<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Sat, 08 Jun 2024 21:30:03 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Detecting a PS2 Emulator: When 1*X does not equal X (135 pts)]]></title>
            <link>https://fobes.dev/ps2/detecting-emu-vu-floats</link>
            <guid>40618459</guid>
            <pubDate>Sat, 08 Jun 2024 16:05:45 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://fobes.dev/ps2/detecting-emu-vu-floats">https://fobes.dev/ps2/detecting-emu-vu-floats</a>, See on <a href="https://news.ycombinator.com/item?id=40618459">Hacker News</a></p>
<div id="readability-page-1" class="page"><div aria-label="Content">
        <p><a href="https://fobes.dev/">..</a></p><article>
  <p>
    <time datetime="2024-06-07 19:29:00 -0400">2024-06-07</time>
  </p>

  

  <p>This is the second entry of my series of detecting PS2 emulators. If you haven’t
read it, you can find it <a href="https://fobes.dev/ps2/detecting-emu-vu0-pipeline">here</a>
.</p>

<hr>

<p>This is a pretty straightforward method. This one can be done on VU1,
VU0 micro mode or VU0 macro mode.
For simplicity, I will do it with VU0 macro mode, where VU0 is used as a coprocessor.
That way it can be done directly on the EE CPU without dealing with VU programs.</p>

<h3 id="welcome-to-hell-ps2-floating-point">Welcome to <del>hell</del> PS2 Floating Point</h3>

<p>If you look at any multiplication instruction (MUL,MULi, etc) in the VU developer
manuals, you will see this remark:</p>

<blockquote>
  <p>There is an operation error of 1 bit in multiplication, so the value multiplied by 1 may not be the same as the
original value. By using VF[fs] as a multiplicand, the results of multiplication with 1 are guaranteed to be
accurate.</p>
</blockquote>

<p>It’s a little bit loaded but the gist of it is, with multiplication operations
<em>1 * X</em> is not guaranteed to result in <em>X</em>, unlike <em>X * 1</em> which is.</p>

<p>The exact reason why a bit is lost is not known to me, whoever decides to
implement software floating point for the PS2 will have to figure that out and
report back :^)</p>

<h3 id="abusing-it">Abusing it</h3>

<p>First things first, we need to figure out a number that triggers this issue. The
easiest way to do that is to brute force it. Thankfully I’ve already done that
in the past. The list of the first 250 numbers (with 0.5 increments) that have
the issue can be found in a
<a href="https://gist.github.com/F0bes/5f209d8a0890879ad0e25ceb6973977a">gist here</a>.</p>

<p>129.5 will be our target number for this detection.</p>

<div><pre><code><span>int</span> <span>isVUMulErrorPresent</span><span>()</span>
<span>{</span>
    <span>float</span> <span>in</span><span>[</span><span>4</span><span>]</span> <span>__aligned</span><span>(</span><span>16</span><span>)</span> <span>=</span> <span>{</span><span>129</span><span>.</span><span>5</span><span>f</span><span>,</span><span>0</span><span>.</span><span>0</span><span>f</span><span>,</span><span>0</span><span>.</span><span>0</span><span>f</span><span>,</span><span>0</span><span>.</span><span>0</span><span>f</span><span>};</span>
    <span>float</span> <span>out</span><span>[</span><span>4</span><span>]</span> <span>__aligned</span><span>(</span><span>16</span><span>)</span> <span>=</span> <span>{</span><span>0</span><span>.</span><span>0</span><span>f</span><span>,</span><span>0</span><span>.</span><span>0</span><span>f</span><span>,</span><span>0</span><span>.</span><span>0</span><span>f</span><span>,</span><span>0</span><span>.</span><span>0</span><span>f</span><span>};</span>
    <span>asm</span> <span>__volatile__</span><span>(</span>
        <span>"QMTC2 %1, $vf1</span><span>\n</span><span>"</span>          <span>// Set VF1 to 129.5f</span>
        <span>"VADDw $vf2, $vf0, $vf0w</span><span>\n</span><span>"</span> <span>// VF2 = vf0[w] = 1</span>
        <span>"VMUL $vf1, $vf2, $vf1</span><span>\n</span><span>"</span>   <span>// VF1 = 1 * 129.5f</span>
        <span>"QMFC2 %0, $vf1</span><span>\n</span><span>"</span>          <span>// Load the number back to the EE</span>
        <span>:</span> <span>"=r"</span><span>(</span><span>out</span><span>[</span><span>0</span><span>])</span>
        <span>:</span> <span>"r"</span><span>(</span><span>in</span><span>[</span><span>0</span><span>]));</span>
    <span>return</span> <span>in</span><span>[</span><span>0</span><span>]</span> <span>!=</span> <span>out</span><span>[</span><span>0</span><span>];</span>
<span>}</span>
</code></pre></div>

<p>Like I said, it’s pretty straightforward. Load 1 and a special number into a
register, multiply them, check the result.</p>

<p>Currently no emulators (PCSX2, Play!, DobieStation, hps2x64) emulate this behaviour.</p>

<p>The difficulty of this one is definitely a 1/5.<br>
I’ll choose a difficult one next time.</p>


  
  

  
</article>

      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The Backrooms of the Internet Archive (317 pts)]]></title>
            <link>https://blog.archive.org/2024/06/01/the-backrooms-of-the-internet-archive/</link>
            <guid>40618079</guid>
            <pubDate>Sat, 08 Jun 2024 15:17:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.archive.org/2024/06/01/the-backrooms-of-the-internet-archive/">https://blog.archive.org/2024/06/01/the-backrooms-of-the-internet-archive/</a>, See on <a href="https://news.ycombinator.com/item?id=40618079">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
			<div>
<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/Dsc00161.jpg"><img decoding="async" width="640" height="480" src="https://blog.archive.org/wp-content/uploads/2024/06/Dsc00161.jpg" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/Dsc00161.jpg 640w, https://blog.archive.org/wp-content/uploads/2024/06/Dsc00161-300x225.jpg 300w, https://blog.archive.org/wp-content/uploads/2024/06/Dsc00161-624x468.jpg 624w" sizes="(max-width: 640px) 100vw, 640px"></a></figure></div>


<p>Like many bits of Internet Culture, this simple image of an empty series of rooms represents a deep-repressed or recently-remembered memory of a common Internet Legend, or it’s just a shot of nothing.</p>



<p>If the answer is that it’s a shot of nothing, let’s get you up to speed.</p>



<p>This image floated around message boards in the 2010s, posted with commentary or as a general use for a slightly off-putting photograph of a less-than-well-maintained location, and was, by most standards, rather indistinct. The internet, after all, is filled with odd images and weird drawings that cause a reaction, often after many different attempts to achieve the effect. <a rel="noreferrer noopener" href="https://en.wikipedia.org/wiki/Survivorship_bias" target="_blank">Survivorship Bias</a> for memes, one might say. So if one more image of an indistinct indoor landscape was out there, not much was going to happen of it.</p>



<p>That changed in 2019, when the image was given a legend and history, made up out of the air, that it was a rare photograph of <a href="https://en.wikipedia.org/wiki/The_Backrooms">The Backrooms</a>. The phrasing of the original declaration speaks for itself:</p>



<p><strong>“If you’re not careful and you noclip out of reality in the wrong areas, you’ll end up in the Backrooms, where it’s nothing but the stink of old moist carpet, the madness of mono-yellow, the endless background noise of fluorescent lights at maximum hum-buzz, and approximately six hundred million square miles of randomly segmented empty rooms to be trapped in<br>God save you if you hear something wandering around nearby, because it sure as hell has heard you”</strong></p>



<p>If this writing strikes you as some sort of odd, rather dramatic addition to the image of a room, then you’re being introduced to <em>creepypasta</em>, or as some might call them, <em>urban legends</em> and <em>campfire stories</em>. It’s part of the overwhelming need for humans to tell tales that excite and frighten, to compose meaning or horror out of the darkness, and even the mundane.</p>



<p>The concept of the “Backrooms” also touches on a very frequent theme of many different horror and science-fiction movies – that there are service tunnels and hard to access areas woven throughout life, known only to a special few. Movies such as <em>The Matrix</em>, <em>The Adjustment Bureau</em>, <em>Us</em>, <em>Beyond the Walls</em>, <em>Dark City</em>, <em>The Cube, </em>and many more have explored this theme – or used it as a jumping off point to tell another story. </p>



<p>The difference, here, is nobody really knew where that very first image came from. <em>For a very long time</em>.</p>



<p>This extended period of not finding the original source of the image left an unfinished tune, a half-written poem, about where it came from and what it meant. And the lack of information in the image as it showed up on these image boards seemed to ensure the mystery would never be found.</p>



<p>So people filled in the blanks.</p>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/Found_Footage_-_Backrooms_1.png"><img decoding="async" loading="lazy" width="780" height="439" src="https://blog.archive.org/wp-content/uploads/2024/06/Found_Footage_-_Backrooms_1.png" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/Found_Footage_-_Backrooms_1.png 780w, https://blog.archive.org/wp-content/uploads/2024/06/Found_Footage_-_Backrooms_1-300x169.png 300w, https://blog.archive.org/wp-content/uploads/2024/06/Found_Footage_-_Backrooms_1-768x432.png 768w, https://blog.archive.org/wp-content/uploads/2024/06/Found_Footage_-_Backrooms_1-624x351.png 624w" sizes="(max-width: 780px) 100vw, 780px"></a></figure>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/Backrooms7.png"><img decoding="async" loading="lazy" width="780" height="439" src="https://blog.archive.org/wp-content/uploads/2024/06/Backrooms7.png" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/Backrooms7.png 780w, https://blog.archive.org/wp-content/uploads/2024/06/Backrooms7-300x169.png 300w, https://blog.archive.org/wp-content/uploads/2024/06/Backrooms7-768x432.png 768w, https://blog.archive.org/wp-content/uploads/2024/06/Backrooms7-624x351.png 624w" sizes="(max-width: 780px) 100vw, 780px"></a></figure>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/Backrooms_model.png"><img decoding="async" loading="lazy" width="1000" height="563" src="https://blog.archive.org/wp-content/uploads/2024/06/Backrooms_model.png" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/Backrooms_model.png 1000w, https://blog.archive.org/wp-content/uploads/2024/06/Backrooms_model-300x169.png 300w, https://blog.archive.org/wp-content/uploads/2024/06/Backrooms_model-768x432.png 768w, https://blog.archive.org/wp-content/uploads/2024/06/Backrooms_model-624x351.png 624w" sizes="(max-width: 1000px) 100vw, 1000px"></a></figure>



<p>A Subreddit called <a rel="noreferrer noopener" href="https://www.reddit.com/r/backrooms/" target="_blank">/r/backrooms</a>, an extended <a rel="noreferrer noopener" href="https://en.wikipedia.org/wiki/Backrooms_(web_series)" target="_blank">web video series called Backrooms</a>, and endless CGI models and creations meant to extend the legend and the origin story became years of effort by thousands to draw the missing pieces of a puzzle that was never a puzzle.</p>



<p>A constantly shifting set of games with titles based off <em>The Backrooms</em> were created and presented for a willing and happy audience; it’d be unfair to choose one or even a few to highlight – there are dozens.</p>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/gamerooms.png"><img decoding="async" loading="lazy" width="1024" height="540" src="https://blog.archive.org/wp-content/uploads/2024/06/gamerooms-1024x540.png" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/gamerooms-1024x540.png 1024w, https://blog.archive.org/wp-content/uploads/2024/06/gamerooms-300x158.png 300w, https://blog.archive.org/wp-content/uploads/2024/06/gamerooms-768x405.png 768w, https://blog.archive.org/wp-content/uploads/2024/06/gamerooms-1536x810.png 1536w, https://blog.archive.org/wp-content/uploads/2024/06/gamerooms-624x329.png 624w, https://blog.archive.org/wp-content/uploads/2024/06/gamerooms.png 1595w" sizes="(max-width: 1024px) 100vw, 1024px"></a></figure>



<p>All of them represent the efforts to bring you into a state of heightened fear or paranoia as you lurked through a series of dark hallways, overlit carpeted spaces, and a growing dread. There’s no question there was a huge audience for this, and it is sometimes thought that this entire legend brought mainstream attention to <strong>liminal spaces</strong>, a perception of the in-between geographies of less unsettling locations. It is now enjoying life as an <a href="https://en.wikipedia.org/wiki/Liminal_space_(aesthetic)">aesthetic movement</a>.</p>



<p>Supporting this explosion of creativity and storytelling was the continued fact that <em>nobody knew where the photograph came from</em>. This situation, of a core image having a completely shadowy and unexplained origin, is arguably the foundation of its power.</p>



<p>That changed, recently.</p>



<p><strong><a href="https://web.archive.org/web/20030503094137/http://www.hobbytownoshkosh.com:80/revolution%20raceway,%20020903.htm" target="_blank" rel="noreferrer noopener">This appears to be the origin of the Backrooms Photograph.</a> </strong></p>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms.png"><img decoding="async" loading="lazy" width="930" height="1024" src="https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms-930x1024.png" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms-930x1024.png 930w, https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms-272x300.png 272w, https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms-768x846.png 768w, https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms-1395x1536.png 1395w, https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms-624x687.png 624w, https://blog.archive.org/wp-content/uploads/2024/06/originofbackrooms.png 1591w" sizes="(max-width: 930px) 100vw, 930px"></a></figure>



<div><p>In March 2003, there was a former furniture store called Rohner’s Home Furnishings in Oshkosh, Wisconsin whose second floor was being renovated by the (somewhat) new tenants, HobbyTown. </p><p>Renovating the space from the sale of furniture to a new remote-controlled racing car track (among other aspects) meant pulling down partitions and ripping out carpet. This inspired taking photographs of the process, one of which, DSC001561.JPG, was the legendary “Back Rooms” image.</p></div>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/justbackrooms-1.png"><img decoding="async" loading="lazy" width="784" height="424" src="https://blog.archive.org/wp-content/uploads/2024/06/justbackrooms-1.png" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/justbackrooms-1.png 784w, https://blog.archive.org/wp-content/uploads/2024/06/justbackrooms-1-300x162.png 300w, https://blog.archive.org/wp-content/uploads/2024/06/justbackrooms-1-768x415.png 768w, https://blog.archive.org/wp-content/uploads/2024/06/justbackrooms-1-624x337.png 624w" sizes="(max-width: 784px) 100vw, 784px"></a></figure>



<p>18 times in the last 20 years, crawlers affiliated with the Internet Archive moved through this page and grabbed portions of it, speculatively, to store for future research and reference. As the whole image was grabbed, reading the metadata of the original image reveals the date it was taken (June 12, 2002), and the camera used (a Sony Cyber-Shot model). The great unknown image, the unsettling photo of a mysterious place and time, was revealed.</p>



<p>However the original, anonymous user stumbled onto this photograph, it appears it was taken from either the Wayback directly, or the Wayback Machine crawled the same site the user had found, and kept that webpage’s preservation for over 20 years.</p>



<p><strong>Emerging, Blinking, Into the Light</strong></p>



<p>Naturally, as news of the Backrooms being “found” travels throughout the world, responses have wildly ranged.</p>



<p>For some, this is a proof that “with enough eyeballs, all problems are shallow”. While we might argue about the relative worth of a given effort, the fact that it is possible for word to travel about a mystery to the point of being solved means that the world is a hair less intimidating and scary. Our shared efforts and cooperation can find the answer to a seemingly impossible-to-answer question. The fact that an image with basically no information and a blurry set of components could be tracked down and revealed is a miracle.</p>



<p>For others, the mystery being solved removes a little bit of magic and wonder from the world. It says that there’s no kayfabe, no holding of mystery in our hands without peeking further to tear out the secret. In this perspective, something special has been lost.</p>



<p>But there’s another lesson as well.</p>



<p>The Internet Archive’s crawlers moved through the pages of a hobby store multiple times over the years, capturing HTML, photographs, and time-stamping the process, with the equivalent care of an at-risk website, a politician on the national stage, or a legendary and obvious moment in history provided via a PDF file.</p>



<p>This agnostic, wide-ranging crawl likely represented both the original source of the image, and a persistent, dependable URL to reference back to it, as thousands are doing at this very moment.</p>



<p><strong>This is the mission of the Wayback Machine – be the dependable, accessible connection to web history, and therefore all history. Give the Internet its Memory, which would otherwise be lost.</strong></p>



<p>If you mourn the loss of legend and mystery in our quest to keep the truth transparent, available and persistent, don’t worry – the process of internalizing and analyzing the image to give the Backrooms history its full and complete story has already begun:</p>



<figure><a href="https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1.jpeg"><img decoding="async" loading="lazy" width="1024" height="726" src="https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1-1024x726.jpeg" alt="" srcset="https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1-1024x726.jpeg 1024w, https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1-300x213.jpeg 300w, https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1-768x545.jpeg 768w, https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1-1536x1089.jpeg 1536w, https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1-624x442.jpeg 624w, https://blog.archive.org/wp-content/uploads/2024/06/mq677jm22t3d1.jpeg 1691w" sizes="(max-width: 1024px) 100vw, 1024px"></a></figure>



<p><em>Here’s to the next mystery, and the next unsettling information being brought into the light and presented for the education, research and entertainment of the Internet, courtesy of the Wayback Machine.</em></p>
					</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[LSP-AI: open-source language server serving as back end for AI code assistance (111 pts)]]></title>
            <link>https://github.com/SilasMarvin/lsp-ai</link>
            <guid>40617082</guid>
            <pubDate>Sat, 08 Jun 2024 12:24:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/SilasMarvin/lsp-ai">https://github.com/SilasMarvin/lsp-ai</a>, See on <a href="https://news.ycombinator.com/item?id=40617082">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><themed-picture data-catalyst-inline="true"><picture>
  <source media="(prefers-color-scheme: dark)" srcset="https://github.com/SilasMarvin/lsp-ai/raw/main/logos/logo-white-no-background-1024x1024.png">
  <source media="(prefers-color-scheme: light)" srcset="https://github.com/SilasMarvin/lsp-ai/raw/main/logos/logo-white-black-background-1024x1024.png">
  <img alt="Logo" src="https://github.com/SilasMarvin/lsp-ai/raw/main/logos/logo-white-black-background-1024x1024.png" width="128em">
</picture></themed-picture>
<p dir="auto"><h2 tabindex="-1" dir="auto">LSP-AI</h2><a id="user-content-lsp-ai" aria-label="Permalink: LSP-AI" href="#lsp-ai"></a></p>
<p dir="auto">LSP-AI is an open source <a href="https://microsoft.github.io/language-server-protocol/" rel="nofollow">language server</a> that serves as a backend for performing completion with large language models and soon other AI powered functionality. Because it is a language server, it works with any editor that has LSP support.</p>
<p dir="auto"><strong>The goal of LSP-AI is to assist and empower software engineers by integrating with the tools they already know and love not replace software engineers.</strong></p>
<p dir="auto">A short list of a few of the editors it works with:</p>
<ul dir="auto">
<li>VS Code</li>
<li>NeoVim</li>
<li>Emacs</li>
<li>Helix</li>
<li>Sublime</li>
</ul>
<p dir="auto">It works with many many many more editors.</p>
<p dir="auto">See the wiki for instructions on:</p>
<ul dir="auto">
<li><a href="https://github.com/SilasMarvin/lsp-ai/wiki">Getting Started</a></li>
<li><a href="https://github.com/SilasMarvin/lsp-ai/wiki/Installation">Installation</a></li>
<li><a href="https://github.com/SilasMarvin/lsp-ai/wiki/Configuration">Configuration</a></li>
<li><a href="https://github.com/SilasMarvin/lsp-ai/wiki/Plugins">Plugins</a></li>
<li><a href="https://github.com/SilasMarvin/lsp-ai/wiki/Server-Capabilities-and-Functions">Server Capabilities</a></li>
<li><a href="https://github.com/SilasMarvin/lsp-ai/wiki">and more</a></li>
</ul>
<p dir="auto">LSP-AI can work as an alternative to Github Copilot.</p>
<details open="">
  <summary>
    
    <span aria-label="Video description LSP-AI.VS-Code.and.Helix.Demo.mp4">LSP-AI.VS-Code.and.Helix.Demo.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/19626586/335907364-59430558-da23-4991-939d-57495061c21b.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTc4ODI1MDMsIm5iZiI6MTcxNzg4MjIwMywicGF0aCI6Ii8xOTYyNjU4Ni8zMzU5MDczNjQtNTk0MzA1NTgtZGEyMy00OTkxLTkzOWQtNTc0OTUwNjFjMjFiLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA2MDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjA4VDIxMzAwM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVmOWUwNTU5NTcyODc5MTljZDdiNzQ3NzU4NzkzYzQzM2Q3MDBkMTYzNTExOWJhOGFiNDdmZWQ1MmQzMzk2YTQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.tJYtIsKAYFUt7oeFMoO9EfAPC4h6_O_51K_X-Hd0zQs" data-canonical-src="https://private-user-images.githubusercontent.com/19626586/335907364-59430558-da23-4991-939d-57495061c21b.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTc4ODI1MDMsIm5iZiI6MTcxNzg4MjIwMywicGF0aCI6Ii8xOTYyNjU4Ni8zMzU5MDczNjQtNTk0MzA1NTgtZGEyMy00OTkxLTkzOWQtNTc0OTUwNjFjMjFiLm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA2MDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNjA4VDIxMzAwM1omWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVmOWUwNTU5NTcyODc5MTljZDdiNzQ3NzU4NzkzYzQzM2Q3MDBkMTYzNTExOWJhOGFiNDdmZWQ1MmQzMzk2YTQmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.tJYtIsKAYFUt7oeFMoO9EfAPC4h6_O_51K_X-Hd0zQs" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto"><em>On the left: VS Code using Mistral Codestral. On the right: Helix using stabilityai/stable-code-3b</em></p>
<p dir="auto"><strong>Note that speed for completions is entirely dependent on the backend being used. For the fastest completions we recommend using either a small local model or Groq.</strong></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">The Case for LSP-AI</h2><a id="user-content-the-case-for-lsp-ai" aria-label="Permalink: The Case for LSP-AI" href="#the-case-for-lsp-ai"></a></p>
<p dir="auto"><strong>tl;dr LSP-AI abstracts complex implementation details from editor specific plugin authors, centralizing open-source development work into one shareable backend.</strong></p>
<p dir="auto">Editor integrated AI-powered assistants are here to stay. They are not perfect, but are only improving and <a href="https://arxiv.org/pdf/2206.15331" rel="nofollow">early research is already showing the benefits</a>. While several companies have released advanced AI-powered editors like <a href="https://cursor.sh/" rel="nofollow">Cursor</a>, the open-source community lacks a direct competitor.</p>
<p dir="auto">LSP-AI aims to fill this gap by providing a language server that integrates AI-powered functionality into the editors we know and love. Here’s why we believe LSP-AI is necessary and beneficial:</p>
<ol dir="auto">
<li>
<p dir="auto"><strong>Unified AI Features</strong>:</p>
<ul dir="auto">
<li>By centralizing AI features into a single backend, LSP-AI allows supported editors to benefit from these advancements without redundant development efforts.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Simplified Plugin Development</strong>:</p>
<ul dir="auto">
<li>LSP-AI abstracts away the complexities of setting up LLM backends, building complex prompts and soon much more. Plugin developers can focus on enhancing the specific editor they are working on, rather than dealing with backend intricacies.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Enhanced Collaboration</strong>:</p>
<ul dir="auto">
<li>Offering a shared backend creates a collaborative platform where open-source developers can come together to add new functionalities. This unified effort fosters innovation and reduces duplicated work.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Broad Compatibility</strong>:</p>
<ul dir="auto">
<li>LSP-AI supports any editor that adheres to the Language Server Protocol (LSP), ensuring that a wide range of editors can leverage the AI capabilities provided by LSP-AI.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Flexible LLM Backend Support</strong>:</p>
<ul dir="auto">
<li>Currently, LSP-AI supports llama.cpp, OpenAI-compatible APIs, Anthropic-compatible APIs and Mistral AI FIM-compatible APIs, giving developers the flexibility to choose their preferred backend. This list will soon grow.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Future-Ready</strong>:</p>
<ul dir="auto">
<li>LSP-AI is committed to staying updated with the latest advancements in LLM-driven software development.</li>
</ul>
</li>
</ol>
<p dir="auto"><h2 tabindex="-1" dir="auto">Roadmap</h2><a id="user-content-roadmap" aria-label="Permalink: Roadmap" href="#roadmap"></a></p>
<p dir="auto">There is so much to do for this project and incredible new research and tools coming out everyday. Below is a list of some ideas for what we want to add next, but we welcome any contributions and discussion around prioritizing new features.</p>
<ul dir="auto">
<li>Implement semantic search-powered context building (This could be incredibly cool and powerful). Planning to use <a href="https://tree-sitter.github.io/tree-sitter/" rel="nofollow">Tree-sitter</a> to chunk code correctly.</li>
<li>Support for additional backends</li>
<li>Exploration of agent-based systems</li>
</ul>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Boeing Passenger Jet Nearly Crashes Because of Known Software Bug (149 pts)]]></title>
            <link>https://www.independent.co.uk/travel/tui-boeing-flight-bristol-disaster-avoided-b2558536.html</link>
            <guid>40615786</guid>
            <pubDate>Sat, 08 Jun 2024 06:52:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.independent.co.uk/travel/tui-boeing-flight-bristol-disaster-avoided-b2558536.html">https://www.independent.co.uk/travel/tui-boeing-flight-bristol-disaster-avoided-b2558536.html</a>, See on <a href="https://news.ycombinator.com/item?id=40615786">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main"><div data-newsletter-key="receiveIndyTravelNews"><p><img src="https://static.independent.co.uk/static-assets/images/newsletter/travel/travel.jpg" loading="lazy" alt="Simon Calder’s Travel"></p><div><p><h3 data-nosnippet="">Sign up to Simon Calder’s free travel email for expert advice and money-saving discounts</h3><h3 data-nosnippet="">Get Simon Calder’s Travel email</h3></p></div></div><p>A potential disaster was narrowly avoided when a packed passenger plane took off just seconds before it was about to run out of runway because of a software glitch.</p><p>The <a href="https://www.independent.co.uk/topic/boeing">Boeing</a> aircraft, operated by <a href="https://www.independent.co.uk/topic/tui">TUI</a>, departed from <a href="https://www.independent.co.uk/topic/bristol-airport">Bristol Airport</a> for Las Palmas, Gran Canaria on 9 March with 163 passengers on board when it struggled to take off.</p><p>The 737-800 plane cleared runway nine with just 260 metres (853ft) of tarmac to spare at a height of 10ft. </p><p>It then flew over the nearby A38 road at a height of just 30 metres (100ft) travelling at the speed of around 150kts (about 173mph).</p><p>The A38 is a major A-class busy road, connecting South West England with the&nbsp; Midlands and the north.</p><p>The Air Accidents Investigation Branch (AAIB), part of the Department for Transport, said the incident was the result of insufficient thrust being used during take-off.</p><p>Pilots manually set the thrust level following a software glitch that Beoing was aware of before take-off.</p><div><figure><p><img src="https://static.independent.co.uk/2024/06/07/10/iStock-1317466923.jpg" srcset="https://static.independent.co.uk/2024/06/07/10/iStock-1317466923.jpg?quality=75&amp;width=320&amp;auto=webp 320w, https://static.independent.co.uk/2024/06/07/10/iStock-1317466923.jpg?quality=75&amp;width=640&amp;auto=webp 640w" loading="lazy" alt="" on="tap:auto-image-gallery,inline-image-carousel.goToSlide(index=0)" tabindex="0" role="button" data-gallery-length="2"></p><figcaption><span>(<!-- -->Getty Images<!-- -->)</span></figcaption></figure></div><p>“A Boeing 737-800 completed a takeoff from Runway 09 at Bristol Airport with insufficient thrust to meet regulated performance,” the AAIB report said.</p><p>“The autothrottle (A/T) disengaged when the takeoff mode was selected, at the start of the takeoff roll, and subsequently the thrust manually set by the crew (84.5% N1 ) was less than the required takeoff thrust (92.8% N1 ).</p><p>“Neither pilot then noticed that the thrust was set incorrectly, and it was not picked up through the standard operating procedures (SOPs).”</p><p>The plane’s acceleration was significantly slower than 99.7 per cent of other aircraft of the same model departing the same airport, performance data collated by the AAIB showed.</p><p>The autothrottle system on a Boeing 737-800 can control the thrust from takeoff to landing, the AAIB added.</p><p>Boeing told investigators looking into the incident that they were aware of a “long history of nuisance disconnects during takeoff mode engagements”.</p><p>It added that plane was fitted with and FDR recording device, known as a ‘black box’, which records flight data and a CVR, which records the recent sounds in the cockpit.</p><p>The AAIB said: “G-FDZS was fitted with both an FDR and a CVR. The CVR fitted to G-FDZS was not removed from the aircraft as it continually overwrites itself, retaining only the last two hours of audio.</p><p>“As such, the recording of the takeoff would have been overwritten during the flight to Las Palmas. However, the FDR was removed and downloaded”.</p><p>The incident is the latest in a string of problems with Boeing jets in recent years.</p><p>The aerospace giant’s safety standards are coming under increasing scrutiny following several <a href="https://www.independent.co.uk/travel/news-and-advice/boeing-737-max-safety-aircraft-passengers-crash-b2542773.html"><u>recent incidents</u></a>, including one <a href="https://www.independent.co.uk/news/world/americas/alaska-airlines-passengers-boeing-lawsuit-b2506896.html"><u>where a disused door fell off a brand new 737 Max shortly after take-off.</u></a> There were no injuries.</p><p>In April a FedEx Airlines Boeing cargo plane landed at Istanbul Airport without the front landing gear deployed but managed to stay on the runway.</p><p>Five years ago, Boeing agreed to pay $2.5bn and make safety improvements after <a href="https://www.independent.co.uk/news/uk/boeing-british-nairobi-addis-ababa-ethiopia-b2372747.html"><u>two new 737 Max jets crashed </u></a>within the space of five months - one in Indonesia in 2018 and one in Ethiopia in 2019, killing a total of 346 people.</p><p>In May US officials <a href="https://www.independent.co.uk/travel/boeing-whistleblower-safety-report-news-b2538763.html"><u>warned Boeing it could face criminal charges</u></a> after claims the airline failed to improve plane safety and adhere to a settlement after the deadly 737 crashes.</p><p>A TUI UK&amp;I spokesperson said: “We have worked closely with the authorities to provide all available information.</p><p>“The AAIB recommendations and learnings resulting from this take-off will support the whole aviation sector and other airlines. The safety of our passengers and crew is always our highest priority.”</p><p>Boeing was contacted for comment.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Content Injection Attack on GitHub (150 pts)]]></title>
            <link>https://github.com/younesbram/younesbram</link>
            <guid>40615653</guid>
            <pubDate>Sat, 08 Jun 2024 06:15:11 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/younesbram/younesbram">https://github.com/younesbram/younesbram</a>, See on <a href="https://news.ycombinator.com/item?id=40615653">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
          <nav aria-label="Global">
            <ul>
                <li>
      
      <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Actions&quot;,&quot;label&quot;:&quot;ref_cta:Actions;&quot;}" href="https://github.com/features/actions">
      
      <div>
        <p>Actions</p><p>
        Automate any workflow
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Packages&quot;,&quot;label&quot;:&quot;ref_cta:Packages;&quot;}" href="https://github.com/features/packages">
      
      <div>
        <p>Packages</p><p>
        Host and manage packages
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Security&quot;,&quot;label&quot;:&quot;ref_cta:Security;&quot;}" href="https://github.com/features/security">
      
      <div>
        <p>Security</p><p>
        Find and fix vulnerabilities
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Codespaces&quot;,&quot;label&quot;:&quot;ref_cta:Codespaces;&quot;}" href="https://github.com/features/codespaces">
      
      <div>
        <p>Codespaces</p><p>
        Instant dev environments
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to GitHub Copilot&quot;,&quot;label&quot;:&quot;ref_cta:GitHub Copilot;&quot;}" href="https://github.com/features/copilot">
      
      <div>
        <p>GitHub Copilot</p><p>
        Write better code with AI
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Code review&quot;,&quot;label&quot;:&quot;ref_cta:Code review;&quot;}" href="https://github.com/features/code-review">
      
      <div>
        <p>Code review</p><p>
        Manage code changes
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Issues&quot;,&quot;label&quot;:&quot;ref_cta:Issues;&quot;}" href="https://github.com/features/issues">
      
      <div>
        <p>Issues</p><p>
        Plan and track work
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Discussions&quot;,&quot;label&quot;:&quot;ref_cta:Discussions;&quot;}" href="https://github.com/features/discussions">
      
      <div>
        <p>Discussions</p><p>
        Collaborate outside of code
      </p></div>

    
</a></li>

            </ul>
          </div>
</li>


                <li>
      
      
</li>


                <li>
      
      <div>
          <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to GitHub Sponsors&quot;,&quot;label&quot;:&quot;ref_cta:GitHub Sponsors;&quot;}" href="https://github.com/sponsors">
      
      <div>
        <p>GitHub Sponsors</p><p>
        Fund open source developers
      </p></div>

    
</a></li>

            </ul>
          </div>
          <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to The ReadME Project&quot;,&quot;label&quot;:&quot;ref_cta:The ReadME Project;&quot;}" href="https://github.com/readme">
      
      <div>
        <p>The ReadME Project</p><p>
        GitHub community articles
      </p></div>

    
</a></li>

            </ul>
          </div>
          
      </div>
</li>


                <li>
      
      <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Enterprise&quot;,&quot;action&quot;:&quot;click to go to Enterprise platform&quot;,&quot;label&quot;:&quot;ref_cta:Enterprise platform;&quot;}" href="https://github.com/enterprise">
      
      <div>
        <p>Enterprise platform</p><p>
        AI-powered developer platform
      </p></div>

    
</a></li>

            </ul>
          </div>
</li>


                <li>
    <a data-analytics-event="{&quot;category&quot;:&quot;Header menu top item (logged out)&quot;,&quot;action&quot;:&quot;click to go to Pricing&quot;,&quot;label&quot;:&quot;ref_cta:Pricing;&quot;}" href="https://github.com/pricing">Pricing</a>
</li>

            </ul>
          </nav>

        <div>
                


<qbsearch-input data-scope="repo:younesbram/younesbram" data-custom-scopes-path="/search/custom_scopes" data-delete-custom-scopes-csrf="5spStqM4ODdm6BVAGfby0OwFtjMdbj89Gyy2_DRTaqm7bghjkkTJfVOGNsS_sfato80FNqOlFiVF8AXHb7QFIg" data-max-custom-scopes="10" data-header-redesign-enabled="false" data-initial-value="" data-blackbird-suggestions-path="/search/suggestions" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations" data-current-repository="younesbram/younesbram" data-current-org="" data-current-owner="younesbram" data-logged-in="false" data-copilot-chat-enabled="false" data-blackbird-indexed-repo-csrf="<esi:include src=&quot;/_esi/rails_csrf_token_form_hidden?r=2lz%2FVk8x%2Fy1ertQN2Xf0SKedyE33KyXvu6Yk3QCYlnK4ljR%2BXbrMNTVhL711gBAJCN0heuWI5oL7c2QeW3jjZxd86mVMHw8ckoOojbc7c2gqidfgTHpiMLuV%2FbodTZ8M2St%2FIw%2BNT3hvRqhvtVoSsMEAp0m9asGdQna1sIXwYggOxIJG18XWv4LsZnozOyu4OQUYRKGwRMMYLnU1FTBTjbJqDsYABymnqqb1Y7GXagv7m1vHZYD1iDS8OXpsTP0tPDpa%2F43%2BMEMRJ8tqrHTWqXAixTqWBGEIAR0ysEwehS7FBkwHUuJcSEgpyXVvsuOkh50Hb5%2FR0eEBR%2F6BwimQIfQqERgC%2FnxyzAafFbBDzJmR2so7s%2BZ3Pxo3N2cFayKs%2B3B58y0uz1L7WBDCTJhGnmOQUUJkjKFqwdrb1vXdJ%2BVGJ0Dh5q6klbyNRhctqAsdR11aA0cwSHIyjgBAW7IoKm1aphJD4M0lKZvDh2d0Z25RVwIxIONnFUBTpb1kJAd8E7b095mWeuqk%2F%2FSmUg%2FZabWO--m5cGCxrFJAUGHzjP--ZEV1sw6q5a8VeJ8Ze46M9Q%3D%3D&quot; />">
  <div data-modal-dialog-overlay="" data-action="click:qbsearch-input#searchInputContainerClicked">
  <modal-dialog data-action="close:qbsearch-input#handleClose cancel:qbsearch-input#handleClose" data-target="qbsearch-input.searchSuggestionsDialog" role="dialog" id="search-suggestions-dialog" aria-modal="true" aria-labelledby="search-suggestions-dialog-header" data-view-component="true">
      <h2 id="search-suggestions-dialog-header">Search code, repositories, users, issues, pull requests...</h2>
    
</modal-dialog></div>
  
  <div>
    
<dialog-helper>
  <dialog data-target="qbsearch-input.feedbackDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="feedback-dialog" aria-modal="true" aria-labelledby="feedback-dialog-title" aria-describedby="feedback-dialog-description" data-view-component="true">
    <div data-view-component="true">
    <p>
      <h2 id="feedback-dialog-title">
        Provide feedback
      </h2>
        
    </p>
    
  </div>
      <scrollable-region data-labelled-by="feedback-dialog-title">
        
      </scrollable-region>
      
</dialog></dialog-helper>

    <custom-scopes data-target="qbsearch-input.customScopesManager">
    
<dialog-helper>
  <dialog data-target="custom-scopes.customScopesModalDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="custom-scopes-dialog" aria-modal="true" aria-labelledby="custom-scopes-dialog-title" aria-describedby="custom-scopes-dialog-description" data-view-component="true">
    <div data-view-component="true">
    <p>
      <h2 id="custom-scopes-dialog-title">
        Saved searches
      </h2>
        <h2 id="custom-scopes-dialog-description">Use saved searches to filter your results more quickly</h2>
    </p>
    
  </div>
      <scrollable-region data-labelled-by="custom-scopes-dialog-title">
        
      </scrollable-region>
      
</dialog></dialog-helper>
    </custom-scopes>
  </div>
</qbsearch-input>

            <p><a href="https://github.com/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=younesbram%2Fyounesbram" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/younesbram/younesbram&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="a4297aba2f00e602b9999fab25705e5d41f18887cf78631859881a63043342fb" data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/<user-name>/<repo-name>;ref_cta:Sign up;ref_loc:header logged out&quot;}">
              Sign up
            </a>
        </p></div>
      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Replit used legal threats to kill my open-source project (2021) (178 pts)]]></title>
            <link>https://intuitiveexplanations.com/tech/replit/</link>
            <guid>40615537</guid>
            <pubDate>Sat, 08 Jun 2024 05:43:48 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://intuitiveexplanations.com/tech/replit/">https://intuitiveexplanations.com/tech/replit/</a>, See on <a href="https://news.ycombinator.com/item?id=40615537">Hacker News</a></p>
<div id="readability-page-1" class="page"><div aria-label="Content">
<article>

<div>

<blockquote cite="CEO of Replit, in an email to me"> I
think you should take it down and stop working on it. I'll be engaging
our lawyers on Monday if it's still up by then. <span>[...]</span> We were a tiny company when you interned
with us <span>[...]</span> Luckily we're bigger now,
and crucially have a lot of money to pay for top lawyers now if we're
forced to go that route.</blockquote>
<p><strong>I received an official response from Replit and my open-source
project will be back up soon; please see <a href="#how-did-replit-respond-to-this-blog-post">the bottom of the blog
post</a> for an update. The
rest of the content here will remain as a historical artifact.</strong></p>
<p>Hi, my name is Radon. I graduated college last year and now work as a
software engineer in DevOps/Infrastructure. In my free time, I also
maintain <a href="https://github.com/raxod502">a number of open-source
projects</a>.</p>
<p>While I was in college, I interned at the startup Replit. This blog
post is the story of how Replit is using legal threats and their
venture-capital funding to bully me into shutting down an open-source
project they don’t like.</p>
<p><strong>Table of contents</strong></p>

<ul>
<li><a href="#whats-replit">What’s Replit?</a></li>
<li><a href="#what-was-my-open-source-project">What was my open-source project?</a></li>
<li><a href="#what-happened-when-i-shared-my-open-source-project-with-replit">What happened when I shared my open-source project with Replit?</a></li>
<li><a href="#what-happened-after-replit-threatened-to-sue-me">What happened after Replit threatened to sue me?</a></li>
<li><a href="#is-replit-right">Is Replit right?</a></li>
<li><a href="#why-would-replit-do-this">Why would Replit do this?</a></li>
<li><a href="#how-did-replit-respond-to-this-blog-post">How did Replit respond to this blog post?</a></li>
<li><a href="#so-is-riju-back-up-now">So is Riju back up now?</a></li>
</ul>

<h2 id="whats-replit" tabindex="-1">What’s Replit?</h2>
<p>Replit makes a webapp you can use to run code online in different
programming languages. This is nothing new (<a href="https://www.google.com/search?q=run+python+online">just Google “run python
online”</a> for
proof), so Replit’s value proposition is extra features like sharing
your work, installing third-party packages, and hosting webapps.</p>
<p>I worked for Replit in Summer 2019, where I was asked to rebuild
Replit’s package management stack and make it open-source. If you like
reading about tech stuff, <a href="https://web.archive.org/web/20210504051428/https://blog.replit.com/upm">here’s the post I wrote for Replit’s
blog</a>,
and <a href="https://github.com/raxod502/upm">here’s the code on GitHub</a>.</p>
<p>I took a job elsewhere in Summer 2020, but still chatted with them
occasionally by email when they reached out to tell me about something
cool Replit had developed.</p>
<h2 id="what-was-my-open-source-project" tabindex="-1">What was my open-source project?</h2>
<center><img src="https://intuitiveexplanations.com/assets/riju-languages.png" alt="Screenshot of
language select page in Riju" width="100%"></center>
<p>The aspect of Replit that I really enjoyed was how it supported lots
of different programming languages. (I wrote <a href="https://web.archive.org/web/20210504023410/https://blog.replit.com/elisp">another blog post for
Replit</a>
about how they do that.) That got me thinking: how many programming
languages could you possibly cram into a single website?</p>
<p>To explore that question, I put together my own little webapp that
could run code online. After about a day, I had something that worked.
(If you’re wondering why it was so fast—it turns out you only need
<a href="https://github.com/raxod502/python-in-a-box">30 lines of code</a> to let
people run Python code in a webapp! This may be why there are so many
websites for running Python online…)</p>
<p>After it was working, I started adding as many different programming
languages as I could. As you can see from this excerpt of my project’s
version history, I got a little overexcited:</p>
<pre><code>                                                                   languages
                                                                   ---------
2020-06-05 df9ba38 Initial commit                                          0
2020-06-05 5e3a4a4 Install some packages into a Docker image               0
2020-06-05 e937c8f Simple Express server with "Hello world"                0
2020-06-06 0961498 Embed terminal on frontend app                          0
2020-06-06 c66cf63 Embed Monaco editor on frontend                         0
2020-06-06 27ab1f7 Add "run" button                                        0
2020-06-06 f417858 You can run Python code now                             1
2020-06-07 d543081 You can run many languages now                          8
2020-06-07 e2a3e71 All languages 17 working now                           17
2020-06-07 473c50c ALL THE LANGUAGES                                      25
2020-06-08 3718315 even more languages                                    33
2020-06-08 548c1c1 repl.it superiority!!                                  38
2020-06-08 1ae424f More languages, we need all the languages              48
2020-06-09 c34ccf2 A lot more languages                                   77
2020-06-09 846caf2 At this point the number of languages is absurd        79
</code></pre>
<p>I eventually ended up with 216 languages, including <a href="https://web.archive.org/web/20210512193221/https://replit.com/languages">all 38 languages
from
Replit</a>,
<a href="https://github.com/mame/quine-relay">all 100 languages from Yusuke Endoh’s “Quine
Relay”</a>, and a good deal more
besides. You might ask: Why did I spend so much time adding obscure
programming languages to a webapp nobody was going to use? Well, let
me put it this way: Is it the weirdest 2020 hobby you’ve seen?</p>

<p>One day, I got an email from Replit letting me know about a new
feature they released. I figured this was a good time to share my
open-source project with them, in case they wanted to take inspiration
from any of my work:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-1.png" alt="Screenshot of an
email from Replit sharing a post from their blog, and my response
sharing my open-source project with them" width="100%"></center>
<p>At first, I got a positive response. But then, 30 minutes later, out
of nowhere, Replit accused me of unethical behavior and stealing their
design:</p>

<center><img src="https://intuitiveexplanations.com/assets/replit-email-2.png" alt="Screenshot of
one email from Replit praising my open-source project, and an
immediately subsequent one accusing me of unethical behavior and
stealing 'internal design decisions'" width="100%"></center>
<p>Now, none of the ideas I used in my open-source project were “internal
design decisions”: they’ve all been published publicly on Replit’s
blog (I knew this because I’d been asked to <em>write</em> some of those blog
posts during my internship). And my project also wasn’t any more of a
Replit clone than any of the other websites on the first few pages of
Google results for “run python online”, most of which look exactly the
same:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-ui-montage.png" alt="Screenshot of
nine different webapps that let you run Python online, all of which
look more or less identical" width="100%"></center>
<p>But I figured I might have missed something, so I asked for details:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-3.png" alt="Screenshot
excerpt of my email asking Replit for details about what ideas they
were claiming I stole" width="100%"></center>
<p>(The rest of this email is basically me repeating the previous
paragraph of this article, but with a lot more technical details. You
can read the whole email <a href="https://imgur.com/a/OaEOwu2">on Imgur</a>,
mirrored <a href="https://web.archive.org/web/20210530184721/https://imgur.com/a/OaEOwu2">on the Internet
Archive</a>.)</p>
<p>Unfortunately, Replit refused to provide any specifics on what they
were saying I had done wrong, reiterated their previous statements,
and threatened me with a lawsuit:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-4.png" alt="Screenshot of an
email from Replit threatening me with a lawsuit" width="100%"></center>
<p>And then just to put a cherry on top, Replit sent me another email
reminding me that they <a href="https://venturebeat.com/2021/02/18/replit-raises-20-million-for-collaborative-browser-based-coding/">just raised $20 million from their investors
last
month</a>,
and they weren’t afraid to use it against me. The “me” in question
being one of their previous interns who just graduated from college a
year ago, and who isn’t running any kind of commercial operation
whatsoever.</p>

<center><img src="https://intuitiveexplanations.com/assets/replit-email-5.png" alt="Screenshot of an
email from Replit threatening me with their money" width="100%"></center>
<p>I’d like to point out two things about this email:</p>
<ul>
<li>The remark about “commits like this”—this is actually misleading.
There’s only one commit in my project that mentions Replit, and it’s
the one I already showed you earlier, from my third day of coding,
when I’d just added all 38 languages that Replit supported, before
moving onto the 178 other languages I wanted to add.</li>
<li>The remark about me being a “demanding” intern—I’m not actually
sure what this is meant to imply, especially since Replit had just
tried to recruit me earlier that day (see the screenshot of their
first email). But I’ll leave it alone because it’s not really
relevant to the issue at hand.</li>
</ul>
<h2 id="what-happened-after-replit-threatened-to-sue-me" tabindex="-1">What happened after Replit threatened to sue me?</h2>
<p>Naturally, I took down my project right away, gave it some time for
feelings to cool, and sent Replit an apology. I figured something
might have been lost over email, so I asked to get on a call:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-6.png" alt="Screenshot of an
email in which I apologize to Replit and ask to have a call" width="100%"></center>
<p>Unfortunately, Replit ignored this email, so I sent them another one
following up. This one got a response, but not the one I was hoping
for:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-7.png" alt="Screenshot of an
email from Replit making it clear that they have no intention of
talking to me further" width="100%"></center>
<p>Just in case Replit didn’t understand that I wasn’t OK with this
situation, I sent three follow-up emails explaining as such over the
next few weeks, all of which were ignored.</p>
<p>In other words, Replit stands by its threat: if I re-publish my
open-source project, then they will sue me with “top lawyers”.</p>
<h2 id="is-replit-right" tabindex="-1">Is Replit right?</h2>
<p>Replit claimed that my open-source project was:</p>
<ol>
<li>a clone of Replit</li>
<li>based on their trade secrets (“internal design decisions”)</li>
<li>unethical to build</li>
</ol>
<p>Let’s examine this claim, part by part:</p>
<ol>
<li>In developing my project, was I making a clone of Replit?</li>
<li>In developing my project, did I make use of any trade secrets of
Replit?</li>
<li>Was it unethical for me to develop an open-source project that’s
similar to Replit, after working for them?</li>
</ol>
<p>Questions 1 and 2 have a fair number of technical details, so I’ve put
them <a href="https://intuitiveexplanations.com/tech/replit/evidence">in a separate post</a>. The TL;DR is:</p>
<ol>
<li>My project isn’t any more similar to Replit than the 15 other
(commercial!) ones you can find on Google by searching “run python
online” or “online programming environment”.</li>
<li>Every similarity between my project and Replit can be explained by
looking only at GitHub repositories and blog posts that were
<em>published online by Replit itself</em>, making them obviously not any
kind of secret.</li>
</ol>
<p>Let’s address question 3 here:</p>
<blockquote>
<p>Q: Was it unethical for me to develop an open-source project that’s
similar to Replit, after working for them?</p>
</blockquote>
<p>In my opinion, the answer to this question is no, for a number of
reasons:</p>
<ul>
<li>Riju is entirely non-commercial. Unlike Replit, I didn’t seek
funding from any source—advertising, donations, fundraising,
subscriptions, whatever. I have no interest in running a business,
and never really <em>wanted</em> Riju to become too popular, since I was
the one paying the server bill.</li>
<li>Riju wasn’t stealing customers from Replit. Based on my analytics
data, there were 38 visits to Riju during the month of February.
(Half of those were probably me.) Meanwhile, Replit had <a href="https://web.archive.org/web/20210505162911/https://twitter.com/Replit/status/1389976994423525378">over 7
million
users</a>.
There’s obviously no sense in which Riju was competing with Replit.</li>
<li>Riju wasn’t <em>built</em> as a competitor to Replit, either. Since the
architecture was limited to running on a single server, anyone could
bring the entire system down just by typing in a <a href="https://en.wikipedia.org/wiki/Fork_bomb">fork
bomb</a>—and one of my
friends did, just to see what would happen. (The system crashed.) If
I were designing a product to compete with Replit, I certainly
wouldn’t have picked an architecture that could only scale to
toy-project size.</li>
<li>Replit’s core value proposition isn’t letting you run code online
(you can do this in dozens of places for free), it’s the features
they offer on top of running code. Riju categorically lacked all of
these features, including: having a user account, saving your work,
sharing your work, publishing webapps, persistent workspaces,
discussion forums, integration with GitHub, etc. etc.</li>
<li>I had no bad intentions towards Replit when developing Riju, and
wasn’t trying to hide anything. As proof of these claims, I offer
the fact that I had the project public on my GitHub from the
beginning, and the fact that Replit found out about the project
because I openly shared it with them of my own volition, extending
an offer for them to take inspiration from my work.</li>
<li>Riju was never intended to be a product, it was intended to be a
personal playground / art piece. As proof of this claim, I offer the
fact that I spent dozens of hours adding languages like
<a href="https://esolangs.org/wiki/Hexagony">Hexagony</a> and
<a href="https://www.snobol4.org/">SNOBOL</a> rather making it so you could
save your work(!).</li>
</ul>
<p>I’m not a business person. I’m just an open-source dev who likes to
build weird things for fun. (If you doubt my track record of building
things that don’t make money, just check out <a href="https://intuitiveexplanations.com/about/projects">the list on my
website</a>, and note the conspicuous absence of
anything that’s ever made a cent of revenue.)</p>
<p>I would never try to steal someone’s business after I worked with
them. Hurting Replit was not my intent in working on Riju, and to
accuse me otherwise—especially without asking a single clarifying
question, and refusing all offers to have a discussion—shows a great
deal of bad faith on the part of Replit, in my opinion.</p>
<p>If you’d like to decide for yourself who is in the right, I’m happy to
put all of the evidence out in the open (except the code, because
Replit’s standing by its promise to sue me if I do). Again, I have <a href="https://intuitiveexplanations.com/tech/replit/evidence">a
separate post</a> with all the technical details. And you can
also read all communications between me and Replit, in full and
unabridged form, <a href="https://imgur.com/a/OaEOwu2">on Imgur</a>, mirrored <a href="https://web.archive.org/web/20210530184721/https://imgur.com/a/OaEOwu2">on
the Internet
Archive</a>).
(Technical details about Replit internals redacted, as well as any
statement that could reveal such details indirectly.)</p>
<h2 id="why-would-replit-do-this" tabindex="-1">Why would Replit do this?</h2>
<p>Replit’s stated ideals include:</p>
<ul>
<li>encouraging open-source development (e.g. <a href="https://github.com/replit">open-sourcing parts of
their technology</a>, <a href="https://web.archive.org/web/20210522215545/https://blog.replit.com/github">adding GitHub support
to
Replit</a>;
Replit’s CEO: <a href="https://web.archive.org/web/20210108083314/https://amasad.me/github">“I owe my entire career to
open-source”</a>)</li>
<li>giving back to the community (from <a href="https://web.archive.org/web/20210504051428/https://blog.replit.com/upm">the blog post Replit asked me to
write</a>:
“we are migrating […] to do our part in improving the ecosystem
for developers everywhere”; “Giving back to the community. The core
of our language-agnostic package management is now open-source on
GitHub”)</li>
<li>making it easy to share and remix your creations (e.g. Replit’s CEO
on learning to program: <a href="https://web.archive.org/web/20210522215545/https://blog.replit.com/github">“I’d download projects related to what I
wanted to build […] change &amp; tinker with them, and get
inspired”</a>;
he advises others to
<a href="https://web.archive.org/web/20210522212135/https://twitter.com/amasad/status/1395074521804148738">fork</a>
and
<a href="https://web.archive.org/web/20210211025614/https://twitter.com/amasad/status/1359697571011125253">remix</a>
too, and sells this philosophy as <a href="https://web.archive.org/web/20210522212034/https://twitter.com/amasad/status/1392517080017108992">a differentiating feature of
Replit</a>)</li>
</ul>
<p>However, Replit’s actions in this case reveal hypocrisy:</p>
<ul>
<li>they say they encourage open-source development, but when my
open-source project offended them, they shut it down with extreme
prejudice</li>
<li>they claim to be giving back to the community through their
open-source and blog posts, but when I tried to use those ideas in a
community project, they threatened to sue me</li>
<li>they say they make it easy to share and remix your creations—but
when I tried to remix Replit itself, I became a <em>persona non grata</em></li>
</ul>
<p>In Replit’s emails to me, their threats were based on the fact that I
had worked for them in the past. However, I believe this reasoning is
a smokescreen. To see why, let’s take a look at some tweets that
Replit’s CEO, Amjad, posted just after threatening me by email:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-tweet-1.png" alt="Screenshot of
Amjad's deleted tweet calling for 'copycats' to be banned from venture
capital" width="75%"></center>
<center><img src="https://intuitiveexplanations.com/assets/replit-tweet-2.png" alt="Screenshot of
Amjad's deleted tweet denigrating 'copycats'" width="60%"></center>
<p>Amjad later deleted these tweets because <a href="https://web.archive.org/web/20210505050939/https://twitter.com/amasad/status/1377604981549752320">they proved
controversial</a>:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-tweet-3.png" alt="Screenshot of
Amjad's tweet explaining that they deleted their previous,
controversial tweets" width="60%"></center>
<p>In these tweets, Amjad points out that Athens Research was clearly
inspired by another company, and argues that they should therefore be
“ridiculed” and banned from receiving funding. Furthermore, he says:
“I stand by what I said about copycats in general”, i.e. he disdains
all people that he thinks are “copying” existing ones, not just the
specific company in his tweet.</p>
<p>There is a clear resemblance between Amjad’s comments on Athens
Research and his legal threats towards my own project. He even used
exactly the same word, “copycat”, in both. In the case of Athens
Research, there was nothing Amjad could do to express his disdain
besides denigrate them on Twitter. But in my case, since I had worked
for Replit before, Amjad had an excuse to throw accusations my
way—accusations that, if you aren’t familiar with the facts, sound
like they could be legitimate.</p>
<p>I’d also like to reiterate that the person Replit is threatening with
“top lawyers” and “a lot of money” is a <em>new grad</em> with <em>no company</em>,
<em>no funding</em>, and <em>no commercial ambitions</em>. If someone with an actual
commercial enterprise were to offend Replit, I shudder to think what
treatment <em>they</em> might receive.</p>
<p>
Radon Rosborough, June 2021
</p>
<h2 id="how-did-replit-respond-to-this-blog-post" tabindex="-1">How did Replit respond to this blog post?</h2>
<p>After I posted the article in the morning, it was <a href="https://news.ycombinator.com/item?id=27424195">discussed
extensively on Hacker
News</a>. Around 5pm,
Amjad posted an apology on Hacker News, <a href="https://news.ycombinator.com/item?id=27429234">which has also been
discussed</a>.</p>
<center><img src="https://intuitiveexplanations.com/assets/amjad-hn-1.png" alt="Screenshot of an
email from Amjad apologizing for making legal threats, and my reply
indicating I would like to have a call" width="70%"></center>
<p>He also reached out to schedule a call, which I naturally agreed to:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-8.png" alt="Screenshot of an
email from Amjad promising that he will not sue me, and my response
thanking him and clarifying a point about how he quoted me" width="100%"></center>
<p>During the call, Amjad apologized for making legal threats, but
reiterated that he felt I had made a clone of Replit and that I had
acted unethically. Eventually we agreed to disagree, and he promised
in writing that he was fine with my putting my project back up:</p>
<center><img src="https://intuitiveexplanations.com/assets/replit-email-9.png" alt="Screenshot of
Amjad's comment on HackerNews saying that he apologizes for making
legal threats, but still feels I acted unethically" width="100%"></center>
<p>In retrospect, I’m a little disappointed that Amjad:</p>
<ul>
<li>didn’t apologize for (or mention) <a href="https://web.archive.org/web/20210608153700/https://twitter.com/amasad/status/1401957368510906369">publicly doubling
down</a>
on his decision to threaten me, and didn’t post an update to that
thread after the phone call</li>
<li>didn’t apologize for (or mention) <a href="https://web.archive.org/web/20210607231029/https://twitter.com/amasad">publicly
retweeting</a>
an accusation that I “literally stole and published IP”, although he
did at least delete the retweet</li>
<li>didn’t apologize for (or mention) making a <a href="#replit-email-5">nebulous personal
attack</a> in writing that I was a “demanding intern”
right after <a href="#replit-email-2">trying to hire me</a></li>
<li>said in the phone call, right after “apologizing”, that he felt as
if he had invited me into his house and I had betrayed his trust</li>
<li>still refused to list any specific part of Replit he thought I had
copied, even when I asked him for such details multiple times during
the phone call, despite his continuing to claim both privately and
publicly that I copied Replit unethically</li>
<li>misquoted me in writing to make me look like I agreed with his
accusations, right after reaching out to apologize for his behavior</li>
</ul>
<p>All in all, I think this could have gone better.</p>
<p>Nonetheless, I’m happy that we were able to get the situation worked
out amicably, and I look forward to moving on with my life—including
putting Riju back up, after I can get things compiling again :)</p>
<p>Peace.</p>
<h2 id="so-is-riju-back-up-now" tabindex="-1">So is Riju back up now?</h2>
<p>Yes! Check it out at <a href="https://riju.codes/">https://riju.codes/</a>, and join the community on
GitHub at <a href="https://github.com/raxod502/riju">https://github.com/raxod502/riju</a>. I’d love to work on the
project with you &lt;3</p>
<p>(Please note that Riju is only available on IPv6-enabled networks due
to the higher financial cost of supporting legacy protocols. If your
network <a href="https://test-ipv6.com/">does not support IPv6</a> then please
consider asking your network administrator or service provider to do
their part in supporting modern internet standards. You can consider
accessing Riju through a VPN as a workaround.)</p>
<p><em>Mandatory legal notice:</em> This blog post is maintained by <a href="https://radian.codes/">Radian
LLC</a>.</p>
</div>
</article>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[South Pole Water Infrastructure (188 pts)]]></title>
            <link>https://brr.fyi/posts/south-pole-water-infrastructure</link>
            <guid>40615530</guid>
            <pubDate>Sat, 08 Jun 2024 05:41:43 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://brr.fyi/posts/south-pole-water-infrastructure">https://brr.fyi/posts/south-pole-water-infrastructure</a>, See on <a href="https://news.ycombinator.com/item?id=40615530">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        <article aria-label="Post">
          <div>
            <p><em>Hello infrastructure enthusiasts! I had a lot of fun back in August 2023 talking about
                <a href="https://brr.fyi/posts/south-pole-electrical-infrastructure">South Pole Electrical Infrastructure</a>. Since then,
                several people have asked me to detail other infrastructure systems.</em></p>
            <p><em>I started this post while I was
                still at Pole, but I only finally got around to finishing it. Better late than never – enjoy!</em></p>
            <hr>
            <h2 id="overview">Overview</h2>
            <p>This post will focus on how we produce fresh water and how we dispose
              of wastewater at the South Pole.</p>
            <p>The majority of the world’s population lives in coastal regions, and researchers in Antarctica are no exception.</p>
            <p>Most Antarctic research stations sit on or near the coast.
              Coastal stations are easier to operate, because
              the ocean provides a moderating effect on the climate, access to ship-based transportation,
              a water source, and a mechanism to dispose of (hopefully treated!) wastewater.</p>
            <p>In addition, many of the interesting scientific sites are located near the coast. The majority of human
              activity in Antarctica is for scientific research purposes, so it makes sense to situate these stations nearby
              the sites that they are designed to help study.</p>
            <p>In fact, there are only three year-round stations that are <strong><em>not</em></strong> located on the coast. Here’s a
              decent map of major Antarctic research facilities, from
              <a href="https://www.comnap.aq/antarctic-facilities-information">COMNAP</a>
              (The Council of Managers of National Antarctic Programs). Yellow dots are year-round facilities, red dots
              are summer-only facilities.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/antarctic-facilities-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/antarctic-facilities-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/antarctic-facilities-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/antarctic-facilities-01-small.jpg" alt="Antarctic Facilities 01">
                </picture>
                <em>Major research facilities in Antarctica. Map courtesy of COMNAP.</em>
              </a>
            </p>
            <p>This is not an exhaustive map. I’m aware of stations that are not shown here.
              This is a decent estimation showing the general pattern of human activity in Antarctica. If your station
              isn’t shown here, please do not get mad at me. Take it up with CONMAP.</p>
            <p>The South Pole is one of those three inland yellow dots, far from the coast.
              We’re located high up on an inland plateau, about 975 miles South of McMurdo Station. (Of course, we are,
              by definition, South of <em>literally everywhere</em>.)</p>
            <p>Remember, McMurdo is the United States’ main coastal logistics hub for Antarctic research, and it’s where I
              spent the first 4 months after my <a href="https://brr.fyi/posts/mcmurdo-arrival">arrival on-continent</a>.</p>
            <p>In this post, I’ll quickly review McMurdo’s water infrastructure, before moving on to discuss water infrastructure
              at the South Pole.</p>
            <ul>
              <li><a href="#mcmurdo-freshwater-infrastructure">McMurdo Freshwater Infrastructure</a></li>
              <li><a href="#mcmurdo-wastewater-infrastructure">McMurdo Wastewater Infrastructure</a></li>
              <li><a href="#south-pole-freshwater-infrastructure">South Pole Freshwater Infrastructure</a>
                <ul>
                  <li><a href="#supply">Supply</a></li>
                  <li><a href="#treatment">Treatment</a></li>
                  <li><a href="#distribution">Distribution</a></li>
                  <li><a href="#fixtures">Fixtures</a></li>
                </ul>
              </li>
              <li><a href="#south-pole-wastewater-infrastructure">South Pole Wastewater Infrastructure</a></li>
              <li><a href="#conclusion">Conclusion</a></li>
            </ul>
            <h2 id="mcmurdo-freshwater-infrastructure">McMurdo Freshwater Infrastructure</h2>
            <p>In order to appreciate the unique challenges of water management infrastructure at the inland South Pole
              Station, it’s worth taking some time first to understand water infrastructure at McMurdo, right on the coast.</p>
            <p>As a coastal station, McMurdo has year-round access to liquid seawater, right at the bottom of the hill,
              at the edge of town.
              Sometimes it’s buried under ice, but there’s always liquid water available below that, even in the middle
              of winter when the air temperature is a brisk -30°F.</p>
            <p>McMurdo brings in raw seawater using a series of pumps. The raw seawater intake infrastructure is located
              in building 179, the Seawater Intake Facility:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-02-small.jpg" alt="McMurdo Seawater Intake 02">
                </picture>
                <em>McMurdo seawater intake facility, up close.</em>
              </a>
            </p>
            <p>The seawater is pumped up a series of insulated pipes:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-seawater-intake-01-small.jpg" alt="McMurdo Seawater Intake 01">
                </picture>
                <em>McMurdo seawater intake, from afar.</em>
              </a>
            </p>
            <p>To safely transport water without it freezing in the pipes, we use thick, insulated pipes, with integrated
              heat trace cabling. Heat trace cabling is just controlled, high-resistance wiring that runs the length
              of the pipe. When electricity is passed through the wire, it heats up.
              The heat is trapped by the thick insulation, and it keeps the water in the pipe from freezing.
              This allows us to safely use above-ground pipes in -30°F weather:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-01-small.jpg" alt="Insulated Pipe 01">
                </picture>
                <em>Cross-section of an abandoned insulated pipe, showing the thick insulation and heat trace cabling.</em>
              </a>
            </p>
            <p>Seawater is used for two purposes in McMurdo. The first use of seawater is for the salt water aquarium in
              Crary Lab:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-01-small.jpg" alt="McMurdo Aquarium 01">
                </picture>
                <em>McMurdo aquarium, showing some of the seawater circulation infrastructure.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-aquarium-02-small.jpg" alt="McMurdo Aquarium 02">
                </picture>
                <em>Weird lil' guys hanging out in the McMurdo aquarium, part of one of the science projects here.</em>
              </a>
            </p>
            <p>The second use for seawater, is, of course, to produce potable (“domestic”) water for station operations.</p>
            <p>At McMurdo, seawater passes through several major steps. I’ll be brief here, because the real focus of this
              post is the South Pole. All of this processing takes place at the McMurdo water treatment plant:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-water-plant-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-water-plant-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-water-plant-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-water-plant-01-small.jpg" alt="McMurdo Water Plant 01">
                </picture>
                <em>McMurdo water plant.</em>
              </a>
            </p>
            <p>The first step is heating. Liquid seawater enters the plant at about 28°F. Since the water is salty, it remains
              liquid at a lower temperature than fresh water. Before we can remove the salt, we have to heat it. We use
              waste heat from the power plant to heat the water to about 37°F.</p>
            <p>The second step is filtering. Raw seawater can contain sediment, which must be removed prior to further
              treatment.</p>
            <p>The third step is desalination. McMurdo uses a reverse osmosis system for this. In short – the seawater
              is pressurized, then forced through a fine membrane. This process allows only pure water through. Salt,
              along with several other naturally-occurring minerals, are left behind. These are returned to the sea.</p>
            <p>The fourth step is “polishing”. Pure water, straight out of the reverse osmosis system, isn’t actually
              desirable. It can cause issues with distribution piping, and it is less than ideal for human consumption
              due to both aesthetic (taste) and nutritional reasons. Polishing involves the use of chemicals to adjust
              the hardness and pH levels, for optimal distribution. A small amount of chlorine is also added, which helps
              mitigate the negative effects of any contamination in the storage and distribution system.</p>
            <p>Finally, the water is sent to storage and distribution! McMurdo stores hundreds of thousands of gallons of
              treated water, ready
              for distribution. Remember, peak summer population can exceed 1,000 people. Water is also used for
              firefighting, so a significant amount of storage is required.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-bathroom-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-bathroom-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-bathroom-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-bathroom-01-small.jpg" alt="McMurdo Bathroom 01" width="75%">
                </picture>
                <em>A genuine McMurdo bathroom, with running water!</em>
              </a>
            </p>
            <h2 id="mcmurdo-wastewater-infrastructure">McMurdo Wastewater Infrastructure</h2>
            <p>Lucky you! I wrote a whole post about this last year, back in October 2022.</p>
            <p>Check it out <a href="https://brr.fyi/posts/wastewater-plant">here</a>.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-wastewater-plant-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-wastewater-plant-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-wastewater-plant-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/mcmurdo-wastewater-plant-01-small.jpg" alt="McMurdo Wastewater Plant 01">
                </picture>
                <em>The McMurdo wastewater treatment plant.</em>
              </a>
            </p>
            <p>That’s McMurdo! It’s not that weird. Cold, but not too cold. Take raw seawater, keep it from freezing,
              purify it, distribute it, use it. Take the wastewater, treat it, release it. Again, not that weird.</p>
            <p>Now – let’s talk about water at the South Pole.</p>
            <h2 id="south-pole-freshwater-infrastructure">South Pole Freshwater Infrastructure</h2>
            <p>At the South Pole, there is no liquid water source available. Pole is hundreds of miles from
              the coast, high up on an inland plateau, and it’s absurdly cold.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/nothingness-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/nothingness-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/nothingness-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/nothingness-01-small.jpg" alt="Nothingness 01">
                </picture>
                <em>Vast, cold, barren nothingness, and no liquid water in sight.</em>
              </a>
            </p>
            <p>Luckily – that plateau is made up of several thousand feet
              of snow! It’s a lot of work, but we can melt this snow and produce potable water.</p>
            <p>This is no small feat of engineering, and the
              underlying physics means it’s an energy-intensive process. The deep-down snow at the South Pole is around -60°F.
              It takes 2.44 watt-hours (8.33 BTUs) of heat input to raise the temperature of 1 gallon of water by 1°F.
              Heating the equivalent of 1 gallon of water from -60°F to a reasonable liquid distribution temperature (50°F)
              means heating it up by a whopping <strong>110°F</strong>. That’s 268 watt-hours of raw energy
              required just to bring a single gallon of water up to distribution temperature!</p>
            <p>This is one of the reasons we’re restricted to <a href="https://brr.fyi/posts/showering-at-the-south-pole">two-minute showers</a>.</p>
            <h2 id="supply">Supply</h2>
            <p>Water at the South Pole begins with a “Rodwell”, short for “Rodriguez Well”. The original design for
              the Rodwell comes from an engineer named Raul Rodriguez, who designed it for a camp in Greenland.</p>
            <p>The Rodwell is located below the Rodwell support building, which is located several hundred feet
              away from station. By “The Rodwell”, I should clarify that
              I’m referring to the <strong>current</strong> Rodwell. As I’ll discuss later, these don’t last forever. We’re on
              what is now officially called “Rodwell 3”. We’ve had more Rodwells than that in the history of the
              South Pole, but the naming convention began when Rodwell location planning was standardized. We have
              locations already planned out for several more Rodwells.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-01-small.jpg" alt="Rodwell Building Exterior 01">
                </picture>
                <em>The exterior of our Rodwell support building.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-exterior-02-small.jpg" alt="Rodwell Building Exterior 02">
                </picture>
                <em>Close-up of the door to our Rodwell support building, showing the herculean task to keep it
                  clear from snow.</em>
              </a>
            </p>
            <p>The basic operation of a Rodwell is straightforward. You drill a hole in the snow.
              You start pumping hot water into the hole. The hot water melts the snow, which pushes outward and forms
              an underground lake. You can pump liquid water out of the lake! As long as you keep adding heat, by
              recirculating hot water down into the hole, you can keep expanding the lake and keep pumping water
              out of it.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-diagram-01.png">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-diagram-01.png" type="image/png">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-diagram-01.png" alt="Rodwell Diagram 01" width="50%">
                </picture>
                <em>Diagram of the first experimental South Pole Rodwell from 1972.
                  Diagram Credit: SouthPoleStation.com</em>
              </a>
            </p>
            <p>Inside the support building is all the equipment we need to manage the Rodwell. The building is heated,
              and it contains control and monitoring equipment.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-02-small.jpg" alt="Rodwell Building Inside 02">
                </picture>
                <em>Interior of the Rodwell support building, looking at the infrastructure above the well.</em>
              </a>
            </p>
            <p>The well itself goes down several hundred feet. There’s two water lines, one for the water we pump out,
              and another for the hot water we recirculate down. There is also electrical wiring for the submerged pump,
              and signal wiring for sensors and control circuitry.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-01-small.jpg" alt="Rodwell Well 01">
                </picture>
                <em>The Rodwell itself! Below these blankets is a hatch. Below this hatch is a hole.
                  The hole goes down hundreds of feet into the snow, to our current Rodwell.
                  We keep it insulated, to avoid undesirable heat transfer in and out.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-well-02-small.jpg" alt="Rodwell Well 02">
                </picture>
                <em>The Rodwell itself, without the insulating blankets. We don't open the hatch very often -- only
                  when we're doing maintenance tasks. This mitigates the risk of dropping items or contaminants inside.</em>
              </a>
            </p>
            <p>Normally, water is pumped out of the Rodwell, and then pumped hundreds of feet toward station, to the main water
              treatment plant. Some of the water
              is taken for station use. The rest of the water passes through a series of heat exchangers in the water plant,
              before it is then pumped
              back to the Rodwell. This heated, recirculated water is used to keep the underground lake serviceable.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-supply-water-temperature-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-supply-water-temperature-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-supply-water-temperature-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-supply-water-temperature-01-small.jpg" alt="Rodwell Supply Water Temperature 01">
                </picture>
                <em>Temperature of the raw water we pump out of the Rodwell, about 36°F.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-return-water-temperature-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-return-water-temperature-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-return-water-temperature-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-return-water-temperature-01-small.jpg" alt="Rodwell Return Water Temperature 01">
                </picture>
                <em>Temperature of the heated water we recirculate back into the Rodwell to maintain and expand it, about 84°F.</em>
              </a>
            </p>
            <p>Since the Rodwell is located several hundred feet from the water plant, we need backup systems
              to ensure that there is <em>always</em> a hot water supply to the Rodwell, even if something happened to the return
              piping between the water plant and Rodwell.</p>
            <p>For resiliency, the Rodwell support building itself has backup boilers and heat exchangers.
              It’s essential that we <em>never</em> lose
              the recirculated hot water loop down into the Rodwell, else we risk damaging it.
              Constant heat input to the system is a critical requirement for its continued operation.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-inside-01-small.jpg" alt="Rodwell Building Inside 01">
                </picture>
                <em>Boilers, to provide onsite heat for the backup Rodwell circulation heating infrastructure.
                  Used to maintain the Rodwell in the
                  event we cannot provide hot recirculated water from the power/water plant.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-glycol-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-glycol-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-glycol-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-building-glycol-01-small.jpg" alt="Rodwell Building Glycol 01">
                </picture>
                <em>Glycol heat infrastructure in the Rodwell support building.</em>
              </a>
            </p>
            <p>We use each Rodwell for several years. Once it gets too big (we’re talking <em>millions</em> of gallons),
              we stop pumping fresh water out of it, and
              we start over with a new one in a new location.
              The old one gets converted to be used for wastewater disposal – more on
              that part later.</p>
            <p>Much more fascinating historical documentation about Rodwells can be found
              on Bill Spindler’s <a href="https://www.southpolestation.com/trivia/rodwell/rodwell.html">South Pole Station</a>
              website.</p>
            <p>As discussed above, once water is pumped out of the Rodwell,
              it exits the Rodwell support building, and it enters into the ice tunnels below.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-into-ice-tunnel-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-into-ice-tunnel-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-into-ice-tunnel-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/rodwell-into-ice-tunnel-01-small.jpg" alt="Rodwell Into Ice Tunnel 01">
                </picture>
                <em>Rodwell water pipes, passing through the floor of the Rodwell support building,
                  into the ice tunnels.</em>
              </a>
            </p>
            <p>The water then travels through pipes in the ice tunnels, en route to the main water plant. The ice tunnels are a
              network of subterranean utility corridors, carved directly out of the hard-packed snow. These tunnels sit
              deep below the station and its outbuildings.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-water-pipes-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-water-pipes-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-water-pipes-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-water-pipes-01-small.jpg" alt="Ice Tunnel Water Pipes 01">
                </picture>
                <em>Transporting water through the ice tunnels. Note the electrical infrastructure here -- that's
                  powering the heat trace cabling that runs within the insulation for these water pipes.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-01-small.jpg" alt="Ice Tunnel Emergency Egress 01">
                </picture>
                <em>Emergency egress fom the ice tunnels.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-emergency-egress-02-small.jpg" alt="Ice Tunnel Emergency Egress 02">
                </picture>
                <em>Emergency egress signage.</em>
              </a>
            </p>
            <h2 id="treatment">Treatment</h2>
            <p>The water pipes exit the ice tunnels and enter the main water plant.</p>
            <p>The water plant is located adjacent to the power plant, in the arches, at the bottom of the <a href="https://brr.fyi/posts/beer-can">beer can</a>.
              This means we can
              easily use a glycol loop carrying generator waste heat, from the power plant next door, to power these
              heat exchangers.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/well-water-supply-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/well-water-supply-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/well-water-supply-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/well-water-supply-01-small.jpg" alt="Well Water Supply 01">
                </picture>
                <em>Rodwell supply and return lines entering the water plant.</em>
              </a>
            </p>
            <p>When the water enters the treatment plant, it first passes through a series of limestone contactors. Limestone
              contactors are used to increase the pH of the water by adding minerals. This improves corrosion resistance
              and makes the water suitable for human consumption. Contactors can be brought online or taken offline as needed,
              depending on the amount of treatment needed to achieve desired target outcomes.</p>
            <p>Note that <strong>all</strong> water passes through the contactors, even water that will be recirculated back to the Rodwell.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-01-small.jpg" alt="Treatment Contactors 01">
                </picture>
                <em>Limestone contactors, for pH stabilization.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/treatment-contactors-02-small.jpg" alt="Treatment Contactors 02">
                </picture>
                <em>Another view of the limestone treatment contactors.</em>
              </a>
            </p>
            <p>After the limestone contactors, the majority of the water is sent toward heat exchangers, which are used to heat up
              the water that will be sent back to the Rodwell. The Rodwell circulation loop uses the majority of the water that
              is pumped out of the Rodwell. Only a small portion is diverted for domestic use.</p>
            <p>The water is about 36°F when it is pumped out of
              the Rodwell, and it reaches about 42°F after it makes it all the way to the water plant and through the
              limestone contactors.</p>
            <p>Domestic water does not receive any direct supplemental heating further along in the process. Additional heat gains
              are due to ambient heat absorption from the water treatment plant, or due to heating along the insulated, heat-traced
              piping.</p>
            <p>Rodwell recirculation water, on the other hand, needs
              to be heated quite a bit, up to about 84°F. Remember, this water is pumped back
              down into the Rodwell, to maintain and expand the underground lake.</p>
            <p>Here you can see the heat exchanger infrastructure. Hot glycol is pumped in from the power plant next door.
              The heat exchangers place the hot glycol loop and water loop in close proximity, separated only by
              small layers of thermally-conductive metal. This allows for the efficient transfer of heat without the
              contents actually touching.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/water-plant-heat-exchangers-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/water-plant-heat-exchangers-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/water-plant-heat-exchangers-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/water-plant-heat-exchangers-01-small.jpg" alt="Water Plant Heat Exchangers 01">
                </picture>
                <em>Heat exchangers, which heat up the water that will be returned back to the Rodwell.</em>
              </a>
            </p>
            <p>The heat exchangers heat up the water to about 84°F. This heated water is sent back to the Rodwell building,
              where it is pumped back down into the Rodwell.</p>
            <p>The remaining portion of the water is destined for domestic use. It receives additional treatment.</p>
            <p>First, the water passes through a series of sediment and carbon filters:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/filters-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/filters-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/filters-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/filters-01-small.jpg" alt="Filters 01">
                </picture>
                <em>Sediment and carbon filters in the water plant.</em>
              </a>
            </p>
            <p>Next, sodium carbonate (soda ash) is used for additional fine-grained pH control:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-02-small.jpg" alt="Chemical Tank 02">
                </picture>
                <em>Sodium Carbonate storage tank.</em>
              </a>
            </p>
            <p>Finally, chlorine (calcium hypochlorite) is used as a disinfectant:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/chemical-tank-01-small.jpg" alt="Chemical Tank 01">
                </picture>
                <em>Chlorine storage tank.</em>
              </a>
            </p>
            <p>Once the domestic water has passed through all of these treatment steps, it is stored in bulk,
              unpressurized tanks. There are two tanks, so one can be taken offline for maintenance. The tanks
              are several thousand gallons, and they provide a storage buffer to guard against scheduled or unscheduled
              interruptions in the Rodwell supply or treatment process.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/bulk-storage-tank-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/bulk-storage-tank-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/bulk-storage-tank-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/bulk-storage-tank-01-small.jpg" alt="Bulk Storage Tank 01" width="75%">
                </picture>
                <em>Bulk storage tank for treated water.</em>
              </a>
            </p>
            <p>A treated water sample point is provided, to allow for scheduled checks of water quality, just prior to the water
              being pressurized for domestic supply:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/treated-water-sample-point-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/treated-water-sample-point-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/treated-water-sample-point-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/treated-water-sample-point-01-small.jpg" alt="Treated Water Sample Point 01">
                </picture>
                <em>Treated water sample point, at the outflow from our bulk treated water storage tanks, just
                  before the domestic water pumps.</em>
              </a>
            </p>
            <p>Water quality is checked at several points throughout the treatment and distribution process.
              A lab table contains a variety of tools used for these measurements:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/lab-table-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/lab-table-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/lab-table-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/lab-table-01-small.jpg" alt="Lab Table 01">
                </picture>
                <em>Lab table in the South Pole water plant.</em>
              </a>
            </p>
            <h2 id="distribution">Distribution</h2>
            <p>The final step in the domestic water treatment process is to
              pressurize and store enough water to provide a reliable domestic supply:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pumps-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pumps-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pumps-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pumps-01-small.jpg" alt="Domestic Pumps 01">
                </picture>
                <em>Pumps, which bring the treated water up to an appropriate distribution pressure for the station.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pressurized-tank-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pressurized-tank-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pressurized-tank-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/domestic-pressurized-tank-01-small.jpg" alt="Domestic Pressurized Tank 01">
                </picture>
                <em>The pressurized water distribution tank, which stores water for station use.</em>
              </a>
            </p>
            <p>Domestic water for the main elevated station must be carried from the tank here, up the beer can, and into
              the station. This is a vertical gain of about 50 feet, which must be factored into the pressure setpoint
              for the distribution system. These pipes are insulated, because the beer can is not heated.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/insulated-pipe-02-small.jpg" alt="Insulated Pipe 02">
                </picture>
                <em>Insulated pipe, carrying domestic water up from the water plant, through the Beer Can,
                  to the Elevated Station.</em>
              </a>
            </p>
            <p>The pipes exit the beer can and enter the elevated station, into the subfloor. The subfloor is a sort of crawl space
              located just below the 1st floor.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/station-entrance-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/station-entrance-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/station-entrance-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/station-entrance-01-small.jpg" alt="Station Entrance 01">
                </picture>
                <em>Water lines entering the Elevated Station, from the Beer Can. Red lights are indicators for the heat
                  trace cabling along these water lines.</em>
              </a>
            </p>
            <p>The elevated station contains one additional, pressurized tank at station level, for fire suppression.
              We have automatic fire sprinklers installed throughout the elevated station. Here you can see
              the large, pressurized fire suppression water tank:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/fire-tank-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/fire-tank-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/fire-tank-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/fire-tank-01-small.jpg" alt="Fire Tank 01">
                </picture>
                <em>Pressurized tank within the elevated station, serving the automatic fire sprinkler system.</em>
              </a>
            </p>
            <p>Other than that, the water is used to serve fixtures throughout the station,
              just like you’d expect in a normal building!</p>
            <h2 id="fixtures">Fixtures</h2>
            <p>The kitchen is one of the larger water consumers. Here you can see our dish pit. Winter staff take turns
              washing dishes, according to a posted schedule:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/dish-pit-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/dish-pit-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/dish-pit-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/dish-pit-01-small.jpg" alt="Dish Pit 01">
                </picture>
                <em>The South Pole dish pit.</em>
              </a>
            </p>
            <p>Here is an important permanently-installed water appliance – our espresso machine. This machine was critical
              to my morale during the long winter:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/espresso-machine-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/espresso-machine-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/espresso-machine-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/espresso-machine-01-small.jpg" alt="Espresso Machine 01">
                </picture>
                <em>The South Pole espresso machine.</em>
              </a>
            </p>
            <p>Laundry works much the same as it does back home.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/laundry-room-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/laundry-room-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/laundry-room-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/laundry-room-01-small.jpg" alt="Laundry Room 01">
                </picture>
                <em>The South Pole laundry room!</em>
              </a>
            </p>
            <p>Most of the washers are only connected to cold water, as an energy saving strategy. A few lucky (and coveted)
              machines have both a hot and cold water connection:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/washer-connections-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/washer-connections-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/washer-connections-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/washer-connections-01-small.jpg" alt="Washer Connections 01">
                </picture>
                <em>Washing machine connections.</em>
              </a>
            </p>
            <p>The only major difference in the laundry room is that our clothes dryers
              have direct glycol heat exchangers, instead of using electrical resistance heating:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/dryer-connections-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/dryer-connections-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/dryer-connections-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/dryer-connections-01-small.jpg" alt="Dryer Connections 01">
                </picture>
                <em>Dryer connections, showing the integration with the building's glycol heating loop.</em>
              </a>
            </p>
            <p>Moving on – this is one of the South Pole bathrooms!
              We participate in weekly “house mouse” cleaning tasks – this week, it was my team’s turn to clean. Other cleaning
              tasks include mopping the halls, vacuuming carpeted spaces, and shoveling snow from outside station entrances.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-01-small.jpg" alt="Bathroom 01">
                </picture>
                <em>Bathroom inside the Elevated Station.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/bathroom-02-small.jpg" alt="Bathroom 02">
                </picture>
                <em>Another view of a bathroom inside the Elevated Station.</em>
              </a>
            </p>
            <p>Finally, completing our tour of domestic water fixtures, we have a genuine South Pole drinking fountain:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/drinking-fountain-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/drinking-fountain-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/drinking-fountain-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/drinking-fountain-01-small.jpg" alt="Drinking Fountain 01">
                </picture>
                <em>A standard South Pole drinking fountain inside the Elevated Station.</em>
              </a>
            </p>
            <p>It’s an Elkay EZS8SF with the LK1110 glass filler add-on – an all-around solid choice for commercial
              drinking fountains.</p>
            <p>And that pretty much covers the freshwater infrastructure at Pole!</p>
            <h2 id="south-pole-wastewater-infrastructure">South Pole Wastewater Infrastructure</h2>
            <p>Wastewater at Pole is handled <strong><em>much</em></strong> differently from wastewater at McMurdo!</p>
            <p>As a reminder, from my
              <a href="https://brr.fyi/posts/wastewater-plant">McMurdo Wastewater Plant</a> post, wastewater at McMurdo goes through
              a full wastewater treatment process. Treated wastewater is discharged into the ocean, and solids are processed
              and sent back to the United States for disposal.</p>
            <p>At Pole, we use the old, spent Rodwells for storing wastewater. When a Rodwell has reached its
              maximum size, we stop drawing fresh water from it, and we convert it into wastewater storage. From then on,
              it is known as the “sewage outfall”.</p>
            <p>Raw sewage and other wastewater flows into the current sewage outfall via a network of sewage pipes. The
              wastewater is stored underground indefinitely. No treatment is performed on this wastewater before it is
              sent underground. There are millions of gallons of raw, untreated wastewater stored in outfalls beneath
              South Pole Station.</p>
            <p>As of this writing (June 2024), a wastewater treatment plant is not currently planned or budgeted
              for South Pole Station, although one has been discussed at various points throughout
              the history of South Pole Station. A wastewater treatment plant does appear as a recommendation in the
              <a href="https://www.nsf.gov/geo/opp/documents/SPSMP_Fed%20Reg%20Draft_NSF.pdf">South Pole Station Master Plan Draft 2024</a>
              (<strong>32 MB PDF</strong>) document on the NSF website.</p>
            <p>Disposing of raw sewage by injecting it beneath the ice is permitted under the
              <a href="https://www.ats.aq/e/waste.html">Antarctic Treaty System</a>,
              which is codified in US law under <a href="https://www.ecfr.gov/current/title-45/part-671#p-671.12(f)">45 CFR § 671.12(f)</a>.</p>
            <p>As I stated in my post about <a href="https://brr.fyi/posts/south-pole-electrical-infrastructure">South Pole Electrical Infrastructure</a>,
              it is my sincere hope that we continue working, with urgency, to reduce the environmental footprint of US Antarctic
              research.</p>
            <p>Wastewater from the elevated station flows from domestic drains and collects in holding pits. There are two main
              holding pits in the elevated station.</p>
            <p>The purpose of these is twofold: First, these pits provide a temporary storage buffer, allowing
              use of plumbing fixtures within the station during periods of maintenance on the discharge piping or
              sewer outfall.</p>
            <p>Second, wastewater can be collected in these pits until they are full, and then the wastewater can be
              force discharged at a high flow rate.
              Discharging at a high flow rate allows for efficient and more complete carrying of suspended solids. If waste
              were discharged all the way to the sewer outfall at the rate it was produced, the system would suffer from
              blockages caused by solids that settled out in transit.</p>
            <p>The first pit, for the “B” pod, is also co-located with our emergency water purification
              infrastructure, inside the Emergency Power Plant (EPP).
              This is part of the “lifeboat”, a wing of the station with redundant infrastructure that could
              function on its own in case the rest of the station were compromised.</p>
            <p>Here you can see the wastewater holding pit, as well as some of the emergency water purification equipment.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-02-small.jpg" alt="Wastewater Pit 02">
                </picture>
                <em>Wastewater holding pit, inside the Elevated Station B2 mechanical room. Plus emergency water purification.</em>
              </a>
            </p>
            <p>This wastewater pit collects all wastewater via gravity from the “B” pod.
              It normally discharges to the main sewage/wastewater outfall. However, in the event that this
              was compromised, it can also discharge to a much smaller emergency outfall. This ensures continuity of
              wastewater disposal in the event of an issue with the primary wastewater outfall.</p>
            <p>The emergency water purification infrastructure here can produce potable, domestic water by melting snow. A
              portable snowmelter can be set up just outside, with heat provided by a glycol loop.</p>
            <p>Up next is the “A” pod wastewater pit. This one is located inside a large mechanical room on the 1st floor
              of the “A” pod. Wastewater collects here via gravity from all fixtures in the “A” pod. It also discharges
              to the main outfall.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/wastewater-pit-01-small.jpg" alt="Wastewater Pit 01">
                </picture>
                <em>Wastewater holding pit, inside the Elevated Station A2 mechanical room.</em>
              </a>
            </p>
            <p>Once the pits are full, they automatically discharge to the sewer outfall. This follows roughly the same
              path as the domestic water supply piping. The pipes exit the station, go down the beer can,
              and travel through the ice tunnels, until they reach the current sewer outfall.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/force-main-discharge-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/force-main-discharge-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/force-main-discharge-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/force-main-discharge-01-small.jpg" alt="Force Main Discharge 01">
                </picture>
                <em>Insulated sewage discharge pipe, through the Beer Can.</em>
              </a>
            </p>
            <p>Here you can see the piping entering the ice tunnels, off of the corridor at the base of the beer can:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-entrance-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-entrance-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-entrance-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/ice-tunnel-entrance-01-small.jpg" alt="Ice Tunnel Entrance 01">
                </picture>
                <em>Primary ice tunnel entrance, at the base of the beer can.</em>
              </a>
            </p>
            <p>Deep inside the ice tunnels, here is the current sewer outfall, showing the insulated pipes.
              This is the discharge point for all of South Pole Station’s wastewater, until we move to Rodwell 4 for
              freshwater, at which point Rodwell 3 will become the new sewer outfall.</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-01-small.jpg" alt="Sewer Outfall 01">
                </picture>
                <em>The sewer outfall, inside the ice tunnels.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-02-small.jpg" alt="Sewer Outfall 02">
                </picture>
                <em>Close-up of the sewer outfall.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-heat-trace-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-heat-trace-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-heat-trace-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/sewer-outfall-heat-trace-01-small.jpg" alt="Sewer Outfall Heat Trace 01">
                </picture>
                <em>Heat trace module for the final (vertical) leg of the sewer outfall.
                  Sewage must be protected from freezing until it discharges into the sewer outfall.</em>
              </a>
            </p>
            <p>Of course, not every building is connected to the plumbing system. In fact, at South Pole, only the elevated
              station and the power plant arch have running water and wastewater connections. The outbuildings (IceCube,
              MAPO, DSL, ARO, etc) are too far away, and so far it hasn’t been cost-effective to connect them.</p>
            <p>For folks working outside away from station, there are a variety of options.</p>
            <p>During the summer, when the population is high, we have porta-potties strategically located
              around campus:</p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-01.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-01-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-01-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-01-small.jpg" alt="Porta Potty 01">
                </picture>
                <em>A seasonal porta-potty, outside in the backyard, for people working away from station.
                  No heat, no running water, no electricity. However, it is engineered to
                  maximize passive solar gain, so it stays surprisingly warm.</em>
              </a>
            </p>
            <p>
              <a href="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-02.jpg">
                <picture>
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-02-small.webp" type="image/webp">
                  <source srcset="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-02-small.jpg" type="image/jpg">
                  <img src="https://brr.fyi/media/south-pole-water-infrastructure/porta-potty-02-small.jpg" alt="Porta Potty 02">
                </picture>
                <em>Inside the porta-potty.</em>
              </a>
            </p>
            <p>Without a permanent sewer connection, waste from porta-potties must eventually be carried back to station once
              the porta-potties fill up.</p>
            <p>Permanent outbuildings also often have an established solution for handling human waste from workers.
              These solutions range from simple buckets, to permanently-installed dry toilets with
              removable storage bins.</p>
            <p>For work that takes you away from station, without access to toilet facilities, many personnel also carry
              portable bottles. These are a formal item, provided by USAP, and marked for their intended use.
              They are 32oz “HDPE” Nalgene bottles.</p>
            <p>You can obtain one at the beginning of your season,
              and it’s your responsibility to return it, thoroughly cleaned and sanitized, before you depart. These are often used
              by personnel who travel to deep field locations, but they are also helpful for any situation where you
              may find yourself away from permanent facilities.</p>
            <h2 id="conclusion">Conclusion</h2>
            <p>And there you have it – a brief tour of South Pole water and wastewater infrastructure!</p>
            <p>Much like <a href="https://brr.fyi/posts/south-pole-electrical-infrastructure">South Pole Electrical Infrastructure</a>, the
              infrastructure that makes all this possible is generally hidden from view. From an average user’s perspective,
              living and working in the elevated station, everything functions pretty much the way you’d expect it to.</p>
            <p>When you’re washing dishes in a windowless, heated room,
              and you turn on the faucet to fill the sink, it’s easy to forget
              all the work going on behind the scenes to make all this happen.</p>
            <p>But venture out to the Rodwell in the middle of winter, when it’s negative 100°F, and you’ll quickly
              be reminded of the forces we’re up against.</p>
            <p>From cold, to wind, to relentlessly accumulating snow, to the
              long, long supply chains for engineering expertise and spare parts, it’s a challenge to make things
              work at Pole. Our water and wastewater systems are critical infrastructure that enable
              humans to live at the bottom of the world.</p>
            <hr>
            <p><em>Thank you everyone, again, for your patience! I wrote most of this post last winter while I was at Pole, and I
                appreciate all the words of support from folks who liked my past writing.</em></p>
            <p><em>I hope everyone enjoyed reading this as much as I enjoyed writing it!</em></p>
          </div>
        </article>
      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Chebyshev approximation and how it can help (2012) (115 pts)]]></title>
            <link>https://www.EmbeddedRelated.com/showarticle/152.php</link>
            <guid>40614338</guid>
            <pubDate>Sat, 08 Jun 2024 00:37:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.EmbeddedRelated.com/showarticle/152.php">https://www.EmbeddedRelated.com/showarticle/152.php</a>, See on <a href="https://news.ycombinator.com/item?id=40614338">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="blogarticle"><p>Well... maybe that's a stretch. I don't think I can recommend anything to help you win friends. Not my forte.
</p>
<p>But I am going to try to convince you why you should know about Chebyshev approximation, which is a technique for figuring out how you can come as close as possible to computing the result of a mathematical function, with a minimal amount of design effort and CPU power. Let's explore two use cases:
</p>
<ul>
	<li>Amy has a low-power 8-bit microcontroller and needs to compute \( \sqrt{x} \) (square root) to get an accurate estimate of RMS power dissipated in a current sense resistor. She's finding that the math library implementation for <code>sqrt()</code> takes a lot of CPU time, and she's short on free program memory space, and is wondering if there is another way to compute square roots that takes less time and program memory.</li>
	<li>Bill is designing a sulfur dioxide (SO<sub>2</sub>) detector, with a sensor that outputs a voltage dependent on SO<sub>2</sub> gas concentration, and a microcontroller that converts that voltage to a reading of SO<sub>2</sub> concentration so it can be displayed. He's not greatly concerned about CPU time limitations, but somehow he has to figure out how to convert gas sensor voltage to a concentration, because the sensor is fairly nonlinear.</li>
</ul>
<p>In Amy's case, she has a known function that seems difficult to compute. In Bill's case, he has an unknown function that he has to figure out how to model. These are both cases of function evaluation with two very different priorities. Both are on embedded systems, which brings me to the Central Hypothesis of Mathematical Computation on Embedded Systems (CHoMCoES? It needs a better name, and I don't feel like calling it the Sachs Hypothesis):
</p>
<blockquote><strong><em>The only embedded systems that require precision floating-point computations are desktop calculators.</em></strong>
</blockquote>
<p>Let that sink in for a minute. Your computer is a wonderful thing. It can calculate pi to hundreds of decimal places in milliseconds, or model the airflow patterns around jet engine blades. The origins of the computer have been consistently centered around mathematical computation, with a huge surge of development around the end of the Second World War and through the early days of solid-state transistors. If you needed a computer in the 1940's and 1950's, it was for some precise mathematical calculation. Computers were very expensive to own and operate; if you needed a quick estimate of some math, there were slide rules. This was also the era where whole books were published containing tables of engineering functions, so that if you needed to calculate Bessel functions to 5 decimal places, you could do it by looking it up in a table.
</p>
<p>The desktop computer uses a calculation strategy of "full machine precision": for a given bit representation, there is only one correct answer to sin(x), and it is the bit pattern that is the one yields the smallest error from the exact mathematical calculation. Someone has written and tested mathematical software libraries that do this, and from there on out, it's just a function call.
</p>
<p>Embedded systems, on the other hand, tend to contain inexpensive processors that are doing things with analog-to-digital-converter measurements. You can do math to the full 53 bits of IEEE-754 double-precision, but if your ADC readings, or the signal conditioning that precedes them, are only accurate to 0.1% (10 bits), then mathematical errors will be dwarfed by the errors of signal conditioning.
</p>
<p>When you have a system that can tolerate mathematical errors, and has computing resource limitations driven by cost, all of a sudden the priority of mathematical computing changes. Now we have to decide what we really need when we want to compute something.
</p>
<p>Let's take Amy's problem first: <u>we need to compute a square root</u>.
</p>
<p>That statement is only an overview of what is needed. There are two major decisions that need to be made up front:
</p>
<ul>
	<li>over what <em>range</em> of x does \( \sqrt{x} \) need to be computed?</li>
	<li>what kind of <em>accuracy</em> does \( \sqrt{x} \) need? (and how does it vary with x?)</li>
</ul>
<p>General full-machine precision math libraries have easy answers to these questions: any input needs to be tolerated, and for each input there is one correct output, even if the correct output is an error (e.g. \( \sqrt{x} \) for negative inputs in systems that don't use complex numbers).
</p>
<p>In the embedded system, the accuracy and range requirements are judgement calls.
</p>
<p>Accuracy is an easy thing to understand: there are algorithms that take shortcuts to computing an expression, and the more inaccuracy can be tolerated, the more shortcuts can be taken.
</p>
<p>The range requirement is a bit more subtle. Obviously you have to support the expected range of inputs to an algorithm, and maybe you want to leave some engineering margin. But why would it be more expensive to calculate \( \sqrt{x} \) over a larger range? If I were to tell you that I was much more concerned about the range of a computation than the accuracy, would you believe me?
</p>
<p>Let's use a real example. Amy thinks she needs \( \sqrt{u} \) calculated over the range \( u \in [0.2, 5.0] \). Her first instinct is to go find her calculus textbook and look up Taylor Series:
</p>
<h2>How not to evaluate functions, part 1: Taylor Series</h2>
<p>Here is the Taylor series for \( \sqrt{1+x} \):&nbsp;&nbsp;&nbsp; (equation courtesy of <a href="https://en.wikipedia.org/wiki/Square_root#Properties">Wikipedia</a>)
</p>
<p><img src="https://upload.wikimedia.org/math/7/1/3/713b1394e1acaa9a5bf87163060a363a.png" alt="" loading="lazy">
</p>
<p>But there's a little footnote saying this only works for x between -1 and 1, meaning it won't work to calculate \( \sqrt{2} \) or the square root of anything 2 or larger. For \( \sqrt{5} \), she has to use a trick, namely that \( \sqrt{5} \) = \( 2\times\sqrt{5/4} \). So she decides to limit the actual input range of the Taylor series to cover the range of \( \sqrt{1+x} \) for \( x \in [-0.8,+0.25] \), and if \( u = 1+x &gt; 1.25 \) then Amy will do the divide-by-4 trick: (we'll use Python here; assume that Amy does something equivalent in C)
</p>
<pre>def sqrt1(x):
# returns sqrt(1+x) for x between -0.8 and +0.25
   return 1 + x/2 - x*x/8 + x*x*x/16
def sqrtapprox(u):
# valid for x between 0.2 to 5.0
   if (u &gt;= 1.25):
      return sqrt1(u/4-1)*2
   else:
      return sqrt1(u-1)
</pre>
<p>Is this good enough? Hmm, let's think about this. We want to know the error between a function and its approximation(s). Let's graph that error. Here's a quick Python function that uses numpy and matplotlib to plot the results:
</p>
<pre>import numpy as np
import matplotlib.pyplot as plt
def showplots(f,approxlist,a,b):
    x = np.linspace(a,b,1000)
    plt.figure(1)
    plt.subplot(211)
    plt.plot(x,f(x))
    vfuncs = [np.vectorize(approx) for approx in approxlist]
    for vf in vfuncs:
        plt.plot(x,vf(x))
    plt.xlim(a,b)
    plt.ylabel('f(x) and approximations fa(x)')
    plt.subplot(212)
    for vf in vfuncs:
        plt.plot(x,f(x)-vf(x))
    plt.xlim(a,b)
    plt.ylabel('error = f(x)-fa(x)')
    plt.xlabel('x')
    plt.show()
</pre>
<p>The results of <code>showplots(np.sqrt,[sqrtapprox],0.2,5.0)</code> will show us the error between the full-machine-precision <code>sqrt()</code> and our approximation:
</p>
<p><img src="https://farm9.staticflickr.com/8455/8036626075_8e89c772c9_o.png" alt="" width="646" height="486" loading="lazy">
</p>
<p>Yuck. A worst-case error of 0.038. Let's try some more terms in the Taylor series. That means we have to figure out how the coefficients work. A little pencil and paper algebra shows the coefficients starting from the quadratic term are
$$\begin{eqnarray}
a_2 &amp;=&amp; -\frac{1}{4\times 2} = -\frac{1}{8}, \cr
a_3 &amp;=&amp; +\frac{3\times 1}{6\times 4\times 2} = \frac{1}{16}, \cr
a_4 &amp;=&amp; -\frac{5\times 3\times 1}{8\times 6\times 4\times 2} = \frac{5}{128}, \cr
a_5 &amp;=&amp; +\frac{7\times 5\times 3\times 1}{10\times 8\times 6\times 4\times 2} = \frac{7}{256}, \cr
a_6 &amp;=&amp; -\frac{9\times 7\times 5\times 3\times 1}{12\times 10\times 8\times 6\times 4\times 2} = -\frac{21}{1024}
\end{eqnarray}$$
and so on, so we try again:
</p>
<pre>def sqrt1a(x):
# returns sqrt(1+x) for x between -0.8 and +0.25
   return 1 + x/2 - x*x/8 + x*x*x/16 - 5.0/128*x*x*x*x
def sqrtapproxa(u):
# valid for x between 0.2 to 5.0
   if (u &gt;= 1.25):
      return sqrt1a(u/4-1)*2
   else:
      return sqrt1a(u-1)
def sqrt1b(x):
# returns sqrt(1+x) for x between -0.8 and +0.25
   return 1 + x/2 - x*x/8 + x*x*x/16 - 5.0/128*x*x*x*x + 7.0/256*x*x*x*x*x
def sqrtapproxb(u):
# valid for x between 0.2 to 5.0
   if (u &gt;= 1.25):
      return sqrt1b(u/4-1)*2
   else:
      return sqrt1b(u-1)
</pre>
<p>Here are the results for sqrtapproxa (a 4th-degree Taylor series):
</p>
<p><img src="https://farm9.staticflickr.com/8321/8036705497_4b00538472_o.png" alt="" width="645" height="485" loading="lazy">
</p>
<p>And here are the results for sqrtapproxb (a 5th-degree Taylor series):
</p>
<p><img src="https://farm9.staticflickr.com/8317/8036705411_f8933b440d_o.png" alt="" width="644" height="484" loading="lazy">
</p>
<p>Yuck. We added two more terms and we only got the error down to 0.015.
</p>
<p>Here's what you need to learn about Taylor series for function evaluation. (Or rather, read this and whatever you don't understand, just trust me.)
</p>
<p>To get the coefficients of a Taylor series for a function f in a region around a point \( x=x_0 \), you evaluate \( f(x_0) \) and all of the derivatives of \( f(x) \) at \( x=x_0 \). You don't have to look at the function anywhere else; the behavior at \( x=x_0 \) somehow lets you know what  \( f(x) \)  is elsewhere. For some functions (like \( \sqrt{1+x} \) ) the region of convergence is finite; for others like \( \sin x \) or \( e^x \) the region of convergence is everywhere.
</p>
<p>Taylor series work on most everyday functions, because these functions have a property called "analyticity": all of their derivatives exist and are therefore continuous and smooth, and through the magic of mathematics this means that looking at an analytic function only at 1 point will tell you enough information to calculate it in some nearby region.
</p>
<p>Right near \( x=x_0 \), Taylor series are great. The error between the exact function and the first N terms of the corresponding Taylor series will be extremely small around \( x=x_0 \). As you move away from \( x=x_0 \), the error starts to become larger. In general, the more terms you use, the better the approximation will be around \( x=x_0 \), but when the approximation starts to do poorly at the edge of its range, it diverges faster.
</p>
<p>To sum this up:<strong> Taylor series approximations do not distribute the approximation error fairly.</strong> The error is small at \( x=x_0 \), but its error tends to be much larger at the edges of its range.
</p>
<p>Now I'm going to show you two more attempts at approximating \( \sqrt{x} \) for \( x \in [0.2, 5.0] \), but I'm going to wait before explaining how I came up with them.
</p>
<pre>def sqrt1c(x):
# valid for x between 0.2 to 1.25
   coeffs = [0.20569678, -0.94612133, 1.79170646, -1.89014568, 1.66083189, 0.17814197]
   y = 0
   for c in coeffs:
      y = y * x + c
   return y
def sqrtapproxc(u):
# valid for u between 0.2 to 5.0
   if (u &gt;= 1.25):
      return sqrt1c(u/4)*2
   else:
      return sqrt1c(u)
def sqrtapproxd(x):
# valid for x between 0.2 to 5.0
   coeffs = [0.00117581,-0.01915684,0.12329254,-0.41444219,1.04368339, 0.26700714]
   y = 0
   for c in coeffs:
      y = y * x + c
   return y
</pre>
<p>Approximation "c" splits the range between \( [0.2,1.25) \) and \( [1.25,5] \) as before; approximation "d" operates over the entire range \( [0.2,5] \). Both are 5th-degree polynomials. Here is the performance of approximation "c":
</p>
<p><img src="https://farm9.staticflickr.com/8314/8037220800_ca6a139588_o.png" alt="" width="646" height="486" loading="lazy">
</p>
<p>You'll notice a peak error of about 0.00042. This is about 35 times smaller than the error in approximation "b" (the Taylor series version using 5th order polynomials with the same range split).
</p>
<p>Here is the error for approximation "d":
</p>
<p><img src="https://farm9.staticflickr.com/8457/8037172712_cc0165778d_o.png" alt="" width="644" height="484" loading="lazy">
</p>
<p>That's about 0.011 worst case error, which is about 30% smaller than approximation "b". We got better worst-case error, without having to split up the range, with a polynomial of the same degree!
</p>
<p>A few things to note from this exercise:
</p>
<ul>
	<li><strong>Good function approximations have error graphs with a characteristic "wiggle".</strong> Ideally they form a so-called minimax function, where the positive and negative peaks all line up. This spreads the error throughout the range of input argument, and can be orders of magnitude better accuracy than a Taylor series polynomial of the same degree. In practice, it is difficult to achieve the ideal minimax error graph, but there is an easy method that comes close to it, which I'll explain in a bit.</li>
	<li><strong>Range reduction can improve the accuracy of function evaluation significantly.</strong> Approximations "c" and "d" both used 5th degree polynomials, but approximation "d" used the whole input range (a 25:1 ratio of maximum to minimum input), whereas approximation "c" only used a part of the input range (with 6.25:1 ratio of maximum to minimum input), and "c" was 25 times more accurate.</li>
</ul>
<h2>How not to evaluate functions, part 2: lookup tables</h2>
<p>All right, so let's toss out Taylor series. The next approach is a lookup table. The idea is simple: you have an array of precomputed values for your function, and use those as a table to evaluate the function. Let's look at a solution for \( \sqrt{x} \) over the \( [0.2, 5.0] \) range using a lookup table with 32 entries:
</p>
<pre>import math
def maketable0(func, a, b, n):
    table = func([(x+0.5)/n*(b-a)+a for x in range(0,n)])
    def tablefunc(x):
        if x &lt; a or x &gt; b:
            raise "out of range error"
        i = math.floor((x-a)/(b-a)*n)
        if i == n:
            i = n-1
        return table[i]
    return tablefunc
sqrtapproxe = maketable0(np.sqrt, 0.2, 5.0, 32
</pre>
<p>Using a lookup table involves the following process, which is fairly trivial but worth discussing nonetheless:
</p>
<ul>
	<li>At design time (or initialization time), divide the input range of the function into N intervals and evaluate the function within those intervals. (Usually the intervals are equal width and function evaluation is at the midpoint of each interval.)</li>
	<li>At runtime:</li>
	<ul>
		<li>handle out-of-range situations (either throw an error or return a value corresponding to min/max input)</li>
		<li>compute an index of which interval the function is in</li>
		<li>lookup the value in the table at that index</li>
	</ul>
</ul>
<p>Here's what the error of approximation "e" looks like:
</p>
<p><img src="https://farm9.staticflickr.com/8462/8039239534_bec155cf9c_o.png" alt="" width="644" height="484" loading="lazy">
</p>
<p>Note the stairsteppy result and the sawtooth error plot. This is typical for a plain table approach. The maximum error is roughly proportional to the slope of the function within an interval (the error is larger for small values of x where \( \sqrt{x} \) is steeper), and proportional to the interval size. If we want to reduce the error by a factor of 10, we need 10x as many lookup table entries.
</p>
<p>If we want to improve the situation, the next improvement we can use is linear interpolation:
</p>
<ul>
	<li>At design time (or initialization time), divide the input range of the function into N intervals and evaluate the function at the N+1 endpoints of those intervals. (Usually the intervals are equal width)</li>
	<li>At runtime:</li>
	<ul>
		<li>handle out-of-range situations (either throw an error or return a value corresponding to min/max input)</li>
		<li>compute an index k of which interval the function is in</li>
		<li>lookup the value in the table at that index and the next index</li>
		<li>perform a linear interpolation: <code>y = table[k]*(1-u) + table[k+1]*u</code>, where u is the number between 0 and 1 representing the position of the input within the interval (0 = beginning of interval, 1 = end)</li>
	</ul>
</ul>
<pre>import math
def maketable1(func, a, b, n):
    table = func([float(x)/n*(b-a)+a for x in range(0,n+1)])
    def tablefunc(x):
        if x &lt; a or x &gt; b:
            raise "out of range error"
        ii = (x-a)/(b-a)*n
        i = math.floor(ii)
        if i == n:
            i = n-1
        u = ii-i
        return table[i]*(1-u) + table[i+1]*u
    return tablefunc
sqrtapproxf = maketable1(np.sqrt, 0.2, 5.0, 32)
</pre>
<p>Here's the error plot for approximation "f":
</p>
<p><img src="https://farm9.staticflickr.com/8180/8039308346_b417950bee_o.png" alt="" width="646" height="486" loading="lazy">
</p>
<p>Much better — note the error plot containing parabolic sections. This is typical for interpolated table lookup. The maximum error is roughly proportional to the curvature (2nd derivative) of the function within an interval, and proportional to the square of the interval size. If we want to reduce the error by a factor of 10, we only need about 3x as many lookup table entries.
</p>
<p>This is one of the rare cases where table interpolation may be more appropriate than polynomial evaluation: the maximum error here is about 1/2 as much as the 5th-order polynomial we used in approximation "d".
</p>
<p>For a comparison in execution time: table lookup with no interpolation is roughly equivalent to a quadratic (2nd order) function, and table interpolation is roughly equivalent to a quartic (4th order) polynomial. That's only an estimate; it really depends on things like whether you're doing floating-point or fixed-point computation, whether the table has a length that is a power of 2 (it should be, so you can use bitwise operations to speed up the math), and how long it takes to perform table lookups on your processor.
</p>
<p>There are only a few situations, in my opinion, where table lookup is appropriate:
</p>
<ul>
	<li>If accuracy requirements are very low, a non-interpolated table lookup may be sufficient.</li>
	<li>If a function is very "nonpolynomial" then an interpolated table lookup may produce superior accuracy compared to a polynomial evaluation of comparable execution time. (This appears to be the case for \( \sqrt{x} \) over the \( [0.2, 5.0] \) range. We'll define "nonpolynomial" shortly; for now just think of it as a function with a lot of wiggles or twists and turns.)</li>
	<li>If a function is very difficult to approximate with a polynomial over the whole range but needs very high accuracy, one option is to split the range into 4 or 8 subintervals and use table lookup to obtain polynomial coefficients for each subinterval.</li>
</ul>
<p>Table lookup is <em>not</em> appropriate when it requires such a large table size that you have to worry about memory requirements.
</p>
<p>Also note that the error in approximation "f" is not fairly distributed: the maximum error happens at the low end of the input range and is much smaller over the rest of the input range. You can use tricks to make the error distribution more fair, namely by using variable-width intervals, but there's no general process for doing this while still using an efficient computation at runtime.
</p>
<h2>Chebyshev Polynomials</h2>
<p>The key to using polynomials to evaluate functions, is not to think of polynomials of being composed of linear combinations of \( 1, x, x^2, x^3 \), etc., but as linear combinations of <a href="http://en.wikipedia.org/wiki/Chebyshev_polynomials">Chebyshev polynomials</a> \( T_n(x) \). As discussed in more detail in the Wikipedia page, these have the following special properties:
</p>
<ul>
	<li>they are minimax functions over the range \( [-1,1] \), e.g. all their minima/maxima/extrema are at ± 1 (see diagram below)</li>
	<li>they are orthogonal over the range \( [-1,1] \) with weight \( \frac{1}{\sqrt{1-x^2}} \)</li>
	<li>\( T_0(x) = 1, T_1(x) = x, T_{n+1}(x) = 2xT_n(x) - T_{n-1}(x) \)</li>
	<li>\( T_n(x) = \cos(n \cos^{-1} x) \)</li>
</ul>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Chebyshev_Polynomials_of_the_1st_Kind_%28n%3D0-5%2C_x%3D%28-1%2C1%29%29.svg/500px-Chebyshev_Polynomials_of_the_1st_Kind_%28n%3D0-5%2C_x%3D%28-1%2C1%29%29.svg.png" alt="" width="500" height="319" loading="lazy">
</p>
<p>Figure: Chebyshev functions \(T_n(x)\), courtesy of Wikipedia
</p>
<p>Let's say we have a given function \(f(x)\) over the range \( x \in [a,b] \). We can express \( f(x) = \sum c_k T_k(u) \) where \( u = \frac{2x-a-b}{b-a} \) and \( x = \frac{b-a}{2}u + \frac{a+b}{2} \), which is a transformation which maps the interval \( x \in [a,b] \) to \( u \in [-1,1] \). The problem then becomes a matter of figuring out the coefficients \( c_k \), which can be done using the <a href="http://en.wikipedia.org/wiki/Chebyshev_nodes">Chebyshev nodes</a>:
</p>
<p><img src="https://upload.wikimedia.org/math/0/d/2/0d22ecceb745e2394fcc05b228737476.png" alt="" width="288" height="44" loading="lazy">
</p>
<p>These are easier to understand graphically; they are merely the projections onto the x-axis of the midpoints of equal interval circular arcs of a semicircle:
</p>
<p><img src="https://farm9.staticflickr.com/8312/8039569145_1d369d4115_o.png" alt="" width="554" height="306" loading="lazy">
</p>
<p>You will note that the nodes are spaced equally near 0 and more compressed towards ± 1.
</p>
<p>To approximate a function by a linear combination of the first N Chebyshev polynomials (k=0 to N-1), the coefficient \( c_k \) is simply equal to \( A(k) \) times the average of the products \( T_k(u)f(x) \) evaluated at the N Chebyshev nodes, where \( A = 1 \) for \( k = 0 \) and \( A = 2 \) for all other k.
</p>
<p>Let's illustrate the process more clearly with an example.
</p>
<p>Suppose \( f(x) = \frac{1}{3} x^3 + 2x^2 + x - 10 \) over the range \( [-1, 3] \), with \( u = \frac{x-1}{2}, x = 2u+1 \):
</p>
<p><img src="https://farm9.staticflickr.com/8317/8039798545_804ba9a536_o.png" alt="" width="604" height="463" loading="lazy">
</p>
<p>Let's use \( N=5 \). The Chebyshev nodes for N=5 are \( u=-0.951057, -0.587785, 0, +0.587785, +0.951057 \). This corresponds to \( x=-0.902113, -0.175571, 1, 2.175771, 2.902113 \), and the function \( f(x) \) evaluated at those nodes are \( y=-9.51921, -10.11572, -6.66667, 5.07419, 17.89408 \).
</p>
<p>For \( c_0 \) we compute the average value of y = \( (-9.51921-10.11572-6.66667+5.07419+17.89408)/5 = -0.66667 \).
</p>
<p>For \( c_1 \) we compute 2 × the average value of u × y = \( 2\times(-9.51921\times-0.951057+-10.11572\times-0.587785\) \(+-6.66667\times 0+5.07419\times 0.587785+17.89408\times 0.951057) = 14 \)
</p>
<p>For \( c_2 \) we compute 2 × the average value of \( T_2(u)\times y  = (2u^2-1) \times y \: \longrightarrow \: c_2 = 6 \)
</p>
<p>For \( c_3 \) we compute 2 × the average value of \( T_3(u)\times y = (4u^3-3u) \times y \: \longrightarrow \: c_3 = 0.66667\)
</p>
<p>For \( c_4 \) we compute 2 × the average value of \( T_4(u)\times y = (8u^4-8u^2+1) \times y \: \longrightarrow \: c_4 = 0 \)
</p>
<p>The conclusion here is that \( f(x) = -\frac{2}{3}T_0(u) + 14T_1(u) + 6T_2(u) + \frac{2}{3}T_3(u) \) ; if you go and crunch through the algebra you will see that the result is the same as \( f(x) = \frac{1}{3}x^3 + 2x^2 + x - 10 \).
</p>
<p>So what was the point here....? Well, if you <em>already</em> have the coefficients of a polynomial, there's no point in using Chebyshev polynomials. (If the input range is significantly different from \( [1,1] \), a linear transformation from x to u where \( u \in [-1,1] \) will give you a polynomial in u that has better numerical stability, and Chebyshev polynomials are one way to do this transformation. More on this later) If you want to approximate the polynomial with a polynomial of lesser degree, Chebyshev polynomials will give you the best approximation.
</p>
<p>For example let's use a quadratic function to approximate \( f(x) \) over the input range in question. All we need to do is truncate the Chebyshev coefficients: let's compute $$\begin{eqnarray} f_2(x) &amp;=&amp; -\frac{2}{3}T_0(u) + 14T_1(u) + 6T_2(u) \cr
&amp;=&amp; -\frac{2}{3} + 14u + 6\times(2u^2-1) \cr
&amp;=&amp; -\frac{20}{3} + 14u +12u^2 \cr
&amp;=&amp; -\frac{20}{3} + 7(x-1) + 3(x-1)^2 \cr
&amp;=&amp; 3x^2 + x - \frac{32}{3}.
\end{eqnarray}
$$
</p>
<p><img src="https://farm9.staticflickr.com/8450/8039804078_f816df25e6_o.png" alt="" width="592" height="464" loading="lazy">
</p>
<p>Voila! We have a quadratic function that is close to the original cubic function, and the magnitude of the error is just the coefficient of the Chebyshev polynomial we removed = \( \frac{2}{3} \).
</p>
<p>You will note that these two polynomials (\( \frac{1}{3}x^3 + 2x^2 + x - 10 \) and \( 3x^2 + x - \frac{32}{3} \)), expressed in their normal power series form, have no obvious relation to each other, whereas the Chebyshev coefficients are the same except in coefficient \( c_3 \) which we set to zero to get a quadratic function.
</p>
<p>In my view, this is the primary utility of expressing a function in terms of its Chebyshev coefficients: The coefficient \( c_0 \) tells you the function's average value over the input range; \( c_1 \) tells you the function's "linearness", \( c_2 \) tells you the function's "quadraticness", \( c_3 \) tells you the function's "cubicness", etc.
</p>
<p>Here's a more typical and less trivial example. Suppose we wish to approximate \( \log_2 x \) over the range \( [1,2] \).
</p>
<p>A decomposition into Chebyshev coefficients up to degree 6 yields the following:
</p><p>
$$\begin{eqnarray}
c_0 &amp;=&amp; +0.54311 \cr
c_1 &amp;=&amp; +0.49505\cr
c_2 &amp;=&amp; -0.042469\cr
c_3 &amp;=&amp; +0.0048577\cr
c_4 &amp;=&amp; -6.2508\times 10^{-4}\cr
c_5 &amp;=&amp; +8.5757\times 10^{-5}\cr
c_6 &amp;=&amp; -1.1996\times 10^{-5}\cr
\end{eqnarray}
$$
</p><div><p>You will note that each coefficient is only a fraction of the magnitude of the previous coefficient. This is an indicator that the function in question (over the specified input range) lends itself well to polynomial approximation. If the Chebyshev coefficients don't decrease significantly by the 5th coefficient, I would classify that function as "nonpolynomial" over the range of interest.</p></div>
<p><img src="https://farm9.staticflickr.com/8034/8039920241_07cf9ab551_o.png" alt="" width="645" height="484" loading="lazy">
</p>
<p>The maximum error for the 6th-degree Chebyshev approximation for \( \log_2 x \) over \( x \in [1,2] \) is only about 2.2×10<sup>-6</sup>, which is approximately the value of the next Chebyshev coefficient.
</p>
<p>If we truncate the series to a 4th-degree Chebyshev approximation, we get a maximum error that is about equal to \( c_5 = 8.6×10^{-5} \):
</p>
<p><img src="https://farm9.staticflickr.com/8461/8039920157_9f5c8d706c_o.png" alt="" width="644" height="484" loading="lazy">
</p>
<p>Neat, huh?
</p>
<h2>Some further examples of elementary functions</h2>
<p>Here is a list of common functions, along with the first 6 Chebyshev coefficients:
</p>
<p>
	<table>
	<tbody>
	<tr>
		<td>\( f(x) \)
		</td>
		<td>range
		</td>
		<td>c<sub>0</sub>
		</td>
		<td>c<sub>1</sub>
		</td>
		<td>c<sub>2</sub>
		</td>
		<td>c<sub>3</sub>
		</td>
		<td>c<sub>4</sub>
		</td>
		<td>c<sub>5</sub>
		</td>
	</tr>
	<tr>
		<td>\( \sin \pi x \)
		</td>
		<td>[-0.5,0.5]
		</td>
		<td>0
		</td>
		<td>1.1336
		</td>
		<td>0
		</td>
		<td>-0.13807
		</td>
		<td>0
		</td>
		<td>0.0045584
		</td>
	</tr>
	<tr>
		<td>\( \sin \pi x \)
		</td>
		<td>[-0.25,0.25]
		</td>
		<td>0
		</td>
		<td>0.72638
		</td>
		<td>0
		</td>
		<td>-0.01942
		</td>
		<td>0
		</td>
		<td>0.00015225
		</td>
	</tr>
	<tr>
		<td>\( \cos \pi x \)
		</td>
		<td>[-0.5,0.5]
		</td>
		<td>0.472
		</td>
		<td>0
		</td>
		<td>-0.4994
		</td>
		<td>0
		</td>
		<td>0.027985
		</td>
		<td>0
		</td>
	</tr>
	<tr>
		<td>\( \cos \pi x \)
		</td>
		<td>[-0.25,0.25]
		</td>
		<td>0.85163
		</td>
		<td>0
		</td>
		<td>-0.14644
		</td>
		<td>0
		</td>
		<td>0.0019214
		</td>
		<td>0
		</td>
	</tr>
	<tr>
		<td>\( \sqrt{x} \)
		</td>
		<td>[1,4]
		</td>
		<td>1.542
		</td>
		<td>0.49296
		</td>
		<td>-0.040488
		</td>
		<td>0.0066968
		</td>
		<td>-0.0013836
		</td>
		<td>0.00030211
		</td>
	</tr>
	<tr>
		<td>\( \log_2 x \)
		</td>
		<td>[1,2]
		</td>
		<td>0.54311
		</td>
		<td>0.49505
		</td>
		<td>-0.042469
		</td>
		<td>0.0048576
		</td>
		<td>-0.00062481
		</td>
		<td>8.3994e-05
		</td>
	</tr>
	<tr>
		<td>\( e^x \)
		</td>
		<td>[0,1]
		</td>
		<td>1.7534
		</td>
		<td>0.85039
		</td>
		<td>0.10521
		</td>
		<td>0.0087221
		</td>
		<td>0.00054344
		</td>
		<td>2.7075e-05
		</td>
	</tr>
	<tr>
		<td>\( \frac{2}{\pi}\tan^{-1} x \)
		</td>
		<td>[-1,1]
		</td>
		<td>0
		</td>
		<td>0.5274
		</td>
		<td>0
		</td>
		<td>-0.030213
		</td>
		<td>0
		</td>
		<td>0.0034855
		</td>
	</tr>
	<tr>
		<td>\( \frac{1}{1 + e^{-x}} \)
		</td>
		<td>[-1,1]
		</td>
		<td>0.5
		</td>
		<td>0.23557
		</td>
		<td>0
		</td>
		<td>-0.0046202
		</td>
		<td>0
		</td>
		<td>0.00011249
		</td>
	</tr>
	<tr>
		<td>\( \frac{1}{1 + e^{-x}} \)
		</td>
		<td>[-3,3]
		</td>
		<td>0.5
		</td>
		<td>0.50547
		</td>
		<td>0
		</td>
		<td>-0.061348
		</td>
		<td>0
		</td>
		<td>0.01109
		</td>
	</tr>
	<tr>
		<td>\( \frac{1}{1 + x^2} \)
		</td>
		<td>[-1,1]
		</td>
		<td>0.70707
		</td>
		<td>0
		</td>
		<td>-0.24242
		</td>
		<td>0
		</td>
		<td>0.040404
		</td>
		<td>0
		</td>
	</tr>
	<tr>
		<td>\( \frac{1}{1 + x^2} \)
		</td>
		<td>[-3,3]
		</td>
		<td>0.30404
		</td>
		<td>0
		</td>
		<td>-0.29876
		</td>
		<td>0
		</td>
		<td>0.12222
		</td>
		<td>0
		</td>
	</tr>
	</tbody>
	</table>
</p>
<h2>Other comments</h2>
<p>A great reference for Chebyshev functions is <a href="http://www.nr.com/">Numerical Recipes</a> by Press, Teukolsky, Vetterling, and Flannery, which covers Chebyshev approximation in detail.
</p>
<p>There are a few things to note when evaluating Chebyshev functions:
</p>
<ul>
	<li>It's better to compute the functions directly rather than trying to convert Chebyshev approximations to a standard polynomial form. (that is, if you want to calculate \( 3T_0(x) + 5T_1(x) - 0.1T_2(x) \) , don't convert to a polynomial, but instead calculate the T values directly.) Numerical Recipes recommends Clenshaw's recurrence formula, but I just use the following simple algorithm:</li>
</ul>
<pre>u = (2*x-a-b)/(b-a)
Tprev = 1
T = u
y = c[0]
for i = 1:n
&nbsp;&nbsp;&nbsp;&nbsp;y=y+T*c[i]
   Tnext = 2*u*T - Tprev
   Tprev = T
   T = Tnext
</pre>
<ul>
	<li>Remember to convert from x to u — this keeps the numerical stability of the algorithm, because polynomials tend to be well-conditioned for evaluating arguments between -1 and 1, and ill-conditioned for arguments with very large or very small magnitudes.</li>
</ul>
<p>Here is a Python class for computing and applying Chebyshev coefficients:
</p>
<pre>import math
import numpy as np
def chebspace(npts):
    t = (np.array(range(0,npts)) + 0.5) / npts
    return -np.cos(t*math.pi)
def chebmat(u, N):
    T = np.column_stack((np.ones(len(u)), u))
    for n in range(2,N+1):
        Tnext = 2*u*T[:,n-1] - T[:,n-2]
        T = np.column_stack((T,Tnext))
    return T
class Cheby(object):
    def __init__(self, a, b, *coeffs):
        self.c = (a+b)/2.0
        self.m = (b-a)/2.0
        self.coeffs = np.array(coeffs, ndmin=1)
    def rangestart(self):
        return self.c-self.m
    def rangeend(self):
        return self.c+self.m
    def range(self):
        return (self.rangestart(), self.rangeend())
    def degree(self):
        return len(self.coeffs)-1
    def truncate(self, n):
        return Cheby(self.rangestart(), self.rangeend(), *self.coeffs[0:n+1])
    def asTaylor(self, x0=0, m0=1.0):
        n = self.degree()+1
        Tprev = np.zeros(n)
        T     = np.zeros(n)
        Tprev[0] = 1
        T[1]  = 1
        # evaluate y = Chebyshev functions as polynomials in u
        y     = self.coeffs[0] * Tprev
        for co in self.coeffs[1:]:
            y = y + T*co
            xT = np.roll(T, 1)
            xT[0] = 0
            Tnext = 2*xT - Tprev
            Tprev = T
            T = Tnext
        # now evaluate y2 = polynomials in x
        P     = np.zeros(n)
        y2    = np.zeros(n)
        P[0]  = 1
        k0 = -self.c/self.m
        k1 = 1.0/self.m
        k0 = k0 + k1*x0
        k1 = k1/m0
        for yi in y:
            y2 = y2 + P*yi
            Pnext = np.roll(P, 1)*k1
            Pnext[0] = 0
            P = Pnext + k0*P
        return y2
    def __call__(self, x):
        xa = np.array(x, copy=False, ndmin=1)
        u = np.array((xa-self.c)/self.m)
        Tprev = np.ones(len(u))
        y = self.coeffs[0] * Tprev
        if self.degree() &gt; 0:
            y = y + u*self.coeffs[1]
            T = u
        for n in range(2,self.degree()+1):
            Tnext = 2*u*T - Tprev
            Tprev = T
            T = Tnext
            y = y + T*self.coeffs[n]
        return y
    def __repr__(self):
        return "Cheby%s" % (self.range()+tuple(c for c in self.coeffs)).__repr__()
    @staticmethod
    def fit(func, a, b, degree):
        N = degree+1
        u = chebspace(N)
        x = (u*(b-a) + (b+a))/2.0
        y = func(x)
        T = chebmat(u, N=degree)
        c = 2.0/N * np.dot(y,T)
        c[0] = c[0]/2
        return Cheby(a,b,*c)
</pre>
<p>You can put this in a file cheby.py and then use it as follows (here we fit \( \sin x \) between 0 and \( \frac{\pi}{2} \) with a 5th degree polynomial, and compute our approximation on angles 0, \( \frac{\pi}{6} \), \( \frac{\pi}{4} \), and \( \frac{\pi}{3} \)):
</p>
<pre>&gt;&gt;&gt; import cheby
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; import math
&gt;&gt;&gt; c = cheby.Cheby.fit(np.sin,0,math.pi/2,5)
&gt;&gt;&gt; c
Cheby(0.0, 1.5707963267948966, 0.60219470125550711, 0.51362516668030367, -0.10354634422944738, -0.013732035086651754, 0.001358650338492214, 0.00010765948465629727)
&gt;&gt;&gt; c(math.pi*np.array([0, 1.0/6, 1.0/4, 1.0/3]))
array([  6.21628624e-06,   5.00003074e-01,   7.07099696e-01,
         8.66028717e-01])
</pre>
<h2>Function approximation for empirical data</h2>
<p>Let's go back to the beginning of our discussion to Bill's problem. He has a nonlinear sensor relating a physical quantity (gas concentration) to a voltage measurement; the problem he faces is how to invert that relation so that he can estimate the original physical quantity: \( y = f(x) \) where x is the measurement and y is the physical quantity.
</p>
<p>Chebyshev approximation works well here too, but we have a problem. We can't just evaluate \( f(x) \) at Chebyshev nodes to get the Chebyshev coefficients, because we don't know for certain what \( f(x) \) actually is. Instead, we have to make some reference measurements to determine those coefficients, with known physical quantities (e.g. known gas concentrations in Bill's case), and tabulate these x and y values, then use them to estimate the coefficients. We have two choices in selecting the measurements:
</p>
<ul>
	<li>Try to plan the measurements so that the values x lie near the Chebyshev nodes over the expected range. This will allow us to use fewer measurements.</li>
	<li>Make a lot of measurements so the whole input range is well-covered</li>
</ul>
<p>In some situations, it's quick and easy to make measurements with arbitrary references. (For example, if you're trying to calibrate a microphone, you can change the amplitude and frequency of reference sound signals automatically with electronic equipment), and the second option is a viable one. In other situations, like the gas concentration problem, it may be inconvenient or expensive to make lots of measurements, and you have to select the reference values carefully.
</p>
<p>The best way I've found to estimate Chebyshev coefficients from empirical data, is to use <a href="http://en.wikipedia.org/wiki/Linear_least_squares_%28mathematics%29#Weighted_linear_least_squares">weighted least-squares</a>:
</p>
<ul>
	<li>Collect the measurements x and physical input quantity y into vectors X and Y</li>
	<li>For the vector of measurements x, compute u from x, and compute the values of the Chebyshev polynomials \( T_0(u), T_1(u), T_2(u), \ldots T_n(u) \) and save each these as vectors in a matrix T. Each polynomial will be used as a basis function.</li>
	<li>Compute a weighting value \( w(x) \) to compensate for the density of values x. (e.g. if lots of x values are near \( x=0 \) but very few of them are near \( x=1 \), you may have to choose \( w(x) \) low near \( x=0 \) and higher near \( x=1 \) .) Express these values as a diagonal matrix W.</li>
	<li>Compute a vector C of coefficients \( c_0, c_1, c_2, \ldots c_n \) using weighted least-squares to solve for C: <br>
	$$(T^TWT)C = T^TWY.$$
To do this you will need some kind of matrix library. In MATLAB this would be computed as
	<code>C = (T'*diag(W)*T)\(T'*diag(W)*Y)</code>. In Python with Numpy, you can skip calculating the T matrix, and just use the <a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.polynomial.chebyshev.chebfit.html"><code>numpy.polynomial.chebyshev.chebfit</code></a> function on the x and y measurements; the weighting vector is an optional input.</li>
</ul>
<p>I would not use a degree greater than 5. If you find you're still not getting a good approximation with a 5th degree polynomial, you're probably using the wrong approach; the function is too sharp or wiggly or cusped. Higher degree polynomials can have problems with numerical accuracy.
</p>
<p>In any case, function approximation of empirical data is a little trickier than approximation of known functions. <strong>Always</strong> make sure you double-check your approximation by graphing the original data and the function you come up with.
</p>
<h2>Wrapup</h2>
<p>The next time you need to turn to function approximation, give Chebyshev approximation a shot! Not only is it probably the best and easiest way to approximate a function with a polynomial, but it will also let you know how well polynomials approximate the function in question, by the behavior of the Chebyshev coefficients.
</p>
<p>Make sure you choose the required accuracy and input range of your function wisely. Too high of an accuracy and too wide an input range will require higher degrees of polynomials and longer execution times, and high degree polynomials are often numerically ill-conditioned.
</p>
<p>More efficient evaluation of functions will mean you can use less CPU resources for a desired accuracy. So this <em>can</em> save you money and influence your coworkers.
</p>
<p>Happy approximating!
</p>
<hr><p>
© 2012 Jason M. Sachs, all rights reserved.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Apollo 8 astronaut William Anders ID'd in WA plane crash (405 pts)]]></title>
            <link>https://www.fox13seattle.com/news/william-anders-wa-plane-crash</link>
            <guid>40614227</guid>
            <pubDate>Sat, 08 Jun 2024 00:16:35 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.fox13seattle.com/news/william-anders-wa-plane-crash">https://www.fox13seattle.com/news/william-anders-wa-plane-crash</a>, See on <a href="https://news.ycombinator.com/item?id=40614227">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-v-29b1414c="" lastmodifieddate="2024-06-07T18:47:39-07:00" data-v-0e30817a=""> <p><strong data-v-29b1414c="">Published</strong>&nbsp;
      June 7, 2024 3:35pm PDT
    </p>   </div><div data-v-0e30817a=""><div data-v-0e30817a=""><h4>Apollo 8 astronaut William Anders identified as pilot in WA plane crash</h4> </div> <!----><p data-v-0e30817a=""><span><strong>SAN JUAN COUNTY, Wash.</strong> - </span>Retired American astronaut William Anders, who was a member of the Apollo 8 crew, was killed in a <a href="https://www.fox13seattle.com/news/san-juan-islands-plane-crash" target="_self">plane crash just off the San Juan Islands</a> on Friday afternoon.</p> <!----><p data-v-0e30817a="">Anders' son, retired Air Force Lt. Col. Greg Anders, <a href="https://apnews.com/article/plane-crash-san-juan-islands-washington-6d3800130ef4e67d761f96b328f7c263" target="_blank">confirmed the death</a> to The Associated Press.</p>   <p data-v-0e30817a="">The plane that crashed was a vintage Air Force T-34 Mentor, which is owned by Anders, who is also a San Juan County resident.&nbsp;</p> <!----><div data-v-0dea8073="" data-v-0e30817a=""><p><img src="https://images.foxtv.com/static.q13fox.com/www.q13fox.com/content/uploads/2024/06/932/524/GettyImages-949601032.jpg?ve=1&amp;tl=1" alt="American astronaut William Ander" data-v-0dea8073=""></p><p data-v-0dea8073=""><span data-v-0dea8073="">Close-up of American astronaut William Anders, of NASA's Apollo 8 mission, during a panel interview held at the Museum of Science and Industry, Chicago, Illinois, April 5, 2018.</span> <span data-v-0dea8073=""><strong data-v-0dea8073=""> (Photo by J.B. Spector/Museum of Science and Industry, Chicago/Getty Images)</strong></span></p></div> <!----> <!----><p data-v-0e30817a="">Anders was reportedly piloting the plane when it crashed. "The family is devastated," Greg Anders said. "He was a great pilot and we will miss him terribly."</p> <!----><div data-v-0e30817a=""><h4>Video shows fiery small plane crash into WA waters near Orcas Island</h4> <p>Crews responded to a plane crash in the San Juan Islands on Friday afternoon. Officials with the United States Coast Guard Pacific Northwest said the crash happened near Orcas Island before 11:45 a.m.</p></div> <!----><h2 data-v-0e30817a="">Early life of William Anders</h2> <!----><p data-v-0e30817a="">William Anders was born on Oct. 17, 1933, in Hong Kong, but he grew up in San Diego. In 1955, Anders graduated from the United States Naval Academy with a bachelor of science degree, and received his master of science degree in nuclear engineering from the Air Force Institute of Technology in 1962. He completed the Harvard Business School Advanced Management Program in 1979.</p> <!----><h2 data-v-0e30817a="">Recruited by NASA</h2> <!----><p data-v-0e30817a="">In 1964, Anders was selected by the <a href="https://www.fox13seattle.com/news/boeing-starliner-launch-nasa-today" target="_blank">National Aeronautics and Space Administration</a> (NASA) to be an astronaut with responsibilities for dosimetry, radiation effects and environmental control.&nbsp;</p> <!----><p data-v-0e30817a="">He was a backup pilot for the Gemini XI, Apollo 11 flights, and was lunar module pilot for Apollo 8.</p> <!----><h2 data-v-0e30817a="">Apollo 8 mission</h2> <!----><p data-v-0e30817a="">In 1968, Anders operated the Apollo 8 mission alongside Air Force veteran Frank F. Borman II and Navy veteran James A. Lovell, Jr. In total, he logged more than 6,000 hours of flying time.</p> <!----><p data-v-0e30817a="">During this mission, their command module floated above the lunar surface, and the astronauts beamed back images of the moon and Earth and took turns reading from the Book of Genesis, closing with a wish for everyone "on the good Earth."</p> <!----><div data-v-0dea8073="" data-v-0e30817a=""><p><img src="https://images.foxtv.com/static.q13fox.com/www.q13fox.com/content/uploads/2024/06/932/524/GettyImages-170741727.jpg?ve=1&amp;tl=1" alt="" data-v-0dea8073=""></p><div data-v-0dea8073=""><p data-v-0dea8073=""><span data-v-0dea8073="">From L to R, Apollo 8 astronauts spacecraft Commander Frank Borman, Command Module Pilot James Lovell and Lunar Module Pilot William Anders, who became the first humans to escape Earth's gravity and the first humans to see the far side of the Moon, l</span> <!----></p> </div></div> <!----><p data-v-0e30817a="">According to NASA, the mission was also famous for the iconic "Earthrise" image, snapped by Anders, which would give humankind a new perspective on their home planet. Anders has said that despite all the training and preparation for an exploration of the moon, the astronauts ended up discovering Earth.</p> <!----><div data-v-0dea8073="" data-v-0e30817a=""><p><img src="https://images.foxtv.com/static.q13fox.com/www.q13fox.com/content/uploads/2024/06/932/524/AP24159853585088.jpg?ve=1&amp;tl=1" alt="" data-v-0dea8073=""></p><div data-v-0dea8073=""><p data-v-0dea8073=""><span data-v-0dea8073="">FILE - This Dec. 24, 1968, file photo made available by NASA shows the Earth behind the surface of the moon during the Apollo 8 mission. Retired Maj. Gen. William Anders, the former Apollo 8 astronaut who took the iconic "Earthrise" photo showing the </span> <!----></p> </div></div> <!----><h2 data-v-0e30817a="">William Anders' retirement</h2> <!----><p data-v-0e30817a="">In 1988, Anders retired from the Air Force Reserves and became the chairman and CEO of General Dynamics Corporation in 1991. After two years, he retired from General Dynamics and stayed as chairman until 1994.&nbsp;</p> <!----><p data-v-0e30817a="">Anders and his wife Valerie moved to Orcas Island in 1993. They have six children and 13 grandchildren.&nbsp;</p> <!----><div data-v-0dea8073="" data-v-0e30817a=""><p><img src="https://images.foxtv.com/static.q13fox.com/www.q13fox.com/content/uploads/2024/06/932/524/GettyImages-949601050.jpg?ve=1&amp;tl=1" alt="" data-v-0dea8073=""></p><div data-v-0dea8073=""><p data-v-0dea8073=""><span data-v-0dea8073="">Group portrait of, from left, American astronauts William Anders, James Lovell, and Frank Borman, all of whom participated in NASA's Apollo 8 mission, as they pose together at the Museum of Science and Industry, Chicago, Illinois, April 5, 2018. (Pho</span> <!----></p> </div></div> <!----><p data-v-0e30817a="">Shortly after retiring, the couple established the Anders Foundation supporting educational and environmental concerns as a vehicle for supporting several of their interests, including Yosemite National Institute and the Olympic Park Institute.&nbsp;</p> <!----><p data-v-0e30817a="">In 1996, the couple started the Heritage Flight Museum around the P-51 Val-Halla. It has steadily grown ever since and currently resides at Skagit Regional Airport in Burlington. As the museum grew, their two sons found a passion for aviation and joined them in the Puget Sound area to help run the museum.</p> <!----><p data-v-0e30817a=""><i>The Associated Press contributed to this report.</i></p> <!----><h2 data-v-0e30817a="">MORE HEADLINES FROM FOX 13 SEATTLE</h2> <!----><p data-v-0e30817a=""><a href="https://www.fox13seattle.com/news/new-wa-laws-june-6" target="_self"><strong>More than 300 new WA state laws went into effect June 6</strong></a></p> <!----><p data-v-0e30817a=""><a href="https://www.fox13seattle.com/news/parents-bill-of-rights-wa" target="_self"><strong>WA schools superintendent responds to new 'Parents' Bill of Rights'</strong></a></p> <!----><p data-v-0e30817a=""><a href="https://www.fox13seattle.com/news/amanda-knox-italy-slander"><strong>Amanda Knox vows to 'fight for the truth' after slander reconviction in Italy</strong></a></p> <!----><p data-v-0e30817a=""><a href="https://www.fox13seattle.com/news/teen-killed-garfield-high-identified" target="_self"><strong>17-year-old shot, killed at Seattle's Garfield High identified</strong></a></p> <!----><p data-v-0e30817a=""><i><strong>To get the best local news, weather and sports in Seattle for free, sign up for the daily </strong></i><a href="https://www.fox13seattle.com/newsletters" target="_self"><strong>FOX 13 Seattle newsletter</strong></a><i><strong>.</strong></i></p> <!---->  <!----> </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[3dfx Voodoo 4 video card in MXM format (2023) (160 pts)]]></title>
            <link>https://www.vogons.org/viewtopic.php?t=100871</link>
            <guid>40613854</guid>
            <pubDate>Fri, 07 Jun 2024 23:11:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.vogons.org/viewtopic.php?t=100871">https://www.vogons.org/viewtopic.php?t=100871</a>, See on <a href="https://news.ycombinator.com/item?id=40613854">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
								<section aria-labelledby="post-1266405-title" id="p1266405">
								<h3 id="post-1266405-title">First post, by sdz</h3>

						

				

				<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>
							</section>
											<article aria-labelledby="post-1266413-title" id="p1266413">
								<h3 id="post-1266413-title">Reply 1 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>Laptops with MXM slots, want a video card with an MXM BIOS. Obviously, the usual V4 BIOS isn't MXM compatible. Also,  the system BIOS would probably need to be edited to add the VSA ID to the whitelist.  I don't want to mess with the system BIOS, or to attempt to make the VSA BIOS MXM compatible.<br>
This means two things:<br>
1. The laptop will not execute the BIOS on the video card. In the case of the VSA-100 it's not that bad. Many registers can be set with hardware straps, but not all. In this case, two important registers are not set to the value that is needed for such an application, vidInFormat[8] and vidInFormat[22] . Because of this, the digital RGB interface of the VSA will output scrambled Chrontel instead of unscrambled Brooktree format.</p>

<div>


			
					<figure aria-labelledby="a-194000">
				<a href="https://www.vogons.org/download/file.php?id=194000&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_2e6c649758210b7052279db28ef553bb/S7.jpg" alt="S7.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194000" href="https://www.vogons.org/download/file.php?id=194000&amp;mode=view">S7.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">129.63 <abbr role="text presentation" title="kibibytes" aria-label="kibibytes">KiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36375 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<p>And this is how DVI looks with in such a setup (V5 5500 DVI):</p>

<div>


			
					<figure aria-labelledby="a-194001">
				<a href="https://www.vogons.org/download/file.php?id=194001&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_a577bdab0b8f6635d0e590701fc4a8b8/S8.jpg" alt="S8.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194001" href="https://www.vogons.org/download/file.php?id=194001&amp;mode=view">S8.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">28.95 <abbr role="text presentation" title="kibibytes" aria-label="kibibytes">KiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36375 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<div>


			
					<figure aria-labelledby="a-194002">
				<a href="https://www.vogons.org/download/file.php?id=194002&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_7a19265ee2d3738d5d5c7fb0778dcba5/S9.jpg" alt="S9.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194002" href="https://www.vogons.org/download/file.php?id=194002&amp;mode=view">S9.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">42.12 <abbr role="text presentation" title="kibibytes" aria-label="kibibytes">KiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36375 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<p>On the V4 M4800 the usual TMDS encoder was replaced with an FPGA.</p>

<p>2. The laptop will behave as it doesn't have a video card plugged in. Because of this, if it's a laptop with an integrated GPU, it will not toggle the muxes to switch to the video signal coming from the MXM slot.<br>
I intend to use the card in a Dell Precision M4800, which has the LVDS connector close to the MXM slot, so for keeping the solution as much as plug and play possible, I added an LVDS connector on the MXM card. Otherwise, some traces need to be cut on the motherboard. With this also goes backlight control via keyboard, but it may be possible to implement a workaround for this. More on that later.</p>


<p>Another important point is that a laptop screen has a fixed resolution. If the GPU is set to render at a resolution lower than the native resolution of the panel, the GPU will upscale that image so that the panel is always fed with it's native resolution. The VSA-100 will do no such scaling. <br>
Also the panel wants to receive dual channel LVDS/OpenLDI/FPDLIK-I signal. Because of this, the card has a Realtek scaler, that takes the HDMI signal from the FPGA, upscales it if needed, and outputs LVDS to the panel. This is basically what's inside a PC monitor, added on the MXM card.</p></div>
				</div>
							</article>
											<article aria-labelledby="post-1266422-title" id="p1266422">
								<h3 id="post-1266422-title">Reply 2 of 25, by Dothan Burger</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Newbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=50779&amp;sr=posts" title="Search Dothan Burger’s posts">87</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2023-02-21, 16:40</dd>
		</p>
		
									
				
	</dl>

				</div>


					<div>
						
								
	

						
						<p>This project sounds awesome.  It looks like RTX founders edition level of density on the board.</p>

						
						

																								
											</div>
				</div>
							</article>
											<article aria-labelledby="post-1266430-title" id="p1266430">
								<h3 id="post-1266430-title">Reply 3 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>It is a bit crammed, as it's basically a 64MB V4, plus PCIe to PCI bridge, FPGA, the scaler that's usually inside a PC monitor, a microcontroler, power supplies, various flash ICs/EEPROMs etc.  The size of the board is 7x8cm.</p> 

<p>I just finished assembly (I'll wash the board better later).</p>

<p>Here it is next to a standard Voodoo 4:</p>

<div>


			
					<figure aria-labelledby="a-194005">
				<a href="https://www.vogons.org/download/file.php?id=194005&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_fd22bc43890583abccd2c8734e0d717c/S10.jpg" alt="S10.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194005" href="https://www.vogons.org/download/file.php?id=194005&amp;mode=view">S10.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.55 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36321 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<p>More photos:</p>

<div>


			
					<figure aria-labelledby="a-194006">
				<a href="https://www.vogons.org/download/file.php?id=194006&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_99bc2608c60d63530caf45e3a85af92c/S11.jpg" alt="S11.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194006" href="https://www.vogons.org/download/file.php?id=194006&amp;mode=view">S11.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.48 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36321 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<div>


			
					<figure aria-labelledby="a-194007">
				<a href="https://www.vogons.org/download/file.php?id=194007&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_948ddbe725a040fc519fdef53cbcc333/S12.jpg" alt="S12.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194007" href="https://www.vogons.org/download/file.php?id=194007&amp;mode=view">S12.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.75 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36321 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<div>


			
					<figure aria-labelledby="a-194008">
				<a href="https://www.vogons.org/download/file.php?id=194008&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_aa61439235756c4d586c2b5b9eb5edca/S13.jpg" alt="S13.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194008" href="https://www.vogons.org/download/file.php?id=194008&amp;mode=view">S13.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.87 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36321 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<div>


			
					<figure aria-labelledby="a-194009">
				<a href="https://www.vogons.org/download/file.php?id=194009&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_edee7825986e324faff2ba1f919bf667/S14.jpg" alt="S14.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194009" href="https://www.vogons.org/download/file.php?id=194009&amp;mode=view">S14.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.73 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36321 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div></div>
				</div>
							</article>
											<article aria-labelledby="post-1266431-title" id="p1266431">
								<h3 id="post-1266431-title">Reply 4 of 25, by sdz</h3>

						

				

				<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>
							</article>
											<article aria-labelledby="post-1266432-title" id="p1266432">
								<h3 id="post-1266432-title">Reply 5 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>Also made an MXM carrier, so I can bring-up the board in a normal PC:</p>

<div>


			
					<figure aria-labelledby="a-194014">
				<a href="https://www.vogons.org/download/file.php?id=194014&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_3391313052ee72295c87981c1ca4abda/S19.jpg" alt="S19.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194014" href="https://www.vogons.org/download/file.php?id=194014&amp;mode=view">S19.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.4 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36319 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<p>This looks absolutely ridiculous:</p>

<div>


			
					<figure aria-labelledby="a-194015">
				<a href="https://www.vogons.org/download/file.php?id=194015&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_fe52ddefcf2e9066d02381cbe43be7ca/S20.jpg" alt="S20.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194015" href="https://www.vogons.org/download/file.php?id=194015&amp;mode=view">S20.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.91 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36319 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<div>


			
					<figure aria-labelledby="a-194017">
				<a href="https://www.vogons.org/download/file.php?id=194017&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_5634a0c0f6ca34cdec030fbb85ab26c0/S21.jpg" alt="S21.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194017" href="https://www.vogons.org/download/file.php?id=194017&amp;mode=view">S21.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.35 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36310 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<div>


			
					<figure aria-labelledby="a-194018">
				<a href="https://www.vogons.org/download/file.php?id=194018&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_171bdcd4a8872fd50a1b58d749e4a2e0/S22.jpg" alt="S22.jpg"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194018" href="https://www.vogons.org/download/file.php?id=194018&amp;mode=view">S22.jpg</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">1.35 <abbr role="text presentation" title="mebibytes" aria-label="mebibytes">MiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">36310 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div></div>
				</div>
							</article>
											<article aria-labelledby="post-1266445-title" id="p1266445">
								<h3 id="post-1266445-title">Reply 6 of 25, by Dothan Burger</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Newbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=50779&amp;sr=posts" title="Search Dothan Burger’s posts">87</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2023-02-21, 16:40</dd>
		</p>
		
									
				
	</dl>

				</div>


					<div>
						
								
	

						
						<p>That's beautiful!  Are you going to sell these?</p>

						
						

																								
											</div>
				</div>
							</article>
											<article aria-labelledby="post-1266451-title" id="p1266451">
								<h3 id="post-1266451-title">Reply 7 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>Probably not, but I'll opensource the design.</p>

<p>Some good news, the card works <span data-version="6.1" data-src="1f600" data-alt="grinning face">😀</span><br>
Here's it running in a PC, with VGA output:<br>
<a href="https://youtu.be/MKRf2rdHCFA?si=6mj1gPLrcQtiUlNY">https://youtu.be/MKRf2rdHCFA?si=6mj1gPLrcQtiUlNY</a></p>

<p>Next step is getting the HDMI output from the FPGA working. There is a mux on the board, and the HDMI can be routed to the onboard scaler or the MXM connector. This will probably take a while.</p></div>
				</div>
							</article>
											<article aria-labelledby="post-1266515-title" id="p1266515">
								<h3 id="post-1266515-title">Reply 8 of 25, by supercordo</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=44263&amp;sr=posts" title="Search supercordo’s posts">286</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2020-08-09, 06:27</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">Ohio, United States</dd>
			</p>
							
				
	</dl>

				</div>


					<div>
						
								
	

						
						<p>At this point you should just make your own Win98/XP compatible laptop. I would buy it.</p>

						
						

																								
											</div>
				</div>
							</article>
											<article aria-labelledby="post-1266599-title" id="p1266599">
								<h3 id="post-1266599-title">Reply 9 of 25, by DrAnthony</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Newbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=46228&amp;sr=posts" title="Search DrAnthony’s posts">90</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2021-04-16, 22:37</dd>
		</p>
		
									
				
	</dl>

				</div>


					<div>
						
								
	

						
						<p>Well done dude! Looks like you've been really busy in the Voodoo lab lately. I know this has some shortcomings that look like a pretty major hill to climb to be a bit more universal, but do you think some outside of the box thinking might be able to improve things? I'm just spitballing here as I don't really tinker with laptops, but would you be able to integrate this into a little box and use thunderbolt for an external GPU? Or does that run headfirst back into the BIOS issues?</p>

						
						

																								
											</div>
				</div>
							</article>
											<article aria-labelledby="post-1267001-title" id="p1267001">
								<h3 id="post-1267001-title">Reply 10 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>@supercordo<br>
That's actually something that I want to do at some point.</p>

<p>@DrAnthony <br>
Thanks! Pretty busy indeed, another board will arrive in a week or so <span data-version="6.1" data-src="1f600" data-alt="grinning face">😀</span><br>
Using the card via Thunderbolt might actually be OK regarding the BIOS, however:<br>
-last time I wanted to develop a thunderbolt device with Intel's ICs, to get access to the documentation/tools, one would need to describe to Intel what's the application, and get their blessing.<br>
-there would be no way (at least no reasonable way) of getting the image on the laptop's screen. One would need to use an external monitor. At that point it's better just to use a PC.</p>



<p>A couple of updates regarding the V4 M4800:</p>

<p>I got HDMI working through the FPGA:</p>



<p><a href="https://youtu.be/MiMey5aXpYw?si=z9vBNY-1vv89CKvE">https://youtu.be/MiMey5aXpYw?si=z9vBNY-1vv89CKvE</a></p>

<p>The following resolutions (all 60Hz) work fine:</p>

<p>640x480<br>
800x600<br>
960x720<br>
1024x768<br>
1152x864<br>
1280x720<br>
1280x1024<br>
1360x768<br>
1600x900 <br>
1600x1024</p>

<p>1280x960 displays a black screen via HDMI, but it's the same on a V5 5500 DVI card, so it's a driver/VSA issue.</p>

<p>1920x1080 works but there are some timing issues to resolve inside the FPGA. I will work on this later, as 1080p is already problematic.<br>
On a regular V5 5500, with the timings provided by Dolenc here <a href="https://www.vogons.org/viewtopic.php?t=85416">The Changeling 3dfx Voodoo 5 5500</a> , 1080p works only on an Alienware AW3423DWF. I tested with about 5 different other displays, and none work with those timings. First I need to other fix that somehow, or ensure that the scaler accepts those timings. After that, I'll fix the FPGA issue for that resolution.</p>

<p>At the moment, everything works as intended, except the scaler, which is the last part to solve.</p>

<div>


			
					<figure aria-labelledby="a-194208">
				<a href="https://www.vogons.org/download/file.php?id=194208&amp;mode=view"><img src="https://www.vogons.org/thumbs/42546_a1990b59077fd9c6eec526c514a4222c/M4800_DG1.png" alt="M4800_DG1.png"></a>
				<figcaption><dl role="associationlist definitionlist">
	<dt role="associationlistitemkey term">Filename</dt>
	<dd role="associationlistitemvalue definition"><a id="a-194208" href="https://www.vogons.org/download/file.php?id=194208&amp;mode=view">M4800_DG1.png</a></dd>
	<dt role="associationlistitemkey term">File size</dt>
	<dd role="associationlistitemvalue definition">84.82 <abbr role="text presentation" title="kibibytes" aria-label="kibibytes">KiB</abbr></dd>
	<dt role="associationlistitemkey term">Views</dt>
	<dd role="associationlistitemvalue definition">35854 views</dd>
			<dt role="associationlistitemkey term">File license</dt>
	<dd role="associationlistitemvalue definition"><span data-icon="view-license">Public domain</span></dd>
</dl>
</figcaption>
			</figure>
		
		
			</div>

<p>I made this small board with just the scaler, so I can work on this easier:</p>





<p>I ran a couple of benchmarks, 3DMark2001SE, XP SP3, SFFT1.9, default settings, 1024x768, 32bpp, and got the following results:</p>

<p>32MB RAM (2.8V VCORE):<br>
166MHz: 1694<br>
183MHz: 1872<br>
192MHz: 1955</p>

<p>64MB RAM (2.8V VCORE):<br>
192MHz: 2035</p></div>
				</div>
							</article>
											<article aria-labelledby="post-1267084-title" id="p1267084">
								<h3 id="post-1267084-title">Reply 11 of 25, by amadeus777999</h3>

						

				

				<div role="note" aria-label="Poster info">
							
								
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Oldbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=27432&amp;sr=posts" title="Search amadeus777999’s posts">973</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2013-07-04, 17:04</dd>
		</p>
		
									
				
	</dl>

				</div>
							</article>
											<article aria-labelledby="post-1267331-title" id="p1267331">
								<h3 id="post-1267331-title">Reply 12 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>@amadeus777999 Thank you!</p>

<p>I got the cursed scaler working.</p> 

<p>It takes 16:9 resolutions and upscales them to 16:9 1920x1080</p>



<p>And  4:3 resolutions, adds black borders, and upscales them to 16:9 1920x1080</p>



<p>Everything mostly works, I fixed a ton of issues (wasted hours trying to "fix" the panel's timings until finally figuring out that a cropped image is not a timing issue (obviously), but overscan). It's not yet ready for the M4800 card. The scaler has two TMDS inputs, and I got only one working. Obviously not the same one I used on the VSA-100 M4800 card.</p></div>
				</div>
							</article>
											<article aria-labelledby="post-1267437-title" id="p1267437">
								<h3 id="post-1267437-title">Reply 13 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>Got the other TMDS input working, and programmed the scaler on the VSA-100 card:</p>





<p><a href="https://www.youtube.com/watch?v=yuj_HG3H74w">https://www.youtube.com/watch?v=yuj_HG3H74w</a></p>

<p>Next is to change the FPGA code a bit, for the messed up video format that the VSA-100 will output when plugged into a laptop.</p></div>
				</div>
							</article>
											<article aria-labelledby="post-1267452-title" id="p1267452">
								<h3 id="post-1267452-title">Reply 14 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>Here it is, world's first 3dfx powered laptop <span data-version="6" data-src="1f601" data-alt="beaming face with smiling eyes">😁</span></p>











<p><a href="https://youtu.be/f1h572CyArk?si=btRd7BH3IB-1CR8d">https://youtu.be/f1h572CyArk?si=btRd7BH3IB-1CR8d</a></p>

<p>There are still a few things to do, fix brightness/contrast, figure out why the image is shifted right by about 5 pixels and fix it, read temperature sensors, control fan, send shutdown signal to host in case of overtemperature, and maybe figure out a way of controlling the panel's backlight from the OS.  But the card works perfectly <span data-version="6.1" data-src="1f600" data-alt="grinning face">😀</span></p></div>
				</div>
							</article>
											<article aria-labelledby="post-1267464-title" id="p1267464">
								<h3 id="post-1267464-title">Reply 15 of 25, by DrAnthony</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Newbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=46228&amp;sr=posts" title="Search DrAnthony’s posts">90</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2021-04-16, 22:37</dd>
		</p>
		
									
				
	</dl>

				</div>


					<div>
						
								
	

						
						<p>Wow, wow, wow, wow,WOW! Thanks for sharing this along with your insights. I'm sure we've all got a display sitting somewhere in house that's got some pesky overscan setting. Mine just so happens to be a 2008 vintage Sony TV in my basement, but the pain is there nonetheless.</p>

						
						

																								
											</div>
				</div>
							</article>
											<article aria-labelledby="post-1267753-title" id="p1267753">
								<h3 id="post-1267753-title">Reply 16 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div>
						
								
	

						
						<div><p>@DrAnthony No problem <span data-version="6.1" data-src="1f600" data-alt="grinning face">😀</span>  .</p>

<p>I managed to fix the scaler brightness/contrast bug, and set them to some decent values (I'll tweak it to "perfection" later). Now the display looks so much better:</p>



<p>Also measured VRMs temperature, as these are not covered at all by the existing heatsink.</p>





<p>At 2.5V VCORE, 166MHz core/memory frequency, idle: 85.9C, load: 87.6C. This is well within spec, the VRM ICs are rated to operate at 125C. If it ever gets beyond that, the MCU will immediately shut down the power rails and issue an overtemperature event that will shutdown the laptop. This way nothing will ever get damaged.<br>
VSA temperature is good, I can't yet say exactly what it is yet, but the cooling system works really well.</p>  

<p>There is a temperature sensor right underneath the VSA, but it's not currently read by the MCU:</p>





<p>When doing the VRM temperature measurements, I found a bug.</p>

<p>When I tested the card plugged into a PC, I was able to overclock it just fine with V.ctrl or VSA100 OC.<br>
However, when I do the same thing with the card plugged into the laptop, the new clocks apply, but, as soon as a Glide or D3D application is started, the card clocks change back to the default 166MHz.<br>
Either something is messed up in that system, or this is somehow caused by the lack of VSA BIOS.</p>


<p>Found some other issues as well. While the VSA-FPGA-HDMI works fine for 640x480,800x600,960x720,1024x768,1152x864,1280x720,1280x1024,1360x768,1600x900,1600x1024, and the HDMI-SCALER-LVDS works fine for  those resolutions as well, when doing VSA-FPGA-SCALER-PANEL there are quite a few resolutions with major issues. I suspect most of this is caused by my FPGA code, as well as the whole image shifted to the right by about 5 pixels.</p></div>

						
						

																			<p><small>Last edited by <a href="https://www.vogons.org/memberlist.php?mode=viewprofile&amp;u=42546"><span role="text presentation">sdz</span></a> on 2024-06-06, 13:36. Edited 1 time in total.</small>
															</p>
																		
											</div>
				</div>
							</article>
											<article aria-labelledby="post-1267919-title" id="p1267919">
								<h3 id="post-1267919-title">Reply 17 of 25, by sdz</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Member</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=42546&amp;sr=posts" title="Search sdz’s posts">328</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2019-12-28, 19:21</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">EU</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>I changed the panel backlight control to the scaler instead of the MCU (the board was design to permit both, with a resistor position change). Now, when the system is on, but the screen should be off, it's black with no backlight, instead of black with backlight on. Also tweaked/fixed various other scaler related things, now the scaler does pretty much all what I wanted it to do.</p>

<p>While I didn't manage to overlock the card with V.ctrl or VSA100 OC (in the laptop), it works with Voodoo 5 Overclocker 1.0. I managed to push the card from the stock 166MHz to 200MHz, at 2.9V VCORE. Not bad considering it's a 220 revision VSA-100 and 166MHz rated RAM.<br>
I have a couple of VSA-100 320 rev ICs, and I'll try to source 200MHz rated RAM. After that it should go higher.</p>

<p>With the card installed in the laptop, 64MB RAM, 200MHz core/mem clock, XP SP3, SFFT1.9, 3DMark2001SE default settings, 1024x768 32bpp, no tweaked LOD: 2148 3D Marks.</p>

</div>
				</div>
							</article>
											<article aria-labelledby="post-1267928-title" id="p1267928">
								<h3 id="post-1267928-title">Reply 18 of 25, by progman.exe</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Newbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=51283&amp;sr=posts" title="Search progman.exe’s posts">93</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2023-04-30, 21:09</dd>
		</p>
		
										<p role="presentation">
				<dt role="associationlistitemkey term" data-icon="location"><span>Location</span></dt>
				<dd role="associationlistitemvalue definition">C:\WINDOWS\</dd>
			</p>
							
				
	</dl>

				</div>


					<div><p>EDIT:I wrote and posted this before reading you'd got it OC'd with another program. Another reason to basically ignore it <span data-version="6.1" data-src="1f600" data-alt="grinning face">😀</span><br>
---------------------------------</p>

<blockquote role="blockquote group" aria-label="Quote"><cite data-icon="quote"> <a href="https://www.vogons.org/viewtopic.php?p=1267753#p1267753" title="Go to original post">wrote on 2024-06-05, 17:30:</a></cite><details><summary><span>When doing the VRM temperature measurements, I found a bug. […]<br></span><span data-icon="down-arrow">Show full quote</span></summary>
<p>When doing the VRM temperature measurements, I found a bug.</p>

<p>When I tested the card plugged into a PC, I was able to overclock it just fine with V.ctrl or VSA100 OC.</p>

<p>However, when I do the same thing with the card plugged into the laptop, the new clocks apply, but, as soon as a Glide or D3D application is started, the card clocks change back to the default 166MHz.<br>
Either something is messed up in that system, or this is somehow caused by the lack of VSA BIOS.</p>
</details></blockquote>

<p>Staggering work. I showed a nerd-mate your website, he tried to be "lol retro why", but the still-gaming-nerd in him knew what he was looking at, and he ended up being impressed.</p>

<p>All I can suggest is bodges: What about something like have a program sleep for 30 seconds, then run a program that turns up the clock. In that 30 seconds, you start your Glide/D3D program, and the overclock is applied in the background?</p>

<p>Or is that recipe to insta-crash the drivers or program?</p>

<p>Otherwise, can you use the FPGA to also hold a copy of the VSA BIOS? Just adding this idea to make it clear I don't know what I am actually looking at <span data-version="6.1" data-src="1f600" data-alt="grinning face">😀</span></p>

<p>Keep up the good work sdz!</p></div>
				</div>
							</article>
											<article aria-labelledby="post-1267995-title" id="p1267995">
								<h3 id="post-1267995-title">Reply 19 of 25, by EriolGaurhoth</h3>

						

				

				<div>
					<div role="note" aria-label="Poster info">
												
	
	<dl role="associationlist definitionlist" data-hide-below-sxs-post="">
					<p role="presentation">
																	<dt role="associationlistitemkey term">Rank</dt>
				<dd role="associationlistitemvalue definition">Newbie</dd>
																</p>
		
						<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="topic"><span>Posts</span></dt>
			<dd role="associationlistitemvalue definition"><a href="https://www.vogons.org/search.php?author_id=50516&amp;sr=posts" title="Search EriolGaurhoth’s posts">21</a></dd>
		</p>
	
			<p role="presentation">
			<dt role="associationlistitemkey term" data-icon="show-guests"><span>Joined</span></dt>
			<dd role="associationlistitemvalue definition">2023-01-17, 23:10</dd>
		</p>
		
									
				
	</dl>

				</div>


					<div><p>I've dreamed of this thing, pretty much my entire life: a proper 3Dfx-powered laptop! I just discovered this today while posting to an old thread about my desire for one of these things, haha!</p>

<p><a href="https://www.vogons.org/viewtopic.php?f=46&amp;t=69866&amp;p=1267700#p1267700">Re: Hardware experts, are we ever going to see replica 3D GPU's?</a></p></div>
				</div>
							</article>
						</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[What Is PID 0? (356 pts)]]></title>
            <link>https://blog.dave.tf/post/linux-pid0/</link>
            <guid>40613287</guid>
            <pubDate>Fri, 07 Jun 2024 21:42:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.dave.tf/post/linux-pid0/">https://blog.dave.tf/post/linux-pid0/</a>, See on <a href="https://news.ycombinator.com/item?id=40613287">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
		<p><span>Written by</span>
        David Anderson
        <br>
        <span>on&nbsp;</span><time datetime="2024-06-05 00:00:00 +0000 UTC">June 5, 2024</time>
</p>
		<h2>What is PID 0?</h2>


		

		<p>I get nerd-sniped a lot. People offhandedly ask something innocent,
and I lose the next several hours (or in this case, days)
comprehensively figuring out the answer. Usually this ends up in a
rant thread on <a href="https://hachyderm.io/@danderson">mastodon</a> or in some
private chat group or other. But for once I have the energy to write
one up for the blog.</p>

<p>Today’s innocent question:</p>

<blockquote>
<p>Is there a reason UIDs start at 0 but PIDs start at 1?</p>
</blockquote>

<p>The very short version: Unix PIDs do start at 0! PID 0 just isn’t
shown to userspace through traditional APIs. PID 0 starts the kernel,
then retires to a quiet life of helping a bit with process scheduling
and power management. Also the entire web is mostly wrong about PID 0,
because of one sentence on Wikipedia from 16 years ago.</p>

<p>There’s a slightly longer short version right at the end, or you can
stick with me for the extremely long middle bit!</p>

<p>But surely you could just google what PID 0 is, right? Why am I even
publishing this?</p>

<h2 id="the-internet-is-wrong">The internet is wrong</h2>

<p>At time of writing, if you go ask the web about PID 0, you’ll get a
mix of incorrect and misleading information, and almost no correct
answers.</p>

<p>After figuring out the truth, I asked Google, Bing, DuckDuckGo and
Kagi what PID 0 is on linux. I looked through the top 20 results for
each, as well as whatever knowledge boxes and AI word salads they
organically gave me. That’s 2 pages of results on Google, for
reference.</p>

<p>All of them failed to produce a fully correct answer. Most had a
single partially correct answer somewhere in the first 20 results, but
never near the top or showcased. DDG did best, with the partially
correct answer at number 4. Google did the worst, no correct answer at
all. And in any case, the incorrect answers were so prevalent and
consistent with each other that you wouldn’t believe the one correct
site anyway.</p>

<p>The top-2 results on all engines were identical, interestingly: a
stackoverflow answer that is wrong, and a spammy looking site that
seems to have embraced LLM slop, because partway through failing to
explain PID 0 it randomly shifts to talking about <a href="https://en.wikipedia.org/wiki/Proportional%E2%80%93integral%E2%80%93derivative_controller">PID
loops</a>,
from control system theory, before snapping out of it a paragraph
later and going back to Unix PIDs.</p>

<p>Going directly to the source of the LLM slop fared slightly better, on
account of them having stolen from books as well as the web, but they
still make shit up in the usual amount. I was able to get a correct
answer though, using the classic prompting technique of already
knowing the answer and retrying until I got good RNG.</p>

<p>If we set aside the few entirely wrong answers (“there is no PID 0”,
“it launches init then exits”, “it’s part of systemd”, “it’s the
entire kernel”, “it spins in an infinite loop and nothing else”), the
most common answer follows a single theme: PID 0 has something to do
with paging, or swap space, virtual memory management in some way.</p>

<p>This theme comes straight from, where else? <a href="https://en.wikipedia.org/w/index.php?title=Process_identifier&amp;oldid=1184062138">Wikipedia’s article on
PIDs</a>,
which said:</p>

<blockquote>
<p>There are two tasks with specially distinguished process IDs:
<strong>swapper or sched has process ID 0 and is responsible for paging</strong>,
and is actually part of the kernel rather than a normal user-mode
process. Process ID 1 is usually the init process primarily
responsible for starting and shutting down the system.</p>
</blockquote>

<p>That text has been on Wikipedia for 16 years, and in that time has
been quoted, paraphrased and distorted across the web to the point
that it’s displaced the truth. It’s a pretty funny dynamic, and also a
bit sad, given the source code for Linux and the BSDs is right there,
you can just check.</p>

<p>(Later note: after I published this, someone went and updated the
article to have the correct information. The link above takes you to
the old version so that the rest of this explanation still makes
sense, but at time of writing this update <a href="https://en.wikipedia.org/wiki/Process_identifier">the current version of the
PID article</a> is
accurate)</p>

<p>To explain why Wikipedia was inaccurate here, we need to take a little
history lesson.</p>

<h2 id="the-history-of-pid-0-in-unix">The history of PID 0 in Unix</h2>

<p>As I said in the opening TLDR, PID 0 does some scheduling and power
management, and no paging. It’s what the scheduler runs when it has
nothing else for a CPU core to do.</p>

<p>The exact implementation obviously varies across kernels and versions,
but all the ones I inspected follow the same broad pattern: when PID 0
gets to run, it tries to find something else that could run in its
place. Failing that, it puts the current CPU core to sleep until
something else wakes it back up, and then loops around and starts
over.</p>

<p>Don’t take my word for it. Here’s
<a href="https://github.com/torvalds/linux/blob/2df0193e62cf887f373995fb8a91068562784adc/kernel/sched/idle.c#L258">do_idle</a>
in the Linux kernel, which is called in an infinite loop by
PID 0. <code>nohz_run_idle_balance</code> tries to find alternate work. The while
loop puts the core to sleep. After wakeup, <code>schedule_idle</code> lets the
scheduler take over and put the core to work again.</p>

<p>But maybe that’s just linux, I hear you say. Okay, here’s
<a href="https://cgit.freebsd.org/src/tree/sys/kern/sched_ule.c?id=86c9325d341fc3f39543bcfaf7c3bb3ceeacbe5d#n2996">sched_idletd</a>
in the FreeBSD kernel. <code>tdq_idled</code> tries to steal runnable tasks from
another core. Failing that, <code>cpu_idle</code> puts the core to sleep. Rinse,
repeat.</p>

<p>Okay sure but these are modern kernels, maybe it was different in the
olden days? Okay, how about
<a href="https://github.com/dspinellis/unix-history-repo/blob/BSD-4_3/usr/src/sys/sys/vm_sched.c#L86">sched</a>
in 4.3BSD, from the summer of 1986? Computers are getting smaller and
OSes more compact, so the scheduler and idle loop are now smushed into
one routine. It tries to find something to schedule, and failing that
<code>sleep</code>s until an external event wakes it back up.</p>

<p>Incidentally, this is the origin of the vague allegation that PID0 is
sometimes called “sched”: in earlier Unixes, the function that
implements PID 0 is literally called <code>sched</code>.</p>

<p>Still not sure? Maybe it’s just a weird BSD thing that leaked into
Linux?</p>

<p>Okay fine, here’s
<a href="https://github.com/dspinellis/unix-history-repo/blob/Research-V4/sys/ken/slp.c#L89">sched</a>
in Unix V4, the first known version of the Unix kernel written in
C. Again the scheduler and idle loop are firmly intertwined, and
there’s also some PDP-11 esoterics that are confusing to modern eyes,
but the same bones are there: find a runnable process and switch to
it, or idle and then try again.</p>

<p>You could go further back. The source code for Unix V1 is out there,
as well as an early prototype on PDP-7. However, it’s all in PDP
assembler, uses some mnemonics that don’t seem to be listed in the
surviving assembler references I could find, and the kernel’s
structured a fair bit differently from the C version.</p>

<p>That said, if you want to go digging, I believe the <code>swap</code> routine is
the meat of the scheduler. And finally we get a clear idea of the root
of the Wikipedia claim: in the earliest Unix implementation, the
scheduler was sometimes nicknamed the “swapper.”</p>

<p>It was called that because, now that we’re back at the beginning of
Unix, one routine encompasses not only scheduling and idling, but also
moving entire process memory images between the small core memory and
secondary storage. Hard drives in this case, references in the kernel
code as well as the <a href="https://gunkies.org/wiki/UNIX_First_Edition">Computer History
wiki</a> confirm that Bell
Labs’s PDP-11 at the time ran an RS11 disk for the core OS and process
swapping, and an RK03 for the user filesystem.</p>

<p>(Sidebar! This is where the / vs. /usr split comes from. /usr was the
part of early Unix stored on the RK03 disk, whereas the smaller root
filesystem was on the RS11. Unless you’re still running on a PDP-11
with single RS11 and RK03 disks, a split /usr is vestigial and <a href="https://systemd.io/SEPARATE_USR_IS_BROKEN/">causes
a variety of problems in early
boot</a>)</p>

<p>So now the history is hopefully fairly clear. In the first Unix the
world at large saw (Unix V5), entry zero in the process table
initialized the kernel, then looped in the <code>sched</code> function, defined
in <code>slp.c</code>. Those two names clearly telegraph the loop’s primary
functions. However, the scheduling algorithm is quite simple at this
point, and so almost all of <code>sched</code>’s code is concerned with swapping
process images in and out of core memory in order to make scheduling
happen. Thinking of this function as the “swapper” is reasonable, even
if the original source code never uses that name.</p>

<p>This essential structure survives to this day, with a lot more
complications. Whole-process swapping gave way to <a href="https://en.wikipedia.org/wiki/Memory_paging">demand
paging</a>, and so PID 0
stopped concerning itself with even a little memory management. As
both the scheduling algorithms and the mechanics of idling a CPU
became more complex, scheduling and idling were split out into
separate pieces of code, and you end up with what we’ve had for at
least two decades: the function implementing PID 0 has <code>sched</code> or
<code>idle</code> in its name, and has a supporting role in doing those two
things.</p>

<p>Going back to the Wikipedia article, it seems the author of that edit
wanted to write “swapping”, in the classic Unix V5 sense of swapping
out whole processes <em>as a consequence of scheduling</em>. But the edit
didn’t clarify that “swapping” was being used in an archaic sense that
was likely to confuse the modern reader. Furthermore the edit wrote
“paging” rather than “swapping”. I don’t know why, but my guess is
that it’s because the canonical article for this general memory
management concept is titled “Memory paging”, whereas “swapping” is a
disambiguation page. In the moment of making the edit, I could
definitely see myself swapping out for the seemingly preferred term.</p>

<p>Unfortunately, in this particular context, replacing “swapping” with
“paging” makes the sentence incorrect. And there it sat for 16 years,
slowly leaking into the rest of the web as people quoted wikipedia at
each other and paraphrased or elaborated further in the wrong
direction.</p>

<p>Okay, end of rant about how the web is turning to ash in our
hands. It’d be nice if it didn’t, or at least it’d be nice if half the
industry wasn’t breathlessly building ways to spray more petrol on
what’s left. So it goes. Back to PID 0 now.</p>

<h2 id="are-those-functions-really-pid-0">Are those functions really PID 0?</h2>

<p>Above, I claim by fiat that the functions I’m linking to are
PID 0. Tracing all of them would take a lot more words, but I’ll
demonstrate the point on Linux and leave you to trace the others. I
encourage you to do so! It’s remarkable how similar to each other
different kernels are in this area, both across current OSes and over
time. They’ve become more complex, but the family tree is still
evident.</p>

<p>Disclaimer, the Linux kernel is a very complex beast. I’m not going to
walk through every single thing the kernel does before reaching
<code>do_idle</code>. Think of this as a signposts to help orient you, not a
comprehensive breakdown. This was written using the 6.9 kernel source
code, so if you’re visiting from the future: hello! I hope your
dilithium matrix is cycling well, and things may have changed.</p>

<p>We begin! The bootloader jumps to the first instruction of kernel
code. The first few steps from here are <em>extremely</em> specific to the
CPU architecture and nearby chipset hardware. I’m going to skip that
and begin at
<a href="https://github.com/torvalds/linux/blob/d30d0e49da71de8df10bf3ff1b3de880653af562/init/main.c#L903">start_kernel</a>,
where the machine has been set up to a common baseline and
architecture-independent kernel code takes over (albeit still assisted
by arch-specific helpers).</p>

<p>At this point, <code>start_kernel</code> is the only thing running on the machine
(yes I know about ring minus 1 and SMM and so on, I said I was
simplifying). On multicore systems, the bootloader/firmware/hardware
arranges for a single CPU core to be running, called the bootstrap
core. That single thread of execution is what we’re looking at, and
it’s all we get until the kernel starts the other cores itself.</p>

<p>The first thing to get called is
<code>set_task_stack_end_magic(&amp;init_task)</code>. Well that looks relevant! It’s
a very simple function that writes a magic number to the top of
<code>init_task</code>’s stack space to detect overflows. <code>init_task</code> is
statically defined in
<a href="https://github.com/torvalds/linux/blob/master/init/init_task.c#L64">init_task.c</a>,
and the leading comment tells us it’s the first task. What’s a task
though?</p>

<h2 id="task-struct-pids-tids-tgids-and-oh-no">task_struct, PIDs TIDs TGIDs and oh no</h2>

<p>Here we have to take a detour into something very confusing: the Linux
kernel and its userspace disagree on the meaning of PID.</p>

<p>In the kernel, the unit of running things is the <code>task_struct</code>. It
represents one thread of execution, rather than a whole process. To
the kernel, a PID identifies a <em>task</em>, not a
process. <code>task_struct.pid</code> is the identifier for that one thread only.</p>

<p>The kernel still needs to represent the concept of a userspace process
somehow, but it’s not a nice crunchy data structure you can point
at. Instead, threads are collected into “thread groups”, and groups
are identified by a thread group identifier, or TGID. Userspace calls
thread groups processes, and thus the kernel TGID is called the PID in
userspace.</p>

<p>To add confusion, these numbers are often the same. When a new thread
group is created (e.g. when userspace runs fork()), the new thread is
given a new thread ID, and that ID also becomes the new group’s
TGID. So for single-threaded processes, kernel TID and TGID are
identical, and asking either the kernel or userspace what this thing’s
“PID” is would give you the same number. But that equivalence breaks
once you spawn more threads: the new thread gets its own thread ID
(which is what the kernel calls a PID), but inherits its parent’s
thread group ID (which userspace calls a PID).</p>

<p>To add <em>even more</em> confusion, the arrival of containers forces threads
and processes to have multiple identities. The thing that’s PID 1 in a
docker container is very much not the same as PID 1 outside the
container. This is tracked in a separate <code>pid</code> struct, which keeps
track of the different thread IDs a <code>task_struct</code> has, depending on
which PID namespace is asking.</p>

<p>I’m a userspace enjoyer by day, so when I started this rabbithole I
interpreted “PID 0” in the question as an analog to the PID 1 I know,
that /bin/init thing. But now the question is ambiguous! PID 0 could
mean thread 0, or it could mean thread group 0.</p>

<p>At the beginning of the kernel, the answer is fortunately easy:
<code>init_task</code> represents PID 0 by everyone’s definition. It’s the thread
with ID 0 (which is the PID according to the kernel), it’s the only
thread in the group with ID 0 (which is the PID according to
userspace), and no child PID namespaces exist yet, so there’s no other
numbers for <code>init_task</code> to be.</p>

<p>This <em>will</em> get muddier later on because thread group 0 is going to
grow more threads, so in userspace terms we’ll have a PID 0 process
that contains several threads, one of which has TID 0. In the rest of
this post I’m going to try and say “task” or “thread” to mean a single
thread of execution, the thing described by a <code>task_struct</code>; and
“thread group” for the thing userspace would call a process. But it’s
not just you, it’s terribly confusing.</p>

<p>Okay, back to the code walk…</p>

<h2 id="the-path-to-the-idle-task">The path to the idle task</h2>

<p>So, we know <code>init_task</code> is the PID 0 we’re looking for, albeit now
it’s actually two different PID 0s at the same time because it’s the
thread with ID 0 within the thread group with ID 0. How do we know
that <code>init_task</code> describes the currently-executing CPU context?</p>

<p>There’s a few things. We know we’re the only thread of execution
currently happening, and <code>init_task</code> is described as the first task,
aka the first thread. That sounds like us. It’s using <code>init_stack</code> as
its stack, which is the stack we’re currently using (proving this
requires digging into arch-specific code and gcc linker scripts, so
I’m going to skip it, but have fun!). Its <code>__state</code> is <code>TASK_RUNNING</code>,
which means it’s either running right now, or it’s runnable and
waiting for CPU time. The kernel scheduler isn’t initialized yet, so
there can’t really be any other runnable task at this point. This
could be a setup for an elaborate trolling, but the evidence suggests
that this <code>init_task</code> is us. And spoiler, we’re not being trolled,
<code>init_task</code> is indeed the initial thread that executes <code>start_kernel</code>.</p>

<p>At this point a lot of early kernel initialization happens. We can
skip over all that for our purposes, and pick up at the call to
<a href="https://github.com/torvalds/linux/blob/master/kernel/sched/core.c#L9920">sched_init</a>. This
function does basic initialization of the CPU scheduler’s data
structures. A lot happens because the scheduler is a large beast,
we’ll just peek at a couple of relevant lines:</p>

<pre><code>    /*
     * The idle task doesn't need the kthread struct to
     * function, but it is dressed up as a per-CPU
     * kthread and thus needs to play the part if we want
     * to avoid special-casing it in code that deals with
     * per-CPU kthreads.
     */
    WARN_ON(!set_kthread_struct(current));

    /*
     * Make us the idle thread. Technically, schedule()
     * should not be called from this thread, however
     * somewhere below it might be, but because we are the
     * idle thread, we just pick up running again when this
     * runqueue becomes "idle".
     */
    init_idle(current, smp_processor_id());
</code></pre>

<p>The first line describes the currently executing thread as “the idle
task,” and mentions that it’s a special kernel thread: most kernel
threads are run by <code>kthreadd</code>, which is task 2 and doesn’t exist
yet. If you’re on linux, <code>ps ax | grep kthreadd</code> will show that
kthreadd is PID 2 in userspace, in addition to also being thread/task
ID 2 in the kernel.</p>

<p>The second line explicitly tells the scheduler that the currently
running thread is the “idle thread” for the bootstrap CPU
core. <code>current</code> is a pointer to the currently-running <code>task_struct</code>,
which at this point in execution points to <code>init_task</code>. The
implementation of <code>current</code> is another very architecture-specific
piece of code, so I’m going to encourage you to go poke at it if
curious, and move right along.</p>

<p>Going back to <code>start_kernel</code>, the remaining initialization code
doesn’t concern us, so we can skip straight to the call to
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/init/main.c#L701">rest_init</a>. This
function is short and sweet: it spawns task 1, which will become the
init process in userspace; and task 2 for <code>kthreadd</code>, which manages
all future kernel threads.</p>

<p>We’ll be following the life of task 1, and although it will someday
become PID 1 in userspace, to start it’ll run
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/init/main.c#L1458">kernel_init</a>. Not
yet though. These new tasks exist and are known to the scheduler, but
they’re not running yet because we haven’t asked the scheduler to do
its thing yet. (caveat: in some kernel configurations, the scheduler
may get a chance to switch to task 1 and 2 sooner than what I’m about
to describe, but these first tasks are orchestrated such that the
outcome is nearly identical.)</p>

<p>Finally, <code>rest_init</code> calls
<a href="https://github.com/torvalds/linux/blob/master/kernel/sched/idle.c#L424">cpu_startup_entry</a>,
which goes into an infinite loop of calling
<a href="https://github.com/torvalds/linux/blob/master/kernel/sched/idle.c#L258">do_idle</a>. And
here we are, we’ve become the idle task on the bootstrap CPU core. On
the first iteration, we don’t put the CPU to sleep because there are
other runnable tasks (the two we just made). So we drop to the bottom
of <code>do_idle</code>, and go into <code>schedule_idle</code>. The scheduler finally gets
to run, and we switch away from task 0. <code>kthreadd</code> in task 2 isn’t
terribly interesting, it does a little initialization then yields the
CPU again until something else asks to create kernel threads. Let’s
follow task 1 instead, it’s much more fun.</p>

<p>Task 1 starts at
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/init/main.c#L1458">kernel_init</a>. This
does even more kernel initialization, including bringing up all device
drivers and mounting either the initramfs or the final root
filesystem. And then, at last, it calls
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/init/main.c#L1376">run_init_process</a>
to drop out of kernel mode and execute userspace’s init program. If
init(1) asks the kernel who it is, it’ll be told that it is thread 1,
which is part of thread group 1. Or thread 1 in PID 1, in the
conventional userspace vocabulary.</p>

<p>It was a surprise to me that task/pid 1 does a whole bunch of kernel
work before if morphs into the familiar userspace process! A large
chunk of what I think of as the kernel booting <em>technically</em> happens
in PID 1, albeit in a very different looking universe to init(1) in
userspace. Why not do those bits in task 0, like the earlier bits of
init?</p>

<h2 id="pid-0-in-multicore-systems">PID 0 in multicore systems</h2>

<p>If you’ve been following carefully so far, you may be wondering about
the other CPU cores. So far we’ve run entirely single-threaded, and
when we initialized the scheduler we explicitly told it to pin task 0
to the bootstrap core. When does that change?</p>

<p>The answer is, in task 1! The first thing <code>kernel_init</code> does is start
up all other CPU cores. This means the bulk of the boot process that
happens in <code>kernel_init</code> can make use of all available CPU power,
rather than being stuck on a single thread. Starting CPU cores is
quite intricate, but the exciting bit for our purposes is the call to
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/kernel/smp.c#L971">smp_init</a>. In
turn, it calls
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/kernel/fork.c#L2705">fork_idle</a>
for each non-bootstrap core, creating a new idle thread and pinning it
to that core. This is where the “PID 0” term gets muddy, because these
new idle tasks have non-zero thread IDs, but they are still part of
thread group 0. So, in userpace parlance, PID 0 is a process that
contains one pinned thread per core, with thread 0 pinned to the
bootstrap core.</p>

<p>After that, <code>smp_init</code> runs
<a href="https://github.com/torvalds/linux/blob/8a92980606e3585d72d510a03b59906e96755b8a/kernel/cpu.c#L1860">bringup_nonboot_cpus</a>,
which does architecture-specific incantations to wake up the cores. As
each core starts, it does a bit of arch-specific setup to make itself
presentable, then runs <code>cpu_startup_entry</code> and <code>do_idle</code>, just like
the bootstrap core did with task 0. All CPU cores are now alive and
can run tasks, and <code>kernel_init</code> proceeds with the rest of boot.</p>

<h2 id="i-m-bad-at-conclusions">I’m bad at conclusions</h2>

<p>And that’s it! To summarize:</p>

<p>PID 0 does exist, it’s the one thread that starts the kernel, provided
by the bootstrap CPU core.</p>

<p>PID 0 runs early kernel initialization, then becomes the bootstrap CPU
core’s idle task, and plays a minor supporting role in scheduling and
power management.</p>

<p>PID 0 has done this, with different degrees of fanciness but the same
broad strokes, since the first Unix kernels. You can go read the
source code of many of them and see for yourself! That’s cool.</p>

<p>PID 0 has nothing to do with memory management. In early Unix kernels
it did some incidental memory management as part of process
scheduling. PID 0 stopped doing that many decades ago.</p>

<p>On Linux, “PID 0” is ambiguous because userspace and the kernel
disagree on what a PID is. The kernel’s definition wins in practice
for PID 0, because none of the entities that make up PID 0 are visible
to userspace through the traditional Unix APIs.</p>

<p>On multicore systems, every CPU core gets an idle thread. All those
idle threads are part of thread group 0, which userspace would call
PID 0. Thread ID 0, which is what the linux kernel calls PID 0, is as
described above.</p>

<p>Seemingly all Q&amp;A websites on the internet function primarily by
paraphrasing Wikipedia. This is made evident and awkward when
Wikipedia accidentally makes the web repeat incorrect information for
16 years.</p>

<p>Having worked all this out, I’d love to go edit the Wikipedia article
and set the record straight… But would that count as “primary
research”? Would the edit be reverted because it disagrees with most
of the web? Does publishing this post mean editing wikipedia would now
count as some variation of sockpuppeting or self-promotion?</p>

<p>I don’t know, and I’ll try to figure it out. In the meantime, thanks
for joining me on this chronicling of how I end up going on very large
sidequests when presented with a short, odd questions.</p>

		
	</div></div>]]></description>
        </item>
    </channel>
</rss>