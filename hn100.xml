<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Sat, 18 Jan 2025 18:30:21 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Show HN: Interactive systemd – a better way to work with systemd units (156 pts)]]></title>
            <link>https://isd-project.github.io/isd/</link>
            <guid>42749402</guid>
            <pubDate>Sat, 18 Jan 2025 16:22:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://isd-project.github.io/isd/">https://isd-project.github.io/isd/</a>, See on <a href="https://news.ycombinator.com/item?id=42749402">Hacker News</a></p>
Couldn't get https://isd-project.github.io/isd/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[HNInternal: Ask HN: Has anyone tried alternative company models (like a co-op) for SaaS? (105 pts)]]></title>
            <link>https://news.ycombinator.com/item?id=42748394</link>
            <guid>42748394</guid>
            <pubDate>Sat, 18 Jan 2025 14:05:20 GMT</pubDate>
            <description><![CDATA[<p>See on <a href="https://news.ycombinator.com/item?id=42748394">Hacker News</a></p>
Couldn't get https://news.ycombinator.com/item?id=42748394: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Google begins requiring JavaScript for Google Search (149 pts)]]></title>
            <link>https://techcrunch.com/2025/01/17/google-begins-requiring-javascript-for-google-search/</link>
            <guid>42747092</guid>
            <pubDate>Sat, 18 Jan 2025 09:36:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://techcrunch.com/2025/01/17/google-begins-requiring-javascript-for-google-search/">https://techcrunch.com/2025/01/17/google-begins-requiring-javascript-for-google-search/</a>, See on <a href="https://news.ycombinator.com/item?id=42747092">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
		
		<div>
			<div>
<p id="speakable-summary">Google says it has begun requiring users to turn on JavaScript, the widely used programming language to make web pages interactive, in order to use Google Search.</p>

<p>In an email to TechCrunch, a company spokesperson claimed that the change is intended to “better protect” Google Search against malicious activity, such as bots and spam, and to improve the overall Google Search experience for users. The spokesperson noted that, without JavaScript, many Google Search features won’t work properly and that the quality of search results tends to be degraded.</p>







<p>“Enabling JavaScript allows us to better protect our services and users from bots and evolving forms of abuse and spam,” the spokesperson told TechCrunch, “and to provide the most relevant and up-to-date information.”</p>

<p>Many major websites rely on JavaScript. <a href="https://nupursogani.medium.com/javascript-41a9caeaf5bd" target="_blank" rel="noreferrer noopener nofollow">According</a> to a 2020 GitHub survey, 95% of sites around the web employ the language in some form. But as users on social media <a href="https://news.ycombinator.com/item?id=42719865" target="_blank" rel="noreferrer noopener nofollow">point out</a>, Google’s decision to require it could add friction for those who rely on accessibility tools, which can <a href="https://developer.mozilla.org/en-US/docs/Learn_web_development/Core/Accessibility/CSS_and_JavaScript" target="_blank" rel="noreferrer noopener nofollow">struggle with certain JavaScript implementations</a>.</p>

<p>JavaScript is also prone to <a href="https://www.zdnet.com/article/which-are-the-most-insecure-programming-languages/" target="_blank" rel="noreferrer noopener nofollow">security vulnerabilities</a>. In its 2024 annual security survey, tech company Datadog found that around 70% of JavaScript services are vulnerable to one or more “critical” or “high-severity” vulnerabilities&nbsp;introduced by a third-party software library.</p>

<p>The Google spokesperson told TechCrunch that, on average, “fewer than .1%” of searches on Google are done by people who disable JavaScript. That’s no small number at Google scale. Google processes around 8.5 billion searches per day, so one can assume that millions of people performing searches through Google aren’t using JavaScript.</p>

<p>One of Google’s motivations here may be inhibiting third-party tools that give insights into Google Search trends and traffic. <a href="https://www.seroundtable.com/google-blocking-seo-rank-checking-tools-volatility-continues-38759.html" target="_blank" rel="noreferrer noopener nofollow">According</a> to a post on Search Engine Roundtable on Friday, a number of “rank-checking” tools — tools that indicate how websites are performing in search engines — began experiencing issues with Google Search around the time Google’s JavaScript requirement came into force.</p>


<p>The Google spokesperson declined to comment on Search Engine Roundtable’s reporting.</p>
</div>

			

			


			
			
			

			




			
			
			

			



			
<div>
	
	
	
	

	
<div>
	<p>
		Kyle Wiggers is a senior reporter at TechCrunch with a special interest in artificial intelligence. His writing has appeared in VentureBeat and Digital Trends, as well as a range of gadget blogs including Android Police, Android Authority, Droid-Life, and XDA-Developers. He lives in Brooklyn with his partner, a piano educator, and dabbles in piano himself. occasionally — if mostly unsuccessfully.	</p>
</div>


	
	<p>
		<a data-ctatext="View Bio" data-destinationlink="https://techcrunch.com/author/kyle-wiggers/" data-event="button" href="https://techcrunch.com/author/kyle-wiggers/">View Bio <svg style="width: 1em;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path fill="var(--c-svg, currentColor)" d="M16.5 12 9 19.5l-1.05-1.05L14.4 12 7.95 5.55 9 4.5z"></path></svg></a>
	</p>
	
</div>


			


		</div>
		

		
		<div id="wp-block-techcrunch-most-popular-posts__heading">
<h2 id="h-most-popular">Most Popular</h2>

</div>
		
	</div><div>
		<div>
	<div>
		<div>
			<h3>Newsletters</h3>
			
		</div>
		<p>Subscribe for the industry’s biggest tech news</p>
	</div>
	<form method="POST" action="/">
		
	</form>
	
</div>


		
		<h2>Related</h2>
		

		
		
		

		
		<div>

<h2>Latest in Apps</h2>




</div>
		

	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Honest Ahmed (2011) (103 pts)]]></title>
            <link>https://bugzilla.mozilla.org/show_bug.cgi?id=647959</link>
            <guid>42747065</guid>
            <pubDate>Sat, 18 Jan 2025 09:31:45 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=647959">https://bugzilla.mozilla.org/show_bug.cgi?id=647959</a>, See on <a href="https://news.ycombinator.com/item?id=42747065">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main-inner">










<div id="summary-container">



  
    <p><span id="field-value-status_summary">
      <span data-status="closed">Closed</span>
      <span id="field-value-bug_id">
        <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=647959">Bug 647959</a>
      </span>
      <span>
        <span>Opened <span title="2011-04-06 02:31 PDT" data-time="1302082262">14 years ago</span></span>
          <span>Closed <span title="2011-04-06 02:37 PDT" data-time="1302082675">14 years ago</span></span>
      </span>
        </span>
    </p>

  
</div>


<section id="module-categories">
    <header id="module-categories-header">
      <div data-label-expanded="Collapse Categories section" data-label-collapsed="Expand Categories section">
        
        <h2 id="module-categories-title">Categories</h2>
          <h3 id="module-categories-subtitle">
            (CA Program :: CA Certificate Root Program, task)
          </h3>
      </div>
    </header>
  <div id="module-categories-content">
        <p><span id="field-value-component">
      <div>
        <p><span id="component-name" tabindex="0" role="button" aria-haspopup="menu" aria-controls="component-info">CA Certificate Root Program
          
        </span></p>
      </div>
        </span>
    </p></div>
</section>


<section id="module-tracking">
    <header id="module-tracking-header">
      <div data-label-expanded="Collapse Tracking section" data-label-collapsed="Expand Tracking section">
        
        <h2 id="module-tracking-title">Tracking</h2>
          <h3 id="module-tracking-subtitle">
            (Not tracked)
          </h3>
      </div>
    </header>
  
</section>



<section id="module-people">
    <header id="module-people-header">
      <div data-label-expanded="Collapse People section" data-label-collapsed="Expand People section">
        
        <h2 id="module-people-title">People</h2>
          <h3 id="module-people-subtitle">
            (Reporter: honest.achmed, Assigned: kathleen.a.wilson)
          </h3>
      </div>
    </header>
  
</section>





<section id="module-details">
    <header id="module-details-header">
      <div data-label-expanded="Collapse Details section" data-label-collapsed="Expand Details section">
        
        <h2 id="module-details-title">Details</h2>
      </div>
    </header>
  
</section>

























<meta name="firefox-versions" content="{&quot;FIREFOX_AURORA&quot;:&quot;&quot;,&quot;FIREFOX_DEVEDITION&quot;:&quot;135.0b6&quot;,&quot;FIREFOX_ESR&quot;:&quot;128.6.0esr&quot;,&quot;FIREFOX_ESR115&quot;:&quot;115.19.0esr&quot;,&quot;FIREFOX_ESR_NEXT&quot;:&quot;&quot;,&quot;FIREFOX_NIGHTLY&quot;:&quot;136.0a1&quot;,&quot;LAST_MERGE_DATE&quot;:&quot;2025-01-06&quot;,&quot;LAST_RELEASE_DATE&quot;:&quot;2025-01-07&quot;,&quot;LAST_SOFTFREEZE_DATE&quot;:&quot;2025-01-02&quot;,&quot;LAST_STRINGFREEZE_DATE&quot;:&quot;2025-01-03&quot;,&quot;LATEST_FIREFOX_DEVEL_VERSION&quot;:&quot;135.0b6&quot;,&quot;LATEST_FIREFOX_OLDER_VERSION&quot;:&quot;3.6.28&quot;,&quot;LATEST_FIREFOX_RELEASED_DEVEL_VERSION&quot;:&quot;135.0b6&quot;,&quot;LATEST_FIREFOX_VERSION&quot;:&quot;134.0.1&quot;,&quot;NEXT_MERGE_DATE&quot;:&quot;2025-02-03&quot;,&quot;NEXT_RELEASE_DATE&quot;:&quot;2025-02-04&quot;,&quot;NEXT_SOFTFREEZE_DATE&quot;:&quot;2025-01-30&quot;,&quot;NEXT_STRINGFREEZE_DATE&quot;:&quot;2025-01-31&quot;}">



<div id="c0"><p>User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-GB; rv:1.9.2.16) Gecko/20110319 Firefox/3.6.16
Build Identifier: 

This is a request to add the CA root certificate for Honest Achmed's Used Cars and Certificates.  The requested information as per the CA information checklist is as follows:

1. Name

Honest Achmed's Used Cars and Certificates

2. Website URL

www.honestachmed.dyndns.org

3. Organizational type

Individual (Achmed, and possibly his cousin Mustafa, who knows a bit about computers).

4. Primary market / customer base

Absolutely anyone who'll give us money.

5. Impact to Mozilla Users

Achmed's business plan is to sell a sufficiently large number of certificates as quickly as possible in order to become too big to fail (see "regulatory capture"), at which point most of the rest of this application will become irrelevant.

6. CA Contact Information

<a href="mailto:achmed@honestachmed.dyndns.org">achmed@honestachmed.dyndns.org</a>

Technical information about each root certificate

1. Certificate Name

Honest Achmed's Used Cars and Certificates

2. Certificate Issuer Field

Honest Achmed's Used Cars and Certificates

3. Certificate Summary

The purpose of this certificate is to allow Honest Achmed to sell bucketloads of other certificates and make a lot of money.

4. Root Certificate URL

www.honestachmed.dyndns.org/cert.der

5. SHA1 fingerprint to 10. Signing key parameters

See the certificates.

11. Test website URL - 14. OCSP (OCSP is required for EV enablement)

<a rel="nofollow" href="https://www.honestachmed.dyndns.org/">https://www.honestachmed.dyndns.org</a> / www.honestachmed.dyndns.org/chain.p7s / www.honestachmed.dyndns.org/crl.der / www.honestachmed.dyndns.org/ocsp.asp

15. Requested Trust Bits

All of them of course.  The more trust bits we get, the more certificates we can sell.

16. SSL Validation Type

All of them.  The more types, the more certificates we can sell.

CA Hierarchy information for each root certificate

1. CA Hierarchy

Honest Achmed plans to authorise certificate issuance by at least, but not limited to, his cousin Osman, his uncles Mehmet and Iskender, and possibly his cousin's friend Emin.

2. Sub CAs Operated by 3rd Parties

Honest Achmed's uncles may invite some of their friends to issue certificates as well, in particular their cousins Refik and Abdi or "RA" as they're known. Honest Achmed's uncles assure us that their RA can be trusted, apart from that one time when they lent them the keys to the car, but that was a one-off that won't happen again.

Verification Policies and Practices

1. Documentation: CP, CPS, and Relying Party Agreements

Honest Achmed promises to studiously verify that payment from anyone requesting a certificate clears before issuing it (except for his uncles, who are good for credit).  Achmed guarantees that no certificate will be issued without payment having been received, as per the old latin proverb "nil certificati sine lucre".

2. Audits

Achmed's uncles all vouch for the fact that he's honest.  In any case by the time he's issued enough certificates he'll be regarded as too big to fail by the browser vendors, so an expensive audit doesn't really matter.

3. SSL Verification Procedures
4. Email Address Verification Procedures
5. Code Signing Subscriber Verification Procedures

See (1).

Response to Mozilla's CA Recommended Practices

Honest Achmed promises to abide by these practices.  If he's found not to abide by them, he'll claim it was a one-off slip-up in procedures and that policies have been changed to ensure that it doesn't happen again.  If it does happen again, he'll blame it on one of his uncles or maybe his cousin, who still owes him some money for getting the car fixed.

Reproducible: Always</p></div><div id="a413_159758"><p>Status: UNCONFIRMED → RESOLVED</p><p>Closed: <span title="2011-04-06 02:37 PDT" data-time="1302082675">14 years ago</span></p><p>Resolution: --- → INVALID</p></div><div id="c1"><p>Honest Achmed is at least more honest than Comodo.</p></div><div id="c2"><p>Is this really regulatory capture, or just TB2F?  The CAs aren't exerting any pressure on the browser vendors (they don't have to because the browser vendors aren't acting as regulators), it seems more like plain TB2F to me.</p></div><div id="c3"><p>He seems very honest, we should grant him to be a CA. (LOL).</p></div><div id="c4"><p>Resolved invalid?

What's the difference between Honest Achmed and the other CAs?

Just an audit report?

The community should chip in!</p></div><div id="c5"><p>This guy seems pretty legit. I know his third cousin seven times removed Asya, she works at my local breakfast place. We can have a key signing party there or something. Signing the keys of people you don't know, but your friend has a friend who has a sister who knows them, is recommended industry practice these days right?

Plus, I hear he gives discounts when you buy identities in bulk.</p></div><div id="c6"><p>Is this really "resolved invalid"?</p></div><div id="c7"><p>I am sure Achmed could help getting the issue resolved timely by hooking up his revenue stream to the bug assignee?</p></div><div id="c9"><p>I don't see how this is RESOLVED INVALID!
Honest Achmed is my bedrooms 2^nd largest CA and if you fail to add the root certificate to firefox I have real problems when accessing my notebook while it is stationed there!
Please reopen!</p></div><div id="c10"><p>I have reopened this ticket due to the honest nature of the request.

Trust the man's certificate.  You trust everyone else's.</p></div><div id="c12"><p>Given that the audit requirements will become irrelevant once Achmed has issued enough certificates to become TB2F, it seems a little redundant to require an audit.  Perhaps Achmed could simply donate the cost of the audit to charity, where it'll at least do some good, and cut out the middleman?

(BenB: Nice comment :-).</p></div><div id="c14"><p>I note that there is a sizeable portion of Thunderbird's userbase which would benefit from having Honest Achmed's certificate included: the members of the many and varied fandoms, interest groups, and self-organizing groups which have a penchant for pseudonyms which cannot be verified with any public registrar.

I vote to reopen the bug.</p></div><div id="c15"><p>Considering the problems at DigiNotar I vote for giving Honest Achmed a second chance!</p></div><div id="c16"><p>Given Diginotar's recent performance, would it have helped my case if I'd applied as Dishonest Achmed?

My other cousin Coskun has many hacker friends in Iran, and they've assured him they wouldn't engage in their national sport of using foreign CAs to issue them Google certificates if I was accepted as a CA.</p></div><div id="c17"><p>You have only a chance of getting approved if you install an anti-virus scanner because the absence of such in the Diginotar case is what Fox-IT thought was worth mentioning in their report.
And since we all know that anti-virus scanners are fuelled by magic and able to detect the intent of the programmer of a certain piece of code this is all the protection you need.</p></div><div id="a191152418_546015"><p>Product: mozilla.org → NSS</p></div><div id="a366382348_1"><p>Product: NSS → CA Program</p></div><p>
          You need to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=647959&amp;GoAheadAndLogIn=1">log in</a>
          before you can comment on or make changes to this bug.
        </p>



</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[I've been advocating for RSS support, and you should too (417 pts)]]></title>
            <link>https://reedybear.bearblog.dev/ive-been-advocating-for-rss-support-and-you-should-too/</link>
            <guid>42746222</guid>
            <pubDate>Sat, 18 Jan 2025 05:58:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://reedybear.bearblog.dev/ive-been-advocating-for-rss-support-and-you-should-too/">https://reedybear.bearblog.dev/ive-been-advocating-for-rss-support-and-you-should-too/</a>, See on <a href="https://news.ycombinator.com/item?id=42746222">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
    

    
        
    

    
        

        <p>
            <i>
                <time datetime="2025-01-17T18:46Z">
                    17 Jan, 2025
                </time>
            </i>
        </p>
    

    <p>I've been using Feeder to keep up with the news for awhile now. For a long time, I just checked AllSides.</p>
<p>But then I found out NPR in my state supports RSS, my local news org supports RSS, and YouTube even supports RSS!</p>
<p>One outlet I really like is GovTrack.us, and they did not support RSS - so I emailed them about it, and they added support.</p>
<p>Feeder's news website wasn't working with the Feeder app, so I emailed them and they fixed it.</p>
<p>I learned my State Senator's website supports RSS, but my state's GOP website does not - so I emailed the GOP asking for RSS. We'll see.</p>
<p>I emailed Ubisoft/Nadeo asking for RSS support on the Trackmania news website. They replied that they'll send the suggestion to dev team. We'll see.</p>
<p>I spoke at my Library's Board meeting last night asking for RSS support on their website. Seemed well-received. We'll see.</p>
<p>Substack supports RSS. Jurist.org supports RSS. Justia's supreme court summaries support RSS (<em>I used to read those, but I don't any more</em>). Blogger supports RSS.</p>
<p>So yeah - If you are interested in an organization's updates, then get a feed reader app, and subscribe to their feed on their website. If they don't have a feed, just ask them to add one!</p>
<p>You'll be surprised how nice it is to keep up with things you actually care about in a way that you're completely in control of, without bloat, without ads, without algorithms.</p>
<p>Please advocate for more RSS support - especially with orgs you want to stay up-to-date with. This can be video game news websites, government organizations, political news websites, entertainment platforms, blogs, or whatever.</p>


    

    
        
            <p>
                
                    <a href="https://reedybear.bearblog.dev/blog/?q=action">#action</a>
                
                    <a href="https://reedybear.bearblog.dev/blog/?q=blog">#blog</a>
                
            </p>
        

        
            


        
    


  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Using ChatGPT is not bad for the environment (195 pts)]]></title>
            <link>https://andymasley.substack.com/p/individual-ai-use-is-not-bad-for</link>
            <guid>42745847</guid>
            <pubDate>Sat, 18 Jan 2025 04:31:04 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://andymasley.substack.com/p/individual-ai-use-is-not-bad-for">https://andymasley.substack.com/p/individual-ai-use-is-not-bad-for</a>, See on <a href="https://news.ycombinator.com/item?id=42745847">Hacker News</a></p>
Couldn't get https://andymasley.substack.com/p/individual-ai-use-is-not-bad-for: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Can you read this cursive handwriting? The National Archives wants your help (181 pts)]]></title>
            <link>https://www.smithsonianmag.com/smart-news/can-you-read-this-cursive-handwriting-the-national-archives-wants-your-help-180985833/</link>
            <guid>42745334</guid>
            <pubDate>Sat, 18 Jan 2025 02:42:54 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.smithsonianmag.com/smart-news/can-you-read-this-cursive-handwriting-the-national-archives-wants-your-help-180985833/">https://www.smithsonianmag.com/smart-news/can-you-read-this-cursive-handwriting-the-national-archives-wants-your-help-180985833/</a>, See on <a href="https://news.ycombinator.com/item?id=42745334">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-article-body="">
        
          <figure>
            <img src="https://th-thumbnailer.cdn-si-edu.com/UY7Ar3brNbOai46R5Y1x9ddq6mg=/1000x750/filters:no_upscale():focal(1000x752:1001x753)/https://tf-cmsv2-smithsonianmag-media.s3.amazonaws.com/filer_public/32/94/3294bdbb-bd00-4fc7-8ab3-88faf17855d7/cursive.jpg" alt="Cursive document" itemprop="image">
            <figcaption>
              
                A Revolutionary War pension and bounty land warrant application submitted by&nbsp;James Lambert
              <span><a href="https://catalog.archives.gov/id/196142683" target="_blank">National Archives</a></span>
            </figcaption>
          </figure>
        

        

        <p>The National Archives is brimming with historical documents written in cursive, including some that date back more than 200 years. But these texts can be difficult to read and understand— particularly for Americans who never learned cursive in school.</p>

<p>That’s why the National Archives is looking for volunteers who can help transcribe and organize its many handwritten records: The goal of the&nbsp;<a href="https://www.archives.gov/citizen-archivist">Citizen Archivist</a> program is to help “unlock history” by making digital documents more accessible, according to the project’s website.</p>

<p>Every year, the National Archives digitizes <a href="https://www.archives.gov/citizen-archivist/faqs">tens of millions</a> of records. The agency uses artificial intelligence and a technology known as&nbsp;<a href="https://www.ibm.com/think/topics/optical-character-recognition">optical character recognition</a> to extract text from historical documents. But these methods don’t always work, and they aren’t always accurate.</p>

<p>That’s where human volunteers come in. By transcribing digital pages, volunteers make it easier for scholars, genealogists and curious history buffs to find and read historical documents.</p><blockquote data-instgrm-captioned="" data-instgrm-permalink="https://www.instagram.com/reel/DEpnFKnBMbb/?utm_source=ig_embed&amp;utm_campaign=loading" data-instgrm-version="14"></blockquote>

<p>Getting started is easy: All you need to do is sign up online. The free program is open to anyone with an internet connection.</p>

<p>“There’s no application,” Suzanne Isaacs, a community manager with the National Archives, tells&nbsp;<a href="https://www.usatoday.com/story/news/nation/2025/01/12/national-archives-needs-citizen-archivists-cursive/77493951007/"><em>USA Today</em></a>’s Elizabeth Weise. “You just pick a record that hasn’t been done and read the instructions. It’s easy to do for a half hour a day or a week.”</p>

<p>If you’re not confident in your cursive deciphering skills, the National Archives has other tasks available, too—such as “tagging” documents that other volunteers have already transcribed. Tagging helps improve the searchability of records.</p>

<p>Already, more than 5,000 volunteers have joined the Citizen Archivist program. Many are hard at work on “missions,” or groups of documents that need transcribing and tagging. For example, <a href="https://www.archives.gov/citizen-archivist/missions">current missions</a> include Revolutionary War pension files and employee contracts from 1866 to 1870.</p>

<p>The Revolutionary War mission, which kicked off in June 2023 in partnership with the National Park Service (NPS), includes files connected to more than 80,000 veterans and their widows.</p>

<p>“The pensions are revealing the stunning—frequently heartbreaking and sometimes funny—complexity, nuance and previously unknown details about the American Revolution and the nation in the decades after,” says Joanne Blacoe, an interpretation planner for the NPS, in a&nbsp;<a href="https://www.nps.gov/articles/000/revolutionary-war-pensions.htm">statement</a>. “It’s rich content that will benefit [national] parks and inspire artists, researchers and families connecting to ancestors.”</p><blockquote data-instgrm-captioned="" data-instgrm-permalink="https://www.instagram.com/p/DB1IAEOJTsZ/?utm_source=ig_embed&amp;utm_campaign=loading" data-instgrm-version="14"></blockquote>

<p>Volunteers can spend as much or as little time as they want transcribing and tagging. Some participants have dedicated years of their lives to the program—like Alex Smith, a retiree from Pennsylvania. Over nine years, he transcribed more than 100,000 documents, as&nbsp;<a href="https://wtop.com/government/2024/03/curious-and-fluent-in-cursive-the-national-archives-is-looking-for-you/">WTOP</a>’s Kate Ryan reported in March 2024.</p>

<p>“I was looking for something to give purpose, and could give some structure to my retired life,” he said. “It was just perfect.”</p>

<p>For Smith, the transcription work is also a chance to peer back in time and connect with Americans of the past. He’s been surprised by some documents, like a note inviting Gerald Ford to <a href="https://footballfoundation.org/sports/general/roster/gerald-r--ford/18">join the Green Bay Packers</a>, and moved by others, like Civil War pension records.</p>

<p>“You’re seeing people in desperate straits,” Smith told WTOP. “They’re trying desperately to get some reasonable pension paid to them, and you think, ‘These are individual tragedies.’”</p>

<p>Though cursive instruction was once standard, today’s educators and lawmakers are <a href="https://www.nea.org/nea-today/all-news-articles/great-cursive-writing-debate">divided</a>: Should schools emphasize penmanship or keyboard skills? But even as laptops, tablets and other devices become more ubiquitous, cursive is making a comeback. More than 20 states now require schools to teach cursive, according to <a href="https://www.edweek.org/policy-politics/the-number-of-states-that-require-schools-to-teach-cursive-is-growing/2024/11"><em>Education Week</em></a>’s Brooke Schultz.</p>

<p>In California, a law mandating cursive instruction took effect in January 2024.</p>

<p>“For some students, it’s a great alternative to printing, and it helps them be more accurate and more careful with the writing,” Erica Ingber, principal of Longfellow Elementary School in Pasadena, told the&nbsp;<a href="https://www.latimes.com/california/story/2024-01-08/topsy-curvy-cursive-writing-returns-to-the-list-of-priorities-in-california-schools"><em>Los Angeles Times</em></a>’ Howard Blume last year. “And then for others, it’s just another thing that is difficult for them.”</p>

<p>A few months later, another law requiring cursive instruction passed in Kentucky.</p>

<p>“We don’t want this to become a lost art,” Sean Howard, superintendent of Kentucky’s Ashland Independent School District, told <a href="https://www.wsaz.com/2024/08/03/new-bill-requires-all-elementary-school-grades-learn-cursive-kentucky/">WSAZ</a>’s Abbey Lord in August 2024. “There is research that connects the ability to read and fluency … to the ability to write cursive.”</p>

        

        

        
          
  <div>
      <p>Get the latest stories in your inbox every weekday.</p>
      
    </div>


        

        

        
          


  
    
      
    
  

  


        

        
        
        
        

        
          
            <section>
              <nav>Filed Under:
                
                  
                    <a href="https://www.smithsonianmag.com/tag/american-history/">American History</a>, 
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/american-writers/">American Writers</a>, 
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/archives/">Archives</a>, 
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/digitization/">Digitization</a>, 
                  
                
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/historical-documents/">Historical Documents</a>, 
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/history/">History</a>, 
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/national-archives/">National Archives</a>, 
                  
                
                  
                    <a href="https://www.smithsonianmag.com/tag/writers/">Writers</a>
                  
                
              </nav>
            </section>
          
        

      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[EFF statement on U.S. Supreme Court's decision to uphold TikTok ban (187 pts)]]></title>
            <link>https://www.eff.org/deeplinks/2025/01/eff-statement-us-supreme-courts-decision-uphold-tiktok-ban</link>
            <guid>42744695</guid>
            <pubDate>Sat, 18 Jan 2025 00:32:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.eff.org/deeplinks/2025/01/eff-statement-us-supreme-courts-decision-uphold-tiktok-ban">https://www.eff.org/deeplinks/2025/01/eff-statement-us-supreme-courts-decision-uphold-tiktok-ban</a>, See on <a href="https://news.ycombinator.com/item?id=42744695">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
      <div>
        <div>
            <article role="article">
  
  
  <div><p><span>We are deeply disappointed that the Court failed to require the strict First Amendment scrutiny required in a case like this, which would’ve led to the inescapable conclusion that the government's desire to prevent potential future harm had to be rejected as infringing millions of Americans’ constitutionally protected free speech. We are disappointed to see the Court sweep past the undisputed content-based justification for the law – to control what speech Americans see and share with each other – and rule only based on the shaky data privacy concerns.</span></p>
<p><span>The United States’ foreign foes easily can steal, scrape, or buy Americans’ data by countless other means. The ban or forced sale of one social media app will do virtually nothing to protect Americans' data privacy – only comprehensive consumer privacy legislation can achieve that goal. Shutting down communications platforms or forcing their reorganization based on concerns of foreign propaganda and anti-national manipulation is an eminently anti-democratic tactic, one that the US has previously condemned globally.</span></p>

</div>

          </article>
    </div>
<div>
          <h2>Related Issues</h2>
            </div>

<div>
          <h2>Join EFF Lists</h2>
        
    </div>
<div>
          <h2>Related Updates</h2>
        <div>
        
  
  
  
  
  <div>
    <article role="article">
      <header>
                    <h3><a href="https://www.eff.org/deeplinks/2024/12/effs-2024-battle-against-online-age-verification-defending-youth-privacy-and-free" rel="bookmark">Fighting Online ID Mandates: 2024 In Review</a></h3>
            
    </header>
  
  
  <div><p>This year, nearly half of U.S. states passed laws imposing age verification requirements on online platforms. Though age verification mandates are often touted as “online safety” measures for kids, the laws actually do more harm than good.</p></div>

          </article>
  </div>
  
  
  <div>
    <article role="article">
      <header>
                    <h3><a href="https://www.eff.org/deeplinks/2024/12/saving-internet-europe-defending-free-expression" rel="bookmark">Saving the Internet in Europe: Defending Free Expression </a></h3>
            
    </header>
  
  
  <div><p><i>This post is part two in a series of posts about EFF’s work in Europe. Read about how and why we work in Europe </i><a href="https://www.eff.org/deeplinks/2024/12/saving-internet-europe-how-eff-works-europe"><i>here</i></a><i>.</i> EFF’s mission is to ensure that technology supports freedom, justice, and innovation for all people of the world. While our work has taken us...</p></div>

          </article>
  </div>
  
    </div>    </div>
      </div>

      <div><h2>Related Issues</h2></div>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Investigating an "Evil" RJ45 Dongle (449 pts)]]></title>
            <link>https://lcamtuf.substack.com/p/investigating-an-evil-rj45-dongle</link>
            <guid>42743033</guid>
            <pubDate>Fri, 17 Jan 2025 20:41:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lcamtuf.substack.com/p/investigating-an-evil-rj45-dongle">https://lcamtuf.substack.com/p/investigating-an-evil-rj45-dongle</a>, See on <a href="https://news.ycombinator.com/item?id=42743033">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><p>When it comes to information security headlines, a good rule of thumb is that claims about about widespread supply-chain sabotage are usually false. It’s not that attacks of this sort can’t happen; it’s that they’re complicated, time-consuming, and risky to pull off. It’s what you use when you’re out of options. Most of the time, it’s much simpler to steal credentials or get someone to download a malicious file.</p><p>Earlier this week, a young entrepreneur caused stir on social media by suggesting that an Ethernet-to-USB they purchased from China was preloaded with malware that “evaded virtual machines”, “captured keystrokes”, and “used Russian-language elements”. </p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg" width="1006" height="850" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:850,&quot;width&quot;:1006,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;Image&quot;,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="Image" title="Image" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1456w" sizes="100vw" fetchpriority="high"></picture></div></a><figcaption><em>OK, it did not say that.</em></figcaption></figure></div><p><span>The revelations have gotten millions of views, but details were quite hazy. The poster shared an </span><a href="https://www.hybrid-analysis.com/sample/e3f57d5ebc882a0a0ca96f9ba244fe97fb1a02a3297335451b9c5091332fe359/6783acb889e814045f0a2da6" rel="">ambiguous antivirus scan report</a><span> from Crowdstrike Falcon, but that seemed to be a red herring: the binary was a self-extracting EXE created using 7-Zip, a well-known open-source archiver authored by Ivan Pavlov. The author’s nationality accounted for the ominous “Russian-language elements”; the nature of self-extracting archives that install drivers explained most of the rest. Finally, the contents of the archive seemed to match a signed, publicly-available 2.0.7.0 driver for an RJ45-to-USB chip made by CoreChips Shenzhen — a company that also calls itself Corechip Semiconductor in the accompanying </span><em>.inf</em><span> file.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png" width="1456" height="884" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/ea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:884,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:78230,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1456w" sizes="100vw"></picture></div></a><figcaption><em>Yeah, it’s pretty much supposed to do that stuff.</em></figcaption></figure></div><p><span>The driver referenced a chip named </span><a href="https://wmsc.lcsc.com/wmsc/upload/file/pdf/v2/lcsc/1912111437_CoreChips-SR9900_C403645.pdf" rel="">SR9900</a><span>; virtually no publicly-available info is available about the chip or its maker, but after some sleuthing, I believe it’s a direct clone of </span><a href="https://www1.futureelectronics.com/doc/Realtek/Realtek-Semicon-RTL8152B-VB-CG_C50656.pdf" rel="">Realtek RTL8152B</a><span>. The English-language product brief implies that “SR” stands for “Supereal”; that brand name comes up in the context of </span><a href="https://zeptobars.com/en/read/FTDI-FT232RL-real-vs-fake-supereal" rel="">counterfeit FTDI FT232RL chips</a><span> that plagued the industry some time ago.</span></p><p>Other than the potential for IP tomfoolery, the lineage of the chip is important because the original Realtek design is pretty old; the datasheet was released in 2013. The devices support 100BASE-TX and USB 2.0, and hearken back to the era of Windows 7. This was an awkward period when CD-ROM drives were going out of fashion, but not every computer could be assumed to be permanently online. It made sense for some gadgets to present themselves as mass storage devices containing their own drivers — and from the security standpoint, it wasn’t better or worse than any other ad-hoc way to deliver the file.</p><p><span>In other words, given the historical context, nothing about the driver seemed particularly odd. That said, the poster implied there’s more to the story: they shared teardown photos and pointed to a sparsely-populated PCB with a </span><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/SST25VF040B-4-Mbit-SPI-Serial-Flash-Data-Sheet-20005051F.pdf" rel="">25x40-type</a><span> serial flash IC mounted next to the aforementioned SR9900:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg" width="1456" height="1092" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/a1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1092,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;Image&quot;,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="Image" title="Image" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1456w" sizes="100vw"></picture></div></a><figcaption><em>One of the original teardown pics. From social media.</em></figcaption></figure></div><p><span>Why did the device need 512 kB of flash memory? Was this for firmware, or was it where </span><em>they </em><span>kept our stolen packets?… To be clear, it’s not wrong to ask! Malicious hardware has plenty of precedent: it’s been used by intelligence agencies and private pentesters alike. Heck, a bit over a decade ago, I built an </span><a href="https://lcamtuf.coredump.cx/plasma_globe/" rel="">evil plasma globe</a><span> for work. Still, we weren’t here to debate whether a malicious RJ45-to-USB adapter </span><em>could</em><span> be made. The important question was whether in this particular instance — as the poster put it — “the Chinese were at it again”.</span></p><p>Unfortunately, the specs for SR9900 and RTL8152B are equally vague about the purpose of the companion flash IC. I dug up the following architectural outline, but it didn’t offer any special insights:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png" width="1456" height="1016" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1016,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:119026,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>CoreChips SR9900 architecture, from the product brief.</em></figcaption></figure></div><p>Image search for schematics proved to be another dead end; I found several designs featuring the original Realtek chip, but there was nothing hooked up to the serial pins:</p><p><span>I was ready to head over to the Dark Web (</span><em>amazon.com</em><span>) and purchase one of the dongles just to dump the contents of the memory chip. The Serial Peripheral Interface (SPI) bus is trivial to work with: in essence, you supply a clock signal at any speed you like; pressing a button by hand would do. At the rising edge of every clock cycle, the peripheral reads one bit on the “serial in” line, while the host reads one “serial out” bit back. There are no handshakes, headers, parity bits, or control flow.</span></p><p>The “application” protocol of the flash chip equally simple and is common to almost all serial memory ICs. To get things going, the host sends a 1-byte READ instruction (0x03), followed by three address bytes. The chip starts sending data immediately after receiving the entire four-byte sequence, and keeps streaming bits for as long as the host clock signal is supplied:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png" width="1456" height="447" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:447,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:108659,&quot;alt&quot;:&quot;&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>Serial memory read protocol. From the Microchip 25x40 spec.</em></figcaption></figure></div><p><span>But then, with the item in my cart, I had an epiphany: I went to the website of CoreChips and used Google Translate to pinpoint the original Chinese text for the “</span><em>SR9900 series chip Windows system mass production tool</em><span>”. I searched for the matching string and found a couple of old Chinese-language forum threads; one of them led me to a password-protected and paywalled download named “</span><em>SR9900(A)设计资料1018.rar</em><span>” . Some $2.99 later, I was the happy owner of an archive containing a very retro-looking SR9900 production tool:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png" width="1456" height="994" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:994,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:419079,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>Ah, to be young again…</em></figcaption></figure></div><p><span>With it, came a 168 kB ISO 9660 (!) filesystem image containing a self-extracting Windows driver; the programming tool puts the .</span><em>iso</em><span> file verbatim onto the SPI flash. Yep: the chip just acts as a “software-defined” CD-ROM, a drop-in replacement for the physical media you’d have gotten with such gear before. You can download the disk image </span><a href="https://lcamtuf.coredump.cx/blog/sr9900-iso.7z" rel="">here</a><span>; the password is “rj45”.</span></p><p>As an aside, the CD-ROM image was created with “ULTRAISO V9.3 CD &amp; DVD CREATOR, (C) EZB SYSTEMS” — another decidedly retro piece straight from the days of Windows XP:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif" width="785" height="574" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:574,&quot;width&quot;:785,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>This is how we used to hack.</em></figcaption></figure></div><p>If you want to try it, be aware that it requires Intel Pentium 166MHz or above.</p><p><span>Corroborating the findings, the main archive also included a document titled </span><em>“SR9900(A)设计前必看.docx”.</em><span> The doc contained the following (auto-translated) passage:</span></p><blockquote><p><em>“When SR9900 is used as a USB network card (consumer computer peripheral market), the SPI can be used as a virtual optical drive when installing the windows system driver (SPI-flash will pre-burn the SR9900 driver under the windows system)”</em></p></blockquote><p>It also underscored that the use of the flash chip was optional.</p><p><span>So there you have it; the predictable, anticlimactic conclusion is that </span><em>weird</em><span> is not always </span><em>bad. </em><span>To get to that point, we didn’t need a hardware lab; a bit of patience and Google-fu was enough.</span></p><p><span>To be fair, we’re leaving one stone unturned: the SR9900 IC itself contains two small microcontroller cores — USB and Ethernet — each running some internal code. If we felt the chip maker was somehow complicit, I think it would be possible to peek inside. Realtek provides an open-source </span><a href="https://github.com/awesometic/realtek-r8152-dkms/blob/master/src/r8152.c#L5834" rel="">Linux driver</a><span> for RTL8152 that does some in-memory patching of the firmware; to my eye, there doesn’t appear to be any encryption or signing going on.</span></p><p><span>Should you be worried about the possibility of being sent an evil USB dongle from faraway lands? If you’re a scientist working on the Iranian nuclear program, probably! If you’re a CISO of a strategically important civilian business, some caution would be advised too: there might be an intelligence analyst with a spreadsheet of all your vendors, </span><em>just in case.</em></p><p>But for home networking, it seems that we get to live another day.</p><p><em>If you liked this article, please subscribe! Unlike most other social media, Substack is not a walled garden and not an addictive doomscrolling experience. It’s just a way to stay in touch with the writers you like.</em></p></div></article></div><div id="discussion"><h4>Discussion about this post</h4></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[So You Want to Build Your Own Data Center (458 pts)]]></title>
            <link>https://blog.railway.com/p/data-center-build-part-one</link>
            <guid>42743019</guid>
            <pubDate>Fri, 17 Jan 2025 20:41:07 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.railway.com/p/data-center-build-part-one">https://blog.railway.com/p/data-center-build-part-one</a>, See on <a href="https://news.ycombinator.com/item?id=42743019">Hacker News</a></p>
<div id="readability-page-1" class="page"><section><p><span>Since the beginning, Railway’s compute has been built on top of Google Cloud Platform. The platform supported Railway's initial journey, but it has caused a multitude of problems that have posed an existential risk to our business. More importantly, building on a hyperscaler prevents us from delivering the best possible platform to our customers. </span></p><p><span>It directly affected the pricing we could offer (egress fees anyone?), limited the level of service we could deliver, and introduced engineering constraints that restricted the features we could build. </span></p><p><span>And not only is it </span><a href="https://github.com/GoogleCloudPlatform/guest-agent/issues/401" target="_blank" rel="noreferrer noopener"><span>rare</span></a><span> that we understand </span><a href="https://blog.railway.com/p/2023-12-01-incident-report" target="_blank" rel="noreferrer noopener"><span>why</span></a><span> </span><a href="https://x.com/JustJake/status/1667478906591666176" target="_blank" rel="noreferrer noopener"><span>things</span></a><span> </span><a href="https://blog.railway.com/p/incident-december-16-2024" target="_blank" rel="noreferrer noopener"><span>break</span></a><span> upstream, but also despite multi-million dollar annual spend, we get about as much support from them as you would spending $100. </span></p><p><span>So in response, we kicked off a Railway Metal project last year. Nine months later we were live with the first site in California, having designed, spec-ed, and installed everything from the fiber optic cables in the cage to the various contracts with ISPs. We’re lighting up three more data center regions as we speak.</span></p><p><span>To deliver an “infra-less” cloud experience to our customers, we’ve needed to get good fast at building out our own physical infrastructure. That’s the topic of our blogpost today.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#so-you-want-to-build-a-cloud"><h2><span>So you want to build a cloud</span></h2></a></p><p><span>From kicking off the Railway Metal project in October last-year, it took us five long months to get the first servers plugged in. It took us an additional three months before we felt comfortable letting our users onto the hardware. </span></p><p><span>The first step was finding some space.</span></p><p><span>When you go “on-prem” in cloud-speak, you need somewhere to put your shiny servers and reliable power to keep them running. Also you want enough cooling so they don’t melt down. </span></p><p><span>In general you have three main choices: Greenfield buildout (buying or leasing a datacenter), Cage Colocation (getting a private space inside a provider's  datacenter enclosed by mesh walls), or Rack colocation (leasing individual racks or partitions of racks in a colocation datacenter). </span></p><p><span>We chose the second option: a cage to give us four walls, a secure door, and a blank slate for everything else.</span></p><div><p><img alt="A cage before any racks have been fitted" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A cage before any racks have been fitted</p></div><p><span>The space itself doesn’t cost much, but power (and by proxy, cooling) costs the most. Depending on the geography, the $/kW rate can vary hugely — on the US west coast for example we may pay less than half as much as we pay in Singapore. Power is paid for as a fixed monthly commit, regardless of whether its consumed or not, to guarantee it will be available on-demand.</span></p><p><span>But how much power do you need?</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#with-great-power-comes-great-responsibility"><h2><span>With great power comes great responsibility</span></h2></a></p><p><span>Ideally if you’ve embarked on your data center migration mission, you should have an idea of the rough amount of compute you want to deploy. We started with a target number of vCPUs, GBs of RAM, and TBs of NVMe to match our capacity on GCP. </span></p><p><span>Using these figures, we converged on a server and CPU choice. There are many knobs to turn when doing this computation — probably worth a blogpost in itself — but the single biggest factor for us was power density e.g. how do we get the compute density we want inside of a specific power draw. </span></p><p><span>The calculations aren’t as simple as summing watts though, especially with 3-phase feeds — Cloudflare has </span><a href="https://blog.cloudflare.com/an-introduction-to-three-phase-power-and-pdus/" target="_blank" rel="noreferrer noopener"><span>a great blogpost</span></a><span> covering this topic.</span></p><p><span>Power is the most critical resource for data centers, and a power outage can have extremely long recovery times. So redundancy is critical, and it’s important to have two fully independent power feeds per rack. Both feeds will share load under normal operation, but the design must be resilient to a feed going down.</span></p><p><span>To deliver this power to your servers, you’ll also want a Power Distribution Unit, which you'll  select based on the number of sockets and management features it provides. The basic ones are glorified extension cords, while the ones we deploy allow control and metering of individual sockets.</span></p><div><p><img alt="Each PDU is accessible over the network and individual sockets can be remotely metered and controlled" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>Each PDU is accessible over the network and individual sockets can be remotely metered and controlled</p></div><p><span>With that, power is now available in the cage.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#let-there-be-light"><h2><span>Let there be light</span></h2></a></p><p><span>No cloud machine is an island </span><span>and that's where networks come into play. </span></p><p><span>To achieve the lowest possible latency on Railway, we need to set you up with solid connections to the rest of the world. </span></p><p><span>We look for DC facilities that are on-network with Tier 1 Internet Services Providers (ISPs), that are part of an Internet Exchange (IX), and that have available fiber to other data centers in close proximity. </span></p><div><p><img alt="Each cage gets diverse and redundant network links" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>Each cage gets diverse and redundant network links</p></div><p><span>Your applications deployed to Railway will want to connect to a diverse mix of endpoints over the network — be it a home internet user in Sydney, Australia or a API hosted on an AWS server in the US. To get you the best possible latency and the lowest bandwidth cost, we contract with a mix of internet providers optimized for each use case.</span></p><p><span>We select ISPs for the maturity of their networks in each geography we target. Partnering with the wrong ISP in a region can lead to extra network hops (and thus latency) to reach specific target markets — or in the worst case — convoluted network routes. So for each region, we pick at least two separate networks based on their regional footprints. </span></p><p><span>Once connected, we receive full internet routing tables from each ISP and consolidate them on our network switches to resolve the best path for each IP prefix. If you have an end user in Australia trying to reach an app deployed to Singapore, we’ll likely hand those packets off directly to </span><a href="https://bgp.tools/as/4637#connectivity" target="_blank" rel="noreferrer noopener"><span>Telstra</span></a><span> who have one of the densest access networks in Australia. If that same app needs to send packets to a end-user or server in Japan, then we’d likely be handing them over to PCCW who peer directly with NTT in Japan and have a </span><a href="https://www.pccwglobal.com/wp-content/uploads/2019/11/world_fold_20191115.pdf" target="_blank" rel="noreferrer noopener"><span>dense footprint in APAC</span></a><span>.</span></p><div><p>👉</p><div><p><span>Peering information is public, head-over to </span><a href="https://bgp.tools/" target="_blank" rel="noreferrer noopener"><span>bgp.tools</span></a><span> to see how your favorite networks interconnect.</span></p></div></div><p><span>For redundancy we’re building out multiple zones in each region, and interconnectivity between these sites is also critical for our expansion. There are several tools such as dark fiber or wavelength services that we look for to plan this expansion. The result is that your apps won’t notice if your database is in the same room or if it’s 4 blocks over in a neighboring building — this is a feature not a bug — as it builds resilience against the failure of an individual data center.</span></p><p><span>...</span></p><p><span>Ok, now that you’ve found a space you like, signed a deal with a data center, and signed deals with several ISPs, you're all-systems-go to install some servers, right? </span></p><p><span>Well, not exactly. First you need a bunch of other things to give your server a nice snug home to warm up in.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#aisles,-racks-and-overhead-infrastructure"><h2><span>Aisles, racks and overhead infrastructure</span></h2></a></p><p><span>In a data center, racks are arranged in rows, and the space between racks, the aisle, is used for airflow. </span></p><p><span>The Cold Aisle is where cold air is blown in from the DC facility, and servers in your rack suck this air up and exhaust it towards the rear onto the Hot Aisle. The DC facility will remove this hot air from the Hot Aisle. For optimum efficiency, you don’t want air between these aisles to mix.</span></p><div><p><img alt="A cage schematic - all equipment must be mounted such that fans blow air from the cold aisle to the hot" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A cage schematic - all equipment must be mounted such that fans blow air from the cold aisle to the hot</p></div><p><span>The racks themselves have some variability, even if you opt to use conventional 19" wide equipment. You can select the height, width, and depth to suit your equipment and cabling needs. </span></p><p><span>Most server equipment can slide on rails to allow for easy maintenance, so it’s important to ensure that cage dimensions allow for this. Cabling and cable management also requires some space, so there’s a tradeoff to be made with how crowded you want each rack to be vs. how many racks you can fit into a cage. </span></p><p><span>In our experience, power and cooling is often the limiting factor rather than the actual space available. In newer sites we opt for wider 800mm racks to allow for better airflow by getting cables out of the way of the exhausts.</span></p><div><p><img alt="A rack-mount server on rails can be pulled out and serviced in place, each weighs nearly 20kg…" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A rack-mount server on rails can be pulled out and serviced in place, each weighs nearly 20kg…</p></div><p><span>In addition to racks, you'll need several bits of infrastructure to get power and data to your racks. This will likely involve installing some overhead infrastructure and trays that let you route fiber cables from the edge of your cage to each of your racks, and to route cables between racks. This is something the DC operator will throw in when quoting the cage.</span></p><p><span>Depending on your design, you’ll want to optimize for short cable paths by ensuring your overhead infrastructure, rack local cabling, and device orientations align. Because our racks have dense switch-to-server fiber cabling in each rack, we buy switches that have their ports oriented to the back of the rack (these are called reverse airflow switches because they exhaust air on the side with the network ports). </span></p><p><span>This allows us to align the cable trays such that all cabling happens on one side of the rack and there’s no zig-zagging of cables between the front and back of the rack.</span></p><div><p><img alt="A ladder rack and fibre cable tray allow routing cables to racks from above" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A ladder rack and fibre cable tray allow routing cables to racks from above</p></div><p><span>So you’ve got the space, signed up ISPs, ordered the hardware, got the racks, and a pretty good picture on how to lay it all out. But it’s still a pretty expensive lego set sitting in the loading bay of a data center. To assemble it you now need to leverage the most versatile programming tool ever devised in the history of mankind … Microsoft Excel.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#the-rack-and-stack"><h2><span>The rack and stack</span></h2></a></p><p><span>Let’s first step back and publish a disclaimer: neat and organized cabling requires a lot of practice; we tried it ourselves first - with… </span><span>mixed…</span><span> results. </span></p><div><p><img alt="Our DIY attempts at cabling to get the first server online vs. what our installation partner put together" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>Our DIY attempts at cabling to get the first server online vs. what our installation partner put together</p></div><p><span>To install it properly, we bring in professionals, but the professionals need to know what to install. A comprehensive documentation pack is essential. A cabling matrix and rack elevation are common documents that communicate to contractors how to rack and wire-up servers.</span></p><p><span>A cabling matrix describes the termination of each cable, specifying the device position and port for each side of the connection, along with the specification of the cable itself (type of fiber, length, etc). The rack elevation is a visual representation of the rack itself, showing the position and orientation of each device.</span></p><div><p><img alt="The cabling matrix for our first install - 300+ cables all manually entered and cross-checked" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>The cabling matrix for our first install - 300+ cables all manually entered and cross-checked</p></div><p><span>The documentation exercise can be intense, each of our install phases involved 60+ devices, 300+ discrete cables, and dozens of little details. This was all  handcrafted into written specifications and spreadsheets we used as a basis for the installation and commissioning. From the materials being on site to getting everything installed takes us about 6-14 days.</span></p><div><p><img alt="We have now built internal tooling to automate generating build specifications" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>We have now built internal tooling to automate generating build specifications</p></div><p><span>This all seems very far removed from software, DevOps, or what you’d typically think of as “infrastructure,” and that is very true — building a datacenter cage is probably closer to building a house than to deploying a Terraform stack. </span></p><p><span>To compound this, every datacenter facility, contractor and  vendor will do things slightly differently, even within the same organization. The operational aspect requires you to stay on your toes and be extremely detail-oriented. </span></p><p><span>Some what-the-duck moments we’ve had thus far:</span></p><ul><li><span>Contractor: “We need longer power cables” - the PDUs at that site were upside down because the power came in from the floor, so our socket numbering was reversed in the plan</span></li><li><span>Phonecall from Amsterdam: “There’s no demarcation point at the site?” - a specific facility installs external fibre links direct to a box in one of our racks rather than via a dedicated demarcation point overhead</span></li><li><span>Railway Discord quote: “Why are the phases wired so weirdly on this PDU?” - the facility was wired differently to our other sites and the power sockets were wired phase-to-neutral vs. phase-to-phase (WYE vs Delta circuits for you EE’s)</span></li><li><span>Contractor: “Your data cables are too short” - the contractor didn’t realize the network gear was reverse-airflow and tried to mount things the wrong way around</span></li><li><span>Us raising a support ticket: “There’s no link coming up on this cable” - the fiber was wired in the wrong polarity; we learnt what “rolling fibre cables” was that day… it’s when they rip out the plugs from the </span><a href="https://www.fs.com/uk/blog/lc-fiber-optics-a-comprehensive-guide-2684.html" target="_blank" rel="noreferrer noopener"><span>LC connector</span></a><span> and swap them around</span></li><li><span>Railway Discord quote: “I brought a rubber mallet from HomeDepot today” - a batch of nearly 24 PDUs from one vendor were delivered with faulty sockets that didn’t properly engage with the power plugs, even with </span><span>appropriate</span><span> extreme mechanical force being applied</span></li></ul><p><span>But from this point - the hardware is in place the task begins to feel more familiar; we’re now needing to do some BGP, install some OS’es, setup monitoring and bring everything up.</span></p><div><p><img alt="The completed cage ready for configuration" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>The completed cage ready for configuration</p></div><p><a href="https://blog.railway.com/p/data-center-build-part-one#pedal-on-metal"><h2><span>Pedal on Metal</span></h2></a></p><p><span>The installed cage is but a blank canvas, the network devices need configuring, router config needs writing, RIR (regional internet registry) records need updating, and we must interact with the likes of </span><a href="https://www.dmtf.org/standards/redfish" target="_blank" rel="noreferrer noopener"><span>Redfish APIs</span></a><span> (HTTP APIs to dedicated controllers on server motherboards and PDUs) and PXE (a protocol to boot servers over the network) to get everything up and running. </span></p><p><span>We've also not discussed how networking works. Our design uses </span><a href="https://frrouting.org/" target="_blank" rel="noreferrer noopener"><span>FRR</span></a><span> and whitebox network switches running </span><a href="https://sonicfoundation.dev/" target="_blank" rel="noreferrer noopener"><span>SONiC</span></a><span> to build a L3-only software-driven network that deeply integrates with our control plane. </span></p><p><span>We’ve regaled you with tales from the frontline … but any more and you’d be here all day. </span></p><p><span>In a future post, we’ll discuss how we go from a bunch of servers in a room to a functional Railway zone. In the space of the last few months we’ve built two new software tools, </span><span>Railyard</span><span> and </span><span>MetalCP</span><span>, to enable a button click experience from designing a new cage, tracing and visualizing the cabling, to installing OSes on servers and getting them on the internet.</span></p><p><span>Until then, if any of this excites you, check out our </span><a href="https://railway.com/careers/infra-platform" target="_blank" rel="noreferrer noopener"><span>open Infrastructure Engineering roles</span></a><span> and reach out if they catch your interest.</span></p></section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Compile C to Not Gates (134 pts)]]></title>
            <link>https://github.com/tomhea/c2fj</link>
            <guid>42742350</guid>
            <pubDate>Fri, 17 Jan 2025 19:36:37 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/tomhea/c2fj">https://github.com/tomhea/c2fj</a>, See on <a href="https://news.ycombinator.com/item?id=42742350">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a href="https://github.com/tomhea/c2fj/blob/main/LICENSE"><img src="https://camo.githubusercontent.com/374f407140f12d3231e2372cd262efe797423d76ceb5767606dfca26ff6adc2f/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f746f6d6865612f6332666a" alt="GitHub" data-canonical-src="https://img.shields.io/github/license/tomhea/c2fj"></a>
<a href="https://esolangs.org/wiki/FlipJump" rel="nofollow"><img src="https://camo.githubusercontent.com/36d3a6fb034708ad2e1e392abd9ac46c902bc03cf307aff7ab388d3364512a92/68747470733a2f2f696d672e736869656c64732e696f2f776562736974653f646f776e5f636f6c6f723d72656426646f776e5f6d6573736167653d646f776e2675705f6d6573736167653d75702675726c3d687474707325334125324625324665736f6c616e67732e6f726725324677696b69253246466c69704a756d70" alt="Website" data-canonical-src="https://img.shields.io/website?down_color=red&amp;down_message=down&amp;up_message=up&amp;url=https%3A%2F%2Fesolangs.org%2Fwiki%2FFlipJump"></a>
<a href="https://pypi.org/project/c2fj/" rel="nofollow"><img src="https://camo.githubusercontent.com/e5304c16795d7b9fc0409a1ae042cfb36829707a615ef4e026b91d2aa1361ef2/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f6332666a" alt="PyPI - Version" data-canonical-src="https://img.shields.io/pypi/v/c2fj"></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">c2fj</h2><a id="user-content-c2fj" aria-label="Permalink: c2fj" href="#c2fj"></a></p>
<p dir="auto">Compiling C --&gt; RiscV --&gt; <a href="https://github.com/tomhea/flip-jump">Flipjump</a> --&gt; .fjm</p>
<p dir="auto">This compiler is a proof that any program can be compiled into a bunch of <code>NOT</code> operations. Read more about FlipJump: <a href="https://github.com/tomhea/flip-jump">Github</a>, <a href="https://esolangs.org/wiki/FlipJump" rel="nofollow">esolangs</a>.</p>
<p dir="auto">An example program, <a href="https://github.com/tomhea/c2fj/blob/main/tests/programs/primes/main.c">primes/main.c</a>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="int main() {
    printf(&quot;Calculate primes up to: &quot;);
    int max_number;
    scanf(&quot;%d&quot;, &amp;max_number);
    
    ...
    
    for (int p = 3; p <= max_number; p += 2) {
        if (non_prime[p] == false) {
            for (int i = p*p; i <= max_number; i += p) {
                non_prime[i] = true;
            }
            printf(&quot;%d\n&quot;, p);
        }
    }
    
    return 0;
}"><pre><span>int</span> <span>main</span>() {
    <span>printf</span>(<span>"Calculate primes up to: "</span>);
    <span>int</span> <span>max_number</span>;
    <span>scanf</span>(<span>"%d"</span>, <span>&amp;</span><span>max_number</span>);
    
    ...
    
    <span>for</span> (<span>int</span> <span>p</span> <span>=</span> <span>3</span>; <span>p</span> &lt;= <span>max_number</span>; <span>p</span> <span>+=</span> <span>2</span>) {
        <span>if</span> (<span>non_prime</span>[<span>p</span>] <span>==</span> false) {
            <span>for</span> (<span>int</span> <span>i</span> <span>=</span> <span>p</span><span>*</span><span>p</span>; <span>i</span> &lt;= <span>max_number</span>; <span>i</span> <span>+=</span> <span>p</span>) {
                <span>non_prime</span>[<span>i</span>] <span>=</span> true;
            }
            <span>printf</span>(<span>"%d\n"</span>, <span>p</span>);
        }
    }
    
    <span>return</span> <span>0</span>;
}</pre></div>
<p dir="auto">Compiled into this:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tomhea/c2fj/blob/main/res/compiled_elf.png"><img src="https://github.com/tomhea/c2fj/raw/main/res/compiled_elf.png" alt="img.png"></a></p>
<p dir="auto">Which was compiled into this:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tomhea/c2fj/blob/main/res/compiled_fj_files.png"><img src="https://github.com/tomhea/c2fj/raw/main/res/compiled_fj_files.png" alt="img.png"></a></p>
<p dir="auto">Which in turn compiled into:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tomhea/c2fj/blob/main/res/compiled_fjm.png"><img src="https://github.com/tomhea/c2fj/raw/main/res/compiled_fjm.png" alt="img.png"></a></p>
<p dir="auto">Now, run it (Remember, these are flipjump ops that are running):</p>
<div data-snippet-clipboard-copy-content="Calculate primes up to: 20
2
3
5
7
11
13
17
19
Program exited with exit code 0x0."><pre lang="text"><code>Calculate primes up to: 20
2
3
5
7
11
13
17
19
Program exited with exit code 0x0.
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">How to install</h2><a id="user-content-how-to-install" aria-label="Permalink: How to install" href="#how-to-install"></a></p>
<div data-snippet-clipboard-copy-content=">>> pip install c2fj
>>> sudo apt install picolibc-riscv64-unknown-elf"><pre><code>&gt;&gt;&gt; pip install c2fj
&gt;&gt;&gt; sudo apt install picolibc-riscv64-unknown-elf
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">How to use</h2><a id="user-content-how-to-use" aria-label="Permalink: How to use" href="#how-to-use"></a></p>
<p dir="auto">Simply <code>python3 c2fj.py file.c</code> will compile your c file into an elf, into fj files, into fjm, then run it.</p>
<p dir="auto"><code>c2fj</code> supports the next flags:</p>
<ul dir="auto">
<li><code>--breakpoints</code> Place a fj-breakpoint at the start of the specified riscv addresses</li>
<li><code>--single-step</code> Place fj-breakpoints at the start of all riscv opcodes</li>
<li><code>--unify_fj</code> Unify the generated fj files into a single file</li>
<li><code>--finish-after</code> Stop the compilation at any step (before running, before creating fjm, etc.)</li>
<li><code>--build-dir</code> Save the builds in this directory</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">What if my project is more then a single c?</h2><a id="user-content-what-if-my-project-is-more-then-a-single-c" aria-label="Permalink: What if my project is more then a single c?" href="#what-if-my-project-is-more-then-a-single-c"></a></p>
<p dir="auto">We support specifying a <code>Makefile</code> path, instead of the c file!<br>
Your Makefile will have to rely on some constants that <code>c2fj</code> will fill:</p>
<div dir="auto" data-snippet-clipboard-copy-content="C2FJ_GCC_OPTIONS
C2FJ_LINKER_SCRIPT
C2FJ_SOURCES
C2FJ_INCLUDE_DIRS
ELF_OUT_PATH"><pre><span>C2FJ_GCC_OPTIONS</span>
<span>C2FJ_LINKER_SCRIPT</span>
<span>C2FJ_SOURCES</span>
<span>C2FJ_INCLUDE_DIRS</span>
<span>ELF_OUT_PATH</span></pre></div>
<p dir="auto">An example Makefile:</p>
<div dir="auto" data-snippet-clipboard-copy-content="GCC := riscv64-unknown-elf-gcc
GCC_FLAGS := -O3

SOURCES := $(C2FJ_SOURCES) main.c globals.c calculate_int.c
OBJECTS := $(SOURCES:.c=.o)

all: |
	$(GCC) $(C2FJ_GCC_OPTIONS) $(GCC_FLAGS) $(SOURCES) -I $(C2FJ_INCLUDE_DIRS) -T $(C2FJ_LINKER_SCRIPT) -o $(ELF_OUT_PATH)

clean:
	rm -r build 2>/dev/null || true

.PHONY: clean all
"><pre><span>GCC</span> := riscv64-unknown-elf-gcc
<span>GCC_FLAGS</span> := -O3

<span>SOURCES</span> := <span>$(<span>C2FJ_SOURCES</span>)</span> main.c globals.c calculate_int.c
<span>OBJECTS</span> := <span>$(<span>SOURCES:.c=.o</span>)</span>

<span>all</span>: |
	<span>$(<span>GCC</span>)</span> <span>$(<span>C2FJ_GCC_OPTIONS</span>)</span> <span>$(<span>GCC_FLAGS</span>)</span> <span>$(<span>SOURCES</span>)</span> -I <span>$(<span>C2FJ_INCLUDE_DIRS</span>)</span> -T <span>$(<span>C2FJ_LINKER_SCRIPT</span>)</span> -o <span>$(<span>ELF_OUT_PATH</span>)</span>

<span>clean</span>:
	rm -r build <span>2&gt;</span>/dev/null <span>||</span> <span>true</span>

<span>.PHONY</span>: clean all
</pre></div>
<p dir="auto">You can also specify your own linker script. It should contain the following:</p>
<ul dir="auto">
<li><code>_stack_end</code> (just after the end of the stack)</li>
<li><code>_sdata</code> (start of the data section)</li>
<li><code>__heap_start</code> (start of the heap)</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">How Does It Work?</h2><a id="user-content-how-does-it-work" aria-label="Permalink: How Does It Work?" href="#how-does-it-work"></a></p>
<p dir="auto">First your C files are being compile to a RiscV elf.<br>
The compilation is done with <a href="https://github.com/picolibc/picolibc">picolibc</a>, and the project provides it any of the function implementation needed, in order for it to support the next phase of fj-compilation.</p>
<p dir="auto">For example, look at <code>exit</code> (<a href="https://github.com/tomhea/c2fj/blob/main/c2fj/compilation_files/c2fj_init.c">c2fj_init.c</a>):</p>
<div dir="auto" data-snippet-clipboard-copy-content="void exit(int status) {
    asm volatile (&quot;jal %0, .+10&quot; ::&quot;r&quot;(status):&quot;memory&quot;);
    __builtin_unreachable();
}"><pre><span>void</span> <span>exit</span>(<span>int</span> <span>status</span>) {
    asm <span>volatile</span> (<span>"jal %0, .+10"</span> ::<span>"r"</span>(<span>status</span>):<span>"memory"</span>);
    <span>__builtin_unreachable</span>();
}</pre></div>
<p dir="auto">It uses jal with bad offset, thus will be parsed here as: (<a href="https://github.com/tomhea/c2fj/blob/main/c2fj/riscv_instructions.py">riscv_instructions.py</a>)</p>
<div dir="auto" data-snippet-clipboard-copy-content="elif imm == JAL_EXIT_IMMEDIATE:
    return f'    .syscall.exit {register_name(rd)}\n'"><pre><span>elif</span> <span>imm</span> <span>==</span> <span>JAL_EXIT_IMMEDIATE</span>:
    <span>return</span> <span>f'    .syscall.exit <span><span>{</span><span>register_name</span>(<span>rd</span>)<span>}</span></span><span>\n</span>'</span></pre></div>
<p dir="auto">Thus, will get to the flipjump implementation of: (<a href="https://github.com/tomhea/c2fj/blob/main/c2fj/compilation_files/riscvlib.fj">riscvlib.fj</a>)</p>
<div dir="auto" data-snippet-clipboard-copy-content="def exit src_register {
    stl.output &quot;Program exited with exit code &quot;
    hex.print_uint 2, src_register, 1, 1
    stl.output &quot;.\n&quot;
    stl.loop
}"><pre><span>def</span> <span>exit</span> <span>src_register</span> {
    <span>stl</span>.<span>output</span> <span>"Program exited with exit code "</span>
    <span>hex</span>.<span>print_uint</span> <span>2</span>, <span>src_register</span>, <span>1</span>, <span>1</span>
    <span>stl</span>.<span>output</span> <span>".<span>\n</span>"</span>
    <span>stl</span>.<span>loop</span>
}</pre></div>
<p dir="auto">You can think of it like this: The C-&gt;RiscV compilation compiles the syscalls to a special (invalid) RiscV op, that gets parsed and further compiled into the fj implementation of the "requested syscall".
The supported syscalls can be found in <a href="https://github.com/tomhea/c2fj/blob/main/c2fj/compilation_files/c2fj_init.c">c2fj_init.c</a>, and they contain <code>_getc</code>, <code>_putc</code>, <code>exit</code>, <code>sbrk</code>.</p>
<p dir="auto">Every other opcode (Let's follow <code>addi x10, x11, 7</code> for example), will be compiled into itself.</p>
<p dir="auto">The RiscV -&gt; FlipJump part of the compilation parses the compiled elf, and matches each opcode with the appropriate flipjump macro. For example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="elif opcode == RV_ALU_IMM:
    if funct3 == RV_ADDI:
        ops_file.write(i_type('addi', full_op))"><pre><span>elif</span> <span>opcode</span> <span>==</span> <span>RV_ALU_IMM</span>:
    <span>if</span> <span>funct3</span> <span>==</span> <span>RV_ADDI</span>:
        <span>ops_file</span>.<span>write</span>(<span>i_type</span>(<span>'addi'</span>, <span>full_op</span>))</pre></div>
<p dir="auto">Then the <code>riscv.addi</code> macro is being used. The riscv ops macros are space-optimized. They are so much optimized, that each takes <code>30-40</code> fj-ops in space.<br>
That is by design. The space optimization allows this project to handle very large c code bases, and still being able to compile it without any problem.
That means that the compilation time doesn't really depend on the size of your codebase.</p>
<p dir="auto">The way it works, is that each opcode is implemented once in the <code>riscv.start</code> macro.
For example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="do_add:
    hex.add .HLEN, .rs1, .rs2
    stl.fret .ret"><pre><span>do_add</span>:
    <span>hex</span>.<span>add</span> .<span>HLEN</span>, .<span>rs1</span>, .<span>rs2</span>
    <span>stl</span>.<span>fret</span> .<span>ret</span></pre></div>
<p dir="auto">Note how <code>addi</code> is implemented:</p>
<div dir="auto" data-snippet-clipboard-copy-content="def addi mov_from_rs1, mov_to_rs1, imm < .do_add {
    .reg_imm_fast_op mov_from_rs1, mov_to_rs1, imm, .do_add
}

// Sets rs1 according to the given &quot;fcall_label&quot;, rs2 to the given imm,
//  fcalls &quot;do_op&quot;, then moves the result to the appropriate dst reg.
def reg_imm_fast_op mov_from_dest, mov_to_rs1, imm, do_op @ table, xor_imm_to_rs2, end < .ret, .zero_rs2, .rs2 {
    wflip .ret+w, table+dw, .ret

    pad 16
  table:
    .ret+dbit+2; do_op          // 4th
    .ret+dbit+1; mov_to_rs1     // 1st
    .ret+dbit+1; xor_imm_to_rs2 // 3rd
    .ret+dbit+0; .zero_rs2      // 2nd
    .ret+dbit+0; mov_from_dest  // 5th
    wflip .ret+w, table+5*dw, end   // 6th

  xor_imm_to_rs2:
    .__xor_by_hex_const .HLEN, .rs2, imm
    stl.fret .ret

  end:
}

def moves_to_from_middle_regs {
  zero_rs2:
    hex.zero .HLEN, .rs2
    stl.fret .ret
  ...
}"><pre><span>def</span> <span>addi</span> <span>mov_from_rs1</span>, <span>mov_to_rs1</span>, <span>imm</span> <span>&lt;</span> .<span>do_add</span> {
    .<span>reg_imm_fast_op</span> <span>mov_from_rs1</span>, <span>mov_to_rs1</span>, <span>imm</span>, .<span>do_add</span>
}

<span>//</span> <span>Sets</span> <span>rs1</span> <span>according</span> <span>to</span> <span>the</span> <span>given</span> <span>"fcall_label"</span>, <span>rs2</span> <span>to</span> <span>the</span> <span>given</span> <span>imm</span>,
<span>//</span>  <span>fcalls</span> <span>"do_op"</span>, <span>then</span> <span>moves</span> <span>the</span> <span>result</span> <span>to</span> <span>the</span> <span>appropriate</span> <span>dst</span> <span>reg</span>.
<span>def</span> <span>reg_imm_fast_op</span> <span>mov_from_dest</span>, <span>mov_to_rs1</span>, <span>imm</span>, <span>do_op</span> @ <span>table</span>, <span>xor_imm_to_rs2</span>, <span>end</span> <span>&lt;</span> .<span>ret</span>, .<span>zero_rs2</span>, .<span>rs2</span> {
    <span>wflip</span> .<span>ret</span><span>+</span><span>w</span>, <span>table</span><span>+</span><span>dw</span>, .<span>ret</span>

    <span>pad</span> <span>16</span>
  <span>table</span>:
    .<span>ret</span><span>+</span><span>dbit</span><span>+</span><span>2</span>; <span>do_op</span>          <span>//</span> <span>4</span><span>th</span>
    .<span>ret</span><span>+</span><span>dbit</span><span>+</span><span>1</span>; <span>mov_to_rs1</span>     <span>//</span> <span>1</span><span>st</span>
    .<span>ret</span><span>+</span><span>dbit</span><span>+</span><span>1</span>; <span>xor_imm_to_rs2</span> <span>//</span> <span>3</span><span>rd</span>
    .<span>ret</span><span>+</span><span>dbit</span><span>+</span><span>0</span>; .<span>zero_rs2</span>      <span>//</span> <span>2</span><span>nd</span>
    .<span>ret</span><span>+</span><span>dbit</span><span>+</span><span>0</span>; <span>mov_from_dest</span>  <span>//</span> <span>5</span><span>th</span>
    <span>wflip</span> .<span>ret</span><span>+</span><span>w</span>, <span>table</span><span>+</span><span>5</span><span>*</span><span>dw</span>, <span>end</span>   <span>//</span> <span>6</span><span>th</span>

  <span>xor_imm_to_rs2</span>:
    .<span>__xor_by_hex_const</span> .<span>HLEN</span>,<span></span> .<span>rs2</span>, <span>imm</span>
    <span>stl</span>.<span>fret</span> .<span>ret</span>

  <span>end</span>:
}

<span>def</span> <span>moves_to_from_middle_regs</span> {
  <span>zero_rs2</span>:
    <span>hex</span>.<span>zero</span> .<span>HLEN</span>, .<span>rs2</span>
    <span>stl</span>.<span>fret</span> .<span>ret</span>
  ...
}</pre></div>
<p dir="auto">Most of the space goes on the two <code>wflip</code>s (total <code>@-4</code> ops).<br>
The line with <code>1st</code> is done first, <code>2nd</code> goes second, and so on. That's a compact way of doing multiple <code>fcall</code>s with a single pair of <code>wflip</code>s.</p>
<p dir="auto">So as you see, the macro gets a <code>mov_to_rs1</code> and <code>mov_from_dest</code> macros. For the example of the <code>addi x10, x11, 7</code>, the next macro names will be specified:</p>
<div dir="auto" data-snippet-clipboard-copy-content="ns riscv {
  mov_rs1_to_x10:
    hex.mov .HLEN, .regs.x10, .rs1
    stl.fret .ret

  mov_x11_to_rs1:
    hex.mov .HLEN, .rs1, .regs.x11
    stl.fret .ret
}"><pre><span>ns</span> <span>riscv</span> {
  <span>mov_rs1_to_x10</span>:
    <span>hex</span>.<span>mov</span> .<span>HLEN</span>, .<span>regs</span>.<span>x10</span>, .<span>rs1</span>
    <span>stl</span>.<span>fret</span> .<span>ret</span>

  <span>mov_x11_to_rs1</span>:
    <span>hex</span>.<span>mov</span> .<span>HLEN</span>, .<span>rs1</span>, .<span>regs</span>.<span>x11</span>
    <span>stl</span>.<span>fret</span> .<span>ret</span>
}</pre></div>
<p dir="auto">And the <code>addi x10, x11, 7</code> opcode will be compiled into <code>riscv.addi mov_rs1_to_x10, mov_x11_to_rs1, 7</code>.</p>
<p dir="auto">So when the <code>1st</code> line is executed, the <code>mov_x11_to_rs1</code> code will be executed, and it will return to the start of the <code>2nd</code> line.<br>
Note that most of the macros use the global fj variables <code>rs1, rs2, rd</code> (part of the <code>riscv</code> namespace).<br>
Then, in the second line <code>rs2</code> is being zeroed.<br>
The third line xors the given immediate (<code>7</code>) to <code>rs2</code>, and the forth line does the actual addition (by jumping to <code>do_op</code> which is <code>do_add</code> in our case).<br>
The fifth line will move the result (which <code>do_add</code> puts in <code>rs1</code>) to <code>x10</code>, using the given <code>mov_rs1_to_x10</code> argument.<br>
Then, the macro will finish.</p>
<p dir="auto">If you want to understand it better, feel free to <em>jump</em> into the FlipJump and read how things work in the bits and bytes level.</p>
<p dir="auto">The next phase uses the <code>flipjump</code> python package to compile the given <code>.fj</code> files into the compiles <code>.fjm</code> file (which is segments of data, and by data I mean bits of flips and jumps).<br>
The last phase, running the <code>.fjm</code> file, uses the <code>flipjump</code> package to interpret the <code>.fjm</code> file, and allows to debug it too.</p>
<p dir="auto"><h4 tabindex="-1" dir="auto">Jumps Tables, Memory?</h4><a id="user-content-jumps-tables-memory" aria-label="Permalink: Jumps Tables, Memory?" href="#jumps-tables-memory"></a></p>
<p dir="auto">In the previous section I talked about the <code>ops.fj</code> file that was created in the compilation process, but there are two more files that gets created in that process too.</p>
<p dir="auto"><h5 tabindex="-1" dir="auto"><code>mem.fj</code>:</h5><a id="user-content-memfj" aria-label="Permalink: mem.fj:" href="#memfj"></a></p>
<p dir="auto">The entire loadable memory of the compiled elf is being loaded into flipjump using this file. It contains all the loadable bytes of the memory in fj <code>hex</code> variables.<br>
There are no memory restrictions on it, thus the running program can read/write/execute from it freely.<br>
Note that the riscv opcodes are part of the loadable memory too, and you can modify that part of memory too, and it will change, but the compiled riscv-ops themselves (in <code>ops.fj</code>) won't change.</p>
<p dir="auto"><h5 tabindex="-1" dir="auto"><code>jmp.fj</code>:</h5><a id="user-content-jmpfj" aria-label="Permalink: jmp.fj:" href="#jmpfj"></a></p>
<p dir="auto">That's a jump table to every runnable riscv address. That helps us in jumping ops, because the macro addresses of the ops in the <code>ops.fj</code> can't be predicted easily.<br>
Think of how can you jump to address 0x144. The label <code>riscv.ADDR_00000144</code> in <code>ops.fj</code> is not in some fixed place, or something that related to <code>0x144</code>. Yet, the current;y running opcode ant to jump to address <code>0x144</code>. Then what do we do?<br>
Use a jump table! It looks something like:</p>
<div dir="auto" data-snippet-clipboard-copy-content="segment .JMP + 0x00000000/4*dw
;.ADDR_00000000
;.ADDR_00000004
...
;.ADDR_00000144"><pre><span>segment</span> .<span>JMP</span> <span>+</span> <span>0x00000000</span><span>/</span><span>4</span><span>*</span><span>dw</span>
;.<span>ADDR_00000000</span>
;.<span>ADDR_00000004</span>
...
;.<span>ADDR_00000144</span></pre></div>
<p dir="auto">The <code>0x144</code> address is at fixed offset from the global <code>.JMP</code> address, thus jumping to riscv memory address <code>0x144</code> became as easy as jumping to fj-address <code>.JMP + 0x144*dw</code> (as <code>dw</code> is the length of one fj opcode, in bits).</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Tests</h2><a id="user-content-tests" aria-label="Permalink: Tests" href="#tests"></a></p>
<p dir="auto">Simply run <code>pytest</code> to run the tests.
This package is tested on linux and python 3.13.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Related projects</h2><a id="user-content-related-projects" aria-label="Permalink: Related projects" href="#related-projects"></a></p>
<ul dir="auto">
<li><a href="https://github.com/tomhea/bf2fj">bf2fj</a> - Brainfuck to FlipJump compiler.</li>
<li><a href="https://github.com/tomhea/flip-jump">FlipJump</a> - The flipjump language macro assembler, standard library, and interpreter.</li>
<li><a href="https://github.com/tomhea/fji-cpp">fji-cpp</a> - Faster C++ interpreter for FlipJump.</li>
</ul>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Branchless UTF-8 Encoding (169 pts)]]></title>
            <link>https://cceckman.com/writing/branchless-utf8-encoding/</link>
            <guid>42742184</guid>
            <pubDate>Fri, 17 Jan 2025 19:20:14 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cceckman.com/writing/branchless-utf8-encoding/">https://cceckman.com/writing/branchless-utf8-encoding/</a>, See on <a href="https://news.ycombinator.com/item?id=42742184">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>Can you encode UTF-8 without branches?</p>
<p><a href="https://github.com/cceckman/unicode-branchless/blob/main/src/lib.rs" rel="external" target="_blank">Yes</a>.</p>
<h2 id="the-question">The question</h2>


<p>In a <a target="_blank" href="https://www.recurse.com/scout/click?t=8238c6d9149cbd0865752e535795d509">Recurse</a> chat, <a href="https://github.com/ngoldbaum" rel="external" target="_blank">Nathan Goldbaum</a> asked:</p>
<blockquote>
<p>I know how to decode UTF-8 using bitmath and some LUTs (see <a href="https://github.com/skeeto/branchless-utf8" rel="external" target="_blank">https://github.com/skeeto/branchless-utf8</a>), but if I want to to go from a codepoint to UTF-8, is there a way to do it without branches?</p>
<p>To start with, is there a way to write this C function, which returns the number of bytes needed to store the UTF-8 bytes for the codepoint without any branches? Or would I need a huge look-up-table?</p>
</blockquote>
<details>
  <summary>The C function</summary>
<blockquote>
<div><pre tabindex="0"><code data-lang="c"><span><span><span>int</span>
</span></span><span><span><span>num_utf8_bytes_for_codepoint</span><span>(</span><span>uint32_t</span> <span>code</span><span>)</span>
</span></span><span><span><span>{</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>code</span> <span>&lt;=</span> <span>0x7F</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>return</span> <span>1</span><span>;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>    <span>else</span> <span>if</span> <span>(</span><span>code</span> <span>&lt;=</span> <span>0x07FF</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>return</span> <span>2</span><span>;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>    <span>else</span> <span>if</span> <span>(</span><span>code</span> <span>&lt;=</span> <span>0xFFFF</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>if</span> <span>((</span><span>code</span> <span>&gt;=</span> <span>0xD800</span><span>)</span> <span>&amp;&amp;</span> <span>(</span><span>code</span> <span>&lt;=</span> <span>0xDFFF</span><span>))</span> <span>{</span>
</span></span><span><span>            <span>// surrogates are invalid UCS4 code points
</span></span></span><span><span><span></span>            <span>return</span> <span>-</span><span>1</span><span>;</span>
</span></span><span><span>        <span>}</span>
</span></span><span><span>        <span>return</span> <span>3</span><span>;</span>
</span></span><span><span>        <span>}</span>
</span></span><span><span>    <span>else</span> <span>if</span> <span>(</span><span>code</span> <span>&lt;=</span> <span>0x10FFFF</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>return</span> <span>4</span><span>;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>    <span>else</span> <span>{</span>
</span></span><span><span>        <span>// codepoint is outside the valid unicode range
</span></span></span><span><span><span></span>        <span>return</span> <span>-</span><span>1</span><span>;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div></blockquote>
</details>
<p>I pondered this but didn’t immediately see a way to do it without a huge (2^32) lookup table.</p>
<h2 id="the-almost-answer">The almost answer</h2>
<p>Until <a href="http://lmb.io/" rel="external" target="_blank">Lorenz</a> pointed out:</p>
<blockquote>
<p>Very handwavy idea: encode a 32 bit code point into utf8 but store the result in a 32bit word again. Count the number of leading / trailing zeroes to figure out how many bytes are necessary. Write four bytes into the output buffer but only advance your position in the output by the number of bytes you really need.</p>
</blockquote>
<p>Aha!</p>
<p>The number of leading zeros will range from 12 to 32<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup> –
a very reasonable size for a lookup table.
From there, we could look up other parameters by length (no more than 4).</p>
<p>I fired off a draft into the chat, then came back to test (and fix) it in the evening.
When I got the tests passing, it looked like this:</p>
<div><pre tabindex="0"><code data-lang="rust"><span><span><span>/// Return the number of bytes required to UTF-8 encode a codepoint.
</span></span></span><span><span><span>/// Returns 0 for surrogates and out-of-bounds values.
</span></span></span><span><span><span></span><span>const</span><span> </span><span>fn</span> <span>utf8_bytes_for_codepoint</span><span>(</span><span>codepoint</span>: <span>u32</span><span>)</span><span> </span>-&gt; <span>usize</span> <span>{</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>len</span><span> </span><span>=</span><span> </span><span>LEN</span><span>[</span><span>codepoint</span><span>.</span><span>leading_zeros</span><span>()</span><span> </span><span>as</span><span> </span><span>usize</span><span>]</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>    </span><span>// Handle surrogates via bit-twiddling.
</span></span></span><span><span><span></span><span>    </span><span>// Rust guarantees true == 1 and false == 0:
</span></span></span><span><span><span></span><span>    </span><span>let</span><span> </span><span>surrogate_bit</span><span> </span><span>=</span><span> </span><span>((</span><span>codepoint</span><span> </span><span>&gt;=</span><span> </span><span>0xD800</span><span>)</span><span> </span><span>&amp;&amp;</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&lt;=</span><span> </span><span>0xDFFF</span><span>))</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>// Extend that one bit into three, and use its inverse as a mask for length
</span></span></span><span><span><span></span><span>    </span><span>let</span><span> </span><span>surrogate_mask</span><span> </span><span>=</span><span> </span><span>surrogate_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>2</span><span> </span><span>|</span><span> </span><span>surrogate_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>1</span><span> </span><span>|</span><span> </span><span>surrogate_bit</span><span>;</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>    </span><span>// Handle exceeded values via bit-twiddling.
</span></span></span><span><span><span></span><span>    </span><span>// Unfortunately, these don't align precisely with a leading-zero boundary;
</span></span></span><span><span><span></span><span>    </span><span>// the largest codepoint is U+10FFFF.
</span></span></span><span><span><span></span><span>    </span><span>let</span><span> </span><span>exceeded_bit</span><span> </span><span>=</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&gt;</span><span> </span><span>0x10_FFFF</span><span>)</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>exceeded_mask</span><span> </span><span>=</span><span> </span><span>exceeded_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>2</span><span> </span><span>|</span><span> </span><span>exceeded_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>1</span><span> </span><span>|</span><span> </span><span>exceeded_bit</span><span>;</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>    </span><span>len</span><span> </span><span>&amp;</span><span> </span><span>!</span><span>surrogate_mask</span><span> </span><span>&amp;</span><span> </span><span>!</span><span>exceeded_mask</span><span>
</span></span></span><span><span><span></span><span>}</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span></span><span>/// Length, based on the number of leading zeros.
</span></span></span><span><span><span></span><span>const</span><span> </span><span>LEN</span>: <span>[</span><span>u8</span><span>;</span><span> </span><span>33</span><span>]</span><span> </span><span>=</span><span> </span><span>[</span><span>
</span></span></span><span><span><span>    </span><span>// 0-10 leading zeros: not valid
</span></span></span><span><span><span></span><span>    </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span>
</span></span></span><span><span><span>    </span><span>// 11-15 leading zeros: 4 bytes
</span></span></span><span><span><span></span><span>    </span><span>4</span><span>,</span><span> </span><span>4</span><span>,</span><span> </span><span>4</span><span>,</span><span> </span><span>4</span><span>,</span><span> </span><span>4</span><span>,</span><span>
</span></span></span><span><span><span>    </span><span>//16-20 leading zeros: 3 bytes
</span></span></span><span><span><span></span><span>    </span><span>3</span><span>,</span><span> </span><span>3</span><span>,</span><span> </span><span>3</span><span>,</span><span> </span><span>3</span><span>,</span><span> </span><span>3</span><span>,</span><span>
</span></span></span><span><span><span>    </span><span>// 21-24 leading zeros: 2 bytes
</span></span></span><span><span><span></span><span>    </span><span>2</span><span>,</span><span> </span><span>2</span><span>,</span><span> </span><span>2</span><span>,</span><span> </span><span>2</span><span>,</span><span>
</span></span></span><span><span><span>    </span><span>// 25-32 leading zeros: 1 byte
</span></span></span><span><span><span></span><span>    </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>1</span><span>,</span><span>
</span></span></span><span><span><span></span><span>];</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span></span><span>/// Encode a UTF-8 codepoint.
</span></span></span><span><span><span>/// Returns a buffer and the number of valid bytes in the buffer.
</span></span></span><span><span><span>///
</span></span></span><span><span><span>/// To add this codepoint to a string, append all four bytes in order,
</span></span></span><span><span><span>/// and record that (usize) bytes were added to the string.
</span></span></span><span><span><span>///
</span></span></span><span><span><span>/// Returns a length of zero for invalid codepoints (surrogates and out-of-bounds values).
</span></span></span><span><span><span></span><span>pub</span><span> </span><span>fn</span> <span>branchless_utf8</span><span>(</span><span>codepoint</span>: <span>u32</span><span>)</span><span> </span>-&gt; <span>([</span><span>u8</span><span>;</span><span> </span><span>4</span><span>],</span><span> </span><span>usize</span><span>)</span><span> </span><span>{</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>len</span><span> </span><span>=</span><span> </span><span>utf8_bytes_for_codepoint</span><span>(</span><span>codepoint</span><span>);</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>buf</span><span> </span><span>=</span><span> </span><span>[</span><span>
</span></span></span><span><span><span>        </span><span>PREFIX</span><span>[</span><span>len</span><span>][</span><span>0</span><span>]</span><span> </span><span>|</span><span> </span><span>((</span><span>codepoint</span><span> </span><span>&gt;&gt;</span><span> </span><span>SHIFT</span><span>[</span><span>len</span><span>][</span><span>0</span><span>])</span><span> </span><span>&amp;</span><span> </span><span>MASK</span><span>[</span><span>len</span><span>][</span><span>0</span><span>]</span><span> </span><span>as</span><span> </span><span>u32</span><span>)</span><span> </span><span>as</span><span> </span><span>u8</span><span>,</span><span>
</span></span></span><span><span><span>        </span><span>PREFIX</span><span>[</span><span>len</span><span>][</span><span>1</span><span>]</span><span> </span><span>|</span><span> </span><span>((</span><span>codepoint</span><span> </span><span>&gt;&gt;</span><span> </span><span>SHIFT</span><span>[</span><span>len</span><span>][</span><span>1</span><span>])</span><span> </span><span>&amp;</span><span> </span><span>MASK</span><span>[</span><span>len</span><span>][</span><span>1</span><span>]</span><span> </span><span>as</span><span> </span><span>u32</span><span>)</span><span> </span><span>as</span><span> </span><span>u8</span><span>,</span><span>
</span></span></span><span><span><span>        </span><span>PREFIX</span><span>[</span><span>len</span><span>][</span><span>2</span><span>]</span><span> </span><span>|</span><span> </span><span>((</span><span>codepoint</span><span> </span><span>&gt;&gt;</span><span> </span><span>SHIFT</span><span>[</span><span>len</span><span>][</span><span>2</span><span>])</span><span> </span><span>&amp;</span><span> </span><span>MASK</span><span>[</span><span>len</span><span>][</span><span>2</span><span>]</span><span> </span><span>as</span><span> </span><span>u32</span><span>)</span><span> </span><span>as</span><span> </span><span>u8</span><span>,</span><span>
</span></span></span><span><span><span>        </span><span>PREFIX</span><span>[</span><span>len</span><span>][</span><span>3</span><span>]</span><span> </span><span>|</span><span> </span><span>((</span><span>codepoint</span><span> </span><span>&gt;&gt;</span><span> </span><span>SHIFT</span><span>[</span><span>len</span><span>][</span><span>3</span><span>])</span><span> </span><span>&amp;</span><span> </span><span>MASK</span><span>[</span><span>len</span><span>][</span><span>3</span><span>]</span><span> </span><span>as</span><span> </span><span>u32</span><span>)</span><span> </span><span>as</span><span> </span><span>u8</span><span>,</span><span>
</span></span></span><span><span><span>    </span><span>];</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>    </span><span>(</span><span>buf</span><span>,</span><span> </span><span>len</span><span>)</span><span>
</span></span></span><span><span><span></span><span>}</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span></span><span>type</span> <span>Table</span><span> </span><span>=</span><span> </span><span>[[</span><span>u8</span><span>;</span><span> </span><span>4</span><span>];</span><span> </span><span>5</span><span>];</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span></span><span>// Byte prefix for a continuation byte.
</span></span></span><span><span><span></span><span>const</span><span> </span><span>CONTINUE</span>: <span>u8</span> <span>=</span><span> </span><span>0b1000_0000</span><span>;</span><span>
</span></span></span><span><span><span></span><span>const</span><span> </span><span>PREFIX</span>: <span>Table</span><span> </span><span>=</span><span> </span><span>[</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0</span><span>u8</span><span>;</span><span> </span><span>4</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0b1100_0000</span><span>,</span><span> </span><span>CONTINUE</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0b1110_0000</span><span>,</span><span> </span><span>CONTINUE</span><span>,</span><span> </span><span>CONTINUE</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0b1111_0000</span><span>,</span><span> </span><span>CONTINUE</span><span>,</span><span> </span><span>CONTINUE</span><span>,</span><span> </span><span>CONTINUE</span><span>],</span><span>
</span></span></span><span><span><span></span><span>];</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span></span><span>// We must arrange that the most-significant bytes are always in byte 0.
</span></span></span><span><span><span></span><span>const</span><span> </span><span>SHIFT</span>: <span>Table</span><span> </span><span>=</span><span> </span><span>[</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0</span><span>u8</span><span>;</span><span> </span><span>4</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>6</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>12</span><span>,</span><span> </span><span>6</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>18</span><span>,</span><span> </span><span>12</span><span>,</span><span> </span><span>6</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span></span><span>];</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span></span><span>const</span><span> </span><span>MASK</span>: <span>Table</span><span> </span><span>=</span><span> </span><span>[</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0</span><span>u8</span><span>;</span><span> </span><span>4</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0x7f</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0x1f</span><span>,</span><span> </span><span>0x3f</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0x0f</span><span>,</span><span> </span><span>0x3f</span><span>,</span><span> </span><span>0x3f</span><span>,</span><span> </span><span>0</span><span>],</span><span>
</span></span></span><span><span><span>    </span><span>[</span><span>0x07</span><span>,</span><span> </span><span>0x3f</span><span>,</span><span> </span><span>0x3f</span><span>,</span><span> </span><span>0x3f</span><span>],</span><span>
</span></span></span><span><span><span></span><span>];</span><span>
</span></span></span></code></pre></div><h2 id="the-branches">The branches</h2>
<p>No if statements, loops, or other conditionals. So, branchless, right?</p>
<p>…well, no.
If we peek at <a href="https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAMzwBtMA7AQwFtMQByARg9KtQYEAysib0QXACx8BBAKoBnTAAUAHpwAMvAFYTStJg1DEArgoKkl9ZATwDKjdAGFUtEywYgAzAFZSjgBk8BkwAOXcAI0xiEEkANlIAB1QFQjsGFzcPbz9k1NsBIJDwliiY%2BMtMawKGIQImYgJM909fSur0uoaCIrDI6NiE827m7Lbhxt6SssGASktUE2Jkdg4Aeg2AamwGNCxNpk25ABUAMQBaAA5Nvcxk4IIAOgBSDQBBDbXNgCVMAiWGAoDpsIiYqFRogcGOhNgQEJhNgx%2BsRNqgqJsAG5iPAwiIATwImCBwVh8JBYIhxBe70%2Brw%2BW2OqAO6BhcLwQNu90EsKZh3MxGCwFIB0SiUcB1otE2/CWIIJRM2JJIWDIdM%2BUJhxEwaGIrIQTAImwgZjwAC9MLM5YSgQB3aIIpgszCsplwhH8wXU%2BlrNVbX7/YiA4H0Ixw1Ho83EJn8FHBLG0HE3DB3VAPIEQBRLKPAA0KwwwxYEc5o84RRbQoHxkxE2ZexImCLShgg4iGZAIegKBQAfRMBColwgnNTghAmxMXgATJbzs8vNgjc8fAAhEyXOfLzaSJcAEWFJvNlueAHZl3TNhfNvRDSHNnOd%2BP%2B5du/jrd2Y93hw8h8muQRZhu56Xte5Loved4rkBl6Xso3zYKcACSAAaS7LiGu6oRou53seThGj%2BWB/ne85zguQgABIIacxyoehPg7phu5HpOcSbAAsm8QgANK0YwGErlh9EHECE7TsJ46XKQUHQZssHwchvEMPxy5cNhJ54VAX7cqRpGbBRVE0SudEMSuqn0cxrEcdxinKWZD5MCJU6Wg5ElSe8MkwXBiEoUZfH0ahk5qbh%2BFaYaOnznplHUTZ/kroF5l3ix7GcTxvlKbFy7xfZjliS5a5uW8HkXnJ3kxSZy5eEFGkESmDzEdgun6dFaXKZVCXPElVmpWhfnlW12Xjk54n5dJGFeGe7zSRAoJUMKIYAZNx4MZN7xoIChpUM2fYDi%2B8o9h%2BoU1X%2BY6iTOukHgiJ4TYVwF/FejDEQ%2BATYKEqGhY89COoK3aRikEDOSJqTmtheVA5ggErTdF5bOR%2Bb0JsmbENmuaVnghwRIQ5wEDaOLoAmRhetBfpmIawAmA0hiEgqBCmJdXgMfTmxcBq0piEoj3gRoIDSSBiPI4SL6EI9IW/iOYUkYzGiqDulwaBoFkdaxR1i8RTic9Lpya7MAPjmDENQ5sWzYKohLQqSBqoiEIJCw8roIFqmDCvmusIoQxIMBi0Tsy5hwsA5ADW0okPdoYIDzd186gOYC37CiB%2BBkfR5ggvi2rXh4ZOOF4YnuYp6rc54cz6kI1mUe5xjBD69JMNwwimCqCszrOpiYjVqj6OY9juP48AhOXlscgMDG/zMIStB4sKbrs%2BgAhgBwhrYsAzaJFqyDslUeKbDjYaHJ9%2BBGOcv0guW6ANHi%2BtE18bpXg0wBEoaoWKkCcgdSpGia5rfcXiB9eN1g6B53AsrOqukpZcA0N2D%2BpwdYXQvrdQ0v9MBNwAbHeOjNEHIMAenAumxM7Fwwf/LBadC5Z02AQ50Kcq7uVus2RWmwwBgBzjHAOiVWIMPISggOdITzLTeHSAgeIxSbGOEwCI8NwKoVQmuDcW4xqbh8HI7hNItgBEYMAOEwoIgOWbgIUkCIkSlEhGie6X0jCbF%2BgoL0a1zCbGeqEMcUj1zjU2F4fqwtJHUOhl8DQ5xwEmP3sAcx0QUhjgYKgQ08YcTSQ0MKGJmw4kJNiUk%2BJyTEmGx9J49JTMuC%2BJ8P4wUQSowKDHJIK0RJpLSC3MKSpNThQbGrmsLgcRziTg0PksxFixxeDKQoaSXhhT9JcQM4Z6SGm4JyZOUpe8CmdNwT06Sk5hSLNwUsupGSDZbEnD4c4U52mBNmczV84NMlcGFKcpmZzLkXOuac7h/lxpKPpJsZc8pNgr0wDQVQQcUSHDWrYJEBp0hlKsQIGxTgADyoRjgIVCHIbAJ1ricwiOAuW3Y5Zy31tYw0JVkJjhEWIumD4PEG0wtI5x256IFWgphVJsTdxUsvJhZFKK0XouFBCqFMK4WpPpaNASzLwGsrluyyF0LYXYBFZy8VdLKV8uXBoAVXAhVxI5WK7lmxVVcolRq0VWreWTXuddX0mwADqCIWAkwOEjQwd9zaGmviwFIRZUhLzwDQUQ3IjlAgaA6WgNomB4ndmU%2BJIL1qRQMni0R4jGbEupQJMlm4KV7jlWkhJ%2BqSUrgSCk7Nglk2ZNQlwZZWa02yvzaZSSTMi0yrzXww1jysXJW4pGgl7jIJlvlQm2RpaM3ytUMeWaObq0MovJhVQXAB1Sy8BOodKbVAaAnaoKdsTF0TvTXG3tGhjzLqXfEld26qDpsUZDDg8xaCcB8LwTwHAtCkFQJwb4lqFCLGWJdScXgeCkAIJoE98x/YgB8BoR4GgvCXDiLLAAnMeUDk5LjHgSGejgkheAsAkMKq9N670cF4MUmJX7r0ntIHAWASA0AsESHQaI5BKCkfI/QGIxAuCXC8DEmgtBCTEGKdNb9pAMbMGIHiTgH7eNn3BREbQ2o8MftI2wQQ4KGDj241gUEwAnBiFoMU7gvAsB%2ByMOIfDpB8Cr1sJ7DTN767aj7KsD9DwqjcYTBEVs/GXBYG4zTPAKHNOkE9sQMsSgdyYB08AHu375hUAMMABQAA1PAmAbTgrFFej9/BBAiDEOwKQMhBCKBUOofTuhTkGCMCAUw5h9B4AiMUyA8xUCJBqBp844LeCoG8wKLAlX/rtAk%2BkBw0JRieFOYEYIfRDExFOXkNIAg%2Bt6HGzUKYyI9BWC6wILojQpunMWzYTo9RJhDemAMdb22miuBaAtw7c2RsSHmE%2BpYKxLv6HPZe7jmHNglYIMgJmjwmNAaNLgQgwcOrvtmLwPDWhtakHhI6AYHW/2SHA48cDcQuDvvAxoScSPjyFoqAhpDpAUMotIOhprnBsMgFwyF09nBJyPf05h4H5OvNe265IIAA%3D" rel="external" target="_blank">the (optimized) code</a> in Compiler Explorer,
we can see the x86_64 assembly has <strong>two different kinds of branches</strong>.</p>
<h3 id="count-leading-zeros">Count leading zeros</h3>
<p>There’s a branch right at the start of the function:</p>
<div><pre tabindex="0"><code data-lang="asm"><span><span>            <span>test</span>    <span>esi</span><span>,</span> <span>esi</span>
</span></span><span><span>            <span>je</span>      <span>.LBB0_1</span>
</span></span><span><span>            <span>bsr</span>     <span>eax</span><span>,</span> <span>esi</span>
</span></span><span><span>            <span>xor</span>     <span>eax</span><span>,</span> <span>31</span>
</span></span><span><span>            <span>jmp</span>     <span>.LBB0_3</span>
</span></span><span><span>    <span>.LBB0_1:</span>
</span></span><span><span>            <span>mov</span>     <span>eax</span><span>,</span> <span>32</span>
</span></span><span><span>    <span>.LBB0_3:</span>
</span></span><span><span>            <span>mov</span>     <span>eax</span><span>,</span> <span>eax</span>
</span></span></code></pre></div><p>I wasn’t sure what this was about until I stepped through it.
The “special” case seems to be when the input (<code>esi</code>) is zero;
then it returns 32.</p>
<p>Why the special case? Compiler Explorer’s tooltip for the <code>bsr</code> instruction says:</p>
<blockquote>
<p>If the content source operand is 0, the content of the destination operand is undefined.</p>
</blockquote>
<p>So on x86_64 processors,
we have to branch to say “a 32-bit zero value has 32 leading zeros”.
Put differently, the “count leading zeros” intrinsic isn’t necessarily a branchless
instruction.
This might look nicer on another architecture!</p>
<h3 id="bounds-checks">Bounds checks</h3>
<p>The other jump seems to be a conflation of the several array-bounds checks.</p>
<div><pre tabindex="0"><code data-lang="asm"><span><span>        <span>cmp</span>     <span>eax</span><span>,</span> <span>4</span>
</span></span><span><span>        <span>ja</span>      <span>.LBB0_5</span>
</span></span><span><span>        <span>...</span>
</span></span><span><span><span>LBB0_5:</span>
</span></span><span><span>        <span>lea</span>     <span>rdx</span><span>,</span> <span>[</span><span>rip</span> <span>+</span> <span>.L__unnamed_5</span><span>]</span>
</span></span><span><span>        <span>mov</span>     <span>esi</span><span>,</span> <span>5</span>
</span></span><span><span>        <span>mov</span>     <span>rdi</span><span>,</span> <span>rax</span>
</span></span><span><span>        <span>call</span>    <span>qword</span> <span>ptr</span> <span>[</span><span>rip</span> <span>+</span> <span>core</span><span>::</span><span>panicking</span><span>::</span><span>panic_bounds_check</span><span>::</span><span>h8307ccead484a122@GOTPCREL</span><span>]</span>
</span></span></code></pre></div><p>All of the jump arrays have the same bound (4), so the compiler can
decide to only check once – and still get Rust’s famous safety guarantees.</p>
<p>In principle, if the compiler optimized through the <code>LEN</code> table,
it could eliminate this check as well; the <code>LEN</code> value is never
greater than 4, which is a valid index for all tables.
But apparently the constants don’t propagate that far.</p>
<h2 id="eliminating-branching">Eliminating branching</h2>
<p>Changing the code and dropping to <a href="https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAMzwBtMA7AQwFtMQByARg9KtQYEAysib0QXACx8BBAKoBnTAAUAHpwAMvAFYTStJg1DEArgoKkl9ZATwDKjdAGFUtEywZ7HAGTwNMAHLuAEaYxCAAzABMpAAOqAqEdgwubh568Ym2Ar7%2BQSyh4dGWmNbZDEIETMQEqe6eXCVlyZXVBLmBIWGRMeZtdemNfTUd%2BYU9AJSWqCbEyOwcAPTLANTYDGhYK0wrcgAqAGIAtAAcK5uY8X4EAHQApBoAgsuLKwBKmASzDArbK8EmKhUMLbBjoFYEBCYFYMLrEFaoKgrABuYjw4OCAE8CJhfn4IVD/oDgcR7k8Xg9nqs9qhtuhwZC8L8LldBBDaTtzMQ/MBSNtYrFHNtaLQVvxZv9sbiVviSFgyJSXqDwcRMGhiAyEEwCCsIGY8AAvTATSU434AdzC0KY9MwDNpkOhXJ5ZKpi0Vqw%2BX2IPz%2B9CMkIRSKNxFp/HhflRtHR5wwl1Q11%2BEAUs1DwG10sM4JmBCOiKOwRmYN%2BUZMuImrtiJmCYoY/2IhmQCHoCgUAH0TAQqCcICyE4IQCsTNETUc7hFsLq7gBWABCJhO49nK0kM4AInz9UaTXcAOyzykrI8reg6/0rcdroddk5trFmtvhtt9669uOsggTJeH494JHIKhgDASAsABYA2yYVswnKBQd33H9j2PSClBqYCIHPccnEvFcvwiA8nkQvc1wQk9PiJJFsJMH4mGBC94IIxDjxnfDHkYtiVgAKmUN5sAOABJAANG5gE%2BDsNihZAAGs7XQxgKxEggxKbNVpPQCANC/Bj2PYvcnF1N8sA/C8J3HScOKEAAJPiDj2YTRKo5SpJk/15Ps8SVJkjTNNY7TfKPO4ogANk4gBZR4hAAaTsxSHIk1TZIYVyYvcpy1I07ZfmHKITUgocTlIEjtK4nj%2BKEhSlLi5y5OiiqPLUrhvL8tjdP0l82VM0zOMs6zbPK2K6oSpLatSiAGsaprtIC4KOLCyKav6kaXPmlL4oajKhxHdaFwKrTfOK3jBOWxz4qWvqVpk7LCqalqoDanUOonLqrJso7KrU063OOi6JnGibmqC0Lwqis6vve6qQbeiBsq2zbcu2q62P20rXoGj7ktBiAIl%2Bv6boM%2BNrmM7BOvM57es%2ByG0eG%2BKsexv6mIBmagZRxbwfJgasZh6G4fyhGL2nYjdqI78nhIiAASoPkXMpIWRZFqIImYvxo38ddKTQH4dSoOtO27O8pXbJ87rxj9Byy0dOq3aE9xYxDT1IutsO8bAAmYu6bnoG0eTbEMEggHLMsSI11y2wPMGFx4SNWCys3oFYU2INMMxLPAdmCQgjgIc10XQZXgFdRDPTMHVgBMapDBxaUCFMK2ImI2uVi4ZUxTEJRjLrq8NBAEi7fjxOcTvQg29a99%2B3ukz640VQ1xODR0qmqbdTu4ysInqeDnXn6Q8NMO8Mj15sFUHEwQJbUEX8f5B%2BuB0EFVTA%2BSzIdW8IPEGGRMJW9ynYWEgySxRIe3gCQm7mRXuqB0z92/goX%2B2FQHgMwAPMeK89JRDonpWBGYEHL0wg3VBcdUxgIwWnAg4c94rGjmCWOmBVDzDtHaFEYgyzJ1TunTO2dc752PKsOQDBwxfGYDiWgmI%2BSOlbugAQYAOA6jRMAOssRVTICZKUTEKws6Bh2B7fARgjg%2B3%2BEWdA1RMThwLq8R0J5qgiXMLGQyo8ZS/DkAFWcXANDr3Xhwo8dsqE0KwOgTB2FjY2M6pPJxbYXEHH9o/beRjjweOoZgWhPjIHQPrp4uJ3jfERCQSsFBLUUnxPSZkxuOTYl5KISQ3aGEAbAXQRAn%2BF5KlgFyWkxJ0tdwCwjk8AgmJBQrD2EwYIsdsLMWYguJcK5VZ4RWNOcZLEPSvG8IwQBCA%2BTBEgnQgQBJoSwgKCCREpFPZGBWD7BQrp1aWKdgEQcwzFwTIiArfmQ8hm7VWBoI4Ti9maOAIcsICRBwMFQDqKM6ISIaD5CClYYKIWgqheC6FkKVjLFIVwLgrzpzvJ5F80MChBySFNLiEi0gVx8gJcSvkCKnmLC4IFI4UQNBooOUcwcERcUKBIhEPkbKVgcq5aS905KsnIqiDijR6KGVZOZSRGIWS%2BSSslWSnyR5VhRGnEcaIdLPmisbveMOu1GgNz5Lqg1%2BqjV6ulvzMpVIVizilCsORmAaCqD/vCHY6tbCwm1MkXFJyBCWKcAAeQCHsPiAQ5DYFNmcbCGhghONnm2Wes9w6nJ1NxA6AlBy9P6TXK8jz5V81nBoEZEzVz8x2jm5icKIXrhLYROckakUxrjWCv1Aag0hthZWkiZao11tjXGvkTbA3BuwH2/1A7W3gvbYLGtXakU9tnsO5tg752jqHSsftLaibFtNXXGZ5JXgAHVoQsCLtsBOhgRInx1KYlgCRcyJBkX%2BPAog2Rat%2BNUa0tBzRMExC/XF4KvUaxWN1Gyaa%2BkDPrtm6teaC3LiLRuDtNbYWgonaWucgVEPjs3ZOxxkq0Mwow3BrDXB8oNxw0hzDEczW71lo8RNKxZoRRAxmh5c54NQeuTB5DkHJ67glnhit5GuOqC4LxyeEQRNkYIyhvNqgNAidUGJ0F8mROcaYjWmTu5FMKfBUpzTVBkPTOlk8DgUxaCcGnLwTwHAtCkFQJwN4x6FAzDmFbeWPBSAEE0MZqYkkQCSEkDcAAnDSrgURdwzw0FEULQV9CcEkLwFgEg52Wes7ZjgvAsUgo81Z4zpA4CwCQGgFgsQ6BhHIJQQrxX6DhGIERiIIKaC0BxMQLFYtPOkDTswYgmJOBuY6wY31wRtBqiy25wrbBBC%2BoYIItroETDACcGIWgWLuC8CwN/Iw4hsukHwPI2wb9lvWaoWqTsCw3PXFKG16MwQGxdZcFgNrVc8AJZW6QN%2BxBCxKDXJgdbwBc6eamFQAwwAFAADU8CYHNL6wUlm3P8EECIMQ7ApAyEEIoFQ6gtu6EaAYIwIBTDmH0HgYIWLIBTFQLEGCnAjhHAAp8v5bZZvgWQtBZIvwjh6XJ7megb9aCXjc6gN73IsAk79k0YbyQHBggGJ4KIjQfB%2BE6Ns8IGnMhJAENLkAsu4gJDVwwUYcIQAaasOLgQrQaga618bmwLQqgjAV2MboRvbe1FcPUTXQxnf66V4bqYjnZjzAkCZszFm2upZWPjggyAG43BOBEG4tKIC4EIP/AKEQGq8Cy1oH6pAoQ2m6KLnz05pzx93AFk4u5ZcBYC7uCvu5pwxY4HF0gCXo2kGS7wVL6WQCZf%2B0HjgUQQ9bc7%2B53vr334S8kEAA%3D%3D%3D" rel="external" target="_blank">unsafe array accesses</a>
eliminates the array bounds check.
But still, there’s still the count-leading-zeros branch at the start.
Can we get rid of that?</p>
<p>Let’s take another look at a bit of the code –
specifically, how we handle out-of-bounds values:</p>
<div><pre tabindex="0"><code data-lang="rust"><span><span><span>let</span><span> </span><span>exceeded_bit</span><span> </span><span>=</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&gt;</span><span> </span><span>0x10_FFFF</span><span>)</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span></code></pre></div><p>The trick I pulled here was to cast a boolean (true or false) to an integer
(1 or 0).
Rust’s semantics guarantee this conversion is safe,
and it happens to be a representation the hardware can work with;
it doesn’t appear to incur a conditional after compilation.<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup></p>
<p>I used these booleans-as-integers to perform masking to zero.
But you know what else we can do with integers?</p>
<p><strong>Addition.</strong></p>
<h2 id="the-answer">The answer</h2>
<p>We can get rid of all the branches by tweaking the length-computing function:</p>
<div><pre tabindex="0"><code data-lang="rust"><span><span><span>const</span><span> </span><span>fn</span> <span>utf8_bytes_for_codepoint</span><span>(</span><span>codepoint</span>: <span>u32</span><span>)</span><span> </span>-&gt; <span>usize</span> <span>{</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>mut</span><span> </span><span>len</span><span> </span><span>=</span><span> </span><span>1</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>// In Rust, true casts to 1 and false to 0, so we can "just" sum lengths.
</span></span></span><span><span><span></span><span>    </span><span>len</span><span> </span><span>+=</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&gt;</span><span> </span><span>0x7f</span><span>)</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>len</span><span> </span><span>+=</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&gt;</span><span> </span><span>0x7ff</span><span>)</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>len</span><span> </span><span>+=</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&gt;</span><span> </span><span>0xffff</span><span>)</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>    </span><span>// As before:
</span></span></span><span><span><span></span><span>    </span><span>let</span><span> </span><span>surrogate_bit</span><span> </span><span>=</span><span> </span><span>((</span><span>codepoint</span><span> </span><span>&gt;=</span><span> </span><span>0xD800</span><span>)</span><span> </span><span>&amp;&amp;</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&lt;=</span><span> </span><span>0xDFFF</span><span>))</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>surrogate_mask</span><span> </span><span>=</span><span> </span><span>surrogate_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>2</span><span> </span><span>|</span><span> </span><span>surrogate_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>1</span><span> </span><span>|</span><span> </span><span>surrogate_bit</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>exceeded_bit</span><span> </span><span>=</span><span> </span><span>(</span><span>codepoint</span><span> </span><span>&gt;</span><span> </span><span>0x10_FFFF</span><span>)</span><span> </span><span>as</span><span> </span><span>usize</span><span>;</span><span>
</span></span></span><span><span><span>    </span><span>let</span><span> </span><span>exceeded_mask</span><span> </span><span>=</span><span> </span><span>exceeded_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>2</span><span> </span><span>|</span><span> </span><span>exceeded_bit</span><span> </span><span>&lt;&lt;</span><span> </span><span>1</span><span> </span><span>|</span><span> </span><span>exceeded_bit</span><span>;</span><span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>    </span><span>len</span><span> </span><span>&amp;</span><span> </span><span>!</span><span>surrogate_mask</span><span> </span><span>&amp;</span><span> </span><span>!</span><span>exceeded_mask</span><span>
</span></span></span><span><span><span></span><span>}</span><span>
</span></span></span></code></pre></div><p>This is the answer to Nathan’s original question, about working out the number of bytes.
Compiler explorer confirms that, with optimizations enabled, <a href="https://godbolt.org/#g:!%28%28g:!%28%28g:!%28%28h:codeEditor,i:%28filename:%271%27,fontScale:14,fontUsePx:%270%27,j:1,lang:rust,selection:%28endColumn:2,endLineNumber:22,positionColumn:2,positionLineNumber:22,selectionStartColumn:2,selectionStartLineNumber:22,startColumn:2,startLineNumber:22%29,source:%27%23%5Bno_mangle%5D%0Aconst+fn+utf8_bytes_for_codepoint%28codepoint:+u32%29+-%3E+usize+%7B%0A++++let+mut+len+%3D+1%3B%0A++++//+In+Rust,+true+casts+to+1+and+false+to+0,+so+we+can+%22just%22+sum+lengths.%0A++++len+%2B%3D+%28codepoint+%3E+0x7f%29+as+usize%3B%0A++++len+%2B%3D+%28codepoint+%3E+0x7ff%29+as+usize%3B%0A++++len+%2B%3D+%28codepoint+%3E+0xffff%29+as+usize%3B%0A%0A++++//+Handle+surrogates+via+bit-twiddling.%0A++++//+Rust+guarantees+true+%3D%3D+1+and+false+%3D%3D+0:%0A++++let+surrogate_bit+%3D+%28%28codepoint+%3E%3D+0xD800%29+%26%26+%28codepoint+%3C%3D+0xDFFF%29%29+as+usize%3B%0A++++//+Extend+that+one+bit+into+three,+and+use+its+inverse+as+a+mask+for+length%0A++++let+surrogate_mask+%3D+surrogate_bit+%3C%3C+2+%7C+surrogate_bit+%3C%3C+1+%7C+surrogate_bit%3B%0A%0A++++//+Handle+exceeded+values+via+bit-twiddling.%0A++++//+Unfortunately,+these+don!%27t+align+precisely+with+a+leading-zero+boundary%3B%0A++++//+the+largest+codepoint+is+U%2B10FFFF.%0A++++let+exceeded_bit+%3D+%28codepoint+%3E+0x10_FFFF%29+as+usize%3B%0A++++let+exceeded_mask+%3D+exceeded_bit+%3C%3C+2+%7C+exceeded_bit+%3C%3C+1+%7C+exceeded_bit%3B%0A%0A++++len+%26+!!surrogate_mask+%26+!!exceeded_mask%0A%7D%27%29,l:%275%27,n:%270%27,o:%27Rust+source+%231%27,t:%270%27%29%29,k:44.92012780022726,l:%274%27,m:100,n:%270%27,o:%27%27,s:0,t:%270%27%29,%28g:!%28%28h:compiler,i:%28compiler:r1830,filters:%28b:%270%27,binary:%271%27,binaryObject:%271%27,commentOnly:%270%27,debugCalls:%271%27,demangle:%270%27,directives:%270%27,execute:%271%27,intel:%270%27,libraryCode:%270%27,trim:%271%27,verboseDemangling:%270%27%29,flagsViewOpen:%271%27,fontScale:14,fontUsePx:%270%27,j:1,lang:rust,libs:!%28%29,options:%27-O%27,overrides:!%28%29,selection:%28endColumn:1,endLineNumber:1,positionColumn:1,positionLineNumber:1,selectionStartColumn:1,selectionStartLineNumber:1,startColumn:1,startLineNumber:1%29,source:1%29,l:%275%27,n:%270%27,o:%27+rustc+1.83.0+%28Editor+%231%29%27,t:%270%27%29%29,header:%28%29,k:55.07987219977275,l:%274%27,m:100,n:%270%27,o:%27%27,s:0,t:%270%27%29%29,l:%272%27,n:%270%27,o:%27%27,t:%270%27%29%29,version:4" rel="external" target="_blank">this function is branchless</a>.</p>
<p>Happily, this transformation also allowed the compiler to realize <code>len &lt;= 4</code> on all paths,
and to statically eliminate the array bounds check.
That means <a href="https://godbolt.org/#z:OYLghAFBqd5QCxAYwPYBMCmBRdBLAF1QCcAaPECAMzwBtMA7AQwFtMQByARg9KtQYEAysib0QXACx8BBAKoBnTAAUAHpwAMvAFYTStJg1DEArgoKkl9ZATwDKjdAGFUtEywYgA7KUcAZPAZMADl3ACNMYhAAJmjSAAdUBUI7Bhc3D28EpJSBAKDQlgio2MtMa1sBIQImYgJ0908fK0wbVOragnyQ8MiYuPNOhszmmrruwuL%2BgEpLVBNiZHYOAHoVsDAAagAhYkNkBHoFBU3GNHwjTdQqTfPMRMCCE8fUTbkAFQAxAFoADgA6ACkGgAgmsNsCwestu8EIYANYnIibYJMAhwhibfjETbozCbACOJkw5lSm0M6E2fhIjAAXliSLiEPj4ZgAJ6bQLJYAIAhA0HgrYghgc4iYFhMQKBYCbFh4Qask61fFyoL8qEQgXQzZCTD43kEeIKEBrYCEBAmML/NAsFYKVmYIgrMJ7BgHI4Kb4mAhUX4MnFYc7S9WQtYrTbYN0YfFMN5fP63aMPQTqsObABKjoWDCVmzCJioVEi5IYlLxmwYvRx102ADcxHhKWE2QQSZzMeX84XIqm1qG1pt3q8mOgywh5YmsMmCLjh5tzMRpaRyfF4o5ybRaAyFnmW23AldiFgyP3wxTNmK0EemWjNhAzHhaZhprvWycAO6RGOjzBl17lhdg1PU8MyzYgc3JTZ6CMdErhuJ9iFebF23rWhG0ne5UEeE4IAUBZEOANE23PeYCG%2Ba5vjCeZSxOVDiQUaZ1XiS0sUxF19kOEkFAAfW9X0IDuacQE2EwAGZohfb5AVE7A70BABWbYTF%2BaTtk2SQFIAEWXB8nxfQEvG2SFNhMqDHTMzFpM0kSfV%2BbjmzfbjsW4wSsMEASkzcghplU4zTPoGcu02KzgsUvzTNM5R02wT4AEkAA0FO2aCtKSjQtOCrwnDvDypy84KZOk2ShAACViz53iSlL5M0tKtP06IADZNgAWRBIQAGkqsYVLFPSmryROMSJMGkTflIcKIs2KKYoS7qGF67YuAygzsqgVzHgK7Aip1MqKvmxblpqhrmrazqDpqpKjuspghvEl9brGibQSmyLorixLFOq2rFOiFaspyjbBC2nbSvKyqvp6y7fvq4Kmta9qushhboe2P6Bse4aHqG8bJoimaPoun7tlE/61tyzDNqK0G9oh5KoeJ0njrh07EaJpKmZuu6Rsx3GXtM1LRKM0FJogLtl2gnyRa8WqRdBNAcxnKhMT4uyHJJJySBczzHgpoSRPuzYpJkkTkifTLhZBCKAtlb0LIK6zlqFyaB1izF0zMCxcVMfFRHMJFXi4EtKSoMQlFnTYNGXBRXk/W5DDh6JtE9wFYnndwLOAdEFHVa3GDhozROsvX8p2jRVC8KhsdNx9MF8/mTOgguQpLqmTfLyuq9G3S6%2Bdhv7dTwvi6Bmcy9UQtC2rnv65BF3wxKil6HT4gCKI2i8FjMJCG%2BAh30bdA0KMXPTIHD3zE2YATFqQxWzbAgfYdkKg/PUPaHDqyQo0EBJptvCV9QQirZ7KEAdoDHWwNqZF0jqoTSvwNAaBOqnZqrcIGiScJ/GBnwsHTCnmbXulsIoDmwKoVspYbwzgEPiLeM4XhMjFJgZc54zD4kIM8BgtZIjh0erGCU9p/SZ3RD/cyf9V5AN4fCUBIiAFEWAaPNB0lsrREytlKRgDMCyIKugtBmwg6rWXqI9R1CZ5z02AvUsS9MCqCWL%2BX8dYxD0TrBvPM29d770PsAY%2BJkBxyAYNiAgJhmCtloGyZceJw7oAEGADgM4GzAExPES88pygcj3rBWM9ARzSm%2BAhV4VEAnoFqGyGehDwzlgMMQYAJIZwj05CcOQg8uAaCwVgzxZkZyWOsVgdAGiW41LHo07izTPi4NrsU/y5kOl6i6dxcRoDJk2O6dQzRCjNhKL0fM6ZSyFErN0QDDZv5ZHGP7k3JBmwNiqJkbM05Gx9ndPEZCAystZ6ggIGyNcg4mBhCXiFJKSVlKqXUoLNS8kgUPK1DsPcmwEmYBoKofhsYFa2ErGiMk6t1QK3Pk4AA8sEd4sVghyGwMJZSoCNBhEafA7i8D4EzwxTOAmCVhLvE%2Bd8qBvz%2B5pX%2BULQFNVnpWwFn1ZcUdI5Cq0nyiKaVyUUqpdS5c2LcX4sJUK0VvLJqSq4BqjQMr4FypxXigl2BdUKoNSq7Saq%2BpSo1dq4V8r9VKs2LaxVhqHV6qdWKh5l0%2B7PKhJsAA6iqT25IV6GEqeQpkKokhkW5AwPANBRDA3VkqMUG53xMDZGw18%2BINDooEOfMGFUmUsvxD8sKHK%2BpcrUhpVVZbtjCrraa8VArtiNWVSKyO7qa1cDiJsFtbb%2Bpms7eNHR3be39r5aCuWII6UI06oWr5xa2Wlv5SZTlKluVVoHcu0KtaK5UFbXWjtW60qqC4Hu6Bokz0HurUevqqgNCXtUBeoVj7L2HolbejQPhz0Pqfd%2Bw9E7vWpyZtsZAVBgAQDfN5VKoIWAYFxFUk4BkCGmWYbcPYrYQDf0MuxN0nFji8VsjpWy9k9w8WciPR5Ryj3RGA5B6DW7lYCIQBAfShk8amWQngdskd/j/HLlgwZzSLbsdejbYAqA5HWVViRxy5HwEEAgHgHyXrXqifMqm1B1kDi1Ew1QRCLBeLiUU1LLdqmpr/AlPECAq1kB6OQP8Ig3FAJGBY/8W6MmSSuegixkzZmzP/ACe%2BPY8RuIkAgAgsZfnBpKDqNxTABINgQA017cTXtU5/UMhQVQjzhJIeS48s5YAfmGVS5R2IvnVOUY5TLMF1HaNVPoxFRjOH3RcSc6wTALHhP9ya4yLjB5s18dUAJoZ3XTOqZtmLUjEtGD6SgS1vDPFVbGci35sTEnQFIMTUlXj31VtmZtsl0B2moggD06gAzw0Vs9ai5sCzTArM2bsw51ATn77Slc%2B5xNrnHOoHfEEdAPmRN%2BYCwwILD3QvEAgAANVaJhoI74gcqdu7dGLBA4sJcgEg5Ly5UvKeQ69KrR6avS00hwWYtBODyV4J4DgWhSCoE4GfGcMcFhLDhqJHgpACCaHJ7MeEIBJCSH%2BAATmiBoLtXg4EaFiF4Jq%2BhOCSF4CwCQOraf08ZxwXgxoo487p%2BT0gcBYBIBtPEOgkRyCUFN%2BbqIxAuC/FElHGgtBWzEGNGLXnpAt7MGIGyTgXPveFKxWEbQrQ9dc5tGwQQWKGDBM91gfMwAnBiDfv73gWAJRGHEPr0g%2BBLy2A4caHPljWjemWFzx45RPdoXYr7lwWBPfvZV9wXgHDiBUSUJpcUIb3G89mFQAwwAFDQ7wJgd8WK1y065/wQQIgxDsCkDIQQigVDqBz7oLg%2BgQ0gFMOYfQeAwjGkgLMVA8RKg5k4N8LFvBUBt8XFgI/LGygVFSA4UswxPCb/8IEHoRQ%2Bib8SGSHPw/z0EANyAYAmCrD0BaDaCqDGHqFcEaGgPKDD3aHgMgL/yiE30GDqBAOwPQJ/0mH/1mFZ0WAXwpypxp0901wvE9mQB0X%2BAdz4zvFwEIEZCAy4GmF4D1y0BwVIGZBHD6CfwF3knkj4y8BF1%2BDly4BFxFy8Dly8HkgVw4CV1IBVwpVIHVxv04G1xAF1z7woI4GiCoJz0124IMNIDb2SHsEkCAA%3D" rel="external" target="_blank">the full code</a> is branchless as well. Victory!</p>
<h2 id="the-caveats">The caveats</h2>
<p>While this is <em>branchless</em>, I make absolutely no claim that it is <em>optimized</em> –
my only goal here was a proof-of-concept of branchlessness.
I haven’t even benchmarked it!</p>
<p>Chris Wellons notes in <a href="https://nullprogram.com/blog/2017/10/06/" rel="external" target="_blank">his post about branchless decoding</a>
that a DFA-based decoder can have similar performance;
SIMD and other “use what the hardware gives you” techniques
are probably even better.
I wouldn’t bet on my encoder over the one in your favorite standard library.</p>
<p>I also make no claims of usefulness.
But you’re welcome to do just about anything with the code:
I hereby release it under the MIT license. The full code is
<a href="https://cceckman.com/r/unicode-branchless" rel="external" target="_blank">here</a>,
along with the tests I used to match it against Rust’s implementation.</p>
<h2 id="thanks">Thanks!</h2>
<p>Thanks Nathan for the question and Lorenz for the insights!
Any mistakes remaining are my own – give me a shout if you spot them!</p>



</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Higher potassium intake at dinner linked to fewer sleep disturbances – study (211 pts)]]></title>
            <link>https://www.nutraingredients-asia.com/Article/2025/01/07/higher-potassium-intake-at-dinner-linked-to-fewer-sleep-disturbances/</link>
            <guid>42742161</guid>
            <pubDate>Fri, 17 Jan 2025 19:17:48 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nutraingredients-asia.com/Article/2025/01/07/higher-potassium-intake-at-dinner-linked-to-fewer-sleep-disturbances/">https://www.nutraingredients-asia.com/Article/2025/01/07/higher-potassium-intake-at-dinner-linked-to-fewer-sleep-disturbances/</a>, See on <a href="https://news.ycombinator.com/item?id=42742161">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article id="pn_rw" data-clarity-region="article"><p>Sleep disorders affect a large population, with <a href="https://www.nutraingredients-asia.com/Article/2024/11/14/blackmores-taps-into-underutilised-opportunities-in-vds-for-sleep-support/">demand for sleep support</a> on the rise. Although previous research has explored the relationship between specific nutrients and insomnia, comprehensive analyses of daily eating patterns of macro- and micronutrients remain limited. </p><p>Diets high in sodium, low in potassium, or both, have been associated with altered nocturnal blood pressure decrease (when blood pressure does not decline as much as it normally does at night). </p><p>At the same time, nocturnal hypertension has been linked to sleep disturbances. </p><p>As such, a cross-sectional study in Japan examined the relationship between potassium and sodium intake and insomnia among healthy Japanese adults.</p><p>Dietary data on energy intake and consumption of protein, fat, carbohydrates, sodium, and potassium during breakfast, lunch, dinner, and snacks spanning January to February 2021 were derived from Asken, a widely used Japanese food-logging mobile app. </p><p>Users can input ingredients, dishes, and portion sizes into the app, which automatically calculates calorie and nutritional intake by referencing the Standard Tables of Food Composition in Japan, 2020 (Eighth Revised Edition), as determined by the country’s Ministry of Education, Culture, Sports, Science and Technology. </p><p>The app boasts over 11.2m downloads as of November 2024. Self-reported food records accumulated on the app have been validated as reliable for research purposes. </p><p>As part of the study, online survey responses were obtained from 4,568 app users (3,320 women and 1,248 men) aged between 20 and 64 at the end of January 2021. </p><p>Sleep disturbances were assessed using the Athens Insomnia Scale (AIS), a self-administered psychometric questionnaire designed to evaluate sleep disorders, particularly insomnia. </p><p>The questionnaire consists of eight items, with total scores classified into three groups according to symptom severity — normal (scores of 3 or less), subclinical insomnia (scores of greater than 3 but less than 6), and clinical insomnia (scores of 6 or more).</p><p>The results showed that total daily potassium intake was inversely associated with log AIS score (<i>p</i> = 0.034). </p><p>When consumption during each meal (breakfast, lunch, dinner, and snacks) was analysed, only potassium intake at dinner remained significantly associated with AIS score (<i>p</i> = 0.003).</p><p><i>“Our findings suggest that potassium intake may be related to sleep quality. Higher potassium intake, especially at dinner, indicates fewer sleep disturbances [based on AIS scores]. This study provides a foundation for future intervention studies and personalised dietary recommendations,” </i>the authors wrote. </p><h3><b>Potassium power</b></h3><p>Previous studies have shown that lower potassium intake is associated with short sleepers, sleepiness during the day, poor sleep quality and sleep efficiency, and nighttime awakening.</p><p>There are several potential mechanisms explaining the relationship between potassium intake and sleep. </p><p>Firstly, adequate potassium levels are critical for proper muscle contraction and relaxation, as the mineral plays a key role in transmitting electrical signals in nerve fibres and muscle cells, thereby regulating overall muscle function and contributing to sleep patterns. </p><p>Additionally, potassium is essential for neurotransmitter function, which is crucially involved in regulating sleep and wakefulness. </p><p>Studies have also demonstrated that potassium reduces both systolic and diastolic blood pressure. Given the well-documented association between poor sleep and hypertension, these findings suggest that potassium intake could lead to better sleep by regulating blood pressure. </p><p>However, the mechanism underlying why dinner intake is particularly significant remains to be investigated.</p><p><i>“To better understand the observed association between potassium intake and insomnia, future research should include both dietary records and blood pressure data. Longitudinal and intervention studies will also be needed to establish causal relationships and explore other factors influencing sleep.” </i></p><h3><b>Link between sodium intake and sleep to be verified</b></h3><p>Several studies have found sodium or salt intake to be associated with sleep maintenance difficulties, later sleep times, and a higher probability of insomnia. </p><p>For example, a Japanese cross-sectional study showed that energy-adjusted sodium intake was positively correlated with sleep duration among healthy Japanese adult men. </p><p>In the present study, however, no significant association between sodium intake and AIS scores was discovered. This calls for further evidence to verify the relationship between sodium intake and sleep.</p><p>The Japanese diet is characterised by high sodium and low potassium intake, or a high sodium-to-potassium ratio. </p><p>The sodium-to-potassium ratio is recognised as a superior indicator for assessing blood pressure outcomes and hypertension incidence, compared to individual measures of sodium or potassium. </p><p>The sodium-chloride cotransporter (NCC), expressed in the kidneys, is a key molecule in the regulation of urinary potassium excretion. Consuming a low-potassium diet activates the NCC, promoting sodium reabsorption. </p><p>Conversely, a high-potassium diet strongly suppresses NCC activation, resulting in increased urinary sodium and potassium excretion. </p><p>Nevertheless, the results in this study did not find any meaningful association between the sodium-to-potassium intake ratio and AIS scores.</p><p><i>Source: Nutrients</i></p><p><a href="https://doi.org/10.3390/nu17010148"><i>https://doi.org/10.3390/nu17010148</i></a><i> </i></p><p><i>“The Association of Sodium or Potassium Intake Timing with Athens Insomnia Scale Scores: A Cross-Sectional Study”</i></p><p><i>Authors: Taiki Okamoto, et al</i></p></article></div></div>]]></description>
        </item>
    </channel>
</rss>