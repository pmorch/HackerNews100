<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 05 Jul 2023 15:00:07 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[News is bad for you – and giving up reading it will make you happier (2013) (110 pts)]]></title>
            <link>https://www.theguardian.com/media/2013/apr/12/news-is-bad-rolf-dobelli</link>
            <guid>36600020</guid>
            <pubDate>Wed, 05 Jul 2023 13:16:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theguardian.com/media/2013/apr/12/news-is-bad-rolf-dobelli">https://www.theguardian.com/media/2013/apr/12/news-is-bad-rolf-dobelli</a>, See on <a href="https://news.ycombinator.com/item?id=36600020">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="maincontent"><p><span><span>I</span></span>n the past few decades, the fortunate among us have recognised the hazards of living with an overabundance of food (obesity, diabetes) and have started to change our diets. But most of us do not yet understand that news is to the mind what sugar is to the body. News is easy to digest. The media feeds us small bites of&nbsp;trivial matter, tidbits that don't really concern our lives and don't require thinking. That's why we experience almost no saturation. Unlike reading books and long magazine articles (which require thinking), we can swallow limitless quantities of news flashes, which are bright-coloured candies for the mind. Today, we have reached the same point in relation to information that we faced 20 years ago in regard to food. We are beginning to recognise how&nbsp;toxic news can be.</p><p><strong>News misleads.</strong> Take the following event (borrowed from Nassim Taleb). A&nbsp;car drives over a bridge, and the bridge collapses. What does the news media focus on? The car. The person in the car. Where he came from. Where he planned to go. How he experienced the crash (if he survived). But that is all irrelevant. What's relevant? The structural stability of the bridge. That's the underlying risk that has been lurking, and could lurk in other bridges. But the car is flashy, it's dramatic, it's a&nbsp;person (non-abstract), and it's news that's cheap to produce. News leads us to walk around with the completely wrong risk map in our heads. So terrorism is over-rated. Chronic stress is under-rated. The collapse of Lehman Brothers is overrated. Fiscal irresponsibility is under-rated. Astronauts are over-rated. Nurses are under-rated.</p><p>We are not rational enough to be exposed to the press. Watching an airplane crash on television is going to&nbsp;change your attitude toward that risk,&nbsp;regardless of its real probability. If&nbsp;you think you can compensate with&nbsp;the strength of your own inner contemplation, you are wrong. Bankers and economists – who have powerful incentives to compensate for news-borne hazards – have shown that they cannot. The only solution: cut yourself off from news consumption entirely.</p><p><strong>News is irrelevant.</strong> Out of the approximately 10,000 news stories you have read in the last 12 months, name one that – because you consumed it – allowed you to make a better decision about a serious matter affecting your life, your career or your business. The point is: the consumption of news is irrelevant to you. But people find it very difficult to recognise what's relevant. It's&nbsp;much easier to recognise what's new. The relevant versus the new is the fundamental battle of the current age. Media organisations want you to believe that news offers you some sort of a competitive advantage. Many fall for that. We get anxious when we're cut off from the flow of news. In reality, news consumption is a competitive disadvantage. The less news you consume, the bigger the advantage you have.</p><p><strong>News has no explanatory power.</strong> News items are bubbles popping on the&nbsp;surface of a deeper world. Will accumulating facts help you understand the world? Sadly, no. The relationship is inverted. The important stories are non-stories: slow, powerful movements that develop below journalists' radar but have a transforming effect. The more "news factoids" you digest, the less of the big picture you will understand. If&nbsp;more information leads to higher economic success, we'd expect journalists to be at the top of the pyramid. That's not the case.</p><p><strong>News is toxic to your body. </strong>It constantly triggers the <a href="https://www.theguardian.com/science/neurophilosophy/2012/may/16/neuroscience-psychology">limbic system</a>. Panicky stories spur the release of cascades of glucocorticoid (cortisol). This deregulates your immune system and inhibits the release of growth hormones. In other words, your body finds itself in a state of chronic stress. High glucocorticoid levels cause impaired digestion, lack of growth (cell,&nbsp;hair, bone), nervousness and susceptibility to infections. The other&nbsp;potential side-effects include fear,&nbsp;aggression, tunnel-vision and&nbsp;desensitisation.</p><p><strong>News increases cognitive errors.</strong> News feeds the mother of all cognitive errors: confirmation bias. In the words of Warren Buffett: "What the human being is best at doing is interpreting all new information so that their prior conclusions remain intact." News exacerbates this flaw. We become prone to overconfidence, take stupid risks and misjudge opportunities. It also exacerbates another cognitive error: the story bias. Our brains crave stories that "make sense" – even if they don't correspond to reality. Any journalist who writes, "The market moved because of X" or "the company went bankrupt because of Y" is an idiot. I am fed up with this cheap way of "explaining" the world.</p><p><strong>News inhibits thinking.</strong> Thinking requires concentration. Concentration requires uninterrupted time. News pieces are specifically engineered to interrupt you. They are like viruses that steal attention for their own purposes. News makes us shallow thinkers. But it's worse than that. News severely affects memory. There are two types of memory. Long-range memory's capacity is nearly infinite, but working memory is limited to a certain amount of slippery data. The path from short-term to long-term memory is a choke-point in the brain, but anything you want to understand must pass through it. If this passageway is disrupted, nothing gets through. Because news disrupts concentration, it weakens comprehension. Online news has an even worse impact. <a href="http://www.wired.com/magazine/2010/05/ff_nicholas_carr/">In a 2001 study two scholars in Canada</a> showed that comprehension declines as the number of hyperlinks in a document increases. Why? Because whenever a link appears, your brain has to at least make the choice not to click, which in itself is distracting. News is an intentional interruption system.</p><p><strong>News works like a drug. </strong>As stories develop, we want to know how they continue. With hundreds of arbitrary storylines in our heads, this craving is increasingly compelling and hard to ignore. Scientists used to think that the dense connections formed among the 100 billion neurons inside our skulls were largely fixed by the time we reached adulthood. Today we know that this is not the case. Nerve cells routinely break old connections and form new ones. The more news we consume, the more we exercise the neural circuits devoted to skimming and multitasking while ignoring those used for reading deeply and thinking with profound focus. Most news consumers – even if they used to be avid book readers – have lost the ability to absorb lengthy articles or books. After four, five pages they get tired, their concentration vanishes, they become restless. It's not because they got older or their schedules became more onerous. It's because the physical structure of their brains has changed.</p><p><strong>News wastes time.</strong> If you read the newspaper for 15 minutes each morning, then check the news for 15 minutes during lunch and 15 minutes before you go to bed, then add five minutes here and there when you're at work, then count distraction and refocusing time, you will lose at least half a day every week. Information is no longer a scarce commodity. But attention is. You are not&nbsp;that irresponsible with your money, reputation or health. Why give away your mind?</p><p><strong>News makes us passive.</strong> News stories are overwhelmingly about things you cannot influence. The daily repetition of news about things we can't act upon makes us passive. It grinds us down until we adopt a worldview that is pessimistic, desensitised, sarcastic and fatalistic. The scientific term is "learned helplessness". It's a bit of a stretch, but I&nbsp;would not be surprised if news consumption, at least partially contributes to the widespread disease of depression.</p><p><strong>News kills creativity.</strong> Finally, things we already know limit our creativity. This is one reason that mathematicians, novelists, composers and entrepreneurs often produce their most creative works at a young age. Their brains enjoy a wide, uninhabited space that emboldens them to come up with and pursue novel ideas. I don't know a single truly creative mind who is a news junkie – not a writer, not a composer, mathematician, physician, scientist, musician, designer, architect or painter. On the other hand, I&nbsp;know a bunch of viciously uncreative minds who consume news like drugs. If you want to come up with old solutions, read news. If you are looking for new solutions, don't.</p><p>Society needs journalism – but in a&nbsp;different way. Investigative journalism is always relevant. We need reporting that polices our institutions and uncovers truth. But important findings don't have to arrive in the form of news. Long journal articles and in-depth books are good, too.</p><p>I have now gone without news for four years, so I can see, feel and report the effects of this freedom first-hand: less disruption, less anxiety, deeper thinking, more time, more insights. It's not easy, but it's worth it.</p><p><em>This is an edited extract from an essay first published at </em><a href="http://dobelli.com/"><em>dobelli.com</em></a><em>. The Art of Thinking Clearly: Better Thinking, Better Decisions by Rolf Dobelli is published by Sceptre, £9.99. Buy it for £7.99 at </em><a href="http://www.guardianbookshop.co.uk/BerteShopWeb/viewProduct.do?ISBN=9781444759549"><em>guardianbookshop.co.uk</em></a></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Astro framework lowers competitors by ~40% on performance graph to looks better (123 pts)]]></title>
            <link>https://twitter.com/sigma__dev/status/1676505365935005696</link>
            <guid>36599217</guid>
            <pubDate>Wed, 05 Jul 2023 12:07:05 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://twitter.com/sigma__dev/status/1676505365935005696">https://twitter.com/sigma__dev/status/1676505365935005696</a>, See on <a href="https://news.ycombinator.com/item?id=36599217">Hacker News</a></p>
Couldn't get https://twitter.com/sigma__dev/status/1676505365935005696: Error [ERR_FR_TOO_MANY_REDIRECTS]: Maximum number of redirects exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Germany Achieves Record 57.7% Renewable Energy Share for First Half of 2023 (132 pts)]]></title>
            <link>https://www.ise.fraunhofer.de/en/press-media/press-releases/2023/german-net-power-generation-in-first-half-of-2023-renewable-energy-share-of-57-percent.html</link>
            <guid>36598618</guid>
            <pubDate>Wed, 05 Jul 2023 11:04:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.ise.fraunhofer.de/en/press-media/press-releases/2023/german-net-power-generation-in-first-half-of-2023-renewable-energy-share-of-57-percent.html">https://www.ise.fraunhofer.de/en/press-media/press-releases/2023/german-net-power-generation-in-first-half-of-2023-renewable-energy-share-of-57-percent.html</a>, See on <a href="https://news.ycombinator.com/item?id=36598618">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-emptytext="linklist_add_items"><article>
    <div>
<p>The first half of 2023 saw a normalization of energy prices, with natural gas prices and electricity exchange prices returning to pre-Ukraine war levels but still above 2021 prices. The impact of the nuclear phase-out, with the shutdown of the last nuclear power plants Isar2, Emsland and Neckarwestheim2 in April 2023, has been absorbed well. Factors such as increasing production from renewable sources, weather and higher production in neighboring European countries are significantly stronger than the effect of shutting down the three nuclear plants. The approximately 30 TWh from the reactors was offset by reduced exports, increased imports, and the addition of solar and wind capacity.<br> </p> 
<p>Load was 234 TWh in the first half of the year (H1 2023: 250 TWh), continuing the declining trend. Electricity production decreased from 252 TWh to 225 TWh compared to the first half of 2022. Exports of electricity to France decreased after the French nuclear reactors came back online. Exports to Austria and Switzerland decreased due to the countries' higher in-house generation and lower consumption. In the first quarter of 2023, more electricity than usual was imported because electricity prices in neighboring countries were favorable.</p> 
 
<h4>Constant generation from sun and wind</h4> 
<p>Wind energy was by far the most important renewable energy source. Wind turbines produced 67 TWh in the first half of 2023, down slightly from the first half of 2022 (about 68 TWh). February was a weak wind month, lowering the overall result. Photovoltaic systems fed approximately 30 TWh into the public grid in the first half of the year, a slight decrease from the previous year's 31 TWh, for which the weak month of March was mainly responsible. Solar power plants thus accounted for 12.5 percent of net public power generation. On May 4, they set a record: for the first time, solar plants in Germany fed more than 40 GW of power into the grid. With about 15 TWh of solar and wind power generation, June set a new monthly record for a June month. Hydropower produced 9.3 TWh in the first half of the year, up from 8.2 TWh a year earlier. Biomass power generation was on par with last year at 21 TWh.<br> </p> 
<p>In total, solar, wind, hydro, and biomass renewables produced about 130 TWh in the first half of 2023, down slightly from 131 TWh a year earlier. The share of net public electricity generation, i.e., the mix of electricity that actually comes out of the socket, was about 57.7 percent, well above the first half of 2022 (51.8 percent).<br> </p> 
 
<h4>Decline in nuclear and fossil generation</h4> 
<p>The last three nuclear power plants generated 6.7 TWh until their shutdown on April 15. In the first half of 2022, the figure was 15.8 TWh.<br> </p> 
<p>Coal-fired power generation also fell: Lignite-fired power plants generated about 41.2 TWh, a sharp decline of 21 percent from 2022 (52.1 TWh). Net production from coal-fired power plants also decreased by 23 percent, from 26.2 TWh in 2022 down to 20.1 TWh in 2023. Electricity generation from natural gas decreased only slightly from 24.3 TWh to 23.4 TWh. In addition to gas-fired power plants for the public power supply, gas-fired plants in the mining and manufacturing sectors also supply the industrial own consumption. These approximately produced an additional 24 TWh for industrial captive use.</p> 
 
<h4>Prices for electricity and natural gas decline</h4> 
<p>The volume-weighted average electricity price in the day-ahead auction was 100.54 euros/MWh. This is a significant decrease compared to the first half of 2022 with 181.28 Euro/MWh.<br> </p> 
<p>The average price for natural gas in the first half of 2023 was 45.29 euros/MWh. In the first half of 2022, the price was 99.84 euros/MWh.</p> 
<p>The average CO₂ certificate price per metric ton of CO₂ in Germany has risen to 86.97 euros, double the 2021 amount, while the volume-weighted average electricity price in the day-ahead auction was 100.37 euros/MWh.</p> 
 
<h4>Solar and wind capacity grow unevenly</h4> 
<p>The addition of photovoltaic capacity is currently within the target corridor of the German climate protection goals: From January to May alone, 5 GW was added, which would meet the target of 9 GW in 2023. Wind expansion, on the other hand, is not on track: By the end of May, 1 GW had been installed onshore and 0.23 GW offshore, indicating that the target of 4 GW will not be reached.<br> </p> 
<p>There has been great movement in the field of battery storage. In the first half of 2023, 1.7 GW of storage capacity with a storage capacity of 2.4 GWh was added, so that 5.6 GW of capacity with 8.3 GWh of capacity is now installed in Germany. By the end of the year, this capacity will increase to 10 to 11 GWh.</p></div>
</article>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The hardest part of building software is not coding, it's requirements (147 pts)]]></title>
            <link>https://stackoverflow.blog/2023/06/26/the-hardest-part-of-building-software-is-not-coding-its-requirements/</link>
            <guid>36597709</guid>
            <pubDate>Wed, 05 Jul 2023 09:03:37 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://stackoverflow.blog/2023/06/26/the-hardest-part-of-building-software-is-not-coding-its-requirements/">https://stackoverflow.blog/2023/06/26/the-hardest-part-of-building-software-is-not-coding-its-requirements/</a>, See on <a href="https://news.ycombinator.com/item?id=36597709">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
    
<p>With all the articles about just how amazing all the developments in AI have been, there’s plenty of hand wringing around the possibility that we, as software developers, could soon be out of a job, replaced by artificial intelligence. They imagine all the business execs and product researchers will bypass most or all of their software developers and asking AI directly to build exactly what they think they want or need. As someone who’s spent 15 years creating software from the specs these folks create, I find it hard to take all the worrying seriously.&nbsp;</p>



<p>Coding can be a challenge, but I’ve never had spent more than two weeks trying to figure out what is wrong with the code. Once you get the hang of the syntax, logic, and techniques, it’s a pretty straightforward process—most of the time. The real problems are usually centered around what the software is supposed to do. The hardest part about creating software is not writing code—it’s creating the requirements, and those software requirements are still defined by humans.</p>



<p>This article will talk about the relationship between requirements and software, as well as what an AI needs to produce good results.&nbsp;</p>



<h2 id="h-it-s-not-a-bug-it-s-feature-no-wait-it-s-a-bug">It’s not a bug, it’s feature…no wait, it’s a bug</h2>



<p>Early in my software career, I was placed on a project midstream in order to help increase the velocity of the team. The main purpose of the software was to configure custom products on ecommerce sites.</p>



<p>I was tasked with generating dynamic terms and conditions. There was conditional verbiage that depended on the type of product being purchased, as well as which US state the customer was located in due to legal requirements.</p>



<p>At some point, I thought I found a potential defect. A user would pick one product type, which would generate the appropriate terms and conditions, but further along the workflow it would allow the user to pick a different product type and predefined terms and conditions. It would violate one of the features explicitly agreed on in the business requirement that had the client’s signature.</p>



<p>I naively asked the client,&nbsp; “Should I remove the input that allowed a user to override the right terms and conditions?” The response I got has been seared inside my brain ever since. His exact words were spoken with complete and total confidence;</p>



<p><em>“That will never happen”</em></p>



<p>This was a senior executive who had been at the company for years, knew the company’s business processes, and was chosen to oversee the software for a reason. The ability to override the default terms and conditions was explicitly requested by the same person. Who the heck was I to question anyone, much less a senior executive of a company that was paying us money to build this product? I shrugged it off and promptly forgot about it.</p>



<p>Months later, just a few weeks before the software was to go live, a tester on the client side had found a defect, and it was assigned to me. When I saw the details of the defect, I laughed out loud.</p>



<p>That concern I had about overriding default terms and conditions, the thing I was told would never happen? Guess what was happening? Guess who was blamed for it, and who was asked to fix it?</p>



<p>The fix was relatively easy, and the consequences of the bug were low, but this experience has been a recurring theme in my career building software. I’ve talked to enough fellow software engineers to know I’m not alone. The problems have become bigger, harder to fix, and more costly, but the source of the problem is usually the same: the requirements were unclear, inconsistent, or wrong.</p>



<figure><img decoding="async" src="https://lh3.googleusercontent.com/YZErrcpfauOH-94JNOf9DHn-pmh0AuPcCui3a7EIcYWGf34stpuXwqX0iVyYJP9i3ZKq7LuHKABtPwz175B3IWKvFQZqrKLQM43BI4yqsoh7tlgRncg959aTYgkbm-f8UfwFZkWouGaZuqRZIBP4d9o" alt=""></figure>



<h2 id="h-ai-right-now-chess-versus-self-driving-cars">AI right now: Chess versus self-driving cars</h2>



<p>The concept of artificial intelligence has been around for quite some time, although the high profile advances have raised concerns in the media <a href="https://www.npr.org/2023/05/15/1175776384/congress-wants-regulate-ai-artificial-intelligence-lot-of-catching-up-to-do">as well as Congress</a>. Artificial intelligence has already been very successful in certain areas. The first one that comes to mind is chess.</p>



<p>AI has been applied to chess as far back as the 1980s. It is widely accepted that AI has exceeded human’s ability to win at chess. It’s also not surprising, as the parameters of chess are FINITE (<a href="https://chess.stackexchange.com/questions/13522/is-chess-a-solved-game">but the game has not yet been solved</a>).</p>



<p>Chess always starts with 32 pieces on 64 squares, has well documented officially agreed upon rules, and most importantly has a clearly defined objective. In each turn, there are a finite number of possible moves. Playing chess is just following a rules engine.&nbsp; AI systems can calculate the repercussions of every move to select the move most likely outcome to capture an opponent’s piece or gain position, and ultimately win.</p>



<p>There has been another front where AI has been very active – self driving cars. Manufacturers have been promising self-driving cars for quite some time. Some have the capacity to self-drive, but there are caveats. In many situations the car requires active supervision; the driver may need to keep their hands on the wheel, the self-driving feature is not autonomous.</p>



<p>Like chess-playing AI programs, self-driving cars largely use <a href="https://www.oreilly.com/radar/podcast/the-technology-behind-self-driving-vehicles/">rules-based engines</a> to make decisions. Unlike the chess programs, the rules on how to navigate every possible situation are not clearly defined. There are thousands of little judgments drivers make in a given trip avoiding pedestrians, navigating around double-parked cars, and turning in busy intersections. Getting those judgments right means the difference between arriving at the mall safely or arriving at the hospital.</p>



<p>In technology, the standard is <a href="https://www.skmurphy.com/blog/2009/09/01/achieving-six-nines-when-you-launch/">five or even six 9s for availability</a>—a website or service is available 99.999% (or 99.9999%) of the time. The cost to achieve the first 99% isn’t that high. It means that your website or service can be down for more than three days—87.6 hours—a year. However for each 9 you add at the end, the cost to get there grows exponentially. By the time you reach 99.9999%, you can only allow for 31.5 seconds of downtime a year. It requires significantly more planning and effort and of course is more expensive. Getting the first 99% may not be easy, but proportionally it’s a lot easier and cheaper than that last tiny fraction.</p>



<p>365 X 24 X 60 minutes = 525,600 minutes a year</p>



<p>99% availability -&gt; down for 5256 minutes, 87.6 hours<br>99.9% availability -&gt; down 526 minutes, 8.76 hours<br>99.99% -&gt; 52 minutes, less than 1 hour<br>99.999% -&gt; 5.2 minutes<br>99.9999% -&gt; 0.52 minutes, roughly 31.5 seconds</p>



<p>No matter how close AI gets to being good enough, there’s always the risk of accidents and fatalities. Those risks and consequences happen every day with humans behind the wheel. I don’t know what rate of accidents and fatalities will be acceptable by governments, but you have to think it needs to be at least as good as human beings.</p>



<p>The reason it’s so difficult to get that acceptable level of safety is because driving a car entails significantly more variables than chess, and those variables are NOT FINITE. The first 95% or 99% might be predictable and easy to account for. However, there are so many edge cases after that first 99%, and each one may share some traits but each one is unique; other vehicles on the road driven by other human beings, road closures, construction, accidents, weather events, How many times have you driven after a road has been paved over but the paint for the dividing lines on the road has not been applied. It’s significantly harder to get your AI model to be able to account for and recognize those anomalies and edge cases, and more importantly how to respond appropriately without getting into an accident. Each edge case may share some traits, but rarely are they identical, which makes it harder for AI identify the appropriate way to respond.</p>



<h2 id="h-ai-can-t-create-software-only-code">AI can’t create software, only code</h2>



<p>Creating and maintaining software has a lot more in common with driving than playing chess. There are far more variables involved and the rules are based on judgment calls. You may have a desired outcome when you are building software, but it’s unlikely that it’s as singular as chess. Software is rarely done; features get added and bugs are fixed; it’s an ongoing exercise. Unlike software, once a chess game is won or lost it’s over.&nbsp;</p>



<p>In software development, we do have a tool to get our software designs closer to the tightly-controlled rules engine of chess: <a href="https://stackoverflow.blog/2020/04/06/a-practical-guide-to-writing-technical-specs/">technical specifications</a>. At their best, specs walk through expected user behaviors and program flows. Here’s how a user buys an e-sandwich: click this button, create this data structure, run this service. However, that’s rarely what we get. Too often, we’re handed wishlists as feature specs, back-of-the-napkin wireframes, and unclear requirements documents and told to make our best judgments.&nbsp;</p>



<p>Worse yet, requirements change or are ignored. Recently I was asked to help a team build something that could help people get information on health issues related to COVID 19. The application was going to be for an area of the globe that did not have reliable WIFI. The team wanted me to help build an application that could do surveys via SMS—phone text messages. Initially I was excited to be involved.</p>



<p>Once I started hearing the team describe what they thought they wanted, I realized this was going to be a problem. It’s one thing for a retail company to ask you on a scale of 1-10 how likely you are to shop in their store again. It’s very different to ask multistep surveys with multiple choice questions about the symptoms you’re experiencing with a possible COVID infection. I never said no, but I did bring up all the possible points of failure in this process and wanted the team to clearly define how we would handle incoming answers for all questions. Would it be comma separated numbers mapped to each answer? What happens if a submitted answer does not map to any of the options given?</p>



<p>After all these questions, the team came to the same conclusion. We decided it would be best not to go through with it. Believe it or not, I’d say this was actually a successful outcome. It would have been more wasteful to have gone ahead without a clear resolution for all of the potential errors when invalid user data was submitted.</p>



<p>Is the idea behind using AI to create software to just let those same stakeholders talk directly to a computer to create a SMS based survey? Is AI going to ask probing questions about how to handle all the possible issues of collecting survey data via SMS? Is it going to account for all the things that we as human beings might do incorrectly along the way and how to handle those missteps?</p>



<p>In order to produce a functional piece of software from AI, you need to know what you want and be able to clearly and precisely define it. There are times when I’m writing software just for myself where I don’t realize some of the difficulties and challenges until I actually start writing code.</p>



<p>Over the past decade, the software industry has transitioned from the waterfall methodology to <a href="https://stackoverflow.blog/2023/06/13/the-meeting-that-changed-how-we-build-software-ep-579/">agile</a>. Waterfall defines exactly what you want before any code is written, while agile allows enough flexibility so you can make adjustments along the way.</p>



<p>So many software projects using waterfall have failed because the stakeholders thought they knew what they wanted and thought they could accurately describe it and document it, only to be very disappointed when the final product was delivered. Agile software development is supposed to be an antidote to this process.</p>



<p>AI might be best suited to rewrite the software we already have but need to rewrite it to use newer hardware or a more modern programming language. There are still a lot of institutions with software written in <a href="https://stackoverflow.blog/2020/04/20/brush-up-your-cobol-why-is-a-60-year-old-language-suddenly-in-demand/">COBOL</a>, but there are fewer programmers learning how to use it. If you know exactly what you want, maybe you could get AI to produce software faster and cheaper than a team of human programmers. I believe AI could create the software that has already been created faster than human programmers but that’s because someone figured out what that software should do along the way.</p>



<p>AI might actually do pretty well building software using the waterfall process, which is also affectionately known as death march. You know who is terrible at waterfall? We are, human beings. And it’s not because of the part where the signed documents are handed over to a team of programmers so they can write the code. It’s everything before that. Artificial intelligence can do some extraordinary things, but it can’t read your mind or tell you what you should want.</p><p>
    Tags: <a href="https://stackoverflow.blog/tag/ai/" rel="tag">ai</a>, <a href="https://stackoverflow.blog/tag/ai-assistant/" rel="tag">ai assistant</a>, <a href="https://stackoverflow.blog/tag/llm/" rel="tag">llm</a>, <a href="https://stackoverflow.blog/tag/requirements/" rel="tag">requirements</a>, <a href="https://stackoverflow.blog/tag/software-engineering/" rel="tag">software engineering</a>  </p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[PhD Simulator (269 pts)]]></title>
            <link>https://research.wmz.ninja/projects/phd/index.html</link>
            <guid>36597534</guid>
            <pubDate>Wed, 05 Jul 2023 08:39:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://research.wmz.ninja/projects/phd/index.html">https://research.wmz.ninja/projects/phd/index.html</a>, See on <a href="https://news.ycombinator.com/item?id=36597534">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Demoscene accepted as UNESCO cultural heritage in The Netherlands (638 pts)]]></title>
            <link>http://demoscene-the-art-of-coding.net/2023/07/03/unescodemoscene-accepted-as-unesco-cultural-heritage-in-the-netherlands/</link>
            <guid>36597460</guid>
            <pubDate>Wed, 05 Jul 2023 08:32:19 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="http://demoscene-the-art-of-coding.net/2023/07/03/unescodemoscene-accepted-as-unesco-cultural-heritage-in-the-netherlands/">http://demoscene-the-art-of-coding.net/2023/07/03/unescodemoscene-accepted-as-unesco-cultural-heritage-in-the-netherlands/</a>, See on <a href="https://news.ycombinator.com/item?id=36597460">Hacker News</a></p>
Couldn't get http://demoscene-the-art-of-coding.net/2023/07/03/unescodemoscene-accepted-as-unesco-cultural-heritage-in-the-netherlands/: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Open Letter from Security Researchers in Relation to the Online Safety Bill [pdf] (193 pts)]]></title>
            <link>https://haddadi.github.io/UKOSBOpenletter.pdf</link>
            <guid>36596610</guid>
            <pubDate>Wed, 05 Jul 2023 07:05:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://haddadi.github.io/UKOSBOpenletter.pdf">https://haddadi.github.io/UKOSBOpenletter.pdf</a>, See on <a href="https://news.ycombinator.com/item?id=36596610">Hacker News</a></p>
&lt;Not HTML&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[That Time I Posted Myself Out Of a Job (180 pts)]]></title>
            <link>https://cohost.org/stillinbeta/post/1847579-that-time-i-posted-m</link>
            <guid>36596193</guid>
            <pubDate>Wed, 05 Jul 2023 06:21:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cohost.org/stillinbeta/post/1847579-that-time-i-posted-m">https://cohost.org/stillinbeta/post/1847579-that-time-i-posted-m</a>, See on <a href="https://news.ycombinator.com/item?id=36596193">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-post-body="true" data-testid="post-body"><p>
The year was 2019, the place San Diego. I was attending KubeCon on behalf of my then-employer, VMware. Kubecon is the Kubernetes Conference; If you don’t know what Kubernetes is don’t worry about it. It’s just a computers. 
<!-- --></p>
<!-- --><p>
I tended to tweet a lot at conferences, as was the style at the time. Any particularly interesting talks I’d live-tweet, and generally I took a lot of photos around the event. 
<!-- --></p>
<!-- --><figure>
  <!-- --><img src="https://staging.cohostcdn.org/attachment/e7bc2314-0432-41c8-81c1-d07c2465e795/pentesting.png?width=337&amp;height=415&amp;fit=crop&amp;auto=webp&amp;dpr=2" alt="Screenshot from my twitter: Extremely hype for Ian Coldwater's keynote! Talking about pentesting Kubernetes">
  <!-- --><figcaption>I don’t remember this talk but Ian is always incredible.
<!-- --></figcaption>
<!-- --></figure>
<!-- --><p>
Most of the tweets were pretty neutral, but some were a little more pointed. 
<!-- --></p>
<!-- --><figure>
  <!-- --><img src="https://staging.cohostcdn.org/attachment/081190db-eed6-4061-9bc5-2c4dd2fbcd73/walmartscale.png" alt="&quot;When we say walmart, the first thing that comes to mind is scale&quot; I guess if forcing workers onto foodstamps and brutally repressing unions counts as scaling #KubeCon">
  <!-- --><figcaption>Walmart is sort of like if they made Amazon in real life
<!-- --></figcaption>
<!-- --></figure>
<!-- --><figure>
  <!-- --><img src="https://staging.cohostcdn.org/attachment/ee8e399a-237a-4da7-a520-38330d706b60/notechforice.png" alt="&quot;No Tech For ICE&quot; written in Legos on a wall">
  <!-- --><figcaption>Trans rights
<!-- --></figcaption>
<!-- --></figure>
<!-- --><h2>Inciting Incident<!-- --></h2>
<!-- --><p>
<!-- --><em>&lt;extremely <!-- --><a href="https://www.youtube.com/channel/UCPxHg4192hLDpTI2w7F9rPg" target="_blank" rel="nofollow noopener noreferrer">Justin Roczniak voice<!-- --></a>&gt;<!-- --></em> At 8:08 AM on November 21st, 2019, I posted the following tweets:
<!-- --></p>
<!-- --><figure>
  <!-- --><img src="https://staging.cohostcdn.org/attachment/2b3f2974-5c38-4caf-9926-b6d428e3d74f/pasted%20image%200.png" alt="quote tweeting &quot;If kubernetes is good enough for DoD weapon systems, it's definitely good enough for your business&quot; with &quot;Fuck you&quot;">
  <!-- --><figcaption>I don’t even usually swear much
<!-- --></figcaption>
<!-- --></figure><p>
And follewed it up with
</p><!-- --><figure>
  <!-- --><img src="https://staging.cohostcdn.org/attachment/2dd68775-45c5-467f-8ef2-384af9b34989/bloodwashesoff.png" alt="Thanks for this @NichChaillan, I'd shake your hand but y'know, blood never washes off">
  <!-- --><figcaption>Anger does not really become me, but boy was I mad. <!-- --></figcaption>
<!-- --></figure>
<!-- --><p>
I think absolutely nothing of this. It was a tweet-heavy day! My thumbs were sore at the end of it!
<!-- --></p>
<!-- --><p>
But the next day, right before my flight home, I get a DM from a helpful colleague:
<!-- --></p>
<!-- --><figure>
  <!-- --><img src="https://staging.cohostcdn.org/attachment/c8ab3389-fd41-46b9-bf3d-5ffc81fbabfc/vmwarefederal.png" alt="I saw your reply to Nic Chaillan's tweet earlier. It was pretty hilarious. However, Nic got miffed and complained to VMWARE federal about it. I don't think they are going to do anything about it, but I just wanted to warn you, just in case">
  <!-- --><figcaption>I’m sure this is fine<!-- --></figcaption>
<!-- --></figure>
<!-- -->
<!-- --><h2>They Do Something About It<!-- --></h2>
<!-- -->
<!-- --><p>
And then after I landed, who should slide into my DMs but <!-- --><em>a VMware Vice President<!-- --></em>, my grand boss of a large number of levels, requested a quick chat with him and an HR representative. 
<!-- --></p>
<!-- --><p>
Being as I’m not an idiot, I elect to bring a witness of my own (<!-- --><a data-testid="mention" href="https://cohost.org/lizthegrey">@<!-- -->lizthegrey<!-- --></a> ). She slightly livetweeted that conversation until VP VMware tells her to stop.  The two VMwares mention the social media guidelines. I hadn’t seen them, but they contain gems like “Avoid topics involving age, sex, race, religion, ethnicity, politics or disabilities.” 
<!-- --></p>
<!-- --><p>
I’ll get right on that. 
<!-- --></p>
<!-- --><p>
On the 24th, my first normal day back at work, I got another meeting request from Vice President VMware. Having learned their lesson they tell me not to bring in external witnesses. I instead invited a colleague of mine to be my witness. 
<!-- --></p>
<!-- --><p>
We talked a little more about the social media guidelines, and I reiterated the impossibility of complying with how the guidelines were written. I mentioned I’d be willing to help improve them, and the guy seemed to be pretty happy with that. A few hours later I got an email from HR saying they didn’t need any more information from them. 
<!-- --></p>
<!-- --><p>
At this point I’m feeling pretty good! I got chastised but mostly I won an opportunity to help improve some social media guidelines! That seemed like a pretty great outcome to me.
<!-- --></p>
<!-- --><h2>A less than great outcome<!-- --></h2>
<!-- -->
<!-- --><p>
A week or so later, though, I’m pulled into another meeting with HR, and they present me with a “written warning,” and I have to sign a bunch of stuff saying I agreed to follow a bunch of documents I was already supposed to sign. 
<!-- --></p>
<!-- --><p>
I pointed out the social media guidelines were basically impossible to follow, and they agreed to strike them.
<!-- --></p>
<!-- --><p>
At this point I’d seen the writing on the wall and I’d retained a labour lawyer. He and I look over the written warning they want me to sign, and we agree I’m basically not giving anything up. So I came back and signed the document, less the provisions I didn’t think I could follow if I tried
<!-- --></p>
<!-- --><p>
Surprise, though! Two days later Vice President VMware once again DMs me (lol) to summon me for a before-working-hours meeting. In it, they inform me they will be “accepting my resignation.” 
<!-- --></p>
<!-- --><p>
The reason given for my termination in the meeting is explicitly my refusal to agree to the social media guidelines, the same ones their own VP agreed I could not follow. 
<!-- --></p>
<!-- --><p>
I say something to this effect, ask if this is really how this is going down, and when they confirm it is, I hang up. Good thing I already have a lawyer on retainer. 
<!-- --></p>
<!-- --><h2>it is time for some JURISPRUDENCE my dudes<!-- --></h2>
<!-- -->
<!-- --><p>
Thing was, I’d joined VMware via an acquisition, which meant I had a pretty generous retention package. Bunch of stock and the like. The severance agreement obviously didn’t include any of that.
<!-- --></p>
<!-- --><p>
Now, talking about political conditions of work is <!-- --><em>sometimes<!-- --></em> protected speech. So together with my lawyer and one from the NLRB, I wrote up a very detailed complaint (which has been very helpful for making this chost honestly).
<!-- --></p>
<!-- --><p>
Unfortunately we were still in the Trump administration, and even though it was the lame duck period his appointees still controlled the NLRB. We had very little leverage and not much room to negotiate. They made a big deal of not giving me a nondisclosure clause, but there was still a nondisparagement clause. Given the impossibility of telling this story in a way that makes VMware look anything but terrible, those clauses amounted to the same thing. 
<!-- --></p>
<!-- --><p>
My excellent lawyer almost doubled my cash payout but the non disparagement clause stayed. I decided being able to tell this ridiculous story wasn’t worth giving up $40k, so I took the offer and only groused about this dude in private.
<!-- --></p>
<!-- --><h2>UNTIL NOW<!-- --></h2>
<!-- -->
<!-- --><p>
Recently, there was news about an <!-- --><a href="https://www.nlrb.gov/news-outreach/news-story/board-rules-that-employers-may-not-offer-severance-agreements-requiring" target="_blank" rel="nofollow noopener noreferrer">NLRB decision<!-- --></a> that specifically impacted non disparagement clauses! And after consulting with my lawyer from this case, we agree it’s highly unlikely VMware will bring charges against me now, and even if they did it’s unlikely they’d prevail. So now I am once again free to Post. 
<!-- --></p><p><em>Your situation may be different, this is not legal advice<!-- --></em></p>
<!-- -->
<!-- --><h2>So Why’d This Happen<!-- --></h2>
<!-- -->
<!-- --><p>
My lawyer went through great pains to explain that I could in theory, still be liable for libel against Mr Air Force. So legally Speaking, I don’t know for sure that Nic Chaillan, then a US Government employee, pressured a private company to fire a single employee because she tweeted at him and hurt his feelings.
<!-- --></p>
<!-- --><p>
What I <!-- --><em>do <!-- --></em>know is that at least one firm has <!-- --><a href="https://www.oxebridge.com/emma/oxebridge-files-ethics-complaint-against-usaf-chief-software-officer/" target="_blank" rel="nofollow noopener noreferrer">filed a complaint against him<!-- --></a> alleging he did exactly that to other parties, threatening to sic an “army of lawyers” on someone who was mean to him online. Multiple reports corroborate this.
<!-- --></p>
<!-- --><p>
He is also known to be a <!-- --><a href="https://www.oxebridge.com/emma/op-ed-usafs-chaillan-knausenberger-must-resign-over-suspected-ethics-violations/" target="_blank" rel="nofollow noopener noreferrer">very bad poster<!-- --></a> (see the “Misuse of Position” section). And when he <!-- --><a href="https://www.oxebridge.com/emma/breaking-usaf-cso-nicolas-chaillan-resigns/" target="_blank" rel="nofollow noopener noreferrer">publicly resigned<!-- --></a> in 2021 he worried about how in the future “China has the drastic advantage of population over the U.S.” 
<!-- --></p>
<!-- --><p>
I invite you to draw your own conclusions about this guy.
<!-- --></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Bret Victor update (219 pts)]]></title>
            <link>http://worrydream.com/July2023/</link>
            <guid>36596095</guid>
            <pubDate>Wed, 05 Jul 2023 06:07:36 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="http://worrydream.com/July2023/">http://worrydream.com/July2023/</a>, See on <a href="https://news.ycombinator.com/item?id=36596095">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Is the aircraft in this image real? (180 pts)]]></title>
            <link>https://aviation.stackexchange.com/questions/99788/is-the-aircraft-in-this-image-real</link>
            <guid>36595711</guid>
            <pubDate>Wed, 05 Jul 2023 05:06:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://aviation.stackexchange.com/questions/99788/is-the-aircraft-in-this-image-real">https://aviation.stackexchange.com/questions/99788/is-the-aircraft-in-this-image-real</a>, See on <a href="https://news.ycombinator.com/item?id=36595711">Hacker News</a></p>
<div id="readability-page-1" class="page"><div itemprop="text">
<p>I am 100% sure this is fake.</p>
<p>I found the same picture on <a href="https://twitter.com/aeroconcepts1/status/1387227601098268672" rel="noreferrer">Twitter in a tweet from April 28,2020</a> , but in higher resolution:</p>
<p><a href="https://i.stack.imgur.com/DQdIY.jpg" rel="noreferrer"><img src="https://i.stack.imgur.com/DQdIY.jpg" alt="The same picture on Twitter, higher resolution"></a></p>
<p>You can see the registration on the aircraft clearly: D-AVXA. This registration is an Airbus Test registration, used by Airbus in Hamburg. Below the registration, you can read the Manufacturer Serial Number (MSN) 8557.</p>
<p>The <a href="https://www.airfleets.net/ficheapp/plane-a321-8557.htm" rel="noreferrer">aircraft with MSN 8557</a> is a A321 which was given Test registration D-AVX<strong>F</strong> during production and testing. It was produced for Indigo as passenger version and delivered with registration VT-IUA. The last two letters (UA) of that registration can be seen on the nose gear doors of the freighter aircraft.</p>
<p>Clearly, something does not add up here, and that is only the first indication.</p>
<p>Then, I found a very similar picture of aircraft MSN 8557 in passenger configuration on <a href="https://www.planespotters.net/photo/898071/d-avxf-indigo-airbus-a321-271nx" rel="noreferrer">planespotters.net</a>. It also has the letters UA on the nose gear doors. Note almost the same position on Hamburg Finkenwerder airport (Airbus Assembly site), including the same shades of leaves in the trees (clearly an autumn setting, which matches the date on the planespotters picuture 16 November 2018).</p>
<p>The picture with the split scimitar winglets is dated in April, which does not match the background.</p>
<p>Zooming in on the lower part of the split scimitar winglet, it looks suspicious monochrome. <a href="https://i.stack.imgur.com/zegas.png" rel="noreferrer"><img src="https://i.stack.imgur.com/zegas.png" alt="Zoomed-in part of the photo, showing winglet and registration"></a></p>
<p>Also note that the Indian registration in front of the Indian flag is part of the paint job, and during testing this is covered with a white sticker. The sticker would overlap the Indigo CarGo Truck logo, but here the logo overlaps the sticker. The outline of the original sticker is still vagely visible in the edited photo.</p>
<p>Finally: the Twitter profile of the Twitter post says in the bio:</p>
<blockquote>
<p><em><strong>Skilled to Transform Your Wild Aeronautical Imaginations Into Digital Reality</strong></em></p>
</blockquote>
<p>That really gives it away.</p>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Functions and algorithms implemented purely with TypeScript's type system (147 pts)]]></title>
            <link>https://github.com/ronami/meta-typing</link>
            <guid>36595512</guid>
            <pubDate>Wed, 05 Jul 2023 04:29:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/ronami/meta-typing">https://github.com/ronami/meta-typing</a>, See on <a href="https://news.ycombinator.com/item?id=36595512">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><h2 tabindex="-1" dir="auto"><g-emoji alias="books" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f4da.png">📚</g-emoji> Meta-Typing</h2>
<blockquote>
<p dir="auto">Functions and algorithms implemented purely with TypeScript's type system</p>
</blockquote>
<h3 tabindex="-1" dir="auto">Introduction</h3>
<p dir="auto"><a href="https://github.com/Microsoft/TypeScript">TypeScript</a>'s type system lets us catch bugs and errors in our code as we write it, instead of later on when the code runs. But... that's the obvious way to use the type system... 😜</p>
<p dir="auto">This project attempts to push TypeScript's type system to its limits by actually implementing various functions and algorithms, purely on top of the type system.</p>
<p dir="auto">Every implementation includes comments describing in detail what's going on. Some functions and algorithms use creative (and sometimes not officially supported) solutions to overcome <a href="https://github.com/microsoft/TypeScript/issues/26223#issuecomment-513187373" data-hovercard-type="issue" data-hovercard-url="/microsoft/TypeScript/issues/26223/hovercard">some limitations</a> of the type system.</p>
<p dir="auto"><em><g-emoji alias="point_up" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/261d.png">☝</g-emoji> Please note that this project is meant to be used for fun and learning purposes and not for practical use.</em></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ronami/meta-typing/blob/master/assets/showcase.gif"><img src="https://github.com/ronami/meta-typing/raw/master/assets/showcase.gif" alt="showcase" data-animated-image=""></a></p>
<h3 tabindex="-1" dir="auto">Try running the code</h3>
<p dir="auto">Start by installing dependencies:</p>

<p dir="auto">Open a file of any function or algorithm and hover over the types to see the results of "running" that function with some input (try hovering the resulting type).</p>
<p dir="auto">You can also run tests (written with <a href="https://github.com/SamVerschueren/tsd">tsd</a>) with:</p>

<h3 tabindex="-1" dir="auto">Functions and algorithms:</h3>
<ul dir="auto">
<li>
<p dir="auto"><strong>Math</strong>:</p>
<ul dir="auto">
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/utils/math.d.ts">Basic arithmetic</a> - add one and decrease by one.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/add/index.d.ts">Add</a> - adds two numbers.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/subtract/index.d.ts">Subtract</a> - subtracts two numbers.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/multiply/index.d.ts">Multiply</a> - multiplies two numbers.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/divide/index.d.ts">Divide</a> - divides two numbers.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/gte/index.d.ts">Greater than or equal</a> - checks if a value is greater than or equal to another value.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/lte/index.d.ts">Less than or equal</a> - checks if a value is less than or equal to another value.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/max/index.d.ts">Max</a> - computes the maximum value of an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/min/index.d.ts">Min</a> - computes the minimum value of an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/sum/index.d.ts">Sum</a> - computes the sum of the values in array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/remainder/index.d.ts">Remainder</a> - return the remainder (%) when one number is divided by a second number.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Lists</strong></p>
<ul dir="auto">
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/head/index.d.ts">Head</a> - gets the first element of an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/tail/index.d.ts">Tail</a> - gets all but the first element of an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/reverse/index.d.ts">Reverse</a> - Reverses an array so that the first element becomes the last, the second element becomes the second to last, and so on.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/size/index.d.ts">Size</a> - gets the size of an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/concat/index.d.ts">Concat</a> - creates a new array by concatenating two arrays together.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/drop/index.d.ts">Drop</a> - creates a slice of an array with <code>n</code> elements dropped from the beginning.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/take/index.d.ts">Take</a> - creates a slice of an array with <code>n</code> elements taken from the beginning.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/uniq/index.d.ts">Uniq</a> - creates a duplicate-free version of an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/includes/index.d.ts">Includes</a> - checks if a value is an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/indexOf/index.d.ts">IndexOf</a> - gets the index at which the first occurrence of a value is found in an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/difference/index.d.ts">Difference</a> - creates an array of values from the first array that are not included in the other given arrays.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/intersection/index.d.ts">Intersection</a> - creates an array of unique values that are included in all given arrays.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/slice/index.d.ts">Slice</a> - creates a slice of an array from start up to, but not including, end.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/flatten/index.d.ts">Flatten</a> - flattens an array a single level deep.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/pull/index.d.ts">Pull</a> - removes all given values from an array.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/chunk/index.d.ts">Chunk</a> - creates an array of elements split into groups the length of size.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/zip/index.d.ts">Zip</a> - creates an array of grouped elements, the first of which contains the first elements of the given arrays, the second of which contains the second elements of the given arrays, and so on.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/range/index.d.ts">Range</a> - creates an array of numbers progressing from start up to, but not including, end.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Sorting</strong></p>
<ul dir="auto">
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/quickSort/index.d.ts">Quick-sort</a> - an efficient sorting algorithm.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/mergeSort/index.d.ts">Merge-sort</a> - another efficient sorting algorithm.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/insertionSort/index.d.ts">Insertion-sort</a> - a simple sorting algorithm that builds the final sorted array (or list) one item at a time.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Utility</strong></p>
<ul dir="auto">
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/isEqual/index.d.ts">IsEqual</a> - compares between two values to determine if they are equivalent.</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Puzzles</strong></p>
<ul dir="auto">
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/nQueens/index.d.ts">N-Queens</a> - the problem of placing N chess queens on an N×N chessboard so that no two queens threaten each other.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/maze/index.d.ts">Maze-solving</a> - find the shortest path to solve a maze with obstacles.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/binaryTrees/index.d.ts">Binary trees</a> - a tree data structure in which each node has at most two children.</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/rotateMatrix/index.d.ts">Square Matrix Rotation</a> - you are given an N×N 2D matrix (representing an image). Rotate the matrix by 90 degrees (clockwise and counter-clockwise).</li>
<li><a href="https://github.com/ronami/meta-typing/blob/master/src/hanoi/index.d.ts">Towers of Hanoi</a> - a mathematical game or puzzle that consists of three rods and a number of disks of different sizes.</li>
</ul>
</li>
</ul>
<h3 tabindex="-1" dir="auto">Additional links</h3>
<ul dir="auto">
<li><a href="https://www.typescriptlang.org/docs/handbook/utility-types.html" rel="nofollow">Utility TypeScript types</a></li>
<li><a href="https://www.typescriptlang.org/docs/handbook/advanced-types.html" rel="nofollow">Advanced TypeScript types</a></li>
<li><a href="https://gal.hagever.com/posts/typing-the-technical-interview-in-typescript/" rel="nofollow">Typing the Technical Interview in TypeScript</a></li>
<li><a href="https://github.com/microsoft/TypeScript/issues/14833" data-hovercard-type="issue" data-hovercard-url="/microsoft/TypeScript/issues/14833/hovercard">TypeScripts Type System is Turing Complete</a></li>
<li><a href="https://gist.github.com/acutmore/9d2ce837f019608f26ff54e0b1c23d6e">Emulating a 4-Bit Virtual Machine in TypeScript's type system</a></li>
<li><a href="https://github.com/trekhleb/javascript-algorithms">Algorithms and data structures implemented in JavaScript</a></li>
<li><a href="https://github.com/pirix-gh/medium/blob/master/types-curry-ramda/src/index.ts">How to master advanced TypeScript patterns</a></li>
</ul>
</article>
          </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Simple Unix Chat (306 pts)]]></title>
            <link>https://the-dam.org/docs/explanations/suc.html</link>
            <guid>36594916</guid>
            <pubDate>Wed, 05 Jul 2023 02:34:16 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://the-dam.org/docs/explanations/suc.html">https://the-dam.org/docs/explanations/suc.html</a>, See on <a href="https://news.ycombinator.com/item?id=36594916">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content">

<p>
The title oversells the content a bit:
</p>
<ul>
<li>first, Slack (or Mattermost, or even the Internet Relay Chat (IRC)) offer
slightly more features than the <i>Simple Unix Chat</i> system (<code>suc</code>), the topic
of this piece;</li>
<li>then, <code>suc</code>’s actual line count exceeds five.</li>
</ul>

<p>
Nevertheless, <code>suc</code>’s core indeed consists of five lines of bash;
and <code>suc</code> provides Slack, Mattermost, <i>etc.</i>’s core features:
</p>
<ul>
<li>Real-time, rich-text chat,</li>
<li>File sharing,</li>
<li>Fine-grained access control,</li>
<li>Straightforward automation and integration with other tools,</li>
<li>Data encryption in transit</li>
<li>and optionally at rest,</li>
<li>state-of-the-art user authentication.</li>
</ul>


<p>
This paper shows how <code>suc</code> implements those features.
<code>suc</code> stays small by leveraging the consistent and composable primitives offered by modern UNIX implementations
<sup><a id="fnr.1" href="#fn.1" role="doc-backlink">1</a></sup>.
</p>

<div id="outline-container-orgefe782e">
<h2 id="orgefe782e">Line count matters</h2>
<div id="text-orgefe782e">
<blockquote>
<p>
One of my most productive days was throwing away 1000 lines of code.
– Ken Thompson, <a href="https://skeptics.stackexchange.com/questions/43800/did-the-creator-of-unix-say-one-of-my-most-productive-days-was-throwing-away-10">apparently</a>
</p>
</blockquote>
<blockquote>
<p>
Measuring programming progress by lines of code is like measuring aircraft
building progress by weight.
– Bill Gates, (probably apocryphal)
</p>
</blockquote>
<blockquote>
<p>
Some of the managers decided that it would be a good idea to track the progress
of each individual engineer in terms of the amount of code that they wrote from
week to week.
[…]
When he got to the lines of code part, [Bill Atkinson] […] wrote in the number: -2000.
– <a href="https://www.folklore.org/StoryView.py?story=Negative_2000_Lines_Of_Code.txt">https://www.folklore.org/StoryView.py?story=Negative_2000_Lines_Of_Code.txt</a>
</p>
</blockquote>
<blockquote>
<p>
Their fundamental design flaws are completely hidden by their superficial design
flaws.
– Douglas Adams
</p>
</blockquote>
<blockquote>
<p>
There are two ways of constructing a software design: One way is to make it so
simple that there are obviously no deficiencies, and the other way is to make it
so complicated that there are no obvious deficiencies.
– Tony Hoare
</p>
</blockquote>
<p>
Despite the wide consensus among competent programmers that <a href="https://wiki.c2.com/?SoftwareAsLiability">code is a liability</a>,
almost every widely-distributed piece of software is a complexity behemoth.
</p>

<p>
Case in point, let’s examine Mattermost’s line count:
</p>
<div>
<pre><span>cd</span> /tmp
<span>git</span> clone --depth=<span>1</span> https://github.com/mattermost/mattermost-server
<span>cd</span> mattermost-server
guix shell cloc -- cloc --quiet --timeout <span>0</span> .
</pre>
</div>

<pre id="org6c7ec21">github.com/AlDanial/cloc v 1.96  T=14.34 s (606.7 files/s, 139790.0 lines/s)
-------------------------------------------------------------------------------
Language                     files          blank        comment           code
-------------------------------------------------------------------------------
Go                            1805          96705          26782         501249
JSON                           177              5              0         492604
TypeScript                    4125          74236          24557         480491
JavaScript                     811          21494          20745          68653
SCSS                           557           9164            359          51464
HTML                            54           6108           1167          37814
JSX                             92           3473           1054          29707
SQL                            807           3553           2253          18266
Text                            11           3824              0          10638
YAML                            45            126             96           7972
SVG                             68              6             12           2586
Markdown                        73            906             88           2168
make                             8            234             68            974
GraphQL                          4             65              2            596
XML                             29             10              1            572
Bourne Shell                    18            128             17            492
CSS                              5             70              0            385
Dockerfile                       4             14              8             46
CSV                              2              0              0             25
diff                             2              1             13              9
INI                              1              2              0              7
-------------------------------------------------------------------------------
SUM:                          8698         220124          77222        1706718
-------------------------------------------------------------------------------
</pre>

<p>
<b><b>Half a million lines</b></b> of Go, and again <b><b>half a million</b></b> lines of
TypeScript. Just for the server !
</p>

<p>
Let’s compare with <code>suc</code>:
</p>
<div>
<pre><span>cd</span> /tmp
<span>git</span> clone --depth=<span>1</span>  https://gitlab.com/edouardklein/suc
<span>cd</span> suc
guix shell cloc -- cloc --quiet --timeout <span>0</span> .
</pre>
</div>

<pre id="orga4ac3ca">github.com/AlDanial/cloc v 1.96  T=0.01 s (475.8 files/s, 8207.6 lines/s)
--------------------------------------------------------------------------------
Language                      files          blank        comment           code
--------------------------------------------------------------------------------
Bourne Again Shell                1              2              2             19
C                                 1              3              3             17
make                              1              3              0             14
Bourne Shell                      1              0              1              5
--------------------------------------------------------------------------------
SUM:                              4              8              6             55
--------------------------------------------------------------------------------
</pre>
<p>
<code>suc</code> can implement Mattermost’s core features <b><b>with 0.005% of the code</b></b>. This is madness !
</p>
</div>
</div>
<div id="outline-container-orga8279f6">
<h2 id="orga8279f6"><code>suc</code>’s core loop</h2>
<div id="text-orga8279f6">
<p>
Behold the five lines of bash that do as much as half a million lines of Go:
</p>
<div>
<pre><span>while</span> /usr/bin/true
<span>do</span>
    <span>read</span> -r line || <span>exit</span> <span>0</span>  <span># </span><span>EOF</span>
    /usr/bin/echo <span>"</span><span>$(/usr/bin/date --iso-8601=seconds)</span><span>"</span><span>\</span>
        <span>"</span><span>$(printf "%-9s" "$(/usr/bin/id --user --name --real)</span><span>")"</span> <span>\</span>
        <span>"</span><span>$</span><span>line</span><span>"</span> &gt;&gt; /var/lib/suc/<span>"</span><span>$</span><span>1</span><span>"</span>
<span>done</span>
</pre>
</div>
<p>
This infinite loop:
</p>
<ul>
<li>reads a line from standard input,</li>
<li>prefixes it with:
<ul>
<li>the date,</li>
<li>the real user name,</li>
</ul></li>
<li>and appends it to a file in <code>/var/lib/suc/</code></li>
</ul>


<p>
Surely, you think, this cannot do. What about authentication, access control, encryption, rich text, <i>etc.</i> ?
</p>

<p>
<code>suc</code> does all that by leveraging SSH, UNIX’s access control API, and UNIX’s text-based modularity.
</p>
</div>
</div>
<div id="outline-container-org14b6181">
<h2 id="org14b6181">Authentication</h2>
<div id="text-org14b6181">
<p>
The <code>suc</code> process can only be launched by an authenticated user
<sup><a id="fnr.2" href="#fn.2" role="doc-backlink">2</a></sup>.
Therefore, <code>suc</code> contains no authentication code at all.
All the authentication stuff happens before <code>suc</code> even starts.
</p>

<p>
As with almost all UNIX servers nowadays,
remote authentication is handled by <code>ssh</code>.
Before granting them the ability to start <code>suc</code>, <code>ssh</code> requires users to prove their identity.
</p>

<p>
This proof can take the form
</p>
<ul>
<li>of a shared secret (<i>i.e.</i> a password),</li>
<li>of a cryptographic challenge (as is the case on <a href="https://the-dam.org/">the dam</a>),</li>
<li>of the use of a One-Time-Passord (OTP) generating device,</li>
<li>or of any combination of the above (also known as Multi-Factor Authentication, MFA).</li>
</ul>


<p>
<code>ssh</code> also authenticates the server to the client,
thus preventing <i>Man-in-the-Middle</i> (MitM) attacks.
</p>

<p>
Last but not least, <code>ssh</code> encrypts all data between the clients and the server.
</p>

<p>
A successful installation of <code>suc</code> therefore depends on a correct configuration
of the UNIX host and its <code>ssh</code> server.
To use <code>suc</code>, a user needs to exist on the system;
and the <code>ssh</code> server needs to be configured to let her remotely log in.
</p>

<p>
Most UNIX distribution provide the <code>useradd</code>, <code>passwd</code>, <i>etc.</i> commands for user management
(creation, deletion, assignation to one or more groups, <i>etc.</i>).
The <code>ssh</code> server reads its configuration from a text file in <code>/etc/</code>
(typically <code>/etc/ssh/sshd_config</code>), and from public key files
(typically in <code>/home/&lt;user&gt;/.ssh/authorized_keys</code>).
</p>

<p>
<a href="https://the-dam.org/">The dam</a> server uses GNU Guix.
GNU Guix differs from almost all other UNIX distributions,
because it uses declarative configuration.
This means that <code>root</code> just has to say what she wishes the configuration to be.
The system then complies and reconfigures itself to match <code>root</code>’s declaration.
</p>

<p>
For example, granting <code>ssh</code> access to <code>alice</code> on a GNU Guix system
<sup><a id="fnr.3" href="#fn.3" role="doc-backlink">3</a></sup>
requires only the following line in the system’s configuration file:
</p>
<div>
<pre> (ssh-user <span>"alice"</span> <span>#:groups</span> '(<span>"c3n"</span> <span>"frenchies"</span>)
                   <span>#:keys</span> '((plain-file <span>"alice.pub"</span> <span>"SOMESSHKEY"</span>)))
</pre>
</div>
<p>
User <code>alice</code> exists on the system only as long as the line exists in the configuration file.
When the line disappears, the reconfiguration process removes user <code>alice</code>, and she can no longer log in.
</p>

<p>
Some big advantages of declarative configuration systems include:
</p>
<ul>
<li>removing the need for clean up actions when removing functionality:
once it is no longer part of the declaration,
it will be removed from the system automatically.</li>
<li>the ability to clone a specific configuration
by just replicating the declaration;
useful for back-ups, failovers, <i>etc.</i>.</li>
</ul>


<p>
Among the disadvantages,
one counts an increased difficulty for quick and dirty setups
(usually for a quick test to try out a piece of software).
New tools (such as e.g. <code>guix shell</code>) allows one to sidestep this difficulty.
</p>

<p>
In such a declarative system,
<code>suc</code>’s overhead per user is limited to a single line in the global configuration file.
One cannot need less,
and current chat systems need more.
</p>
</div>
</div>
<div id="outline-container-orgc7dc063">
<h2 id="orgc7dc063">Access control</h2>
<div id="text-orgc7dc063">
<p>
As with authentication, <code>suc</code> contains no access control code whatsoever.
This combination of caring about neither authentication nor access control is called <i>security agnosticism</i>.
<i>Security anosticism</i> allows <code>suc</code> to be lean,
and therefore more probably correct (and so, paradoxically, more secure) than its heavier counterparts.
</p>

<p>
On UNIX, software can afford to be <i>security agnostic</i>
because the system provides a clean and powerful API for access control:
the kernel knows about
</p>
<ul>
<li>users and groups,</li>
<li>processes and files.</li>
</ul>


<p>
Let’s dive in.
</p>

<p>
UNIX veterans will have noticed that <code>suc</code> prefixes the user’s messages with her <i>real</i> name.
Indeed, files have an owner (a user),
whereas processes have two owners (two users). The <i>real</i> one and the <i>effective</i> one.
</p>

<p>
Most of the time, <i>real</i> and <i>effective</i> owners are the same.
<code>suc</code>’s ownership differs:  it <i>effectively</i> belongs to a special user also named <code>suc</code>;
it <i>really</i> belongs to whoever (<i>e.g.</i> user <code>alice</code>) launched the <code>suc</code> command
<sup><a id="fnr.4" href="#fn.4" role="doc-backlink">4</a></sup>.
</p>

<p>
The kernel examines the <i>effective</i> ownership of a process
to determine said process’ ability to read or write to files.
</p>

<p>
With that in mind, let’s examine the content of <code>/var/lib/suc</code> on <a href="https://the-dam.org/">the dam</a>:
</p>
<div>
<pre>ssh -i ~/.ssh/id_rsa edk@the-dam.org <span>ls</span> -l /var/lib/suc
</pre>
</div>

<pre>total 92
-rw-r----- 1 suc c3n            44368 Apr 13 19:18 banane
-rw-r----- 1 suc forbiddenlands  6234 Apr 13 21:04 forbiddenlands
-rw-r----- 1 suc frenchies         62 Apr 21 22:23 frenchies
-rw-r----- 1 suc guixdevs           0 Apr 22 15:39 guix
-rw-r----- 1 suc iwp9            4181 Apr 21 21:46 iwp9
-rw-r----- 1 suc users          18241 Jun 30 07:14 the-dam
-rw-r----- 1 suc wb3c             188 May 10 11:56 wb3c
</pre>


<p>
The files in <code>/var/lib/suc</code> belong to <code>suc</code>;
only <code>suc</code> can read and write those files
<sup><a id="fnr.5" href="#fn.5" role="doc-backlink">5</a></sup>.
</p>

<p>
Any other user, such as <code>alice</code>, may read some of the files (e.g. <code>banane</code>),
provided she belongs to the appropriate <i>group</i> (e.g. <code>c3n</code>).
</p>

<p>
With this configuration,
<code>suc</code> does not need to care about access control at all.
For example <code>suc</code> need not match a user against the list of authorized readers or writers of a <i>channel</i>.
</p>

<p>
Instead, <code>usuc</code><sup><a id="fnr.6" href="#fn.6" role="doc-backlink">6</a></sup>
will just happily always <i>try</i> to read or write the file.
The kernel will do the matching and prevent any unauthorized access.
</p>

<p>
On <a href="https://the-dam.org/">the dam</a>, everyone can start <code>suc</code>, whose <i>effective</i> owner will be the user
<code>suc</code>, who has the right to write into any channel. By design, any user on <a href="https://the-dam.org/">the dam</a>
can request membership into a group by blindly writing a request to the
group’s channel.
</p>

<p>
Less loosely-managed communities may wish to restrict channel write access to members only.
<code>root</code> achieves this by maintaining multiple copies of the <code>suc</code> binary.
</p>

<p>
Let’s assume that
</p>
<ul>
<li><code>alice</code> and <code>bob</code> belong to the <code>blue</code> group,</li>
<li>while <code>eve</code> and <code>mallory</code> belong to the <code>red</code> group.</li>
</ul>


<p>
<code>root</code> creates <code>nobody</code>-like<sup><a id="fnr.7" href="#fn.7" role="doc-backlink">7</a></sup> users <code>red</code> and <code>blue</code>. She then creates two copies of <code>suc</code>, one for
each group:
</p>
<div>
<pre><span>ls</span> -l /usr/bin/suc*
total <span>32</span>
-rwsr-xr-- <span>1</span> red     red      <span>15624</span> Jun  <span>4</span> 10:51 suc_red
-rwsr-xr-- <span>1</span> blue    blue     <span>15624</span> Jun  <span>4</span> 10:56 suc_blue
</pre>
</div>
<p>
And she also creates one channel for each team:
</p>
<div>
<pre><span>ls</span> -l /var/lib/suc/
total <span>16</span>
-rw-r----- <span>1</span> blue     blue     <span>11027</span> Jun  <span>4</span> 11:30 blue
-rw-r----- <span>1</span> red      red      <span>17</span>    Jun  <span>4</span> 10:53 red
</pre>
</div>
<p>
One can see that:
</p>
<ul>
<li><code>alice</code> and <code>bob</code> belong to group <code>blue</code>.
<ul>
<li>They can read the <code>blue</code> channel. Indeed the file <code>/var/lib/suc/blue</code>
belongs to group <code>blue</code> and has mode <code>-rw-r-----</code> : the second <code>r</code> means
that members of the owning group (here, <code>blue</code>), can read the file (but not
write to it).</li>
<li>They cannot directly write to the file.
Only user <code>blue</code> can.</li>
<li>They can however launch the <code>/usr/bin/suc_blue</code> program,
because group <code>blue</code> owns it,
and it has mode <code>-rwsr-xr--</code> .
The <code>x</code> means that members of the owning group (here, <code>blue</code>) can start the program.</li>
<li>This program will run with user <code>blue</code> as the <i>effective</i> owner:
User <code>blue</code> owns the file
and <code>root</code> has set its setuid bit
(the <code>s</code> in the mode line says so).</li>
<li>Therefore, <code>alice</code> and <code>bob</code>, being members of the <code>blue</code> group, can launch the <code>/usr/bin/suc_blue</code> program,
which being <i>effectively</i> owned by user <code>blue</code>
(despite being launched by <code>alice</code> or <code>bob</code> who will be the <i>real</i>, but not <i>effective</i> owner)
can write to the <code>/var/lib/suc/blue</code> file.</li>
</ul></li>
<li><code>eve</code> and <code>mallory</code> belong to group <code>red</code> (but not group <code>blue</code>).
<ul>
<li>They cannot read the <code>blue</code> channel.
Indeed, people other than user <code>blue</code> or members of group <code>blue</code> have no rights on the <code>/var/lib/suc/blue</code> file
(the end of its mode line is <code>---</code>).</li>
<li>They cannot write to the <code>blue</code> channel directly,
only user <code>blue</code> can.</li>
<li>They cannot start the <code>/usr/bin/suc_blue</code> program,
because they do not belong to group <code>blue</code>.
The only thing they can do to this file is read it (its mode line ends in <code>r--</code>).</li>
<li>Therefore they can neither read nor write the <code>blue</code> channel.</li>
</ul></li>
</ul>


<p>
To relieve <code>root</code> from the cumbersome and error-prone process of setting this all up,
<code>suc</code> provides an 80-something-lines long helper script called <a href="https://gitlab.com/edouardklein/suc/-/blob/master/suc_channel.sh"><code>suc_channel.sh</code></a>.
</p>

<p>
GNU Guix users can create a <code>suc</code> channel by
adding a single line to the system’s configuration file:
</p>
<pre>(suc-private-channel "red" "red")
</pre>

<p>
This line takes care of creating the necessary
</p>
<ul>
<li><code>suc_red</code> setuid binary,</li>
<li><code>red</code> user</li>
<li><code>red</code> group</li>
<li><code>red</code> channel file.</li>
</ul>


<p>
Here, GNU Guix’s declarative configuration paradigm shines again. The
<code>suc_channel.sh</code> script may fail halfway, leaving the system in an undetermined
state, whereas GNU Guix provides <i>transactional</i> updates: either the transition
happens fully or it does not at all. The system always stays in a known clean
state. One can even roll-back to a previous working state (see <a href="https://guix.gnu.org/en/blog/2018/multi-dimensional-transactions-and-rollbacks-oh-my/">Multi-dimensional
transactions and rollbacks, oh my!</a>).
</p>

<p>
GNU Guix also automatically computes which groups, users, and setuid binaries
should exist on the system. When <code>root</code> removes a private channel (e.g. <code>red</code>),
she must assess whether the associated group (also named <code>red</code>), user (also
<code>red</code>), and setuid binary (<code>suc_red</code>) should stay or go. That entails looking at
the other channels to see if any of them is still owned by user <code>red</code> or group
<code>red</code>. Again, a cumbersome and error prone task whereas on GNU Guix, <code>root</code> just
removes the channel’s line from the system declaration. The <code>red</code> group, <code>red</code>
user, and <code>suc_red</code> binary will stay if and only if another part of the system
needs them.
</p>

<p>
As an illustration, here is a full system declaration for the above example. One
can hardly be simpler than that.
</p>
<div>
<pre>(<span>begin</span> (use-modules
        (gnu packages base)
        (guix gexp)
        (beaver system)
        (beaver packages plan9)
        (beaver functional-services))
       (-&gt; (minimal-ovh)
           (ssh-user <span>"alice"</span>   <span>#:groups</span> '(<span>"suc"</span> <span>"blue"</span>) <span>#:keys</span> '())
           (ssh-user <span>"bob"</span>     <span>#:groups</span> '(<span>"suc"</span> <span>"blue"</span>) <span>#:keys</span> '())
           (ssh-user <span>"eve"</span>     <span>#:groups</span> '(<span>"suc"</span> <span>"red"</span>)  <span>#:keys</span> '())
           (ssh-user <span>"mallory"</span> <span>#:groups</span> '(<span>"suc"</span> <span>"red"</span>)  <span>#:keys</span> '())
           (suc-private-channel <span>"red"</span> <span>"red"</span>)
           (suc-private-channel <span>"blue"</span> <span>"blue"</span>)
           (suc-public-channel <span>"purple"</span>)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org76ce31c">
<h2 id="org76ce31c">Fancy text</h2>
<div id="text-org76ce31c">
<p>
We have seen how <code>suc</code> is <i>security-agnostic</i>, relying on:
</p>
<ul>
<li><code>ssh</code> for authentication,</li>
<li>UNIX’s file and process ownership and permission model for access control.</li>
</ul>


<p>
Let’s now dive into the featureful side of things by first looking at some bells
and whistles: rich text.
</p>

<p>
Most chat applications nowadays piggyback on an HTML engine to render the chat’s
text. For example <a href="https://github.com/mattermost/desktop">mattermost’s client</a> uses <a href="https://www.electronjs.org/">Electron</a>. There go another few tens of
thousand of lines of code.
</p>

<p>
On the one hand, this adds tremendous complexity and increases the attack
surface of the application. On the other hand it lets the chat display elements
in a complex layout, or embed interactive widgets within the messages (such as
emoji reactions), etc.
</p>

<p>
<code>suc</code> uses one file per channel. This text file is meant to be displayed to the
user with a command-line tool such as <code>tail</code> or <code>cat</code>.
</p>

<p>
Before everything got shoehorned into an HTML rendering engine, people managed
to display rich text, boxes, and even primitive graphics on their terminals.
These capabilities more-or-less coalesced into something called ANSI escape
codes<sup><a id="fnr.8" href="#fn.8" role="doc-backlink">8</a></sup>. Almost all terminal emulators support
those. Together with proper UTF-8 support, they allow for the colorful,
emoji-filled experience of your average corporate slack channel, with ~5% of the
memory footprint.
</p>

<p>
If you paid attention to the 5 lines of bash that <code>suc</code> consists of, you have
noticed that while <code>suc</code> writes into the channel file, it does not read from it.
</p>

<p>
This job befalls to <code>usuc</code>. Why two separate binaries ? Because <code>suc</code> is a
privileged binary, which runs under the powerful effective ownership of whoever
can write to a channel. One must be careful to keep the logic and external
dependencies of <code>suc</code> to a bare minimum to minimize the attack surface, and
avoid any complex logic where bugs like to hide.
</p>

<p>
<code>usuc</code>, conversely, runs with both effective and real owners set to the
calling user. It can go crazy with the features, as whatever happens can not
impact the channel file, except through <code>suc</code>, whose logic is so simple
there should not be any bugs in it.
</p>

<p>
Here is as of <span><span>&lt;2023-06-29 Thu&gt; </span></span> the code for usuc:
</p>
<div>
<pre><span>#</span><span>!/usr/bin/</span><span>bash</span>
<span>set</span> -euo pipefail

<span># </span><span>Autowrap self in rlwrap</span>
<span>if</span> [ -z <span>"</span><span>$</span><span>{RLWRAP:-}</span><span>"</span> ]
<span>then</span>
    <span>RLWRAP</span>=<span>1</span> rlwrap <span>"</span><span>$</span><span>0</span><span>"</span> <span>"</span><span>$</span><span>@</span><span>"</span>
    <span>exit</span> <span>0</span>
<span>fi</span>

<span>chan_owner</span>=$(<span>ls</span> -l /var/lib/suc/<span>"</span><span>$</span><span>1</span><span>"</span> | cut -d<span>' '</span> -f <span>3</span>)
<span>if</span> [ <span>"</span><span>$</span><span>chan_owner</span><span>"</span> != suc ]
<span>then</span>
    <span>SUC</span>=suc_<span>"</span><span>$</span><span>chan_owner</span><span>"</span>
<span>else</span>
    <span>SUC</span>=suc
<span>fi</span>
<span># </span><span>Tail the channel</span>
tail -f -n <span>20</span> /var/lib/suc/<span>"</span><span>$</span><span>1</span><span>"</span>&amp;
<span>while</span> true
<span>do</span>
    <span>read</span> -r line || <span>exit</span> <span>0</span>
    <span>if</span> [ <span>"</span><span>$</span><span>{line::1}</span><span>"</span> == <span>":"</span> ]
    <span>then</span>
        <span>echo</span> <span>'*runs* `'</span> <span>"</span><span>$</span><span>{line:1}</span><span>"</span> <span>'`'</span> | pygmentize -l md -f <span>256</span> | <span>"</span><span>$</span><span>SUC</span><span>"</span> <span>"</span><span>$</span><span>1</span><span>"</span>
        bash -c <span>"</span><span>$</span><span>{line:1}</span><span>"</span> | <span>"</span><span>$</span><span>SUC</span><span>"</span> <span>"</span><span>$</span><span>1</span><span>"</span>
    <span>else</span>
        <span>echo</span> <span>"</span><span>$</span><span>line</span><span>"</span> | pygmentize -l md -f <span>256</span> | <span>"</span><span>$</span><span>SUC</span><span>"</span> <span>"</span><span>$</span><span>1</span><span>"</span>
    <span>fi</span>
<span>done</span>
</pre>
</div>
<p>
<code>usuc</code>:
</p>
<ul>
<li>makes sure to prefix its own call with <code>rlwrap</code>, which provides history and line
editing capabilities,</li>
<li>selects the correct setuid <code>suc</code> binary to run depending on who owns the channel file,</li>
<li>calls <code>tail -f</code>, displaying the last 20 lines of the channel and then
anything that get subsequently written to it,</li>
<li>check whether the line typed by the user starts with “:” (see the next section),</li>
<li>pipe anything the user typed through <code>pygmentize</code>.</li>
</ul>


<p>
Pygmentize is a nifty Python module for syntax coloring. Here it runs expecting
markdown on its standard input, and outputting ANSI color coded text on its
standard output. That way, a user can use markup syntax like <code>**bold**</code>, and get
<b>bold</b> output. <code>suc</code> gets markdown support in a single line of code.
</p>
</div>
</div>
<div id="outline-container-orgabf779c">
<h2 id="orgabf779c">Chat commands</h2>
<div id="text-orgabf779c">
<p>
Other tools can, like <code>pygmentize</code>, output ANSI-styled text. One of those is e.g.
<a href="https://github.com/charmbracelet/gum"><code>gum</code></a>.
</p>

<p>
To invoke <code>gum</code> directly from the chat interface, one just has to start a
message with <code>:</code>. <code>usuc</code> will catch that and will not pipe the text to <code>suc</code>
like it would for a normal message. It will instead run the command, and pipe
its <i>output</i> to <code>suc</code>.
</p>

<p>
One can therefore type:
</p>
<pre>: gum style --border=rounded --bold --foreground=#F00 "Hello World !"
</pre>

<p>
as a <code>suc</code> message and see something that looks like the following appear in the channel:
</p>
<pre>╭─────────────╮
│<span>Hello World !</span>│
╰─────────────╯
</pre>

<p>
Any command that exists in the namespace of the user who called <code>usuc</code> can run
that way. Its output will appear in the chat.
</p>

<p>
We use that on <a href="https://the-dam.org/">the dam</a> to roll dice when we play table-top role playing games:
</p>
<pre>: roll 2d6
2023-04-13T21:04:57+00:00 gm        *runs* ` roll 2d6 `
2023-04-13T21:04:58+00:00 gm        [6, 2]
</pre>


<p>
Again, it all happens in the namespace of the user. Any user can customize
her environment to keep useful chat macros on hand, without any impact on the
other users.
</p>
</div>
</div>
<div id="outline-container-orgd2b464b">
<h2 id="orgd2b464b">Piping text to <code>suc</code></h2>
<div id="text-orgd2b464b">
<p>
Instead of using <code>usuc</code>’s command-calling facility, one can pipe right into
<code>suc</code> the output of any command, from one’s shell.
</p>

<p>
For example if you want to pretty-print a piece of source code to a relevant
channel, you can invoke <a href="https://github.com/sharkdp/bat"><code>bat</code></a>:
</p>
<pre>bat --force-colorization --paging=never --style=full toto.c | suc greybeards
</pre>

<p>
and you will get a syntactically-colored listing of your code in the channel.
</p>

<p>
Complex chat system like Mattermost, Slack, etc. offer many
<a href="https://mattermost.com/integrations-overview/">integrations</a>, that is, ways to interact with other software.
</p>

<p>
<code>suc</code> is text-based ; integrating it with other tools feels natural in a UNIX
environment. For example consider the following bash one-liner:
</p>
<div>
<pre><span>make</span> test &gt; testlog || (suc devops &lt; testlog ; <span>exit</span> <span>1</span>)
</pre>
</div>
<p>
This code will run the tests of a software project, and send the logs to the
<code>devops</code> channel on failure.
</p>

<p>
With the necessary boilerplate, this oneliner fits into the <a href="https://www.atlassian.com/git/tutorials/git-hooks">git hook</a> <code>update</code> of
a git repo:
</p>
<div>
<pre><span>#</span><span>!/usr/bin/</span><span>bash</span>
<span>set</span> -euxo pipefail
<span>newrev</span>=<span>"</span><span>$</span><span>3</span><span>"</span>

<span>GIT_DIR</span>=$(realpath <span>"</span><span>$</span><span>GIT_DIR</span><span>"</span>)
<span>cd</span> <span>"</span><span>$(mktemp -d)</span><span>"</span>
<span>git</span> clone <span>"</span><span>$</span><span>GIT_DIR</span><span>"</span> .
<span>git</span> checkout <span>"</span><span>$</span><span>newrev</span><span>"</span>

<span>make</span> test &gt; test_log || (suc devops &lt; test_log ;  <span>exit</span> <span>1</span>)
<span>exit</span> <span>0</span>
</pre>
</div>
<p>
And voilà ! You get a <code>git/suc</code> integration in 11 lines of bash. Any push to
the repo will trigger the test, reject the update on failure, and ring the
DevOps team so they can solve the problem.
</p>
</div>
</div>
<div id="outline-container-org26050c9">
<h2 id="org26050c9">Reading from a <code>suc</code> channel</h2>
<div id="text-org26050c9">
<p>
<code>suc</code> users continually update a text file (the channel). By calling <code>tail -f</code>
on that text file, you can process the new lines as they arrive.
</p>

<p>
For example, to get notified when a new message gets posted in a channel, just run:
</p>
<div>
<pre>tail -n0 -f /var/lib/suc/some-chan | (<span>while</span> true;
                                      <span>do </span><span>read</span> -r line;
                                         notify-send <span>"</span><span>$</span><span>line</span><span>"</span>;
                                      <span>done</span>)
</pre>
</div>

<p>
Too many notifications ? Reduce the noise by grepping for keywords:
</p>
<div>
<pre>tail -n0 -f /var/lib/suc/some-chan | <span>\</span>
    stdbuf -i0 -o0 <span>grep</span> -E <span>"(myname|build failure|fire)"</span> | <span>\</span>
    (<span>while</span> true; <span>do </span><span>read</span> -r line; notify-send <span>"</span><span>$</span><span>line</span><span>"</span>; <span>done</span>)
</pre>
</div>

<p>
Don’t want to open as many windows as channels you follow ? Coalesce them all in
a single feed:
</p>
<pre>tail -f /var/lib/suc/*
</pre>

<p>
Or use the more powerful <a href="https://lnav.org/">lnav</a> (a log file viewer), which will
</p>
<ul>
<li>remember where you left off,</li>
<li>set bookmarks,</li>
<li>assign a color to each channel,</li>
<li>parse the date, username, or any custom field that may appear in the text,</li>
<li>let you filter the messages,</li>
<li>run SQL queries on the messages.</li>
</ul>


<p>
Try to do that with Slack…
</p>
</div>
</div>
<div id="outline-container-orgfc27392">
<h2 id="orgfc27392">Bots</h2>
<div id="text-orgfc27392">
<p>
If you can write and read to a <code>suc</code> channel, you can do both at once. Chat
systems often host bots and semi-automated “assistants”. These provide a text-based
interface to e.g. tickets, continuous integration, corporate directory, server
logs, etc. Have a look below at the code of a bot that convert into meters any
length given in feet:
</p>
<div>
<pre><span>#</span><span>!/usr/bin/</span><span>bash</span>
<span>feet_to_meters</span> (){
    <span>feetexpr</span>=<span>"</span><span>$</span><span>1</span><span>"</span>
    <span>echo</span> -e <span>"</span><span>$</span><span>feetexpr</span><span> \n m"</span> | units | <span>grep</span> -Eo <span>"\* [0-9.]*"</span> | tr -d <span>'*'</span>
}

tail -n0 -f /var/lib/suc/<span>"</span><span>$</span><span>1</span><span>"</span> | <span>\</span>
    stdbuf -i0 -o0 <span>grep</span> -v <span>"metric_bot"</span>  | <span>\</span>
    stdbuf -i0 -o0 <span>grep</span> -Eo <span>"[0-9]+[[:blank:]]*(feet|ft)"</span> | <span>\</span>
    (<span>while</span> true;
     <span>do </span><span>read</span> -r line;
        <span>echo</span> <span>"[metric_bot] </span><span>$</span><span>line</span><span> is </span><span>$(feet_to_meters "</span><span>$</span><span>line</span><span>")</span><span> meters."</span> | suc <span>"</span><span>$</span><span>1</span><span>"</span>
     <span>done</span>)
</pre>
</div>
<pre id="org5024b6d">2023-06-30T11:20:47+02:00 edouard   The plane flew at 33000 ft.
2023-06-30T11:20:47+02:00 bots      [metric_bot] 33000 ft is  10058.4 meters.
</pre>
</div>
</div>
<div id="outline-container-org2edb71a">
<h2 id="org2edb71a">Conclusion</h2>
<div id="text-org2edb71a">
<p>
<code>suc</code> piggybacks on SSH for authentication and on UNIX for access control and
composability. It provides almost all the features offered by Mattermost,
Slack, <i>etc.</i> with such a ridiculously small fraction of the code that one
wonders why such complex systems even exist.
</p>

<p>
Using text files as the base for <code>suc</code> channels lets user leverage UNIX tools
for reading (<code>tail</code>, <code>bat</code>, <code>lnav</code>, <code>less</code>, <code>grep</code>, etc.), writing (<code>gum</code>,
<code>bat</code>, <code>pygmentize</code>, etc.), or semi-automated extension with bots, hooks, and
scripts.
</p>

<p>
Tools can be written in any language, as long as they read and write text.
</p>
</div>
</div>
<div id="outline-container-org26136f6">
<h2 id="org26136f6">Advertisement</h2>
<div id="text-org26136f6">
<p>
If you want to play with <code>suc</code> but don’t want to bother with installing it, or
if you don’t have any friends to share a <code>suc</code> instance with, come and join us
at <a href="https://the-dam.org/">the dam</a> ! For a measly 10€/year, you can enjoy sharing <code>suc</code> on a GNU Guix
server with people from all over the world.
</p>

<p>
If you would like your own instance of <code>suc</code>, don’t hesitate and rent a VPS from
<a href="https://guix-hosting.com/">Guix hosting</a> ! For 100€/year, you get a GNU Guix VPS. Adding <code>suc</code> is just one
line of configuration away. There are no usage-based restrictions, your data
stays yours, and you can use your VPS to provide other services as well.
</p>
</div>
</div>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Our Journey with Apache Arrow (Part 2): Adaptive Schemas and Sorting (112 pts)]]></title>
            <link>https://arrow.apache.org/blog/2023/06/26/our-journey-at-f5-with-apache-arrow-part-2/</link>
            <guid>36594695</guid>
            <pubDate>Wed, 05 Jul 2023 01:53:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://arrow.apache.org/blog/2023/06/26/our-journey-at-f5-with-apache-arrow-part-2/">https://arrow.apache.org/blog/2023/06/26/our-journey-at-f5-with-apache-arrow-part-2/</a>, See on <a href="https://news.ycombinator.com/item?id=36594695">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
      <main role="main">
        

<hr>



<p>
  <span>Published</span>
  <span>
    26 Jun 2023
  </span>
  <br>
  <span>By</span>
  
    Laurent Quérel
  

  
</p>


        <!--

-->

<p>In the previous <a href="https://arrow.apache.org/blog/2023/04/11/our-journey-at-f5-with-apache-arrow-part-1/">article</a>, we discussed our use of Apache Arrow within the context of the OpenTelemetry project. We investigated various techniques to maximize the efficiency of Apache Arrow, aiming to find the optimal balance between data compression ratio and queryability. The compression results speak for themselves, boasting improvements ranging from 1.5x to 5x better than the original OTLP protocol. In this article, we will delve into three techniques that have enabled us to enhance both the compression ratio and memory usage of Apache Arrow buffers within the current version of the <a href="https://github.com/f5/otel-arrow-adapter">OTel Arrow protocol</a>.</p>

<p>The first technique we’ll discuss aims to optimize schemas in terms of memory usage. As you’ll see, the gains can be substantial, potentially halving memory usage in certain cases. The second section will delve more deeply into the various approaches that can be used to handle recursive schema definitions. Lastly, we’ll emphasize that the design of your schema(s), coupled with the sorts you can apply at the record level, play a pivotal role in maximizing the benefits of Apache Arrow and its columnar representation.</p>

<h2 id="handling-dynamic-and-unknown-data-distributions">Handling dynamic and unknown data distributions</h2>

<p>In certain contexts, the comprehensive definition of an Arrow schema can end up being overly broad and complex in order to cover all possible cases that you intend to represent in columnar form. However, as is often the case with complex schemas, only a subset of this schema will actually be utilized for a specific deployment. Similarly, it’s not always possible to determine the optimal dictionary encoding for one or more fields in advance. Employing a broad and very general schema that covers all cases is usually more memory-intensive. This is because, for most implementations, a column without value still continues to consume memory space. Likewise, a column with dictionary encoding that indexes a uint64 will occupy four times more memory than the same column with a dictionary encoding based on a uint8.</p>

<p>To illustrate this more concretely, let’s consider an OTel collector positioned at the output of a production environment, receiving a telemetry data stream produced by a large and dynamic set of servers. Invariably, the content of this telemetry stream will change in volume and nature over time. It’s challenging to predict the optimal schema in such a scenario, and it’s equally difficult to know in advance the distribution of a particular attribute of the telemetry data passing through this point.</p>

<p>To optimize such scenarios, we have adopted an intermediary approach that we have named <strong>dynamic Arrow schema</strong>, aiming to gradually adapt the schema based on the observed data. The general principle is relatively simple. We start with a general schema defining the maximum envelope of what should be represented. Some fields of this schema will be declared optional, while other fields will be encoded with multiple possible options depending on the observed distribution. In theory, this principle can be applied to other types of transformations (e.g., recursive column creation) but we will let your imagination explore these other options. So if you encounter data streams where certain fields are not utilized, some union variants remain unused, and/or the value distribution of a field cannot be determined a priori, it may be worthwhile to invest time in implementing this model. This can lead to improved efficiency in terms of compression ratio, memory usage, and processing speed.</p>

<p>The following Go Arrow schema definition provides an example of such a schema, instrumented with a collection of annotations. These annotations will be processed by an enhanced Record Builder, equipped with the ability to dynamically adapt the schema. The structure of this system is illustrated in Figure 1.</p>

<div><pre><code><span>var</span> <span>(</span>
  <span>// Arrow schema for the OTLP Arrow Traces record (without attributes, links, and events).</span>
  <span>TracesSchema</span> <span>=</span> <span>arrow</span><span>.</span><span>NewSchema</span><span>([]</span><span>arrow</span><span>.</span><span>Field</span><span>{</span>
      <span>// Nullabe:true means the field is optional, in this case of 16 bit unsigned integers</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>ID</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint16</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Resource</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>StructOf</span><span>([]</span><span>arrow</span><span>.</span><span>Field</span><span>{</span>
        <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>ID</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint16</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
        <span>// --- Use dictionary with 8 bit integers initially ----</span>
        <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>SchemaUrl</span><span>,</span><span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span><span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
        <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>DroppedAttributesCount</span><span>,</span><span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint32</span><span>,</span><span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>}</span><span>...</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Scope</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>StructOf</span><span>([]</span><span>arrow</span><span>.</span><span>Field</span><span>{</span>
          <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>ID</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint16</span><span>,</span> <span>Metadata</span><span>:</span> <span>acommon</span><span>.</span><span>Metadata</span><span>(</span><span>acommon</span><span>.</span><span>DeltaEncoding</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
          <span>// --- Use dictionary with 8 bit integers initially ----</span>
          <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Name</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span> <span>Metadata</span><span>:</span> <span>acommon</span><span>.</span><span>Metadata</span><span>(</span><span>acommon</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
          <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Version</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span> <span>Metadata</span><span>:</span> <span>acommon</span><span>.</span><span>Metadata</span><span>(</span><span>acommon</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
          <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>DroppedAttributesCount</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint32</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>}</span><span>...</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>SchemaUrl</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>StartTimeUnixNano</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>FixedWidthTypes</span><span>.</span><span>Timestamp_ns</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>DurationTimeUnixNano</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>FixedWidthTypes</span><span>.</span><span>Duration_ms</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>)},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>TraceId</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>FixedSizeBinaryType</span><span>{</span><span>ByteWidth</span><span>:</span> <span>16</span><span>}},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>SpanId</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>FixedSizeBinaryType</span><span>{</span><span>ByteWidth</span><span>:</span> <span>8</span><span>}},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>TraceState</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>ParentSpanId</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>FixedSizeBinaryType</span><span>{</span><span>ByteWidth</span><span>:</span> <span>8</span><span>},</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Name</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>)},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>KIND</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Int32</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>DroppedAttributesCount</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint32</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>DroppedEventsCount</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint32</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>DroppedLinksCount</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint32</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Status</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>StructOf</span><span>([]</span><span>arrow</span><span>.</span><span>Field</span><span>{</span>
        <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>StatusCode</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Int32</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
        <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>StatusMessage</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>,</span> <span>Metadata</span><span>:</span> <span>schema</span><span>.</span><span>Metadata</span><span>(</span><span>schema</span><span>.</span><span>Dictionary8</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
      <span>}</span><span>...</span><span>),</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
    <span>},</span> <span>nil</span><span>)</span>
  <span>)</span>
</code></pre></div>

<p>In this example, Arrow field-level metadata are employed to designate when a field is optional (Nullable: true) or to specify the minimal dictionary encoding applicable to a particular field (Metadata Dictionary8/16/…). Now let’s imagine a scenario utilizing this schema in a straightforward scenario, wherein only a handful of fields are actually in use, and the cardinality of most dictionary-encoded fields is low (i.e., below 2^8). Ideally, we’d want a system capable of dynamically constructing the following simplified schema, which, in essence, is a strict subset of the original schema.</p>

<div><pre><code><span>var</span> <span>(</span>
  <span>// Simplified schema definition generated by the Arrow Record encoder based on</span>
  <span>// the data observed.</span>
  <span>TracesSchema</span> <span>=</span> <span>arrow</span><span>.</span><span>NewSchema</span><span>([]</span><span>arrow</span><span>.</span><span>Field</span><span>{</span>
    <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>ID</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint16</span><span>,</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
    <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>StartTimeUnixNano</span><span>,</span> <span>Type</span><span>:</span> <span>arrow</span><span>.</span><span>FixedWidthTypes</span><span>.</span><span>Timestamp_ns</span><span>},</span>
    <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>TraceId</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>FixedSizeBinaryType</span><span>{</span><span>ByteWidth</span><span>:</span> <span>16</span><span>}},</span>
    <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>SpanId</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>FixedSizeBinaryType</span><span>{</span><span>ByteWidth</span><span>:</span> <span>8</span><span>}},</span>
    <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>Name</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>DictionaryType</span> <span>{</span>
      <span>IndexType</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint8</span><span>,</span>
      <span>ValueType</span><span>:</span> <span>arrow</span><span>.</span><span>BinaryTypes</span><span>.</span><span>String</span><span>}},</span>
    <span>{</span><span>Name</span><span>:</span> <span>constants</span><span>.</span><span>KIND</span><span>,</span> <span>Type</span><span>:</span> <span>&amp;</span><span>arrow</span><span>.</span><span>DictionaryType</span> <span>{</span>
      <span>IndexType</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Uint8</span><span>,</span>
      <span>ValueType</span><span>:</span> <span>arrow</span><span>.</span><span>PrimitiveTypes</span><span>.</span><span>Int32</span><span>,</span>
    <span>},</span> <span>Nullable</span><span>:</span> <span>true</span><span>},</span>
  <span>},</span> <span>nil</span><span>)</span>
<span>)</span>
</code></pre></div>

<p>Additionally, we desire a system capable of automatically adapting the aforementioned schema if it encounters new fields or existing fields with a cardinality exceeding the size of the current dictionary definition in future batches. In extreme scenarios, if the cardinality of a specific field surpasses a certain threshold, we would prefer the system to automatically revert to the non-dictionary representation (mechanism of dictionary overflow). That is precisely what we will elaborate on in the remainder of this section.</p>

<p>An overview of the different components and events used to implement this approach is depicted in figure 1.</p>

<figure>
  <img src="https://arrow.apache.org/img/journey-apache-arrow/adaptive-schema-architecture.svg" width="100%" alt="Fig 1: Adaptive Arrow schema architecture overview.">
  <figcaption>Fig 1: Adaptive Arrow schema architecture overview.</figcaption>
</figure>

<p>The overall Adaptive Arrow schema component takes a data stream segmented into batches and produces one or multiple streams of Arrow Records (one schema per stream). Each of these records is defined with an Arrow schema, which is based both on the annotated Arrow schema and the shape of fields observed in the incoming data.</p>

<p>More specifically, the process of the Adaptive Arrow schema component consists of four main phases</p>

<p><strong>Initialization phase</strong></p>

<p>During the initialization phase, the Arrow Record Encoder reads the annotated Arrow schema (i.e. the reference schema) and generates a collection of transformations. When these transformations are applied to the reference schema, they yield the first minimal Arrow schema that adheres to the constraints depicted by these annotations. In this initial iteration, all optional fields are eliminated, and all dictionary-encoded fields are configured to utilize the smallest encoding as defined by the annotation (only <code>Dictionary8</code> in the previous example). These transformations form a tree, reflecting the structure of the reference schema.</p>

<p><strong>Feeding phase</strong></p>

<p>Following the initialization is the feeding phase. Here, the Arrow Record Encoder scans the batch and attempts to store all the fields in an Arrow Record Builder, which is defined by the schema created in the prior step. If a field exists in the data but is not included in the schema, the encoder will trigger a <code>missing field</code> event. This process continues until the current batch is completely processed. An additional internal check is conducted on all dictionary-encoded fields in the Arrow Record builder to ensure there’s no dictionary overflow (i.e. more unique entries than the cardinality of the index permits). <code>Dictionary overflow</code> events are generated if such a situation is detected. Consequently, by the end, all unknown fields and dictionary overflow would have been detected, or alternatively, no discrepancies would have surfaced if the data aligns perfectly with the schema.</p>

<p><strong>Corrective phase</strong></p>

<p>If at least one event has been generated, a corrective phase will be initiated to fix the schema. This optional stage considers all the events generated in the previous stage and adjusts the transformation tree accordingly to align with the observed data. A <code>missing field</code> event will remove a NoField transformation for the corresponding field. A <code>dictionary overflow</code> event will modify the dictionary transformation to mirror the event (e.g. changing the index type from uint8 to uint16, or if the maximum index size has been reached, the transformation will remove the dictionary-encoding and revert to the original non-dictionary-encoded type). The updated transformation tree is subsequently used to create a new schema and a fresh Arrow Record Builder. This Record Builder is then utilized to replay the preceding feeding phase with the batch that wasn’t processed correctly.</p>

<p><strong>Routing phase</strong></p>

<p>Once a Record Builder has been properly fed, an Arrow Record is created, and the system transitions into the routing phase. The router component calculates a schema signature of the record and utilizes this signature to route the record to an existing Arrow stream compatible with the signature, or it initiates a new stream if there is no match.</p>

<p>This four-phase process should gradually adapt and stabilize the schema to a structure and definition that is optimized for a specific data stream. Unused fields will never unnecessarily consume memory. Dictionary-encoded fields will be defined with the most optimal index size based on the observed data cardinality, and fields with a cardinality exceeding a certain threshold (defined by configuration) will automatically revert to their non-dictionary-encoded versions.</p>

<p>To effectively execute this approach, you must ensure that there is a sufficient level of flexibility on the receiver side. It’s crucial that your downstream pipeline remains functional even when some fields are missing in the schema or when various dictionary index configurations are employed. While this may not always be feasible without implementing additional transformations upon reception, it proves worthwhile in certain scenarios.</p>

<p>The following results highlight the significant memory usage reduction achieved through the application of various optimization techniques. These results were gathered using a schema akin to the one previously presented. The considerable memory efficiency underscores the effectiveness of this approach.</p>

<figure>
  <img src="https://arrow.apache.org/img/journey-apache-arrow/memory-usage-25k-traces.png" width="100%" alt="Fig 2: Comparative analysis of memory usage for different schema optimizations.">
  <figcaption>Fig 2: Comparative analysis of memory usage for different schema optimizations.</figcaption>
</figure>

<p>The concept of a transformation tree enables a generalized approach to perform various types of schema optimizations based on the knowledge acquired from the data. This architecture is highly flexible; the current implementation allows for the removal of unused fields, the application of the most specific dictionary encoding, and the optimization of union type variants. In the future, there is potential for introducing additional optimizations that can be expressed as transformations on the initial schema. An implementation of this approach is available <a href="https://github.com/f5/otel-arrow-adapter/tree/main/pkg/otel/common/schema">here</a>.</p>

<h2 id="handling-recursive-schema-definition">Handling recursive schema definition</h2>

<p>Apache Arrow does not support recursive schema definitions, implying that data structures with variable depth cannot be directly represented. Figure 3 exemplifies such a recursive definition where the value of an attribute can either be a simple data type, a list of values, or a map of values. The depth of this definition cannot be predetermined.</p>

<figure>
  <img src="https://arrow.apache.org/img/journey-apache-arrow/recursive-def-otel-attributes.svg" width="100%" alt="Fig 3: Recursive definition of OTel attributes.">
  <figcaption>Fig 3: Recursive definition of OTel attributes.</figcaption>
</figure>

<p>Several strategies can be employed to circumvent this limitation. Technically, the dynamic schema concept we’ve presented could be expanded to dynamically update the schema to include any missing level of recursion. However, for this use case, this method is complex and has the notable downside of not offering any assurance on the maximum size of the schema. This lack of constraint can pose security issues; hence, this approach isn’t elaborated upon.</p>

<p>The second approach consists of breaking the recursion by employing a serialization format that supports the definition of a recursive schema. The result of this serialization can then be integrated into the Arrow record as a binary type column, effectively halting the recursion at a specific level. To fully leverage the advantages of columnar representation, it is crucial to apply this ad-hoc serialization as deeply within the data structure as feasible. In the context of OpenTelemetry, this is performed at the attribute level – more specifically, at the second level of attributes.</p>

<p>A variety of serialization formats, such as protobuf or CBOR, can be employed to encode recursive data. Without particular treatment, these binary columns may not be easily queryable by the existing Arrow query engines. Therefore, it’s crucial to thoughtfully ascertain when and where to apply such a technique. While I’m not aware of any attempts to address this limitation within the Arrow system, it doesn’t seem insurmountable and would constitute a valuable extension. This would help reduce the complexity of integrating Arrow with other systems that rely on such recursive definitions.</p>

<h2 id="importance-of-sorting">Importance of sorting</h2>

<p>In our preceding <a href="https://arrow.apache.org/blog/2023/04/11/our-journey-at-f5-with-apache-arrow-part-1/">article</a>, we explored a variety of strategies to represent hierarchical data models, including nested structures based on struct/list/map/union, denormalization and flattening representations, as well as a multi-record approach. Each method presents its unique advantages and disadvantages. However, in this last section, we’ll delve deeper into the multi-record approach, focusing specifically on its ability to offer versatile sorting options and how these options contribute to an enhanced compression ratio.</p>

<p>In the OTel Arrow protocol, we leverage the multi-record approach to represent metrics, logs, and traces. The following entity-relationship diagram offers a simplified version of various record schemas and illustrates their relationships, specifically those used to represent gauges and sums. A comprehensive description of the Arrow data model employed in OpenTelemetry can be accessed <a href="https://github.com/f5/otel-arrow-adapter/blob/main/docs/data_model.md">here</a>.</p>

<p>These Arrow records, also referred to as tables, form a hierarchy with <code>METRICS</code> acting as the primary entry point. Each table can be independently sorted according to one or more columns. This sorting strategy facilitates the grouping of duplicated data, thereby improving the compression ratio.</p>

<figure>
  <img src="https://arrow.apache.org/img/journey-apache-arrow/metric-dp-data-model.png" width="100%" alt="Fig 4: A simplified entity-relationship diagram representing OTel sum &amp; gauge metrics.">
  <figcaption>Fig 4: A simplified entity-relationship diagram representing OTel sum &amp; gauge metrics.</figcaption>
</figure>

<p>The relationship between the primary <code>METRICS</code> table and the secondary <code>RESOURCE_ATTRS</code>, <code>SCOPE_ATTRS</code>, and <code>NUMBER_DATA_POINTS</code> tables is established through a unique <code>id</code> in the main table and a <code>parent_id</code> column in each of the secondary tables. This {id,parent_id} pair represents an overhead that should be minimized to the greatest extent possible post-compression.</p>

<p>To achieve this, the ordering process for the different tables adheres to the hierarchy, starting from the main table down to the leaf. The main table is sorted (by one or multiple columns), and then an incremental id is assigned to each row. This numerical id is stored using delta-encoding, which is implemented on top of Arrow.</p>

<p>The secondary tables directly connected to the main table are sorted using the same principle, but the <code>parent_id</code> column is consistently utilized as the last column in the sort statement. Including the <code>parent_id</code> column in the sort statement enables the use of a variation of delta encoding. The efficiency of this approach is summarized in the chart below.</p>

<figure>
  <img src="https://arrow.apache.org/img/journey-apache-arrow/compressed-message-size.png" width="100%" alt="Fig 5: Comparative analysis of compression ratios - OTLP Protocol vs. Two variations of the OTel Arrow Protocol with multivariate metrics stream. (lower percentage is better)">
  <figcaption>Fig 5: Comparative analysis of compression ratios - OTLP Protocol vs. Two variations of the OTel Arrow Protocol with multivariate metrics stream. (lower percentage is better)</figcaption>
</figure>

<p>The second column presents the average size of the OTLP batch both pre- and post-ZSTD compression for batches of varying sizes. This column serves as a reference point for the ensuing two columns. The third column displays results for the OTel Arrow protocol without any sorting applied, while the final column showcases results for the OTel Arrow protocol with sorting enabled.</p>

<p>Before compression, the average batch sizes for the two OTel Arrow configurations are predictably similar. However, post-compression, the benefits of sorting each individual table on the compression ratio become immediately apparent. Without sorting, the OTel Arrow protocol exhibits a compression ratio that’s 1.40 to 1.67 times better than the reference. When sorting is enabled, the OTel Arrow protocol outperforms the reference by a factor ranging from 4.94 to 7.21 times!</p>

<p>The gains in terms of compression obviously depend on your data and the redundancy of information present in your data batches. According to our observations, the choice of a good sort generally improves the compression ratio by a factor of 1.5 to 8.</p>

<p>Decomposing a complex schema into multiple simpler schemas to enhance sorting capabilities, coupled with a targeted approach to efficiently encode the identifiers representing the relationships, emerges as an effective strategy for enhancing overall data compression. This method also eliminates complex Arrow data types, such as lists, maps, and unions. Consequently, it not only improves but also simplifies data query-ability. This simplification proves beneficial for existing query engines, which may struggle to operate on intricate schemas.</p>

<h2 id="conclusion-and-next-steps">Conclusion and next steps</h2>

<p>This article concludes our two-part series on Apache Arrow, wherein we have explored various strategies to maximize the utility of Apache Arrow within specific contexts. The adaptive schema architecture presented in the second part of this series paves the way for future optimization possibilities. We look forward to seeing what the community can add based on this contribution.</p>

<p>Apache Arrow is an exceptional project, continually enhanced by a thriving ecosystem. However, throughout our exploration, we have noticed certain gaps or points of friction that, if addressed, could significantly enrich the overall experience.</p>
<ul>
  <li>Designing an efficient Arrow schema can, in some cases, prove to be a challenging task. Having the <strong>ability to collect statistics</strong> at the record level could facilitate this design phase (data distribution per field, dictionary stats, Arrow array sizes before/after compression, and so on). These statistics would also assist in identifying the most effective columns on which to base the record sorting.</li>
  <li><strong>Native support for recursive schemas</strong> would also increase adoption by simplifying the use of Arrow in complex scenarios. While I’m not aware of any attempts to address this limitation within the Arrow system, it doesn’t seem insurmountable and would constitute a valuable extension. This would help reduce the complexity of integrating Arrow with other systems that rely on such recursive definitions.</li>
  <li><strong>Harmonizing the support for data types as well as IPC stream capabilities</strong> would also be a major benefit. Predominant client libraries support nested and hierarchical schemas, but their use is limited due to a lack of full support across the rest of the ecosystem. For example, list and/or union types are not well supported by query engines or Parquet bridges. Also, the advanced dictionary support within IPC streams is not consistent across different implementations (i.e. delta dictionaries and replacement dictionaries are not supported by all implementations).</li>
  <li><strong>Optimizing the support of complex schemas</strong> in terms of memory consumption and compression rate could be improved by natively integrating the concept of the dynamic schema presented in this article.</li>
  <li><strong>Detecting dictionary overflows</strong> (index level) is not something that is easy to test on the fly. The API could be improved to indicate this overflow as soon as an insertion occurs.</li>
</ul>

<p>Our effort to utilize Apache Arrow in conjunction with OpenTelemetry has produced encouraging results. While this has necessitated considerable investment in terms of development, exploration, and benchmarking, we hope that these articles will aid in accelerating your journey with Apache Arrow. Looking ahead, we envision an end-to-end integration with Apache Arrow and plan to significantly extend our use of the Arrow ecosystem. This extension involves providing a bridge with Parquet and integrating with a query engine such as DataFusion, with the goal of processing telemetry streams within the collector.</p>

      </main>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[I Hate the News (2006) (106 pts)]]></title>
            <link>http://www.aaronsw.com/weblog/hatethenews</link>
            <guid>36593249</guid>
            <pubDate>Tue, 04 Jul 2023 22:20:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="http://www.aaronsw.com/weblog/hatethenews">http://www.aaronsw.com/weblog/hatethenews</a>, See on <a href="https://news.ycombinator.com/item?id=36593249">Hacker News</a></p>
<div id="readability-page-1" class="page"><p>Some people start their day by reading <em>The New York Times</em>. Others end it by watching the nightly news. Some get it from <em>The Daily Show</em>. Others download it from a variety weblogs. Some keep up-to-the-minute by following CNN. Others have instant news updates automatically text messaged to their phone. But everybody seems to agree: it’s a citizen’s responsibility to keep up with the news. Everybody except me.</p><p>I think following the news is a waste of time.</p><p>Some people agree with me on a small scale. Some point out that the cable channels are obsessed with bizarre crimes that have little larger impact, that they worry too much about horse-race coverage of politics, that too much of the news is filled with PR-inserted nonsense. But they do this because they think these are aberrations; that underneath all this, the news is worth saving. I simply go one step further: I think none of it is worthwhile.</p><p>Let us look at the front page of today’s <em>New York Times</em>, the gold standard in news. In the top spot there is a story about Republicans feuding among themselves. There is a photo of soldiers in Iraq. A stock exchange chief must return $100M. There is a concern about some doctors over-selling a nerve testing system. There is a threat from China against North Korea. There is a report that violence in Iraq is rising. And there is concern about virtual science classes replacing real ones.</p><p>None of these stories have relevance to my life. Reading them may be enjoyable, but it’s an enjoyable waste of time. They will have no impact on my actions one way or another.</p><p>Most people will usually generally concede this point, but suggest that there’s something virtuous about knowing it anyway, that it makes me a better citizen. They point out that newspapers are a key part of our democracy, that by exposing wrong-doing to the people, they force the wrong-doers to stop.</p><p>This seems to be true, but the curious thing is that I’m never involved. The government commits a crime, the <em>New York Times</em> prints it on the front page, the people on the cable chat shows foam at the mouth about it, the government apologizes and commits the crime more subtly. It’s a valuable system — I certainly support the government being more subtle about committing crimes (well, for the sake of argument, at least) — but you notice how it never involves me? It seems like the whole thing would work just as well even if nobody ever read the <em>Times</em> or watched the cable chat shows. It’s a closed system.</p><p>There is voting, of course, but to become an informed voter all one needs to do is read a short guide about the candidates and issues before the election. There’s no need to have to suffer through the daily back-and-forth of allegations and counter-allegations, of scurrilous lies and their refutations. Indeed, reading a voter’s guide is much better: there’s no recency bias (where you only remember the crimes reported in the past couple months), you get to hear both sides of the story after the investigation has died down, you can actually think about the issues instead of worrying about the politics.</p><p>Others say that sure, most of the stuff in the news isn’t of use, but occasionally you’ll come across some story that will lead you to actually change what you’ve been working on. But really, how plausible is this? Most people’s major life changes don’t come from reading an article in the newspaper; they come from reading longer-form essays or thoughtful books, which are much more convincing and detailed.</p><p>Which brings me to my second example of people agreeing with me on the small scale. You’ll often hear TV critics say that CNN’s up-to-the-minute reporting is absurd. Instead of saying, “We have unconfirmed reports that—This just in! We now have confirmed reports that those unconfirmed reports have been denied. No, wait! There’s a new report denying the confirmation of the denial of the unconfirmed report.” and giving viewers whiplash, they suggest that the reporters simply wait until a story is confirmed before reporting it and do commentary in the meantime.</p><p>But if that’s true on a scale of minutes, why longer? Instead of watching hourly updates, why not read a daily paper? Instead of reading the back and forth of a daily, why not read <a href="http://harpers.org/WeeklyReview.html">a weekly review</a>? Instead of a weekly review, why not read a monthly magazine? Instead of a monthly magazine, why not read an annual book?</p><p>With the time people waste reading a newspaper every day, they could have read an entire book about most subjects covered and thereby learned about it with far more detail and far more impact than the daily doses they get dribbled out by the paper. But people, of course, wouldn’t read a book about most subjects covered in the paper, because most of them are simply irrelevant.</p><p>But finally, I’d like to argue that following the news isn’t just a waste of time, it’s actively unhealthy. Edward Tufte notes that when he used to read the <em>New York Times</em> in the morning, it scrambled his brain with so many different topics that he couldn’t get any real intellectual work done the rest of the day.</p><p>The news’s obsession with having a little bit of information on a wide variety of subjects means that it actually gets most of those subjects wrong. (One need only read the blatant errors reported in the corrections page to get some sense of the more thorough-going errors that must lie beneath them. And, indeed, anyone who has ever been in the news will tell you that the news always gets the story wrong.) Its obsession with the criminal and the deviant makes us less trusting people. Its obsession with the hurry of the day-to-day makes us less reflective thinkers. Its obsession with surfaces makes us shallow.</p><p>This is not simply an essay meant to provoke; I genuinely believe what I write. I have not followed the news at least since I was 13 (with occasional lapses on particular topics). My life does not seem to be impoverished for it; indeed, I think it has been greatly enhanced. But I haven’t found many other people who are willing to take the plunge.</p><div id="comments_body">




<div id="c1">
<p>I’d distinguish what’s relevant from what’s interesting. E.g., a local zoning board dispute is more relevant to me than interesting.  You’re still interested in matters that are only marginally relevant to you. You’re just widening your sample as a noise filter, and it just becomes a matter of finding the optimum time period.  So if journalism is the first draft of history, maybe we should wait for the second draft, huh?</p>

<p>posted by Mike Sierra
 on October 20, 2006 <a href="#c1" rel="bookmark">#</a></p>
</div>
<div id="c2">
<p>This essay is kinda funny considering that Aaron works on a website that is all about sharing democratizing news…</p>

<p>posted by johnnyboy
 on October 20, 2006 <a href="#c2" rel="bookmark">#</a></p>
</div>
<div id="c3">
<p>johnnyboy: Is that what Aaron’s blog is about? Hmmm…I thought it was about making fun of people. That’s why I read it, anyway. Though you are right, this one was pretty funny too.</p>

<p>posted by ged
 on October 20, 2006 <a href="#c3" rel="bookmark">#</a></p>
</div>
<div id="c4">
<p>Wow, this post plays to so many of my own prejudices about the news, I almost want to disqualify myself from commenting! LOL Anyway, I have a challenge I’ve posted to friends and strangers over the past 25 years, and I have yet to have a “winner.”  Here it is: if you, personally (first-hand knowledge only!) have been involved in a situation that was reported in the newspaper, did they get it correct, 100 percent? Every name spelled correctly?  The numbers right? The very simplest of details that would have been easy to check and verify?  Because of the several hundred (admittedly small sample) I’ve asked, no one has answered in the affirmative.  From the smallest local story to the national ones.  I just think that’s bizarre, and I don’t understand it, knowing how obsessive some reporters and writers can be about details.  Any explanations?</p>

<p>posted by Reg Aubry
 on October 20, 2006 <a href="#c4" rel="bookmark">#</a></p>
</div>
<div id="c5">
<p>Stop reminding me of Theodore Sturgeon short stories dangit! If you haven’t read “And Now The News…” (the story in the book of the same title) you must go read it now! Go!</p>

<p>posted by <a rel="nofollow" href="http://mccarthy.vg/">Jamie McCarthy</a>
 on October 20, 2006 <a href="#c5" rel="bookmark">#</a></p>
</div>
<div id="c6">
<p>One morning about 5 years ago, for reasons which I have never fully understood, I clicked on the morning news for the first time ever. The date was 9/11/2001. The result was so bad that I never repeated the experiment.</p>

<p>posted by Gordon
 on October 20, 2006 <a href="#c6" rel="bookmark">#</a></p>
</div>
<div id="c7">
<p>By the same argument, we probably shouldn’t read blogs either, except ones that have time-sensitive, relative information.</p>

<p>posted by <a rel="nofollow" href="http://slesinsky.org/brian/">Brian Slesinsky</a>
 on October 21, 2006 <a href="#c7" rel="bookmark">#</a></p>
</div>
<div id="c8">
<p>@Reg Aubry:</p>

<p>Consider how unreliable eyewitness testimony is. People who witness crimes often have very different accounts of what happened — not just trivia like whether the assailant was wearing green-on-red plaid or red-on-green plaid, but how many people were involved, the sequence of events, the skin color and other obvious physical characteristics of the people involved, etc.</p>

<p>What’s my point? The news is made by people who rely on other people and their memories and explanations of what happened.</p>

<p>And that is not even considering the intentional dishonesty of parties involved in the events.</p>

<p>posted by joseph knecht
 on October 21, 2006 <a href="#c8" rel="bookmark">#</a></p>
</div>
<div id="c9">
<p>actually, nassim taleb (author of Fooled by Randomness, which is an awesome book about luck and financial markets) also talks about information pollution (more in the context of financial commentators on things like CNBC and Bloomberg).</p>

<p>posted by <a rel="nofollow" href="http://fireshui.com/">B.Z.</a>
 on October 21, 2006 <a href="#c9" rel="bookmark">#</a></p>
</div>
<div id="c10">
<blockquote>
  <p>None of these stories have relevance to my life. 
  Reading them may be enjoyable, but it’s an 
  enjoyable waste of time. They will have no impact 
  on my actions one way or another.</p>
</blockquote>

<p>You’re basically arguing against Chomsky and denying the influence of media on public opinion. This is very interesting for several reasons, one would be that you’ve just found out that spending money in political campaigns is a waste - though somehow this goes against every piece of study done in that field; OK, maybe it is in fact only the bumpersticker and the flag that make difference, not the news-media.</p>

<p>But seriously: I think you are arguing, that it doesn’t make any sense for YOU to read the news, because you already made up your mind on all the things you’re going to do. You know who you’re voting for, you know that you’ll not be taking part in any revolutions toppling the government, you know already what you want to believe about the policies of certain politicians, or parties. In such a case of course it doesn’t help to read the news. Neither for you, nor for followers of the Bush cult, or religious nuts etc. (forgive me for juxtaposing you with those groups; I know that unlike them you are from the reality-based community and will change your perceptions in accordance with reality).</p>

<p>However the conclusion that it is unnecessary for you, does not mean it is unnecesary for everybody. I agree that watching the news daily is more for entertainment, but I think getting a weekly overview over what is happening is important, for the same reason for <em>not</em> letting all tax-related stuff pile up until shortly before the deadlines; it’s easier to “get done”, it feels less like a chore). And yes, due to things I have read in the news, I have actualy taken action, like taking part in demonstrations for/against certain ideas/concepts/policies. It’s not like there is a dichotomy between reading long essays/books and reading newspapers. There is in fact a) some overlap and b) plenty of reason to do both, because I do not beforehand what topics I want (or should be) reading long books/essays on.</p>

<blockquote>
  <p>But if that’s true on a scale of minutes, why 
  longer? Instead of watching hourly updates, why 
  not read a daily paper? Instead of reading the 
  back and forth of a daily, why not read a weekly
   review? Instead of a weekly review, why not 
  read a monthly magazine? Instead of a monthly 
  magazine, why not read an annual book?</p>
</blockquote>

<p>That’s a very poor argument, in fact it’s not an argument it’s a slippery slope fallacy. And I am surprised that you’d stoop so low. Here see how much sense it makes:
“If having sex every minute of your life is not a good way to live your life and might lead to harmful side-effects, then why would it be a good idea to have sex once a day? or once a week? Or once a year or once in your life? If having sex every minute in your life is bad, then surely having sex even once in your life is bad as well. Remeber: If the glove doesn’t fit, you must acquit.”
Doesn’t make much sense, does it…</p>

<blockquote>
  <p>The news’s obsession with having a little bit of
  information on a wide variety of subjects means 
  that it actually gets most of those subjects 
  wrong.</p>
</blockquote>

<p>This seems similar to one of the commenters saying:</p>

<blockquote>
  <p>that was reported in the newspaper, did they get
  it correct, 100 percent?</p>
</blockquote>

<p>It’s probably true that often things are not 100% correct. It’s also true that of the many decision that I face as a human every day not all are 100% correct, yet I somehow manage to get by and even think of my life as being somewhat decent. Could it be that the same goes for newspapers? That while they may not be 100%correct  on any subject, that they manage to be decent enough to be useful for the people readin them? Sure, I’d prefer to have an oracle that is 100% correct; but I sure as hell would not pay the price for that with respect to news. You probably know the difference of cost between a datacenter that guarantuees 99% availability, and the one that offers 99,999% availability (the costs explode). For my purposes the former has been decent enough, thank you. As a politician making crucial decision about life or death, you certainl want higher precision, and they do in fact pay a lot more for their reports and intelligence, than what I pay for a newspaper. In any case: Are you honestly suggesting that the simple and obvious fact that a newspaper is not an oracle makes them useless?</p>

<blockquote>
  <p>It’s a valuable system — I certainly support 
  the government being more subtle about 
  committing crimes (well, for the sake of 
  argument, at least) — but you notice how it 
  never involves me? It seems like the whole thing
   would work just as well even if nobody ever 
  read the Times or watched the cable chat shows. 
  It’s a closed system.</p>
</blockquote>

<p>You can say the same thing about voting in a represantative democracy. Surely one singe vote is not going to make a difference. And even if only the people voted that actually hold office, and the rest of the population wouldn’t, it wouldn’t make a difference, would it? Legitimacy, Schmeticimacy, that’s not important. After all it’s only the brand that counts, right? If  somebody bought the “Times” and never published something to the pubic, and only made their claims to the officials in government, it would keep on working the same way. Much like when dictators claim they live and rule in a democracy and have free press, and freedom for the people, then that makes it true, at least as long as they bought the “true democracy brand”, like Iraq is currently doing. Certainly it doesn’t involve any of the actual people living there to do or say anything.</p>

<p>The reason that the “closed system” works, is because there is some legitimacy in it. That legitimacy is gone when people stop participating in it. For a newspaper participation comes from the readers it is reaching, and for a democracy it is the people voting. Claiming that it’s a “closed system” and works the same way when you take away the people is absurd.</p>

<p>What you <em>can</em> claim is that taking away one person is not going to make the system collapse. In game theory I believe this is called the free rider’s dilemma. Surely the country is not going down the drain, when one person is not paying his taxes. Surely public transit is not going bankrupt, if I decide not pay today. etc. etc.</p>

<blockquote>
  <p>Most people’s major life changes don’t come from
  reading an article in the newspaper; they come 
  from reading longer-form essays or thoughtful 
  books, which are much more convincing and 
  detailed.</p>
</blockquote>

<p>What does that say about your weblog?</p>

<p>I think what you are really trying to say, is that the act of delivering and the act of absorbing a list of facts about lots of unrelated little stories is not helpful. That’s true for a certain kind of “journalism” (in quotes) that feeds on the same instinct that makes peope slow down and look at accident-scenes. That’s indeed little helpful. But to reduce news, newspapers or the media to just that is dismissing the reality of the world we live in.</p>

<p>posted by Anonymous
 on October 21, 2006 <a href="#c10" rel="bookmark">#</a></p>
</div>
<div id="c11">
<p>Reading the news may, and probably does, make you a better citizen. But so what? I don’t want to be a (good) citizen, i.e. an (obedient) subject of a state. As the saying goes, “the only nation worth paying any allegiance to, is imagination”.</p>

<p>With regard to the news themselves, I just scan the headlines (RSS) to see what’s going on, and it won’t waste many minutes of my time a day. That’s usually quite enough to infer the content, most of which is totally uninteresting. Occasionally there’s a more interesting story worth reading, but only very occasionally.</p>

<p>One could actually almost “survive” on free newspapers here, as every few months some newspaper tries to lure you to order it, by offering it for free for a month or two. Some years ago I once took the free newspaper, but all I got was fed up with hauling the papers to the paper recycling bin, so I haven’t accepted any newspaper offers, free or otherwise, since then.</p>

<p>posted by <a rel="nofollow" href="http://iki.fi/tuomov/">tuomov</a>
 on October 21, 2006 <a href="#c11" rel="bookmark">#</a></p>
</div>
<div id="c12">
<p>I own a television, but it is literally wrapped up in a wooden box which has a lock on it, and for good reason. I also gave up on the news after a brief stint in the wake of 9-11 when every military anything had a TV tuned to CNN non-stop: having taken news consumption to its limit, and having a job, simultaneously, to find information, it became painfully clear that the news, and television in general, was a waste of time. I rely on friends and blogs to keep me informed of current events and I spend my ‘news’ time searching out other viewpoints. With those provisios, let me tack on to Anonymous about this:</p>

<blockquote>The news’s obsession with having a little bit of information on a wide variety of subjects means that it actually gets most of those subjects wrong.</blockquote>

<p>This is true, but it is also true that <a href="http://medicine.plosjournals.org/perlserv?request=get-document&amp;doi=10.1371/journal.pmed.0020124" rel="nofollow">most scientific findings are false</a>. This is a deep but practical reason that it is necessary to doubt, not to reject journalism.</p>

<p>posted by <a rel="nofollow" href="http://nielsolson.us/">Niels Olson</a>
 on October 21, 2006 <a href="#c12" rel="bookmark">#</a></p>
</div>
<div id="c13">
<p>Do you vote?
Are your choices when voting influenced by what you read in the news?</p>

<p>If so it is no longer a closed system and you are involved. The reason that the government reacts when the cable channels, etc froth at the mouth is that they are concerned that that votes are at stake. If no one ever read the papers, or watched the news, then the motivation for the goverment to ‘commit crimes more subtly” would not exist. It is not a closed system, but it can feel that way, as the actions of voters are only significant when viewed in large blocks.</p>

<p>I would agree that following the news on an hourly, or daily basis is a waste of time for the average person, but when the time comes to vote for a representative , knowledge of how they have performed in the past is valuable.</p>

<p>posted by <a rel="nofollow" href="http://blog.odonnell.nu/">Sean O'Donnell</a>
 on October 22, 2006 <a href="#c13" rel="bookmark">#</a></p>
</div>
<div id="c14">
<p>Maybe it’s not <em>reading</em> the Times that helps, but <em>buying</em> it — you’re paying the salaries of the reporters that expose politicians doing bad stuff.</p>

<p>posted by Chris
 on October 22, 2006 <a href="#c14" rel="bookmark">#</a></p>
</div>
<div id="c15">
<p>http://en.wikipedia.org/wiki/Solipsism</p>

<p>posted by hmmm
 on October 22, 2006 <a href="#c15" rel="bookmark">#</a></p>
</div>
<div id="c16">
<p><a href="http://www.aaronsw.com/weblog/hatethenews#c2" rel="nofollow">johnnyboy:</a> I considered adding a bit about myself in the last paragraph on that topic, but it seemed too self-indulgent.</p>

<p><a href="http://www.aaronsw.com/weblog/hatethenews#c10" rel="nofollow">Anonymous:</a> (and <a href="http://www.aaronsw.com/weblog/hatethenews#c13" rel="nofollow">Sean</a>) If you comment is only about voting, then all I need to do is read a voter guide shortly before the election. Why do I need to get daily updates on the back and forth? I’ve added a paragraph to this effect.</p>

<p>A slippery slope argument isn’t a fallacy, because sometimes it’s true. In any event, this isn’t a slippery slope argument — it’s a “if you agree there’s a line, where do you draw it?” argument.</p>

<p>I’m not saying newspapers are useless; I’m saying they’re worse than the alternative.</p>

<p><a href="http://www.aaronsw.com/weblog/hatethenews#c12" rel="nofollow">Niels:</a> The scientific findings are false in a very different way than newspapers are false. The scientific findings are false because in experiments you can’t rule out random chance. The newspaper findings are</p>

<p>posted by <a rel="nofollow" href="http://www.aaronsw.com/">Aaron Swartz</a>
 on October 22, 2006 <a href="#c16" rel="bookmark">#</a></p>
</div>
<div id="c17">
<p>“…to become an informed voter all one needs to do is read a short guide about the candidates and issues before the election.”
Will those of you who believe this PLEASE-STOP-VOTING.
Thanks.</p>

<p>posted by DaveA
 on October 22, 2006 <a href="#c17" rel="bookmark">#</a></p>
</div>
<div id="c18">
<p>Aaron, when considering a voter guide , then our opinions are much closer. The sad fact is that (over here in Ireland at least) voter guides are few and far between. On top of that where does the voter guide come from? Who compiled it? What are their biases? Now I need a voter guide guide to boot. Its a nice scenario , but impractical.</p>

<p>In the abscence of reliable, unbiased guides, the news is my only source of information. That said I agree that keeping up regularly is uneccessary. I use the large variety of news sources to help control the biases. I buy a paper perhaps once every 2 weeks, and watch television news with roughly the same frequency. If I find an issue of particular concern on one of these rare dips into the news stream that might result in a period of more intense attention than normal. If a serious national/european issue arises, It will become impossible to miss. And if something more specialist arises It will do doubt be raised in one of the many blogs on topics of interest that I subscribe.</p>

<p>For example when the EUCD started reared its ugly head that resulted in me paying particular attention to all news outlets that might carry any information on the subject at all. And close to key voting dates my attention was indeed hourly. All the better to lobby my MEP’s and combat any last minute PR by the opposing side.</p>

<p>But at the moment there is nothing particularly alarming happening that I wish to involve myself in, so its been weeks since I have watched TV news or read the papers.</p>

<p>I suppose this brings me to a second point. Why are you not involved? Why do you not contact your representatives? I will admit that the first time I did it I did not believe that it would actually accomplish anything, I almost viewed it as a symbolic protest, and with some representatives that was indeed the case. But in the majority of cases I was actually pleasantly suprised that the act of one voter calling, phoning or writing (email seems to be very ineffective) seemed to have a real impact.</p>

<p>posted by <a rel="nofollow" href="http://blog.odonnell.nu/">Sean O'Donnell</a>
 on October 22, 2006 <a href="#c18" rel="bookmark">#</a></p>
</div>
<div id="c19">
<p>Hi Aaron,</p>

<p>I enjoy your blog, and I love your honesty and disclosure. Really good.</p>

<p>Have you considered that because your opportunity-rich young life is at least partly a product of your country’s position in the world, you might have a responsibility to understand the cost externalities of this lifestyle? (In other words, to read good quality international news). Maybe ignorance is blissful self-indulgence?</p>

<p>Don’t mean to sound patronising, and I’m not trying to tell you what to do ;-) but it’s at least one argument in favour of reading the news, through whatever medium. On the other hand, personal experience suggests that this strategy does not tend to happiness, but hey!</p>

<p>Just my 2c.</p>

<p>posted by Lee Bryant
 on October 22, 2006 <a href="#c19" rel="bookmark">#</a></p>
</div>
<div id="c20">
<p>I’m incredibly concerned about the privilege I receive as a beneficiary of US imperialism and the costs to the rest of the world. That’s because I read books; not because I read the paper.</p>

<p>posted by <a rel="nofollow" href="http://www.aaronsw.com/">Aaron Swartz</a>
 on October 22, 2006 <a href="#c20" rel="bookmark">#</a></p>
</div>
<div id="c21">
<p>All counts. Books(new and old), papers, tvs, documentaries, movies, what you see on the street. How you talk to your Chinese, Argentinian, and Lebanese friends - Iraqi landlords - or even Jewish contractors - how the 20th century was for their family and people - and how it’s going - etc.</p>

<p>It’s harmful to think books are better than newspapers. For local and current issue, local papers and phone directory comes in handy, esp when things are not working that well in the local govts.</p>

<p>We all got basic intelligence to grasp how things are working in the world, problem is we haven’t sorted out the framework to design ‘dashboard’ for each and all of us - as a driver and passenger - but we have all kind of meters and warning lights piling up almost at random in front of our eyes.</p>

<p>But base should be that we all got enough intelligence to grasp what’s going on. The rest is like competition snotty kids having in classroom. Get it out. It’s a pettiness over the privilege.</p>

<p>posted by a.kusaka
 on October 23, 2006 <a href="#c21" rel="bookmark">#</a></p>
</div>
<div id="c22">
<p>I know you’re concerned and connected in a good way, and wasn’t trying to imply otherwise :-)</p>

<p>Books are great, but they can only tell you what has happened, not what is about to happen. Also, in my experience, where books use secondary or tertiary sources to reconstruct events, they sometimes get it wrong just like the ‘papers.</p>

<p>There are some great reporters out there who are writing great books page by page whilst covering events around the world, and without their primary materials based on sharing the experiences of real people, history books would be a lot more remote from real life.</p>

<p>posted by Lee Bryant
 on October 23, 2006 <a href="#c22" rel="bookmark">#</a></p>
</div>
<div id="c23">
<p>While i hail your strategy for following the news as a wise choice, i would like to emphasize that it may not be the best strategy for all people at all times.  To say “None of these stories have relevance to my life … They will have no impact on my actions one way or another” is true (or not) by personal choice and not of necessity.  For the most part i have followed the same strategy as have you; and me thinks it has served me well … obsession with what passes for mainstream news these days is most certainly the waste of time of a obsessive voyeur.  Yet from time to time it is wise to adapt and change the focus of your attention.  If there is a fire in the house, you must watch out.  Me thinks that is actually the case we have in the world today.  The urgent matter, of course, being the Bush Doctrine.  That is a fire that must be extinguished.  Involvement in that political story with the objective of taking control of the US congress away form the administration is an urgent matter with which every right minded citizen of the United States should be concerned … or so me thinks.</p>

<p>posted by <a rel="nofollow" href="http://fastblogit.com/seth">Seth Russell</a>
 on October 23, 2006 <a href="#c23" rel="bookmark">#</a></p>
</div>
<div id="c24">
<p><a href="http://www.aaronsw.com/weblog/hatethenews#c18" rel="nofollow">Sean:</a> So voter guides might be biased, but we can all trust newspapers?</p>

<p>I spent a long time contating my representatives; it’s never had an impact. So I decided to build a system to let lots of people contact their representatives, but then I found that didn’t have an impact either. So now I’m working on an even bigger system.</p>

<p><a href="http://www.aaronsw.com/weblog/hatethenews#c22" rel="nofollow">Lee:</a> Nobody is suggesting people shouldn’t do journalism and publish it in books. Nor that books are always right. But when do you care about what is just about to happen?</p>

<p>posted by <a rel="nofollow" href="http://www.aaronsw.com/">Aaron Swartz</a>
 on October 23, 2006 <a href="#c24" rel="bookmark">#</a></p>
</div>
<div id="c25">
<p>Aaron, as I said, I use the large variety of news sources to help control the biases. While this isnt perfect, no source of information (no matter how hard the author may honestly try) is completely free of bias, the only reasonable solution to that is to try and get as many sides of the opinion as possible. For voter guides to become a practical solution to the problem , the number being increased  would have to increase dramatically.</p>

<p>posted by <a rel="nofollow" href="http://blog.odonnell.nu/">Sean O'Donnell</a>
 on October 23, 2006 <a href="#c25" rel="bookmark">#</a></p>
</div>
<div id="c26">
<p>I’ll offer two counter-points:</p>

<p>1) Part of what makes news interesting is also what makes <em>Lost</em> and the Detroit Tigers interesting — it’s fun to talk about. That is, it’s conversationally fun to be aware of current events and develop hypotheses on their outcomes.</p>

<p>2) The book version of news seems to miss the point. News is a <em>process</em>, a narrative — not a finished complete product. That’s what makes it fun.</p>

<p>posted by <a rel="nofollow" href="http://www.fimoculous.com/">Rex</a>
 on October 24, 2006 <a href="#c26" rel="bookmark">#</a></p>
</div>
<div id="c27">
<p>Part of the Australian Yr 12 HSC English course is Representation of the Truth.
Most of the classwork is sitting around watching news and current affairs shows and discussing how they lied about what they just showed and who is influencing them. After doing that unit of work, we basically learned to question everything about the news anyway.</p>

<p>Thankfully, last Monday I finished english forever :P</p>

<p>posted by Duck
 on October 24, 2006 <a href="#c27" rel="bookmark">#</a></p>
</div>
<div id="c28">
<p>There’s a difference between News, information, and the Media. I have been cut off from the news for a year now since giving up TV. I was never  fond of newspapers, and I was generally tired of what was out there. My half full glass was emptied everytime I started reading or listening. The only thing I may regret about the experience is my inability to compete at Trivia Pursuit in a couple years.</p>

<p>posted by <a rel="nofollow" href="http://biggirlunderoos.blogspot.com/">Sassy Pants</a>
 on October 26, 2006 <a href="#c28" rel="bookmark">#</a></p>
</div>
<div id="c29">
<p>While I can’t agree with your proudly apathetic stance, I do think there’s a germ of truth to it - especially given the sad, sensationalistic nature of modern news.   As Ben Hecht said ”
“Trying to determine what is going on in the world by reading newspapers is like trying to tell the time by watching the second hand of a clock.”</p>

<p>posted by joseph
 on October 27, 2006 <a href="#c29" rel="bookmark">#</a></p>
</div>
<div id="c30">
<p>While I can’t agree with your proudly apathetic stance, I do think there’s a germ of truth to it - especially given the sad, sensationalistic nature of modern news.   As Ben Hecht said ”
“Trying to determine what is going on in the world by reading newspapers is like trying to tell the time by watching the second hand of a clock.”</p>

<p>posted by joseph
 on October 27, 2006 <a href="#c30" rel="bookmark">#</a></p>
</div>
<div id="c31">
<p>More news, not less. More sources, not less. More choice, not less. More often, not less. You’re either open or closed, dynamic or static, moving or still. Alive or dead.</p>

<p>News is not about citizenship, it’s about survival.</p>

<p>posted by <a rel="nofollow" href="http://www.niallflaherty.com/">Niall</a>
 on October 28, 2006 <a href="#c31" rel="bookmark">#</a></p>
</div>
<div id="c32">
<p>Hi Aaron,</p>

<p>You asked “when do you care about what is just about to happen?”</p>

<p>Well, sometimes you do. If you retro-analyse attacks on civil liberties or other changes that can impact on our lives, you can probably find a pattern of signals in prior coverage. If you live in Iran, you presumably read the evil empire’s statements about Iranian nuclear technology very closely, as they could mean the difference between living a normal life and being bombed back to the stone age. There are many more examples I can think of, some too personal to relate here, where a better news radar could have saved peoples’ lives if they knew when to get out of a particular place or situation.</p>

<p>Also, perhaps when you have expended your entrepreneurial energies inventing things and starting companies, you might end up holding stock in the companies that buy your ventures ;-) In that case, you may want to track the news to find out what is about to happen.</p>

<p>Anyway - it’s all RSS these days. Just write an early warning algorithm based on text analysis and get a nabaztag bunny to notify you when to pack your bags and get the hell out of Dodge ;-)</p>

<p>posted by <a rel="nofollow" href="http://www.headshift.com/">Lee Bryant</a>
 on October 28, 2006 <a href="#c32" rel="bookmark">#</a></p>
</div>
<div id="c47">
<p>Great article! I’ve written something similar a few months ago (in my native, non-english language), was published and got similar responses as you. It seems people defend their daily news habit as if it was sacred. ;)</p>

<p>posted by Mark
 on April 17, 2007 <a href="#c47" rel="bookmark">#</a></p>
</div>
<div id="c48">
<p>The unexamined life is not worth living.  Examination shows that conventional news isn’t worthwhile.  So throw it out.  I don’t understand what’s the big deal with this, I guess I throw out lots of things like “news” and it doesn’t seem particularly remarkable, it seems quite normal.  Is the point here to produce a diff list of what people who examine their lives do differently from what people who don’t examine their lives do?  (Although arguably even people who “don’t examine their lives” probably do examine their lives and are happy with them!)  In any case, that diff list would be a pretty cool list, I’d like to see that.</p>

<p>posted by <a rel="nofollow" href="http://www.connellybarnes.com/">Connelly Barnes</a>
 on May 10, 2007 <a href="#c48" rel="bookmark">#</a></p>
</div>
<div id="c49">
<p>Miscellaneous list of other things to reject: Mocking the right brain, doing pretty much anything our culture implores such as worshiping individuals, working, acting rationally, pretending to support something and then acting contrarily (for example, people pretend to support community and then buy books, movies, software, etc), pretending that the public is idiotic while contributing nothing other than deploring the public’s idiocy and endlessly discussing events which one considers idiotic, leaving no exit from “idiocy,” acting as a type, dishonesty, quoting or repeating things ad verbatim rather than thinking for oneself, discouraging others from thinking or creating of themselves by being excessively critical and holding all works to the same “standard,” discouraging others from experimenting even in ways that appear to be stupid.  These are all just based on what Noam Chomsky called the minimal plausible rule of ethics, the “rule of the Gospels:” do unto others as you would have others do unto you.  Of course one could go further if one was inclined.  And I’m not saying that any of these are necessary, they’re just things that I tend to do because I feel uncomfortable when I’m excessively hypocritical.</p>

<p>posted by <a rel="nofollow" href="http://www.connellybarnes.com/">Connelly Barnes</a>
 on May 11, 2007 <a href="#c49" rel="bookmark">#</a></p>
</div>
<div id="c62">
<p>I agree with everything you said. I hate when all my family can talk about at the dinner table is the shit they read in the newspaper today or heard on CNN. I just want to yell out, “Why do you give a shit? How does it effect you? How is it relevant to your life?”</p>

<p>Earlier this year during the dreadful, nonstop coverage of the rebellions in the middle east, my class was having a long, drawn out discussion on the topic. I couldn’t take it anymore so I raised my hand and said, “excuse me, but why do you guys care so much about this? how does it effect your lives in any way? If you didn’t hear about it on the radio or watch it on TV, you wouldn’t even know it was happening, and it would have the same effect on your life: absolutely none whatsoever.” Of course, I was attacked by everyone in the classroom and was basically labeled an uncaring, heartless ignoramus.</p>

<p>Such is the way of the world…</p>

<p>posted by gimmedatsammich
 on June 24, 2011 <a href="#c62" rel="bookmark">#</a></p>
</div>

<p>You can also <a href="mailto:weblog@aaronsw.com">send comments by email</a>.</p> 




</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How many people have ever lived on Earth? (104 pts)]]></title>
            <link>https://www.prb.org/articles/how-many-people-have-ever-lived-on-earth/</link>
            <guid>36593206</guid>
            <pubDate>Tue, 04 Jul 2023 22:16:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.prb.org/articles/how-many-people-have-ever-lived-on-earth/">https://www.prb.org/articles/how-many-people-have-ever-lived-on-earth/</a>, See on <a href="https://news.ycombinator.com/item?id=36593206">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hide="">
					<p>In any case, life was short. Life expectancy at birth probably averaged only about 10 years for most of human history. Average life expectancy in Iron Age France (from 800 B.C.E. to about 100 C.E.) has been estimated at only 10 or 12 years. Under these conditions, the birth rate would have to be about 80 live births per 1,000 people just for the species to survive. To put that in perspective, a high birth rate today is about 35 to 45 live births per 1,000 population, and it is observed in only some sub-Saharan African countries.</p>
<p>These short life expectancies mean that the human population had a hard time increasing. One estimate of the population of the Roman Empire, spanning Spain to Asia Minor, in 14 C.E. is 45 million. Other historians, however, set the figure twice as high, suggesting how imprecise population estimates of early historical periods can be.</p>
<p>By 1650, the world’s population rose to about 500 million—not a large increase from the estimate of 300 million in 1 C.E. The average annual rate of growth was actually lower in this period than the rate suggested for 8000 B.C.E. to 1 C.E. One reason for the unusually slower growth was the Black Death. This dreaded plague was not limited to 14th-century Europe but may have begun in western Asia in about 542 C.E. and spread from there. Experts believe that half the Byzantine Empire was destroyed by plague in the sixth century, a total of 100 million deaths. Such large fluctuations in population size over long periods greatly compound the difficulty of estimating the number of people who have ever lived.</p>
<p>By 1800, however, the world population passed the 1 billion mark and has since continued to grow to its current 8 billion (our most recent estimate as of 2022). This growth is driven in large part by advances in public health, medicine, and nutrition that have lowered death rates, allowing more people to live far into their reproductive years.<strong>&nbsp;</strong></p>
<h2>Assumptions Help Us Estimate Human Population History</h2>
<p>Guesstimating the number of people ever born requires determining population sizes for different points in human prehistory and history and applying assumed birth rates to each period. We start at the very, very beginning—with just two people (a minimalist approach!). Although it is unlikely that humans descended from two people, this approach simplifies our estimation.</p>
<p>One complicating factor is the pattern of population growth. Did it rise to some level and then fluctuate wildly in response to famines and changes in climate? Or did it grow at a constant rate? We cannot know the answers to these questions, although paleontologists have produced a variety of theories. For the purposes of this exercise, we assumed a constant growth rate applied to each period up to modern times. Birth rates were set at 80 per 1,000 population annually through 1 C.E. and at 60 per 1,000 from 2 C.E. to 1750. Rates then declined to below the 20s by the modern period (see Table 1).</p>
<p>This semi-scientific approach yields an estimate of about 117 billion births since the dawn of modern humankind. Clearly, the period 190,000 B.C.E. to 1 C.E. is key to our estimate but, unfortunately, little is known about that era’s population size. If we were to challenge our conclusion at all, it might be that our method underestimates the number of births to some degree. The assumption of constant rather than highly fluctuating population growth in the earlier period may underestimate the average population size at the time.</p>
<h2>We Account for a Large Percentage of People Who Have Ever Lived</h2>
<p>Given a current global population of about 8 billion, the estimated 117 billion total births means that those alive in 2022 represent nearly 7% of the total number of people&nbsp; who have ever lived (see Table 2). Because we have existed on Earth for approximately 200,000 years, that’s actually a fairly large percentage.</p>

<h5>TABLE 2. Snapshot of Population History</h5>
<table>
<tbody>
<tr>
<td>Estimated number of people ever born</td>
<td>117,020,448,575</td>
</tr>
<tr>
<td>World population in mid-2022</td>
<td>7,963,000,000</td>
</tr>
<tr>
<td>Percentage of those ever born who are living in 2022</td>
<td>6.8</td>
</tr>
</tbody>
</table>
									</div><div data-hide="">
					<p>As new archaeological discoveries are made and analyzed using increasingly innovative methods, our understanding of human population history will likely expand further, allowing us to improve on this ever-intriguing proposition!</p>

<hr>
<h3>Featured Resources</h3>
									</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Bottles – Easily run Windows software on Linux (294 pts)]]></title>
            <link>https://usebottles.com/</link>
            <guid>36592930</guid>
            <pubDate>Tue, 04 Jul 2023 21:47:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://usebottles.com/">https://usebottles.com/</a>, See on <a href="https://news.ycombinator.com/item?id=36592930">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><a rel="me" href="https://mastodon.online/@usebottles">


</a><section><a rel="me" href="https://mastodon.online/@usebottles">
</a>
</section>
<div>
<div>
<h2>Gaming <u>ready</u></h2>
<p>Bottles' Gaming Environment comes preconfigured to support a large set of Windows video games on Linux.</p>
<p>Thanks to our <span>installers</span> you can have immediate access to the most famous game stores (e.g. Epic Games Store,
EA Launcher, Battle.net etc.) and then play your favorite games, just like on Windows.</p>
<p><a href="https://usebottles.com/gaming">
More about</a>
</p></div>
<p><img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-gaming.png">
<img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-gaming-dark.png">
</p></div>
<div>
<div>
<h2>Empowered by <u>environments</u></h2>
<p>Bottles introduces a new way to handle Windows prefixes using
environments, a combination of ready-to-use settings, libraries and
dependencies.</p>
<p>Choose between <span>Gaming</span> and
<span>Software</span> environment based on the type of
software you want to start.</p>
<p>More advanced users can choose the <span>Custom</span>
environment to configure the bottle on their own.</p>
<p><a href="https://docs.usebottles.com/getting-started/environments">
More about</a>
</p></div>
<p><img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-environments.png">
<img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-environments-dark.png">
</p></div>
<div>
<div>
<h2>Highly <u>tweakable</u></h2>
<p>Customize your Windows environment with ease.</p>
<p>Choose whether to use dxvk, vkd3d, gamemode, esync, fsync or other,
Bottles will handle it all for you.</p>
<p>Change runners on the fly or install new ones for all your tests.</p>
<p><a href="https://docs.usebottles.com/bottles/preferences">
More about</a>
</p></div>
<p><img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-customizable.png">
<img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-customizable-dark.png">
</p></div>
<div>
<div>
<h2>Integrated <u>dependency manager</u></h2>
<p>Windows software need dependencies to work properly.</p>
<p>Bottles comes with a powerful and easy-to-use dependency manager that
automates this task.</p>
<p>Just look for the package you need and then "install", Bottles will
take care of everything for you.</p>
<p><a href="https://docs.usebottles.com/bottles/dependencies">
More about</a>
</p></div>
<p><img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-dependencies-manager.png">
<img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-dependencies-manager-dark.png">
</p></div>
<div>
<div>
<h2>Install programs <u>in one click</u><span>New</span></h2>
<p>Installers (introduced in 2022.2.14) are an easy way to install games
and applications into your bottles.</p>
<p>Installers are instruction sets written by our community, which
automate the entire dependency setup and installation process. You
won't have to worry about anything anymore.</p>
<p><a href="https://docs.usebottles.com/bottles/installers">
More about</a>
<a href="https://usebottles.com/appstore">
Apps</a>
</p></div>
<p><img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-installers.png">
<img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-installers-dark.png">
</p></div>
<div>
<div>
<h2>Easy <u>to restore</u></h2>
<p>The Snapshots manager allows you to easily restore a previous state
of your bottle.</p>
<p>If enabled, Bottles will automatically create a new snapshot when you
install a new dependency.</p>
<p>If something goes wrong, go to the Snapshots section of your bottle
and restore the previous state.</p>
<p><a href="https://docs.usebottles.com/bottles/versioning">
More about</a>
</p></div>
<p><img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-versioning.png">
<img alt="Bottles highly customisable" src="https://usebottles.com/uploads/bottles-versioning-dark.png">
</p></div>
<div>
<h2>
<ion-icon name="shield-checkmark-outline"></ion-icon>
Safe. <u>Sandboxed.</u>
</h2>
<p>Your bottles are isolated from the system and will only hit your
personal files when you decide.</p>
<p>The full-sandbox is provided and pre-configured only using the
<a href="https://flathub.org/apps/details/com.usebottles.bottles">
Flatpak package</a> (highly recommended).</p>
<p>All other packages still have access to the partial sandbox which
isolates the bottle files and prevents them from accessing your
homedir.</p>
<p><a href="https://docs.usebottles.com/flatpak/expose-directories">
More about</a>
</p></div>
<div>
<h2>Sponsors</h2>

<p>Plus all the donations from the awesome users who support Bottles!</p>
<p><a href="https://usebottles.com/funding/">
Show more</a>
</p></div>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[LXD is now under Canonical (206 pts)]]></title>
            <link>https://linuxcontainers.org/lxd/</link>
            <guid>36592343</guid>
            <pubDate>Tue, 04 Jul 2023 20:48:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://linuxcontainers.org/lxd/">https://linuxcontainers.org/lxd/</a>, See on <a href="https://news.ycombinator.com/item?id=36592343">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main-content">
            <h2 id="lxd-is-now-under-canonical">LXD is now under Canonical<a href="#lxd-is-now-under-canonical" title="Permanent link">¶</a></h2>
<p>The LXD project is no longer part of the LinuxContainers project but can now be found directly on Canonical's websites.</p>
<p>Website: <a href="https://ubuntu.com/lxd">https://ubuntu.com/lxd</a><br>
Github: <a href="https://github.com/canonical/lxd">https://github.com/canonical/lxd</a><br>
Forum: <a href="https://discourse.ubuntu.com/c/lxd/">https://discourse.ubuntu.com/c/lxd/</a><br>
Documentation: <a href="https://documentation.ubuntu.com/lxd/">https://documentation.ubuntu.com/lxd/</a></p>
<h2 id="project-announcement">Project announcement<a href="#project-announcement" title="Permanent link">¶</a></h2>
<p>Date: 4th of July 2023</p>
<p>Hello,</p>
<p>Canonical, the creator and main contributor of the LXD project has decided that after over 8 years as part of the Linux Containers community, the project would now be better served directly under Canonical’s own set of projects.</p>
<p>While the team behind Linux Containers regrets that decision and will be missing LXD as one of its projects, it does respect Canonical’s decision and is now in the process of moving the project over.</p>
<p>Concretely, the expected changes are:</p>
<ul>
<li><a href="https://github.com/lxc/lxd">https://github.com/lxc/lxd</a> will now become <a href="https://github.com/canonical/lxd">https://github.com/canonical/lxd</a></li>
<li><a href="https://linuxcontainers.org/lxd">https://linuxcontainers.org/lxd</a> will disappear and be replaced with a mention directing users to <a href="https://canonical.com/lxd">https://ubuntu.com/lxd</a></li>
<li>The LXD YouTube channel will be handed over to the Canonical team</li>
<li>The LXD section on the LinuxContainers community forum will slowly be sunset in favor of the Ubuntu Discourse forum run by Canonical</li>
<li>The LXD CI infrastructure will be moved under Canonical’s care</li>
<li>Image building for Linux Containers will no longer be relying on systems provided by Canonical, limiting image building to <code>x86_64</code> and <code>aarch64</code>.</li>
</ul>
<p>What will not be changing:</p>
<ul>
<li>The rest of the Linux Containers projects remain unaffected</li>
<li>The image server, currently used by both LXC and LXD will keep operating as normal, though with less architectures available as mentioned above</li>
</ul>
<p>Those changes will likely all happen pretty rapidly as everything is relatively tightly integrated together. As a result, you may notice a bit of bumpiness while Canonical sets up the replacement infrastructure.</p>
<p>Sincerely,</p>
<p>The Linux Containers team</p>
<p>&nbsp;&nbsp;  Christian Brauner<br>
&nbsp;&nbsp;  Serge Hallyn<br>
&nbsp;&nbsp;  Stéphane Graber</p>
        </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[“How is your thesis going?” Students’ perspectives on mental health and stress (114 pts)]]></title>
            <link>https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0288103</link>
            <guid>36592033</guid>
            <pubDate>Tue, 04 Jul 2023 20:20:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0288103">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0288103</a>, See on <a href="https://news.ycombinator.com/item?id=36592033">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main-content">

<header>





<ul id="almSignposts">
  <li id="loadingMetrics">
    <p>Loading metrics</p>
  </li>
</ul>







    <div>
  <p id="licenseShort">Open Access</p>
  <p id="peerReviewed">Peer-reviewed</p>

<p id="artType">Research Article</p>


</div>
    <div>



<div>
  

<ul data-js-tooltip="tooltip_container" id="author-list">



<li data-js-tooltip="tooltip_trigger">
       
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="1">
Anna Bareis,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="2">
Moritz Bross,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="3">
Zoé Bürger,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="4">
Álvaro Cortés Rodríguez,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="5">
Nina Effenberger,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="6">
Markus Kleinhansl,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="7">
Fabienne Kremer,</a>    
</li>

<li data-js-tooltip="tooltip_trigger">
   <a data-author-id="8">
Cornelius Schröder</a>    
</li>

</ul>


</div>


<div id="floatTitleTop" data-js-floater="title_author" role="presentation">
    <div>
      <h2><!--?xml version="1.0" encoding="UTF-8"?-->“How is your thesis going?”–Ph.D. students’ perspectives on mental health and stress in academia</h2>

<ul id="floatAuthorList" data-js-floater="floated_authors">

  <li data-float-index="1">Julian Friedrich,&nbsp;

  </li>
  <li data-float-index="2">Anna Bareis,&nbsp;

  </li>
  <li data-float-index="3">Moritz Bross,&nbsp;

  </li>
  <li data-float-index="4">Zoé Bürger,&nbsp;

  </li>
  <li data-float-index="5">Álvaro Cortés Rodríguez,&nbsp;

  </li>
  <li data-float-index="6">Nina Effenberger,&nbsp;

  </li>
  <li data-float-index="7">Markus Kleinhansl,&nbsp;

  </li>
  <li data-float-index="8">Fabienne Kremer,&nbsp;

  </li>
  <li data-float-index="9">Cornelius Schröder

  </li>

</ul>



    </div>
    <div id="titleTopCloser">
      <p><img src="https://journals.plos.org/resource/img/logo-plos.png" alt="PLOS"></p><p>x</p>
    </div>
  </div>

      <ul>
        <li id="artPubDate">Published: July 3, 2023</li>
        <li id="artDoi">
<a href="https://doi.org/10.1371/journal.pone.0288103">https://doi.org/10.1371/journal.pone.0288103</a>
        </li>
        <li></li>
      </ul>

    </div>
  
</header>
  <div>






<div id="figure-carousel-section">
  <h2>Figures</h2>

  
</div>





        <div id="artText">
          



<div xmlns:plos="http://plos.org"><h2>Abstract</h2><div><p>Mental health issues among Ph.D. students are prevalent and on the rise, with multiple studies showing that Ph.D. students are more likely to experience symptoms of mental health-related issues than the general population. However, the data is still sparse. This study aims to investigate the mental health of 589 Ph.D. students at a public university in Germany using a mixed quantitative and qualitative approach. We administered a web-based self-report questionnaire to gather data on the mental health status, investigated mental illnesses such as depression and anxiety, and potential areas for improvement of the mental health and well-being of Ph.D. students. Our results revealed that one-third of the participants were above the cut-off for depression and that factors such as perceived stress and self-doubt were prominent predictors of the mental health status of Ph.D. students. Additionally, we found job insecurity and low job satisfaction to be predictors of stress and anxiety. Many participants in our study reported working more than full-time while being employed part-time. Importantly, deficient supervision was found to have a negative effect on Ph.D. students’ mental health. The study’s results are in line with those of earlier investigations of mental health in academia, which likewise reveal significant levels of depression and anxiety among Ph.D. students. Overall, the findings provide a greater knowledge of the underlying reasons and potential interventions required for advancing the mental health problems experienced by Ph.D. students. The results of this research can guide the development of effective strategies to support the mental health of Ph.D. students.</p>
</div></div>


<div xmlns:plos="http://plos.org"><p><strong>Citation: </strong>Friedrich J, Bareis A, Bross M, Bürger Z, Cortés Rodríguez Á, Effenberger N, et al.  (2023) “How is your thesis going?”–Ph.D. students’ perspectives on mental health and stress in academia. PLoS ONE 18(7):
           e0288103.
        
        https://doi.org/10.1371/journal.pone.0288103</p><p><strong>Editor: </strong>Khader Ahmad Almhdawi, Jordan University of Science and Technology Faculty of Applied Medical Science, JORDAN</p><p><strong>Received: </strong>March 23, 2023; <strong>Accepted: </strong>June 20, 2023; <strong>Published: </strong> July 3, 2023</p><p><strong>Copyright: </strong> © 2023 Friedrich et al. This is an open access article distributed under the terms of the <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</a>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</p><p><strong>Data Availability: </strong>The anonymized data set is available at <a href="https://doi.org/10.23668/psycharchives.12914">https://doi.org/10.23668/psycharchives.12914</a>. All code for the analysis can be found at <a href="https://github.com/coschroeder/mental_health_analysis">https://github.com/coschroeder/mental_health_analysis</a>.</p><p><strong>Funding: </strong>We acknowledge support by the Open Access Publishing Fund of University of Tübingen. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p><p><strong>Competing interests: </strong> The authors have declared that no competing interests exist.</p></div>





<div xmlns:plos="http://plos.org" id="section1"><h2>Introduction</h2><p>Work situations can be demanding and have a profound influence on employees’ mental health and well-being across different sectors and disciplines [<a href="#pone.0288103.ref001">1</a>]. Multiple studies show that the mental health status of people working in academia and especially that of Ph.D. students seems to be particularly detrimental when compared to the public [e.g., <a href="#pone.0288103.ref002">2</a>,<a href="#pone.0288103.ref003">3</a>]. Disorders such as anxiety and depression are on the rise in the general population [<a href="#pone.0288103.ref004">4</a>,<a href="#pone.0288103.ref005">5</a>]. Multiple studies show that this is even more severe in academia [<a href="#pone.0288103.ref006">6</a>–<a href="#pone.0288103.ref010">10</a>] and in particular Ph.D. students are affected by mental health problems [<a href="#pone.0288103.ref011">11</a>,<a href="#pone.0288103.ref012">12</a>]. Worldwide surveys grant support for Ph.D. students’ suboptimal and alarming mental health situations [<a href="#pone.0288103.ref013">13</a>,<a href="#pone.0288103.ref014">14</a>].</p>
<p>A comprehensive study with more than 2000 participants (90% Ph.D. students, 10% Master students) from over 200 institutions across different countries showed that graduate students were more than six times more likely to experience symptoms of depression and anxiety than the general public [<a href="#pone.0288103.ref002">2</a>]. Furthermore, a global-scale meta-analysis [<a href="#pone.0288103.ref003">3</a>] and several other studies concerned with the mental health of Ph.D. students in different countries, e.g., the United States [<a href="#pone.0288103.ref007">7</a>,<a href="#pone.0288103.ref009">9</a>], the United Kingdom [<a href="#pone.0288103.ref006">6</a>], France [<a href="#pone.0288103.ref015">15</a>], Poland [<a href="#pone.0288103.ref008">8</a>], Belgium [<a href="#pone.0288103.ref016">16</a>] or Germany [<a href="#pone.0288103.ref011">11</a>,<a href="#pone.0288103.ref012">12</a>] voice concerns about the mental health situation of Ph.D. students. Recent research conducted in Belgium has consistently found a higher prevalence of mental health problems among Ph.D. students compared to different groups of other highly educated individuals [<a href="#pone.0288103.ref016">16</a>]. In the same study, 50% of the Ph.D. students reported that they suffer from some form of mental health problem, and every third is at risk of a common psychiatric disorder [<a href="#pone.0288103.ref016">16</a>]. A similar picture is forming in Germany. For example, the prevalence of at least moderate depression among doctoral researchers at the Max Planck Society, one of the biggest academic societies in Germany, was between 9.6% and 11.6% higher than in the age-related general population [<a href="#pone.0288103.ref011">11</a>].</p>

<div id="section1"><h3>Increasing numbers of anxiety and depression among Ph.D. students</h3>
<p>Recent studies describe not only a high prevalence but also a rising tendency of mental health issues among Ph.D. students. In a study from 2017, 12% of the respondents reported seeking help for depression or anxiety related to their Ph.D. [<a href="#pone.0288103.ref013">13</a>], while in 2019, the result was even more drastic, as 36% of the respondents reported that having searched for help for those same reasons [<a href="#pone.0288103.ref014">14</a>]. Several studies among doctoral researchers within the Max Planck Society show similar results. For instance, a survey in 2019 showed that the average of the Ph.D. students were at risk for an anxiety disorder and another sample from 2020 provided even more robust support for this claim [<a href="#pone.0288103.ref011">11</a>,<a href="#pone.0288103.ref012">12</a>]. Furthermore, the mean depression score increased from 2019 to 2020 in both samples [<a href="#pone.0288103.ref011">11</a>].</p>
</div>

<div id="section2"><h3>Risk factors and resources</h3>
<p>Given these alarming statistics, several studies addressed risks and resources for increased mental health issues. Other studies have revealed that gender, perceived work-life balance, and mentorship quality are correlated with mental health issues [<a href="#pone.0288103.ref002">2</a>,<a href="#pone.0288103.ref017">17</a>]. Specifically, female gender [<a href="#pone.0288103.ref017">17</a>] and transgender/gender-nonconforming Ph.D. students are, on average, more likely to suffer from mental health issues [<a href="#pone.0288103.ref002">2</a>]. In contrast, a positive and supportive mentoring relationship or a supervisor’s leadership style, and a good work-life balance are positively associated with better mental health [<a href="#pone.0288103.ref002">2</a>,<a href="#pone.0288103.ref016">16</a>]. While some authors [<a href="#pone.0288103.ref018">18</a>] reported a negative correlation between the Ph.D. stage and mental health, with students at later stages disclosing greater levels of distress, others [<a href="#pone.0288103.ref016">16</a>] did not find significant differences in this regard. Moreover, another report identified that Ph.D. students’ satisfaction levels strongly correlate with their relationship with their supervisors, number of publications, hours worked, and received guidance from advisors [<a href="#pone.0288103.ref019">19</a>]. Furthermore, several studies showed a positive correlation between job satisfaction [<a href="#pone.0288103.ref020">20</a>,<a href="#pone.0288103.ref021">21</a>] as well as a negative correlation between job insecurity [<a href="#pone.0288103.ref022">22</a>] and mental health or perceived stress, also in Ph.D. students.</p>
</div>

<div id="section3"><h3>Aim and research questions</h3>
<p>Taken together, the alarming findings on the psychological status of Ph.D. students around the globe cannot be denied. However, data on the situation of Ph.D. students in Germany are scarce [<a href="#pone.0288103.ref011">11</a>,<a href="#pone.0288103.ref012">12</a>,<a href="#pone.0288103.ref023">23</a>]; thus, comparisons of different universities within a country can hardly be made. However, addressing those differences is particularly relevant since the working conditions, concerning contract types, financial situations or supervision vary strongly among different countries, geographical regions and universities or institutions [<a href="#pone.0288103.ref024">24</a>]. Furthermore, little is known about the reasons for this precarious situation and where exactly the need for action lies [<a href="#pone.0288103.ref025">25</a>]. Therefore, the aim of this study was to conduct a survey among Ph.D. students at a university in the southwest of Germany to assess Ph.D. students’ mental health status. Additionally, the present study also reveals information on the extent of the need for additional support services and pinpoints the specific areas where these services ought to be emphasized. In order to help identify relevant indicators, this investigation provides empirically sound findings on the mental health situation of Ph.D. students in Germany.</p>
</div>
</div>

<div xmlns:plos="http://plos.org" id="section2"><h2>Materials and methods</h2>
<div id="section1"><h3>Sample and procedure</h3>
<p>Overall, 589 participants (60.3% female, 0.8% of diverse gender, <em>M</em><sub>Age</sub> = 28.8, <em>SD</em><sub>Age</sub> = 3.48, range 17–48 years) out of a total of enrolled 2552 Ph.D. students (response rate: 23.1%; actual numbers of Ph.D. students at the University of Tübingen higher as some Ph.D. students are not enrolled) took part in an online survey from October to December 2021. Instructions, items, and scales were all presented in English. Participants could answer the open questions in German or English and were comprised of Ph.D. students across various stages of their Ph.D. at the University of Tübingen without further exclusion criteria. The online questionnaire was sent to Ph.D. students’ email addresses via mailing distribution lists in cooperation with the central institution for strategic researcher development (Graduate Academy) of the University of Tübingen and with Ph.D. representatives of different faculties. Ethics approval was obtained by the “Ethics Committee of the Faculty of Economics and Social Science of the University of Tübingen” and written informed consent was given by the participants.</p>
<p>The distribution of faculty affiliation of the participants was heterogeneous with shares of 61.8% Science, 12.4% Humanities, 11.7% Economics and Social Sciences. These numbers reflect the different sizes of faculties and are roughly aligned with the relative numbers of students (41.7% Science, 24.8% Medicine, 16.2% Humanities, 7.5% Economics and Social Sciences), with a clear underrepresentation of the Medical Faculty. Faculties with less than 20 participants or participants with multiple answers were grouped into one category for further analysis (Others 14.1%, see <a href="#pone.0288103.s001">S1 Table</a>). 67.9% of the participants were German and in total, 82.9% came from European countries. During data collection, the participants were at different stages of their Ph.D. ranging from 0 to over 130 months with a mean time of two and a half years (30.0 months) of Ph.D. progress.</p>
</div>

<div id="section2"><h3>Measures</h3>
<p>First, demographic data and background information on the current Ph.D. situation were collected. In a second part, to get a differentiated view, we included different measures to operationalize the mental health status of Ph.D. students. The quantitative questionnaire assessed 1) general health, generalized anxiety disorder, as well as internally reviewed self-generated questions, 2) life and job satisfaction, and quantitative job insecurity, and 3) stressors (institutional and systemic), causes of stress and potential solutions. This study also collected information regarding the degree of participants’ familiarity with the mental health resources available at the university, e.g., points of contacts for counseling, in order to evaluate whether Ph.D. students make use of these services. Moreover, participants were asked to name additional services that they may consider necessary.</p>

<div id="section1"><h4>General health and stressors.</h4><p>General health was assessed by two items of the Perceived Health Questionnaire (PHQ-2) [<a href="#pone.0288103.ref026">26</a>]. Participants were asked to indicate how frequently they had experienced depressed moods and anhedonia over the past four weeks on a scale from 1 (not at all) to 4 (nearly every day). Additionally, they were presented with seven items of the Generalized Anxiety Disorder scale (GAD-7) [<a href="#pone.0288103.ref027">27</a>] capturing the severity of various anxiety signs like nervousness, restlessness, and easy irritation on a scale from 1 (not at all) to 4 (nearly every day). Both scales were used in this combination in a previous study in German higher education [<a href="#pone.0288103.ref028">28</a>]. Furthermore, we included two binary questions on whether the participants are currently in psychotherapy and if they have ever been diagnosed with a mental disorder.</p>
<p>The condensed version of the Perceived Stress Scale (PSS) [<a href="#pone.0288103.ref029">29</a>] was used to get the degree of stressful situations in life in the last twelve months or since the start of the Ph.D. [<a href="#pone.0288103.ref030">30</a>]. The response scale ranged from 0 (never) to 4 (very often), the following being a sample item: “… how often have you felt that you were unable to control the important things in your life?” To check the internal consistency of the four items, we calculated Cronbach’s alpha which was .79.</p>
</div>

<div id="section2"><h4>Job satisfaction and life satisfaction.</h4><p>Three items on a scale from 1 (strongly disagree) to 5 (strongly agree) were used to measure job satisfaction [<a href="#pone.0288103.ref031">31</a>], where a higher mean score indicated higher job satisfaction. A sample item is: “I am satisfied with my job.” Cronbach’s alpha was .86. Additionally, we added one item concerning general life satisfaction [adapted from <a href="#pone.0288103.ref032">32</a>] with the same response categories to get a more holistic insight.</p>
</div>

<div id="section3"><h4>Job insecurity.</h4><p>To assess the fear of losing the job itself, quantitative job insecurity was measured with three items (e.g., “I am worried about having to leave my job before I would like to.”) [<a href="#pone.0288103.ref033">33</a>] on a scale from 1 (strongly disagree) to 5 (strongly agree). We calculated a mean score with higher scores indicating higher job insecurity. Cronbach’s alpha was .80.</p>
</div>

<div id="section4"><h4>Institutional and systemic stressors.</h4><p>For institutional stressors, we focused mainly on the role of supervision and included eight questions, four were framed using positive wording and four with negative wording, each with a scale from 1 (not at all) to 5 (all of the time). We summarized these questions in two constructs (positive support/negative support) which had Cronbach’s alphas of .85 and .76, respectively. As for systemic stressors, we included two questions on long-term contracts and on future perspectives, again using a scale from 1 (strongly disagree) to 5 (strongly agree).</p>
</div>

<div id="section5"><h4>COVID-19.</h4><p>To cover the potential impacts of the COVID-19 pandemic and the implemented regulations, we included two questions to evaluate whether the pandemic affected the students’ general situation. On the one hand, participants were asked to pick the statement that best describes the effects of the pandemic in general (“yes, it improved my general situation”, “yes, it worsened my general situation”, “yes, but it neither worsened nor improved my general situation”, “no”), and on the other hand, they were asked to evaluate whether the particular answers provided in this survey had been affected by the pandemic from 1 (very likely) to 5 (very unlikely).</p>
</div>
</div>

<div id="section3"><h3>Rating procedure and open answers</h3>

<div id="section1"><h4>Causes of stress and potential solutions.</h4><p>We included three open-ended questions in the questionnaire to get a deeper understanding of the perceived causes of stress, potential ways to improve mental health, and ways to improve the overall situation of Ph.D. students. The questions were: (1) “What is/are the cause(s) of your stress?” (2) “What would need to change to improve your mental health status?” (3) “What could be done to improve your situation?” Participants could mention as many points as they wanted (without any word limit). To analyze these questions, we built categories by following the model of inductive category development [<a href="#pone.0288103.ref034">34</a>]. Two raters screened the first and last 20 responses in the data set and created categories for reoccurring topics (for a list containing all categories see <a href="#pone.0288103.s005">S5</a>–<a href="#pone.0288103.s007">S7</a> Tables). In the next steps, two new raters rated all open answers with the developed categories and added additional categories if needed. Applicable categories were rated with 1 (“category was mentioned”) or 0 (“category was not mentioned”). For example, the following response to question (1) “[My] supervisor is on maternity leave with open end, i.e. I have no one to talk to about my topic and have almost nothing so far […] I feel like I’m not good enough at this, not sure I will be able to succeed–everyone else has other projects and publications except me–no topic-related network” was rated with 1 in the following four categories: supervision (quality &amp; quantity), social integration &amp; interactions (private &amp; professional), self-perception (internal factors), and perceived lack of relevant competences &amp; experience–(sense) of progress and success. The full list of categories and inter-rater reliability as measured by Krippendorf’s Alpha is reported in <a href="#pone-0288103-t003">Table 3</a> [<a href="#pone.0288103.ref035">35</a>].</p>
</div>
</div>
</div>

<div xmlns:plos="http://plos.org" id="section3"><h2>Results</h2>
<div id="section1"><h3>Descriptive statistics of work environment and workload</h3>
<p>The largest part of the participants (65.5%) was temporarily employed, 12.1% got a scholarship, 7.6% were permanently employed, and 6.5% were not employed at all. The mean for total contract length was 34.3 months, with a range between two and 72 months. About 10.5% of the participants had a contract for only 12 months or shorter. A similar large variation was found in the percentage of employment with a mean of 63%, ranging from 10% to 100% of employment. For workload, we found a mean of 36.0 hours of Ph.D.-related work per week with a standard deviation of 15.6 hours. After taking a closer look at high workloads, we found that 31.3% of the participants work 45 hours or more (21.5% work 50 hours and more) per week. On top of their Ph.D. work, many Ph.D. students work in other jobs, which combined with the hours spent for Ph.D.-related work, summed up to the mean of 44.1 overall working hours per week. A detailed description can be found in <a href="#pone.0288103.s001">S1 Table</a>.</p>
</div>

<div id="section2"><h3>Faculty-wise comparison</h3>
<p>In an explorative manner, we compared the mean differences of the most important variables between different faculties. Most of the analyzed variables did not show significant differences. Still, we want to stress that the highly imbalanced sample sizes (see <a href="#pone.0288103.s003">S3 Table</a>) could lead to false negative outcomes due to the small numbers of participants in some groups. However, we found that the mean job insecurity was significantly different between faculties (<em>p</em> &lt; .001, Kruskal-Wallis rank sum test) with comparable low job insecurity in the faculties of law (<em>M</em> = 2.10, <em>SD</em> = 1.22) and theology (<em>M</em> = 2.38, <em>SD</em> = 1.19) and high insecurity in the faculty of humanities (<em>M</em> = 3.32, <em>SD</em> = 0.91).</p>
</div>

<div id="section3"><h3>COVID-19</h3>
<p>In total, 41.9% of the participants stated that their general situation worsened due to the pandemic, while 28.5% stated that the pandemic affected but it neither worsened nor improved their general situation. 33.5% of the participants stated that their responses in this study were “very likely” or “likely” to be affected by the pandemic, with a mean of 2.97 (<em>SD</em> = 1.26).</p>
</div>

<div id="section4"><h3>General health and stressors</h3>
<p>The mean of the sum score for PHQ-2 in our study was 2.32 which is below the cut-off of three for major depression [<a href="#pone.0288103.ref026">26</a>]. Yet, 33.1% of the participants were above the cut-off. For the GAD-7, the sum score for the study’s sample was 8.49. Cut points of 5 might be interpreted as mild, cut points of 10 as moderate and 15 as severe levels of anxiety [<a href="#pone.0288103.ref027">27</a>], which implies a mild risk level for generalized anxiety with the suggestion of a follow-up examination in this sample. When asking for mental disorders, we found that 19.9% of the participants (<em>n</em> = 99) have already been diagnosed with a mental disorder and 15.5% (<em>n</em> = 77) are currently in psychotherapy. The sum score for the Perceived Stress Scale (PSS) of 7.79 (with <em>Min</em> = 0, <em>Max</em> = 15) was above the total sum score compared to a representative British sample (6.11) [<a href="#pone.0288103.ref036">36</a>] and a representative German community sample (4.79 for PSS-4) [<a href="#pone.0288103.ref037">37</a>]. Job satisfaction of our participants with a total sum score of 10.06 was lower compared to a sum score of 12.79 in a German sample of workers in small- and medium sized enterprises [<a href="#pone.0288103.ref038">38</a>]. The mean score for job satisfaction was 3.35, also lower than in a sample of Ph.D. students in Belgium (3.9) [<a href="#pone.0288103.ref039">39</a>]. Job insecurity was with a total sum score of 8.76 higher compared to the German small- and medium sized enterprises sample (5.67) [<a href="#pone.0288103.ref038">38</a>]. Consistently, more than 80% of the Ph.D. students in our study were worried about the lack of permanent or long-term contracts in academia (<em>M</em> = 4.25, <em>SD</em> = 1.09; 5 indicating a strong agreement). Nevertheless, around half of the participants (54.5%) believed that having a Ph.D. would help them find a good job (<em>M</em> = 3.49, <em>SD</em> = 0.97). We found a mean score of 3.48 (<em>SD</em> = 0.98) for the positive support questions which is above average over response levels. Around 57.1% of the Ph.D. students felt supported by their supervisor “most” or “all of the time”. Around 55.7% felt comfortable when contacting the supervisor for support. The negative support construct was with a mean score of 2.18 below average: 46.7% of the participants had never felt looked down, and 62.6% had never felt mistreated by their supervisor. Nevertheless, 28.6% of the Ph.D. students answered feelings of degradation and 19.1% felt mistreated more than “some of the time”. When it comes to the frequency of the meetings with the supervisor, the mean reported a value of 2.4 laying somewhere between having meetings once a month (2) and at least every three months (3). However, 18.2% reported meeting their supervisor only once every six months or less. For sample items and detailed values see <a href="#pone.0288103.s002">S2 Table</a>.</p>
<p>When we analyzed the relationship between the studied outcomes, we found that all major constructs correlated significantly (see <a href="#pone-0288103-t001">Table 1</a>). High correlations occurred between the items of the related PHQ-2 and GAD-7 as well as their connections to the PSS. Understandably, the two institutional support dimensions were highly correlated (<em>r</em> = -.69).</p>
</div>

<div id="section5"><h3>Regression for perceived stress, depression, and anxiety</h3>
<p>To predict potential driving factors for the two more direct mental health measurements, namely depression and anxiety, and for perceived stress, we employed linear regression models with these three constructs as response variables controlling for age and gender. We included relevant risk factors and stressors such as job insecurity, perceived stress, negative support and resources such as job and life satisfaction, and positive support to get a comprehensible overview over predictors. All analyses were carried out in R statistics version 4.1.3.</p>
<p>For depression, significant predictors were job satisfaction (β = -0.1, <em>SE</em> = 0.04, <em>p</em> &lt; .05), life satisfaction (β = -0.3, <em>SE</em> = 0.04, <em>p</em> &lt; .001), perceived stress (β = 0.4, <em>SE</em> = 0.05, <em>p</em> &lt; .001) and negative institutional support (β = 0.11, <em>SE</em> = 0.05, <em>p</em> &lt; .05, see <a href="#pone-0288103-t002">Table 2</a>). The model explained 46.7% of the variance, <em>F</em>(8, 482) = 54.5, <em>p</em> &lt; .01.</p>
<p>For anxiety, all studied variables except job satisfaction and positive support were significant predictors with a variance explanation of 36.0%, <em>F</em>(8, 392) = 29.5, <em>p</em> &lt; .01 (see <a href="#pone-0288103-t002">Table 2</a>). Noticeable was the strong influence of perceived stress on anxiety. Specifically, we observed that with an increase of one unit in perceived stress, the level of GAD-7 increased by 2.02 units and was in line with the high correlation (<em>r</em> = .52, <em>p</em> &lt; .01, <a href="#pone-0288103-t002">Table 2</a>).</p>
<p>For perceived stress, we found that job insecurity (β = 0.15, <em>SE</em> = 0.02, <em>p</em> &lt; .01), life satisfaction (β = -0.32, <em>SE</em> = 0.03, <em>p</em> &lt; .01) as well as negative institutional support (β = 0.13, <em>SE</em> = 0.04, <em>p</em> &lt; .01) were significant predictors with a model variance explanation of 42.7%, <em>F</em>(4, 486) = 53.5, <em>p</em> &lt; .01. The detailed results for this regression analysis can be found in <a href="#pone.0288103.s004">S4 Table</a>.</p>
</div>

<div id="section6"><h3>Qualitative answers</h3>
<p>In the following, we report the main categories with short sample quotes as well as the mean frequency of the two raters (see <a href="#pone-0288103-t003">Table 3</a>; details in <a href="#pone.0288103.s005">S5</a>–<a href="#pone.0288103.s007">S7</a> Tables). The inter-rater reliability as indicated by Krippendorff’s alpha for the top five categories of all questions was above α ≥ .67, except for the category <em>Manageable Workload</em> for question MH06_1 (see <a href="#pone-0288103-t003">Table 3</a>) with α = .62; CI [0.50; 0.74]. A threshold of .67 is commonly considered as the lower conceivable limit that still allows tentative conclusions [<a href="#pone.0288103.ref040">40</a>].</p>

<div id="section1"><h4>Causes of stress.</h4><p>The question “What is/are the cause(s) of your stress?” was answered by <em>n</em> = 446 participants. To cover the breadth of the responses, we built 18 categories. The most frequently mentioned categories were <em>Workload &amp; Time Pressure</em> (mean rating frequency = 211), <em>Self-Perception</em> (<em>M</em> = 132.5), <em>Job-Insecurity</em> (<em>M</em> = 93), <em>Social Integration &amp; Interactions</em> (<em>M</em> = 91), and <em>Supervision Quality &amp; Quantity</em> (<em>M</em> = 88.5). The category <em>Workload &amp; Time Pressure</em> includes all responses referring to the amount of work and/or deadlines. The category <em>Self-Perception</em> includes responses that indicate a perceived lack of competences or other personal doubts, concerns, and worries (e.g., “Since I started my Ph.D. I have almost constantly felt stupid”, “feeling like not belonging in academia, lack of self-confidence, feeling of making too little progress”). The category <em>Job Insecurity</em> reflects responses regarding contract length and general uncertainty about future employment (e.g., “scholarship is to be ended”, “Not knowing how things will work out after the PhD”, “Hopelessness of scientific career because there are too few full-time positions”). The category <em>Social Integration &amp; Interactions</em> covers responses regarding the integration and sense of belonging in the work environment (e.g., “not valued by colleagues”, “being socially isolated at work”) as well as social issues in the private life (e.g., “Mostly my personal life, or often the lack thereof”, “problems with parents”). The category <em>Supervision Quality &amp; Quantity</em> was used to capture all supervision-related responses including comments about the lack of support, feedback, frequency of meetings, or supervisors’ interest in the topics (e.g., “no clear communication with supervisor”, “lack of support from supervisor, even gossiping about me behind my back”).</p>
</div>

<div id="section2"><h4>Potential ways to improve the mental health status.</h4><p>When asked “What would need to change to improve your mental health status?”, the Ph.D. students’ responses (<em>n</em> = 307) included various topics, some addressing compensation and income-related aspects, others highlighting supportive supervision. Overall, the responses lead to twelve different categories. Most answers referred to <em>Supportive Supervision</em> (<em>M</em> = 98.5), followed by <em>Job Security/Contract</em> (<em>M</em> = 59). Sample quotes with respect to supervision are e.g., “more feedback from supervisor or even more interest in my topic” or “more regular support by supervisor”. The category <em>Job Security/Contract</em> contains comments with respect to contract length and aspects for future employment (e.g., “no more worries about not being able to get my contract renewed”). The category <em>Manageable Workload</em> (<em>M</em> = 56.5) includes all responses around work-life balance (e.g., “having also activities beside work”, “clear work hours”). The fourth category was <em>Compensation &amp; Financial Security</em> (<em>M</em> = 35) and included all income- and compensation-related aspects of the job (e.g., “Be paid 100% would be a start”, “Get paid for all the time at work”). The category <em>Less Additional Tasks</em> (<em>M</em> = 27.5) was used to specifically cover responses mentioning the number of additional tasks within the job (“Less work in teaching/work unrelated to PhD”).</p>
</div>

<div id="section3"><h4>Ways to improve the personal situation.</h4><p>In addition to the previous question, which focused on general ways to improve the mental health status, we asked the Ph.D. students the following question: “What could be done to improve your situation?” Based on the themes and topics mentioned in the responses (<em>n</em> = 281) we built eleven categories. The categories mentioned the most were <em>Job-Security &amp; Compensation</em> (<em>M</em> = 85.5), followed by <em>Supportive Supervision</em> (<em>M</em> = 68), <em>Services and Support System</em> (<em>M</em> = 39.5), <em>Decrease Pressure to Perform</em> (<em>M</em> = 39.5), and <em>Manageable Workload</em> (<em>M</em> = 36). The category <em>Job-Security &amp; Compensation</em> includes responses like “chances of getting a long-term job in academia, not just the three-year programs” or “Fair payment (half of students get 50% others 65% even at the same institute)”. For the category <em>Supportive Supervision</em> “Regular meetings with people who are supportive &amp; have an expertise in my research topic” can serve as a sample quote. The category <em>Services and Support System</em> was built to cover the responses named a solution outside the working group and team, such as “it would be helpful to see a university-based psychologist outside of the regular working hours” or “more courses (or better communications about them) about stress management”. The next category was labeled <em>Decrease Pressure to Perform</em> and included all responses that highlighted a high level of perceived pressure, such as “the performance pressure (every talk at a seminar is a job talk) is a big problem” or “Instead of pressuring academics to publish as much as possible, there should be more focus on the quality instead of the quantity of their articles/publication”. The last category, <em>Manageable Workload</em>, contained answers with respect to the amount of work (e.g., “Normal working hours, having really free-time without having the feeling that I should be working, it should be normal to take all vacation days”).</p>
</div>

<div id="section4"><h4>Summary of the qualitative answers.</h4><p>With respect to the open answers, it can be summarized that the factors named as causes for stress and the possible solutions cover a wide range of topics. However, there are reoccurring topics across all three questions, such as supervision, workload, and job security. The role of supervision is a reemerging motif in the qualitative content analysis. While the quality and quantity of supervision were seen as a cause of stress, supportive supervision has a positive impact on the mental health status as well as the whole situation of the Ph.D. students. Furthermore, job insecurity was mentioned as an important stressor, while stable contracts and appropriate compensation for the work and fewer extra tasks were also added for improvement. Workload and time pressure were the most often stated causes of stress, followed by self-doubts and worries about not having enough competencies for the job. A manageable workload, fewer additional tasks, and a lower pressure to perform were indicated by the participants as valuable improvements.</p>
</div>
</div>
</div>

<div xmlns:plos="http://plos.org" id="section4"><h2>Discussion</h2>
<div id="section1"><h3>Summary of the main findings</h3>
<p>The conducted survey investigates the mental health of Ph.D. students at a university in the southwest of Germany and gives insights into what causes stress and mental health disorders and where there is a need for further support services. Our qualitative and quantitative analyses revealed interesting and consistent results on the alarming situation of the mental health of Ph.D. students.</p>
<p>First, our quantitative results revealed that one-third of the participants were above the cut-off for depression which is an indicator of a high risk of depression that should be checked by a health professional. On average, the surveyed Ph.D. students were at a mild risk level for an anxiety disorder. While our study design does not allow us to diagnose mental illnesses, it identifies problems that need to be pursued further. It reveals some unhealthy working conditions and increased risks for mental illnesses. Our qualitative and quantitative results showed consistently that many of the most prominent issues for our study’s participants are personal factors such as perceived stress, life satisfaction and self-doubt, but modulated by structural deficits such as financial and job security as well as workload and time pressure. The quantitative analyses revealed that life satisfaction, perceived stress and negative support are the main predictors for anxiety disorders as well as depression. Additionally, low job satisfaction was a significant predictor of depression and job insecurity for anxiety. Furthermore, we identified job insecurity, life satisfaction as well as negative institutional support as predictors for perceived stress.</p>
<p>Second and besides mental health problems, our quantitative analyses showed how supervision and the work environment played a role in the mental health and general well-being of Ph.D. students. Deficient supervision could affect Ph.D. students’ perceived job insecurity and job dissatisfaction. Although good supervision was not a predictor for satisfaction, being comfortable with contacting the supervisor could lower the perceived stress. This shows the importance of the supervisor-student relationship and highlights the importance of the social work environment, which was also mentioned by study participants in the open-end questions. While the categories in the qualitative analyses mainly served to find recurring themes, they can also be used to distinguish between different levels. Some participants reflected causes of stress on a personal level (e.g., self-perception). In contrast, others set the focus on the supervisor level or working group level, or even on the more structural abstract level of the academic system.</p>
<p>Third, our study does not only investigate the mental health situation of Ph.D. students, but we also analyze how the situation and mental health status could be improved. Many suggestions were straightforward given the results of the causes of stress, i.e., bad supervision should be improved, and a secure income should be guaranteed. However, we were also able to show that Ph.D. students wish to make use of services and support systems that could be provided by the university. Furthermore, less pressure to perform and a manageable workload with fewer additional tasks besides the Ph.D. project might decrease the stress level and improve mental health status.</p>
<p>Overall, detrimental mental health is a known problem in academia, and we show another example of its extent as well as opportunities for improvement at a German university.</p>
</div>

<div id="section2"><h3>Comparison to other studies</h3>
<p>Data on Ph.D. students’ situation in Germany are scarce, and we, therefore, perform a broader comparison with Ph.D. students around the world. However, the results of this comparison should be taken with caution as our questionnaire and time of survey conduction are unique. We focus mainly on PHQ-2 [<a href="#pone.0288103.ref026">26</a>] and GAD-7 [<a href="#pone.0288103.ref027">27</a>], for which other studies in Germany during the pandemic showed that–compared to pre-COVID-19 reference values–these measurements were significantly increased [<a href="#pone.0288103.ref041">41</a>]. Two studies conducted during the COVID-19 pandemic include the same scales [<a href="#pone.0288103.ref041">41</a>,<a href="#pone.0288103.ref042">42</a>] and reveal similar results for the general population in Germany, while in our later study from October to December 2021, the risk for anxiety and depression is slightly higher. In our study, one-third of the participants (33.1%) was above the cut-off for major depression, compared to the studies in a 1.5-year earlier timeframe, where 14.1% (March to May 2020; <em>n</em> = 15704, 70.7% female gender; 42.6% university education) [<a href="#pone.0288103.ref042">42</a>] and 21.4% (March to July 2020; <em>n</em> = 16918; 69.7% female gender; 42.4% university education [<a href="#pone.0288103.ref041">41</a>] of the participants with diverse occupations were above the cut-off. Furthermore, in our study, 39.2% of the participants were at the mild risk level for anxiety compared to 27.4% of the participants in an earlier study [<a href="#pone.0288103.ref041">41</a>]. This shows the increase in depression and anxiety during the pandemic and even higher numbers in our study compared with the German general population. Nevertheless, compared to a survey at public research universities in the United States from May to July 2020, the number of doctoral students screened for major depressive disorder symptoms with the same measurements PHQ-2 was higher with 36% [<a href="#pone.0288103.ref043">43</a>], indicating high numbers of mental issues in academia in several countries.</p>
<p>While using the same scales and items for job satisfaction and job insecurity, our study showed worse sum scores compared to a sample of employers and employees in small- and medium sized enterprises in Germany (December 2020 to May 2021; <em>n</em> = 828; 53.7% female gender, <em>M</em> = 41.5 years; 38.8% higher education entrance qualification) [<a href="#pone.0288103.ref038">38</a>]. It seems that Ph.D. students have higher job insecurity and job dissatisfaction compared to workers in diverse branches and occupations. This may result from different contract types, as workers, especially in industrial sectors, have long-term contracts. The recurrent factor of time pressure and workload, also mentioned in the open-end questions, is backed up by the raw numbers of the contract types and working hours, which may also lead to job dissatisfaction. Although the mean contract type in our study is 63%, the mean number of hours dedicated to Ph.D. work (<em>M</em> = 36.0, <em>SD</em> = 15.6 hours) is almost in the range of a full-time position. What is more, the participants reported a total weekly workload (<em>M</em> = 44.1, <em>SD</em> = 11.4 hours) that exceeds a typical full-time position in Germany [<a href="#pone.0288103.ref044">44</a>]. The discrepancy between Ph.D. work and corresponding contract types results in a mean of 12.1 hours of overwork per week (based on a 38.5-hour full-time contract, which is the standard contract for Ph.D. students in Germany). This is in line with previous studies where the authors found a mean of 12.6 hours of overwork per week for Ph.D. students in Science, Technology, Engineering, and Mathematics disciplines in Germany [<a href="#pone.0288103.ref045">45</a>]. However, the authors did not include any further work obligations and corrected for contract types with low percentages, and thus the results are difficult to compare directly. Furthermore, we used gender as a control variable, which turned out to be statistically significant for anxiety and stress. This is in line with related work where the female gender was reported to be higher correlated with mental disorders [<a href="#pone.0288103.ref002">2</a>,<a href="#pone.0288103.ref017">17</a>,<a href="#pone.0288103.ref046">46</a>,<a href="#pone.0288103.ref047">47</a>].</p>
</div>

<div id="section3"><h3>Strengths and limitations</h3>

<div id="section1"><h4>Generalization.</h4><p>While we aimed for our study to reflect the current situation for Ph.D. students as best as possible, there are points that are limiting the generalization of the results or are beyond the scope of this survey. First, we collected the data between October and December 2021, a time at which the ordinance on protection against risks of infection with the SARS-CoV-2 virus (“Coronavirus-Schutzverordnung”) [<a href="#pone.0288103.ref048">48</a>] was still in place in Germany and influenced private and working life. About one-third (33.5%) of our study population stated that it is very likely or likely that the pandemic affected their answers. Nonetheless, a pandemic is a situation that can reoccur and is only one more reason to proactively set up a resilient Ph.D. graduation system. Another research group [<a href="#pone.0288103.ref049">49</a>] investigated how mental health care should change as a consequence of the COVID-19 pandemic and concluded that the pandemic could even be seen as a chance to improve mental health services [<a href="#pone.0288103.ref049">49</a>]. Nevertheless, we would like to point out that generalizing from a mental health study conducted during a pandemic may be difficult.</p>
<p>Overall, around 23% of all Ph.D. students at the University of Tübingen [<a href="#pone.0288103.ref050">50</a>] participated in our study, which is slightly below the response rate in other similar studies [e.g., <a href="#pone.0288103.ref016">16</a>]. Considering that university students are very frequently invited to various questionnaires and studies, and given that our survey lasted approximately 20 minutes, it can be argued that the participants were motivated to invest time into their responses. However, our study population remains small compared to the total number of Ph.D. students in Germany. Moreover, we want to emphasize the likely sample bias in our data. We recruited participants mainly via mailing lists and our project therefore probably has especially appealed to people who are already interested in health or aware of mental health issues. However, given our relatively large coverage of almost a quarter of all Ph.D. students at the University of Tübingen, even a selective sample can give us insights into overall tendencies. The transferability of our results to other German universities or even universities in other countries is also not guaranteed as the academic systems can largely differ. Additionally, the results of this study are influenced by the overall living conditions the Ph.D. students experience. As Tübingen is a small town in the southwest of Germany, a comparison to larger cities or other countries might not be viable as the conditions probably differ largely.</p>
<p>Finally, even within one university, the generalization of our results is further limited by the uneven distribution of the participants across faculties. Most participants (61.8%) were from the Science Faculty, which is also the largest department (in terms of the highest total number of students) at the University of Tübingen. This skewness limits the faculty-wise comparisons, and we would expect to find interesting insights into the different graduate programs by conducting detailed comparisons. These differences could not only arise from different academic traditions but also from the highly varying expectations on the scope of a Ph.D. thesis. It follows that more detailed and systematic monitoring and data collection in national and international surveys are needed.</p>
</div>

<div id="section2"><h4>Methodology.</h4><p>In a cross-sectional study, we investigate the current situation of Ph.D. students. While this is a valid and important instrument to access the current state, it cannot give us information about the dynamic changes in the transition phase between undergraduate studies and the Ph.D. as well as across the Ph.D. [<a href="#pone.0288103.ref051">51</a>]. To track these changes or make comparisons over time, a longitudinal study design or propensity score matching procedures [<a href="#pone.0288103.ref052">52</a>] could give further insights. It is therefore desirable to establish regular surveys and monitoring systems either on a university level or in a national survey to provide information on the impact of undertaken actions and implemented changes. We used a mixed quantitative and qualitative research approach. While this provides information on distinct levels, there are some pitfalls. For example, the open answer categories were defined post-hoc. While this gives the possibility for the participants to express their thoughts freely, it makes a systematic analysis more difficult, and the analysis might be biased by the evaluators. Overall, it is important to summarize and statistically analyze our study results on an overall level, but it must not be forgotten that every person and Ph.D. project is individual.</p>
</div>
</div>

<div id="section4"><h3>Implications for research and practice</h3>

<div id="section1"><h4>Research.</h4><p>The overall scarce data, paired with worrisome flashlights on the mental health situation of Ph.D. students in different countries, highlights the need for more systematic monitoring of mental health in academia. For this purpose, standardized as well as domain-specific scales for Ph.D. students need to be established and longitudinal data needs to be collected. This would enable researchers to measure the effect of larger environmental changes (such as the COVID-19 pandemic or economic developments) and to measure the impact of interventions targeted to improve the situation. At the same time, we propose including qualitative measurements to assess unknown variables and the unique situation each Ph.D. student faces. These could also inform the development of additional quantitative measurable constructs to reflect the dynamic situation in academia. Such monitoring systems can either be implemented at the university level to give detailed insights into the situation at a specific university or on a national level to get an overall impression of Ph.D. students’ health issues. Optimally, a survey should be promoted from an independent self-governing institution dedicated to advancing science and research. While the demands for a better mental health situation for Ph.D. students are obvious, systematical and political changes need to be addressed in the research community and in academia.</p>
</div>

<div id="section2"><h4>Practice.</h4><p>Our mixed methods research approach allows us not only to find out more about the issues of Ph.D. students but also to draw conclusions about what is needed to improve their situation. However, finding solutions to a recognized problem is not a straightforward task, and complex problems often require a step-by-step solution. Therefore, we assume that more practical implications, which could be indicated by an established monitoring system, will be necessary once the first steps have been taken.</p>
<p>In general, we can group interventions into at least four levels that can influence each other: the Ph.D. students themselves, the supervisors, the universities or research institutions, and the greater political context and academic culture. Building on the responses about potential improvements and additional services, we identified the following practical implications:</p>
<p>On an individual level, the main interventions could happen in capacity building (e.g., in time/project management, self-reflection or mental health awareness) but also by being more proactive about changing working modes (e.g., establishing collaborations or a peer counseling system) or by improving the social environment. This could additionally lead to a change in self-perception, for which direct interventions might be more difficult. At this point, we want to highlight that changes on the individual level aim to prevent the development of mental health problems and strengthen the resilience of Ph.D. students. They can at no point replace professional support once such problems have been manifested.</p>
<p>The level of supervision seems to be the most urgent and promising target for an improvement of Ph.D. students’ situation. As supervisors are usually defining a project and its goals, but also additional teaching or other tasks, they are responsible for setting the workload and time constraints. Not only the hard constraints of the working conditions but also the quality of supervision was often mentioned to be highly deficient. Possible interventions could target improving the skills in personnel management of supervisors. But also, clear supervision requirements and guidelines could be imposed by the university. Such agreements (including expectations on the thesis, supervision times and conciliation mechanisms) might be an option to enhance the agreements in a supervisor-student relationship. While these suggestions are not new, and some of them are theoretically established in some university departments, our study results suggest that they are often ignored or not properly implemented, and more binding agreements and control mechanisms need to be made. Establishing additional external supervision, where for example the personnel management is reflected, might also give new perspectives and enhance demanding situations. At this point, it has to be considered that there are strong dependencies between Ph.D. students and their supervisors since, in many cases, it is the supervisors who have a major impact on the outcome of a Ph.D. thesis, such as the final grade. It remains challenging how Ph.D. students can criticize the supervising situation without negatively impacting the personal relationship with their supervisors.</p>
<p>Further interventions on the level of universities and research institutions might include support in bureaucratic processes and providing more information on different contact points (e.g., for mental health services). It is obvious that the aforementioned interventions (such as capacity building courses for Ph.D. students and supervisors) are dependent on the support of the central facilities of the research institution. Furthermore, highlighting the high prevalence of mental health problems, for example, at mandatory introductory sessions for Ph.D. students, might help to raise awareness about this topic. This could help unexperienced young researchers to notice signs of anxiety and depression early on before these mental disorders manifest. Finally, public events on this topic could reduce the stigma associated with it, making it easier for affected Ph.D. students to seek help. Such events might also be used to remind the students that it is important to take care not only of their physical but also mental health, for instance, by strengthening social relationships and pursuing hobbies which are not work-related.</p>
<p>Lastly, there are also changes in the political setting and academic culture needed. This includes a fair payment system, reasonable control of contract lengths and extensions, and more perspectives for long-term positions in academia. Considering that the vast majority of Ph.D. students will end up in positions outside of academia, it could be beneficial to better prepare students for careers in alternative job markets, such as industry. Such interventions might directly influence the job insecurity and job dissatisfaction of Ph.D. students. In Germany, the current regulations for temporary academic employment are being evaluated [<a href="#pone.0288103.ref053">53</a>], but even propositions from the conference of university rectors [<a href="#pone.0288103.ref054">54</a>] seem not to be sufficient for fundamental changes. These changes would also need a shift in the academic culture [<a href="#pone.0288103.ref055">55</a>], in which “publish or perish” is still a guiding theme leading to high pressure to perform. Working on a cultural shift is a task for all scientists. This will lead to a more sustainable work culture from which all stakeholders might benefit.</p>
<p>All in all, there is an interplay and dependence of all mentioned levels. Importantly, most problems mentioned in the survey can result from shortcomings on multiple levels, and therefore interventions on more than one level are needed for a satisfying solution. For example, changes to improve the mental health situation on an individual level can be dependent on the consent of the supervisor and can also be negatively impacted by already existing mental health issues. In addition to individual responsibility for health, it is important to systematically target prevention and change the system on the aforementioned levels so that Ph.D. students are better and more quickly supported when mental health problems arise.</p>
</div>
</div>
</div>

<div xmlns:plos="http://plos.org" id="section5"><h2>Conclusion</h2><p>This study shows once again the detrimental mental health situation of Ph.D. students in academia. By analyzing the mental health of Ph.D. students at a German university, we found alarming hints of depressive and anxious tendencies that are in line with other comparable studies. Furthermore, we have identified main stressors, such as perceived stress or self-doubts, and resources, such as a positive student-supervisor relationship. Understanding conditional factors and being able to improve the situation depend on such identifications. With our study, we provide first insights of the status quo for the University chair, the Graduate Academy, and other stakeholders in the academic system. We invite them to inspect the results and suggestions responsibly so that actions to assess and improve the conditions for Ph.D. students’ mental health and well-being can be taken in the future. Based on our data, additional offers for Ph.D. students, as well as their supervisors, should be created and existing ones sustainably modified. Positive conditions and resources for mental health and well-being will not restrict to academia but will affect all areas of life. While an increased mental health state is an indispensable value on its own, additional benefits can be created for research, teaching, practice, and society. As such, mental health is a big part of sustainable living and should have a high priority for all people. While this is already acknowledged in the sustainable development goals, further steps need to be taken to raise awareness and provide support throughout society.</p>
</div>

<div xmlns:plos="http://plos.org" id="section6"><h2>Supporting information</h2></div>





<div xmlns:plos="http://plos.org"><h2>Acknowledgments</h2>
<p>We would like to express our gratitude to all participants of the survey as well to the <em>sustainAbility</em> Ph.D. initiative at the University of Tübingen. We thank Dr. Stephanie Rosenstiel for support with the ethics approval and Prof. Dr. Birgit Derntl and Prof. Dr. Andreas Fallgatter for their helpful feedback on the conception of the questionnaire. We thank Mumina Javed and Monja Neuser for their support in the early phase of the project.</p>
</div><div xmlns:plos="http://plos.org"><h2>References</h2><ol><li id="ref1"><span>1.
            </span><a name="pone.0288103.ref001" id="pone.0288103.ref001"></a>World Health Organization, editor. Mental health: facing the challenges, building solutions: report from the WHO European Ministerial Conference. Copenhagen, Denmark: World Health Organization, Regional Office for Europe; 2005. <ul></ul></li><li id="ref2"><span>2.
            </span><a name="pone.0288103.ref002" id="pone.0288103.ref002"></a>Evans TM, Bira L, Gastelum JB, Weiss LT, Vanderford NL. Evidence for a mental health crisis in graduate education. Nat Biotechnol. 2018;36(3): 282284.  pmid:29509732 <ul data-doi="10.1038/nbt.4089"><li><a href="https://doi.org/10.1038/nbt.4089" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/29509732" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Evidence+for+a+mental+health+crisis+in+graduate+education+Evans+2018" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref3"><span>3.
            </span><a name="pone.0288103.ref003" id="pone.0288103.ref003"></a>Satinsky EN, Kimura T, Kiang MV, Abebe R, Cunningham S, Lee H, et al. Systematic review and meta-analysis of depression, anxiety, and suicidal ideation among Ph.D. students. Sci Rep. 2021;11(1): 14370.  pmid:34257319 <ul data-doi="10.1038/s41598-021-93687-7"><li><a href="https://doi.org/10.1038/s41598-021-93687-7" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/34257319" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Systematic+review+and+meta-analysis+of+depression%2C+anxiety%2C+and+suicidal+ideation+among+Ph.D.+students+Satinsky+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref4"><span>4.
            </span><a name="pone.0288103.ref004" id="pone.0288103.ref004"></a>Baxter AJ, Scott KM, Vos T, Whiteford HA. Global prevalence of anxiety disorders: a systematic review and meta-regression. Psychol Med. 2013;43(5): 897–910.  pmid:22781489 <ul data-doi="10.1017/S003329171200147X"><li><a href="https://doi.org/10.1017/S003329171200147X" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/22781489" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Global+prevalence+of+anxiety+disorders%3A+a+systematic+review+and+meta-regression+Baxter+2013" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref5"><span>5.
            </span><a name="pone.0288103.ref005" id="pone.0288103.ref005"></a>Ferrari AJ, Somerville AJ, Baxter AJ, Norman R, Patten SB, Vos T, et al. Global variation in the prevalence and incidence of major depressive disorder: a systematic review of the epidemiological literature. Psychol Med. 2013;43(3): 471–481.  pmid:22831756 <ul data-doi="10.1017/S0033291712001511"><li><a href="https://doi.org/10.1017/S0033291712001511" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/22831756" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Global+variation+in+the+prevalence+and+incidence+of+major+depressive+disorder%3A+a+systematic+review+of+the+epidemiological+literature+Ferrari+2013" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref6"><span>6.
            </span><a name="pone.0288103.ref006" id="pone.0288103.ref006"></a>Byrom NC, Dinu L, Kirkman A, Hughes G. Predicting stress and mental wellbeing among doctoral researchers. Journal of Mental Health. 2020; 1–9.  pmid:32967498 <ul data-doi="10.1080/09638237.2020.1818196"><li><a href="https://doi.org/10.1080/09638237.2020.1818196" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/32967498" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Predicting+stress+and+mental+wellbeing+among+doctoral+researchers+Byrom+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref7"><span>7.
            </span><a name="pone.0288103.ref007" id="pone.0288103.ref007"></a>El-Ghoroury NH, Galper DI, Sawaqdeh A, Bufka LF. Stress, coping, and barriers to wellness among psychology graduate students. Training and Education in Professional Psychology. 2012;6(2): 122–134. <ul><li><a href="#" data-author="El-Ghoroury" data-cit="El-GhorouryNH%2C%20GalperDI%2C%20SawaqdehA%2C%20BufkaLF.%20Stress%2C%20coping%2C%20and%20barriers%20to%20wellness%20among%20psychology%20graduate%20students.%20Training%20and%20Education%20in%20Professional%20Psychology.%202012%3B6%282%29%3A%20122%E2%80%93134." data-title="Stress%2C%20coping%2C%20and%20barriers%20to%20wellness%20among%20psychology%20graduate%20students" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Stress%2C+coping%2C+and+barriers+to+wellness+among+psychology+graduate+students+El-Ghoroury+2012" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref8"><span>8.
            </span><a name="pone.0288103.ref008" id="pone.0288103.ref008"></a>Kowalczyk M, Karbownik MS, Kowalczyk E, Sienkiewicz M, Talarowska M. Mental Health of PhD Students at Polish Universities–Before the COVID-19 Outbreak. IJERPH. 2021;18(22): 12068.  pmid:34831821 <ul data-doi="10.3390/ijerph182212068"><li><a href="https://doi.org/10.3390/ijerph182212068" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/34831821" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Mental+Health+of+PhD+Students+at+Polish+Universities%E2%80%93Before+the+COVID-19+Outbreak+Kowalczyk+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref9"><span>9.
            </span><a name="pone.0288103.ref009" id="pone.0288103.ref009"></a>Smith E, Brooks Z. Graduate Student Mental Health (University of Arizona). National Association of Graduate-Professional Students [Internet]. 2015. Available from: <a href="http://nagps.org/wordpress/wp-content/uploads/2015/06/NAGPS_Institute_mental_health_survey_report_2015.pdf">http://nagps.org/wordpress/wp-content/uploads/2015/06/NAGPS_Institute_mental_health_survey_report_2015.pdf</a>. <ul><li><a href="#" data-author="Smith" data-cit="SmithE%2C%20BrooksZ.%20Graduate%20Student%20Mental%20Health%20%28University%20of%20Arizona%29.%20National%20Association%20of%20Graduate-Professional%20Students%20%5BInternet%5D.%202015.%20Available%20from%3A%20http%3A%2F%2Fnagps.org%2Fwordpress%2Fwp-content%2Fuploads%2F2015%2F06%2FNAGPS_Institute_mental_health_survey_report_2015.pdf." data-title="Graduate%20Student%20Mental%20Health%20%28University%20of%20Arizona%29" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Graduate+Student+Mental+Health+%28University+of+Arizona%29+Smith+2015" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref10"><span>10.
            </span><a name="pone.0288103.ref010" id="pone.0288103.ref010"></a>Williams S. 2019 Postgraduate Research Experience Survey [Internet]. 2019. Available from: <a href="https://s3.eu-west-2.amazonaws.com/assets.creode.advancehe-document-manager/documents/advance-he/AdvanceHE-Postgraduate_Research_%20Survey_%202019_1574338111.pdf">https://s3.eu-west-2.amazonaws.com/assets.creode.advancehe-document-manager/documents/advance-he/AdvanceHE-Postgraduate_Research_%20Survey_%202019_1574338111.pdf</a>. <ul></ul></li><li id="ref11"><span>11.
            </span><a name="pone.0288103.ref011" id="pone.0288103.ref011"></a>Majev PG, Vieira RM, Carollo A, Liu H, Stutz D, Fahrenwaldt A, et al. PhDnet Report 2020. 2021. <ul><li><a href="#" data-author="Majev" data-cit="MajevPG%2C%20VieiraRM%2C%20CarolloA%2C%20LiuH%2C%20StutzD%2C%20FahrenwaldtA%2C%20et%20al.%20PhDnet%20Report%202020.%202021." data-title="PhDnet%20Report%202020" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=PhDnet+Report+2020+Majev+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref12"><span>12.
            </span><a name="pone.0288103.ref012" id="pone.0288103.ref012"></a>Olsthoorn LHM, Heckmann LA, Filippi A, Vieira RM, Varanasi RS, Lasser J, et al. PhDnet Report 2019. 2020. <ul><li><a href="#" data-author="Olsthoorn" data-cit="OlsthoornLHM%2C%20HeckmannLA%2C%20FilippiA%2C%20VieiraRM%2C%20VaranasiRS%2C%20LasserJ%2C%20et%20al.%20PhDnet%20Report%202019.%202020." data-title="PhDnet%20Report%202019" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=PhDnet+Report+2019+Olsthoorn+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref13"><span>13.
            </span><a name="pone.0288103.ref013" id="pone.0288103.ref013"></a>Woolston C. Graduate survey: A love–hurt relationship. Nature. 2017;550(7677): 549–552. <ul><li><a href="#" data-author="Woolston" data-cit="WoolstonC.%20Graduate%20survey%3A%20A%20love%E2%80%93hurt%20relationship.%20Nature.%202017%3B550%287677%29%3A%20549%E2%80%93552." data-title="Graduate%20survey%3A%20A%20love%E2%80%93hurt%20relationship" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Graduate+survey%3A+A+love%E2%80%93hurt+relationship+Woolston+2017" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref14"><span>14.
            </span><a name="pone.0288103.ref014" id="pone.0288103.ref014"></a>Woolston C. PhDs: the tortuous truth. Nature. 2019;575(7782): 403–406.  pmid:31723297 <ul data-doi="10.1038/d41586-019-03459-7"><li><a href="https://doi.org/10.1038/d41586-019-03459-7" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/31723297" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=PhDs%3A+the+tortuous+truth+Woolston+2019" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref15"><span>15.
            </span><a name="pone.0288103.ref015" id="pone.0288103.ref015"></a>Marais GAB, Shankland R, Haag P, Fiault R, Juniper B. A Survey and a Positive Psychology Intervention on French PhD Student Well-being. IJDS. 2018;13: 109–138. <ul><li><a href="#" data-author="Marais" data-cit="MaraisGAB%2C%20ShanklandR%2C%20HaagP%2C%20FiaultR%2C%20JuniperB.%20A%20Survey%20and%20a%20Positive%20Psychology%20Intervention%20on%20French%20PhD%20Student%20Well-being.%20IJDS.%202018%3B13%3A%20109%E2%80%93138." data-title="A%20Survey%20and%20a%20Positive%20Psychology%20Intervention%20on%20French%20PhD%20Student%20Well-being" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=A+Survey+and+a+Positive+Psychology+Intervention+on+French+PhD+Student+Well-being+Marais+2018" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref16"><span>16.
            </span><a name="pone.0288103.ref016" id="pone.0288103.ref016"></a>Levecque K, Anseel F, De Beuckelaer A, Van der Heyden J, Gisle L. Work organization and mental health problems in PhD students. Research Policy. 2017;46(4): 868–879. <ul><li><a href="#" data-author="Levecque" data-cit="LevecqueK%2C%20AnseelF%2C%20De%20BeuckelaerA%2C%20Van%20der%20HeydenJ%2C%20GisleL.%20Work%20organization%20and%20mental%20health%20problems%20in%20PhD%20students.%20Research%20Policy.%202017%3B46%284%29%3A%20868%E2%80%93879." data-title="Work%20organization%20and%20mental%20health%20problems%20in%20PhD%20students" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Work+organization+and+mental+health+problems+in+PhD+students+Levecque+2017" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref17"><span>17.
            </span><a name="pone.0288103.ref017" id="pone.0288103.ref017"></a>Auerbach RP, Mortier P, Bruffaerts R, Alonso J, Benjet C, Cuijpers P, et al. WHO World Mental Health Surveys International College Student Project: Prevalence and distribution of mental disorders. Journal of Abnormal Psychology. 2018;127(7): 623638.  pmid:30211576 <ul data-doi="10.1037/abn0000362"><li><a href="https://doi.org/10.1037/abn0000362" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/30211576" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=WHO+World+Mental+Health+Surveys+International+College+Student+Project%3A+Prevalence+and+distribution+of+mental+disorders+Auerbach+2018" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref18"><span>18.
            </span><a name="pone.0288103.ref018" id="pone.0288103.ref018"></a>Sverdlik A, Hall NC. Not just a phase: Exploring the role of program stage on well-being and motivation in doctoral students. Journal of Adult and Continuing Education. 2020;26(1): 97–124. <ul><li><a href="#" data-author="Sverdlik" data-cit="SverdlikA%2C%20HallNC.%20Not%20just%20a%20phase%3A%20Exploring%20the%20role%20of%20program%20stage%20on%20well-being%20and%20motivation%20in%20doctoral%20students.%20Journal%20of%20Adult%20and%20Continuing%20Education.%202020%3B26%281%29%3A%2097%E2%80%93124." data-title="Not%20just%20a%20phase%3A%20Exploring%20the%20role%20of%20program%20stage%20on%20well-being%20and%20motivation%20in%20doctoral%20students" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Not+just+a+phase%3A+Exploring+the+role+of+program+stage+on+well-being+and+motivation+in+doctoral+students+Sverdlik+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref19"><span>19.
            </span><a name="pone.0288103.ref019" id="pone.0288103.ref019"></a>The mental health of PhD researchers demands urgent attention. Nature. 2019;575(7782): 257–258.  pmid:31723298 <ul data-doi="10.1038/d41586-019-03489-1"><li><a href="https://doi.org/10.1038/d41586-019-03489-1" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/31723298" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=The+mental+health+of+PhD+researchers+demands+urgent+attention++2019" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref20"><span>20.
            </span><a name="pone.0288103.ref020" id="pone.0288103.ref020"></a>Mark G, Smith AP. Effects of occupational stress, job characteristics, coping, and attributional style on the mental health and job satisfaction of university employees. Anxiety, Stress &amp; Coping. 2012;25(1): 63–78.  pmid:21271408 <ul data-doi="10.1080/10615806.2010.548088"><li><a href="https://doi.org/10.1080/10615806.2010.548088" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/21271408" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Effects+of+occupational+stress%2C+job+characteristics%2C+coping%2C+and+attributional+style+on+the+mental+health+and+job+satisfaction+of+university+employees+Mark+2012" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref21"><span>21.
            </span><a name="pone.0288103.ref021" id="pone.0288103.ref021"></a>Pyhältö K, Stubb J, Lonka K. Developing scholarly communities as learning environments for doctoral students. International Journal for Academic Development. 2009;14(3): 221–232. <ul><li><a href="#" data-author="Pyh%C3%A4lt%C3%B6" data-cit="Pyh%C3%A4lt%C3%B6K%2C%20StubbJ%2C%20LonkaK.%20Developing%20scholarly%20communities%20as%20learning%20environments%20for%20doctoral%20students.%20International%20Journal%20for%20Academic%20Development.%202009%3B14%283%29%3A%20221%E2%80%93232." data-title="Developing%20scholarly%20communities%20as%20learning%20environments%20for%20doctoral%20students" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Developing+scholarly+communities+as+learning+environments+for+doctoral+students+Pyh%C3%A4lt%C3%B6+2009" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref22"><span>22.
            </span><a name="pone.0288103.ref022" id="pone.0288103.ref022"></a>Urbanaviciute I, Christina Roll L, Tomas J, Witte H. Proactive strategies for countering the detrimental outcomes of qualitative job insecurity in academia. Stress and Health. 2021;37(3): 557571.  pmid:33377270 <ul data-doi="10.1002/smi.3023"><li><a href="https://doi.org/10.1002/smi.3023" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/33377270" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Proactive+strategies+for+countering+the+detrimental+outcomes+of+qualitative+job+insecurity+in+academia+Urbanaviciute+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref23"><span>23.
            </span><a name="pone.0288103.ref023" id="pone.0288103.ref023"></a>Dadaczynski K, Okan O, Messer M, Rathmann K. University students’ sense of coherence, future worries and mental health: findings from the German COVID-HL-survey. Health Promotion International. 2022;37(1): daab070.  pmid:34214156 <ul data-doi="10.1093/heapro/daab070"><li><a href="https://doi.org/10.1093/heapro/daab070" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/34214156" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=University+students%E2%80%99+sense+of+coherence%2C+future+worries+and+mental+health%3A+findings+from+the+German+COVID-HL-survey+Dadaczynski+2022" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref24"><span>24.
            </span><a name="pone.0288103.ref024" id="pone.0288103.ref024"></a>Nicholls H, Nicholls M, Tekin S, Lamb D, Billings J. The impact of working in academia on researchers’ mental health and well-being: A systematic review and qualitative meta-synthesis. Serraino GF, editor. PLoS ONE. 2022;17(5): e0268890.  pmid:35613147 <ul data-doi="10.1371/journal.pone.0268890"><li><a href="https://doi.org/10.1371/journal.pone.0268890" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/35613147" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=The+impact+of+working+in+academia+on+researchers%E2%80%99+mental+health+and+well-being%3A+A+systematic+review+and+qualitative+meta-synthesis+Nicholls+2022" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref25"><span>25.
            </span><a name="pone.0288103.ref025" id="pone.0288103.ref025"></a>Mackie SA, Bates GW. Contribution of the doctoral education environment to PhD candidates’ mental health problems: a scoping review. Higher Education Research &amp; Development. 2019;38(3): 565–578. <ul><li><a href="#" data-author="Mackie" data-cit="MackieSA%2C%20BatesGW.%20Contribution%20of%20the%20doctoral%20education%20environment%20to%20PhD%20candidates%E2%80%99%20mental%20health%20problems%3A%20a%20scoping%20review.%20Higher%20Education%20Research%20%26%20Development.%202019%3B38%283%29%3A%20565%E2%80%93578." data-title="Contribution%20of%20the%20doctoral%20education%20environment%20to%20PhD%20candidates%E2%80%99%20mental%20health%20problems%3A%20a%20scoping%20review" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Contribution+of+the+doctoral+education+environment+to+PhD+candidates%E2%80%99+mental+health+problems%3A+a+scoping+review+Mackie+2019" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref26"><span>26.
            </span><a name="pone.0288103.ref026" id="pone.0288103.ref026"></a>Kroenke K, Spitzer RL, Williams JBW. The Patient Health Questionnaire-2: Validity of a Two-Item Depression Screener. Medical Care. 2003;41(11): 1284–1292.  pmid:14583691 <ul data-doi="10.1097/01.MLR.0000093487.78664.3C"><li><a href="https://doi.org/10.1097/01.MLR.0000093487.78664.3C" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/14583691" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=The+Patient+Health+Questionnaire-2%3A+Validity+of+a+Two-Item+Depression+Screener+Kroenke+2003" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref27"><span>27.
            </span><a name="pone.0288103.ref027" id="pone.0288103.ref027"></a>Spitzer RL, Kroenke K, Williams JBW, Löwe B. A Brief Measure for Assessing Generalized Anxiety Disorder: The GAD-7. Arch Intern Med. 2006;166(10): 1092.  pmid:16717171 <ul data-doi="10.1001/archinte.166.10.1092"><li><a href="https://doi.org/10.1001/archinte.166.10.1092" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/16717171" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=A+Brief+Measure+for+Assessing+Generalized+Anxiety+Disorder%3A+The+GAD-7+Spitzer+2006" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref28"><span>28.
            </span><a name="pone.0288103.ref028" id="pone.0288103.ref028"></a>Bach M. Substance use for neuroenhancement or coping with stress: An epidemiological study on university students and clients of a University counseling service in Germany [Internet]. RWTH Aachen; 2016. Available from: <a href="http://publications.rwth-aachen.de/record/679004/files/679004.pdf">http://publications.rwth-aachen.de/record/679004/files/679004.pdf</a>. <ul><li><a href="#" data-author="Bach" data-cit="BachM.%20Substance%20use%20for%20neuroenhancement%20or%20coping%20with%20stress%3A%20An%20epidemiological%20study%20on%20university%20students%20and%20clients%20of%20a%20University%20counseling%20service%20in%20Germany%20%5BInternet%5D.%20RWTH%20Aachen%3B%202016.%20Available%20from%3A%20http%3A%2F%2Fpublications.rwth-aachen.de%2Frecord%2F679004%2Ffiles%2F679004.pdf." data-title="Substance%20use%20for%20neuroenhancement%20or%20coping%20with%20stress%3A%20An%20epidemiological%20study%20on%20university%20students%20and%20clients%20of%20a%20University%20counseling%20service%20in%20Germany" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Substance+use+for+neuroenhancement+or+coping+with+stress%3A+An+epidemiological+study+on+university+students+and+clients+of+a+University+counseling+service+in+Germany+Bach+2016" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref29"><span>29.
            </span><a name="pone.0288103.ref029" id="pone.0288103.ref029"></a>Cohen S, Kamarck T, Mermelstein R. A Global Measure of Perceived Stress. Journal of Health and Social Behavior. 1983;24(4): 385–396. pmid:6668417 <ul><li><a href="#" data-author="Cohen" data-cit="CohenS%2C%20KamarckT%2C%20MermelsteinR.%20A%20Global%20Measure%20of%20Perceived%20Stress.%20Journal%20of%20Health%20and%20Social%20Behavior.%201983%3B24%284%29%3A%20385%E2%80%93396.%206668417" data-title="A%20Global%20Measure%20of%20Perceived%20Stress" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/6668417" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=A+Global+Measure+of+Perceived+Stress+Cohen+1983" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref30"><span>30.
            </span><a name="pone.0288103.ref030" id="pone.0288103.ref030"></a>Büssing A. Translation of Cohen’s 10 Item Perceived Stress Scale (PSS). University of Witten/Herdecke; 2011. <ul></ul></li><li id="ref31"><span>31.
            </span><a name="pone.0288103.ref031" id="pone.0288103.ref031"></a>Hellgren J, Sjöberg A, Sverke M. Intention to quit: Effects of job satisfaction and job perceptions. In: Avallone F, Arnold J, de Witte K, editors. Feelings work in Europe. Milano: Guerini; 1997. pp. 415–423. <ul><li><a href="#" data-author="Hellgren" data-cit="HellgrenJ%2C%20Sj%C3%B6bergA%2C%20SverkeM.%20Intention%20to%20quit%3A%20Effects%20of%20job%20satisfaction%20and%20job%20perceptions.%20In%3A%20AvalloneF%2C%20ArnoldJ%2C%20de%20WitteK%2C%20editors.%20Feelings%20work%20in%20Europe.%20Milano%3A%20Guerini%3B%201997.%20pp.%20415%E2%80%93423." data-title="Intention%20to%20quit%3A%20Effects%20of%20job%20satisfaction%20and%20job%20perceptions" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Intention+to+quit%3A+Effects+of+job+satisfaction+and+job+perceptions+Hellgren+1997" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref32"><span>32.
            </span><a name="pone.0288103.ref032" id="pone.0288103.ref032"></a>Ahrendt D, Anderson R, Dubois H, Jungblut JM, Leončikas T, Pöntinen L, et al. European quality of live survey 2016: quality of life, quality of public services, and quality of society. Luxembourg: Publications Office of the European Union; 2017. <ul></ul></li><li id="ref33"><span>33.
            </span><a name="pone.0288103.ref033" id="pone.0288103.ref033"></a>Hellgren J, Sverke M, Isaksson K. A Two-dimensional Approach to Job Insecurity: Consequences for Employee Attitudes and Well-being. European Journal of Work and Organizational Psychology. 1999;8(2): 179–195. <ul><li><a href="#" data-author="Hellgren" data-cit="HellgrenJ%2C%20SverkeM%2C%20IsakssonK.%20A%20Two-dimensional%20Approach%20to%20Job%20Insecurity%3A%20Consequences%20for%20Employee%20Attitudes%20and%20Well-being.%20European%20Journal%20of%20Work%20and%20Organizational%20Psychology.%201999%3B8%282%29%3A%20179%E2%80%93195." data-title="A%20Two-dimensional%20Approach%20to%20Job%20Insecurity%3A%20Consequences%20for%20Employee%20Attitudes%20and%20Well-being" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=A+Two-dimensional+Approach+to+Job+Insecurity%3A+Consequences+for+Employee+Attitudes+and+Well-being+Hellgren+1999" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref34"><span>34.
            </span><a name="pone.0288103.ref034" id="pone.0288103.ref034"></a>Mayring P. Qualitative Inhaltsanalyse: Grundlagen und Techniken. 13., überarbeitete Auflage. Weinheim Basel: Beltz; 2022. <ul></ul></li><li id="ref35"><span>35.
            </span><a name="pone.0288103.ref035" id="pone.0288103.ref035"></a>Hayes AF, Krippendorff K. Answering the Call for a Standard Reliability Measure for Coding Data. Communication Methods and Measures. 2007;1(1): 77–89. <ul><li><a href="#" data-author="Hayes" data-cit="HayesAF%2C%20KrippendorffK.%20Answering%20the%20Call%20for%20a%20Standard%20Reliability%20Measure%20for%20Coding%20Data.%20Communication%20Methods%20and%20Measures.%202007%3B1%281%29%3A%2077%E2%80%9389." data-title="Answering%20the%20Call%20for%20a%20Standard%20Reliability%20Measure%20for%20Coding%20Data" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Answering+the+Call+for+a+Standard+Reliability+Measure+for+Coding+Data+Hayes+2007" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref36"><span>36.
            </span><a name="pone.0288103.ref036" id="pone.0288103.ref036"></a>Warttig SL, Forshaw MJ, South J, White AK. New, normative, English-sample data for the Short Form Perceived Stress Scale (PSS-4). J Health Psychol. 2013;18(12): 1617–1628.  pmid:24155195 <ul data-doi="10.1177/1359105313508346"><li><a href="https://doi.org/10.1177/1359105313508346" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/24155195" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=New%2C+normative%2C+English-sample+data+for+the+Short+Form+Perceived+Stress+Scale+%28PSS-4%29+Warttig+2013" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref37"><span>37.
            </span><a name="pone.0288103.ref037" id="pone.0288103.ref037"></a>Klein EM, Brähler E, Dreier M, Reinecke L, Müller KW, Schmutzer G, et al. The German version of the Perceived Stress Scale–psychometric characteristics in a representative German community sample. BMC Psychiatry. 2016;16(1): 1–10. <ul><li><a href="#" data-author="Klein" data-cit="KleinEM%2C%20Br%C3%A4hlerE%2C%20DreierM%2C%20ReineckeL%2C%20M%C3%BCllerKW%2C%20SchmutzerG%2C%20et%20al.%20The%20German%20version%20of%20the%20Perceived%20Stress%20Scale%E2%80%93psychometric%20characteristics%20in%20a%20representative%20German%20community%20sample.%20BMC%20Psychiatry.%202016%3B16%281%29%3A%201%E2%80%9310." data-title="The%20German%20version%20of%20the%20Perceived%20Stress%20Scale%E2%80%93psychometric%20characteristics%20in%20a%20representative%20German%20community%20sample" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=The+German+version+of+the+Perceived+Stress+Scale%E2%80%93psychometric+characteristics+in+a+representative+German+community+sample+Klein+2016" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref38"><span>38.
            </span><a name="pone.0288103.ref038" id="pone.0288103.ref038"></a>Friedrich J, Münch AK, Thiel A, Voelter-Mahlknecht S, Sudeck G. Occupational Health Literacy Scale (OHLS): development and validation of a domain-specific measuring instrument. Health Promotion International. 2023;38(1): daac182.  pmid:36738454 <ul data-doi="10.1093/heapro/daac182"><li><a href="https://doi.org/10.1093/heapro/daac182" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/36738454" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Occupational+Health+Literacy+Scale+%28OHLS%29%3A+development+and+validation+of+a+domain-specific+measuring+instrument+Friedrich+2023" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref39"><span>39.
            </span><a name="pone.0288103.ref039" id="pone.0288103.ref039"></a>Levecque K, De Beuckelaer A, Van Overbeke K, Mortier A. How satisfied are PhD students with their job? A focus on Flanders. ECCOM-brief. 2019;18: 1–5. <ul><li><a href="#" data-author="Levecque" data-cit="LevecqueK%2C%20De%20BeuckelaerA%2C%20Van%20OverbekeK%2C%20MortierA.%20How%20satisfied%20are%20PhD%20students%20with%20their%20job%3F%20A%20focus%20on%20Flanders.%20ECCOM-brief.%202019%3B18%3A%201%E2%80%935." data-title="How%20satisfied%20are%20PhD%20students%20with%20their%20job%3F%20A%20focus%20on%20Flanders" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=How+satisfied+are+PhD+students+with+their+job%3F+A+focus+on+Flanders+Levecque+2019" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref40"><span>40.
            </span><a name="pone.0288103.ref040" id="pone.0288103.ref040"></a>Krippendorff K. Content Analysis: An Introduction to Its Methodology [Internet]. SAGE Publications; 2019 [cited 2023 Jun 6]. Available from: <a href="https://methods.sagepub.com/book/content-analysis-4e">https://methods.sagepub.com/book/content-analysis-4e</a>. <ul></ul></li><li id="ref41"><span>41.
            </span><a name="pone.0288103.ref041" id="pone.0288103.ref041"></a>Skoda EM, Spura A, De Bock F, Schweda A, Dörrie N, Fink M, et al. Veränderung der psychischen Belastung in der COVID-19-Pandemie in Deutschland: Ängste, individuelles Verhalten und die Relevanz von Information sowie Vertrauen in Behörden. Bundesgesundheitsbl. 2021r;64(3): 322–333. <ul><li><a href="#" data-author="Skoda" data-cit="SkodaEM%2C%20SpuraA%2C%20De%20BockF%2C%20SchwedaA%2C%20D%C3%B6rrieN%2C%20FinkM%2C%20et%20al.%20Ver%C3%A4nderung%20der%20psychischen%20Belastung%20in%20der%20COVID-19-Pandemie%20in%20Deutschland%3A%20%C3%84ngste%2C%20individuelles%20Verhalten%20und%20die%20Relevanz%20von%20Information%20sowie%20Vertrauen%20in%20Beh%C3%B6rden.%20Bundesgesundheitsbl.%202021r%3B64%283%29%3A%20322%E2%80%93333." data-title="Ver%C3%A4nderung%20der%20psychischen%20Belastung%20in%20der%20COVID-19-Pandemie%20in%20Deutschland%3A%20%C3%84ngste%2C%20individuelles%20Verhalten%20und%20die%20Relevanz%20von%20Information%20sowie%20Vertrauen%20in%20Beh%C3%B6rden" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Ver%C3%A4nderung+der+psychischen+Belastung+in+der+COVID-19-Pandemie+in+Deutschland%3A+%C3%84ngste%2C+individuelles+Verhalten+und+die+Relevanz+von+Information+sowie+Vertrauen+in+Beh%C3%B6rden+Skoda+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref42"><span>42.
            </span><a name="pone.0288103.ref042" id="pone.0288103.ref042"></a>Bäuerle A, Steinbach J, Schweda A, Beckord J, Hetkamp M, Weismüller B, et al. Mental Health Burden of the COVID-19 Outbreak in Germany: Predictors of Mental Health Impairment. J Prim Care Community Health. 2020 Jan;11: 1–8.  pmid:32865107 <ul data-doi="10.1177/2150132720953682"><li><a href="https://doi.org/10.1177/2150132720953682" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/32865107" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Mental+Health+Burden+of+the+COVID-19+Outbreak+in+Germany%3A+Predictors+of+Mental+Health+Impairment+B%C3%A4uerle+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref43"><span>43.
            </span><a name="pone.0288103.ref043" id="pone.0288103.ref043"></a>Chrikov I, Soria KM, Horgos B, Jones-White D. Undergraduate and graduate students’ mental health during the COVID-19 pandemic. [Internet]. University of California—Berkeley and University of Minnesota: SERU Consortium; 2020. Available from: <a href="https://hdl.handle.net/11299/215271">https://hdl.handle.net/11299/215271</a>. <ul><li><a href="#" data-author="Chrikov" data-cit="ChrikovI%2C%20SoriaKM%2C%20HorgosB%2C%20Jones-WhiteD.%20Undergraduate%20and%20graduate%20students%E2%80%99%20mental%20health%20during%20the%20COVID-19%20pandemic.%20%5BInternet%5D.%20University%20of%20California%E2%80%94Berkeley%20and%20University%20of%20Minnesota%3A%20SERU%20Consortium%3B%202020.%20Available%20from%3A%20https%3A%2F%2Fhdl.handle.net%2F11299%2F215271." data-title="Undergraduate%20and%20graduate%20students%E2%80%99%20mental%20health%20during%20the%20COVID-19%20pandemic" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Undergraduate+and+graduate+students%E2%80%99+mental+health+during+the+COVID-19+pandemic+Chrikov+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref44"><span>44.
            </span><a name="pone.0288103.ref044" id="pone.0288103.ref044"></a>Federal Statistical Office. Qualität der Arbeit: Wöchentliche Arbeitszeit [Internet]. Wiesbaden: Statistisches Bundesamt; 2021. Available from: <a href="https://www.destatis.de/DE/Themen/Arbeit/Arbeitsmarkt/Qualitaet-Arbeit/Dimension-3/woechentliche-arbeitszeitl.html">https://www.destatis.de/DE/Themen/Arbeit/Arbeitsmarkt/Qualitaet-Arbeit/Dimension-3/woechentliche-arbeitszeitl.html</a>. <ul></ul></li><li id="ref45"><span>45.
            </span><a name="pone.0288103.ref045" id="pone.0288103.ref045"></a>Frei I, Grund C. Antecedents of overtime work: The case of junior academics. German Journal of Human Resource Management. 2020;34(4): 371–397. <ul><li><a href="#" data-author="Frei" data-cit="FreiI%2C%20GrundC.%20Antecedents%20of%20overtime%20work%3A%20The%20case%20of%20junior%20academics.%20German%20Journal%20of%20Human%20Resource%20Management.%202020%3B34%284%29%3A%20371%E2%80%93397." data-title="Antecedents%20of%20overtime%20work%3A%20The%20case%20of%20junior%20academics" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Antecedents+of+overtime+work%3A+The+case+of+junior+academics+Frei+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref46"><span>46.
            </span><a name="pone.0288103.ref046" id="pone.0288103.ref046"></a>Mauvais-Jarvis F, Bairey Merz N, Barnes PJ, Brinton RD, Carrero JJ, DeMeo DL, et al. Sex and gender: modifiers of health, disease, and medicine. The Lancet. 2020;396(10250): 565–582.  pmid:32828189 <ul data-doi="10.1016/S0140-6736(20)31561-0"><li><a href="https://doi.org/10.1016/S0140-6736(20)31561-0" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/32828189" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Sex+and+gender%3A+modifiers+of+health%2C+disease%2C+and+medicine+Mauvais-Jarvis+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref47"><span>47.
            </span><a name="pone.0288103.ref047" id="pone.0288103.ref047"></a>Prowse R, Sherratt F, Abizaid A, Gabrys RL, Hellemans KGC, Patterson ZR, et al. Coping With the COVID-19 Pandemic: Examining Gender Differences in Stress and Mental Health Among University Students. Front Psychiatry. 2021;12: 650759.  pmid:33897499 <ul data-doi="10.3389/fpsyt.2021.650759"><li><a href="https://doi.org/10.3389/fpsyt.2021.650759" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/33897499" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=Coping+With+the+COVID-19+Pandemic%3A+Examining+Gender+Differences+in+Stress+and+Mental+Health+Among+University+Students+Prowse+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref48"><span>48.
            </span><a name="pone.0288103.ref048" id="pone.0288103.ref048"></a>Federal Ministry of Health. Ordinance on protection against infection risks related to entry to Germany with regard to novel mutations of the SARS-CoV-2 coronavirus subsequent to the determination of an epidemic situation of national significance by the German Bundestag (Coronavirus-Schutzverordnung–CoronaSchV) [Internet]. Berlin: Federal Ministry of Health; 2021. Available from: <a href="https://www.bundesgesundheitsministerium.de/fileadmin/Dateien/3_Downloads/C/Coronavirus/Verordnungen/EN_Corona-Schutzverordnung_konsolidierte_Reinfassung_BAnz_bf.pdf">https://www.bundesgesundheitsministerium.de/fileadmin/Dateien/3_Downloads/C/Coronavirus/Verordnungen/EN_Corona-Schutzverordnung_konsolidierte_Reinfassung_BAnz_bf.pdf</a>. <ul></ul></li><li id="ref49"><span>49.
            </span><a name="pone.0288103.ref049" id="pone.0288103.ref049"></a>Moreno C, Wykes T, Galderisi S, Nordentoft M, Crossley N, Jones N, et al. How mental health care should change as a consequence of the COVID-19 pandemic. The Lancet Psychiatry. 2020;7(9): 813–824.  pmid:32682460 <ul data-doi="10.1016/S2215-0366(20)30307-2"><li><a href="https://doi.org/10.1016/S2215-0366(20)30307-2" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/32682460" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=How+mental+health+care+should+change+as+a+consequence+of+the+COVID-19+pandemic+Moreno+2020" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref50"><span>50.
            </span><a name="pone.0288103.ref050" id="pone.0288103.ref050"></a>Eberhard Karls Universität Tübingen. Studierendenstatistik Wintersemester 2021/2022 [Internet]. Tübingen: Eberhard Karls Universität; 2021. Available from: <a href="https://uni-tuebingen.de/securedl/sdl-eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2NzI4MzQ4NTgsImV4cCI6MTY3MjkyNDg0OCwidXNlciI6MCwiZ3JvdXBzIjpbMCwtMV0sImZpbGUiOiJmaWxlYWRtaW5cL1VuaV9UdWViaW5nZW5cL0RlemVybmF0ZVwvRGV6ZXJuYXRfSUlcL3N0dWRlbnRlbnN0YXRpc3Rpa2VuXC9zdGF0aXN0aWstd3MtMjAyMTIwMjIucGRmIiwicGFnZSI6NTk3fQ.4gH9ESxTCgdSWpi0dMxRLnZPB_xrL4MVm46k8wtB3IY/statistik-ws-20212022.pdf">https://uni-tuebingen.de/securedl/sdl-eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE2NzI4MzQ4NTgsImV4cCI6MTY3MjkyNDg0OCwidXNlciI6MCwiZ3JvdXBzIjpbMCwtMV0sImZpbGUiOiJmaWxlYWRtaW5cL1VuaV9UdWViaW5nZW5cL0RlemVybmF0ZVwvRGV6ZXJuYXRfSUlcL3N0dWRlbnRlbnN0YXRpc3Rpa2VuXC9zdGF0aXN0aWstd3MtMjAyMTIwMjIucGRmIiwicGFnZSI6NTk3fQ.4gH9ESxTCgdSWpi0dMxRLnZPB_xrL4MVm46k8wtB3IY/statistik-ws-20212022.pdf</a>. <ul></ul></li><li id="ref51"><span>51.
            </span><a name="pone.0288103.ref051" id="pone.0288103.ref051"></a>Scarf D, Winter T, Riordan B, Hunter J, Tustin K, Gollop M, et al. A longitudinal study of mental wellbeing in students that transition into PhD study. PsyArXiv [Preprint]. 2021 [cited 2023 Jun 6]. Available from: <a href="https://osf.io/eq6xg">https://osf.io/eq6xg</a>. <ul><li><a href="#" data-author="Scarf" data-cit="ScarfD%2C%20WinterT%2C%20RiordanB%2C%20HunterJ%2C%20TustinK%2C%20GollopM%2C%20et%20al.%20A%20longitudinal%20study%20of%20mental%20wellbeing%20in%20students%20that%20transition%20into%20PhD%20study.%20PsyArXiv%20%5BPreprint%5D.%202021%20%5Bcited%202023%20Jun%206%5D.%20Available%20from%3A%20https%3A%2F%2Fosf.io%2Feq6xg." data-title="A%20longitudinal%20study%20of%20mental%20wellbeing%20in%20students%20that%20transition%20into%20PhD%20study" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=A+longitudinal+study+of+mental+wellbeing+in+students+that+transition+into+PhD+study+Scarf+2021" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref52"><span>52.
            </span><a name="pone.0288103.ref052" id="pone.0288103.ref052"></a>Rosenbaum PR, Rubin DB. The central role of the propensity score in observational studies for causal effects. Biometrika. 1983;70(1): 41–55. <ul><li><a href="#" data-author="Rosenbaum" data-cit="RosenbaumPR%2C%20RubinDB.%20The%20central%20role%20of%20the%20propensity%20score%20in%20observational%20studies%20for%20causal%20effects.%20Biometrika.%201983%3B70%281%29%3A%2041%E2%80%9355." data-title="The%20central%20role%20of%20the%20propensity%20score%20in%20observational%20studies%20for%20causal%20effects" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=The+central+role+of+the+propensity+score+in+observational+studies+for+causal+effects+Rosenbaum+1983" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref53"><span>53.
            </span><a name="pone.0288103.ref053" id="pone.0288103.ref053"></a>Sommer J, Jongmanns G, Book A, Rennert C. Evaluation des novellierten Wissenschaftszeitvertragsgesetzes [Internet]. Hannover: HIS-Institut für Hochschulentwicklung e. V.; 2022. Available from: <a href="https://www.bmbf.de/SharedDocs/Downloads/de/2022/abschlussbericht-evaluation-wisszeitvg.pdf?__blob=publicationFile&amp;v=2">https://www.bmbf.de/SharedDocs/Downloads/de/2022/abschlussbericht-evaluation-wisszeitvg.pdf?__blob=publicationFile&amp;v=2</a>. <ul><li><a href="#" data-author="Sommer" data-cit="SommerJ%2C%20JongmannsG%2C%20BookA%2C%20RennertC.%20Evaluation%20des%20novellierten%20Wissenschaftszeitvertragsgesetzes%20%5BInternet%5D.%20Hannover%3A%20HIS-Institut%20f%C3%BCr%20Hochschulentwicklung%20e.%20V.%3B%202022.%20Available%20from%3A%20https%3A%2F%2Fwww.bmbf.de%2FSharedDocs%2FDownloads%2Fde%2F2022%2Fabschlussbericht-evaluation-wisszeitvg.pdf%3F__blob%3DpublicationFile%26v%3D2." data-title="Evaluation%20des%20novellierten%20Wissenschaftszeitvertragsgesetzes" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Evaluation+des+novellierten+Wissenschaftszeitvertragsgesetzes+Sommer+2022" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref54"><span>54.
            </span><a name="pone.0288103.ref054" id="pone.0288103.ref054"></a>Hochschulrektorenkonferenz. Diskussionsvorschlag der Mitgliedergruppe Universitäten der Hochschulrektorenkonferenz zur Weiterentwicklung des Wissenschaftszeitvertragsgesetzes (Berlin, 06.07.2022) [Internet]. Bonn: Stiftung zur Förderung der Hochschulrektorenkonferenz; 2022. Available from: <a href="https://www.hrk.de/fileadmin/redaktion/hrk/02-Dokumente/02-01-Beschluesse/20220706_MGU_WissZeitVG_Diskussionsvorschlag.pdf">https://www.hrk.de/fileadmin/redaktion/hrk/02-Dokumente/02-01-Beschluesse/20220706_MGU_WissZeitVG_Diskussionsvorschlag.pdf</a>. <ul></ul></li><li id="ref55"><span>55.
            </span><a name="pone.0288103.ref055" id="pone.0288103.ref055"></a>Hall S. A mental-health crisis is gripping science–toxic research culture is to blame. Nature. 2023;617(7962): 666–668.  pmid:37221336 <ul data-doi="10.1038/d41586-023-01708-4"><li><a href="https://doi.org/10.1038/d41586-023-01708-4" data-author="doi-provided" data-cit="doi-provided" data-title="doi-provided" target="_new" title="Go to article">
                      View Article
                    </a></li><li><a href="http://www.ncbi.nlm.nih.gov/pubmed/37221336" target="_new" title="Go to article in PubMed">
                        PubMed/NCBI
                      </a></li><li><a href="http://scholar.google.com/scholar?q=A+mental-health+crisis+is+gripping+science%E2%80%93toxic+research+culture+is+to+blame+Hall+2023" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li></ol></div>



          

        </div>
      </div>
  
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Iridescent crystal with raymarching and signed distance fields (149 pts)]]></title>
            <link>https://varun.ca/ray-march-sdf/</link>
            <guid>36591767</guid>
            <pubDate>Tue, 04 Jul 2023 19:52:41 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://varun.ca/ray-march-sdf/">https://varun.ca/ray-march-sdf/</a>, See on <a href="https://news.ycombinator.com/item?id=36591767">Hacker News</a></p>
<div id="readability-page-1" class="page"><div tabindex="-1" id="___gatsby"><nav></nav><article><header><time datetime="2023-06-03T00:00:00.000Z" color="neutral.2" font-size="1" font-family="systemSans">3rd June, 2023</time></header><p font-family="systemSans" color="neutral.0" font-size="2,3">When building a 3D scene using libraries such as Three.js we generally use meshes. You define a geometry attach some material to it to create a mesh. Then add that mesh to the scene to render it. This is also how 3D modelling software like Blender and Cinema4D work. However, in the demoscene world—where the goal of is to create stuff using extremely small and self-contained computer programs—this approach didn’t work. They’d have to package a 3D library or engine along with the demo code which takes up a lot of memory. So, those folks came up with a pretty innovative approach. They used signed distance fields (SDFs) to define the geometry and then use raymarching to render the scene. The whole thing runs in a single shader program.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">If you’ve ever come across demos on <a href="https://www.shadertoy.com/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Shadertoy</a> or <a href="http://glslsandbox.com/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">GLSL Sandbox</a>, you’ve seen this approach in action. While the initial goal was a small file size, it also allows you to create some <a href="https://www.shadertoy.com/user/tdhooper/sort=popular&amp;from=0&amp;num=8" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">really cool effects</a> and use boolean operations to create complex shapes. In this article, I’ll show you how to create an iridescent crystal using raymarching and SDFs.</p><p font-size="2" color="neutral.1" font-family="systemSans">ℹ️ This post assumes foundational knowledge of shaders. If you're not familiar with shaders or the GLSL API, check out:<!-- --> <a href="https://typefully.com/DanHollick/gpnhhud" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Dan Hollick's twitter thread</a> <!-- -->for a brief overview,<!-- --> <a href="https://youtu.be/f4s1h2YETNY" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">kishimisu's intro tutorial</a> that breaks down basic GLSL concepts, or<!-- --> <a href="https://blog.maximeheckel.com/posts/the-study-of-shaders-with-react-three-fiber/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Maxime Heckel's tutorial</a> <!-- -->on shaders with React Three Fiber.</p><h2 id="ray-marching" font-family="systemSans" color="neutral.0" font-size="4,5" font-weight="7"><a href="#ray-marching" aria-label="ray marching permalink" color="brand.main" font-family="systemSans"></a>Ray Marching</h2><p font-family="systemSans" color="neutral.0" font-size="2,3">Ray Marching is a rendering technique that involves sending rays into a scene and checking for collisions with objects. Here’s how it works:</p><p font-family="systemSans" color="neutral.0" font-size="2,3">First, we select a position for the camera. Then, we send rays from the camera to each pixel in the output image. Along each ray, we step bit by bit, checking if there is a collision with an object in the scene. If a collision occurs, we’re done! If not, we continue stepping along the ray up to a maximum number of steps.</p><figure><img src="https://varun.ca/static/ray-march-41bd80ce90cdf1dde6084381abf07d6f.svg" alt="" width="100%,75%,50%" display="block"><figcaption font-size="1" font-family="systemSans" color="neutral.0"><a href="https://en.wikipedia.org/wiki/Ray_tracing_(graphics)" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">from "Ray tracing" on Wikipedia</a></figcaption></figure><p font-family="systemSans" color="neutral.0" font-size="2,3">The other important distinction is that we’re not using vertices &amp; triangles to define the geometry. If you’ve done any kind of 3D work, you’re probably familiar with the idea of defining geometry using vertices. For example, a cube is defined by 8 vertices and 12 triangles. But with raymarching, we use something called “signed distance field” to represent the geometry.</p><h3 id="signed-distance-field-sdf" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#signed-distance-field-sdf" aria-label="signed distance field sdf permalink" color="brand.main" font-family="systemSans"></a>Signed Distance Field (SDF)</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">While the term SDF may sound daunting, it’s just a function that calculates the shortest distance from any point in space to a shape’s surface. The distance is negative for points within the shape, positive for points outside the shape, and zero for points exactly on the surface of the shape.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">For example, a circle can be defined by the following function:</p><div data-language="glsl"><pre><code><span>float</span> <span>sdCircle</span><span>(</span><span>vec2</span> point<span>,</span> <span>float</span> radius<span>)</span> <span>{</span>
  <span>return</span> <span>length</span><span>(</span>point<span>)</span> <span>-</span> radius<span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">You can find functions for various <a href="https://iquilezles.org/articles/distfunctions2d/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">2D</a> and <a href="https://iquilezles.org/articles/distfunctions/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">3D</a> SDFs on Inigo Quilez’s website. Or use the <a href="https://github.com/marklundin/glsl-sdf-primitives" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">glsl-sdf-primitives</a> library. I’ll explain how to use these functions later in the article.</p><p width="50%" font-family="systemSans" color="neutral.0" font-size="2,3">
  <img src="https://varun.ca/baf8094ed68d7efbc78649ba655b5a69/sdf-marching.svg" alt="" display="block">
</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Back to raymarching. When stepping along the ray, the obvious option is to take a tiny step at a time and check for collisions. But since SDF provides us with the distance to the surface, we know that we can step by that distance without going through the surface. Doing so both speeds up the process and improves accuracy.</p><p font-size="2" color="neutral.1" font-family="systemSans">🤔 <b>Raytracing vs Raymarching</b><br>Raytracing is a very similar process to raymarching, the key difference is that geometry is typically defined as triangles, spheres, etc. To find the intersection between the view ray and the scene, we conduct a series of geometric intersection tests. For example, does the ray intersect with a triangle and, if so, which part of the triangle.</p><h2 id="implementing-a-raymarched-scene" font-family="systemSans" color="neutral.0" font-size="4,5" font-weight="7"><a href="#implementing-a-raymarched-scene" aria-label="implementing a raymarched scene permalink" color="brand.main" font-family="systemSans"></a>Implementing a raymarched scene</h2><p font-family="systemSans" color="neutral.0" font-size="2,3">Alright, onto the crystal. Let’s take the technique I shared above and implement it in GLSL. We’ll start with a basic shader scene, add raymarching to it, and then implement lighting and materials.</p><div><figure display="none,none,block" width="400"></figure><div display="none,none,block"><h3 id="basic-shader-scene" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#basic-shader-scene" aria-label="basic shader scene permalink" color="brand.main" font-family="systemSans"></a>Basic shader scene</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">My goto tool for creative coding is <a href="https://github.com/mattdesl/canvas-sketch" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">canvas-sketch</a>. It offers a <a href="https://github.com/mattdesl/canvas-sketch-util/blob/master/docs/shader.md#shader--createshaderopt" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">utility function</a> that creates a full-screen GLSL shader renderer using <a href="https://regl.party/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">regl</a>. You can pass in your shader code and uniforms and it takes care of the rest. Here’s an example of a shader that renders a gradient.</p><div data-language="js"><pre><code><span>const</span> canvasSketch <span>=</span> <span>require</span><span>(</span><span>'canvas-sketch'</span><span>)</span><span>;</span>
<span>const</span> createShader <span>=</span> <span>require</span><span>(</span><span>'canvas-sketch-util/shader'</span><span>)</span><span>;</span>
<span>const</span> glsl <span>=</span> <span>require</span><span>(</span><span>'glslify'</span><span>)</span><span>;</span>

<span>const</span> settings <span>=</span> <span>{</span>
  dimensions<span>:</span> <span>[</span><span>1080</span><span>,</span> <span>1080</span><span>]</span><span>,</span>
  context<span>:</span> <span>'webgl'</span><span>,</span>
  animate<span>:</span> <span>true</span><span>,</span>
<span>}</span><span>;</span>

<span>const</span> frag <span>=</span> <span>glsl</span><span>(</span><span><span>`</span><span>
  precision highp float;

  uniform float time;
  varying vec2 vUv;

  void main () {
    vec3 col = 0.5 + 0.5 * cos(time + vUv.xyx + vec3(0,2,4));
    gl_FragColor = vec4(col, 1.0);
  }
</span><span>`</span></span><span>)</span><span>;</span>

<span>const</span> <span>sketch</span> <span>=</span> <span>(</span><span><span>{</span> gl<span>,</span> canvas <span>}</span></span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>return</span> <span>createShader</span><span>(</span><span>{</span>
    gl<span>,</span>
    frag<span>,</span>
    uniforms<span>:</span> <span>{</span>
      <span>resolution</span><span>:</span> <span>(</span><span><span>{</span> width<span>,</span> height <span>}</span></span><span>)</span> <span>=&gt;</span> <span>[</span>width<span>,</span> height<span>]</span><span>,</span>
      <span>time</span><span>:</span> <span>(</span><span><span>{</span> time <span>}</span></span><span>)</span> <span>=&gt;</span> time<span>,</span>
      <span>playhead</span><span>:</span> <span>(</span><span><span>{</span> playhead <span>}</span></span><span>)</span> <span>=&gt;</span> playhead<span>,</span>
    <span>}</span><span>,</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span><span>;</span>

<span>canvasSketch</span><span>(</span>sketch<span>,</span> settings<span>)</span><span>;</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">Couple of things to note here. <code>createShader</code> bootstraps a default vertex shader (see below) that provides a varying <code>vUv</code>. This essentially maps the pixel coordinates to a value between 0 and 1. You can override this by specifying a custom vertex shader. But for most cases, this is sufficient.</p><p>vert.glsl</p><div data-language="glsl"><pre><code><span>precision</span> <span>highp</span> <span>float</span><span>;</span>
<span>attribute</span> <span>vec3</span> position<span>;</span>
<span>varying</span> <span>vec2</span> vUv<span>;</span>

<span>void</span> <span>main</span> <span>(</span><span>)</span> <span>{</span>
  gl_Position <span>=</span> <span>vec4</span><span>(</span>position<span>.</span>xyz<span>,</span> <span>1.0</span><span>)</span><span>;</span>
  vUv <span>=</span> gl_Position<span>.</span>xy <span>*</span> <span>0.5</span> <span>+</span> <span>0.5</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">I’m also using a tool called <code>glslify</code> to wrap the shader code. This enables us to import GLSL modules into our shader. We’ll use it to import SDF functions and other raymarching utilities.</p><h3 id="the-raymarching-algorithm" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#the-raymarching-algorithm" aria-label="the raymarching algorithm permalink" color="brand.main" font-family="systemSans"></a>The Raymarching Algorithm</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">Below is an implementation of the ray marching algorithm. The camera is positioned as the <code>rayOrigin</code>, and pointed towards the <code>rayTarget</code>—the center of the scene.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">The <code>rayDirection</code> is a vector that points from the origin towards a a pixel on the screen, while accounting for the camera’s orientation and field of view. It requires a bit of fancy math to figure out this direction. We’ll be using the <code>glsl-camera-ray</code> module to run that calculation.</p><p><img src="https://varun.ca/static/ray-direction-8b0a68215b4c83cd9236ca43e204a9da.svg" alt="Ray starts at the camera, goes through the pixel on the screen and moves through the scene" display="block"></p><p font-family="systemSans" color="neutral.0" font-size="2,3">Once we obtain the ray direction, we proceed along it, checking for collisions. If a collision is detected, the distance to the surface is returned. Otherwise, we return <code>-1.0</code> to signify that no collision was found.</p><div data-language="glsl"><pre><code><span>precision</span> <span>highp</span> <span>float</span><span>;</span>
<span>varying</span> <span>vec2</span> vUv<span>;</span>
<span>uniform</span> <span>float</span> lensLength<span>;</span>

<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> camera <span>=</span> <span>require</span><span>(</span></span><span>'glsl-camera-ray'</span><span><span>)</span></span></span>

<span>float</span> <span>sdSphere</span><span>(</span><span>vec3</span> point<span>,</span> <span>float</span> radius<span>)</span> <span>{</span>
  <span>return</span> <span>length</span><span>(</span>point<span>)</span> <span>-</span> radius<span>;</span>
<span>}</span>

<span>const</span> <span>int</span> steps <span>=</span> <span>90</span><span>;</span>
<span>const</span> <span>float</span> maxdist <span>=</span> <span>20.0</span><span>;</span>
<span>const</span> <span>float</span> precis <span>=</span> <span>0.001</span><span>;</span>

<span>float</span> <span>raymarch</span><span>(</span><span>vec3</span> rayOrigin<span>,</span> <span>vec3</span> rayDir<span>)</span> <span>{</span>
  <span>float</span> latest <span>=</span> precis <span>*</span> <span>2.0</span><span>;</span>
  <span>float</span> dist <span>=</span> <span>0.0</span><span>;</span>
  <span>float</span> res <span>=</span> <span>-</span><span>1.0</span><span>;</span>

  <span>// March along the ray</span>
  <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> steps<span>;</span> i<span>++</span><span>)</span> <span>{</span>
    <span>// Break if we're close enough or too far away</span>
    <span>if</span> <span>(</span>latest <span>&lt;</span> precis <span>||</span> dist <span>&gt;</span> maxdist<span>)</span> <span>break</span><span>;</span>
    <span>// Get the SDF distance</span>
    <span>float</span> latest <span>=</span> <span>sdSphere</span><span>(</span>rayOrigin <span>+</span> rayDir <span>*</span> dist<span>,</span> <span>1.0</span><span>)</span><span>;</span>
    <span>// Increment by the latest SDF distance</span>
    dist <span>+=</span> latest<span>;</span>
  <span>}</span>
  <span>// if we're still within bounds,</span>
  <span>// set the result to the distance</span>
  <span>if</span> <span>(</span>dist <span>&lt;</span> maxdist<span>)</span> <span>{</span>
    res <span>=</span> dist<span>;</span>
  <span>}</span>

  <span>return</span> res<span>;</span>
<span>}</span>

<span>void</span> <span>main</span><span>(</span><span>)</span> <span>{</span>
  <span>vec3</span> color <span>=</span> <span>vec3</span><span>(</span><span>0.0</span><span>)</span><span>;</span>

  <span>// Bootstrap a raymarching scene</span>
  <span>vec3</span> rayOrigin <span>=</span> <span>vec3</span><span>(</span><span>3.5</span><span>,</span> <span>0.</span><span>,</span> <span>3.5</span><span>)</span><span>;</span>
  <span>vec3</span> rayTarget <span>=</span> <span>vec3</span><span>(</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>)</span><span>;</span>
  <span>// map from 0 to 1 to -1. to 1.</span>
  <span>vec2</span> screenPos <span>=</span> vUv <span>*</span> <span>2.0</span> <span>-</span> <span>1.</span><span>;</span>
  <span>vec3</span> rayDirection <span>=</span> <span>camera</span><span>(</span>rayOrigin<span>,</span> rayTarget<span>,</span> screenPos<span>,</span> lensLength<span>)</span><span>;</span>

  <span>float</span> collision <span>=</span> <span>raymarch</span><span>(</span>rayOrigin<span>,</span> rayDirection<span>)</span><span>;</span>

  <span>// If the ray collides, draw the surface</span>
  <span>if</span> <span>(</span>collision <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
    color <span>=</span> <span>vec3</span><span>(</span><span>0.678</span><span>,</span> <span>0.106</span><span>,</span> <span>0.176</span><span>)</span><span>;</span>
  <span>}</span>

  gl_FragColor <span>=</span> <span>vec4</span><span>(</span>color<span>,</span> <span>1</span><span>)</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3"><code>lensLength</code> here determines the field of view. Try changing it to see how it affects the scene.</p><h3 id="using-glsl-modules-for-raymarching" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#using-glsl-modules-for-raymarching" aria-label="using glsl modules for raymarching permalink" color="brand.main" font-family="systemSans"></a>Using GLSL modules for raymarching</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">Implementing your own raymarching function is cool. It’s especially useful when you want to tweak the inner workings to achieve a specific effect. However, in most cases, you can probably just use an off-the-shelf module.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Below, I’ve updated the sketch to use the <code>glsl-raytrace</code> module. Additionally, I’m using a <code>glsl-sdf-primitives</code> module to generate a torus and <code>glsl-rotate</code> to rotate it.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">The mechanics remain largely similar. The key difference is that geometry is now defined within a function called <code>doModel</code>, and raymarch returns a <code>vec2</code> containing the distance and material index. This is useful if you want to render multiple types of objects in a scene.</p><div data-language="glsl"><pre><code><span>precision</span> <span>highp</span> <span>float</span><span>;</span>
<span>varying</span> <span>vec2</span> vUv<span>;</span>
<span>uniform</span> <span>float</span> lensLength<span>;</span>
<span>uniform</span> <span>float</span> time<span>;</span>

<span>vec2</span> <span>doModel</span><span>(</span><span>vec3</span> p<span>)</span><span>;</span>

<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> camera <span>=</span> <span>require</span><span>(</span></span><span>'glsl-camera-ray'</span><span><span>)</span></span></span>
<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> raymarch <span>=</span> <span>require</span><span>(</span></span><span>'glsl-raytrace'</span><span><span>,</span> map <span>=</span> doModel<span>,</span> steps <span>=</span> <span>90</span><span>)</span></span></span>
<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> sdTorus <span>=</span> <span>require</span><span>(</span></span><span>'glsl-sdf-primitives/sdTorus'</span><span><span>)</span></span></span>
<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> rotate <span>=</span> <span>require</span><span>(</span></span><span>'glsl-rotate/rotate'</span><span><span>)</span></span></span>

<span>vec2</span> <span>doModel</span><span>(</span><span>vec3</span> p<span>)</span> <span>{</span>
  <span>// Spin the shape</span>
  p<span>.</span>xy <span>=</span> <span>rotate</span><span>(</span>p<span>.</span>xy<span>,</span> time<span>)</span><span>;</span>
  p<span>.</span>yz <span>=</span> <span>rotate</span><span>(</span>p<span>.</span>yz<span>,</span> time<span>)</span><span>;</span>
  <span>// Calculate SDF distance</span>
  <span>float</span> d <span>=</span> <span>sdTorus</span><span>(</span>p<span>,</span> <span>vec2</span><span>(</span><span>0.75</span><span>,</span> <span>0.35</span><span>)</span><span>)</span><span>;</span>
  <span>return</span> <span>vec2</span><span>(</span>d<span>,</span> <span>0.0</span><span>)</span><span>;</span>
<span>}</span>

<span>void</span> <span>main</span><span>(</span><span>)</span> <span>{</span>
  <span>vec3</span> color <span>=</span> <span>vec3</span><span>(</span><span>0.0</span><span>)</span><span>;</span>
  <span>// Bootstrap a raytracing scene</span>
  <span>vec3</span> rayOrigin <span>=</span> <span>vec3</span><span>(</span><span>3.5</span><span>,</span> <span>0</span><span>,</span> <span>3.5</span><span>)</span><span>;</span>
  <span>vec3</span> rayTarget <span>=</span> <span>vec3</span><span>(</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>)</span><span>;</span>
  <span>// map from 0 to 1 to -1. to 1.</span>
  <span>vec2</span> screenPos <span>=</span> vUv <span>*</span> <span>2.0</span> <span>-</span> <span>1.</span><span>;</span>
  <span>vec3</span> rayDirection <span>=</span> <span>camera</span><span>(</span>rayOrigin<span>,</span> rayTarget<span>,</span> screenPos<span>,</span> lensLength<span>)</span><span>;</span>

  <span>vec2</span> collision <span>=</span> <span>raymarch</span><span>(</span>rayOrigin<span>,</span> rayDirection<span>)</span><span>;</span>

  <span>// If the ray collides, draw the surface</span>
  <span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
    color <span>=</span> <span>vec3</span><span>(</span><span>0.678</span><span>,</span> <span>0.106</span><span>,</span> <span>0.176</span><span>)</span><span>;</span>
  <span>}</span>

  gl_FragColor <span>=</span> <span>vec4</span><span>(</span>color<span>,</span> <span>1</span><span>)</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">Check it out! We’ve got a spinning donut 🍩 But it looks kinda flat. Let’s add some depth to the scene.</p><h3 id="calculating-normals" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#calculating-normals" aria-label="calculating normals permalink" color="brand.main" font-family="systemSans"></a>Calculating normals</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">For the classic material and lighting combination, we need to calculate surface normals. That is, a vector that points away from the surface at a given point.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">With SDFs, we calculate the normal by taking the gradient of the SDF function (f) at a specific point, denoted as ∇f. I don’t know about you, but the last time I took a gradient was in <a href="https://apps.ualberta.ca/catalogue/course/mec_e/537" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">MEC E 537 - Aerodynamics</a>. And that was a while ago 😅</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Luckily for us, we can use the <code>glsl-sdf-normal</code> module to compute normals for us. The module uses the same <code>doModel</code> function that we defined for raymarching. If you’re curious about the underlying math, check out <a href="https://jamie-wong.com/2016/07/15/ray-marching-signed-distance-functions/#surface-normals-and-lighting" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Jamie Wong’s explanation</a>.</p><div data-language="glsl"><pre><code><span><span>#</span><span>pragma</span> <span>glslify<span>:</span> normal <span>=</span> <span>require</span><span>(</span></span><span>'glsl-sdf-normal'</span><span><span>,</span> map <span>=</span> doModel<span>)</span></span></span>

<span>// ...</span>

<span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// Determine the point of collision</span>
  <span>vec3</span> pos <span>=</span> rayOrigin <span>+</span> rayDirection <span>*</span> collision<span>.</span>x<span>;</span>
  <span>// Calculate the normal</span>
  <span>vec3</span> nor <span>=</span> <span>normal</span><span>(</span>pos<span>)</span><span>;</span>
  <span>// Convert the normal to a color</span>
  color <span>=</span> nor <span>*</span> <span>0.5</span> <span>+</span> <span>0.5</span><span>;</span>
<span>}</span>

<span>// ...</span></code></pre></div><h3 id="phong-lighting" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#phong-lighting" aria-label="phong lighting permalink" color="brand.main" font-family="systemSans"></a>Phong lighting</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">My personal philosophy is very much:</p><p><img alt="Fuck around find out" src="https://varun.ca/static/fuck-around-find-out-cc2e14bf2895e5634f02f2f2475d8531.jpg" display="block"></p><p font-family="systemSans" color="neutral.0" font-size="2,3">It’s important to understand how things work, but I’m less focused on implementing everything from scratch and more intrigued by applying those concepts to create my own sketches and scenes. That’s why I was super excited to come across <a href="http://stack.gl/packages" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">stack.gl/packages</a>.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">The stackgl ecosystem is full of little GLSL modules that you can glue these together to create all kinds of effects.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Interested in adding lighting to the scene? What type would you prefer? Lambert, Phong, Beckmann, or Specular? Just grab the associated module and plug it into the scene.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">I chose <code>glsl-specular-blinn-phong</code></p><div data-language="glsl"><pre><code><span><span>#</span><span>pragma</span> <span>glslify<span>:</span> blinnPhongSpec <span>=</span> <span>require</span><span>(</span></span><span>'glsl-specular-blinn-phong'</span><span><span>)</span></span></span>

<span>// ...</span>

<span>vec3</span> lightPos <span>=</span> <span>vec3</span><span>(</span><span>1</span><span>,</span> <span>1</span><span>,</span> <span>1</span><span>)</span><span>;</span>
<span>vec3</span> tint <span>=</span> <span>vec3</span><span>(</span><span>0.05</span><span>,</span> <span>0.0</span><span>,</span> <span>0.97</span><span>)</span><span>;</span> <span>// color of the shape</span>

<span>vec2</span> collision <span>=</span> <span>raymarch</span><span>(</span>rayOrigin<span>,</span> rayDirection<span>)</span><span>;</span>

<span>// If the ray collides, draw the surface</span>
<span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// Determine the point of collision</span>
  <span>vec3</span> pos <span>=</span> rayOrigin <span>+</span> rayDirection <span>*</span> collision<span>.</span>x<span>;</span>
  <span>// Calculate the normal</span>
  <span>vec3</span> nor <span>=</span> <span>normal</span><span>(</span>pos<span>)</span><span>;</span>

  <span>// Calculate light intensity</span>
  <span>vec3</span> eyeDirection <span>=</span> <span>normalize</span><span>(</span>rayOrigin <span>-</span> pos<span>)</span><span>;</span>
  <span>vec3</span> lightDirection <span>=</span> <span>normalize</span><span>(</span>lightPos <span>-</span> pos<span>)</span><span>;</span>
  <span>float</span> power <span>=</span> <span>blinnPhongSpec</span><span>(</span>lightDirection<span>,</span> eyeDirection<span>,</span> nor<span>,</span> <span>0.5</span><span>)</span><span>;</span>
  <span>// light intensity * color of the shape</span>
  color <span>=</span> power <span>*</span> tint<span>;</span>
<span>}</span></code></pre></div><h3 id="iridescent-material" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#iridescent-material" aria-label="iridescent material permalink" color="brand.main" font-family="systemSans"></a>Iridescent material</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">Stackgl isn’t the only place where you can find useful code. My other favourite option is Shadertoy. I’m not going to lie, most things on shadertoy were too daunting for me. I couldn’t even begin to figure out what the code was doing.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">That is, until I discovered that most work on shadertoy uses a combo of raymarching + SDF. This was certainly a lightbulb moment for me. It’s like suddenly this cryptic code was deciphered and I could understand what it said.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">I’ve been obsessed with iridescence and have been bookmarking cool shaders. Once I learnt the raymarching technique, that was it. I could revisit these shaders and try to understand how they work.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">One such shader was <a href="https://www.shadertoy.com/view/llcXWM" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Thomas Hooper’s Crystals</a>. It’s way more complex than our scene but the general structure is the same. There’s a function for generating the geometry, there’s raymarching loop and after checking for collision is the bit where the iridescence effect is applied.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Let’s add that to our scene.</p><div data-language="glsl"><pre><code><span>vec3</span> <span>pal</span><span>(</span> <span>in</span> <span>float</span> t<span>,</span> <span>in</span> <span>vec3</span> a<span>,</span> <span>in</span> <span>vec3</span> b<span>,</span> <span>in</span> <span>vec3</span> c<span>,</span> <span>in</span> <span>vec3</span> d <span>)</span> <span>{</span>
  <span>return</span> a <span>+</span> b<span>*</span><span>cos</span><span>(</span> <span>6.28318</span><span>*</span><span>(</span>c<span>*</span>t<span>+</span>d<span>)</span> <span>)</span><span>;</span>
<span>}</span>

<span>vec3</span> <span>spectrum</span><span>(</span><span>float</span> n<span>)</span> <span>{</span>
  <span>return</span> <span>pal</span><span>(</span> n<span>,</span> <span>vec3</span><span>(</span><span>0.5</span><span>,</span><span>0.5</span><span>,</span><span>0.5</span><span>)</span><span>,</span><span>vec3</span><span>(</span><span>0.5</span><span>,</span><span>0.5</span><span>,</span><span>0.5</span><span>)</span><span>,</span><span>vec3</span><span>(</span><span>1.0</span><span>,</span><span>1.0</span><span>,</span><span>1.0</span><span>)</span><span>,</span><span>vec3</span><span>(</span><span>0.0</span><span>,</span><span>0.33</span><span>,</span><span>0.67</span><span>)</span> <span>)</span><span>;</span>
<span>}</span>

<span>const</span> <span>float</span> GAMMA <span>=</span> <span>2.2</span><span>;</span>

<span>vec3</span> <span>gamma</span><span>(</span><span>vec3</span> color<span>,</span> <span>float</span> g<span>)</span> <span>{</span>
  <span>return</span> <span>pow</span><span>(</span>color<span>,</span> <span>vec3</span><span>(</span>g<span>)</span><span>)</span><span>;</span>
<span>}</span>

<span>vec3</span> <span>linearToScreen</span><span>(</span><span>vec3</span> linearRGB<span>)</span> <span>{</span>
  <span>return</span> <span>gamma</span><span>(</span>linearRGB<span>,</span> <span>1.0</span> <span>/</span> GAMMA<span>)</span><span>;</span>
<span>}</span>

<span>// ...</span>

<span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// Determine the point of collision</span>
  <span>vec3</span> pos <span>=</span> rayOrigin <span>+</span> rayDirection <span>*</span> collision<span>.</span>x<span>;</span>
  <span>vec3</span> nor <span>=</span> <span>normal</span><span>(</span>pos<span>)</span><span>;</span>

  <span>vec3</span> eyeDirection <span>=</span> <span>normalize</span><span>(</span>rayOrigin <span>-</span> pos<span>)</span><span>;</span>
  <span>vec3</span> lightDirection <span>=</span> <span>normalize</span><span>(</span>lightPos <span>-</span> pos<span>)</span><span>;</span>

  <span>// Iridescent lighting</span>
  <span>vec3</span> reflection <span>=</span> <span>reflect</span><span>(</span>rayDirection<span>,</span> nor<span>)</span><span>;</span>
  <span>vec3</span> dome <span>=</span> <span>vec3</span><span>(</span><span>0</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>)</span><span>;</span>
  <span>// base layer</span>
  <span>vec3</span> perturb <span>=</span> <span>sin</span><span>(</span>pos <span>*</span> <span>10.</span><span>)</span><span>;</span>
  color <span>=</span> <span>spectrum</span><span>(</span><span>dot</span><span>(</span>nor <span>+</span> perturb <span>*</span> <span>.05</span><span>,</span> eyeDirection<span>)</span> <span>*</span> <span>2.</span><span>)</span><span>;</span>
  <span>// specular</span>
  <span>float</span> specular <span>=</span> <span>clamp</span><span>(</span><span>dot</span><span>(</span>reflection<span>,</span> lightDirection<span>)</span><span>,</span> <span>0.</span><span>,</span> <span>1.</span><span>)</span><span>;</span>
  specular <span>=</span> <span>pow</span><span>(</span><span>(</span><span>sin</span><span>(</span>specular <span>*</span> <span>20.</span> <span>-</span> <span>3.</span><span>)</span> <span>*</span> <span>.5</span> <span>+</span> <span>.5</span><span>)</span> <span>+</span> <span>.1</span><span>,</span> <span>32.</span><span>)</span> <span>*</span> specular<span>;</span>
  specular <span>*=</span> <span>.1</span><span>;</span>
  specular <span>+=</span> <span>pow</span><span>(</span><span>clamp</span><span>(</span><span>dot</span><span>(</span>reflection<span>,</span> lightDirection<span>)</span><span>,</span> <span>0.</span><span>,</span> <span>1.</span><span>)</span> <span>+</span> <span>.3</span><span>,</span> <span>8.</span><span>)</span> <span>*</span> <span>.1</span><span>;</span>
  <span>// shadow</span>
  <span>float</span> shadow <span>=</span> <span>pow</span><span>(</span><span>clamp</span><span>(</span><span>dot</span><span>(</span>nor<span>,</span> dome<span>)</span> <span>*</span> <span>.5</span> <span>+</span> <span>1.2</span><span>,</span> <span>0.</span><span>,</span> <span>1.</span><span>)</span><span>,</span> <span>3.</span><span>)</span><span>;</span>
  color <span>=</span> color <span>*</span> shadow <span>+</span> specular<span>;</span>

  <span>// gamma correction</span>
  color <span>=</span> <span>linearToScreen</span><span>(</span>color<span>)</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">There are three layers to the iridescent material: the base layer (the funky gradients), a little bit of shadow and specular (the concentric light bands). Try toggling them on and off with the slider see their effects.</p><h3 id="mix-phong-and-iridescence" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#mix-phong-and-iridescence" aria-label="mix phong and iridescence permalink" color="brand.main" font-family="systemSans"></a>Mix Phong and Iridescence</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">One last little tweak with the lighting. We can actually blend the phong and iridescence effects. Which enables you to have tinted iridescent objects.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">There’s not a whole lot to it. Calculate the colors for the two effects and then blend them with the <code>mix</code> function.</p><div data-language="glsl"><pre><code><span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// ...</span>
  <span>// Basic blinn phong lighting</span>
  <span>float</span> power <span>=</span> <span>blinnPhongSpec</span><span>(</span>lightDirection<span>,</span> eyeDirection<span>,</span> nor<span>,</span> <span>0.5</span><span>)</span><span>;</span>
  <span>vec3</span> baseColor <span>=</span> power <span>*</span> tint<span>;</span>

  <span>// Iridescent lighting</span>
  <span>// ...</span>
  color <span>=</span> color <span>*</span> shadow <span>+</span> specular<span>;</span>

  <span>// mix blinn phong lighting and iridescent lighting</span>
  color <span>=</span> <span>mix</span><span>(</span>baseColor<span>,</span> color<span>,</span> mixBaseAndIridescent<span>)</span><span>;</span>
  <span>// gamma correction</span>
  color <span>=</span> <span>linearToScreen</span><span>(</span>color<span>)</span><span>;</span>
<span>}</span></code></pre></div><h3 id="crystal-geometry" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#crystal-geometry" aria-label="crystal geometry permalink" color="brand.main" font-family="systemSans"></a>Crystal geometry</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">We’ve nailed the look, but what about the crystal shape?</p><p font-family="systemSans" color="neutral.0" font-size="2,3">You can file this under “stuff I don’t quite understand, but that’s not going to stop me from using it.” The crystal geometry is a Rhombic Triacontahedron, which I discovered in a <a href="https://www.youtube.com/watch?v=0RWaR7zApEo&amp;t=50s" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">The Art Of Code tutorial</a>.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">This shape is created by folding a plane onto itself using some “magic numbers” and along a “magic direction.” We repeat the process a few times until we achieve the desired crystal shape.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Try using the slider to observe how the shape changes with each fold.</p><div data-language="glsl"><pre><code><span>float</span> <span>sdCrystal</span><span>(</span><span>vec3</span> p<span>)</span> <span>{</span>
  <span>float</span> c <span>=</span> <span>cos</span><span>(</span><span>3.1415</span><span>/</span><span>5.</span><span>)</span><span>,</span> s<span>=</span><span>sqrt</span><span>(</span><span>0.75</span><span>-</span>c<span>*</span>c<span>)</span><span>;</span> <span>// magic numbers</span>
  <span>vec3</span> n <span>=</span> <span>vec3</span><span>(</span><span>-</span><span>0.5</span><span>,</span> <span>-</span>c<span>,</span> s<span>)</span><span>;</span> <span>// magic direction</span>

  <span>// fold the space to add symmetry</span>
  p <span>=</span> <span>abs</span><span>(</span>p<span>)</span><span>;</span>
  <span>// fold along the n direction</span>
  p <span>-=</span> <span>2.</span><span>*</span><span>min</span><span>(</span><span>0.</span><span>,</span> <span>dot</span><span>(</span>p<span>,</span> n<span>)</span><span>)</span><span>*</span>n<span>;</span>

  <span>// fold the space again and along the n direction</span>
  p<span>.</span>xy <span>=</span> <span>abs</span><span>(</span>p<span>.</span>xy<span>)</span><span>;</span>
  p <span>-=</span> <span>2.</span><span>*</span><span>min</span><span>(</span><span>0.</span><span>,</span> <span>dot</span><span>(</span>p<span>,</span> n<span>)</span><span>)</span><span>*</span>n<span>;</span>

  <span>// repeat the process</span>
  p<span>.</span>xy <span>=</span> <span>abs</span><span>(</span>p<span>.</span>xy<span>)</span><span>;</span>
  p <span>-=</span> <span>2.</span><span>*</span><span>min</span><span>(</span><span>0.</span><span>,</span> <span>dot</span><span>(</span>p<span>,</span> n<span>)</span><span>)</span><span>*</span>n<span>;</span>

  <span>// distance to the surface</span>
  <span>float</span> d <span>=</span> p<span>.</span>z <span>-</span> <span>1.</span><span>;</span>
  <span>return</span> d<span>;</span>
<span>}</span></code></pre></div></div><div display="block,block,none"><h3 id="basic-shader-scene" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#basic-shader-scene" aria-label="basic shader scene permalink" color="brand.main" font-family="systemSans"></a>Basic shader scene</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">My goto tool for creative coding is <a href="https://github.com/mattdesl/canvas-sketch" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">canvas-sketch</a>. It offers a <a href="https://github.com/mattdesl/canvas-sketch-util/blob/master/docs/shader.md#shader--createshaderopt" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">utility function</a> that creates a full-screen GLSL shader renderer using <a href="https://regl.party/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">regl</a>. You can pass in your shader code and uniforms and it takes care of the rest. Here’s an example of a shader that renders a gradient.</p><div data-language="js"><pre><code><span>const</span> canvasSketch <span>=</span> <span>require</span><span>(</span><span>'canvas-sketch'</span><span>)</span><span>;</span>
<span>const</span> createShader <span>=</span> <span>require</span><span>(</span><span>'canvas-sketch-util/shader'</span><span>)</span><span>;</span>
<span>const</span> glsl <span>=</span> <span>require</span><span>(</span><span>'glslify'</span><span>)</span><span>;</span>

<span>const</span> settings <span>=</span> <span>{</span>
  dimensions<span>:</span> <span>[</span><span>1080</span><span>,</span> <span>1080</span><span>]</span><span>,</span>
  context<span>:</span> <span>'webgl'</span><span>,</span>
  animate<span>:</span> <span>true</span><span>,</span>
<span>}</span><span>;</span>

<span>const</span> frag <span>=</span> <span>glsl</span><span>(</span><span><span>`</span><span>
  precision highp float;

  uniform float time;
  varying vec2 vUv;

  void main () {
    vec3 col = 0.5 + 0.5 * cos(time + vUv.xyx + vec3(0,2,4));
    gl_FragColor = vec4(col, 1.0);
  }
</span><span>`</span></span><span>)</span><span>;</span>

<span>const</span> <span>sketch</span> <span>=</span> <span>(</span><span><span>{</span> gl<span>,</span> canvas <span>}</span></span><span>)</span> <span>=&gt;</span> <span>{</span>
  <span>return</span> <span>createShader</span><span>(</span><span>{</span>
    gl<span>,</span>
    frag<span>,</span>
    uniforms<span>:</span> <span>{</span>
      <span>resolution</span><span>:</span> <span>(</span><span><span>{</span> width<span>,</span> height <span>}</span></span><span>)</span> <span>=&gt;</span> <span>[</span>width<span>,</span> height<span>]</span><span>,</span>
      <span>time</span><span>:</span> <span>(</span><span><span>{</span> time <span>}</span></span><span>)</span> <span>=&gt;</span> time<span>,</span>
      <span>playhead</span><span>:</span> <span>(</span><span><span>{</span> playhead <span>}</span></span><span>)</span> <span>=&gt;</span> playhead<span>,</span>
    <span>}</span><span>,</span>
  <span>}</span><span>)</span><span>;</span>
<span>}</span><span>;</span>

<span>canvasSketch</span><span>(</span>sketch<span>,</span> settings<span>)</span><span>;</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">Couple of things to note here. <code>createShader</code> bootstraps a default vertex shader (see below) that provides a varying <code>vUv</code>. This essentially maps the pixel coordinates to a value between 0 and 1. You can override this by specifying a custom vertex shader. But for most cases, this is sufficient.</p><p>vert.glsl</p><div data-language="glsl"><pre><code><span>precision</span> <span>highp</span> <span>float</span><span>;</span>
<span>attribute</span> <span>vec3</span> position<span>;</span>
<span>varying</span> <span>vec2</span> vUv<span>;</span>

<span>void</span> <span>main</span> <span>(</span><span>)</span> <span>{</span>
  gl_Position <span>=</span> <span>vec4</span><span>(</span>position<span>.</span>xyz<span>,</span> <span>1.0</span><span>)</span><span>;</span>
  vUv <span>=</span> gl_Position<span>.</span>xy <span>*</span> <span>0.5</span> <span>+</span> <span>0.5</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">I’m also using a tool called <code>glslify</code> to wrap the shader code. This enables us to import GLSL modules into our shader. We’ll use it to import SDF functions and other raymarching utilities.</p><h3 id="the-raymarching-algorithm" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#the-raymarching-algorithm" aria-label="the raymarching algorithm permalink" color="brand.main" font-family="systemSans"></a>The Raymarching Algorithm</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">Below is an implementation of the ray marching algorithm. The camera is positioned as the <code>rayOrigin</code>, and pointed towards the <code>rayTarget</code>—the center of the scene.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">The <code>rayDirection</code> is a vector that points from the origin towards a a pixel on the screen, while accounting for the camera’s orientation and field of view. It requires a bit of fancy math to figure out this direction. We’ll be using the <code>glsl-camera-ray</code> module to run that calculation.</p><p><img src="https://varun.ca/static/ray-direction-8b0a68215b4c83cd9236ca43e204a9da.svg" alt="Ray starts at the camera, goes through the pixel on the screen and moves through the scene" display="block"></p><p font-family="systemSans" color="neutral.0" font-size="2,3">Once we obtain the ray direction, we proceed along it, checking for collisions. If a collision is detected, the distance to the surface is returned. Otherwise, we return <code>-1.0</code> to signify that no collision was found.</p><div data-language="glsl"><pre><code><span>precision</span> <span>highp</span> <span>float</span><span>;</span>
<span>varying</span> <span>vec2</span> vUv<span>;</span>
<span>uniform</span> <span>float</span> lensLength<span>;</span>

<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> camera <span>=</span> <span>require</span><span>(</span></span><span>'glsl-camera-ray'</span><span><span>)</span></span></span>

<span>float</span> <span>sdSphere</span><span>(</span><span>vec3</span> point<span>,</span> <span>float</span> radius<span>)</span> <span>{</span>
  <span>return</span> <span>length</span><span>(</span>point<span>)</span> <span>-</span> radius<span>;</span>
<span>}</span>

<span>const</span> <span>int</span> steps <span>=</span> <span>90</span><span>;</span>
<span>const</span> <span>float</span> maxdist <span>=</span> <span>20.0</span><span>;</span>
<span>const</span> <span>float</span> precis <span>=</span> <span>0.001</span><span>;</span>

<span>float</span> <span>raymarch</span><span>(</span><span>vec3</span> rayOrigin<span>,</span> <span>vec3</span> rayDir<span>)</span> <span>{</span>
  <span>float</span> latest <span>=</span> precis <span>*</span> <span>2.0</span><span>;</span>
  <span>float</span> dist <span>=</span> <span>0.0</span><span>;</span>
  <span>float</span> res <span>=</span> <span>-</span><span>1.0</span><span>;</span>

  <span>// March along the ray</span>
  <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> steps<span>;</span> i<span>++</span><span>)</span> <span>{</span>
    <span>// Break if we're close enough or too far away</span>
    <span>if</span> <span>(</span>latest <span>&lt;</span> precis <span>||</span> dist <span>&gt;</span> maxdist<span>)</span> <span>break</span><span>;</span>
    <span>// Get the SDF distance</span>
    <span>float</span> latest <span>=</span> <span>sdSphere</span><span>(</span>rayOrigin <span>+</span> rayDir <span>*</span> dist<span>,</span> <span>1.0</span><span>)</span><span>;</span>
    <span>// Increment by the latest SDF distance</span>
    dist <span>+=</span> latest<span>;</span>
  <span>}</span>
  <span>// if we're still within bounds,</span>
  <span>// set the result to the distance</span>
  <span>if</span> <span>(</span>dist <span>&lt;</span> maxdist<span>)</span> <span>{</span>
    res <span>=</span> dist<span>;</span>
  <span>}</span>

  <span>return</span> res<span>;</span>
<span>}</span>

<span>void</span> <span>main</span><span>(</span><span>)</span> <span>{</span>
  <span>vec3</span> color <span>=</span> <span>vec3</span><span>(</span><span>0.0</span><span>)</span><span>;</span>

  <span>// Bootstrap a raymarching scene</span>
  <span>vec3</span> rayOrigin <span>=</span> <span>vec3</span><span>(</span><span>3.5</span><span>,</span> <span>0.</span><span>,</span> <span>3.5</span><span>)</span><span>;</span>
  <span>vec3</span> rayTarget <span>=</span> <span>vec3</span><span>(</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>)</span><span>;</span>
  <span>// map from 0 to 1 to -1. to 1.</span>
  <span>vec2</span> screenPos <span>=</span> vUv <span>*</span> <span>2.0</span> <span>-</span> <span>1.</span><span>;</span>
  <span>vec3</span> rayDirection <span>=</span> <span>camera</span><span>(</span>rayOrigin<span>,</span> rayTarget<span>,</span> screenPos<span>,</span> lensLength<span>)</span><span>;</span>

  <span>float</span> collision <span>=</span> <span>raymarch</span><span>(</span>rayOrigin<span>,</span> rayDirection<span>)</span><span>;</span>

  <span>// If the ray collides, draw the surface</span>
  <span>if</span> <span>(</span>collision <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
    color <span>=</span> <span>vec3</span><span>(</span><span>0.678</span><span>,</span> <span>0.106</span><span>,</span> <span>0.176</span><span>)</span><span>;</span>
  <span>}</span>

  gl_FragColor <span>=</span> <span>vec4</span><span>(</span>color<span>,</span> <span>1</span><span>)</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3"><code>lensLength</code> here determines the field of view. Try changing it to see how it affects the scene.</p><h3 id="using-glsl-modules-for-raymarching" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#using-glsl-modules-for-raymarching" aria-label="using glsl modules for raymarching permalink" color="brand.main" font-family="systemSans"></a>Using GLSL modules for raymarching</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">Implementing your own raymarching function is cool. It’s especially useful when you want to tweak the inner workings to achieve a specific effect. However, in most cases, you can probably just use an off-the-shelf module.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Below, I’ve updated the sketch to use the <code>glsl-raytrace</code> module. Additionally, I’m using a <code>glsl-sdf-primitives</code> module to generate a torus and <code>glsl-rotate</code> to rotate it.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">The mechanics remain largely similar. The key difference is that geometry is now defined within a function called <code>doModel</code>, and raymarch returns a <code>vec2</code> containing the distance and material index. This is useful if you want to render multiple types of objects in a scene.</p><div data-language="glsl"><pre><code><span>precision</span> <span>highp</span> <span>float</span><span>;</span>
<span>varying</span> <span>vec2</span> vUv<span>;</span>
<span>uniform</span> <span>float</span> lensLength<span>;</span>
<span>uniform</span> <span>float</span> time<span>;</span>

<span>vec2</span> <span>doModel</span><span>(</span><span>vec3</span> p<span>)</span><span>;</span>

<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> camera <span>=</span> <span>require</span><span>(</span></span><span>'glsl-camera-ray'</span><span><span>)</span></span></span>
<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> raymarch <span>=</span> <span>require</span><span>(</span></span><span>'glsl-raytrace'</span><span><span>,</span> map <span>=</span> doModel<span>,</span> steps <span>=</span> <span>90</span><span>)</span></span></span>
<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> sdTorus <span>=</span> <span>require</span><span>(</span></span><span>'glsl-sdf-primitives/sdTorus'</span><span><span>)</span></span></span>
<span><span>#</span><span>pragma</span> <span>glslify<span>:</span> rotate <span>=</span> <span>require</span><span>(</span></span><span>'glsl-rotate/rotate'</span><span><span>)</span></span></span>

<span>vec2</span> <span>doModel</span><span>(</span><span>vec3</span> p<span>)</span> <span>{</span>
  <span>// Spin the shape</span>
  p<span>.</span>xy <span>=</span> <span>rotate</span><span>(</span>p<span>.</span>xy<span>,</span> time<span>)</span><span>;</span>
  p<span>.</span>yz <span>=</span> <span>rotate</span><span>(</span>p<span>.</span>yz<span>,</span> time<span>)</span><span>;</span>
  <span>// Calculate SDF distance</span>
  <span>float</span> d <span>=</span> <span>sdTorus</span><span>(</span>p<span>,</span> <span>vec2</span><span>(</span><span>0.75</span><span>,</span> <span>0.35</span><span>)</span><span>)</span><span>;</span>
  <span>return</span> <span>vec2</span><span>(</span>d<span>,</span> <span>0.0</span><span>)</span><span>;</span>
<span>}</span>

<span>void</span> <span>main</span><span>(</span><span>)</span> <span>{</span>
  <span>vec3</span> color <span>=</span> <span>vec3</span><span>(</span><span>0.0</span><span>)</span><span>;</span>
  <span>// Bootstrap a raytracing scene</span>
  <span>vec3</span> rayOrigin <span>=</span> <span>vec3</span><span>(</span><span>3.5</span><span>,</span> <span>0</span><span>,</span> <span>3.5</span><span>)</span><span>;</span>
  <span>vec3</span> rayTarget <span>=</span> <span>vec3</span><span>(</span><span>0</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>)</span><span>;</span>
  <span>// map from 0 to 1 to -1. to 1.</span>
  <span>vec2</span> screenPos <span>=</span> vUv <span>*</span> <span>2.0</span> <span>-</span> <span>1.</span><span>;</span>
  <span>vec3</span> rayDirection <span>=</span> <span>camera</span><span>(</span>rayOrigin<span>,</span> rayTarget<span>,</span> screenPos<span>,</span> lensLength<span>)</span><span>;</span>

  <span>vec2</span> collision <span>=</span> <span>raymarch</span><span>(</span>rayOrigin<span>,</span> rayDirection<span>)</span><span>;</span>

  <span>// If the ray collides, draw the surface</span>
  <span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
    color <span>=</span> <span>vec3</span><span>(</span><span>0.678</span><span>,</span> <span>0.106</span><span>,</span> <span>0.176</span><span>)</span><span>;</span>
  <span>}</span>

  gl_FragColor <span>=</span> <span>vec4</span><span>(</span>color<span>,</span> <span>1</span><span>)</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">Check it out! We’ve got a spinning donut 🍩 But it looks kinda flat. Let’s add some depth to the scene.</p><h3 id="calculating-normals" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#calculating-normals" aria-label="calculating normals permalink" color="brand.main" font-family="systemSans"></a>Calculating normals</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">For the classic material and lighting combination, we need to calculate surface normals. That is, a vector that points away from the surface at a given point.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">With SDFs, we calculate the normal by taking the gradient of the SDF function (f) at a specific point, denoted as ∇f. I don’t know about you, but the last time I took a gradient was in <a href="https://apps.ualberta.ca/catalogue/course/mec_e/537" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">MEC E 537 - Aerodynamics</a>. And that was a while ago 😅</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Luckily for us, we can use the <code>glsl-sdf-normal</code> module to compute normals for us. The module uses the same <code>doModel</code> function that we defined for raymarching. If you’re curious about the underlying math, check out <a href="https://jamie-wong.com/2016/07/15/ray-marching-signed-distance-functions/#surface-normals-and-lighting" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Jamie Wong’s explanation</a>.</p><div data-language="glsl"><pre><code><span><span>#</span><span>pragma</span> <span>glslify<span>:</span> normal <span>=</span> <span>require</span><span>(</span></span><span>'glsl-sdf-normal'</span><span><span>,</span> map <span>=</span> doModel<span>)</span></span></span>

<span>// ...</span>

<span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// Determine the point of collision</span>
  <span>vec3</span> pos <span>=</span> rayOrigin <span>+</span> rayDirection <span>*</span> collision<span>.</span>x<span>;</span>
  <span>// Calculate the normal</span>
  <span>vec3</span> nor <span>=</span> <span>normal</span><span>(</span>pos<span>)</span><span>;</span>
  <span>// Convert the normal to a color</span>
  color <span>=</span> nor <span>*</span> <span>0.5</span> <span>+</span> <span>0.5</span><span>;</span>
<span>}</span>

<span>// ...</span></code></pre></div><h3 id="phong-lighting" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#phong-lighting" aria-label="phong lighting permalink" color="brand.main" font-family="systemSans"></a>Phong lighting</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">My personal philosophy is very much:</p><p><img alt="Fuck around find out" src="https://varun.ca/static/fuck-around-find-out-cc2e14bf2895e5634f02f2f2475d8531.jpg" display="block"></p><p font-family="systemSans" color="neutral.0" font-size="2,3">It’s important to understand how things work, but I’m less focused on implementing everything from scratch and more intrigued by applying those concepts to create my own sketches and scenes. That’s why I was super excited to come across <a href="http://stack.gl/packages" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">stack.gl/packages</a>.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">The stackgl ecosystem is full of little GLSL modules that you can glue these together to create all kinds of effects.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Interested in adding lighting to the scene? What type would you prefer? Lambert, Phong, Beckmann, or Specular? Just grab the associated module and plug it into the scene.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">I chose <code>glsl-specular-blinn-phong</code></p><div data-language="glsl"><pre><code><span><span>#</span><span>pragma</span> <span>glslify<span>:</span> blinnPhongSpec <span>=</span> <span>require</span><span>(</span></span><span>'glsl-specular-blinn-phong'</span><span><span>)</span></span></span>

<span>// ...</span>

<span>vec3</span> lightPos <span>=</span> <span>vec3</span><span>(</span><span>1</span><span>,</span> <span>1</span><span>,</span> <span>1</span><span>)</span><span>;</span>
<span>vec3</span> tint <span>=</span> <span>vec3</span><span>(</span><span>0.05</span><span>,</span> <span>0.0</span><span>,</span> <span>0.97</span><span>)</span><span>;</span> <span>// color of the shape</span>

<span>vec2</span> collision <span>=</span> <span>raymarch</span><span>(</span>rayOrigin<span>,</span> rayDirection<span>)</span><span>;</span>

<span>// If the ray collides, draw the surface</span>
<span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// Determine the point of collision</span>
  <span>vec3</span> pos <span>=</span> rayOrigin <span>+</span> rayDirection <span>*</span> collision<span>.</span>x<span>;</span>
  <span>// Calculate the normal</span>
  <span>vec3</span> nor <span>=</span> <span>normal</span><span>(</span>pos<span>)</span><span>;</span>

  <span>// Calculate light intensity</span>
  <span>vec3</span> eyeDirection <span>=</span> <span>normalize</span><span>(</span>rayOrigin <span>-</span> pos<span>)</span><span>;</span>
  <span>vec3</span> lightDirection <span>=</span> <span>normalize</span><span>(</span>lightPos <span>-</span> pos<span>)</span><span>;</span>
  <span>float</span> power <span>=</span> <span>blinnPhongSpec</span><span>(</span>lightDirection<span>,</span> eyeDirection<span>,</span> nor<span>,</span> <span>0.5</span><span>)</span><span>;</span>
  <span>// light intensity * color of the shape</span>
  color <span>=</span> power <span>*</span> tint<span>;</span>
<span>}</span></code></pre></div><h3 id="iridescent-material" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#iridescent-material" aria-label="iridescent material permalink" color="brand.main" font-family="systemSans"></a>Iridescent material</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">Stackgl isn’t the only place where you can find useful code. My other favourite option is Shadertoy. I’m not going to lie, most things on shadertoy were too daunting for me. I couldn’t even begin to figure out what the code was doing.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">That is, until I discovered that most work on shadertoy uses a combo of raymarching + SDF. This was certainly a lightbulb moment for me. It’s like suddenly this cryptic code was deciphered and I could understand what it said.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">I’ve been obsessed with iridescence and have been bookmarking cool shaders. Once I learnt the raymarching technique, that was it. I could revisit these shaders and try to understand how they work.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">One such shader was <a href="https://www.shadertoy.com/view/llcXWM" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Thomas Hooper’s Crystals</a>. It’s way more complex than our scene but the general structure is the same. There’s a function for generating the geometry, there’s raymarching loop and after checking for collision is the bit where the iridescence effect is applied.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Let’s add that to our scene.</p><div data-language="glsl"><pre><code><span>vec3</span> <span>pal</span><span>(</span> <span>in</span> <span>float</span> t<span>,</span> <span>in</span> <span>vec3</span> a<span>,</span> <span>in</span> <span>vec3</span> b<span>,</span> <span>in</span> <span>vec3</span> c<span>,</span> <span>in</span> <span>vec3</span> d <span>)</span> <span>{</span>
  <span>return</span> a <span>+</span> b<span>*</span><span>cos</span><span>(</span> <span>6.28318</span><span>*</span><span>(</span>c<span>*</span>t<span>+</span>d<span>)</span> <span>)</span><span>;</span>
<span>}</span>

<span>vec3</span> <span>spectrum</span><span>(</span><span>float</span> n<span>)</span> <span>{</span>
  <span>return</span> <span>pal</span><span>(</span> n<span>,</span> <span>vec3</span><span>(</span><span>0.5</span><span>,</span><span>0.5</span><span>,</span><span>0.5</span><span>)</span><span>,</span><span>vec3</span><span>(</span><span>0.5</span><span>,</span><span>0.5</span><span>,</span><span>0.5</span><span>)</span><span>,</span><span>vec3</span><span>(</span><span>1.0</span><span>,</span><span>1.0</span><span>,</span><span>1.0</span><span>)</span><span>,</span><span>vec3</span><span>(</span><span>0.0</span><span>,</span><span>0.33</span><span>,</span><span>0.67</span><span>)</span> <span>)</span><span>;</span>
<span>}</span>

<span>const</span> <span>float</span> GAMMA <span>=</span> <span>2.2</span><span>;</span>

<span>vec3</span> <span>gamma</span><span>(</span><span>vec3</span> color<span>,</span> <span>float</span> g<span>)</span> <span>{</span>
  <span>return</span> <span>pow</span><span>(</span>color<span>,</span> <span>vec3</span><span>(</span>g<span>)</span><span>)</span><span>;</span>
<span>}</span>

<span>vec3</span> <span>linearToScreen</span><span>(</span><span>vec3</span> linearRGB<span>)</span> <span>{</span>
  <span>return</span> <span>gamma</span><span>(</span>linearRGB<span>,</span> <span>1.0</span> <span>/</span> GAMMA<span>)</span><span>;</span>
<span>}</span>

<span>// ...</span>

<span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// Determine the point of collision</span>
  <span>vec3</span> pos <span>=</span> rayOrigin <span>+</span> rayDirection <span>*</span> collision<span>.</span>x<span>;</span>
  <span>vec3</span> nor <span>=</span> <span>normal</span><span>(</span>pos<span>)</span><span>;</span>

  <span>vec3</span> eyeDirection <span>=</span> <span>normalize</span><span>(</span>rayOrigin <span>-</span> pos<span>)</span><span>;</span>
  <span>vec3</span> lightDirection <span>=</span> <span>normalize</span><span>(</span>lightPos <span>-</span> pos<span>)</span><span>;</span>

  <span>// Iridescent lighting</span>
  <span>vec3</span> reflection <span>=</span> <span>reflect</span><span>(</span>rayDirection<span>,</span> nor<span>)</span><span>;</span>
  <span>vec3</span> dome <span>=</span> <span>vec3</span><span>(</span><span>0</span><span>,</span> <span>1</span><span>,</span> <span>0</span><span>)</span><span>;</span>
  <span>// base layer</span>
  <span>vec3</span> perturb <span>=</span> <span>sin</span><span>(</span>pos <span>*</span> <span>10.</span><span>)</span><span>;</span>
  color <span>=</span> <span>spectrum</span><span>(</span><span>dot</span><span>(</span>nor <span>+</span> perturb <span>*</span> <span>.05</span><span>,</span> eyeDirection<span>)</span> <span>*</span> <span>2.</span><span>)</span><span>;</span>
  <span>// specular</span>
  <span>float</span> specular <span>=</span> <span>clamp</span><span>(</span><span>dot</span><span>(</span>reflection<span>,</span> lightDirection<span>)</span><span>,</span> <span>0.</span><span>,</span> <span>1.</span><span>)</span><span>;</span>
  specular <span>=</span> <span>pow</span><span>(</span><span>(</span><span>sin</span><span>(</span>specular <span>*</span> <span>20.</span> <span>-</span> <span>3.</span><span>)</span> <span>*</span> <span>.5</span> <span>+</span> <span>.5</span><span>)</span> <span>+</span> <span>.1</span><span>,</span> <span>32.</span><span>)</span> <span>*</span> specular<span>;</span>
  specular <span>*=</span> <span>.1</span><span>;</span>
  specular <span>+=</span> <span>pow</span><span>(</span><span>clamp</span><span>(</span><span>dot</span><span>(</span>reflection<span>,</span> lightDirection<span>)</span><span>,</span> <span>0.</span><span>,</span> <span>1.</span><span>)</span> <span>+</span> <span>.3</span><span>,</span> <span>8.</span><span>)</span> <span>*</span> <span>.1</span><span>;</span>
  <span>// shadow</span>
  <span>float</span> shadow <span>=</span> <span>pow</span><span>(</span><span>clamp</span><span>(</span><span>dot</span><span>(</span>nor<span>,</span> dome<span>)</span> <span>*</span> <span>.5</span> <span>+</span> <span>1.2</span><span>,</span> <span>0.</span><span>,</span> <span>1.</span><span>)</span><span>,</span> <span>3.</span><span>)</span><span>;</span>
  color <span>=</span> color <span>*</span> shadow <span>+</span> specular<span>;</span>

  <span>// gamma correction</span>
  color <span>=</span> <span>linearToScreen</span><span>(</span>color<span>)</span><span>;</span>
<span>}</span></code></pre></div><p font-family="systemSans" color="neutral.0" font-size="2,3">There are three layers to the iridescent material: the base layer (the funky gradients), a little bit of shadow and specular (the concentric light bands). Try toggling them on and off with the slider see their effects.</p><h3 id="mix-phong-and-iridescence" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#mix-phong-and-iridescence" aria-label="mix phong and iridescence permalink" color="brand.main" font-family="systemSans"></a>Mix Phong and Iridescence</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">One last little tweak with the lighting. We can actually blend the phong and iridescence effects. Which enables you to have tinted iridescent objects.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">There’s not a whole lot to it. Calculate the colors for the two effects and then blend them with the <code>mix</code> function.</p><div data-language="glsl"><pre><code><span>if</span> <span>(</span>collision<span>.</span>x <span>&gt;</span> <span>-</span><span>0.5</span><span>)</span> <span>{</span>
  <span>// ...</span>
  <span>// Basic blinn phong lighting</span>
  <span>float</span> power <span>=</span> <span>blinnPhongSpec</span><span>(</span>lightDirection<span>,</span> eyeDirection<span>,</span> nor<span>,</span> <span>0.5</span><span>)</span><span>;</span>
  <span>vec3</span> baseColor <span>=</span> power <span>*</span> tint<span>;</span>

  <span>// Iridescent lighting</span>
  <span>// ...</span>
  color <span>=</span> color <span>*</span> shadow <span>+</span> specular<span>;</span>

  <span>// mix blinn phong lighting and iridescent lighting</span>
  color <span>=</span> <span>mix</span><span>(</span>baseColor<span>,</span> color<span>,</span> mixBaseAndIridescent<span>)</span><span>;</span>
  <span>// gamma correction</span>
  color <span>=</span> <span>linearToScreen</span><span>(</span>color<span>)</span><span>;</span>
<span>}</span></code></pre></div><h3 id="crystal-geometry" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#crystal-geometry" aria-label="crystal geometry permalink" color="brand.main" font-family="systemSans"></a>Crystal geometry</h3><p font-family="systemSans" color="neutral.0" font-size="2,3">We’ve nailed the look, but what about the crystal shape?</p><p font-family="systemSans" color="neutral.0" font-size="2,3">You can file this under “stuff I don’t quite understand, but that’s not going to stop me from using it.” The crystal geometry is a Rhombic Triacontahedron, which I discovered in a <a href="https://www.youtube.com/watch?v=0RWaR7zApEo&amp;t=50s" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">The Art Of Code tutorial</a>.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">This shape is created by folding a plane onto itself using some “magic numbers” and along a “magic direction.” We repeat the process a few times until we achieve the desired crystal shape.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Try using the slider to observe how the shape changes with each fold.</p><div data-language="glsl"><pre><code><span>float</span> <span>sdCrystal</span><span>(</span><span>vec3</span> p<span>)</span> <span>{</span>
  <span>float</span> c <span>=</span> <span>cos</span><span>(</span><span>3.1415</span><span>/</span><span>5.</span><span>)</span><span>,</span> s<span>=</span><span>sqrt</span><span>(</span><span>0.75</span><span>-</span>c<span>*</span>c<span>)</span><span>;</span> <span>// magic numbers</span>
  <span>vec3</span> n <span>=</span> <span>vec3</span><span>(</span><span>-</span><span>0.5</span><span>,</span> <span>-</span>c<span>,</span> s<span>)</span><span>;</span> <span>// magic direction</span>

  <span>// fold the space to add symmetry</span>
  p <span>=</span> <span>abs</span><span>(</span>p<span>)</span><span>;</span>
  <span>// fold along the n direction</span>
  p <span>-=</span> <span>2.</span><span>*</span><span>min</span><span>(</span><span>0.</span><span>,</span> <span>dot</span><span>(</span>p<span>,</span> n<span>)</span><span>)</span><span>*</span>n<span>;</span>

  <span>// fold the space again and along the n direction</span>
  p<span>.</span>xy <span>=</span> <span>abs</span><span>(</span>p<span>.</span>xy<span>)</span><span>;</span>
  p <span>-=</span> <span>2.</span><span>*</span><span>min</span><span>(</span><span>0.</span><span>,</span> <span>dot</span><span>(</span>p<span>,</span> n<span>)</span><span>)</span><span>*</span>n<span>;</span>

  <span>// repeat the process</span>
  p<span>.</span>xy <span>=</span> <span>abs</span><span>(</span>p<span>.</span>xy<span>)</span><span>;</span>
  p <span>-=</span> <span>2.</span><span>*</span><span>min</span><span>(</span><span>0.</span><span>,</span> <span>dot</span><span>(</span>p<span>,</span> n<span>)</span><span>)</span><span>*</span>n<span>;</span>

  <span>// distance to the surface</span>
  <span>float</span> d <span>=</span> p<span>.</span>z <span>-</span> <span>1.</span><span>;</span>
  <span>return</span> d<span>;</span>
<span>}</span></code></pre></div></div></div><h2 id="and-thats-that" font-family="systemSans" color="neutral.0" font-size="4,5" font-weight="7"><a href="#and-thats-that" aria-label="and thats that permalink" color="brand.main" font-family="systemSans"></a>And that’s that!</h2><p font-family="systemSans" color="neutral.0" font-size="2,3">Raymarching with SDF isn’t better than the conventional mesh based approach; it’s just different. However, it offers the ability to create unique and visually striking effects, making it a fantastic tool to have in your creative coding toolbox. Plus, with glslify and the <a href="http://stack.gl/packages" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">stack.gl ecosystem</a> you can use off-the-shelf modules to get going quickly.</p><p font-family="systemSans" color="neutral.0" font-size="2,3">Checkout the <a href="https://github.com/winkerVSbecks/shader-sketches/blob/main/sketches/sdf-iridescent-crystal.js" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">full source</a> for the crystal sketch on Github. Want to take it a step further? I’ve expanded this sketch to combine refraction and iridescence to make a <a href="https://github.com/winkerVSbecks/shader-sketches/blob/main/sketches/refraction-iridescent.js" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">see through crystal</a>.</p><h3 id="reference" font-family="systemSans" color="neutral.0" font-size="3,4" font-weight="7"><a href="#reference" aria-label="reference permalink" color="brand.main" font-family="systemSans"></a>Reference</h3><ul><li font-family="systemSans" color="neutral.0" font-size="2,3"><a href="https://jasmcole.com/2019/10/03/signed-distance-fields/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Signed distance fields by Jason Cole</a></li><li font-family="systemSans" color="neutral.0" font-size="2,3"><a href="https://iquilezles.org/articles/distfunctions/" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">3D distance functions by Inigo Quilez</a></li><li font-family="systemSans" color="neutral.0" font-size="2,3"><a href="https://www.shadertoy.com/view/ldfSWs" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Raymarching template</a></li><li font-family="systemSans" color="neutral.0" font-size="2,3"><a href="https://youtu.be/NCpaaLkmXI8" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Bending Light by The Art of Code (part 1)</a> &amp; <a href="https://youtu.be/0RWaR7zApEo" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">part 2</a></li></ul></article><p font-size="2" font-family="systemSans" color="neutral.0">Questions, Comments or Suggestions?<!-- --> <a href="https://github.com/winkerVSbecks/varun.ca/issues/new?title=Iridescent%20crystal%20with%20raymarching%20and%20signed%20distance%20fields" target="_blank" rel="noopener noreferrer" color="brand.main" font-family="systemSans">Open an Issue</a></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Monday was hottest day for global average temperature, as climate crisis bites (140 pts)]]></title>
            <link>https://www.theguardian.com/world/2023/jul/04/monday-was-hottest-day-for-global-average-temperature-on-record-as-climate-crisis-bites</link>
            <guid>36591402</guid>
            <pubDate>Tue, 04 Jul 2023 19:18:45 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theguardian.com/world/2023/jul/04/monday-was-hottest-day-for-global-average-temperature-on-record-as-climate-crisis-bites">https://www.theguardian.com/world/2023/jul/04/monday-was-hottest-day-for-global-average-temperature-on-record-as-climate-crisis-bites</a>, See on <a href="https://news.ycombinator.com/item?id=36591402">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="maincontent"><p>This Monday, 3 July 2023, was the hottest day ever recorded globally, according to data from the US National Centers for Environmental Prediction.</p><p>The average global temperature reached 17.01C (62.62F), surpassing the August 2016 record of 16.92C (62.46F), as heatwaves sizzled around the world.</p><figure id="80976557-4cfe-4dfe-a401-391b7535fb9d" data-spacefinder-role="richLink" data-spacefinder-type="model.dotcomrendering.pageElements.RichLinkBlockElement"><gu-island name="RichLinkComponent" deferuntil="idle" props="{&quot;richLinkIndex&quot;:2,&quot;element&quot;:{&quot;_type&quot;:&quot;model.dotcomrendering.pageElements.RichLinkBlockElement&quot;,&quot;url&quot;:&quot;https://www.theguardian.com/environment/2023/jul/04/climate-heating-el-nino-has-arrived-and-threatens-lives-declares-un&quot;,&quot;text&quot;:&quot;Climate-heating El Niño has arrived and threatens lives, declares UN&quot;,&quot;prefix&quot;:&quot;Related: &quot;,&quot;role&quot;:&quot;richLink&quot;,&quot;elementId&quot;:&quot;80976557-4cfe-4dfe-a401-391b7535fb9d&quot;},&quot;ajaxUrl&quot;:&quot;https://api.nextgen.guardianapps.co.uk&quot;,&quot;format&quot;:{&quot;display&quot;:0,&quot;theme&quot;:0,&quot;design&quot;:0}}"></gu-island></figure><p>The southern US has <a href="https://www.theguardian.com/us-news/2023/jul/01/texas-extreme-heat-heatwave">been suffering</a> under an <a href="https://www.theguardian.com/us-news/2023/jul/03/heat-dome-keeps-new-orleans-broiling-with-heat-index-as-high-as-110f">intense heat dome</a> in recent weeks amid <a href="https://www.theguardian.com/world/extreme-weather">extreme weather</a>, probably driven by the human-caused climate crisis, <a href="https://www.theguardian.com/environment/2023/jun/27/heatwave-human-caused-climate-crisis-texas-louisiana-mexico">experts said</a>. In parts of China, an <a href="https://www.theguardian.com/world/2023/jun/30/as-beijing-swelters-activists-hope-the-heat-will-prompt-climate-action">enduring heatwave</a> continued, with temperatures above 35C (95F). North Africa has seen temperatures near 50C (122F), with, in the Middle East, <a href="https://www.theguardian.com/world/2023/jun/30/thousands-suffer-heat-stress-on-hajj-pilgrimage-as-temperatures-reach-48c">thousands suffering</a> from unusually scorching heat during the hajj religious pilgrimage in Saudi Arabia.</p><p>And even <a href="https://www.theguardian.com/world/antarctica">Antarctica</a>, currently in its winter, registered anomalously high temperatures, as <a href="https://www.theguardian.com/science/2023/may/25/slowing-ocean-current-caused-by-melting-antarctic-ice-could-have-drastic-climate-impact-study-says">glacier melt</a> accelerates and the sun intensifies. Ukraine’s Vernadsky research base, in the vast frozen continent’s Argentine Islands, recently broke its July temperature record with a reading of 8.7C (47.6F).</p><p>Jeni Miller, executive director of the California-based Global Climate and Health Alliance, an international consortium of health organizations, said: “People around the world are already enduring climate impacts, from heatwaves, wildfires and air pollution to floods and extreme storms. Global warming is also exacerbating crop losses and the spread of infectious diseases, as well as migration.”</p><p>She added: “The extraction and use of coal, oil and gas harm people’s health, are the primary driver of warming and are incompatible with a healthy climate future. That’s all the more reason that governments must prepare to deliver a commitment at <a href="https://www.theguardian.com/environment/cop28">Cop28</a> to phase out all fossil fuels, and a just transition to renewable energy for all.”</p><p>Climate scientist Friederike Otto of the Grantham Institute for Climate Change and the Environment at Britain’s Imperial College London, said: “It’s a death sentence for people and ecosystems.”</p><p>Scientists lamented the climate crisis, accelerated by the <a href="https://www.theguardian.com/environment/2023/jul/04/climate-heating-el-nino-has-arrived-and-threatens-lives-declares-un">El Niño weather pattern</a>, the latest of which the United Nations’ World Meteorological Organization (WMO) warned this week had begun. The last major <a href="https://www.theguardian.com/environment/elnino">El Niño</a> was in 2016, which was the hottest year on record – until now.</p><figure data-spacefinder-role="inline" data-spacefinder-type="model.dotcomrendering.pageElements.NewsletterSignupBlockElement"><a data-ignore="global-link-styling" href="#EmailSignup-skip-link-9">skip past newsletter promotion</a><p id="EmailSignup-skip-link-9" tabindex="0" aria-label="after newsletter promotion" role="note">after newsletter promotion</p></figure><p>Of the new temperature record announced on Tuesday, Zeke Hausfather, a research scientist at Berkeley Earth, said: “Unfortunately, it promises to only be the first in a series of new records set this year as increasing emissions of [carbon dioxide] and greenhouse gases, coupled with a growing El Niño event, push temperatures to new highs.”</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Type system updates: moving from research into development (258 pts)]]></title>
            <link>https://elixir-lang.org/blog/2023/06/22/type-system-updates-research-dev/</link>
            <guid>36591313</guid>
            <pubDate>Tue, 04 Jul 2023 19:11:43 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://elixir-lang.org/blog/2023/06/22/type-system-updates-research-dev/">https://elixir-lang.org/blog/2023/06/22/type-system-updates-research-dev/</a>, See on <a href="https://news.ycombinator.com/item?id=36591313">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main">
        <p>A year ago, at ElixirConf EU 2022, we announced an effort to research
and develop a type system for Elixir (<a href="https://www.youtube.com/watch?v=Jf5Hsa1KOc8">video presentation</a>)
(<a href="https://elixir-lang.org/blog/2022/10/05/my-future-with-elixir-set-theoretic-types/">written report</a>).</p>

<p>This work is happening under the lead of <a href="https://www.irif.fr/~gc/">Giuseppe Castagna</a>,
CNRS Senior Researcher, and taken by
<a href="https://www.irif.fr/users/gduboc/index">Guillaume Duboc</a> as part of his
PhD studies, with further guidance from myself (José Valim).</p>

<p>This article is a summary of where we are in our efforts and where we
are going.</p>

<h2 id="out-of-research">Out of research</h2>

<p>Our main goal during research is to find a type system that can model
most of Elixir’s functional semantics and develop brand new theory on
the areas we found to be incompatible or lacking. We believe we were
able to achieve this goal with a gradual set-theoretic type system
and we are now ready to head towards development. Over the last 2 months,
we have published plenty of resources on our results:</p>

<ul>
  <li><a href="https://arxiv.org/abs/2306.06391">A technical report on the design principles of the Elixir type system</a></li>
  <li><a href="https://youtube.com/watch?v=gJJH7a2J9O8">A technical presentation by Guillaume Duboc at ElixirConf 2023 on the work above</a></li>
  <li><a href="https://smartlogic.io/podcast/elixir-wizards/s10-e12-jose-guillaume-giuseppe-types-elixir/">An informal discussion with Giuseppe Castagna, Guillaume Duboc, and José Valim on the SmartLogic podcast</a></li>
  <li><a href="https://www.twitch.tv/videos/1841707383">An informal Q&amp;A with Guillaume Duboc, José Valim, and the community on Twitch</a></li>
</ul>

<p>Our focus so far has been on the semantics. While we have introduced a
new syntax capable of expressing the semantics of the new set-theoretic
type system, the syntax is not final as there are still no concrete
plans for user-facing changes to the language. Once we are confident
those changes will happen, we will have plenty of discussion with the
community about the type system interface and its syntax.</p>

<p>The work so far has been made possible thanks to a partnership between
the <a href="https://www.cnrs.fr/fr">CNRS</a> and <a href="https://remote.com/">Remote</a>,
with sponsorships from <a href="https://www.fresha.com/">Fresha</a>,
<a href="https://supabase.com/">Supabase</a>, and <a href="https://dashbit.co/">Dashbit</a>.</p>



<p>While there is still on-going research, our focus for the second semester
of 2023 onwards is on development.</p>

<p>Incorporating a type system into a language used at scale can be a daunting
task. Our concerns range from how the community will interact and use the
type system to how it will perform on large codebases. Therefore, our plan
is to gradually introduce our gradual (pun intended) type system into the
Elixir compiler.</p>

<p>In the first release, types will be used just internally by the compiler.
The type system will extract type information from patterns and guards to
find the most obvious mistakes, such as typos in field names or type
mismatches from attempting to add an integer to a string, without introducing
any user-facing changes to the language. At this stage, our main goal is
to assess the performance impact of the type system and the quality of
the reports we can generate in case of typing violations. If we are
unhappy with the results, we still have time to reassess our work or drop
the initiative altogether.</p>

<p>The second milestone is to introduce type annotations only in structs,
which are named and statically-defined in Elixir codebases. Elixir programs
frequently pattern match on structs, which reveals information about
the struct fields, but it knows nothing about their respective types.
By propagating types from structs and their fields throughout the program,
we will increase the type system’s ability to find errors while further
straining our type system implementation.</p>

<p>The third milestone is to introduce the (most likely) <code>$</code>-prefixed type
annotations for functions, with no or very limited type reconstruction:
users can annotate their code with types, but any untyped parameter
will be assumed to be of the <code>dynamic()</code> type. If successful, then we
will effectively have introduced a type system into the language.</p>

<p>This new exciting development stage is sponsored by <a href="https://www.fresha.com/">Fresha</a> (<a href="https://www.fresha.com/careers/openings?department=engineering">they are hiring!</a>),
<a href="https://starfish.team/">Starfish*</a> (<a href="https://starfish.team/jobs/experienced-elixir-developer">they are hiring!</a>),
and <a href="https://dashbit.co/">Dashbit</a>.</p>

      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Designing a Language Without a Parser (107 pts)]]></title>
            <link>https://thunderseethe.dev/posts/type-inference/</link>
            <guid>36591079</guid>
            <pubDate>Tue, 04 Jul 2023 18:52:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://thunderseethe.dev/posts/type-inference/">https://thunderseethe.dev/posts/type-inference/</a>, See on <a href="https://news.ycombinator.com/item?id=36591079">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><h2 id="intro">Intro
<a href="#intro">
<span>Link to heading</span></a></h2><p>I’d like to design a language, more specifically implement a compiler for a programming language I’ve made up. This is not the first time I’ve wanted to do this. In fact, I’ve had the <a href="https://github.com/thunderseethe/waht" target="_blank" rel="noopener">itch</a> <a href="https://github.com/thunderseethe/panera" target="_blank" rel="noopener">quite a</a> <a href="https://github.com/thunderseethe/brainfuck_interpreter" target="_blank" rel="noopener">few</a> <a href="https://github.com/thunderseethe/false_interpreter" target="_blank" rel="noopener">times</a> <a href="https://github.com/thunderseethe/tiger" target="_blank" rel="noopener">before</a>. I can’t tell you why I keep returning to this venture when I’ve failed at it so many times. What I can tell you is why I always fail. Every time I begin a sparkly new project with fresh eyes and quickly whip together a lexer.</p><p>However, once I start constructing a parser, progress slows to a crawl. I endlessly struggle with bikeshedding my syntax or fret to figure out my operator precedence. Without fail by the time I’ve managed to produce an Abstract Syntax Tree (AST) I’ve lost all steam. The language is added to my ever-growing pile of incomplete side projects doomed to forever be an empty repository of listless aspirations. The more attempts I’ve made the clearer this pattern has become to me.</p><p>So let’s take a step back, why do I start with the lexer and parser at all? Compiler construction can be thought of as a couple of big steps where the output of each step is fed as input into the next step:</p><p><img src="https://thunderseethe.dev/img/compiler_pipeline.svg" alt="Infographic for Compiler Pipeline"></p><p>Because the compiler executes these steps in order when it runs, it’s natural to think about creating them in order. The problem is compounded by the educational material on creating languages. Teaching material focuses a <strong>lot</strong> on the many methods by which you can parse text. It’s to the point that the wonderful <a href="https://craftinginterpreters.com/" target="_blank" rel="noopener">Crafting Interpreters</a> felt the need to include <a href="https://craftinginterpreters.com/compiling-expressions.html#design-note" target="_blank" rel="noopener">a note</a> explaining why they are brushing over parsing. This over emphasis on parsing could lead one (certainly led me) to believe that parsing is the best place to start on a new language. However, there’s no rule that states things have to be created in this order. In fact, doing things this way is impractical if you’re designing a language from scratch. Trying to create syntax for your language without first knowing its semantics is a trap. It’s like trying to design a vehicle’s interior without knowing how many wheels it will have or how its engine will power them. You might design the interior to comfortably seat 4, but if you discover down the line you’re designing a motorcycle you’re in trouble!</p><p>So how do I overcome my parsing problem? I’ll simply not write a lexer or parser. I can’t get stuck writing a parser if I don’t start writing one. I can come back later and add a parser once I’ve designed more of the internals of my language. My hope is having the other steps (Type Checking, Code Generation, etc.) will provide a guiding hand for what my parser should look like when I do eventually write one. The goal of writing a parser is to produce an AST. But we don’t have to parse our AST out of text during prototyping, we can design an AST and then construct it ad hoc where we need it. Then the question is, if we’re not starting with lexing/parsing, then what step do we start with? The answer is type inference (surprise), but it’s relevant to answer why we’re starting with type inference.</p><p>To understand why we’re starting with our types, look no further than the explanation in <a href="http://www.cs.cmu.edu/~rwh/pfpl.html" target="_blank" rel="noopener">Practical Foundations for Programming Languages</a>:</p><blockquote><p>Types are the central organizing principle of the theory of programming languages. Language features are the manifestations of type structure. The syntax of a language is governed by the constructs that define its types, and its semantics is determined by the interactions among those constructs.</p></blockquote><p>Types inform every other part of our language design, so it’s important we nail them down first. Conversely, once we’ve designed our types the syntax and semantics of our language should easily fall out of our type system.</p><h2 id="background">Background
<a href="#background">
<span>Link to heading</span></a></h2><p>This article will not be a great introduction to programming language design in general. There are already a lot of great resources for that:</p><ul><li><a href="https://craftinginterpreters.com/" target="_blank" rel="noopener">Crafting Interpreters</a></li><li><a href="https://www.cis.upenn.edu/~bcpierce/tapl/" target="_blank" rel="noopener">Types and Programming Languages</a></li></ul><p>We’re focused on implementing type inference (For brevity, we won’t even cover definitions of types, polymorphism, or ASTs). None of the ideas I’m covering here are new. My aspirations with this post are to coalesce good ideas I’ve found in disparate sources. I’ve cobbled together an idea of how to do type inference from reading these sources, and looking at the source code of rustc and GHC. I couldn’t find a good resource that tied all the concepts together, so I decided to write one.</p><p>We’ll build our language in Rust. One might wonder why we’d pick a low level language like Rust, and why not a higher level language that is less verbose such as Haskell or OCaml. These languages are often featured in literature on compilers, and for good reason. They make expressing the tree traversals involved in compilation very natural. However, I don’t know OCaml. I’m more familiar with Haskell, but our type inference will make heavy use of mutation which makes the immutable purity of Haskell a poor fit. Rust has enough features to be functional for our tree traversals while still allowing for mutation. So we’ll be using Rust, if you’re unfamiliar <a href="https://cheats.rs/" target="_blank" rel="noopener">cheats.rs</a> has a dense rundown to get you up to speed.</p><h2 id="abstract-syntax-tree-ast">Abstract Syntax Tree (AST)
<a href="#abstract-syntax-tree-ast">
<span>Link to heading</span></a></h2><p>The whole point of parsing is to convert a text file into an AST. Since we’re skipping over parsing, we’ll start with an AST already constructed. If you’d like a refresher on ASTs check out <a href="https://ruslanspivak.com/lsbasi-part7/" target="_blank" rel="noopener">this blog post</a>. Our language is new, so we’ll start small and add more fancy AST nodes incrementally. Initially, our AST will have just 4 nodes: variables, integer literals, function literals, and function application:</p><div><pre tabindex="0"><code data-lang="rs"><span><span><span>enum</span> <span>Ast</span><span>&lt;</span>V<span>&gt;</span><span> </span>{<span>
</span></span></span><span><span><span>  </span><span>/// A local variable
</span></span></span><span><span><span></span><span>  </span>Var(V),<span>
</span></span></span><span><span><span>  </span><span>/// An integer literal
</span></span></span><span><span><span></span><span>  </span>Int(<span>isize</span>),<span>
</span></span></span><span><span><span>  </span><span>/// A function literal 
</span></span></span><span><span><span></span><span>  </span><span>/// (lambda, closure, etc.)
</span></span></span><span><span><span></span><span>  </span>Fun(V,<span> </span>Box<span>&lt;</span>Self<span>&gt;</span>),<span>
</span></span></span><span><span><span>  </span><span>/// Function application
</span></span></span><span><span><span></span><span>  </span>App(Box<span>&lt;</span>Self<span>&gt;</span>,<span> </span>Box<span>&lt;</span>Self<span>&gt;</span>),<span> 
</span></span></span><span><span><span></span>}<span>
</span></span></span></code></pre></div><p>It doesn’t get much simpler than this. This isn’t really enough for a usable language, although it is Turing complete. For our purposes, it’s plenty to get a minimal type inference system set up. We parameterize our AST by a type parameter <code>V</code>. <code>V</code> will be the variable of our AST used in <code>Var</code> and <code>Fun</code>. Initially our AST variable type parameter will be:</p><p>For simplicity, we’ll represent variables as a <code>usize</code>. We can imagine these might be interned strings in a more sophisticated compiler. Once we type check our AST, each variable will be annotated with its type:</p><div><pre tabindex="0"><code data-lang="rs"><span><span><span>struct</span> <span>TypedVar</span>(Var,<span> </span>Type);<span>
</span></span></span></code></pre></div><p>Rust requires a layer of indirection for recursive types. Boxing values will make our code samples pretty noisy, let’s define some helper methods to hide that noise:</p><div><pre tabindex="0"><code data-lang="rs"><span><span><span>impl</span><span>&lt;</span>V<span>&gt;</span><span> </span>Ast<span>&lt;</span>V<span>&gt;</span><span> </span>{<span>
</span></span></span><span><span><span>  </span><span>fn</span> <span>fun</span>(<span>
</span></span></span><span><span><span>    </span>arg: <span>V</span>,<span> 
</span></span></span><span><span><span>    </span>body: <span>Self</span><span>
</span></span></span><span><span><span>  </span>)<span> </span>-&gt; <span>Self</span><span> </span>{<span>
</span></span></span><span><span><span>    </span>Self::Fun(<span>
</span></span></span><span><span><span>      </span>arg,<span> 
</span></span></span><span><span><span>      </span>Box::new(body))<span>
</span></span></span><span><span><span>  </span>}<span>
</span></span></span><span><span><span>
</span></span></span><span><span><span>  </span><span>fn</span> <span>app</span>(<span>
</span></span></span><span><span><span>    </span>fun: <span>Self</span>,<span> 
</span></span></span><span><span><span>    </span>arg: <span>Self</span><span>
</span></span></span><span><span><span>  </span>)<span> </span>-&gt; <span>Self</span><span> </span>{<span>
</span></span></span><span><span><span>    </span>Self::App(<span>
</span></span></span><span><span><span>      </span>Box::new(fun),<span> 
</span></span></span><span><span><span>      </span>Box::new(arg))<span>
</span></span></span><span><span><span>  </span>}<span>
</span></span></span><span><span><span></span>}<span>
</span></span></span></code></pre></div><h2 id="type">Type
<a href="#type">
<span>Link to heading</span></a></h2><p>Before we can begin inferring types, we have to know what types can be inferred. Our <code>Type</code> type (ha) is determined by our <code>Ast</code>. We need a type to cover each possible value our <code>Ast</code> could produce. Since our <code>Ast</code> only has 4 cases, we can check each one and determine what values they can produce:</p><ul><li><code>Var</code> - it produces any value <code>AST</code> produces (but is not a value itself)</li><li><code>Int</code> - Integer literals are values and will need a type, the type of integers</li><li><code>Fun</code> - Function literals are also values and will need a type, the type of functions</li><li><code>App</code> - Function application will return a value when evaluated, but the application case itself is not a value.</li></ul><p>So we have two values we can produce from our <code>Ast</code>: <code>Int</code>, and <code>Fun</code>. We need two types for these values. We also need a type for type variables; these won’t be for any values but allow us to support polymorphism. Knowing all this we can lay out <code>Type</code>:</p><div><pre tabindex="0"><code data-lang="rs"><span><span><span>struct</span> <span>TypeVar</span>(<span>u32</span>);<span>
</span></span></span><span><span><span></span><span>enum</span> <span>Type</span><span> </span>{<span>
</span></span></span><span><span><span>  </span><span>// A type variable
</span></span></span><span><span><span></span><span>  </span>Var(TypeVar),<span>
</span></span></span><span><span><span>  </span><span>// Type of integers
</span></span></span><span><span><span></span><span>  </span>Int,<span>
</span></span></span><span><span><span>  </span><span>// Type of functions
</span></span></span><span><span><span></span><span>  </span>Fun(Box<span>&lt;</span>Self<span>&gt;</span>,<span> </span>Box<span>&lt;</span>Self<span>&gt;</span>),<span>
</span></span></span><span><span><span></span>}<span>
</span></span></span></code></pre></div><p>Similar to <code>Var</code>, our <code>TypeVar</code> is just a number under the hood. Our <code>Type</code> is a recursive tree, same as <code>AST</code>, so we have to box our nodes. We introduce similar helper methods to alleviate the boxing:</p><div><pre tabindex="0"><code data-lang="rs"><span><span><span>impl</span><span> </span>Type<span> </span>{<span>
</span></span></span><span><span><span>  </span><span>fn</span> <span>fun</span>(<span>
</span></span></span><span><span><span>    </span>arg: <span>Self</span>,<span> 
</span></span></span><span><span><span>    </span>ret: <span>Self</span><span>
</span></span></span><span><span><span>  </span>)<span> </span>-&gt; <span>Self</span><span> </span>{<span>
</span></span></span><span><span><span>    </span>Self::Fun(<span>
</span></span></span><span><span><span>      </span>Box::new(arg),<span> 
</span></span></span><span><span><span>      </span>Box::new(ret))<span>
</span></span></span><span><span><span>  </span>}<span>
</span></span></span><span><span><span></span>}<span>
</span></span></span></code></pre></div><h2 id="type-inference-algorithm">Type Inference Algorithm
<a href="#type-inference-algorithm">
<span>Link to heading</span></a></h2><p>At a high level, the goal of type inference is to use contextual information from our AST to infer the type of each AST node. In trivial cases this is very easy when we see an <code>Int</code> AST node we know it always has type <code>Int</code>. It’s not always so straightforward, though. If we want to know the type of an <code>App</code> node, we have to look at the return type of the function of that <code>App</code> node. However, we may not know the type of that function yet. The function might be a variable that refers to an input parameter to our overall AST term. In that case we can’t know the type of our function until we know the type of our whole term, which seems circular. The way to break up this circular reasoning is by waiting to infer our type until we have enough information to do so. Instead of inferring a type immediately, when we encounter a type we don’t know, we’ll track some constraints about that type. Then once we’ve walked our entire AST we should have enough constraints to infer all our types.</p><p>That sounds a little hand wavy; how can we be sure we’ll always generate enough constraints to figure out our types? The answer is <strong>math</strong>! I won’t go into details here, but we’ll lean on some very nifty proofs a lot of folks worked on to guide us to a type system that is always inferrable. For more information, look into the <a href="https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system" target="_blank" rel="noopener">Hindley-Milner (HM) type system</a>.</p><p>So we’re going to track information about types. We do this on our type variables since they represent unknown types. When we encounter a node, we’ll give it a fresh type variable and emit a constraint on that variable. Any other nodes that rely on that node will reuse its type variable, producing their own constraints on that variable. This is the basis for implementations of the HM type system such as <a href="https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system#Algorithm_J" target="_blank" rel="noopener">Algorithm J</a>, or its cousin Algorithm W. There’s a key difference between those implementations and ours though. Algorithm J attempts to solve constraints as soon as it encounters them and uses a clever data structure to avoid the circular reasoning we saw earlier. Our implementation will instead generate all constraints in one pass and then solve them all in a separate pass. We can visualize this as 3 separate passes: constraint generation, constraint solving, and a final type substitution.</p><p><img src="https://thunderseethe.dev/img/type_inference_algorithm.svg" alt="Type Inference Algorithm"></p><p>This split into constraint generation followed by constraint solving offers some nice properties over the “solve as you go” solution. Because we generate a set of constraints from the AST and then solve them, constraint solving only has to know about constraints and nothing about the AST. This means constraint solving requires no modifications when we change our AST. Right now while we have 4 AST nodes the benefit is small, but most languages have 100+ AST nodes. Being able to handle all these cases in constraint generation and not have them bleed over into constraint solving is a huge win for managing complexity. An explicit list of constraints can also make error reporting easier. We can associate a span with each constraint. Then use these spans help to print smarter error messages on a type error. LambdaAle has a great talk by Simon Peyton Jones <a href="https://www.youtube.com/watch?v=-TJGhGa04F8&amp;t=2731s" target="_blank" rel="noopener">Type Inference as Constraint Solving</a> that goes over the benefits in more detail.</p><p>We’ll put a pin our type inference aspirations here. Our AST, Type, and type inference algorithm provide a strong foundation for our implementation. In our <a href="https://thunderseethe.dev/posts/bidirectional-constraint-generation">next post</a> we’ll implement constraint generation using a bidirectional type system.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How to build a website without frameworks and tons of libraries (438 pts)]]></title>
            <link>https://www.kodingkitty.com/blog/how-to-build-a-website/</link>
            <guid>36591032</guid>
            <pubDate>Tue, 04 Jul 2023 18:47:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.kodingkitty.com/blog/how-to-build-a-website/">https://www.kodingkitty.com/blog/how-to-build-a-website/</a>, See on <a href="https://news.ycombinator.com/item?id=36591032">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>
An innocent question <a href="https://www.indiehackers.com/post/21-websites-for-free-illustrations-29a45232db" target="_blank">was posted</a> on IndieHackers the other day:
<span>"I'm asking what did you use to build your website"</span>.
    </p><p>
The question also had a second part.
So just to be fair, here it is in its entirety: <span>"I'm asking what did you use to build your website, I really love the design and feeling of kodingkitty."</span></p><p>
But this post is not about people loving our website.
Although we're obviously happy about that.
    </p><p>
Too lazy to read? <a href="#kittys-tool-chain">Check out Koding Kitty's simple toolchain</a>.
      </p><h2>The shocking truth</h2><p>
The question sparked an idea to write about the tech stack that KodingKitty team uses for its own web.
And we warn you beforehand: it's so simple that some of you might find it shocking.
    </p><p>
You have been warned.
    </p><h2>Hype is just a coincidence</h2><p>
Our tech stack has nothing to do with the current hype about lightweight or simplified web development.
Not everyone rides that wave, and that's fine.
    </p><p>
On the other hand, we believe that in many cases, "back to the roots" or "simplicity is the ultimate perfection" is a better solution for customers than convoluted web of overused frameworks and libraries.
    </p><p>
To put it another way, the solution we designed for our website and the current hype is just a coincidence.
Our stack is simple because we wanted something pragmatic with minimal friction for the developers.
    </p><p>
And even though we wanted Koding Kitty website to have a distinctive yet subtle design, it is important to mention that it could have been achieved in many other ways.
    </p><h2>Comparing options</h2><p>
Our website and the way it is built comes from our past experience.
    </p><p>
We had the chance to work with different web frameworks in the past.
We know this is a luxury not everyone has.
It has allowed us to compare different technologies and decide what works best for us.
    </p><p>
From the beginning we agreed to start with a static website.
After all, what does a kitty's web really need?
A front page, a showcase, a blog ... and probably not much more.
At least in the beginning.
    </p><h2>Our requirements</h2><p>
We set the following set of requirements:
    </p><ul><li>Fast website</li><li>Fast to develop</li><li>Inexpensive hosting</li><li>Minimal complexity</li></ul><p>
What are the options today to have a website with the above requirements?
    </p><h2>Wordpress (and similar CMS)</h2><p>
Nothing against WordPress, it's done a tremendous job for the internet but&nbsp;...<br>
...&nbsp;honestly, it's a bit overkill for our modest needs.
    </p><p>
We don't need to store our content in a database.
We don't need to deal with plugins.
We don't need a visual editor to write our content.
    </p><h2>No-Code</h2><p>
Yes, that's one area where there's a lot of the hype these days.
    </p><p>
But to be a web coder and use a no-code tool?
Seriously?
It sounds weird.
    </p><p>
We want to own our content.
We want to do whatever we want with our web.
We can code a website faster than we can build it in the no-code WYSIWYG editor.
    </p><p>
The last point is that such tool still requires initial (and then ongoing) learning.
    </p><h2>Frameworks</h2><p>
We have an experience with frameworks.
    </p><p>
But, did we want to do the whole setup?
Although it can be done quickly, we would end up with too many parts.
Like a database, configuration, libraries, admin, and so on.
Yes, it is a fully customizable solution, but we would end up with something that resembles WordPress.
    </p><p>
And that's not what we wanted.
    </p><h2>Jamstack (aka Site generators)</h2><p>
Static site generators look like a tempting option for our needs, don't they?
    </p><p>
Just pick a programming language, do some coding, press a button (or run a script) and voila&nbsp;...<br>
...&nbsp;your fast static site is generated.
    </p><p>
Unfortunately, Jamstack tools require an initial setup and an initial (and continuous) learning.
    </p><p>
We understand, that writing a blog in markdown is convenient, but taking all things into consideration we decided for simpler solution.
    </p><h2>KittyStack</h2><p>
Our solution is obvious, when you review our requirements (repeated below for your convenience):
    </p><ul><li>Fast website</li><li>Fast to develop</li><li>Inexpensive hosting</li><li>Minimal complexity</li></ul><p>
Let's discuss them one by one:
    </p><h2>Fast website</h2><p>
Is a static website fast?<br>
Yes, it is!
    </p><h2>Fast development</h2><p>
Now, you may be thinking: "If you're not writing your content in markdown, you're not using a fancy editor, then what are you using?"
    </p><p>
We write our content in HTML!
    </p><p>
Take a look at our website.
For the kind of posts we publish there, HTML is ideal.
We mix the text with HTML/CSS/JS widgets, so it makes sense to have a post written directly in HTML.
    </p><h2>Inexpensive hosting</h2><p>
Is hosting a static site inexpensive?
    </p><p>
It depends on the provider and all the bells and whistles you decide you need.
    </p><p>
We decided to go with the absolute minimum, because hosting static sites doesn't require a massive hardware setup.
    </p><p>
Mind you, Hetzner <a href="https://www.hetzner.com/webhosting" target="_blank">webhosting</a> starts at 2 EUR!
How crazy is that?
    </p><p>
And if you are worried that your site will not survive a massive spike in traffic - like when your post hits the front page of Hacker News - it probably will.
At least our site did.
    </p><h2>Minimal complexity</h2><p>
We insisted on minimal complexity, but some of our pages and posts have repeating patterns.
    </p><p>
While it is possible to use a copy+paste routine, it can quickly get out of control.
Using some form of loops would help a lot.
Also, the ability to include some blocks of code - like header, footer, and the alike - would be beneficial.
    </p><h2>Templating to the rescue</h2><p>
And so we come to the last piece of the puzzle.
    </p><p>
Meet <a href="https://palletsprojects.com/p/jinja/" target="_blank">Jinja</a> templates, which make our life much easier.
Jinja allows us to use loops, include files (navigation bar, footer, etc.) and much more.
    </p><p>
Plus, we didn't have to learn a new system as we were already using frameworks based on Jinja before.
    </p><h2 id="kittys-tool-chain">A simple toolchain</h2><p>
Now you might be wondering how we generate the final, static page.
    </p><p>
We use a short Python script with exactly 45 lines of code.
<span>Including comments and blank lines.</span></p><p>
In summary, this is the simple toolchain for building our web:
    </p><ul><li>Developer updates index.src.html</li><li>Watchdog.py detects the file change and ...</li><li>... renders Jinja template into index.html and ...</li><li>... calls <a href="https://tailwindcss.com/blog/standalone-cli" target="_blank">Tailwind CSS CLI</a> to generate styles.min.css.</li></ul><!-- Widget --><div><svg viewBox="0 0 24 24" stroke-width="0.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 2l-.15 .005a2 2 0 0 0 -1.85 1.995v6.999l-2.586 .001a2 2 0 0 0 -1.414 3.414l6.586 6.586a2 2 0 0 0 2.828 0l6.586 -6.586a2 2 0 0 0 .434 -2.18l-.068 -.145a2 2 0 0 0 -1.78 -1.089l-2.586 -.001v-6.999a2 2 0 0 0 -2 -2h-4z" stroke-width="0" fill="currentColor"></path></svg><div><svg viewBox="0 0 24 24" stroke-width="1.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z"></path><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0"></path></svg><p><span>watchdog.py</span><span>renders Jinja template</span><span>calls Tailwind CLI</span></p></div><svg viewBox="0 0 24 24" stroke-width="0.5" stroke="#ffffff" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M10 2l-.15 .005a2 2 0 0 0 -1.85 1.995v6.999l-2.586 .001a2 2 0 0 0 -1.414 3.414l6.586 6.586a2 2 0 0 0 2.828 0l6.586 -6.586a2 2 0 0 0 .434 -2.18l-.068 -.145a2 2 0 0 0 -1.78 -1.089l-2.586 -.001v-6.999a2 2 0 0 0 -2 -2h-4z" stroke-width="0" fill="currentColor"></path></svg></div><p>
It's also important to mention following:
    </p><ul><li>During development, <a href="https://www.npmjs.com/package/live-server" target="_blank">Live Server</a> serves files and reloads them as they change.</li><li>When it's time to publish, the files are uploaded <span>manually</span> via <a href="https://en.wikipedia.org/wiki/File_Transfer_Protocol" target="_blank">FTP</a>.</li></ul><h2>Conclusion</h2><p>
Web development can be kept simple without sacrificing too much.
    </p><p>
In fact, it can be liberating to limit yourself to just a few options.
And based on what we've seen so far, many customers would benefit from having solutions that are faster, simpler and cheaper.
    </p><p>
But don't just take our word for it.
Take a look around the web and ask yourself: could the same result be achieved using a less complex tech stack?
    </p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: MongoDB Protocol for SQLite (137 pts)]]></title>
            <link>https://github.com/FerretDB/FerretDB</link>
            <guid>36590834</guid>
            <pubDate>Tue, 04 Jul 2023 18:35:11 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/FerretDB/FerretDB">https://github.com/FerretDB/FerretDB</a>, See on <a href="https://news.ycombinator.com/item?id=36590834">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-target="readme-toc.content">
            <article itemprop="text"><h2 tabindex="-1" dir="auto">FerretDB</h2>
<p dir="auto"><a href="https://pkg.go.dev/github.com/FerretDB/FerretDB/ferretdb" rel="nofollow"><img src="https://camo.githubusercontent.com/300b5958449c8a6351a204c43e55669a0befcfb8c6fe925a1d73487636421088/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f46657272657444422f46657272657444422f66657272657464622e737667" alt="Go Reference" data-canonical-src="https://pkg.go.dev/badge/github.com/FerretDB/FerretDB/ferretdb.svg"></a></p>
<p dir="auto"><a href="https://github.com/FerretDB/FerretDB/actions/workflows/go.yml"><img src="https://github.com/FerretDB/FerretDB/actions/workflows/go.yml/badge.svg?branch=main" alt="Go"></a>
<a href="https://codecov.io/gh/FerretDB/FerretDB" rel="nofollow"><img src="https://camo.githubusercontent.com/e3b356c5102c6a029736b7b9995e1efc212f16c550eab9c4f54c99e0820b12e4/68747470733a2f2f636f6465636f762e696f2f67682f46657272657444422f46657272657444422f6272616e63682f6d61696e2f67726170682f62616467652e7376673f746f6b656e3d4a5a353658465433444d" alt="codecov" data-canonical-src="https://codecov.io/gh/FerretDB/FerretDB/branch/main/graph/badge.svg?token=JZ56XFT3DM"></a></p>
<p dir="auto"><a href="https://github.com/FerretDB/FerretDB/actions/workflows/security.yml"><img src="https://github.com/FerretDB/FerretDB/actions/workflows/security.yml/badge.svg?branch=main" alt="Security"></a>
<a href="https://github.com/FerretDB/FerretDB/actions/workflows/packages.yml"><img src="https://github.com/FerretDB/FerretDB/actions/workflows/packages.yml/badge.svg?branch=main" alt="Packages"></a>
<a href="https://github.com/FerretDB/FerretDB/actions/workflows/docs.yml"><img src="https://github.com/FerretDB/FerretDB/actions/workflows/docs.yml/badge.svg?branch=main" alt="Docs"></a></p>
<p dir="auto">FerretDB was founded to become the de-facto open-source substitute to MongoDB.
FerretDB is an open-source proxy, converting the MongoDB 6.0+ wire protocol queries to SQL -
using PostgreSQL or SQLite as a database engine.</p>
<h2 tabindex="-1" dir="auto">Why do we need FerretDB?</h2>
<p dir="auto">MongoDB was originally an eye-opening technology for many of us developers,
empowering us to build applications faster than using relational databases.
In its early days, its ease-to-use and well-documented drivers made MongoDB one of the simplest database solutions available.
However, as time passed, MongoDB abandoned its open-source roots;
changing the license to <a href="https://www.mongodb.com/licensing/server-side-public-license" rel="nofollow">SSPL</a> - making it unusable for many open source and early-stage commercial projects.</p>
<p dir="auto">Most MongoDB users do not require any advanced features offered by MongoDB;
however, they need an easy-to-use open-source document database solution.
Recognizing this, FerretDB is here to fill that gap.</p>
<h2 tabindex="-1" dir="auto">Scope and current state</h2>
<p dir="auto">FerretDB is compatible with MongoDB drivers and popular MongoDB tools.
It functions as a drop-in replacement for MongoDB 6.0+ in many cases.
Features are constantly being added to further increase compatibility and performance.</p>
<p dir="auto">We welcome all contributors.
See our <a href="https://github.com/orgs/FerretDB/projects/2/views/1">public roadmap</a>,
a list of <a href="https://docs.ferretdb.io/diff/" rel="nofollow">known differences with MongoDB</a>,
and <a href="https://github.com/FerretDB/FerretDB/blob/main/CONTRIBUTING.md">contributing guidelines</a>.</p>
<h2 tabindex="-1" dir="auto">Quickstart</h2>
<p dir="auto">Run this command to start FerretDB with PostgreSQL backend:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -d --rm --name ferretdb -p 27017:27017 ghcr.io/ferretdb/all-in-one"><pre>docker run -d --rm --name ferretdb -p 27017:27017 ghcr.io/ferretdb/all-in-one</pre></div>
<p dir="auto">Alternatively, run this command to start FerretDB with SQLite backend:</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -d --rm --name ferretdb -p 27017:27017 \
  -v ./data:/data/ -e FERRETDB_HANDLER=sqlite -e FERRETDB_SQLITE_URL=file:/data/ \
  ghcr.io/ferretdb/all-in-one"><pre>docker run -d --rm --name ferretdb -p 27017:27017 \
  -v ./data:/data/ -e FERRETDB_HANDLER=sqlite -e FERRETDB_SQLITE_URL=file:/data/ \
  ghcr.io/ferretdb/all-in-one</pre></div>
<p dir="auto">This command will start a container with FerretDB, PostgreSQL, and MongoDB Shell for quick testing and experiments.
However, it is unsuitable for production use cases because it keeps all data inside and loses it on shutdown.
See our <a href="https://docs.ferretdb.io/quickstart-guide/docker/" rel="nofollow">Docker quickstart guide</a> for instructions
that don't have those problems.</p>
<p dir="auto">With that container running, you can:</p>
<ul dir="auto">
<li>Connect to it with any MongoDB client application using MongoDB URI <code>mongodb://127.0.0.1:27017/</code>.</li>
<li>Connect to it using MongoDB Shell by just running <code>mongosh</code>.
If you don't have it installed locally, you can run <code>docker exec -it ferretdb mongosh</code>.</li>
<li>For PostgreSQL backend, connect to it by running <code>docker exec -it ferretdb psql -U username ferretdb</code>.
FerretDB uses PostgreSQL schemas for MongoDB databases.
So, if you created some collections in the <code>test</code> database using any MongoDB client,
you can switch to it by running <code>SET search_path = 'test';</code> query
and see a list of PostgreSQL tables by running <code>\d</code> <code>psql</code> command.</li>
<li>For the SQLite backend, database files will be created on a host in the <code>data</code> directory.
You can access them by running <code>sqlite3 data/&lt;filename&gt;.sqlite</code> after some data is inserted into FerretDB.</li>
</ul>
<p dir="auto">You can stop the container with <code>docker stop ferretdb</code>.</p>
<p dir="auto">We also provide binaries and packages for various Linux distributions,
as well as <a href="https://pkg.go.dev/github.com/FerretDB/FerretDB/ferretdb" rel="nofollow">Go library package</a> that embeds FerretDB into your application.
See <a href="https://docs.ferretdb.io/quickstart-guide/" rel="nofollow">our documentation</a> for more details.</p>
<h2 tabindex="-1" dir="auto">Building and packaging</h2>
<p dir="auto">We strongly advise users not to build FerretDB themselves.
Instead, use binaries, Docker images, or <code>.deb</code>/<code>.rpm</code> packages provided by us.</p>
<p dir="auto">If you want to package FerretDB for your operating system or distribution,
the recommended way to build the binary is to use the <code>build-release</code> task;
see our <a href="https://github.com/FerretDB/FerretDB/blob/main/CONTRIBUTING.md">instructions for contributors</a> for more details.
FerretDB could also be built as any other Go program,
but a few generated files and build tags could affect it.
See <a href="https://pkg.go.dev/github.com/FerretDB/FerretDB/build/version" rel="nofollow">there</a> for more details.</p>
<h2 tabindex="-1" dir="auto">Managed FerretDB at cloud providers</h2>
<ul dir="auto">
<li><a href="https://www.civo.com/" rel="nofollow">Civo</a> (see <a href="https://www.civo.com/marketplace/FerretDB" rel="nofollow">here</a>).</li>
<li><a href="https://www.scaleway.com/" rel="nofollow">Scaleway</a> (request access <a href="https://www.scaleway.com/en/betas/#managed-document-database" rel="nofollow">here</a>).</li>
</ul>
<h2 tabindex="-1" dir="auto">Documentation</h2>
<ul dir="auto">
<li><a href="https://docs.ferretdb.io/" rel="nofollow">Documentation for users</a>.</li>
<li><a href="https://pkg.go.dev/github.com/FerretDB/FerretDB/ferretdb" rel="nofollow">Documentation for Go developers about embeddable FerretDB</a>.</li>
</ul>
<h2 tabindex="-1" dir="auto">Community</h2>
<ul dir="auto">
<li>Website and blog: <a href="https://ferretdb.io/" rel="nofollow">https://ferretdb.io</a>.</li>
<li>Twitter: <a href="https://twitter.com/ferret_db" rel="nofollow">@ferret_db</a>.</li>
<li>Mastodon: <a href="https://techhub.social/@ferretdb" rel="nofollow">@ferretdb@techhub.social</a>.</li>
<li><a href="https://join.slack.com/t/ferretdb/shared_invite/zt-zqe9hj8g-ZcMG3~5Cs5u9uuOPnZB8~A" rel="nofollow">Slack chat</a> for quick questions.</li>
<li><a href="https://github.com/FerretDB/FerretDB/discussions">GitHub Discussions</a> for longer topics.</li>
<li><a href="https://github.com/FerretDB/FerretDB/issues">GitHub Issues</a> for bugs and missing features.</li>
<li><a href="https://calendar.google.com/event?action=TEMPLATE&amp;tmeid=NjNkdTkyN3VoNW5zdHRiaHZybXFtb2l1OWtfMjAyMTEyMTNUMTgwMDAwWiBjX24zN3RxdW9yZWlsOWIwMm0wNzQwMDA3MjQ0QGc&amp;tmsrc=c_n37tquoreil9b02m0740007244%40group.calendar.google.com&amp;scp=ALL" rel="nofollow">Open Office Hours meeting</a>
every Monday at 18:00 UTC at <a href="https://meet.google.com/mcb-arhw-qbq" rel="nofollow">Google Meet</a>.</li>
</ul>
<p dir="auto">If you want to contact FerretDB Inc., please use <a href="https://www.ferretdb.io/contact/" rel="nofollow">this form</a>.</p>
</article>
          </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Dark Waters of Self-Delusion: The crash of Transair flight 810 (161 pts)]]></title>
            <link>https://admiralcloudberg.medium.com/dark-waters-of-self-delusion-the-crash-of-transair-flight-810-a4eeb033bc00</link>
            <guid>36590806</guid>
            <pubDate>Tue, 04 Jul 2023 18:32:34 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://admiralcloudberg.medium.com/dark-waters-of-self-delusion-the-crash-of-transair-flight-810-a4eeb033bc00">https://admiralcloudberg.medium.com/dark-waters-of-self-delusion-the-crash-of-transair-flight-810-a4eeb033bc00</a>, See on <a href="https://news.ycombinator.com/item?id=36590806">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><div><a rel="noopener follow" href="https://admiralcloudberg.medium.com/?source=post_page-----a4eeb033bc00--------------------------------"><div aria-hidden="false"><p><img alt="Admiral Cloudberg" src="https://miro.medium.com/v2/resize:fill:88:88/2*pZPMtIONqtJYi2xHYD_Ivg.jpeg" width="44" height="44" loading="lazy"></p></div></a></div><figure><figcaption>The forward fuselage of Transair flight 810, as seen at the bottom of the sea. (NTSB)</figcaption></figure><p id="92bd">On the 2nd of July 2021, a Boeing 737–200 hauling cargo between the Hawaiian Islands lost power in one engine shortly after takeoff from Honolulu. As the pilots attempted to turn back toward the airport, they reported the unthinkable: their second engine was going too, and they weren’t going to make it. While the Coast Guard scrambled to respond, the crew carried out an extraordinary ditching at sea in the dark of night, successfully bringing their 737 down on the heaving waters of Mamala Bay, 3.3 kilometers off the coast of Oahu. Although the plane broke into two pieces on impact, both pilots managed to escape, and in a harrowing rescue they were plucked from the water just as the remains of the airplane slipped beneath the waves.</p><p id="193e">Two years later, the publication of the National Transportation Safety Board’s final report has confirmed what many long suspected: that the crash of Transair flight 810 was not a story of exemplary airmanship, but quite the opposite, as a relatively minor engine failure snowballed into a dangerous ditching that need never have been attempted. The unfortunate truth was that the pilots never properly addressed the emergency, and in their confusion, reduced power on their functioning engine — a tale as old as the very concept of multi-engine airplanes. The cockpit voice recording and interviews with the pilots revealed the factors which may or may not have contributed, from their muddled attempts to declare an emergency, to an incomplete control handover, to simple stress, as the captain delivered a heated and sometimes sexist 32-minute pre-flight monologue about a fellow pilot. In any case, the findings raised questions about the safety culture at Transair, a scrappy (and now defunct) cargo airline operating 50-year-old airplanes — and highlighted how a breakdown in communication and critical thinking can turn a minor failure into a potentially deadly crash.</p><p id="1194">◊◊◊</p><figure><figcaption>Transair 737s on the ramp in Honolulu. (Transair)</figcaption></figure><p id="c619">In the archipelago of Hawaii, modern life depends on the fast and efficient transfer of goods between the state’s seven inhabited islands, especially by air. Numerous small companies have historically competed for this market, including — until recently — Rhoades Aviation, better known under its public-facing name Transair, which branded itself as “Hawaii’s leader in interisland air cargo.” Founded in 1982 by Iranian-born businessman Teimour Riahi, the airline slowly grew from a few small turboprops to a fleet of several first-generation Boeing 737–200 jets, surviving for decades despite its small size and even a failed attempt to expand into passenger services in 2005.</p><p id="2cbd">For Transair pilots, the pay was mediocre and the hours were unpredictable, but by the 2020s, Transair was one of at most two or three remaining operators of the ancient Boeing 737–200 left in the United States, and anyone who wanted to fly the classic jets would have had few other options. Others were simply attracted by the promise of working in Hawaii, including one of the main characters of this story, 58-year-old Captain Henry Okai. Born in the West African nation of Ghana, he came to the United States decades ago to pursue his dream of flying, which was met with success as he passed pilot training and got a job with regional carrier Allegheny Airlines. Over the years he flew for a variety of companies, both in the United States and abroad, until he finally landed with Transair, having been drawn to the airline in a spur-of-the-moment decision.</p><figure><figcaption>N810TA, the aircraft involved in the accident. (Li Cheng Tsai)</figcaption></figure><p id="9353">Just after midnight on the 2nd of July, 2021, Captain Okai reported for duty at Honolulu International Airport to fly Transair flight 810, a regular service from Hawaii’s capital and largest city, to Kahului, the largest town on the island of Maui. Joining him was 50-year-old First Officer Gregory Ryan, founder of the local Honolulu law firm Greg Ryan and Associates. Ryan first flew for commuter carrier Mesa Airlines from 1991 to 1995, before switching careers to become a divorce lawyer. In 2019, however, he decided to get back into flying, and for the last two years he had been splitting his time between Transair and his legal practice.</p><p id="72f6">That night they would be flying a Boeing 737–200 built in 1975 and registered as N810TA (at Transair, the flight number was based on the registration number — any route that N810TA happened to be flying was “flight 810”). When they arrived at the ramp, cargo handlers were loading the plane with several tons of frozen seafood, pharmaceuticals, and other perishable items typically shipped by air in Hawaii. After performing the pre-flight checks, the pilots sat down in the cockpit to wait for the cargo loading to finish, at which point Captain Okai began to vent about an incident that had allegedly occurred on July 1st, less than 24 hours previously. First Officer Ryan appears to have been already aware of what happened, suggesting that the conversation may actually have begun earlier, but what is known is that the issue would come to dominate the cockpit conversation almost until the moment of takeoff.</p><p id="45da">Most of the information about what happened comes from Captain Okai’s own statements captured by the cockpit voice recorder, but what is known is that on the morning of the 1st, Okai had been rostered to fly with the airline’s sole female First Officer, identified as Gina Moore. After a fraught disagreement over procedures, the two apparently found themselves in a shouting match in the cockpit, at which point Moore announced that she would not fly with Captain Okai, and walked away from the flight in the middle of the after start checklist. A new first officer had to be found, and the flight was delayed. (According to Moore’s own testimony, which is very sparse in detail, she did not ask to be replaced — rather, the Chief Pilot replaced her as soon as she told him she was uncomfortable with Captain Okai. Okai may have been unaware of this.)</p><figure><figcaption>Another photo of N810TA at Honolulu International Airport. (Chris Hoare)</figcaption></figure><p id="3c87">From the transcript, Captain Okai clearly had not mentally moved on from the incident. The conflict seemed to have arisen because Okai and Moore had different interpretations of the procedures in the manual, and neither was willing to compromise with the other, a hallmark of poor crew resource management. As First Officer Ryan listened, interjecting only occasionally to affirm his captain, Okai described his interpretation of the procedures, then discussed how Moore walked out in the middle of the checklist, which apparently prompted him to say a number of hostile words, including “what’s wrong with you,” “this is a joke,” and “you’re going to finish the checklist.” A shouting match ensued, which Ryan recognized as a safety issue, although neither pilot pointed out Okai’s own role in the altercation. In fact, he said, “<em>This is the way we work when I am with her, you know, you have to yell at her to force her to do things.”</em></p><p id="ca03">This incident had apparently been escalated all the way to the airline’s owner, but Okai accused the Chief Pilot of favoring Moore at his expense. He then professed a belief that First Officers needed to acquiesce to their captains regardless of what they thought “the book” said. Again, not a hallmark of an effective team player.</p><p id="68c6">At around quarter past 1:00, the cargo loading concluded, and the pilots paused the conversation to conduct the departure briefing, complete the before start checklist, and start the engines — although Okai interrupted the checklist to mention that he was going to use his cell phone to send pictures of the wording in the manual to the Chief Pilot in order to prove Moore wrong.</p><p id="b372">Several minutes later, the flight was ready to taxi, and the pilots proceeded toward the runway — only for Okai’s mind to come back to Moore again. Spotting a pothole in the runway, Okai began to describe how he accidently ran through that same pothole during a landing rollout because he was distracted arguing with Moore. “This girl is driving me crazy, you know!” he said.</p><p id="9272">Moments later, he brought the rant to a new level, graduating from personal animosity to outright misogyny. “These are the kind of women you don’t wanna get married to,” he said. “You know, some men, they lose their temper and the next thing you know, the wife is dead, you know… they start punching them and kicking them, and they lost their minds, you know… they kill the woman… it’s the woman who can drive you to do crazy stuff, you know?”</p><blockquote><p id="3de9">(Public service announcement: if a husband murders his wife because he thinks she’s annoying, that’s the husband’s fault. I shouldn’t need to say this.)</p></blockquote><p id="2704">◊◊◊</p><p id="89f1">Minutes later, at 1:33 a.m., flight 810 arrived at the head of the runway with takeoff clearance in hand, and Captain Okai handed over control to First Officer Ryan. Working together, they pushed the thrust levers to takeoff power, and the engine instruments responded normally. Okai observed that the exhaust gas temperatures, or EGTs, were hovering very close to the yellow “caution” zone on the gauge, but he had seen this indication many times before on multiple Transair planes, and he wasn’t concerned.</p><p id="e467">As the 737 accelerated down the runway, Okai made the standard callout, “Eighty knots,” followed by “V1,” or decision speed, and then “rotate.” Ryan pulled the nose back, and the plane lifted off, prompting Okai to call out, “positive rate.”</p><p id="e1b7">“Gear up,” Ryan ordered, and Okai complied.</p><p id="59a9">Then, just as the gear finished retracting, a loud “thud” was heard, accompanied by vibrations and a long “whooshing” sound, like an engine rolling back.</p><p id="b2fa">“Oh shit,” Ryan exclaimed.</p><p id="40e9">“Lost an engine, you got it?” Okai asked.</p><p id="1ad6">“Okay, I got it, yep,” Ryan said, instinctively stepping on the rudder to counteract the developing asymmetric thrust.</p><p id="2ee7">“Yep, you lost number…” Okai started to say, trying to determine which engine had failed.</p><p id="d720">“Number two, yep,” said Ryan, referring to the right engine.</p><p id="21e9">“Number two,” Okai agreed.</p><figure><figcaption>The damage to the turbine blades that precipitated the emergency. (NTSB)</figcaption></figure><p id="a09a">The pilots’ assessment was correct. Inside the high pressure turbine within the right (№2) engine, corrosion had been eating away at two of the turbine blades from the inside, expanding outward around each blade’s internal lightening holes — voids in the material designed to reduce the weight of the blades. The corrosion steadily weakened the blades, until one or both failed under the stresses of normal operation. The broken blade tips were then sucked back through the low pressure turbine, causing further damage that reduced the engine’s ability to produce power. In fact, within seconds of the failure, the Engine Pressure Ratio, or EPR, for the right engine — a proxy for its power output — decreased from 1.97, which is approximately takeoff power, to 1.43, which is closer to cruise.</p><p id="ceef">When an engine failure occurs on takeoff in a twin-engine jet like the 737, the procedure is to declare an emergency, climb to a safe altitude, level off, identify which engine has failed, complete the “engine failure or shutdown” checklist, and then return to the airport. Therefore, to start things off, Captain Okai jumped on the radio and said, “Rhoades eight ten, we have an emergency, stand by.”</p><p id="04f4">“Rhoades Express eight ten, radar contact, fly heading of one one zero to join victor two, resume own navigation,” the controller said, having apparently missed the content of the transmission.</p><p id="e4aa">“Eight twenty [sic] has emergency, on a two twenty heading, stand by,” Okai repeated. Turning to his first officer, he added, “Okay, you can inch up to two thousand.” 2,000 feet would be an excellent safe altitude at which to level off while they completed the engine failure procedure.</p><p id="fb7d">About 12 seconds later, Okai said, “Okay, coming up on two thousand, we’ll level at two thousand… you have two twenty heading, right?”</p><p id="0edd">In addition to flying with less power on the right side, First Officer Ryan was also navigating through a procedure turn to the right following takeoff, but he seemed to be handling it just fine, so he simply said, “Yes.”</p><p id="b11b">Moments later, the flight reached 2,000 feet, and Ryan began leveling the plane. At the same time, the controller called them again to repeat her earlier clearance. “Rhoades Express eight ten, radar contact, turn left heading zero niner zero, join victor two, resume own navigation, climb and maintain one three thousand, say altitude,” she said.</p><p id="6fa4">Wondering whether the controller wasn’t able to hear them, Okai said, “Okay, Rhoaaades eight ten, radio check, how do you read?”</p><p id="9f9b">“Rhoades Express eight ten, loud and clear, how do you hear? Turn left heading one eight zero,” the controller replied, again without mentioning the emergency. The simple truth, which Okai would later realize, was that the controller was handling a large volume of traffic, and other planes were stepping on his transmissions, making them hard to understand. But in the moment, her failure to appreciate the emergency declaration was probably frustrating.</p><p id="359b">“Okay, Rhoades eight ten, we’ve lost an engine, we are on a two twenty heading, maintaining two thousand, declaring an emergency, how do you read?” Okai repeated.</p><p id="a674">But the controller was in the middle of talking to their sister aircraft, Transair flight 809, and when Okai stopped talking, he heard only the end of their conversation: “…say again, heading two four zero?”</p><p id="4ea2">“Okay, two four zero heading, Rhoades eight ten,” Okai replied, thinking the transmission was for him.</p><p id="449b">“No, Rhoades eight oh nine, Rhoades eight oh nine, left two four zero,” the controller clarified. Then, finally recognizing that flight 810 was in trouble, she added, “Rhoades Express eight ten, you are cleared visual approach runway four right, you can turn in towards the airport.”</p><p id="a709">“Okay, Rhoades eight ten, we’re gonna have to run a checklist, if we can get a delay vector and uh, we’ll let you know when we’re ready to come into the airport,” Okai replied.</p><p id="a97d">“Just keep me advised and maintain two thousand if that’s the altitude you’d like,” said the controller.</p><p id="2fbb">“Okay, two thousand is good for now,” said Okai. “We’ll stay around fifteen miles from the airport and uh, maintaining two thousand, Rhoades eight ten.”</p><figure><figcaption>The EPR gauges on the accident airplane, which would have been the primary instrument indication of engine performance. The values depicted are not what was shown at any point during the accident sequence; the photo is illustrative of the concept only. (NTSB)</figcaption></figure><p id="f7d4">By the time the conversation concluded, a minute and forty seconds had passed with little to no discussion between the pilots. First Officer Ryan spent that time leveling off at 2,000 feet and trying to achieve the target airspeed for an engine-out scenario, which was about 220 knots. He initially overshot both, climbing to 2,100 feet and reaching a speed of 250 knots, so he began incrementally reducing power in both engines in order to slow down. In accordance with standard procedures, he moved both thrust levers together, since they had not formally carried out the identification process for the failed engine.</p><p id="da2a">Returning his attention to the cockpit, Captain Okai now said, “Okay, let’s uh… two forty heading.” He appeared not to have understood that this heading was not for him. He then added a question: “You want me to take over, or you got it?”</p><p id="aa5d">“No, I’m okay, thank you,” said Ryan.</p><p id="1cf9">In an emergency, it’s normal for the First Officer to fly while the Captain develops a strategy and completes the abnormal checklists. This was not an official rule nor was it set in stone, but Okai’s offer contradicted it nonetheless.</p><p id="4267">At that moment, the controller called again. “Rhoades Express eight ten, uh, when you get a chance can I get the nature of the emergency, I know you said an engine out, which one? Uh, how many souls on board, and fuel?”</p><p id="17b6">“Okay, all that is good, we’ll give you all that in a little bit, in a little bit, Rhoades eight ten,” Okai replied. Turning back to First Officer Ryan, he said, “Okay, so we’ll plan for two.. say two twenty speed, eh?”</p><p id="c734">“Kay,” said Ryan. By now, both thrust levers had been rolled all the way back to flight idle, the lowest flight setting, and the left and right EPRs had dropped to 1.05 and 1.09 respectively, indicating very little forward thrust. Their speed was dropping nicely toward 220 knots, which was what they wanted.</p><p id="e59f">Now, about 45 seconds after his first offer to take control, Okai said, “Let me take over briefly, and you…”</p><p id="efb2">“Okay,” First Officer Ryan agreed. He would later state that he perceived Okai’s statement as an order, so he agreed to hand over control, even though he was having no issues flying the plane. In fact, with both engines at idle, the asymmetric thrust had disappeared, and it was trivial to keep the plane straight and level.</p><p id="eb32">“You set your things up, I have control,” said Captain Okai.</p><p id="6855">“Okay, you have control,” Ryan acknowledged.</p><figure><figcaption>This 3-D reconstruction shows how the plane began slowly losing altitude just minutes after takeoff. (FlightAware)</figcaption></figure><p id="254a">Now that he was flying the plane, Okai immediately noticed that not all was as it should be. Their speed had dropped to the target of 220 knots, but they were losing altitude, having fallen from 2,100 down to 1,700 feet. Okai tried pitching up to regain their planned altitude, but as a result their speed dropped even more, to 196 knots, and the plane barely climbed. Of course, the reason was because First Officer Ryan had set both thrust levers to idle, and because of the control handover, no one pushed them back up again. But Okai didn’t realize that. Instead, he said, “Okay, let’s see what is the problem. Which one… what’s going on with the gauges? Read the gauges and see which one… who one… which… who has the EGT?”</p><p id="58f8">Glancing over at the engine gauges, First Officer Ryan attempted to determine which engine had abnormal parameters, including but not limited to the exhaust gas temperature (EGT). But with both engines still running at idle power, it was quite difficult to tell. Out of the indicated parameters, engine pressure ratio (EPR) was usually the biggest clue, but the EPR for both engines was almost the same. Instead, Ryan attempted to recall what symptoms he had noticed when the engine first failed: he heard a sound which seemed to come from the left, and the plane yawed left — didn’t it? So it must have been the left engine. Its indicated EPR, slightly below that of the right engine, was consistent with such an interpretation. And so he said, “Yep, so it looks like the number one.”</p><p id="34d2">“Number one is gone?” Okai asked.</p><p id="53b6">“It’s gone, yep,” said Ryan. “So we have number two.”</p><p id="810e">“So we have number two, okay,” said Okai.</p><p id="8443">You might have already noticed what’s wrong with this picture. When the failure first happened, didn’t both pilots identify the problem as being with the right engine? First Officer Ryan even used the rudder to prevent the plane from yawing right! But, as it turns out, human memory is more fallible than we would sometimes like to admit, and in the intervening four minutes, both pilots had somehow entirely forgotten their initial impressions. First Officer Ryan even seemingly forgot that the left engine was at idle power because he put it there himself not even two minutes earlier. If at that moment some outside observer had asked Ryan why he thought the number one (left) engine was faulty, he might not even have been able to give a straight answer, and yet in the moment he expressed his determination with unquestioned conviction, and Captain Okai, believing Ryan to be a competent and trustworthy pilot, accepted his conclusion unconditionally.</p><figure><figcaption>The 737–200 Engine Failure or Shutdown checklist. (NTSB)</figcaption></figure><p id="00f4">Having concluded that the left engine was at fault, Okai advanced the right thrust lever in order to stabilize their flight path, then moved to their next priority: completing the engine failure checklist. His plan was to fly 15 miles out from the airport on their assigned heading before turning back, which would give them plenty of time to complete the procedure, so he said, “Alright, uh, two forty heading, I have control.”</p><p id="ceb1">“Okay, should we head back toward the airport though, before we get too far away?”</p><p id="1164">“Yeah, we’ll stay within fifteen… alright, I have controls, you run the checklist, let’s do the engine failure shutdown checklist.”</p><p id="3a69">First Officer Ryan would later assert that he disagreed with the decision to spend so much time in the air, but that Okai was the captain, so he obeyed him. Besides, given their earlier conversation, he surely knew where arguing with Okai would get him (which was nowhere). Okai, for his part, would later note that he had been reprimanded by the Chief Pilot for landing without performing the checklist after a previous engine failure, and had promised not to do so again.</p><p id="e5c0">Some 30 seconds later, Okai asked air traffic control for permission to begin turning in, and received a new heading. Meanwhile, First Officer Ryan started reading off the conditions for performing the checklist. “Okay, engine failure or shutdown,” he recited. “When these occurs… engine failure, engine flameout, or another checklist directs an engine failure…”</p><p id="59e1">At that moment, Ryan seemed to notice that the EGT on the right engine was abnormally high, almost inside the red “warning” zone on the gauge. If they let the exhaust gas temperature climb into the red zone, severe engine damage could occur. Of course, the reason for this was that the right engine was already damaged and was not running properly, causing its internal temperature to rise, but in the moment it appeared to First Officer Ryan that they were simply demanding too much of the old, somewhat underpowered engine. “We’re… we’re red line here, we should pull the right one back a little bit,” he said.</p><p id="ce16">Captain Okai immediately recognized that this was a serious issue. He had already moved the right thrust lever to a reasonable power setting, but the EPR was much lower than it should have been, only about 1.22, which was not enough to keep them airborne for long. And yet even at this low power setting, the engine was overheating. His immediate conclusion was that they were about to lose thrust in both engines, and that they needed to get on the ground as soon as possible, so he said, “Okay, shoot, we should head towards the airport.”</p><figure><figcaption>The location and appearance of the exhaust gas temperature (EGT) gauges on a Boeing 737–200. (Chris Brady)</figcaption></figure><p id="6aa3">As the gravity of the situation set in, First Officer Ryan began setting up for the approach, while Captain Okai informed air traffic control that they were turning in and did not have the airport in sight.</p><p id="ab6d">“Rhoades Express eight ten, fly heading of zero two zero and would you like to intercept the localizer or do you want vectors?” the controller asked.</p><p id="aad8">“No, vectors straight to the airport,” Okai said. “We might lose the other engine too.”</p><p id="5c4d">Back in the cockpit, Okai asked, “We are clean, right?” His concern was that the flaps or landing gear might be extended, causing drag that was reducing their performance (a plane with no flaps or gear is referred to as “clean”). But they were in fact clean, so that wasn’t the problem.</p><p id="5d77">“Okay,” said Ryan.“Just have to watch this though, the number two.”</p><p id="2230">By now they had fallen to 1,000 feet, their speed was down to 157 knots, and both parameters were still decreasing. “Damn,” Okai said. Suddenly, the stick shaker activated, warning that they were flying too slowly and could stall if they didn’t increase their airspeed. With their only working engine redlined — or so they thought — the only way to gain speed was by pitching down, but that would only hasten their already alarming descent.</p><p id="3df3">“What’s this?” Okai exclaimed. “Hey man, we can’t keep going down!”</p><p id="23ec">“We’re descending,” Ryan agreed.</p><p id="a48b">Okai advanced the right thrust lever even more, and the EPR crept up to a still meager 1.37, but the temperature only continued rising into the red zone, until finally it reached the maximum that gauge could indicate.</p><p id="7f6e">“Okay, see, see if you can see the airport now,” Okay said, growing worried.</p><p id="03eb">“Uh, we’re descending, we have to climb!” said Ryan.</p><p id="e0dd">“Double check the airplane is cleaned up,” said Okai.</p><p id="290b">“Yeah, flaps are up, speedbrakes…” Ryan replied.</p><p id="f650">“How is the EGT?” Okai asked.</p><p id="a1e5">“It’s max, it’s beyond max,” said Ryan.</p><p id="cdd6">“Okay, we’re barely holding altitude,” Okai said. “Okay, see what you can do in the checklist, finish as much as possible.”</p><p id="c1df">“This says, uh, airframe vibrations, abnormal engines exist…” Ryan said, speed reading the checklist introductions. “It says do the engine shutdown only when flight conditions — we have to fly the airplane though.”</p><p id="5c09">The full phrase was “when flight conditions allow” — and in Ryan’s view, that meant when their altitude and speed were stable, which they were not. And that meant flying the airplane had to come before finishing the checklist.</p><p id="414f">“Okay,” said Okai. “Damn.”</p><p id="aaa0">“We’re losing altitude,” Ryan repeated.</p><p id="b519">“Yeah. Fifteen miles out,” Okai said. They were on their way back to the airport now, but they were so low that it was difficult to make out the airport lights on the horizon, and they were still dropping. Unless they managed to find some more thrust, they weren’t going to make it. Of course, if someone had simply advanced the left thrust lever, all their problems would have been solved, but nobody even thought to try, so down they went.</p><figure><figcaption>The full annotated flight path of flight 810. (NTSB)</figcaption></figure><p id="b8ec">Desperate now to avoid losing altitude, First Officer Ryan thought it was time to start deploying the flaps, knowing that while they would allow them to fly at a lower speed, they would also increase drag. “Do we go flaps, flaps one?” he asked.</p><p id="6bcb">“No no, not yet,” said Okai.</p><p id="13ef">“Kay, we’re, we’re very slow though,” said Ryan. If they didn’t deploy the flaps, Okai would have to keep pitching down to avoid stalling.</p><p id="88b6">“Shoot, okay, flaps one,” Okai agreed.</p><p id="94ed">“Five hundred,” an automated voice called out, reciting their height above the water. It was followed by a callout from the Enhanced Ground Proximity Warning System, or EGPWS: “TOO LOW, GEAR!”</p><p id="aa09">Keying his mic, Captain Okai said to air traffic control, “Okay, Rhoades eight ten, uh situation, we’ve lost number one engine and um, we’re coming straight to the airport… we’re gonna need the fire department, there’s a chance we’re gonna lose the other engine too, it’s running very hot. And um, speed is um, we’re pretty low on the speed and it doesn’t look good out here… you might want to let the Coast Guard know as well.” This request would probably end up being the best decision Captain Okai made during the entire emergency.</p><p id="75c0">“TOO LOW, GEAR!” the EGPWS repeated.</p><p id="0e80">“Just fly, fly the airplane please!” said Ryan.</p><p id="6a3c">“TOO LOW, TERRAIN,” said the EGPWS. “TOO LOW, GEAR! TERRAIN! TERRAIN!</p><p id="7b36">“Do you have the airport?” Okai desperately asked.</p><p id="940b">“PULL UP,” the EGPWS blared.</p><p id="c1fc">“Pull up, we’re low!” Ryan repeated.</p><p id="ffad">“PULL UP! PULL UP!”</p><p id="09f8">“Rhoades Express eight ten, do you have the airport in sight?” the controller asked.</p><p id="157c">“Negative!” Ryan replied.</p><p id="7aea">“And Rhoades Express eight ten, low altitude alert, are you able to climb at all?”</p><p id="3603">“No, negative,” Ryan again replied.</p><p id="690e">“Rhoades Express eight ten, roger, proceed direct to the airport and you are cleared to land any runway,” the controller said, followed by a heading. But they were running out of time.</p><figure><figcaption>A graph of the engine pressure ratios over time shows how both engines were reduced to near idle, before the right thrust lever was advanced again. (NTSB)</figcaption></figure><p id="5e9a">As flight 810 dropped the last few hundred feet toward the ocean, the EGPWS continued to blare: “TOO LOW, TERRAIN! Three hundred! TOO LOW, GEAR!”</p><p id="056d">“Rhoades Express eight ten, the trucks are rolling,” said the controller.</p><p id="24a8">Jumping on the radio again, Okai replied, “Roger, you wanna — you wanna let the Coast — Coast Guard know as well?</p><p id="5895">“Say that again?”</p><p id="194a">“Can you let the Coast Guard know, we cannot maintain altitude,” Okai repeated.</p><p id="3591">“We will,” said the controller.</p><p id="983a">At that moment, the EPR on the right engine increased to over 1.4, and for a brief moment the plane seemed to level off, before entering an extremely shallow climb. “Hold that please, it’s climbing, hold that, hold that,” First Officer Ryan exclaimed. “Pull back, we’ve got a climb! Pull back to the stick shaker!”</p><p id="93f2">“Shoot, the three hundred feet…” Captain Okai started to say.</p><p id="8240">“It’s okay, we’re climbing — ” Ryan began, but at that moment the right engine started losing power again, and they began descending once more, having gained only 50 feet. “Oh, we’re not climbing, damn,” Ryan concluded.</p><p id="4665">“How’s the EGT?” Okai asked again.</p><p id="9104">“Hot, way over,” said Ryan.</p><p id="44c4">“TOO LOW, TERRAIN!” said the EGPWS. “TOO LOW, GEAR! TOO LOW, GEAR! TOO LOW, GEAR!”</p><p id="4c09">“Rhoades Express eight ten, the Coast Guard is on the way,” said the controller.</p><p id="c814">“TOO LOW, GEAR! TOO LOW, TERRAIN!”</p><p id="ef86">“Pull back please!” said Ryan.</p><p id="dc4a">“Rhoades Express eight ten, if you can get to runway eight right or Kalaeloa, do you want Kalaeloa?” the controller asked, referring to a military airfield off their left side. It was closer than Honolulu International, but probably still too far away.</p><p id="37fe">“We’d like the closest airport runway please,” Ryan replied.</p><p id="016f">“Anything we can land on,” Okai interjected.</p><p id="29ec">“[Kalaeloa air]port is three miles north of you, uh, off your nine to ten o’clock,” said the controller.</p><p id="258f">“Wanna go there?” Ryan asked. The stick shaker stall warning activated for two seconds, prompting Okai to pitch down again.</p><p id="b70f">“Can you get that, Rhoades Express eight ten, it’s three uh, to your left about three miles northwest of you,” the controller said.</p><p id="33bf">“TOO LOW, GEAR! TOO LOW, GEAR!”</p><p id="0f38">“Okay, give me a heading,” Captain Okai transmitted.</p><p id="e9ab">“TOO LOW, GEAR! TOO LOW, GEAR!” the EGPWS blared, followed again by the stick shaker.</p><p id="77f9">“Rhoades Express eight ten, uh the airport is about a three one zero heading from you,” said the controller.</p><p id="5b4e">But it was too late even for this last-ditch effort. As Captain Okai turned left toward the airbase, the pace of the EGPWS alerts became even more frenetic: “TERRAIN! TERRAIN! PULL UP! PULL UP!”</p><p id="0df6">“Three one zero, thank you,” Okai said to the controller. It would be the last transmission from flight 810.</p><p id="1b57">“PULL UP,” the EGPWS screamed. “PULL UP! PULL UP! PULL UP! PULL UP!”</p><p id="09f6">“You have control and you have control!” Okai exclaimed. It’s unclear what he meant, since he retained control of the plane and neither pilot would be able to recall the statement later.</p><p id="5633">“PULL UP!”</p><p id="419b">“Okay,” said Ryan.</p><p id="b608">“Shoot, this is the water, we in the water,” Okai said, spotting the shining black waters of Mamala Bay rising beneath them.</p><p id="5f52">“PULL UP!” The stick shaker rattled briefly again. “PULL UP! PULL UP! PULL UP! TOO LOW, TERRAIN!”</p><p id="f257">“Oh man, we’re in the water, we’re in the water, we can’t…” Okai said, on the verge of hyperventilation.</p><p id="3ce1">The stick shaker started rattling continuously now, punctuated by more EGPWS alerts: “TERRAIN! TERRAIN! PULL UP!”</p><p id="3c76">“Damn!” Okai shouted.</p><p id="eac7">The EGPWS mustered one last “pull up,” and then, with a tremendous shudder, the plane hit the water.</p><figure><figcaption>First Officer Ryan’s seat collapsed forward, causing him to strike his head. It was found still in that position when the plane was recovered. (NTSB)</figcaption></figure><p id="2ea2">The impact was hard, and over quickly. Within seconds, the plane ground to a halt, but its fuselage had cracked in two just ahead of the wings, and water was pouring in. By the time Captain Okai managed to undo his seatbelt, the water outside the plane was half way up his window, and it came rushing into the cockpit when he slid it open. Fighting against the inflow, he forced his way out the window and into the heaving ocean. Meanwhile, First Officer Ryan’s seat had collapsed forward on impact, causing him to strike his head, but he too managed to open his window and clamber out into the watery darkness. Now only one objective remained: to survive.</p><p id="ca82">In search of something to hang onto, Captain Okai swam toward the tail section, but no cargo or panels had come loose, so he simply grabbed the automatic direction finder antenna on the vertical stabilizer and hauled himself onto the top of the sinking empennage, where he clung to the tail as waves crashed over him. At the same time, First Officer Ryan held onto the nose section, but as it began to slip beneath the surface, he spotted a loose cargo pallet and climbed aboard, using it as a makeshift raft. He called his captain’s name, and Okai called his name in return, but Okai was in trouble, as waves repeatedly knocked him off his perch, forcing him to swim back again.</p><figure><figcaption>A Coast Guard helicopter and boat respond to the scene of the crash. (US Coast Guard)</figcaption></figure><p id="6569">Suddenly, the roar of a helicopter overcame the rumble of the waves, and floodlights illuminated the desperate scene. The Coast Guard had arrived! At that moment, a wave again swept Captain Okai into the water, but this time he became disoriented; he could no longer find the tail, which was rapidly sinking. Floundering in the heaving sea, he began inhaling water and jet fuel. Realizing that his captain’s life was in danger, First Officer Ryan pointed the helicopter toward the tail section, and the rescuers got the message. An elite rescue swimmer jumped from the hovering helicopter and swam to Okai’s aid, pulling him back from the brink at the last possible moment. The swimmer and the unconscious captain were then winched back aboard — at which point the rescue swimmer jumped right back in again to save First Officer Ryan. With Captain Okai in apparently critical condition, the helicopter departed without them, but the Coast Guard had a plan B: a rescue boat, which was just now arriving at the scene. Grabbing onto the First Officer’s cargo pallet, the rescue swimmer swam through the ocean, pushing the improvised raft ahead of him, until they reached the boat and were hoisted aboard.</p><p id="5445">Against all odds, having ditched their plane in the ocean in the middle of the night, both pilots had been saved in the nick of time.</p><p id="24ce">◊◊◊</p><figure><figcaption>The aft section of N810TA as seen on the bottom of the ocean. (NTSB)</figcaption></figure><p id="6b1c">When National Transportation Safety Board investigators arrived in Hawaii later that day, they knew from the publicly available air traffic control tapes that the pilots of flight 810 reported an inability to maintain altitude and a possible dual engine failure, leading to a forced landing on water at night. Although it was clear that the pilots were lucky to be alive — in fact both were released from hospital within 48 hours — little else about the nature of the events was immediately obvious. And with the plane, and its black boxes, sitting somewhere on the bottom of Mamala Bay, the only way to find out what happened was to ask the two men who were there.</p><p id="ff31">The interviews with the pilots, which have been publicly released, provide a glimpse into what the crew thought was going on during the emergency. Captain Okai reported believing that the number two (right) engine had failed, but that when First Officer Ryan told him the faulty engine was number one (left), he had no reason to disbelieve him. After all, Ryan was the one flying the plane, so he would have been in a better position to detect which side was lacking thrust. First Officer Ryan, for his part, stated in full confidence that the sound of the “thud” came from the left side, that the plane yawed to the left, and that he had always known it was the left engine that failed. Only after this did it become clear that the right engine was running very hot and was not producing enough thrust to keep them in the air. But both pilots agreed on one thing: they had no idea why the plane wouldn’t fly, and were eager to find out.</p><figure><figcaption>The forward fuselage and cockpit of N810TA came to rest some distance away. (NTSB)</figcaption></figure><p id="33d0">The recovery of the plane from under 110 to 130 meters (360 to 420 feet) of water ultimately took four months, but when the NTSB finally received the flight data and cockpit voice recordings, their contents underscored just how unreliable witness testimony can often be. In fact, the data showed that the right engine suddenly lost power about 7 seconds after liftoff, confirming Captain Okai’s initial impression that this engine had failed. Furthermore, the resulting yaw to the right was countered correctly by First Officer Ryan, showing that he knew which side had lost thrust. The cockpit voice recorder was even more unequivocal: in fact, both pilots explicitly stated that the right engine had failed. This was confirmed by metallurgical analysis, which showed that corrosion had led to at least one blade failure in the right engine’s high pressure turbine, but that no defects were present in the left engine until it hit the water.</p><p id="eaad">The error chain began minutes after the initial failure, when First Officer Ryan began reducing thrust on both engines toward idle in order to slow the plane from 250 to 220 knots. After this occurred, the pilots again revisited the question of which engine had failed, and came to a startlingly different conclusion. In his interview, Ryan said that in addition to the symptoms described earlier, he saw that the left engine’s EPR and other parameters had fallen to idle, leading him to a conclusion that this engine had failed. But the left engine was at idle because he put it there! How was it possible for him to have become so confused? In the end, we may never know for sure — but it is possible to say a lot more about why Captain Okai failed to notice.</p><figure><figcaption>Part of one of N810TA’s two JT8D engines lies on the sea floor. (NTSB)</figcaption></figure><p id="cbca">As pilot monitoring during the takeoff, it was Captain Okai’s primary responsibility to watch the instruments and note any abnormalities. But almost as soon as the failure occurred, he took it upon himself to declare an emergency to air traffic control, an effort which he admitted “became a project.” In fact, Okai spent one minute and 40 seconds in a confused exchange with the oversaturated controller before he finally returned his attention to the cockpit, demonstrating rather poor task prioritization. Ideally, he should have analyzed the situation first and declared an emergency second, and if the controller did not hear his emergency declaration, he could have used the transponder to “squawk” 7700, the universal emergency code, instead of wasting more time on the radio. But he did not.</p><p id="1e83">By the time Captain Okai returned his attention to the cockpit, First Officer Ryan had already rolled back both engines to idle and leveled off at 2,000 feet, eliminating the most salient clues as to which engine had failed. At this point, they found themselves outside the boundaries of the assumptions built into their training scenarios and emergency checklists. The procedures for responding to an engine failure on takeoff assumed two things: first, that one engine would stop producing power entirely, resulting in warnings and zeroes on gauges; and second, that the adverse yaw from the asymmetric thrust would persist, providing a powerful clue about which engine had failed. But in this case, neither of these assumptions held, because the right engine only suffered a partial loss of power, and by the time the pilots got around to formally identifying the failed engine some four minutes after takeoff, both engines were producing the same amount of thrust (very little), so the adverse yaw was gone. At that point the only obvious difference between the two sets of gauges would have been a higher temperature on the right engine. As a result, there was nothing to obviously indicate to Captain Okai that First Officer Ryan’s conclusion about the failed engine was wrong. There was nothing to indicate that it was right, either, but Okai’s trust in Ryan was apparently good enough. Had he attempted to verify this by advancing both thrust levers in turn, which is a prescribed procedure for identifying a failed engine, he would have realized that the left engine was fine, but he never tried.</p><figure><figcaption>A closer view of the damaged nose section. (NTSB)</figcaption></figure><p id="8224">Because the pilots never increased power on the left engine, the plane did not have enough thrust to maintain altitude, even with the right thrust lever fully forward, because they were relying only on the damaged right engine. At any point, the pilots could have averted the accident by simply moving the left thrust lever forward, which would be a sensible thing to do when one is about to hit the water, even if one believes that that engine has failed. After all, the worst that can happen is it doesn’t work, and in the best case scenario, it could save lives. But when the NTSB conducted follow-up interviews in March 2022 to clarify why, among other points, the pilots did not move the left thrust lever, both replied that it simply never occurred to them. By the time it had become clear that they could not maintain altitude, both pilots were suffering from tunnel vision, and were singularly focused on flying the airplane to the end, rather than thinking outside the box for solutions. And with their focus so consumed by the task of flying, no one even looked at the thrust levers, let alone considered moving them.</p><p id="66fa">Had the pilots completed the engine failure and shutdown checklist, which required moving the affected thrust lever to idle before cutting fuel, the pilots might have noticed that the left thrust lever had been at idle the whole time, and might have tried advancing it. But in the event, they never actually started the checklist, because by the time they got around to it, their flight path was no longer stable, and First Officer Ryan had decided that flying the plane was a higher priority. Captain Okai, for his part, told the NTSB that he thought the checklist would be useless once the second engine started to fail, so he didn’t order Ryan to finish it.</p><figure><figcaption>The aft section of N810TA is recovered from the water in November 2021. (NTSB)</figcaption></figure><p id="f4e3">In the end, the fact that the pilots rolled back the wrong engine was attributed to poor communication and insufficient procedural discipline. The flight operations manual included the following prescient warning: “<em>Any time an engine shutdown is required in flight, good crew coordination is essential. Airplane incidents have turned into airplane accidents as a result of the flight crew shutting down the incorrect engine. When the flight path is under complete control, the crew should proceed with a deliberate, systematic process that identifies the correct engine and ensures that the operating engine is not shut down.”</em> In the event, the flight path was stable at 2,000 feet for several minutes, but no “deliberate” or “systematic” attempt to identify the correct engine was ever carried out. Ultimately, this was the pilots’ biggest and most unfortunate mistake.</p><p id="899f">The NTSB also criticized Captain Okai for demonstrating poor task prioritization (communicating with ATC instead of analyzing the situation, failing to ensure that the checklist was performed in a timely manner); poor crew resource management (failing to trust but verify, failing to monitor his First Officer’s actions); and poor leadership (failing to establish a plan, failing to enforce adherence to procedures). However, investigators also wrote that many of his mistakes could have been influenced by stress, which is known to have effects similar to fatigue, including inhibited decision-making and reduced ability to conduct critical thinking.</p><p id="27a5">Although the NTSB pointed to the nature of the emergency itself as the possible source of his stress, it’s also worth noting that the cockpit voice recorder transcript supports a hypothesis that Captain Okai was already stressed before the flight even took off. He had been in a shouting match with another pilot less than 24 hours earlier and may have felt hurt or insulted by her refusal to fly with him. The salience of this event was clear, given that Okai spent a total of 32 minutes before the flight talking about his experiences with First Officer Moore, including after starting the engines and during taxi, in violation of the sterile cockpit rule, which prohibits off-topic conversations between engine start and 10,000 feet. This violation almost certainly had no effect on the course of events, but it did suggest that Okai was having difficulty focusing on the task at hand. In the end, the NTSB declined to mention these conversations in its final report, which is normal — most of the time, the agency doesn’t wade into pilots’ personal disputes — but when taken in context, it’s difficult to ignore.</p><p id="fa8b">◊◊◊</p><figure><figcaption>The nose section is loaded onto a barge. (NTSB)</figcaption></figure><p id="b3e4">Although the crash was the direct result of the flight crew’s actions, it’s worth summarizing the mechanical aspects before bowing out. The final report and its supporting documentation are light on details, but the cause of the failure seems to have been simple corrosion of either one or two high pressure turbine blades. The question of whether this corrosion was detectable during routine inspections, and why the corrosion appeared in the first place, don’t seem to have been addressed. However, given that the corrosion was internal to the blades, it’s possible that it was difficult to detect, which is supported by the NTSB’s explicit conclusion, stated in its report, that “maintenance was not a factor in this accident.” Furthermore, corrosion is an inevitability on airplanes and engines operating in Hawaii’s humid, salty climate, especially over long timeframes. The engine that failed was built in 1968 and was 53 years old at the time of the crash, plenty long enough to develop all manner of problems, especially if the maintenance was not always up to par.</p><p id="3bc1">There was plenty of circumstantial evidence to suggest that maintenance was a major problem area for Transair. Captain Okai said he had experienced five engine failures while flying 737s for Transair, which is a lot, and issues like high engine temperatures on takeoff were common. The airline’s chief maintenance inspector had also resigned two weeks before the crash, citing insufficient staffing, time, and experience. And according to a colleague, First Officer Ryan had previously called the airline’s safety culture “screwed up” and “beyond help.” These problems had been brewing in the background for some time, and in May 2022, the Federal Aviation Administration revoked Rhoades Aviation’s air operator certificate, permanently grounding Transair, after an investigation found numerous maintenance violations, including 33 flights performed with unairworthy engines. However, the investigation and its findings were said to have nothing to do with the accident, which was caused by an apparently undetectable issue.</p><p id="4122">◊◊◊</p><figure><figcaption>The underside of the nose section was heavily damaged during the impact. (NTSB)</figcaption></figure><p id="5789">With Transair having ceased to exist by the time the investigation concluded, and with very few Boeing 737–200s remaining in service in the United States, the NTSB did not issue any safety recommendations as a result of the accident. Nevertheless, as the latest example in a series of crashes involving shutdown of an incorrect engine, it’s worth extracting some lessons anyway. The crash of Transair flight 810 in particular evokes the 1989 disaster involving <a rel="noopener" href="https://admiralcloudberg.medium.com/lefts-rights-and-wrongs-the-crash-of-british-midland-flight-92-or-the-kegworth-air-disaster-a3989feb4d3a#:%7E:text=On%20the%208th%20of%20January,height%20of%20just%20900%20feet">British Midland flight 92</a>, another Boeing 737 that suffered a partial engine failure, only to crash short of the airport after the pilots mistakenly shut down the wrong engine. The reasons for the engine failures and for the pilots’ mistakes in both crashes were different — for instance, the British Midland investigation cited poorly designed gauges that were not installed on earlier 737–200s like that involved in the Transair crash. However, both cases were characterized by a lack of due care in determining the failed engine, including captains who uncritically believed their first officers’ unsupported and incorrect determinations.</p><figure><figcaption>An NTSB investigator examines the recovered nose section. (NTSB)</figcaption></figure><p id="967e">The fact that the same mistakes could occur again after 32 years underscores the need for pilots to double and triple check which engine has failed, but it also highlights the limitations of better training and words of caution in manuals as a solution to this recurring issue. As I mentioned in my article on the British Midland crash, the most effective way to prevent this kind of accident is by fitting airplanes with an Engine Indicating and Crew Alerting System, known as EICAS, or similar equipment. These systems automatically monitor engine performance and, should an engine fail, will produce a message informing the pilots which engine is the cause of the problem, dramatically reducing the probability of an incorrect identification. However, retrofitting the systems onto older 737s, which are most at risk, is not required and may be impractical or impossible. For that reason, as long as first and second generation 737s continue to fly, a safety risk still exists, and now that the findings of the Transair investigation have been released, that fact bears repeating: as long as pilots rely on context clues to determine which engine has failed, the opportunity for this type of error will remain. Let us merely be thankful that this latest warning did not come to us at the cost of lives — and let us not squander it.</p><p id="482b">_______________________________________________________________</p><p id="2a7e"><a href="https://www.reddit.com/r/CatastrophicFailure/comments/14nxu5c/2021_the_crash_of_transair_flight_810_a_boeing/?" rel="noopener ugc nofollow" target="_blank">Join the discussion of this article on Reddit</a></p><p id="72db"><a href="https://www.patreon.com/Admiral_Cloudberg" rel="noopener ugc nofollow" target="_blank">Support me on Patreon</a> (Note: I do not earn money from views on Medium!)</p><p id="b1bb"><a href="https://twitter.com/KyraCloudy" rel="noopener ugc nofollow" target="_blank">Follow me on Twitter</a></p><p id="5a52">Visit <a href="https://www.reddit.com/r/AdmiralCloudberg/" rel="noopener ugc nofollow" target="_blank">r/admiralcloudberg</a> to read and discuss over 240 similar articles</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[What gets to the front page of Hacker News? (138 pts)]]></title>
            <link>https://randomshit.dev/posts/what-gets-to-the-front-page-of-hacker-news</link>
            <guid>36590226</guid>
            <pubDate>Tue, 04 Jul 2023 17:53:41 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://randomshit.dev/posts/what-gets-to-the-front-page-of-hacker-news">https://randomshit.dev/posts/what-gets-to-the-front-page-of-hacker-news</a>, See on <a href="https://news.ycombinator.com/item?id=36590226">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p><img src="https://randomshit.dev/images/hacker-news/front-page.png"></p>
<p>In my job as technical writer / marketer<sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup>, the most common question I get from companies I work with is “how do we get to the front page of Hacker News?” And as someone whose writing has been on said front page many times, I’ll tell you: <strong>I have no clue!</strong></p>
<p>Sometimes it seems like good, high quality writing always finds its way to the front page; other times, it feels like the mods are out to get you. So I started (very manually) collecting data on what the top 30 posts on HN are at the end of any given day.</p>
<p>Here are the highlights (FP = Front Page):</p>
<ul>
<li><strong>Blog posts</strong> (45%) are the most popular type of content on the FP</li>
<li>A blog post from a <strong>corporate entity</strong> only has a 8% shot at making the FP</li>
<li>25% of FP posts are blog posts from engineers on their <strong>personal blogs/sites or OSS</strong></li>
<li>36% of FP posts are <strong>news articles</strong>, and the (slight) majority of them are actually not about software/hardware</li>
<li>ShowHN posts almost never make the front page (&lt;2%)</li>
</ul>
<p>Here’s the breakdown more visually:</p>
<p><img src="https://randomshit.dev/images/hacker-news/top-30-by-category.png"></p>
<p>Before some more analysis and a few more charts, I want to preface this post by saying that I don’t mean to comment on the <em>inherent value</em> of getting your content to the front page of Hacker News. Whether this is the right goal, or if perhaps you should pursue a different goal like number of upvotes, or maybe comments, or maybe <em>angry</em> comments, is a discussion for another post.</p>
<h2>How I gathered and categorized the data</h2>
<p>The way I gathered this (small) data set was by manually<sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="" aria-describedby="footnote-label">2</a></sup> combing through the top 30 posts on Hacker News using the <a href="https://news.ycombinator.com/front"><code>past</code></a> feature. For each post, I clicked on the link to see what the content was about, who published it, and where. Partially in advance, and then partially on the fly the more stuff I saw, I classified each post into a category. Since my main focus is technical writing and marketing, the categories I chose relate to that lens:</p>
<ul>
<li>News / opinion articles in media publications</li>
<li>Academic journals and papers</li>
<li>Blog posts
<ul>
<li>Personal blog vs. a corporate blog vs. an open source entity</li>
<li>Types of content: tutorials, thought leadership, etc.</li>
</ul>
</li>
<li>Hiring announcements</li>
<li>ShowHN</li>
<li>Misc.
<ul>
<li>Repo links</li>
<li>Non-blog websites</li>
<li>Tweets, Reddit posts, etc.</li>
</ul>
</li>
</ul>
<p>These categories have excellent coverage (Misc. &lt;5%) despite them being oddly specific. You can see that I wasn’t particularly concerned with the <em>subject matter</em> per se (everything is about Rust anyway) but more the format and the authoring entity.</p>
<p>The astute reader will note several limitations of the data set. </p>
<p>First, the data I collected represents what <em>finished</em> the day on the front page of Hacker News. But many items will <em>be</em> on the front page over the course of a given day, and then end the day somewhere else (perhaps number 35, or 67). What “gets to” the front page – a group that contains, and exceeds the size of, what “ends” on the front page - is a richer data set but I do not have access to it / it may not exist.</p>
<p>Second, and perhaps more importantly, the dataset doesn’t record the <em>attempts</em> made to get to the front page, i.e. all posts on Hacker News in a given day. It’s possible that there are orders of magnitude more blog posts <em>posted</em>  but fewer that <em>make</em> the FP, whereas 95% of any academic paper submitted makes the front page (extreme figures used for illustrative purposes). So for simplicity, I’ll say “the likelihood of making the FP” which assumes a constant rate of conversion from post to FP across different categories.</p>
<p>Limitations aside, the results started to converge very clearly after only 5 or 6 days of data, although there were a few outlier days with spikes in a particular category. In total I collected and sifted through 30 days worth of data, and hope to add more in the future.</p>
<h2>What kinds of blog posts get to the front page?</h2>
<p>Statistically, your best shot of getting your writing to the front page of Hacker News is by writing something (with nothing to promote) on your personal website or blog. 26% of total FP posts are blogs like this, while only 11% of total FP posts (or 24% of FP <em>blog</em> posts) came from corporate<sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="" aria-describedby="footnote-label">3</a></sup> entities on their corporate blogs or websites. 20% of blog posts are from some sort of open source entity (usually launches).</p>
<p>On the subject of what to post, <a href="https://news.ycombinator.com/newsguidelines.html">the Hacker News guidelines</a> say:</p>
<blockquote>
<p><em>On-Topic: Anything that good hackers would find interesting. That includes more than hacking and startups. If you had to reduce it to a sentence, the answer might be: anything that gratifies one's intellectual curiosity.</em></p>
</blockquote>
<p>and this is pretty much the story with what blog posts make the FP. </p>
<p><img src="https://randomshit.dev/images/hacker-news/blog-posts.png"></p>
<p>Of those corporate blog posts, about 40% of them are product announcements or launches; the rest are less promotional content formats like technical tutorials. A common question I get is “how do we get our product launch on the front page of HackerNews?” and the answer is that it’s statistically<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="" aria-describedby="footnote-label">4</a></sup> highly unlikely (~4%) for that to happen. And of those product announcements that made the FP, a good deal of them are (a) from established companies and products like Apple, (b) posted organically by the community, and (c) about hardware and gaming. Not your software startup.</p>
<p>Personal blog posts, though, are highly popular on the FP. They span the gamut from tutorials to “how I built ___” type posts, and of course the perennial “I made a thing.” Here are a few examples of personal blog posts that made the FP:</p>
<ul>
<li><a href="https://tavianator.com/2023/futex.html">You could have invented Futexes</a></li>
<li><a href="https://jingnanshi.com/blog/groebner_basis.html">Use Gröbner Bases To Solve Polynomial Equations</a></li>
<li><a href="https://www.milanvit.net/post/my-ultimate-shell-setup-with-fish-shell-and-tmux/">My ultimate shell setup with Fish shell and Tmux</a></li>
<li><a href="https://ariadne.space/2023/04/13/writing-portable-arm64-assembly/">Writing portable ARM64 assembly</a></li>
</ul>
<p>The common thread is that they’re non-promotional, and typically focus on a personal pursuit of the author<sup><a href="#user-content-fn-5" id="user-content-fnref-5" data-footnote-ref="" aria-describedby="footnote-label">5</a></sup>.</p>
<p>My personal experience writing for corporate entities says that useful tutorials and interesting stories do the best. The most recent post I wrote that made it to #1 was a tutorial for PlanetScale about how database sharding works (HN post <a href="https://news.ycombinator.com/item?id=35476518">here</a>). A few others I wrote that made the FP were all non-promotional:</p>
<ul>
<li>My two stories for Retool about why Accenture (<a href="https://news.ycombinator.com/item?id=26969364">link</a>) and Oracle (<a href="https://news.ycombinator.com/item?id=29004597">link</a>) are worth so much money</li>
<li>My blog post for WorkOS about best practices for building webhooks (<a href="https://news.ycombinator.com/item?id=26401838">link</a>)</li>
<li>My “thought leadership” for PlanetScale about DBA experience (<a href="https://news.ycombinator.com/item?id=28330297">link</a>)</li>
</ul>
<p>These successes live next door to a massive graveyard of blog posts I’ve written that <em>I</em> thought were really good, but Hacker News did not. Or perhaps randomness just reared its ugly head. </p>
<h2>What kinds of news gets to the front page?</h2>
<p>The second biggest category of posts that make the front page of Hacker News is (shocker) news, which I define here as a story or opinion piece published by a media organization. 36% of FP items are news, which is a lot!</p>
<p>While almost all of the news that makes the FP is STEM related, the majority of it (well, by a few percentage points) doesn’t relate to software or hardware. There are a lot of articles about space exploration and rockets, biology and chemistry, and physics, but fewer about code and SaaS and things like that. </p>
<p><img src="https://randomshit.dev/images/hacker-news/news.png"></p>
<p>It’s worth noting that I didn’t see a single article from TechCrunch in the entire dataset I gathered, despite there being plenty of articles for places like the Verge, Wired, etc. A cursory search using <a href="https://hn.algolia.com/?dateRange=all&amp;page=0&amp;prefix=true&amp;query=techcrunch&amp;sort=byPopularity&amp;type=story">Algolia’s Search HackerNews tool</a>, ordered by number of upvotes, reveals that HackerNews really does not like TechCrunch very much.</p>
<p><img src="https://randomshit.dev/images/hacker-news/techcrunch.png"></p>
<h2>Miscellaneous findings and other things</h2>
<p>6% of items on the front page are academic papers, which is more than I thought.</p>
<p>ShowHN is very valuable, but is not likely to land your product on the front page.</p>
<p>Tweets and tweet threads sometimes make the front page.</p>
<p>It’s uncommon for hiring or launch posts - the two types of posts that are reserved for YC companies, and “artificially” promoted by moderators - to make the front page.</p>
<p>You can access the underlying dataset <a href="https://docs.google.com/spreadsheets/d/1iUYmm4PRFbRi6KmDztRyCDiaHOLjsze4zT6Ts4-qbxk/edit?usp=sharing">here</a>.</p>
<p>I want to thank <a href="https://github.com/minimaxir">Max Woolf</a> (who may recall interviewing me for a Data Science job at Buzzfeed that I thankfully did not take) for the excellent <a href="https://github.com/minimaxir/hacker-news-undocumented">“Hacker News Undocumented”</a> resource. It was tremendously helpful. </p>
<hr>
<h2>Footnotes</h2>
<section data-footnotes="">
<p id="user-content-fn-1">1. With an undergrad Data Science degree for some reason <a href="#user-content-fnref-1" data-footnote-backref="" aria-label="Back to content">↩</a></p>
<p id="user-content-fn-2">2. For the empathetic reader wondering why I did this manually when there are tons of ways for the author (who, as mentioned in the previous footnote, has a Data Science degree) to access historical Hacker News data via <a href="https://console.cloud.google.com/marketplace/details/y-combinator/hacker-news?project=flowing-bonito-366719">BigQuery</a>, <a href="https://github.com/HackerNews/API">API</a>, etc. – the amount of effort it would have taken to train a classifier would have been highly impractical, plus I’d need to manually label the data anyway. <a href="#user-content-fnref-2" data-footnote-backref="" aria-label="Back to content">↩</a></p>
<p id="user-content-fn-3">3. By this I mean closed source, basically. Anything written on the blog of a company that is selling something. <a href="#user-content-fnref-3" data-footnote-backref="" aria-label="Back to content">↩</a></p>
<p id="user-content-fn-4">4. Noting once again that this framing isn’t entirely fair, since the dataset is missing attempts. <a href="#user-content-fnref-4" data-footnote-backref="" aria-label="Back to content">↩</a></p>
<p id="user-content-fn-5">5. Which makes me wonder if the best “front page strategy” might be to encourage your engineering team to work on their personal blogs? <a href="#user-content-fnref-5" data-footnote-backref="" aria-label="Back to content">↩</a></p>
</section>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Turning my hobby into a business made me hate it (333 pts)]]></title>
            <link>https://shant.nu/turning-my-passion-hobby-into-a-business-made-me-hate-it/</link>
            <guid>36588514</guid>
            <pubDate>Tue, 04 Jul 2023 16:06:44 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://shant.nu/turning-my-passion-hobby-into-a-business-made-me-hate-it/">https://shant.nu/turning-my-passion-hobby-into-a-business-made-me-hate-it/</a>, See on <a href="https://news.ycombinator.com/item?id=36588514">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>This is a problem many people who love doing creative stuff (writing, music, programming, painting, pottery, calligraphy, anything creative and original) will face:</p>



<blockquote>
<p><em>“This is good, why don’t you make money from it?”</em></p>
</blockquote>



<p>As if the only value anything has is by how much dollars it makes.</p>



<p>You could create the most beautiful painting, the most moving music, the most engaging novel, but if you don’t have the big dolla’s in your bank account, you are a failure.</p>



<p>And all of it is complicated by the fact that, yes, like most creatives, I <em>do want</em> to make money from my writing. Maybe not millions, but a little would help. Especially when the day job is going shit, and you know the fantasy that online entrepreneurs sell:</p>



<blockquote>
<p><em>Quit the day job! Start your own business! Don’t depend on one person for all your income! Blah blah blah! Now buy my book/course, so at least one of us can get rich.</em></p>
</blockquote>



<p>It doesn’t help with all these online “gurus” who claim you can make the big $$$ by selling anything (yes sir, ANYTHING!) online, if only you buy their expensive course.</p>



<p>One guru (and why name him, since they all do the same) says you can make money online (BIG MONEY!) even if you are selling things like crotchet kits or dog training. All you have to do is <em>(in thunderous manly voice)</em>:</p>



<p><strong>FOLLOW MY FORMULA!</strong></p>



<p>His formula was, in a nutshell: Create training courses and sell them to others, just as he was doing. And at least one of us made big money (<em>hint, it wasn’t me</em>).</p>



<p><strong>My story</strong></p>



<p>I loved writing fiction– novels, short stories, interactive fiction. At first, I would just self-publish them on Amazon, no care whether anyone bought them.</p>



<p>Then I joined a few writer groups, and they were all like “You need to market your work”.</p>



<p>And so I spent hours every week building my email list, running ads, asking for reviews (as you need them to sell books), blogs/podcasts.</p>



<p>I found the type of fiction that sells is in a few mainstream genres, and in series (so you write a dozen books, all with a hard-boiled detective, for example). That’s why every book nowadays is in a series because publishers (traditional and indie)have figured out this is the “formula” to success.</p>



<p>I like to experiment and play—one genre I love writing is comedy-horror. This is one of those super niche genres that have a few hardcore fans but isn’t mainstream. Think <em>Shaun of the Dead</em> in movies, or one of my favourite books <em>John Dies at the End.</em></p>



<p>Other books I wrote were supernatural detective series, a fantasy comedy (a teddy bear that solves crime). Now, there are books like these and sell (and where do you think I got ideas from?), but they are not mainstream.</p>



<p>If you want to make the big money, you at least have to try writing for the “market” or trying to write in a way that appeals to the mainstream, or at least a large number of people.</p>



<p>So that’s what I did. Why not? Everyone else was doing it. They were pasting screenshots of how much money they were making online in Facebook groups.</p>



<p>And while all the above I tried worked in the short term (and yes, it DOES work), soon I began to hate what I was doing and one day, I just couldn’t type anymore.</p>



<p>And one day, I couldn’t take it anymore. Couldn’t type one more word. Quit 2 years ago, after 7-8 years of writing.</p>



<p>Have tried to restart many times, but each time, I feel disgusted and quit.</p>



<p><strong>Trying to make money from your “passion” is hard</strong></p>



<p><em>Just follow your passion and you won’t have to work a day!</em></p>



<p>Sure, if your passion is online marketing or making WordPress sites for cash-rich, time-poor business owners.</p>



<p>When I was writing, I hit all the clichés about “passion”:</p>



<ul>
<li>I would be lost for hours in writing</li>



<li>I loved doing it</li>



<li>I did it for several years non-stop, including training to become better</li>
</ul>



<p>And yet, in spite of my passionate “passion”, I never made enough money to quit the day job. I followed my passion and all it gave my was wrist pain.</p>



<p>And it is a field where people make money— but like many other creative fields (music, sports, art), it’s a winner-take-all field. 5-10% of authors make 90% of the money. And that’s fine, I knew the statistics before I started.</p>



<p>But I was still hoping to make some money. To be honest, I do, but it’s never been more than a fancy night out each month.</p>



<p>I never cracked the Amazon algorithm; I never got 10,000 fans on Facebook; I never got a huge email list of people <em>Oh gosh! Just waiting to buy my book.</em></p>



<p>And in trying to hit these targets, I started hating what I was actually doing — writing.</p>



<p><strong>My advice is</strong>: If you love someone, do it for love, don’t always try to make money from it.</p>



<p>It all comes back to doing it for the love and accepting that perhaps this will always remain a hobby. Do it with a craftsman’s mindset, always improving for the sake of improving.</p>



<p>And don’t let anyone shame you if you don’t want to make money.</p>



<p><em>Note: I wrote this post 2–3 years ago, and it had been sitting on my hard drive since then.</em> <em>I have given up fiction writing, though my books are still online I don’t do anything to promote them, nor am I writing new ones. I wrote this post as a warning: If you love something, do it for the love and don’t let the Get-Rich-Types make you lose your focus.</em></p>



<p>Read more posts on <strong><a href="https://shant.nu/creativity-series/">Creativity</a></strong></p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[ZFS 2.2.0 (RC): Block Cloning merged (262 pts)]]></title>
            <link>https://github.com/openzfs/zfs/pull/13392</link>
            <guid>36588240</guid>
            <pubDate>Tue, 04 Jul 2023 15:46:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/openzfs/zfs/pull/13392">https://github.com/openzfs/zfs/pull/13392</a>, See on <a href="https://news.ycombinator.com/item?id=36588240">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
  
  <task-lists disabled="" sortable="">
    <div>
      


<h3 dir="auto">Motivation and Context</h3>
<p dir="auto">Block Cloning allows to clone a file (or a subset of its blocks) into another (or the same) file by just creating additional references to the data blocks without copying the data itself. Block Cloning can be described as a fast, manual deduplication.</p>
<h3 dir="auto">Description</h3>
<p dir="auto">In many ways Block Cloning is similar to the existing deduplication, but there are some important differences:</p>
<ul dir="auto">
<li>Deduplication is automatic and Block Cloning is not - one has to use a dedicated system call(s) to clone the given file/blocks.</li>
<li>Deduplication keeps all data blocks in its table, even those referenced just ones. Block Cloning creates an entry in its tables only when there are at least two references to the given data block. If the block was never explicitly cloned or the second to last reference was dropped, there will be neither space nor performance overhead.</li>
<li>Deduplication needs data to work - one needs to pass real data to the write(2) syscall, so hash can be calculated. Block Cloning doesn't require data, just block pointers to the data, so it is extremely fast, as we pay neither the cost of reading the data, nor the cost of writing the data - we operate exclusively on metadata.</li>
<li>If the D (dedup) bit is not set in the block pointer, it means that the block is not in the dedup table (DDT) and we won't consult the DDT when we need to free the block. Block Cloning must be consulted on every free, because we cannot modify the source BP (eg. by setting something similar to the D bit), thus we have no hint if the block is in the Block Reference Table (BRT), so we need to look into the BRT. There is an optimization in place that allows to eliminate majority of BRT lookups that is described below in the "Minimizing free penalty" section.</li>
<li>The BRT entry is much smaller than the DDT entry - for BRT we only store 64bit offset and 64bit reference counter.</li>
<li>Dedup keys are cryptographic hashes, so two blocks that are close to each other on disk are most likely in totally different parts of the DDT.  The BRT entry keys are offsets into a single top-level VDEV, so data blocks from one file should have BRT entries close to each other.</li>
<li>Scrub will only do a single pass over a block that is referenced multiple times in the DDT. Unfortunately it is not currently (if at all) possible with Block Cloning and block referenced multiple times will be scrubbed multiple times.</li>
<li>Deduplication requires cryptographically strong hash as a checksum or additional data verification. Block Cloning works with any checksum algorithm or even with checksumming disabled.</li>
</ul>
<p dir="auto">As mentioned above, the BRT entries are much smaller than the DDT entries.  To uniquely identify a block we just need its vdevid and offset. We also need to maintain a reference counter. The vdevid will often repeat, as there is a small number of top-level VDEVs and a large number of blocks stored in each VDEV. We take advantage of that to reduce the BRT entry size further by maintaining one BRT for each top-level VDEV, so we can then have only offset and counter as the BRT entry.</p>
<p dir="auto">Minimizing free penalty.</p>
<p dir="auto">Block Cloning allows to clone any existing block. When we free a block there is no hint in the block pointer whether the block was cloned or not, so on each free we have to check if there is a corresponding entry in the BRT or not. If there is, we need to decrease the reference counter. Doing BRT lookup on every free can potentially be expensive by requiring additional I/Os if the BRT doesn't fit into memory. This is the main problem with deduplication, so we've learn our lesson and try not to repeat the same mistake here. How do we do that? We divide each top-level VDEV into 64MB regions. For each region we maintain a reference counter that is a sum of all reference counters of the cloned blocks that have offsets within the region. This creates the regions array of 64bit numbers for each top-level VDEV. The regions array is always kept in memory and updated on disk in the same transaction group as the BRT updates to keep everything in-sync. We can keep the array in memory, because it is very small. With 64MB regions and 1TB VDEV the array requires only 128kB of memory (we may decide to decrease the region size in the future). Now, when we want to free a block, we first consult the array. If the counter for the whole region is zero, there is no need to look for the BRT entry, as there isn't one for sure. If the counter for the region is greater than zero, only then we will do a BRT lookup and if an entry is found we will decrease the reference counters in the entry and in the regions array.</p>
<p dir="auto">The regions array is small, but can potentially be larger for very large VDEVs or smaller regions. In this case we don't want to rewrite entire array on every change. We then divide the regions array into 128kB chunks and keep a bitmap of dirty chunks within a transaction group. When we sync the transaction group we can only update the parts of the regions array that were modified. Note: Keeping track of the dirty parts of the regions array is implemented, but updating only parts of the regions array on disk is not yet implemented - for now we will update entire regions array if there was any change.</p>
<p dir="auto">The implementation tries to be economic: if BRT is not used, or no longer used, there will be no entries in the MOS and no additional memory used (eg.  the regions array is only allocated if needed).</p>
<p dir="auto">Interaction between Deduplication and Block Cloning.</p>
<p dir="auto">If both functionalities are in use, we could end up with a block that is referenced multiple times in both DDT and BRT. When we free one of the references we couldn't tell where it belongs, so we would have to decide what table takes the precedence: do we first clear DDT references or BRT references? To avoid this dilemma BRT cooperates with DDT - if a given block is being cloned using BRT and the BP has the D (dedup) bit set, BRT will lookup DDT entry and increase the counter there. No BRT entry will be created for a block that resides on a dataset with deduplication turned on.  BRT may be more efficient for manual deduplication, but if the block is already in the DDT, then creating additional BRT entry would be less efficient. This clever idea was proposed by Allan Jude.</p>
<p dir="auto">Block Cloning across datasets.</p>
<p dir="auto">Block Cloning is not limited to cloning blocks within the same dataset.  It is possible (and very useful) to clone blocks between different datasets.<br>
One use case is recovering files from snapshots. By cloning the files into dataset we need no additional storage. Without Block Cloning we would need additional space for those files.<br>
Another interesting use case is moving the files between datasets (copying the file content to the new dataset and removing the source file).  In that case Block Cloning will only be used briefly, because the BRT entries will be removed when the source is removed.<br>
Note: currently it is not possible to clone blocks between encrypted datasets, even if those datasets use the same encryption key (this includes snapshots of encrypted datasets). Cloning blocks between datasets that use the same keys should be possible and should be implemented in the future.</p>
<p dir="auto">Block Cloning flow through ZFS layers.</p>
<p dir="auto">Note: Block Cloning can be used both for cloning file system blocks and ZVOL blocks. As of this writing no interface is implemented that allows for ZVOL blocks cloning.<br>
Depending on the operating system there might be different interfaces to clone blocks. On FreeBSD we have two syscalls:</p>
<div data-snippet-clipboard-copy-content=" ssize_t fclonefile(int srcfd, int dstfd);
 ssize_t fclonerange(int srcfd, off_t srcoffset, size_t length, int dstfd, off_t dstoffset);"><pre><code> ssize_t fclonefile(int srcfd, int dstfd);
 ssize_t fclonerange(int srcfd, off_t srcoffset, size_t length, int dstfd, off_t dstoffset);
</code></pre></div>
<p dir="auto">Even though fclonerange() takes byte offsets and length, they have to be block-aligned.<br>
Both syscalls call OS-independent zfs_clone_range() function. This function was implemented based on zfs_write(), but instead of writing the given data we first read block pointers using the new dmu_read_l0_bps() function from the source file. Once we have BPs from the source file we call the dmu_brt_addref() function on the destination file. This function allocates BPs for us. We iterate over all source BPs. If the given BP is a hole or an embedded block, we just copy BP. If it points to a real data we place this BP on a BRT pending list using the brt_pending_add() function.</p>
<p dir="auto">We use this pending list to keep track of all BPs that got new references within this transaction group.</p>
<p dir="auto">Some special cases to consider and how we address them:</p>
<ul dir="auto">
<li>The block we want to clone may have been created within the same transaction group as we are trying to clone. Such block has no BP allocated yet, so it is too early to clone it. In this case the dmu_read_l0_bps() function will return EAGAIN and in the zfs_clone_range() function we will wait for the transaction group to be synced to disks and retry.</li>
<li>The block we want to clone may have been modified within the same transaction group. We could potentially clone the previous version of the data, but that doesn't seem right. We handle it as the previous case.</li>
<li>A block may be cloned multiple times during one transaction group (that's why pending list is actually a tree and not an append-only list - this way we can figure out faster if this block is cloned for the first time in this txg or consecutive time).</li>
<li>A block may be cloned and freed within the same transaction group (see dbuf_undirty()).</li>
<li>A block may be cloned and within the same transaction group the clone can be cloned again (see dmu_read_l0_bps()).</li>
<li>A file might have been deleted, but the caller still has a file descriptor open to this file and clones it.</li>
</ul>
<p dir="auto">When we free a block we have additional step in the ZIO pipeline where we call the zio_brt_free() function. We then call the brt_entry_decref() that loads the corresponding BRT entry (if one exists) and decreases reference counter. If this is not the last reference we will stop ZIO pipeline here. If this is the last reference or the block is not in the BRT, we continue the pipeline and free the block as usual.</p>
<p dir="auto">At the beginning of spa_sync() where there can be no more block cloning, but before issuing frees we call brt_pending_apply(). This function applies all the new clones to the BRT table - we load BRT entries and update reference counters. To sync new BRT entries to disk, we use brt_sync() function. This function will sync all dirty top-level-vdev BRTs, regions arrays, etc.</p>
<p dir="auto">Block Cloning and ZIL.</p>
<p dir="auto">Every clone operation is divided into chunks (similar to write) and each chunk is cloned in a separate transaction. To keep ZIL entries small, each chunk clones at most 254 blocks, which makes ZIL entry to be 32kB.  Replaying clone operation is different from the regular clone operation, as when we log clone operation we cannot use the source object - it may reside on a different dataset, so we log BPs we want to clone.<br>
The ZIL is replayed when we mount the given dataset, not when the pool is imported. Taking this into account it is possible that the pool is imported without mounting datasets and the source dataset is destroy before the destination dataset is mounted and its ZIL replayed.<br>
To address this situation we leverage zil_claim() mechanism where ZFS will parse all the ZILs on pool import. When we come across TX_CLONE_RANGE entries, we will bump reference counters for their BPs in the BRT and then on mount and ZIL replay we will just attach BPs to the file without bumping reference counters.<br>
Note it is still possible that after zil_claim() we never mount the destination, so we never replay its ZIL and we destroy it. This way we would end up with leaked references in BRT. We address that too as ZFS gives as a chance to clean this up on dataset destroy (see zil_free_clone_range()).</p>
<h3 dir="auto">How Has This Been Tested?</h3>
<p dir="auto">I have a test program that can make use of this functionality that I have been using for manual testing.</p>
<h3 dir="auto">Types of changes</h3>

<ul>
<li> Bug fix (non-breaking change which fixes an issue)</li>
<li> New feature (non-breaking change which adds functionality)</li>
<li> Performance enhancement (non-breaking change which improves efficiency)</li>
<li> Code cleanup (non-breaking change which makes code smaller or more readable)</li>
<li> Breaking change (fix or feature that would cause existing functionality to change)</li>
<li> Library ABI change (libzfs, libzfs_core, libnvpair, libuutil and libzfsbootenv)</li>
<li> Documentation (a change to man pages or other documentation)</li>
</ul>
<h3 dir="auto">Checklist:</h3>


<ul>
<li> My code follows the OpenZFS <a href="https://github.com/openzfs/zfs/blob/master/.github/CONTRIBUTING.md#coding-conventions">code style requirements</a>.</li>
<li> I have updated the documentation accordingly.</li>
<li> I have read the <a href="https://github.com/openzfs/zfs/blob/master/.github/CONTRIBUTING.md"><strong>contributing</strong> document</a>.</li>
<li> I have added <a href="https://github.com/openzfs/zfs/tree/master/tests">tests</a> to cover my changes.</li>
<li> I have run the ZFS Test Suite with this change applied.</li>
<li> All commit messages are properly formatted and contain <a href="https://github.com/openzfs/zfs/blob/master/.github/CONTRIBUTING.md#signed-off-by"><code>Signed-off-by</code></a>.</li>
</ul>
    </div>
  </task-lists>
  
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Makie, a modern and fast plotting library for Julia (241 pts)]]></title>
            <link>https://makie.org</link>
            <guid>36587875</guid>
            <pubDate>Tue, 04 Jul 2023 15:22:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://makie.org">https://makie.org</a>, See on <a href="https://news.ycombinator.com/item?id=36587875">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-jscall-id="21">
        <div data-jscall-id="22">
              <p><span data-jscall-id="27">Makie</span> is a modern plotting library for 
                <a href="https://julialang.org/" target="_blank" data-jscall-id="28">Julia</a>.
It is easy to use, fast and powerful. Packed with features,
it is a general-purpose tool that makes as few compromises for specialized use cases as possible.

              </p>
            </div>
        <div data-jscall-id="49">
            <h2 data-jscall-id="51">Features</h2>
            <div data-jscall-id="52">
                  <h2 data-jscall-id="55">Surgical updates &amp; high performance</h2><p>Makie uses Observables.jl to only update what's necessary at a given point in time.
This example animates hundreds of thousands of points just through a colormap update, modifying only a few bytes per frame directly on the GPU.
There's no faster way to animate large data. Combining the power of GPUs and Julia's high performance, Makie is fit for any task!

                  </p>
                </div>
            
            <div data-jscall-id="66">
              <div data-jscall-id="67">
                  <h2 data-jscall-id="69">Powerful Layouting</h2><p>Makie has one of the most powerful layouting systems compared to other plotting
libraries, allowing you to tweak any possible attribute and place your plots
and subplots freely.

                  </p>
                </div>
              <p><a href="https://docs.makie.org/stable/tutorials/layout-tutorial/" target="_blank" data-jscall-id="76">
                  <img src="https://makie.org/jsserve/png/layouting.png" data-jscall-id="77">
                </a>
              </p>
            </div>
            
            <div data-jscall-id="79">
                  <h2 data-jscall-id="82">2D, 3D, Volumes, Meshes, Sliders, Buttons and more</h2><p>Makie has support for all kind of primitives for interactive data exploration. This makes it simple to quickly build up dashboards for any kind of data.

                  </p>
                </div>
            
            <div data-jscall-id="93">
              <div data-jscall-id="94">
                  <h2 data-jscall-id="96">Powerful event system and rendering engine</h2><p>Makie is certainly not a game engine, but its rich rendering and interaction features allow the creation of simple, interactive games such as Minecraft.
While Makie might not be the go-to for more complex games, using it to build a Minecraft-like game highlights its versatility for complex, interactive visualizations.
Many use cases, such as AI gyms or complex, interactive 3D simulations, greatly benefit from this.

                </p></div>
              <p><a href="https://github.com/ashwani-rathee/Miner.jl" target="_blank" data-jscall-id="98">
                  <img src="https://makie.org/jsserve/png/miner.png" data-jscall-id="99">
                </a>
              </p>
            </div>
            
          </div>
        <div data-jscall-id="101">
            <h2 data-jscall-id="103">Backends</h2>
            <p>Makie's backends are the reason why we can have high quality vector graphics for publication while also delivering fast GPU accelerated renderings.
Use exactly the same code and change how your interactive graphic is displayed simply by switching the backend.
</p>
            <div data-jscall-id="105">
              <div data-jscall-id="106">
                  <h2 data-jscall-id="108">GLMakie</h2>
                  <p><span data-jscall-id="109">The backend for fast, interactive desktop applications.
It was Makie's first backend and uses the GPU via OpenGL for fast 3D animations.
It supports basic UI elements for simple Dashboards.
Either a hardware or virtual GPU (e.g. Mesa, VirtualGL) is necessary to use GLMakie.
(Image from:

                    <a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2022MS003527" target="_blank" data-jscall-id="110">A. N. Souza</a>)
                  </span>
                </p></div>
              <p><a href="https://docs.makie.org/stable/documentation/backends/glmakie/" target="_blank" data-jscall-id="112">
                  <img src="https://makie.org/jsserve/png/glmakie.png" data-jscall-id="113">
                </a>
              </p>
            </div>
            
            <div data-jscall-id="115">
              <div data-jscall-id="116">
                  <h2 data-jscall-id="118">CairoMakie</h2>
                  <p><span data-jscall-id="119">CairoMakie runs anywhere on the CPU and is Makie's backend for SVG and PDF vector graphics output.
With CairoMakie, you can achieve the highest quality output for publications and reports.
Because it uses vector graphics primitives, CairoMakie does not support 3D rendering the same way as GLMakie
and has no interactive mode.
(Image from:

                    <a href="https://beautiful.makie.org/" target="_blank" data-jscall-id="120">beautiful.makie.org</a>)
                  </span>
                </p></div>
              <p><a href="https://docs.makie.org/stable/documentation/backends/cairomakie/" target="_blank" data-jscall-id="122">
                  <img src="https://makie.org/jsserve/svg/cairomakie.svg" data-jscall-id="123">
                </a>
              </p>
            </div>
            
            <div data-jscall-id="125">
                  <h2 data-jscall-id="128">WGLMakie</h2>
                  <p><span data-jscall-id="129">WGLMakie puts your visualizations in the browser using Threejs and WebGL.
It runs almost anywhere on the GPU and is great for working on remote machines,
with Pluto or Jupyter notebooks, or in browser-like IDEs such as VSCode.
Like with all javascript-based visualization tools, there is an overhead when transferring large amounts of data to the browser.
(Image from:

                    <a href="https://www.visus.uni-stuttgart.de/" target="_blank" data-jscall-id="130">VISUS</a>)
                  </span>
                </p></div>
            
            <div data-jscall-id="136">
              <div data-jscall-id="137">
                  <h2 data-jscall-id="139">RPRMakie</h2>
                  <p><span data-jscall-id="140">RPRMakie is the newest experimental backend for raytraced images using RadeonProRender.
With appropriately fast hardware, you can render beautiful visualizations that show off your data
using physically accurate materials and lights.
(Image from:

                    <a href="https://github.com/lazarusA" target="_blank" data-jscall-id="141">Lazaro Alonso</a>)
                  </span>
                </p></div>
              <p><a href="https://docs.makie.org/stable/documentation/backends/rprmakie/" target="_blank" data-jscall-id="143">
                  <img src="https://makie.org/jsserve/png/earths_creditst.png" data-jscall-id="144">
                </a>
              </p>
            </div>
          </div>
        <div data-jscall-id="145">
            <h2 data-jscall-id="147">Rich Ecosystem</h2>
            <p>Makie is highly modular and extensible.
Many use cases are already covered by its inbuilt plot types and interactive elements.
For more specialized applications, have a look at the rich third-party ecosystem that has developed around Makie:
</p>
            
          </div>
        <div data-jscall-id="316">
            <p>Users</p>
            
            <p>Supporters</p>
            
            <p>Follow us</p>
            
          </div>
      </div></div>]]></description>
        </item>
    </channel>
</rss>