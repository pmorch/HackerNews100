<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 10 Apr 2024 17:00:06 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Twitter's pivot to x.com is a gift to phishers (255 pts)]]></title>
            <link>https://krebsonsecurity.com/2024/04/twitters-clumsy-pivot-to-x-com-is-a-gift-to-phishers/</link>
            <guid>39991173</guid>
            <pubDate>Wed, 10 Apr 2024 14:35:37 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://krebsonsecurity.com/2024/04/twitters-clumsy-pivot-to-x-com-is-a-gift-to-phishers/">https://krebsonsecurity.com/2024/04/twitters-clumsy-pivot-to-x-com-is-a-gift-to-phishers/</a>, See on <a href="https://news.ycombinator.com/item?id=39991173">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
												<p>On April 9, Twitter/X began automatically modifying links that mention “twitter.com” to read “x.com” instead. But over the past 48 hours, dozens of new domain names have been registered that demonstrate how this change could be used to craft convincing phishing links — such as <strong>fedetwitter[.]com</strong>, which until very recently rendered as <strong>fedex.com</strong> in tweets.</p>
<div id="attachment_67139"><p><img aria-describedby="caption-attachment-67139" decoding="async" src="https://krebsonsecurity.com/wp-content/uploads/2024/04/ruseriousx.png" alt="" width="652" height="698"></p><p id="caption-attachment-67139">The message displayed when one visits carfatwitter.com, which Twitter/X displayed as carfax.com in tweets and messages.</p></div>
<p>A search at <a href="https://www.domaintools.com/" target="_blank" rel="noopener">DomainTools.com</a> shows at least 60 domain names have been registered over the past two days for domains ending in “twitter.com,” although research so far shows the majority of these domains have been registered “defensively” by private individuals to prevent the domains from being purchased by scammers.</p>
<p>Those include <strong>carfatwitter.com</strong>, which Twitter/X truncated to carfax.com when the domain appeared in user messages or tweets. Visiting this domain currently displays a message that begins, “Are you serious, X Corp?”</p>
<p><strong>Update:</strong> It appears Twitter/X has corrected its mistake, and no longer truncates any domain ending in “twitter.com” to “x.com.”</p>
<p><em>Original story:</em></p>
<p>The same message is on other newly registered domains, including <strong>goodrtwitter.com</strong> (goodrx.com), <strong>neobutwitter.com</strong> (neobux.com), <strong>roblotwitter.com</strong> (roblox.com), <strong>square-enitwitter.com</strong> (square-enix.com) and yandetwitter.com (yandex.com). The message left on these domains indicates they were defensively registered by <a href="https://compostintraining.club/@prplecake" target="_blank" rel="noopener">a user on Mastodon</a> whose bio says they are a systems admin/engineer. That profile has not responded to requests for comment.</p>
<p>A number of these new domains including “twitter.com” appear to be registered defensively by Twitter/X users in Japan. The domain netflitwitter.com (netflix.com, to Twitter/X users) now displays a message saying it was “acquired to prevent its use for malicious purposes,” along with a Twitter/X username.</p>
<p>The domain mentioned at the beginning of this story — fedetwitter.com — redirects users to the blog of a Japanese technology enthusiast. A user with the handle “amplest0e” appears to have registered <strong>space-twitter.com</strong>, which Twitter/X users would see as the CEO’s “space-x.com.” The domain “ametwitter.com” already redirects to the real americanexpress.com.<span id="more-67137"></span></p>
<p>Some of the domains registered recently and ending in “twitter.com” currently do not resolve and contain no useful contact information in their registration records. Those include <strong>firefotwitter[.]com</strong> (firefox.com), <strong>ngintwitter[.]com</strong> (nginx.com), and <strong>webetwitter[.]com</strong> (webex.com).</p>
<div id="attachment_67144"><p><img aria-describedby="caption-attachment-67144" decoding="async" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2024/04/sextwitter.png" alt="" width="750" height="491" srcset="https://krebsonsecurity.com/wp-content/uploads/2024/04/sextwitter.png 1299w, https://krebsonsecurity.com/wp-content/uploads/2024/04/sextwitter-768x503.png 768w, https://krebsonsecurity.com/wp-content/uploads/2024/04/sextwitter-782x512.png 782w" sizes="(max-width: 750px) 100vw, 750px"></p><p id="caption-attachment-67144">The domain setwitter.com, which Twitter/X until very recently rendered as “sex.com,” redirects to this blog post warning about the recent changes and their potential use for phishing.</p></div>
<p><strong>Sean McNee</strong>, vice president of research and data at DomainTools, told KrebsOnSecurity it appears Twitter/X did not properly limit its redirection efforts.</p>
<p>“Bad actors could register domains as a way to divert traffic from legitimate sites or brands given the opportunity — many such brands in the top million domains end in x, such as webex, hbomax, xerox, xbox, and more,” McNee said. “It is also notable that several other globally popular brands, such as Rolex and Linux, were also on the list of registered domains.”</p>
<p>The apparent oversight by Twitter/X was cause for amusement and amazement from many former users who have migrated to other social media platforms since the new CEO took over. <strong>Matthew Garrett</strong>, a lecturer at U.C. Berkeley’s School of Information, <a href="https://infosec.exchange/@mjg59@nondeterministic.computer/112243298637438787" target="_blank" rel="noopener">summed up</a> the Schadenfreude thusly:</p>
<p>“Twitter just doing a ‘redirect links in tweets that go to x.com to twitter.com instead but accidentally do so for all domains that end x.com like eg spacex.com going to spacetwitter.com’ is not absolutely the funniest thing I could imagine but it’s high up there.”</p>
											</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[2023 ACM Turing Prize awarded to Avi Wigderson (103 pts)]]></title>
            <link>https://awards.acm.org/about/2023-turing</link>
            <guid>39990004</guid>
            <pubDate>Wed, 10 Apr 2024 12:36:43 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://awards.acm.org/about/2023-turing">https://awards.acm.org/about/2023-turing</a>, See on <a href="https://news.ycombinator.com/item?id=39990004">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>ACM has named <a href="https://awards.acm.org/award-recipients/wigderson_3844537">Avi Wigderson</a> as recipient of the 2023 ACM A.M. Turing Award for foundational contributions to the theory of computation, including reshaping our understanding of the role of randomness in computation, and for his decades of intellectual leadership in theoretical computer science.</p>
<p>Wigderson is the Herbert H. Maass Professor in the School of Mathematics at the Institute for Advanced Study in Princeton, New Jersey. He has been a leading figure in areas including computational complexity theory, algorithms and optimization, randomness and cryptography, parallel and distributed computation, combinatorics, and graph theory, as well as connections between theoretical computer science and mathematics and science.</p>
<p>The ACM A.M. Turing Award, often referred to as the “Nobel Prize of Computing,” carries a $1 million prize with financial support provided by Google, Inc. The award is named for Alan M. Turing, the British mathematician who articulated the mathematical foundations of computing.</p>
<p><u>What is Theoretical Computer Science?</u></p>
<p>Theoretical computer science is concerned with the mathematical underpinnings of the field. It poses questions such as “Is this problem solvable through computation?” or “If this problem is solvable through computation, how much time and other resources will be required?”</p>
<p>Theoretical computer science also explores the design of efficient algorithms. Every computing technology that touches our lives is made possible by algorithms. Understanding the principles that make for powerful and efficient algorithms deepens our understanding not only of computer science, but also the laws of nature. While theoretical computer science is known as a field that presents exciting intellectual challenges and is often not directly concerned with improving the practical applications of computing, research breakthroughs in this discipline have led to advances in almost every area of the field—from cryptography and computational biology to network design, machine learning, and quantum computing.</p>
<p><u>Why is Randomness Important?</u></p>
<p>Fundamentally, computers are <em>deterministic</em> systems; the set of instructions of an algorithm applied to any given input uniquely determines its computation and, in particular, its output. In other words, the deterministic algorithm is following a predictable pattern. <em> Randomness </em> , by contrast, lacks a well-defined pattern, or predictability in events or outcomes. Because the world we live in seems full of random events (weather systems, biological and quantum phenomena, etc.), computer scientists have enriched algorithms by allowing them to make random choices in the course of their computation, in the hope of improving their efficiency. And indeed, many problems for which no efficient deterministic algorithm was known have been solved efficiently by probabilistic algorithms, albeit with some small probability of error (that can be efficiently reduced). But is randomness essential, or can it be removed? And what is the quality of randomness needed for the success of probabilistic algorithms?</p>
<p>These, and many other fundamental questions lie at the heart of understanding randomness and pseudorandomness in computation. An improved understanding of the dynamics of randomness in computation can lead us to develop better algorithms as well as deepen our understanding of the nature of computation itself.</p>
<p><u>Wigderson’s Contributions</u></p>
<p>A leader in theoretical computer science research for four decades, Wigderson has made foundational contributions to the understanding of the role of randomness and pseudorandomness in computation.</p>
<p>Computer scientists have discovered a remarkable connection between randomness and computational difficulty (i.e., identifying natural problems that have no efficient algorithms). Working with colleagues, Wigderson authored a highly influential series of works on trading hardness for randomness. They proved that, under standard and widely believed computational assumptions, every probabilistic polynomial time algorithm can be efficiently derandomized (namely, made fully deterministic). In other words, randomness is not necessary for efficient computation. This sequence of works revolutionized our understanding of the role of randomness in computation, and the way we think about randomness. This series of influential papers include the following three:</p>
<ul>
<li>“<a href="https://www.math.ias.edu/~avi/PUBLICATIONS/MYPAPERS/NOAM/HARDNESS/final.pdf">Hardness vs. Randomness</a>” (co-authored with Noam Nisan)<br>
Among other findings, this paper introduced a new type of pseudorandom generator, and proved that efficient deterministic simulation of randomized algorithms is possible under much weaker assumptions than previously known.</li>
<li>“<a href="https://link.springer.com/article/10.1007/BF01275486">BPP Has Subexponential Time Simulations Unless EXPTIME has Publishable Proofs</a>” (co-authored with László Babai, Lance Fortnow, and Noam Nisan)<br>
This paper used `hardness amplification’ to demonstrate that bounded-error probabilistic polynomial time (BPP) can be simulated in subexponential time for infinitely many input lengths under weaker assumptions.</li>
<li>“<a href="https://dl.acm.org/doi/pdf/10.1145/258533.258590">P = BPP if E Requires Exponential Circuits: Derandomizing the XOR Lemma</a>” (co-authored with Russell Impagliazzo)<br>
This paper introduces a stronger pseudo-random generator with essentially optimal hardness vs randomness trade-offs.</li>
</ul>
<p>Importantly, the impact of these three papers by Wigderson goes far beyond the areas of randomness and derandomization. Ideas from these papers were subsequently used in many areas of theoretical computer science and led to impactful papers by several leading figures in the field.</p>
<p>Still working within the broad area of randomness in computation, in <a href="https://www.math.ias.edu/~avi/PUBLICATIONS/MYPAPERS/CRVW01/crvw01.pdf"> papers</a>&nbsp;with Omer Reingold, Salil Vadhan, and Michael Capalbo, Wigderson gave the first efficient combinatorial constructions of expander graphs, which are sparse graphs that have strong connectivity properties. They have many important applications in both mathematics and theoretical computer science.</p>
<p>Outside of his work in randomness, Wigderson has been an intellectual leader in several other areas of theoretical computer science, including multi-prover interactive proofs, cryptography, and circuit complexity.</p>
<p><u>Mentoring</u></p>
<p>In addition to his groundbreaking technical contributions, Wigderson is recognized as an esteemed mentor and colleague who has advised countless young researchers. His vast knowledge and unrivaled technical proficiency—coupled with his friendliness, enthusiasm, and generosity—have attracted many of the best young minds to pursue careers in theoretical computer science.</p>
<p>“It’s important to point out that Avi Wigderson also received the Abel Prize, which is considered the most important honor for lifetime achievements in the field of mathematics,” explained ACM President Yannis Ioannidis. “Being selected for the ACM A.M. Turing Award is a fitting follow-up—as mathematics is foundational to computer science and Wigderson’s work has connected a wide range of mathematical sub-areas to theoretical computer science. Wigderson is a towering intellectual force in theoretical computer science, an exciting discipline that attracts some of the most promising young researchers to work on the most difficult challenges. This year’s Turing Award recognizes Wigderson’s specific work on randomness, as well as the indirect but substantial impact he has had on the entire field of theoretical computer science.”</p>
<p>"Avi Wigderson’s work on randomness and other topics has set the agenda in theoretical computer science for the past three decades,” explained Jeff Dean, Senior Vice President, Google. “From the earliest days of computer science, researchers have recognized that incorporating randomness was a way to design faster algorithms for a wide range of applications. Efforts to better understand randomness continue to yield important benefits to our field, and Wigderson has opened new horizons in this area. Google also salutes Wigderson’s role as a mentor. His colleagues credit him with generating great ideas and research directions, and then motivating a new generation of smart young researchers to work on them. We congratulate Avi Wigderson on receiving the ACM A.M. Turing Award—computing’s highest honor.”</p>
<p><strong><a href="https://www.acm.org/media-center/2024/april/turing-award-2023">News Release</a> | <a href="https://awards.acm.org/binaries/content/assets/press-releases/2024/april/news-release_wigderson_turing-award.pdf">Printable PDF</a></strong></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Double-Entry Bookkeeping as a Directed Graph (295 pts)]]></title>
            <link>https://matheusportela.com/double-entry-bookkeeping-as-a-directed-graph</link>
            <guid>39988993</guid>
            <pubDate>Wed, 10 Apr 2024 10:13:23 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://matheusportela.com/double-entry-bookkeeping-as-a-directed-graph">https://matheusportela.com/double-entry-bookkeeping-as-a-directed-graph</a>, See on <a href="https://news.ycombinator.com/item?id=39988993">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
  
  <p><span>08 Apr 2024</span></p><h2 id="my-journey-into-accounting">My Journey into Accounting</h2>

<p>In the past couple of years, I’ve been working in billing and payments at <a href="https://www.justworks.com/">Justworks</a>. This experience introduced me to the world of bookkeeping and accounting in ways I didn’t expect: I took a <a href="https://www.udemy.com/course/accounting-fsa-a-solid-foundation-for-a-career-in-finance/">course</a> and <a href="https://link.springer.com/book/10.1007/978-1-349-20618-6">read a textbook</a> in accounting, adopted <a href="https://plaintextaccounting.org/">plain text accounting</a> for my personal finances, and worked in a double-entry ledger system.</p>

<p>Being such a fundamental part of the human experience, accounting has been around for literally millenia. It fostered mathematical and language development. In some cultures, it even predates <a href="https://en.wikipedia.org/wiki/Quipu">written language</a>. For this reason, it’s not surprising that accounting uses a very particular vocabulary and set of concepts that can be intimidating to a newcomer. Credits and debits. Assets and liabilities. Balance sheet. Ledgers and journals.</p>

<p>It took me a while to get used to these things. But once I did, I realized they aren’t <em>that</em> difficult. Maybe it is just a matter of finding the right way to explain them.</p>

<p>This series of articles is my attempt to capture some of my “a-ha” moments while learning accounting. Hopefully, it will help someone out there grasp these ideas in a more intuitive and modern way.</p>

<p>In this first article, we’ll start with the basics: bookkeeping.</p>

<p>Disclaimer: in this article, I’ll simplify some concepts and use slightly different terminology than traditional accounting for didactic purposes. If you’re an accountant, please bear with me.</p>

<h2 id="bookkeeping-without-ledgers">Bookkeeping Without Ledgers</h2>

<p>At its core, accounting is about keeping track of countable things over time. Some of the oldest documents archelogists have found register quantities in old societies: food, animals, people, money. Nowadays, accounting is usually interested in tracking money whereas other areas (such as inventory management or the census bureau) count the rest. For the rest of this article, we’ll focus on money.</p>

<p>Let’s start with a very simple example. Imagine you’re in a small town with two people: Alice and Bob. Alice has $100 in her pocket and Bob has $50 as of January 1st, 2024. We’ll record this data in a table as follows:</p>

<div><pre><code>| Person | Amount |
| ------ | ------ |
| Alice  | $100   |
| Bob    | $50    |
</code></pre></div>

<p>If nothing changes, our job is done. We just need to go around town and ask each person how much money they have, tabulate the data, and store it in a safe place. Badabing, badaboom!</p>

<p>But money is meant to be spent. Alice is studying for her finals and needs to buy a book. She notices Bob has one copy and proposes to buy it from him for $20. Bob is happy to sell her the book he hasn’t used in a while and cash in the extra $20. Great deal!</p>

<p>Now that money has changed hands, we need to update our records. Alice spent $20 and Bob received the same amount. Let’s update our table.</p>

<div><pre><code>| Person | Amount |
| ------ | ------ |
| Alice  | $80    |
| Bob    | $70    |
</code></pre></div>

<p>Before proceeding, let’s name a few things. In our records, Alice and Bob are <strong>accounts</strong>, i.e., places where money is stored. The amount of money in each account is called a <strong>balance</strong>. Saying that Alice has $80 is the same as saying that the Alice account’s balance is $80 as of February 1st, 2024.</p>

<blockquote>
  <p><strong>Definition 1: Account</strong></p>

  <p>A place where money is stored.</p>
</blockquote>

<blockquote>
  <p><strong>Definition 2: Balance</strong></p>

  <p>The amount of money in an account at a given point in time.</p>
</blockquote>

<p>Every month, we can go around town, ask people how much money they have and write it down. We’re basically creating a snapshot of the town’s financial situation monthly. (Surely, most people will be annoyed by this breach of privacy and I would probably be arrested for stalking but let’s ignore this for now.)</p>

<p>What kinds of questions can we answer with this data? Actually, many!</p>
<ul>
  <li>How much money does each person have?</li>
  <li>How much money has each person spent or gained over time?</li>
  <li>Who has the most money?</li>
  <li>Who has the least money?</li>
  <li>How much money is there in total in the town?</li>
</ul>

<p>Our records are simple but useful.</p>

<p>Now, consider Alice comes to us one day and asks “How come I have $80? I thought I had more!” Unfortunately, all we can answer is “That’s what I have written down” with our current data. We can’t tell, for instance, whether Alice initially had $0 and received $80 or if she had $10,000 and spent $9,920.</p>

<p>Why is this so?</p>

<p>Well, we’re only keeping track of the <em>current</em> balance of each account. Because we erase the old balance and replace it with a new one, we don’t know exactly what happened to that balance over time. We lose the changes that happened between snapshots are lost.</p>

<p>Could we do better?</p>

<p>Of course! Accountants have dealt with this problem for centuries and they have a solution: <strong>ledgers</strong>.</p>

<h2 id="bookkeeping-with-single-entry-ledgers">Bookkeeping with Single-Entry Ledgers</h2>

<p>Let’s now think how we could keep track of the historical changes in a systematic way. One way to do this is to write down each update as it happens, not only the balance in a certain date.</p>

<p>To do this, we’ll change the table a little bit. For example, we write down that on January 1st, 2024, Alice had $100.</p>

<div><pre><code>| Account | Description     | Date       | Amount | Balance |
| ------- | --------------- | ---------- | ------ | ------- |
| Alice   | Opening balance | 2024-01-01 | $100   | $100    |
</code></pre></div>

<p>We added some columns to the table:</p>
<ul>
  <li><strong>Description</strong>: A human-readable explanation of the transaction (e.g. what it is about, who got paid, a reference number, etc).</li>
  <li><strong>Date</strong>: When the transaction happened. Besides ordering transactions, this field can be used to group transactions by period (e.g. monthly reports). It can be enhanced with time information (e.g. hour, minute, second) if needed.</li>
  <li><strong>Balance</strong>: The balance of the account after the transaction. This field is redundant but it’s useful when inspecting the data.</li>
</ul>

<p>So far, so good.</p>

<p>Now, let’s take a look at how we can write down that Alice bought the book from Bob.</p>

<div><pre><code>| Account | Description     | Date       | Amount | Balance |
| ------- | --------------- | ---------- | ------ | ------- |
| Alice   | Opening balance | 2024-01-01 | $100   | $100    |
| Alice   | Bought book     | 2024-02-01 | -$20   | $80     |
</code></pre></div>

<p>This is different… Instead of just updating the existing balance, we’re <em>adding a new row</em> with the transaction details. The new columns we added earlier are helpful in understanding what happened to the account. We know that Alice had $100, then spent $20 when buying the book, and now has $80.</p>

<p>Time for more definitions: each row in this table is called an <strong>entry</strong> and the whole table is called a <strong>ledger</strong>.</p>

<blockquote>
  <p><strong>Definition 3: Entry</strong></p>

  <p>A record of a transaction that happened to an account.</p>
</blockquote>

<blockquote>
  <p><strong>Definition 4: Ledger</strong></p>

  <p>A collection of entries for an account.</p>
</blockquote>

<p>So far, we’ve updated only Alice’s ledger. Let’s take a look at Bob’s:</p>

<div><pre><code>| Account | Description     | Date       | Amount | Balance |
| ------- | --------------- | ---------- | ------ | ------- |
| Bob     | Opening balance | 2024-01-01 | $50    | $50     |
| Bob     | Sold book       | 2024-02-01 | $20    | $70     |
</code></pre></div>

<p>Now we have a ledger for each account. Great!</p>

<p>This system we implemented right now is called a <a href="https://en.wikipedia.org/wiki/Single-entry_bookkeeping"><strong>single-entry bookkeeping</strong></a> system. Each account has its own ledger and we write down entries that affect one account at a time. This is a simple system that works well for small businesses or personal finances.</p>

<p>Ledgers are sometimes called <strong>journal</strong> or <strong>book</strong> because, in the past, they were physical books where accountants would write down transactions. In the modern world, though, they’re usually stored in a database.</p>

<center><figure><img src="https://matheusportela.com/assets/images/double-entry-bookkeeping/handwritten-ledger.jpg" alt="Picture of a 1926 handwritten ledger"><figcaption>A 1926 handwritten ledger. Notice the accountant calculated the cash and bank balances daily. Source: <a href="https://www.business-case-analysis.com/ledger.html">Business Case Analysis</a>.</figcaption></figure></center>

<p>An important characteristic of a ledger is that the data is <em>immutable</em>. Once an entry is written, it cannot be changed at all because we want to preserve the ledger’s full history. No more erasing or scribbling over entries.</p>

<p>This raises the question: what happens if we make a mistake?</p>

<p>Here’s an example. Say the correct price for the book is $30 but we wrote down $20. If we were in a mutable system, we could just update the amount in the original entry as follows:</p>

<div><pre><code>| Account | Description     | Date       | Amount | Balance |
| ------- | --------------- | ---------- | ------ | ------- |
| Alice   | Opening balance | 2024-01-01 | $100   | $100    |
| Alice   | Bought book     | 2024-02-01 | -$30   | $70     |
</code></pre></div>

<p>There are many problems with this approach though. We lose the history of the original amount. We can’t tell that we made a mistake and corrected it. We also can’t tell if the original amount was correct and we made a mistake in the correction.</p>

<p>Could we do better?</p>

<p>Yes! Instead of updating the original entry, we can write a new entry to cancel the old one and write a new one with the correct amount. Let’s see how this looks:</p>

<div><pre><code>| Account | Description        | Date       | Amount | Balance |
| ------- | ---------------    | ---------- | ------ | ------- |
| Alice   | Opening balance    | 2024-01-01 | $100   | $100    |
| Alice   | Bought book        | 2024-02-01 | -$20   | $80     |
| Alice   | Correct book price | 2024-02-01 | $20    | $100    |
| Alice   | Bought book        | 2024-02-01 | -$30   | $70     |
</code></pre></div>

<p>The end result is the same as updating an entry in-place: the balance is $70. However, we can now see that we made a mistake and corrected it. We can also see the original amount and the reason for the correction. This gives us an <em>audit trail</em> of changes.</p>

<p>In a way, a ledger is similar to <a href="https://martinfowler.com/eaaDev/EventSourcing.html">event sourcing</a> in Computer Science. In event sourcing, we store events that happened in the system and use them to compute the current state of the system. This is in contrast to storing just the state of the system and updating it in-place. Event sourcing has many benefits, like being able to replay events or to rebuild the state of the system at any point in time.</p>

<p>If our system only cares about a single account at a time, a single-entry ledger system is enough. Think of a personal finance app that you use to keep track of your money or a gym that tracks how much their members paid for the service. However, financial systems are usually more complex than that and transactions typically involve multiple accounts at once.</p>

<p>For these complex scenarios, accountants developed a more robust system: <strong>double-entry bookkeeping</strong>.</p>

<h2 id="bookkeeping-with-double-entry-ledgers">Bookkeeping with Double-Entry Ledgers</h2>

<p>Let’s revisit the example of Alice buying the book from Bob and see the ledgers for both accounts:</p>

<div><pre><code>| Account | Description        | Date       | Amount | Balance |
| ------- | ------------------ | ---------- | ------ | ------- |
| Alice   | Opening balance    | 2024-01-01 | $100   | $100    |
| Alice   | Bought book        | 2024-02-01 | -$20   | $80     |

| Account | Description        | Date       | Amount | Balance |
| ------- | ------------------ | ---------- | ------ | ------- |
| Bob     | Opening balance    | 2024-01-01 | $50    | $50     |
| Bob     | Sold book          | 2024-02-01 | $20    | $70     |
</code></pre></div>

<p>Did you notice how the transactions are related to each other? The $20 Alice spent is the same $20 Bob received. We know that but the system doesn’t since we’re not explicitly stating this relationship in our ledgers. It could be the case the Alice bought the book from Bob and Bob received the money from Charlie. We can’t tell the difference when reading the ledgers.</p>

<p>A first step in making this relationship explicit is to group related entries into a <strong>transaction</strong>. Let’s add the <code>Transaction</code> column to our table:</p>

<div><pre><code>| Account | Transaction | Description        | Date       | Amount | Balance |
| ------- | ----------  | ------------------ | ---------- | ------ | ------- |
| Alice   | 1           | Opening balance    | 2024-01-01 | $100   | $100    |
| Alice   | 3           | Book sale          | 2024-02-01 | -$20   | $80     |

| Account | Transaction | Description        | Date       | Amount | Balance |
| ------- | ----------  | ------------------ | ---------- | ------ | ------- |
| Bob     | 2           | Opening balance    | 2024-01-01 | $50    | $50     |
| Bob     | 3           | Book sale          | 2024-02-01 | $20    | $70     |
</code></pre></div>

<p>In this example, we have the following transactions:</p>
<ul>
  <li>Transaction 1: Alice’s opening balance.</li>
  <li>Transaction 2: Bob’s opening balance.</li>
  <li>Transaction 3: Alice bought a book from Bob.</li>
</ul>

<p>Now, we explicitly state that the $20 Alice spent is the same $20 Bob received. No more ambiguity.</p>

<blockquote>
  <p><strong>Definition 5: Transaction</strong></p>

  <p>A group of related entries that affect different accounts.</p>
</blockquote>

<p>The difference between our current system and the previous one is that we’re now grouping related entries into transactions. Since each transaction affects multiple accounts, we can now see how money flows between accounts. By adding transactions to the tables, we are now working with a <a href="https://en.wikipedia.org/wiki/Double-entry_bookkeeping"><strong>double-entry bookkeeping</strong></a> system.</p>

<p>Traditionally, accountants would use two columns to represent the flow of money between accounts: <strong>credits</strong> and <strong>debits</strong>. When money leaves an account, the amounts goes in the credit column. Incoming money appears in the debit column.</p>

<blockquote>
  <p><strong>Definition 6: Credit</strong></p>

  <p>An entry that represents money leaving an account.</p>
</blockquote>

<blockquote>
  <p><strong>Definition 7: Debit</strong></p>

  <p>An entry that represents money entering an account.</p>
</blockquote>

<p>(Pro-tip: Ignore what you know about credit and debit cards for now.)</p>

<p>When Alice pays Bob $20, we say Alice’s account is credited $20 and Bob’s account is debited $20. Let’s represent this in our table:</p>

<div><pre><code>| Account | Transaction | Description        | Date       | Debit | Credit |
| ------- | ----------  | ------------------ | ---------- | ----- | ------ |
| Alice   | 1           | Opening balance    | 2024-01-01 | $100  |        |
| Alice   | 3           | Bought book        | 2024-02-01 |       | $20    |

| Account | Transaction | Description        | Date       | Debit | Credit |
| ------- | ----------  | ------------------ | ---------- | ----- | ------ |
| Bob     | 2           | Opening balance    | 2024-01-01 | $50   |        |
| Bob     | 3           | Sold book          | 2024-02-01 | $20   |        |
</code></pre></div>

<p>I wanted to make a few of points before continuing our journey.</p>

<p>First, the goal of double-entry bookkeeping is to reduce mistakes, especially the ones that are hard to notice. Remember that, for centuries, accountants were using pen and paper to keep track of insane amounts of money. Small mistakes could lead to big problems. Writing debits and credits in different columns, as we did above, reduces the chance of making mistakes. Your hand is literally moved to different places on the paper when writing debits and credits.</p>

<p>Real world accounting journals wouldn’t even put these columns side-by-side. Instead, they would be in different parts of the page. In fact, accounting journals were symmetrical: the left side was for debits and the right side, for credits. Something like this:</p>

<div><pre><code>Debit                          Alice's account                           Credit
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------
| Date       | Description     | $    | | Date       | Description     | $    |
| ---------- | --------------- | ---- | | ---------- | --------------- | ---- |
| 2024-01-01 | Opening balance | $100 | |            |                 |      |
|            |                 |      | | 2024-02-01 | Bought book     | $20  |
</code></pre></div>

<p>This format is commonly referred to as a <a href="https://en.wikipedia.org/wiki/Debits_and_credits#T-accounts">T-account</a> (an analogy to the same: the top with the account name, the left side with debits, and the right side with credits). For this reason, many accountants will refer to debits as entries that go on the left side and credits as the ones that go on the right side.</p>

<center><figure><img src="https://matheusportela.com/assets/images/double-entry-bookkeeping/general-post-office-accounting-book.jpg" alt="Picture of the General Post Office T-account as instituted by Benjamin Franklin"><figcaption>General Post Office T-account as instituted by Benjamin Franklin. Source: <a href="https://postalmuseum.si.edu/object/npm_1982.0786.1">Smithsonian National Post Museum</a>.</figcaption></figure></center>

<p>Computer systems don’t need to use this format, though, as it doesn’t necessary prevent software bugs. Instead, it is common to have a single amount column and another column to indicate whether the amount is a debit or a credit. For example:</p>

<div><pre><code>| Account | Transaction | Description        | Date       | Type   | Amount |
| ------- | ----------  | ------------------ | ---------- | ------ | ------ |
| Alice   | 1           | Opening balance    | 2024-01-01 | Debit  | $100   |
| Alice   | 3           | Bought book        | 2024-02-01 | Credit | $20    |
</code></pre></div>

<p>Second, notice how we’re using a positive number even when money is leaving Alice’s account. Historically, accountants don’t like negative numbers in the books as they only became popular much later in Europe. Computer systems are very good with negative numbers, though. Instead of having two columns, we could just use a single column and adopt a convention in which credits are negative and debits are positive, or vice-versa. For example:</p>

<div><pre><code>| Account | Transaction | Description        | Date       | Amount |
| ------- | ----------  | ------------------ | ---------- | ------ |
| Alice   | 1           | Opening balance    | 2024-01-01 | $100   |
| Alice   | 3           | Bought book        | 2024-02-01 | -$20   |
</code></pre></div>

<p>If you pay close attention to this last example, this is exactly what we were doing before. The difference is that now we understand that the amount is negative because it’s a credit. (Technically, using negative numbers for credits might be a limitation if we’re trying to undo a credit entry without creating a debit entry but we don’t need to be that picky for now.)</p>

<p>Finally, I’m not a big fan of old nomenclature for tradition’s sake. We could rename credits as <em>outgoing</em> money and debits as <em>incoming</em> money without losing precision. In my opinion, this is a bit less confusing.</p>

<div><pre><code>| Account | Transaction | Description        | Date       | Incoming | Outgoing |
| ------- | ----------  | ------------------ | ---------- | -------- | -------- |
| Alice   | 1           | Opening balance    | 2024-01-01 | $100     |          |
| Alice   | 3           | Bought book        | 2024-02-01 |          | $20      |

| Account | Transaction | Description        | Date       | Incoming | Outgoing |
| ------- | ----------  | ------------------ | ---------- | -------- | -------- |
| Bob     | 2           | Opening balance    | 2024-01-01 | $50      |          |
| Bob     | 3           | Sold book          | 2024-02-01 | $20      |          |
</code></pre></div>

<p>Sweet!</p>

<p>A fundamental principle of double-entry bookkeeping is that the total amount of money in the system remains the same after each transaction. A particular account can increase or decrease its balance over time but the sum of <em>all</em> balances must remain constant. Nothing is lost, nothing is created, everything is <em>transacted</em>. It is a closed system.</p>

<blockquote>
  <p><strong>Definition 6: Double-Entry Ledger</strong></p>

  <p>A system of accounting where each transaction is recorded one or more entries. The amount of money leaving accounts is equal to the amount of money entering other accounts in every transaction.</p>
</blockquote>

<p>Ok, you might be thinking: “Wait a minute, these opening balances go against what you just said!” and you’re right. Transactions 1 and 2 change the total amount of money in the system from $0 to $150. We should do better than stating a rule only to break it in the very next sentence.</p>

<p>Let’s assume all of the money that Alice and Bob have comes from a bank. Then, let’s create an account for this bank and use this account as the other side of the opening balance transactions.</p>

<div><pre><code>| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Bank    | 1           | Alice's opening balance    | 2024-01-01 |          | $100     |
| Bank    | 2           | Bob's opening balance      | 2024-01-01 |          | $50      |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Alice   | 1           | Opening balance            | 2024-01-01 | $100     |          |
| Alice   | 3           | Bought book                | 2024-02-01 |          | $20      |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Bob     | 2           | Opening balance            | 2024-01-01 | $50      |          |
| Bob     | 3           | Sold book                  | 2024-02-01 | $20      |          |
</code></pre></div>

<p>In this example, we don’t care where the opening balances come from exactly. We just need to make sure money is coming from somewhere. The bank account is a kind of phony account that is there just to help us follow the rules. In accounting terms, it is called a <a href="https://en.wikipedia.org/wiki/Debits_and_credits#Contra_account">contra account</a> to the other accounts. The important thing is that all transactions are <strong>balanced</strong>, i.e., “credits equal debits”.</p>

<blockquote>
  <p><strong>Definition 7: Contra Account</strong></p>

  <p>An account that is used to offset another account. It is used to keep the accounting equation in balance.</p>
</blockquote>

<p>Our system is now complete. We have a double-entry ledger system that keeps track of money flowing between accounts. We can answer many questions about the financial situation of Alice and Bob and we have a clear audit trail of all transactions that happened.</p>

<p>Let’s consider a more complex example. When Alice buys the book, she accidentally uses the wrong credit card and needs to pay $2 in foreign exchange fees. Bob, on the other hand, pays $2 in sales taxes to the government, $1 in credit card fees. How do we keep track of this?</p>

<p>The secret in double-entry bookkeeping is to use accounts for everything. As we did before, we model this flow by creating new accounts: one for the credit card company and another for the tax authority. Then, when creating the transaction, we add new entries as necessary.</p>

<div><pre><code>| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Bank    | 1           | Alice's opening balance    | 2024-01-01 |          | $100     |
| Bank    | 2           | Bob's opening balance      | 2024-01-01 |          | $50      |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Alice   | 1           | Opening balance            | 2024-01-01 | $100     |          |
| Alice   | 3           | Bought book                | 2024-02-01 |          | $20      |
| Alice   | 3           | Foreign exchange fee       | 2024-02-01 |          | $2       |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Bob     | 2           | Opening balance            | 2024-01-01 | $50      |          |
| Bob     | 3           | Sold book                  | 2024-02-01 | $20      |          |
| Bob     | 3           | Sales tax                  | 2024-02-01 |          | $2       |
| Bob     | 3           | Credit card fee            | 2024-02-01 |          | $1       |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| CC      | 3           | Alice's credit card fee    | 2024-02-01 | $2       |          |
| CC      | 3           | Bob's credit card fee      | 2024-02-01 | $1       |          |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Tax     | 3           | Bob's sales tax            | 2024-02-01 | $2       |          |
</code></pre></div>

<p>We modified transaction 3 as follows:</p>
<ul>
  <li>Alice pays $20 to Bob and $2 to the credit card company.</li>
  <li>Bob receives $20 from Alice, pays $2 to the tax authority, and $1 to the credit card company.</li>
  <li>The credit card company receives $2 from Alice and $1 from Bob.</li>
  <li>The tax authority receives $2 from Bob.</li>
</ul>

<p>Notice that transaction 3 has <em>more than two entries</em>. It has eight entries, to be precise. This is perfectly fine! We can have as many entries as we need to represent the flow of money between accounts as long as the transaction is balanced, i.e., credits = debits.</p>

<p>It is a common mistake to think that <em>double</em>-entry bookkeeping limits transactions to two entries at a time. The technique is called “double-entry” not because there are only two entries but because each transaction has <em>two sides</em>: one side where money leaves an account and another side where money enters another account. I guess “many-entry bookkeeping” doesn’t sound as good.</p>

<h2 id="double-entry-bookkeeping-is-a-directed-graph">Double-Entry Bookkeeping is a Directed Graph</h2>

<p>I hope these concepts are clear so far. We have accounts, entries, transactions, incoming money, and outgoing money. With practice, you’ll be able to read and write these tables with ease.</p>

<p>But I have a confession to make: I’m a visual person. I like to draw and see things when I’m learning. So I started to think: how can we visualize this data in a way that makes sense to me? After using double-entry bookkeeping for a while in my personal finances and trying to come with a visualization for my ledgers, it finally clicked: we’re modeling money flow as a <a href="https://en.wikipedia.org/wiki/Directed_graph"><em>directed graph</em></a>.</p>

<p>Think about this: An account is a <em>node</em> in the graph, a credit entry is an <em>outgoing edge</em> with an amount of money leaving this node whereas a debit is an <em>incoming edge</em> with money flowing to another node. A transaction, then, groups and enforces a condition on a set of edges: the outgoing edges must have the same sum of money as the incoming edges.</p>

<p>Let’s take a look at the example we’ve been using so far. First, we start with Alice’s and Bob’s accounts and the money they stored in the bank:</p>

<p><img src="https://matheusportela.com/assets/images/double-entry-bookkeeping/Picture%201.drawio.svg" alt="Graph for the first example: Alice's and Bob's initial balances with the Bank as a source"></p>

<p>A few comments on this graph:</p>
<ul>
  <li>An account is a round node with the account name.</li>
  <li>A transaction is a square node with the transaction number.</li>
  <li>A credit entry goes from an account to a transaction.</li>
  <li>A debit entry goes from a transaction to an account.</li>
  <li>The entry’s amount of money is written on the edge.</li>
  <li>An account’s balance is the sum of the amounts of the incoming edges minus the sum of the amounts of the outgoing edges.</li>
</ul>

<p>We can see that transaction 1 moves $100 from the bank to Alice. Transaction 2 moves $50 from the bank to Bob. The total amount of money in the system is $150.</p>

<p>Then, Alice buys a book from Bob:</p>

<p><img src="https://matheusportela.com/assets/images/double-entry-bookkeeping/Picture%202.drawio.svg" alt="Graph for the second example: Alice buys a book from Bob"></p>

<p>We can see that transaction 3 moves $20 from Alice to Bob. Hence, Alice has $80 and Bob, $70.</p>

<p>We haven’t added fees and taxes yet. Let’s do this:</p>

<p><img src="https://matheusportela.com/assets/images/double-entry-bookkeeping/Picture%203.drawio.svg" alt="Graph for the third example: fees and taxes"></p>

<p>Oof, that’s a lot of edges! Transaction 3 is very complex as it conflates what Alice is paying Bob with the fees and taxes they pay to other parties. We could make this easier by splitting this transaction into two smaller ones:</p>

<div><pre><code>| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Bank    | 1           | Alice's opening balance    | 2024-01-01 |          | $100     |
| Bank    | 2           | Bob's opening balance      | 2024-01-01 |          | $50      |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Alice   | 1           | Opening balance            | 2024-01-01 | $100     |          |
| Alice   | 3           | Bought book                | 2024-02-01 |          | $22      |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Bob     | 2           | Opening balance            | 2024-01-01 | $50      |          |
| Bob     | 3           | Sold book                  | 2024-02-01 | $19      |          |
| Bob     | 4           | Sales tax                  | 2024-02-01 |          | $2       |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| CC      | 3           | Transaction fee            | 2024-02-01 | $3       |          |

| Account | Transaction | Description                | Date       | Incoming | Outgoing |
| ------- | ----------  | -------------------------- | ---------- | -------- | -------- |
| Tax     | 4           | Bob's sales tax            | 2024-02-01 | $2       |          |
</code></pre></div>

<p>And as a graph:</p>

<p><img src="https://matheusportela.com/assets/images/double-entry-bookkeeping/Picture%204.drawio.svg" alt="Graph for the fourth example: simplified transactions"></p>

<p>We simplified the transactions a little bit:</p>
<ul>
  <li>Alice sees $22 leaving her account but Bob only receives $19. The remaining $3 goes to the credit card company.</li>
  <li>Bob pays sales taxes in a different transaction.</li>
</ul>

<p>Regardless of how we model the transactions, the account balances are the same. Alice has $78, Bob has $69, the tax authority has $2, and the credit card company has $3. It is the accountant’s job to decide how to group transactions and entries in a way that makes sense for the business as the bookkeeping system is flexible enough to accommodate different needs.</p>

<p>These simple examples show how we can visualize money flow in a double-entry bookkeeping system as a directed graph. The graph grows over time as new transactions are added but it’s properties remain the same. In my opinion, understanding bookkeeping as a graph is a powerful way to reason about many accounting concepts. Suddenly, things as <em>balance sheets</em>, <em>income statements</em>, and <em>cash flow statements</em> are just visualizations of this graph. Categories such as <em>assets</em>, <em>liabilities</em>, <em>equity</em>, <em>income</em>, and <em>expenses</em> are just groups of nodes in the graph and it is quite easy to understand whether credits or debits increase their balances. It’s a way to make accounting more intuitive and less intimidating to me!</p>

<p>We could go on and on with this example, adding more complexity to the transactions, creating new accounts, and visualizing the graph as it grows. But I think we did a great job today and should take a well-deserved break.</p>

<h2 id="takeaways">Takeaways</h2>

<p>In this article, we’ve covered the basics of bookkeeping. We started with a simple system that only kept track of balances, evolved it into a single-entry and, later, into a double-entry ledger system that models money flow between accounts. We’ve seen how to represent transactions as entries in a ledger and how to group related entries into transactions. Finally, we’ve seen how to visualize a double-entry ledger as a directed graph.</p>

<p>In the next article, we’ll dive deeper into basic accounting concepts and see how they relate to the graph representation we’ve seen here.</p>

<h2 id="resources">Resources</h2>

<p>When studying these concepts, I found the following resources particularly helpful:</p>
<ul>
  <li><a href="https://www.udemy.com/course/accounting-fsa-a-solid-foundation-for-a-career-in-finance/">Accounting &amp; Financial Statement Analysis: Complete Training</a>: A crash course in accounting in Udemy. It was my introduction to the topic and I highly recommend it.</li>
  <li><a href="https://link.springer.com/book/10.1007/978-1-349-20618-6">Mastering Accounting by George Bright and Michael Herbert</a>: A textbook that covers accounting from the basics to more advanced topics. Another great resource to deepen my understanding of accounting.</li>
  <li><a href="https://beancount.github.io/docs/the_double_entry_counting_method.html">Beancount’s documentation</a> has a great explanation of accounting as a graph over time. It was a big inspiration for this article.</li>
  <li><a href="https://www.moderntreasury.com/journal/accounting-for-developers-part-i">Modern Treasury</a> has a great series of articles that explain accounting concepts for developers. It is another big inspiration.</li>
  <li><a href="https://news.ycombinator.com/item?id=32495724">This particular thread on Hacker News</a>. Some comments are gold!</li>
  <li><a href="https://plaintextaccounting.org/">Plain text accounting</a> is a small but engaged community that uses plain text files and command-line tools to keep track of their finances. I use <a href="https://hledger.org/">hledger</a> for my personal finances.</li>
</ul>

</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[U.S. imposes first-ever national drinking water limits on PFAS (112 pts)]]></title>
            <link>https://apnews.com/article/forever-chemicals-pfas-pollution-epa-drinking-water-1c8804288413a73bb7b99fc866c8fa51</link>
            <guid>39988718</guid>
            <pubDate>Wed, 10 Apr 2024 09:31:10 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://apnews.com/article/forever-chemicals-pfas-pollution-epa-drinking-water-1c8804288413a73bb7b99fc866c8fa51">https://apnews.com/article/forever-chemicals-pfas-pollution-epa-drinking-water-1c8804288413a73bb7b99fc866c8fa51</a>, See on <a href="https://news.ycombinator.com/item?id=39988718">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                                        <p>The Biden administration on Wednesday finalized strict limits on certain so-called “forever chemicals” in drinking water that will require utilities to reduce them to the lowest level they can be reliably measured. Officials say this will reduce exposure for 100 million people and help prevent thousands of illnesses, including cancers.</p><p>The rule is the first national drinking water limit on toxic PFAS, or perfluoroalkyl and polyfluoroalkyl substances, which are widespread and long lasting in the environment. </p><p>Health advocates praised the Environmental Protection Agency for not backing away from <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/epa-pfas-forever-chemicals-water-contamination-regulations-560d0ce3321e7fa8ed052f792c24f16f">tough limits the agency proposed last year</a></span>. But water utilities took issue with the rule, saying treatment systems are expensive to install and that customers will end up paying more for water.</p><p>Water providers are entering a new era with significant additional health standards that the EPA says will make tap water safer for millions of consumers — a Biden administration priority. The agency has also proposed <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/lead-epa-flint-discrimination-biden-white-house-ca10a72d628491fe03ec687432bf0b45">forcing utilities to remove dangerous lead pipes</a></span>. </p>




    

<p>Utility groups warn the rules will cost tens of billions of dollars each and <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/health-business-west-virginia-dementia-6770a6191b89b064bd77227e1b18639d">fall hardest on small communities with fewer resources</a></span>. Legal challenges are sure to follow. </p><p>EPA Administrator Michael Regan says the rule is the most important action the EPA has ever taken on PFAS.</p><p>“The result is a comprehensive and life-changing rule, one that will improve the health and vitality of so many communities across our country,” said Regan.</p>
    
<p>PFAS chemicals are hazardous because they don’t degrade in the environment and are linked to health issues such as low birth weight and liver disease, along with certain cancers. The EPA estimates the rule will cost about $1.5 billion to implement each year, but doing so will prevent nearly 10,000 deaths over decades and significantly reduce serious illnesses.</p>
    

<p>They’ve been used in everyday products including nonstick pans, firefighting foam and waterproof clothing. Although some of the most common types are phased out in the U.S., others remain. Water providers will now be forced to remove contamination put in the environment by other industries.</p><p>“It’s that accumulation that’s the problem,” said Scott Belcher, a North Carolina State University professor who researches PFAS toxicity. “Even tiny, tiny, tiny amounts each time you take a drink of water over your lifetime is going to keep adding up, leading to the health effects.”</p><p>PFAS is a broad family of chemical substances, and the new rule sets strict limits on two common types — called PFOA and PFOS — at 4 parts per trillion. Three other types that include GenEx Chemicals that are a major problem in North Carolina are limited to 10 parts per trillion. Water providers will have to test for these PFAS chemicals and tell the public when levels are too high. Combinations of some PFAS types will be limited, too. </p><p>Regan will announce the rule in Fayetteville, North Carolina, on Wednesday.</p><p>Environmental and health advocates praised the rule, but said PFAS manufacturers knew decades ago the substances were dangerous yet hid or downplayed the evidence. Limits should have come sooner, they argue. </p>
    

<p>“Reducing PFAS in our drinking water is the most cost effective way to reduce our exposure,” said Scott Faber, a food and water expert at Environmental Working Group. “It’s much more challenging to reduce other exposures such as PFAS in food or clothing or carpets.”</p><p>Over the last year, EPA has periodically released batches of utility test results for PFAS in drinking water. Roughly 16% of utilities found at least one of the two strictly limited PFAS chemicals at or above the new limits. These utilities serve tens of millions of people. The Biden administration, however, expects about 6-10% of water systems to exceed the new limits.</p><p>Water providers will generally have three years to do testing. If those test exceed the limits, they’ll have two more years to install treatment systems, according to EPA officials.</p><p>Some funds are available to help utilities. Manufacturer 3M recently agreed to <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/pfas-drinking-water-settlement-3m-fa41cadfe0d65b9723377a681df43af1">pay more than $10 billion to drinking water providers</a></span> to settle PFAS litigation. And the Bipartisan Infrastructure Law includes billions to combat the substance. But utilities say more will be needed.</p>
    

<p>For some communities, tests results were a surprise. Last June, a utility outside Philadelphia that serves nearly 9,000 people learned that one of its wells had a PFOA level of 235 parts per trillion, among the highest results in the country at the time.</p><p>“I mean, obviously, it was a shock,” said Joseph Hastings, director of the joint public works department for the Collegeville and Trappe boroughs, whose job includes solving problems presented by new regulations.</p><p>The well was quickly yanked offline, but Hastings still doesn’t know the contamination source. Several other wells were above the EPA’s new limits, but lower than those the state of Pennsylvania set earlier. Now, Hastings says installing treatment systems could be a multi-million dollar endeavor, a major expense for a small customer base.</p>
    

<p>The new regulation is “going to throw public confidence in drinking water into chaos,” said Mike McGill, president of WaterPIO, a water industry communications firm.</p><p>The American Water Works Association, an industry group, says it supports the development of PFAS limits in drinking water, but argues the EPA’s rule has big problems. </p><p>The agency underestimated its high cost, which can’t be justified for communities with low levels of PFAS, and it’ll raise customer water bills, the association said. Plus, there aren’t enough experts and workers — and supplies of filtration material are limited.</p><p>Work in some places has started. The company Veolia operates utilities serving about 2.3 million people across six eastern states and manages water systems for millions more. Veolia built PFAS treatment for small water systems that serve about 150,000 people. The company expects, however, that roughly 50 more sites will need treatment — and it’s working to scale up efforts to reduce PFAS in larger communities it serves.</p><p>Such efforts followed <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/pfas-epa-water-regulations-d2d5052c36a5a95f4e56866f028c9c4f">dramatic shifts in EPA’s health guidance</a></span> for PFAS in recent years as more research into its health harms emerged. Less than a decade ago, EPA issued a health advisory that PFOA and PFOS levels combined shouldn’t exceed 70 parts per trillion. Now, the agency says no amount is safe.</p><p>Public alarm has increased, too. In Minnesota, for example, Amara’s Law aims to stop avoidable PFAS use. It’s been nearly a year since the law’s namesake, Amara Strande, died from a rare cancer her family blames on PFAS contamination by 3M near her high school in Oakdale, although a connection between PFAS and her cancer can’t be proven. Biden administration officials say communities shouldn’t suffer like Oakdale. 3M says it extends its deepest condolences to Amara’s friends and family.</p><p>Losing Amara pushed the family towards activism. They’ve testified multiple times in favor of PFAS restrictions. </p><p>“Four parts per trillion, we couldn’t ask for a better standard,” Amara’s sister Nora said. “It’s a very ambitious goal, but anything higher than that is endangering lives.”</p><h2>___</h2><p>Associated Press data journalist Camille Fassett in San Francisco and reporter Matthew Daly in Washington D.C. contributed to this story.</p><h2>___</h2><p>The Associated Press receives support from the Walton Family Foundation for coverage of water and environmental policy. The AP is solely responsible for all content. For all of AP’s environmental coverage, visit <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/hub/environment">https://apnews.com/hub/climate-and-environment</a></span></p>
                                    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Deep Bug (167 pts)]]></title>
            <link>https://www.marginalia.nu/log/a_104_dep_bug/</link>
            <guid>39988716</guid>
            <pubDate>Wed, 10 Apr 2024 09:30:59 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.marginalia.nu/log/a_104_dep_bug/">https://www.marginalia.nu/log/a_104_dep_bug/</a>, See on <a href="https://news.ycombinator.com/item?id=39988716">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content"><p>The project has been haunted by a mysterious bug since sometime February. It relates to the code that constructs the index, particularly the code that merges partial indices.</p><p>In short the search engine constucts the reverse index through successive merging of smaller indices, which reduces the overall memory requirement.</p><p>You can conceptualize the revese index itself as two files, one with offset pointers into another file, which has sorted numbers. This code runs after each partition finishes crawling and processing its data, and has a run time of about 4 hours.</p><p>Suddenly the code that merges the indexes started to randomly fail.</p><p>What failed was the code that copies sorted numbers from one of the older indices to one of the newer, in the case when a keyword is present in only one of the indexes and no actual merging of sorted lists is needed.</p><p>If code suddenly starts acting up when the amount of data increases, all my intuition screams that this must be a 32 bit integer overflow. The index construction does all of its work in the bermuda triangle of 32 bit errors that is 1-32 GB file size range, so it really does seem like a very probable suspect.</p><p>I went over the code looking for such a thing, and found nothing. I added a bunch of guard clauses and assertions to get some hint about what was going on, but these didn’t turn up much other than the copy operation attempting to copy outside the file.</p><p>To my surprise, while doing this the construction process suddenly went through! The index it constructed was sane. Had I fixed it by perturbing the code somehow? I ran it again and it failed.</p><p>Some non-determinism is expected since the indexes are merged in parallel, so the order they’re merged in is a bit random even if the merging itself is completely deterministic. I felt this explained the random success: I got lucky with the ordering.</p><p>Since I had a work-around I left this be for a while. I had other work that was more pressing. The seven remaining partitions were coaxed through by just hitting the restart button until it worked, taking one or more days of hammering restarts. Annoying and time consuming, but it worked.</p><p>This week the final partition came through, and I had a moment to look deeper into this enigma.</p><p>Maybe it wasn’t an integer overflow? I checked the git log for any suspect changes between December when it worked and February when it didn’t work, and I found nothing. Again I combed over the code looking for integer overflows, and still found nothing.</p><p>I did find a function that shrinks the merged index, which is initially allocated to be the total size of the inputs. Since the merge function removes duplicates, the merged index is often smaller than the sum of its parts, but it’s impossible to know how small before actually merging.</p><p>This seemed like a plausible explanation, since if the files were truncated too hard, it would explain the files seemingly being “too small”. I disabled the truncation, and still got errors.</p><p>In investigating this, I stumbled on a very curious aberration. I’ll sketch out the gist of it:</p><div><pre tabindex="0"><code data-lang="java"><span><span>
</span></span><span><span>val <span>=</span> read<span>-</span>only mmapped file 
</span></span><span><span>      not subject to change
</span></span><span><span>counts <span>=</span> zeroed mmap<span>:</span>ed file 
</span></span><span><span>
</span></span><span><span><span>long</span> offset <span>=</span> 0<span>;</span>
</span></span><span><span><span>for</span> <span>(</span><span>int</span> i <span>=</span> 0<span>;</span> i <span>&lt;</span> length<span>;</span> i<span>++)</span> <span>{</span>
</span></span><span><span>  counts<span>[</span>i<span>]</span> <span>=</span> val<span>[</span>i<span>];</span>
</span></span><span><span>  offset <span>+=</span> val<span>[</span>i<span>];</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>long</span> size <span>=</span> 0<span>;</span>
</span></span><span><span><span>for</span> <span>(</span><span>int</span> i <span>=</span> 0<span>;</span> i <span>&lt;</span> length<span>;</span> i<span>++)</span> <span>{</span>
</span></span><span><span>   size <span>+=</span> counts<span>[</span>i<span>];</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>// ...
</span></span></span><span><span><span></span>
</span></span><span><span><span>assert</span> <span>(</span>size <span>==</span> offset<span>);</span>
</span></span><span><span>
</span></span><span><span><span>// ...
</span></span></span><span><span><span></span>
</span></span><span><span>truncate<span>(</span>size<span>);</span>
</span></span></code></pre></div><p>All this runs in sequence on the same thread, and nothing writes to <code>counts</code> other than this code.</p><p>The assertion would fail.</p><p>Alright, so it is an integer overflow! … you might think. Nope. These are all 64 bit longs, and the values being added are small and few enough not to overflow a 32 bit integer. At this point I could reliably isolate the particular inputs that triggered the behavior with the assert, so I did just that.</p><p>There are four lights, damnit!</p><p>At this point I patched production so that if this assertion were to fail, the input files were copied over to a separate directory. This gave me a 2 GB set of test-data that had been known to trigger the error that I could exfiltrate and examine locally.</p><p>The bug of course did not re-appear when I ran this code in isolation, but that actually says something important. I’d reduced the problem down to deterministic code being non-deterministic and outputting logical contradictions. This feels like a good reason to question other things than the program logic.</p><p>It’s probably safe to assume the problem is either the JVM, the linux kernel, or the hardware, in decreasing order of likelihood.</p><p>The JVM is at the top of the suspect list since one of the things that <em>had</em> in fact changed since the bug appeared was that the project migrated over to graalvm from openjdk.</p><p>Hardware errors typically don’t target only a specific function over and over, except I guess if you have some Homer-style divine grudge going on. Having not skipped over any libations, enraged gods could probably be ruled out, and to further sow doubts about this I was able to reproduce the error on another machine, not with the exfiltrated data but through reindexing Wikipedia’s data repeatedly. This also probably rules out some sort of linux kernel bug, since the kernels were a few versions apart; one machine was SMP and the other was not, one with ECC one not, etc.</p><p>So at this point the only remaining suspect on my list was the graalvm JDK. I migrated the project to the latest graalvm version, from jdk-21 to jdk-22 through oracle’s official docker images. This did absolutely nothing to address the problem. I switched the docker build process to use a temurin (openjdk) image instead of graalvm, and… the problem went away! Since then, it’s worked over and over.</p><p>At this point I’d love to file a bug report, although I’m having trouble isolating the problem enough to do so. “Doesn’t work” is famously not an error description. The relevant process is something like 5 KLOC, and the smallest dataset that triggers the bug somewhat reliably is about 54 GB.</p><p>I’ve isolated the code that manifests the bug and run it 50,000 times on the data exfiltrated from production on a machine that’s previously been able to trigger the problem, and it’s run without a hitch, so there appears to be some sort of spooky action at a distance going on. I’ve tried perturbing it in various ways, introducing page faults and so on, since that’s happening a lot in production, again to no avail.</p><p>In general I’d argue you haven’t fixed a bug unless you understand why it happened and why your fix worked, which makes this frustrating, since every indication is that the bug exists within proprietary code that is out of my reach. This feels like an impasse, not a solution, even though the error has nominally been corrected.</p><p>I can at least say make statements about what hasn’t caused the error.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Client libraries are better when they have no API (125 pts)]]></title>
            <link>https://csvbase.com/blog/7</link>
            <guid>39988580</guid>
            <pubDate>Wed, 10 Apr 2024 09:10:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://csvbase.com/blog/7">https://csvbase.com/blog/7</a>, See on <a href="https://news.ycombinator.com/item?id=39988580">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        <p>When I met a friend in a pub recently and I told him I was writing a client
library for csvbase, he did laugh a bit.  "Can't people just use curl?"</p>
<p>It's true.  On csvbase, you can just curl any table url and get a csv file.
Through the magic of HTTP, this web-page:</p>
<p><img src="https://csvbase.com/blog-static/stock-exchanges.png" alt="screenshot of csvbase table web
page"></p>
<p>becomes this csv file inside curl:</p>
<p><img src="https://csvbase.com/blog-static/curl.png" alt="screenshot of csvbase table in
curl"></p>
<p>[For details of how that trick works, see <a href="https://csvbase.com/blog/2">an older
blog post</a>]</p>
<p>That barely qualifies as an API, it's just HTTP.  So what possible use could a
client library be?</p>
<p>And of course client libraries add mental overhead of their own.  You have to
read some docs, learn some methods and then and the end you still have to add
some code to use whatever library it is.</p>
<p>Wouldn't you rather just not?</p>
<p>I would certainly rather not.  With that in mind, I've written a client library
that has no API.</p>
<h2>No API</h2>
<p>Wait, no API?:</p>
<div><pre><span></span><span>&gt;&gt;&gt;</span> <span>import</span> <span>pandas</span> <span>as</span> <span>pd</span>
<span>&gt;&gt;&gt;</span> <span>df</span> <span>=</span> <span>pd</span><span>.</span><span>read_csv</span><span>(</span><span>"csvbase://calpaterson/onion-vox-pops"</span><span>)</span>
<span>&gt;&gt;&gt;</span> <span>df</span><span>.</span><span>quote</span><span>[</span><span>0</span><span>]</span>
<span>"""I realize passengers are concerned, but speaking as a pilot,</span>
<span>there's no better place to drop acid than 40,000 feet in the air."""</span>
</pre></div>
<p>(A man after my own heart.)</p>
<p>But yes, no API.  I resent writing data APIs anyway (that's why I wrote
csvbase - to do it once, generically).  So if you want, just pull dataframes
down from csvbase with Pandas itself.  pip install
<a href="https://pypi.org/project/csvbase-client/"><code>csvbase-client</code></a> and Pandas will
suddenly learn the <code>csvbase://</code> url scheme.</p>
<p>And what if you want to write a dataframe to csvbase?  Is there an API for
that?  Again: no.  You call the usual method: <code>DataFrame.to_csv</code>:</p>
<div><pre><span></span><span>&gt;&gt;&gt;</span> <span>import</span> <span>string</span>  <span># from the stdlib</span>
<span>&gt;&gt;&gt;</span> <span>alphabet_df</span> <span>=</span> <span>pd</span><span>.</span><span>DataFrame</span><span>(</span><span>zip</span><span>(</span><span>range</span><span>(</span><span>1</span><span>,</span> <span>27</span><span>),</span> <span>string</span><span>.</span><span>ascii_lowercase</span><span>),</span>\
    <span>columns</span><span>=</span><span>(</span><span>"number"</span><span>,</span> <span>"letter"</span><span>))</span><span>.</span><span>set_index</span><span>(</span><span>"number"</span><span>)</span>
<span>&gt;&gt;&gt;</span> <span>alphabet_df</span><span>.</span><span>to_csv</span><span>(</span><span>"csvbase://calpaterson/alphabet"</span><span>)</span>
</pre></div>
<p>You do admittedly need to put your csvbase username and <strong>API key</strong> into
<code>~/.netrc</code> first.  Here's mine:</p>
<div><pre><span></span><span>machine csvbase.com</span><span></span>
<span>  </span><span>login calpaterson</span><span></span>
<span>  </span><span>password hunter42</span><span></span>
</pre></div>
<p>You can check up on <code>calpaterson/alphabet</code>: it's a <a href="https://csvbase.com/calpaterson/alphabet">real table on
csvbase.com</a> now.</p>
<p>But perhaps you don't like Pandas.  You prefer <a href="https://pola.rs/">Polars</a>, that
other dataframe library.  Again: I refuse to write an API.  You can just use
Polars itself:</p>
<div><pre><span></span><span>&gt;&gt;&gt;</span> <span>import</span> <span>polars</span> <span>as</span> <span>pl</span>
<span>&gt;&gt;&gt;</span> <span>pl</span><span>.</span><span>read_csv</span><span>(</span><span>"csvbase://calpaterson/alphabet"</span><span>)</span>
<span>shape</span><span>:</span> <span>(</span><span>26</span><span>,</span> <span>3</span><span>)</span>
<span>┌────────────────┬────────┬────────┐</span>
<span>│</span> <span>csvbase_row_id</span> <span>┆</span> <span>number</span> <span>┆</span> <span>letter</span> <span>│</span>
<span>│</span> <span>---</span>            <span>┆</span> <span>---</span>    <span>┆</span> <span>---</span>    <span>│</span>
<span>│</span> <span>i64</span>            <span>┆</span> <span>i64</span>    <span>┆</span> <span>str</span>    <span>│</span>
<span>╞════════════════╪════════╪════════╡</span>
<span>│</span> <span>1</span>              <span>┆</span> <span>1</span>      <span>┆</span> <span>a</span>      <span>│</span>
<span>│</span> <span>2</span>              <span>┆</span> <span>2</span>      <span>┆</span> <span>b</span>      <span>│</span>
<span>│</span> <span>3</span>              <span>┆</span> <span>3</span>      <span>┆</span> <span>c</span>      <span>│</span>
<span>│</span> <span>4</span>              <span>┆</span> <span>4</span>      <span>┆</span> <span>d</span>      <span>│</span>
<span>│</span> <span>5</span>              <span>┆</span> <span>5</span>      <span>┆</span> <span>e</span>      <span>│</span>
<span>│</span> <span>…</span>              <span>┆</span> <span>…</span>      <span>┆</span> <span>…</span>      <span>│</span>
<span>│</span> <span>22</span>             <span>┆</span> <span>22</span>     <span>┆</span> <span>v</span>      <span>│</span>
<span>│</span> <span>23</span>             <span>┆</span> <span>23</span>     <span>┆</span> <span>w</span>      <span>│</span>
<span>│</span> <span>24</span>             <span>┆</span> <span>24</span>     <span>┆</span> <span>x</span>      <span>│</span>
<span>│</span> <span>25</span>             <span>┆</span> <span>25</span>     <span>┆</span> <span>y</span>      <span>│</span>
<span>│</span> <span>26</span>             <span>┆</span> <span>26</span>     <span>┆</span> <span>z</span>      <span>│</span>
<span>└────────────────┴────────┴────────┘</span>
</pre></div>
<p>What about <a href="https://docs.dask.org/en/stable/">Dask</a>?  Same thing:</p>
<div><pre><span></span><span>&gt;&gt;&gt;</span> <span>import</span> <span>dask.dataframe</span> <span>as</span> <span>dd</span>
<span>&gt;&gt;&gt;</span> <span>dd</span><span>.</span><span>read_csv</span><span>(</span><span>"csvbase://calpaterson/alphabet"</span><span>)</span>
<span>Dask</span> <span>DataFrame</span> <span>Structure</span><span>:</span>
              <span>csvbase_row_id</span> <span>number</span>  <span>letter</span>
<span>npartitions</span><span>=</span><span>1</span>
                       <span>int64</span>  <span>int64</span>  <span>string</span>
                         <span>...</span>    <span>...</span>     <span>...</span>
<span>Dask</span> <span>Name</span><span>:</span> <span>read_csv</span><span>,</span> <span>1</span> <span>expression</span>
<span>Expr</span><span>=</span><span>ReadCSV</span><span>(</span><span>16</span><span>ad101</span><span>)</span>
</pre></div>
<p>I imported <code>pandas as pd</code>, I imported <code>polars as pl</code> and I imported
<code>dask.dataframe as dd</code>.  But I didn't import <code>csvbase_client</code>.  Unnecessary -
there is no API.</p>
<h2>Enter fsspec</h2>
<p>How is this all working?  Have I perpetrated a kind of grand, <a href="https://www.wired.com/story/jia-tan-xz-backdoor/">Jia Tan</a>-style
jedi mind trick on the maintainers of these dataframe libraries, secretly
sneaking csvbase-specific code into their repos?</p>
<p>I haven't.  All of these dataframe libraries (and probably others I haven't
thought of) use a standard filesystem interface library, called
<a href="https://github.com/fsspec/filesystem_spec/">fsspec</a>.  csvbase-client just
implements an adaptor for fsspec:</p>
<div><pre><span></span><span>from</span> <span>fsspec.spec</span> <span>import</span> <span>AbstractFileSystem</span><span>,</span> <span>AbstractBufferedFile</span>

<span>class</span> <span>CSVBaseFileSystem</span><span>(</span><span>AbstractFileSystem</span><span>):</span>
    <span>def</span> <span>_open</span><span>(</span><span>self</span><span>,</span> <span>path</span><span>,</span> <span>mode</span><span>=</span><span>"rb"</span><span>):</span>
        <span>return</span> <span>CSVBaseFile</span><span>(</span><span>self</span><span>,</span> <span>path</span><span>,</span> <span>mode</span><span>)</span>

<span>class</span> <span>CSVBaseFile</span><span>(</span><span>AbstractBufferedFile</span><span>):</span>
    <span>def</span> <span>_fetch_range</span><span>(</span><span>self</span><span>,</span> <span>start</span><span>:</span> <span>int</span><span>,</span> <span>end</span><span>:</span> <span>int</span><span>)</span> <span>-&gt;</span> <span>bytes</span><span>:</span>
        <span>...</span>
</pre></div>
<p>fsspec already comes with built-in adaptors for <a href="https://calpaterson.com/s3.html">object
stores</a>, webdav, Github, Dropbox and lots
more.  It's a pretty nice abstraction layer.  csvbase's client is just one more
adaptor.</p>
<p>For whatever reason, fsspec is not that well known.  It has less than 800 stars
<a href="https://github.com/fsspec/filesystem_spec/">on github</a>.  But it is well used:
it's downloaded <a href="https://pypistats.org/packages/fsspec">more than 8 million times a
day</a>, usually as an automatically
installed dependency of other libraries.  That actually makes it the 20th most
popular Python package - bigger in fact than Pandas.</p>
<p>At any rate, after my classes are written it just takes a short setuptools
incantation to wire my classes into place upon package install:</p>
<div><pre><span></span><span>from</span> <span>setuptools</span> <span>import</span> <span>setup</span>
<span>setup</span><span>(</span>
  <span>name</span><span>=</span><span>"csvbase-client"</span><span>,</span>
  <span>...</span><span>,</span> <span># [snip]</span>
  <span>entry_points</span><span>=</span><span>{</span>
    <span>"fsspec.specs"</span><span>:</span> <span>[</span>
      <span>"csvbase=csvbase_client.fsspec.CSVBaseFileSystem"</span><span>,</span>
    <span>],</span>
  <span>},</span>
<span>)</span>
</pre></div>
<p>Or in pyproject.toml:</p>
<div><pre><span></span><span>[project.entry-points."fsspec.specs"]</span><span></span>
<span>csvbase</span><span> </span><span>=</span><span> </span><span>"csvbase_client.fsspec.CSVBaseFileSystem"</span><span></span>
</pre></div>
<p>With all this working, the <code>csvbase://</code> url scheme becomes real and you can use
it inside anything which relies on fsspec, which is a surprisingly large number
of things.</p>
<h2>How to use fsspec in your own programs</h2>
<p>fsspec is pretty nice.  It's very useful when you want, for example, to write a
cli program that can write both to a file, and then later an S3 object.</p>
<p>Instead of calling the Python built-in <code>open</code>, you call <code>fsspec.open</code>.  It is a
mostly drop-in replacement.</p>
<div><pre><span></span><span>import</span> <span>fsspec</span>

<span>with</span> <span>fsspec</span><span>.</span><span>open</span><span>(</span><span>"csvbase://calpaterson/onion-vox-pops"</span><span>)</span> <span>as</span> <span>vox_pops_f</span><span>:</span>
   <span>print</span><span>(</span><span>vox_pops_f</span><span>.</span><span>read</span><span>(</span><span>100</span><span>))</span>
</pre></div>
<p>That's it.  It is extremely simple to integrate against.</p>
<p>There isn't just <code>open</code>, either, but <code>touch</code>, <code>rm</code>, <code>cp</code>, <code>mv</code> - the whole
gang.  <code>csvbase-client</code>'s support doesn't cover all of these yet, but that is
planned.</p>
<h2>And there's a cli tool</h2>
<p>I can't get out of writing a cli tool for csvbase.  There is no way to avoid
that - but I did make it a thin veneer over fsspec.</p>
<div><pre><span></span>$ csvbase-client table get calpaterson/alphabet
csvbase_row_id,number,letter
<span>1</span>,1,a
<span>2</span>,2,b
<span>3</span>,3,c
<span>[</span>you know the rest<span>]</span>
</pre></div>
<p>But <a href="https://csvbase.com/blog/5">other examples</a> are more fun:</p>
<div><pre><span></span>$ csvbase-client table get calpaterson/eurofxref-hist <span>|</span> <span>\</span>
grep USD <span>|</span> <span>\</span>
cut -d, -f <span>2</span>,4 <span>|</span> <span>\</span>
gnuplot -e <span>"set datafile separator ','; set term dumb; \</span>
<span>plot '-' using 1:2 with lines title 'usd'"</span>
</pre></div>
<p><img src="https://csvbase.com/blog-static/dumb-term.png" alt="a gnuplot graph in drawn in the
terminal"></p>
<h2>The bytes on the internet are free and you can take them home with you</h2>
<p>As with <a href="https://github.com/calpaterson/csvbase">csvbase proper</a>,
<a href="https://github.com/calpaterson/csvbase-client">csvbase-client</a> is open source,
so you can just <a href="https://github.com/calpaterson/csvbase-client/blob/main/csvbase_client/fsspec.py">take my
code</a>
as a starting point and write your own fsspec APIs.</p>
<p>I'm looking forward to expanding on it in future.  I'm particularly keen to use
fsspec to <a href="https://filesystem-spec.readthedocs.io/en/latest/features.html#mount-anything-with-fuse">mount csvbase.com as a
filesystem</a>
via FUSE.  That sounds fun.</p>
<p>Help me out:</p>
<ul>
<li>try <a href="https://pypi.org/project/csvbase-client/">csvbase-client</a></li>
<li>
do me a solid by <a href="https://github.com/calpaterson/csvbase-client">starring csvbase-client on
github</a><ul>
<li>star the <a href="https://github.com/calpaterson/csvbase">main
project</a> as well if you're feeling
extra generous</li>
<li>regardless, shoot <a href="https://github.com/fsspec/filesystem_spec/">fsspec</a> a
github star because they did almost the work</li>
</ul>
</li>
<li><a href="mailto:cal@calpaterson.com">email me your thoughts</a></li>
<li>or <a href="https://github.com/calpaterson/csvbase-client/issues">file bugs on github</a></li>
</ul>

      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Microsoft employees exposed internal passwords in security lapse (111 pts)]]></title>
            <link>https://techcrunch.com/2024/04/09/microsoft-employees-exposed-internal-passwords-security-lapse/</link>
            <guid>39988415</guid>
            <pubDate>Wed, 10 Apr 2024 08:46:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://techcrunch.com/2024/04/09/microsoft-employees-exposed-internal-passwords-security-lapse/">https://techcrunch.com/2024/04/09/microsoft-employees-exposed-internal-passwords-security-lapse/</a>, See on <a href="https://news.ycombinator.com/item?id=39988415">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
				<p id="speakable-summary">Microsoft has resolved a security lapse that exposed internal company files and credentials to the open internet.</p>
<p>Security researchers Can Yoleri, Murat Özfidan and Egemen Koçhisarlı with SOCRadar, a cybersecurity company that helps organizations find security weaknesses, discovered an open and public storage server hosted on Microsoft’s Azure cloud service that was storing internal information relating to Microsoft’s Bing search engine.</p>
<p>The Azure storage server housed code, scripts and configuration files containing passwords, keys and credentials used by the Microsoft employees for accessing other internal databases and systems.</p>
<p>But the storage server itself was not protected with a password and could be accessed by anyone on the internet.</p>
<p>Yoleri told TechCrunch that the exposed data could potentially help malicious actors identify or access other places where Microsoft stores its internal files. Identifying those storage locations “could result in more significant data leaks and possibly compromise the services in use,” Yoleri said.</p>
<p>The researchers notified Microsoft of the security lapse on February 6, and Microsoft secured the spilling files on March 5.</p>
<p>It’s not known for how long the cloud server was exposed to the internet, or if anyone other than SOCRadar discovered the exposed data inside. When reached by email, a spokesperson for Microsoft did not provide comment by the time of publication. Microsoft did not say if it had reset or changed any of the exposed internal credentials.</p>
<p>This is the latest security gaffe at Microsoft as the company tries to rebuild trust with its customers after a series of cloud security incidents in recent years. In a similar security lapse last year, researchers found that <a href="https://www.vice.com/en/article/m7gb43/microsoft-employees-exposed-login-credentials-azure-github" target="_blank" rel="noopener">Microsoft employees were exposing their own corporate network logins</a> in code published to GitHub.</p>
<p>Microsoft also came under fire last year after the company admitted it did not know <a href="https://techcrunch.com/2023/09/08/microsoft-hacker-china-government-storm-0558/">how China-backed hackers stole an internal email signing key</a> that allowed the hackers broad access to Microsoft-hosted inboxes of senior U.S. government officials. An independent board of cyber experts tasked with investigating the email breach wrote in their report, published last week, that the hackers succeeded because of a “cascade of security failures at Microsoft.”</p>
<p>In March, Microsoft said that <a href="https://techcrunch.com/2024/03/08/microsoft-ongoing-cyberattack-russia-apt-29/">it continues to counter an ongoing cyberattack</a> that allowed Russian state-backed hackers to steal portions of the company’s source code and internal emails from Microsoft corporate executives.</p>
			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Verified curl (133 pts)]]></title>
            <link>https://daniel.haxx.se/blog/2024/04/10/verified-curl/</link>
            <guid>39988269</guid>
            <pubDate>Wed, 10 Apr 2024 08:20:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://daniel.haxx.se/blog/2024/04/10/verified-curl/">https://daniel.haxx.se/blog/2024/04/10/verified-curl/</a>, See on <a href="https://news.ycombinator.com/item?id=39988269">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
		
<p>Don’t trust. Verify.</p>


<div>
<figure><a href="https://daniel.haxx.se/blog/wp-content/uploads/2024/04/state-sponsor-your-open-source.png"><img decoding="async" width="1979" height="2800" src="https://daniel.haxx.se/blog/wp-content/uploads/2024/04/state-sponsor-your-open-source.png" alt=""></a><figcaption><em>I could not resist making a fake book cover</em></figcaption></figure></div>


<p>Here follows a brief description on how you can detect if the curl package would ever <a href="https://en.wikipedia.org/wiki/XZ_Utils_backdoor">make an xz</a>.</p>



<p>xz (and its library liblzma) was presumably selected as a target because it is an often used component and by extension via systemd it often used by openssh in several Linux distros. libcurl is probably an even more widely used software component and if infected, could potentially serve as an effective vessel to distribute evil into the world.</p>



<p>Conceivably, the xz attackers have infiltrated more than one other Open Source project to cover their bases. Which ones?</p>



<h2>No inexplicable binary blobs</h2>



<p>First, you can verify that there are no binary blobs stored in git that could host an encrypted attack payload, planted there for the future.</p>



<p>Every file in <a href="https://github.com/curl/curl">the curl git repository</a> has a benign meaning and purpose. As part of the products, the documentation, tooling or the test suites etc.</p>



<p>Without any secret “hide-out” in the git repository, you know that any backdoor needs to be provided either in plain code or using some crazy weird <a href="https://en.wikipedia.org/wiki/Steganography">steganography</a>. Or get inserted into the tarballs with content not present in git – read on for how to verify that this is not happening.</p>



<h2>No disabled fuzzers</h2>



<p>The xz attack would have been detected by proper fuzzing (and valgrind use) which is why the attacker made sure to sneakily disable such automated checks of code that was present in git.</p>



<p>While somewhat hard to verify, you can make sure that no such activities have been done in curl’s fuzzing or curl’s automated and CI testing,</p>



<h2>No hidden payloads in tarballs</h2>



<p>In the curl project we <em>generate</em> several files as part of the release process and those files end up in the release tarball. This means that not all files in the tarball are found in the git repository. (Because we don’t commit generated files.)</p>



<p>The generated files are produced with a small set of tools, and these tools use the source code available in git at the release tag. Anyone can check out the same code from that same release tag, make sure to have the corresponding tools (and versions) installed and then generate a version of the tarball themselves – to verify that this tarball indeed becomes an identical copy of the public release.</p>



<p>That process verifies that the tarballs we ship are generated only with legitimate tools and that the release contents originate only from the files present in git. No secret sauce added in the process. No malicious code can get inserted.</p>



<h2>Reproducible tarballs</h2>



<p>We have recently improved reproducibility as a direct result of the post xz-attack debate. To make sure that a repeated tarball creation actually produces the exact same results, but also to make it easier for others to verify our release tarballs. With more documentation (releases now contain documentation of exactly which tools and versions that generated the tarball) and by making it easier to run the exact same virtual machine and tool setup like the one that created the release. We aim to soon <a href="https://github.com/curl/curl/pull/13250">provide a Dockerfile</a> to make this process even smoother.</p>



<p>We also verify tarball reproducibility in a CI job: generating a release tarball with a given timestamp produces the identical binary output when done again for the same timestamp.</p>



<h2>Signed tarballs</h2>



<p>As an extra detail, everyone can also verify that the released tarballs are in fact shipped by me Daniel personally, as they are always signed with my GPG key as part of the release process. This should at least prove that new releases are made with the same keys as previous ones were, which should with a reasonable probability be me.</p>



<p>The signatures also help verify that the tarballs have not been tampered with in transition, from the point I generated them to the moment they land in your download directory. curl downloads are normally distributed via a third-party CDN which we normally trust of course, but if it would ever be breached or similar, a modified tarball would be detected when the digital signature is verified.</p>



<p>We do not provide checksums for the tarballs simply because providing checksums next to the downloads adds almost no extra verification. If someone can tamper with the tarballs, they can probably update the webpage which a fake checksum as well.</p>



<h2>Signed commits</h2>



<p>All commits done to curl done by me are signed, You can verify that I did them. Not all committers in the project do them signed, unfortunately. We hope to increase the share going forward. Over the last 365 days, 73% of the curl commits were signed.</p>



<p>These signatures only verify that the commits where done by a maintainer of the curl project (or someone who controls that account). A maintainer you may not trust and who might not be known under their real name and you do not even know in which country they live. And of course, even a trusted maintainer can suddenly go rogue.</p>



<h2>Is the content in git benign?</h2>



<p>The process above only verifies that tarballs are indeed generated (only) from contents present in git and that they are unaltered from the moment I made them.</p>



<p>How do you know that the contents in git does not contain any backdoors or other vulnerabilities?</p>



<p>Without trusting anyone else’s opinions and without just relying on the fact that you can run the test suite, fuzzers and static code analyzers without finding anything, you can review it. Or pay someone else to review it.</p>



<p>We have had <a href="https://curl.se/docs/audits.html">curl audited several times</a> by external organizations, but can you trust claimed random audits?</p>



<h2>Anonymous contributors</h2>



<p>We regularly accept contributions from anonymous and pseudonymous contributors in curl – and we always have. Our policy says that if a contribution is good: if it passes review and all tests run green, we have no reason to deny it – in the name of progress and improvement. That is also why we accept even single-letter typo fixes: even a very small fix is a step in the right direction.</p>



<p>A (to me) surprisingly large amount of contributions are done by people who do not state a full real name. They may chose to be anonymous for various reasons – we do not ask. Maybe they fear retaliation if they would propose something that ends up buggy? Sometimes people want to hide their affiliation/origin so that their contribution is not associated with the organization they work at. Another reason sometimes mentioned is that women do it to avoid revealing themselves as female. etc. As  I said: we do not ask so I cannot tell for sure.</p>



<h2>Anonymous maintainers</h2>



<p>We do not have anonymous maintainers, but we don’t actually have rules against it.</p>



<p>Right now, we have 18 members in the GitHub curl organization with the <em>rights</em> to push commits. I have not met all of them. I have not even seen the faces of all of them. They have all proven themselves worthy of their administrative rights based on their track record. I cannot know if anyone of them is using a false identity and I do not ask nor keep track in which country they reside. A former top maintainer in the curl projected even landed a large amount of changes under a presumed/false name during several years.</p>



<p>If a curl maintainer suddenly goes rogue and attempts to land malicious content, our only effective remedy is review. To rely on the curl community to have eyes on the changes and to test things.</p>



<h2>Can curl be targeted?</h2>



<p>I think it would be very hard but I can of course not rule it out. Possibly I am also blind for our weaknesses because I have lived with them for so long.</p>



<p>Everyone can help the greater ecosystem by verifying a package or two. If we all tighten all screws just a little bit more, things will get better.</p>



<h2>Vulnerabilities</h2>



<p>I maintain that planting a backdoor in curl code is so infuriatingly hard to achieve that efforts and energy are probably much rather spent on  finding security vulnerabilities and ways to exploit them. After all, we have <a href="https://curl.se/docs/security.html">155 published past vulnerabilities</a> in curl so far, out of which 42 have been at severity high or critical.</p>



<p>I can be fairy sure that none of those 42 somewhat serious issues were deliberately planted, because just about every one of them were found in code that I personally authored…</p>



<p>People often ask. But I have <strong>never</strong> seen a backdoor attempt in curl. Maybe that is just me being naive.</p>



<h2>Credits</h2>



<p>Top Image by <a href="https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=8577615">Gerd Altmann</a> from <a href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=8577615">Pixabay</a>. Fake book cover by Daniel Stenberg.</p>
	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Three major LLM releases in 24 hours (117 pts)]]></title>
            <link>https://simonwillison.net/2024/Apr/10/weeknotes-llm-releases/</link>
            <guid>39987769</guid>
            <pubDate>Wed, 10 Apr 2024 07:01:34 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://simonwillison.net/2024/Apr/10/weeknotes-llm-releases/">https://simonwillison.net/2024/Apr/10/weeknotes-llm-releases/</a>, See on <a href="https://news.ycombinator.com/item?id=39987769">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-permalink-context="/2024/Apr/10/weeknotes-llm-releases/">

<p>10th April 2024</p>

<p>I’m a bit behind on my <a href="https://simonwillison.net/tags/weeknotes/">weeknotes</a>, so there’s a lot to cover here. But first... a review of the last 24 hours of Large Language Model news. All times are in US Pacific.</p>
<ul>
<li>11:01am: Google Gemini Pro 1.5 hits general availability, here’s <a href="https://developers.googleblog.com/2024/04/gemini-15-pro-in-public-preview-with-new-features.html">the blog post</a>—their 1 million token context GPT-4 class model now has no waitlist, is available to anyone in 180 countries (not including Europe or the UK as far as I can tell) and most impressively all the API has a <strong>free tier</strong> that allows up to 50 requests a day, though rate limited to 2 per minute. Beyond that you can pay $7/million input tokens and $21/million output tokens, which is slightly less than GPT-4 Turbo and a little more than Claude 3 Sonnet. Gemini Pro also now support audio inputs and system prompts.</li>
<li>11:44am: OpenAI finally released the non-preview version of <strong>GPT-4 Turbo</strong>, integrating GPT-4 Vision directly into the model (previously it was separate). Vision mode now supports both functions and JSON output, previously unavailable for image inputs. OpenAI also claim that the new model is <a href="https://twitter.com/OpenAI/status/1777772582680301665">“Majorly improved”</a> but no-one knows what they mean by that.</li>
<li>6:20pm (3:20am in their home country of France): Mistral <a href="https://twitter.com/MistralAI/status/1777869263778291896">tweet a link</a> to a 281GB magnet BitTorrent of <strong>Mixtral 8x22B</strong>—their latest openly licensed model release, significantly larger than their previous best open model Mixtral 8x7B. I’ve not seen anyone get this running yet but it’s likely to perform extremely well, given how good the original Mixtral was.</li>
</ul>
<p>And while it wasn’t released today (it came out <a href="https://txt.cohere.com/command-r-plus-microsoft-azure/">last week</a>), this morning Cohere’s Command R+ (an excellent openly licensed model) <a href="https://fedi.simonwillison.net/@simon/112242034813525962">reached position 6 on the LMSYS Chatbot Arena Leaderboard</a>—the highest ever ranking for an open weights model.</p>
<p>Since I have a lot of software that builds on these models, I spent a bunch of time today publishing new releases of things.</p>

<p>I’ve been working on <a href="https://datasette.io/plugins/datasette-extract">Datasette Extract</a> for a while now: it’s a plugin for Datasette that adds structured data extraction from unstructured text, powered by GPT-4 Turbo.</p>
<p>I updated it for the new model releases <a href="https://github.com/datasette/datasette-extract/releases/tag/0.1a4">this morning</a>, and decided to celebrate by making <a href="https://www.youtube.com/watch?v=g3NtJatmQR0">a video</a> showing what it can do:</p>
<iframe src="https://www.youtube.com/embed/g3NtJatmQR0?si=OcLs6MqykLTFvZb3" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen"> </iframe>
<p>I want to start publishing videos like this more often, so this felt like a great opportunity to put that into practice.</p>
<p>The Datasette Cloud blog hasn’t had an entry in a while, so I <a href="https://www.datasette.cloud/blog/2024/datasette-extract/">published screenshots and notes there</a> to accompany the video.</p>
<h4 id="gemini-pro-system-prompts">Gemini Pro 1.5 system prompts</h4>
<p>I really like system prompts—extra prompts you can pass to an LLM that give it instructions about how to process the main input. They’re sadly <a href="https://simonwillison.net/2023/Apr/14/worst-that-can-happen/#gpt4">not a guaranteed solution for prompt injection</a>—even with instructions separated from data by a system prompt you can still over-ride them in the main prompt if you try hard enough—but they’re still useful for non-adversarial situations.</p>
<p><strong><a href="https://github.com/simonw/llm-gemini/releases/tag/0.1a2">llm-gemini 0.1a2</a></strong> adds support for them, so now you can do things like this:</p>
<div><pre>llm -m p15 <span><span>'</span>say hi three times three different ways<span>'</span></span> \
  --system <span><span>'</span>in spanish<span>'</span></span></pre></div>
<p>And get back output like this:</p>
<blockquote>
<p>¡Hola! 👋 ¡Buenos días! ☀️ ¡Buenas tardes! 😊</p>
</blockquote>
<p>Interestingly “in german” doesn’t include emoji, but “in spanish” does.</p>
<p>I had to reverse-engineer the REST format for sending a system prompt from the Python library as the REST documentation hasn’t been updated yet—<a href="https://github.com/simonw/llm-gemini/issues/6#issuecomment-2046460319">notes on that in my issue</a>.</p>
<h4 id="datasette-enrichments-turbo">datasette-enrichments-gpt using GPT-4 Turbo</h4>
<p>Another small release: the <a href="https://datasette.io/plugins/datasette-enrichments-gpt">datasette-enrichments-gpt</a> plugin can enrich data in a table by running prompts through GPT-3.5, GPT-4 Turbo or GPT-4 Vision. I released <a href="https://github.com/datasette/datasette-enrichments-gpt/releases/tag/0.4">version 0.4</a> switching to the new GPT-4 Turbo model.</p>
<h4 id="weeknotes-178-everything-else">Everything else</h4>
<p>That covers today... but my last weeknotes were nearly four weeks ago! Here’s everything else, with a few extra annotations:</p>
<h4 id="weeknotes-178-blog-entries">Blog entries</h4>
<p>All five of my most recent posts are about ways that I use LLM tools in my own work—see also my <a href="https://simonwillison.net/series/using-llms/">How I use LLMs and ChatGPT</a> series.</p>
<ul>
<li><a href="https://simonwillison.net/2024/Apr/8/files-to-prompt/">Building files-to-prompt entirely using Claude 3 Opus</a></li>
<li><a href="https://simonwillison.net/2024/Mar/30/ocr-pdfs-images/">Running OCR against PDFs and images directly in your browser</a></li>
<li><a href="https://simonwillison.net/2024/Mar/26/llm-cmd/">llm cmd undo last git commit—a new plugin for LLM</a></li>
<li><a href="https://simonwillison.net/2024/Mar/23/building-c-extensions-for-sqlite-with-chatgpt-code-interpreter/">Building and testing C extensions for SQLite with ChatGPT Code Interpreter</a></li>
<li><a href="https://simonwillison.net/2024/Mar/22/claude-and-chatgpt-case-study/">Claude and ChatGPT for ad-hoc sidequests</a></li>
</ul>
<h4 id="weeknotes-178-releases">Releases</h4>
<p>Many of these releases relate to ongoing work on <a href="https://www.datasette.cloud/">Datasette Cloud</a>. In particular there’s a flurry of minor releases to add descriptions to the action menu items added by various plugins, best illustrated by this screenshot:</p>
<p><img src="https://static.simonwillison.net/static/2024/action-menus.png" alt="A screenshot showing the database actions, table actions and row actions menus in Datasette running on Datasette Cloud. The database menu items are: Upload CSV. Create a new table by uploading a CSV file. Execute SQL write. Run queries like insert/update/delete against this database. Query this database with Al assistance. Ask a question to build a SQL query. Create table with Al extracted data. Paste in text or an image to extract structured data. Edit database metadata. Set the description, source and license for this database. Create a table. Define a new table with specified columns. Create table with pasted data. Paste in JSON, CSV or TSV data (e.g. from Google Sheets). Export this database. Create and download a snapshot of this SQLite database (1.3 GB). The table menu items: Delete this table. Delete table and all rows within it. Enrich selected data. Run a data cleaning operation against every selected row. Query this table with Al assistance. Ask a question to build a SQL query. Extract data into this table with Al. Paste in text or an image to extract structured data. Edit table metadata. Set the description, source and license for this table. Edit table schema. Rename the table, add and remove columns.... Make table public. Allow anyone to view this table. Configure full-text search. Select columns to make searchable for this table. The row menu items: Enrich this row. Run a dat acleaning operation against this row."></p>
<ul>
<li>
<strong><a href="https://github.com/datasette/datasette-enrichments-gpt/releases/tag/0.4">datasette-enrichments-gpt 0.4</a></strong>—2024-04-10<br>Datasette enrichment for analyzing row data using OpenAI’s GPT models</li>
<li>
<strong><a href="https://github.com/simonw/llm-gemini/releases/tag/0.1a2">llm-gemini 0.1a2</a></strong>—2024-04-10<br>LLM plugin to access Google’s Gemini family of models</li>
<li>
<strong><a href="https://github.com/simonw/datasette-public/releases/tag/0.2.3">datasette-public 0.2.3</a></strong>—2024-04-09<br>Make specific Datasette tables visible to the public</li>
<li>
<strong><a href="https://github.com/datasette/datasette-enrichments/releases/tag/0.3.2">datasette-enrichments 0.3.2</a></strong>—2024-04-09<br>Tools for running enrichments against data stored in Datasette</li>
<li>
<strong><a href="https://github.com/datasette/datasette-extract/releases/tag/0.1a4">datasette-extract 0.1a4</a></strong>—2024-04-09<br>Import unstructured data (text and images) into structured tables</li>
<li>
<strong><a href="https://github.com/simonw/datasette-cors/releases/tag/1.0">datasette-cors 1.0</a></strong>—2024-04-08<br>Datasette plugin for configuring CORS headers</li>
<li>
<strong><a href="https://github.com/simonw/asgi-cors/releases/tag/1.0">asgi-cors 1.0</a></strong>—2024-04-08<br>ASGI middleware for applying CORS headers to an ASGI application</li>
<li>
<strong><a href="https://github.com/simonw/files-to-prompt/releases/tag/0.2.1">files-to-prompt 0.2.1</a></strong>—2024-04-08<br>Concatenate a directory full of files into a single prompt for use with LLMs</li>
<li>
<strong><a href="https://github.com/datasette/datasette-embeddings/releases/tag/0.1a3">datasette-embeddings 0.1a3</a></strong>—2024-04-08<br>Store and query embedding vectors in Datasette tables</li>
<li>
<strong><a href="https://github.com/datasette/datasette-studio/releases/tag/0.1a3">datasette-studio 0.1a3</a></strong>—2024-04-06<br>Datasette pre-configured with useful plugins. Experimental alpha.</li>
<li>
<strong><a href="https://github.com/datasette/datasette-paste/releases/tag/0.1a5">datasette-paste 0.1a5</a></strong>—2024-04-06<br>Paste data to create tables in Datasette</li>
<li>
<strong><a href="https://github.com/datasette/datasette-import/releases/tag/0.1a4">datasette-import 0.1a4</a></strong>—2024-04-06<br>Tools for importing data into Datasette</li>
<li>
<strong><a href="https://github.com/datasette/datasette-enrichments-quickjs/releases/tag/0.1a2">datasette-enrichments-quickjs 0.1a2</a></strong>—2024-04-05<br>Enrich data with a custom JavaScript function</li>
<li>
<strong><a href="https://github.com/simonw/s3-credentials/releases/tag/0.16.1">s3-credentials 0.16.1</a></strong>—2024-04-05<br>A tool for creating credentials for accessing S3 buckets</li>
<li>
<strong><a href="https://github.com/simonw/llm-command-r/releases/tag/0.2">llm-command-r 0.2</a></strong>—2024-04-04<br>Access the Cohere Command R family of models</li>
<li>
<strong><a href="https://github.com/simonw/llm-nomic-api-embed/releases/tag/0.1">llm-nomic-api-embed 0.1</a></strong>—2024-03-30<br>Create embeddings for LLM using the Nomic API</li>
<li>
<strong><a href="https://github.com/simonw/textract-cli/releases/tag/0.1">textract-cli 0.1</a></strong>—2024-03-29<br>CLI for running files through AWS Textract</li>
<li>
<strong><a href="https://github.com/simonw/llm-cmd/releases/tag/0.1a0">llm-cmd 0.1a0</a></strong>—2024-03-26<br>Use LLM to generate and execute commands in your shell</li>
<li>
<strong><a href="https://github.com/simonw/datasette-write/releases/tag/0.3.2">datasette-write 0.3.2</a></strong>—2024-03-18<br>Datasette plugin providing a UI for executing SQL writes against the database</li>
</ul>
<h4 id="weeknotes-178-tils">TILs</h4>
<ul>
<li>
<a href="https://til.simonwillison.net/macos/impaste">impaste: pasting images to piped commands on macOS</a>—2024-04-04</li>
<li>
<a href="https://til.simonwillison.net/go/installing-tools">Installing tools written in Go</a>—2024-03-26</li>
<li>
<a href="https://til.simonwillison.net/chrome/headless">Google Chrome --headless mode</a>—2024-03-24</li>
<li>
<a href="https://til.simonwillison.net/clickhouse/github-public-history">Reviewing your history of public GitHub repositories using ClickHouse</a>—2024-03-20</li>
<li>
<a href="https://til.simonwillison.net/npm/self-hosted-quickjs">Running self-hosted QuickJS in a browser</a>—2024-03-20</li>
<li>
<a href="https://til.simonwillison.net/python/comparing-version-numbers">Programmatically comparing Python version strings</a>—2024-03-17</li>
</ul>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Meta Used Monolithic Architecture to Ship Threads in Only Five Months (172 pts)]]></title>
            <link>https://www.infoq.com/news/2024/04/meta-threads-instagram-5-months/</link>
            <guid>39987466</guid>
            <pubDate>Wed, 10 Apr 2024 06:12:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.infoq.com/news/2024/04/meta-threads-instagram-5-months/">https://www.infoq.com/news/2024/04/meta-threads-instagram-5-months/</a>, See on <a href="https://news.ycombinator.com/item?id=39987466">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
								<p>Zahan Malkani <a href="https://qconlondon.com/presentation/apr2024/0-1-shipping-threads-5-months">talked during QCon London 2024 about Meta's journey</a> from identifying the opportunity in the market to shipping the Threads application only five months later. The company leveraged Instagram's existing monolithic architecture and quickly iterated to create a new text-first microblogging service in record time.</p>

<p>Soon after Elon Musk acquired Twitter, Meta saw an opportunity to create a competing service but had little time to launch it to attract existing Twitter users, who were looking for alternatives. The company initially tested whether better support for text-based posts on Instagram would be sufficient to sway some Twitter users over to Meta's products, but these efforts didn’t attract enough new users.</p>

<p>Meta formed a small team to devise an approach to delivering a new service that would directly compete with Twitter in just a few months. <a href="https://www.linkedin.com/in/zahanm">Zahan Malkani</a>, a software engineer at Meta, shared how his team was able to reuse the existing Instagram backend components, data stores, and large parts of the existing infrastructure stack but customize them to offer functionality comparable to what now is X.</p>

<p><img alt="" data-src="news/2024/04/meta-threads-instagram-5-months/en/resources/1meta-instagram-arch-1712608215163.jpeg" src="https://imgopt.infoq.com/fit-in/3000x4000/filters:quality(85)/filters:no_upscale()/news/2024/04/meta-threads-instagram-5-months/en/resources/1meta-instagram-arch-1712608215163.jpeg" rel="share"></p>

<p><em>Instagram / Threads High-Level Architecture (Source: <a href="https://www.linkedin.com/posts/danielbryantuk_qconlondon-ugcPost-7183060633251147776-a6Fx?utm_source=share&amp;utm_medium=member_desktop">Daniel Bryant’s LinkedIn post</a>)</em></p>

<p>Theads's technology stack is almost identical to Instagram's, consisting of a few monolithic application components and dedicated data stores. The main backend component is a large Python codebase using a custom version of the <a href="https://www.djangoproject.com/">Django Framework</a>, named Distillery, that integrates with an older PHP component called WWW. The data is stored in <a href="https://engineering.fb.com/2013/06/25/core-infra/tao-the-power-of-the-graph/">TAO</a>, a write-though cache that operates on a <a href="https://en.wikipedia.org/wiki/Graph_database">graph data model</a>, which in turn uses UDB, a sharded <a href="https://www.mysql.com/">MySQL</a> deployment, that stores all the data. Additionally, the <a href="https://engineering.fb.com/2021/08/06/core-infra/zippydb/">ZippyDB</a> key-value cache stores transient data, and <a href="https://engineering.fb.com/2020/08/17/production-engineering/async/">Async</a>, a serverless function compute platform, is used to execute asynchronous jobs outside of peak hours.</p>

<p>While working on Threads, the team used a <a href="https://www.apollographql.com/docs/technotes/TN0032-sdui-basics">Server-Driven UI (SDUI)</a> approach to enable a quick experimentation cycle in the early days of the project, using thousands of company employees for feedback.</p>

<p>Despite the apparent advantages of reusing Instagram's platform for Threads (much faster delivery time), Malkani admitted the company introduced a substantial amount of technical debt that must be addressed in the future. The team is working on gradually separating the data models from Instagram's as the Threads service gains new functionality so that both platforms can be separated, but the process will take some time.</p>

<p>Malkani recounted the stressful period when Threads launched in July 2023, including a few mishaps, like when users in&nbsp;Southeast Asia and other time zones were&nbsp;able to download the mobile app before the US team was ready to allow traffic in, due to the time zone confusion. Engineers also had to improve scalability of some processes to allow for importing followers from Instagram. The team has been working tirelessly to address any issues and ensure the stability of the platform, which saw unprecedented adoption. Ten million users downloaded the app on the first day, and 100 million in the first five days.</p>

<p>Since the launch, the team delivered new features like the "following" feed, trending conversations, and the limited availability of API access for reading and writing posts. Threads team is also actively working on adopting <a href="https://www.w3.org/TR/activitypub/">the ActivityPub protocol</a>, allowing users to share their posts to other social networks that support the protocol.</p>

								









  
    <div> <!-- main wrapper for authors section -->
        <h2>About the Author</h2> <!-- section title -->

        
            
                
            
            <div data-id="author-Rafal-Gancarz">
                    <h4><strong>Rafal Gancarz</strong></h4>
                    
                </div>
        
    </div>

							</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[A science fiction obsession led me to psychological war (141 pts)]]></title>
            <link>https://buttondown.email/thehypothesis/archive/how-a-science-fiction-obsession-led-me-to/</link>
            <guid>39986593</guid>
            <pubDate>Wed, 10 Apr 2024 03:08:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://buttondown.email/thehypothesis/archive/how-a-science-fiction-obsession-led-me-to/">https://buttondown.email/thehypothesis/archive/how-a-science-fiction-obsession-led-me-to/</a>, See on <a href="https://news.ycombinator.com/item?id=39986593">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                <date>
                    
                        April 9, 2024
                    </date>
                
                

                

                
                    
                        <p>I've spent the past three years researching and writing a book about the history of psychological warfare in the United States. It’s called <a href="https://wwnorton.com/books/9780393881516?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank"><em>Stories Are Weapons: Psychological Warfare and the American Mind</em></a><em>, </em>and it comes out on June 4. The subject crept up on me, and not for the reasons you might think.</p>
<p>It all started over a decade ago at a science fiction convention in San Diego. I was talking to the writer Eugene Fisher about obscure writers that we loved. He mentioned Cordwainer Smith, a mid-twentieth century author who had written about human-animal hybrids of the distant future who led a revolution against their cyborg masters. It sounded amazing and weird, and I made a mental note to pick up some of Smith’s work. It was only later that I discovered that Cordwainer Smith was the pen name of Paul Linebarger, an intelligence operative who wrote the first Army manual devoted to the practice of psychological warfare in 1948.</p>
<p>I had to know more. So I started digging, and what follows is some of what I found. I was only able to cram a few of these gems into my book, so I've got a treasure trove of stuff here that I've been dying to talk about.</p>
<p>Linebarger’s father was a judge in the Philippines who became a devoted follower of Chinese nationalist Sun Yat-Sen. As a result, the young writer spent long stretches of his childhood under the tutelage of his godfather Sun Yat-Sen in China, learning statecraft from his father’s circle and Mandarin in school. He grew up with two names: 林白乐 (Lin Bai-lo) and Paul Linebarger. As an adult, he published science fiction as Cordwainer Smith, realist fiction under the name Felix C. Forrest, as well as a spy novel and an unpublished pop psychology book under the name Carmichael Smith. As a professional psywarrior, he worked to overthrow the Communists in China – not for the glory of America, but to continue the nationalist project of his mentor Sun Yat-Sen.&nbsp;</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/74f2ad0d-1868-4f64-9556-6e84b9a3ca42.png?w=960&amp;fit=max"><figcaption>The 1948 edition of "Psychological Warfare," and "We the Underpeople," a collection of Cordwainer Smith's short stories and a novel.</figcaption></figure>
<p>Now declassified, Linebarger’s <em>Psychological Warfare</em> is available from a number of print-on-demand publishers. I ordered a copy online, and read it alongside a collection of Cordwainer Smith stories called <em>We the Underpeople</em>. I couldn’t believe the same person had written them. This guy who wrote about subversive cat women and robot cities and weapons made from angry psychic weasels and mind control sex between people who are literally floating naked inside a chamber of flames – he had <em>also</em> codified the U.S. military’s approach to psyops at the dawn of the Cold War? <em>Really??</em></p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/18215c15-3639-4b96-9c48-6c93a20f8e31.jpg?w=960&amp;fit=max"><figcaption>An array of membership and ID cards that Linebarger saved, now preserved among his papers at the Hoover Institute. Note that his "mystery writers" name is Carmichael Smith, a name he used to publish a Cold War novel called "Atomsk." Under his legal name, he was part of the Cosmos Club, a private club in DC for thought leaders; and of course he was an Eisenhower man.</figcaption></figure>
<p>I’m not the first person to ask this question using italics and lots of question marks. A miniscule cottage industry of writing about Linebarger’s life explores whether he was <a href="https://elms.faculty.ucdavis.edu/wp-content/uploads/sites/98/2014/07/20021-Behind-the-Jet1.pdf?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">secretly delusional</a>, or perhaps <a href="https://reactormag.com/the-what-he-did-the-poetic-science-fiction-of-cordwainer-smith/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">dropping subversive messages</a> in his stories. Gary K. Wolfe, a literary critic who has <a href="https://www.jstor.org/stable/4239107?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">written quite a bit</a> about Linebarger’s fiction, told me that some fans thought the author had to be a time traveler because his futures felt so vivid and bizarrely detailed. There are even questions surrounding the people who study Linebarger. <a href="https://nevalalee.wordpress.com/about/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">Alec Nevala-Lee</a>, author of <em>Astounding: John W. Campbell, Isaac Asimov, Robert A. Heinlein, L. Ron Hubbard, and the Golden Age of Science Fiction</em>, said that he’s heard a lot of wild speculation about UC Davis psychology professor <a href="https://www.cordwainer-smith.com/scholarly.htm?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">Alan C. Elms</a>, who spent decades writing a biography of Linebarger, but never published it for mysterious reasons.&nbsp;</p>
<p>My point is that Paul Linebarger was a psyop specialist whose life history reads like a psyop. It makes you want to do your own research, as the conspiracy influencers say. I couldn’t stop thinking about Linebarger, but it wasn’t because I thought he was some kind of time traveling superspy. His work made me realize how much American propaganda strategies owed to science fiction.&nbsp;</p>
<p>Eventually, I followed my curiosity to the Hoover Institution Library &amp; Archive at Stanford University, where Linebarger’s papers are kept alongside his father’s.</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/7c91b14c-5ac7-4497-aecb-03eb9e28abea.png?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>This and the image below are from Linebarger’s personal diaries, which he kept between the ages of 10 and 16. Above is a note from October 17, 1926, when he was 13 years old. “I love Shanghai. Paradise!!!” he scrawls. “I don’t want to go away. Never! Never!! Never!!!!!!” He had just spent two years in China with his family, and was very enthusiastic about travel.</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/5b7ed81d-834a-4e6d-ac7a-1793af7fb91e.png?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>Two photos taken February ninth, 1929. Linebarger was 15 years old, and was in his first year at George Washington University.&nbsp;</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/51499013-2138-4d2f-9e2c-05229ba4e0a1.jpg?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>These are some slips of paper and pictures he kept tucked into the front flap of his teen journal: Chinese language practice, a picture of himself on a ship with a group of his father’s compatriots and Sun Yat-Sen followers, a picture of the Horsehead Nebula cut out from a magazine, and a list of women’s names (likely girls he’d had crushes on – his journals are full of urgent romantic commentary). It was wild to peer into the baby mind of a psywarrior, to see how closely his childhood interests aligned with his adult profession. He approached science fiction and international policy as two strands in the same project: Both were about explaining alien civilizations to each other, with a very specific goal in mind.</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/66e01d49-e79f-4771-9c14-5995e81ae25d.png?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>The fragment of typewritten manuscript above is from a book called “Conversations with Sun Yat-sen,” which he co-wrote with his father in the early 1930s. It’s from the introduction, written exclusively by the younger Linebarger, when he was both a college student and an his father’s secretary, helping with policy and intelligence analysis for the Chinese nationalist government. He wanted to sow empathy for China among Americans, especially at a time when racist immigration policies and political ignorance had distorted many people's understanding of what was happening across the Pacific.</p>
<p>He writes: “China the Nation, in the mind of Sun Yat-sen, is the most difficult of all his principles to interpret to the Western understanding. Nationalism is so simple and intelligible a phenomenon when preached by Hitler and Mussolini that is seems impossible that any other doctrines should be nationalistic and yet run counter to the chauvinisms of the modern world.”</p>
<p>Linebarger goes on to describe Sun Yat-sen as something of a science fiction writer, teaching his people about alien worlds beyond China. “It was the duty of Sun Yat-sen to persuade a world that it was no world, but a nation; to persuade his fellow-countrymen that their customs and traditions were not the universal laws of reason, but only the peculiarly fine development of one civilization; to teach them that their world, whence patriotic and religious wars had long been banished, had to contend with a narrowing universe which had brought forth other worlds, fantastically different, upon the same globe.”</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/bfa8b895-225c-423c-84d7-0e78655c3ea1.png?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>I had to know more about where this overlap between genre fiction and psychological warfare began. So I delved deeper -- reading histories, interviewing experts and practitioners -- and I found examples of U.S. psyops going back to the nation's earliest days. Two hundred years ago, propagandists were using narrative techniques borrowed from many kinds of popular storytelling: tabloid journalism, fantasy, cowboy stories, adventure tales, comedy, horror. This was a tradition that Linebarger had inherited from generations of Americans before him. In the nineteenth century, for example, popular Western dime novels inspired pundits who pushed "manifest destiny" as a policy. Newspaper accounts justifying the United States' wars on Indigenous nations often read like cowboy adventures set in an unclaimed, virgin land. Using the tropes of popular entertainment helped pro-expansionists sell settlers on the U.S. government policy of coercively relocating hundreds of thousands of people.</p>
<p>In World War II, Linebarger and many of his colleagues advised psywarriors to make their products resemble movies, pulp fiction, radio, and other forms of popular entertainment. They also studied advertising for hints about how to persuade reluctant adversaries, and imitated the language of scientists to make their lies sound trustworthy.&nbsp;</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/b66a7721-1604-4d38-8e82-da34b248cc52.jpg?w=960&amp;fit=max"><figcaption>More of Paul Linebarger's identification cards -- these reflect his positions in the military and overseas.</figcaption></figure>
<p>I think psyops specialists are often cast as secret agents who suppress dissent, cover up the truth, and push mindless conformity. But most of Linebarger's work focused on fomenting revolutionary movements. He wanted his work to inspire ordinary people who feared their struggles against Nazis and dictators were doomed. In 1950, he wrote an unpublished monograph about how to encourage "passive resistance," which he described as "obstruction to authority" that doesn't involve an organized military force. People in such a movement don't plant bombs, he wrote, but "their hostility to authority outweighs their fear of authority." He credited this form of resistance movement with challenging tyranny in Ukraine, China, Japan, and India.</p>
<p>He also compared it to art. "Passive resistance in its more quiet and secret forms is essentially an artistic rather than a scientific undertaking," he wrote.</p>
<figure><img alt="Passive resistance in its more quiet and secret forms is essentially an artistic rather than a scientific undertaking.  It is no use trying to organize such a movement on a disciplined and controlled basis, even though particular elements within it may be subject to real instruction and to real indoctrination. Passive resistance as a whole must be sought in terms of a succession of spontaneous activities, some of which are incited by outside propaganda and some of which arise from the conditions prevailing under the hated regime." contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/e6228e6e-719f-4fa5-80db-195a7b41de88.png?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>He was right. Psyops are an unsung speculative art. Some are brilliant, and others are duds. But they are all attempts to create compelling, emotional stories that offer audiences a new perspective – and inspire them to take action.</p>
<p>Psyops are also, fundamentally, lies -- often with violent overtones. Still, the original 1948 version of <em>Psychological Warfare</em> concludes with a section about "psychological disarmament," where Linebarger imagined a world of psychological truths and peace. Border controls would be abolished, and the government would fund education and public parks, while also guaranteeing a free press.<br></p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/3383e857-05b1-4bf1-80d2-9c480b372d1b.png?w=960&amp;fit=max"><figcaption>Linebarger saved several ration cards from World War II, including this one for tobacco.</figcaption></figure>
<p>As the Cold War escalated, however, he abandoned this serene vision. In <a href="https://www.gutenberg.org/files/48612/48612-h/48612-h.htm?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">the 1954 edition of <em>Psychological Warfare</em></a>, he explained that he had replaced the disarmament chapters with a section on the future of psyops. His implication was that psychological warfare would be permanent, with no ceasefire or peaceful resolution. And, as propaganda production grew more sophisticated, he predicted that more authors would join the cause. "The artistic and cultural aspect of writing is readily converted to propaganda usage," Linebarger wrote in the book's new conclusion.</p>
<p>Throughout his life, Linebarger kept journals of his travels. Often, he would jot down a sentence or two, describing the sounds of aircraft carriers or the way light glinted on the Nile at sunset. And sometimes, those notes showed Linebarger realizing that the United States had its own set of oppressive systems that ought to be resisted.</p>
<figure><img contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/3317848e-35e1-466f-8ed5-f395550a129e.png?w=960&amp;fit=max"><figcaption></figcaption></figure>
<p>In an undated note from the 1950s, Linebarger noted: "The women assistants in Washington (Pentagon) astonish me more and more. One whom I have met has more brains than any of the officers around here."</p>
<p>Unlike most men in his profession at the time, Linebarger frequently acknowledged the contributions of women. Many of his major fictional characters are women, too -- including the heroes C'mel and D'joan, who lead resistance movements against the dictatorial Instrumentality, an interstellar government that looms over much of his work. <a href="https://www.jstor.org/stable/4239639?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">According to his biographer Alan C. Elms</a>, Linebarger had hoped to use the pseudonym Lucy Estes on his first two books, but his publisher convinced him to use a man's name.</p>
<p>I spoke to Linebarger's daughter Rosana Hart, who maintains <a href="http://www.cordwainer-smith.com/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">a website devoted to her father's work</a>. "I think he thought that women were superior to men," she told me. I wondered whether this feeling -- so out-of-step with dominant ideas about women in the 1950s -- might have fueled his urge to generate new identities for himself through writing. Maybe he was searching for a way to express an identity that was more fluid than the one the world allowed him.</p>
<figure><img alt="For your present purposes it does not matter whence, historically, your troubles came. Nor does it matter whether what you think about the origins of your troubles is factually true or not. What does matter is that you swing a searchlight from the vantage point of your watched mind across part of the vast terrain of your unwatched mind and that you find, here or there, the character of the trouble which is interfering in your reasonableness and your happiness. This can be illustrated with an example: You have something between your legs. If you are a man it is a small complicated bag of flesh. If you are a woman it is an inconspicuous but deep wrinkle. Whichever set of genitals it may be, the organ itself is actually surprisingly strong ..." contenteditable="false" draggable="false" src="https://assets.buttondown.email/images/e3332011-ee08-4105-8dde-93830f9e7e79.png?w=960&amp;fit=max"><figcaption>An excerpt from an unpublished manuscript from the mid-1950s, written under the name Carmichael Smith (Linebarger's "crime writer" pseudonym), devoted to what he called "ethical dianetics," or "mutual emotional aid." He points out that one source of "trouble" for human psychology is the fact of our genitals, which cannot be talked about openly.</figcaption></figure>
<p>After I talked to Hart, I kept thinking about Linebarger's fiction as a wrathful exercise in frustrated self-fashioning. There is an undeniable streak of cruelty in Linebarger’s sci-fi stories – he revels in describing intense mental and physical torture, and many of his characters die in gruesome ways. Hart told me that her father believed people should see the ugly side of humanity, in order to understand the truth about the world. When she was a little girl, he made a point of telling her about the horrific things people had done to each other in the wars he’d studied and experienced firsthand. “He would go into more detail about suffering than a child should have had to listen to,” she said.</p>
<p>No matter what Linebarger did, he was always trapped in a cold, liminal space between the worlds of China and the United States, propaganda and art. If he couldn't inhabit the world as it was, perhaps he could use his words to bash a better one into being.</p>
<p>With his book <em>Psychological Warfare</em>, he codified a form of creativity whose purpose is to persuade, but also to intimidate, demoralize, and mislead. He described psyops as an opportunity to aid the oppressed, but also a way to hurt adversaries.</p>
<p>This is the paradox at the heart of all propaganda. Unlike wild storytelling, psyops have a specific purpose: to become a weapon. Perhaps it is forged with the intention of bringing justice to the oppressed. And perhaps its emotional ammunition is aimed at the minds of the vulnerable. Either way, it is a weapon whose power cannot be contained. Like a gun or a tank, it can be transferred from the military into civilian life, exploding our domestic policies, school board meetings, healthcare access, and employment opportunities. And that is what <em>Stories Are Weapons</em> is about: how psyops designed for use against national adversaries became weapons in a culture war between people who live in the United States.</p>
<h2>Pre-order <em>Stories Are Weapons</em> now!</h2>
<p>You can <a href="https://wwnorton.com/books/9780393881516?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">pre-order <em>Stories Are Weapons</em> now</a> from your local indie bookstore! If you'd like a personalized and/or signed copy, you can order it from <a href="https://www.greenapplebooks.com/signed-annalee-newitz?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">Green Apple Bookstore</a> (just write in the "info" field how you would like it personalized).</p>
<p>Pre-orders help tremendously, by sending a signal to stores and my publisher that people are interested in the book -- and that can lead to more exposure for <em>Stories Are Weapons</em>.</p>
<h2>See me on my west coast book tour!</h2>
<p>Mark your calendars and get your tickets now! Here's the schedule (more dates may be added later):</p>
<p>6/4: Powell's Books in Portland (w/Dave Miller, host of OPB's "Think Out Loud")</p>
<p>6/6: Seattle Town Hall (w/Lindy West) -- ticketed event (link coming soon!)</p>
<p>6/13: Mechanics Institute in San Francisco (w/Alexis Madrigal)</p>
<p>6/18: <a href="https://app.gopassage.com/events/stories-are-weapons/event_times/1490223?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">Berkeley Arts &amp; Letters at the Hillside Club in Berkeley</a> (w/Ed Yong) -- ticketed event</p>
<h2>What I've been working on lately</h2>
<p>I reviewed two fascinating books about surveillance <a href="https://www.nytimes.com/2024/02/28/books/review/means-of-control-byron-tau-the-sentinel-state-minxin-pei.html?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">for the <em>New York Times</em>:</a> "The Sentinel State," by Minxin Pei, and "Means of Control" by Byron Tau. Comparing the high tech (and low tech) ways that China and the U.S. spy on their citizens is extremely instructive.</p>
<p>I have a new short story out in the glorious <em>Uncanny Magazine</em>! It's called "<a href="https://www.uncannymagazine.com/article/the-best-ever-cosplay-of-whistle-and-midnight/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">The Best-Ever Cosplay of Whistle and Midnight</a>," and it's about what happens when the biggest worm cosplay convention on the planet Sasky loses its venue. Get ready for interspecies dramas, last-minute costume decisions, and a lucky encounter with a very silly cat who works as a bartender at THE TONGUE FORKS. This story is partly a response to the many people who read <em>The Terraformers</em> and asked me, "What happened to the worms after they were able to speak?" But it's also a standalone tale about what it's like to celebrate your body, no matter what form it takes.</p>
<p>Also, if you are feeling saddened by the rise in Comstockery in the States, just remember that <a href="https://us.macmillan.com/books/9780765392121/thefutureofanothertimeline?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">I wrote a novel about time traveling feminists fighting Comstockers</a> across the timeline to restore reproductive rights in America. Hell yeah!</p>
<p>My <em>New Scientist</em> column comes out monthly, and is now outside the paywall! Check out some recent columns on <a href="https://www.newscientist.com/article/mg26134830-200-is-the-truth-out-there-yes-but-it-doesnt-involve-aliens/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">new ways of analyzing UFO sightings</a>, why the Taylor Swift psyops stories are <a href="https://www.newscientist.com/article/mg26134793-500-the-taylor-swift-psy-op-conspiracy-theory-offers-a-troubling-lesson/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">more dangerous than you think</a>, the <a href="https://www.newscientist.com/article/mg26034712-800-the-weird-tale-of-california-forever-a-tech-billionaire-instant-city/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">unregulated Utopian city</a> that billionaires are secretly trying to build on Northern California farmland, and why <a href="https://www.newscientist.com/article/2403999-trust-and-safety-the-most-important-tech-job-youve-never-heard-of/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">trust and safety</a> is the most important tech job you've never heard of.</p>
<p>And the amazing podcast that I co-host with Charlie Jane Anders, <a href="https://ouropinionsarecorrect.libsyn.com/?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">Our Opinions Are Correct</a>, comes out fortnightly! Check out our recent episode on <a href="https://ouropinionsarecorrect.libsyn.com/queer-horror-with-dr-chuck-tingle?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">queer horror</a> with guest Chuck Tingle, and our <a href="https://ouropinionsarecorrect.libsyn.com/we-failed-the-turing-test-walex-hanna-and-emily-m-bender?utm_source=thehypothesis&amp;utm_medium=email&amp;utm_campaign=how-a-science-fiction-obsession-led-me-to" rel="noopener noreferrer nofollow" target="_blank">evisceration of the Turing Test</a> with the help of AI researchers Alex Hanna and Emily M. Bender!</p>
                    
                

                

            </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Mistral AI Launches New 8x22B MOE Model (211 pts)]]></title>
            <link>https://twitter.com/MistralAI</link>
            <guid>39986095</guid>
            <pubDate>Wed, 10 Apr 2024 01:31:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://twitter.com/MistralAI">https://twitter.com/MistralAI</a>, See on <a href="https://news.ycombinator.com/item?id=39986095">Hacker News</a></p>
Couldn't get https://twitter.com/MistralAI: Error: Request failed with status code 400]]></description>
        </item>
        <item>
            <title><![CDATA[Why does part of the Windows 98 Setup program look older than the rest? (2020) (292 pts)]]></title>
            <link>https://retrocomputing.stackexchange.com/questions/14903/why-does-part-of-the-windows-98-setup-program-look-older-than-the-rest</link>
            <guid>39985630</guid>
            <pubDate>Wed, 10 Apr 2024 00:10:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://retrocomputing.stackexchange.com/questions/14903/why-does-part-of-the-windows-98-setup-program-look-older-than-the-rest">https://retrocomputing.stackexchange.com/questions/14903/why-does-part-of-the-windows-98-setup-program-look-older-than-the-rest</a>, See on <a href="https://news.ycombinator.com/item?id=39985630">Hacker News</a></p>
<div id="readability-page-1" class="page"><div itemprop="text">
<p>Basically, because it is running under Windows 3.1 at that point.</p>
<p>Windows 98’s setup process goes through three main phases, in three different operating environments; each one installs the operating environment for the next, until the installation is complete.</p>
<ol>
<li><p>The first, which can run from the setup floppies and/or CD-ROM, uses a DOS program (<code>DOSSETUP.BIN</code>) to set up disk partitions, run various checks etc.:</p>
<p><a href="https://i.stack.imgur.com/jEOF5.png" rel="noreferrer"><img src="https://i.stack.imgur.com/jEOF5.png" alt="Screenshot of the DOS phase of Windows 98 setup"></a></p>
<p>This phases finishes by copying a minimal version of Windows 3.1 to the target installation drive, in a temporary directory (normally <code>WININST0.400</code>), containing <code>DOSX.EXE</code>, <code>USER.EXE</code>, <code>GDI.EXE</code>, <code>KRNL386.EXE</code>, <code>LZEXPAND.DLL</code> etc. (see <code>MINI.CAB</code>).</p>
</li>
<li><p>The second uses this minimal Windows 3.1 to run a Windows 3 program, <code>W98SETUP.BIN</code> (specified as the “shell” in <code>SYSTEM.INI</code>):</p>
<p><a href="https://i.stack.imgur.com/O9Lcv.png" rel="noreferrer"><img src="https://i.stack.imgur.com/O9Lcv.png" alt="Screenshot of the Windows 3 phase of Windows 98 setup"></a></p>
<p>This starts by copying more files to support all the information-gathering during setup, and various other niceties including the 3D look shown in your screenshot (the contents of the <code>PRECOPY</code> CABs); it ends by copying most of Windows 98, setting the system up so that it will boot Windows 98 from the target drive, and rebooting.</p>
</li>
<li><p>The third runs after the first boot into Windows 98, from Windows 98:</p>
<p><a href="https://i.stack.imgur.com/MWn8z.png" rel="noreferrer"><img src="https://i.stack.imgur.com/MWn8z.png" alt="Screenshot of the Windows 98 phase"></a></p>
</li>
</ol>
<p>Many PCs with Windows 98 pre-installed were shipped in a variant of the state left at the end of the second phase above; the third phase starts with a “Starting Windows 98 for the first time” message, and follows that up by asking the user for their name and company name. Thus PC buyers got a system pre-installed, but ready to be personalised.</p>
<p>You can interrupt setup at any point, or inspect the image during installation in an emulator, to see what’s present on the disk and thus determine the runtime environment.</p>
<p>It is also possible to initiate the setup process from any of the above environments, which is how Windows 98 handles upgrades (from MS-DOS, or Windows 3, or Windows 95).</p>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[GPT-4 Turbo with Vision is a step backwards for coding (160 pts)]]></title>
            <link>https://aider.chat/2024/04/09/gpt-4-turbo.html</link>
            <guid>39985596</guid>
            <pubDate>Wed, 10 Apr 2024 00:03:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://aider.chat/2024/04/09/gpt-4-turbo.html">https://aider.chat/2024/04/09/gpt-4-turbo.html</a>, See on <a href="https://news.ycombinator.com/item?id=39985596">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content" role="main">
      

<p><a href="https://twitter.com/OpenAIDevs/status/1777769463258988634">OpenAI just released GPT-4 Turbo with Vision</a>
and it performs worse on aider’s coding benchmark suites than all the previous GPT-4 models.
In particular, it seems much more prone to “lazy coding” than the
existing GPT-4 Turbo “preview” models.</p>

<h2 id="code-editing-skill">Code editing skill</h2>

<p><a href="https://aider.chat/assets/2024-04-09-gpt-4-turbo.svg"><img src="https://aider.chat/assets/2024-04-09-gpt-4-turbo.svg" alt="benchmark results"></a></p>

<p>Aider relies on a
<a href="https://aider.chat/docs/benchmarks.html#the-benchmark">code editing benchmark</a>
to quantitatively evaluate how well
an LLM can make changes to existing code.
The benchmark uses aider to try and complete
<a href="https://github.com/exercism/python">133 Exercism Python coding exercises</a>.</p>

<p>For each exercise, the LLM gets two tries to solve each problem:</p>

<ol>
  <li>On the first try, it gets initial stub code and the English description of the coding task. If the tests all pass, we are done.</li>
  <li>If any tests failed, aider sends the LLM the failing test output and gives it a second try to complete the task.</li>
</ol>

<p><strong>GPT-4 Turbo with Vision
scores only 62% on this benchmark,
the lowest score of any of the existing GPT-4 models.</strong>
The other models scored 63-66%, so this represents only a small
regression, and is likely statistically insignificant when compared
against <code>gpt-4-0613</code>.</p>

<h2 id="lazy-coding">Lazy coding</h2>

<p><a href="https://aider.chat/assets/2024-04-09-gpt-4-turbo-laziness.svg"><img src="https://aider.chat/assets/2024-04-09-gpt-4-turbo-laziness.svg" alt="benchmark results"></a></p>

<p>The GPT-4 Turbo “preview” models have been widely criticized for being “lazy”
when coding.
They often omit needed code
and instead leave comments with homework assignments like “implement method here”.</p>

<div><pre><code>def some_complex_method(foo, bar):
    # ... implement method here ...
</code></pre></div>

<p>Aider uses a <a href="https://github.com/paul-gauthier/refactor-benchmark">“laziness” benchmark suite</a>
which is designed to both provoke and quantify lazy coding.
It consists of
89 python refactoring tasks
which tend to make GPT-4 Turbo code in that lazy manner.</p>

<p><strong>The new GPT-4 Turbo with Vision model scores only 34% on aider’s
refactoring benchmark, making it the laziest coder of all the GPT-4 Turbo models
by a significant margin.</strong></p>

<h2 id="conclusions">Conclusions</h2>

<p>Aider has full support for the new GPT-4 Turbo with Vision
model, which you can access using the switch <code>--model gpt-4-turbo-2024-04-09</code>.
But aider will continue to use <code>gpt-4-1106-preview</code> by default,
as it is by far the strongest coder of the GPT-4 models.</p>



      
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[My deployment platform is a shell script (121 pts)]]></title>
            <link>https://j3s.sh/thought/my-deployment-platform-is-a-shell-script.html</link>
            <guid>39985249</guid>
            <pubDate>Tue, 09 Apr 2024 22:58:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://j3s.sh/thought/my-deployment-platform-is-a-shell-script.html">https://j3s.sh/thought/my-deployment-platform-is-a-shell-script.html</a>, See on <a href="https://news.ycombinator.com/item?id=39985249">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
  <p><small><a href="https://j3s.sh/thoughts.html">↵return</a></small>
  </p><p>my deployment platform is a shell script</p>
  <p><b>
    <img height="30" src="https://j3s.sh/static/unnamed-puffy.png" alt="another pufferfish drawn by rekka">
  </b>
</p></div>
<p>my deployment platform is a shell script
2024-04-09

like many people, i fell in love with free software
because i could install it. i'd come home from work and
install a bunch of software.

what fun! tee hee! a playground and i'm the prince!

but eventually, relentlessly, it all starts to feel more
like a horror show.

proxmox needs an upgrade! *SPOOKY WIND*
how the fuck does k8s work again?? *SPOOKY CRICKETS*
promql *EXISTENTIAL SCREAM*


i'm too old now - i'm more fickle with my time. i like
things that work for years with as little interaction
from me as possible.

when it comes to my own projects, i always prioritize
maintainability.

to that end, i built a little deployment system that i
run on a single virtual machine - it's a shell script!

i run it every minute via cron.

here's the script, in its entirety:

  #!/bin/sh

  println() {
    printf "%s\n" "$1" &gt;&gt; /root/gocicd.log
  }

  die() {
    printf "%s\n" "$1" &gt;&gt; /root/gocicd.log
    exit 1
  }

  cd /root
  for project in $(ls go-cicd); do
    cd "/root/go-cicd/$project" 2&gt;&amp;1 &gt;&gt; /root/gocicd.log
    git fetch origin 2&gt;&amp;1 &gt;&gt; /root/gocicd.log
    if git status | grep -q behind; then
      println "$(date): building $project"
      git merge origin/main ||
        git merge origin/master ||
	  die "could not merge $project"
      go build ||
        die "could not build $project"
      mv "$project" "/usr/local/bin/$project"
      cat &lt;&lt;EOF &gt;/etc/init.d/$project"
      #!/sbin/openrc-run

      supervisor="supervise-daemon"
      command="/usr/local/bin/$project"
      directory="/root/go-cicd/$project"
      EOF
      service "$project" restart
    fi
  done

whenever i make an upstream change to any of my tracked
projects, it is cloned, built, and running within 60
seconds.

this gives me a lot of joy. the blog post you're reading
right now was deployed using this system (j3s.sh is a go
application).

this has worked for many years with no maintenance at
all!

my script will never:
  - go down
  - require an upgrade
  - force me to migrate
  - surprise me
  - keep me up at night

all of this makes jes very happy.


digging in a little, the contents of the go-cicd dir look like this:

  $ ls go-cicd/
  existentialcrisis.sh  jackal                nekobot
  j3s.sh                vore                  neoarkbot

these are all of my "tracked projects".

to start tracking a new project, i only need to clone a
repository:

  $ cd go-cicd
  $ git clone git.j3s.sh/newproject

now whenever a new commit is made to
git.j3s.sh/newproject, it is deployed within 60 seconds.

ez.

here's a little taste of the log file:

  $ tail -n 5 go-cicd.log
  Thu Feb  8 00:13:12 UTC 2024: building vore
  Fri Feb  9 22:08:25 UTC 2024: building vore
  Mon Apr  8 02:07:00 UTC 2024: building j3s.sh
  Mon Apr  8 02:59:00 UTC 2024: building j3s.sh
  Tue Apr  9 21:11:00 UTC 2024: building vore

cool! i wonder what happened in march.
(oh, i moved to Virginia, right)


i recognize that this script is pretty limited. it can
only deploy golang applications to my alpine system, but
that's exactly the point i'm trying to prove:

a little, specific solution might be  easier to maintain
and straight up more enjoyable than a larger, more
general system.

i spent maybe 10 minutes writing this script in December
of 2021, and i'm proud of how reliable it has been.

consider keeping your little things little.

it worked for little old me.


until next time, with love from virginia,


  lil jes

</p><p>follow me on <a href="https://merveilles.town/@j3s">mastodon!</a>
</p><p>last updated 2024-04-09T00:00:00.000Z

</p></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Building Reliable Systems Out of Unreliable Agents (269 pts)]]></title>
            <link>https://www.rainforestqa.com/blog/building-reliable-systems-out-of-unreliable-agents</link>
            <guid>39984209</guid>
            <pubDate>Tue, 09 Apr 2024 21:01:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.rainforestqa.com/blog/building-reliable-systems-out-of-unreliable-agents">https://www.rainforestqa.com/blog/building-reliable-systems-out-of-unreliable-agents</a>, See on <a href="https://news.ycombinator.com/item?id=39984209">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>If you’ve tried building real-world features with AI, chances are that you’ve experienced reliability issues. It’s common knowledge that AI makes for great demos, but…&nbsp;<em>questionable</em>&nbsp;products. After getting uncannily correct answers at first, you get burned on reliability with some wild output and decide you can’t make anything useful out of that.</p><p>Well, I’m here to tell you that there’s hope. Even though AI agents are&nbsp;not&nbsp;reliable, it&nbsp;is&nbsp;possible to build reliable systems out of them.</p><p>These learnings come from a years-long process of creating&nbsp;<a href="https://www.rainforestqa.com/" target="_blank" rel="noreferrer noopener">a QA AI</a>. While building, we found a process that worked pretty well for us and we’re sharing it here. As a summary, it consists of these high-level steps:</p><ul><li>Write simple prompts to solve your problem</li><li>Use that experience to build an eval system to do prompt engineering and improve performance in a principled way</li><li>Deploy your AI system with good observability, and use that signal to keep gathering examples and improving your evals</li><li>Invest in Retrieval Augmented Generation (RAG)</li><li>Fine-tune your model using the data you gathered from earlier steps</li></ul><p>Having worked on this problem for a while, I think these are the best practices every team should adopt. But there’s an additional approach we came up with that gave us a breakthrough in reliability, and it might be a good fit for your product, too:</p><ul><li>Use complementary agents</li></ul><p>The principle behind this step is simple: it’s possible to build&nbsp;systems&nbsp;of complementary agents that work much more reliably than a single agent. More on that later.</p><p>Before we jump in, a note on who this is for: you don’t need much AI experience to follow the process we lay out here. In fact, most of our team while building our QA agent didn’t have previous AI or ML experience. A solid software engineering background, however, is super helpful — a sentiment <a href="https://twitter.com/gdb/status/1729893902814192096" target="_blank" rel="noreferrer noopener">echoed</a> by well-known people in the industry. Particularly, thinking deeply about how to test what you’re building and constantly finding ways to optimize your workflow are really important.</p><div id="ez-toc-container"><nav><ul><li><a href="#Start_with_simple_prompts" title="Start with simple prompts">Start with simple prompts</a></li><li><a href="#Use_an_eval_system_to_do_prompt_engineering" title="Use an eval system to do prompt engineering">Use an eval system to do prompt engineering</a></li><li><a href="#Improve_with_observability" title="Improve with observability">Improve with observability</a></li><li><a href="#Invest_in_RAG" title="Invest in RAG">Invest in RAG</a></li><li><a href="#Fine-tune_your_model" title="Fine-tune your model">Fine-tune your model</a></li><li><a href="#Use_complementary_agents" title="Use complementary agents">Use complementary agents</a></li><li><a href="#Final_notes" title="Final notes">Final notes</a></li></ul></nav></div><h2><span id="Start_with_simple_prompts"></span>Start with simple prompts<span></span></h2><p>The most obvious way to start using an LLM to solve a problem is simply asking it to do the thing in your own words. This approach often works well enough at the beginning to give you hope, but starts falling down as soon as you want any reliability. The answers you get might be mostly correct, but not good enough for production. And you’ll quickly notice scenarios where the answers are consistently wrong.</p><p>The best LLMs today are amazing generalists, but not very good specialists — and generally, you want specialists to solve your business problems. They need to have enough general knowledge to not be tedious, but at the same time they need to know how exactly to handle the specifics in the gray areas of your problem space.</p><p>Let’s take a trivial example: you want to get a list of ingredients needed to prepare different things to eat. You start with the first thing that comes to mind:</p><figure><img loading="lazy" decoding="async" width="916" height="1024" src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-916x1024.jpg" alt="" srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-916x1024.jpg 916w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-268x300.jpg 268w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-768x858.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-1374x1536.jpg 1374w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2.jpg 1426w" sizes="(max-width: 916px) 100vw, 916px" data-old-src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20916%201024'%3E%3C/svg%3E" data-lazy-srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-916x1024.jpg 916w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-268x300.jpg 268w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-768x858.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-1374x1536.jpg 1374w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2.jpg 1426w" data-lazy-src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj1-2-916x1024.jpg"></figure><p>This is good — the list of ingredients is right there. But there’s also a bunch of other stuff that you don’t need. For example, you might use the same knife for both jars and not care for being lectured about ‌knife hygiene. You can fiddle with the prompt pretty easily:</p><div><figure><img loading="lazy" decoding="async" width="1024" height="638" src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-1024x638.jpg" alt="" srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-1024x638.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-300x187.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-768x478.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2.jpg 1362w" sizes="(max-width: 1024px) 100vw, 1024px" data-old-src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20638'%3E%3C/svg%3E" data-lazy-srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-1024x638.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-300x187.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-768x478.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2.jpg 1362w" data-lazy-src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj2-2-1024x638.jpg"></figure></div><p>Better, but there’s still some unnecessary commentary there. Let’s have another shot:</p><div><figure><img loading="lazy" decoding="async" width="1024" height="442" src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-1024x442.jpg" alt="" srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-1024x442.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-300x130.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-768x332.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2.jpg 1172w" sizes="(max-width: 1024px) 100vw, 1024px" data-old-src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20442'%3E%3C/svg%3E" data-lazy-srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-1024x442.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-300x130.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-768x332.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2.jpg 1172w" data-lazy-src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj3-2-1024x442.jpg"></figure></div><p>OK, I guess that’ll do. Now we just need to make it JSON so we can integrate it with the rest of our product. Also, just to be safe, let’s run it a few times to make sure it’s reliable:</p><div><figure><img loading="lazy" decoding="async" width="1024" height="572" src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-1024x572.jpg" alt="" srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-1024x572.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-300x167.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-768x429.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2.jpg 1394w" sizes="(max-width: 1024px) 100vw, 1024px" data-old-src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20572'%3E%3C/svg%3E" data-lazy-srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-1024x572.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-300x167.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-768x429.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2.jpg 1394w" data-lazy-src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj4-2-1024x572.jpg"></figure></div><div><figure><img loading="lazy" decoding="async" width="1024" height="619" src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-1024x619.jpg" alt="" srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-1024x619.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-300x181.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-768x464.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2.jpg 1396w" sizes="(max-width: 1024px) 100vw, 1024px" data-old-src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20619'%3E%3C/svg%3E" data-lazy-srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-1024x619.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-300x181.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-768x464.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2.jpg 1396w" data-lazy-src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj5-2-1024x619.jpg"></figure></div><div><figure><img loading="lazy" decoding="async" width="1024" height="587" src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-1024x587.jpg" alt="" srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-1024x587.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-300x172.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-768x440.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2.jpg 1378w" sizes="(max-width: 1024px) 100vw, 1024px" data-old-src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%201024%20587'%3E%3C/svg%3E" data-lazy-srcset="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-1024x587.jpg 1024w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-300x172.jpg 300w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-768x440.jpg 768w, https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2.jpg 1378w" data-lazy-src="https://www.rainforestqa.com/blog/wp-content/uploads/2024/04/pbj6-2-1024x587.jpg"></figure></div><p>As you can see, we’re reliably getting JSON out, but it’s not consistent: the capitalization of the keys and what’s included in each value varies. These specific problems are easy to deal with and even this might be good enough for your use case, but we’re still far from the reliable and reproducible behavior we’re looking for.</p><h3>Minimum necessary product integration</h3><p>At this point, it’s time to integrate a minimal version of your “AI component” with your product, so the next step is to start using the API instead of the console. Grab your favorite LLM-provider client (or just use their API — there are <a href="https://x.com/simonw/status/1728141822063767857?s=20" target="_blank" rel="noreferrer noopener">some good reasons to stick with HTTP</a>) and integrate it into your product in the most minimal way possible. The point is to start building out the infrastructure, knowing that the results won’t be great yet.</p><p>Some cheat codes at this point, based on my experience:</p><ul><li>If you use <code>mypy</code>, you might be tempted to use strongly-typed inputs when interacting with the client (e.g., the OpenAI client), but my advice would be: don’t. While I like having <code>mypy</code> around, it’s much easier to work with plain dictionaries to build your messages and you’re not risking a lot of bugs.</li><li>In my experience, it’s a good idea to set <code>temperature=0.0</code> in all your model calls if you care about reliability. You still won’t get perfect reproducibility, but it’s usually the best place to start your explorations.</li><li>If you’re thinking about using a wrapper like <a href="https://github.com/jxnl/instructor" target="_blank" rel="noreferrer noopener"><code>instructor</code></a> to get structured data out of the LLM: it’s <em>really</em> cool and makes some use-cases very smooth, but also makes your code a little less flexible. I’d usually start without it and then bring it in at a later point, once I’m confident in the shape of my data.</li></ul><h2><span id="Use_an_eval_system_to_do_prompt_engineering"></span>Use an eval system to do prompt engineering<span></span></h2><p>The first thing you should try after the naive “ask a simple question” approach is prompt engineering. While the phrase is common, I don’t think many people have an accurate definition of what “prompt engineering” actually means, so let’s define it first.</p><p>When I say “prompt engineering,” I mean something like, “iterative improvement of a prompt based on measurable success criteria”, where “iterative” and “measurable success criteria” are the key phrases. (I like&nbsp;<a href="https://mitchellh.com/writing/prompt-engineering-vs-blind-prompting" target="_blank" rel="noreferrer noopener">this post</a>&nbsp;from last year as an early attempt to define this.) The key is to have some way of determining whether an answer you get from an LLM is correct and then measuring correctness across examples to give you a number you can compare over time.</p><p>Create an evaluation loop so you have a way of checking any change you make, and then make that loop as fast as it can be so you can iterate effectively. For an overview of how to think about your eval systems, see&nbsp;<a href="https://hamel.dev/blog/posts/evals/" target="_blank" rel="noreferrer noopener">this excellent blog post</a>.</p><h3>Evaluating when there are multiple correct answers</h3><p>This whole procedure rhymes with “testing” and “collecting a validation set,” except for any given question there might be multiple correct answers, so it’s not obvious how to do this. Here are some situations and how to deal with them:</p><ul><li>It’s possible to apply deterministic transformations on the output of the LLM before you compare it to the “known good” answer. An example might be the capitalization issue from earlier, or maybe you only ever want three first words as an output. Running these transformations will make it trivial to compare what you get with what you expect.</li><li>You might be able to use some heuristics to validate your output. E.g., if you’re working on summarization, you might be able to say something like “to summarize this story accurately, the following words are absolutely necessary” and then get away with doing string matching on the response.</li><li>Maybe you need the output in a certain format. E.g., you’re getting function calls or their arguments from an LLM or you’re expecting country codes or other well-defined outputs. In these cases, you can validate what you get against a known schema and retry in case of errors. In practice, you can use something like&nbsp;<a href="https://github.com/jxnl/instructor" target="_blank" rel="noreferrer noopener">instructor</a> — if you’re comfortable with the constraints it imposes, including around code flexibility — and then you’re left with straightforwardly comparing structured data.</li><li>In a true Inception fashion, you might want to use a simpler, smaller, and cheaper LLM to evaluate the outputs of your big-LLM-using-component. Comparing two differently-written, but equivalent lists of ingredients is an easy task even for something like GPT 3.5 Turbo. Just keep in mind: even thought it’s pretty reliable, you’re now introducing <em>some</em> flakiness into your test suite. Trade-offs!</li><li>To evaluate an answer, you might have to “execute” the entire set of instructions the agent gives you and check if you’ve reached the goal. This is more complex and time-consuming, but sometimes the only way. For example, we often ask an agent to achieve a goal inside a browser by outputting a series of instructions that might span multiple screens. The only way for us to check its answer is to execute the instructions inside Playwright and run some assertions on the final state.</li></ul><h3>Building your validation set</h3><p>Once you have your evaluation loop nailed down, you can build a validation set of example inputs and the corresponding outputs you’d like the agent to produce.</p><p>As you evaluate different strategies and make changes to your prompts, it’s ideal if you have a single metric to compare over time. Something like “% prompts answered correctly” is the most obvious, but something like precision/recall might be more informative depending on your use case.</p><p>It’s also possible you won’t be able to use a single metric if you’re evaluating fuzzy properties of your answers, in which case you can at least look at what breaks after each change and make a judgment call.</p><h3>Prompt engineering tricks</h3><p>Now’s your chance to try all the prompt engineering tricks you’ve heard about. Let’s cover some of them!</p><p>First of all, provide all the context you’d need to give to an intelligent human operator who’s unfamiliar with the nuances and requirements of the task. This is a necessary (but not sufficient!) condition to making your system work. E.g., if you know you absolutely always want some salted butter under your peanut butter, you need to include that information in your prompt.</p><p>If you’re not getting the correct responses, ask the agent to think step-by-step before providing the actual answer. This can be a little tricky if you’re expecting structured data out — you’ll have to somehow give the agent a way to do some reasoning&nbsp;<em>before</em> it makes any consequential decisions and locks itself in.</p><p>E.g., if you use the <a href="https://platform.openai.com/docs/api-reference/chat/create#chat-create-tools" target="_blank" rel="noreferrer noopener">tool-calling API</a>, which is really nifty, you might be tempted to tell the agent to do some chain-of-thought reasoning by having a JSON schema similar to this:</p><pre><code>[
    {
        "type": "function",
        "function": {
            "name": "scoop_out",
            "description": "scoop something out",
            "parameters": {
                "type": "object",
                "properties": {
                    "chain_of_thought": {
                        "type": "string",
                        "description": "the reasoning for this action"
                    },
                    "jar": {
                        "type": "string",
                        "description": "the jar to scoop out of"
                    },
                    "amount": {
                        "type": "integer",
                        "description": "how much to scoop out"
                    }
                },
                "required": ["chain_of_thought", "jar","amount"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "spread",
            "description": "spread something on a piece of bread",
            "parameters": {
                "type": "object",
                "properties": {
                    "chain_of_thought": {
                        "type": "string",
                        "description": "the reasoning for this action"
                    },
                    "substance": {
                        "type": "string",
                        "description": "what to spread"
                    }
                },
                "required": ["chain_of_thought", "substance"]
            }
        }
    }
]</code></pre><p>Unfortunately, this will make the agent output the function name <em>before</em> it produces the chain-of-thought, locking it into the early decision and defeating the whole point. One way to get around this is to pass in the schema with the available functions, but ask the agent to output a JSON that wraps the function spec, similar to this:</p><pre><code>You are an assistant helping prepare food. Given a dish name, respond with a JSON object of the following structure:

{{
    "chain_of_thought": "Describe your reasoning for the next action",
    "function_name": "scoop_out" | "spread",
    "function_args": {{
        &lt; appropriate arguments for the function &gt;
    }}
}}</code></pre><p>This has fewer guarantees, but works well enough in practice with GPT 4 Turbo.</p><p>Generally, chain-of-thought has a speed/cost vs. accuracy trade-off, so pay attention to your latencies and token usage in addition to correctness.</p><p>Another popular trick is <em>few-shot prompting</em>. In many cases, you’ll get a noticeable bump in performance if you include a few examples of questions and their corresponding answers in your prompt, though this isn’t always feasible. E.g., your actual input might be so large that including more than a single “shot” in your prompt isn’t practical.</p><p>Finally, you can try offering the agent a bribe or telling it something bad will happen if it answers incorrectly. We didn’t find these tactics worked for us, but they might for you — they’re worth trying, assuming you trust your eval process.</p><p>Every trick from the ones listed above will change things: some things will hopefully get better, but it’s likely you’ll break something else at the same time. It’s really important you have a representative set of examples that you can work with, so commit to spending time on building it.</p><h2><span id="Improve_with_observability"></span>Improve with observability<span></span></h2><p>At this point, you’ll likely have something that’s good enough to deploy as an alpha-quality product. Which you should absolutely do as soon as you can so you can get real user data and feedback.</p><p>It’s important you’re open about where your system is in terms of robustness, but it’s impossible to overstate the value of users telling you what they think. It’s tempting to get everything working correctly before opening up to users, but you’ll hit a point of diminishing returns without real user feedback. This is an absolutely necessary ingredient to making your system better over time — don’t skip it.</p><p>Before release, just make sure your observability practices are solid. From my perspective, this basically means logging all of your LLM input/output pairs so you can a) look at them and learn what your users need and b) label them manually to build up your eval set.</p><p>There a many options to go with here, from big monitoring providers you might already be using to open-source libraries that help you trace your LLM calls. Some, like <a href="https://github.com/traceloop/openllmetry" target="_blank" rel="noreferrer noopener">openllmetry</a> and <a href="https://github.com/Arize-ai/openinference" target="_blank" rel="noreferrer noopener">openinference</a> even use the OpenTelemetry under the hood, which seems like a great idea. I haven’t seen a tool focused on labeling the data you’ve gathered and turning it into a validation set, however, which is why we built our own solution: store some JSON files in S3 and have a web interface to look at and label them. It doesn’t have as many bells and whistles as off-the-shelf options, but it’s enough for what we need at the moment.</p><h2><span id="Invest_in_RAG"></span>Invest in RAG<span></span></h2><p>Once you’ve exhausted all your prompt-engineering tricks and you feel like you’re out of ideas and your performance is at a plateau, it might be time to invest in a RAG pipeline. Roughly, RAG is runtime prompt engineering where you build a system to dynamically add relevant things to your prompt before you ask the agent for an answer.</p><p>An example might be answering questions about very recent events. This isn’t something LLMs are good at, because they’re not usually retrained to include the latest news. However, it’s relatively straightforward to run a web search and include some of the most relevant news articles in your prompt before asking the LLM to give you the answer. If you have relevant data of your own you can leverage, it’s likely to give you another noticeable improvement.</p><p>Another example from our world: we’ve got an agent interacting with the UI of an application based on plain-English prompts. We also have more than ten years worth of data from our clients writing testing prompts in English and our crowd of human testers executing those instructions. We can use this data to tell the agent something like “it looks like most human testers executing similar tasks clicked on button X and then typed Y into field Z” to guide it.</p><p>Retrieval is great and very powerful, but it has real trade-offs, complexity being the main one. Again, there are many options: you can roll your own solution, use an external provider, or have some combination of the two (e.g., using <a href="https://platform.openai.com/docs/guides/embeddings/how-to-get-embeddings" target="_blank" rel="noreferrer noopener">OpenAI’s embeddings</a> and <a href="https://github.com/pgvector/pgvector" target="_blank" rel="noreferrer noopener">storing the vectors in your Postgres</a> instance).</p><p>A particular library that looked great (a little more on the do-it-yourself end of the spectrum) is <a href="https://github.com/bclavie/RAGatouille" target="_blank" rel="noreferrer noopener">RAGatouille</a>, but I wasn’t able to make it work and gave up after a couple of hours. In the end, we used BigQuery to get data out, OpenAI for producing embeddings, and <a href="https://pinecone.io/" target="_blank" rel="noreferrer noopener">Pinecone</a> for storage and nearest-neighbor search because that was the easiest way for us to deploy something without setting up a lot of new infrastructure. Pinecone makes it very easy to store and search through embeddings with their associated metadata to augment your prompts.</p><p>There’s more we can do here — we didn’t evaluate any alternative embedding engines, we only find top-3 related samples, and get limited data out of those samples currently. Looking at alternative embeddings, including more samples, and getting more details information about each sample is something we plan to look at in the future.</p><p>You can spend quite a while on this level of the ladder. There’s a lot of room for exploration. If you exhaust all the possibilities and ways of building your pipeline, still aren’t getting good enough results and can’t think any more sources of useful data, it’s time to consider fine-tuning.</p><h2><span id="Fine-tune_your_model"></span>Fine-tune your model<span></span></h2><p>Now we’re getting to the edges of the known universe. If you’ve done everything above: created an eval system, shipped an AI product, observed it running in production, got real user data, and even have a useful RAG pipeline, then congratulations! You’re on the bleeding edge of applied AI.</p><p>Where to go from here is unclear. Fine-tuning a model based on the data you’ve gathered so far seems like the obvious choice. But beware — I’ve heard conflicting opinions in the industry about the merits of fine-tuning relative to the effort required.</p><p>It&nbsp;<em>seems</em>&nbsp;like it should work better, but there are unresolved practical matters: OpenAI <a href="https://platform.openai.com/docs/guides/fine-tuning/fine-tuning">only allows you to fine-tune older models</a>, and <a href="https://docs.anthropic.com/claude/docs/glossary#fine-tuning">Anthropic is kind of promising to make it available</a> soon with a bunch of caveats.</p><p>Fine-tuning and hosting your own models is a whole different area of expertise. Which model do you choose as the base? How do you gather data for fine-tuning? How do you evaluate any improvements? And so on. In the case of self-hosted models, I’d caution against hoping to save money vs. hosted solutions — you’re very unlikely to have the expertise and the economies of scale to get there, even if you choose smaller models.</p><p>My advice would be to wait a few months for the dust to settle a bit before investing here, unless you’ve tried everything else already and still aren’t getting good-enough results. We haven’t had to do this so far because we still haven’t exhausted all the possibilities mentioned above, so we’re postponing the increase in complexity.</p><h2><span id="Use_complementary_agents"></span>Use complementary agents<span></span></h2><p>Finally, I want to share a trick that might be applicable to your problem, but is sort of independent of the whole process described above — you can apply it at any of the stages I’ve described.</p><p>It involves a bit of a computation vs. reliability trade-off: it turns out that in many situations it’s possible to throw more resources at a problem to get better results. The only question is: can you find a balance that’s both fast and cheap enough while being accurate enough?</p><p>You’ll often feel like you’re playing whack-a-mole when trying to fix specific problems with your LLM prompts. For instance, I often find there’s a tension between creating the correct high-level plan of execution and the ability to‌ precisely execute it. This reminded me of the idea behind&nbsp;<a href="https://blog.gardeviance.org/2015/03/on-pioneers-settlers-town-planners-and.html" target="_blank" rel="noreferrer noopener">“pioneers, settlers, and city planners”</a>: different people have different skills and approaches and thrive in different situations. It’s rare for a single person to both have a good grand vision and to be able to precisely manage the vision’s execution.</p><p>Of course, LLMs aren’t people, but some of their properties make the analogy work. While it’s difficult to prompt your way to an agent that always does the right thing, it’s much easier to plan what’s needed and create a team of specialists that complement each other.</p><p>I’ve seen a similar approach called an “ensemble of agents,” but I prefer “complementary agents” for this approach because it highlights that the agents are meaningfully different and support each other in ways that identical agents couldn’t.</p><p>For example, to achieve a non-obvious goal, it helps to create a high-level plan first, before jumping into the details. While creating high-level plans, it’s useful to have a very broad and low-resolution view of the world without getting bogged down by details. Once you have a plan, however, executing each subsequent step is much easier with a narrow, high-resolution view of the world. Specific details can make or break your work, and at the same time, seeing irrelevant information can confuse you. How do we square this circle?</p><p>One answer is creating teams of complementary agents to give each other feedback. LLMs are pretty good at correcting themselves if you tell them what they got wrong, and it’s not too difficult to create a “verifier” agent that checks specific aspects of a given response.</p><p>An example conversation between “high level planner” and “verifier” agents might look something like the following:</p><pre><code>Planner
OK, we need to make a PB&amp;J sandwich! To do that, we need to get some peanut
butter, some jelly and some bread, then take out a plate and a knife.

Verifier
Cool, that sounds good.

Planner
OK, now take the peanut butter and spread it on the bread.

Verifier
(noticing there's no slice of bread visible) Wait, I can't see the bread in
front of me, you can't spread anything on it because it's not there.

Planner
Ah, of course, we need to take the slice of bread out first and put it on a
plate.

Verifier
Yep, that seems reasonable, let's do it.
</code></pre><p>The two agents complement each other, and neither can work on its own. Nobody is perfect, but we can build a reliable system out of flawed pieces if we’re thoughtful about it.</p><h3>How we’re using complementary agents</h3><p>This is exactly what we did for our testing agents: there’s a planner and a verifier. The planner knows the overall goal and tries to achieve it. It’s creative and can usually find a way to get to the goal even if it isn’t immediately obvious. E.g., if you ask it to click on a product that’s not on the current page, it’ll often use the search functionality to look for the product. But sometimes the planner is <em>too</em> optimistic and wants to do things that seem like they should be possible, but in fact aren’t.</p><p>For example, it might want to click on a “Pay now” button on an e-commerce checkout page, because the button <em>should</em> be there, but it’s just below the fold and not currently visible. In such cases, the verifier (who doesn’t know the overall goal and is only looking at the immediate situation) can correct the planner and point out that the concrete task we’re trying to do right now isn’t possible.</p><h2><span id="Final_notes"></span><strong>Final notes</strong><span></span></h2><p>Putting all this together again, we now have a pretty clear process for building LLM-based products that deal with their inherent unreliability.</p><p>Making something usable in the real world still isn’t a well-explored area, and things are changing really quickly, so you can’t follow well-explored paths. It’s basically applied research, rather than pure engineering. Still, having a clear process to follow while you’re iterating will make your life easier and allow you to set the right expectations at the start.</p><p>The process I’ve described should follow a step-by-step increase in complexity, starting with naive prompting and finally doing RAG and possibly fine-tuning. At each step, evaluate whether the increased complexity is worth it — you might get good-enough results pretty early, depending on your use case. I bet getting through the first four steps will be enough to handle most of your problems.</p><p>Keep in mind that this is going to be a very iterative process — there’s no way to design and build AI systems in a single try. You won’t be able to predict what works and how your users will bend your tool, so you absolutely need their feedback. You’ll build the first, inadequate version, use it, notice flaws, improve it, release it more widely, etc. And if you’re successful and build something that gets used, your prize will be more iterations and improvements. Yay!</p><p>Also, don’t sweat having a single, optimizable success metric too much. It’s the ideal scenario, but it might take you a while to get to that point. Despite having a collection of tests and examples, we still rely “vibe checks” when evaluating whether a new prompt version is an improvement. Just counting passing examples might not be enough if some examples are more important than others.</p><p>Finally, try the “complementary agents” trick to work around weaknesses you notice. It’s often very difficult to make a single agent do the right thing reliably, but detecting the wrong thing so you can retry tends to be easier.</p><h3>What’s next for us</h3><p>There’s still a bunch of things that we’re planning to work on in the coming months, so our product won’t be static. I don’t expect, however, to deviate much from the process we described here. We’re continuously speaking with our customers and monitoring how our product is being used and finding edge cases to fix. We’re also certainly not at the global optimum when it comes to reliability, speed, and cost, so we’ll continue experimenting with alternative models, providers, and ways of work.</p><p>Specifically, I’m really intrigued by the latest Anthropic models (e.g., what can we usefully do with a small model like Haiku, which still has vision capabilities?) and I’m deeply intrigued by the ideas <a href="https://github.com/stanfordnlp/dspy">DSPy</a> is promoting. I suspect there are some unrealized wins in the way we structure our prompts.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The challenges of building modern open source software on PowerPC Mac OS X (101 pts)]]></title>
            <link>http://www.netbsd.org/~nia/tigersrc/</link>
            <guid>39983915</guid>
            <pubDate>Tue, 09 Apr 2024 20:30:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="http://www.netbsd.org/~nia/tigersrc/">http://www.netbsd.org/~nia/tigersrc/</a>, See on <a href="https://news.ycombinator.com/item?id=39983915">Hacker News</a></p>
<div id="readability-page-1" class="page">
<h2>Unix software from pkgsrc for Mac OS X 10.4 (PowerPC Tiger)</h2>
<h2>Introduction</h2>
<p>
PowerPC Macs were produced in huge numbers, and a lot of this hardware
is still viable for use today, with professional software such as
Photoshop CS2 and Propellerheads Reason. They're still good
workstations, with lots of productivity software,
and no always-online tracking or distractions. Originally, I got mine
for running NetBSD, but found the pull of 20 year old commercial software
too tempting to resist.
</p>
<p>
Regardless, how usable is Mac OS X 10.4 for Unix professionals,
software developers, and command-line junkies? A surprising
amount of free software can still run, often with some
simple adjustments. The <a href="https://www.pkgsrc.org/">pkgsrc</a>
framework offers a platform-netural repository with powerful
frameworks that allow wide porting of software.
</p>
<p>
Pre-built PowerPC binaries for popular software are available,
including PostgreSQL, ImageMagick, Python 3, Wget, cURL, FFmpeg,
OpenSSH, OpenSSL, Apache Web Server, nginx, yt-dlp, SDL,
Midnight Commander, and many more.
</p>
<p>
Note: I make no guarantees about the security or up-to-dateness
of these packages, though I pinky promise they're better than what
Tiger includes by default.  No warranty. Your fridge may explode.
You may find you're suddenly able to connect to servers that
use modern encryption, with all the risks that entails.
</p>
<h2>How to install software</h2>
<h3>Bootstrapping</h3>
<p><a href="https://ftp.netbsd.org/pub/pkgsrc/misc/nia/tigersrc/bootstrap-tiger.tar.gz">Download the bootstrap kit</a></p>
<p>Extract the bootstrap kit on 10.4, set your <code>PATH</code>:</p>
<pre><code>
$ sudo tar -C / -xzpvf bootstrap-tiger.tar.gz
$ export PATH=/usr/pkg/sbin:/usr/pkg/bin:$PATH
$ export PKG_PATH=https://ftp.NetBSD.org/pub/pkgsrc/misc/nia/tigersrc/packages/All/
</code>
</pre>
<p>Add the last two lines to <code>~/.bash_profile</code>.
</p><h3>Installing packages</h3>
<p><a href="https://ftp.netbsd.org/pub/pkgsrc/misc/nia/tigersrc/packages/All/">Browse the repository</a></p>
<pre><code>
$ sudo pkg_add ffmpeg2
</code>
</pre>
<h2>Challenges building modern software on 10.4</h2>
<p>Part of this project is <em>just for fun</em>. Since I'm a developer
specialized in build systems, I get enjoyment out of pushing pkgsrc as far
as possible. Therefore, others should get to learn from this too.</p>
<p>Refer to the <a href="http://www.netbsd.org/~nia/tigersrc/mk.conf">mk.conf</a> used for this repository,
containing some non-upstreamed workarounds, and the
<a href="http://www.netbsd.org/~nia/tigersrc/tiger-packages.txt">allowlist of packages</a>.</p>
<ul>
<li><strong>Compiler:</strong> XCode's GCC 4.0 does not support C++11 or C11.
    Some software expects the compiler to default to C99,
    and does not explicitly specify <code>-std=c99</code> in <code>CFLAGS</code>.
    This older version of GCC supports C99 but does not default to it,
    which should be worked around by setting <code>FORCE_C_STD</code>
    in pkgsrc. Many pieces of modern software like to specify lots of unsupported
    -W and -Wno arguments to customize warnings. These can be stripped out with pkgsrc's
    <code>BUILDLINK_TRANSFORM</code>.</li>
<li><strong>Linker:</strong> The strict Mach-O linker included in Tiger is
    quite different from what modern software expects (e.g. it does not
    support <code>-shared</code>), <em>unless</em> that software uses libtool to make
    shared libraries in a portable manner.
    pkgsrc has long had a policy of "libtoolization", patching software that
    builds with plain Makefiles to use libtool.
    <code>BUILDLINK_TRANSFORM</code> can also translate many GNU ELF-style
    linker arguments to be compatible with the Darwin linker.
    I also found the <code>-m</code> option (for making multiply-defined
    symbols into a warning instead of an error) useful.</li>
<li><strong>Library:</strong> Now-ubiqitious functions are missing, including
    <code>clock_gettime</code> and <code>strnlen</code>.
    These can easily be substituted from either <code>libnbcompat</code> or
    <code>macports-legacy-support</code>.</li>
<li><strong>Atomics:</strong> Some wide atomic instructions are missing
    from 32-bit PowerPC. This isn't a PowerPC or Darwin-specific problem,
    since it affects other 32-bit instruction sets like i486.</li>
<li><strong>Rust:</strong> Even if it worked on this platform, build times
    would be completely unacceptable. We use the pre-Rust versions of
    software like py-cryptography, since pkgsrc makes this easy. Reduce CO2 emissions,
    keep writing C.</li>
<li><strong>Locales:</strong> Certain UTF-8 file names fail to extract with
    <em>bsdtar</em>, with the UTF-8 sequences
    being detected as invalid. I haven't done much research into this yet,
    but it affects very few packages, such as the Icelandic aspell
    dictionary. This is probably not a bsdtar problem, since it
    works on NetBSD with the same tar version.</li>
<li><strong>Toolchain bugs:</strong> There is a problem with
    <code>signal.h</code> that causes some software to fail to compile.
    This can be easily worked around by disabling the relevant type definitions
    by pre-defining macros in <code>CFLAGS</code>.</li>
<li><strong>Kernel bugs:</strong> Sadly, <code>kqueue</code> does not work
    properly on Tiger. kqueue support is nearly always optional in software,
    but sometimes the detection needs to be turned off for this OS version.
    GNU configure makes this easy, other build systems may vary.</li>
<li><strong>Other curiosities:</strong> The default dashboard widgets and
    screensaver in 10.4 use a surprising amount of CPU time that could be
    better spent on GCC. They're easy to disable, though.</li>
</ul>
<p>Most of these problems are <em>very general</em>, so there's a lot of
benefit to be gained from automatically making these adjustments for everything.</p>
<p>A big problem for this project is the wider ecosystem (well, mostly GNOME-adjacent
libraries) moving away from the GNU build system, which mostly solved the
problem of building shared libraries on different platforms years ago,
as well as nicely handling feature detection.  More work needs to be done before
CMake and Meson can work well on this platform, but also a way to say to them
"yes, this OS has this feature, but please ignore it" would be very useful
(also for testing!).
</p>
<p>Related to the issue of 64-bit atomics is the world moving away from 32-bit
platforms. If you're a stranger to the embedded world, this is happening
more slowly than you might think. While Mac OS X suffers from the Year 2038
Problem, NetBSD solved it years ago. 64-bit wide atomic instructions
are unavailable on many NetBSD ports, with libatomic being a hacky workaround
at best.</p>
<p>Most importantly, if you maintain a C/C++ software project, and don't specify
<code>-std=(gnu|c)XX</code> in your build sytem already, <em>please do</em>.
Keep in mind that <code>-Werror</code> will fall over the moment you try building with
a compiler version that you haven't tested personally, and distribution maintainers
will want to disable it. For pkgsrc on modern platforms, at any one time we're building
with around 4 different major versions of GCC plus Clang, so we'd disable it
even if we weren't supporting crusty old stuff.</p>
<h2>See also</h2>
<ul>
<li><a href="https://www.macports.org/">MacPorts</a> - lots of prior art</li>
<li><a href="https://github.com/mistydemeo/tigerbrew">TigerBrew</a> - lots of frozen packages to prevent them breaking, pkgsrc being more "live"</li>
<li><a href="https://www.macintoshrepository.org/">Macintosh Repository</a> - useful for obtaining XCode</li>
</ul>
<small>
<p>nia from the domain pkgsrc.org<br>
Best viewed in Links.<br>
Last updated March 2024.</p>
<p>
<a href="https://validator.w3.org/markup/check?uri=referer"><img src="https://www.w3.org/Icons/valid-html401" alt="Valid HTML 4.01 Strict" height="31" width="88"></a>
</p>
</small>


</div>]]></description>
        </item>
        <item>
            <title><![CDATA[A MySQL compatible database engine written in pure Go (370 pts)]]></title>
            <link>https://github.com/dolthub/go-mysql-server</link>
            <guid>39983490</guid>
            <pubDate>Tue, 09 Apr 2024 19:50:43 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/dolthub/go-mysql-server">https://github.com/dolthub/go-mysql-server</a>, See on <a href="https://news.ycombinator.com/item?id=39983490">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/dolthub/go-mysql-server/blob/main/mascot.png"><img height="240" src="https://github.com/dolthub/go-mysql-server/raw/main/mascot.png"></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">A MySQL compatible database engine written in pure Go</h2><a id="user-content-a-mysql-compatible-database-engine-written-in-pure-go" aria-label="Permalink: A MySQL compatible database engine written in pure Go" href="#a-mysql-compatible-database-engine-written-in-pure-go"></a></p>
<p dir="auto"><strong>go-mysql-server</strong> is a data-source agnostic SQL engine and server
which runs queries on data sources you provide, using the MySQL
dialect and wire protocol. A simple in-memory database implementation
is included, and you can query any data source you want by
implementing your own backend.</p>
<p dir="auto"><a href="https://www.doltdb.com/" rel="nofollow">Dolt</a>, a SQL database with Git-style
versioning, is the main production database implementation of this
package.  <a href="https://docs.dolthub.com/introduction/what-is-dolt" rel="nofollow">Check
out</a> that project
for reference a implementation. Or, hop into the Dolt discord
<a href="https://discord.com/invite/RFwfYpu" rel="nofollow">here</a> if you want to talk to the
<a href="https://www.dolthub.com/team" rel="nofollow">core developers</a> behind
<strong>go-mysql-server</strong> and Dolt.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Compatibility</h2><a id="user-content-compatibility" aria-label="Permalink: Compatibility" href="#compatibility"></a></p>
<p dir="auto">With the exception of specific limitations (see below),
<strong>go-mysql-server</strong> is a drop-in replacement for MySQL. Any client
library, tool, query, SQL syntax, SQL function, etc. that works with
MySQL should also work with <strong>go-mysql-server</strong>. If you find a gap in
functionality, please file an issue.</p>
<p dir="auto">For full MySQL compatibility documentation, see the <a href="https://docs.dolthub.com/sql-reference/sql-support" rel="nofollow">Dolt
docs</a> on this
topic.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Scope of this project</h2><a id="user-content-scope-of-this-project" aria-label="Permalink: Scope of this project" href="#scope-of-this-project"></a></p>
<ul dir="auto">
<li>SQL server and engine to query your data sources.</li>
<li>In-memory database backend implementation suitable for use in tests.</li>
<li>Interfaces you can use to implement new backends to query your own
data sources.</li>
<li>With a few caveats and using a full database implementation, a
drop-in MySQL database replacement.</li>
</ul>
<p dir="auto"><strong>go-mysql-server</strong> has two primary uses case:</p>
<ol dir="auto">
<li>
<p dir="auto">Stand-in for MySQL in a golang test environment, using the built-in
<code>memory</code> database implementation.</p>
</li>
<li>
<p dir="auto">Providing access to arbitrary data sources with SQL queries by
implementing a handful of interfaces. The most complete real-world
implementation is <a href="https://github.com/dolthub/dolt">Dolt</a>.</p>
</li>
</ol>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<p dir="auto">Add <strong>go-mysql-server</strong> as a dependency to your project. In the
directory with the <code>go.mod</code> file, run:</p>
<div data-snippet-clipboard-copy-content="go get github.com/dolthub/go-mysql-server@latest"><pre><code>go get github.com/dolthub/go-mysql-server@latest
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Using the in-memory test server</h2><a id="user-content-using-the-in-memory-test-server" aria-label="Permalink: Using the in-memory test server" href="#using-the-in-memory-test-server"></a></p>
<p dir="auto">The in-memory test server can replace a real MySQL server in
tests. Start the server using the code in the <a href="https://github.com/dolthub/go-mysql-server/blob/main/_example/main.go">_example
directory</a>, also reproduced below.</p>
<div dir="auto" data-snippet-clipboard-copy-content="package main

import (
	&quot;context&quot;
	&quot;fmt&quot;
	&quot;time&quot;

	&quot;github.com/dolthub/vitess/go/vt/proto/query&quot;

	sqle &quot;github.com/dolthub/go-mysql-server&quot;
	&quot;github.com/dolthub/go-mysql-server/memory&quot;
	&quot;github.com/dolthub/go-mysql-server/server&quot;
	&quot;github.com/dolthub/go-mysql-server/sql&quot;
	&quot;github.com/dolthub/go-mysql-server/sql/types&quot;
)

// This is an example of how to implement a MySQL server.
// After running the example, you may connect to it using the following:
//
// > mysql --host=localhost --port=3306 --user=root mydb --execute=&quot;SELECT * FROM mytable;&quot;
// +----------+-------------------+-------------------------------+----------------------------+
// | name     | email             | phone_numbers                 | created_at                 |
// +----------+-------------------+-------------------------------+----------------------------+
// | Jane Deo | janedeo@gmail.com | [&quot;556-565-566&quot;,&quot;777-777-777&quot;] | 2022-11-01 12:00:00.000001 |
// | Jane Doe | jane@doe.com      | []                            | 2022-11-01 12:00:00.000001 |
// | John Doe | john@doe.com      | [&quot;555-555-555&quot;]               | 2022-11-01 12:00:00.000001 |
// | John Doe | johnalt@doe.com   | []                            | 2022-11-01 12:00:00.000001 |
// +----------+-------------------+-------------------------------+----------------------------+
//
// The included MySQL client is used in this example, however any MySQL-compatible client will work.

var (
	dbName    = &quot;mydb&quot;
	tableName = &quot;mytable&quot;
	address   = &quot;localhost&quot;
	port      = 3306
)

func main() {
	pro := createTestDatabase()
	engine := sqle.NewDefault(pro)

	session := memory.NewSession(sql.NewBaseSession(), pro)
	ctx := sql.NewContext(context.Background(), sql.WithSession(session))
	ctx.SetCurrentDatabase(&quot;test&quot;)

	// This variable may be found in the &quot;users_example.go&quot; file. Please refer to that file for a walkthrough on how to
	// set up the &quot;mysql&quot; database to allow user creation and user checking when establishing connections. This is set
	// to false for this example, but feel free to play around with it and see how it works.
	if enableUsers {
		if err := enableUserAccounts(ctx, engine); err != nil {
			panic(err)
		}
	}

	config := server.Config{
		Protocol: &quot;tcp&quot;,
		Address:  fmt.Sprintf(&quot;%s:%d&quot;, address, port),
	}
	s, err := server.NewServer(config, engine, memory.NewSessionBuilder(pro), nil)
	if err != nil {
		panic(err)
	}
	if err = s.Start(); err != nil {
		panic(err)
	}
}

func createTestDatabase() *memory.DbProvider {
	db := memory.NewDatabase(dbName)
	db.BaseDatabase.EnablePrimaryKeyIndexes()

	pro := memory.NewDBProvider(db)
	session := memory.NewSession(sql.NewBaseSession(), pro)
	ctx := sql.NewContext(context.Background(), sql.WithSession(session))

	table := memory.NewTable(db, tableName, sql.NewPrimaryKeySchema(sql.Schema{
		{Name: &quot;name&quot;, Type: types.Text, Nullable: false, Source: tableName, PrimaryKey: true},
		{Name: &quot;email&quot;, Type: types.Text, Nullable: false, Source: tableName, PrimaryKey: true},
		{Name: &quot;phone_numbers&quot;, Type: types.JSON, Nullable: false, Source: tableName},
		{Name: &quot;created_at&quot;, Type: types.MustCreateDatetimeType(query.Type_DATETIME, 6), Nullable: false, Source: tableName},
	}), db.GetForeignKeyCollection())
	db.AddTable(tableName, table)

	creationTime := time.Unix(0, 1667304000000001000).UTC()
	_ = table.Insert(ctx, sql.NewRow(&quot;Jane Deo&quot;, &quot;janedeo@gmail.com&quot;, types.MustJSON(`[&quot;556-565-566&quot;, &quot;777-777-777&quot;]`), creationTime))
	_ = table.Insert(ctx, sql.NewRow(&quot;Jane Doe&quot;, &quot;jane@doe.com&quot;, types.MustJSON(`[]`), creationTime))
	_ = table.Insert(ctx, sql.NewRow(&quot;John Doe&quot;, &quot;john@doe.com&quot;, types.MustJSON(`[&quot;555-555-555&quot;]`), creationTime))
	_ = table.Insert(ctx, sql.NewRow(&quot;John Doe&quot;, &quot;johnalt@doe.com&quot;, types.MustJSON(`[]`), creationTime))

	return pro
}"><pre><span>package</span> main

<span>import</span> (
	<span>"context"</span>
	<span>"fmt"</span>
	<span>"time"</span>

	<span>"github.com/dolthub/vitess/go/vt/proto/query"</span>

	sqle <span>"github.com/dolthub/go-mysql-server"</span>
	<span>"github.com/dolthub/go-mysql-server/memory"</span>
	<span>"github.com/dolthub/go-mysql-server/server"</span>
	<span>"github.com/dolthub/go-mysql-server/sql"</span>
	<span>"github.com/dolthub/go-mysql-server/sql/types"</span>
)

<span>// This is an example of how to implement a MySQL server.</span>
<span>// After running the example, you may connect to it using the following:</span>
<span>//</span>
<span>// &gt; mysql --host=localhost --port=3306 --user=root mydb --execute="SELECT * FROM mytable;"</span>
<span>// +----------+-------------------+-------------------------------+----------------------------+</span>
<span>// | name     | email             | phone_numbers                 | created_at                 |</span>
<span>// +----------+-------------------+-------------------------------+----------------------------+</span>
<span>// | Jane Deo | janedeo@gmail.com | ["556-565-566","777-777-777"] | 2022-11-01 12:00:00.000001 |</span>
<span>// | Jane Doe | jane@doe.com      | []                            | 2022-11-01 12:00:00.000001 |</span>
<span>// | John Doe | john@doe.com      | ["555-555-555"]               | 2022-11-01 12:00:00.000001 |</span>
<span>// | John Doe | johnalt@doe.com   | []                            | 2022-11-01 12:00:00.000001 |</span>
<span>// +----------+-------------------+-------------------------------+----------------------------+</span>
<span>//</span>
<span>// The included MySQL client is used in this example, however any MySQL-compatible client will work.</span>

<span>var</span> (
	<span>dbName</span>    <span>=</span> <span>"mydb"</span>
	<span>tableName</span> <span>=</span> <span>"mytable"</span>
	<span>address</span>   <span>=</span> <span>"localhost"</span>
	<span>port</span>      <span>=</span> <span>3306</span>
)

<span>func</span> <span>main</span>() {
	<span>pro</span> <span>:=</span> <span>createTestDatabase</span>()
	<span>engine</span> <span>:=</span> <span>sqle</span>.<span>NewDefault</span>(<span>pro</span>)

	<span>session</span> <span>:=</span> <span>memory</span>.<span>NewSession</span>(<span>sql</span>.<span>NewBaseSession</span>(), <span>pro</span>)
	<span>ctx</span> <span>:=</span> <span>sql</span>.<span>NewContext</span>(<span>context</span>.<span>Background</span>(), <span>sql</span>.<span>WithSession</span>(<span>session</span>))
	<span>ctx</span>.<span>SetCurrentDatabase</span>(<span>"test"</span>)

	<span>// This variable may be found in the "users_example.go" file. Please refer to that file for a walkthrough on how to</span>
	<span>// set up the "mysql" database to allow user creation and user checking when establishing connections. This is set</span>
	<span>// to false for this example, but feel free to play around with it and see how it works.</span>
	<span>if</span> <span>enableUsers</span> {
		<span>if</span> <span>err</span> <span>:=</span> <span>enableUserAccounts</span>(<span>ctx</span>, <span>engine</span>); <span>err</span> <span>!=</span> <span>nil</span> {
			<span>panic</span>(<span>err</span>)
		}
	}

	<span>config</span> <span>:=</span> server.<span>Config</span>{
		<span>Protocol</span>: <span>"tcp"</span>,
		<span>Address</span>:  <span>fmt</span>.<span>Sprintf</span>(<span>"%s:%d"</span>, <span>address</span>, <span>port</span>),
	}
	<span>s</span>, <span>err</span> <span>:=</span> <span>server</span>.<span>NewServer</span>(<span>config</span>, <span>engine</span>, <span>memory</span>.<span>NewSessionBuilder</span>(<span>pro</span>), <span>nil</span>)
	<span>if</span> <span>err</span> <span>!=</span> <span>nil</span> {
		<span>panic</span>(<span>err</span>)
	}
	<span>if</span> <span>err</span> <span>=</span> <span>s</span>.<span>Start</span>(); <span>err</span> <span>!=</span> <span>nil</span> {
		<span>panic</span>(<span>err</span>)
	}
}

<span>func</span> <span>createTestDatabase</span>() <span>*</span>memory.<span>DbProvider</span> {
	<span>db</span> <span>:=</span> <span>memory</span>.<span>NewDatabase</span>(<span>dbName</span>)
	<span>db</span>.<span>BaseDatabase</span>.<span>EnablePrimaryKeyIndexes</span>()

	<span>pro</span> <span>:=</span> <span>memory</span>.<span>NewDBProvider</span>(<span>db</span>)
	<span>session</span> <span>:=</span> <span>memory</span>.<span>NewSession</span>(<span>sql</span>.<span>NewBaseSession</span>(), <span>pro</span>)
	<span>ctx</span> <span>:=</span> <span>sql</span>.<span>NewContext</span>(<span>context</span>.<span>Background</span>(), <span>sql</span>.<span>WithSession</span>(<span>session</span>))

	<span>table</span> <span>:=</span> <span>memory</span>.<span>NewTable</span>(<span>db</span>, <span>tableName</span>, <span>sql</span>.<span>NewPrimaryKeySchema</span>(sql.<span>Schema</span>{
		{<span>Name</span>: <span>"name"</span>, <span>Type</span>: <span>types</span>.<span>Text</span>, <span>Nullable</span>: <span>false</span>, <span>Source</span>: <span>tableName</span>, <span>PrimaryKey</span>: <span>true</span>},
		{<span>Name</span>: <span>"email"</span>, <span>Type</span>: <span>types</span>.<span>Text</span>, <span>Nullable</span>: <span>false</span>, <span>Source</span>: <span>tableName</span>, <span>PrimaryKey</span>: <span>true</span>},
		{<span>Name</span>: <span>"phone_numbers"</span>, <span>Type</span>: <span>types</span>.<span>JSON</span>, <span>Nullable</span>: <span>false</span>, <span>Source</span>: <span>tableName</span>},
		{<span>Name</span>: <span>"created_at"</span>, <span>Type</span>: <span>types</span>.<span>MustCreateDatetimeType</span>(<span>query</span>.<span>Type_DATETIME</span>, <span>6</span>), <span>Nullable</span>: <span>false</span>, <span>Source</span>: <span>tableName</span>},
	}), <span>db</span>.<span>GetForeignKeyCollection</span>())
	<span>db</span>.<span>AddTable</span>(<span>tableName</span>, <span>table</span>)

	<span>creationTime</span> <span>:=</span> <span>time</span>.<span>Unix</span>(<span>0</span>, <span>1667304000000001000</span>).<span>UTC</span>()
	<span>_</span> <span>=</span> <span>table</span>.<span>Insert</span>(<span>ctx</span>, <span>sql</span>.<span>NewRow</span>(<span>"Jane Deo"</span>, <span>"janedeo@gmail.com"</span>, <span>types</span>.<span>MustJSON</span>(<span>`["556-565-566", "777-777-777"]`</span>), <span>creationTime</span>))
	<span>_</span> <span>=</span> <span>table</span>.<span>Insert</span>(<span>ctx</span>, <span>sql</span>.<span>NewRow</span>(<span>"Jane Doe"</span>, <span>"jane@doe.com"</span>, <span>types</span>.<span>MustJSON</span>(<span>`[]`</span>), <span>creationTime</span>))
	<span>_</span> <span>=</span> <span>table</span>.<span>Insert</span>(<span>ctx</span>, <span>sql</span>.<span>NewRow</span>(<span>"John Doe"</span>, <span>"john@doe.com"</span>, <span>types</span>.<span>MustJSON</span>(<span>`["555-555-555"]`</span>), <span>creationTime</span>))
	<span>_</span> <span>=</span> <span>table</span>.<span>Insert</span>(<span>ctx</span>, <span>sql</span>.<span>NewRow</span>(<span>"John Doe"</span>, <span>"johnalt@doe.com"</span>, <span>types</span>.<span>MustJSON</span>(<span>`[]`</span>), <span>creationTime</span>))

	<span>return</span> <span>pro</span>
}</pre></div>
<p dir="auto">This example populates the database by creating <code>memory.Database</code> and
<code>memory.Table</code> objects via golang code, but you can also populate it
by issuing <code>CREATE DATABASE</code>, <code>CREATE TABLE</code>, etc. statements to the
server once it's running.</p>
<p dir="auto">Once the server is running, connect with any MySQL client, including
the golang MySQL connector and the <code>mysql</code> shell.</p>
<div dir="auto" data-snippet-clipboard-copy-content="> mysql --host=localhost --port=3306 --user=root mydb --execute=&quot;SELECT * FROM mytable;&quot;
+----------+-------------------+-------------------------------+----------------------------+
| name     | email             | phone_numbers                 | created_at                 |
+----------+-------------------+-------------------------------+----------------------------+
| Jane Deo | janedeo@gmail.com | [&quot;556-565-566&quot;,&quot;777-777-777&quot;] | 2022-11-01 12:00:00.000001 |
| Jane Doe | jane@doe.com      | []                            | 2022-11-01 12:00:00.000001 |
| John Doe | john@doe.com      | [&quot;555-555-555&quot;]               | 2022-11-01 12:00:00.000001 |
| John Doe | johnalt@doe.com   | []                            | 2022-11-01 12:00:00.000001 |
+----------+-------------------+-------------------------------+----------------------------+"><pre><span>&gt;</span> mysql --host=localhost --port=3306 --user=root mydb --execute=<span><span>"</span>SELECT * FROM mytable;<span>"</span></span>
+----------+-------------------+-------------------------------+----------------------------+
<span>|</span> name     <span>|</span> email             <span>|</span> phone_numbers                 <span>|</span> created_at                 <span>|</span>
+----------+-------------------+-------------------------------+----------------------------+
<span>|</span> Jane Deo <span>|</span> janedeo@gmail.com <span>|</span> [<span><span>"</span>556-565-566<span>"</span></span>,<span><span>"</span>777-777-777<span>"</span></span>] <span>|</span> 2022-11-01 12:00:00.000001 <span>|</span>
<span>|</span> Jane Doe <span>|</span> jane@doe.com      <span>|</span> []                            <span>|</span> 2022-11-01 12:00:00.000001 <span>|</span>
<span>|</span> John Doe <span>|</span> john@doe.com      <span>|</span> [<span><span>"</span>555-555-555<span>"</span></span>]               <span>|</span> 2022-11-01 12:00:00.000001 <span>|</span>
<span>|</span> John Doe <span>|</span> johnalt@doe.com   <span>|</span> []                            <span>|</span> 2022-11-01 12:00:00.000001 <span>|</span>
+----------+-------------------+-------------------------------+----------------------------+</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Limitations of the in-memory database implementation</h2><a id="user-content-limitations-of-the-in-memory-database-implementation" aria-label="Permalink: Limitations of the in-memory database implementation" href="#limitations-of-the-in-memory-database-implementation"></a></p>
<p dir="auto">The in-memory database implementation included with this package is
intended for use in tests. It has specific limitations that we know
of:</p>
<ul dir="auto">
<li><a href="https://github.com/dolthub/go-mysql-server/issues/1306" data-hovercard-type="issue" data-hovercard-url="/dolthub/go-mysql-server/issues/1306/hovercard">Not
threadsafe</a>. To
avoid concurrency issues, limit DDL and DML statements (<code>CREATE TABLE</code>, <code>INSERT</code>, etc.) to a single goroutine.</li>
<li><a href="https://github.com/dolthub/go-mysql-server/issues/1506" data-hovercard-type="issue" data-hovercard-url="/dolthub/go-mysql-server/issues/1506/hovercard">No transaction
support</a>. Statements
like <code>START TRANSACTION</code>, <code>ROLLBACK</code>, and <code>COMMIT</code> are no-ops.</li>
<li><a href="https://github.com/dolthub/go-mysql-server/issues/1347" data-hovercard-type="issue" data-hovercard-url="/dolthub/go-mysql-server/issues/1347/hovercard">Non-performant index
implementation</a>. Indexed
lookups and joins perform full table scans on the underlying tables.</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Custom backend implementations</h2><a id="user-content-custom-backend-implementations" aria-label="Permalink: Custom backend implementations" href="#custom-backend-implementations"></a></p>
<p dir="auto">You can create your own backend to query your own data sources by
implementing some interfaces. For detailed instructions, see the
<a href="https://github.com/dolthub/go-mysql-server/blob/main/BACKEND.md">backend guide</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Technical documentation for contributors and backend developers</h2><a id="user-content-technical-documentation-for-contributors-and-backend-developers" aria-label="Permalink: Technical documentation for contributors and backend developers" href="#technical-documentation-for-contributors-and-backend-developers"></a></p>
<ul dir="auto">
<li><a href="https://github.com/dolthub/go-mysql-server/blob/main/ARCHITECTURE.md">Architecture</a> is an overview of the various
packages of the project and how they fit together.</li>
<li><a href="https://github.com/dolthub/go-mysql-server/blob/main/CONTRIBUTING.md">Contribution guide</a> for new contributors,
including instructions for how to get your PR merged.</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Powered by go-mysql-server</h2><a id="user-content-powered-by-go-mysql-server" aria-label="Permalink: Powered by go-mysql-server" href="#powered-by-go-mysql-server"></a></p>
<ul dir="auto">
<li><a href="https://github.com/dolthub/dolt">dolt</a></li>
<li><a href="https://github.com/src-d/gitbase">gitbase</a> (defunct)</li>
</ul>
<p dir="auto">Are you building a database backend using <strong>go-mysql-server</strong>? We
would like to hear from you and include you in this list.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Security Policy</h2><a id="user-content-security-policy" aria-label="Permalink: Security Policy" href="#security-policy"></a></p>
<p dir="auto"><a href="https://github.com/dolthub/go-mysql-server/blob/main/SECURITY.md">go-mysql-server's security
policy</a> is
maintained in this repository. Please follow the disclosure instructions there.
Please do not initially report security issues in this repository's public
GitHub issues.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Acknowledgements</h2><a id="user-content-acknowledgements" aria-label="Permalink: Acknowledgements" href="#acknowledgements"></a></p>
<p dir="auto"><strong>go-mysql-server</strong> was originally developed by the <code>{source-d}</code>
organzation, and this repository was originally forked from
<a href="https://github.com/src-d/go-mysql-server">src-d</a>. We want to thank
the entire <code>{source-d}</code> development team for their work on this
project, especially Miguel Molina (@erizocosmico) and Juanjo Álvarez
Martinez (@juanjux).</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto">Apache License 2.0, see <a href="https://github.com/dolthub/go-mysql-server/blob/main/LICENSE">LICENSE</a></p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Yes, social media is a cause of the epidemic of teenage mental illness (924 pts)]]></title>
            <link>https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic</link>
            <guid>39983233</guid>
            <pubDate>Tue, 09 Apr 2024 19:29:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic">https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic</a>, See on <a href="https://news.ycombinator.com/item?id=39983233">Hacker News</a></p>
<div id="readability-page-1" class="page"><div dir="auto"><p><span>For centuries, adults have worried about whatever “kids these days” are doing. From novels in the 18th century to the bicycle in the 19th and through comic books, rock and roll, marijuana, and violent video games in the 20th century, there are always those who ring alarms, and there are always </span><a href="https://parents.simonandschuster.com/9781982159597" rel="">those who are skeptics of those alarms</a><span>. So far, the skeptics have been right more often than not, and when they are right, they earn the right to call the alarm ringers “alarmists” who have fomented a groundless moral panic, usually through sensational but rare (or non-existent) horror stories trumpeted by irresponsible media.&nbsp;</span></p><p><span>But the skeptics are not always right. I think it is a very good thing that alarms were rung about teen smoking, teen pregnancy, drunk driving, and the exposure of children to sex and violence on TV. The lesson of </span><em>The Boy Who Cried Wolf</em><span> is not that after two false alarms we should disconnect the alarm system. In that story, the wolf does eventually come.&nbsp;</span></p><p><span>The question before us now, on the topic of teens and social media, is this: Are the skeptics correct that we are going through just one more groundless moral panic over teens and tech in which adults are freaking out while, in fact, </span><em>the harms are so minimal</em><span> that they shouldn’t be a cause for worry? Or did the wolf really arrive around 2012, and has been mauling young people ever since via their smartphones and social media accounts? (Of course, there are </span><a href="https://technosapiens.substack.com/" rel="">researchers</a><span> who reside in the space between these two perspectives.)</span></p><p>Psychologist Candice Odgers has taken the skeptical side for many years now (along with researchers including Amy Orben, Andrew Przybylski, Jeff Hancock, Chris Ferguson, and Aaron Brown), while Jean Twenge and I have been writing as alarm ringers. It has been a normal and productive academic debate. Engagement with each other’s arguments is how science makes progress. Even if we never convince each other, the broader scientific and policy communities tune in to the debate, and eventually, they’ll move one way or the other.</p><p><span>Odgers recently stated the skeptics' case in an essay in </span><em>Nature</em><span> titled </span><em><a href="https://www.nature.com/articles/d41586-024-00902-2" rel="">The Great Rewiring: Is Social Media Really Behind an Epidemic of Teenage Mental Illness</a><span>?</span></em><span> The essay offered a critique of my recent book, </span><em>The Anxious Generation</em><span>. Odgers’ primary criticism is that I have mistaken correlation for causation and that “there is no evidence that using these platforms is rewiring children’s brains or driving an epidemic of mental illness.”&nbsp; She also warns that my ringing of a false alarm “might distract us from effectively responding to the real causes of the current mental-health crisis in young people,” which, she suggests, are social ills such as racism, economic hardship, and the lingering impact of the 2008 Global Financial Crisis and its disparate impact on children in low SES families.&nbsp;</span></p><p>In this response essay, I’ll present the two main problems I see with the skeptics' approach, as exemplified in Odgers’ review:&nbsp;</p><ol><li><p>Odgers is wrong to say that I have no evidence of causation</p></li><li><p>Odgers’ alternative explanation does not fit the available facts.</p></li></ol><p data-attrs="{&quot;url&quot;:&quot;https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share&quot;,&quot;text&quot;:&quot;Share&quot;,&quot;action&quot;:null,&quot;class&quot;:null}" data-component-name="ButtonCreateButton"><a href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share" rel=""><span>Share</span></a></p><p>Odgers’ central claim is that I have mistaken correlation for causation and that I have “no evidence” that social media is a cause, rather than a mere correlate, of the current epidemic of adolescent mental illness. Odgers says that I am just “making up stories by simply looking at trend lines.”</p><p><span>In 2018, when I entered this debate as a co-author of </span><em>The Coddling of the American Mind</em><span>, it was true that the great majority of published studies on “digital media” and mental health were correlational, and every social scientist knows that correlational studies often suggest to our intuitive minds a causal pathway that vanishes when experiments using random assignment are published. (Think of the changing guidance on the health effects of fat, carbs, and red wine). But even in 2018 there were a few </span><a href="https://doi.org/10.1080/15213269.2016.1257392" rel="">experimental</a><span> </span><a href="https://psycnet.apa.org/record/2014-19176-040" rel="">studies</a><span> on social media and mental health. For example, college students</span><a href="https://guilfordjournals.com/doi/abs/10.1521/jscp.2018.37.10.751" rel=""> who were asked</a><span> to reduce their social media use for three weeks generally experienced mental health benefits compared to the control group. Zach Rausch, Jean Twenge, and I began to collect all the studies we could find in 2019, and we organized them by type: correlational, longitudinal, and experimental. We put all of our work online in Google Docs that are open to other researchers for comment and critique. You can find all of our “collaborative review” documents at </span><a href="http://anxiousgeneration.com/reviews" rel="">AnxiousGeneration.com/reviews</a></p><p><span>The main document that collects studies on social media is here:</span><br><a href="https://docs.google.com/document/d/1w-HOfseF2wF9YIpXwUUtP65-olnkPyWcgF5BiAtBEy0/edit" rel="">Social Media and Mental Health: A Collaborative Review</a></p><p><span>In that document, we list dozens of correlational and longitudinal studies. These large datasets provide us with correlation coefficients that tell us how variables in the dataset are related to each other, and they tell us when and for whom those relationships are stronger. Those studies reveal a fairly consistent relationship in which heavy users of social media are at much higher risk of mental illness or poor mental health than everyone else. A </span><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6537508/" rel="">widely cited 2018 study</a><span> of 14-year-olds found that girls who spend five hours or more on social media per day are </span><em>three times as likely to be depressed</em><span> as girls who use social media only a little or not at all. For boys, the ratio is lower, closer to two-to-one. A </span><a href="https://pubmed.ncbi.nlm.nih.gov/35564559/#:~:text=The%20risk%20of%20depression%20increased,of%20adolescent%20social%20media%20use." rel="">meta-analysis of 26 such studies</a><span> found that the risk of depression increased by 13% for each hour increase on social media for adolescents (and that increase was even higher for girls).</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-1-143412349" href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic#footnote-1-143412349" target="_self" rel="">1</a></span><span>&nbsp;</span></p><p>In that document, we also list 22 experimental studies, 16 of which found significant evidence of harm (or of benefits from getting off of social media for long enough to get past withdrawal symptoms). To give just a few examples:&nbsp;</p><ol><li><p><a href="https://pubs.aeaweb.org/doi/pdfplus/10.1257/aer.20190658" rel="">Alcott and colleagues (2020)</a><span> randomly assigned 2743 adults to either deactivate their Facebook accounts for one month or not. This study also found that deactivation significantly improved subjective well-being and that “80% of the treatment group agreed that deactivation was good for them.” The treatment group was also more likely to report using Facebook less and having uninstalled the app from their phones post-experiment.</span></p></li><li><p><a href="https://doi.org/10.1007/s10389-022-01751-x" rel="">Brailovskaia and colleagues (2022)</a><span> have done one of the only studies I have seen that incorporate both social media reduction and physical activity increases. They randomly assigned 642 participants to (1) reduce social media use to 30 minutes a day for two weeks, (2) increase physical activity by 30 minutes a day for two weeks, (3) follow both instructions, or (4) do nothing. The researchers found the strongest effects within the combined condition (#3). This group reported the largest decreases in depressive symptoms and increases in life satisfaction and subjective happiness compared to other groups.&nbsp;</span></p></li><li><p><span>There are also a </span><a href="https://psycnet.apa.org/doi/10.1037/ppm0000182" rel="">number</a><span> of </span><a href="https://www.sciencedirect.com/science/article/pii/S174014452030406X" rel="">experiments</a><span> that have looked at Instagram's unique negative impacts on women, including the finding that it is </span><a href="https://www.sciencedirect.com/science/article/abs/pii/S1740144519303754?via%3Dihub" rel="">more harmful to women</a><span> than is Facebook.</span></p></li></ol><p><span>In that document, we also list nine quasi-experiments or natural experiments (as when high-speed internet arrives in different parts of a country at different times), eight of which found evidence of harm to mental health, especially for girls and women. (Odgers cited only the </span><a href="https://journals.sagepub.com/doi/10.1177/21677026231207791" rel=""><span>9</span><sup>th</sup><span> one</span></a><span>, which relies on a dataset that is made up of unreliable estimates that do not detect known rises in mental illness, as </span><a href="https://www.afterbabel.com/p/international-mental-health-gbd" rel="">Zach showed here</a><span>.) To give just one example: </span><a href="https://www.iza.org/publications/dp/15728/high-speed-internet-and-the-widening-gender-gap-in-adolescent-mental-health-evidence-from-hospital-records" rel="">Arenas-Arroyo and colleagues (2022) </a><span>looked at the links between the staggered rollout of broadband internet in Spain between 2007-2019 and hospital discharge diagnoses of behavioral and mental health cases of adolescents. They found a significant effect of the arrival of high-speed internet,</span><em> but only among adolescent girls.</em></p><p><span>There are also a number of studies showing </span><a href="https://openaccess.nhh.no/nhh-xmlui/handle/11250/3119200" rel="">mental health improvements</a><span>, </span><a href="https://doi.org/10.3390/ijerph18041907" rel="">increases in physical activity</a><span>, and </span><a href="https://doi.org/10.1108/AEA-05-2021-0112" rel="">reductions in bullying</a><span> when schools go phone-free—one of the few natural experiments that specifically targets both adolescents </span><em>and</em><span> group-level effects. (These group-level effects are illustrated brilliantly </span><a href="https://bfi.uchicago.edu/insight/research-summary/when-product-markets-become-collective-traps-the-case-of-social-media/" rel="">here</a><span>).&nbsp;</span></p><p>I am not saying that academic debates are settled by counting up the number of studies on each side, but bringing so many studies together in one place gives us an overview of the available evidence, and that overview supports three points about problems with the skeptics’ arguments.</p><p><span>First, if the skeptics were right and the null hypothesis were true (i.e., social media does </span><em>not</em><span> cause harm to teen mental health), then the published studies would just reflect random noise</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-2-143412349" href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic#footnote-2-143412349" target="_self" rel="">2</a></span><span> and Type I errors (believing something that is false). In that case, we’d see experimental studies producing a wide range of findings, including many that showed </span><em>benefits</em><span> to mental health from using social media (or that showed harm to those who go off of social media for a few weeks). Yet there are hardly any such experimental findings. Most experiments find evidence of negative effects; some find no evidence of such effects, and very few show benefits. Also, if the null hypothesis were true, then we’d find some studies where the effects were larger for boys and some that found larger effects for girls. Yet that’s not what we find. When a sex difference is reported, it almost always shows more harm to girls and women. There is a clear and consistent signal running through the experimental studies (as well as the correlational studies), a signal that is not consistent with the null hypothesis.</span></p><p><span>Second, and most germane to Odgers’ review: She and the other skeptics are free to critique the hundreds of studies Zach and I cite in our essays at </span><em>After Babel</em><span> and in chapters 1, 5, 6, and 7 of </span><em>The Anxious Generatio</em><span>n. They can certainly say that they are not persuaded and that they will not be persuaded until the perfect experiment is done. But they cannot say that I am drawing </span><em>only</em><span> on correlational studies, or that I have “no evidence” of causation, or that I do not understand the difference between correlation and causation. I laid out the evidence for causality (not just correlation) between social media use and mental health outcomes for girls and walked the reader through the Google Doc and multiple kinds of evidence in this post in early 2023:</span></p><p><strong><a href="https://www.afterbabel.com/p/social-media-mental-illness-epidemic" rel="">Social Media is a Major Cause of the Mental Illness Epidemic in Teen Girls. Here’s the Evidence</a><span>.</span></strong></p><p><span>I presented several conceptual problems with the skeptics’ claims about causality and evidence in this essay: </span><strong><a href="https://www.afterbabel.com/p/why-some-researchers-think-im-wrong" rel="">Why Some Researchers Think I’m Wrong About Social Media and Mental Illness</a><span>.</span></strong><span> For example, I noted that the skeptics focus on testing one narrow model of causality that treats social media consumption as if it were an individual act, like consuming sugar, and then looks for the size of the dose-response relationship in individuals. But much of my book is about the </span><em>collective action traps</em><span> that entire communities of adolescents fall into when they move their social lives onto these platforms, such that it becomes costly to abstain. It is at that point that collective mental health declines most sharply, and the individuals who try to quit find that they are socially isolated. The skeptics do not consider the ways that these network or group-level effects may obscure individual-level effects, and may be much larger than the individual-level effects.</span></p><p><span>Third, even beyond the published experiments, there is ample evidence of causation that should be relevant to parents, lawyers, and legislators: eyewitness testimony. When you ask members of Gen Z what </span><em>they</em><span> think is causing their high rates of mental illness, they often point to </span><a href="https://headspace.org.au/assets/headspace-National-Youth-Mental-Health-Survey-2018.pdf" rel="">social media</a><span> and </span><a href="https://www.rsph.org.uk/about-us/news/instagram-ranked-worst-for-young-people-s-mental-health.html" rel="">particularly Instagram</a><span> as a major cause.</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-3-143412349" href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic#footnote-3-143412349" target="_self" rel="">3</a></span><span> (See </span><a href="https://docs.google.com/document/d/1w-HOfseF2wF9YIpXwUUtP65-olnkPyWcgF5BiAtBEy0/edit#heading=h.uj5mgiudhp60" rel="">section 4 of our main collaborative review doc</a><span>.)&nbsp; I have been searching for essays by members of Gen Z that defend social media and the phone-based childhood as being good for mental health. I can’t find them, but I find </span><a href="https://www.afterbabel.com/t/voices-of-gen-z" rel="">plenty of members of Gen Z</a><span> who say that social media damaged them or their generation. Also relevant: many members of </span><a href="https://www.halfthestoryproject.com/" rel="">Gen Z are</a><span> </span><a href="https://www.logoffmovement.org/" rel="">starting</a><span> </span><a href="https://www.rethinkwords.com/" rel="">organizations</a><span> </span><a href="https://designitforus.org/" rel="">to fight</a><span> </span><a href="https://www.nosonovember.org/" rel="">back</a><span>.</span></p><p><span>Meta collected some eyewitness testimony accidentally. In that famous internal study </span><a href="https://www.wsj.com/articles/the-facebook-files-11631713039?mod=bigtop-breadcrumb" rel="">brought out by whistleblower Frances Haugen</a><span>, the researchers found that Instagram is particularly bad for girls. They wrote: “Teens blame Instagram for increases in the rate of anxiety and depression. . . . This reaction was unprompted and consistent across all groups.” Quantitative researchers such as Odgers are free to place less weight on qualitative studies, but they </span><em>are </em><span>a kind of evidence in social science research. They are relevant when we try to sort out multiple theories about causation, especially when the platforms will not share data with scientists so the experts with the deepest insights into what social media is doing to teens are the teens themselves. They see it happening. Do they count as “no evidence” since their claims are not peer-reviewed?</span></p><p>The second major problem with Odgers’ review is that she proposes an alternative to my “great rewiring” theory that does not fit the known facts. Odgers claims that the “real causes” of the crisis, from which my book “might distract us from effectively responding,” are longstanding social ills such as “structural discrimination and racism, sexism and sexual abuse, the opioid epidemic, economic hardship and social isolation.” She proposes that the specific timing of the epidemic, beginning around 2012, might be linked to the 2008 Global Financial Crisis, which had lasting effects on “families in the bottom 20% of the income distribution,” who were “also growing up at the time of an opioid crisis, school shootings, and increasing unrest because of racial and sexual discrimination and violence.”</p><p>I agree that those things are all bad for human development, but Odgers’ theory cannot explain why rates of anxiety and depression were generally flat in the 2000s and then suddenly shot upward roughly four years after the start of the Global Financial Crisis. Did life in America suddenly get that much worse during President Obama’s second term, as the economy was steadily improving?&nbsp;</p><p>Her theory also cannot explain why adolescent mental health collapsed in similar ways around the same time in Canada, the UK, Australia, and New Zealand, as Zach and I showed in this post:</p><p><strong><a href="https://www.afterbabel.com/p/international-mental-illness-part-one" rel="">The Teen Mental Illness Epidemic is International, Part 1: The Anglosphere</a></strong></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png" width="1456" height="687" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:687,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F50b837d0-ae20-48c8-b9f8-fee6dd6da67f_1600x755.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p><em><strong>Figure 1.</strong><span> Since 2010, rates of self-harm episodes have increased for adolescents in the Anglosphere countries, especially for girls. For data on all sources and larger versions of the graphs, see </span><a href="https://jonathanhaidt.substack.com/p/international-mental-illness-part-one" rel="">Rausch and Haidt (2023).</a><span> (Data for Canada is limited to Ontario province, which contains nearly 40% of the population of Canada.)</span></em></p><p>Nor can she explain why it also happened at roughly the same time in the Nordic countries, which lack most of the social pathologies on Odgers’ list, as Zach and I showed in this post:</p><p><strong><a href="https://www.afterbabel.com/p/international-mental-illness-part-two" rel="">The Teen Mental Illness Epidemic is International, Part 2: The Nordic Nations</a></strong></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png" width="473" height="396.4564315352697" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:808,&quot;width&quot;:964,&quot;resizeWidth&quot;:473,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F4d11a32a-850f-4850-89e5-6a29ba5fa1ac_964x808.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p><em><strong>Figure 2.</strong><span> Percent of Nordic Teens with High Psychological Distress. Data from the </span><a href="https://hbsc.org/" rel="">Health Behavior in School-Age Children Survey (2002-2018)</a><span>. Graphs and data were organized, analyzed, and created by Thomas Potrebny and Zach Rausch. See 1.1.1 of </span><a href="https://docs.google.com/document/d/1w5DUx-7wTfFXvwuSRbM1Mi8VCqbpdUey4BgzPi9LvtA/edit#" rel="">Nordic Adolescent Mood Disorders since 2010</a><span>.</span></em></p><p>Nor can she explain why it also happened in much, though not all, of Western Europe:</p><p><strong><a href="https://www.afterbabel.com/p/international-crisis-europe" rel="">The Youth Mental Health Crisis is International Part 4: Europe</a></strong></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png" width="597" height="366.8313253012048" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:510,&quot;width&quot;:830,&quot;resizeWidth&quot;:597,&quot;bytes&quot;:218844,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F026ae4ff-6ff6-4a52-bb2e-8022c93827d2_830x510.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p><em><strong>Figure 3. </strong><span>Changes in psychological distress by high vs. low individualism of each country, split by sex. Source: </span><a href="https://hbsc.org/data/" rel="">Health Behavior in School-Age Children Survey, 2002-2018</a><span> (See Zach’s </span><a href="https://docs.google.com/spreadsheets/d/1czZiySSxNHOn6_K6zmXv-t_NheygAaBfHM3zmH1nPDo/edit#gid=204943004" rel="">spreadsheet</a><span> for data points) and </span><a href="https://www.hofstede-insights.com/country-comparison-tool" rel="">Hofstede Insights.</a></em><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-4-143412349" href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic#footnote-4-143412349" target="_self" rel="">4</a></span><span> </span></p><p>Nor can she explain why suicide rates for Gen Z girls (but not always boys) are at record levels across the Anglosphere, as we showed in this post:</p><p><strong><a href="https://www.afterbabel.com/p/anglo-teen-suicide" rel="">Suicide Rates Are Up for Gen Z Across the Anglosphere, Especially for Girls</a></strong></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png" width="996" height="512" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:512,&quot;width&quot;:996,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:138694,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F39f5d67d-b793-4ea5-91f6-ed9ad8f548b3_996x512.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p><em><strong>Figure 4. </strong><span>All datasets and figures can be </span><a href="https://www.afterbabel.com/p/anglo-teen-suicide" rel="">found in the post</a><span>.&nbsp;</span></em></p><p>If Odgers was correct that the “real causes” of the epidemic are America’s social ills, then we would not find these patterns in so many countries. I just can’t see a causal path by which America’s school shootings, lockdown drills, poverty, or racism caused girls in Australia to suddenly start self-harming or dying by suicide at the same time as so many American girls.</p><p>An equally large problem for Odgers’ explanation is that it commits her to the prediction that the increases in mental illness were largest for teens in low SES families. After all, her explanation for why there was a four-year delay between the onset of the GFC and the onset of the mental health crisis was because the effects lasted longer for those “in the bottom 20% of the income distribution,” who “continue to experience harm.”&nbsp;</p><p><a href="https://www.afterbabel.com/p/financial-crisis" rel="">Jean Twenge tested Odgers’ explanation</a><span> by looking to see whether rates of major depressive episodes increased faster for teens in families below the poverty line (shown in red in Figure 5 below) versus those whose families’ incomes were at least double the poverty line (shown in blue). As you can see, there was no difference between the two groups up through 2012 (which is contrary to Odgers’ thesis about the differential impacts of the GFC on mental health), and then a difference opened up after 2012, but in the </span><em>opposite</em><span> direction of Odgers’ prediction.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png" width="591" height="518.8923444976076" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:734,&quot;width&quot;:836,&quot;resizeWidth&quot;:591,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F3bc59bda-d344-4ff6-8477-cda3a19be24d_836x734.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p><em><strong>Figure 5.</strong><span> Percent of U.S. 12- to 17-year-olds experiencing major depressive episodes in the last 12 months, by family income level. Source: Data from the nationally representative </span><a href="https://www.samhsa.gov/data/data-we-collect/nsduh-national-survey-drug-use-and-health" rel="">National Survey of Drug Use and Health</a><span>; analysis by Jean M. Twenge for the Generation Tech Substack.</span></em><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-5-143412349" href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic#footnote-5-143412349" target="_self" rel="">5</a></span><em>&nbsp;</em></p><p><span>Twenge has also addressed </span><a href="https://www.afterbabel.com/p/13-explanations-mental-health-crisis" rel="">13 </a><em><a href="https://www.afterbabel.com/p/13-explanations-mental-health-crisis" rel="">other</a></em><a href="https://www.afterbabel.com/p/13-explanations-mental-health-crisis" rel=""> possible explanations</a><span> for the mental health crisis and shows why they don’t fit the data.</span></p><p>In short: Odgers has pointed to an alternative causal explanation that A) does not fit the timing in the U.S., B) does not fit the social class data in the U.S., and C) does not fit the international scope of the crisis.&nbsp;</p><p data-attrs="{&quot;url&quot;:&quot;https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share&quot;,&quot;text&quot;:&quot;Share&quot;,&quot;action&quot;:null,&quot;class&quot;:null}" data-component-name="ButtonCreateButton"><a href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share" rel=""><span>Share</span></a></p><p>Parents, teachers, and legislators cannot wait any longer; they want to do something about the ever-rising levels of anxiety, distraction, and suffering. Whose policy prescriptions should they follow, given the current state of the evidence and the relative risks and costs associated with each path?&nbsp;</p><p>If leaders and change-makers were to embrace Odgers’ causal theory about the “real causes” rather than being “distracted” by mine, then the way forward is to first solve society’s biggest social problems, most of which we have been working on for decades. Perhaps this time we’ll make more progress, and in ten or twenty years, rates of teen mental illness will begin to decline.&nbsp;</p><p>And if Odger’s causal theory turns out to be wrong? We’ll have spent another decade or two locked in the usual culture war battles over spending on social programs that may or may not be effective, and we will have lost another generation to mental illness.&nbsp;</p><p>In contrast, if leaders and change makers were to embrace my account of the “great rewiring of childhood,” in which the phone-based childhood replaced the play-based childhood, what policy implications follow? That we should roll back the phone-based childhood, especially in elementary school and middle school because of the vital importance of protecting kids during early puberty. More specifically, we’d try to implement these four norms as widely as possible:&nbsp;</p><ol><li><p><em>No smartphones before high school</em><span> (as a norm, not a law; </span><a href="https://www.anxiousgeneration.com/pdfs/for-parents.pdf" rel="">parents can just give younger kids</a><span> flip phones, basic phones, or phone watches).</span></p></li><li><p><em>No social media before 16</em><span> (as a norm, but one that would be much more effective if supported by laws such as the proposed </span><a href="https://www.commonsensemedia.org/sites/default/files/featured-content/files/coppa-2.0-one-pager-2024.pdf" rel="">update to COPPA</a><span>, the </span><a href="https://www.commonsensemedia.org/sites/default/files/featured-content/files/kosa-one-pager-2024_1.pdf" rel="">Kids Online Safety Act</a><span>, state-level </span><a href="https://californiaaadc.com/" rel="">age-appropriate design codes</a><span>, and new social media bills like the bipartisan </span><a href="https://www.washingtonpost.com/opinions/2023/05/11/social-media-cotton-schatz-murphy-britt/" rel="">Protecting Kids on Social Media Act</a><span>, or like the state level bills passed </span><a href="https://socialmedia.utah.gov/" rel="">in Utah</a><span> last year and in </span><a href="https://www.reuters.com/world/us/floridas-desantis-signs-law-restricting-social-media-people-under-16-2024-03-25/" rel="">Florida</a><span> last month).</span></p></li><li><p><em><a href="https://www.anxiousgeneration.com/pdfs/for-educators.pdf" rel="">Phone-free schools</a></em><span> (use phone lockers or Yondr pouches for the whole school day, so that students can </span><a href="https://www.theatlantic.com/ideas/archive/2023/06/ban-smartphones-phone-free-schools-social-media/674304/" rel="">pay attention to their teachers and to each other</a><span>)</span></p></li><li><p><span>More </span><a href="https://letgrow.org/program/parents-and-families/" rel="">independence, free play, and responsibility</a><span> in the real world.</span></p></li></ol><p>Note that these four reforms, taken together, cost almost nothing, have strong bipartisan support, and can be implemented all right now, this year, if we agree to act collectively.</p><p><span>And what if it turns out that I am wrong? What if, in reality, the multinational collapse of adolescent mental health in the early 2010s was not </span><em>caused</em><span> by the arrival of phone-based childhood; it was just a big coincidence. Will kids be damaged by these four norms? I don’t think so. What irreversible harm will be done to children who spend more time listening to their teachers during class, more time playing and exploring together outdoors, and less time sitting alone hunched over a device?</span></p><p><span>We are now 12 years into a public health emergency that began around 2012. In </span><em><a href="https://www.anxiousgeneration.com/" rel="">The Anxious Generation</a><span>,</span></em><span> I offer a detailed explanation of what caused it (drawing on many academic fields) and a detailed path by which we can reverse it. I know of no plausible alternative explanation, nor have I found anyone offering a realistic alternative pathway out.</span></p><p>We certainly need skeptics to challenge alarm-ringers, who sometimes do ring false alarms. God bless the skeptics. But at a certain point, we need to take action based on the most plausible theory, even if we can’t be 100% certain that we have the correct causal theory. I think that point is now.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Stalwart mail server (self-hosted all-in-one mail server) now as an admin webui (185 pts)]]></title>
            <link>https://stalw.art/blog/stalwart-webadmin/</link>
            <guid>39983018</guid>
            <pubDate>Tue, 09 Apr 2024 19:08:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://stalw.art/blog/stalwart-webadmin/">https://stalw.art/blog/stalwart-webadmin/</a>, See on <a href="https://news.ycombinator.com/item?id=39983018">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="__blog-post-container" itemprop="articleBody"><p>We're thrilled to announce the release of <a href="https://github.com/stalwartlabs/mail-server" target="_blank" rel="noopener noreferrer">Stalwart Mail Server</a> version <code>0.7.0</code>, a significant update that brings a wealth of features and improvements to enhance the performance and manageability of your email services. This release marks a pivotal moment in our journey to provide an email server solution that combines ease of use with robust performance, ensuring that your email infrastructure is both secure and efficient.</p><h3 id="introducing-web-based-administration">Introducing Web-Based Administration<a href="#introducing-web-based-administration" aria-label="Direct link to Introducing Web-Based Administration" title="Direct link to Introducing Web-Based Administration">​</a></h3><p><img loading="lazy" alt="Setup screencast" src="https://stalw.art/assets/images/screencast-setup-780bc42a88c6e41ad8925d242c2bf469.gif" width="921" height="532"></p><p>At the heart of version <code>0.7.0</code> is the introduction of a new, web-based administration tool. Developed in Rust, this single-page application (SPA) represents a monumental shift in how you interact with Stalwart Mail Server. Gone are the days of relying on SSH connections or command-line interfaces for routine administration tasks. Now, every aspect of your mail server can be managed from the convenience of a web browser.</p><p>The new web administration tool is designed to streamline and simplify the management of your mail server, offering a wide array of features:</p><ul><li><strong>Complete Control Over Accounts and Domains</strong>: Easily manage user accounts, domains, groups, and mailing lists, all from a user-friendly interface.</li><li><strong>Advanced Queue Management</strong>: Monitor and manage your SMTP queues with ease, including messages and outbound DMARC and TLS reports, ensuring timely delivery and compliance.</li><li><strong>Insightful Report Visualization</strong>: Gain valuable insights into your email security with a dedicated interface for visualizing received DMARC, TLS-RPT, and Failure (ARF) reports.</li><li><strong>Full Configuration Flexibility</strong>: Adjust and fine-tune every aspect of your mail server settings directly from the webadmin, tailored to meet your specific requirements.</li><li><strong>Enhanced Log Viewing and Searching</strong>: Navigate through logs effortlessly with advanced search and filtering capabilities, making it easier to pinpoint issues or monitor activity.</li><li><strong>Self-Service Portal for Users</strong>: Empower your users with a self-service portal for password resets and managing encryption-at-rest keys, enhancing security and convenience.</li></ul><p>This transformative approach to mail server management not only elevates the administration experience but also significantly reduces the complexity and time required to manage your email infrastructure.</p><h3 id="enhanced-performance-and-efficiency">Enhanced Performance and Efficiency<a href="#enhanced-performance-and-efficiency" aria-label="Direct link to Enhanced Performance and Efficiency" title="Direct link to Enhanced Performance and Efficiency">​</a></h3><p>Beyond management improvements, Stalwart Mail Server <code>0.7.0</code> introduces significant performance enhancements to ensure swift and efficient email delivery. A major focus has been placed on optimizing mailbox retrieval speeds to accommodate IMAP clients, particularly those without client-side caching, ensuring that large mailboxes are displayed promptly. This version also integrates automatic compression for messages and binaries stored in the blob store using LZ4, a move that conservatively manages storage space while improving access and transfer speeds. These enhancements collectively ensure that Stalwart Mail Server <code>0.7.0</code> delivers unparalleled performance, making it faster and more efficient than ever before.</p><h3 id="embracing-the-future">Embracing the Future<a href="#embracing-the-future" aria-label="Direct link to Embracing the Future" title="Direct link to Embracing the Future">​</a></h3><p>With the release of version <code>0.7.0</code>, Stalwart Mail Server sets a new standard for email server solutions. The introduction of a web-based administration tool and significant performance improvements underscore our commitment to innovation and excellence. We invite you to experience the future of email server management and performance with Stalwart Mail Server <code>0.7.0</code>.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[GPT-4 Turbo with Vision Generally Available (208 pts)]]></title>
            <link>https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4</link>
            <guid>39982818</guid>
            <pubDate>Tue, 09 Apr 2024 18:53:54 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4">https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4</a>, See on <a href="https://news.ycombinator.com/item?id=39982818">Hacker News</a></p>
Couldn't get https://platform.openai.com/docs/models/gpt-4-turbo-and-gpt-4: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[The Collapse of Small Press Distribution (120 pts)]]></title>
            <link>https://lithub.com/the-small-press-world-is-about-to-fall-apart-on-the-collapse-of-small-press-distribution/</link>
            <guid>39982300</guid>
            <pubDate>Tue, 09 Apr 2024 18:09:29 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lithub.com/the-small-press-world-is-about-to-fall-apart-on-the-collapse-of-small-press-distribution/">https://lithub.com/the-small-press-world-is-about-to-fall-apart-on-the-collapse-of-small-press-distribution/</a>, See on <a href="https://news.ycombinator.com/item?id=39982300">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
							        
									<p><span itemprop="articleBody"><p>Last week, Diane Goettel was on vacation in Florida when she saw an alarming email on her phone. After 55 years, <a href="https://spdbooks.org/" target="_blank">Small Press Distribution</a> (SPD)—one of the last remaining independent book distributors in the US—was shutting down immediately, with no advance notice or transitional support. Its website went dark, its Twitter account was deleted, and no one was answering calls.</p>
<p>“The small press world is about to fall apart,” Goettel remembers thinking. She’s the executive editor of <a href="https://blacklawrencepress.com/" target="_blank">Black Lawrence Press</a>, one of more than 400 publishers that relied on SPD to fulfill online orders and make copies available to bookstores and libraries. “A lot of people are really angry,” Goettel says. “I’m a little angry myself, but mostly I’m sad about the loss of this organization, and afraid of what it means.”</p>
<p>On the other side of the country, the executive editor of <a href="https://www.noemipress.org/" target="_blank">Noemi Press</a>, Sarah Gzemski, was about to hop on a Zoom for her day job at the University of Arizona Poetry Center in Tucson when she received a text about SPD. “We were shocked, [though] some of the fulfillment issues we encountered over the past few months began to make more sense,” Gzemski says. “We’re already working on shoestring budgets, so for our distributor to close abruptly, without warning, while not paying us our earned income, is devastating.”</p>
<p>Distributors are perhaps the most opaque and byzantine part of the publishing industry. When you buy a book on Amazon or Bookshop.org, it’s usually the distributor—not the publisher—who ships you a copy from its warehouse. When bookstores, libraries, and schools order books for their brick-and-mortar locations, they use online catalogs populated by distributors. Even further, most distributors (including SPD, before it vanished) employ sales teams that work to get copies in Barnes &amp; Noble, independent bookstores, and other retail outlets like gift shops.</p>
<p>Without a distributor, presses like Black Lawrence and Noemi are completely cut off from their main sources of income—and for some, SPD might have been the only affordable option left.</p>
<p>“I don’t know where else these presses can go,” says Meg Reid, executive director of the <a href="https://www.hubcity.org/" target="_blank">Hub City Writers Project</a> in Spartanburg, SC. “Larger distributors are going to have sales minimums that might not be financially viable, and self-distribution basically takes them out of the system in terms of getting reviewed in major publications or public radio.”</p>
<p>Reid’s publishing imprint, Hub City Press, is distributed by Publishers Group West, a once-independent distributor that was acquired by Ingram in 2016. Based just outside of Nashville, Ingram is the largest book wholesaler and distributor in the US, with more than 17 million titles available (Ingram is a sponsor of Literary Hub). In its email to publishers last week, SPD said all of its 300,000 books had been transferred to either Ingram or Publishers Storage and Shipping (PSSC) warehouses—but that publishers would have to contact Ingram or PSSC themselves to get their books back.</p>
<span>Right now, the future is extremely uncertain for SPD’s former small presses—but they’re adapting as quickly as they can.</span>
<p>To make matters worse, many small presses say SPD owes them money. “We’re owed upwards of $8,000,” says Gzemski. “We just released three books [at Noemi], and all of the preorder and event order revenue from those books has disappeared. This is an enormous loss for us that impacts how we’ll need to proceed moving forward.”</p>
<p>Back on the east coast, Goettel says SPD owes Black Lawrence Press more than $17,000—an enormous sum for a small press. “It could be devastating. I don’t know what will happen if we don’t receive those funds,” she says. In the meantime, Black Lawrence Press has launched a <a href="https://www.gofundme.com/f/support-black-lawrence-press" target="_blank">GoFundMe campaign</a> to help.</p>
<p>As of this week, it’s unclear when or whether SPD will be able to pay its presses back. “As a California nonprofit, SPD’s dissolution will be overseen by the Superior Court of California, which will determine the equitable disposition of SPD’s remaining assets to the extent all claims from creditors cannot be satisfied,” SPD executive director Kent Watson wrote in his sudden email on March 28.</p>
<p>However, “it’s difficult to say what remaining assets exist,” according to Mary Gannon, executive director of the <a href="https://www.clmp.org/" target="_blank">Community of Literary Magazines &amp; Presses</a> (CLMP), many members of which were distributed by SPD. “Having to submit claims and figure out what may or may not be owed puts a significant burden on these small operations, especially when we’ve heard from some presses that they no longer have access to sales reports,” Gannon says. “Additionally, any presses that want their books returned from either Ingram or PSSC will need to pay for shipping, [which is] an additional cost.”</p>
<p>I contacted Kent Watson at SPD to ask several questions for this story, but didn’t receive a response before publication. Gannon, Gzemski, and Goettel have also attempted to contact Watson, with no response. In his mass email, Watson said that SPD staff had been “reduced to a minimal team that is in the process of winding down operations” and that they “are not able to respond to individual queries.”</p>
<p>Right now, the future is extremely uncertain for SPD’s former small presses—but they’re adapting as quickly as they can. On an emergency Zoom call organized by the CLMP the day after the news broke, representatives from two alternative distributors answered questions from publishers: <a href="https://www.bookmobile.com/distribution-and-fulfillment/print-distribution-to-the-trade-via-itasca-books/" target="_blank">Bookmobile</a>, a Minneapolis-based company long known for its beautiful typesetting and printing services, and <a href="https://asterismbooks.com/for-publishers" target="_blank">Asterism</a>, a newer company founded in 2021 by Joshua Rothes, publisher of his own small press in Seattle, Sublunary Editions.</p>
<p>“I was distributed by SPD for about a year until the troubling allegations about the working environment came to light, which, coupled with the abysmal business terms, made for an easy decision to try something different,” Rothes tells me. He’s referring to <a href="https://damagedbookworker.medium.com/terrorized-by-spd-612014765e7c" target="_blank">an essay published</a> by a former SPD employee, as well as further <a href="https://www.kqed.org/news/11883845/how-former-employees-at-a-berkeley-bastion-for-literary-presses-ignited-a-reckoning" target="_blank">reports in 2021</a> that accused SPD of fostering a toxic workplace and poor labor conditions, as well as “financial issues and mismanagement.”</p>
<p>On the CLMP’s emergency Zoom, some presses were bullish on Asterism thanks to its low costs. But unlike Bookmobile and most other distributors, Asterism doesn’t currently offer returns to retailers, which leaves bookstores on the hook for any copies they ordered but didn’t sell.</p>
<p>“Our returns policy has raised a few eyebrows, but I wouldn’t say we’ve met fierce resistance over it,” Rothes says. “We compromised with bookstores on event orders, [more] than 200 bookstores have signed up for accounts with Asterism so far, and it seems booksellers are generally happy to order fewer copies of more titles, and re-order when they need to.”</p>
<p>Asterism also doesn’t currently distribute to Amazon, a major source of income for many small presses who see it as a necessary evil. “We don’t sell into marketplaces that routinely discount titles below what booksellers can sell them for,” Rothes says, “but we’re not exclusive and don’t demand control over all of our publishers’ sales channels. Publishers can and do manage their own Amazon seller accounts, or take advantage of the integration options through print-on-demand services.”</p>
<p>Still, Rothes says Asterism will continue listening to what small presses need: “We’ll absolutely maintain a dialogue with both booksellers and publishers, old and new, to determine when we might need to compromise or change course.”</p>
<p>The CLMP says they’re exploring even more options in addition to Ingram, which could be prohibitively expensive, and Bookmobile or Asterism, which might be more affordable. “If they have the bandwidth, these presses can also sell their books directly to consumers, but the problem is discoverability,” Gannon says, echoing Meg Reid. “This is a devastating and sudden turn of events, [but those presses are] distinguished by their innovation and resilience.”</p>
<p>“Noemi is exploring all of our options right now,” says Gzemski. “I feel some comfort that we’re in the same boat as everyone else, and rushing into a new distributor without the proper research will not serve us well.”</p>
<p>Goettel is optimistic about Black Lawrence Press, but anxious about the situation more broadly. “I’m not panicking at this point, but I would not be surprised if some small presses completely close because of this.”</p>
<p>Meanwhile, the CLMP is planning on holding future Zooms with Ingram and <a href="https://www.ipgbook.com/ipg-pages-154.php" target="_blank">Independent Publishers Group</a> (IPG), an international distributor based in Chicago with more than 1,000 publishers, including its own parent company, Chicago Review Press, which acquired IPG in 1987.</p>
<p>“The contributions these small presses make is essential to writers, readers, and literature in our country,” says Gannon. “They’re in the business because of their dedication to publishing the work of writers who would otherwise not have a home for their work. [The CLMP is] going to do everything we can to support them and find more robust solutions to make their books available.”</p>
<p>If you’d like to help the small presses impacted by SPD’s sudden closure, you can purchase books directly from their websites, and/or donate funds if they’re nonprofits like Noemi Press, <a href="https://rosemetalpress.com/support-rose-metal-press/" target="_blank">Rose Metal Press</a>, <a href="https://fenceportal.org/support/" target="_blank">Fence</a>, and <a href="https://the-song-cave.com/pages/donate" target="_blank">The Song Cave</a>. Here’s a <a href="https://www.clmp.org/news/presses-previously-distributed-by-spd/" target="_blank">full list of presses</a> that were distributed by SPD as of January 2024, courtesy of the CLMP.</p>
</span></p>
									
																		
																		
									<br><hr>
									
							    										
								</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Cow Magnets (391 pts)]]></title>
            <link>https://www.stanfordmagnets.com/cow-magnets.html</link>
            <guid>39982024</guid>
            <pubDate>Tue, 09 Apr 2024 17:45:00 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.stanfordmagnets.com/cow-magnets.html">https://www.stanfordmagnets.com/cow-magnets.html</a>, See on <a href="https://news.ycombinator.com/item?id=39982024">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                                    <h2><strong>Cow Magnets</strong></h2>
<p><span lang="en">What is a <strong>cow magnet</strong>？Have you ever heard of this <strong><a href="https://www.stanfordmagnets.com/what-are-the-four-types-of-magnets.html">type of magnet</a></strong>? Actually, <strong>c</strong></span><strong>ow magnets</strong> are very popular with farmers, ranchers, and veterinarians since they are a well-known method of&nbsp;preventing hardware disease in cattle. So what’s&nbsp;hardware disease?</p>
<figure id="attachment_35470"><img src="https://www.stanfordmagnets.com/wp-content/uploads/2021/03/Cow_Magnets.jpg" alt="Cow Magnets" width="725" height="453" srcset="https://www.stanfordmagnets.com/wp-content/uploads/2021/03/Cow_Magnets.jpg 725w, https://www.stanfordmagnets.com/wp-content/uploads/2021/03/Cow_Magnets-300x187.jpg 300w, https://www.stanfordmagnets.com/wp-content/uploads/2021/03/Cow_Magnets-600x375.jpg 600w" sizes="(max-width: 725px) 100vw, 725px"><figcaption>Cow Magnets</figcaption></figure>
<h2><strong>About Hardware Disease</strong></h2>
<p>Hardware disease is a common term for bovine traumatic reticulopericarditis. It is usually caused by the ingestion of a sharp, metallic object. These pieces of metal settle in the reticulum and can irritate or penetrate the lining. It is most common in dairy cattle but is occasionally seen in beef cattle. It is very rarely reported in any other ruminants. It can be difficult to conclusively diagnose but can be prevented by the oral administration of a magnet around the time that the animal reaches the age of one year.</p>
<h2><strong>Causes of </strong><strong>Hardware Disease</strong></h2>
<p>Cattle commonly swallow foreign objects, because they do not use their lips to discriminate between materials and they do not completely chew their feed before swallowing.&nbsp;<span lang="en">Sharp metal objects (such as nails or iron wires) are a common cause of hardware diseases.&nbsp;The object travels into the rumen and is then pushed into the reticulum along with the rest of the feed.&nbsp; In some cases, contractions of the reticulum can push the object through part of the reticulum wall into the peritoneal cavity, where it causes severe inflammation.&nbsp;In rare cases, the metal object penetrates the entire wall of the reticulum and can pierce the heart sac, causing pericarditis. Compression by the uterus in late pregnancy, straining during parturition, and mounting during estrus can increase the likelihood of the object penetrating the abdominal wall or the heart sac.</span></p>
<h2><strong>How to prevent the hardware disease?</strong></h2>
<p><span lang="en">A <strong>cow magnet</strong> is a kind of veterinary medical equipment used to treat or prevent hardware diseases of cattle.&nbsp;Traditionally, the cow magnets are strong <strong><a href="https://www.stanfordmagnets.com/alnico-magnets.html">Alnico magnets</a></strong>, in the shape of a smooth rod, about 1 cm by 8 cm (0.4 by 3.1 inches). However, today they are more commonly several ring-shaped <strong><a href="https://www.stanfordmagnets.com/ceramic-ferrite-magnets.html">ferrite magnets</a></strong> attached to a stainless-steel or plastic core, in the same shape as the single-piece original.&nbsp;</span></p>
<p><span lang="en">Newer designs to help increase effectiveness include a cage design, in which the magnet holds metal objects inside a protective plastic framework. Even newer designs include a stronger array of <strong><a href="https://www.stanfordmagnets.com/are-rare-earth-magnets-really-rare.html">rare-earth magnets</a></strong> inside a stainless steel body that resembles the original Alnico design.</span></p>
<p>A rancher or dairy farmer feeds a magnet to each calf at branding time; the magnet settles in the rumen or reticulum and remains there for the life of the animal.&nbsp;The magnet is administered after fasting the cow for 18–24 hours. This is most effective if done to the entire herd before the age of one.</p>
<p>The cow magnet attracts such objects and prevents them from becoming lodged in the animal’s tissue. While the resultant mass of iron remains in the cow’s rumen as a pseudobezoar (an intentionally introduced bezoar), it does not cause the severe problems of hardware disease. Cow magnets cannot be passed through a cow’s 4th bonivial meta-colon.</p>
<p>Cow magnets are widely available from veterinary, feed supply, and scientific supply sources.</p>
<h2><strong>Conclusion&nbsp;</strong></h2>
<p>Thank you for reading our article and we hope it can help you to have a better understanding of the cow magnets. If you want to learn more about magnets, we would like to advise you to visit <strong><a href="https://www.stanfordmagnets.com/">Stanford Magnets</a></strong> for more information.</p>
<p>As a&nbsp;<a href="https://www.stanfordmagnets.com/magnet-manufacturer-and-supplier.html"><strong>leading&nbsp;magnet supplier&nbsp;</strong></a>across the world,&nbsp;<strong>Stanford Magnets</strong>&nbsp;has been involved in R&amp;D, manufacturing, and sales of&nbsp;<span lang="en">magnets</span>&nbsp;since the 1990s. It provides customers with high-quality permanent magnets like&nbsp;<strong><a href="https://www.stanfordmagnets.com/smco-magnets.html">SmCo magnets</a>,</strong>&nbsp;<strong><a href="https://www.samaterials.com/neodymium/1087-neodymium-metal-powder.html">neodymium</a>&nbsp;magnets</strong>,&nbsp;<strong>AlNiCo magnets</strong>, and&nbsp;<strong>ferrite magnets</strong>&nbsp;(ceramic magnets) at a very competitive price.</p>
<p><span></span>
			<span>Post Views: </span>
			<span>35,279</span>
			</p>                                    <p><span>Tags: <a href="https://www.stanfordmagnets.com/tag/alnico-magnets/" rel="tag">Alnico magnets</a>, <a href="https://www.stanfordmagnets.com/4-things-you-should-know-about-ceramic-magnets.html" rel="tag">Ceramic Magnets</a>, <a href="https://www.stanfordmagnets.com/tag/cow-magnet/" rel="tag">Cow Magnet</a>, <a href="https://www.stanfordmagnets.com/where-to-use-neodymium-countersunk-magnets.html-4" rel="tag">ferrite magnets</a>, <a href="https://www.stanfordmagnets.com/tag/hardware-disease/" rel="tag">Hardware Disease</a>, <a href="https://www.stanfordmagnets.com/how-to-choose-a-neodymium-magnet.html-9" rel="tag">leading&nbsp;magnet supplier</a>, <a href="https://www.stanfordmagnets.com/tag/neodymium-magnets/" rel="tag">Neodymium Magnets</a>, <a href="https://www.stanfordmagnets.com/tag/rare-earth-magnets/" rel="tag">rare earth magnets</a>, <a href="https://www.stanfordmagnets.com/everything-you-need-to-know-about-samarium-cobalt-magnets.html" rel="tag">SmCo Magnets</a>, <a href="https://www.stanfordmagnets.com/everything-you-need-to-know-about-rare-earth-magnets.html" rel="tag">Stanford Magnets</a>, <a href="https://www.stanfordmagnets.com/how-to-choose-a-neodymium-magnet.html-5" rel="tag">types of magnet</a></span></p>
                                                                    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[PS1 Programming Course with MIPS Assembly and C (207 pts)]]></title>
            <link>https://pikuma.com/courses/ps1-programming-mips-assembly-language</link>
            <guid>39982011</guid>
            <pubDate>Tue, 09 Apr 2024 17:43:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://pikuma.com/courses/ps1-programming-mips-assembly-language">https://pikuma.com/courses/ps1-programming-mips-assembly-language</a>, See on <a href="https://news.ycombinator.com/item?id=39982011">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

                <!-- THIS COURSE INCLUDES (MOBILE ONLY) -->
                

                <!-- WHAT YOU'LL LEARN -->
                <div>
                        <h2>What you'll <span>learn</span></h2>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/psx-controller.png" alt="PSX programming assembly" width="200">
                            </p>
                            <p>This course is a deep dive into the world of <strong>PlayStation</strong> programming! We'll explore the PS1 hardware, understand its sub-components, and learn how to code games using <strong>MIPS assembler</strong> &amp; the <strong>C programming language</strong>. We'll also learn how to use the official Sony <strong>Psy-Q</strong> libraries on a modern development toolchain to be more productive and push faster 3D polygons out of our console.</p>
                        </div>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/mips-assembler.png" alt="MIPS assembly language" width="220">
                            </p>
                            <p>We are about to enter the 5th generation of 32-bit consoles. This era brings with it many technology milestones, such as the adoption of CPUs based on <strong>RISC architecture</strong> and a preference for coding using a <strong>high-level language</strong> instead of writing games using plain assembly. We will start by learning the basics of MIPS assembly and evolve to use a C compiler with the official Psy-Q library to develop our final project.</p>
                        </div>
                    </div>

                <!-- PROMO VIDEO -->
                <div>
                                <p>
                                    <iframe src="https://www.youtube.com/embed/mPlctVzV4OI" allowfullscreen=""></iframe>
                                </p>
                            </div>

                <!-- TOOLS WE'LL USE -->
                <div>
                        <h2>The <span>tools</span> you'll need</h2>
                        <div>
                            <p>The original development toolchain was designed for Windows/PC, so you can either use the original 32-bit library on a 32-bit operating system (<strong>Windowx XP</strong>), or you can use a modern C compiler with Visual Studio Code on a 64-bit operating system (<strong>Windows 11</strong>). Emulating a Windows system on <strong>macOS</strong> or <strong>Linux</strong> is also possible!</p>
                            <p><img src="https://pikuma.com/images/courses/ps1/os.png" alt="operating system" width="220">
                            </p>
                        </div>
                    </div>

                <!-- IS THIS COURSE FOR YOU -->
                <div>
                        <h2>Is this course for <span>you</span>?</h2>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/wipeout-final-project-small.gif" alt="psx game development">
                            </p>
                            <div>
                                <p>This is a self-contained course teaching concepts from the ground up. However, it <strong>is expected</strong> from students a basic understanding of coding (if-else, loops, functions).</p>
                                <p>If you like retro programming &amp; want to learn more about the early days of 3D games, then this course is definitely for you!</p>
                            </div>
                        </div>
                    </div>

                <!-- ABOUT THE INSTRUCTOR -->
                <div>
                        <h2>About the <span>instructor</span></h2>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/instructor.png" alt="gustavo pezzi" width="220">
                            </p>
                            <div>
                                <p><strong>Gustavo Pezzi</strong> is a university lecturer in London, UK. He has won multiple education awards as a teacher and is also the founder of <a href="https://pikuma.com/">pikuma.com</a>.</p>
                                <p>Gustavo teaches fundamentals of computer science and mathematics; his academic path includes institutions such as Pittsburg State University, City University of London, and University of Oxford.</p>
                            </div>
                        </div>
                    </div>

                <!-- MY TEACHING ACCREDITATIONS -->
                

                <!-- COURSE CONTENT -->
                <div>
                        <h2>Course <span>content</span></h2>
                        <div>
                            <p><span>25 hours total length <span>•</span> 32 Chapters <span>•</span> Last updated April 2024</span></p>
                        </div>
                    </div>

                <!-- WHY IS THIS COURSE DIFFERENT -->
                <div>
                        <h2>How is this course <span>different</span>?</h2>
                        <div>
                            <p>Learning how to create games for the original PlayStation is a great excuse to explore really hardcore <strong>computer science</strong> topics. As we learn different aspects of the 32-bit generation of consoles, we'll touch important concepts like algorithms, data structures, data compression, machine architecture, fixed-point math, computer graphics, and much (much!) more.</p>
                        </div>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/ps1-controller.png" alt="ps1 programming tutorial" width="200">
                            </p>
                        </div>
                        <div>
                            <p>Many new games try to imitate the style and the visuals of old PS1 era using a modern game engine. This is <strong>no imitation</strong>! We'll be flipping bits on the <strong>OG</strong> PlayStation.</p>
                        </div>
                        <div>
                            <p>Many people are surprised that the first part of the course uses <strong>MIPS assembly</strong>. Using an assembler in the early stages of our course allows us to really understand the low-level aspects of the console &amp; really grok how data flow inside the machine.</p>
                        </div>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/cube.gif" alt="psx programming tutorial" width="200">
                            </p>
                        </div>
                        <div>
                            <p>We'll then move away from assembly and climb one layer of abstraction up. We'll work with a <strong>C compiler</strong> paired with the official Sony Psy-Q library. This is where we'll really glue all the concepts that we learned before to consolidate our knowledge with a final big project.</p>
                        </div>
                        <div>
                            <p><img src="https://pikuma.com/images/courses/ps1/wipeout-ship.gif" alt="psxdev tutorial" width="300">
                            </p>
                        </div>
                        <div>
                            <p>At the end of the course, you'll have all the tools and the skills you need to grow and evolve on your own. You'll have a working project running on the PlayStation console and a deep understanding of the theory that underpins the development of PS1 games.</p>
                        </div>
                    </div>

                <!-- LAUREL AND DISCOUNT MESSAGE -->
                <div>
                        <p><span>73%</span> of our students <strong>come back</strong> for another course</p>
                        <p>
                                <img src="https://pikuma.com/images/about/no-discount.png">
                                We <strong>don't</strong> offer discounts on our courses. Ever.</p>
                    </div>

                <!-- TESTIMONIALS -->
                <div>
                        <h2><strong>What students are <span>saying</span></strong></h2>
                        <div>
                                            <table>
                                                <tbody><tr>
                                                    <td>5 star</td>
                                                    <td></td>
                                                    <td>0.0%</td>
                                                </tr>
                                                <tr>
                                                    <td>4 star</td>
                                                    <td></td>
                                                    <td>0.0%</td>
                                                </tr>
                                                <tr>
                                                    <td>3 star</td>
                                                    <td></td>
                                                    <td>0.0%</td>
                                                </tr>
                                                <tr>
                                                    <td>2 star</td>
                                                    <td></td>
                                                    <td>0.0%</td>
                                                </tr>
                                                <tr>
                                                    <td>1 star</td>
                                                    <td></td>
                                                    <td>0.0%</td>
                                                </tr>
                                            </tbody></table>
                                        </div>
                        
                        
                        
                    </div>

                <!-- SIMILAR COURSES -->
                <div>
                        <h2>Other <span>similar</span> courses</h2>
                        
                    </div>
            </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Zed Decoded: Async Rust (205 pts)]]></title>
            <link>https://zed.dev/blog/zed-decoded-async-rust</link>
            <guid>39981945</guid>
            <pubDate>Tue, 09 Apr 2024 17:38:59 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://zed.dev/blog/zed-decoded-async-rust">https://zed.dev/blog/zed-decoded-async-rust</a>, See on <a href="https://news.ycombinator.com/item?id=39981945">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><p><h2><span data-br=":R3brrrqbf9la:" data-brr="1">Zed Decoded: Async Rust</span></h2></p><header></header><p>Welcome to the first article in a new series called <strong>Zed Decoded</strong>. In Zed Decoded I'm going to take a close look at Zed — how it's built, which data structures it uses, which technologies and techniques, what features it has, which bugs we ran into. The best part? I won't do this alone, but get to interview and ask my colleagues here at Zed about everything I want to know.</p>
<div><div><p><b>Companion Video</b>: <!-- -->Async Rust</p><p>This post comes with a 1hr companion video, in which Thorsten and Antonio explore how Zed uses async Rust —&nbsp;in Zed. It's a loose conversation that focuses on the code and dives a bit deeper into some topics that didn't fit into the post.</p><p>Watch the video here:<!-- --> <a href="https://youtu.be/gkU4NGSe21I">https://youtu.be/gkU4NGSe21I</a></p></div><p><img src="https://zed.dev/img/post/zed-decoded-async-rust/thumbnail.jpg" width="230" height="150"></p></div>
<p>The first topic that was on my list: async Rust and how it's used in Zed. Over the past few months I've become quite fascinated with async Rust — Zed's the first codebase I've worked in that uses it — so I decided to sit down and ask Antonio, one of Zed's co-founders, about how we use async Rust in Zed.</p>
<p>We won't get into the details of async Rust itself (familiarity with that is to be expected if you want to understand the nitty-gritty of the code we'll see), but instead focus on how Zed uses async Rust to build a high-performance, native application: what async code looks like on the application level, which runtime it uses, why it uses that runtime.</p>
<h2 id="writing-async-rust-with-gpui"><span data-br=":R4nbrrrqbf9la:" data-brr="1">Writing async Rust with GPUI</span></h2>
<p>Let's jump right into the deep end. Here is a snippet of code that's representative of async code in the Zed codebase:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>fn</span><span> show_cursor_names</span><span>(&amp;</span><span>mut</span><span> self</span><span>, </span><span>cx</span><span>: &amp;</span><span>mut</span><span> ViewContext</span><span>&lt;</span><span>Self</span><span>&gt;) {</span></span>
<span data-line=""><span>    self</span><span>.show_cursor_names = </span><span>true</span><span>;</span></span>
<span data-line=""><span>    cx</span><span>.</span><span>notify</span><span>();</span></span>
<span data-line=""><span>    cx</span><span>.</span><span>spawn</span><span>(|</span><span>this</span><span>, </span><span>mut</span><span> cx</span><span>| </span><span>async</span><span> move</span><span> {</span></span>
<span data-line=""><span>        cx</span><span>.</span><span>background_executor</span><span>().</span><span>timer</span><span>(CURSORS_VISIBLE_FOR).</span><span>await</span><span>;</span></span>
<span data-line=""><span>        this</span><span>.</span><span>update</span><span>(&amp;</span><span>mut</span><span> cx</span><span>, |</span><span>this</span><span>, </span><span>cx</span><span>| {</span></span>
<span data-line=""><span>            this</span><span>.show_cursor_names = </span><span>false</span><span>;</span></span>
<span data-line=""><span>            cx</span><span>.</span><span>notify</span><span>()</span></span>
<span data-line=""><span>        })</span></span>
<span data-line=""><span>        .</span><span>ok</span><span>()</span></span>
<span data-line=""><span>    })</span></span>
<span data-line=""><span>    .</span><span>detach</span><span>();</span></span>
<span data-line=""><span>}</span></span></code></pre></div></figure>
<p>It's <a href="https://github.com/zed-industries/zed/blob/98ddefc8884d0957ab766b3aea09265c8423684e/crates/editor/src/editor.rs#L3935-L3947">a function from our <code>Editor</code></a>. When it's called, Zed shows the names of the owners of each cursor: your name or the names of the people you're collaborating with. It's called, for example, when the editor is re-focused, so you can quickly see who's doing what and where.</p>
<p>What <code>show_cursor_names</code> does is the following:</p>
<ul>
<li>Toggle on <code>Editor.show_cursor_names</code> and trigger a re-render of the editor. When <code>Editor.show_cursor_names</code> is true, cursor names will be rendered.</li>
<li>Spawn a task that sleeps for <code>CURSOR_VISIBLE_FOR</code>, turn the cursors off, and trigger another re-render.</li>
</ul>
<p>If you've ever written async Rust before, you can spot some familiar elements in the code: there's a <code>.spawn</code>, there's an <code>async move</code>, there's an <code>await</code>. And if you've ever used the <code>async_task</code> crate before, this might remind you of code <a href="https://docs.rs/async-task/4.7.0/async_task/struct.Task.html#method.detach">like this</a>:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>let</span><span> ex</span><span> = </span><span>Executor</span><span>::</span><span>new</span><span>();</span></span>
<span data-line=""><span>ex</span><span>.</span><span>spawn</span><span>(</span><span>async</span><span> {</span></span>
<span data-line=""><span>    loop</span><span> {</span></span>
<span data-line=""><span>        Timer</span><span>::</span><span>after</span><span>(</span><span>Duration</span><span>::</span><span>from_secs</span><span>(</span><span>1</span><span>)).</span><span>await</span><span>;</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""><span>})</span></span>
<span data-line=""><span>.</span><span>detach</span><span>();</span></span></code></pre></div></figure>
<p>That's because Zed uses <code>async_task</code> for its <code>Task</code> type. But in this example there's an <code>Executor</code> — where is that in the Zed code? And what does <code>cx.background_executor()</code> do? Good questions, let's find answers.</p>
<h2 id="macos-as-our-async-runtime"><span data-br=":Rdnbrrrqbf9la:" data-brr="1">macOS as our async runtime</span></h2>
<p>One remarkable thing about async Rust is that it allows you to choose your own runtime. That's different from a lot of other languages (such as JavaScript) in which you can also write asynchronous code. Runtime isn't a term with very sharp definition, but for our purposes here, we can say that a runtime is the thing that runs your asynchronous code and provides you with utilities such as <code>.spawn</code> and something like an <code>Executor</code>.</p>
<p>The most popular of these runtimes is probably <a href="https://github.com/tokio-rs/tokio">tokio</a>. But there's also <a href="https://github.com/smol-rs/smol">smol</a>, <a href="https://github.com/embassy-rs/embassy">embassy</a> and others. Choosing and switching runtimes comes with tradeoffs, they <a href="https://corrode.dev/blog/async/">are only interchangable to a degree</a>, but it is possible.</p>
<p>In Zed for macOS, as it turns out, we don't use any one of these. We also don't use <code>async_task</code>'s <code>Executor</code>. But there has to be something to execute the asynchronous code, right? Otherwise I wouldn't be typing these lines in Zed.</p>
<p>So what then does <code>cx.spawn</code> do and what is the <code>cx.background_executor()</code>? Let's take a look. Here are <a href="https://github.com/zed-industries/zed/blob/dc98b3cfa19d6bd4eae813ce7dfaf9d9e13c232c/crates/gpui/src/app.rs#L818-L836">three relevant methods from GPUI's <code>AppContext</code></a>:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>// crates/gpui/src/app.rs</span></span>
<span data-line=""> </span>
<span data-line=""><span>impl</span><span> AppContext</span><span> {</span></span>
<span data-line=""><span>    pub</span><span> fn</span><span> background_executor</span><span>(&amp;</span><span>self</span><span>) -&gt; &amp;</span><span>BackgroundExecutor</span><span> {</span></span>
<span data-line=""><span>        &amp;</span><span>self</span><span>.background_executor</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""> </span>
<span data-line=""><span>    pub</span><span> fn</span><span> foreground_executor</span><span>(&amp;</span><span>self</span><span>) -&gt; &amp;</span><span>ForegroundExecutor</span><span> {</span></span>
<span data-line=""><span>        &amp;</span><span>self</span><span>.foreground_executor</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""> </span>
<span data-line=""><span>    /// Spawns the future returned by the given function on the thread pool. The closure will be invoked</span></span>
<span data-line=""><span>    /// with [AsyncAppContext], which allows the application state to be accessed across await points.</span></span>
<span data-line=""><span>    pub</span><span> fn</span><span> spawn</span><span>&lt;</span><span>Fut</span><span>, </span><span>R</span><span>&gt;(&amp;</span><span>self</span><span>, </span><span>f</span><span>: </span><span>impl</span><span> FnOnce</span><span>(</span><span>AsyncAppContext</span><span>) -&gt; </span><span>Fut</span><span>) -&gt; </span><span>Task</span><span>&lt;</span><span>R</span><span>&gt;</span></span>
<span data-line=""><span>    where</span></span>
<span data-line=""><span>        Fut</span><span>: </span><span>Future</span><span>&lt;</span><span>Output</span><span> = </span><span>R</span><span>&gt; + '</span><span>static</span><span>,</span></span>
<span data-line=""><span>        R</span><span>: '</span><span>static</span><span>,</span></span>
<span data-line=""><span>    {</span></span>
<span data-line=""><span>        self</span><span>.foreground_executor.</span><span>spawn</span><span>(</span><span>f</span><span>(</span><span>self</span><span>.</span><span>to_async</span><span>()))</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""> </span>
<span data-line=""><span>    // [...]</span></span>
<span data-line=""><span>}</span></span></code></pre></div></figure>
<p>Alright, two executors, <code>foreground_executor</code> and <code>background_executor</code>, and both have <code>.spawn</code> methods. We already saw <code>background_executor</code>'s <code>.spawn</code> above in <code>show_cursor_names</code> and here, in <code>AppContext.spawn</code>, we see the <code>foreground_executor</code> counterpart.</p>
<p>One level deeper, we can see what <code>foreground_executor.spawn</code> does:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>// crates/gpui/src/executor.rs</span></span>
<span data-line=""> </span>
<span data-line=""><span>impl</span><span> ForegroundExecutor</span><span> {</span></span>
<span data-line=""><span>    /// Enqueues the given Task to run on the main thread at some point in the future.</span></span>
<span data-line=""><span>    pub</span><span> fn</span><span> spawn</span><span>&lt;</span><span>R</span><span>&gt;(&amp;</span><span>self</span><span>, </span><span>future</span><span>: </span><span>impl</span><span> Future</span><span>&lt;</span><span>Output</span><span> = </span><span>R</span><span>&gt; + '</span><span>static</span><span>) -&gt; </span><span>Task</span><span>&lt;</span><span>R</span><span>&gt;</span></span>
<span data-line=""><span>    where</span></span>
<span data-line=""><span>        R</span><span>: '</span><span>static</span><span>,</span></span>
<span data-line=""><span>    {</span></span>
<span data-line=""><span>        let</span><span> dispatcher</span><span> = </span><span>self</span><span>.dispatcher.</span><span>clone</span><span>();</span></span>
<span data-line=""><span>        fn</span><span> inner</span><span>&lt;</span><span>R</span><span>: '</span><span>static</span><span>&gt;(</span></span>
<span data-line=""><span>            dispatcher</span><span>: </span><span>Arc</span><span>&lt;</span><span>dyn</span><span> PlatformDispatcher</span><span>&gt;,</span></span>
<span data-line=""><span>            future</span><span>: </span><span>AnyLocalFuture</span><span>&lt;</span><span>R</span><span>&gt;,</span></span>
<span data-line=""><span>        ) -&gt; </span><span>Task</span><span>&lt;</span><span>R</span><span>&gt; {</span></span>
<span data-line=""><span>            let</span><span> (</span><span>runnable</span><span>, </span><span>task</span><span>) = </span><span>async_task</span><span>::</span><span>spawn_local</span><span>(</span><span>future</span><span>, </span><span>move</span><span> |</span><span>runnable</span><span>| {</span></span>
<span data-line=""><span>                dispatcher</span><span>.</span><span>dispatch_on_main_thread</span><span>(</span><span>runnable</span><span>)</span></span>
<span data-line=""><span>            });</span></span>
<span data-line=""><span>            runnable</span><span>.</span><span>schedule</span><span>();</span></span>
<span data-line=""><span>            Task</span><span>::</span><span>Spawned</span><span>(</span><span>task</span><span>)</span></span>
<span data-line=""><span>        }</span></span>
<span data-line=""><span>        inner</span><span>::&lt;</span><span>R</span><span>&gt;(</span><span>dispatcher</span><span>, </span><span>Box</span><span>::</span><span>pin</span><span>(</span><span>future</span><span>))</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""> </span>
<span data-line=""><span>    // [...]</span></span>
<span data-line=""><span>}</span></span></code></pre></div></figure>
<p>There's a lot going on here, a lot of syntax, but what happens can be boiled down to this: the <code>.spawn</code> method takes in a <code>future</code>, turns it into a <a href="https://docs.rs/async-task/latest/async_task/struct.Runnable.html"><code>Runnable</code></a> and a <code>Task</code>, and asks the <code>dispatcher</code> to run it on the main thread.</p>
<p>The <code>dispatcher</code> here is a <code>PlatformDispatcher</code>. That's the GPUI equivalent of <code>async_task</code>'s <code>Executor</code> from above. It has <code>Platform</code> in its name because it has different implementations for macOS, Linux, and Windows. But in this post, we're only going to look at macOS, since that's our best-supported platform at the moment and Linux/Windows implementations are still work-in-progress.</p>
<p>So what does <code>dispatch_on_main_thread</code> do? Does <em>this</em> now call an async runtime? No, no runtime <a href="https://github.com/zed-industries/zed/blob/dc98b3cfa19d6bd4eae813ce7dfaf9d9e13c232c/crates/gpui/src/platform/mac/dispatcher.rs#L66-L75">there either</a>:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>// crates/gpui/src/platform/mac/dispatcher.rs</span></span>
<span data-line=""> </span>
<span data-line=""><span>impl</span><span> PlatformDispatcher</span><span> for</span><span> MacDispatcher</span><span> {</span></span>
<span data-line=""><span>    fn</span><span> dispatch_on_main_thread</span><span>(&amp;</span><span>self</span><span>, </span><span>runnable</span><span>: </span><span>Runnable</span><span>) {</span></span>
<span data-line=""><span>        unsafe</span><span> {</span></span>
<span data-line=""><span>            dispatch_async_f</span><span>(</span></span>
<span data-line=""><span>                dispatch_get_main_queue</span><span>(),</span></span>
<span data-line=""><span>                runnable</span><span>.</span><span>into_raw</span><span>().</span><span>as_ptr</span><span>() </span><span>as</span><span> *</span><span>mut</span><span> c_void</span><span>,</span></span>
<span data-line=""><span>                Some</span><span>(</span><span>trampoline</span><span>),</span></span>
<span data-line=""><span>            );</span></span>
<span data-line=""><span>        }</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""><span>    // [...]</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>extern</span><span> "C"</span><span> fn</span><span> trampoline</span><span>(</span><span>runnable</span><span>: *</span><span>mut</span><span> c_void</span><span>) {</span></span>
<span data-line=""><span>    let</span><span> task</span><span> = </span><span>unsafe</span><span> { </span><span>Runnable</span><span>::&lt;()&gt;::</span><span>from_raw</span><span>(</span><span>NonNull</span><span>::</span><span>new_unchecked</span><span>(</span><span>runnable</span><span> as</span><span> *</span><span>mut</span><span> ())) };</span></span>
<span data-line=""><span>    task</span><span>.</span><span>run</span><span>();</span></span>
<span data-line=""><span>}</span></span></code></pre></div></figure>
<p><code>dispatch_async_f</code> is where the call leaves the Zed codebase, because <code>dispatch_async_f</code> is actually a compile-time generated binding to the <a href="https://developer.apple.com/documentation/dispatch/1452834-dispatch_async_f"><code>dispatch_async_f</code></a> function in <a href="https://developer.apple.com/documentation/DISPATCH">macOS' Grand Central Dispatch's (GCD)</a>. <code>dispatch_get_main_queue()</code>, too, is such a binding.</p>
<p>That's right: Zed, as a macOS application, uses macOS' GCD to schedule and execute work.</p>
<p>What happens in the snippet above is that Zed turns the <code>Runnable</code> — think of it as a handle to a <code>Task</code> — into a raw pointer and passes it to <code>dispatch_async_f</code> along with a <code>trampoline</code>, which puts it on its <code>main_queue</code>.</p>
<p>When GCD then decides it's time to run the next item on the <code>main_queue</code>, it pops it off the queue, and calls <code>trampoline</code>, which takes the raw pointer, turns it back into a <code>Runnable</code> and, to poll the <code>Future</code> behind its <code>Task</code>, calls <code>.run()</code> on it.</p>
<p>And, as I learned to my big surprise: that's it. That's essentially all the code necessary to use GCD as a "runtime" for async Rust. Where other applications use tokio or smol, Zed uses thin wrappers around GCD and crates such as <code>async_task</code>.</p>
<p>Wait, but what about the <code>BackgroundExecutor</code>? It's very, very similar to the <code>ForegroundExecutor</code>, with the main difference being that the <code>BackgroundExecutor</code> calls this method on <code>PlatformDispatcher</code>:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>impl</span><span> PlatformDispatcher</span><span> for</span><span> MacDispatcher</span><span> {</span></span>
<span data-line=""><span>    fn</span><span> dispatch</span><span>(&amp;</span><span>self</span><span>, </span><span>runnable</span><span>: </span><span>Runnable</span><span>, </span><span>_</span><span>: </span><span>Option</span><span>&lt;</span><span>TaskLabel</span><span>&gt;) {</span></span>
<span data-line=""><span>        unsafe</span><span> {</span></span>
<span data-line=""><span>            dispatch_async_f</span><span>(</span></span>
<span data-line=""><span>                dispatch_get_global_queue</span><span>(DISPATCH_QUEUE_PRIORITY_HIGH.</span><span>try_into</span><span>().</span><span>unwrap</span><span>(), </span><span>0</span><span>),</span></span>
<span data-line=""><span>                runnable</span><span>.</span><span>into_raw</span><span>().</span><span>as_ptr</span><span>() </span><span>as</span><span> *</span><span>mut</span><span> c_void</span><span>,</span></span>
<span data-line=""><span>                Some</span><span>(</span><span>trampoline</span><span>),</span></span>
<span data-line=""><span>            );</span></span>
<span data-line=""><span>        }</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""><span>}</span></span></code></pre></div></figure>
<p>The only difference between this <code>dispatch</code> method and <code>dispatch_async_f</code> from above is the queue. The <code>BackgroundExecutor</code> doesn't use the <code>main_queue</code>, but <a href="https://developer.apple.com/documentation/dispatch/1452927-dispatch_get_global_queue?language=objc">a global queue</a>.</p>
<p>Like I did when I first read through this code, you now might wonder: why?</p>
<p>Why use GCD? Why have a <code>ForegroundExecutor</code> and a <code>BackgroundExecutor</code>? What's so special about the <code>main_queue</code>?</p>
<h2 id="never-block-the-main-thread"><span data-br=":R14nbrrrqbf9la:" data-brr="1">Never block the main thread</span></h2>
<p>In a native UI application, the main thread is important. No, the main thread is <em>holy</em>. The main thread is where the rendering happens, where user input is handled, where the operating system communicates with the application. The main thread should never, ever block. On the main thread, the responsiveness of your app lives or dies.</p>
<p>That's true for <a href="https://en.wikipedia.org/wiki/Cocoa_(API)">Cocoa</a> applications on macOS too. Rendering, receiving user input, communication with macOS, and other platform concerns have to happen on the main thread. And since Zed wants perfect cooperation with macOS to ensure high-performance and responsiveness, it does two things.</p>
<p>First, it uses GCD to schedule its work — on and off the main thread — so that macOS can maintain high responsiveness and overall system efficiency.</p>
<p>Second, the importance of the main thread is baked into GPUI, the UI framework, by explicitly making the distinction between the <code>ForegroundExecutor</code> and the <code>BackgroundExecutor</code>, both of which we saw above.</p>
<p>As a writer of application-level Zed code, you should always be mindful of what happens on the main thread and never put too much blocking work on it. If you were to put, say, a blocking <code>sleep(10ms)</code> on the main thread, rendering the UI now has to wait for that <code>sleep()</code> to finish, which means that rendering the next frame would take longer than 8ms — the maximum frame time available if you want to achieve <a href="https://zed.dev/blog/120fps">120 FPS</a>. You'd "drop a frame", as they say.</p>
<p>Knowing that, let's take a look at another small snippet of code. This time it's from the built-in terminal in Zed, a function that <a href="https://github.com/zed-industries/zed/blob/dc98b3cfa19d6bd4eae813ce7dfaf9d9e13c232c/crates/terminal/src/terminal.rs#L1346-L1358">searches through the contents of the terminal buffer</a>:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>// crates/terminal/src/terminal.rs</span></span>
<span data-line=""> </span>
<span data-line=""><span>pub</span><span> struct</span><span> Terminal</span><span> {</span></span>
<span data-line=""><span>    term</span><span>: </span><span>Arc</span><span>&lt;</span><span>Mutex</span><span>&lt;</span><span>alacritty_terminal</span><span>::</span><span>Term</span><span>&lt;</span><span>ZedListener</span><span>&gt;&gt;&gt;,</span></span>
<span data-line=""> </span>
<span data-line=""><span>    // [... other fields ...]</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>pub</span><span> fn</span><span> find_matches</span><span>(</span></span>
<span data-line=""><span>    &amp;</span><span>mut</span><span> self</span><span>,</span></span>
<span data-line=""><span>    mut</span><span> searcher</span><span>: </span><span>RegexSearch</span><span>,</span></span>
<span data-line=""><span>    cx</span><span>: &amp;</span><span>mut</span><span> ModelContext</span><span>&lt;</span><span>Self</span><span>&gt;,</span></span>
<span data-line=""><span>) -&gt; </span><span>Task</span><span>&lt;</span><span>Vec</span><span>&lt;</span><span>RangeInclusive</span><span>&lt;</span><span>AlacPoint</span><span>&gt;&gt;&gt; {</span></span>
<span data-line=""><span>    let</span><span> term</span><span> = </span><span>self</span><span>.term.</span><span>clone</span><span>();</span></span>
<span data-line=""><span>    cx</span><span>.</span><span>background_executor</span><span>().</span><span>spawn</span><span>(</span><span>async</span><span> move</span><span> {</span></span>
<span data-line=""><span>        let</span><span> term</span><span> = </span><span>term</span><span>.</span><span>lock</span><span>();</span></span>
<span data-line=""> </span>
<span data-line=""><span>        all_search_matches</span><span>(&amp;</span><span>term</span><span>, &amp;</span><span>mut</span><span> searcher</span><span>).</span><span>collect</span><span>()</span></span>
<span data-line=""><span>    })</span></span>
<span data-line=""><span>}</span></span></code></pre></div></figure>
<p>The first line in <code>find_matches</code>, the <code>self.term.clone()</code>, happens on the main thread and is quick: <code>self.term</code> is an <code>Arc&lt;Mutex&lt;...&gt;&gt;</code>, so cloning only bumps the reference count on the <code>Arc</code>. The call to <code>.lock()</code> then only happens in the background, since <code>.lock()</code> might block. It's unlikely that there will be contention for this lock in this particular code path, but if there was contention, it wouldn't freeze the UI, only a single background thread. That's the pattern: if it's quick, you can do it on the main thread, but if it might take a while or even block, put it on a background thread by using <code>cx.background_executor()</code>.</p>
<p>Here's another example, the project-wide search in Zed (<code>⌘-shift-f</code>). It pushes as much heavy work as possible onto background threads to ensure Zed stays responsive while searching through tens of thousands of files in your project. Here's a simplified and heavily-commented <a href="https://github.com/zed-industries/zed/blob/dc98b3cfa19d6bd4eae813ce7dfaf9d9e13c232c/crates/project/src/project.rs#L6485-L6498">excerpt from <code>Project.search_local</code></a> that shows the main part of the search:</p>
<figure data-rehype-pretty-code-figure=""><div><pre tabindex="0" data-language="rust" data-theme="light-plus"><code data-language="rust" data-theme="light-plus"><span data-line=""><span>// crates/project/src/project.rs</span></span>
<span data-line=""> </span>
<span data-line=""><span>// Spawn a Task on the background executor. The Task finds all files on disk</span></span>
<span data-line=""><span>// that contain &gt;1 matches for the given `query` and sends them back over</span></span>
<span data-line=""><span>// the `matching_paths_tx` channel.</span></span>
<span data-line=""><span>let</span><span> (</span><span>matching_paths_tx</span><span>, </span><span>matching_paths_rx</span><span>) = </span><span>smol</span><span>::</span><span>channel</span><span>::</span><span>bounded</span><span>(</span><span>1024</span><span>);</span></span>
<span data-line=""><span>cx</span><span>.</span><span>background_executor</span><span>()</span></span>
<span data-line=""><span>    .</span><span>spawn</span><span>(</span><span>Self</span><span>::</span><span>background_search</span><span>(</span></span>
<span data-line=""><span>        // [... other arguments ... ]</span></span>
<span data-line=""><span>        query</span><span>.</span><span>clone</span><span>(),</span></span>
<span data-line=""><span>        matching_paths_tx</span><span>,</span></span>
<span data-line=""><span>    ))</span></span>
<span data-line=""><span>    .</span><span>detach</span><span>();</span></span>
<span data-line=""> </span>
<span data-line=""><span>// Setup a channel on which we stream results to the UI.</span></span>
<span data-line=""><span>let</span><span> (</span><span>result_tx</span><span>, </span><span>result_rx</span><span>) = </span><span>smol</span><span>::</span><span>channel</span><span>::</span><span>bounded</span><span>(</span><span>1024</span><span>);</span></span>
<span data-line=""> </span>
<span data-line=""><span>// On the main thread, spawn a Task that first...</span></span>
<span data-line=""><span>cx</span><span>.</span><span>spawn</span><span>(|</span><span>this</span><span>, </span><span>mut</span><span> cx</span><span>| </span><span>async</span><span> move</span><span> {</span></span>
<span data-line=""><span>    // ... waits for the background thread to return the filepaths of</span></span>
<span data-line=""><span>    // the maximum number of files that we want to search...</span></span>
<span data-line=""><span>    let</span><span> mut</span><span> matching_paths</span><span> = </span><span>matching_paths_rx</span></span>
<span data-line=""><span>        .</span><span>take</span><span>(MAX_SEARCH_RESULT_FILES + </span><span>1</span><span>)</span></span>
<span data-line=""><span>        .</span><span>collect</span><span>::&lt;</span><span>Vec</span><span>&lt;</span><span>_</span><span>&gt;&gt;()</span></span>
<span data-line=""><span>        .</span><span>await</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>    // ... then loops over the filepaths in chunks of 64...</span></span>
<span data-line=""><span>    for</span><span> matching_paths_chunk</span><span> in</span><span> matching_paths</span><span>.</span><span>chunks</span><span>(</span><span>64</span><span>) {</span></span>
<span data-line=""><span>        let</span><span> mut</span><span> chunk_results</span><span> = </span><span>Vec</span><span>::</span><span>new</span><span>();</span></span>
<span data-line=""> </span>
<span data-line=""><span>        for</span><span> matching_path</span><span> in</span><span> matching_paths_chunk</span><span> {</span></span>
<span data-line=""><span>            // .... opens each file....</span></span>
<span data-line=""><span>            let</span><span> buffer</span><span> = </span><span>this</span><span>.</span><span>update</span><span>(&amp;</span><span>mut</span><span> cx</span><span>, |</span><span>this</span><span>, </span><span>cx</span><span>| {</span></span>
<span data-line=""><span>                this</span><span>.</span><span>open_buffer</span><span>((*</span><span>worktree_id</span><span>, </span><span>path</span><span>.</span><span>clone</span><span>()), </span><span>cx</span><span>)</span></span>
<span data-line=""><span>            })?;</span></span>
<span data-line=""> </span>
<span data-line=""><span>            // ... and pushes into `chunk_results` a Task that</span></span>
<span data-line=""><span>            // runs on the main thread and ...</span></span>
<span data-line=""><span>            chunk_results</span><span>.</span><span>push</span><span>(</span><span>cx</span><span>.</span><span>spawn</span><span>(|</span><span>cx</span><span>| </span><span>async</span><span> move</span><span> {</span></span>
<span data-line=""><span>                // ... waits for the file to be opened ...</span></span>
<span data-line=""><span>                let</span><span> buffer</span><span> = </span><span>buffer</span><span>.</span><span>await</span><span>?;</span></span>
<span data-line=""><span>                // ... creates a snapshot of its contents ...</span></span>
<span data-line=""><span>                let</span><span> snapshot</span><span> = </span><span>buffer</span><span>.</span><span>read_with</span><span>(&amp;</span><span>cx</span><span>, |</span><span>buffer</span><span>, </span><span>_</span><span>| </span><span>buffer</span><span>.</span><span>snapshot</span><span>())?;</span></span>
<span data-line=""><span>                // ... and again starts a Task on the background executor,</span></span>
<span data-line=""><span>                // which searches through the snapshot for all results.</span></span>
<span data-line=""><span>                let</span><span> ranges</span><span> = </span><span>cx</span></span>
<span data-line=""><span>                    .</span><span>background_executor</span><span>()</span></span>
<span data-line=""><span>                    .</span><span>spawn</span><span>(</span><span>async</span><span> move</span><span> {</span></span>
<span data-line=""><span>                        query</span></span>
<span data-line=""><span>                            .</span><span>search</span><span>(&amp;</span><span>snapshot</span><span>, </span><span>None</span><span>)</span></span>
<span data-line=""><span>                            .</span><span>await</span></span>
<span data-line=""><span>                            .</span><span>iter</span><span>()</span></span>
<span data-line=""><span>                            .</span><span>collect</span><span>::&lt;</span><span>Vec</span><span>&lt;</span><span>_</span><span>&gt;&gt;()</span></span>
<span data-line=""><span>                    })</span></span>
<span data-line=""><span>                    .</span><span>await</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>                Ok</span><span>((</span><span>buffer</span><span>, </span><span>ranges</span><span>))</span></span>
<span data-line=""><span>            }));</span></span>
<span data-line=""><span>        }</span></span>
<span data-line=""> </span>
<span data-line=""><span>        // On the main thread, non-blocking, wait for all buffers to be searched...</span></span>
<span data-line=""><span>        let</span><span> chunk_results</span><span> = </span><span>futures</span><span>::</span><span>future</span><span>::</span><span>join_all</span><span>(</span><span>chunk_results</span><span>).</span><span>await</span><span>;</span></span>
<span data-line=""><span>        for</span><span> result</span><span> in</span><span> chunk_results</span><span> {</span></span>
<span data-line=""><span>            if</span><span> let</span><span> Some</span><span>((</span><span>buffer</span><span>, </span><span>ranges</span><span>)) = </span><span>result</span><span>.</span><span>log_err</span><span>() {</span></span>
<span data-line=""><span>                // send the results over the results channel</span></span>
<span data-line=""><span>                result_tx</span></span>
<span data-line=""><span>                    .</span><span>send</span><span>(</span><span>SearchResult</span><span>::</span><span>Buffer</span><span> { </span><span>buffer</span><span>, </span><span>ranges</span><span> })</span></span>
<span data-line=""><span>                    .</span><span>await</span><span>?;</span></span>
<span data-line=""><span>            }</span></span>
<span data-line=""><span>        }</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""><span>})</span></span>
<span data-line=""><span>.</span><span>detach</span><span>();</span></span>
<span data-line=""> </span>
<span data-line=""><span>result_rx</span></span></code></pre></div></figure>
<p>It's a lot of code — sorry! — but there's not a lot more going on than the concepts we already talked about. What's noteworthy here and why I wanted to show it is the ping-pong between the main thread and background threads:</p>
<ul>
<li><strong>main thread</strong>: kicks off the search and hands the <code>query</code> over to background thread</li>
<li><strong>background thread</strong>: finds files in project with &gt;1 occurrences of <code>query</code> in them, sends results back over channel as they come in</li>
<li><strong>main thread</strong>: waits until background thread has found <code>MAX+1</code> results, then drops channel, which causes background thread to exit</li>
<li><strong>main thread</strong>: spawns multiple other main-thread tasks to open each file &amp; create a snapshot.</li>
<li><strong>background threads</strong>: search through buffer snapshot to find all results in a buffer, sends results back over channel</li>
<li><strong>main thread</strong>: waits for background thread to find results in all buffers, then sends them back to the caller of the outer <code>search_local</code> method</li>
</ul>
<p>Even though this method can be optimized and the search made a lot faster (we haven't gotten around to that yet), it can already search thousands of files without blocking the main thread, while still using multiple CPU cores.</p>
<h2 id="async-friendly-data-structures-testing-executors-and-more"><span data-br=":R1inbrrrqbf9la:" data-brr="1">Async-Friendly Data Structures, Testing Executors, and More</span></h2>
<p>I'm pretty sure that the previous code excerpt raised a lot of questions that I haven't answered yet: how exactly is it possible to send a buffer snapshot to a background thread? How efficient is it do that? What if I want to modify such a snapshot on another thread? How do you test all this?</p>
<p>And I'm sorry to say that I couldn't fit all of the answers into this post. But there is a <a href="https://youtu.be/gkU4NGSe21I">companion video</a> in which Antonio and I did dive into a lot of these areas and talked about async-friendly data structures, copy-on-write buffer snapshots, and other things. Antonio also gave <a href="https://www.youtube.com/watch?v=ms8zKpS_dZE">a fantastic talk about how we do property-testing of async Rust code</a> in the Zed code base that I highly recommend. I also promise that in the future there will be a post about the data structures underlying the Zed editor.</p>
<p>Until next time!</p><hr></article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[ScreenAI: A visual LLM for UI and visually-situated language understanding (227 pts)]]></title>
            <link>https://research.google/blog/screenai-a-visual-language-model-for-ui-and-visually-situated-language-understanding/</link>
            <guid>39981623</guid>
            <pubDate>Tue, 09 Apr 2024 17:15:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://research.google/blog/screenai-a-visual-language-model-for-ui-and-visually-situated-language-understanding/">https://research.google/blog/screenai-a-visual-language-model-for-ui-and-visually-situated-language-understanding/</a>, See on <a href="https://news.ycombinator.com/item?id=39981623">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                
                    <section>
                        
                        



<p>We introduce ScreenAI, a vision-language model for user interfaces and infographics that achieves state-of-the-art results on UI and infographics-based tasks. We are also releasing three new datasets: Screen Annotation to evaluate the layout understanding capability of the model, as well as ScreenQA Short and Complex ScreenQA for a more comprehensive evaluation of its QA capability.</p>
                        
                    </section>
                
                
                
                


<div>
        <p data-block-key="df7wk">Screen user interfaces (UIs) and infographics, such as charts, diagrams and tables, play important roles in human communication and human-machine interaction as they facilitate rich and interactive user experiences. UIs and infographics share similar design principles and visual language (e.g., icons and layouts), that offer an opportunity to build a single model that can understand, reason, and interact with these interfaces. However, because of their complexity and varied presentation formats, infographics and UIs present a unique modeling challenge.</p><p data-block-key="9f7at">To that end, we introduce “<a href="https://arxiv.org/abs/2402.04615" target="_blank" rel="noopener noreferrer">ScreenAI: A Vision-Language Model for UI and Infographics Understanding</a>”. ScreenAI improves upon the <a href="https://arxiv.org/abs/2305.18565" target="_blank" rel="noopener noreferrer">PaLI architecture</a> with the flexible patching strategy from <a href="https://arxiv.org/abs/2210.03347" target="_blank" rel="noopener noreferrer">pix2struct</a>. We train ScreenAI on a unique mixture of datasets and tasks, including a novel Screen Annotation task that requires the model to identify UI element information (i.e., type, location and description) on a screen. These text annotations provide large language models (LLMs) with screen descriptions, enabling them to automatically generate question-answering (QA), UI navigation, and summarization training datasets at scale. At only 5B parameters, ScreenAI achieves state-of-the-art results on UI- and infographic-based tasks (<a href="https://x-lance.github.io/WebSRC/" target="_blank" rel="noopener noreferrer">WebSRC</a> and <a href="https://github.com/aburns4/MoTIF" target="_blank" rel="noopener noreferrer">MoTIF</a>), and best-in-class performance on <a href="https://github.com/vis-nlp/ChartQA" target="_blank" rel="noopener noreferrer">Chart QA</a>, <a href="https://rrc.cvc.uab.es/?ch=17&amp;com=evaluation&amp;task=1" target="_blank" rel="noopener noreferrer">DocVQA</a>, and <a href="https://arxiv.org/abs/2104.12756" target="_blank" rel="noopener noreferrer">InfographicVQA</a> compared to models of similar size. We are also releasing three new datasets: <a href="https://github.com/google-research-datasets/screen_qa?tab=readme-ov-file#screen-annotation-dataset-details" target="_blank" rel="noopener noreferrer">Screen Annotation</a> to evaluate the layout understanding capability of the model, as well as <a href="https://github.com/google-research-datasets/screen_qa/tree/main?tab=readme-ov-file#short_answers-directory" target="_blank" rel="noopener noreferrer">ScreenQA Short</a> and <a href="https://github.com/google-research-datasets/screen_qa?tab=readme-ov-file#complexqa" target="_blank" rel="noopener noreferrer">Complex ScreenQA</a> for a more comprehensive evaluation of its QA capability.</p>
    </div>

                
                


<section>
    
    <p>
        <h2 data-block-key="df7wk">ScreenAI</h2>
    </p>


    
</section>

                
                


<div>
        <p data-block-key="df7wk">ScreenAI’s architecture is based on <a href="https://arxiv.org/abs/2209.06794" target="_blank" rel="noopener noreferrer">PaLI</a>, composed of a multimodal encoder block and an autoregressive decoder. The PaLI encoder uses a <a href="https://arxiv.org/abs/2010.11929" target="_blank" rel="noopener noreferrer">vision transformer</a> (ViT) that creates image embeddings and a multimodal encoder that takes the concatenation of the image and text embeddings as input. This flexible architecture allows ScreenAI to solve vision tasks that can be recast as text+image-to-text problems.</p><p data-block-key="fnskt">On top of the PaLI architecture, we employ a flexible patching strategy introduced in pix2struct. Instead of using a fixed-grid pattern, the grid dimensions are selected such that they preserve the native aspect ratio of the input image. This enables ScreenAI to work well across images of various aspect ratios.</p><p data-block-key="bnr6j">The ScreenAI model is trained in two stages: a pre-training stage followed by a fine-tuning stage. First, self-supervised learning is applied to automatically generate data labels, which are then used to train ViT and the language model. ViT is frozen during the fine-tuning stage, where most data used is manually labeled by human raters.</p>
    </div>

                
                
    

<!-- mode: &#x27;&#x27; -->


  
    <div>
      <video playsinline="" muted="true" loop="true" preload="auto">
        <source src="https://storage.googleapis.com/gweb-research2023-media/media/ScreenAI-model.mp4" type="video/mp4">
      </video>
      <div aria-label="Video Play/pause">
        <p><span>play silent looping video</span>
          <span>pause silent looping video</span>
        </p>
        
      </div>
      
      <p data-block-key="f4d4n">ScreenAI model architecture.</p>
      
    </div>
  



                
                


<section>
    
    <p>
        <h2 data-block-key="xjbkq">Data generation</h2>
    </p>


    
</section>

                
                


<section>
    
    <p data-block-key="xjbkq">To create a pre-training dataset for ScreenAI, we first compile an extensive collection of screenshots from various devices, including desktops, mobile, and tablets. This is achieved by using <a href="https://arxiv.org/abs/1910.10683" target="_blank" rel="noopener noreferrer">publicly accessible web pages</a> and following the programmatic exploration approach used for the <a href="https://dl.acm.org/doi/10.1145/3126594.3126651" target="_blank" rel="noopener noreferrer">RICO dataset</a> for mobile apps. We then apply a layout annotator, based on the <a href="https://arxiv.org/abs/2005.12872" target="_blank" rel="noopener noreferrer">DETR</a> model, that identifies and labels a wide range of UI elements (e.g., image, pictogram, button, text) and their spatial relationships. Pictograms undergo further analysis using an <a href="https://arxiv.org/abs/2210.02663" target="_blank" rel="noopener noreferrer">icon classifier</a> capable of distinguishing 77 different icon types. This detailed classification is essential for interpreting the subtle information conveyed through icons. For icons that are not covered by the classifier, and for infographics and images, we use the PaLI image captioning model to generate descriptive captions that provide contextual information. We also apply an <a href="https://cloud.google.com/use-cases/ocr" target="_blank" rel="noopener noreferrer">optical character recognition</a> (OCR) engine to extract and annotate textual content on screen. We combine the OCR text with the previous annotations to create a detailed description of each screen.</p>


    
</section>

                
                
    

<!-- mode: &#x27;&#x27; -->


  
    
    
    <picture>
      
      
      <source media="(min-width: 768px)" srcset="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-2.width-800.png" alt="ScreenAI-2">
      
      <img src="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-2.width-800.png" alt="ScreenAI-2" loading="lazy">
      
        <p data-block-key="f4d4n">A mobile app screenshot with generated annotations that include UI elements and their descriptions, e.g., TEXT elements also contain the text content from OCR, IMAGE elements contain image captions, LIST_ITEMs contain all their child elements.</p>
      
    </picture>
  



                
                


<section>
    
    <p>
        <h3 data-block-key="xjbkq">LLM-based data generation</h3>
    </p>


    
</section>

                
                


<section>
    
    <p data-block-key="xjbkq">We enhance the pre-training data's diversity using <a href="https://blog.google/technology/ai/google-palm-2-ai-large-language-model/" target="_blank" rel="noopener noreferrer">PaLM 2</a> to generate input-output pairs in a two-step process. First, screen annotations are generated using the technique outlined above, then we craft a prompt around this schema for the LLM to create synthetic data. This process requires prompt engineering and iterative refinement to find an effective prompt. We assess the generated data's quality through human validation against a quality threshold.</p>


    
</section>

                
                <div>
  <p><code data-block-key="5c1oc">You only speak JSON. Do not write text that isn’t JSON.<br>You are given the following mobile screenshot, described in words. Can you generate 5 questions regarding the content of the screenshot as well as the corresponding short answers to them? <p>The answer should be as short as possible, containing only the necessary information. Your answer should be structured as follows:<br>questions: [<br>{{question: the question,<br>    answer: the answer<br>}},<br> ...<br>]</p><p>{THE SCREEN SCHEMA}</p></code></p>
  <p data-block-key="v2dgk">A sample prompt for QA data generation.</p>
</div>
                
                


<div>
        <p data-block-key="xjbkq">By combining the natural language capabilities of LLMs with a structured schema, we simulate a wide range of user interactions and scenarios to generate synthetic, realistic tasks. In particular, we generate three categories of tasks:</p><ul><li data-block-key="dvi3e"><b>Question answering</b>: The model is asked to answer questions regarding the content of the screenshots, e.g., “When does the restaurant open?”</li><li data-block-key="7isdo"><b>Screen navigation</b>: The model is asked to convert a natural language utterance into an executable action on a screen, e.g., “Click the search button.”</li><li data-block-key="a56rn"><b>Screen summarization</b>: The model is asked to summarize the screen content in one or two sentences.</li></ul>
    </div>

                
                
    

<!-- mode: &#x27;&#x27; -->


  
    
    
    <picture>
      
      
      <source media="(min-width: 768px)" srcset="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-3.width-800.png" alt="ScreenAI-3">
      
      <img src="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-3.width-800.png" alt="ScreenAI-3" loading="lazy">
      
        <p data-block-key="f4d4n">Block diagram of our workflow for generating data for QA, summarization and navigation tasks using existing ScreenAI models and LLMs. Each task uses a custom prompt to emphasize desired aspects, like questions related to counting, involving reasoning, etc.</p>
      
    </picture>
  



                
                
    

<!-- mode: &#x27;&#x27; -->


  
    
    
    <picture>
      
      
      <source media="(min-width: 768px)" srcset="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-1.width-800.png" alt="ScreenAI-1">
      
      <img src="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-1.width-800.png" alt="ScreenAI-1" loading="lazy">
      
        <p data-block-key="f4d4n">LLM-generated data. Examples for screen QA, navigation and summarization. For navigation, the action bounding box is displayed in red on the screenshot.</p>
      
    </picture>
  



                
                


<section>
    
    <p>
        <h2 data-block-key="xjbkq">Experiments and results</h2>
    </p>


    
</section>

                
                


<div>
        <p data-block-key="xjbkq">As previously mentioned, ScreenAI is trained in two stages: pre-training and fine-tuning. Pre-training data labels are obtained using self-supervised learning and fine-tuning data labels comes from human raters.</p><p data-block-key="ao9ia">We fine-tune ScreenAI using public QA, summarization, and navigation datasets and a variety of tasks related to UIs. For QA, we use well established benchmarks in the multimodal and document understanding field, such as <a href="https://github.com/vis-nlp/ChartQA" target="_blank" rel="noopener noreferrer">ChartQA</a>, <a href="https://rrc.cvc.uab.es/?ch=17&amp;com=evaluation&amp;task=1" target="_blank" rel="noopener noreferrer">DocVQA</a>, <a href="https://rrc.cvc.uab.es/?ch=17&amp;com=tasks" target="_blank" rel="noopener noreferrer">Multi page DocVQA</a>, <a href="https://arxiv.org/abs/2104.12756" target="_blank" rel="noopener noreferrer">InfographicVQA</a>, <a href="https://ocr-vqa.github.io/" target="_blank" rel="noopener noreferrer">OCR VQA</a>, <a href="https://x-lance.github.io/WebSRC/" target="_blank" rel="noopener noreferrer">Web SRC</a> and <a href="https://github.com/google-research-datasets/screen_qa" target="_blank" rel="noopener noreferrer">ScreenQA</a>. For navigation, datasets used include <a href="https://github.com/google-research-datasets/uibert/tree/main" target="_blank" rel="noopener noreferrer">Referring Expressions</a>, <a href="https://github.com/aburns4/MoTIF" target="_blank" rel="noopener noreferrer">MoTIF</a>, <a href="https://arxiv.org/abs/2209.15099" target="_blank" rel="noopener noreferrer">Mug</a>, and <a href="https://github.com/google-research/google-research/tree/master/android_in_the_wild" target="_blank" rel="noopener noreferrer">Android in the Wild</a>. Finally, we use <a href="https://github.com/google-research-datasets/screen2words" target="_blank" rel="noopener noreferrer">Screen2Words</a> for screen summarization. Along with the fine-tuning datasets, we evaluate the fine-tuned ScreenAI model using three novel benchmarks:</p><ol><li data-block-key="3s465">Screen Annotation: Enables the evaluation model layout annotations and spatial understanding capabilities.</li><li data-block-key="d6g8q">ScreenQA Short: A variation of ScreenQA, where its ground truth answers have been shortened to contain only the relevant information that better aligns with other QA tasks.</li><li data-block-key="1oj5v">Complex ScreenQA: Complements ScreenQA Short with more difficult questions (counting, arithmetic, comparison, and non-answerable questions) and contains screens with various aspect ratios.</li></ol><p data-block-key="3m7r7">The fine-tuned ScreenAI model achieves state-of-the-art results on various UI and infographic-based tasks (<a href="https://x-lance.github.io/WebSRC/" target="_blank" rel="noopener noreferrer">WebSRC</a> and <a href="https://github.com/aburns4/MoTIF" target="_blank" rel="noopener noreferrer">MoTIF</a>) and best-in-class performance on <a href="https://github.com/vis-nlp/ChartQA" target="_blank" rel="noopener noreferrer">Chart QA</a>, <a href="https://rrc.cvc.uab.es/?ch=17&amp;com=evaluation&amp;task=1" target="_blank" rel="noopener noreferrer">DocVQA</a>, and <a href="https://arxiv.org/abs/2104.12756" target="_blank" rel="noopener noreferrer">InfographicVQA</a> compared to models of similar size. ScreenAI achieves competitive performance on Screen2Words and OCR-VQA. Additionally, we report results on the new benchmark datasets introduced to serve as a baseline for further research.</p>
    </div>

                
                
    

<!-- mode: &#x27;&#x27; -->


  
    
    
    <picture>
      
      
      <source media="(min-width: 768px)" srcset="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-6.width-800.png" alt="ScreenAI-6">
      
      <img src="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-6.width-800.png" alt="ScreenAI-6" loading="lazy">
      
        <p data-block-key="f4d4n">Comparing model performance of ScreenAI with state-of-the-art (SOTA) models of similar size.</p>
      
    </picture>
  



                
                


<section>
    
    <p data-block-key="xjbkq">Next, we examine ScreenAI’s scaling capabilities and observe that across all tasks, increasing the model size improves performances and the improvements have not saturated at the largest size.</p>


    
</section>

                
                
    

<!-- mode: &#x27;&#x27; -->


  
    
    
    <picture>
      
      
      <source media="(min-width: 768px)" srcset="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-5.width-800.png" alt="ScreenAI-5">
      
      <img src="https://storage.googleapis.com/gweb-research2023-media/images/ScreenAI-5.width-800.png" alt="ScreenAI-5" loading="lazy">
      
        <p data-block-key="f4d4n">Model performance increases with size, and the performance has not saturated even at the largest size of 5B params.</p>
      
    </picture>
  



                
                


<section>
    
    <p>
        <h2 data-block-key="xjbkq">Conclusion</h2>
    </p>


    
</section>

                
                


<section>
    
    <p data-block-key="xjbkq">We introduce the ScreenAI model along with a unified representation that enables us to develop self-supervised learning tasks leveraging data from all these domains. We also illustrate the impact of data generation using LLMs and investigate improving model performance on specific aspects with modifying the training mixture. We apply all of these techniques to build multi-task trained models that perform competitively with state-of-the-art approaches on a number of public benchmarks. However, we also note that our approach still lags behind large models and further research is needed to bridge this gap.</p>


    
</section>

                
                


<section>
    
    <p>
        <h2 data-block-key="xjbkq">Acknowledgements</h2>
    </p>


    
</section>

                
                


<section>
    
    <p data-block-key="xjbkq"><i>This project is the result of joint work with Maria Wang, Fedir Zubach, Hassan Mansoor, Vincent Etter, Victor Carbune, Jason Lin, Jindong Chen and Abhanshu Sharma. We thank Fangyu Liu, Xi Chen, Efi Kokiopoulou, Jesse Berent, Gabriel Barcik, Lukas Zilka, Oriana Riva, Gang Li,Yang Li, Radu Soricut, and Tania Bedrax-Weiss for their insightful feedback and discussions, along with Rahul Aralikatte, Hao Cheng and Daniel Kim for their support in data preparation. We also thank Jay Yagnik, Blaise Aguera y Arcas, Ewa Dominowska, David Petrou, and Matt Sharifi for their leadership, vision and support. We are very grateful toTom Small for helping us create the animation in this post.</i></p>


    
</section>

                

                


<section aria-label="List of footnotes">
  <ol>
    
  </ol>
</section>

                


            </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Fairbuds: In-ear with replaceable batteries (344 pts)]]></title>
            <link>https://shop.fairphone.com/fairbuds</link>
            <guid>39981550</guid>
            <pubDate>Tue, 09 Apr 2024 17:09:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://shop.fairphone.com/fairbuds">https://shop.fairphone.com/fairbuds</a>, See on <a href="https://news.ycombinator.com/item?id=39981550">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="wrap">
            
            <div data-snippet="s_fp_fairbuds_001" data-name="Fairbuds 001">
                    <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/content/circle_blue.svg" loading="eager">
                    <img src="https://shop.fairphone.com/theme_fairphone/static/src/img/content/square_blue_2.svg" loading="eager"></p><h4>FAIRBUDS</h4>
                    <h2>Premium Sound. Designed to last.</h2>
                    <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/330.webp" loading="lazy" data-bs-original-title="" title="" aria-describedby="tooltip343461">
                    </p>
                    <p>Meet the world's most repairable premium earbuds.</p>
                    <p><span data-fp-product-id="502">0.00</span>
                        <span>plus shipping costs from € 3.95</span>
                    </p>
                    <p><a href="https://shop.fairphone.com/shop/aufear-ww1-fairphone-true-wireless-earbuds-406#attr=119" data-bs-original-title="" title="" aria-describedby="popover696845">buy now</a>
                </p></div>
            <div id="section1" data-snippet="s_fp_fairbuds_002" data-name="Fairbuds 002">
                    <h2>Keep what you love for longer</h2>
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/304.webp" loading="lazy">
                        <i data-fp-youtube-popup="fp_js_youtube_popup_16" data-fp-youtube-id="NkTYn8n_W64"></i></p>
                    </div>
                </div>
            <div data-snippet="s_fp_fairbuds_003" data-name="Fairbuds 003">
                        <p><i></i>
                            <span>Long-lasting with a three-year warranty</span>
                        </p>
                        <p><i></i>
                            <span>14-day trial period with 100% full refund</span>
                        </p>
                        <p><i></i>
                            <span>Replaceable batteries inside buds and charging case</span>
                        </p>
                    </div>
            <div>
                <h2>Iconic design. Available in two colors.</h2>
                
            </div>
            <div id="section2" data-snippet="s_fp_fairbuds_005" data-name="Fairbuds 005">
                    <h2>Premium sound</h2>
                    
                    <div>
                        <h4>FINE-TUNED FOR PERFECTION</h4>
                        <div>
                            <div>
                                    <h5>Active Noise Canceling</h5>
                                    <p>Immerse yourself in your music. Or stay connected to the world around you. It's up to you.</p>
                                </div>
                            <div>
                                    <h5>TITANIUM DRIVERS</h5>
                                    <p>The titanium-coated 11mm premium drivers deliver a one-of-a-kind listening experience, with rich, well-balanced sound profiles.
                                    </p>
                                </div>
                            <div>
                                    <h5>Seamless dual point connectivity</h5>
                                    <p>Stay connected to multiple devices simultaneously and switch between them hassle-free.</p>
                                </div>
                            <div>
                                    <h5>Dedicated app For iOS and Android
                                    </h5>
                                    <p>Pick your favorite presets, customize EQ settings just how you like it, and get all the latest software updates.</p>
                                </div>
                        </div>
                    </div>
                </div>
            <div data-snippet="s_fp_fairbuds_006" data-name="Fairbuds 006">
                        <p>Up to 6 hours of listening in a single charge and 20 additional hours with charging case.</p>
                        </div>
            <div data-snippet="s_fp_fairbuds_007" data-name="Fairbuds 007">
                    <h2>Designed to last.</h2>
                    
                    <div>
                        <h4>Built for living worry-free</h4>
                        <div>
                            <div>
                                    <h5>3 year Warranty</h5>
                                    <p>Your Fairbuds come standard with a two year warranty.We're extending that by another year. Because we've got your
                                        back.
                                    </p>
                                </div>
                            <div>
                                    <h5>Easily Repairable</h5>
                                    <p>It was about time the True Wireless Earbuds category got the signature Fairphone treatment: Built to last and
                                        fully repairable.
                                    </p>
                                </div>
                            <div>
                                    <h5>Replaceable Batteries</h5>
                                    <p>Old batteries should never be the end of your earbuds. That's why we designed the Fairbuds with replaceable
                                        batteries - in the charging case and both buds!
                                    </p>
                                </div>
                            <div>
                                    <h5>IP54 Sweat and Water Resistance</h5>
                                    <p>It always rains in Amsterdam - so of course these had to be weatherproof. That also makes them great for working
                                        out.
                                    </p>
                                </div>
                        </div>
                    </div>
                </div>
            <section data-snippet="s_fp_fairbuds_008" data-name="Fairbuds 008">
                <div>
                    <h2>Small size. Big impact.</h2>
                    <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/326.webp" loading="lazy">
                    </p>
                    <div>
                        <h2>Small size. Big impact.</h2>
                        <div>
                            <ul>
                                <li>Made with fair and recycled materials</li>
                                <li>Made in fair factories</li>
                                <li>Climate conscious and electronic waste neutral</li>
                            </ul>
                            <p><span data-fp-light-box="light_box_16">
                                <i></i>
                                <span>More about our fair approach</span>
                            </span>
                        </p></div>
                    </div>
                </div>
                <div id="light_box_16">
                            <h2>Small size. Big impact.</h2>
                            <div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/326.webp" loading="lazy">
                                </p>
                                <h3>Made with fair and recycled materials</h3>
                                <p>We integrate Fairtrade Gold into the Fairbuds’ supply chain and invest in Fairmined Gold Credits, Fairtrade Silver Credits and Cobalt Credits to account for the Fairbuds’ gold, silver and cobalt footprint. They also contain recycled materials such as rare earth elements and post-consumer recycled plastic.
                                </p>
                            </div>
                            <div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/112.png" loading="lazy">
                                </p>
                                <h3>Made in fair factories</h3>
                                <p>The people who help to assemble the Fairbuds are paid a living wage bonus that helps to bridge the gap between minimum wage and a decent salary. Plus they get an active voice in improving working conditions with factory management.
                                </p>
                            </div>
                            <div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/327.webp" loading="lazy">
                                </p>
                                <h3>Electronic waste neutral</h3>
                                <p>The Fairbuds are electronic waste neutral. What does this mean? The Fairbuds weigh 78 grams with the charging case. So, for every
                                    Fairbuds we put out into the world, we make it a point to responsibly collect and recycle 78 grams of electronic waste.
                                </p>
                            </div>
                            <div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/328.webp" loading="lazy">
                                </p>
                                <h3>Climate conscious</h3>
                                <p>Like all our products, the Fairbuds were designed to be climate conscious. The Fairbuds are designed to last really long, thanks to its modular approach. The longer it lasts, the less impact on climate it has. It uses recycled materials in the production process, reducing carbon emissions. For the remaining emissions, we invest in Gold Standard-certified carbon reduction projects.
                                </p>
                            </div>
                        </div>
            </section>
            <div data-snippet="s_fp_fairbuds_009" data-name="Fairbuds 009">
                    <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/content/square_linear_gradient_3.svg" loading="lazy">
                    <img src="https://shop.fairphone.com/theme_fairphone/static/src/img/content/circle_blue.svg" loading="lazy"></p><h2>Your sound. Uninterrupted.</h2>
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/322.webp" loading="lazy">
                            <i></i>
                        </p>
                        <div>
                            <h3>Active Noise Cancelling for the win</h3>
                            <p>For pristine sound in less than perfect conditions, switch on ANC with advanced wind noise reduction.</p>
                        </div>
                    </div>
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/323.webp" loading="lazy">
                            <i></i>
                        </p>
                        <div>
                            <h3>Crystal Clear Calls Always</h3>
                            <p>Say hello to clearer phone calls and voice recordings, thanks to Environmental Noise Canceling (ENC), powered by a six-microphone array
                                that vastly reduces background noise.
                            </p>
                        </div>
                    </div>
                </div>
            <div data-snippet="s_fp_fairbuds_010" data-name="Fairbuds 010">
                    <h2>Easy to use. Easy to control.</h2>
                    
                    <div>
                        <h3>A dedicated mobile app to customise your Fairbuds</h3>
                        <div>
                            <div>
                                    <h5>CUSTOMIZE YOUR EQ SETTINGS</h5>
                                    <p>It’s time to own your sound. Get maximum control over how your Fairbuds sound with the fully customizable eight-band equalizer.
                                        Or take it easy with one of our presets.
                                    </p>
                                </div>
                            <div>
                                    <h5>KEEP YOUR BUDS UPDATED</h5>
                                    <p>You can also use the app to download and install the latest firmware updates for your Fairbuds.</p>
                                </div>
                        </div>
                        
                    </div>
                </div>
            
            <div data-snippet="s_fp_fairbuds_012" data-name="Fairbuds 012">
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/331.webp" loading="lazy">
                        </p>
                        <div>
                            <h3>Get the perfect fit</h3>
                            <p>Because one size shouldn’t fit all. Choose from three different ear tip options and find the one that fits the best.</p>
                        </div>
                    </div>
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/334.webp" loading="lazy">
                        </p>
                        <div>
                            <h3>Connect to more devices</h3>
                            <p>Connect to multiple devices and let the Fairbuds do the work for you. The Fairbuds will know where the music is playing, so you can sit
                                back and enjoy.
                            </p>
                        </div>
                    </div>
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/332.webp" loading="lazy">
                        </p>
                        <div>
                            <h3>Auto play and pause</h3>
                            <p>The Fairbuds know when they're in your ear. Take them out and your song will pause, put them back in and you won't miss a beat.</p>
                        </div>
                    </div>
                    <div>
                        <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/333.webp" loading="lazy">
                        </p>
                        <div>
                            <h3>Dual audio controls</h3>
                            <p>Control your favorite playlist straight from your Fairbuds. Adjusting the volume and playback is right at your fingertips.</p>
                        </div>
                    </div>
                </div>
            
            <div id="section3" data-snippet="s_fp_fairbuds_014" data-name="Fairbuds 014">
                    <h2>The specs at a glance</h2>
                    <p>The Fairbuds are made for all your listening and wireless needs.</p>
                    <div>
                        <section data-name="Item row">
                            <p>
                                <h5>Controls</h5>
                            </p>
                            <div>
                                <ul>
                                    <li>Capacitive Touch Controls (Both Earbuds)</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <div>
                                
                                <h5>Bluetooth &amp; wireless</h5>
                            </div>
                            <div>
                                <ul>
                                    <li>Bluetooth: v5.3 (Profiles A2DP V1.2, AVRCP V1.5, HFP V1.8, HSP V1.2;)</li>
                                    <li>Multipoint Connection (Dual)</li>
                                    <li>Codec: SBC &amp; AAC</li>
                                    <li>Wireless Range: up to 10M (line of sight)</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <p>
                                <h5>Connectors &amp; charging</h5>
                            </p>
                            <div>
                                <ul>
                                    <li>USB Type-C</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <div>
                                
                                <h5>Battery</h5>
                            </div>
                            <div>
                                <ul>
                                    <li>Battery capacity: 45mAh (earbuds) 500mAh (charging case)</li>
                                    <li>Number of cycles: &gt;500 cycles</li>
                                    <li>Charging time: ~2 hours (case + earbuds), 10 min for 1.5h playback</li>
                                    <li>Total playtime (with case): Up to 26 hours</li>
                                    <li>Calling / Music time: Up to 5 hours (ANC on)/ Up to 6 hours (ANC off)</li>
                                    <li>Wireless charging: No</li>
                                    <li>Replaceable battery: Yes (both earbuds and case)</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <div>
                                
                                <h5>SOUND</h5>
                            </div>
                            <div>
                                <ul>
                                    <li>Driver Diameter: 11mm</li>
                                    <li>Driver type: Titanium coated, dynamic driver</li>
                                    <li>Sensitivity: 104±1dB at 1KHZ</li>
                                    <li>Frequency Response Range: 20Hz -20KHz</li>
                                    <li>Driver impedance: 16Ω ±15%</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <div>
                                
                                <h5>Microphone</h5>
                            </div>
                            <div>
                                <ul>
                                    <li>Total of 6 mics: 3 left, 3 right</li>
                                    <li>Smart assistants: Google Assistant, Apple Siri</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <p>
                                <h5>Weather resistant</h5>
                            </p>
                            <div>
                                <ul>
                                    <li>IP54 rating (light rain and sweat)</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <div>
                                
                                <h5>Product dimensions</h5>
                            </div>
                            <div>
                                <ul>
                                    <li>Earbud: 28.7mm*24.6mm*21mm</li>
                                    <li>Case: 65mm*65mm*27mm</li>
                                    <li>Weight: 78g including case; earbuds ~5g</li>
                                </ul>
                            </div>
                        </section>
                        <section data-name="Item row">
                            <div>
                                
                                <h5>Compatibility</h5>
                            </div>
                            <div>
                                <ul>
                                    <li>Compatible with Fairphone 3, 3+, 4 and 5</li>
                                    <li>Compatible with any device with Bluetooth</li>
                                </ul>
                            </div>
                        </section>
                    </div>
                </div>
            <div data-snippet="s_fp_fairbuds_015" data-name="Fairbuds 015">
                    <h2>Included in the box</h2>
                    <p>Everything you need to get started. No more. No less.</p>
                    <div>
                        <div>
                            <p><span>1</span></p><div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/335.webp" loading="lazy">
                                </p>
                                <p><span>Fairbuds and charging case</span>
                            </p></div>
                        </div>
                        <div>
                            <p><span>2</span></p><div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/336.webp" loading="lazy">
                                </p>
                                <p><span>Three ear tips</span>
                            </p></div>
                        </div>
                        <div>
                            <p><span>3</span></p><div>
                                <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/337.webp" loading="lazy">
                                </p>
                                <p><span>Quick-start guide</span>
                            </p></div>
                        </div>
                    </div>
                </div>
            <div data-snippet="s_fp_fairbuds_016" data-name="Fairbuds 016">
                    <h3>Some things are not in the box, and here’s why:</h3>
                    <p>We do not include a <a data-bs-original-title="" title="" href="https://shop.fairphone.com/shop/usb-c-3-2-long-life-cable-5?category=5#attr=" target="_blank">USB Cable</a> or <a data-bs-original-title="" title="" href="https://shop.fairphone.com/shop/dual-port-30-w-charger-eu-6?category=5#attr=" target="_blank">charger</a> in this box because we believe that it’s better to
                        save the environment through the reduction of plastic waste. Of course, it’s possible to buy one of these products if you need it.
                    </p>
                </div>
            <div data-snippet="s_fp_fairbuds_017" data-name="Fairbuds 017">
                    <h2>Get your Fairbuds today</h2>
                    <div>
                        <div>
                            
                            
                            <p><img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/338.webp" loading="lazy">
                                <img src="https://shop.fairphone.com/theme_fairphone/static/src/img/final_content/339.webp" loading="lazy">
                            </p>
                        </div>
                        <div>
                            <h5>FAIRBUDS</h5>
                            <ul>
                                <li>Titanium coated 11mm drivers</li>
                                <li>Active Noise Cancellation with advanced wind reduction</li>
                                <li>Modular and easy to repair with replaceable buds and batteries</li>
                            </ul>
                            <div>
                                <p><span data-fp-product-id="502">£129.00</span>
                                    <span data-fp-product-id="502">£129.00</span>
                                </p>
                                <p>plus shipping costs from € 3.95</p>
                            </div>
                            <p><a href="https://shop.fairphone.com/shop/aufear-ww1-fairphone-true-wireless-earbuds-406#attr=119" data-bs-original-title="" title="">buy now</a>
                        </p></div>
                    </div>
                </div>
            <div data-snippet="s_fp_fairbuds_003" data-name="Fairbuds 003">
                        <p><i></i>
                            <span>Long-lasting with a three-year warranty</span>
                        </p>
                        <p><i></i>
                            <span>14-day trial period with 100% full refund</span>
                        </p>
                        <p><i></i>
                            <span>Replaceable batteries inside buds and charging case</span>
                        </p>
                    </div>
            <div data-snippet="s_fp_wwwww_024" data-name="wwwww 024">
                    <h2>Frequently asked questions</h2>
                    <div>
                        <section>
                            <h5>Why have you launched the Fairbuds?</h5>
                            <i data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#faq_collapse_tab_1"></i>
                            <p>Our mission at Fairphone is to establish a viable market for sustainable consumer electronics. Many of the problems that we see with smartphones, especially around e-waste and issues in the supply chain, also apply to audio products. In 2021, the Fairphone TWS earbuds were our first step into this new product category. They incorporated longer battery life and Fairtrade gold in the supply chain, but were, otherwise, an off-the-shelf design that was not repairable. Our plan was therefore always to improve on the design later on. The Fairbuds are the result of these efforts.
                                </p>
                        </section>
                        <section>
                            <h5>What warranty do you offer on the Fairbuds?</h5>
                            <i data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#faq_collapse_tab_2"></i>
                            <p>There is a standard 2-year warranty on the earbuds, plus a one-year extended warranty if users register their Fairbuds online. That said, due to the modular design and the repairability, we expect the Fairbuds to last a lot longer than three years.
                                </p>
                        </section>
                        <section>
                            <h5>Which parts of the Fairbuds can be repaired or exchanged by the user?</h5>
                            <i data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#faq_collapse_tab_3"></i>
                            <div id="faq_collapse_tab_3">
                                <p>Earbud (Left and/or Right)</p><p>Earbud Battery and Silicon Ring</p><p>Earbud Tips</p><p>Charging Case Outer Shell</p><p>Charging Case Core</p><p>Charging Case Battery</p></div>
                        </section>
                        <section>
                            <h5>Are the Fairbuds water-resistant/waterproof?</h5>
                            <i data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#faq_collapse_tab_4"></i>
                            <p>The Fairbuds have IP54 certification, meaning they are sweat and weather resistant, but not completely waterproof.
                                </p>
                        </section>
                        <section>
                            <h5>What is the Fairbuds app used for?</h5>
                            <i data-bs-toggle="collapse" aria-expanded="false" data-bs-target="#faq_collapse_tab_5"></i>
                            <p>The Fairbuds app offers users more control over their earbuds, allowing you to change equalizer presets and tune your Fairbuds to your personal preferences. You can use the app to access the latest Fairbuds updates as well, ensuring better longevity of your device, with potentially new features, and the occasional bug-fix.  The app also offers users a quick start guide, tutorials, support articles and a customer service touchpoint. Learn more about the different components that make up your Fairbuds, and order replacement parts through the app if your Fairbuds are in need of repairs.</p>
                        </section>
                        
                        
                        
                        
                        
                    </div>
                </div>
            <div data-snippet="s_fp_home_010" data-name="Home 010">
                        <p>
                            <h2>Best in green electronics</h2>
                            
                        </p>
                        <div>
                            <h5>OUR IMPACT</h5>
                            <p>There are more phones than people. And behind every device is a complex supply chain. With suppliers, local communities and the wider industry, we work for fairer materials and more responsible practices. Showing the electronics industry that we can do better.
                            </p>
                            <p>Together we’re disrupting the industry’s short-term thinking that the world can no longer afford. And changing what it means to be “best.”</p>
                        </div>
                    </div>
        </div></div>]]></description>
        </item>
    </channel>
</rss>