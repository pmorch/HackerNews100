<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 28 Aug 2024 05:30:02 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Diffusion Models Are Real-Time Game Engines (209 pts)]]></title>
            <link>https://gamengen.github.io</link>
            <guid>41375548</guid>
            <pubDate>Wed, 28 Aug 2024 02:59:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://gamengen.github.io">https://gamengen.github.io</a>, See on <a href="https://news.ycombinator.com/item?id=41375548">Hacker News</a></p>
Couldn't get https://gamengen.github.io: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Faster CRDTs (2021) (210 pts)]]></title>
            <link>https://josephg.com/blog/crdts-go-brrr/</link>
            <guid>41372833</guid>
            <pubDate>Tue, 27 Aug 2024 20:47:28 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://josephg.com/blog/crdts-go-brrr/">https://josephg.com/blog/crdts-go-brrr/</a>, See on <a href="https://news.ycombinator.com/item?id=41372833">Hacker News</a></p>
Couldn't get https://josephg.com/blog/crdts-go-brrr/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[A Collection of Free Public APIs That Is Tested Daily (326 pts)]]></title>
            <link>https://www.freepublicapis.com/</link>
            <guid>41371170</guid>
            <pubDate>Tue, 27 Aug 2024 18:38:59 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.freepublicapis.com/">https://www.freepublicapis.com/</a>, See on <a href="https://news.ycombinator.com/item?id=41371170">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><div data-v-92221758=""><h2 data-v-92221758="">Best APIs</h2><p data-v-92221758="">APIs with the highest Health Scores. Health is calculated from latency, error rate and reliability.</p></div><div data-v-737892aa=""><!--[--><div data-v-737892aa=""><a href="https://www.freepublicapis.com/rick-and-morty-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üëΩ</span><span data-v-737892aa="">Rick and Morty API</span></h2><p data-v-737892aa="">API providing information about characters, locations, and episodes from the Rick and Morty show. Supports GraphQL and REST endpoints for querying data.</p></div><div data-v-737892aa=""><p data-v-737892aa="">3 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/postcodesio" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üìÆ</span><span data-v-737892aa="">Postcodes.io</span></h2><p data-v-737892aa="">Free UK postcode lookup API and datasets. Search, validate and reverse geocode postcodes. Open sourced project.</p></div><div data-v-737892aa=""><p data-v-737892aa="">2 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/harry-potter-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">‚ö°Ô∏è</span><span data-v-737892aa="">Harry Potter API</span></h2><p data-v-737892aa="">API providing data on Harry Potter characters and spells. Includes routes for all characters, specific character by ID, Hogwarts students and staff, characters in a house, and all spells.</p></div><div data-v-737892aa=""><p data-v-737892aa="">3 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/kanyerest" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üé§</span><span data-v-737892aa="">kanye.rest</span></h2><p data-v-737892aa="">A free REST API for random Kanye West quotes (Kanye as a Service)</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/data-usa" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üìä</span><span data-v-737892aa="">Data USA</span></h2><p data-v-737892aa="">Browse 47,000+ automated reports, view aggregated data, merge and download data, compare reports</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/public-holiday-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üìÖ</span><span data-v-737892aa="">Public Holiday API</span></h2><p data-v-737892aa="">An API for public holiday data. Supports over 100 countries. Provides information on holidays and long weekends.</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/ip-geolocation-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üåç</span><span data-v-737892aa="">IP Geolocation API</span></h2><p data-v-737892aa="">Free IP Geolocation API - lookup any IP address. Provides geolocation data based on the input IPv4/IPv6 address or domain name, with optional parameters for customization like language and callback.</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/global-flood-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üåä</span><span data-v-737892aa="">Global Flood API</span></h2><p data-v-737892aa="">Simulated river discharge at 5 km resolution from 1984 up to 7 months forecast.</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/pokapi" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üî¥</span><span data-v-737892aa="">Pok√©API</span></h2><p data-v-737892aa="">An open RESTful API for Pok√©mon data</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/json-ip-geolocation" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üåç</span><span data-v-737892aa="">IP Geolocation &amp; Currency Converter</span></h2><p data-v-737892aa="">The JSON IP Geolocation API allows you to determine the geographical location of visitors based on their IP addresses. It provides detailed location data such as country, region, city, and coordinates in a structured JSON format.</p></div><div data-v-737892aa=""><p data-v-737892aa="">2 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/yesno-generator" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üé≤</span><span data-v-737892aa="">YesNo Generator</span></h2><p data-v-737892aa="">This API generates a random 'Yes' or 'No' response.</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/air-quality-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üå±</span><span data-v-737892aa="">Air Quality API</span></h2><p data-v-737892aa="">Pollutants and pollen forecast in 11 km resolution</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/open-meteo" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üå¶Ô∏è</span><span data-v-737892aa="">Open Meteo</span></h2><p data-v-737892aa="">Open-Meteo is an open-source weather API and offers free access for non-commercial use. No API key required. Start using it now!</p></div><div data-v-737892aa=""><p data-v-737892aa="">2 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/nekosbest-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üêæ</span><span data-v-737892aa="">nekos.best API</span></h2><p data-v-737892aa="">nekos.best is a RESTful API serving fully SFW and high quality anime images and GIFs.</p></div><div data-v-737892aa=""><p data-v-737892aa="">3 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/useless-facts-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">ü§™</span><span data-v-737892aa="">Useless Facts API</span></h2><p data-v-737892aa="">HTTP API for useless facts. Provides random useless facts and today's useless fact with language and content-type customization options. APIv1 is deprecated.</p></div><div data-v-737892aa=""><p data-v-737892aa="">3 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/data-dragon-api" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üó°Ô∏è</span><span data-v-737892aa="">Data Dragon API</span></h2><p data-v-737892aa="">Data Dragon is a static data API providing information and images related to champions, runes, and items in League of Legends. It allows developers to access and download data files, enabling them to integrate game-related information into their applications.</p></div><div data-v-737892aa=""><p data-v-737892aa="">1 Endpoint</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><div data-v-737892aa=""><a href="https://www.freepublicapis.com/jsonplaceholder" data-v-737892aa=""><div data-v-737892aa=""><h2 data-v-737892aa=""><span data-v-737892aa="">üîµ</span><span data-v-737892aa="">JSONPlaceholder</span></h2><p data-v-737892aa="">Free fake and reliable API for testing and prototyping. Serving ~3 billion requests each month.</p></div><div data-v-737892aa=""><p data-v-737892aa="">3 Endpoints</p><div data-v-737892aa="" data-v-8d476b2d=""><svg height="44px" width="44px" viewBox="0 0 20 20" data-v-8d476b2d=""><circle r="10" cx="10" cy="10" fill="#E7E7E7" data-v-8d476b2d=""></circle><circle r="5" cx="10" cy="10" fill="transparent" stroke-width="10" stroke="#37A410" stroke-dasharray="31.41592653589793 31.41592653589793" data-v-8d476b2d=""></circle></svg><p data-v-8d476b2d="">100 API Health</p></div></div></a></div><!--]--></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[U.S. Ambassador says Canadians are consuming 'unhealthy' amount of American news (216 pts)]]></title>
            <link>https://thehub.ca/2024/08/27/hub-exclusive-u-s-ambassador-says-canadians-are-consuming-an-unhealthy-amount-of-american-news/</link>
            <guid>41371117</guid>
            <pubDate>Tue, 27 Aug 2024 18:34:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://thehub.ca/2024/08/27/hub-exclusive-u-s-ambassador-says-canadians-are-consuming-an-unhealthy-amount-of-american-news/">https://thehub.ca/2024/08/27/hub-exclusive-u-s-ambassador-says-canadians-are-consuming-an-unhealthy-amount-of-american-news/</a>, See on <a href="https://news.ycombinator.com/item?id=41371117">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                
            <div>
                <p>U.S. Ambassador to Canada David Cohen says Canadians are consuming too much American news, which he believes is ‚Äúunhealthy‚Äù because of American legacy media‚Äôs polarizing and partisan nature.</p>
<p>He added that it‚Äôs come at the expense of Canadians consuming news about their own country‚Äôs politics.</p>
<p>Cohen made the comments during a recent <a href="https://thehub.ca/podcasts/the-united-states-has-no-more-important-friend-partner-or-ally-than-canada-u-s-ambassador-david-cohen-on-canadian-american-relations-trade-protectionism-and-nato-spending/" target="_blank" rel="noopener">interview</a> with <em>The Hub‚Äôs</em> managing editor, Harrison Lowman.</p>
<p>When asked about Canadians‚Äô apparent obsession and preoccupation with the political news of the United States, Cohen, who is a former Comcast media executive, explained that he finds Canada‚Äôs consumption of American news from CNN, MSNBC, and Fox to be somewhat strange.</p>
<p>‚ÄúI do think it is odd, particularly when I contrast it to the United States, where‚Ä¶virtually no one in the United States is paying any attention to Canadian politics,‚Äù he said.</p>
<p>‚ÄúEvery major Canadian household has easy access to American cable television news,‚Äù he noted.</p>
<p>‚ÄúI‚Äôll be honest with you, before I came here‚Ä¶Canadian cable television news outlets, I didn‚Äôt even know how to get them in the United States,‚Äù he added.</p>
<p>According to new <a href="https://reutersinstitute.politics.ox.ac.uk/digital-news-report/2024/canada" target="_blank" rel="noopener">statistics</a> from the Reuters Institute, a significant number of Canadians, particularly in English Canada, rely on American outlets like CNN and the <em>New York Times</em> on a weekly basis for news.</p>
<p>In 2018, Canada was the <a href="https://www.niemanlab.org/2018/07/as-the-new-york-times-extends-its-reach-across-countries-and-languages-and-cultures-it-looks-to-locals-for-guidance/" target="_blank" rel="noopener">biggest</a> foreign market for the <i>New York Times</i>, making up around 27 percent of its total foreign audience. In an <a href="http://www.canadalandshow.com/podcast/whats-new-york-times-canada/">interview</a> with <i>Canadaland</i>, the then <i>New York Times</i> Canada bureau chief said the paper‚Äôs Canadian audience hovered around 94,000.</p>
<p>In 2024, a <i>New York Times </i><a href="https://www.nytco.com/press/the-new-york-times-passes-2m-international-digital-subscribers/" target="_blank" rel="noopener">press release</a> announced the paper had reached two million international subscriptions, highlighting that it has ‚Äúseen subscriber growth in recent years‚Äù in Canada. Some estimates have claimed the <i>New York Times</i> has more paying Canadian digital subscribers than any Canadian news outlet.</p>
            </div>

        
            <div>
                <p><a href="https://whatsapp.com/channel/0029VabMzl9BvvsZnNBEjT2x" target="_blank" rel="noopener">
                            
    <img src="https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a.jpg" data-src="https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a.jpg" data-srcset="https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a.jpg 2048w, https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a-1536x472.jpg 1536w, https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a-960x295.jpg 960w, https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a-720x221.jpg 720w" data-sizes="(min-width: 1260px) 100vw, (min-width: 1024px) 100vw, (min-width: 768px) 100vw, (min-width: 600px) 100vw, 100vw" height="530" width="1726" alt="" srcset="https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a.jpg 2048w, https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a-1536x472.jpg 1536w, https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a-960x295.jpg 960w, https://thehub.ca/wp-content/uploads/2024/06/newgreen_hub_whatsappjoin_v5a-720x221.jpg 720w">
                        </a>
                                    </p>
            </div>

        
            <div>
                <h4><b>A Canadian fixation with America</b></h4>
<p>Within our borders, Canadian media outlets have also become fixated on American politics.</p>
<p><i>True North</i> reported that Canada‚Äôs public broadcaster <i>CBC</i> <a href="https://tnc.news/2024/08/20/cbcs-kamala-mania-68-stories/" target="_blank" rel="noopener">published</a> 68 stories about the Kamala Harris campaign in one month. Back in 2020, <i>CBC</i> <a href="https://tnc.news/2020/08/17/500-more-cbc-headlines-about-kamala-harris-than-leslyn-lewis/" target="_blank" rel="noopener">published</a> 500 percent more stories about Harris than about Leslyn Lewis, a black woman running for federal office in Canada.</p>
<p><i>CBC</i> has also held U.S. election night TV specials for the <a href="https://www.cbc.ca/news/world/how-to-watch-us-election-cbc-1.5782601" target="_blank" rel="noopener">2020</a> and <a href="https://www.youtube.com/watch?v=Mkb3oFIFAXc" target="_blank" rel="noopener">2016</a> U.S. presidential elections.</p>
<p>‚ÄúWorld coverage has been a hallmark of <i>CBC News </i>since the public broadcaster was founded, and we dedicate more resources to international reporting than any other media outlet in Canada,‚Äù <i>CBC</i> general manager and editor-in-chief Brodie Fenlon recently <a href="https://www.cbc.ca/news/editorsblog/why-cbc-news-follows-the-u-s-presidential-election-1.7299084" target="_blank" rel="noopener">explained</a> in an article justifying the public broadcaster‚Äôs coverage of U.S. politics.</p>
<p>‚Äú‚Äã‚ÄãWithin our coverage of the world, the United States occupies a special place for some obvious reasons,‚Äù he added. ‚ÄúFrom arts and culture, national security, the economy to the environment‚Äîour countries are inextricably linked.‚Äù</p>
<p>As previously reported by <i>The Hub</i>, Canada‚Äôs politics are <a href="https://thehub.ca/2024/08/09/elie-cantin-nantel-trudeaus-liberals-are-americanizing-canadas-politics/" target="_blank" rel="noopener">growing</a> more and more Americanized.</p>
            </div>

        
            <div>
                    
    <p><img src="https://thehub.ca/wp-content/uploads/2024/08/CP172511819-2048x1365.jpg" data-src="https://thehub.ca/wp-content/uploads/2024/08/CP172511819-2048x1365.jpg" data-srcset="https://thehub.ca/wp-content/uploads/2024/08/CP172511819-2048x1365.jpg 2048w, https://thehub.ca/wp-content/uploads/2024/08/CP172511819-1536x1024.jpg 1536w, https://thehub.ca/wp-content/uploads/2024/08/CP172511819-960x640.jpg 960w, https://thehub.ca/wp-content/uploads/2024/08/CP172511819-720x480.jpg 720w" data-sizes="(min-width: 1260px) 100vw, (min-width: 1024px) 100vw, (min-width: 768px) 100vw, (min-width: 600px) 100vw, 100vw" height="3264" width="4896" alt="" srcset="https://thehub.ca/wp-content/uploads/2024/08/CP172511819-2048x1365.jpg 2048w, https://thehub.ca/wp-content/uploads/2024/08/CP172511819-1536x1024.jpg 1536w, https://thehub.ca/wp-content/uploads/2024/08/CP172511819-960x640.jpg 960w, https://thehub.ca/wp-content/uploads/2024/08/CP172511819-720x480.jpg 720w"></p><div>
            <p>President Joe Biden and Republican presidential candidate former President Donald Trump stand during a break in a presidential debate hosted by CNN, June 27, 2024, in Atlanta. John Bazemore/AP Photo.</p>
        </div>
                </div>

        
            <div>
                <h4><b>Slanted news</b></h4>
<p>Ambassador Cohen said even American outlets themselves have what he considers to be ‚Äúan unhealthy preoccupation with American politics.‚Äù</p>
<p>‚ÄúYou‚Äôre getting an unfiltered and 24/7 perspective on the political structure from all of these cable television news outlets, without the balancing perspective of lots of people around you who have different opinions and who can balance a little bit what you‚Äôre seeing on a cable television news show,‚Äù he explained.</p>
<p>‚ÄúI do think it‚Äôs unhealthy,‚Äù said Cohen, admitting that for his own mental health he took an intentional break from his country‚Äôs political news channels this summer.</p>
<p>According to media analysts, America‚Äôs ‚ÄúBig Three‚Äù news channels‚Äî<i>Fox News, CNN, </i>and<i> MSNBC</i>‚Äîall have political biases.</p>
<p>The AllSides bias checker rates <i>Fox News</i> as having a <a href="https://www.allsides.com/news-source/fox-news-editorial-media-bias" target="_blank" rel="noopener">right-wing</a> bias, <i>CNN</i> as having a bias that <a href="https://www.allsides.com/news-source/cnn-media-bias" target="_blank" rel="noopener">leans Left</a>, and <i>MSNBC</i> as having a <a href="https://www.allsides.com/news-source/msnbc" target="_blank" rel="noopener">left-wing</a> bias.</p>
<p>Meanwhile, many American newsrooms are lacking ideological diversity. According to a <a href="https://www.theamericanjournalist.org/_files/ugd/46a507_4fe1c4d6ec6d4c229895282965258a7a.pdf" target="_blank" rel="noopener">2022 Syracuse University study</a>, just 3.4 percent of American journalists now describe themselves as Republicans, while 36.4 percent describe themselves as Democrats.</p>
<p>‚ÄúI come from Pennsylvania‚Ä¶ [which] I think has been properly identified as maybe the battleground state in the upcoming election,‚Äù said Cohen. ‚ÄúSo I can‚Äôt go anywhere in Pennsylvania where I don‚Äôt find equal numbers of people who have very different political opinions than what is being carried on <i>MSNBC</i> and, to a large extent, on <i>CNN</i>.‚Äù</p>
<p>‚ÄúIt‚Äôs just not necessarily an accurate depiction of the political process and the way people think to just get your news and information from cable television news outlets,‚Äù he added.</p>
<p>This is not the first time that Cohen has spoken about Canada‚Äôs massive appetite for American news.</p>
<p>In a July interview with the<i> Hill Times</i>, Cohen <a href="https://www.hilltimes.com/story/2024/07/10/american-envoy-david-cohen-navigates-unaccustomed-hiatus-from-political-arena-as-presidential-vote-looms/427688/">said</a> he believes one of the reasons why Canadians are often anxious about the United States is because of their media consumption.</p>
<p>The Hub‚Äôs<i> full-length interview with U.S. Ambassador to Canada David Cohen can be found </i><a href="https://thehub.ca/podcasts/the-united-states-has-no-more-important-friend-partner-or-ally-than-canada-u-s-ambassador-david-cohen-on-canadian-american-relations-trade-protectionism-and-nato-spending/" target="_blank" rel="noopener"><i>here</i></a><i>.</i></p>
            </div>

                    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Microsoft donates the Mono Project to the Wine team (919 pts)]]></title>
            <link>https://www.mono-project.com/</link>
            <guid>41371106</guid>
            <pubDate>Tue, 27 Aug 2024 18:34:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.mono-project.com/">https://www.mono-project.com/</a>, See on <a href="https://news.ycombinator.com/item?id=41371106">Hacker News</a></p>
Couldn't get https://www.mono-project.com/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Why is the Oral-B iOS app almost 300 MB? And why is Colgate's app even bigger..? (226 pts)]]></title>
            <link>https://twitter.com/emergetools/status/1828490449881047401</link>
            <guid>41371038</guid>
            <pubDate>Tue, 27 Aug 2024 18:29:16 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://twitter.com/emergetools/status/1828490449881047401">https://twitter.com/emergetools/status/1828490449881047401</a>, See on <a href="https://news.ycombinator.com/item?id=41371038">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Malware infiltrates Pidgin messenger's official plugin repository (157 pts)]]></title>
            <link>https://www.bleepingcomputer.com/news/security/malware-infiltrates-pidgin-messengers-official-plugin-repository/</link>
            <guid>41370714</guid>
            <pubDate>Tue, 27 Aug 2024 18:02:29 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bleepingcomputer.com/news/security/malware-infiltrates-pidgin-messengers-official-plugin-repository/">https://www.bleepingcomputer.com/news/security/malware-infiltrates-pidgin-messengers-official-plugin-repository/</a>, See on <a href="https://news.ycombinator.com/item?id=41370714">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p><img alt="Pidgin" height="900" src="https://www.bleepstatic.com/content/hl-images/2024/08/27/pidgin-header.jpg" width="1600"></p>
<p>The Pidgin messaging app removed the ScreenShareOTR plugin from its official third-party plugin list after it was discovered that it was used to install keyloggers, information stealers, and malware commonly used to gain initial access to corporate networks.</p>
<p>The plugin was promoted as a screen-sharing tool for secure Off-The-Record (OTR) protocol and was available for both Windows and Linux versions of Pidgin.</p>
<p>According to ESET, the malicious plugin was configured to infect unsuspecting users with <a href="https://www.bleepingcomputer.com/news/security/darkgate-and-pikabot-malware-emerge-as-qakbots-successors/" target="_blank">DarkGate malware</a>, a powerful malware threat actors use to breach networks since QBot's dismantling by the authorities.</p>
<h2>Sneaky Pidgin plugin</h2>
<p>Pidgin is an open-source, cross-platform instant messaging client that supports multiple networks and messaging protocols.</p>
<p>Although not as popular as in the mid-2000s when multi-protocol clients were in high demand, it remains a popular choice among those seeking to consolidate their messaging accounts into a single app and has a dedicated user base of tech-savvy individuals, open-source enthusiasts, and users who need to connect to legacy IM systems.</p>
<p>Pidgin operates a plugin system that allows users to extend the program's functionality, enable niche features, and unlock new customization options.</p>
<p>Users can download them from the project's official <a href="https://pidgin.im/plugins/?publisher=all&amp;query=&amp;type=" target="_blank" rel="nofollow noopener">third-party plugins list</a>, currently hosting 211 addons.</p>
<p>According to <a href="http://pidgin.im/posts/2024-08-malicious-plugin/" target="_blank" rel="nofollow noopener">an announcement</a> on the project's website&nbsp;last week, a malicious plugin named 'ss-otr' had slipped into the list on July 6, 2024, and was only pulled on August 16 following a user report about it being a keylogger and screenshot capturing tool.</p>
<div><p>"A plugin, ss-otr, was added to the third party plugins list on July 6th. On August 16th we received a report from 0xFFFC0000 that the plugin contained a key logger and shared screen shots with unwanted parties.</p><p>
We quietly pulled the plugin from the list immediately and started investigating. On August 22nd Johnny Xmas was able to confirm that a keylogger was present." ‚Äì Pidgin</p></div>
<p>A red flag is that ss-otr only provided binaries for download and not any source code, but due to the lack of robust reviewing mechanisms in Pidgin's third-party plugin repository, nobody questioned its security.</p>
<h2>Plugin leads to DarkGate malware</h2>
<p>ESET <a href="https://x.com/ESETresearch/status/1828114327976415445" target="_blank" rel="nofollow noopener">reports</a> the plugin installer is signed with a valid digital certificate issued to <em>INTERREX ‚Äì SP. Z O.O.</em>, a legitimate Polish company.</p>
<div>
<figure><img alt="Signed executable" height="515" src="https://www.bleepstatic.com/images/news/u/1220909/2024/Linux/04/signed.jpg" width="810"><figcaption><strong>Signed executable</strong><br><em>Source: ESET</em></figcaption></figure></div>
<p>The plugin offers the advertised functionality of screen sharing but also contains malicious code, allowing it to download additional binaries from the attacker's server at jabberplugins[.]net.</p>
<p>The downloaded payloads are either PowerShell scripts or the DarkGate malware, which is also signed by an Interrex certificate.</p>
<p>A similar mechanism is implemented for the Linux version of the Pidgin client, so both platforms are covered.</p>
<p>ESET says that the same malicious server, which has been taken down now, hosted additional plugins named OMEMO, Pidgin Paranoia, Master Password, Window Merge, and HTTP File Upload.</p>
<p>These plugins were almost certainly also delivering DarkGate, indicating that ScreenShareOTR was just one small part of a broader-scale campaign.</p>
<div>
<figure><img alt="Threat actor's website" height="600" src="https://www.bleepstatic.com/images/news/u/1220909/2024/Linux/04/site.jpg" width="800"><figcaption><strong>Threat actor's website</strong><br><em>Source: ESET</em></figcaption></figure></div>
<p>Those who installed it are recommended to remove it immediately and perform a full system scan with an antivirus tool, as DarkGate may be lurking on their system.</p>
<p>After publishing our story, Pidgin's maintainer and lead developer, Gary Kramlich, <a href="https://infosec.exchange/@grimmy@mastodon.social/113035335884182662" target="_blank" rel="nofollow noopener">notified us on Mastodon</a> to say that they do not keep track of how many times a plugin is installed.</p>
<p>To prevent similar incidents from happening in the future, Pidgin announced that, from now on, it will only accept third-party plugins that have an OSI Approved Open Source License, allowing scrutiny into their code and internal functionality.</p>
<p><em>Update 8/27/24: Updated story to note that Pidgin does not keep track of plugin downloads.</em></p>

</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Just use fucking paper, man (142 pts)]]></title>
            <link>https://andy-bell.co.uk/just-fucking-use-paper-man/</link>
            <guid>41370673</guid>
            <pubDate>Tue, 27 Aug 2024 17:59:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://andy-bell.co.uk/just-fucking-use-paper-man/">https://andy-bell.co.uk/just-fucking-use-paper-man/</a>, See on <a href="https://news.ycombinator.com/item?id=41370673">Hacker News</a></p>
Couldn't get https://andy-bell.co.uk/just-fucking-use-paper-man/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Blitzortung ‚Äì real time lightning strikes around the world (192 pts)]]></title>
            <link>https://www.blitzortung.org/en/live_lightning_maps.php</link>
            <guid>41370187</guid>
            <pubDate>Tue, 27 Aug 2024 17:21:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.blitzortung.org/en/live_lightning_maps.php">https://www.blitzortung.org/en/live_lightning_maps.php</a>, See on <a href="https://news.ycombinator.com/item?id=41370187">Hacker News</a></p>
Couldn't get https://www.blitzortung.org/en/live_lightning_maps.php: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[The Monospace Web (289 pts)]]></title>
            <link>https://owickstrom.github.io/the-monospace-web/</link>
            <guid>41370020</guid>
            <pubDate>Tue, 27 Aug 2024 17:09:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://owickstrom.github.io/the-monospace-web/">https://owickstrom.github.io/the-monospace-web/</a>, See on <a href="https://news.ycombinator.com/item?id=41370020">Hacker News</a></p>
Couldn't get https://owickstrom.github.io/the-monospace-web/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Is 'No tax on tips' a distraction from the fight to end sub-minimum wages? (121 pts)]]></title>
            <link>https://www.theguardian.com/us-news/article/2024/aug/27/no-tax-on-tips-unlivable-minimum-wages</link>
            <guid>41369769</guid>
            <pubDate>Tue, 27 Aug 2024 16:53:45 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theguardian.com/us-news/article/2024/aug/27/no-tax-on-tips-unlivable-minimum-wages">https://www.theguardian.com/us-news/article/2024/aug/27/no-tax-on-tips-unlivable-minimum-wages</a>, See on <a href="https://news.ycombinator.com/item?id=41369769">Hacker News</a></p>
Couldn't get https://www.theguardian.com/us-news/article/2024/aug/27/no-tax-on-tips-unlivable-minimum-wages: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Cerebras Inference: AI at Instant Speed (145 pts)]]></title>
            <link>https://cerebras.ai/blog/introducing-cerebras-inference-ai-at-instant-speed</link>
            <guid>41369705</guid>
            <pubDate>Tue, 27 Aug 2024 16:49:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cerebras.ai/blog/introducing-cerebras-inference-ai-at-instant-speed">https://cerebras.ai/blog/introducing-cerebras-inference-ai-at-instant-speed</a>, See on <a href="https://news.ycombinator.com/item?id=41369705">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p><span data-contrast="auto">Cerebras inference is designed to serve models from billions to trillions of parameters. When models exceed the memory capacity of a single wafer, we split them at layer boundaries and map them to multiple CS-3 systems. 20B models fit on a single CS-3 while 70B models fit on as few as four systems. In the weeks to come we will be adding larger models such as Llama3-405B and Mistral Large with industry leading speed and cost per token.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<h3>16-bit model weights for the highest accuracy</h3>
<p><span data-contrast="auto">Some companies try to overcome the memory bandwidth bottleneck by reducing weight precision from 16-bit to 8-bit, often without informing their users. This approach, however, can result in loss of accuracy. Cerebras inference runs Llama3.1 8B and 70B models using the original 16-bit weights released by Meta, ensuring the most accurate and reliable model output. Our evaluations, along with third-party benchmarks, show that 16-bit models score up to 5% higher than their 8-bit counterparts, resulting in substantially better performance in multi-turn conversations, math, and reasoning tasks.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<h3>Cerebras Inference API</h3>
</div><p><span lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span>Cerebras</span><span> inference is available today via </span></span><a href="http://link/" target="_blank" rel="noreferrer noopener"><span lang="EN-US" xml:lang="EN-US" data-contrast="none"><span data-ccp-charstyle="Hyperlink">chat</span></span></a><span lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span> and </span></span><a href="http://link/" target="_blank" rel="noreferrer noopener"><span lang="EN-US" xml:lang="EN-US" data-contrast="none"><span data-ccp-charstyle="Hyperlink">API</span></span></a><span lang="EN-US" xml:lang="EN-US" data-contrast="auto"><span> access. Built on the familiar OpenAI Chat Completions format, it allows developers to integrate our powerful inference capabilities by simply swapping out the API key. </span><span>Cerebras</span><span> inference API offers some of the most generous rate limits in the industry at </span><span>60 tokens per minute and </span><span>1</span><span> million tokens per day</span><span>, making it the ideal platform for AI developers to </span><span>built</span><span> interactive and agentic applications.</span></span></p><div><p><span data-contrast="auto">Cerebras inference API offers the best combination of performance, speed, accuracy and cost. At 450 tokens per second, it‚Äôs the only solution that runs Llama3.1-70B at instantaneous speed. We use Meta‚Äôs original 16-bit model weights, ensuring the highest accuracy. For launch we are providing developers with 1 million free tokens daily. For at scale deployments, our pricing is a fraction of popular GPU clouds.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<p><span data-contrast="auto">For initial launch, we are offering Llama3.1 8B and 70B models. We will be adding support for larger models such as Llama3 405B and Mistral Large 2 in the coming weeks. Please let us know what models you‚Äôd like to see added.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<h3>Why fast inference matters</h3>
<p><span data-contrast="auto">The implications of high-speed inference extend far beyond raw metrics. By dramatically reducing processing time, we‚Äôre enabling more complex AI workflows and enhancing real-time LLM intelligence. Traditional LLMs output everything they think immediately, without stopping to consider the best possible answer. New techniques like scaffolding, on the other hand, function like a thoughtful agent who explores different possible solutions before deciding. This ‚Äúthinking before speaking‚Äù approach provides over 10x performance on demanding tasks like code generation, fundamentally boosting the intelligence of AI models without additional training. But these techniques require up to 100x more tokens at runtime, and thus is only possible in real time running on Cerebras hardware.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<p><span data-contrast="auto">With record-breaking performance, industry-leading pricing, and open API access, Cerebras Inference sets a new standard for open LLM development and deployment. As the only solution capable of delivering both high-speed training and inference, Cerebras opens entirely new capabilities for AI. We can‚Äôt wait to see the new and exciting applications developers will build with Cerebras Inference.</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<p><b><span data-contrast="auto">Links:</span></b><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></p>
<ul>
<li>
<ul>
<li data-leveltext="ÔÇ∑" data-font="Symbol" data-listid="5" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;ÔÇ∑&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1"><a href="https://inference.cerebras.ai/"><span data-contrast="none">Try chat</span></a><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></li>
<li data-leveltext="ÔÇ∑" data-font="Symbol" data-listid="5" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;ÔÇ∑&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1"><a href="https://cloud.cerebras.ai/" target="_blank" rel="noopener"><span data-contrast="none">API Access</span></a><span data-contrast="auto">&nbsp;</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></li>
<li data-leveltext="ÔÇ∑" data-font="Symbol" data-listid="5" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;ÔÇ∑&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" aria-setsize="-1" data-aria-posinset="1" data-aria-level="1"><a href="https://discord.com/channels/1085960591052644463/1087099163432468540"><span data-contrast="none">Discord</span></a><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:278}">&nbsp;</span></li>
</ul>
</li>
</ul>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Your Immune System Is Not a Muscle (192 pts)]]></title>
            <link>https://rachel.fast.ai/posts/2024-08-13-crowds-vs-friends/</link>
            <guid>41369061</guid>
            <pubDate>Tue, 27 Aug 2024 16:06:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://rachel.fast.ai/posts/2024-08-13-crowds-vs-friends/">https://rachel.fast.ai/posts/2024-08-13-crowds-vs-friends/</a>, See on <a href="https://news.ycombinator.com/item?id=41369061">Hacker News</a></p>
Couldn't get https://rachel.fast.ai/posts/2024-08-13-crowds-vs-friends/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[80% of AI Projects Crash and Burn, Billions Wasted Says Rand Report (153 pts)]]></title>
            <link>https://salesforcedevops.net/index.php/2024/08/19/ai-apocalypse/</link>
            <guid>41368935</guid>
            <pubDate>Tue, 27 Aug 2024 15:55:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://salesforcedevops.net/index.php/2024/08/19/ai-apocalypse/">https://salesforcedevops.net/index.php/2024/08/19/ai-apocalypse/</a>, See on <a href="https://news.ycombinator.com/item?id=41368935">Hacker News</a></p>
Couldn't get https://salesforcedevops.net/index.php/2024/08/19/ai-apocalypse/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Sainsbury Wing contractors find 1990 letter from donor (284 pts)]]></title>
            <link>https://www.theartnewspaper.com/2024/08/27/sainsbury-wing-contractors-find-1990-letter-from-donor-anticipating-their-demolition-of-false-columns</link>
            <guid>41368866</guid>
            <pubDate>Tue, 27 Aug 2024 15:49:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theartnewspaper.com/2024/08/27/sainsbury-wing-contractors-find-1990-letter-from-donor-anticipating-their-demolition-of-false-columns">https://www.theartnewspaper.com/2024/08/27/sainsbury-wing-contractors-find-1990-letter-from-donor-anticipating-their-demolition-of-false-columns</a>, See on <a href="https://news.ycombinator.com/item?id=41368866">Hacker News</a></p>
<div id="readability-page-1" class="page"><div itemprop="articleBody"><p itemprop="text">A ‚Äútime capsule‚Äù has been discovered at London‚Äôs National Gallery, buried deep in a column in the foyer of the Sainsbury Wing. It is a letter recording that one of the wing‚Äôs funders, John Sainsbury (Lord Sainsbury of Preston Candover), believed the architects had committed a serious ‚Äúmistake‚Äù. The 1990 letter, typed on Sainsbury‚Äôs supermarket notepaper, has recently been deposited in the gallery‚Äôs archive as an historic document.</p><p itemprop="text">John Sainsbury is critical in the letter of the American post-Modernist architect Robert Venturi and his professional partner and wife Denise Scott Brown for inserting two large false columns in the gallery‚Äôs foyer that served no structural purpose. Other than the false columns, John Sainsbury was happy with the Venturi and Scott Brown design.</p><p itemprop="text">While building work was under way, Sainsbury gained access to the site and dropped his letter into a concrete column that was under construction. The letter, protected in a plastic folder, was discovered last year, when the foyer was being reconfigured.</p><p itemprop="text">The Sainsbury letter of 26 July 1990 was addressed ‚ÄúTo those who find this note‚Äù‚Äîwho turned out to be the 2023 demolition workers.</p><p itemprop="text">The note, typed in capital letters, continues:</p><p itemprop="text">IF YOU HAVE FOUND THIS NOTE YOU MUST BE ENGAGED IN DEMOLISHING ONE OF THE FALSE COLUMNS THAT HAVE BEEN PLACED IN THE FOYER OF THE SAINSBURY WING OF THE NATIONAL GALLERY. I BELIEVE THAT THE FALSE COLUMNS ARE A MISTAKE OF THE ARCHITECT AND THAT WE WOULD LIVE TO REGRET OUR ACCEPTING THIS DETAIL OF HIS DESIGN.</p><p itemprop="text">LET IT BE KNOWN THAT ONE OF THE DONORS OF THIS BUILDING IS ABSOLUTELY DELIGHTED THAT YOUR GENERATION HAS DECIDED TO DISPENSE WITH THE UNNECESSARY COLUMNS.</p><figure><img alt="" srcset="https://cdn.sanity.io/images/cxgd3urn/production/e483264430dfee3ca8ed67838ae3808fb9b4bbae-1400x1989.jpg?rect=0,0,1399,1989&amp;w=750&amp;h=1066&amp;fit=crop&amp;auto=format 1x, https://cdn.sanity.io/images/cxgd3urn/production/e483264430dfee3ca8ed67838ae3808fb9b4bbae-1400x1989.jpg?w=1920&amp;h=2728&amp;fit=crop&amp;auto=format 2x" src="https://cdn.sanity.io/images/cxgd3urn/production/e483264430dfee3ca8ed67838ae3808fb9b4bbae-1400x1989.jpg?w=1920&amp;h=2728&amp;fit=crop&amp;auto=format" width="644" height="914.9399999999999" decoding="async" data-nimg="1" loading="lazy"><figcaption><p>John Sainsbury's letter of 26 July 1990 was discovered last year, protected in a plastic folder, during building works to reconfigure the foyer of the Sainsbury Wing of London's National Gallery  <span>Courtesy of the National Gallery and by permission of the Sainsbury family</span></p></figcaption></figure><p itemprop="text">John and his wife Anya presumably never imagined that the demolition of the Sainsbury Wing foyer might take place during their lifetimes. John, one of the most generous UK donors to the arts, died in 2022, aged 94. His widow Anya, a former ballerina, was present when her husband‚Äôs note was removed. ‚ÄúI was so happy for John‚Äôs letter to be rediscovered after all these years,‚Äù she says, ‚Äúand I feel he would be relieved and delighted for the gallery‚Äôs new plans and the extra space they are creating.‚Äù</p><p itemprop="text">The Sainsbury Wing was opened by Queen Elizabeth II in 1991, just under a year after John wrote his time capsule letter. It was entirely funded by John and his two Sainsbury brothers: Simon (who died in 2006) and Timothy (a former Conservative minister, now aged 92). It was their great-grandfather who established the London grocery shop which has now become the UK‚Äôs second largest supermarket chain, after Tesco.</p><div><blockquote>I was so happy for John‚Äôs letter to be rediscovered after all these years, and I feel he would be relieved and delighted for the gallery‚Äôs new plans and the extra space they are creating <p>Anya Sainsbury</p></blockquote></div><p itemprop="text">Neil MacGregor, the director of the National Gallery when the Sainsbury Wing was planned and built, tells <em>The Art Newspaper</em>: ‚ÄúVenturi wanted the foyer to have the feel of a mighty crypt, leading upstairs to the galleries, so it was a subsidiary space‚Äîthe beginning of a journey, not a destination. John Sainsbury argued that sightlines should be as unencumbered as possible, thinking the extra columns would conceal the entrance to the lecture theatre and temporary exhibition galleries, confusing the visitor.‚Äù</p><figure><img alt="" srcset="https://cdn.sanity.io/images/cxgd3urn/production/0a733d1463e90e5134c5bfa604bb0d91ffbfdf6c-1468x1101.jpg?rect=1,0,1467,1101&amp;w=750&amp;h=563&amp;fit=crop&amp;auto=format 1x, https://cdn.sanity.io/images/cxgd3urn/production/0a733d1463e90e5134c5bfa604bb0d91ffbfdf6c-1468x1101.jpg?w=1920&amp;h=1440&amp;fit=crop&amp;auto=format 2x" src="https://cdn.sanity.io/images/cxgd3urn/production/0a733d1463e90e5134c5bfa604bb0d91ffbfdf6c-1468x1101.jpg?w=1920&amp;h=1440&amp;fit=crop&amp;auto=format" width="644" height="483" decoding="async" data-nimg="1" loading="lazy"><figcaption><p>Anya Sainsbury (centre) holds her late husband John‚Äôs 1990 letter after being shown it on site in the Sainsbury Wing by the National Gallery‚Äôs director, Gabriele Finaldi (left) and chairman, John Booth, last year<br><span>Photo: Sarah Butler-Sloss</span></p></figcaption></figure><p itemprop="text">MacGregor ultimately concluded in the late 1980s that the false columns were acceptable: ‚ÄúAlthough there were drawbacks, Venturi had a coherent idea of the organic link between entrance hall, staircase and main galleries. I felt that, on balance, we should let the architect be the architect.‚Äù</p><p itemprop="text">The size of the Sainsbury family‚Äôs original donation has never been officially revealed, but <em>The Art Newspaper</em> understands that it was around ¬£40m (equivalent to ¬£90m today). It might be considered exceedingly gracious of John Sainsbury to have donated a third of this sum‚Äîand not to have insisted that his wishes relating to the false columns should be respected.</p><h4>Sainsbury family is largest contributor to ¬£85m  upgrade of Sainsbury Wing</h4><p itemprop="text">Last year the National Gallery embarked on a ¬£85m project to upgrade the Sainsbury Wing and develop new facilities in the adjacent part of its main building. The main improvement in the Sainsbury Wing will be a more open and welcoming foyer, to cope with double the number of visitors that had been envisaged in the 1980s.</p><p itemprop="text">This scheme, designed by the architect Annabelle Selldorf, included the demolition of the two non-structural columns. These were located on the ground floor near the former cloakroom, halfway between the street entrance and the stairs and lift leading down to the basement. Three adjacent structural columns have needed to be retained.</p><p itemprop="text">Demolition of the two columns was criticised by the Twentieth Century Society, which argued that they ‚Äúcontribute to the sense of weight and the lobby‚Äôs function as an anticipatory space‚Äù. The National Gallery recently took a different view, pointing out that wayfinding is hindered by columns which ‚Äúrestrict views to the lifts and obscures the entrance to the [lecture] theatre and temporary exhibition spaces‚Äù. Westminster City Council gave planning permission for the National Gallery‚Äôs plan‚Äîand the columns in the listed building were demolished last year.</p><p itemprop="text">Venturi died in 2018. His partner Scott Brown has vociferously opposed the redesign of the foyer.</p><p itemprop="text">The Sainsbury family is the largest financial contributor to the present project. Although the gallery has not released the figures, the Linbury Trust (set up by John and Anya) and the Headley Trust (set up by Timothy and his wife Susan) have each committed ¬£5m. Their ¬£10m joint contribution represents one of the largest donations to a UK museum in recent years.</p><p itemprop="text">Building work has taken longer than originally anticipated, but the newly refurbished Sainsbury Wing is now due to reopen in May next year. Visitors will then be able to make their own judgement on the architectural controversy.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Eazel, ex-Apple led Linux startup (141 pts)]]></title>
            <link>https://en.wikipedia.org/wiki/Eazel</link>
            <guid>41368363</guid>
            <pubDate>Tue, 27 Aug 2024 15:04:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://en.wikipedia.org/wiki/Eazel">https://en.wikipedia.org/wiki/Eazel</a>, See on <a href="https://news.ycombinator.com/item?id=41368363">Hacker News</a></p>
Couldn't get https://en.wikipedia.org/wiki/Eazel: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[New 0-Day Attacks Linked to China's 'Volt Typhoon' (184 pts)]]></title>
            <link>https://krebsonsecurity.com/2024/08/new-0-day-attacks-linked-to-chinas-volt-typhoon/</link>
            <guid>41367964</guid>
            <pubDate>Tue, 27 Aug 2024 14:31:50 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://krebsonsecurity.com/2024/08/new-0-day-attacks-linked-to-chinas-volt-typhoon/">https://krebsonsecurity.com/2024/08/new-0-day-attacks-linked-to-chinas-volt-typhoon/</a>, See on <a href="https://news.ycombinator.com/item?id=41367964">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
												<p>Malicious hackers are exploiting a zero-day vulnerability in <strong>Versa Director</strong>, a software product used by many Internet and IT service providers. Researchers believe the activity is linked to <strong>Volt Typhoon</strong>, a Chinese cyber espionage group focused on infiltrating critical U.S. networks and laying the groundwork for the ability to disrupt communications between the United States and Asia during any future armed conflict with China.</p>
<div id="attachment_68507"><p><img aria-describedby="caption-attachment-68507" decoding="async" src="https://krebsonsecurity.com/wp-content/uploads/2024/08/ss-dissolvingsphere.png" alt="" width="840" height="508" srcset="https://krebsonsecurity.com/wp-content/uploads/2024/08/ss-dissolvingsphere.png 840w, https://krebsonsecurity.com/wp-content/uploads/2024/08/ss-dissolvingsphere-768x464.png 768w, https://krebsonsecurity.com/wp-content/uploads/2024/08/ss-dissolvingsphere-782x473.png 782w" sizes="(max-width: 840px) 100vw, 840px"></p><p id="caption-attachment-68507">Image: Shutterstock.com</p></div>
<p>Versa Director systems are primarily used by Internet service providers (ISPs), as well as managed service providers (MSPs) that cater to the IT needs of many small to mid-sized businesses simultaneously. In <a href="https://versa-networks.com/blog/versa-security-bulletin-update-on-cve-2024-39717-versa-director-dangerous-file-type-upload-vulnerability/" target="_blank" rel="noopener">a security advisory</a> published Aug. 26, Versa urged customers to deploy a patch for the vulnerability (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39717" target="_blank" rel="noopener">CVE-2024-39717</a>), which the company said is fixed in <em>Versa Director 22.1.4</em> or later.</p>
<p>Versa said the weakness allows attackers to upload a file of their choosing to vulnerable systems. The advisory placed much of the blame on Versa customers who ‚Äúfailed to implement system hardening and firewall guidelines‚Ä¶leaving a management port exposed on the internet that provided the threat actors with initial access.‚Äù</p>
<p>Versa‚Äôs advisory doesn‚Äôt say how it learned of the zero-day flaw, but its vulnerability listing at mitre.org acknowledges ‚Äúthere are reports of others based on backbone telemetry observations of a 3rd party provider, however these are unconfirmed to date.‚Äù</p>
<p>Those third-party reports came in late June 2024 from <strong>Michael Horka</strong>, senior lead information security engineer at <strong>Black Lotus Labs</strong>, the security research arm of <strong>Lumen Technologies</strong>, which operates one of the global Internet‚Äôs largest backbones.</p>
<p>In an interview with KrebsOnSecurity, Horka said Black Lotus Labs identified a web-based backdoor on Versa Director systems belonging to four U.S. victims and one non-U.S. victim in the ISP and MSP sectors, with the earliest known exploit activity occurring at a U.S. ISP on June 12, 2024.</p>
<p>‚ÄúThis makes Versa Director a lucrative target for advanced persistent threat (APT) actors who would want to view or control network infrastructure at scale, or pivot into additional (or downstream) networks of interest,‚Äù Horka <a href="https://blog.lumen.com/taking-the-crossroads-the-versa-director-zero-day-exploitation/" target="_blank" rel="noopener">wrote</a> in a blog post published today.</p>
<p>Black Lotus Labs said it assessed with ‚Äúmedium‚Äù confidence that Volt Typhoon was responsible for the compromises, noting the intrusions bear the hallmarks of the Chinese state-sponsored espionage group ‚Äî including zero-day attacks targeting IT infrastructure providers, and Java-based backdoors that run in memory only.</p>
<p>In May 2023, the <strong>National Security Agency</strong> (NSA), the <strong>Federal Bureau of Investigation</strong> (FBI), and the <strong>Cybersecurity Infrastructure Security Agency</strong> (CISA) issued <a href="https://media.defense.gov/2023/May/24/2003229517/-1/-1/0/CSA_Living_off_the_Land.PDF" target="_blank" rel="noopener">a joint warning</a> (PDF) about Volt Typhoon, also known as ‚Äú<strong>Bronze Silhouette</strong>‚Äù and ‚Äú<strong>Insidious Taurus</strong>,‚Äù which described how the group uses small office/home office (SOHO) network devices to hide their activity.</p>
<p>In early December 2023, Black Lotus Labs <a href="https://blog.lumen.com/routers-roasting-on-an-open-firewall-the-kv-botnet-investigation/" target="_blank" rel="noopener">published its findings</a> on ‚Äú<strong>KV-botnet</strong>,‚Äù thousands of compromised SOHO routers that were chained together to form a covert data transfer network supporting various Chinese state-sponsored hacking groups, including Volt Typhoon.</p>
<p>In January 2024, the <strong>U.S. Department of Justice</strong> disclosed the FBI had <a href="https://www.justice.gov/opa/pr/us-government-disrupts-botnet-peoples-republic-china-used-conceal-hacking-critical" target="_blank" rel="noopener">executed a court-authorized takedown</a> of the KV-botnet shortly before Black Lotus Labs released its December report.<span id="more-68493"></span></p>
<p>In February 2024, CISA again joined the FBI and NSA in <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa24-038a" target="_blank" rel="noopener">warning</a> Volt Typhoon had compromised the IT environments of multiple critical infrastructure organizations ‚Äî primarily in communications, energy, transportation systems, and water and wastewater sectors ‚Äî in the continental and non-continental United States and its territories, including Guam.</p>
<p>‚ÄúVolt Typhoon‚Äôs choice of targets and pattern of behavior is not consistent with traditional cyber espionage or intelligence gathering operations, and the U.S. authoring agencies assess with high confidence that Volt Typhoon actors are pre-positioning themselves on IT networks to enable lateral movement to OT [operational technology] assets to disrupt functions,‚Äù that alert warned.</p>
<p>In a speech at Vanderbilt University in April, FBI Director <strong>Christopher Wray</strong> <a href="https://www.reuters.com/technology/cybersecurity/fbi-says-chinese-hackers-preparing-attack-us-infrastructure-2024-04-18/" target="_blank" rel="noopener">said</a> China is developing the ‚Äúability to physically wreak havoc on our critical infrastructure at a time of its choosing,‚Äù and that China‚Äôs plan is to ‚Äúland blows against civilian infrastructure to try to induce panic.‚Äù</p>
<p><strong>Ryan English</strong>, an information security engineer at Lumen, said it‚Äôs disappointing his employer didn‚Äôt at least garner an honorable mention in Versa‚Äôs security advisory. But he said he‚Äôs glad there are now a lot fewer Versa systems exposed to this attack.</p>
<p>‚ÄúLumen has for the last nine weeks been very intimate with their leadership with the goal in mind of helping them mitigate this,‚Äù English said. ‚ÄúWe‚Äôve given them everything we could along the way, so it kind of sucks being referenced just as a third party.‚Äù</p>
											</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[MiniJinja: Learnings from Building a Template Engine in Rust (105 pts)]]></title>
            <link>https://lucumr.pocoo.org/2024/8/27/minijinja/</link>
            <guid>41367644</guid>
            <pubDate>Tue, 27 Aug 2024 14:02:43 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lucumr.pocoo.org/2024/8/27/minijinja/">https://lucumr.pocoo.org/2024/8/27/minijinja/</a>, See on <a href="https://news.ycombinator.com/item?id=41367644">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        
  

  
  <p>written on Tuesday, August 27, 2024
  

  </p><p>Given that I can't stop creating template engines, I figured I might write
a bit about my learnings of creating <a href="https://github.com/mitsuhiko/minijinja/">MiniJinja</a> which is an implementation of
my Jinja2 template engine for Rust.  Disclaimer: this post might be a bit
more technical.</p>
<p>There is a good chance you have come across Jinja2 templates before as
they became quite common place in various places over the years.  They
look a bit like this:</p>
<div><pre><span></span><span>{%</span> <span>extends</span> <span>"layout.html"</span> <span>%}</span><span></span>
<span>{%</span> <span>block</span> <span>body</span> <span>%}</span><span></span>
<span>  &lt;p&gt;Hello </span><span>{{</span> <span>name</span> <span>}}</span><span>!&lt;/p&gt;</span>
<span>{%</span> <span>endblock</span> <span>%}</span><span></span>
</pre></div>
<p>If you want to play around it yourself, here are some links:</p>
<ul>
<li>The <a href="https://mitsuhiko.github.io/minijinja-playground/">MiniJinja playground</a>
lets you play with a WASM compiled version of MiniJinja.</li>
<li>The <a href="https://docs.rs/minijinja/">API Documentation</a> documents all
APIs, functionality and syntax.</li>
<li>The <a href="https://github.com/mitsuhiko/minijinja/">GitHub Project</a> for all
the code including lots of examples.</li>
<li><a href="https://crates.io/crates/minijinja">minijinja</a> and
<a href="https://crates.io/crates/minijinja-cli">minijinja-cli</a> on crates.io</li>
</ul>
<div id="why-minijinja">
<h2>Why MiniJinja?</h2>
<p>Maybe we start with the initial question of why I wrote MiniJinja.  It's
the year 2024 and people don't create a ton of HTML with server side
rendered template engines any more.  While there is some resurgence of
that model thanks to HTMX, hotwire and livewire, I personally use <a href="https://www.solidjs.com/">SolidJS</a> for my internal UI needs.  There is however
always a need to generate some form of text and so somehow Jinja2's need
never really went away.  When I originally created it, it was clearly
meant for generating HTML with some JavaScript sprinkled on top, but in
the years since I have encountered Jinja templates in many more places,
primarily for generating YAML and similar formats.  Lately it comes up for
LLM prompt generation.</p>
<p>My personal need for MiniJinja came out of an experiment I built for
infrastructure automation.  Since the templates had to be loaded
dynamically I could not use a system like Askama.  Askama has type-safe
templates that just generate Rust code.  On the other hand most Jinja
inspired template engines that are dynamic in Rust really do not try very
hard to be Jinja compatible.  Because writing template engines is also fun,
I figured I might give it another try.</p>
<p>Over the last two years I kept adding to the engine until it got to the
point where it's at almost feature parity with Jinja2 and quite enjoyable
to use.</p>
</div>
<div id="runtime-values">
<h2>Runtime Values</h2>
<p>When building a template engine for Rust you end up building a little
dynamic programming language that is optimized for text generation.
Consequently you pull in most of the challenges of building a dynamic
language.  Particularly when working in Rust the immediate challenge is
memory management and exposing native Rust objects to the embedded
language.  So the interesting bit here is how to create a system that
allows interactions between the template engine and the Rust world around
it.</p>
<p>MiniJinja, unlike Jinja2 does not use code generation but has a basic
stack based VM and a AST based bytecode compiler.  Since MiniJinja follows
Jinja2 it inherits a lot of the realities of the underlying object system
that Jinja2 inherits from Python.  For instance macros (functions) are
first class objects and they can have closures.  This has challenges
because it's easy to create cycles and Rust has no garbage collector that
can help with this problem.</p>
<p>The core object model in MiniJinja is a <cite>Value</cite> type which is represented
by an enum that looks as follows (some less important variants removed):</p>
<div><pre><span></span><span>#[derive(Clone)]</span><span></span>
<span>pub</span><span> </span><span>struct</span> <span>Value</span><span>(</span><span>ValueRepr</span><span>);</span><span></span>

<span>#[derive(Clone)]</span><span></span>
<span>pub</span><span>(</span><span>crate</span><span>)</span><span> </span><span>enum</span> <span>ValueRepr</span><span> </span><span>{</span><span></span>
<span>    </span><span>Undefined</span><span>,</span><span></span>
<span>    </span><span>None</span><span>,</span><span></span>
<span>    </span><span>Bool</span><span>(</span><span>bool</span><span>),</span><span></span>
<span>    </span><span>U64</span><span>(</span><span>u64</span><span>),</span><span></span>
<span>    </span><span>I64</span><span>(</span><span>i64</span><span>),</span><span></span>
<span>    </span><span>F64</span><span>(</span><span>f64</span><span>),</span><span></span>
<span>    </span><span>String</span><span>(</span><span>Arc</span><span>&lt;</span><span>str</span><span>&gt;</span><span>,</span><span> </span><span>StringType</span><span>),</span><span></span>
<span>    </span><span>SmallStr</span><span>(</span><span>SmallStr</span><span>),</span><span></span>
<span>    </span><span>Invalid</span><span>(</span><span>Arc</span><span>&lt;</span><span>Error</span><span>&gt;</span><span>),</span><span></span>
<span>    </span><span>Object</span><span>(</span><span>DynObject</span><span>),</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>Externaly everything is a <cite>Value</cite>.  If you <cite>Clone</cite> it, you usually bump a
reference count or you make a cheap memcopy.  Values are either primitives
such as strings, numbers etc. or objects.</p>
<p>For objects MiniJinja provides a tait called <cite>Object</cite> which can be
implemented by most Rust types.  The engine provides a <cite>DynObject</cite> wrapper
is a fancy <cite>Arc&lt;dyn Object&gt;</cite> which supports borrowing and object safety.
<a href="https://lucumr.pocoo.org/2024/5/16/macro-vtable-magic/">I wrote about this before</a>.  What you
will notice is that quite a few of the types involved have an <cite>Arc</cite>.
That's because these values are for the most part reference counted.
Since values here are really fat (they are 24 bytes in memory) a
<cite>SmallStr</cite> type is used to hold up to 22 bytes of string data inline.  One
byte is used to encode the length of the string, and another byte is then
used by the <cite>ValueRepr</cite> to mark which enum variant is in use.  In pure
theory this is all wrong.  We never use weak references, so the weak count
in the <cite>Arc</cite> is not used and clever bit hackery could be used to greatly
reduce the size of the value type.  I think one could get the whole thing
down to 16 bytes trivially or even 8 bytes with NaN tagging.  However I
did not want to walk into the world of unsafe code more than feels
appropriate.</p>
<p>MiniJinjia is also <a href="https://github.com/mitsuhiko/minijinja/tree/main/benchmarks">plenty fast</a>.</p>
<p>One variant that is worth calling out is <cite>Invalid</cite>.  That's a value that
can exist in the system but it carries an error.  When you're trying to
interact with it in most cases it will propagate this error.  That's used
in the engine in places where the API assumes infallability (particularly
during iteration) but it needs a way to emit an error.  This concept is
quite common when writing an engine in C though typically the actual error
is carried out of bounds.  For instance in QuickJS there is a marker value
that indicates a failure, but the actual error is held on the interpreter
runtime.</p>
<p>The trait definition for objects looks like this:</p>
<div><pre><span></span><span>pub</span><span> </span><span>trait</span><span> </span><span>Object</span>: <span>Debug</span><span> </span><span>+</span><span> </span><span>Send</span><span> </span><span>+</span><span> </span><span>Sync</span><span> </span><span>{</span><span></span>
<span>    </span><span>fn</span> <span>repr</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>ObjectRepr</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>get_value</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span> </span><span>key</span>: <span>&amp;</span><span>Value</span><span>)</span><span> </span>-&gt; <span>Option</span><span>&lt;</span><span>Value</span><span>&gt;</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>enumerate</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>Enumerator</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>enumerator_len</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>Option</span><span>&lt;</span><span>usize</span><span>&gt;</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>is_true</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>bool</span> <span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>call</span><span>(</span><span></span>
<span>        </span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span></span>
<span>        </span><span>state</span>: <span>&amp;</span><span>State</span><span>&lt;'</span><span>_</span><span>,</span><span> </span><span>'</span><span>_</span><span>&gt;</span><span>,</span><span></span>
<span>        </span><span>args</span>: <span>&amp;</span><span>[</span><span>Value</span><span>],</span><span></span>
<span>    </span><span>)</span><span> </span>-&gt; <span>Result</span><span>&lt;</span><span>Value</span><span>,</span><span> </span><span>Error</span><span>&gt;</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>call_method</span><span>(</span><span></span>
<span>        </span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span></span>
<span>        </span><span>state</span>: <span>&amp;</span><span>State</span><span>&lt;'</span><span>_</span><span>,</span><span> </span><span>'</span><span>_</span><span>&gt;</span><span>,</span><span></span>
<span>        </span><span>method</span>: <span>&amp;</span><span>str</span><span>,</span><span></span>
<span>        </span><span>args</span>: <span>&amp;</span><span>[</span><span>Value</span><span>],</span><span></span>
<span>    </span><span>)</span><span> </span>-&gt; <span>Result</span><span>&lt;</span><span>Value</span><span>,</span><span> </span><span>Error</span><span>&gt;</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>    </span><span>fn</span> <span>render</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span> </span><span>f</span>: <span>&amp;</span><span>mut</span><span> </span><span>Formatter</span><span>&lt;'</span><span>_</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>Result</span>
       <span>where</span><span> </span><span>Self</span>: <span>Sized</span> <span>+</span><span> </span><span>'</span><span>static</span><span> </span><span>{</span><span> </span><span>..</span><span>.</span><span> </span><span>}</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>Some of these methods are implemented automatically.  For instance many of
the methods such as <cite>is_true</cite> or <cite>enumerator_len</cite> have a default
implementation that is based on object <cite>repr</cite> and the return value from
<cite>enumerate</cite>.  But they can be overridden to change the default behavior or
to add some potential optimizations.</p>
<p>One of the most important types in Jinja is a map as it holds the template
context.  They are implemented as you can imagine as <cite>Object</cite>.  The
implementation is in fact pretty trivial:</p>
<div><pre><span></span><span>impl</span><span>&lt;</span><span>V</span><span>&gt;</span><span> </span><span>Object</span><span> </span><span>for</span><span> </span><span>BTreeMap</span><span>&lt;</span><span>Value</span><span>,</span><span> </span><span>V</span><span>&gt;</span><span></span>
<span>where</span><span></span>
<span>    </span><span>V</span>: <span>Into</span><span>&lt;</span><span>Value</span><span>&gt;</span><span> </span><span>+</span><span> </span><span>Clone</span><span> </span><span>+</span><span> </span><span>Send</span><span> </span><span>+</span><span> </span><span>Sync</span><span> </span><span>+</span><span> </span><span>fmt</span>::<span>Debug</span><span> </span><span>+</span><span> </span><span>'</span><span>static</span><span>,</span><span></span>
<span>{</span><span></span>
<span>    </span><span>fn</span> <span>get_value</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span> </span><span>key</span>: <span>&amp;</span><span>Value</span><span>)</span><span> </span>-&gt; <span>Option</span><span>&lt;</span><span>Value</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>        </span><span>self</span><span>.</span><span>get</span><span>(</span><span>key</span><span>).</span><span>cloned</span><span>().</span><span>map</span><span>(</span><span>|</span><span>v</span><span>|</span><span> </span><span>v</span><span>.</span><span>into</span><span>())</span><span></span>
<span>    </span><span>}</span><span></span>

<span>    </span><span>fn</span> <span>enumerate</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>Enumerator</span><span> </span><span>{</span><span></span>
<span>        </span><span>self</span><span>.</span><span>mapped_enumerator</span><span>(</span><span>|</span><span>this</span><span>|</span><span> </span><span>Box</span>::<span>new</span><span>(</span><span>this</span><span>.</span><span>keys</span><span>().</span><span>cloned</span><span>()))</span><span></span>
<span>    </span><span>}</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>This reveals two interesting aspects of the object model: First that
<cite>Value</cite> implements <cite>Hash</cite>.  That means any value can be used as the key in
a value.  While this is untypical for Rust and even not what happens in
Python, it simplifies the system greatly.  When in the template engine you
write <cite>{{ object.key }}</cite>, behind the scenes
<cite>object.get_value(Value::from("key"))</cite> is called.  Since most keys are
typically less than 22 characters, creating a dummy <cite>Value</cite> wrapper around
is not too problematic.</p>
<p>The second and probably more interesting part here is that you can sort of
borrow out of an object for the enumerator.  The <cite>mapped_enumerator</cite>
helper takes a reference to self and invokes a closure which itself can
borrow from self.  This adjacent borrowing is implemented with unsafe code
as there is no other way to make it work.  The combination of <cite>repr</cite>
(defaults to <cite>Map</cite>), <cite>get_value</cite> and <cite>enumerate</cite> gives the object the
behavior, shape and contents.</p>
<p>Vectors look quite similar:</p>
<div><pre><span></span><span>impl</span><span>&lt;</span><span>T</span><span>&gt;</span><span> </span><span>Object</span><span> </span><span>for</span><span> </span><span>Vec</span><span>&lt;</span><span>T</span><span>&gt;</span><span></span>
<span>where</span><span></span>
<span>    </span><span>T</span>: <span>Into</span><span>&lt;</span><span>Value</span><span>&gt;</span><span> </span><span>+</span><span> </span><span>Clone</span><span> </span><span>+</span><span> </span><span>Send</span><span> </span><span>+</span><span> </span><span>Sync</span><span> </span><span>+</span><span> </span><span>fmt</span>::<span>Debug</span><span> </span><span>+</span><span> </span><span>'</span><span>static</span><span>,</span><span></span>
<span>{</span><span></span>
<span>    </span><span>fn</span> <span>repr</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>ObjectRepr</span><span> </span><span>{</span><span></span>
<span>        </span><span>ObjectRepr</span>::<span>Seq</span><span></span>
<span>    </span><span>}</span><span></span>

<span>    </span><span>fn</span> <span>get_value</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span> </span><span>key</span>: <span>&amp;</span><span>Value</span><span>)</span><span> </span>-&gt; <span>Option</span><span>&lt;</span><span>Value</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>        </span><span>self</span><span>.</span><span>get</span><span>(</span><span>key</span><span>.</span><span>as_usize</span><span>()</span><span>?</span><span>).</span><span>cloned</span><span>().</span><span>map</span><span>(</span><span>|</span><span>v</span><span>|</span><span> </span><span>v</span><span>.</span><span>into</span><span>())</span><span></span>
<span>    </span><span>}</span><span></span>

<span>    </span><span>fn</span> <span>enumerate</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>)</span><span> </span>-&gt; <span>Enumerator</span><span> </span><span>{</span><span></span>
<span>        </span><span>Enumerator</span>::<span>Seq</span><span>(</span><span>self</span><span>.</span><span>len</span><span>())</span><span></span>
<span>    </span><span>}</span><span></span>
<span>}</span><span></span>
</pre></div>
</div>
<div id="enumerators-and-object-behaviors">
<h2>Enumerators and Object Behaviors</h2>
<p>Enumeration in MiniJinja is a way to allow an object to describe what's
inside of it.  In combination with the return values from <cite>repr()</cite> the
engine changes how iteration is performed.  These are possible
enumerators:</p>
<div><pre><span></span><span>pub</span><span> </span><span>enum</span> <span>Enumerator</span><span> </span><span>{</span><span></span>
<span>    </span><span>NonEnumerable</span><span>,</span><span></span>
<span>    </span><span>Empty</span><span>,</span><span></span>
<span>    </span><span>Iter</span><span>(</span><span>Box</span><span>&lt;</span><span>dyn</span><span> </span><span>Iterator</span><span>&lt;</span><span>Item</span><span> </span><span>=</span><span> </span><span>Value</span><span>&gt;</span><span> </span><span>+</span><span> </span><span>Send</span><span> </span><span>+</span><span> </span><span>Sync</span><span>&gt;</span><span>),</span><span></span>
<span>    </span><span>Seq</span><span>(</span><span>usize</span><span>),</span><span></span>
<span>    </span><span>Values</span><span>(</span><span>Vec</span><span>&lt;</span><span>Value</span><span>&gt;</span><span>),</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>It's probably easier to explain how enumerators turn into iterators by
showing you the <cite>try_iter</cite> method in the engine:</p>
<div><pre><span></span><span>impl</span><span> </span><span>DynObject</span><span> </span><span>{</span><span></span>
<span>    </span><span>fn</span> <span>try_iter</span><span>(</span><span>self</span>: <span>&amp;</span><span>Self</span><span>)</span><span> </span>-&gt; <span>Option</span><span>&lt;</span><span>Box</span><span>&lt;</span><span>dyn</span><span> </span><span>Iterator</span><span>&lt;</span><span>Item</span><span> </span><span>=</span><span> </span><span>Value</span><span>&gt;</span><span> </span><span>+</span><span> </span><span>Send</span><span> </span><span>+</span><span> </span><span>Sync</span><span>&gt;&gt;</span><span></span>
<span>    </span><span>where</span><span></span>
<span>        </span><span>Self</span>: <span>'</span><span>static</span><span>,</span><span></span>
<span>    </span><span>{</span><span></span>
<span>        </span><span>match</span><span> </span><span>self</span><span>.</span><span>enumerate</span><span>()</span><span> </span><span>{</span><span></span>
<span>            </span><span>Enumerator</span>::<span>NonEnumerable</span><span> </span><span>=&gt;</span><span> </span><span>None</span><span>,</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Empty</span><span> </span><span>=&gt;</span><span> </span><span>Some</span><span>(</span><span>Box</span>::<span>new</span><span>(</span><span>None</span>::<span>&lt;</span><span>Value</span><span>&gt;</span><span>.</span><span>into_iter</span><span>())),</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Seq</span><span>(</span><span>l</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>                </span><span>let</span><span> </span><span>self_clone</span><span> </span><span>=</span><span> </span><span>self</span><span>.</span><span>clone</span><span>();</span><span></span>
<span>                </span><span>Some</span><span>(</span><span>Box</span>::<span>new</span><span>((</span><span>0</span><span>..</span><span>l</span><span>).</span><span>map</span><span>(</span><span>move</span><span> </span><span>|</span><span>idx</span><span>|</span><span> </span><span>{</span><span></span>
<span>                    </span><span>self_clone</span><span>.</span><span>get_value</span><span>(</span><span>&amp;</span><span>Value</span>::<span>from</span><span>(</span><span>idx</span><span>)).</span><span>unwrap_or_default</span><span>()</span><span></span>
<span>                </span><span>})))</span><span></span>
<span>            </span><span>}</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Iter</span><span>(</span><span>iter</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>Some</span><span>(</span><span>iter</span><span>),</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Values</span><span>(</span><span>v</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>Some</span><span>(</span><span>Box</span>::<span>new</span><span>(</span><span>v</span><span>.</span><span>into_iter</span><span>())),</span><span></span>
<span>        </span><span>}</span><span></span>
<span>    </span><span>}</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>Some of the trivial enumerators are quick to explain:
<cite>Enumerator::NonEnumerable</cite> just does not support iteration and
<cite>Enumerator::Empty</cite> does but won't yield any values.  The more interesting
one is <cite>Enumerator::Seq(n)</cite> which basically tells the engine to call
<cite>get_value</cite> from 0 to <cite>n</cite> to yield items from the object.  This is how
sequences are implemented.  The rest are enumerators that just directly
yield values.</p>
<p>So when you want to iterate over a map, you will usually use something
like <cite>Enumerator::Iter</cite> and iterate over all the keys in the map.</p>
<p>The engine then uses <cite>ObjectRepr</cite> to figure out what to do with it.  For
a value marked as <cite>ObjectRepr::Seq</cite> it will display like a sequence, you
can index it with integers, and that it iterates over the values in the
sequence.  If the repr is <cite>ObejctRepr::Map</cite> then the expectation is that
it will be indexable by key and it will iterate over the keys when used in
a loop.  Its default rendering also is a key-value pair list wrapped in
curly braces.</p>
<p>Now quite frankly I don't like that iteration protocol.  I think it's more
sensible for maps to naturally iterate over the key-value pairs, but since
MiniJinja follows Jinja2 and Jinja2 follows Python emulating was
important.</p>
<p>Enumerators are a bit different than iterators because they might only
define how iteration is performed (see: <cite>Enumerator::Seq</cite>).  To actually
create an iterator, the object is then passed to it.  They are also asked
to provide a length.  When an enumerator provides a length it's an
indication to the engine that the object can be iterated over more than
once (you can re-create the enumerator).  This is why objects land in a
MiniJinja template that looks like a list, but is actually just an
iterable object with a known length.  For this MiniJinja uses a trick
where it will inspect the size hint of the iterator to make assumptions
about it.  Internally every enumerator allows the engine to query the
length of it:</p>
<div><pre><span></span><span>impl</span><span> </span><span>Enumerator</span><span> </span><span>{</span><span></span>
<span>    </span><span>fn</span> <span>query_len</span><span>(</span><span>&amp;</span><span>self</span><span>)</span><span> </span>-&gt; <span>Option</span><span>&lt;</span><span>usize</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>        </span><span>Some</span><span>(</span><span>match</span><span> </span><span>self</span><span> </span><span>{</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Empty</span><span> </span><span>=&gt;</span><span> </span><span>0</span><span>,</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Values</span><span>(</span><span>v</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>v</span><span>.</span><span>len</span><span>(),</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Iter</span><span>(</span><span>i</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>match</span><span> </span><span>i</span><span>.</span><span>size_hint</span><span>()</span><span> </span><span>{</span><span></span>
<span>                </span><span>(</span><span>a</span><span>,</span><span> </span><span>Some</span><span>(</span><span>b</span><span>))</span><span> </span><span>if</span><span> </span><span>a</span><span> </span><span>==</span><span> </span><span>b</span><span> </span><span>=&gt;</span><span> </span><span>a</span><span>,</span><span></span>
<span>                </span><span>_</span><span> </span><span>=&gt;</span><span> </span><span>return</span><span> </span><span>None</span><span>,</span><span></span>
<span>            </span><span>},</span><span></span>
<span>            </span><span>Enumerator</span>::<span>RevIter</span><span>(</span><span>i</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>match</span><span> </span><span>i</span><span>.</span><span>size_hint</span><span>()</span><span> </span><span>{</span><span></span>
<span>                </span><span>(</span><span>a</span><span>,</span><span> </span><span>Some</span><span>(</span><span>b</span><span>))</span><span> </span><span>if</span><span> </span><span>a</span><span> </span><span>==</span><span> </span><span>b</span><span> </span><span>=&gt;</span><span> </span><span>a</span><span>,</span><span></span>
<span>                </span><span>_</span><span> </span><span>=&gt;</span><span> </span><span>return</span><span> </span><span>None</span><span>,</span><span></span>
<span>            </span><span>},</span><span></span>
<span>            </span><span>Enumerator</span>::<span>Seq</span><span>(</span><span>v</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>*</span><span>v</span><span>,</span><span></span>
<span>            </span><span>Enumerator</span>::<span>NonEnumerable</span><span> </span><span>=&gt;</span><span> </span><span>return</span><span> </span><span>None</span><span>,</span><span></span>
<span>        </span><span>})</span><span></span>
<span>    </span><span>}</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>The important part here is the call to <cite>size_hint</cite>.  If the upper bound is
known, and the lower bound matches the upper bound then MiniJinja will
assume the iterator will always have that length (for as long as not
iterated).  As a result it will change the way the object is interacted
with.  This for instance means that if you run <cite>range(10)</cite> in a template
it looks like a list when printed even though iteration and number
creation is lazy.  On the other hand if you use the
<cite>Value::make_one_shot_iterator</cite> API the length hint will always be
disabled and MiniJinja will not attempt to interact with the iterator when
printing it:</p>
<div><pre><span></span><span>{{</span> <span>range</span><span>(</span><span>4</span><span>)</span> <span>}}</span><span>         -&gt; prints [0, 1, 2, 3]</span>
<span>{{</span> <span>a_real_iterator</span> <span>}}</span><span>  -&gt; prints &lt;iterator&gt;</span>
</pre></div>
</div>
<div id="building-a-vm">
<h2>Building a VM</h2>
<p>Lexing and parsing I think is not too puzzling in Rust, but making an AST
and making a VM is kinda unusual.  The first thing is that Rust is just
not particularly amazing at tree structures.  In MiniJinja I really wanted
to avoid having the AST at all, but it does come in in handy to implement
some of the functionality that Jinja2 requires.  For instance to establish
closures it will just walk the AST to figure out which names are looked up
within a function.  I tried a few things to improve how memory allocations
work with the AST.  There are great crates out there for doing this, but
I really wanted MiniJinja to be light on dependencies so I ended up opting
against all of them.</p>
<p>For the AST design I went with large enums that hold <cite>Spanned&lt;T&gt;</cite> values:</p>
<div><pre><span></span><span>pub</span><span> </span><span>enum</span> <span>Expr</span><span>&lt;'</span><span>a</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>    </span><span>Var</span><span>(</span><span>Spanned</span><span>&lt;</span><span>Var</span><span>&lt;'</span><span>a</span><span>&gt;&gt;</span><span>),</span><span></span>
<span>    </span><span>Const</span><span>(</span><span>Spanned</span><span>&lt;</span><span>Const</span><span>&gt;</span><span>),</span><span></span>
<span>    </span><span>..</span><span>.</span><span></span>
<span>}</span><span></span>

<span>pub</span><span> </span><span>struct</span> <span>Var</span><span>&lt;'</span><span>a</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>    </span><span>pub</span><span> </span><span>id</span>: <span>&amp;</span><span>'</span><span>a</span> <span>str</span><span>,</span><span></span>
<span>}</span><span></span>

<span>pub</span><span> </span><span>struct</span> <span>Const</span><span> </span><span>{</span><span></span>
<span>    </span><span>pub</span><span> </span><span>value</span>: <span>Value</span><span>,</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>You might now be curious what <cite>Spanned&lt;T&gt;</cite> is.  It's a wrapper type that
does two things: it boxes the inner node and it stores and adjacent <cite>Span</cite>
which is basically the code location in the original input template for
debugging:</p>
<div><pre><span></span><span>pub</span><span> </span><span>struct</span> <span>Spanned</span><span>&lt;</span><span>T</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>    </span><span>node</span>: <span>Box</span><span>&lt;</span><span>T</span><span>&gt;</span><span>,</span><span></span>
<span>    </span><span>span</span>: <span>Span</span><span>,</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>It implements <cite>Deref</cite> like a smart pointer so you can poke right through
it to interact with the node.  The code generator just walks the AST and
<a href="https://github.com/mitsuhiko/minijinja/blob/main/minijinja/src/compiler/codegen.rs">emits instructions</a>
for it.</p>
<p>The instructions themselves are a large enum but the number of arguments
to the variants is kept rather low to not waste too much memory.  The base
size of the instruction is dominated by it being able to hold a <cite>Value</cite>
which as we have established is a pretty hefty thing:</p>
<div><pre><span></span><span>pub</span><span> </span><span>enum</span> <span>Instruction</span><span>&lt;'</span><span>source</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>    </span><span>EmitRaw</span><span>(</span><span>&amp;'</span><span>source</span><span> </span><span>str</span><span>),</span><span></span>
<span>    </span><span>StoreLocal</span><span>(</span><span>&amp;'</span><span>source</span><span> </span><span>str</span><span>),</span><span></span>
<span>    </span><span>Lookup</span><span>(</span><span>&amp;'</span><span>source</span><span> </span><span>str</span><span>),</span><span></span>
<span>    </span><span>LoadConst</span><span>(</span><span>Value</span><span>),</span><span></span>
<span>    </span><span>Jump</span><span>(</span><span>usize</span><span>),</span><span></span>
<span>    </span><span>JumpIfFalse</span><span>(</span><span>usize</span><span>),</span><span></span>
<span>    </span><span>JumpIfFalseOrPop</span><span>(</span><span>usize</span><span>),</span><span></span>
<span>    </span><span>JumpIfTrueOrPop</span><span>(</span><span>usize</span><span>),</span><span></span>
<span>    </span><span>..</span><span>.</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>The VM keeps most of the runtime state on a <cite>State</cite> object that is passed
to a few places.  For instance you have already seen this in the <cite>call</cite>
signature further up.  The state for instance holds the loaded
instructions or the template context.  The VM itself maintains a stack of
values and then just steps through a list of instructions on the state in
a loop.  Since there are a lot of instructions you can <a href="https://github.com/mitsuhiko/minijinja/blob/b327a8c41ae869bb71452e7b645126ff6966e2ef/minijinja/src/vm/mod.rs#L216">have a look on
GitHub to see it</a>
in its entirety.  Here however is a small part that shows roughly how this
works:</p>
<div><pre><span></span><span>let</span><span> </span><span>mut</span><span> </span><span>pc</span><span> </span><span>=</span><span> </span><span>0</span><span>;</span><span></span>
<span>loop</span><span> </span><span>{</span><span></span>
<span>    </span><span>let</span><span> </span><span>instr</span><span> </span><span>=</span><span> </span><span>state</span><span>.</span><span>instructions</span><span>.</span><span>get</span><span>(</span><span>pc</span><span>)</span><span> </span><span>{</span><span></span>
<span>        </span><span>Some</span><span>(</span><span>instr</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>instr</span><span>,</span><span></span>
<span>        </span><span>None</span><span> </span><span>=&gt;</span><span> </span><span>break</span><span>,</span><span></span>
<span>    </span><span>};</span><span></span>

<span>    </span><span>let</span><span> </span><span>a</span><span>;</span><span></span>
<span>    </span><span>let</span><span> </span><span>b</span><span>;</span><span></span>

<span>    </span><span>match</span><span> </span><span>instr</span><span> </span><span>{</span><span></span>
<span>        </span><span>Instruction</span>::<span>EmitRaw</span><span>(</span><span>val</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>out</span><span>.</span><span>write_str</span><span>(</span><span>val</span><span>).</span><span>map_err</span><span>(</span><span>Error</span>::<span>from</span><span>)</span><span>?</span><span>;</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>Emit</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>self</span><span>.</span><span>env</span><span>.</span><span>format</span><span>(</span><span>&amp;</span><span>stack</span><span>.</span><span>pop</span><span>(),</span><span> </span><span>state</span><span>,</span><span> </span><span>out</span><span>)</span><span>?</span><span>;</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>StoreLocal</span><span>(</span><span>name</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>state</span><span>.</span><span>ctx</span><span>.</span><span>store</span><span>(</span><span>name</span><span>,</span><span> </span><span>stack</span><span>.</span><span>pop</span><span>());</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>Lookup</span><span>(</span><span>name</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>stack</span><span>.</span><span>push</span><span>(</span><span>assert_valid</span><span>!</span><span>(</span><span>state</span><span></span>
<span>                </span><span>.</span><span>lookup</span><span>(</span><span>name</span><span>)</span><span></span>
<span>                </span><span>.</span><span>unwrap_or</span><span>(</span><span>Value</span>::<span>UNDEFINED</span><span>)));</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>GetAttr</span><span>(</span><span>name</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>a</span><span> </span><span>=</span><span> </span><span>stack</span><span>.</span><span>pop</span><span>();</span><span></span>
<span>            </span><span>stack</span><span>.</span><span>push</span><span>(</span><span>match</span><span> </span><span>a</span><span>.</span><span>get_attr_fast</span><span>(</span><span>name</span><span>)</span><span> </span><span>{</span><span></span>
<span>                </span><span>Some</span><span>(</span><span>value</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>value</span><span>,</span><span></span>
<span>                </span><span>None</span><span> </span><span>=&gt;</span><span> </span><span>undefined_behavior</span><span>.</span><span>handle_undefined</span><span>(</span><span>a</span><span>.</span><span>is_undefined</span><span>())</span><span>?</span><span>,</span><span></span>
<span>            </span><span>});</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>LoadConst</span><span>(</span><span>value</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>stack</span><span>.</span><span>push</span><span>(</span><span>value</span><span>.</span><span>clone</span><span>());</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>Jump</span><span>(</span><span>jump_target</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>pc</span><span> </span><span>=</span><span> </span><span>*</span><span>jump_target</span><span>;</span><span></span>
<span>            </span><span>continue</span><span>;</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>Instruction</span>::<span>JumpIfFalse</span><span>(</span><span>jump_target</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span>
<span>            </span><span>a</span><span> </span><span>=</span><span> </span><span>stack</span><span>.</span><span>pop</span><span>();</span><span></span>
<span>            </span><span>if</span><span> </span><span>!</span><span>undefined_behavior</span><span>.</span><span>is_true</span><span>(</span><span>&amp;</span><span>a</span><span>)</span><span>?</span><span> </span><span>{</span><span></span>
<span>                </span><span>pc</span><span> </span><span>=</span><span> </span><span>*</span><span>jump_target</span><span>;</span><span></span>
<span>                </span><span>continue</span><span>;</span><span></span>
<span>            </span><span>}</span><span></span>
<span>        </span><span>}</span><span></span>
<span>        </span><span>// ...</span>
<span>    </span><span>}</span><span></span>
<span>    </span><span>pc</span><span> </span><span>+=</span><span> </span><span>1</span><span>;</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>Basically the current instruction is held in <cite>pc</cite> (short for program
counter), normally it's advanced by one but jump instructions can change
the <cite>pc</cite> to any other location.  If you run out of instructions the
evaluation ends.</p>
<p>One piece of complexity in the VM comes down to macros.  That's because
lifetimes make that really tricky.  A macro is just a <cite>Value</cite> that holds a
<cite>Macro</cite> <cite>Object</cite> internally.  So how can that macro reference the
instructions, if the instructions themselves have a lifetime to the
template <cite>'source</cite>?  The answer is that they can't (at least I have not
found a reasonable way).  So instead a macro has an ID which acts as a
handle to look up the instructions dynamically from the execution state.
Additionally each state has a unique ID so the engine can assert that
nothing funny was happening.  The downside of this is that a macro cannot
be "returned" from a template.  They can however be imported from one
template into another.</p>
<p>Here is what a macro object looks like in code (abbreviated):</p>
<div><pre><span></span><span>pub</span><span>(</span><span>crate</span><span>)</span><span> </span><span>struct</span> <span>Macro</span><span> </span><span>{</span><span></span>
<span>    </span><span>pub</span><span> </span><span>name</span>: <span>Value</span><span>,</span><span></span>
<span>    </span><span>pub</span><span> </span><span>arg_spec</span>: <span>Vec</span><span>&lt;</span><span>Value</span><span>&gt;</span><span>,</span><span></span>
<span>    </span><span>pub</span><span> </span><span>macro_ref_id</span>: <span>usize</span><span>,</span><span>  </span><span>// id of the macro</span>
<span>    </span><span>pub</span><span> </span><span>state_id</span>: <span>isize</span><span>,</span><span></span>
<span>    </span><span>pub</span><span> </span><span>closure</span>: <span>Value</span><span>,</span><span></span>
<span>    </span><span>pub</span><span> </span><span>caller_reference</span>: <span>bool</span><span>,</span><span></span>
<span>}</span><span></span>

<span>impl</span><span> </span><span>Object</span><span> </span><span>for</span><span> </span><span>Macro</span><span> </span><span>{</span><span></span>
<span>    </span><span>fn</span> <span>call</span><span>(</span><span>self</span>: <span>&amp;</span><span>Arc</span><span>&lt;</span><span>Self</span><span>&gt;</span><span>,</span><span> </span><span>state</span>: <span>&amp;</span><span>State</span><span>&lt;'</span><span>_</span><span>,</span><span> </span><span>'</span><span>_</span><span>&gt;</span><span>,</span><span> </span><span>args</span>: <span>&amp;</span><span>[</span><span>Value</span><span>])</span><span> </span>-&gt; <span>Result</span><span>&lt;</span><span>Value</span><span>,</span><span> </span><span>Error</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>        </span><span>// we can only call macros that point to loaded template state.</span>
<span>        </span><span>// if a template would be returned from a template this will</span>
<span>        </span><span>// fail.</span>
<span>        </span><span>if</span><span> </span><span>state</span><span>.</span><span>id</span><span> </span><span>!=</span><span> </span><span>self</span><span>.</span><span>state_id</span><span> </span><span>{</span><span></span>
<span>            </span><span>return</span><span> </span><span>Err</span><span>(</span><span>Error</span>::<span>new</span><span>(</span><span></span>
<span>                </span><span>ErrorKind</span>::<span>InvalidOperation</span><span>,</span><span></span>
<span>                </span><span>"cannot call this macro. template state went away."</span><span>,</span><span></span>
<span>            </span><span>));</span><span></span>
<span>        </span><span>}</span><span></span>

<span>        </span><span>// ... argument parsing</span>
<span>        </span><span>let</span><span> </span><span>arg_values</span><span> </span><span>=</span><span> </span><span>..</span><span>.;</span><span></span>

<span>        </span><span>// find referenced instructions</span>
<span>        </span><span>let</span><span> </span><span>(</span><span>instructions</span><span>,</span><span> </span><span>offset</span><span>)</span><span> </span><span>=</span><span> </span><span>&amp;</span><span>state</span><span>.</span><span>macros</span><span>[</span><span>self</span><span>.</span><span>macro_ref_id</span><span>];</span><span></span>

<span>        </span><span>// created a nested vm and evaluate the macro</span>
<span>        </span><span>let</span><span> </span><span>vm</span><span> </span><span>=</span><span> </span><span>Vm</span>::<span>new</span><span>(</span><span>state</span><span>.</span><span>env</span><span>());</span><span></span>
<span>        </span><span>let</span><span> </span><span>mut</span><span> </span><span>rv</span><span> </span><span>=</span><span> </span><span>String</span>::<span>new</span><span>();</span><span></span>
<span>        </span><span>let</span><span> </span><span>mut</span><span> </span><span>out</span><span> </span><span>=</span><span> </span><span>Output</span>::<span>with_string</span><span>(</span><span>&amp;</span><span>mut</span><span> </span><span>rv</span><span>);</span><span></span>
<span>        </span><span>let</span><span> </span><span>closure</span><span> </span><span>=</span><span> </span><span>self</span><span>.</span><span>closure</span><span>.</span><span>clone</span><span>();</span><span></span>
<span>        </span><span>ok</span><span>!</span><span>(</span><span>vm</span><span>.</span><span>eval_macro</span><span>(</span><span></span>
<span>            </span><span>instructions</span><span>,</span><span></span>
<span>            </span><span>*</span><span>offset</span><span>,</span><span></span>
<span>            </span><span>self</span><span>.</span><span>closure</span><span>.</span><span>clone</span><span>(),</span><span></span>
<span>            </span><span>state</span><span>.</span><span>ctx</span><span>.</span><span>clone_base</span><span>(),</span><span></span>
<span>            </span><span>caller</span><span>,</span><span></span>
<span>            </span><span>&amp;</span><span>mut</span><span> </span><span>out</span><span>,</span><span></span>
<span>            </span><span>state</span><span>,</span><span></span>
<span>            </span><span>arg_values</span><span></span>
<span>        </span><span>));</span><span></span>

<span>        </span><span>// return rendered template as string from the call</span>
<span>        </span><span>Ok</span><span>(</span><span>if</span><span> </span><span>!</span><span>matches!</span><span>(</span><span>state</span><span>.</span><span>auto_escape</span><span>(),</span><span> </span><span>AutoEscape</span>::<span>None</span><span>)</span><span> </span><span>{</span><span></span>
<span>            </span><span>Value</span>::<span>from_safe_string</span><span>(</span><span>rv</span><span>)</span><span></span>
<span>        </span><span>}</span><span> </span><span>else</span><span> </span><span>{</span><span></span>
<span>            </span><span>Value</span>::<span>from</span><span>(</span><span>rv</span><span>)</span><span></span>
<span>        </span><span>})</span><span></span>
<span>    </span><span>}</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>Additionally the closure is a good source of cycles.  For that reason the
engine keeps track of all closures during the execution and breaks cycles
caused by closures manually by clearning them out.</p>
</div>
<div id="cool-apis">
<h2>Cool APIs</h2>
<p>The last part that I want to go over is the magic that makes this work:</p>
<div><pre><span></span><span>fn</span> <span>slugify</span><span>(</span><span>value</span>: <span>String</span><span>)</span><span> </span>-&gt; <span>String</span> <span>{</span><span></span>
<span>    </span><span>value</span><span>.</span><span>to_lowercase</span><span>().</span><span>split_whitespace</span><span>().</span><span>collect</span>::<span>&lt;</span><span>Vec</span><span>&lt;</span><span>_</span><span>&gt;&gt;</span><span>().</span><span>join</span><span>(</span><span>"-"</span><span>)</span><span></span>
<span>}</span><span></span>

<span>fn</span> <span>timeformat</span><span>(</span><span>state</span>: <span>&amp;</span><span>State</span><span>,</span><span> </span><span>ts</span>: <span>f64</span><span>)</span><span> </span>-&gt; <span>String</span> <span>{</span><span></span>
<span>    </span><span>let</span><span> </span><span>configured_format</span><span> </span><span>=</span><span> </span><span>state</span><span>.</span><span>lookup</span><span>(</span><span>"TIME_FORMAT"</span><span>);</span><span></span>
<span>    </span><span>let</span><span> </span><span>format</span><span> </span><span>=</span><span> </span><span>configured_format</span><span></span>
<span>        </span><span>.</span><span>as_ref</span><span>()</span><span></span>
<span>        </span><span>.</span><span>and_then</span><span>(</span><span>|</span><span>x</span><span>|</span><span> </span><span>x</span><span>.</span><span>as_str</span><span>())</span><span></span>
<span>        </span><span>.</span><span>unwrap_or</span><span>(</span><span>"HH:MM:SS"</span><span>);</span><span></span>
<span>    </span><span>format_unix_timestamp</span><span>(</span><span>ts</span><span>,</span><span> </span><span>format</span><span>)</span><span></span>
<span>}</span><span></span>

<span>let</span><span> </span><span>mut</span><span> </span><span>env</span><span> </span><span>=</span><span> </span><span>Environment</span>::<span>new</span><span>();</span><span></span>
<span>env</span><span>.</span><span>add_filter</span><span>(</span><span>"slugify"</span><span>,</span><span> </span><span>slugify</span><span>);</span><span></span>
<span>env</span><span>.</span><span>add_filter</span><span>(</span><span>"timeformat"</span><span>,</span><span> </span><span>timeformat</span><span>);</span><span></span>
</pre></div>
<p>You might have seem something like this in Rust before, but it's still a
bit magical.  How can you make functions with seemingly different
signatures register with the <cite>add_filter</cite> function?  How does the engine
perform the type conversions (as we know the engine has <cite>Value</cite> types, so
where does the <cite>String</cite> conversion take place?).  This is a topic for a
blog post on its own but the answer behind this lies in a a lot of clever
trait hackery.  The <cite>add_filter</cite> function reveals a bit of that hackery:</p>
<div><pre><span></span><span>pub</span><span> </span><span>fn</span> <span>add_filter</span><span>&lt;</span><span>N</span><span>,</span><span> </span><span>F</span><span>,</span><span> </span><span>Rv</span><span>,</span><span> </span><span>Args</span><span>&gt;</span><span>(</span><span>&amp;</span><span>mut</span><span> </span><span>self</span><span>,</span><span> </span><span>name</span>: <span>N</span><span>,</span><span> </span><span>f</span>: <span>F</span><span>)</span><span></span>
<span>where</span><span></span>
<span>    </span><span>N</span>: <span>Into</span><span>&lt;</span><span>Cow</span><span>&lt;'</span><span>source</span><span>,</span><span> </span><span>str</span><span>&gt;&gt;</span><span>,</span><span></span>
<span>    </span><span>F</span>: <span>Filter</span><span>&lt;</span><span>Rv</span><span>,</span><span> </span><span>Args</span><span>&gt;</span><span> </span><span>+</span><span> </span><span>for</span><span>&lt;'</span><span>a</span><span>&gt;</span><span> </span><span>Filter</span><span>&lt;</span><span>Rv</span><span>,</span><span> </span><span>&lt;</span><span>Args</span><span> </span><span>as</span><span> </span><span>FunctionArgs</span><span>&lt;'</span><span>a</span><span>&gt;&gt;</span>::<span>Output</span><span>&gt;</span><span>,</span><span></span>
<span>    </span><span>Rv</span>: <span>FunctionResult</span><span>,</span><span></span>
<span>    </span><span>Args</span>: <span>for</span><span>&lt;'</span><span>a</span><span>&gt;</span><span> </span><span>FunctionArgs</span><span>&lt;'</span><span>a</span><span>&gt;</span><span>,</span><span></span>
<span>{</span><span></span>
<span>    </span><span>let</span><span> </span><span>filter</span><span> </span><span>=</span><span> </span><span>BoxedFilter</span><span>(</span><span>Arc</span>::<span>new</span><span>(</span><span>move</span><span> </span><span>|</span><span>state</span><span>,</span><span> </span><span>args</span><span>|</span><span> </span>-&gt; <span>Result</span><span>&lt;</span><span>Value</span><span>,</span><span> </span><span>Error</span><span>&gt;</span><span> </span><span>{</span><span></span>
<span>        </span><span>f</span><span>.</span><span>apply_to</span><span>(</span><span>Args</span>::<span>from_values</span><span>(</span><span>Some</span><span>(</span><span>state</span><span>),</span><span> </span><span>args</span><span>)</span><span>?</span><span>).</span><span>into_result</span><span>()</span><span></span>
<span>    </span><span>}));</span><span></span>
<span>    </span><span>self</span><span>.</span><span>filters</span><span>.</span><span>insert</span><span>(</span><span>name</span><span>.</span><span>into</span><span>(),</span><span> </span><span>filter</span><span>);</span><span></span>
<span>}</span><span></span>
</pre></div>
<p>Hidden behind this rather complex set of traits are some basic ideas:</p>
<ol>
<li><cite>FunctionArgs</cite> is a helper trait for type conversions.  It's
implemented for tuples of different sizes made of <cite>ArgType</cite> values.
These tuples represent the signature of the function.  It has a method
called <cite>from_values</cite> which performs that conversion via <cite>ArgType</cite>.</li>
<li><cite>ArgType</cite> which you can't really see in the code above, is a trait that
knows how to convert a <cite>Value</cite> into whatever the function desires as
argument.</li>
<li><cite>Filter</cite> is a trait implemented for function with qualifying
<cite>FunctionArgs</cite> signatures returning a <cite>FunctionResult</cite>.</li>
<li>A <cite>FunctionResult</cite> is a trait that represents potential return values
from the function such as a <cite>Value</cite>, something that can be converted into
a <cite>Value</cite> or a <cite>Result</cite>.</li>
<li>The <cite>BoxedFilter</cite> type is what converts the passed closure into a
reference counted object that is held in the environment.</li>
</ol>
</div>
<div id="conclusion">
<h2>Conclusion</h2>
<p>I think a lot of the patterns in MiniJinja are useful for projects
outside of MiniJinja.  Quite is quite a bit more hidden in it that I have
talked about before such as how <a href="https://lucumr.pocoo.org/2021/11/14/abusing-serde/">MiniJinja is abusing serde</a>.  If you have a need for a Jinja2
compatible template engine I would love if you get some use out of it.  If
you're curious about how to build a runtime and object system in Rust, you
might also find some utility in the codebase.</p>
<p>I myself learned quite a bit about what creative API design can look like
in Rust by building it.  At this point I am incredibly happy with how the
public API of the engine shaped out to be.  The engine is extensively
documented both internally and publicly and you can <a href="https://docs.rs/minijinja/latest/minijinja/">read all about it in
the API docs</a>.</p>
</div>


  
  <p>This entry was tagged
    
      <a href="https://lucumr.pocoo.org/tags/jinja/">jinja</a> and 
      <a href="https://lucumr.pocoo.org/tags/rust/">rust</a>
  

      </p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Nuclear reactors a mile underground promise safe, cheap power (139 pts)]]></title>
            <link>https://newatlas.com/energy/underground-nuclear-reactors/</link>
            <guid>41366436</guid>
            <pubDate>Tue, 27 Aug 2024 11:36:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://newatlas.com/energy/underground-nuclear-reactors/">https://newatlas.com/energy/underground-nuclear-reactors/</a>, See on <a href="https://news.ycombinator.com/item?id=41366436">Hacker News</a></p>
Couldn't get https://newatlas.com/energy/underground-nuclear-reactors/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Why has Japan been hit with rice shortages despite normal crops? (129 pts)]]></title>
            <link>https://mainichi.jp/english/articles/20240823/p2a/00m/0bu/024000c</link>
            <guid>41366304</guid>
            <pubDate>Tue, 27 Aug 2024 11:19:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mainichi.jp/english/articles/20240823/p2a/00m/0bu/024000c">https://mainichi.jp/english/articles/20240823/p2a/00m/0bu/024000c</a>, See on <a href="https://news.ycombinator.com/item?id=41366304">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<!-- cxenseparse_start -->

<div>
<figure>
<div>
<a data-href="https://cdn.mainichi.jp/vol1/2024/08/23/20240823p2a00m0bu021000p/9.jpg?1" data-lightbox="photos" data-title="Shortages of Japanese rice, pictured in this file photo taken on Aug. 14, 2024, have continued in Japan. (Mainichi/Shiro Sakamaki)">
<span>
<img src="https://cdn.mainichi.jp/vol1/2024/08/23/20240823p2a00m0bu021000p/6.jpg?1" alt="">

</span>

</a>
</div>
<figcaption>Shortages of Japanese rice, pictured in this file photo taken on Aug. 14, 2024, have continued in Japan. (Mainichi/Shiro Sakamaki)</figcaption>
</figure>
</div>
<p>
    TOKYO -- Shortages of rice have recently been seen across Japan, and the price of the staple food is soaring. But close to 100% of Japan's rice is domestically produced and the yield of crops appears normal, so why is this happening? 
</p>
<!-- cxenseparse_end -->

<!-- cxenseparse_start -->
<p>
    The Mainichi Shimbun spoke with Kazuhito Yamashita, a former bureaucrat at Japan's Ministry of Agriculture, Forestry and Fisheries and a research director at the Canon Institute for Global Studies, about the background to the rice commotion, shedding light on the reality of rice policies that have disregarded consumers. Questions and answers from the interview follow:
</p>
<p>
    <b>No poor harvest</b>
</p>
<p>
    Question: Why is there a shortage of rice and why are prices high?
</p>
<p>
    Answer: Some have said that it's due to lean crops as a result of last year's scorching summer, or from an increase in inbound tourism, but neither of these is the main reason.
</p>
<p>
    The crop situation index for rice grown in 2023, indicating the amount of the rice harvest, was 101 -- around the same as an average year. In contrast, the crop situation index for 1993, which led to the so-called "rice riots of the Heisei era," was 74. Some suggest that a lean harvest of high-quality rice caused a shortage of the crop, but the harvest was not bad.
</p>
<p>
    As for the suggestion that inbound visitors are consuming more, we cannot say this is a major factor. Even if around 3 million visitors were to stay in Japan each month for a week and eat rice for breakfast, lunch and dinner like many Japanese people, it would still only account for around 0.5% of total consumption. And in actual fact, not many visitors have rice for all three meals, so their consumption must be even lower.
</p>
<p>
    <b>A mechanism that has lasted for over 50 years</b>
</p>
<p>
    Q: What is the main factor, then?
</p>
<p>
    A: The reason there is a shortage of rice is because of the acreage reduction policy which decreases the amount of land devoted to cultivation. Under acreage reduction, rice production is cut to raise market prices, and the government provides subsidies to rice farmers who switch to other crops such as wheat or soybeans. Japan has continued this policy for over 50 years.
</p>

<div>
<figure>
<div>
<a data-href="https://cdn.mainichi.jp/vol1/2024/08/23/20240823p2a00m0bu022000p/9.jpg?1" data-lightbox="photos" data-title="Kazuhito Yamashita, a research director at the Canon Institute for Global Studies, speaks in an interview with the Mainichi Shimbun in Tokyo's Chiyoda Ward on Aug. 6, 2024. (Mainichi/Megumi Udagawa)">
<span>
<img src="https://cdn.mainichi.jp/vol1/2024/08/23/20240823p2a00m0bu022000p/7.jpg?1" alt="">

</span>

</a>
</div>
<figcaption>Kazuhito Yamashita, a research director at the Canon Institute for Global Studies, speaks in an interview with the Mainichi Shimbun in Tokyo's Chiyoda Ward on Aug. 6, 2024. (Mainichi/Megumi Udagawa)</figcaption>
</figure>
</div>
<p>
    Because consumption of bread, pasta and other alternative foods is increasing, if farmers produced the same amount of rice as before, there would be a surplus, causing the price of rice to drop. To avoid such a situation, production has been cut year by year, and recently only about 60% of rice paddies are in use, with the others set aside under the acreage reduction policy. Production has thus been kept at under half of the peak of 14.45 million metric tons annually.
</p>
<p>
    Because production has been managed so tightly, when there is even a slight increase in demand, such as from inbound tourists, it can quickly lead to a shortage, and prices surge as a result. This is the essence of what is happening now.
</p>
<p>
    <b>Misleading idea of 'abolition of acreage reduction' under Abe government</b>
</p>
<p>
    Q: Wasn't the rice acreage reduction policy abolished in 2018 under the administration of then Prime Minister Shinzo Abe?
</p>
<p>
    A: That was a trick of the Abe administration. They actually only abolished the rice production targets, and the policy of providing subsidies if farmers reduced their rice production remained in place. In fact, I asked an official from the Ministry of Agriculture, Forestry and Fisheries at the time if they were really abolishing the policy to reduce acreage, and they firmly stated, "Absolutely not. We have never said we would abolish it."
</p>
<p>
    At the time, the prime minister's office probably wanted to display colors of reform by coming out with "the abolishment of acreage reduction" and use that to buoy the administration. The truth is that this was well received by the public, so the Abe administration kept on claiming that the rice acreage reduction policy had been abolished.
</p>
<p>
    <b>No protests occurred</b>
</p>
<p>
    Q: So, the public was deceived?
</p>
<p>
    A: If the rice acreage policy had really been abolished, rice production would have increased, and prices would have plummeted. This in turn would have stirred massive protests from farmers. But have rice prices dropped? On the contrary, we're seeing a commotion now because of the high prices.
</p>
<p>
    No other country has maintained a crop acreage reduction policy for as long as Japan has. The United States and the European Union temporarily introduced such a policy when there was a surplus of crops in order to maintain prices. But now they have all stopped doing this. That's because they know that producing more and exporting it brings greater benefits than reducing the amount produced.
</p>
<p>
    Japan should also completely abolish the rice acreage reduction policy, produce more rice and actively start exporting it. This would also increase the food self-sufficiency rate.
</p>

<div>
<figure>
<div>
<a data-href="https://cdn.mainichi.jp/vol1/2024/08/23/20240823p2a00m0bu023000p/9.jpg?1" data-lightbox="photos" data-title="Ripe rice plants are pictured in Miyagi Prefecture in this file photo taken on Aug. 28, 2017. (Mainichi)">
<span>
<img src="https://cdn.mainichi.jp/vol1/2024/08/23/20240823p2a00m0bu023000p/6.jpg?1" alt="">

</span>

</a>
</div>
<figcaption>Ripe rice plants are pictured in Miyagi Prefecture in this file photo taken on Aug. 28, 2017. (Mainichi)</figcaption>
</figure>
</div>
<p>
    <b>The 'Rolls-Royce' of rice</b>
</p>
<p>
    Q: Is Japanese rice competitive internationally?
</p>
<p>
    A: People across the world say, "It's the best-tasting rice in the world, so why isn't more of it being exported?" Japanese agricultural officials often comment, "We can't compete with cheap rice produced in Thailand and elsewhere," but that's not the case. Just like you have luxury and standard cars, there are different kinds of rice. Luxury cars won't lose out to ordinary ones even if the price is higher.
</p>
<p>
    The British Rolls-Royce is an ultra-luxury vehicle, and Japanese rice, too, should be marketed as the Rolls-Royce of rice, so there's no need to compete with cheaper rice. With the right pricing, any amount will sell. In actual fact, in California, Koshihikari rice produced in the state is now selling for a higher price than in Japanese supermarkets.
</p>
<p>
    <b>A terrible policy</b>
</p>
<p>
    Q: It's said that the decline in rice consumption is serious, but if the amount produced increased and the price went down, people would eat more, wouldn't they?
</p>
<p>
    A: Exactly. Rice acreage reduction is an absolutely terrible policy. The government spends over 300 billion yen (about $2.06 billion) in subsidies annually to decrease the amount of rice produced, thus going out of its way to raise the price and increasing the burden on consumers. In the medical field, for example, the government spends money to reduce the financial burden on citizens, but the rice acreage reduction does the opposite -- it is using taxpayer money to make consumers suffer.
</p>
<p>
    Furthermore, due to the acreage reduction policy, the development of rice varieties that increase yield per unit area has been halted. By unit area, Californian rice now yields 1.6 times more than Japan's. Chinese rice too used to yield only half as much as Japan's but now yields more.
</p>
<p>
    The acreage reduction policy does not benefit consumers or the agricultural industry. If the abolition of the acreage reduction policy causes rice prices to drop and creates difficulties for full-time farmers whose main income is from agriculture, direct payments from the government, like in Western countries, would be the solution.
</p>
<p>
    <b>Increased production needed for food security</b>
</p>
<p>
    Q: Japan's rice is the only grain of which almost all is produced domestically. From the point of food security, it's important to increase the amount produced, right?
</p>
<p>
    A: Japan currently harvests just under 7 million tons annually, but if it were to do away with the rice acreage policy and introduce high-yield rice varieties, it would have the ability to produce 17 million tons a year. If it were to yield that much and export 10 million tons, it would have great security benefits. For example, if a maritime blockade was imposed in the event of an emergency situation in Taiwan and imports and exports were cut off, Japan would be able to use the 10 million tons that it had exported for its people. Exports serve as a kind of reserve for emergencies. All countries are aware of this and are advancing their food policies accordingly.
</p>
<p>
    <b>Shortages, high prices likely to recur</b>
</p>
<p>
    Q: Are the rice shortages and high prices that we're seeing likely to recur in the future?
</p>
<p>
    A: As long as the policy to reduce rice acreage remains in place, similar situations will occur again. That's because the environment where even a small movement in consumption can lead to rice shortages and high prices remains unchanged.
</p>
<p>
    Today, the world's largest rice exporter is India, with its exports reaching 10 million to 20 million tons annually. If Japan completely abolished rice acreage reduction and exported 10 million tons a year, it would become one of the world's largest rice suppliers and could also contribute to global food security. Despite such opportunities, officials have paid no attention, begging the question of how long Japan intends to continue to pour effort into maintaining high domestic rice prices.
</p>
<p>
    (Interviewed by Megumi Udagawa, Opinion Group)
</p>
<p>
    <b>Profile: Kazuhito Yamashita</b> 
</p>
<p>
    Kazuhito Yamashita was born in western Japan's Okayama Prefecture in 1955. He graduated from the University of Tokyo's Faculty of Law in 1977 and joined the former Ministry of Agriculture, Forestry and Fisheries (MAFF) in 1977. He served as vice chairman of the OECD Committee for Agriculture and deputy director-general of MAFF's Rural Development Bureau. His expertise includes food and agricultural policy. He has authored many books, including "Nihon ga Ueru! Sekai Shokuryo Kiki no Shinjitsu" (Japan is starving! The truth of the global food crisis).
</p>
<!-- cxenseparse_end -->

<!--| tools BGN |-->

<!--| tools END |-->
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The possibilities for dark matter have shrunk (126 pts)]]></title>
            <link>https://www.sciencenews.org/article/dark-matter-wimps-lz</link>
            <guid>41366064</guid>
            <pubDate>Tue, 27 Aug 2024 10:37:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.sciencenews.org/article/dark-matter-wimps-lz">https://www.sciencenews.org/article/dark-matter-wimps-lz</a>, See on <a href="https://news.ycombinator.com/item?id=41366064">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content">
		

<article id="post-3142967">
	<header>
	<div>
			


			
<p>
	The LZ experiment reports no signs of dark matter in their latest search</p>



		</div>

		<figure>
		<p><img width="1030" height="580" src="https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?fit=1030%2C580&amp;ssl=1" alt="An array of circular photomultiplier tubes that is part of the LZ experiment." decoding="async" fetchpriority="high" srcset="https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?w=1440&amp;ssl=1 1440w, https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?resize=680%2C383&amp;ssl=1 680w, https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?resize=800%2C450&amp;ssl=1 800w, https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?resize=330%2C186&amp;ssl=1 330w, https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?resize=768%2C432&amp;ssl=1 768w, https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?resize=1030%2C580&amp;ssl=1 1030w, https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?resize=1380%2C776&amp;ssl=1 1380w" sizes="(max-width: 1030px) 100vw, 1030px" data-attachment-id="3142969" data-permalink="https://www.sciencenews.org/082324_ec_dark-matter_feat" data-orig-file="https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?fit=1440%2C810&amp;ssl=1" data-orig-size="1440,810" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;Sanford Underground Research Facility&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="082324_EC_dark-matter_feat" data-image-description="" data-image-caption="<p style=&quot;font-weight: 400&quot;>The LZ experiment is designed to detect light from interactions of dark matter particles using photomultiplier tubes (shown).</p>
" data-medium-file="https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?fit=680%2C383&amp;ssl=1" data-large-file="https://i0.wp.com/www.sciencenews.org/wp-content/uploads/2024/08/082324_EC_dark-matter_feat.jpg?fit=800%2C450&amp;ssl=1">		</p>

					<figcaption>
									<span>
						<p>The LZ experiment is designed to detect light from interactions of dark matter particles using photomultiplier tubes (shown).</p>
					</span>
				
									<span>
						<p>Matthew Kapust/Sanford Underground Research Facility</p>
					</span>
							</figcaption>
			</figure>
	</header>

	

		
		
	<div data-component="video-embed">
				




<p>Scientists have just slashed the potential hiding spaces for dark matter particles.</p>



<p>The LUX-ZEPLIN, or LZ, experiment has searched for and ruled out the existence of dark matter particles with a wide swath of properties, researchers report August 26 at two conferences. Dark matter is a substance whose influence can be seen on the scale of galaxies and galaxy clusters, but which has never been directly detected.&nbsp;</p>



<p>LZ searches for a hypothetical type of dark matter particle called a weakly interacting massive particle, specifically WIMPs with masses above 9 billion electron volts. (For comparison, a proton has a mass of around 1 billion electron volts). The LZ detector, filled with 10 metric tons of liquid xenon,&nbsp;<a href="https://www.sciencenews.org/article/dark-matter-lz-experiment-physics">monitors for atomic nuclei recoiling</a>&nbsp;when WIMPs plow into the liquid (<em>SN: 7/7/22</em>).&nbsp;</p>





<p>The researchers characterize WIMPs by their cross section ‚Äî the probability that a particle will interact. The result shrinks the maximum possible cross section to about a fifth that allowed by previous results, LZ researchers report at the&nbsp;<a href="https://indico.uchicago.edu/event/427/contributions/1325/" target="_blank" rel="noopener">TeV Particle Astrophysics meeting</a>&nbsp;in Chicago and at the&nbsp;<a href="https://indico.cern.ch/event/1390649/contributions/6061507/" target="_blank" rel="noopener">Light Detection in Noble Elements meeting</a>&nbsp;in S√£o Paulo.</p>



<p>‚ÄúWe are making massive strides into new territory,‚Äù says physicist Chamkaur Ghag of University College London, spokesperson of LZ.&nbsp;</p>



<p>The study was performed with 280 days‚Äô worth of data. LZ‚Äôs final results will be based on 1,000 days of data, and it‚Äôs expected to further carve away at the dark matter‚Äôs possibilities ‚Äî or find evidence of it.</p>



			</div>
</article><!-- #post-## -->


<section>
	<h3 id="carousel-heading">
		More Stories from Science News on <a href="https://www.sciencenews.org/topic/particle-physics">Particle Physics</a>
	</h3>
	

</section>

	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Splatt3R: Zero-Shot Gaussian Splatting from Uncalibrated Image Pairs (108 pts)]]></title>
            <link>https://splatt3r.active.vision/</link>
            <guid>41366006</guid>
            <pubDate>Tue, 27 Aug 2024 10:23:35 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://splatt3r.active.vision/">https://splatt3r.active.vision/</a>, See on <a href="https://news.ycombinator.com/item?id=41366006">Hacker News</a></p>
Couldn't get https://splatt3r.active.vision/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Zuckerberg claims regret on caving to White House pressure on content (394 pts)]]></title>
            <link>https://www.politico.com/news/2024/08/26/zuckerberg-meta-white-house-pressure-00176399</link>
            <guid>41365868</guid>
            <pubDate>Tue, 27 Aug 2024 09:50:15 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.politico.com/news/2024/08/26/zuckerberg-meta-white-house-pressure-00176399">https://www.politico.com/news/2024/08/26/zuckerberg-meta-white-house-pressure-00176399</a>, See on <a href="https://news.ycombinator.com/item?id=41365868">Hacker News</a></p>
Couldn't get https://www.politico.com/news/2024/08/26/zuckerberg-meta-white-house-pressure-00176399: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Tinybox of tinygrad by George Hotz is finally entering production (177 pts)]]></title>
            <link>https://twitter.com/realgeorgehotz/status/1828197925874463166</link>
            <guid>41365637</guid>
            <pubDate>Tue, 27 Aug 2024 08:54:44 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://twitter.com/realgeorgehotz/status/1828197925874463166">https://twitter.com/realgeorgehotz/status/1828197925874463166</a>, See on <a href="https://news.ycombinator.com/item?id=41365637">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
    </channel>
</rss>