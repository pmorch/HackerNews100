<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 05 Jun 2024 06:30:02 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[You'll regret using natural keys (216 pts)]]></title>
            <link>https://blog.ploeh.dk/2024/06/03/youll-regret-using-natural-keys/</link>
            <guid>40580549</guid>
            <pubDate>Wed, 05 Jun 2024 01:25:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.ploeh.dk/2024/06/03/youll-regret-using-natural-keys/">https://blog.ploeh.dk/2024/06/03/youll-regret-using-natural-keys/</a>, See on <a href="https://news.ycombinator.com/item?id=40580549">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="post">
    <p>
        <em>Beating another dead horse.</em>
    </p>
    <p>
        Although I live in Copenhagen and mostly walk or ride my bicycle in order to get around town, I do own an old car for getting around the rest of the country. In Denmark, cars go through mandatory official inspection every other year, and I've been through a few of these in my life. A few years ago, the mechanic doing the inspection informed me that my car's <a href="https://en.wikipedia.org/wiki/Vehicle_identification_number">chassis number</a> was incorrect.
    </p>
    <p>
        This did make me a bit nervous, because I'd bought the car used, and I was suddenly concerned that things weren't really as I thought. Had I unwittingly bought a stolen car?
    </p>
    <p>
        But the mechanic just walked over to his computer in order to correct the error. That's when a different kind of unease hit me. When you've programmed for some decades, you learn to foresee various typical failure modes. Since a chassis number is an obvious candidate for a <a href="https://en.wikipedia.org/wiki/Natural_key">natural key</a>, I already predicted that changing the number would prove to be either impossible, or have all sorts of cascading effects, ultimately terminating in official records no longer recognizing that the car is mine.
    </p>
    <p>
        As it turned out, though, whoever made that piece of software knew what they were doing, because the mechanic just changed the chassis number, and that was that. This is now five or six years ago, and I still own the same car, and I've never had any problems with the official ownership records.
    </p>
    <h3 id="8a38dcbfae1146f8868fe8a408ffe5d8">
        Uniqueness <a href="#8a38dcbfae1146f8868fe8a408ffe5d8">#</a>
    </h3>
    <p>
        The reason I related this story is that I'm currently following an undergraduate course in databases and information systems. Since this course is aimed at students with no real-world experience, it wisely moves forward in a pedagogical progression. In order to teach database keys, it starts with natural keys. From a didactic perspective, this makes sense, but the result, so far, is that the young people I work with now propose database designs with natural keys.
    </p>
    <p>
        I'm not blaming anyone. You have to learn to crawl before you can walk.
    </p>
    <p>
        Still, this situation made me reflect on the following question: <em>Are natural keys ever a good idea?</em>
    </p>
    <p>
        Let's consider an example. For a little project we're doing, we've created a database of <a href="https://www.theworlds50best.com/">the World's 50 best restaurants</a>. My fellow students suggest a table design like this:
    </p>
    <pre><span>CREATE</span>&nbsp;<span>TABLE</span>&nbsp;Restaurants<span>&nbsp;</span><span>(</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span>year</span>&nbsp;<span>TEXT</span>&nbsp;<span>NOT</span>&nbsp;<span>NULL,</span>
&nbsp;&nbsp;&nbsp;&nbsp;<span>rank</span>&nbsp;<span>TEXT</span>&nbsp;<span>NOT</span>&nbsp;<span>NULL,</span>
&nbsp;&nbsp;&nbsp;&nbsp;restaurantName&nbsp;<span>TEXT</span>&nbsp;<span>NOT</span>&nbsp;<span>NULL,</span>
&nbsp;&nbsp;&nbsp;&nbsp;cityName&nbsp;<span>TEXT</span>&nbsp;<span>NOT</span>&nbsp;<span>NULL</span>
<span>);</span></pre>
    
    <p>
        Granted, at this point, this table definition defines no key at all. I'm not complaining about that. After all, a month ago, the students probably hadn't seen a database table.
    </p>
    <p>
        From following the course curriculum, it'd be natural, however, to define a key for the <code>Restaurants</code> table as the combination of <code>restaurantName</code>, <code>cityName</code>, and <code>year</code>. The assumption is that name and city uniquely identifies a restaurant.
    </p>
    <p>
        In this particular example, this assumption may actually turn out to hold. So far. After all, the data set isn't that big, and it's important for restaurants in that league to have recognizable names. If I had to guess, I'd say that there's probably only one <a href="https://www.nobelhartundschmutzig.com/">Nobelhart &amp; Schmutzig</a> in the world.
    </p>
    <p>
        Still, a good software architect should challenge the underlying assumptions. Is name and city a <em>natural</em> key? It's easy to imagine that it's not. What if we expand the key to include the country as well? Okay, but what if we had a restaurant named <em>China Wok</em> in Springfield, USA? Hardly unique. Add the state, you say? Probably still not unique.
    </p>
    <h3 id="778bd217e62d4ffca25f487a39d34c1a">
        Identity <a href="#778bd217e62d4ffca25f487a39d34c1a">#</a>
    </h3>
    <p>
        Ensuring uniqueness is only the first of many problems with natural keys. You may quickly reach the conclusion that for a restaurant database, a <a href="https://en.wikipedia.org/wiki/Surrogate_key">synthetic key</a> is probably the best choice.
    </p>
    <p>
        But what about 'natural' natural keys, so to speak? An example may be a car's chassis number. This is already an opaque number, and it probably originates from a database somewhere. Or how about a personal identification number? In Denmark we have the <a href="https://en.wikipedia.org/wiki/Personal_identification_number_(Denmark)">CPR number</a>, and I understand that the US <a href="https://en.wikipedia.org/wiki/Social_Security_number">Social Security Number</a> is vaguely analogous.
    </p>
    <p>
        If you're designing a database that already includes such a personal identification number, you might be tempted to use it as a natural key. After all, it's already a key somewhere else, so it's guaranteed to be unique, right?
    </p>
    <p>
        Yes, the number may uniquely identify a person, but the converse may not be true. A person may have more than one identification number. At least when time is a factor.
    </p>
    <p>
        As an example, for technical-historical reasons, the Danish CPR number carries information (which keys shouldn't do), such as a person's date of birth and sex. Since 2014 a new law enables transsexual citizens to get a new CPR number that reflects their perceived gender. The consequence is that the same person may have more than one CPR number. Perhaps not more than one at the same time, but definitely two during a lifetime.
    </p>
    <p>
        Even if existing keys are guaranteed to be unique, you can't assume that the uniqueness gives rise to a <a href="https://en.wikipedia.org/wiki/Bijection">bijection</a>. If you use an external unique key, you may lose track of the entities that you're trying to keep track of.
    </p>
    <p>
        This is true not only for people, but cars, bicycles (which also have chassis numbers), network cards, etc.
    </p>
    <h3 id="93d43ca6c76a4c6c83e9542bb671f39c">
        Clerical errors <a href="#93d43ca6c76a4c6c83e9542bb671f39c">#</a>
    </h3>
    <p>
        Finally, even if you've found a natural key that is guaranteed to be unique <em>and</em> track the actual entity that you want to keep track of, there's a final argument against using an externally defined key in your system: Data-entry errors.
    </p>
    <p>
        Take the story about my car's chassis number. The mechanic who spotted the discrepancy clearly interpreted it as a clerical error.
    </p>
    <p>
        After a few decades of programming, I've learned that sooner or later, there <em>will</em> be errors in your data. Either it's a clerical error, or the end-user mistyped, or there was a data conversion error when importing from an external system. Or even data conversion errors within the <em>same</em> system, as it goes through upgrades and migrations.
    </p>
    <p>
        Your system should be designed to allow corrections to data. This includes corrections of external keys, such as chassis numbers, government IDs, etc. This means that you can't use such keys as database keys in your own system.
    </p>
    <h3 id="ca9efd721698452f856b089fc3f69ad1">
        Heuristic <a href="#ca9efd721698452f856b089fc3f69ad1">#</a>
    </h3>
    <p>
        Many were the times, earlier in my career, when I decided to use a 'natural key' as a key in my own database. As far as I recall, I've regretted it every single time.
    </p>
    <p>
        These days I follow a hard heuristic: Always use synthetic keys for database tables.
    </p>
    <h3 id="c174062e2ad14b6a9ff4056b1de80a0f">
        Conclusion <a href="#c174062e2ad14b6a9ff4056b1de80a0f">#</a>
    </h3>
    <p>
        Is it ever a good idea to use natural keys in a database design? My experience tells me that it's not. Ultimately, regardless of how certain you can be that the natural key is stable and correctly tracks the entity that it's supposed to keep track of, data errors will occur. This includes errors in those natural keys.
    </p>
    <p>
        You should be able to correct such errors without losing track of the involved entities. You'll regret using natural keys. Use synthetic keys.
    </p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[macOS Bartender Auto-Update Signed by Unknown New Owner (154 pts)]]></title>
            <link>https://www.macrumors.com/2024/06/04/bartender-mac-app-new-owner/</link>
            <guid>40579660</guid>
            <pubDate>Tue, 04 Jun 2024 22:34:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.macrumors.com/2024/06/04/bartender-mac-app-new-owner/">https://www.macrumors.com/2024/06/04/bartender-mac-app-new-owner/</a>, See on <a href="https://news.ycombinator.com/item?id=40579660">Hacker News</a></p>
<div id="readability-page-1" class="page"><div role="main" id="maincontent"><article expanded="true"><div data-io-article-url="/2024/06/04/bartender-mac-app-new-owner/"><p>Popular Mac app Bartender appears to have been quietly sold approximately two months ago, with neither the prior owner nor the current owner providing customers or potential customers with information on the sale.</p>
<p><img src="https://images.macrumors.com/t/sWndGhdSp0x_oZUMjyWjfXgMI4M=/400x0/article-new/2024/06/bartender-app.jpg?lossy" srcset="https://images.macrumors.com/t/sWndGhdSp0x_oZUMjyWjfXgMI4M=/400x0/article-new/2024/06/bartender-app.jpg?lossy 400w,https://images.macrumors.com/t/Pb_br6hlCBm9ECgSrDK3mIGBCpk=/800x0/article-new/2024/06/bartender-app.jpg?lossy 800w,https://images.macrumors.com/t/e7MJBthJKSGVCHXe4f_AqqA34mI=/1600x0/article-new/2024/06/bartender-app.jpg 1600w,https://images.macrumors.com/t/uFa-g-GLLTYO9mTXVRqgh_iTn94=/2500x0/filters:no_upscale()/article-new/2024/06/bartender-app.jpg 2500w" sizes="(max-width: 900px) 100vw, 697px" alt="bartender app" width="2128" height="1197"><br>The transaction came to light after some Reddit users saw a <a href="https://www.reddit.com/r/macapps/comments/1d7zjv8/bartender_5_not_safe_anymore_warning_from/">warning from MacUpdater</a> letting them know that the company behind Bartender had been silently replaced. MacUpdater warned users that updates to the app from version 5.0.52 could be potentially unsafe due to the lack of transparency surrounding the situation.</p>
<p>Bartender's new owners replied to the Reddit thread and confirmed that Bartender had been acquired, but did not explain why customers had not been notified nor why there had been a certificate change without said explanation.<br>
</p>
<blockquote><p>Hey everyone, new owners of Bartender here! Our team acquired Bartender from Ben S, the original developer, two months ago. As we prepare to roll out updates for Bartender, we needed to re-sign the app with Apple using our company's information, replacing Ben's. This led to a one-time certificate change.</p>
<p>Truth be told, we should have notated it on the release notes but, since we could not update them retroactively, we included this fact on our blog &amp; shared it with users as they emailed us. We've collaborated closely with Ben to understand his vision for Bartender. Our goal is to implement many of the improvements he had planned and address any reported bugs from the past few months to enhance Bartender's performance.</p></blockquote>
<p>Reddit users asked Bartender's owners for more information on their identity, but there was no response. The Bartender website was updated with information about the certificate change after users began seeing popups asking for new permissions, and while the blog post calls the new certificate request "expected and valid," no background information is provided on the purchase. In the Reddit thread, the owners claim to have posted information about the sale on the website, but that has turned out to be untrue.</p>
<p>At this point, it does not appear that Bartender's new owners plan to inform customers about the change in ownership, but users should be aware that the app has been sold and is no longer being updated by the original developer. The new owner's intentions are not clear, but as Reddit users have pointed out, the situation raises some red flags.</p>
</div></article><p><h2>Popular Stories</h2></p><div><h3><a href="https://www.macrumors.com/2024/06/04/us-carriers-call-outage/">Some AT&amp;T, T-Mobile and Verizon Customers Report Issues With Calls [Update: Fixed]</a></h3><p>Tuesday June 4, 2024 10:51 am PDT by <a href="https://www.macrumors.com/author/juli-clover/" rel="author">Juli Clover</a></p><p>There appears to be an outage with at least one U.S. cellular carrier, with customers unable to place or receive calls. AT&amp;T, T-Mobile, and Verizon customers have been complaining about the issue on social networks, and there are also reports of outages on the Down Detector website. According to a statement from AT&amp;T, the outage is affecting calls between carriers in the United States. All...</p></div><div><h3><a href="https://www.macrumors.com/2024/06/02/gurman-no-new-hardware-at-wwdc-2024/">Gurman: No Hardware at WWDC, Next Apple TV No Longer Coming Soon</a></h3><p>Bloomberg's Mark Gurman does not expect Apple to announce any new hardware during its WWDC 2024 keynote on June 10. "There's no hardware slated to be announced at WWDC, unless Apple unexpectedly previews a new device launching later (to be clear: I don't expect that)," said Gurman, in his Power On newsletter today. Notably, Gurman now says a new Apple TV model "isn't imminent," despite...</p></div><div><h3><a href="https://www.macrumors.com/2024/06/03/sonos-ace-vs-airpods-max/">Sonos Ace Headphones vs. AirPods Max</a></h3><p>Monday June 3, 2024 6:01 am PDT by <a href="https://www.macrumors.com/author/juli-clover/" rel="author">Juli Clover</a></p><p>Sonos in May decided to get into the headphone market with the launch of the Sonos Ace headphones. The $449 Sonos Ace headphones have some enticing design elements and features you won't see in Apple's headphones, so we thought we'd compare them to the $549 AirPods Max to see which is ultimately better. Subscribe to the MacRumors YouTube channel for more videos. In terms of design, both the...</p></div><div><h3><a href="https://www.macrumors.com/2024/06/04/ios-18-these-iphones-wont-support-ai/">iOS 18: These iPhones Likely Won't Support Some AI Features</a></h3><p>Apple is planning a major AI overhaul in iOS 18, but some new features are unlikely to work on older iPhones, even if they do appear on the new operating system's device compatibility list. Apple's initial AI roadmap for iOS 18 is said to come in two parts: Basic AI features that will be processed on-device, and more advanced capabilities that will require communication with Apple's servers. ...</p></div><div><h3><a href="https://www.macrumors.com/2024/06/03/iphone-16-pro-thinnest-bezels-smartphone/">iPhone 16 Pro Could Break Record for Thinnest Bezels on a Smartphone</a></h3><p>Apple's upcoming iPhone 16 Pro models will have the thinnest bezels of any smartphone, beating the screen border thinness of even its latest iPhone 15 Pro devices. That's according to the leaker known as "Ice Universe," who has divulged accurate information about Apple's plans in the past. According to multiple sources, despite minimal design changes, both iPhone 16 Pro models will increase...</p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[An animated introduction to Fourier series (287 pts)]]></title>
            <link>https://www.andreinc.net/2024/04/24/from-the-circle-to-epicycles</link>
            <guid>40578705</guid>
            <pubDate>Tue, 04 Jun 2024 20:39:52 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.andreinc.net/2024/04/24/from-the-circle-to-epicycles">https://www.andreinc.net/2024/04/24/from-the-circle-to-epicycles</a>, See on <a href="https://news.ycombinator.com/item?id=40578705">Hacker News</a></p>
<div id="readability-page-1" class="page"><section itemprop="text">
        
        <p>This article will be part of a more extended series in which I plan to explore various aspects of <a href="https://en.wikipedia.org/wiki/Fourier_analysis">Fourier Mathematics</a>. I will take notes, create some visuals (a good pretext to learn more about graphics), and hope that it will be useful to someone other than me.</p>

<p>The article has yet to be thoroughly reviewed by anyone other than me, so I put it online, hoping to get some feedback before bringing it to a final state.</p>

<h2 id="table-of-contents">Table of contents</h2>

<p>In this series, we will start with a brief recap of some of the math concepts related to the circle, including trigonometric functions like sine and cosine. We’ll also discuss Euler’s identity, introduce the concept of a sinusoid (and complex sinusoid), and finally, we’ll introduce the concept of Fourier Series.</p>

<p>The animations used in this series are original, although I drew inspiration from some existing materials found on the web. Please keep in mind that this is not a comprehensive course on the topic, so if you’re really interested in learning more, I recommend taking a full course on the subject.</p>

<ul>
  <li><a href="#the-circle">The Circle</a></li>
  <li><a href="#the-number-pi">The number \(\pi\)</a></li>
  <li><a href="#radians">Radians</a></li>
  <li><a href="#the-sine-and-the-cosine">The sine and the cosine</a></li>
  <li><a href="#the-cos-leads-the-sin">The \(\cos\) leads the \(\sin\)</a></li>
  <li><a href="#the-parity-of-cos-and-sin">The parity of \(\cos\) and \(\sin\)</a></li>
  <li><a href="#complex-numbers-and-the-unit-circle">Complex Numbers and the Unit Circle</a></li>
  <li><a href="#multiplying-with-i-means-a-rotation-with-fracpi2">Multiplying with \(i\) means a rotation with \(\frac{\pi}{2}\)</a></li>
  <li><a href="#eulers-identity">Euler’s identity</a></li>
  <li><a href="#eulers-formula-the-connection-between-e-pi-and-i">Euler’s formula, the connection between \(e\), \(\pi\) and \(i\)</a></li>
  <li><a href="#the-sin-and-cos-in-their-exponential-form">The \(\sin\) and \(\cos\) in their exponential form</a></li>
  <li><a href="#the-sinusoid">The sinusoid</a></li>
  <li><a href="#sinusoids-are-flexible">Sinusoids are <em>flexible</em></a></li>
  <li><a href="#sinusoids-can-be-complex">Sinusoids can be complex</a></li>
  <li><a href="#sinusoids-can-nullify-themselves">Sinusoids can nullify themselves</a></li>
  <li><a href="#adding-sinusoids-leads-to-complexity">Adding sinusoids leads to complexity</a></li>
  <li><a href="#adding-random-sinusoids-for-fun">Adding random sinusoids for fun</a></li>
  <li><a href="#playing-sinusoidal-tetris-for-fun">Playing Sinusoidal tetris for fun</a></li>
  <li><a href="#a-square-wave-and-sinusoids">A square wave and sinusoids</a></li>
  <li><a href="#epicycles-first-encounter">Epicycles - First Encounter</a></li>
  <li><a href="#epicycles-an-intuitive-understanding">Epicycles - An intuitive understanding</a></li>
  <li><a href="#epicycles-a-flower">Epicycles - A flower </a></li>
  <li><a href="#fourier-series">Fourier Series</a></li>
  <li><a href="#fourier-series-in-exponential-form">Fourier Series in Exponential Form</a></li>
  <li><a href="#example-the-fourier-series-for-the-box-function">Example: The Fourier Series for the Box Function</a></li>
  <li><a href="#example-the-fourier-series-of-the-triangle-wave">Example - The Fourier Series of the Triangle wave</a></li>
  <li><a href="#example-the-fourier-series-of-a-sawtooth-function">Example - The Fourier Series of a Sawtooth Function</a></li>
  <li><a href="#the-fourier-series-machinery">The Fourier Series Machinery</a></li>
</ul>

<p><strong>to be continued</strong></p>

<hr>

<h2 id="the-circle">The Circle</h2>

<p>It all starts with <a href="https://en.wikipedia.org/wiki/Circle"><em>The Circle</em></a>:</p>



<p>The Circle is a geometrical figure with a center \(P(a, b)\), and a radius \(r\).</p>

<p>It has the following associated equation:</p>

\[(x-a)^{2} + (y-b)^{2} = r^2\]

<p>If \(a=0, b=0\) and \(r=1\), the circle becomes less generic, so we call it <a href="https://en.wikipedia.org/wiki/Unit_circle"><em>The Unit Circle</em></a>:</p>



<p>The equation for <em>The Unit Circle</em> is:</p>

\[x^2+y^2=1\]

<p>One could argue <em>The Circle</em> is the epitome of <a href="https://en.wikipedia.org/wiki/Symmetry">symmetry</a>.</p>

<p>Pick one point, \(A\), then its reflection <em>on the other side</em>, \(A^{'}\), and start rotating:</p>



<p>What happens on <em>The Circle</em>, stays on <em>The Circle</em>.</p>

<h2 id="the-number-pi">The number \(\pi\)</h2>

<p>We rarely see angles expressed in <a href="https://en.wikipedia.org/wiki/Degree_(angle)">degrees</a>; usually, we represent them in relation to the number <a href="https://www.andreinc.net/2024/04/24/(https://en.wikipedia.org/wiki/Pi)">PI</a> \(\pi\): \(\pi\), \(\frac{\pi}{2}\), \(\frac{\pi}{3}\), \(\frac{\pi}{4}\), etc.;</p>

<p>\(\pi\) is the ratio of a circle’s circumference to its diameter. <code>π ≈ 3.14</code>.</p>



<p>If \(r \neq 1\), the circle’s perimeter is \(P=2\pi r\), while the area is \(A=\pi r^2\). Both \(A\) and \(P\) depend on \(\pi\).</p>

<p>\(\pi\) is <a href="https://en.wikipedia.org/wiki/Irrational_number">irrational</a> and <a href="https://en.wikipedia.org/wiki/Transcendental_number">transcendental</a>.</p>

<h2 id="radians">Radians</h2>

<p>The <a href="https://en.wikipedia.org/wiki/Radian"><code>radian</code></a> (or <code>rad</code>) is the <em>actual</em> unit we use to measure angles. An intimate relationship exists between the <code>radian</code> and the number \(\pi\).</p>



<p>To transform an angle measured in degrees (\(360°\)) to radians, the algorithm is simple: we multiply the angle by \(\pi\), then divide the result by \(180\).</p>

<h2 id="the-sine-and-the-cosine">The sine and the cosine</h2>

<p>We can define \(\sin\) and \(\cos\) in relationship to <em>The Unit Circle</em>:</p>



<ul>
  <li>\(\theta\) is the angle formed by the radius, \(r\) and the \(x\) axis, at every given point.</li>
  <li>The \(\sin\) function represents the \(y\)-coordinate of a point on the <em>Unit Circle</em>;</li>
  <li>The \(\cos\) function is the \(x\)-coordinate of the same point on the <em>Unit Circle</em>.</li>
</ul>

<p>\(\sin\) and \(\cos\) are <a href="https://en.wikipedia.org/wiki/Periodic_function"><em>periodic functions</em></a> with the period \(2\pi\).</p>



<p>At this point, it will be unfair for \(\cos\) not to plot it on the same graph:</p>



<h2 id="the-cos-leads-the-sin">The \(\cos\) leads the \(\sin\)</h2>

<p>Putting \(\cos\) and \(\sin\) side by side, we observe that they are not that different:</p>

\[\sin(x+\frac{\pi}{2})=\cos(x)\]

<p>We say that \(\cos\) leads the \(\sin\) with \(\frac{\pi}{2}\):</p>



<h2 id="the-parity-of-cos-and-sin">The parity of \(\cos\) and \(\sin\)</h2>

<p>The <a href="https://en.wikipedia.org/wiki/Even_and_odd_functions"><em>parity</em> of mathematical functions</a> generally refers to whether a function is <em>even</em>, <em>odd</em>, or <em>neither</em>.</p>

<p>The <em>cosine</em> is <em>even</em>, meaning \(\cos(x)=\cos(-x)\):</p>



<p>And the <em>sine</em> is odd, meaning \(\sin(-x)=-\sin(x)\), or \(\sin(x)=-\sin(-x)\):</p>



<h2 id="complex-numbers-and-the-unit-circle">Complex Numbers and the Unit Circle</h2>

<p>In the <a href="https://en.wikipedia.org/wiki/Complex_plane">Complex Plane</a>, the points on the circle are defined by the following equation:</p>

\[z=\cos(\theta)+i*\sin(\theta)\]



<h2 id="multiplying-with-i-means-a-rotation-with-fracpi2">Multiplying with \(i\) means a rotation with \(\frac{\pi}{2}\)</h2>

<p>Multiplying a <em>complex number</em> with <a href="https://en.wikipedia.org/wiki/Imaginary_unit">imaginary unit</a> \(i\) is the equivalent of rotating the number counterclockwise with \(\frac{\pi}{2}\) on an “imaginary circle” with the radius: \(r=\mid a + b*i \mid=\sqrt{a^2 + b^2}\)</p>

<p>For example, if we take \(z_{1} \in \mathbb{C}\) and we multiply it three times with \(i\) we will have it <em>rotated</em> into the all 4 quadrants of the circle:</p>



<h2 id="eulers-identity">Euler’s identity</h2>

<p>The natural exponential function, often denoted as \(f(x)=e^{x}\), is a particular case of the exponential function where the base is \(e\), also known as <em>Euler’s Number</em> (\(e \approx 2.71828\)).</p>

<p>\(e\), just like \(\pi\), <a href="https://en.wikipedia.org/wiki/Irrational_number">irrational</a> and <a href="https://en.wikipedia.org/wiki/Transcendental_number">transcendental</a>.</p>

<p>We normally define \(e\) as:</p>

\[e=\sum_{n=0}^{\infty}(\frac{1}{n!})=\frac{1}{0!} + \frac{1}{1!}+\frac{1}{2!}+...\]

\[e=\lim_{x \to \infty}(1+\frac{1}{x})^x\]

\[e=\lim_{x \to 0}(x+1)^{\frac{1}{x}}\]

<p>Even if not obvious, there’s a strong connection between \(e\) and the circle.</p>

<p>The <em>natural exponentiation</em> function is an <a href="https://en.wikipedia.org/wiki/Eigenfunction"><em>eigenfunction</em></a> for <a href="https://en.wikipedia.org/wiki/Derivative">differentiation</a>.</p>

<p>An eigenfunction in this context is a function that, when differentiated, yields a constant multiple of itself:</p>

\[\frac{d}{dx} e^{ax} = a * e^{x}\]

<p>If we substitute \(a \rightarrow e\), by subsequently differentiating \(f(x) = e^{ix}\), we obtain:</p>

\[\frac{d}{dx}f(x) = \frac{d}{dx} (e^{ix}) = i * e^{ix}\]

\[\frac{d^2}{dx^2}f(x) = \frac{d^2}{dx^2} (e^{ix}) = \frac{d}{dx} (i * e^{ix}) = -e^{ix}\]

\[\frac{d^3}{dx^3}f(x) = \frac{d^3}{dx^3} (e^{ix}) = \frac{d}{dx} (-e^{ix}) = -i * e^{ix}\]

\[\frac{d^4}{dx^4}f(x) = \frac{d^4}{dx^4} (e^{ix}) = \frac{d}{dx} (-i*e^{ix}) = e^{ix} = f(x)\]

<p>In simple terms, after we differentiate \(f(x)\) four times (\(f'(x), f''(x), f'''(x), f''''(x)\)), our function does a <em>full circle</em>.</p>

<p>It’s the same pattern described in the previous section when we multiplied our \(z_{1}\) with \(i\).</p>

<p>Subsequently deriving \(e^{ix}\) is the equivalent of subsequently multiplying \(e^{ix}\) with \(i\). Multiplying a complex number with \(i\) means <em>rotating</em> that number in the <em>Complex Plane</em> with \(\frac{\pi}{2}\).</p>

<p>But what is a derivative of a function at a certain point?</p>

<p>It’s the rate of change of that function at that particular point. But we’ve just said that the derivative of \(e^{ix}\) is equivalent to a <em>rotation</em>.</p>

<p>So, the rate of change is rotational.</p>

<p>We can intuitively <em>feel</em> that the function \(e^{ix}\) describes an actual circle.</p>

<p>There’s no other possible solution. So we can boldly affirm that \(e^{ix} = \cos(x) + i*\sin(x)\) (which is the formula discovered by Euler).</p>

<p>Of course, this is not a rigorous demonstration. One can prove Euler’s identity using <a href="https://en.wikipedia.org/wiki/Taylor_series">Taylor Series</a>.</p>

<h2 id="eulers-formula-the-connection-between-e-pi-and-i">Euler’s formula, the connection between \(e\), \(\pi\) and \(i\)</h2>

<p>Euler’s formula is a thing of marvel:</p>

\[e^{ix}=\cos(x) + i * \sin(x)\]

<p>Or, if we choose \(x=\pi\):</p>

\[e^{i\pi}+1=0\]

<h2 id="the-sin-and-cos-in-their-exponential-form">The \(\sin\) and \(\cos\) in their exponential form</h2>

<p>By substituting \(x \rightarrow -x\) into Euler’s identity we obtain:</p>

\[e^{-ix}=\cos(x)-i*\sin(x)\]

<p>If we add/subtract the two equalities, we will obtain the definition of the sine and cosine functions in their exponential form:</p>

\[\cos(x) = \frac{e^{ix} + e^{-ix}}{2}\]

\[\sin(x) = \frac{e^{ix} - e^{-ix}}{2*i}\]

<p>All points of the circle are determined by a functon \(z(x)\), where:</p>

\[z(x)=e^{ix}=\underbrace{\cos(x)}_{Re(x)}+\underbrace{i*\sin(x)}_{Im(x)}\]

<p>\(x\) represents the actual angle \(\theta \in \mathbb{R}\), so \(z(\theta)=e^{i\theta}=cos(\theta)+i*sin(\theta)\).</p>

<p>You’ve seen that we’ve interchanged \(x\) with \(t\) and \(\theta\) throughout the article. It’s confusing, but don’t get confused. We are the ones to decide how to look at \(x\), as an angle or as time.</p>

<h2 id="the-sinusoid">The sinusoid</h2>

<p>A <em>sinusoid</em>, or a <em>sine wave</em>, is a smooth, repetitive curve defined by following function:</p>

\[y(t) = A * \sin(2\pi ft + \varphi) = A * \sin(\omega t + \varphi)\]

<ul>
  <li>\(A\) is called the <em>amplitude</em>, representing the maximum deviation of the function from zero.</li>
  <li>\(f\) is called <em>ordinary frequency</em> and denotes the number of oscillations (the radius moving inside the circle) occurring each second.</li>
  <li>\(\omega=2\pi f\) is called the <em>angular frequency</em>; it’s the same thing as <em>ordinary frequency</em>, but we measure it \(\frac{radians}{second}\);</li>
  <li>\(\varphi\) is called <em>phase offset</em>; it’s measured in radians.</li>
</ul>

<p>If we consider <em>time</em> to be the \(x\)-axis, and \(y(t)\) the \(y\)-axis, the sinusoid becomes:</p>

\[y=f(x)=A * \sin(\omega x + \varphi)\]

<p>The \(\sin\) and \(\cos\) are just particular cases of sinusoids.</p>

<h2 id="sinusoids-are-flexible">Sinusoids are <em>flexible</em></h2>

<p>The following animation is interactive. You can choose the values of \(A=\) 
    
    , \(\omega=\)
         
    and \(\varphi=\) 
     
    to plot the sinusoid (if you pick \(\varphi=\frac{\pi}{2}\) a cosine is plotted):</p>



<h2 id="sinusoids-can-be-complex">Sinusoids can be complex</h2>

<p>Starting with the definition of a sinusoid:</p>

\[y(t) = A * sin(2\pi ft + \varphi) = A * sin(\omega t + \varphi)\]

<p>If we multiply each side with \(A\):</p>

\[A*e^{i\theta}=A*(\cos(\theta)+i*\sin(\theta))\]

<p>If we substitute \(\theta\) with \(\theta=\omega t + \varphi\) we obtain the complex sinusoid:</p>

\[s(t)=A*e^{i(\omega t + \varphi)} = A * \cos(\underbrace{\omega t + \varphi}_{\theta}) + i * A * \sin(\underbrace{\omega t + \varphi}_{\theta})\]

<p>A <em>complex sinusoid</em> captures the behavior of two sinusoids (one cosine and one sine) on both its axes; on the real part, it behaves like a cosine, while on its imaginary part, it behaves like a sine.</p>

<p>The two are <em>in sync</em> as they both depend on the free variable \(\theta\), expressed as \(\theta=\omega t + \varphi\).</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/threedcomplex.js">(Source code)</a></sup></sup></p>

<p>Two interesting observations:</p>
<ul>
  <li>If we project the complex sinusoid on the plane determined by the Y-axis and Z-axis, we will plot a <em>sine</em> (the Imaginary part);</li>
  <li>If we project the complex sinusoid on the plane determined by the X-axis and Z-axis, we will plot a <em>cosine</em> (the Real part);</li>
</ul>

<h2 id="sinusoids-can-nullify-themselves">Sinusoids can nullify themselves</h2>

<p>Two sinusoids in phase and sharing the same amplitude but with opposite frequencies nullify themselves.</p>



<h2 id="adding-sinusoids-leads-to-complexity">Adding sinusoids leads to complexity</h2>

<p>Let’s plot two arbitrary selected sinusoids \(y_{1}(x)\) and \(y_{2}(x)\), where:</p>
<ul>
  <li>\(y_{1}(x) = \frac{9}{10} * sin(7x + \frac{\pi}{2})\), and</li>
  <li>\(y_{2}(x) = \frac{12}{10} * sin(3x - 2)\) .</li>
</ul>

<p>The sum \(y(x)=y_{1}(x) + y_{2}(x)\) shows an interesting pattern</p>



<h2 id="adding-random-sinusoids-for-fun">Adding random sinusoids for fun</h2>

<p>Adding more sinusoids to an existing one (\(A=1\), \(\omega=1\), \(\varphi=1\)) generate more complex patterns:</p>



<h2 id="playing-sinusoidal-tetris-for-fun">Playing Sinusoidal tetris for fun</h2>

<p>Not so long ago, <a href="https://www.andreinc.net/2024/02/06/the-sinusoidal-tetris">I’ve re-imagined the game of Tetris</a>.</p>

<p>It’s now possible to play Tetris with Sinusoids:</p>

<p><a href="https://www.andreinc.net/2024/02/06/the-sinusoidal-tetris"><img src="https://www.andreinc.net/assets/images/2024-04-08-from-the-circle-to-epicycles/sinusoida-tetris.png" alt="img"></a></p>

<h2 id="a-square-wave-and-sinusoids">A square wave and sinusoids</h2>

<p>If we carefully choose the sinusoids, we can create <em>predictable</em> patterns:</p>

<p>Let’s take, for example, use the following formula:</p>

\[y(x) = \frac{4}{\pi}\sum_{k=1}^{\infty}\frac{\sin(2\pi(2k-1)fx)}{2k-1}\]

<p>Through expansion, the formula becomes:</p>

\[y(x) =  \underbrace{\frac{4}{\pi}\sin(\omega x)}_{y_{1}(x)} + \underbrace{\frac{4}{3\pi}\sin(3\omega x)}_{y_{2}(x)} + ... + \underbrace{\frac{4}{(2k-1)\pi}{\sin((2k-1)\omega x)}}_{y_k(x)} + ...\]

<p>\(y_1(x), y_2(x), y_3(x), ..., y_k(x), ...\) are all the individual sinusoids.</p>

<p>If we perform the sum, we will create a <em>square wave</em>. The more sinusoids we pick, the better the approximation.</p>

<p>Please choose how many sinusoids you want to use, and let’s see how the functions look like for  (and \(\omega\)=):</p>



<h2 id="epicycles---first-encounter">Epicycles - First Encounter</h2>

<p>One sinusoid has a corresponding circle that <em>spins</em>. So, the above animation can be re-imagined like this:</p>

<p>Pick  and \(\omega\)= to plot the circles and the corresponding \(y_k(x)\) functions:</p>



<h2 id="epicycles---an-intuitive-understanding">Epicycles - An intuitive understanding</h2>

<p>There’s an intuitive proof to this: each epicycle corresponds to a specific sinusoid; when we talk about combining the sinusoids, we are talking about summing their positions at each point in time, and eventually, this operation reduces to subsequent vector additions.</p>

<p>Let’s take a simple example by introducing three arbitrarily picked sinusoids and their associated <em>point vectors</em> (or <em>position vectors</em>):</p>
<ul>
  <li>\(y_{1}(x)=1.4sin(x + 1)\), with the associated position vector \(\vec{u_{1}}\);</li>
  <li>\(y_{2}(x)=0.8sin(2*x)\), with the associated position vector \(\vec{u_{2}}\);</li>
  <li>\(y_{3}(x)=0.5sin(3*x)\), with the associated position vector \(\vec{u_{3}}\).</li>
</ul>

<p>Their sum is \(y(x) = y_{1}(x) + y_{2}(x) + y_{3}(x) = 1.4sin(x + 1) + =0.8sin(2*x) + 0.5sin(3*x)\).</p>

<p>A position vector represents the displacement from the origin \((0, 0)\) to a specific point in space. In our case, the vector \((x, y_{k}(x))\) represents the position or location of a point on the graph of the function(s) \(y_{k}(x)\) at a particular \(x\) value.</p>

<p>If we plot \(y(x)\) on the cartesian grid we obtain something like:</p>



<p>At each given point \(x\), we can say for certain that \(\vec{u} = \vec{u_{1}} + \vec{u_{2}} + \vec{u_{3}}\).</p>

<h2 id="epicycles---a-flower">Epicycles - A flower</h2>

<p>If we carefully pick the <em>right sinusoids</em> the moving circles can describe (approximate) any shape we want.</p>

<p>Here is a flower for example:</p>



<p>Can you guess the individual sinusoids working together to draw the flower?</p>

<p>You probably can’t unless you apply methods from a branch of mathematics called <em>Fourier Analysis</em>.</p>

<h2 id="fourier-series">Fourier Series</h2>

<p><em>Fourier Series</em> is the mathematical process through which we expand a periodic function of period \(P\) as a sum of trigonometric functions.</p>

<p>Do you remember the <a href="https://en.wikipedia.org/wiki/Pink_Floyd">Pink Floyd’s</a> album cover for the <a href="https://en.wikipedia.org/wiki/The_Dark_Side_of_the_Moon"><em>Dark Side of The Moon</em></a>:</p>

<p><img src="https://www.andreinc.net/assets/images/2023-07-02-painting-with-circles/darksideofthemoon.jpg" alt="img"></p>

<p>Imagine our function \(f(x)\) is the light itself, <a href="https://en.wikipedia.org/wiki/Prism_(optics)">the prism</a> is essentially <em>Fourier Mathematics</em>, and the spectral colors emanating from the prism are the sinusoids.</p>

<p>Following the analogy the formula looks like this:</p>

\[\underbrace{f(x)}_{\text{ light itself}}=\underbrace{A_{0} + \sum_{n=1}^{\infty} [A_{n} cos(\frac{2\pi nx}{P}) + B_{n} sin(\frac{2\pi nx}{P})]}_{\text{the spectral components}}\]

<p>Where \(A_{n}\) and \(B_{n}\) are called <em>Fourier Coefficients</em> are defined by the following integrals:</p>

\[A_{0} = \frac{1}{P} \int_{- \frac{P}{2}}^{+\frac{P}{2}} f(x) dx\]

\[A_{n} = \frac{2}{P} \int_{- \frac{P}{2}}^{+ \frac{P}{2}} f(x) * \cos(\frac{2\pi nx}{P}) dx\]

\[B_{n} = \frac{2}{P} \int_{- \frac{P}{2}}^{+ \frac{P}{2}} f(x) * \sin(\frac{2\pi nx}{P}) dx\]

<h2 id="fourier-series-in-exponential-form">Fourier Series in Exponential Form</h2>

<p>With the help of Euler’s Formula and by changing the sine and cosine functions in their exponential forms, we can also express the Fourier Series of a function as a sum of <em>Complex Sinusoids</em>:</p>

\[f(x) = \sum_{n=-N}^{N} C_{n} e ^ {i2\pi \frac{n}{P}x}\]

<p>Where:</p>

\[C_{n} = \begin{cases}
            A_{0} &amp; \text{if } n = 0 \\
            \frac{1}{2} (A_{n} - i * B_{n}) &amp;  \text{if } n &gt; 0 \\
            \frac{1}{2} (A_{n} + i * B_{n}) &amp; \text{if } n &lt; 0 \\
        \end{cases}\]

<p>If we do additional substitutions, the final form of \(C_{n}\) is:</p>

\[C_{n} = \frac{1}{P} \int_{-\frac{P}{2}}^{\frac{P}{2}} e^{-i2\pi\frac{n}{P}x} f(x) dx\]

<h2 id="example-the-fourier-series-for-the-box-function">Example: The Fourier Series for the Box Function</h2>

<p>Remember the <em>Square Wave</em> we’ve approximated with sinusoids <a href="#adding-sinusoids">in this section</a>? At that point, we used the following formula to express the <em>Square</em> as a sum of sinusoidal components:</p>

\[y(x) = \frac{4}{\pi}\sum_{k=1}^{\infty}\frac{\sin(2\pi(2k-1)fx)}{2k-1}\]

<p>Or, to keep things simpler, by substituting \(\omega=2\pi f\) (\(\omega\) is the angular frequency):</p>

\[y(x) = \frac{4}{\pi}\sum_{k=1}^{\infty}\frac{\sin((2k-1)\omega x)}{2k-1}\]

<p>It’s time to understand how we’ve devised such an approximation.</p>

<p>In <em>isolation</em>, the <em>Square Wave</em>, \(f(x)\) looks like this:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/squarewavef.js">(Source code)</a></sup></sup></p>

<p>Throughout the interval  <code>[0, 2L]</code>, \(f(x)\) can be written as:</p>

\[f(x) = 2 [H(\frac{x}{L})-H(\frac{x}{L}-1)] - 1\]

<p>Where \(H(x)\) is called the <a href="https://mathworld.wolfram.com/HeavisideStepFunction.html"><em>Heavisde Step Function</em></a> and has the following definition:</p>

\[H(x) =  \begin{cases}
        0 &amp; \text{if } x \lt 0 \\
        1 &amp; \text{if } x \ge 0 \\
        \end{cases}\]

<p>First of all, let’s look at \(A_{0} = \frac{1}{2L} \int_{0}^{2L} f(x) dx\). Notice how we’ve changed the interval from \([-\frac{P}{2}, \frac{P}{2}]\) to \([0, 2L]\) to match our example. This will be reflected in the formulas.</p>

<p>Well, this coefficient (\(A_{0}\)) is a fancy way to express the average of \(f(x)\) over the interval (in our case <code>[0, 2L]</code>). In the same time \(A_{0}\) is the area determined by \(f(x)\) over <code>[0, 2L]</code> then divided by \(2L\). But if you look at the plot again, you will see that the net area is  \(0\), because the green area (S1) nullifies the red area (S2), regardless of \(L\).</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/squarewavefa0.js">(Source code)</a></sup></sup></p>

<p>Secondly, let’s compute the \(A_{n} = \frac{1}{L} \int_{0}^{2L} f(x) * \cos(\frac{\pi nx}{L}) dx\) coefficients. An important observation is that \(f(n)\) is odd, and its average value on the interval is \(0\); we can safely say all the coefficients \(A_{n}\) also vanish.</p>

<p>Visually speaking, regardless of how you pick \(n\) or \(L\), the net area determined by the \(A_{n}\) integral will always be zero. It’s visually obvious if we <em>plot</em> \(A_n\). For example plotting \(A_{1}\), \(A_{2}\), \(A_{3}\), \(A_{4}\) looks like this:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/squarewavean.js">(Source code)</a></sup></sup></p>

<p>Similar symmetrical patterns will emerge if you increase the \(n\) in \(A_{n}\) and plot them.</p>

<p>Thirdly, we need to compute:</p>

\[B_{n} = \frac{1}{L} \int_{0}^{2L} f(x) * \sin(\frac{\pi nx}{L}) dx\]

<p>If we plot a \(B_{1}\), \(B_{2}\), \(B_{3}\) and, let’s say, \(B_{4}\) we can intuitively <em>feel</em> what’s happening with \(B_{n}\):</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/squarewavebn.js">(Source code)</a></sup></sup></p>

<p>If you have a keen eye for geometrical representations, you will notice that every even \(B_{n}\) is also 0. The red and green areas nullify, so the net area described by the integral is \(0\). The odd terms will be \(2 * \text{something}\), so let’s calculate that \(\text{something}\).</p>

<p>We will need to split the integral on two sub-intervals \([0, L]\) and \([L, 2L]\) (there’s a <em>chasm</em> at \(L\)), but given the fact \(f(x)\) and \(sin(x)\) are odd, \(B_{n}\) can we written as:</p>

\[B_{n} = 2 * [\frac{1}{L} \int_{0}^{L} f(x) * \sin(\frac{\pi nx}{L}) dx]\]

<p>We can now perform <a href="https://en.wikipedia.org/wiki/Integration_by_substitution">u-substition</a>, so we can write:</p>

\[B_{n} = \frac{2}{L} \int_{0}^{nL\pi} \frac{\sin(\frac{u}{L})}{n\pi}du\]

<p>After we take the constant out, we compute the integral, use the intervals, and take into consideration the periodicity of cosine:</p>

\[B_{n} = \frac{2}{n\pi}(1-(-1)^n)\]

<p>And now we see it, \(B_{n}\) is exactly \(0\) if \(n\) is even, and \(B_{n}=2 * \frac{2}{n\pi}\) is \(n\) is odd.</p>

<p>Putting all back into the master formula of the <em>Fourier Series</em>:</p>

\[f(x)=\underbrace{A_{0}}_{0} + \sum_{n=1}^{\infty} [\underbrace{A_{n} \cos(\frac{\pi nx}{L})}_{0} + B_{n} \sin(\frac{\pi nx}{L})]\]

<p>Things become:</p>

\[f(x)=\frac{4}{\pi} \sum_{n=1,3,5...}^{+\infty} (\frac{1}{n} * \sin(\frac{\pi nx}{L}))\]

<p>If we substitute \(n \rightarrow 2k-1\) and consider, we obtain the initial formula:</p>

\[f(x)=\frac{4}{\pi} \sum_{k=1}^{+\infty} (\frac{\sin(\frac{\pi (2k-1)x}{L})}{(2k-1)})\]

<p>To obtain the initial formula, we substitute \(L \rightarrow \frac{1}{2f}\), and \(2\pi f \rightarrow \omega\), basically we create an interdependence between \(L\) (half of the interval) and \(\omega\), \(L=\frac{\pi}{\omega}\):</p>

\[f(x) = \frac{4}{\pi}\sum_{k=1}^{\infty}\frac{\sin((2k-1)\omega x)}{2k-1}\]

<p>Unfortunately, there’s no way we can go to \(+\infty\), so let’s consider \(s(x)\) as an approximation of \(f(x)\) that depends on \(n\).</p>

\[s(x) = \frac{4}{\pi}\sum_{k=1}^{n}\frac{\sin((2k-1)\omega x)}{2k-1} \approx f(x)\]

<p>In the next animation, you will see that by increasing \(n\), the accuracy of our approximation gets better and better, and the <em>gaps</em> are slowly closed:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/tightfourier.js">(Source code)</a></sup></sup></p>

<p>To understand how adding more coefficients improves the approximation, let’s look back again at a few of our coefficients \(s_{1}(x)\), \(s_{2}(x)\), \(s_{3}(x)\), \(s_{4}(x)\) and \(s_{5}(x)\) (we will pick \(\omega=\frac{\pi}{2}\), so that \(2L=1\)):</p>

\[s_{1}(x) = \frac{4}{\pi} \sin(\frac{\pi x}{2})\]

\[s_{2}(x) = \frac{4}{3\pi} \sin(\frac{3\pi x}{2})\]

\[s_{3}(x) = \frac{4}{5\pi} \sin(\frac{5\pi x}{2})\]

\[s_{4}(x) = \frac{4}{7\pi} \sin(\frac{7\pi x}{2})\]

\[s_{5}(x) = \frac{4}{9\pi} \sin(\frac{9\pi x}{2})\]

<p>Each of the 5 terms is a sinusoid, with \(\frac{4}{\pi}\), \(\frac{4}{3\pi}\), etc. amplitudes, and \(\frac{\pi}{2}\), \(\frac{3\pi}{2}\), etc. frequencies.</p>

<p>So, if we were to approximate a <em>Square Wave</em> with its fifth partial sum (the red dot), we would obtain something like this:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/tightfourieravg.js">(Source code)</a></sup></sup></p>

<p>Notice how <em>obsessed</em> the <em>red dot</em> is with the <em>blue dot</em> (the actual function) and how closely it follows it.</p>

<p>We can always add more terms to the partial sum to help the <em>red dot</em> in its <em>holy mission</em>, improving the approximation until nobody cares anymore.</p>

<h2 id="example---the-fourier-series-of-the-triangle-wave">Example - The Fourier Series of the Triangle wave</h2>

<p>Without dealing with all the associated math, the <em>Fourier Series</em> decomposition for a triangle-wave is:</p>

\[s(x)=\frac{8}{\pi^2}\sum_{k=1}^{N}\frac{(-1)^{k-1}}{(2k-1)^2}*\sin((2k-1)x)\]

<p>Plotting the function \(s(x)\), we will see that things converge smoothly and fast. As soon as \(n\) approaches \(6\), we can already observe the triangle:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/tighttriangle.js">(Source code)</a></sup></sup></p>

<p>Let’s compute the first terms six terms of the \(\sum\), so that:</p>

\[s(x) \approx s_1(x) + s_2(x) + s_3(x) + s_4(x) + s_5(x) + s_6(x)\]

<p>Where:</p>
<ul>
  <li>The first term is \(s_1(x)=\frac{8}{\pi^2}*\sin(x)\), where \(A=\frac{8}{\pi^2}\), \(\omega=1\), \(\varphi=0\);</li>
  <li>The second term is \(s_2(x)=-\frac{8}{3^2\pi^2}*\sin(3x)\), where \(A=-\frac{8}{3^2\pi^2}\), \(\omega=3\), \(\varphi=0\);</li>
  <li>The third term is \(s_3(x)=\frac{8}{5^2\pi^2}*\sin(5x)\), where \(A=\frac{8}{5^2\pi^2}\), \(\omega=5\), \(\varphi=0\);</li>
  <li>The fourth term is \(s_4(x)=-\frac{8}{7^2\pi^2}*\sin(7x)\), where \(A=-\frac{8}{7^2\pi^2}\), \(\omega=7\), \(\varphi=0\);</li>
  <li>The fifth term is \(s_5(x)=\frac{8}{9^2\pi^2}*\sin(9x)\), where \(A=\frac{8}{9^2\pi^2}\), \(\omega=9\), \(\varphi=0\);</li>
  <li>The sixth term is \(s_6(x)=-\frac{8}{11^2\pi^2}*\sin(11x)\), where \(A=-\frac{8}{11^2\pi^2}\), \(\omega=11\), \(\varphi=0\);</li>
</ul>

<p>A keen eye will see will observe the that \(s_2(x)\), \(s_4(x)\), \(s_6(x)\) and all the even terms are <em>negative</em>.</p>

<p>A negative amplitude doesn’t make too much sense, at least not in a physical sense. What are we going to do with the <em>minus sign</em>?</p>

<p>We have two options:</p>
<ol>
  <li>Because \(\sin(-x)=-\sin(x)\), nobody stops us to make the <em>frequency</em> negative. For example, \(s_2(x)=\frac{8}{3^2\pi^2}*\sin(-3x)\), so that the \(\omega=-3\). But again, why would we want a <em>negative frequency</em>? This also doesn’t make sense in a physical sense.</li>
  <li>We can use \(\vert A \vert\) and shift the signal with \(\pi\), so that \(\varphi=\pi\).</li>
</ol>

<p>In practice, we will go with 2. as it’s more practical and gives us more control, but the two options are equivalent so that we can write \(s_2(x)\) in both ways:</p>

\[s_2(x)=-\frac{8}{3^2\pi^2}*\sin(3x)\]

\[s_2(x)=\frac{8}{3^2\pi^2}*\sin(3x + \pi)\]

<p>Visually speaking, the results will not be surprising if we plot \(sin(-x)\) and \(sin(x+\pi)\) side by side; the two are equivalent:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/pishift.js">(Source code)</a></sup></sup></p>

<p>If we consider this, the even terms of \(s(x)\) will become:</p>

<ul>
  <li>\(s_2(x)=\frac{8}{3^2\pi^2}*sin(3x+\pi)\) ;</li>
  <li>\(s_4(x)=\frac{8}{7^2\pi^2}*sin(7x+\pi)\) ;</li>
  <li>\(s_6(x)=\frac{8}{11^2\pi^2}*sin(11x+\pi)\) ;</li>
  <li>…and so on</li>
</ul>

<h2 id="example---the-fourier-series-of-a-sawtooth-function">Example - The Fourier Series of a Sawtooth Function</h2>

<p>Shamelessly skipping the math demonstration, a reverse-sawtooth function has the following form:</p>

\[s(x)=\frac{2}{\pi}\sum_{k=1}^{N}(-1)^k*\frac{\sin(kx)}{k}\]

<p>Plotting \(s(x)\), while increasing \(n\), things look like this:</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/tightsawtooth.js">(Source code)</a></sup></sup></p>

<h2 id="the-fourier-series-machinery">The Fourier Series Machinery</h2>

<p>To better visualize what’s happening, let’s look at a <em>Fourier Series Machinery</em> and how the <em>circles move</em> to create <em><del>beautiful</del> practical patterns</em>.</p>

<p>You can pick the shape of the desired signal from here:  and the sketch will change accordingly.</p>


<p><sup><sup><a href="https://assets/js/2024-04-24-from-the-circle-to-epicycles/fmachinery.js">(Source code)</a></sup></sup></p>

<p>…A bunch of spinning circles on a stick, where each circle corresponds to exactly one term of the series - this is the marvelous <em>Fourier Series Machinery</em>.</p>

<p><img src="https://www.andreinc.net/assets/images/2023-07-02-painting-with-circles/fmachinery.jpg" alt="img"></p>

<p>If we run our signal through the <em>Fourier Series Machinery</em>, we will obtain <em>The Amplitude</em> (\(A\)) and <em>The Phase</em> (\(\varphi\)) for each Frequency (\(\omega\)) from \(1\) to \(N\). Isn’t it amazing? And it all comes down to a bunch of spinning circles… on a stick.</p>

<p><strong>to be continued</strong></p>

        
      </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Some notes on influenceering (169 pts)]]></title>
            <link>https://lcamtuf.substack.com/p/some-notes-on-influenceering</link>
            <guid>40578668</guid>
            <pubDate>Tue, 04 Jun 2024 20:34:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lcamtuf.substack.com/p/some-notes-on-influenceering">https://lcamtuf.substack.com/p/some-notes-on-influenceering</a>, See on <a href="https://news.ycombinator.com/item?id=40578668">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><p><span>I’ve been putting content on the internet for all of my adult life. The works ranged from security research, to open-source projects, to long-term writing on a variety of topics. In an </span><a href="https://lcamtuf.substack.com/p/you-should-write-more" rel="">earlier article</a><span>, I extolled the virtues of publishing just for the sake of it:</span></p><blockquote><p><em>“The concepts in our heads are nebulous and ever-shifting. Putting them on paper forces us to pressure-test our assumptions and address gaps.</em></p><p><em>You don’t need to be the world’s leading expert to write about a particular topic. Experts are often busy and struggle to explain concepts in an accessible way. You should be honest with yourself and with your readers about what you know and don’t know — but otherwise, it’s OK to write about what excites you, and to do it as you learn.”</em></p></blockquote><p>For over two decades, I resisted the desire to monetize my side projects. Part of it was pragmatic: my career paid better than what I could realistically make by cramming ads into articles or selling geeky books. But just as important, I didn’t want to turn a hobby into yet another chore.</p><p>Today, I’d like to share some of the less obvious takeaways from the journey so far.</p><p>By refusing to monetize, you give up most of the tangible upsides of online publishing — but the downsides stay with you either way. In the long haul, you should expect to spend as much time putting out fires and wrangling the technology as you spend on creative pursuits.</p><p>To give you a taste, I had my website randomly delisted by Google, hijacked by SEO spammers in Bing, repeatedly flagged by antivirus tools, and hit with bogus abuse and copyright claims; in each case, it took weeks to get it sorted out, often having to lean on informal connections to get through.</p><p>When I self-hosted, I had to deal with endless configuration and maintenance tasks — and at one point, an outright server compromise. Third-party hosting is easier until it isn’t. For example, it took me nearly a year to get this rendering issue fixed by Substack:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg" width="1168" height="520" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:520,&quot;width&quot;:1168,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:180087,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/jpeg&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd99ae74d-3a0c-4895-974d-d0698eb15bed_1168x520.jpeg 1456w" sizes="100vw" fetchpriority="high"></picture></div></a><figcaption><em>How Substack used to display math on this blog.</em></figcaption></figure></div><p>Their support was of no help; what finally worked was a “cold” email to one of the site’s founders. In other words, it took perseverance and luck.</p><p><span>Even with free hosting, you need a job to pay the bills. I poured thousands of dollars into this craft, and I’m sure the same goes for most other habitual content producers you come across. The costs range from photo and video gear, to software licenses, to the procurement of </span><a href="https://lcamtuf.substack.com/p/a-brief-history-of-counting-stuff" rel="">antique calculating machines</a><span> and </span><a href="https://lcamtuf.substack.com/p/comparing-hobby-pcb-vendors" rel="">random PCBs</a><span>.</span></p><p>Unless you’re a pop star, you are unlikely to gain devoted fans who follow you around. Most of the time, when we come across helpful content on the internet, we don’t think much of the stranger who put it out there. We just take the experience for granted and move on.</p><p>Online hate isn’t so fleeting. Sooner or later, you come across a heckler who follows you around and makes it their life’s mission to “debunk” your claims — or simply hurl insults in your general direction without any pretense of being constructive.</p><p>This seems worse than it really is. Putting others down on the internet is a pretty miserable hobby — often just a way for the other person to cope with their own insecurities and stress.  But still, early on, it plays tricks with your mind — what if I’m really as clueless as they say?</p><p><span>If your content upsets another person, it still means you have an audience. More often than not, the controversy pulls in bystanders and lets them make up their own minds. There </span><em>is</em><span> such a thing as bad press, but on the internet, the threshold is pretty high.</span></p><p><span>What stings far more is when you get no reaction whatsoever: all of sudden, the content’s most important </span><em>raison d'etre</em><span> is lost. Few bloggers or vloggers quit because of the occasional snide remark; many give up when their metrics don’t budge post after post.</span></p><p><span>The process of building an online audience is slow and unpredictable, so my best advice is to pick a platform that doesn’t rub your nose in it. I’ve previously written about my </span><a href="https://lcamtuf.substack.com/p/youtube-is-hell" rel="">special dislike of YouTube</a><span>, where the entire creator experience revolves around view counts:</span></p><blockquote><p><em>“The complexity of the medium is not YouTube’s fault. What I fault them for, however, is that they deliberately thrust authors into a global popularity contest — and offer no reprieve. You can use Reddit, Twitter, or Facebook to hang out with friends without knowing who’s the highest-ranking influencer of the week. On YouTube, view counts are all there is — inescapable and in-your-face.</em></p><p><em><strong>[A thumbnail of a woman flipping off an Alaskan malamute, 82M views]</strong></em></p><p><em>Even in the privacy of your own channel, you’re being compared: to the right of your video, you see similar clips from strangers, along with their scores. The takeaway is simple: there must be something wrong with you if you can’t compete with a person flipping off their dog.”</em></p></blockquote><p><span>Most social media platforms use </span><em>algorithmic feeds</em><span> — that is, they decide what to show not based on their users’ explicit preferences, but on what’s most likely to elicit a response and keep the user engaged. Because of this, follower counts are fairly meaningless: just because a person follows you on Instagram or Facebook, it doesn’t mean they will ever see your posts.</span></p><p>To be fair, the platform you’re reading this on — Substack — is a bit of an outlier. They deliver every post via email, so if a subscriber is still alive and the mails are not ending up in spam, they will see what you have to say. But for a more typical data point, let’s have a look at Twitter: I have 35k+ followers over there, but this translates to just about 1,000 to 2,000 impressions on a typical post. YouTube is the same: I notionally have 1,100 followers there, but a video that isn’t promoted elsewhere tends to get 50-100 views.</p><p>I’m not sure there’s any special takeaway to this — except, if you want to build an audience around subscriptions, make sure they are real. And don’t assume that people with 100k or 1M followers have anything resembling this kind of reach.</p><p>If you ask an average person what’s corrupting the internet, they will probably point to monetization. But it’s not just about money; non-commercial content creators are getting comically distorted signals too.</p><p><span>For example, did you know that my Substack audience is telling me I should stop writing? It’s true: whenever I post a new article, I reliably lose subscribers. If you have a sufficiently large audience, there’s always someone who expected something different, and your new post nudges them to finally unsubscribe. But when I’m </span><strong>not</strong><span> posting, I quickly make up the losses with sign-ups driven through Google search. Clearly, the best growth strategy is to post nothing at all.</span></p><p>More seriously, the sheer randomness of internet’s attention, and its heavy bias toward low-effort content, will drive you nuts. Some of my most popular posts are throwaway quips and memes that went viral on social media. One of my life’s crowning achievements is this:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png" width="1456" height="762" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:762,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:80342,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd2bc890d-6b37-4e2e-8551-af62b7a91600_1485x777.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>Just asking questions.</em></figcaption></figure></div><p><span>In contrast, some of the work I put weeks or months into essentially lost the SEO game and gets nearly zero traffic. A while ago, I put together an impassioned, contrarian </span><a href="https://lcamtuf.coredump.cx/photo_basics/" rel="">guide to photography</a><span>, illustrated with a number of interactive shots. The only traffic it’s getting today are confused searches for a porn performer with a vaguely similar name. Even though I don’t write for money, there is an immense pressure to produce clickbait — even if simply to add </span><em>“hey, since you’re here, check out this serious thing”.</em></p><p><em><span>For a categorized list of posts on this Substack, </span><a href="https://lcamtuf.coredump.cx/offsite.shtml" rel="">click here</a><span>.</span></em></p></div></article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Things the guys who stole my phone have texted me to try to get me to unlock it (390 pts)]]></title>
            <link>https://gothamist.com/news/things-the-guys-who-stole-my-phone-have-texted-me-to-try-to-get-me-to-unlock-it</link>
            <guid>40578460</guid>
            <pubDate>Tue, 04 Jun 2024 20:10:23 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://gothamist.com/news/things-the-guys-who-stole-my-phone-have-texted-me-to-try-to-get-me-to-unlock-it">https://gothamist.com/news/things-the-guys-who-stole-my-phone-have-texted-me-to-try-to-get-me-to-unlock-it</a>, See on <a href="https://news.ycombinator.com/item?id=40578460">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><!--[--><!--[--><div><p><i>A version of this story originally appeared in</i> <a href="https://maxread.substack.com/p/iphone-thieves-copypasta" rel="noopener" target="_blank"><i>Read Max</i></a><i>, a twice-weekly newsletter about tech, politics, culture, and media.</i></p><p>My phone was stolen in early March, most likely while I was standing on the platform at the York Street station waiting for the F train. Fifteen minutes later, in a food hall under the movie theater where my boyfriend and I were supposed to see “Dune 2,” I reached into my pocket and realized it was gone. He looked at the Find My app on his phone: My phone was “last seen” at York Street but wasn’t registering a current location. Someone had turned it off.</p><p>As quickly as possible, I did <a href="https://support.apple.com/en-us/101593" rel="noopener" target="_blank">all the things you’re supposed to do when your phone is lost or stolen</a> —- mark it as lost, cut off service, and remotely erase it. I spent the rest of the night anxiously refreshing the Find My app, watching my phone move around Manhattan before it finally stopped at Rockefeller Center. I didn’t bother confronting the thief. Worst of all, we didn't even see “Dune 2.”</p><p>After two hours in the Williamsburg Apple Store the next morning, I had a new iPhone 15 and I stopped stressing. As long as I didn’t remove the phone from my Apple account or the Find My app, the phone was essentially bricked to anyone without the passcode <i>and</i> my iCloud password — unusable by the thieves, or the fences who I assume bought it from them. Now my phone was their problem.</p><p>Where had my phone gone? I learned (from Reddit comments – where else?) that stolen iPhones usually end up sold in bulk online, either directly by the thief or by a fence who buys stolen phones individually and <i>then</i> sells them in bulk. The purchasers are either <a href="https://www.reddit.com/r/Flipping/comments/fw7s3v/my_experience_with_liquidationcom/" rel="noopener" target="_blank">looking for parts</a> or think they can crack into the phones, wipe and resell them. This teenager on YouTube, for example, <a href="https://www.youtube.com/watch?v=26bdjJqWdCo" rel="noopener" target="_blank">bought a box of stolen iPhones</a> for $1,300 on Liquidation.com:</p></div><!--]--><!--[--><div><p>
    <iframe width="200" height="113" src="https://www.youtube.com/embed/26bdjJqWdCo?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="" title="I Bought STOLEN iPhones for CHEAP"></iframe>
</p>
</div><!--]--><!--[--><div><p>As you can see, most of the phones she tried didn’t have passcodes but were still linked to iCloud accounts, which meant she (or anyone buying the phones) still had access to all of the original owners’ texts, emails and photos. She sent a message to each iCloud email offering to give people their phones back, but only one guy replied.</p><p>I, sadly, did not get a message from a teenage YouTuber earnestly offering to return my stolen phone. Instead I received a series of texts from someone cycling through a number of different strategies for engaging, convincing, tricking or scaring me into unlocking the phone for them.</p><p>Rather than being engaged, convinced, tricked or scared, however, I was delighted. The experience managed to combine the internet's promises of international communion and international crime.</p><p>There was something oddly soothing about being in touch with the people who’d stolen my phone. Instead of it disappearing into the ether, I knew more or less where it was, and thanks to these texts, I knew that it was a source of frustration to the people who’d gotten their hands on it. As the texts escalated in complexity and rage, I sympathized with their plight. I mean, not enough to unlock my phone. But we’ve all been there – sometimes you get stuck with a difficult project at work.</p><p>In case you find yourself in a similar situation, here are some things the guys who stole (or later purchased) my iPhone have told me to try to get me to unlock it.</p></div><!--]--><!--[--><p><h5><b>1) “Your iPhone 14 Pro is trying to pay with Apple Pay in China.”</b></h5></p><!--]--><!--[--><figure><figcaption><!----><p>The first text I received from the scammers.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>The first text I got from my new friends was sent on April 28, a few weeks after the phone was stolen, and I have to be honest … it kind of got me, at least for a second. It helped that, even though this text came from a clearly bogus iCloud email address, Apple’s own “helpful” iMessage feature was sort of fooled: the auto-filled contact name said “Maybe: Apple Pay.” Maybe!</p><!--]--><!--[--><figure><figcaption><!----><p>Apple’s own “helpful” iMessage feature was sort of fooled: the auto-filled contact name said “Maybe: Apple Pay.” Maybe!</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>At this point, my phone was in Sunnyside, Queens:</p><!--]--><!--[--><figure><figcaption><!----><p>My phone was camped out in Sunnyside, Queens for a bit.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>My old phone's new owners persisted with this tactic for a while. I later got the same message again, but from a different iCloud address. Two weeks after that, on May 12, I got an identical message in which “USA” had been replaced with “China.” I'm guessing it was intended to dial up the panic, but instead it made me feel cosmopolitan and sophisticated.</p><!--]--><!--[--><p><h5><b>2) “Iv'e bought an iPhone 14 Pro I'm using, it have your messages, emails, cards, bank, notes and personal information on it”</b></h5></p><!--]--><!--[--><figure><figcaption><!----><p>Posing as the unwitting new owners of a stolen iPhone, the scammer continued to try to get me to unlock the phone.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>On May 13, my pen pals reached out from a Filipino phone number. They'd switched from the impersonal "Apple Pay warning" texts to claiming that they were the unwitting new owners of a stolen iPhone. I appreciated this more intimate approach – the message even came from a phone number rather than email address, which was a nice touch – and I was glad to hear they were concerned about my insurance claim. “Best of luck!” I texted back.</p><!--]--><!--[--><p><h5><b>3) “Your old iPhone 14 Pro is recycled by us, we are just recycling merchants, we are not the ones who steal your phone”</b></h5></p><!--]--><!--[--><figure><figcaption><!----><p>This was my favorite text. Who am I to say no to recycling?</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>The next day, I was kindly contacted by a U.K. phone number notifying me that the people in possession of my phone simply wanted to recycle it. This was one of my favorites: Sure, there’s an implicit threat (“hackers” might “contact my family” to, what, send them thousands of photos of my dog??), but it's not just some poor sap I'm supposed to help, it's the <i>planet</i>. Who am I to stand in the way of recycling? I replied:</p><!--]--><!--[--><figure><figcaption><!----><p>I loved lying to the scammers.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p><h5><b>4) “The phone is going be auctioned on the black market with your personal information and everything about you that you had on it.”</b></h5></p><!--]--><!--[--><figure><figcaption><!----><p>I appreciated the use of CAPS in this one.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>I got this one on the same day (May 14), from the Filipino number, which had previously claimed to be some guy who’d accidentally bought my phone.</p><!--]--><!--[--><p><h5><b>5) “Your old iPhone has been disassembled… you do not want to take it back, because it does not belong to the law of the United States”</b></h5></p><!--]--><!--[--><figure><figcaption><!----><p>This is where things started escalating.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><div><p>At the same time, I got this nearly identical message from the U.K. number. Thanks to Reddit, I discovered that most of the messages I was getting were <a href="https://www.reddit.com/r/iphone/comments/1abu8ec/my_phone_got_stolen_and_this_is_what_they_texted/" rel="noopener" target="_blank">scammer copypasta</a>: English phrases and texts that were passed around between thieves, fences and jailbreakers to entice bereft phone owners like me.</p><p>In the end I think these two texts provide a lesson in the importance of great openers. While the previous message didn’t move me much, it’s hard not to admire the arresting visuals of the detailed iPhone breakdown, the reference to “the law of the United States,” the mocking “you’ll never catch me.” It’s an incredible intro that really elevates the literary value of what would otherwise be a rote bit of vaguely threatening text! ! ! ! ! !</p><p>In any event, I will credit them with being honest: I checked Find My and my phone was indeed in China. It looked like it was in an office building conveniently located around the corner from an Adidas store, about 8,000 miles from me.</p></div><!--]--><!--[--><figure><figcaption><!----><p>My iPhone took a little trip!</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p><h5><b>6) “Listen! I'm going to harassed, wreck and ruin your sad, stupid low pathetic life if its not removed you mindless peasant.”</b></h5></p><!--]--><!--[--><figure><figcaption><!----><p>This was the final (and most threatening) message I received from my scammer friends.</p><p>Veronica de Souza/Gothamist</p></figcaption></figure><!--]--><!--[--><p>I did not like this tone from my best pal! This text (more <a href="https://www.reddit.com/r/copypasta/comments/13tv0r3/someone_who_got_their_iphone_stolen_got_this/" rel="noopener" target="_blank">scammer copypasta</a>) was accompanied by two videos. One video showed a “hacker” breaking into someone’s iPhone and going through their camera roll, which was a mix of selfies and graphic videos. Another appeared to be a screen recording of a social video of a man showing off his gun. I guess this is supposed to be the guy named “Miami” who is going to come kill me and my whole family “on Monday.” I haven’t heard from them since.</p><!--]--><!--]--></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Debian's /tmpest in a teapot (150 pts)]]></title>
            <link>https://lwn.net/SubscriberLink/975565/bcce68a68d82d63a/</link>
            <guid>40578414</guid>
            <pubDate>Tue, 04 Jun 2024 20:05:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lwn.net/SubscriberLink/975565/bcce68a68d82d63a/">https://lwn.net/SubscriberLink/975565/bcce68a68d82d63a/</a>, See on <a href="https://news.ycombinator.com/item?id=40578414">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<!-- $Id: slink-trial,v 1.1 2005-11-04 21:27:01 corbet Exp $ -->
<center>
<table>
<tbody><tr><td>
<h3>Welcome to LWN.net</h3>
<p>
The following subscription-only content has been made available to you 
by an LWN subscriber.  Thousands of subscribers depend on LWN for the 
best news from the Linux and free software communities.  If you enjoy this 
article, please consider accepting the trial offer on the right.  Thank you
for visiting LWN.net!
</p></td><td>
<div>
<h3>Free trial subscription</h3>
           <p>
           Try LWN for free for 1 month: no payment
           or credit card required.  <a href="https://lwn.net/Promo/slink-trial2-3/claim">Activate
           your trial subscription now</a> and see why thousands of
           readers subscribe to LWN.net.
           
</p></div>
</td>
</tr>

</tbody></table>
</center>

<p>Debian had a major <a href="https://lwn.net/Articles/499410/">discussion</a>
about mounting <tt>/tmp</tt> as a RAM-based tmpfs in 2012 but inertia
won out in the end. Debian systems have continued to
store temporary files on disk by default. Until now. A mere 
12 years later, the project will be switching to a RAM-based <tt>/tmp</tt> in the Debian
13 ("Trixie") release. Additionally, starting with Trixie, the
default will be to periodically clean up temporary files automatically in
<tt><nobr>/tmp</nobr></tt> and <tt><nobr>/var/tmp</nobr></tt>. Naturally, it involved a lengthy discussion first.</p>

<h4>Join the party</h4>

<p>By now, using tmpfs for the <tt>/tmp</tt>
directory is a road well-traveled. Many Linux distributions have already switched to mounting
<tt>/tmp</tt> as a tmpfs. Arch Linux, Fedora, openSUSE
Tumbleweed, and many others have all made the switch. Red Hat Enterprise Linux (RHEL) and its
clones, as well as SUSE Linux Enterprise Server (SLES) and openSUSE Leap, still default to <tt>/tmp</tt> on
disk. Ubuntu, following Debian, also continues to have a disk-based
<tt>/tmp</tt> rather than using tmpfs.</p>

<p>The knobs to control how <tt>/tmp</tt> is mounted, and the handling
of temporary files, <a href="https://systemd.io/TEMPORARY_DIRECTORIES/">are part of
systemd</a>. (On systems where systemd is used, of course.) The
upstream defaults for systemd are to mount <tt>/tmp</tt> as a tmpfs
and delete files that have not been read or changed after ten days in
<tt>/tmp</tt> and 30 days for those stored in <tt>/var/tmp</tt>.
Debian Developer and systemd contributor Luca Boccassi recently
decided it was time to revisit the topic of <tt>/tmp</tt> as a tmpfs,
and start deleting temporary files in <tt>/tmp</tt> and
<tt>/var/tmp</tt>.</p>

<p>On May 6 Boccassi
<a href="https://lwn.net/ml/debian-devel/ebee234c6f72eb7dfe55809821c038491bfea542.camel@debian.org/">resurrected</a> a discussion from Debian's bug
tracker that started in 2020 and that had trailed off in July 2022 without resolution. The bug
was submitted by Eric Desrochers, who <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=966621#5">complained</a> that
Debian's systemd implementation did not clean <tt>/var/tmp</tt> by
default. Michael Biebl <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=966621#10">wrote</a>
that this was a deliberate choice to match Debian's pre-systemd
behavior. After a long period of inactivity, Biebl <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=966621#35">suggested</a>
in October 2021 (and <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=966621#40">again</a> in July 2022) that Desrochers raise the topic on the Debian devel
mailing list. That never happened.</p>

<p>In reviving the topic, Boccassi declared that it was time to bring Debian's defaults in
line with upstream and other Linux distributions by making
<tt>/tmp</tt> a tmpfs, and cleaning up <tt>/tmp</tt> and <tt>/var/tmp</tt> on a
timer. He planned to apply those changes in the next systemd upload to
Debian unstable within a week, with instructions in the <tt>NEWS</tt> file on
how to override the changes for any users who wanted to keep the
current behavior. That, in turn, sparked quite a discussion.</p>

<h4>The case for and against</h4>

<p>Biebl <a href="https://lwn.net/ml/debian-devel/abb5af73-7b68-4880-b0fc-622112bf4403@debian.org/">worried</a>
about the effect of cleaning up temporary files by default. Currently,
he said, Debian only cleans <tt>/tmp</tt> on boot (which is
unnecessary if <tt>/tmp</tt> is a RAM-based tmpfs) and to never clean
up files in <tt>/var/tmp</tt>. Boccassi <a href="https://lwn.net/ml/debian-devel/CAMw=ZnQuCfngAWSrZrJCXxru61EVtfsOMjw-5fFHrPQ11U4L9Q@mail.gmail.com/">answered</a>:
"<q>Defaults are defaults, they are trivially and fully overridable
where needed if needed.</q>" Biebl <a href="https://lwn.net/ml/debian-devel/4b514ecf-d6b1-4208-9be3-ffa3f988da32@debian.org/">replied</a>
that there is value in aligning defaults across Linux distributions,
but argued that Debian has "<q>a larger scope</q>" than a desktop
distribution like Fedora. He suggested that it was necessary to "<q>gather feedback from all affected parties 
to make an informed decision</q>". Boccassi <a href="https://lwn.net/ml/debian-devel/CAMw=ZnRzXjern5wD60Gb+uUmxyTk_duK8jGNND16EA3xpDPVNw@mail.gmail.com/">responded</a>
that it was impossible to have defaults that would make everyone
happy, and he was not looking for hypothetical arguments or
philosophical discussions, he wanted facts: "<q>what would
break where, and how to fix it?</q>"</p>

<p>Sam Hartman <a href="https://lwn.net/ml/debian-devel/tsla5l1d1kh.fsf@suchdamage.org/">noted</a>
that <tt>ssh-agent</tt> created its socket under <tt>/tmp</tt>, but it would be
better if it respected the <tt>$XDG_RUNTIME_DIR</tt> setting and
created its socket under <tt>/run/user</tt>. Boccassi
<a href="https://lwn.net/ml/debian-devel/CAMw=ZnQ9TedkhqkAv-+SYV9+_rRwnxc8H7y=mUS1DgY2oV7wkw@mail.gmail.com/">agreed</a>
and said that he had <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1070725">filed a bug</a> for <tt>ssh-agent</tt>. Richard Lewis
<a href="https://lwn.net/ml/debian-devel/86seyuk41q.fsf@simplex.rtf.org.uk/">pointed
out</a> that tmux stores its sockets in <tt>/tmp/tmux-$UID</tt>, and
deleting those files might mean users could not reattach to a tmux
session that had been idle a long time. Boccassi <a href="https://lwn.net/ml/debian-devel/CAMw=ZnSYrqwd5s6u1fhT1dx+W2E1Ti3Y84eWAKs9iKZN_O5=OA@mail.gmail.com/">suggested</a>
that using <a href="https://manpages.debian.org/testing/manpages-dev/flock.2.en.html"><tt>flock()</tt></a>
would be the right solution to stop the deletion, and <a href="https://lwn.net/ml/debian-devel/CAMw=ZnRT3OeZwZ6M=X_fLdWo5Saf6Xgn04UnS_9yywCbfjhGfg@mail.gmail.com/">said</a>
he had <a href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1070724">filed a bug</a> on that as well.</p>

<p>Lewis <a href="https://lwn.net/ml/debian-devel/86ikzpjq8k.fsf@simplex.rtf.org.uk/">questioned</a>
whether files downloaded with <tt>apt&nbsp;source</tt> might be
considered "old" when they were extracted under <tt>/tmp</tt> and
immediately flagged to be deleted. Russ Allbery <a href="https://lwn.net/ml/debian-devel/87cypxfgi9.fsf@hope.eyrie.org/">said</a>
that <tt>systemd-tmpfiles</tt> would respect the access timestamp (atime)
and changed timestamp (ctime), not just the modified timestamp
(mtime), "<q>so I think this would only be a problem on file systems that didn't support
those attributes</q>". Allbery said he believed tmpfs supports all three.</p>

<p>Some users store information in <tt>/var/tmp</tt> for long-running
jobs, because they want it preserved without being backed up, <a href="https://lwn.net/ml/debian-devel/CANa01B+C2Z6o=QEv33Ovd8pDM4+MqmCZ2L4T2g4nNY4Gj13-dg@mail.gmail.com/">said</a>
Barak A. Pearlmutter. Boccassi <a href="https://lwn.net/ml/debian-devel/CAMw=ZnT_bYrBRm7j3iU5sN=dtzvHcf0vaRH=Xxc7xEVjQ=txWA@mail.gmail.com/">dismissed</a>
that, saying that those users "<q>assuming they actually exist</q>",
can customize the system defaults according to their needs.</p>

<p>Those users do exist, <a href="https://lwn.net/ml/debian-devel/D14DPA7WSVOK.2LV6HCA1DS4F5@debian.org/">wrote</a>
Jonathan Dowland, "<q>[I've] been one of them, I've worked with many of
them, it's an incredibly common pattern in academic
computing</q>". Making a change to how these files are handled,
"<q>should be a very carefully explored decision</q>". He also
asked for arguments in favor of the change, and to hold off the change
to allow the discussion to continue.</p>

<p>Hartman <a href="https://lwn.net/ml/debian-devel/tsla5l11xl6.fsf@suchdamage.org/">wished</a>
that it was possible to specify that directories under
<tt>/var/tmp</tt> should be deleted entirely or left alone. Boccassi
said that was a reasonable enhancement request, and that it had
already been <a href="https://lwn.net/ml/debian-devel/CAMw=ZnRbG9EJgu1VDYCwxDYAtmwDj+UrxgxiXkxWgyqOY8UZtw@mail.gmail.com/">filed
upstream</a> for systemd.</p>

<p>Allbery eventually <a href="https://lwn.net/ml/debian-devel/87h6f9hev0.fsf@hope.eyrie.org/">admitted
surprise</a> at the number of people who reported using
<tt>/var/tmp</tt> "<q>for things that are clearly not temporary
files in the traditional UNIX sense</q>". Periodically deleting files
in <tt>/var/tmp</tt>, he said, has been common UNIX practice for at
least 30 years:</p>

<blockquote>
Whatever we do with /var/tmp retention, I beg people to stop using
/var/tmp for data you're keeping for longer than a few days and care about
losing.  That's not what it's for, and you *will* be bitten by this
someday, somewhere, because even with existing Debian configuration many
people run tmpreaper or similar programs.  If you are running a
long-running task that produces data that you care about, make a directory
for it to use, whether in your home directory, /opt, /srv, whatever.
</blockquote>

<p>Hakan Bayındır <a href="https://lwn.net/ml/debian-devel/812a6293-c157-484e-9fc0-002692ad733a@bayindir.org/">said</a>
that he did not use <tt>/var/tmp</tt>, but applications that
other people use do. He cited a high-end scientific application that was
not under his or other users' control. Allbery argued that this
was "<q>not a good design decision</q>" but conceded that may not be
helpful if a user or admin does not have control over the
application's design. However, he said, it was "<q>playing with fire</q>"
to use <tt>/var/tmp</tt> that way "<q>and it's
going to result in someone getting their data deleted at some point,
regardless of what Debian does</q>".</p>

<p>Lewis <a href="https://lwn.net/ml/debian-devel/86h6f9jop1.fsf@simplex.rtf.org.uk/">said</a>
he still did not understand the rationale for the change. Was there,
he asked, "<q>perhaps something more compelling than 'other
distributions and upstream already do this'?</q>" That sounded like
the original rationale, <a href="https://lwn.net/ml/debian-devel/878r0lffbs.fsf@hope.eyrie.org/">Allbery
said</a>, but he added that moving <tt>/tmp</tt> to tmpfs should make
applications run faster, and reaping files under <tt>/var/tmp</tt>
could help to avoid filling up a partition. Allowing the partition to
fill up, he noted, could
cause bounced mail, unstable services, and other problems. It may not
be a problem for desktop systems, which tend to have enough disk space
not to be affected, but for virtual machines that have <tt>/var/tmp</tt>
contained within a small root partition, it is still a concern.</p>

<h4>Rolling out changes</h4>

<p>In the end, none of the arguments for maintaining Debian's status
quo managed to persuade Boccassi to stay his hand. On May 28, Boccassi <a href="https://lwn.net/ml/debian-devel/CAMw=ZnTPEbA7uZ4Cg2sx7PBZS2_Z_8-ZD7UDqoVWq6UasAcUxA@mail.gmail.com/">announced</a>
the changes that he had made and uploaded to unstable. As expected, <tt>/tmp</tt> will become a
tmpfs by default, for both new and existing installations. New
installs will use the systemd default behavior. The
<tt>openssh</tt> and <tt>tmux</tt> packages, he said, had been fixed
to provide exceptions to retain their temporary files. A description has been added
to the Debian installer to inform users that <tt>/tmp</tt> is a tmpfs
by default, and the changes have been noted in the <tt>NEWS</tt>
file. He also offered
to review and merge any changes to the Debian installer that would let
users customize those options during installation.
Users who want <tt>/tmp</tt> to remain on disk can override the
upstream default with <tt>systemctl&nbsp;mask&nbsp;tmp.mount</tt>. To
stop periodic cleanups of <tt>/tmp</tt> and <tt>/var/tmp</tt> users
can run <tt>touch&nbsp;/etc/tmpfiles.d/tmp.conf</tt>.</p>

<p>None of the changes, it should be noted, will affect Debian
versions prior to Trixie. Users of Debian stable and oldstable will
only encounter these changes on upgrade.</p>

<p>As noted, many distributions have already made these changes
without catastrophe. Debian, and its users, should be able to adapt to
the new defaults or override them if they are unsuitable for the
workloads to be run. At worst, it promises to be a temporary
inconvenience.</p><br clear="all">
               <br clear="all">
               <blockquote>
<p>
<b>Did you like this article?</b>  Please accept our 
<a href="https://lwn.net/Promo/slink-trial2-3/claim">trial subscription offer</a> to be
able to see more content like it and to participate in the discussion.
</p>
</blockquote>
<hr><p>
           (<a href="https://lwn.net/Login/?target=/Articles/975565/">Log in</a> to post comments)
           </p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Entropy, a CLI that scans files to find high entropy lines (might be secrets) (121 pts)]]></title>
            <link>https://github.com/EwenQuim/entropy</link>
            <guid>40578060</guid>
            <pubDate>Tue, 04 Jun 2024 19:25:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/EwenQuim/entropy">https://github.com/EwenQuim/entropy</a>, See on <a href="https://news.ycombinator.com/item?id=40578060">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/EwenQuim/entropy/blob/master/entropy.png"><img src="https://github.com/EwenQuim/entropy/raw/master/entropy.png" alt="Entropy logo"></a></p>
<blockquote>
<p dir="auto">Paranoïd about having secrets leaked in your huge codebase? Entropy is here to help you find them!</p>
</blockquote>
<p dir="auto"><h2 tabindex="-1" dir="auto">Entropy</h2><a id="user-content-entropy" aria-label="Permalink: Entropy" href="#entropy"></a></p>
<p dir="auto"><a href="https://pkg.go.dev/github.com/EwenQuim/entropy" rel="nofollow"><img src="https://camo.githubusercontent.com/93a15bfa5bcb59ef604062700f0a52593262f3e80e675dda2021f2528f6c36aa/68747470733a2f2f706b672e676f2e6465762f62616467652f6769746875622e636f6d2f4577656e5175696d2f656e74726f70792e737667" alt="Go Reference" data-canonical-src="https://pkg.go.dev/badge/github.com/EwenQuim/entropy.svg"></a>
<a href="https://goreportcard.com/report/github.com/EwenQuim/entropy" rel="nofollow"><img src="https://camo.githubusercontent.com/7c76b6a208333f52e7b975ed9ae0e183f446aba3b96a63663b41d2a8354f9045/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f4577656e5175696d2f656e74726f7079" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/EwenQuim/entropy"></a></p>
<p dir="auto">Entropy is a CLI tool that will <strong>scan your codebase for high entropy lines</strong>, which are often secrets.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<p dir="auto">If you have Go installed</p>
<div dir="auto" data-snippet-clipboard-copy-content="go install github.com/EwenQuim/entropy@latest
entropy"><pre>go install github.com/EwenQuim/entropy@latest
entropy</pre></div>
<p dir="auto">or in one line</p>
<div dir="auto" data-snippet-clipboard-copy-content="go run github.com/EwenQuim/entropy@latest"><pre>go run github.com/EwenQuim/entropy@latest</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">With brew</h3><a id="user-content-with-brew" aria-label="Permalink: With brew" href="#with-brew"></a></p>
<p dir="auto">WIP</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Usage</h2><a id="user-content-usage" aria-label="Permalink: Usage" href="#usage"></a></p>
<p dir="auto">I don't want to maintain a documentation here, so just run</p>
<div dir="auto" data-snippet-clipboard-copy-content="entropy -h"><pre>entropy -h</pre></div>
<p dir="auto">as it will always be up to date.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Influencer cartels manipulate social media (149 pts)]]></title>
            <link>https://cepr.org/voxeu/columns/how-influencer-cartels-manipulate-social-media-fraudulent-behaviour-hidden-plain</link>
            <guid>40577726</guid>
            <pubDate>Tue, 04 Jun 2024 18:51:34 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cepr.org/voxeu/columns/how-influencer-cartels-manipulate-social-media-fraudulent-behaviour-hidden-plain">https://cepr.org/voxeu/columns/how-influencer-cartels-manipulate-social-media-fraudulent-behaviour-hidden-plain</a>, See on <a href="https://news.ycombinator.com/item?id=40577726">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
      

      <article>
        
              <div>
                
                  <p>Imagine a university that rewards professors based on the number of citations to their research. In response, a group of colleagues might agree to cite each other’s work in every paper they write. What would be the positive and negative effects of our imaginary citation cartel? Economists are not known for excessive citations, which could be explained by positive externalities: the citing author bears all the costs, while the cited author reaps the benefits. As citing authors can’t internalise this positive externality, we end up with fewer citations than is socially optimal.</p>

<p>A citation cartel could solve this issue via reciprocal behaviour: by the cartel agreement, members would receive as many citations as they give. However, this can go too far. If this agreement requires citing unrelated papers, it might be good for group members but lead to meaningless literature reviews. Thus, the benefit of such agreements depends on their nature: making more effort to cite related papers could be good, while citing unrelated papers is probably bad.</p>

<p>Such academic citation cartels are not purely hypothetical. Academic journals have been found to form agreements to boost each other’s journals in the rankings (Van Noorden 2013). Similarly, universities have boosted their colleagues’ citation counts to advance in university rankings (Catanzaro 2024). Due to such citation patterns, Clarivate (Thomson Reuters) has excluded journals from Impact Factor listings, and most recently excluded the entire field of mathematics (Van Noorden 2013, Catanzaro 2024).</p>

<p>Academic citation cartels are difficult to study because there is no data on explicit cartel agreements. But in influencer marketing, cartel agreements are observable. In our new paper (Hinnosaar and Hinnosaar 2024), we study how influencers collude to inflate engagement and the conditions under which influencer cartels can be welfare-improving.</p>

<h2>Distorted incentives and fraudulent behaviour in influencer marketing</h2>

<p>Influencer marketing has become a key part of modern advertising. In 2023, spending on influencer marketing reached $31 billion, already rivalling the entirety of print newspaper advertising. Influencer marketing allows advertisers fine targeting based on consumer interests by choosing a good product-influencer-consumer match.</p>

<p>Many non-celebrity influencers are not paid based on the success of their marketing campaigns. In fact, less than 20% of companies track the sales induced by their influencer marketing campaigns. Instead, influencers’ pay is based on impact measures such as the number of followers and engagement (likes and comments), furnishing an incentive for fraudulent behaviour – for inflating their influence. Inflating influence is a form of advertising fraud that causes market inefficiencies by directing ads to the wrong audience. An estimated 15% of influencer marketing spending is misused due to exaggerated influence. To address this issue, the US Federal Trade Commission proposed a rule in 2023 to ban the sale and purchase of false indicators of social media influence. Cartels provide a way of obtaining fake engagement that does not fall directly under the proposed rule – because no money changes hands – but is still in the same spirit. While there is substantial literature on fake consumer reviews (Mayzlin et al. 2014, Luca and Zervas 2016) and other forms of advertising fraud (Zinman and Zitzewitz 2016), the literature on influencer marketing has focused mostly on advertising disclosure (Ershov and Mitchell 2023, Pei and Mayzlin 2022, Mitchell 2021, Fainmesser and Galeotti 2021), leaving the fraudulent behaviour unstudied.</p>

<h2>How do Instagram cartels work?</h2>

<p>An influencer cartel is a group of influencers who collude to boost their advertising fees by inflating engagement metrics. As in traditional industries (Steen et al. 2013), influencer cartels involve a formal agreement to manipulate the market for the members’ benefit. The cartels operate in online chatrooms. The screenshots below show how one such cartel operates in practice. The image on the left is from an online chat room, where cartel members submit links to their content for extra engagement. Before submitting a link, they must reciprocate by liking and commenting on other members’ posts. An algorithm enforces these rules. The image on the right shows these cartel-induced comments on Instagram. The cartel history and rules make it possible to observe which engagement (comments) originate from the cartel.</p>

<p><strong>Figure 1</strong> Left panel shows posts in online chatroom submitted for cartel engagement; right panel shows Instagram comments originating from the cartel</p>

  


<h6><em>Source</em>: Left panel is a screenshot of a Telegram group; right panel is a screenshot from Instagram. To preserve anonymity, account identifiers are blurred and the photo is replaced with an analogous photo by an AI image generator.</h6>

<h2>What distinguishes ‘bad’ from ‘not-so-bad’ cartels?</h2>

<p>Our theoretical model formalises the main trade-offs in this setting, in the spirit of the imaginary citation group discussed earlier. The model focuses on strategic engagement, a decision that affects social media content distribution and consumption (Aridor et al. 2024) but has been underexplored (with the exception of Filippas et al. 2023, who studied attention bartering in Twitter). Engaging with other influencers’ content has a positive externality, leading to too little engagement in equilibrium. Forming a cartel to reciprocally engage with each other’s content can internalise this externality and might be socially desirable. However, it can also result in low-value engagement, especially when advertisers pay based on quantity rather than quality.</p>

<p>The key dimension to differentiating ‘bad’ from ‘not-so-bad’ cartels is the quality of cartel engagement. By ‘high quality’, we mean engagement coming from influencers with similar interests. The idea is that influencers provide value to advertisers by promoting a product among the target audience: people with similar interests, such as vegan burgers to vegans. If a cartel generates engagement from influencers with other interests (meat lovers), this hurts consumers and advertisers. It hurts consumers because the platform will show them irrelevant content, and advertisers are hurt because their ads are shown to the wrong audience. Whether or not a particular cartel is welfare-reducing or welfare-improving is an empirical question.</p>

<h2>Evaluating engagement quality using machine-learning methods</h2>

<p>To answer this empirical question, we use novel data from influencer cartels and machine learning to analyse Instagram text and photos. The cartel data allows us to directly observe which Instagram posts are included in the cartel and which engagement originates from the cartel (via cartel rules). Our dataset includes two types of cartels, differentiated by cartel entry rules: topic cartels (which only accept influencers posting on specific topics) and general cartels (with unrestricted topics).</p>

<p>Our goal is to compare the quality of natural engagement to that originating from the cartel. We measure the quality by the topic match between the cartel member and the Instagram user who engages. To quantify the similarity of Instagram users, we generate numeric vectors (embeddings) from the text and photos in Instagram posts using a large language model (Language-agnostic BERT Sentence Embedding) and an analogous large neural network (Contrastive Language Image Pre-training model). Then we calculate cosine similarity between the Instagram users based on these numeric vectors.</p>

<h2>Are the cartels likely to be welfare-improving?</h2>

<p>We find that engagement from general cartels is significantly lower in quality compared to natural engagement. Specifically, the quality of engagement from these cartels is nearly as low as that from a counterfactual engagement from a random Instagram user. In contrast, engagement from topic cartels is much closer to the quality of natural engagement.</p>

<p>The figure below illustrates these effects using raw data (see the paper for regression estimates, robustness checks, and additional analysis). It presents distributions of cosine similarity between the author and commenter, separately for general (left panel) and topic (right panel) cartels. It shows that non-cartel commenters (natural engagement) have the highest similarity with the author of the content, and random users have the lowest. Match quality from general cartels is similar to random engagement (left panel). In contrast, topic cartel engagement is much closer to natural engagement (right panel).</p>

<p><strong>Figure 2</strong> Probability density of authors’ similarity to commenters and random users in general cartels (left) and topic cartels (right)</p>

  


<p>Back-of-the-envelope calculations (based on regression analysis) show that if advertisers pay for cartel engagement as if it were natural engagement, they receive only 3–18% of the value with general cartels, and 60–85% with topic cartels. In other words, general cartels provide nearly worthless engagement for advertisers, while topic cartels cause less distortion.</p>

<h2>Conclusions and policy implications</h2>

<p>Our findings lead to three policy implications. First, since general cartels are likely to reduce welfare, stronger regulation of their activities would benefit society. Second, regulations that prohibit buying and selling fake social media indicators should also cover in-kind transfers, such as paying for engagement with reciprocal engagement. Third, the current practice of rewarding engagement quantity encourages harmful collusion. A better approach would be to compensate influencers based on the actual value they provide. Luckily, many advertisers are already moving in this direction. Until they get there, platforms could improve outcomes by reporting match-quality-weighted engagement.</p>

<h2>References</h2>

<p>Aridor, G, R Jiménez-Durán, R Levy and L Song (2024), “<a href="https://cepr.org/voxeu/columns/economics-social-media">The economics of social media</a>,” VoxEU.org, 20 May.</p>

<p>Catanzaro, M (2024), “Citation Manipulation Found to be Rife in Math”, <em>Science</em> 383 (6682): 470.</p>

<p>Ershov, D and M Mitchell (2023), “The Effects of Influencer Advertising Disclosure Regulations: Evidence from Instagram”, <em>RAND Journal of Economics,</em> forthcoming.</p>

<p>Fainmesser, I P and A Galeotti (2021), “The Market for Online Influence”, <em>American Economic Journal: Microeconomics </em>13(4): 332–72.</p>

<p>Filippas, A, J J Horton and E Lipnowski (2023), “The Production and Consumption of Social Media”, manuscript.</p>

<p>Hinnosaar, M and T Hinnosaar (2024), “<a href="https://cepr.org/publications/dp19079">Influencer Cartels</a>”, CEPR Discussion Paper 19079.</p>

<p>Luca, M and G Zervas (2016), “Fake It Till You Make It: Reputation, Competition, and Yelp Review Fraud”, M<em>anagement Science </em>62(12): 3412–27.</p>

<p>Mayzlin, D, Y Dover and J Chevalier (2014), “Promotional Reviews: An Empirical Investigation of Online Review Manipulation”, <em>American Economic Review </em>104(8): 2421–55.</p>

<p>Mitchell, M (2021), “Free Ad(vice): Internet Influencers and Disclosure Regulation”, <em>RAND Journal of Economics</em> 52(1): 3–21.</p>

<p>Pei, A and D Mayzlin (2022), “Influencing Social Media Influencers Through Affiliation”,<em> Marketing Science</em> 41(3): 593–615.</p>

<p>Steen, F, O Toivanen and A Hyytinen (2013), “<a href="https://cepr.org/voxeu/columns/anatomy-cartel-contracts">Anatomy of cartel contracts</a>”, VoxEU.org, 14 June.</p>

<p>Van Noorden, R (2013), “Brazilian Citation Scheme Outed”, Nature 500(7464): 510–11.</p>

<p>Zinman, J and E Zitzewitz (2016), “Wintertime for Deceptive Advertising?”, American Economic Journal: Applied Economics 8(1): 177–92.</p>

              </div>

              
                                          </article>
    </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Why do electronic components have such odd values? (2021) (330 pts)]]></title>
            <link>https://digilent.com/blog/why-do-electronic-components-have-such-odd-values/</link>
            <guid>40576132</guid>
            <pubDate>Tue, 04 Jun 2024 16:20:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://digilent.com/blog/why-do-electronic-components-have-such-odd-values/">https://digilent.com/blog/why-do-electronic-components-have-such-odd-values/</a>, See on <a href="https://news.ycombinator.com/item?id=40576132">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-4381">
	<!-- .entry-header -->

	<div>
		<p>If you’ve been around electronics for a while, you’ve probably noticed that components like resistors, capacitors, zener diodes, and inductors come in some odd values. Looking at the chart below, there seems to be no clear rationale&nbsp;behind the values, but there is a pattern. 47kΩ resistors and 22μF capacitors are everywhere, but not 40kΩ or 50kΩ resistors, or 20μF or 30μF capacitors. So what’s the deal? It all has to do with <a href="http://en.wikipedia.org/wiki/Preferred_number" target="_blank" rel="noopener">preferred numbers</a>.</p>
<p><a href="https://digilent.com/blog/wp-content/uploads/2015/01/resistor-color-codes.png"><img fetchpriority="high" decoding="async" src="https://digilent.com/blog/wp-content/uploads/2015/01/resistor-color-codes-600x600.png" alt="resistor-color-codes" width="600" height="600" srcset="https://digilent.com/blog/wp-content/uploads/2015/01/resistor-color-codes.png 600w, https://digilent.com/blog/wp-content/uploads/2015/01/resistor-color-codes-150x150.png 150w, https://digilent.com/blog/wp-content/uploads/2015/01/resistor-color-codes-225x225.png 225w, https://digilent.com/blog/wp-content/uploads/2015/01/resistor-color-codes-300x300-cropped.png 300w" sizes="(max-width: 600px) 100vw, 600px"></a></p>
<p>We have to go back a few years to 1877 France. The French military used balloons for various purposes and of various sizes, and they had to be anchored using cables. Over time, they ended up with 425 different sizes of mooring cables that had to be individually ordered and inventoried. Talk about a nightmare.</p>
<p>Enter Charles Renard. He was tasked with improving the balloons, but discovered this rat’s nest of cables in the inventory closet instead. He spent some time thinking about it and came up with a series of 17 cable sizes that would allow for every type of balloon to be properly moored. Each size of cable had a max/min rating that just overlapped it’s neighbor above and below, so every required value was covered by one or more cable. This system of numbers became known as the “Renard numbers” and was later included in the&nbsp;“preferred numbers” when the concept was expanded for other applications and became an international standard with ISO (International Organization for Standards) 3 in 1952.</p>
<p>Since then, numerous international standards have been adopted by ISO for countless things, but one of those is how we identify&nbsp;certain electronic components. Using the same idea that Renard developed, these components are labeled with what are known as E-series values within the preferred number system. The lowest value is E6, which enumerates six&nbsp;values between&nbsp;two consecutive powers of 10, i.e., between 10 and 100 or between 10k and 100k. Starting with 10, we increase that value by roughly half and we get 15. Increase by roughly half again and we get 22. Continuing this trend, rounding as needed, and we end up with the series 10, 15, 22, 33, 47, and 68. Components built to the E6 standard have a 20% relative error tolerance, and if we look at the values again we’ll see a trend. Starting with 10 again and adding 20% error we end up with 12. Moving to 15 and subtracting 20% we get… wait for it… 12. Moving up from 15 we get 15 + 20% = 18 and 22 – 20% = 17.6. This trend repeats no matter what range of powers of 10 you use, as long as they are consecutive. So 47kΩ&nbsp;+ 20% = 56400, while 68kΩ – 20% = 54400.</p>
<p>Look again at the values 47 and 68. The max/min values overlap right about 56, don’t they? That sounds familiar. The E12 standard uses all of the same values as E6, but with 6 more values mixed in. These 6 additional values are roughly where the E6 values overlap, and now in order to cover the entire range our %-error is reduced to 10%. Starting again at 10, we have 10, 12, 15, 18, 22, 27, 33, 39, 47, 56, 68, and 82. The math holds true here as well, with the error values just slightly overlapping.</p>
<p>There are four&nbsp;more E-series as well, namely E24, E48, E96, and E192. The image above lists all values included in the E6/E12/E24 standards. With each doubling of&nbsp;values between consecutive powers of 10, there is an associated halving of the %-error allowance as well. So E24 values have a +/- %-error of 5%, E48 is set at 2%, and so on. The values associated with E192 are also available with 0.25% and 0.1% tolerances, and E24 and E96 are also available with 1% tolerances.</p>
<p>Below is a simple graphical view of how the E12 values relate to one another. Along the bottom of the graph you will see the first 13 terms&nbsp;of an ideal geometric sequence as well. (The sequence is given by y=10^(<em>i</em>/<em>b</em>), where <em>b</em> is the value of the series (e.g. 12) and <em>i</em> is the term desired (e.g. the 8th term would yield 10^(8/12)=4.64).) Notice how closely the values are related.</p>
<figure id="attachment_4382" aria-describedby="caption-attachment-4382"><a href="https://digilent.com/blog/wp-content/uploads/2015/01/E12_series_tolerance.svg_.png"><img decoding="async" src="https://digilent.com/blog/wp-content/uploads/2015/01/E12_series_tolerance.svg_-343x600.png" alt="E12_series_tolerance.svg" width="343" height="600" srcset="https://digilent.com/blog/wp-content/uploads/2015/01/E12_series_tolerance.svg_.png 343w, https://digilent.com/blog/wp-content/uploads/2015/01/E12_series_tolerance.svg_-129x225.png 129w" sizes="(max-width: 343px) 100vw, 343px"></a><figcaption id="caption-attachment-4382">This graph shows how any value between 1 and 10 is within ±10% of an E12 series value, and its difference from the ideal value in a geometric sequence. By Anders Andersson from <a href="http://commons.wikimedia.org/wiki/File%3AE12_series_tolerance.svg" target="_blank" rel="noopener">Wikimedia Commons</a>.</figcaption></figure>
<p>While it is possible to have a 3.3kΩ resistor with 20% tolerance test out between 2.64kΩ and 3.96kΩ, I would be hesitant to use it. I want 3.3kΩ, so I tend to use resistors with a higher tolerance, usually 5%, so I can just reach in my bin and know that I’m reasonably close. Looking back at the table in the beginning,&nbsp;we see that there are values of 68 and 75 listed. If I’m looking for a value of 70 (or some multiple power of 10, like 700), what can I do to achieve it? I can certainly start testing every 68 valued resistor I can find (75 is just out of range of 5% tolerance), hoping to find one that is just right, but just because it says 5%, doesn’t mean it is. That is a maximum allowance, and my experience has been that the tolerances are much tighter than that. I could go up to an E96 (681 0r 715) or even E192 (698!), but resistors with that level of %-error tolerance are not common and cost more. I just want something simple that I already have in my bin! The answer is actually quite simple. Just add a 33 and a 47 and call it good. You get your 70 +/- whatever tolerance you want since 33 and 47 are preferred numbers in every E-series. The point is that any value can be made for any circuit requirement simply by adding components together. When you throw in the rules for calculating components in series and parallel, the combinations are endless.</p>

         
        
                    <!--begin code -->

                    
                    <div data-post_id="30055" data-instance_id="1" data-additional_class="pp-multiple-authors-layout-boxed.multiple-authors-target-the-content" data-original_class="pp-multiple-authors-boxes-wrapper pp-multiple-authors-wrapper box-post-id-30055 box-instance-id-1">
                                                                                                                                    <p><span>
                                                                                                                        <ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                    <li>
                                                                                                                                                                                    <div>
                                                                    <p><img alt="Brandon Marcum" src="https://secure.gravatar.com/avatar/759a6fe8a05fd65a78b981319973577c?s=80&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/759a6fe8a05fd65a78b981319973577c?s=160&amp;d=mm&amp;r=g 2x" height="80" width="80">                                                                                                                                                                                                            </p>
                                                                                                                                    </div>
                                                            
                                                            
                                                                                                                                                                                                                        </li>
                                                                                                                                                                                                                                    </ul>
                                                                            </span>
                                                                                                                        </p></div>
                    <!--end code -->
                    
                
                                
                
        	</div><!-- .entry-content -->

	<!-- .entry-footer -->
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[CO2 helps viruses stay alive longer in the air (132 pts)]]></title>
            <link>https://www.statnews.com/2024/06/04/co2-ventilation-research-virus-airborne-life-haddrell-celebs/</link>
            <guid>40575081</guid>
            <pubDate>Tue, 04 Jun 2024 14:36:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.statnews.com/2024/06/04/co2-ventilation-research-virus-airborne-life-haddrell-celebs/">https://www.statnews.com/2024/06/04/co2-ventilation-research-virus-airborne-life-haddrell-celebs/</a>, See on <a href="https://news.ycombinator.com/item?id=40575081">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
	<p><span><span>C</span></span>arbon dioxide monitors have been around for decades. But in 2020, they became, almost overnight, a hot commodity. All of a sudden, people wanted them to help assess the safety of indoor spaces — to gauge the likelihood of breathing in coronavirus-laced particles that until very recently had been in someone else’s lungs.</p>
<p>No sensor can monitor how many infectious aerosols are swirling around us in real time. But carbon dioxide, or CO2, can act as a convenient proxy. People exhale it when they breathe, and in spaces that aren’t well ventilated, the gas accumulates. High CO2 concentrations can provide a warning sign that a lot of the air you’re inhaling is coming out of other people’s respiratory tracts.</p>
<p>For decades, that’s how aerosol scientists and ventilation engineers have mostly thought about CO2 — as a sort of indicator for the health of indoor environments. But over the last three years, researchers in the U.K. working with next-generation bioaerosol technologies have discovered that CO2 is more than a useful bystander. In fact, it plays a critical role in determining how long viruses can stay alive in the air: The more CO2 there is, the more virus-friendly the air becomes.</p>
<p>It’s a revelation that is already transforming the way scientists study airborne pathogens. But on a planet where burning fossil fuels and other industrial activities inject 37 billion metric tons of CO2 into the atmosphere each year, it could also have huge implications for human health.</p>
		
		
<p>“By increasing the CO2 in the air, we’re getting rid of a natural means by which viruses become inactivated,” said Allen Haddrell, an environmental chemist at the University of Bristol Aerosol Research Center, who led the new work. “It’s fascinating, but it’s also horrifying.”</p>
<p><span><span>H</span></span>addrell has spent his career designing instruments to better understand the complex chemical reactions that take place in the violent moments after someone coughs, sneezes, or breathes respiratory particles out. The reactions within those flecks determine how far they can float and how long they can linger in the air. In 2013, Haddrell was approached by the U.K.’s Defense Science and Technology Laboratory about making a machine to study how long bacteria can live inside these particles.</p>
<p>For the better part of a century, scientists have done those experiments with an instrument called a nebulizer, which creates a cloud of aerosols from liquids and releases them into a rotating drum. Then they wait and take time-stamped samples of the air inside the drum to calculate a given pathogen’s half-life: how long it can stay alive and aloft.</p>
<p>The trouble is, these nebulizers create complex plumes of particles, with different sizes and ages, so it can be difficult to know exactly what’s being measured. All the tumbling can give microbes a beating, too, making it difficult to interpret data about their viability. The British government’s military research arm wanted better information to help it prepare for a potential bioterrorism attack.</p>
<p>Making an instrument that could provide such information would turn into a six-year slog. Initially, Haddrell tried to adapt a technology known as “optical tweezers,” developed by a colleague of his at Bristol named Jonathan Reid. It uses lasers to trap particles in a microscope for extended periods of time, allowing researchers to measure the light scattering off of them to determine their physical and chemical properties. But bacteria — with all their proteins, fats, and other biomolecules — created patterns too complicated to fully understand.</p>
<p>Eventually, Haddrell, Reid, and a small team of Ph.D. students and postdocs turned to piezoelectronics. They could harness tiny charges of electricity to force fluid out under carefully controlled pressure, forming a perfect liquid bead — each with exactly the same chemical composition, size, and number of viral particles.</p>
<p>Instead of a rotating drum, Haddrell’s team built an electrodynamic force field to trap each tiny particle in mid-air at the moment of its creation. Using a laser and a camera, they could watch each hovering particle move and change as they exposed it to different environmental conditions. Once they’d measured the particles’ size and chemical composition, they could turn off the electrodynamic field, sending the beads plummeting into a Petri dish to be cultured.</p>
<p>The researchers called the contraption CELEBS, for “controlled electrodynamic levitation and extraction of bioaerosols onto a substrate,” and by 2019, they’d <a href="https://royalsocietypublishing.org/doi/10.1098/rsif.2018.0779" target="_blank" rel="noopener">shown it could work quite well</a> for benchmark bacteria like E. coli. The plan was to move on to other, more concerning airborne bacterial threats.</p>
<p>Then, a novel coronavirus emerged in China and began sickening millions of people all over the world.</p>
		
		
<p><span><span>O</span></span>n March 23, 2020, the same day Prime Minister Boris Johnson announced a nationwide lockdown to curb the widening outbreak of SARS-CoV-2, Haddrell got an email from a colleague at Bristol’s veterinary school, located on a farm about a 40-minute drive south. They were standing up a Containment Level 3 laboratory there and assembling a multidisciplinary rapid response team to study the virus. Could he get his CELEBS system working there, so they could learn more about how it behaved in respiratory particles?</p>
<p>“It was wild,” recalled Haddrell. “I went from thinking I would be home for the next three to six months to driving down there the next day.”</p>
<figure id="attachment_1165502"><a href="https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1.jpeg"><img fetchpriority="high" decoding="async" src="https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-328x437.jpeg" alt="Portrait of Allen Haddrell wearing a green shirt, with yellowish/green bushes behind him. -- infectious disease coverage from STAT" width="328" height="437" srcset="https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-328x437.jpeg 328w, https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-1024x1365.jpeg 1024w, https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-768x1024.jpeg 768w, https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-500x667.jpeg 500w, https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-640x853.jpeg 640w, https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1-432x576.jpeg 432w, https://www.statnews.com/wp-content/uploads/2024/06/IMG_5044-1.jpeg 1536w" sizes="(max-width: 328px) 100vw, 328px"></a><figcaption><span>Allen Haddrell</span> <cite>Courtesy Hannah Craven</cite></figcaption></figure>
<p>As the country shut down and the roads emptied of cars, Haddrell began building a high-containment version of his machine. While he did that, a postdoc named Henry Oswin took an existing CELEBS and got it calibrated to work with a mouse virus so they’d be ready to move on to SARS-CoV-2 as soon as the lab opened.</p>
<p>Around that time, researchers using traditional rotating drums began to report <a href="https://www.statnews.com/2020/03/16/coronavirus-can-become-aerosol-doesnt-mean-doomed/">the first survivability data for the new coronavirus</a>. One group, at the National Institute of Allergy and Infectious Diseases, found <a href="https://www.nejm.org/doi/10.1056/NEJMc2004973" target="_blank" rel="noopener">SARS-CoV-2 could stay viable in aerosols for up to three hours</a>. Another, from Tulane University, found it could live in the air for <a href="https://www.medrxiv.org/content/10.1101/2020.04.13.20063784v1" target="_blank" rel="noopener">over 16 hours</a>. The divergent findings added to the confusion as officials crafted public health policies in those first months of the pandemic — when Americans were encouraged first not to wear medical-grade masks, <a href="https://www.statnews.com/2020/04/03/white-house-urges-masks-coronavirus/">then to wear homemade cloth coverings</a>.</p>
<p>But when Haddrell’s team finally began their own experiments with SARS-CoV-2 in the fall of that year, they found the virus lost 90% of its ability to infect people within 20 minutes — with most of the loss occurring within the first five minutes.</p>
<p>Haddrell knew that going public with this information was going to be tricky. Because it had come from a totally novel technology, it would be easy to disregard the data as an artifact of an untested method. He wanted to make sure they had an explanation for why, in their hands, the coronavirus decayed much more quickly. So his team spent another year doing experiments and arguing over hypotheses on the daily drives to and from the new lab. Finally, they settled on a possible answer.</p>
<p>In biology labs, viruses are kept alive inside of cell cultures, where the byproducts of eating and growing can drive up the pH to dangerously alkaline levels. To keep that from happening, most culture media contains dissolved bicarbonate, which together with the carbon dioxide gas inside an incubator creates a buffering system.</p>
		
		
<p>Inside a nebulizer, though, these virus-laced bicarbonate solutions become aerosolized, releasing CO2 that builds up if it’s in a confined space. Haddrell’s team found that a standard nebulizer spraying cell culture media could raise the concentration of CO2 in a 7-liter box from 700 parts per million to over 1,100 over the course of 10 minutes. That extra CO2 acted like a buffer keeping the particles closer to a neutral pH, where respiratory viruses are quite content.</p>
<p>In the CELEBS system, that didn’t happen. As particles lost water through evaporation, they rapidly became more basic, which killed any SARS-CoV-2 viruses inside. Haddrell and his team proposed that pH, more than temperature and humidity, was the driving force behind viral decay in respiratory particles. And the method most widely used to study that had been incidentally altering pH without anyone realizing it.</p>
<p><span><span>I</span></span>f they were right, it would call into question decades of data produced by virology research groups around the world. So when Haddrell’s team posted their own results as <a href="https://www.medrxiv.org/content/10.1101/2022.01.08.22268944v1.full.pdf" target="_blank" rel="noopener">a preprint </a>in January 2022, they expected a bit of blowback. What they got was a hurricane.</p>
<p>“The headline is VERY convenient for people in power” tweeted Jose-Luis Jimenez, an atmospheric chemist at the University of Colorado, referencing <a href="https://www.theguardian.com/world/2022/jan/11/covid-loses-90-of-ability-to-infect-within-five-minutes-in-air-study" target="_blank" rel="noopener">a Guardian article about the research</a>. “Now they can quote an aerosol preprint to keep doing nothing… [Wonder if they’ll forget not reviewed?]” Other leading aerosol scientists <a href="https://twitter.com/jljcolorado/status/1480927297926479884" target="_blank" rel="noopener">quickly piled on</a>.</p>
<p>Haddrell, who wasn’t active on the social media site at the time, had unknowingly waded into a blistering online feud among researchers <a href="https://www.wired.com/story/the-teeny-tiny-scientific-screwup-that-helped-covid-kill/" target="_blank" rel="noopener">about the extent to which SARS-CoV-2 was airborne</a>. If it could travel through the air and infect people via inhalation, even over short distances, then social distancing and handwashing wasn’t going to be enough to curb its spread — masking and ventilation would also be required.</p>
<p>The controversy hinged on differences in how aerosol scientists and medical professionals used words like “aerosol” and “airborne,” <a href="https://www.statnews.com/2024/04/18/covid-airborne-transmission-disease-who-expanded-definition/#:~:text=Even%20as%20evidence%20grew%20that,was%20airborne%20until%20late%202021.">differences the World Health Organization only recently resolved</a>. But in 2022, many feared that at the precise time when the Delta variant was filling up hospital wards across the U.K. with Covid patients, Haddrell’s data would be wrongly interpreted as casting doubt on the airborne route of transmission.</p>
<p>“That’s not what we were saying at all,” Haddrell said. “When Fox News emailed us, we knew we had a problem,” he said.</p>
<p>So when his group used CELEBS to systematically tease apart all the fundamental processes that could be causing SARS-CoV-2 to die in respiratory particles — temperature, humidity, salt content — and still found that pH played the biggest role, they didn’t put out the results as a preprint before it was <a href="https://royalsocietypublishing.org/doi/10.1098/rsif.2023.0062" target="_blank" rel="noopener">published</a> last summer. He also took to X, formerly Twitter, to explain what this finding meant in practical, pandemic terms: “Anything that reduces the acid content of the air will lower the aerosolized viral load #ventilation,” he wrote.</p>
<p>That’s because the human body is not unlike those nebulizers. We, too, carry around dissolved CO2 in the form of bicarbonate, which our blood transports from all our remote tissues into our lungs. When we exhale, and the bicarbonate inside our respiratory particles comes into contact with the outside air, it quickly breaks down and escapes as CO2 gas. If we’re in an enclosed space, that CO2 sticks around, limiting how high the pH inside those particles can climb — just like inside the rotating drums.</p>
<p>But that still left the question: How much CO2 is necessary to boost the odds of viral survival? The <a href="https://www.nature.com/articles/s41467-024-47777-5" target="_blank" rel="noopener">latest paper</a> from Haddrell’s group, published in Nature Communications in April, found a disconcerting answer: not nearly as much as you might think. Increasing the CO2 concentration to just 800 parts per million, a level widely identified as being a marker of good ventilation, significantly extended the life spans of multiple SARS-CoV-2 variants. At higher concentrations — like those you might expect to find in a crowded, poorly ventilated room — Haddrell’s team found that 10 times as much virus remained infectious after 40 minutes when compared to clean air.</p>
		
		
<p><span><span>T</span></span>ogether, the papers make a case for the need to improve the quality of indoor air, said Josh Santarpia, an expert in aerosol transmission of disease at the University of Nebraska Medical Center who was not involved in the study. “It’s not just that your exposure is higher, but the risk is also higher because there are more things that are staying alive,” he said. “It demonstrates the compounded nature of poor ventilation.”</p>
<p>Jimenez, who had been critical of Haddrell’s 2022 preprint and the subsequent media coverage, described the Bristol group’s latest work as “very important” in the push for stronger policies that regulate indoor air. In March, he and a group of international experts <a href="https://www.science.org/doi/10.1126/science.adl0677" target="_blank" rel="noopener">writing in Science</a> presented a blueprint for national indoor air standards in public buildings, aiming to reduce both disease transmission and indoor pollutants.</p>
<p>In its call to action, the group proposed CO2 as one of three key metrics, suggesting ventilation rates that would keep CO2 levels at 800 parts per million or below. Lidia Morawska, an aerosol expert at Queensland University of Technology who was also an author on the Science perspective, told STAT that the Bristol work indicates that number might be too conservative.</p>
<p>“This is another argument for lowering the concentration of CO2 as much as we can,” Morawska said. “It’s moving from a role of being just a proxy to being understood as an enhancer, if we can use this term, for infection.”</p>
<p>Other aerosol experts who have studied SARS-CoV-2 extensively, like Linsey Marr at Virginia Tech, aren’t convinced that CO2 and pH are the whole story. “There are still many details we don’t understand about virus survival in respiratory particles,” she told STAT via email. “Their explanation might be right, but it might not.”</p>
<p>Haddrell agrees that more work needs to be done to understand how widely generalizable the phenomenon is. His team is now gearing up to begin more experiments with influenza A viruses.</p>
<p>But others are also taking up the reins. The Bristol group has now sent CELEBS machines to a handful of other labs, including Morawska’s in Australia and some in the U.S. With the recent spread of <a href="https://www.statnews.com/topic/h5n1-bird-flu/">H5N1 bird flu</a> into many mammal species, including dairy cattle and <a href="https://www.statnews.com/2024/05/30/bird-flu-third-case-human-infection-caused-respiratory-symptoms/">farmworkers who care for them</a>, and the continuing rise in atmospheric CO2 levels, understanding the complex interplay between viruses, human bodies, and the environments where they eat, sleep, and breathe, is only growing more urgent.</p>
</section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Encryption at Rest: Whose Threat Model Is It Anyway? (188 pts)]]></title>
            <link>https://scottarc.blog/2024/06/02/encryption-at-rest-whose-threat-model-is-it-anyway/</link>
            <guid>40573211</guid>
            <pubDate>Tue, 04 Jun 2024 11:25:18 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://scottarc.blog/2024/06/02/encryption-at-rest-whose-threat-model-is-it-anyway/">https://scottarc.blog/2024/06/02/encryption-at-rest-whose-threat-model-is-it-anyway/</a>, See on <a href="https://news.ycombinator.com/item?id=40573211">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p><strong>Head’s up</strong>: This is a blog post about applied cryptography, with a focus on web and cloud applications that encrypt data at rest in a database or filesystem. While the lessons can be broadly applicable, the scope of the post is not.</p>



<hr>



<p>One of the lessons I learned during my time at AWS Cryptography (and particularly as an AWS Crypto Bar Raiser) is that the threat model for Encryption At Rest is often undefined.</p>



<p>Prior to consulting cryptography experts, most software developers do not have a clear and concise understanding of the risks they’re facing, let alone how or why the encrypting data at rest would help protect their customers.</p>



<p>Unsurprisingly, I’ve heard a few infosec thought leader types insist that encryption-at-rest is security theater over the years. I disagree with this assessment in the absolute terms, but there is a nugget of truth in that assertion.</p>



<figure><img loading="lazy" data-attachment-id="581" data-permalink="https://scottarc.blog/2024/06/02/encryption-at-rest-whose-threat-model-is-it-anyway/whose-threat-model/" data-orig-file="https://scottarc.blog/wp-content/uploads/2024/06/whose-threat-model.jpg" data-orig-size="566,440" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="whose-threat-model" data-image-description="" data-image-caption="" data-medium-file="https://scottarc.blog/wp-content/uploads/2024/06/whose-threat-model.jpg?w=300" data-large-file="https://scottarc.blog/wp-content/uploads/2024/06/whose-threat-model.jpg?w=566" width="566" height="440" src="https://scottarc.blog/wp-content/uploads/2024/06/whose-threat-model.jpg?w=566" alt="Whose threat model is it anyway?"><figcaption>The million dollar question.</figcaption></figure>



<p>Let’s explore this subject in a little more detail.</p>



<h2>Why should we listen to <em>you</em> about this topic?</h2>



<p>(If you don’t need any convincing, feel free to <a href="#protection">skip this section</a>.)</p>



<p>Encryption at rest is a particular hobby horse of mine. I previously wrote on this blog about <a href="https://scottarc.blog/2023/08/18/innovations-in-the-aws-database-encryption-sdk/">the under-celebrated design decisions in the AWS Database Encryption SDK</a> and <a href="https://scottarc.blog/2022/10/17/lucid-multi-key-deputies-require-commitment/">the need for key-committing AEAD modes in multi-tenant data lakes</a>.</p>



<p>Before my time at Amazon, I had also designed a PHP library called <a href="https://ciphersweet.paragonie.com/">CipherSweet</a> that offers a limited type of Searchable Encryption. The goal of CipherSweet was to improve the cryptography used by SuiteCRM. (The library name is, of course, a pun.)</p>



<p>I’ve also contributed a ton of time making cryptography easy-to-use and hard to misuse outside of the narrow use-case that is at-rest data encryption. To that end, I designed <a href="https://paseto.io/">PASETO</a> as a secure-by-default alternative to JSON Web Tokens.</p>



<p>I also have a lot of skin in the game when it comes to developer comprehension: I was the first Stack Overflow user with a gold badge for both <a href="https://stackoverflow.com/help/badges/1030/security" target="_blank" rel="noreferrer noopener">[security]</a> and <a href="https://stackoverflow.com/help/badges/4641/encryption" target="_blank" rel="noreferrer noopener">[encryption]</a>, largely due to the effort I put into cleaning up the <a href="https://meta.stackoverflow.com/questions/293930/problematic-php-cryptography-advice-in-popular-questions" target="_blank" rel="noreferrer noopener">bad cryptography advice for the PHP ecosystem</a>.</p>



<p>I have spent the past decade or so trying to help teams avoid <a href="https://paragonie.com/blog/2019/05/wordpress-5-2-mitigating-supply-chain-attacks-against-33-internet" target="_blank" rel="noreferrer noopener">security disasters in one form or another</a>. </p>



<h3>Why should we <strong>not</strong> listen to you about this topic?</h3>



<p>If you happen to know a cryptography expert you trust more than some Internet stranger with a blog, I implore you to listen to them if we disagree on any point. They may know something I don’t. (That said, I’m always happy to learn something new!)</p>



<p>I also do <strong>not</strong> have a college degree in Cryptography, nor have I published any papers in prestigious academic journals. If you care very much about this sort of pedigree, you will likely find my words easily discarded. If this describes your situation, no hard feelings.</p>



<h2 id="protection">Why and How to use Encryption At Rest to Protect Sensitive Data</h2>



<blockquote>
<p><strong>Important:</strong> I’m chiefly interested in discussing one use-case, and not focusing on other use cases. Namely, I’m focusing on encryption-at-rest in the narrow context of web applications and/or cloud services.</p>



<p>This is not a comprehensive blog post covering every possible use case or threat model relating to encryption at rest. Those other use cases are certainly interesting, but this post is already long enough with a narrower focus.</p>



<p>In particular: I’m not talking about the threats faced by activists or whistleblowers. This is a software engineering and applied cryptography focused blog post.</p>
</blockquote>



<p>If you’re only interested in compliance requirements, you can probably just enable Full Disk Encryption and call it a day. Then, if your server’s hard drive grows legs and walks out of the data center, your users’ most sensitive data will remain confidential.</p>



<p>Unfortunately, for the server-side encryption at rest use case, that’s basically all that Disk Encryption protects against.</p>



<p>If your application or database software is online and an attacker gains access to it (e.g., through SQL injection), with full disk encryption, <em>it might as well be plaintext</em> to an online attacker.</p>



<figure><img loading="lazy" data-attachment-id="607" data-permalink="https://scottarc.blog/2024/06/02/encryption-at-rest-whose-threat-model-is-it-anyway/full-disk-encryption/" data-orig-file="https://scottarc.blog/wp-content/uploads/2024/06/full-disk-encryption.jpg" data-orig-size="500,559" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="full-disk-encryption" data-image-description="" data-image-caption="" data-medium-file="https://scottarc.blog/wp-content/uploads/2024/06/full-disk-encryption.jpg?w=268" data-large-file="https://scottarc.blog/wp-content/uploads/2024/06/full-disk-encryption.jpg?w=500" width="500" height="559" src="https://scottarc.blog/wp-content/uploads/2024/06/full-disk-encryption.jpg?w=500" alt="Corporate needs you to find the differences between this picture and this picture. Picture 1: Full Disk Encryption. Picture 2: Plaintext Data. Attackers: They're the same picture."><figcaption>It do be like that.</figcaption></figure>



<p>Therefore, if you find yourself reaching for Encryption At Rest to mitigate the impact of the kind of vulnerability that would leak the contents of your database or filesystem to an attacker, you’re probably unwittingly engaging in security theater.</p>



<p>Disk Encryption is important for disk disposal and mitigating hardware theft, not preventing data leakage to online attackers.</p>



<p>So the next logical thing to do is draw a box around the system or component that stores a lot of data and never let plaintext cross that boundary.</p>



<h3>Client-Side Encryption</h3>



<p>Note: The naming here is a little imprecise. It <em>is</em> client-side encryption with respect to your data warehouse (i.e. SQL database), but not with respect to the user experience of a web application. In those cases, client-side would mean on the actual end user’s device.</p>



<p>Instead, client-side encryption is the generic buzz-word to mean that you’re encrypting data outside of the box you drew in your system architecture. Generally, this means that you have an application server that’s acting as the “client” for the purpose of bulk data encryption.</p>



<p>There are a lot of software projects that aim to provide client-side encryption for data stored in a database or filesystems; e.g., in Amazon S3 buckets.</p>



<p>This is a step in the right direction, but implementation details matter a lot.</p>



<blockquote>
<p><em>Quick aside:</em> For the remainder of this blog post, I’m going to assume an architecture that looks like a traditional web application, for simplicity.</p>



<p>The assumed architecture looks vaguely like this:</p>



<ul>
<li>User Agents (e.g., web browsers) that communicate with the application server.</li>



<li>Application Server(s) respond to HTTP requests from user agents, manages key material using KMS, encrypts / decrypts records stored in the database.</li>



<li>Database Server(s) which store ciphertext on behalf of the application server.</li>
</ul>



<p>This is an abstract design, so the actual implementation details you encounter in the real world may be simpler or more complex in different respects.</p>



<p>There are other interesting design considerations for OS-level end-user device encryption that I’m not going to explore today. For example: <a href="https://tosc.iacr.org/index.php/ToSC/article/view/7360">Adiantum</a> is extremely cool.</p>



<p>I’m also not going to dive deep into laptop theft or the importance of Full Disk Encryption as a mechanism for ensuring data is erased from solid state hard drives, or the activities of hostile nation states. That’s a separate discussion entirely.</p>
</blockquote>



<h2 id="security-considerations">Security Considerations for Client-Side Encryption</h2>



<p>The first question to answer when data is being encrypted is, “How are the keys being managed?” This is a very deep rabbit hole of complexity, but one good answer for a centralized service is, “Cloud-based key management service with audit logging”; i.e. AWS KMS, Google CloudKMS, etc.</p>



<p>We could talk about key management for a very long time, but there’s other things I want to focus on, so let’s revisit that in a future blog post.</p>



<p>Next, you have to understand how the data is being encrypted in the first place.</p>



<p><strong>Bad answer:</strong> <a href="https://robertheaton.com/2013/07/29/padding-oracle-attack/" target="_blank" rel="noreferrer noopener">AES in CBC mode without HMAC</a>.</p>



<p><strong>Worse answer:</strong> <a href="https://words.filippo.io/the-ecb-penguin/" target="_blank" rel="noreferrer noopener">AES in ECB mode</a>.</p>



<p>Generally, you’re going to want to use an AEAD construction, such as AES-GCM or XChaCha20-Poly1305.</p>



<p>You’ll also want <a href="https://scottarc.blog/2022/10/17/lucid-multi-key-deputies-require-commitment/">key-commitment</a> if you’re storing data for multiple customers in the same hardware. You can get this property by stapling HKDF onto your protocol (once for key derivation, again for commitment). See also: <a href="https://github.com/paseto-standard/paseto-spec/blob/master/docs/Rationale-V3-V4.md#better-use-of-hkdf-salts-change">PASETO v3 and v4</a>, or <a href="https://aws.amazon.com/blogs/security/improved-client-side-encryption-explicit-keyids-and-key-commitment/" target="_blank" rel="noreferrer noopener">Version 2 of the AWS Encryption SDK</a>.</p>



<p>It may be tempting to build a committing AEAD scheme out of, e.g., AES-CTR and HMAC, but take care that you don’t introduce canonicalization risks in your MAC.</p>



<h3>Is Your Deputy Confused?</h3>



<p>Even if you’re using IND-CCA secure encryption and managing your keys securely, there is still a very stupid attack against many data-at-rest encryption schemes.</p>



<p>To understand the attack, first consider this sort of scenario:</p>



<blockquote>
<p>Alice and Bob use the same health insurance provider, whom is storing sensitive medical records for both parties. Bob works as a database administrator for the insurance company he and Alice both use. One day, he decides to snoop on her private medical history.</p>



<p>Fortunately, the data is encrypted at the web application, so all of the data Bob can access is indistinguishable from random. He can access his own account and see his data through the application, but he cannot see Alice’s data from his vantage point on the database server.</p>
</blockquote>



<p>Here’s the stupid simple attack that works in far too many cases: Bob copies Alice’s encrypted data, and overwrites his records in the database, then accesses the insurance provider’s web app. </p>



<p><strong>Bam!</strong> Alice’s plaintext recovered.</p>



<p>What’s happening here is simple: The web application has the ability to decrypt different records encrypted with different keys. If you pass records that were encrypted for Alice to the application to decrypt it for Bob, and you’re <em>not authenticating your access patterns</em>, Bob can read Alice’s data by performing this attack.</p>



<p>The cryptographic attack is literally copy and paste, from the database administrator’s perspective. It’s stupid but <em>it works against too many encryption-at-rest software projects</em>.</p>



<p>In this setup, the application is the Deputy, and you can easily confuse it by replaying an encrypted blob in the incorrect context.</p>



<p>The mitigation is simple: Use the AAD mechanism (part of the standard AEAD interface) to bind a ciphertext to its context. This can be a customer ID, each row’s value for the primary key of the database table, or something else entirely.</p>



<p>If you’re using AWS KMS, you can also use <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html" target="_blank" rel="noreferrer noopener">Encryption Context for this exact purpose</a>.</p>



<h3>An Illustrative Example</h3>



<p>Let’s say you have a simple web application that encrypts data before storing it in a SQL database. </p>



<p>Let’s also write it to use AES-GCM, since unauthenticated CBC mode is awful.</p>



<p>A quick and dirty implementation might look like this:</p>


<div><pre title="">class User {
    public function __construct(
        public readonly string $username,
        public string $email,
        public string $fullName
    ) {}
}

class UserModel {
    public function __construct(protected Database $db)
    {}

    public function save(User $user): bool
    {
        return $this-&gt;db-&gt;upsert(
           'users', 
           [ // set
               'full_name' =&gt; aes128gcm_encrypt($user-&gt;fullName),
               'email' =&gt; aes128gcm_encrypt($user-&gt;email)
                       // encryption details abstracted
           ], 
           [ // where
               'username' =&gt; $user-&gt;username
           ]
        );
    }

    public function fetch(string $username): User
    {
        $row = $this-&gt;db-&gt;fetch('users', ['username' =&gt; $username]);
        return new User(
            $username,
            aes128gcm_decrypt($row['email']),
            aes128gcm_decrypt($row['full_name'])
        );
    }
}
</pre></div>


<p>For the abstracted <code>aes128gcm</code> functions in the pseudocode above, just assume they’re getting the key from KMS during encryption and storing an encrypted data key in a place the ciphertext can reference later on decrypt. I didn’t want to complicate the pseudocode with a lot of boilerplate.</p>



<p>You might decide to prove the confused deputy risk by doing something like this:</p>


<div><pre title="">$model = new UserModel($db);
$model-&gt;save(new User('alice', 'alice@example.com', 'Alice McWonderland'));
$model-&gt;save(new User('bob', 'bob@example.com', 'Bob BurgerMeister'));

// Fetch Alice's data
$aliceData = $db-&gt;fetch('users', ['username' =&gt; 'alice']);
$bobData = $db-&gt;fetch('users', ['username' =&gt; 'bob']);

// This is the attack the database server can perfrom:
// Replace Bob's full_name with Alice's email
$db-&gt;upsert('users', [
    'full_name' =&gt; $alice['email']
], ['username' =&gt; 'bob']);

$badBob = $model-&gt;fetch('bob');
</pre></div>


<p>Now Bob’s full name is set to Alice’s email address.</p>



<h3>The Curious Case of CipherSweet</h3>



<p>My knowledge of this risk didn’t manifest itself in a vacuum. It was discovered over the years of maintaining an open source library.</p>



<p>The first release of CipherSweet mitigated most of this risk by construction: Each field uses a different encryption key, through a key derivation scheme. </p>



<p>In <a href="https://scottarc.blog/wp-content/uploads/2024/06/pseudocode-py.jpg" target="_blank" rel="noreferrer noopener">pseudocode</a>:</p>


<div><pre title="">def encryptRow(self, records):
    for field, type in self.fieldsToEncrypt:
       key = self.getFieldSymmetricKey(self.table, field)
       records[field] = encryptField(key, field)
</pre></div>


<p>Since CipherSweet’s inception, if you try to replace Alice’s encrypted zip code with Alice’s encrypted social security number, the keys would be wrong, so it would lead to a decryption failure.</p>



<p><strong>Or so I thought!</strong></p>



<p>As I mentioned in my blog post about <a href="https://scottarc.blog/2022/10/17/lucid-multi-key-deputies-require-commitment/">multi-tenancy and confused deputy attacks</a>, if your AEAD mode doesn’t commit to the key used, it’s possible to craft a single (ciphertext, tag) that decrypts to two different plaintext values under two different keys.</p>



<p>CipherSweet’s <code>ModernCrypto</code> suite used XChaCha20-Poly1305, which is not key-committing, and therefore susceptible to this sort of misuse.</p>



<p>This violated the Principle of Least Astonishment and motivated the development of a new algorithm suite called <code>BoringCrypto</code>, which used BLAKE2b-MAC instead of Poly1305. This change was released <a href="https://github.com/paragonie/ciphersweet/releases/tag/v3.0.0">in version 3.0.0 in June 2021</a>. </p>



<p>However, even with <code>BoringCrypto</code> in 3.0.0, this only mitigated <em>most of </em> the issue by construction. The last mile of complexity here is that each field must also be bound to a primary key or foreign key.</p>



<p>Encrypting with AAD has been possible since a very early release of CipherSweet, but being possible to use securely is not sufficient. It should be <em>easy</em> to use securely.</p>



<p><a href="https://github.com/paragonie/ciphersweet/releases/tag/v4.7.0">CipherSweet Version 4.7.0</a>, which was released last month, now only requires a code change that looks like this in order to mitigate confused deputies in an application:</p>


<div><pre title="">  $multiRowEncryptor = new EncryptedMultiRows($engine);
  $multiRowEncryptor
+     -&gt;setAutoBindContext(true)
+     -&gt;setPrimaryKeyColumn('table2', 'id')
      -&gt;addTextField('table1', 'field1')
</pre></div>


<p>This is in addition to the new <a href="https://ciphersweet.paragonie.com/php/usage#enhanced-aad">Enhanced AAD</a> feature, which allows for flexible and powerful context binding based on other fields and/or string literals.</p>



<p>(In fact, this new convenience feature actually uses Enhanced AAD under-the-hood.)</p>



<p>This doesn’t come for free, however: Users have to know the serial / primary key for a record prior to writing it, in order to use it as AAD when encrypting fields. However, that’s a much easier pill to swallow than expecting PHP devs to manage the complexity of context-binding themselves.</p>



<p>As you can see, mitigating confused deputies in an encryption library (without making it unwieldy) requires a painstaking attention to detail to get right.</p>



<p>As Avi Douglen says, “Security at the cost of usability comes at the cost of security.”</p>



<p>Given the prevalence of client-side encryption projects that just phone it in with insecure block cipher modes (or <a href="https://fosstodon.org/@atoponce/112550648928122217">ECB, which is the absence of a block cipher mode entirely</a>), it’s highly doubtful that most of them will ever address confused deputy attacks. Even I didn’t get it right at first when I made CipherSweet back in 2018.</p>



<h3>What about non-databases?</h3>



<p>Everything I mentioned in the previous section was focused on confused deputy attacks against client-side encryption for information that is stored in a database, but it’s a general problem with encrypting data at rest and storing the ciphertext “server-side”.</p>



<p>If you’re storing encrypted data in an S3 bucket, rather than in MySQL, you still need some form of context-binding mechanism to prevent the dumb and obvious attack from working against a deputy that reads data from said S3 bucket.</p>



<p>If you take nothing else away from this blog post, remember: <em>Authenticate your access patterns</em>.</p>



<h2>Why aren’t things better already?</h2>



<p>As with most things in software security, the problem is either not widely known, or is not widely understood.</p>



<p>Unknown unknowns tend to fester, untreated, across the entire ecosystem.</p>



<p>Misunderstood issues often lead to an incorrect solution.</p>



<p>In this case, at-rest encryption is mostly in Column B, and confused deputy attacks are mostly in Column A.</p>



<p>The most pronounced consequence of this is, when tasked with building at-rest data encryption in an application, most software developers do not have a cohesive threat model in mind (let alone a formal one).</p>



<p>This leads to disagreement between stakeholders about what the security requirements actually are.</p>



<h3>How can I help improve things somewhat?</h3>



<p>Most importantly, spread awareness of the nuances of encryption at-rest.</p>



<p>This blog post is intended to be a good conversation starter, but there are other resources to consider, too. I’ve linked to many of them throughout this post already.</p>



<p>If you’re paying for software to encrypt data at rest, ask your vendor how they mitigate the risk of confused deputy attacks. Link them to this blog post if they’re not sure what you mean.</p>



<p>If said vendor responds, “this risk is outside of our threat model,” ask to see their formal threat model document. If it exists and doesn’t align with your application’s threat model, maybe consider alternative solutions that provide protection against more attack classes than Full Disk Encryption would.</p>



<p>Finally, gaining experience with <a href="https://www.trailofbits.com/services/software-assurance/appsec/" target="_blank" rel="noreferrer noopener">threat modeling</a> is a good use of every developer’s time. Adam Caudill has <a href="https://adamcaudill.com/2016/07/20/threat-modeling-for-applications/">an excellent introductory blog post on the subject</a>.</p>



<h2>Closing Thoughts</h2>



<p>Despite everything I’ve written here today, I do not claim to have all the answers for encryption at rest.</p>



<p>However, you can unlock a lot of value just by asking the right questions. My hope is that anyone that reads this post is now capable of asking those questions.</p>



<h3 id="addendum-2024-06-03">Addendum (2024-06-03)</h3>



<p>After I published this, the r/netsec subreddit has expressed disappointment that this blog post had “no mention of” consumer device theft or countries experiencing civil unrest and pulling hard drives from data centers.</p>



<p>You could make a congruent  complaint that it also had no mention of Batman.</p>



<p>To be clear, I’m <strong>not</strong> saying that the use cases and risks Reddit cares about are off-topic to any discussion of full-disk encryption. They matter.</p>



<p>Rather, it’s that they’re not relevant to <em>the specific point I am making</em>: Even in the simplest use case, far from the annoying details of end user hardware or the whims of nation states, encryption-at-rest is poorly understood by most developers, and should be thought through carefully.</p>



<p>Your threat model is not my threat model, and vice versa.</p>



<p>I never advertised this blog post as a comprehensive and complete guide to the entire subject of encryption-at-rest. If you too felt under-served by this blog post for not addressing the corner cases that really matter to <em>you</em>, I hope this addendum makes it clearer why I didn’t cover them.</p>



<p>Finally, if you feel that there’s an aspect of the encryption-at-rest topic that really warrants further examination, I invite you to blog about it. </p>



<p>If your blog post is interesting enough, I’ll revise this post and link to it here.</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Microsoft blocks Windows 11 workaround that enabled local accounts (183 pts)]]></title>
            <link>https://www.pcworld.com/article/2354686/microsoft-blocks-windows-11-workaround-local-accounts.html</link>
            <guid>40572289</guid>
            <pubDate>Tue, 04 Jun 2024 09:10:10 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.pcworld.com/article/2354686/microsoft-blocks-windows-11-workaround-local-accounts.html">https://www.pcworld.com/article/2354686/microsoft-blocks-windows-11-workaround-local-accounts.html</a>, See on <a href="https://news.ycombinator.com/item?id=40572289">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="link_wrapped_content">




<p>Before PC users can enjoy everything Windows 11 has on tap, they must first enter an e-mail address that’s linked to a Microsoft account. If you don’t have one, you’ll be asked to create one before you can start setting it up.</p>



<p>A frequently used trick to circumvent this block is a small but ingenious step. By entering a random e-mail address and password, which doesn’t exist and causes the link to fail, you end up directly with the creation of a local account and can thus avoid creating an official account with Microsoft.</p>



		

		


<p>Many users prefer this method, as a local account promises more control over their own data and more privacy. However, without a Microsoft account, some useful functions are also lost such as account backup or special features for apps like Copilot.</p>



<p>This common method no longer seems to work, as Microsoft has apparently patched this bug. Instead of skipping the account link, you’re led into a kind of continuous loop that doesn’t end until you have entered the correct email address.</p>

		
			
			


<figure><div>
<blockquote data-width="500" data-dnt="true"><p lang="en" dir="ltr">It looks like Microsoft has blocked the bypass that allowed you to create a local account during Windows 11 setup by typing in a blocked email address. Now it just loops you back to typing in a different account ðŸ™ <a href="https://go.redirectingat.com/?id=111346X1569483&amp;url=https://t.co/mKnHToLLQV&amp;xcust=2-1-2354686-1-0-0&amp;sref=https://www.pcworld.com/article/2354686/microsoft-blocks-windows-11-workaround-local-accounts.html" rel="nofollow">pic.twitter.com/mKnHToLLQV</a></p>— Zac Bowden (@zacbowden) <a href="https://go.redirectingat.com/?id=111346X1569483&amp;url=https://twitter.com/zacbowden/status/1797496910737252744?ref_src=twsrc%5Etfw&amp;xcust=2-1-2354686-1-0-0&amp;sref=https://www.pcworld.com/article/2354686/microsoft-blocks-windows-11-workaround-local-accounts.html" rel="nofollow">June 3, 2024</a></blockquote>
</div></figure>



<p>Previously, it was possible to cut the Internet connection in the Task Manager before creating an account. Microsoft has since removed this workaround. As a result, many people who previously used this method are now forced to enter a working Microsoft account email address and password or use other methods.</p>



<h2 id="bypassing-microsoft-account-restrictions">Bypassing Microsoft account restrictions</h2>



<p>Another method of bypassing the account lockdown still exists. You simply have to enter OOBE\BYPASSNRO in the command prompt during the Windows 11 setup process, which allows you to skip the connection to the Internet and thus also the link to a Microsoft account. </p>



<p>However, it’s questionable how long this option will remain available. It seems that Microsoft is aiming to make the use of Windows 11 dependent on a Microsoft account. In combination with the increased calls for Windows users to finally switch to Windows 11, this appears to be a controversial combination.</p>



<p><em>This article originally appeared on PC Welt and has been translated from German to English.</em></p>

</div><p>This article originally appeared on our sister publication <a href="https://www.pcwelt.de/" rel="noreferrer noopener" target="_blank">PC-WELT</a> and was translated and localized from German.</p><div data-ga="article-footer-author">
				<p>Laura ist begeisterte Gamerin sowie Film- und Serien-Fan. Nach ihrem Studium der Kommunikationswissenschaft verschlug es sie direkt in die ersten Redaktionen, um ihre Leidenschaft auszuleben. Seitdem schreibt sie über alles rund um PCs und Technik-Themen und ist seit Mai 2024 bei PC Welt als feste Redakteurin tätig.</p>
					<ul>
																															
						  
						    
					</ul>
				
			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Web Development with Htmx, Type-Guided Components, Pure Python (104 pts)]]></title>
            <link>https://getludic.dev/docs/</link>
            <guid>40572219</guid>
            <pubDate>Tue, 04 Jun 2024 08:58:02 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://getludic.dev/docs/">https://getludic.dev/docs/</a>, See on <a href="https://news.ycombinator.com/item?id=40572219">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main-content" title="Ludic - Documentation"><p><a href="https://github.com/paveldedik/ludic/actions" title="Tests Status"><img src="https://github.com/paveldedik/ludic/actions/workflows/test.yaml/badge.svg" alt="Tests Status"></a><a href="https://codecov.io/gh/paveldedik/ludic" title="Code Coverage"><img src="https://codecov.io/gh/paveldedik/ludic/graph/badge.svg?token=BBDNJWHMGX" alt="Code Coverage"></a><a href="https://www.python.org/downloads/release/python-312/" title="Python 3.12"><img src="https://img.shields.io/badge/python-3.12-blue.svg" alt="Python 3.12"></a><a href="https://mypy-lang.org/" title="Checked with mypy"><img src="https://www.mypy-lang.org/static/mypy_badge.svg" alt="Checked with mypy"></a><a href="https://discord.gg/4Y5fSQUS" title="Discord Server"><img src="https://img.shields.io/badge/discord-ludic-black" alt="Discord Server"></a></p><h2>Introduction</h2><p>Ludic is a lightweight framework for building HTML pages with a component approach similar to <a href="https://react.dev/" target="_blank">React</a>. It is built to be used together with <a href="https://htmx.org/" target="_blank">htmx.org</a> so that developers don't need to write almost any JavaScript to create dynamic web services. Its potential can be leveraged together with its web framework which is a wrapper around the powerful <a href="https://www.starlette.io/" target="_blank">Starlette</a> framework. It is built with the latest Python 3.12 features heavily incorporating typing.</p><div><p>Experimental</p><p>The framework is in a very early development/experimental stage. There are a lot of half-functioning features at the moment. Contributions are welcome to help out with the progress!</p></div><ul><li>Seamless <b>&lt;/&gt; htmx</b> integration for rapid web development in <b>pure Python</b></li><li><b>Type-Guided components</b> utilizing Python's typing system</li><li>Uses the power of <b>Starlette</b> and <b>Async</b> for high-performance web development</li><li>Build HTML with the ease and power of Python <b>f-strings</b></li><li>Add CSS styling to your components with <b>Themes</b></li><li>Create simple, responsive layouts adopted from the <b>Every Layout Book</b></li></ul><div><h2 id="comparison">Comparison</h2><p><a href="#comparison">#</a></p></div><p>Here is a table comparing Ludic to other similar tools:</p><p>(*) HTMX as well as Starlette are optional dependencies for Ludic, it does not enforce any frontend or backend frameworks. At it's core, Ludic only generates HTML and allows registering CSS.</p><div><h2 id="quick-example">Quick Example</h2><p><a href="#quick-example">#</a></p></div><p>Here is a simple re-implementation of an example from <a href="https://reflex.dev/docs/getting-started/introduction/#an-example:-make-it-count" target="_blank">Reflex</a>:</p><p>The counter can be included on any page like here:</p><pre><span>from</span> <span>typing</span> <span>import</span> override

<span>from</span> <span>ludic.html</span> <span>import</span> b
<span>from</span> <span>ludic.web</span> <span>import</span> Endpoint, LudicApp, Request
<span>from</span> <span>ludic.catalog.buttons</span> <span>import</span> ButtonDanger, ButtonSuccess
<span>from</span> <span>ludic.catalog.layouts</span> <span>import</span> Box, Cluster

app <span>=</span> LudicApp()

<span>@app</span><span>.</span>get(<span>"/"</span>)
<span>def</span> <span>index</span>(request: Request) <span>-&gt;</span> Box:
    <span>return</span> Box(Counter(<span>"0"</span>))
</pre><p>Note that the <code>Box</code> is just a component wrapping the buttons and the number to make it nicely framed. You can read more about the <code>Box</code> in the <b><a href="https://getludic.dev/catalog/layouts">Layouts</a></b> section later. Anyway, the <code>Counter</code> component is the part that is more interesting: </p><pre><span>@app</span><span>.</span>get(<span>"/counter/</span><span>{value}</span><span>"</span>)
<span>def</span> <span>Counter</span>(value: <span>str</span>) <span>-&gt;</span> Cluster:
    <span>return</span> Cluster(
        ButtonDanger(
            <span>"Decrement"</span>,
            hx_get<span>=</span>app<span>.</span>url_path_for(<span>"Counter"</span>, value<span>=</span><span>int</span>(value) <span>-</span> <span>1</span>),
            hx_target<span>=</span><span>"#counter"</span>,
        ),
        b(value, style<span>=</span>{<span>"font-size"</span>: <span>"2em"</span>}),
        ButtonSuccess(
            <span>"Increment"</span>,
            hx_get<span>=</span>app<span>.</span>url_path_for(<span>"Counter"</span>, value<span>=</span><span>int</span>(value) <span>+</span> <span>1</span>),
            hx_target<span>=</span><span>"#counter"</span>,
        ),
        <span>id</span><span>=</span><span>"counter"</span>,
    )
</pre><div><h2 id="requirements">Requirements</h2><p><a href="#requirements">#</a></p></div><p>Python 3.12+</p><div><h2 id="installation">Installation</h2><p><a href="#installation">#</a></p></div><pre>pip install "ludic[full]"</pre><p>As similar for Starlette, you'll also want to install an <a href="https://asgi.readthedocs.io/en/latest/" target="_blank">ASGI</a> server:</p><pre>pip install uvicorn</pre><p>You can also use the <a href="https://github.com/cookiecutter/cookiecutter" target="_blank">cookiecutter</a> template to quickly create a new project:</p><pre>cookiecutter gh:paveldedik/ludic-template</pre><div><h2 id="contributing">Contributing</h2><p><a href="#contributing">#</a></p></div><p>Any contributions to the framework are warmly welcome! Your help will make it a better resource for the community. If you're ready to contribute, read the <a href="https://github.com/paveldedik/ludic/blob/main/CONTRIBUTING.md" target="_blank">contribution guide on GitHub</a>.</p><ul><li><a href="https://github.com/paveldedik/ludic/issues" target="_blank">GitHub Issues</a> – If you encounter a bug, please report it here.</li><li><a href="https://github.com/paveldedik/ludic/discussions" target="_blank">GitHub Discussions</a> – To request a new feature, this is the best place to initiate the discussion.</li><li><a href="https://discord.gg/4Y5fSQUS" target="_blank">Discord</a> – Join our Discord server for support, sharing ideas, and receiving assistance.</li></ul></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[A breakthrough towards the Riemann hypothesis (458 pts)]]></title>
            <link>https://mathstodon.xyz/@tao/112557248794707738</link>
            <guid>40571995</guid>
            <pubDate>Tue, 04 Jun 2024 08:25:19 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mathstodon.xyz/@tao/112557248794707738">https://mathstodon.xyz/@tao/112557248794707738</a>, See on <a href="https://news.ycombinator.com/item?id=40571995">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Sphere Rendering: Flat Planets (162 pts)]]></title>
            <link>https://emildziewanowski.com/flat-planets/</link>
            <guid>40571727</guid>
            <pubDate>Tue, 04 Jun 2024 07:42:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://emildziewanowski.com/flat-planets/">https://emildziewanowski.com/flat-planets/</a>, See on <a href="https://news.ycombinator.com/item?id=40571727">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-simplebar="">
                                    <article>
                        <div>
                            <p><h2>Flat Planets</h2></p>
                            
<p>I often envy those who can accurately estimate the time their tasks will take, particularly the seemingly small ones. Experience has taught me that it’s these ‘simple’ tasks that are often the most deceptive. What appears to be a 15-minute fix can unexpectedly turn into a bizarre edge case, transforming a supposed one-line code change into a day-long hunt for answers on the Wayback Machine. And yet, even with all that experience, the task that led me down the deepest rabbit hole, surprisingly, was texturing a sphere.</p>







<h2>Skybox</h2>



<p>Sky can serve as an excellent narrative device. Movie directors and game developers understand this well, often using it for exposition. What better way to convey the sense of being on a far-off planet than by presenting an alien sky, complete with unfamiliar-looking moons and planets hanging over the horizon?</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/01\/AlienSkies.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-200&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Sky in games and movies&quot;,&quot;alt&quot;:&quot;Sky in games and movies&quot;}" data-wp-interactive="core/image"><img fetchpriority="high" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/01/AlienSkies-1024x576.jpg" alt="Sky in games and movies" srcset="https://emildziewanowski.com/wp-content/uploads/2024/01/AlienSkies-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/01/AlienSkies-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/01/AlienSkies-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/01/AlienSkies-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/01/AlienSkies-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>I’m taking a similar approach in my project. The skybox I’m working on will feature an animated moon and a gas giant, adding some extra visual flair.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/SkyboxConcept.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-381&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1400,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Skybox concepts&quot;,&quot;alt&quot;:&quot;Skybox concepts&quot;}" data-wp-interactive="core/image"><img decoding="async" width="1024" height="560" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/SkyboxConcept-1024x560.jpg" alt="Skybox concepts" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/SkyboxConcept-1024x560.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/SkyboxConcept-300x164.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/SkyboxConcept-768x420.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/SkyboxConcept-1536x840.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/SkyboxConcept-2048x1120.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Both planets will spin, and in addition, the gas giant will feature moving atmospheric currents. Normally, these motions are too subtle to be seen, but I’ll accelerate them for greater visual impact. As for the artistic direction, I’m going for a semi-realistic style, inspired by the sci-fi art of the ’70s and ’80s.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/70SciFiArt.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-233&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Style inspiration&quot;,&quot;alt&quot;:&quot;Style inspiration&quot;}" data-wp-interactive="core/image"><img decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/70SciFiArt-1024x576.jpg" alt="Style inspiration" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/70SciFiArt-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/70SciFiArt-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/70SciFiArt-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/70SciFiArt-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/70SciFiArt-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h2>Planet’s Surface</h2>



<p>While the gas giant’s surface texture will be generated in realtime using a pixel shader and a render-to-texture approach, moon texture will be created using Substance Designer. This allows for experimenting with various looks by simply changing the color palette and material seed.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/SubstanceWorkflow.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-252&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Substance Designer generated planets&quot;,&quot;alt&quot;:&quot;Substance Designer generated planets&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/SubstanceWorkflow-1024x576.jpg" alt="Substance Designer generated planets" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/SubstanceWorkflow-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/SubstanceWorkflow-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/SubstanceWorkflow-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/SubstanceWorkflow-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/SubstanceWorkflow-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Animated gas giant, while visually captivating, presents its own set of challenges. Rendering texture for each frame will impact performance, with the rendering cost quadrupling if the texture resolution is doubled.</p>







<p>I want one solution that works consistently, regardless of whether the input is a static texture created in Substance Designer or dynamically rendered in Unreal as described in <a href="https://emildziewanowski.com/flowfields/" data-type="post" data-id="119">Flowfields.</a></p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/GasGiantvsMoonTex-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-750&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Generated vs static textures&quot;,&quot;alt&quot;:&quot;Generated vs static textures&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/GasGiantvsMoonTex-1-1024x576.jpg" alt="Generated vs static textures" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/GasGiantvsMoonTex-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/GasGiantvsMoonTex-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/GasGiantvsMoonTex-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/GasGiantvsMoonTex-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/GasGiantvsMoonTex-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>This leaves 2 options for storing the planet surface – a square or rectangular texture. Although a cubemap was considered initially, its potential performance impact – consuming six times the resources of its square texture counterpart – makes it completely impractical. Furthermore, Substance Designer doesn’t support cubemap generation.</p>



<h2>UV Sphere Problems</h2>



<p>With texture choices narrowed down to square or rectangle, the next step is mapping them onto a sphere. The UV sphere is an obvious choice here, as it is easy to align its texture coordinates with the a 2×1 rectangular texture.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/UVSphere.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-640&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: UV sphere texture layout&quot;,&quot;alt&quot;:&quot;UV sphere texture layout&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/UVSphere-1024x576.jpg" alt="UV sphere texture layout" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/UVSphere-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/UVSphere-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/UVSphere-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/UVSphere-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/UVSphere-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p> Given that only one side of the sphere is visible at a time, there is no need to use a full, unique rectangular texture,  a tiling square one can be used instead.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/RectangularVsSquare.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-262&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Square vs Rectangular Texture&quot;,&quot;alt&quot;:&quot;Square vs Rectangular Texture&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/RectangularVsSquare-1024x576.jpg" alt="Square vs Rectangular Texture" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/RectangularVsSquare-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/RectangularVsSquare-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/RectangularVsSquare-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/RectangularVsSquare-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/RectangularVsSquare-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h3>Jagged Edges</h3>



<p>Using UV sphere might be the easiest option, but unfortunately in this case is not the best one. Firstly the outline is visibly angular – it doesn’t have to be a perfect circle, but at least should be smooth.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/JaggedEdges.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-264&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Polycount an jagged edges&quot;,&quot;alt&quot;:&quot;Polycount an jagged edges&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/JaggedEdges-1024x576.jpg" alt="Polycount an jagged edges" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/JaggedEdges-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/JaggedEdges-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/JaggedEdges-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/JaggedEdges-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/JaggedEdges-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>When triangle count is not an issue this problem can be solved by using a sphere with more subdivisions. Alternatively the edge can be masked using pixel shader.</p>



<h2>Texture Usage</h2>



<p>Most of the sphere’s surface is viewed at an angle, leading to sampling from lower mipmaps. This is particularly problematic for dynamic textures, where each pixel is rendered per frame. Most of the generated image gets wasted on areas where it is barely visible.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/InefficientTextureUsage-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-269&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Poor texture usage&quot;,&quot;alt&quot;:&quot;Poor texture usage&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/InefficientTextureUsage-1-1024x576.jpg" alt="Poor texture usage" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/InefficientTextureUsage-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/InefficientTextureUsage-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/InefficientTextureUsage-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/InefficientTextureUsage-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/InefficientTextureUsage-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p> While increasing tiling can mitigate this issue, it introduces another problem.</p>



<h3>Seams</h3>



<p>To maintain a continuous pattern across the whole sphere, the tiling can only be increased in whole numbers. However, even doubling the initial tiling makes the repetition noticeable. </p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/VisibleSeam-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-280&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Seam and tiling&quot;,&quot;alt&quot;:&quot;Seam and tiling&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/VisibleSeam-1-1024x576.jpg" alt="Seam and tiling" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/VisibleSeam-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/VisibleSeam-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/VisibleSeam-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/VisibleSeam-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/VisibleSeam-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Fractional values, on the other hand, create a seam running from the north to the south pole.</p>



<h3>Polar Distortion</h3>



<p>Another problem is texture pinching at the poles. Not only the pinching is visually jarring, mapping onto triangles generates additional distortion, similiar to PSX’s ‘floaty’ texturing. </p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/PolePinching-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-282&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: With and without polar patch&quot;,&quot;alt&quot;:&quot;With and without polar patch&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/PolePinching-1-1024x576.jpg" alt="With and without polar patch" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/PolePinching-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/PolePinching-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/PolePinching-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/PolePinching-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/PolePinching-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>A common workaround in game development has been to conceal these pinched areas with a textured patch.</p>



<h3>Atmosphere</h3>



<p>Finally, when considering the UV sphere for a planetary model, the inability to depict atmospheric halos becomes a limitation. Since mesh only allows surface drawing, an additional model is required for the halo, complicating the setup.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/HaloMeshes-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-278&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Ways of adding atmosphere&quot;,&quot;alt&quot;:&quot;Ways of adding atmosphere&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/HaloMeshes-1-1024x576.jpg" alt="Ways of adding atmosphere" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/HaloMeshes-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/HaloMeshes-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/HaloMeshes-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/HaloMeshes-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/HaloMeshes-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The UV sphere may seem as a feasible solution, but the laundry list of necessary modifications and creative hacks turns it into a Frankenstein’s monster. It is still used for modeling a planet, but for my application, the skybox, I was considering another option.</p>



<h2>Flat Disk</h2>



<p>Opting for an actual spherical mesh to represent the planet is primarily for the ease of texture mapping. In the case of a skybox, however, there’s no need for a complex 3D mesh – it will be observed from a distance and from one position. A basic disk will work just as good. The main issue, texture mapping, can be effectively managed through a pixel shader. This technique also has the added benefit of allowing the atmospheric halo to be drawn on the same mesh.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/FlatDiskVsSphere.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-285&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Using flat disk vs using 3D sphere&quot;,&quot;alt&quot;:&quot;Using flat disk vs using 3D sphere&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/FlatDiskVsSphere-1024x576.jpg" alt="Using flat disk vs using 3D sphere" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/FlatDiskVsSphere-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/FlatDiskVsSphere-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/FlatDiskVsSphere-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/FlatDiskVsSphere-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/FlatDiskVsSphere-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The disk mesh I’ll use is a straightforward filled circular polygon. The key feature to note is that its texture coordinates have their origin exactly at the center of the disk. If we assume that the planet has a radius of 1, then the UV coordinates have to extend beyond that to make some space for rendering the atmosphere.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/01\/PolygonalDiscCoords.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-204&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Flat disk UV coordinates&quot;,&quot;alt&quot;:&quot;Flat disk UV coordinates&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/01/PolygonalDiscCoords-1024x576.jpg" alt="Flat disk UV coordinates" srcset="https://emildziewanowski.com/wp-content/uploads/2024/01/PolygonalDiscCoords-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/01/PolygonalDiscCoords-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/01/PolygonalDiscCoords-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/01/PolygonalDiscCoords-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/01/PolygonalDiscCoords-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h2>Pixel Shader</h2>



<p>There are several features of the 3D UV Sphere mesh I want to recreate in the shader. Obviously, the shader version of a planet has to be visually indistinguishable from the mesh one. It also has to be free of all the problems of the mesh listed before. The shader creation process will be broken down to several steps.</p>



<ul>
<li>Surface Equation: Without the triangle mesh, the surface has to be defined in analytical terms.</li>



<li>Texture Mapping: UV coordinates have to be defined as a function of position on a sphere. This includes scaling and TBN calculation</li>



<li>Orientation: The shader must allow for the tilting of the planet’s axis.</li>



<li>Rotation: The planet should be able to spin around its axis.</li>
</ul>



<h2>Surface Equation</h2>



<p>One important note on coordinates: I’ll be using a left-handed, Y-up system, as it is most consistent with DirectX. I will also use the DirectX normal map format. While Unreal Engine also uses a left-handed system,  Z is the up-direction. It is a good practice to double- or triple-check orientations and the format of normal maps used.</p>



<p>The surface equation maps a 2D position on a disc plane to a corresponding 3D position on a spherical surface. In simpler terms – it is a function that draws a ball.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/SurfaceEquation.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-287&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Surface equation diagram&quot;,&quot;alt&quot;:&quot;Surface equation diagram&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/SurfaceEquation-1024x576.jpg" alt="Surface equation diagram" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/SurfaceEquation-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/SurfaceEquation-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/SurfaceEquation-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/SurfaceEquation-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/SurfaceEquation-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The first step is figuring out if the pixel lies on the surface of a sphere. To create a bounding circle mask, verify if the length of the UV vector is less than the sphere’s radius:</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/CircleMaskEquation-2.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-249&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Circle equation&quot;,&quot;alt&quot;:&quot;Circle equation&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/CircleMaskEquation-2-1024x576.jpg" alt="Circle equation" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/CircleMaskEquation-2-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/CircleMaskEquation-2-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/CircleMaskEquation-2-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/CircleMaskEquation-2-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/CircleMaskEquation-2-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<div><pre data-lang="HLSL"><code>float CircleMask( float2 uv, float radius)
{
    return length(uv) &lt; radius? 1.0: 0.0;
}</code></pre></div>



<p>It’s important to note that this approach will function correctly only when the UV coordinates are aligned with the center of the mesh.</p>



<p>Next step is to create surface vector – or the local position of the surface of the sphere. Luckily both x and y components of the UV coordinates are the same as the corresponding surface vector components. The only thing left to do is to reconstruct z component. </p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/ZComponentReconstruction-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-292&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Surface vector equation&quot;,&quot;alt&quot;:&quot;Surface vector equation&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/ZComponentReconstruction-1-1024x576.jpg" alt="Surface vector equation" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/ZComponentReconstruction-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/ZComponentReconstruction-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/ZComponentReconstruction-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/ZComponentReconstruction-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/ZComponentReconstruction-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<div><pre data-lang="HLSL"><code>float3 ReconstructSurface(float2 uv)
{
    float zSquared = 1.0 - dot(uv, uv);
    float z = sqrt(zSquared);
    return float3(uv, z);
}</code></pre></div>



<h2>Texture Mapping</h2>



<p>Mapping the square texture to spherical surface can be broken down to 3 operations:</p>



<ol>
<li>Wrapping around cylinder</li>



<li>Repeating the same for y axis</li>



<li>Deforming the result into a circle</li>
</ol>







<p>Process of wrapping might seem counterintuitive. The x coordinate of texture will be proportional to the angle the texture would wrap around the cylinder. To find this angle it is enough to calculate the arcsine(x). Then the angle has to be remapped from [-<strong>π</strong>, <strong>π </strong>] to [0, 1]. </p>



<p>To form a circle it is necessary to define the circular curve as a distance from y axis:</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/01\/HalfCircleEquation.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-224&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Generatrix equation&quot;,&quot;alt&quot;:&quot;Generatrix equation&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/01/HalfCircleEquation-1024x576.jpg" alt="Generatrix equation" srcset="https://emildziewanowski.com/wp-content/uploads/2024/01/HalfCircleEquation-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/01/HalfCircleEquation-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/01/HalfCircleEquation-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/01/HalfCircleEquation-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/01/HalfCircleEquation-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The ‘local width’ of the sphere, or the generatrix, is then used to pinch the coordinates at the poles. This is achieved by dividing the x-component of the surface position.</p>



<div><pre data-lang="HLSL"><code>float2 GenerateSphericalUV(float3 position)
{
    float width = sqrt(1.0 - position.y * position.y);
    float generatrixX = position.x / width * sign(position.z);
    float2 generatrix = float2(generatrixX, position.y);
    float2 uv = asin(generatrix) / 3.14159 + float2(0.5, 0.5);  
    return float2(uv);
}</code></pre></div>



<h2>Orientation</h2>



<p>To make the planet look more natural, we need to adjust the orientation of its axis, specifically the pitch and roll. Planets in the sci-fi art are usually tilted, as it creates more dynamic composition and allows to show ice capes on the poles.</p>



<p>The yaw, which corresponds to the planet’s spinning motion, will be dealt with in separate step to avoid the seam issue mentioned when discussing UV spheres.</p>







<p>In the conventional approach, a mesh sphere is typically reoriented or transformed using a matrix.  In our case, where each pixel defines the surface position, we can use a simplified 3⨯3 matrix limited to rotation – eliminating the need for a full set of transformations.</p>



<p>Building such a matrix is pretty straightforward. Identify the ‘right,’ ‘up,’ and ‘forward’ vectors of the rotated sphere and organize them as columns in the matrix.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/01\/BuildingRotationMatrix.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-206&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Rotation matrix&quot;,&quot;alt&quot;:&quot;Rotation matrix&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/01/BuildingRotationMatrix-1024x576.jpg" alt="Rotation matrix" srcset="https://emildziewanowski.com/wp-content/uploads/2024/01/BuildingRotationMatrix-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/01/BuildingRotationMatrix-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/01/BuildingRotationMatrix-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/01/BuildingRotationMatrix-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/01/BuildingRotationMatrix-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Material editor doesn’t support matrices as a data format, but Unreal offers a walk-around:</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/UnrealMatrixBasis.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-238&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Rotation matrix in Unreal material graph&quot;,&quot;alt&quot;:&quot;Rotation matrix in Unreal material graph&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/UnrealMatrixBasis-1024x576.jpg" alt="Rotation matrix in Unreal material graph" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/UnrealMatrixBasis-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/UnrealMatrixBasis-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/UnrealMatrixBasis-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/UnrealMatrixBasis-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/UnrealMatrixBasis-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>When the rotations are limited to just pitch and roll the matrix looks like this:</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/PitchRollMatrix.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-236&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Rotation matrix for pitch and roll&quot;,&quot;alt&quot;:&quot;Rotation matrix for pitch and roll&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/PitchRollMatrix-1024x576.jpg" alt="Rotation matrix for pitch and roll" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/PitchRollMatrix-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/PitchRollMatrix-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/PitchRollMatrix-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/PitchRollMatrix-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/PitchRollMatrix-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/RotationMatrixUnreal-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-231&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Pitch and roll matrix in Unreal material graph&quot;,&quot;alt&quot;:&quot;Pitch and roll matrix in Unreal material graph&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/RotationMatrixUnreal-1-1024x576.jpg" alt="Pitch and roll matrix in Unreal material graph" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/RotationMatrixUnreal-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/RotationMatrixUnreal-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/RotationMatrixUnreal-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/RotationMatrixUnreal-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/RotationMatrixUnreal-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>In HLSL 3⨯3 matrix can be represented using float3x3:</p>



<div><pre data-lang="HLSL"><code>float3x3 CreateRotationMatrix(float pitch, float roll) {
    float cosPitch = cos(pitch);
    float sinPitch = sin(pitch);
    float cosRoll = cos(roll);
    float sinRoll = sin(roll);

    return (float3x3)(
        cosRoll, -sinRoll * cosPitch, sinRoll * sinPitch,
        sinRoll, cosRoll * cosPitch, -cosRoll * sinPitch,
        0.0, sinPitch, cosPitch
    );
}</code></pre></div>



<h2>Scale</h2>







<p>Before adding the spinning motion, there is one problem that needs to be adressed – uv seams. Right now the texture is mapped in such a way, that the seams are aligned with the edges of the texture, and thus invisible. But if we change the scale, the discontinuity becomes obvious. It is not a problem that can be easily solved, but it can be partially masked by moving to the backside. This requires changes in mapping function:</p>



<div><pre data-lang="HLSL"><code>float2 GenerateSphericalUV(float3 position, float scale)
{
    float width = sqrt(1.0 - position.y * position.y);
    float generatrixX = position.x / width * sign(position.z);
    float2 generatrix = float2(generatrixX, position.y);
    float2 uv = asin(generatrix) / 3.14159 + float2(0.5, 0.5);  
    return float2(uv);
}</code></pre></div>



<h2>Rotation</h2>



<p>With all the prerequisites in place, adding the spinning is straightforward, even if counterintuitive. To keep the seam in well masked position, we will not rotater sphere’s surface, but pan the surface texture along x axis. </p>



<div><pre data-lang="HLSL"><code>float2 GenerateSphericalUV(float3 position, float scale, float spin)
{
    float width = sqrt(1.0 - position.y * position.y);
    float generatrixX = position.x / width * sign(position.z);
    float2 generatrix = float2(generatrixX, position.y);
    float2 uv = asin(generatrix) / 3.14159 + float2(0.5, 0.5);  
    return float2(uv);
}</code></pre></div>



<div><pre data-lang="HLSL" data-start="6"><code>float2 sphericalVU = GenerateSphericalUV(position, scale, time*speed)</code></pre></div>







<h2>Shading</h2>



<p>For the ball to appear truly round, shading is crucial. Typically, it would be handled by the engine, but in the case of a planet, it is not that easy. A planet consists of two distinctive layers – the surface and the atmosphere. Typical materials describe only one medium. Therefore, we have to define how both layers are lit and blend them together manually.</p>



<h3>Normal</h3>



<p>Regardless of the chosen shading model, surface normal must be provided. Fortunately it is already there – surface position, before rotation, in case where radius is 1 is equal to surface normal. It is enough to perform basic shading.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/02\/PositionToNormal.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-298&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Normal and surface vector similiarity&quot;,&quot;alt&quot;:&quot;Normal and surface vector similiarity&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/02/PositionToNormal-1024x576.jpg" alt="Normal and surface vector similiarity" srcset="https://emildziewanowski.com/wp-content/uploads/2024/02/PositionToNormal-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/02/PositionToNormal-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/02/PositionToNormal-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/02/PositionToNormal-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/02/PositionToNormal-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<h3>Light</h3>



<p>I want to replicate the aesthetics of sci-fi book covers, with a stylized version inspired by NASA photos. Realism isn’t my primary concern. I’ll be using the simplest Lambertian model, where the light is equal to the dot product of the surface normal and light vector.</p>



<div><pre data-lang="HLSL"><code>float LambertianLight(float3 normal, float3 lightDirection) {
    float NdotL = max(dot(normal, lightDirection), 0.0);
    return NdotL;
}</code></pre></div>







<h3>Bump Mapping</h3>



<p>A simple normal might suffice for cases where the planet appears smooth, such as gas giants. However, planets with rocky surfaces are often covered with geological formations like mountains, ridges, or craters. These are best simulated using normal maps.</p>



<p>To use normal maps, we require a complete set of vectors: Tangent, Bitangent, and Normal. This set comprises three unit vectors perpendicular to each other and aligned to UV mapping. These vectors can be thought of as ‘UV Local Space’.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/TBNExplained-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-669&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: TBN set in general case&quot;,&quot;alt&quot;:&quot;TBN set in general case&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="http://emildziewanowski.com/wp-content/uploads/2024/03/TBNExplained-1-1024x576.jpg" alt="TBN set in general case" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/TBNExplained-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/TBNExplained-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/TBNExplained-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/TBNExplained-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/TBNExplained-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>In the case of a sphere, calculations need to be done per pixel. It’s often convenient to store these calculations as columns of the TBN matrix. This matrix can then be used to recalculate the normal from the normal map into World Space Coordinates.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/SphereTBN-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-672&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: TBN set for sphere&quot;,&quot;alt&quot;:&quot;TBN set for sphere&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/SphereTBN-1-1024x576.jpg" alt="TBN set for sphere" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/SphereTBN-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/SphereTBN-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/SphereTBN-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/SphereTBN-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/SphereTBN-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Shaded surface and the corresponding normalmap:</p>







<h2>UV Discontinuities</h2>



<p>When discussing the generation of UV coordinates in the pixel shader, one critical topic to address is discontinuities. Take, for instance, the case of the back seam – the horizontal component of the UV should wrap perfectly as it is equal to 0.0 and 1.0 on the borders. However, instead of a seamless transition, there is a line of blocky artifacts along the seam.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/DDXDiscontinuity.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-676&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Source of ddx seam&quot;,&quot;alt&quot;:&quot;Source of ddx seam&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/DDXDiscontinuity-1024x576.jpg" alt="Source of ddx seam" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/DDXDiscontinuity-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXDiscontinuity-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXDiscontinuity-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXDiscontinuity-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXDiscontinuity-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>This line corresponds to the DDX of the UV. DDX and DDY, in this case, measure the rate of change of UV in the respective screen space axes. They are then fed into the texture sampler and used to determine which mipmap to use. Low values of UV derivative correspond to a high-resolution mipmap, and vice versa.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/DDXExplained.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-679&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: DDX and DDY explained&quot;,&quot;alt&quot;:&quot;DDX and DDY explained&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/DDXExplained-1024x576.jpg" alt="DDX and DDY explained" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/DDXExplained-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXExplained-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXExplained-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXExplained-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXExplained-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>There’s a ‘jump’ in values between the left and right sides of the seam, causing the DDX to be high. Consequently, the texture is sampled from the lowest mipmap, resulting in the gray color.</p>



<p>In the case of a planet, it won’t be a significant issue, as it will be covered with a polar patch anyway. However, in other visually jarring scenarios, the DDX and DDY of the seam have to be manually corrected and fed into the sampler.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/DDXSampling.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-684&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Fix for ddx and ddy seam in Unreal material graph&quot;,&quot;alt&quot;:&quot;Fix for ddx and ddy seam in Unreal material graph&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/DDXSampling-1024x576.jpg" alt="Fix for ddx and ddy seam in Unreal material graph" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/DDXSampling-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXSampling-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXSampling-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXSampling-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/DDXSampling-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The presented ‘fix’ is merely for illustrative purposes. Typically, formulas for proper values of DDX and DDY have to be derived manually to match the mapping accurately.</p>



<h2>Polar Patches</h2>



<p>Last problem that needs adressing is the distortion on the poles. As mentioned before – the tried and tested solution is to just cover them. Seems like a hack, but in the case of a planet or a moon makes a lot of sense. Polar areas are often covered with ice, and visually distinct from the rest of the planet, so having a patch of different texture not only hides the prolem but also add visual interest.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/MarsIceCap.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-681&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Photo of ice cap on Mars&quot;,&quot;alt&quot;:&quot;Photo of ice cap on Mars&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/MarsIceCap-1024x576.jpg" alt="Photo of ice cap on Mars" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/MarsIceCap-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/MarsIceCap-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/MarsIceCap-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/MarsIceCap-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/MarsIceCap-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Easiest way to add polar patch wolud be to map it in the plane perpendicular to the axis of rotation and rotate resulting coordinates:</p>



<div><pre data-lang="HLSL"><code>float2 PolarPatchMapping(float3 position, float scale, float spin)
{
    float width = sqrt(1.0 - position.y * position.y);
    float generatrixX = position.x / width * sign(position.z);
    float2 generatrix = float2(generatrixX, position.y);
    float2 uv = asin(generatrix) / 3.14159 + float2(0.5, 0.5);  
    return float2(uv);
}</code></pre></div>







<h2>Atmosphere</h2>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/EarthAtmosphereISS.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-688&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Photo of Earth\u0027s atmosphere taken from ISS&quot;,&quot;alt&quot;:&quot;Photo of Earth\u0027s atmosphere taken from ISS&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/EarthAtmosphereISS-1024x576.jpg" alt="Photo of Earth's atmosphere taken from ISS" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/EarthAtmosphereISS-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/EarthAtmosphereISS-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/EarthAtmosphereISS-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/EarthAtmosphereISS-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/EarthAtmosphereISS-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Planet’s surface doesn’t occupy the entire area of the disk, leaving enough space to draw the atmospheric halo. Drawn with the same shader, it can be seamlessly merged with the atmosphere drawn over the planet.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/SurfaceAndAtmosphere.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-704&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Surface and atmosphere on flat disc&quot;,&quot;alt&quot;:&quot;Surface and atmosphere on flat disc&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/SurfaceAndAtmosphere-1024x576.jpg" alt="Surface and atmosphere on flat disc" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/SurfaceAndAtmosphere-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/SurfaceAndAtmosphere-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/SurfaceAndAtmosphere-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/SurfaceAndAtmosphere-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/SurfaceAndAtmosphere-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>There are countless whitepapers discussing atmosphere rendering. Most are <a href="https://en.wikipedia.org/wiki/Rayleigh_scattering">physically based</a> and rely on raymarching to deliver the most realistic image possible. I will use none of them. There is a nice trick from Quake I want to try.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/Quake2MonsterLighting-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-689&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Quake 2 screenshot&quot;,&quot;alt&quot;:&quot;Quake 2 screenshot&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2MonsterLighting-1-1024x576.jpg" alt="Quake 2 screenshot" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2MonsterLighting-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2MonsterLighting-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2MonsterLighting-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2MonsterLighting-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2MonsterLighting-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>In both Quake 1 and 2, lighting was achieved using mostly lightmaps, a technique popular at the time and still used until recently for static light scenarios. In this approach, computationally expensive lighting calculations are precomputed during development and stored as a separate texture covering all surfaces in the level.</p>



<p>However, since lightmaps only work for static lighting, idSoftware had to devise a solution for dynamic objects like monsters. They sampled the lightmap below the dynamic object and used it to modulate the color of the object. While this technique wasn’t physically accurate, it was good enough to make the monster blend with its surroundings.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/Quake2LightmapSampling-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-731&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Quake2 character light&quot;,&quot;alt&quot;:&quot;Quake2 character light&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2LightmapSampling-1-1024x576.jpg" alt="Quake2 character light" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2LightmapSampling-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2LightmapSampling-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2LightmapSampling-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2LightmapSampling-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/Quake2LightmapSampling-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>In a similar manner, I’ll use the planet’s surface to approximate the lighting of the atmospheric halo. It is enough to extend the surface normal before bump mapping to calculate the halo’s brightness.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/AtmosphericNormalAndLight.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-711&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Extended surface normal and light&quot;,&quot;alt&quot;:&quot;Extended surface normal and light&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphericNormalAndLight-1024x576.jpg" alt="Extended surface normal and light" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphericNormalAndLight-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphericNormalAndLight-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphericNormalAndLight-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphericNormalAndLight-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphericNormalAndLight-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>To further enhance the effect, the brightness of each channel can be remapped differently. This is a simple yet effective method for simulating the absorption of different light wavelengths.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/MappedLambertLighting-1.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-717&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Remapped light color components&quot;,&quot;alt&quot;:&quot;Remapped light color components&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/MappedLambertLighting-1-1024x576.jpg" alt="Remapped light color components" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/MappedLambertLighting-1-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/MappedLambertLighting-1-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/MappedLambertLighting-1-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/MappedLambertLighting-1-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/MappedLambertLighting-1-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The visibility of the atmosphere is more pronounced at oblique angles. This effect can be replicated by remapping the Z component of the surface normal. Additionally, to recreate the halo’s fading effect, the distance from the sphere’s surface must be calculated.</p>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/AtmosphereOpacity.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-721&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Light opacity components&quot;,&quot;alt&quot;:&quot;Light opacity components&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphereOpacity-1024x576.jpg" alt="Light opacity components" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphereOpacity-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphereOpacity-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphereOpacity-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphereOpacity-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/AtmosphereOpacity-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Finally, both the surface and atmosphere need to be alpha-blended together.</p>







<h2>Conclusions</h2>



<figure data-wp-context="{&quot;uploadedSrc&quot;:&quot;https:\/\/emildziewanowski.com\/wp-content\/uploads\/2024\/03\/CompletePlanetMaterialGraph.jpg&quot;,&quot;figureClassNames&quot;:&quot;wp-block-image size-large&quot;,&quot;figureStyles&quot;:null,&quot;imgClassNames&quot;:&quot;wp-image-785&quot;,&quot;imgStyles&quot;:null,&quot;targetWidth&quot;:2560,&quot;targetHeight&quot;:1440,&quot;scaleAttr&quot;:false,&quot;ariaLabel&quot;:&quot;Enlarge image: Full Unreal material graph&quot;,&quot;alt&quot;:&quot;Full Unreal material graph&quot;}" data-wp-interactive="core/image"><img loading="lazy" decoding="async" width="1024" height="576" data-wp-init="callbacks.setButtonStyles" data-wp-on--click="actions.showLightbox" data-wp-on--load="callbacks.setButtonStyles" data-wp-on-window--resize="callbacks.setButtonStyles" src="https://emildziewanowski.com/wp-content/uploads/2024/03/CompletePlanetMaterialGraph-1024x576.jpg" alt="Full Unreal material graph" srcset="https://emildziewanowski.com/wp-content/uploads/2024/03/CompletePlanetMaterialGraph-1024x576.jpg 1024w, https://emildziewanowski.com/wp-content/uploads/2024/03/CompletePlanetMaterialGraph-300x169.jpg 300w, https://emildziewanowski.com/wp-content/uploads/2024/03/CompletePlanetMaterialGraph-768x432.jpg 768w, https://emildziewanowski.com/wp-content/uploads/2024/03/CompletePlanetMaterialGraph-1536x864.jpg 1536w, https://emildziewanowski.com/wp-content/uploads/2024/03/CompletePlanetMaterialGraph-2048x1152.jpg 2048w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Although it took more steps than anticipated, the result works great. The planet is a perfect sphere, and the mapping allows for all the texture and shader manipulations I wanted. I can create a single Substance Designer graph generating surface texture, and the result doesn’t require any further post-processing. The same goes for animated texture – I can use a smaller size and thus save performance, then adjust the tiling as needed.</p>



<figure><p>
<iframe loading="lazy" title="Flat Planet Shader" width="500" height="281" src="https://www.youtube.com/embed/gbzJpvsuzfc?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>
</p></figure>
                        </div>
                    </article>
                        </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Don't be terrified of Pale Fire (165 pts)]]></title>
            <link>https://unherd.com/2024/05/dont-be-terrified-of-pale-fire/</link>
            <guid>40571402</guid>
            <pubDate>Tue, 04 Jun 2024 06:48:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://unherd.com/2024/05/dont-be-terrified-of-pale-fire/">https://unherd.com/2024/05/dont-be-terrified-of-pale-fire/</a>, See on <a href="https://news.ycombinator.com/item?id=40571402">Hacker News</a></p>
<div id="readability-page-1" class="page"><div> <div> <p>Nabokov in 1959. (Hulton-Deutsch Collection/CORBIS/Corbis via Getty Images)</p>  </div> <div> <hr> <p><a href="https://unherd.com/author/mary-gaitskill/"><img data-del="avatar" height="70" width="70" nitro-lazy-src="https://cdn-ilaccph.nitrocdn.com/LLdtxDykcbTCtkVQaULRliAzilbccaov/assets/images/optimized/rev-b9e0517/unherd.com/wp-content/uploads/2022/06/lady-16-jun-100x100.jpg" decoding="async" nitro-lazy-empty="" id="MTE2NjoyODM=-1" src="https://cdn-ilaccph.nitrocdn.com/LLdtxDykcbTCtkVQaULRliAzilbccaov/assets/images/optimized/rev-b9e0517/unherd.com/wp-content/uploads/2022/06/lady-16-jun-100x100.jpg"></a></p> <hr> <div> <p><em>Pale Fire</em> is one of the greatest books I’ve ever read. It is so great it is terrifying to write about. This is not something I would normally confess, but in this case it seems better to just come out and say it, lest the reader feel the awful stammering of suppressed terror quavering through my words without knowing what they are feeling. It is terrifying! But I want to do it anyway, because although mighty brains from all over the planet have weighed in on the subject with breath-taking and exhaustive scholarly ardour, I feel that something essential about the book remains not exactly unseen but distinctly understated.</p> <p>Since its publication in 1962, people who admire <em>Pale Fire </em>— fawn upon it, adore it — like to speak of it as a feat of baroque intellectual magic, which it is. In her <em>New Republic</em> review, Mary McCarthy described it as “Faberge gem, a clockwork toy, a chess problem, an infernal machine, a trap to catch reviewers, a cat-and-mouse game, and do-it-yourself novel”, among other things. Brian Boyd, in his book <em>Nabokov’s Pale Fire: The Magic of Artistic Discovery, </em>writes densely and ecstatically about the novel as a near-endless array of ever-deepening “problems and possibilities”, an intellectual delight to explore; Ron Rosenbaum (in <em>The Observer</em>, circa 1999) declared the book “The Novel of the Century” based on the idea that it is a “theology of Shakespeare”, haunted by Shakespeare, housing Shakespeare, that it is, basically, a Shakespeare phantasmagoria. (Rosenbaum also acknowledges that the book is “an almost obscenely sensual pleasure”, but that is an aside.)</p> <p>The book has also been criticised for this very virtuosity, even dismissed by those who interpret the book’s brilliance as cold, wilfully weird or even hostile towards the reader. These opposing critical opinions are sincerely echoed by readers of all kinds, sometimes simultaneously. A friend of mine described his amazed delight in the book as something he might feel “if a winged griffin had landed on [his] lawn”, awed, but not moved emotionally — and secretly suspecting that the author might consider him a sucker if he <em>were </em>moved. An academic acquaintance who generally loves Nabokov considers it his least wonderful book, flawed by excessive cleverness, compulsive literary cross-referencing and the homophobic portrayal of its ridiculous and bitchy queer narrator, Charles Kinbote.</p> <p>It is true that Kinbote’s queerness is unflattering. (It is also not quite convincing; there is more narrative energy lavished on his dramatic woman-spurning than on his conquests of — or rejection by — men and boys.) Indeed, the generic condemnation “problematic” more than applies to the character Kinbote, a comically unpleasant personality who has been morally condemned or pitied by readers since his creation.</p></div></div>    <div>  <p>He appears on page one of the novel to explain that he is the editor of a poem titled <em>Pale Fire, </em>authored by his neighbour, friend and academic colleague, Professor John Shade, who has been recently murdered in error by an incompetent foreign agent dispatched to kill Kinbote. Kinbote, you see, is not your average college professor; that role is a disguise to hide his true identity as the fugitive King of Zembla, where he reigned as Charles the Beloved until an annoying crew of Soviet-style revolutionaries turned his beautiful world upside-down. Thus forced to take a drab teaching position at Wordsmith College in Wye, Appalachia, subletting the furnished home of a local judge (full of family pictures so distasteful to His Majesty that they are quickly consigned to the closet), Kinbote’s only consolation is his proximity to Shade who he truly admires — so much that he stalks Shade’s house to spy on him.</p> <p>Whether or not Kinbote is completely crazy is a question throughout the book — indeed his very identity is a question. From my point of view, he is just <em>somewhat crazy</em> and a lot desperate and has certainly taken advantage of Shade’s distraught widow in order to seize control of the poem so that he may explain to the world that it really is or at least <em>ought to have been </em>about him and his camouflaged royalty. After his fevered introduction, written from a cheap and desolate mountain hideaway, he presents the poem, 36 pages of wry, elegiac perhaps rather staid beauty. This is followed by 228 pages of Kinbote’s wildly self-centred commentary — even the suicide of John Shade’s daughter, poor homely Hazel, with whom Kinbote feels more empathic identification than anyone else, is seen through the fanatically minute lens of His Majesty’s Zemblan concerns. And then there is the almost mystically Kinbotian index, in which detailed notes are supplied for characters barely mentioned and it is revealed that the Zemblan assassin’s name spelled backwards is the name of a “mirror-maker of genius”.</p> <p>For all his fantastic humour, Kinbote seems the unintentional butt of his own jokes, the ultimate “unreliable narrator”, meant to be pitied or contrasted unfavourably with the imminently normal Shade. And yet… he reminds me of a line from Nabokov’s short story <em>Spring In Fialta </em>in which the narrator describes a circus poster “which depicted a red hussar and an orange tiger of sorts; curious — in his effort to make the beast as ferocious as possible, the artist had gone so far that he had come back from the other side, for the tiger’s face looked positively human”. If you replace the word “ferocious” with “grotesque” the tiger could be Kinbote.</p>  <p>Almost on introducing himself to us, at the beginning of his forward to Shade’s poem, Kinbote interrupts his faux scholarly description of the work with the non-sequitur, “There is a very loud amusement park right in front of my present lodgings”, before picking up right where he left off. It is one of a few small but telling oddities that made Brian Boyd<em>, </em>rhetorically remark: “What sort of person <em>is </em>this commentator?” I might answer, using a word that Nabokov would’ve hated and which I sort of hate too: a very relatable one. Someone who possesses a contemporary sensibility that feels free mixing a subjectively personal aside into what is supposed to be a scrupulous public presentation; someone who hates being pestered by loud noise when he is trying to think; someone so given to incongruous blurtings that he can be trusted to tell you the truth about himself even when he is lying.</p></div></div><div>  <p>It sounds complicated because it is. And I haven’t even mentioned the book’s most complicated aspect: the layers of patterns, linkages and intricate structure that give <em>Pale Fire</em> a kind of supernatural depth. The supernatural is literally a theme in the book, in the form of attempted communication between the living and the dead in weird partial words tapped out by a maybe spirit and flickering lights that show up in an Appalachian barn and are then incongruously refrained in the Zemblan tunnel King Charles traverses with one of his young loves. The colours red and green act in opposition/connection with characters and doors that link disparate times and places and the number eight; minor characters are doubled with Zemblan and Appalachian incarnations through similar names and attributes; the hiding place of the Crown Jewels is doubled as are the actual jewels; butterfly imagery links Hazel Shade, her mother Sybil and King Charles’s unwanted queen Disa — who is also linked with Hazel in a triple iteration of rejected girls.</p> <p>Dates and letters also join the fun! Kinbote, John Shade and Shade’s killer all have the same birthday; Shade is killed on the day that Nabokov’s father was born and Nabokov’s father was killed by a gunman aiming to kill someone else. The family pictures that Kinbote furiously stuffs into the closet of his sublet home are all of girls named in alphabetical order — an order reversed in the names of King Charles’s possibly invented royal family. And throughout, poets and poetry star the skies of Zembla and Appalachia alike: direct and subtle references to Browning, Shakespeare, Eliot and Goethe shine piercingly or dimly in the most quotidian and/or dramatic scenes, sometimes ostentatiously quoted, sometimes so simply and quietly <em>there</em> that only a scholar would notice.</p> <p>Only a scholar would notice most of these (and I haven’t even noted all of it), at least on the first reading; while I was aware of some of this layered patterning (the repetitive tropes of butterflies, dancing lights, opposing colours and rejected girls for example are hard to miss), I discovered most of what I’ve summarised above through critics, particularly Brian Boyd who’s book I love and recommend. Indeed the novel’s complexity has ironically unleashed armies of Kinbotes, devoting themselves to decades-long online arguments about whether or not the character John Shade invented Kinbote and faked his own death or if the reverse is true, that Kinbote actually invented Shade and wrote the poem attributed to him or — but wait! — that actually the deceased Hazel Shade spiritually transmitted the delusion of Zembla into Kinbote’s tortured mind so that he could tell her father about it and also to comfort Kinbote himself and further to create a more beautiful version of her own lonely life in his fantasy.</p> <p>“Indeed the novel’s complexity has ironically unleashed armies of Kinbotes, devoting themselves to decades-long online arguments…”</p> <p>To refrain McCarthy: “a clockwork toy, a chess problem, an infernal machine, <em>a trap to catch reviewers</em>…” Except that in the context of this fantastic novel, the critic’s theories are not as crazy as they appear on paper. I don’t find McCarthy’s words entirely right; the book is more like its own living universe than anything mechanical, and in such a world (as in ours) many strange things can happen. It is designed yes, but not to trap. It matters because I think this chess game emphasis has contributed to the popular perception of the book as steroidally brainy but emotionally cold. Critics haven’t exactly ignored the book’s touching aspects: the death of Hazel Shade and her parent’s grief are given their due as is the theme of mortality and the moving beauty of the natural world. (Though I agree with Michael Wood, in his essay <em>The Demons of Our Pity, </em>that there is something oddly shallow about the emotion towards Hazel in Shade’s poem, not to mention an unpleasant fixation on her homeliness.) But those emotional elements tend to get lost in the critical excitement about traps and problems and creates the impression that in order to enjoy <em>Pale Fire </em>you need not merely an intelligent mind but a <em>very particular type </em>of intelligent mind, preferably one outfitted with a first-class education.</p> <p>But. When I first read the book I was an ignorant 24-year-old with a barely adequate undergraduate education. Because I had not majored in English (I was concerned about what kind of job I might get after graduating and an English degree did not look promising), I had not taken many literature courses. I had read very little poetry and almost no Shakespeare. I recognised the names of the poets mentioned in <em>Pale Fire </em>but I could not possibly register the more subtle meanings evoked by the adjacent language because I didn’t know their work in any depth or really at all. That didn’t matter. I loved <em>Pale Fire. </em>I could feel its intellectual power in the intense perceptual contrasts of its characters, in the descriptions of faces and objects and, for example, the swift evocation of an alternate world in John Shade’s image of himself reflected in the window glass, “above the grass” with his furniture and an apple on a plate. I could feel it in the patterning I saw and sensed, viscerally, as if I was not only seeing a griffin landing before me but feeling the vibration of its wings come up through the ground into the soles of my feet.</p> <p>“I could feel its intellectual power in the intense perceptual contrasts of its characters.”</p> <p>But it wasn’t primarily the intellectual power that drew me in. I experienced <em>Pale Fire </em>far more emotionally than intellectually. I felt the emotion of longing saturating the story, the depth of Kinbote’s loneliness, the cruelty visited on Hazel and the bewilderment of her father at having lost her; I felt Kinbote’s anguish in his affected, light and giddy voice, and in the way those naturally polarised tones were electrically joined in the fast-moving comedy. (If you have read <em>Lolita, </em>it is a voice reminiscent of Humbert sans Dolores on a drunken drive with drunken Rita on the perpetual road to Grainball: the voice of someone broken and desperate yet mentally agile enough to bob and weave under a rain of blows, real and imagined; someone too broken and desperate to fully dissemble). The actual prose was, as Ron Rosenbaum noted, a great sensual pleasure. Then, about 200 pages in, the experience intensified when I came to this description of a secondary character, Queen Disa, the woman Kinbote/Charles indifferently marries because marry he must:</p></div><div>  <p><em>‘What had the sentiments he entertained in regard to Disa ever amounted to? Friendly indifference and bleak respect. Not even in the first bloom of their marriage had he felt any tenderness or any excitement. Of pity, of heartache, there could be no question. He was, had always been, casual and heartless. But the heart of his dreaming self, both before and after the rupture, made extraordinary amends.”</em></p> <p>This is a narrative depth change, with no lightness or giddiness or humour. I sometimes read this section to students as an example of how a narrative can be indirectly and deeply illuminated through minor characters or descriptive asides, and no matter who they are, grad students or sophomores taking the class to fulfil a Lit major, I can feel their attention come into focus from the first two lines. Even with minimal information about who the speaker or the woman he is speaking of might be, almost any nominal adult, no matter how inexperienced, can recognise the emotional reality of those sentences that open the soliloquy.</p> <p><em>“He dreamed of her more often, and with incomparably more poignancy, than his surface-life feelings for her warranted; these dreams occurred when he least thought of her, and worries in no way connected with her assumed her image in the subliminal world as a battle or a reform becomes a bird of wonder in a tale for children. These heart-rending dreams transformed the drab prose of his feelings for her into strong and strange poetry, subsiding undulations of which would flash and disturb him throughout the day, bringing back the pang and the richness — and then only the pang, and then only its glancing reflection — but not at all affecting his attitude towards the real Disa.”</em></p> <p>Here, words create images to describe something that happens wordlessly, physically but subtly, in the inchoate realm of feeling. The words “subsiding undulations” which “flash” and then gradually fade (as a wave returns and fades) describe the movement of intimate emotion, the way people repeatedly draw near one another and then move away, sometimes simultaneously, in different aspects. The words also describe the bodily experience of strong feeling in a single person, rising up and then subsiding, either becoming greater or — as it is here — fading completely but for a troubling echo that lingers so faintly you can’t tell where it’s coming from. It is something almost impossible to talk about let alone write about but which almost everyone experiences. Using words to describe what is experienced wordlessly is art on a high level, at least as impressive and more affecting than even the most intricate structuring.</p> <p><em>“Her image, as she entered and re-entered his sleep rising apprehensively from a distant sofa or going in search of the messenger who, they said, had just passed through the draperies, took into account changes of fashion; but the Disa wearing the dress he had seen on her the summer of the Glass Works explosion, or last Sunday, or in any other antechamber of time, forever remained exactly as she looked on the day he had first told her he did not love her. That happened during a hopeless trip to Italy, in a lakeside hotel garden — roses, black araucarias, rusty, greenish hydrangeas — one cloudless evening with the mountains of the far shore swimming in a sunset haze and the lake all peach syrup regularly rippled with pale blue, and the captions of a newspaper spread flat on the foul bottom near the stone bank perfectly readable through the shallow diaphanous filth, and because, upon hearing him out, she sank down on the lawn in an impossible posture, examining a grass culm and frowning, he had taken his words back at once; but the shock had fatally starred the mirror, and thenceforth in his dreams her image was infected with the memory of that confession as with some disease or the secret aftereffects of a surgical operation too intimate to be mentioned.”</em></p> <p>The pain of unrequited love, both for the lover and the loved one who cannot return the feeling, is an obvious subject of the book as is the longing for an ideal which bleeds up through mundane reality, “the shallow diaphanous filth” vs. the fantastic colours, the dream which might be delusional or might actually be more real than acted-out life; the imagery is in effect a crumbling bridge between the two. It is in this passage that I see what I called the understated “essential something” about the book: how this elemental and raw experience is evoked as closely as possible to how it is felt, through the textures of the natural world that exist as the body exists, humbly and unknowably: plants, mountains, water, sky, light, the amazement of colours.</p>  <p><em>“The gist, rather than the actual plot of the dream, was a constant refutation of his not loving her. His dream-love for her exceeded in emotional tone, in spiritual passion and depth, anything he had experienced in his surface existence. This love was like an endless wringing of hands, like a blundering of the soul through an infinite maze of hopelessness and remorse. They were, in a sense, amorous dreams, for they were permeated with tenderness, with a longing to sink his head onto her lap and sob away the monstrous past. They brimmed with the awful awareness of her being so young and so helpless. They were purer than his life. What carnal aura there was in them came not from her but from those with whom he betrayed her… and even so the sexual scum remained somewhere far above the sunken treasure and was quite unimportant.”</em></p> <p><em>A blundering of the soul through an infinite maze of hopelessness and remorse. </em>This secondary character may be, as some critics say, a figment of Kinbote’s narcissistic imagination; she may be an alt-world creation of the deceased Hazel Shade. But whatever she is, the complex of emotions embodied in and provoked by her are real in any existing human world, as deep and for me more riveting than any problem posed anywhere else in the book. It is the mystery of human feeling/lack of feeling, the need for love and the fear of it, part of what Kinbote calls “the prison of personality” and it is not going to be solved. But here at least it is seen profoundly, with the compassionate wisdom that is the real “Crown Jewels” of <em>Pale Fire, </em>hidden in a description of an incidental relationship.</p> <p>Of course, there are other jewels hidden elsewhere in the book, more than might be addressed within the scope of this essay. Brian Boyd quotes Nabokov remarking in relation to <em>Pale Fire </em>that: “You can get nearer and nearer, so to speak, to reality; but you can never get near enough because reality is an infinite succession of steps, levels of perception, false bottoms and hence unquenchable, unattainable.” The novel is a joyful and reverent mimic of such reality — and yet it invites readers and critics to come close, to find the unattainable, and so, with great gusto, they try. And I am glad that they do, even if it sometimes looks a bit like blundering through an infinite maze of some sort. I am especially glad for Brian Boyd and Michael Wood; over time, reading and learning from their intrepid analyses has deepened my understanding and respect for the book. But I still remember, as something rare and unrepeatable, the power of my first reading when I had so little knowledge and yet felt the brilliance and depth of <em>Pale Fire </em>almost as if through my skin. If reading this is your first experience of the book, that is what I hope for you: that you acquire a copy and see the griffin come in for a landing. If you worry that it is looking down on you, don’t. Because all you have to do is look up. Its heart is strange but it is huge; let yours beat in response.</p> <p><strong>***</strong></p> <p><em>Pale Fire, with an introduction by Mary Gaitskill, is <a href="https://www.amazon.co.uk/Pale-Fire-W-N-Essentials/dp/1474620876" target="_blank" rel="noopener">published by Weidenfeld &amp; Nicolson</a>.</em></p>   <hr>   </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[I Am So Sick of Leetcode-Style Interviews (426 pts)]]></title>
            <link>https://nelson.cloud/i-am-so-sick-of-leetcode-style-interviews/</link>
            <guid>40571395</guid>
            <pubDate>Tue, 04 Jun 2024 06:47:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://nelson.cloud/i-am-so-sick-of-leetcode-style-interviews/">https://nelson.cloud/i-am-so-sick-of-leetcode-style-interviews/</a>, See on <a href="https://news.ycombinator.com/item?id=40571395">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div><p>I quit my previous job at <a href="https://robinhood.com/?ref=nelson.cloud" target="_blank">Robinhood</a>
in late November of 2023 mainly for health reasons. I’ve been in various interviews since then. Things have fallen off for one reason or another but I just gotta say…I am getting so tired of <a href="https://leetcode.com/problemset/?ref=nelson.cloud" target="_blank">Leetcode</a>
-style interviews. Especially since I know for a fact they don’t reflect the actual responsibilities of a software engineering of a job.</p><p>It seems like most (if not all) companies do these kinds of interviews simply because that’s what all the big companies do, like Google, Facebook, Amazon, and so on.</p><p>I’ve had some very bright engineers tell me that I shouldn’t memorize things that I can easily google. But yet, these interviews quiz me on things that I can easily Google that I may not know off the top of my head. It’s absurd.</p><p>I don’t really have a solution to this problem, I just know it’s a problem.</p><p>And I’m sick of it.</p><p>If you need a Software Engineer with AWS, Kuberentes, and Ruby on Rails experience, and you don’t do silly quizzes, feel free to reach out!</p></div></article></div></div>]]></description>
        </item>
    </channel>
</rss>