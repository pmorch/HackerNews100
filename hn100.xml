<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Fri, 28 Nov 2025 16:30:01 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Petition to formally recognize open source work as civic service in Germany (277 pts)]]></title>
            <link>https://www.openpetition.de/petition/online/anerkennung-von-open-source-arbeit-als-ehrenamt-in-deutschland#petition-main</link>
            <guid>46078770</guid>
            <pubDate>Fri, 28 Nov 2025 14:08:14 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.openpetition.de/petition/online/anerkennung-von-open-source-arbeit-als-ehrenamt-in-deutschland#petition-main">https://www.openpetition.de/petition/online/anerkennung-von-open-source-arbeit-als-ehrenamt-in-deutschland#petition-main</a>, See on <a href="https://news.ycombinator.com/item?id=46078770">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
		<div dir="ltr" lang="de">
			<p>
				<strong>Petition richtet sich an:</strong>
									Deutscher Bundestag Petitionsausschuss							</p>

			<!--marker--><p>Open-Source-Software bildet heute das Fundament großer Teile der digitalen Infrastruktur – in Verwaltung, Wirtschaft, Forschung und im täglichen Leben. Selbst im aktuellen <b>Koalitionsvertrag</b> der <b>Bundesregierung</b> wird Open-Source-Software als elementarer Baustein zur Erreichung  <b>digitaler Souveränität</b> genannt.</p><p>Dennoch wird die Arbeit, die tausende Freiwillige dafür leisten, in Deutschland steuer- und förderrechtlich <b>nicht als Ehrenamt anerkannt</b>. Dieses Ungleichgewicht zwischen gesellschaftlicher Bedeutung und rechtlichem Status gilt es zu korrigieren.</p><p>Als aktiver Contributor in Open-Source-Projekten fordere ich daher, Open-Source-Arbeit als <b>gemeinwohlorientiertes Ehrenamt</b> anzuerkennen – gleichrangig mit Vereinsarbeit, Jugendarbeit oder Rettungsdiensten.</p>		</div>

					<h4>Begründung</h4>

			<div dir="ltr" lang="de">
				<!--marker--><p><b>1. Open-Source trägt nachweislich zum Gemeinwohl bei</b><br></p><ul><li>Open-Source-Projekte schaffen <b>freie, transparente und überprüfbare Software</b>, die allen zugutekommt.</li><li>Kritische Systeme wie <b>Internet-Protokolle, Sicherheitsbibliotheken, Gesundheits-IT, KI-Frameworks, Energieverwaltung, Bildungstechnologien und Kommunikationswerkzeuge</b> basieren maßgeblich auf freiwilligen Beiträgen.</li><li>Ohne diese Arbeit wäre Deutschland digital <b>abhängiger, weniger sicher und weniger innovativ</b>.</li></ul><p>Gemeinwohlorientierung ist ein zentrales Kriterium für ein Ehrenamt – und Open-Source erfüllt dieses in höchstem Maße.</p><p><b>2. Die Arbeit geschieht überwiegend unbezahlt – und ist freiwilliges bürgerschaftliches Engagement</b><br></p><ul><li>Die Mehrheit aller Entwicklungs-, Wartungs- und Dokumentationsleistungen erfolgt <b>ehrenamtlich in der Freizeit</b>.</li><li>Contributor übernehmen Verantwortung für <b>Sicherheit, Stabilität und Weiterentwicklung</b> zentraler Softwarekomponenten, ohne Vergütung und oft ohne Anerkennung.</li><li>Das Engagement ist <b>vergleichbar mit Tätigkeiten in gemeinnützigen Vereinen</b>, nur eben digital.</li></ul><p>Die rechtliche Gleichstellung mit klassischem Ehrenamt wäre daher folgerichtig.</p><p><b>3. Gesellschaftliche Abhängigkeit ohne gesellschaftliche Anerkennung</b><br></p><ul><li>Staatliche Einrichtungen, Kommunen, Schulen und Unternehmen <b>profitieren direkt</b> von Open-Source-Bibliotheken, Frameworks und Tools.</li><li>Sicherheitslücken wie „Heartbleed“ oder Log4Shell haben gezeigt, wie entscheidend die Arbeit der Maintainer für das <b>Schutzinteresse der Allgemeinheit</b> ist.</li><li>Gleichzeitig fehlen Ressourcen und Strukturen, weil die Arbeit <b>formal nicht als Ehrenamt</b> eingestuft ist – und damit <i>keinerlei steuerliche oder organisatorische Förderung</i> erhält.</li></ul><p>Dies erzeugt eine <b>unausgewogene Verantwortungslast</b>, die auf wenigen Freiwilligen liegt, während Millionen Nutzer*innen profitieren.</p><p><b>4. Anerkennung als Ehrenamt würde Rechtsklarheit schaffen</b></p><p>Durch eine formelle Anerkennung könnten:<br></p><ul><li><b>Aufwandsentschädigungen steuerfrei</b> gewährt werden (Ehrenamtspauschale/Übungsleiterpauschale).</li><li><b>Gemeinnützige Open-Source-Projekte</b> eine leichtere Einstufung nach §52 AO erreichen.</li><li>Contributor bei Haftungsfragen besser gestellt werden (analog zu §31a BGB für Vereinsvorstände).</li><li>Projekte rechtssicher Kosten erstatten oder Spendenquittungen ausstellen.</li></ul><p>Dies schafft <b>Transparenz</b>, <b>Rechtssicherheit</b> und <b>Nachhaltigkeit</b> im digitalen Ehrenamt.</p><p><b>5. Digitalisierung braucht freiwillige Kompetenz – und diese verdient Förderung</b><br></p><ul><li>Open-Source-Engagement erfordert hohe technische Kompetenz.</li><li>Freiwillige Entwickler*innen leisten Arbeit, die Unternehmen ansonsten für hohe Stundensätze einkaufen müssten.</li><li>Der Staat investiert Milliarden in Digitalisierung, ignoriert aber die Menschen, die die technologische Basis <b>freiwillig</b> pflegen.</li></ul><p>Eine Anerkennung als Ehrenamt wäre ein <b>kosteneffizienter Beitrag zur digitalen Souveränität</b> Deutschlands.</p><p><b>6. Deutschland hinkt international hinterher</b></p><p>Andere Staaten fördern Open-Source-Engagement bereits durch:</p><ul><li>steuerliche Begünstigungen</li><li>institutionelle Förderung</li><li>Anerkennung gemeinnütziger Softwareentwicklung</li></ul><p>Deutschland riskiert, im globalen Wettbewerb zurückzufallen, wenn Freiwilligenarbeit im digitalen Raum weiterhin <b>strukturell benachteiligt</b> wird.</p>			</div>
		
					
			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[A Remarkable Assertion from A16Z (190 pts)]]></title>
            <link>https://nealstephenson.substack.com/p/a-remarkable-assertion-from-a16z</link>
            <guid>46078138</guid>
            <pubDate>Fri, 28 Nov 2025 12:41:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://nealstephenson.substack.com/p/a-remarkable-assertion-from-a16z">https://nealstephenson.substack.com/p/a-remarkable-assertion-from-a16z</a>, See on <a href="https://news.ycombinator.com/item?id=46078138">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><p><span>A friend made me aware of </span><a href="https://a16z-infra.github.io/reading-list/" rel="">a reading list</a><span> from </span><a href="https://a16z.com/about/" rel="">A16Z </a><span>containg recommendations for books, weighted towards science fiction since that’s mostly what people there read. Some of my books are listed. Since this is the season of Thanksgiving, I’ll start by saying that I genuinely appreciate the plug! However, I was taken aback by the statement highlighted in the screen grab below:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!XIVl!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!XIVl!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 424w, https://substackcdn.com/image/fetch/$s_!XIVl!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 848w, https://substackcdn.com/image/fetch/$s_!XIVl!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 1272w, https://substackcdn.com/image/fetch/$s_!XIVl!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/$s_!XIVl!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png" width="1456" height="472" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:472,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:578864,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:&quot;https://nealstephenson.substack.com/i/179984587?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png&quot;,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!XIVl!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 424w, https://substackcdn.com/image/fetch/$s_!XIVl!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 848w, https://substackcdn.com/image/fetch/$s_!XIVl!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 1272w, https://substackcdn.com/image/fetch/$s_!XIVl!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2f9bca4c-6495-4e72-b009-b35968b43315_2404x780.png 1456w" sizes="100vw" fetchpriority="high"></picture></div></a></figure></div><p><em>“…most of these books don’t have endings (they literally stop mid-sentence).”</em></p><p>I had to read this over a few times to believe that I was seeing it. If it didn’t include the word “literally” I’d assume some poetic license on the part of whoever, or whatever, wrote this. But even then it would be crazy wrong.</p><p>I’m not surprised or perturbed by the underlying sentiment. Some of my endings have been controversial for a long time. Tastes differ. Some readers would prefer more conclusive endings. Now, in some cases, such as Snow Crash, I simply can’t fathom why any reader could read the ending—a long action sequence in which the Big Bad is defeated, the two primary antagonists meet their maker and Y.T. is reconciled and reunited with her mother—as anything other than a proper wind-up to the story. In other cases, notably The Diamond Age and Seveneves, I can understand why readers who prefer a firm conclusion would end up being frustrated. It is simply not what I was trying to do in those books. So, for a long time, people have argued about some of my endings, and that’s fine.</p><p>In this case, though, we have a big company explicitly stating that several of my best-known books just stop mid-sentence, and putting in the word “literally” to eliminate any room for interpretive leeway.</p><p>This isn’t literary criticism, which consists of statements of opinion. This is a factual assertion that is (a) false, (b) easy to fact-check, and (c) casts my work ethic, and that of my editors, in an unflattering light.</p><p>It is interesting to speculate as to how such an assertion found its way onto A16Z’s website!</p><p>By far the most plausible explanation is that this verbiage was generated by an AI and then copy-pasted into the web page by a human who didn’t bother to fact-check it. This would explain the misspelling of my name and some peculiarities in the writing style. Of course, this kind of thing is happening all the time now in law, academia, journalism, and other fields, so it’s pretty unremarkable; it just caught my attention because it’s the first time it’s directly affected me.</p><p>The flow diagram looks like this:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!VJvc!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!VJvc!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 424w, https://substackcdn.com/image/fetch/$s_!VJvc!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 848w, https://substackcdn.com/image/fetch/$s_!VJvc!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 1272w, https://substackcdn.com/image/fetch/$s_!VJvc!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/$s_!VJvc!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png" width="1456" height="1091" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1091,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:138336,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:&quot;https://nealstephenson.substack.com/i/179984587?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png&quot;,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!VJvc!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 424w, https://substackcdn.com/image/fetch/$s_!VJvc!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 848w, https://substackcdn.com/image/fetch/$s_!VJvc!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 1272w, https://substackcdn.com/image/fetch/$s_!VJvc!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0bc418b3-07f2-41ed-bd3d-7161d8ebcdb0_1516x1136.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p>That does a pretty good job of explaining how this all might have come about. So far so good. But it raises interesting questions about what happens next: the faulty quote from this seemingly authoritative source in turn gets ingested by the next generation of LLMs, and so on and so forth:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/$s_!kv4L!,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/$s_!kv4L!,w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 424w, https://substackcdn.com/image/fetch/$s_!kv4L!,w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 848w, https://substackcdn.com/image/fetch/$s_!kv4L!,w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 1272w, https://substackcdn.com/image/fetch/$s_!kv4L!,w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/$s_!kv4L!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png" width="1400" height="838" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:838,&quot;width&quot;:1400,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:83358,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:&quot;https://nealstephenson.substack.com/i/179984587?img=https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png&quot;,&quot;isProcessing&quot;:false,&quot;align&quot;:null,&quot;offset&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/$s_!kv4L!,w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 424w, https://substackcdn.com/image/fetch/$s_!kv4L!,w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 848w, https://substackcdn.com/image/fetch/$s_!kv4L!,w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 1272w, https://substackcdn.com/image/fetch/$s_!kv4L!,w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F53e10fbf-fa9f-45c0-8f85-67f4fd9dbef4_1400x838.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p>A hundred years from now, thanks to the workings of the Inhuman Centipede, I’m known as a deservedly obscure dadaist prose stylist who thought it was cool to stop his books mid-sentence.</p><p>In this scenario, which seems more far-fetched, we have a sincere and honest human writer who is reporting what they believe to be true based on false information. It breaks down into two sub-hypotheses:</p><p><span>There are bootleg copies of countless books circulating all over the Internet, and have been for decades</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-1-179984587" href="https://nealstephenson.substack.com/p/a-remarkable-assertion-from-a16z#footnote-1-179984587" target="_self" rel="">1</a></span><span>. Very often these are of poor quality. It could be that the person (or the AI) who wrote the above excerpt decided to save some money by downloading one of those, and got a bad copy that was cut off in mid-sentence.</span></p><p>Even in the legit publishing industry, the quality of translations can be quite variable, and it’s difficult for authors to know whether a given translation was any good. I’ve seen translated editions of some of my books that look suspiciously short on page count. For all I know there might be translations of my books (legit or bootleg) that actually do stop mid-sentence!</p><p>I genuinely am grateful to have been included on this list! But I had to say something about this astonishing howler embedded in the otherwise reasonable verbiage.</p><p>Even the most cynical and Internet-savvy among us are somehow hard-wired to take anything we read on the Internet at face value. I’m as guilty as the next person. This has been a bad idea for a long time now, since bad actors have been swarming onto the Internet for decades.  Now, though, it’s a bad idea for a whole new reason: content we read on the Internet might not have been written by a person with an intent to misinform, but rather by an LLM with no motives whatsoever, and no underlying model of reality that enables it to determine fact from fiction.</p></div></article></div><div id="discussion"><h4>Discussion about this post</h4></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The mysterious black fungus from Chernobyl that may eat radiation (203 pts)]]></title>
            <link>https://www.bbc.com/future/article/20251125-the-mysterious-black-fungus-from-chernobyl-that-appears-to-eat-radiation</link>
            <guid>46077992</guid>
            <pubDate>Fri, 28 Nov 2025 12:17:15 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bbc.com/future/article/20251125-the-mysterious-black-fungus-from-chernobyl-that-appears-to-eat-radiation">https://www.bbc.com/future/article/20251125-the-mysterious-black-fungus-from-chernobyl-that-appears-to-eat-radiation</a>, See on <a href="https://news.ycombinator.com/item?id=46077992">Hacker News</a></p>
<div id="readability-page-1" class="page"><article><div data-component="image-block"><figure><div><p><img src="https://static.files.bbci.co.uk/bbcdotcom/web/20251120-101800-81b2dab7dc-web-2.34.1-2/grey-placeholder.png" aria-label="image unavailable"><img sizes="(min-width: 1280px) 50vw, (min-width: 1008px) 66vw, 96vw" srcset="https://ichef.bbci.co.uk/images/ic/160xn/p0mk4zv2.jpg.webp 160w, https://ichef.bbci.co.uk/images/ic/240xn/p0mk4zv2.jpg.webp 240w, https://ichef.bbci.co.uk/images/ic/320xn/p0mk4zv2.jpg.webp 320w, https://ichef.bbci.co.uk/images/ic/480xn/p0mk4zv2.jpg.webp 480w, https://ichef.bbci.co.uk/images/ic/640xn/p0mk4zv2.jpg.webp 640w, https://ichef.bbci.co.uk/images/ic/800xn/p0mk4zv2.jpg.webp 800w, https://ichef.bbci.co.uk/images/ic/1024xn/p0mk4zv2.jpg.webp 1024w, https://ichef.bbci.co.uk/images/ic/1376xn/p0mk4zv2.jpg.webp 1376w, https://ichef.bbci.co.uk/images/ic/1920xn/p0mk4zv2.jpg.webp 1920w" src="https://ichef.bbci.co.uk/images/ic/480xn/p0mk4zv2.jpg.webp" loading="lazy" alt="Getty Images A figure stands by a metal array and radioactivity warning sign (Credit: Getty Images)"><span>Getty Images</span></p></div></figure></div><div data-component="layout-block"><p><b id="mould-found-at-the-site-of-the-chernobyl-nuclear-disaster-appears-to-be-feeding-off-the-radiation.-could-we-use-it-to-shield-space-travellers-from-cosmic-rays?">Mould found at the site of the Chernobyl nuclear disaster appears to be feeding off the radiation. Could we use it to shield space travellers from cosmic rays?</b></p><p>In May 1997, Nelli Zhdanova entered one of the most radioactive places on Earth – the abandoned ruins of Chernobyl's exploded nuclear power plant – and saw that she wasn't alone.&nbsp;</p><p>Across the ceiling, walls and inside metal conduits that protect electrical cables, black mould had taken up residence in a place that was once thought to be <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0265931X17309347#cebib0010">detrimental</a>&nbsp;to life.&nbsp;</p><p>In the fields and forest outside, <a target="_self" href="https://www.bbc.com/news/science-environment-34414914">wolves and wild boar had rebounded</a> in the absence of humans. But even today there are hotspots where <a target="_self" href="https://www.bbc.com/news/science-environment-48193866">staggering levels of radiation</a> can be found due to material thrown out from the reactor when it exploded.</p><div><p><span>Like plants reaching for sunlight, Zhdanova's research indicated that the fungal hyphae of the black mould seemed attracted to ionising radiation</span></p></div></div><div data-component="layout-block"><p>The mould – formed from a number of different fungi – seemed to be doing something remarkable. It hadn't just moved in because workers at the plant had left. Instead, <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S0953756209810575">Zhdanova</a> had found in previous surveys of soil around Chernobyl that the fungi were actually growing <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S0953756208604281">towards</a> the radioactive particles that littered the area. Now, she found that they had reached into the original source of the radiation, the rooms within the exploded reactor building.</p><p>With each survey taking her close to harmful radiation, Zhdanova's work has also overturned our ideas about how radiation impacts life on Earth. Now her discovery offers <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S187861461930159X">hope of cleaning up radioactive sites</a> and even provide ways of protecting astronauts from harmful radiation as they travel into space.&nbsp;&nbsp;</p><p>Eleven years before Zhdanova's visit, a routine safety test of reactor four at the Chernobyl Nuclear Power Plant had <a target="_self" href="https://www.bbc.com/future/article/20190725-will-we-ever-know-chernobyls-true-death-toll">quickly turned into the world's worst nuclear accident</a>. A series of errors both in the design of the reactor and its operation led to a huge explosion in the early hours of 26 April 1986. The result was a single, massive release of radionuclides. Radioactive iodine was <a target="_blank" href="https://www.iaea.org/newscenter/focus/chernobyl/faqs">a leading cause of death</a> in the first days and weeks, and, later, of cancer.&nbsp;</p><p>In an attempt to reduce the risk of radiation poisoning and long-term health complications, a 30km (19 mile) exclusion zone – also known as the "<a target="_blank" href="https://www.sites.se.manchester.ac.uk/nuclearhitchhiker/2017/03/10/637/">zone of alienation" – was established</a> to keep people at a distance from the worst of the radioactive remains of reactor four.</p><p>But while humans were kept away, Zhdanova's black mould had slowly colonised the area.</p></div><div data-component="layout-block"><figure><p><img src="https://static.files.bbci.co.uk/bbcdotcom/web/20251120-101800-81b2dab7dc-web-2.34.1-2/grey-placeholder.png" aria-label="image unavailable"><img sizes="(min-width: 1280px) 50vw, (min-width: 1008px) 66vw, 96vw" srcset="https://ichef.bbci.co.uk/images/ic/160xn/p0mjnsb9.jpg.webp 160w, https://ichef.bbci.co.uk/images/ic/240xn/p0mjnsb9.jpg.webp 240w, https://ichef.bbci.co.uk/images/ic/320xn/p0mjnsb9.jpg.webp 320w, https://ichef.bbci.co.uk/images/ic/480xn/p0mjnsb9.jpg.webp 480w, https://ichef.bbci.co.uk/images/ic/640xn/p0mjnsb9.jpg.webp 640w, https://ichef.bbci.co.uk/images/ic/800xn/p0mjnsb9.jpg.webp 800w, https://ichef.bbci.co.uk/images/ic/1024xn/p0mjnsb9.jpg.webp 1024w, https://ichef.bbci.co.uk/images/ic/1376xn/p0mjnsb9.jpg.webp 1376w, https://ichef.bbci.co.uk/images/ic/1920xn/p0mjnsb9.jpg.webp 1920w" src="https://ichef.bbci.co.uk/images/ic/480xn/p0mjnsb9.jpg.webp" loading="lazy" alt="Germán Orizaola/Pablo Burraco Ionising radiation may have led tree frogs inside the Chernobyl exclusion zone to have darker skin (left) than those outside it (right) (Credit: Germán Orizaola/ Pablo Burraco)"><span>Germán Orizaola/Pablo Burraco</span></p><figcaption>Ionising radiation may have led tree frogs inside the Chernobyl exclusion zone to have darker skin (left) than those outside it (right) (Credit: Germán Orizaola/ Pablo Burraco)</figcaption></figure><p>Like plants reaching for sunlight, Zhdanova's research indicated that the fungal hyphae of the black mould seemed <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S0953756209810575">attracted</a> to ionising radiation. But "radiotropism", as Zhdanova called it, was a paradox: ionising radiation is generally far more powerful than sunlight, a barrage of radioactive particles that <a target="_blank" href="https://www.ncbi.nlm.nih.gov/books/NBK401323/">shreds through DNA and proteins</a> like bullets puncture flesh. The damage it causes can trigger harmful mutations, destroy cells and kill organisms.</p><p>Along with the apparently radiotropic fungi, Zhdanova's surveys found <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S0953756208615026">36 other species of ordinary, but distantly related, fungi growing</a> around Chernobyl. Over the next two decades, her pioneering work on the radiotropic fungi she identified would reach far outside of Ukraine. It would add to knowledge of a potentially <a target="_blank" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2677413/">new foundation of life</a> on Earth – one that thrives on radiation rather than sunlight. And it would lead scientists at Nasa to <a target="_blank" href="https://www.nasa.gov/centers-and-facilities/ames/could-future-homes-on-the-moon-and-mars-be-made-of-fungi/">consider surrounding their astronauts in walls of fungi</a> for a durable form of life support.</p><p>At the centre of this story is a pigment found widely in life on Earth: melanin. This molecule, which can range from black to reddish brown, is what leads to different skin and hair colours in people. But it is also the reason why the various species of mould growing in Chernobyl were black. Their cell walls were <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S0953756209810575">packed</a> with melanin.</p><p>Just as darker skin protects our cells from ultraviolet (UV) radiation, Zhdanova suspected that the melanin of these fungi was <a target="_blank" href="https://www.sciencedirect.com/science/article/abs/pii/S1369527408001306?via%3Dihub">acting as a shield</a> against ionising radiation.</p></div><div data-component="layout-block"><div><p><span>Just as those black moulds colonised an abandoned world at Chernobyl, perhaps they could one day protect our first steps on new worlds elsewhere in the Solar System</span></p></div><p>It wasn't just fungi that were harnessing melanin's protective properties. In the ponds around Chernobyl, frogs with higher concentrations of melanin in their cells, and so darker in colour, were <a target="_blank" href="https://theconversation.com/chernobyl-black-frogs-reveal-evolution-in-action-191034">better able to survive and reproduce</a>, slowly turning the local population living there black.</p><p>In warfare, a shield might protect a soldier from an arrow by deflecting the projectile away from their body. But melanin doesn't work like this. It isn't a hard or smooth surface. The radiation – whether UV or radioactive particles – is <a target="_blank" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2677413/">swallowed by its disordered structure</a>, its energy <a target="_blank" href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2671032/">dissipated rather than deflected</a>. Melanin is <a target="_blank" href="https://www.ncbi.nlm.nih.gov/books/NBK459156/">also an antioxidant</a>, a molecule that can turn the reactive ions that radiation produces in biological matter and return them to a stable state.</p><p>In 2007, Ekaterina Dadachova, a nuclear scientist at the Albert Einstein College of Medicine in New York, added to Zhdanova's work on Chernobyl's fungi, revealing that their growth wasn't just directional (radiotropic) but actually <a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/17520016/">increased</a> in the presence of radiation. Melanised fungi, just like those inside Chernobyl's reactor, grew 10% faster in the presence of radioactive Caesium compared to the same fungi cultured without radiation, she found. Dadachova and her team also found that the melanised fungi that were irradiated appeared to be using the energy to help drive its metabolism. In other words, they were using it to grow.</p><figure><p><img src="https://static.files.bbci.co.uk/bbcdotcom/web/20251120-101800-81b2dab7dc-web-2.34.1-2/grey-placeholder.png" aria-label="image unavailable"><img sizes="(min-width: 1280px) 50vw, (min-width: 1008px) 66vw, 96vw" srcset="https://ichef.bbci.co.uk/images/ic/160xn/p0mjntqd.jpg.webp 160w, https://ichef.bbci.co.uk/images/ic/240xn/p0mjntqd.jpg.webp 240w, https://ichef.bbci.co.uk/images/ic/320xn/p0mjntqd.jpg.webp 320w, https://ichef.bbci.co.uk/images/ic/480xn/p0mjntqd.jpg.webp 480w, https://ichef.bbci.co.uk/images/ic/640xn/p0mjntqd.jpg.webp 640w, https://ichef.bbci.co.uk/images/ic/800xn/p0mjntqd.jpg.webp 800w, https://ichef.bbci.co.uk/images/ic/1024xn/p0mjntqd.jpg.webp 1024w, https://ichef.bbci.co.uk/images/ic/1376xn/p0mjntqd.jpg.webp 1376w, https://ichef.bbci.co.uk/images/ic/1920xn/p0mjntqd.jpg.webp 1920w" src="https://ichef.bbci.co.uk/images/ic/480xn/p0mjntqd.jpg.webp" loading="lazy" alt="Elsevier/ Zhdanova et al. 2000 Cultures found in the fourth unit at Chernobyl, including Cladosporium sphaerospermum. The top right dish clearly shows melanisation (Credit: Elsevier/ Zhdanova et al. 2000)"><span>Elsevier/ Zhdanova et al. 2000</span></p><figcaption>Cultures found in the fourth unit at Chernobyl, including Cladosporium sphaerospermum. The top right dish clearly shows melanisation (Credit: Elsevier/ Zhdanova et al. 2000)</figcaption></figure></div><div data-component="layout-block"><p>Zhdanova had suggested that these fungi could be harnessing the energy from radiation, and now Dadachova's research appeared to be building on this. These fungi weren't just growing towards radiation for warmth or some unknown reaction between radiation and its surroundings as Zhdanova had suggested. Dadachova believed the fungi were actively feeding on the radiation's energy. She called this process "<a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/17520016/">radiosynthesis</a>". And melanin was central to the theory.</p><p>"The energy of ionising radiation is around one million times higher than the energy of white light, which is used in photosynthesis," says Dadachova. "So you need a pretty powerful energy transducer, and this is what we think melanin is capable of doing – to transduce [<a target="_blank" href="https://www.who.int/news-room/fact-sheets/detail/ionizing-radiation-and-health-effects">ionising radiation</a>] into usable levels of energy."&nbsp;</p><p>Radiosynthesis is still just a theory, as it can only be proven if the precise mechanism between melanin and metabolism is discovered. Scientists would need to find the exact receptor – or a particular nook in melanin's convoluted structure – that is involved in converting radiation into energy for growth.</p><p>In more recent years, Dadachova&nbsp;and her colleagues have started to identify some of the&nbsp;<a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/32389299/">pathways</a>&nbsp;and&nbsp;<a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/33425251/">proteins</a>&nbsp;that might underlie the fungi's increase in growth with ionising radiation.&nbsp;</p><p>Not all melanised fungi show a tendency for radiotropism and positive growth in the presence of radiation. A 2006 <a target="_blank" href="https://pubmed.ncbi.nlm.nih.gov/16821711/">study</a> from Zhdanova and her colleagues, for example, found that only nine of the 47 species of melanised fungi they collected at Chernobyl grew towards a source of radioactive caesium (caesium-137).&nbsp;</p></div><div data-component="layout-block"><p>Similarly, in 2022, scientists at Sandia National Laboratories in New Mexico <a target="_blank" href="https://www.nature.com/articles/s41598-022-16063-z">found no difference in growth</a> when two species of fungi (one melanised, one not) were exposed to UV radiation and caesium-137.</p><p>But that same year, the same tendency for fungal growth when exposed to radiation <a target="_blank" href="https://www.frontiersin.org/journals/microbiology/articles/10.3389/fmicb.2022.877625/full">was found again –</a><a target="_blank" href="https://www.frontiersin.org/journals/microbiology/articles/10.3389/fmicb.2022.877625/full"> in space</a>.</p><p>Different from the radioactive decay found at Chernobyl, so-called <a target="_blank" href="https://www.nasa.gov/missions/analog-field-testing/why-space-radiation-matters/">galactic cosmic radiation</a> is an invisible storm of charged protons, each travelling near the speed of light through the Universe. Originating from exploding stars outside our solar system, it <a target="_blank" href="https://www.nasa.gov/humans-in-space/positive-negative-or-neutral-it-all-matters-nasa-explains-space-radiation/">even passes through lead without much trouble</a>. On Earth, our atmosphere largely protects us from it but for astronauts travelling into deep-space it has been called "<a target="_blank" href="https://www.biorxiv.org/content/10.1101/2020.07.16.205534v7">the greatest hazard</a>" to <a target="_blank" href="https://ntrs.nasa.gov/citations/20250004252">their health</a>.</p><p>But even galactic cosmic radiation was no problem for samples of<i id="cladosporium-sphaerospermum"> Cladosporium sphaerospermum</i>, the same strain that Zhdanova found growing throughout Chernobyl, according to a study that <a target="_blank" href="http://www.frontiersin.org/journals/microbiology/articles/10.3389/fmicb.2022.877625/full">sent these fungi to the International Space Station</a> in December 2018.</p><p>"What we showed is that it grows better in space," says Nils Averesch, a biochemist working at the University of Florida and co-author of the study.</p></div><div data-component="layout-block"><figure><p><img src="https://static.files.bbci.co.uk/bbcdotcom/web/20251120-101800-81b2dab7dc-web-2.34.1-2/grey-placeholder.png" aria-label="image unavailable"><img sizes="(min-width: 1280px) 50vw, (min-width: 1008px) 66vw, 96vw" srcset="https://ichef.bbci.co.uk/images/ic/160xn/p0mjnv89.jpg.webp 160w, https://ichef.bbci.co.uk/images/ic/240xn/p0mjnv89.jpg.webp 240w, https://ichef.bbci.co.uk/images/ic/320xn/p0mjnv89.jpg.webp 320w, https://ichef.bbci.co.uk/images/ic/480xn/p0mjnv89.jpg.webp 480w, https://ichef.bbci.co.uk/images/ic/640xn/p0mjnv89.jpg.webp 640w, https://ichef.bbci.co.uk/images/ic/800xn/p0mjnv89.jpg.webp 800w, https://ichef.bbci.co.uk/images/ic/1024xn/p0mjnv89.jpg.webp 1024w, https://ichef.bbci.co.uk/images/ic/1376xn/p0mjnv89.jpg.webp 1376w, https://ichef.bbci.co.uk/images/ic/1920xn/p0mjnv89.jpg.webp 1920w" src="https://ichef.bbci.co.uk/images/ic/480xn/p0mjnv89.jpg.webp" loading="lazy" alt="Nils Averesch/ Aaron Berliner The Cladosporium sphaerospermum isolate from Chornobyl, grown on a potato dextrose agar plate, shows very high melanisation (Credit: Nils Averesch/ Aaron Berliner)"><span>Nils Averesch/ Aaron Berliner</span></p><figcaption>The Cladosporium sphaerospermum isolate from Chornobyl, grown on a potato dextrose agar plate, shows very high melanisation (Credit: Nils Averesch/ Aaron Berliner)</figcaption></figure><p>Compared to control samples back on Earth, the researchers found that fungi that faced the galactic cosmic radiation for 26 days grew an average 1.21 times faster.</p><p>Even so, Averesch is still unconvinced that this is because <i id="c.-sphaerospermum">C. sphaerospermum</i> was harnessing the radiation in space. The increased levels of growth could also have been the result of zero gravity, he says, another factor that fungi back on Earth didn't experience. "Averesch is now conducting experiments using a <a target="_blank" href="https://www.esa.int/ESA_Multimedia/Videos/2019/04/Random_Positioning_Machine">random positioning machine</a> that simulates zero gravity here on Earth to parse these two possibilities.&nbsp;</p><p>But Averesch and his colleagues also tested the protective potential of the melanin in<i id="c.-sphaerospermum"> C. sphaerospermum</i> by putting a sensor underneath a sample of the fungi aboard the International Space Station. Compared to samples without fungi, the amount of radiation blocked increased as the fungi grew, and even a smear of mould in a petri dish seemed to be an effective shield.</p><p>"Considering the comparatively thin layer of biomass, this may indicate a profound ability of <i id="c.-sphaerospermum">C. sphaerospermum</i> to absorb space radiation in the measured spectrum," the researchers <a target="_blank" href="https://www.frontiersin.org/journals/microbiology/articles/10.3389/fmicb.2022.877625/full">wrote</a>.</p></div><div data-component="layout-block"><p>Averesch says it's still possible the apparent radioprotective benefits of fungi are due to components of biological life other than melanin. Water, for example, a molecule with a high number of protons in its structure (eight in oxygen and one in each hydrogen), is one of the <a target="_blank" href="https://www.esa.int/Enabling_Support/Space_Engineering_Technology/For_astronaut_radiation_protection_just_add_water">best ways</a> to protect against the protons that zoom through space, an astrobiological equivalent of fighting fire with fire.</p><p><b id="more-like-this:">More like this:</b></p><p>•&nbsp;<a target="_self" href="https://www.bbc.com/future/article/20190725-will-we-ever-know-chernobyls-true-death-toll">The true toll of the Chernobyl disaster</a></p><p><a target="_blank" href=""></a>•&nbsp;<a target="_self" href="http://www.bbc.com/future/article/20190701-why-plants-survived-chernobyls-deadly-radiation">How plants reclaimed Chernobyl's poisoned land</a></p><p><a target="_blank" href=""></a>•&nbsp;<a target="_self" href="https://www.bbc.com/future/article/20210422-the-guards-caring-for-chernobyls-abandoned-dogs">The guards caring for Chernobyl's abandoned dogs</a></p><p>Even so, the findings have opened intriguing prospects for solving a problem of space-based living. Both <a target="_self" href="https://www.bbc.co.uk/future/article/20240510-change-6-is-just-the-tip-of-chinas-space-ambitions">China</a> and <a target="_self" href="https://www.bbc.com/news/articles/cy7pegvz17yo">the US</a> plan to have a base on the Moon in the coming decades, while Texas-based SpaceX aims to have its <a target="_self" href="https://www.bbc.co.uk/news/articles/cx2g88y52y8o">first mission to Mars blast off </a><a target="_self" href="https://www.bbc.co.uk/news/articles/cx2g88y52y8o">by the end of </a><a target="_self" href="https://www.bbc.co.uk/news/articles/cx2g88y52y8o">2026</a>, and land humans there three to five years later. Any people living on these bases will <a target="_blank" href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2024SW004086">need to be protected from cosmic radiation</a>. But using water or polyethylene plastic as a <a target="_blank" href="https://www.nasa.gov/science-research/heliophysics/real-martians-how-to-protect-astronauts-from-space-radiation-on-mars/">radioprotective cocoon</a> for these bases might be far too heavy for liftoff.</p><p>Metal and glass present a similar problem. Lynn J Rothschild, an astrobiologist at Nasa's Ames Research Centre, has likened transporting these materials into space to build space bases to a turtle carrying its shell everywhere it goes. "[It's] a reliable plan, but with huge energy costs," she <a target="_blank" href="https://www.nasa.gov/centers-and-facilities/ames/could-future-homes-on-the-moon-and-mars-be-made-of-fungi/">said in a 2020 N</a><a target="_blank" href="https://www.nasa.gov/centers-and-facilities/ames/could-future-homes-on-the-moon-and-mars-be-made-of-fungi/">asa</a><a target="_blank" href="https://www.nasa.gov/centers-and-facilities/ames/could-future-homes-on-the-moon-and-mars-be-made-of-fungi/"> release</a>.</p><p>Her research has <a target="_blank" href="https://www.nasa.gov/general/myco-architecture-off-planet-growing-surface-structures-at-destination/">led to fungal based furniture and walls</a> that could be grown on the Moon or Mars. Not only would such "myco-architecture" reduce the cost of lift-off, but – if the findings from Dadachova and Averesch prove correct – it could also be used to form a radiation shield, a self-regenerating barrier between the space-faring humans and the storm of galactic cosmic radiation outside.&nbsp;</p></div></article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[EU Council Approves New "Chat Control" Mandate Pushing Mass Surveillance (486 pts)]]></title>
            <link>https://reclaimthenet.org/eu-council-approves-new-chat-control-mandate-pushing-mass-surveillance</link>
            <guid>46077393</guid>
            <pubDate>Fri, 28 Nov 2025 10:36:08 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://reclaimthenet.org/eu-council-approves-new-chat-control-mandate-pushing-mass-surveillance">https://reclaimthenet.org/eu-council-approves-new-chat-control-mandate-pushing-mass-surveillance</a>, See on <a href="https://news.ycombinator.com/item?id=46077393">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-id="4189490c" data-element_type="widget" data-widget_type="theme-post-content.default">
					<p>European governments have taken another step toward reviving the EU’s controversial <a href="https://reclaimthenet.org/chat-control-2-0-eu-moves-toward-ending-private-communication">Chat Control agenda</a>, approving a new negotiating mandate for the Child Sexual Abuse Regulation in a closed session of the Council of the European Union on November 26.</p>
<p>The measure, presented as a tool for child protection, is once again drawing heavy criticism for its surveillance implications and the way it reshapes private digital communication in Europe.</p>
<p>Unlike earlier drafts, this version <a href="https://reclaimthenet.org/eus-weakened-chat-control-bill-still-poses-major-privacy-risks">drops the explicit obligation</a> for companies to scan all private messages but quietly introduces what opponents describe as an indirect system of pressure.</p>
<p>It rewards or penalizes online services depending on whether they agree to carry out “voluntary” scanning, effectively making intrusive monitoring a business expectation rather than a legal requirement.</p>
<p>Former MEP Patrick Breyer, a long-standing defender of digital freedom and one of the most vocal opponents of the plan, said the deal “paves the way for a permanent infrastructure of mass surveillance.”</p>
<p>According to him, the Council’s text replaces legal compulsion with financial and regulatory incentives that push major US technology firms toward indiscriminate scanning.</p>
<p>He warned that the framework also brings “anonymity-breaking age checks” that will turn ordinary online use into an exercise in identity verification.</p>
<p>The new proposal, brokered largely through Danish mediation, comes months after the original “Chat Control 1.0” regulation appeared to have been shelved following widespread backlash.</p>
<p>It reinstates many of the same principles, requiring providers to assess their potential “risk” for child abuse content and to apply “mitigation measures” approved by authorities. In practice, that could mean pressure to install scanning tools that probe both encrypted and unencrypted communications.</p>
<p>Czech MEP Markéta Gregorová called the Council’s position “a disappointment…Chat Control…opens the way to blanket scanning of our messages.”</p>
<p><img fetchpriority="high" decoding="async" src="https://reclaimthenet.org/wp-content/uploads/2025/11/CnZOD1FJo2Zk.jpg" alt="Dark-mode screenshot of a verified Twitter/X post warning that the EU Council approved “Chat Control,” allowing blanket scanning of messages, while saying the European Parliament opposes it; an embedded Czech headline reads “EU states agreed on a proposal against child pornography, Czechia voted against”; timestamp Nov 26, 2025, 5:04 AM and 88.9K views are shown." width="776" height="604" srcset="https://reclaimthenet.org/wp-content/uploads/2025/11/CnZOD1FJo2Zk.jpg 776w, https://reclaimthenet.org/wp-content/uploads/2025/11/CnZOD1FJo2Zk-300x234.jpg 300w, https://reclaimthenet.org/wp-content/uploads/2025/11/CnZOD1FJo2Zk-768x598.jpg 768w" sizes="(max-width: 776px) 100vw, 776px"></p>
<p>Similar objections emerged across Europe.</p>
<p>In the Netherlands, members of parliament forced their government to vote against the plan, warning that it combines “mandatory age verification” with a “voluntary obligation” scheme that could penalize any company refusing to adopt invasive surveillance methods. Poland and the Czech Republic also voted against, and Italy abstained.</p>
<p>Former Dutch MEP Rob Roos accused Brussels of operating “behind closed doors,” warning that “Europe risks sliding into digital authoritarianism.”</p>
<p>Beyond parliamentarians, independent voices such as Daniel Vávra, David Heinemeier Hansson, and privacy-focused company Mullvad have spoken out against the Council’s position, calling it a direct threat to private communication online.</p>
<p>Despite the removal of the word “mandatory,” the structure of the new deal appears to preserve mass scanning in practice.</p>
<p>Breyer described it as a “Trojan Horse,” arguing that by calling the process “voluntary,” EU governments have shifted the burden of surveillance to tech companies themselves.</p>
<p>The Council’s mandate introduces three central dangers that remain largely unacknowledged in the public debate.</p>
<p>First, so-called “voluntary scanning” turns mass surveillance into standard operating procedure. The proposal extends the earlier temporary regulation that allowed service providers to scan user messages and images without warrants.</p>
<p>Authorities like Germany’s Federal Criminal Police Office have reported that roughly<a href="https://reclaimthenet.org/germany-chat-control-false-reports-surveillance-encryption-privacy"> half the alerts from such systems are baseless</a>, often involving completely legal content flagged by flawed algorithms. Breyer said these systems leak “tens of thousands of completely legal, private chats” to law enforcement every year.</p>
<p>Second, the plan effectively erases anonymous communication. To meet the new requirement to “reliably identify minors,” providers will have to implement universal age checks. This likely means ID verification or face scans before accessing even basic services such as email or messaging apps.</p>
<p>For journalists, activists, and anyone who depends on anonymity for protection, this system could make easy private speech functionally impossible.</p>
<p>Technical experts have repeatedly warned that age estimation “cannot be performed in a privacy-preserving way” and carries “a disproportionate risk of serious privacy violation and discrimination.”</p>
<p>Third, it risks digitally isolating young people. Under the Council’s framework, users under 17 could be blocked from many platforms unless they pass strict identity verification, including chat-enabled games and messaging services. Breyer called this idea “pedagogical nonsense,” arguing that it excludes teenagers instead of helping them develop safe online habits.</p>
<p>Member states remain divided: the Netherlands, Poland, and the Czech Republic rejected the text, while Italy abstained. Negotiations between the European Parliament and the Council are expected to begin soon, aiming for a final version before April 2026.</p>
<p>Breyer warned that the apparent compromise is no real retreat from surveillance. “The headlines are misleading: Chat Control is not dead, it is just being privatized,” he said. “We are facing a future where you need an ID card to send a message, and where foreign black-box AI decides if your private photos are suspicious. This is not a victory for privacy; it is a disaster waiting to happen.”</p>
				</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Tech Titans Amass Multimillion-Dollar War Chests to Fight AI Regulation (113 pts)]]></title>
            <link>https://www.wsj.com/tech/ai/tech-titans-amass-multimillion-dollar-war-chests-to-fight-ai-regulation-88c600e1</link>
            <guid>46077038</guid>
            <pubDate>Fri, 28 Nov 2025 09:21:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.wsj.com/tech/ai/tech-titans-amass-multimillion-dollar-war-chests-to-fight-ai-regulation-88c600e1">https://www.wsj.com/tech/ai/tech-titans-amass-multimillion-dollar-war-chests-to-fight-ai-regulation-88c600e1</a>, See on <a href="https://news.ycombinator.com/item?id=46077038">Hacker News</a></p>
Couldn't get https://www.wsj.com/tech/ai/tech-titans-amass-multimillion-dollar-war-chests-to-fight-ai-regulation-88c600e1: Error: Request failed with status code 401]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Glasses to detect smart-glasses that have cameras (384 pts)]]></title>
            <link>https://github.com/NullPxl/banrays</link>
            <guid>46075882</guid>
            <pubDate>Fri, 28 Nov 2025 05:52:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/NullPxl/banrays">https://github.com/NullPxl/banrays</a>, See on <a href="https://news.ycombinator.com/item?id=46075882">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">Ban-Rays</h2><a id="user-content-ban-rays" aria-label="Permalink: Ban-Rays" href="#ban-rays"></a></p>
<p dir="auto"><strong>Glasses to detect smart-glasses that have cameras</strong></p>
<p dir="auto">I'm experimenting with 2 main approaches:</p>
<ul dir="auto">
<li><a href="#optics">Optics</a>: classify the camera using light reflections.</li>
<li><a href="#networking">Networking</a>: bluetooth and wi-fi analysis.</li>
</ul>
<p dir="auto">So far fingerprinting specific devices based on bluetooth (BLE) is looking like easiest and most reliable approach. The picture below is the first version, which plays the legend of zelda 'secret found' jingle when it detects a BLE advertisement from Meta Raybans.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/banrays_physical_v1.png"><img src="https://github.com/NullPxl/banrays/raw/main/banrays_physical_v1.png" alt=""></a></p>
<p dir="auto">I'm essentially treating this README like a logbook, so it will have my current approaches/ideas.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Optics</h2><a id="user-content-optics" aria-label="Permalink: Optics" href="#optics"></a></p>
<p dir="auto">By sending IR at camera lenses, we can take advantage of the fact that the CMOS sensor in a camera reflects light directly back at the source (called 'retro-reflectivity' / 'cat-eye effect') to identify cameras.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/irrb.jpg"><img src="https://github.com/NullPxl/banrays/raw/main/irrb.jpg" alt=""></a></p>
<p dir="auto">This isn't exactly a new idea. Some researchers in 2005 used this property to create 'capture-resistant environments' when smartphones with cameras were gaining popularity.</p>
<ul dir="auto">
<li><a href="https://homes.cs.washington.edu/~shwetak/papers/cre.pdf" rel="nofollow">https://homes.cs.washington.edu/~shwetak/papers/cre.pdf</a></li>
</ul>
<p dir="auto">There's even some recent research (2024) that figured out how to classify individual cameras based on their retro-reflections.</p>
<ul dir="auto">
<li><a href="https://opg.optica.org/oe/fulltext.cfm?uri=oe-32-8-13836" rel="nofollow">https://opg.optica.org/oe/fulltext.cfm?uri=oe-32-8-13836</a></li>
</ul>
<p dir="auto">Now we have a similar situation to those 2005 researchers on our hands, where smart glasses with hidden cameras seem to be getting more popular. So I want to create a pair of glasses to identify these. Unfortunately, from what I can tell most of the existing research in this space records data with a camera and then uses ML, a ton of controlled angles, etc. to differentiate between normal reflective surfaces and cameras.</p>
<p dir="auto">I would feel pretty silly if my solution uses its own camera. So I'll be avoiding that. Instead I think it's likely I'll have to rely on being consistent with my 'sweeps', and creating a good classifier based on signal data. For example you can see here that the back camera on my smartphone seems to produce quick and large spikes, while the glossy screen creates a more prolonged wave.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/ts_plot_labeled.png"><img src="https://github.com/NullPxl/banrays/raw/main/ts_plot_labeled.png" alt=""></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/ts_plot_spikes.png"><img src="https://github.com/NullPxl/banrays/raw/main/ts_plot_spikes.png" alt=""></a></p>
<p dir="auto">After getting to test some Meta Raybans, I found that this setup is not going to be sufficient. Here's a test of some sweeps of the camera-area + the same area when the lens is covered. You can see the waveform is similar to what I saw in the earlier test (short spike for camera, wider otherwise), but it's wildly inconsistent and the strength of the signal is very weak. This was from about 4 inches away from the LEDs. I didn't notice much difference when swapping between 940nm and 850nm LEDs.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/ir_rayban_first_sweeps.png"><img src="https://github.com/NullPxl/banrays/raw/main/ir_rayban_first_sweeps.png" alt=""></a></p>
<p dir="auto">So at least with current hardware that's easy for me to access, this probably isn't enough to differentiate accurately.</p>
<p dir="auto">Another idea I had is to create a designated sweep 'pattern'. The user (wearing the detector glasses) would perform a specific scan pattern of the target. Using the waveforms captured from this data, maybe we can more accurately fingerprint the raybans. For example, sweeping across the targets glasses in a 'left, right, up, down' approach. I tested this by comparing the results of the Meta raybans vs some aviators I had lying around. I think the idea behind this approach is sound (actually it's light), but it might need more workshopping.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/ir_rayban_sweeping_pattern.png"><img src="https://github.com/NullPxl/banrays/raw/main/ir_rayban_sweeping_pattern.png" alt=""></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">IR Circuit</h3><a id="user-content-ir-circuit" aria-label="Permalink: IR Circuit" href="#ir-circuit"></a></p>
<p dir="auto">For prototyping, I'm using:</p>
<ul dir="auto">
<li>Arduino uno</li>
<li>a bunch of 940nm and 850nm IR LEDs</li>
<li>a photodiode as a receiver</li>
<li>a 2222A transistor</li>
</ul>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/basicsetup.jpg"><img src="https://github.com/NullPxl/banrays/raw/main/basicsetup.jpg" alt=""></a></p>
<p dir="auto">TODO:</p>
<ul dir="auto">
<li>experiment with sweeping patterns</li>
<li>experiment with combining data from different wavelengths</li>
<li>collimation?</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Networking</h2><a id="user-content-networking" aria-label="Permalink: Networking" href="#networking"></a></p>
<p dir="auto">This has been more tricky than I first thought! My current approach here is to fingerprint the Meta Raybans over Bluetooth low-energy (BLE) advertisements. But, <strong>I have only been able to detect BLE traffic during 1) pairing 2) powering-on</strong>. I sometimes also see the advertisement as they are taken out of the case (while already powered on), but not consistently.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/NullPxl/banrays/blob/main/ble_detect.jpg"><img src="https://github.com/NullPxl/banrays/raw/main/ble_detect.jpg" alt=""></a></p>
<p dir="auto">The goal is to detect them during usage when they're communicating with the paired phone, but to see this type of directed BLE traffic it seems like I would first need to see the <code>CONNECT_REQ</code> packet which has information as to what which of the communication channels to hop between in sync. I don't think what I currently have (ESP32) is set up to do this kind of following.</p>
<ul dir="auto">
<li>potentially can use an <a href="https://www.nordicsemi.com/Products/Development-tools/nRF-Sniffer-for-Bluetooth-LE" rel="nofollow">nRF module</a> for this</li>
</ul>
<p dir="auto">For any of the bluetooth classic (BTC) traffic, unfortunately the hardware seems a bit more involved (read: expensive). So if I want to do down this route, I'll likely need a more clever solution here.</p>
<p dir="auto">When turned on or put into pairing mode (or sometimes when taken out of the case), I can detect the device through advertised manufacturer data and service UUIDs. <code>0x01AB</code> is a Meta-specific SIG-assigned ID (assigned by the Bluetooth standards body), and <code>0xFD5F</code> in the Service UUID is assigned to Meta as well.</p>
<p dir="auto">capture when the glasses are powered on:</p>
<div data-snippet-clipboard-copy-content="[01:07:06] RSSI: -59 dBm
Address: XX:XX:XX:XX:XX:XX
Name: Unknown

META/LUXOTTICA DEVICE DETECTED!
  Manufacturer: Meta (0x01AB)
  Service UUID: Meta (0xFD5F) (0000fd5f-0000-1000-8000-00805f9b34fb)

Manufacturer Data:
  Company ID: Meta (0x01AB)
  Data: 020102102716e4

Service UUIDs: ['0000fd5f-0000-1000-8000-00805f9b34fb']"><pre><code>[01:07:06] RSSI: -59 dBm
Address: XX:XX:XX:XX:XX:XX
Name: Unknown

META/LUXOTTICA DEVICE DETECTED!
  Manufacturer: Meta (0x01AB)
  Service UUID: Meta (0xFD5F) (0000fd5f-0000-1000-8000-00805f9b34fb)

Manufacturer Data:
  Company ID: Meta (0x01AB)
  Data: 020102102716e4

Service UUIDs: ['0000fd5f-0000-1000-8000-00805f9b34fb']
</code></pre></div>
<p dir="auto">IEEE assigns certain MAC address prefixes (OUI, 'Organizationally Unique Identifier'), but these addresses get randomized so I don't expect them to be super useful for BLE.</p>
<p dir="auto">Here's some links to more data if you're curious:</p>
<ul dir="auto">
<li><a href="https://www.bluetooth.com/wp-content/uploads/Files/Specification/HTML/Assigned_Numbers/out/en/Assigned_Numbers.pdf" rel="nofollow">https://www.bluetooth.com/wp-content/uploads/Files/Specification/HTML/Assigned_Numbers/out/en/Assigned_Numbers.pdf</a></li>
<li><a href="https://gitlab.com/wireshark/wireshark/-/blob/99df5f588b38cc0964f998a6a292e81c7dcf0800/epan/dissectors/packet-bluetooth.c" rel="nofollow">https://gitlab.com/wireshark/wireshark/-/blob/99df5f588b38cc0964f998a6a292e81c7dcf0800/epan/dissectors/packet-bluetooth.c</a></li>
<li><a href="https://www.netify.ai/resources/macs/brands/meta" rel="nofollow">https://www.netify.ai/resources/macs/brands/meta</a></li>
</ul>
<p dir="auto">TODO:</p>
<ul dir="auto">
<li>Read: <a href="https://dl.acm.org/doi/10.1145/3548606.3559372" rel="nofollow">https://dl.acm.org/doi/10.1145/3548606.3559372</a></li>
<li>try active probing/interrogating</li>
</ul>
<hr>
<p dir="auto">Thanks to Trevor Seets and Junming Chen for their advice in optics and BLE (respectively). Also to Sohail for lending me meta raybans to test with.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Pocketbase – open-source realtime back end in 1 file (506 pts)]]></title>
            <link>https://pocketbase.io/</link>
            <guid>46075320</guid>
            <pubDate>Fri, 28 Nov 2025 03:45:04 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://pocketbase.io/">https://pocketbase.io/</a>, See on <a href="https://news.ycombinator.com/item?id=46075320">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>    <div data-wave-pattern-credits="https://www.freepik.com/author/garrykillian"><div data-svelte-h="svelte-8c4w4v"><p>Open Source backend</p> <p><strong>in 1 file</strong></p></div> <div data-svelte-h="svelte-1ydfhff"><p><i></i> <span>Realtime database</span></p> <p><i></i> <span>Authentication</span></p> <p><i></i> <span>File storage</span></p> <p><i></i> <span>Admin dashboard</span></p></div> <figure> <div><p><img data-gopher-credits="https://github.com/marcusolsson/gophers" src="data:image/png;base64,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" alt="Gopher" width="69" height="90"></p> </div> <img src="data:image/png;base64,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" alt="PocketBase dashboard preview" width="1140" height="636"> </figure></div>  <div><section><h2 data-svelte-h="svelte-x1beqb">Ready to use out of the box</h2> <div><nav>    <a href="https://pocketbase.io/docs" data-svelte-h="svelte-idt8cr"><span>Explore all features</span> <i></i></a></nav> <div> <p><code><!-- HTML_TAG_START --><span>// JavaScript SDK</span>
<span>import</span> PocketBase <span>from</span> <span>'pocketbase'</span><span>;</span>

<span>const</span> pb <span>=</span> <span>new</span> <span>PocketBase</span><span>(</span><span>'http://127.0.0.1:8090'</span><span>)</span><span>;</span>

<span>...</span>

<span>// list and search for 'example' collection records</span>
<span>const</span> list <span>=</span> <span>await</span> pb<span>.</span><span>collection</span><span>(</span><span>'example'</span><span>)</span><span>.</span><span>getList</span><span>(</span><span>1</span><span>,</span> <span>100</span><span>,</span> <span>{</span>
    <span>filter</span><span>:</span> <span>'title != "" &amp;&amp; created &gt; "2022-08-01"'</span><span>,</span>
    <span>sort</span><span>:</span> <span>'-created,title'</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>// or fetch a single 'example' collection record</span>
<span>const</span> record <span>=</span> <span>await</span> pb<span>.</span><span>collection</span><span>(</span><span>'example'</span><span>)</span><span>.</span><span>getOne</span><span>(</span><span>'RECORD_ID'</span><span>)</span><span>;</span>

<span>// delete a single 'example' collection record</span>
<span>await</span> pb<span>.</span><span>collection</span><span>(</span><span>'example'</span><span>)</span><span>.</span><span>delete</span><span>(</span><span>'RECORD_ID'</span><span>)</span><span>;</span>

<span>// create a new 'example' collection record</span>
<span>const</span> newRecord <span>=</span> <span>await</span> pb<span>.</span><span>collection</span><span>(</span><span>'example'</span><span>)</span><span>.</span><span>create</span><span>(</span><span>{</span>
    <span>title</span><span>:</span> <span>'Lorem ipsum dolor sit amet'</span><span>,</span>
<span>}</span><span>)</span><span>;</span>

<span>// subscribe to changes in any record from the 'example' collection</span>
pb<span>.</span><span>collection</span><span>(</span><span>'example'</span><span>)</span><span>.</span><span>subscribe</span><span>(</span><span>'*'</span><span>,</span> <span>function</span> <span>(</span><span>e</span><span>)</span> <span>{</span>
    console<span>.</span><span>log</span><span>(</span>e<span>.</span>record<span>)</span><span>;</span>
<span>}</span><span>)</span><span>;</span>

<span>// stop listening for changes in the 'example' collection</span>
pb<span>.</span><span>collection</span><span>(</span><span>'example'</span><span>)</span><span>.</span><span>unsubscribe</span><span>(</span><span>)</span><span>;</span><!-- HTML_TAG_END --></code> </p></div></div></section> <section><h2 data-svelte-h="svelte-nyj4px">Integrate nicely with your favorite frontend stack</h2> <p><a href="https://github.com/pocketbase/dart-sdk" target="_blank" rel="noreferrer noopener" data-svelte-h="svelte-4vpdzw"><img src="https://pocketbase.io/images/flutter_logo.svg?v2" alt="Flutter logo" width="40" height="50"></a> <a href="https://github.com/pocketbase/js-sdk" target="_blank" rel="noreferrer noopener" data-svelte-h="svelte-ub686t"><img src="https://pocketbase.io/images/svelte_logo.svg?v2" alt="Svelte logo" width="41" height="50"></a> <a href="https://github.com/pocketbase/js-sdk" target="_blank" rel="noreferrer noopener" data-svelte-h="svelte-1x1338t"><img src="https://pocketbase.io/images/vue_logo.svg?v2" alt="Vue logo" width="53" height="46"></a> <a href="https://github.com/pocketbase/js-sdk" target="_blank" rel="noreferrer noopener" data-svelte-h="svelte-c3cg59"><img src="https://pocketbase.io/images/react_logo.svg?v2" alt="React logo" width="57" height="51"></a> <a href="https://github.com/pocketbase/js-sdk" target="_blank" rel="noreferrer noopener" data-svelte-h="svelte-8srn1b"><img src="https://pocketbase.io/images/angular_logo.svg?v2" alt="Angular logo" width="47" height="50"></a></p></section></div>  
			
			
		</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[China's BEV trucks and the end of diesel's dominance (124 pts)]]></title>
            <link>https://cleantechnica.com/2025/11/26/chinas-bev-trucks-and-the-end-of-diesels-dominance/</link>
            <guid>46075305</guid>
            <pubDate>Fri, 28 Nov 2025 03:40:52 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cleantechnica.com/2025/11/26/chinas-bev-trucks-and-the-end-of-diesels-dominance/">https://cleantechnica.com/2025/11/26/chinas-bev-trucks-and-the-end-of-diesels-dominance/</a>, See on <a href="https://news.ycombinator.com/item?id=46075305">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
	<hr>

<p><strong><em>Support CleanTechnica's work through <a href="https://cleantechnica.substack.com/subscribe" target="_blank">a Substack subscription</a> or <a href="https://cleantechnica.fundjournalism.org/contribute/" target="_blank">on Stripe</a>.</em></strong></p><hr>

<p>Cheap Chinese battery electric heavy trucks are no longer a rumor. They are real machines with real price tags that are so low that they force a reassessment of what the global freight industry is willing to pay for electrification. Standing in a commercial vehicle hall in Wuhan and seeing a 400 kWh or 600 kWh truck priced between €58,000 and €85,000, as my European freight trucking electrification contact <a href="https://www.linkedin.com/posts/johnnynijenhuisetruck_johnnyinchina-activity-7399133525314281473-vW50?utm_source=share&amp;utm_medium=member_desktop&amp;rcm=ACoAAAABbtwBpXWZZtB8v6K_lwf8yVP9nmwrGyI">Johnny Nijenhuis recently did</a>, changes the frame of the entire conversation. These are not diesel frames with a battery box welded underneath. They are purpose built electric trucks built around LFP packs, integrated e-axles and the simplified chassis architecture that becomes possible when the engine bay, gearbox, diesel tank, emissions controls and half of the mechanical complexity of a truck disappear. Anyone who has worked with heavy vehicles knows the cost structure of diesel powertrains. Removing that entire system while building at very large scale produces numbers that do not match Western experience.</p>
<p>China’s low price electric trucks do not arrive as finished products for Europe or North America. They need work. Western short haul freight fleets expect certain features that Chinese domestic buyers usually skip. Tires need to carry E-mark or FMVSS certification. Electronic stability controls must meet UNECE R13 or FMVSS 121. Cab structures need to meet R29 or similar requirements. Crash protection for battery packs needs to satisfy R100 or FMVSS 305. European drivers expect better seats, quieter cabs and stronger HVAC. Even in short haul work, fleets expect well understood advanced driver assistance (ADAS) features to handle traffic and depot work. However, inexpensive Chinese leaf springs are just fine for short haul trucking given the serious upgrade to driver comfort and truck performance of battery electric drivetrains.</p>
<p>When these adjustments are added into the bill of materials and spread across a production run, the upgrades land in the €20,000 to €40,000 range for short haul duty, per my rough estimate. That moves the landed price up to roughly €80,000 to €120,000. The comparison with Western OEM offerings is stark because Western battery electric trucks today often start near €250,000 and can move far higher once options and charging hardware are included. A short haul operator looking at the difference between a €100,000 truck and a €300,000 truck will ask which one meets the actual duty cycle. For operators with depot charging and predictable delivery routes, the cheaper truck is credible in a way that few expected even three years ago.</p>
<p>The long haul story is different. European and North American long haul operators require far more from a truck than a Chinese domestic short range tractor offers. Axle loads need to support 40 to 44 ton gross combined weight. Suspension needs to manage high speed stability for many hours a day on roads built for 80 to 100 km/h cruising. Cab structures must handle fatigue and cross winds on long corridors. Drivers spend nights sleeping in the cab and expect western comfort standards. Trailer interfaces require specific electrical and pneumatic systems that have to meet long established norms. Battery safety systems need to be built for high speed impacts and rollover events. All of that requires a larger budget. The gap between a domestic Chinese tractor and a European or North American long haul tractor is roughly €80,000 to €120,000 once all mechanical, safety and comfort systems are brought to the required levels per my estimate. That does not erase the cost advantage, because even a €180,000 Chinese based long haul electric truck is cheaper than many Western models, but it does shift the choice from simple purchase price to service expectations and lifetime durability.</p>
<p>Most freight is not long haul. <a href="https://cleantechnica.com/2025/04/06/france-germanys-economic-councils-endorse-electric-trucks-over-hydrogen/">French and German economic councils</a> have both looked at freight movements through national data and concluded that the majority of truck trips and ton kilometers occur in short haul service. This includes urban deliveries, regional distribution, logistics shuttles between depots and ports, construction supply and waste collection. These trips are usually under 250 km, begin and end at the same depot and involve repeated stop-start movement where electric drivetrains perform well. The idea that the heavy trucking problem is a long haul problem has shaped Western investment priorities for a decade, but national economic councils in Europe now argue that solving short haul electrification first delivers most of the benefit. The fact that low cost Chinese battery electric trucks map almost perfectly onto these duty cycles suggests that they will find receptive markets once import pathways are established.</p>
<figure id="attachment_364527" aria-describedby="caption-attachment-364527"><img decoding="async" src="https://cleantechnica.com/wp-content/uploads/2025/11/Heavy-Trucks-in-Transition-in-China.png" alt="Chart of heavy truck sales in China assembled by author" width="1082" height="668" srcset="https://cleantechnica.com/wp-content/uploads/2025/11/Heavy-Trucks-in-Transition-in-China.png 1082w, https://cleantechnica.com/wp-content/uploads/2025/11/Heavy-Trucks-in-Transition-in-China-400x247.png 400w, https://cleantechnica.com/wp-content/uploads/2025/11/Heavy-Trucks-in-Transition-in-China-800x494.png 800w, https://cleantechnica.com/wp-content/uploads/2025/11/Heavy-Trucks-in-Transition-in-China-768x474.png 768w" sizes="(max-width: 1082px) 100vw, 1082px"><figcaption id="caption-attachment-364527">Chart of heavy truck sales in China assembled by author</figcaption></figure>
<p>China’s shift away from diesel in the heavy truck segment is dramatic. The country sold more than 900,000 heavy trucks in 2024. Diesel’s share fell to about 57% that year. Natural gas trucks rose to around 29%. Battery electric trucks reached 13%. Early 2025 data points to battery electric share rising again to about 22% of new heavy truck sales, with diesel falling close to the 50% mark. These shifts are large movements inside a very conservative sector. Natural gas trucks saw a rapid rise between 2022 and 2024 as operators chased lower fuel prices and simpler emissions compliance, but the price war in battery electric trucks has made electric freight attractive for many of the same operators. Gas trucks still fill some niches, but the pattern suggests that they may face the same pressure that diesel trucks face. Electric trucks with low running costs and high cycle life begin to look compelling to operators once the purchase price falls into a familiar range.</p>
<p>Western OEMs entered China with hopes of capturing a share of the largest truck market in the world, but the results have been mixed. Joint ventures like Foton Daimler once offered a bridge into domestic heavy trucking, yet the rapid rise of low cost local manufacturers in both diesel and electric segments has eroded that position. Western models arrived with higher prices and platforms optimized for different regulations and freight conditions. As domestic OEMs expanded capacity and cut costs, the market shifted toward local brands in every drivetrain category. The impact is clear. Western firms now face reduced market share, weaker margins and strategic uncertainty about long term participation in China’s truck sector.</p>
<p>Underlying these drivetrain transitions is a heavy truck market that is smaller and more complicated than it was five years ago. The peak in 2020, with roughly 1.6 million heavy trucks sold, was not a normal year. It was driven by a large regulatory pre-buy that pulled forward sales before tighter emissions rules arrived. The freight economy was also stronger at that time and the construction sector had not yet entered its recent slowdown. As those drivers faded, the market returned to what looks like a long term equilibrium between 800,000 and one million trucks per year. Several confounding factors overlap in this period. Freight volumes shifted. Rail took a larger share of bulk transport as China achieved what North America and Europe have only talked about, mode shifting. Replacement cycles grew longer. Real estate and construction slowed. Diesel’s loss of share is partly driven by these economic factors and partly driven by the arrival of cheaper alternatives. It is difficult to separate the exact contribution of each. The net result is a natural market size that is much lower than the 2020 peak and a much more competitive fight inside the remaining market.</p>
<p>Hydrogen heavy truck sales in China show a pattern of stalling growth followed by early signs of decline in 2025. Registration data and industry reports indicate that fuel cell heavy trucks were less than 1% of the heavy truck market in 2024, amounting to low single digit thousands of vehicles, and most of these were tied to provincial demonstration subsidies rather than broad fleet adoption. In the first half of 2025 the number of registered hydrogen trucks rose slightly on paper, but analysts inside China noted that real world operation rates were low and that several local programs were winding down as subsidies tightened. At the same time battery electric heavy trucks climbed from 13% of new sales in 2024 to 22% in early 2025. Hydrogen heavy trucks are losing ground inside a market that is moving quickly toward lower cost electric models, and operators are stepping away from fuel cell platforms as more credible electric options appear. I didn’t bother to include hydrogen on the truck statistics chart as it’s a rounding error and not increasing.</p>
<p>One indicator that connects these pieces is diesel consumption. China’s diesel use dropped by about 11% year over year at one point in 2024, which is not a small shift in a country with heavy commercial transport. Part of the drop was due to economic slowing in trucking dominant sectors, but the rise of LNG trucks and electric trucks also contributed. When a truck that once burned diesel every day is replaced by a gas or battery electric truck, national fuel consumption reacts quickly. The fuel market sees these changes earlier than the headline truck sales numbers because thousands of trucks operating every day create a measurable signal in fuel demand. The data is consistent with a freight system that is changing in composition and technology at a pace that would have seemed unlikely a few years earlier.</p>
<p>Western operators have to look at this landscape with practical questions in mind. The leading electric bus manufacturer in Europe is Chinese because it built functional electric buses at lower prices before Western firms did. There is no reason the same pattern will not repeat in trucks. Once the cost of a short haul electric truck falls near the cost of a diesel truck, operators will start to buy them. If the imported option is much cheaper than the domestic option, early fleets will run the numbers and make decisions based on cash flow and reliability. Western OEMs face challenges in this environment because their legacy designs and cost structures are not tuned for the kind of price war that emerged in China. They need to match cost while preserving safety and service expectations, which is difficult while shifting from a century of diesel design to a new electric architecture.</p>
<p>Western OEMs entered the electric truck market with the platforms they already understood. Most began by taking a diesel tractor frame, removing the engine and gearbox and adding batteries, motors and the associated power electronics. This approach kept production lines moving and reduced near term engineering risk, but it produced electric trucks that carried the compromises of diesel architecture. Battery boxes hung from ladder frames, wiring loops wound through spaces never designed for high voltage systems and weight distribution was optimized for a drivetrain that no longer existed. Several OEMs even explored hydrogen drivetrains inside the same basic frames, which locked in the limitations of a platform built around an internal combustion engine. The results were heavier trucks with less space for batteries, higher costs and lower overall efficiency.</p>
<p>The shift toward purpose built electric tractors is only now underway among the major Western OEMs. Volvo’s FH Electric and FM Electric, Daimler’s eActros 300 and 600, Scania’s new battery electric regional tractor and MAN’s eTruck all represent clean sheet or near clean sheet electric designs with integrated drivetrains and optimized battery packaging. These models move Western OEMs closer to the design philosophy that Chinese manufacturers adopted earlier, where the entire platform is built around the electric driveline from the start.</p>
<p>China has moved faster toward battery electric heavy trucks than any other major market. It built supply chains for motors, inverters, LFP cells, structural packs and integrated e-axles. It created standard designs and cut costs through volume. It encouraged competition. It is now exporting electric trucks into Asia, Latin America and Africa. Europe and North America are watching this unfold while debating the right charging standards and duty cycle models. The arrival of low cost electric trucks from China raises uncomfortable questions for Western OEMs and policymakers, but it also provides an opportunity. If freight electrification can happen at one third the expected cost, then the pace of decarbonization can be much faster. The challenge is deciding how to integrate or respond to the cost structure that China has already built.</p>
<p>The story of heavy trucking is no longer a slow migration from diesel to a distant alternative. The transition is already underway at scale inside the world’s largest heavy truck market. It does not look like the long haul hydrogen scenario that dominated Western modelling for the last decade. It looks like battery electric trucks built cheaply and deployed quickly into short haul service. The economic logic is straightforward. The operational fit is strong. The supply chain is built. The lesson for Western operators and policymakers is that the cost curve has shifted. The decisions that made sense even in 2024 do not match the realities of 2025. The market is moving toward electric freight because it is becoming cheaper than diesel across the majority of real world duty cycles. From the short haul electric trucks will come the new generation of long haul trucks, as night follows day. The arrival of low cost battery trucks from China marks the beginning of a new phase in freight decarbonization.</p>
<div>

<hr>

<p><em>Sign up for <a href="https://cleantechnica.substack.com/subscribe" target="_blank">CleanTechnica's Weekly Substack for Zach and Scott's in-depth analyses and high level summaries</a>, sign up for <a href="https://mailchi.mp/cleantechnica/daily-newsletter">our daily newsletter</a>, and <a href="https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFV05zWldGdWRHVmphRzVwWTJFdVkyOXRLQUFQAQ">follow us on Google News</a>!</em></p><hr>

<center><bold>Advertisement</bold></center>

<center><!-- CT new after-post -->
<ins data-ad-client="ca-pub-1552008901061842" data-ad-slot="4461458457"></ins>
</center>&nbsp;

<hr>

<p><em>Have a tip for CleanTechnica? Want to advertise? Want to suggest a guest for our CleanTech Talk podcast? <a href="https://cleantechnica.com/contact/">Contact us here</a>.</em></p><hr>

<p><em>Sign up for our daily newsletter for <a target="_blank" href="https://mailchi.mp/cleantechnica/daily-newsletter">15 new cleantech stories a day</a>. Or sign up for <a target="_blank" href="https://mailchi.mp/cleantechnica/weekly-newsletter">our weekly one on top stories of the week</a> if daily is too frequent.</em></p><hr>

<iframe width="840" height="472" src="https://www.youtube.com/embed/R3ABZ_IIdRM?si=cR0-Y0TginhVg7jB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>

<hr>

<p><em><span>CleanTechnica uses affiliate links. See our policy <a href="https://cleantechnica.com/cleantechnica-editorial-ethics/">here</a>.</span></em></p><p><b><em><a href="https://cleantechnica.com/cleantechnica-comment-policy/">CleanTechnica's Comment Policy</a></em></b></p>

<hr>

</div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How Charles M Schulz created Charlie Brown and Snoopy (2024) (163 pts)]]></title>
            <link>https://www.bbc.com/culture/article/20241205-how-charles-m-schulz-created-charlie-brown-and-snoopy</link>
            <guid>46074362</guid>
            <pubDate>Fri, 28 Nov 2025 00:10:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bbc.com/culture/article/20241205-how-charles-m-schulz-created-charlie-brown-and-snoopy">https://www.bbc.com/culture/article/20241205-how-charles-m-schulz-created-charlie-brown-and-snoopy</a>, See on <a href="https://news.ycombinator.com/item?id=46074362">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p><b id="charles-m-schulz-drew-his-beloved-peanuts-strip-for-50-years-until-his-announcement-on-14-december-1999-that-ill-health-was-forcing-him-to-retire.-in-history-looks-at-how-an-unassuming-cartoonist-built-a-billion-dollar-empire-out-of-the-lives-of-a-group-of-children,-a-dog-and-a-bird.">Charles M Schulz drew his beloved Peanuts strip for 50 years until his announcement on 14 December 1999 that ill health was forcing him to retire. In History looks at how an unassuming cartoonist built a billion-dollar empire out of the lives of a group of children, a dog and a bird.</b></p><p>Charles M Schulz's timeless creation Charlie Brown may have been as popular as any character in all of literature, but the cartoonist was modest about the scope of his miniature parables. In a 1977 BBC interview, he said: "I'm talking only about the minor everyday problems in life. Leo Tolstoy dealt with the major problems of the world. I'm only dealing with why we all have the feeling that people don't like us."&nbsp;&nbsp;</p><p>This did not mean that he felt as if he was dealing with trivial matters. He said: "I'm always very much offended when someone asks me, 'Do I ever do satire on the social condition?' Well, I do it almost every day. And they say, 'Well, do you ever do political things?' I say, 'I do things which are more important than politics. I'm dealing with love and hate and mistrust and fear and insecurity.'"&nbsp;&nbsp;</p><div><figcaption>WATCH: 'Cartooning is drawing funny pictures whether they're silly or rather meaningful political cartoons'.</figcaption></div><p>While Charlie Brown may have been the eternal failure, the universal feelings that Schulz channelled helped make <a target="_self" href="https://www.bbc.com/culture/article/20181112-good-grief-the-beguiling-philosophy-of-peanuts">Peanuts</a> a global success. Born in 1922, Schulz drew every single Peanuts strip himself from 1950 until his death in February 2000. It was so popular that Nasa named two of the modules in its May 1969 <a target="_self" href="https://www.bbc.co.uk/programmes/articles/4M9zXf4hWZhHMdhZrDhn472/seven-things-you-might-not-know-about-peanuts">Apollo 10 lunar mission</a> after Charlie Brown and Snoopy. The strip was syndicated in more than 2,600 newspapers worldwide, and inspired films, music and countless items of merchandise.&nbsp;</p><p>Part of its success, according to the writer Umberto Eco, was that it worked on different levels. <a target="_blank" href="http://:%20https:/www.nybooks.com/articles/1985/06/13/on-krazy-kat-and-peanuts/">He wrote</a>: "Peanuts charms both sophisticated adults and children with equal intensity, as if each reader found there something for himself, and it is always the same thing, to be enjoyed in two different keys. Peanuts is thus a little human comedy for the innocent reader and for the sophisticated."&nbsp;</p><p>Schulz's initial reason for focusing on children in the strip was strictly commercial. In 1990, he <a target="_blank" href="https://www.facebook.com/BBCArchive/videos/139456464818589/">told the BBC</a>: "I always hate to say it, but I drew little kids because this is what sold. I wanted to draw something, I didn't know what it was, but it just seemed as if whenever I drew children, these were the cartoons that editors seemed to like the best. And so, back in 1950, I mailed a batch of cartoons to New York City, to United Features Syndicate, and they said they liked them, and so ever since I've been drawing little kids."&nbsp;&nbsp;</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Bird flu viruses are resistant to fever, making them a major threat to humans (159 pts)]]></title>
            <link>https://medicalxpress.com/news/2025-11-bird-flu-viruses-resistant-fever.html</link>
            <guid>46074286</guid>
            <pubDate>Thu, 27 Nov 2025 23:57:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://medicalxpress.com/news/2025-11-bird-flu-viruses-resistant-fever.html">https://medicalxpress.com/news/2025-11-bird-flu-viruses-resistant-fever.html</a>, See on <a href="https://news.ycombinator.com/item?id=46074286">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
									    
<div data-thumb="https://scx1.b-cdn.net/csz/news/tmb/2023/chicken-farm-1.jpg" data-src="https://scx2.b-cdn.net/gfx/news/hires/2023/chicken-farm-1.jpg" data-sub-html="Credit: Unsplash/CC0 Public Domain">
        <figure>
            <img src="https://scx1.b-cdn.net/csz/news/800a/2023/chicken-farm-1.jpg" alt="chicken farm" title="Credit: Unsplash/CC0 Public Domain" width="800" height="530">
             <figcaption>
                Credit: Unsplash/CC0 Public Domain
            </figcaption>        </figure>
    </div><p>Bird flu viruses are a particular threat to humans because they can replicate at temperatures higher than a typical fever, one of the body's ways of stopping viruses in their tracks, according to new research led by the universities of Cambridge and Glasgow.</p>

                                        
                                                                                  
                                         
										    


                                                                                                                                    <p>In a study published today in <i>Science</i>, the team identified a gene that plays an important role in setting the temperature sensitivity of a virus. In the deadly pandemics of 1957 and 1968, this gene transferred into human flu viruses, and the resulting virus thrived.</p>
<h2>How flu viruses thrive in the body</h2>
<p>Human flu viruses cause millions of infections every year. The most common types of these viruses, which cause seasonal flu, are known as influenza A viruses. They tend to thrive in the upper respiratory tract, where the temperature is around 33°C, rather than deep in the lungs in the lower respiratory tract, where the temperature is around 37°C.</p>
<p>Unchecked, a virus will replicate and spread throughout the body, where it can cause illness, occasionally severe. One of the body's self-defense mechanisms is fever, which can cause our body temperature to reach as high as 41°C, though until now it has not been clear how fever stops viruses—and why some viruses can survive.</p>
<p>Unlike human flu viruses, avian influenza viruses tend to thrive in the lower respiratory tract. In fact, in their natural hosts, which include ducks and seagulls, the virus often infects the gut, where temperatures can be as high as 40°C–42°C.</p>
<h2>Research methods and findings</h2>
<p>In previous studies using cultured cells, scientists have shown that avian influenza viruses appear more resistant to temperatures typically seen in fever in humans. Today's study uses in vivo models—mice infected with influenza viruses—to help explain how fever protects us and why it may not be enough to protect us against avian influenza.</p>

                                                                                                        
    
                                                                                                                                                                                                <p>An international team led by scientists in Cambridge and Glasgow simulated in mice what happens during a fever in response to influenza infections. To carry out the research, they used a laboratory-adapted influenza virus of human origin, known as PR8, which does not pose a risk to humans.</p>
<p>Although mice do not typically develop fever in response to influenza A viruses, the researchers were able to mimic its effect on the virus by raising the ambient temperature where the mice were housed (elevating the body temperature of the mice).</p>
<p>The researchers showed that raising body temperature to fever levels is effective at stopping human-origin flu viruses from replicating, but it is unlikely to stop avian flu viruses. Fever protected against severe infection from human-origin flu viruses, with just a 2°C increase in body temperature enough to turn a lethal infection into a mild disease.</p>
<p>The research also revealed that the PB1 gene of the virus, important in the replication of the virus genome inside infected cells, plays a key role in setting the temperature-sensitivity. Viruses carrying an avian-like PB1 gene were able to withstand the high temperatures associated with fever, and caused severe illness in the mice. This is important, because human and bird flu viruses can "swap" their genes when they co-infect a host at the same time, for example when both viruses infect pigs.</p>

                                                                                                                                            <h2>Expert perspectives and implications</h2>
<p>Dr. Matt Turnbull, the first author of the study, from the Medical Research Council Center for Virus Research at the University of Glasgow said, "The ability of viruses to swap genes is a continued source of threat from emerging flu viruses. We've seen it happen before during previous pandemics, such as in 1957 and 1968, where a human virus swapped its PB1 gene with that from an avian strain. This may help explain why these pandemics caused serious illness in people.</p>
<p>"It's crucial that we monitor bird flu strains to help us prepare for potential outbreaks. Testing potential spillover viruses for how resistant they are likely to be to fever may help us identify more virulent strains."</p>
<p>Senior author Professor Sam Wilson, from the Cambridge Institute of Therapeutic Immunology and Infectious Disease at the University of Cambridge, said, "Thankfully, humans don't tend to get infected by bird flu viruses very frequently, but we still see dozens of human cases a year. Bird flu fatality rates in humans have traditionally been worryingly high, such as in historic H5N1 infections that caused more than 40% mortality.</p>
<p>"Understanding what makes bird flu viruses cause serious illness in humans is crucial for surveillance and pandemic preparedness efforts. This is especially important because of the pandemic threat posed by avian H5N1 viruses."</p>
<p>The findings may have implications for the treatment of infections, though the team stresses that more research is needed before changes are considered for treatment guidelines. Fever is often treated with antipyretic medications, which include ibuprofen and aspirin. However, there is clinical evidence that treating fever may not always be beneficial to the patient and may even promote transmission of influenza A viruses in humans.</p>

                                                                                                                                    
                                                                                
                                        											<div>
												                                                    <p><strong>More information:</strong>
                                                    Matt Turnbull et al, Avian-origin influenza A viruses tolerate elevated pyrexic temperatures in mammals, <i>Science</i> (2025). <a data-doi="1" href="https://dx.doi.org/10.1126/science.adq4691" target="_blank">DOI: 10.1126/science.adq4691</a>
																								
																								</p>
																							</div>
                                        											
																					
                                                                                                                        
                                        <!-- print only -->
                                        <div>
                                            <p><strong>Citation</strong>:
                                                 Bird flu viruses are resistant to fever, making them a major threat to humans (2025, November 27)
                                                 retrieved 28 November 2025
                                                 from https://medicalxpress.com/news/2025-11-bird-flu-viruses-resistant-fever.html
                                            </p>
                                            <p>
                                            This document is subject to copyright. Apart from any fair dealing for the purpose of private study or research, no
                                            part may be reproduced without the written permission. The content is provided for information purposes only.
                                            </p>
                                        </div>
                                        
									</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Vsora Jotunn-8 5nm European inference chip (154 pts)]]></title>
            <link>https://vsora.com/products/jotunn-8/</link>
            <guid>46074111</guid>
            <pubDate>Thu, 27 Nov 2025 23:30:11 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://vsora.com/products/jotunn-8/">https://vsora.com/products/jotunn-8/</a>, See on <a href="https://news.ycombinator.com/item?id=46074111">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-id="40fd0e6" data-element_type="container" data-settings="{&quot;background_background&quot;:&quot;classic&quot;,&quot;motion_fx_motion_fx_scrolling&quot;:&quot;yes&quot;,&quot;motion_fx_devices&quot;:[&quot;desktop&quot;,&quot;tablet&quot;,&quot;mobile&quot;]}">
		<div data-id="3203a64" data-element_type="container" data-widget_type="text-editor.default">
				<p>In the world of AI data centers, speed, efficiency, and scale aren’t optional—they’re everything. Jotunn8, our ultra-high-performance inference chip is built to deploy trained models with lightning-fast throughput, minimal cost, and maximum scalability. Designed around what matters most—performance, cost-efficiency, and sustainability—they deliver the power to run AI at scale, without compromise!</p>
				</div>
		<div data-id="9d98324" data-element_type="container" data-widget_type="text-editor.default" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
				<p>Why it matters: Critical for real-time applications like chatbots, fraud detection, and search.</p>
				</div>
		<div data-id="18b2ad5" data-element_type="container" data-widget_type="text-editor.default">
				<p>Reasoning models, Generative AI and Agentic AI are increasingly being combined to build more capable and reliable systems. Generative AI provide flexibility and language fluency. Reasoning models provide rigor and correctness. Agentic frameworks provide autonomy and decision-making. The VSORA architecture enables smooth and easy integration of these algorithms, providing near-theory performance.</p>
				</div>
		<div data-id="6edb84f" data-element_type="container" data-widget_type="text-editor.default" data-settings="{&quot;background_background&quot;:&quot;classic&quot;}">
				<p>Why it matters: AI inference is often run at massive scale – reducing cost per inference is essential for business viability.</p>
				</div>
				</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[250MWh 'Sand Battery' to start construction in Finland (310 pts)]]></title>
            <link>https://www.energy-storage.news/250mwh-sand-battery-to-start-construction-in-finland-for-both-heating-and-ancillary-services/</link>
            <guid>46073855</guid>
            <pubDate>Thu, 27 Nov 2025 22:48:44 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.energy-storage.news/250mwh-sand-battery-to-start-construction-in-finland-for-both-heating-and-ancillary-services/">https://www.energy-storage.news/250mwh-sand-battery-to-start-construction-in-finland-for-both-heating-and-ancillary-services/</a>, See on <a href="https://news.ycombinator.com/item?id=46073855">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-id="7673aec" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[{&quot;jet_parallax_layout_image&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;_id&quot;:&quot;9297098&quot;,&quot;jet_parallax_layout_image_tablet&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_image_mobile&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_speed&quot;:{&quot;unit&quot;:&quot;%&quot;,&quot;size&quot;:50,&quot;sizes&quot;:[]},&quot;jet_parallax_layout_type&quot;:&quot;scroll&quot;,&quot;jet_parallax_layout_direction&quot;:&quot;1&quot;,&quot;jet_parallax_layout_fx_direction&quot;:null,&quot;jet_parallax_layout_z_index&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x&quot;:50,&quot;jet_parallax_layout_bg_x_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y&quot;:50,&quot;jet_parallax_layout_bg_y_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size&quot;:&quot;auto&quot;,&quot;jet_parallax_layout_bg_size_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_animation_prop&quot;:&quot;transform&quot;,&quot;jet_parallax_layout_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;]}]}" data-elementor-type="single-post" data-elementor-id="554" data-elementor-post-type="elementor_library">
					<div data-id="1305123" data-element_type="column">
						
				
				
				
				
				
				
				
				<div data-id="7d4060d" data-element_type="widget" data-widget_type="theme-post-content.default">
					<div>
<figure>
<figure><img fetchpriority="high" decoding="async" width="1024" height="632" data-id="91060" src="https://www.energy-storage.news/wp-content/uploads/2025/11/Screenshot-2025-11-26-110954-1024x632.jpg" alt="Polar Night Energy and Lahti Energia  are partnering on the Sand Battery project in Finland. Image: Polar Night Energy / Lahti Energia." srcset="https://www.energy-storage.news/wp-content/uploads/2025/11/Screenshot-2025-11-26-110954-1024x632.jpg 1024w, https://www.energy-storage.news/wp-content/uploads/2025/11/Screenshot-2025-11-26-110954-300x185.jpg 300w, https://www.energy-storage.news/wp-content/uploads/2025/11/Screenshot-2025-11-26-110954-768x474.jpg 768w, https://www.energy-storage.news/wp-content/uploads/2025/11/Screenshot-2025-11-26-110954.jpg 1278w" sizes="(max-width: 1024px) 100vw, 1024px"><figcaption>Polar Night Energy and Lahti Energia  are partnering on the Sand Battery project in Finland. Image: Polar Night Energy / Lahti Energia.</figcaption></figure>
</figure>



<p>Technology provider Polar Night Energy and utility Lahti Energia have partnered for a large-scale project using Polar’s ‘Sand Battery’ technology for the latter’s district heating network in Vääksy, Finland. </p>



<p>The project will have a heating power of 2MW and a thermal energy storage (TES) capacity of 250MW, making it a 125-hour system and the largest sand-based TES project once complete. </p>



<p>It will supply heat to Lahti Energia’s Vääksy district heating network but is also large enough to participate in Fingrid’s reserve and grid balancing markets. </p>



<p>Polar Night Energy’s technology works by heating a sand or a similar solid material using electricity, retaining that heat and then discharging that for industrial or heating use. </p></div><div><div><div>
<p>This article requires <span>Premium Subscription</span><span>Basic (FREE) Subscription</span></p>
<p>Already a subscriber? <a href="#">Sign In</a></p>
</div>
<div>
<h2>Try Premium for just $1</h2>
<ul>
<li><span></span><span>Full premium access for the first month at only $1</span></li>
<li><span></span><span>Converts to an annual rate after 30 days unless cancelled</span></li>
<li><span></span><span>Cancel anytime during the trial period</span></li>
</ul>

</div>
<div>
<h3>Premium Benefits</h3>
<ul>
<li><span></span><span>Expert industry analysis and interviews</span></li>
<li><span></span><span>Digital access to PV Tech Power journal</span></li>
<li><span></span><span>Exclusive event discounts</span></li>
</ul>

</div>
<div data-wk-call-status-user="guest">
<h3>Or continue reading this article for free</h3>

</div>
</div><div>



<p>The project will cut fossil-based emissions in the Vääksy district heating network by around 60% each year, by reducing natural gas use bu 80% and also decreasing wood chip consumption.</p>



<p>It follows Polar Night Energy <a href="https://www.energy-storage.news/100mwh-sand-battery-goes-into-commercial-operation-in-finland/">completing and putting a 1MW/100MWh Sand Battery TES project into commercial operations this summer</a>, for another utility&nbsp;Loviisan Lämpö. That project uses soapstone as its storage medium, a byproduct of ceramics production. </p>



<p>This latest project will use locally available natural sand, held in a container 14m high and 15m wide. Lahti Energia received a grant for the project from state body Business Finland.</p>



<p>Polar Night Energy will act as the main contractor for the construction project, with on-site work beginning in early 2026, and the Sand Battery will be completed in summer 2027.</p>



<p>“We want to offer our customers affordable district heating and make use of renewable energy in our heat production. The scale of this Sand Battery also enables us to participate in Fingrid’s reserve and grid balancing markets. As the share of weather-dependent energy grows in the grid, the Sand Battery will contribute to balancing electricity supply and demand”, says Jouni Haikarainen, CEO of Lahti Energia.</p>




</div></div>				</div>
				<div data-queried-id="91058|WP_Post" data-nav="{&quot;enabled&quot;:false,&quot;type&quot;:null,&quot;more_el&quot;:null,&quot;query&quot;:[],&quot;widget_settings&quot;:{&quot;lisitng_id&quot;:49216,&quot;posts_num&quot;:6,&quot;columns&quot;:1,&quot;columns_tablet&quot;:1,&quot;columns_mobile&quot;:1,&quot;column_min_width&quot;:240,&quot;column_min_width_tablet&quot;:240,&quot;column_min_width_mobile&quot;:240,&quot;inline_columns_css&quot;:false,&quot;is_archive_template&quot;:&quot;&quot;,&quot;post_status&quot;:[&quot;publish&quot;],&quot;use_random_posts_num&quot;:&quot;&quot;,&quot;max_posts_num&quot;:9,&quot;not_found_message&quot;:&quot;No data was found&quot;,&quot;is_masonry&quot;:false,&quot;equal_columns_height&quot;:&quot;&quot;,&quot;use_load_more&quot;:&quot;&quot;,&quot;load_more_id&quot;:&quot;&quot;,&quot;load_more_type&quot;:&quot;click&quot;,&quot;load_more_offset&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:0,&quot;sizes&quot;:[]},&quot;use_custom_post_types&quot;:&quot;&quot;,&quot;custom_post_types&quot;:[],&quot;hide_widget_if&quot;:&quot;empty_query&quot;,&quot;carousel_enabled&quot;:&quot;&quot;,&quot;slides_to_scroll&quot;:&quot;1&quot;,&quot;arrows&quot;:&quot;true&quot;,&quot;arrow_icon&quot;:&quot;fa fa-angle-left&quot;,&quot;dots&quot;:&quot;&quot;,&quot;autoplay&quot;:&quot;true&quot;,&quot;pause_on_hover&quot;:&quot;true&quot;,&quot;autoplay_speed&quot;:5000,&quot;infinite&quot;:&quot;true&quot;,&quot;center_mode&quot;:&quot;&quot;,&quot;effect&quot;:&quot;slide&quot;,&quot;speed&quot;:500,&quot;inject_alternative_items&quot;:&quot;&quot;,&quot;injection_items&quot;:[],&quot;scroll_slider_enabled&quot;:&quot;&quot;,&quot;scroll_slider_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;,&quot;mobile&quot;],&quot;custom_query&quot;:false,&quot;custom_query_id&quot;:&quot;&quot;,&quot;_element_id&quot;:&quot;&quot;,&quot;collapse_first_last_gap&quot;:false,&quot;list_tag_selection&quot;:&quot;&quot;,&quot;list_items_wrapper_tag&quot;:&quot;div&quot;,&quot;list_item_tag&quot;:&quot;div&quot;,&quot;empty_items_wrapper_tag&quot;:&quot;div&quot;}}" data-page="1" data-pages="1" data-listing-source="posts" data-listing-id="49216" data-query-id="" data-id="529fd35" data-element_type="widget" data-settings="{&quot;columns&quot;:&quot;1&quot;}" data-widget_type="jet-listing-grid.default"><div data-id="09bc75f" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[]}" data-elementor-type="jet-listing-items" data-elementor-id="49216" data-elementor-post-type="jet-engine" data-post-id="67927">
						
				
				
				<div data-id="e1a93b6" data-element_type="widget" data-widget_type="jet-listing-dynamic-field.default"><p>NH Collection Vittorio Veneto, Rome, Italy</p></div>
				<div data-id="7188b76" data-element_type="widget" data-widget_type="text-editor.default">
				<p>
									Across two packed days, the Summit focused on three core themes: revenue &amp; trading, the lifecycle of the battery, and optimisation tools. Attendees explored innovative strategies for enhancing asset performance and longevity, with a spotlight on key markets like Germany, Italy, and the UK. Stay tuned for details on the 2025 edition of the Battery Asset Management Summit Europe, where we’ll continue to chart the path forward for energy storage asset management.								</p>
				</div>
				
					</div><div data-id="09bc75f" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[]}" data-elementor-type="jet-listing-items" data-elementor-id="49216" data-elementor-post-type="jet-engine" data-post-id="49140">
						
				
				
				<div data-id="e1a93b6" data-element_type="widget" data-widget_type="jet-listing-dynamic-field.default"><p>InterContinental London - The O2, London, UK</p></div>
				<div data-id="7188b76" data-element_type="widget" data-widget_type="text-editor.default">
				<p>
									This isn’t just another summit – it’s our biggest and most exhilarating Summit yet! Picture this: immersive workshop spaces where ideas come to life, dedicated industry working groups igniting innovation, live podcasts sparking lively discussions, hard-hitting keynotes that will leave you inspired, and an abundance of networking opportunities that will take your connections to new heights!								</p>
				</div>
				
					</div></div>
				
				
				<div data-id="c456bdd" data-element_type="widget" data-widget_type="heading.default">
				<p>
					<h2>Read Next</h2>				</p>
				</div>
				<div data-queried-id="91058|WP_Post" data-nav="{&quot;enabled&quot;:false,&quot;type&quot;:null,&quot;more_el&quot;:null,&quot;query&quot;:[],&quot;widget_settings&quot;:{&quot;lisitng_id&quot;:513,&quot;posts_num&quot;:5,&quot;columns&quot;:1,&quot;columns_tablet&quot;:1,&quot;columns_mobile&quot;:1,&quot;column_min_width&quot;:240,&quot;column_min_width_tablet&quot;:240,&quot;column_min_width_mobile&quot;:240,&quot;inline_columns_css&quot;:false,&quot;is_archive_template&quot;:&quot;&quot;,&quot;post_status&quot;:[&quot;publish&quot;],&quot;use_random_posts_num&quot;:&quot;&quot;,&quot;max_posts_num&quot;:9,&quot;not_found_message&quot;:&quot;No data was found&quot;,&quot;is_masonry&quot;:false,&quot;equal_columns_height&quot;:&quot;&quot;,&quot;use_load_more&quot;:&quot;&quot;,&quot;load_more_id&quot;:&quot;&quot;,&quot;load_more_type&quot;:&quot;click&quot;,&quot;load_more_offset&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;size&quot;:0,&quot;sizes&quot;:[]},&quot;use_custom_post_types&quot;:&quot;&quot;,&quot;custom_post_types&quot;:[],&quot;hide_widget_if&quot;:&quot;&quot;,&quot;carousel_enabled&quot;:&quot;&quot;,&quot;slides_to_scroll&quot;:&quot;1&quot;,&quot;arrows&quot;:&quot;true&quot;,&quot;arrow_icon&quot;:&quot;fa fa-angle-left&quot;,&quot;dots&quot;:&quot;&quot;,&quot;autoplay&quot;:&quot;true&quot;,&quot;pause_on_hover&quot;:&quot;true&quot;,&quot;autoplay_speed&quot;:5000,&quot;infinite&quot;:&quot;true&quot;,&quot;center_mode&quot;:&quot;&quot;,&quot;effect&quot;:&quot;slide&quot;,&quot;speed&quot;:500,&quot;inject_alternative_items&quot;:&quot;&quot;,&quot;injection_items&quot;:[],&quot;scroll_slider_enabled&quot;:&quot;&quot;,&quot;scroll_slider_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;,&quot;mobile&quot;],&quot;custom_query&quot;:false,&quot;custom_query_id&quot;:&quot;&quot;,&quot;_element_id&quot;:&quot;&quot;,&quot;collapse_first_last_gap&quot;:false,&quot;list_tag_selection&quot;:&quot;&quot;,&quot;list_items_wrapper_tag&quot;:&quot;div&quot;,&quot;list_item_tag&quot;:&quot;div&quot;,&quot;empty_items_wrapper_tag&quot;:&quot;div&quot;}}" data-page="1" data-pages="131" data-listing-source="posts" data-listing-id="513" data-query-id="" data-id="58f2e59" data-element_type="widget" data-settings="{&quot;columns&quot;:&quot;1&quot;}" data-widget_type="jet-listing-grid.default"><div data-id="e6ad8cc" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[{&quot;jet_parallax_layout_image&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;_id&quot;:&quot;8920bc9&quot;,&quot;jet_parallax_layout_image_tablet&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_image_mobile&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_speed&quot;:{&quot;unit&quot;:&quot;%&quot;,&quot;size&quot;:50,&quot;sizes&quot;:[]},&quot;jet_parallax_layout_type&quot;:&quot;scroll&quot;,&quot;jet_parallax_layout_direction&quot;:&quot;1&quot;,&quot;jet_parallax_layout_fx_direction&quot;:null,&quot;jet_parallax_layout_z_index&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x&quot;:50,&quot;jet_parallax_layout_bg_x_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y&quot;:50,&quot;jet_parallax_layout_bg_y_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size&quot;:&quot;auto&quot;,&quot;jet_parallax_layout_bg_size_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_animation_prop&quot;:&quot;transform&quot;,&quot;jet_parallax_layout_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;]}]}" data-elementor-type="jet-listing-items" data-elementor-id="513" data-elementor-post-type="jet-engine" data-post-id="91000">
					<div data-id="36443ab" data-element_type="column" data-widget_type="image.default">
				<p><a href="https://www.energy-storage.news/nostromos-thermal-ess-participates-in-caiso-energy-market/">
							<img src="https://www.energy-storage.news/wp-content/uploads/elementor/thumbs/Nostromo_600kWh_Icebrick_system_on_Medinol_rooftop-1-qybmzs80ci06an9t6yvrji91vk1x9m5sbfditmgix0.jpg" title="Nostromo IceBrick" alt="Nostromo IceBrick" loading="lazy">								</a>
															</p>
				</div>
				<div data-id="c8cccae" data-element_type="column" data-widget_type="text-editor.default">
				<p>
									Nostromo Energy’s IceBrick thermal energy storage (TES) technology will participate in the California Independent System Operator (CAISO) wholesale energy market. 								</p>
				</div>
					</div><div data-id="e6ad8cc" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[{&quot;jet_parallax_layout_image&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;_id&quot;:&quot;8920bc9&quot;,&quot;jet_parallax_layout_image_tablet&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_image_mobile&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_speed&quot;:{&quot;unit&quot;:&quot;%&quot;,&quot;size&quot;:50,&quot;sizes&quot;:[]},&quot;jet_parallax_layout_type&quot;:&quot;scroll&quot;,&quot;jet_parallax_layout_direction&quot;:&quot;1&quot;,&quot;jet_parallax_layout_fx_direction&quot;:null,&quot;jet_parallax_layout_z_index&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x&quot;:50,&quot;jet_parallax_layout_bg_x_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y&quot;:50,&quot;jet_parallax_layout_bg_y_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size&quot;:&quot;auto&quot;,&quot;jet_parallax_layout_bg_size_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_animation_prop&quot;:&quot;transform&quot;,&quot;jet_parallax_layout_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;]}]}" data-elementor-type="jet-listing-items" data-elementor-id="513" data-elementor-post-type="jet-engine" data-post-id="91119">
					<div data-id="36443ab" data-element_type="column" data-widget_type="image.default">
				<p><a href="https://www.energy-storage.news/italian-battery-storage-market-pipeline-soars-developers-flock-from-around-europe/">
							<img src="https://www.energy-storage.news/wp-content/uploads/elementor/thumbs/Screenshot-2025-11-27-102310-rfbh454zzrkt475rfaurl9p6qvyckff55t8txbvv0k.png" title="Italy battery storage project database market research" alt="Italy battery storage project database market research" loading="lazy">								</a>
															</p>
				</div>
				<div data-id="c8cccae" data-element_type="column" data-widget_type="text-editor.default">
				<p>
									The utility-scale battery storage market in Italy is drawing huge interest and development activity, writes Solar Media Market Research analyst Josh Cornes.								</p>
				</div>
					</div><div data-id="e6ad8cc" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[{&quot;jet_parallax_layout_image&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;_id&quot;:&quot;8920bc9&quot;,&quot;jet_parallax_layout_image_tablet&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_image_mobile&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_speed&quot;:{&quot;unit&quot;:&quot;%&quot;,&quot;size&quot;:50,&quot;sizes&quot;:[]},&quot;jet_parallax_layout_type&quot;:&quot;scroll&quot;,&quot;jet_parallax_layout_direction&quot;:&quot;1&quot;,&quot;jet_parallax_layout_fx_direction&quot;:null,&quot;jet_parallax_layout_z_index&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x&quot;:50,&quot;jet_parallax_layout_bg_x_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y&quot;:50,&quot;jet_parallax_layout_bg_y_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size&quot;:&quot;auto&quot;,&quot;jet_parallax_layout_bg_size_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_animation_prop&quot;:&quot;transform&quot;,&quot;jet_parallax_layout_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;]}]}" data-elementor-type="jet-listing-items" data-elementor-id="513" data-elementor-post-type="jet-engine" data-post-id="90899">
					<div data-id="36443ab" data-element_type="column" data-widget_type="image.default">
				<p><a href="https://www.energy-storage.news/germany-bess-firsts-integrated-software-multi-party-optimisation-privileged-permitting/">
							<img src="https://www.energy-storage.news/wp-content/uploads/elementor/thumbs/Tangermunde-rf80aaipu7u2pyq8ct5mv9yxxpkkin58nbfbxiymro.jpg" title="The Tangermünde BESS in Germany. Image: Dynamic." alt="The Tangermünde BESS in Germany. Image: Dynamic." loading="lazy">								</a>
															</p>
				</div>
				<div data-id="c8cccae" data-element_type="column" data-widget_type="text-editor.default">
				<p>
									A week of claimed first-of-their-kind advances in Germany’s BESS market, including the combination of monitoring, diagnostics and energy trading on one platform, an optimisation deal allowing multiple companies to trade one asset, and a law change accelerating permitting. 								</p>
				</div>
					</div><div data-id="e6ad8cc" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[{&quot;jet_parallax_layout_image&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;_id&quot;:&quot;8920bc9&quot;,&quot;jet_parallax_layout_image_tablet&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_image_mobile&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_speed&quot;:{&quot;unit&quot;:&quot;%&quot;,&quot;size&quot;:50,&quot;sizes&quot;:[]},&quot;jet_parallax_layout_type&quot;:&quot;scroll&quot;,&quot;jet_parallax_layout_direction&quot;:&quot;1&quot;,&quot;jet_parallax_layout_fx_direction&quot;:null,&quot;jet_parallax_layout_z_index&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x&quot;:50,&quot;jet_parallax_layout_bg_x_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y&quot;:50,&quot;jet_parallax_layout_bg_y_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size&quot;:&quot;auto&quot;,&quot;jet_parallax_layout_bg_size_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_animation_prop&quot;:&quot;transform&quot;,&quot;jet_parallax_layout_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;]}]}" data-elementor-type="jet-listing-items" data-elementor-id="513" data-elementor-post-type="jet-engine" data-post-id="90745">
					<div data-id="36443ab" data-element_type="column" data-widget_type="image.default">
				<p><a href="https://www.energy-storage.news/european-bess-m-a-and-financings-totalling-over-1gw/">
							<img src="https://www.energy-storage.news/wp-content/uploads/elementor/thumbs/Poland-BESS-Rendering-rf15u8dcccnkafw1yba0olyzawtoeiolup5ugfniro.jpg" title="A render of a typical BESS that Northland provided when announcing its Poland acquisition. Image: Northland Power." alt="A render of a typical BESS that Northland provided when announcing its Poland acquisition. Image: Northland Power." loading="lazy">								</a>
															</p>
				</div>
				<div data-id="c8cccae" data-element_type="column" data-widget_type="text-editor.default">
				<p>
									In a major week for European BESS deal-making, project acquisition and financing deals have been done in the Poland, Germany, Finland, the UK and Romania for grid-scale projects totalling well over 1GW of capacity.								</p>
				</div>
					</div><div data-id="e6ad8cc" data-element_type="section" data-settings="{&quot;jet_parallax_layout_list&quot;:[{&quot;jet_parallax_layout_image&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;_id&quot;:&quot;8920bc9&quot;,&quot;jet_parallax_layout_image_tablet&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_image_mobile&quot;:{&quot;url&quot;:&quot;&quot;,&quot;id&quot;:&quot;&quot;,&quot;size&quot;:&quot;&quot;},&quot;jet_parallax_layout_speed&quot;:{&quot;unit&quot;:&quot;%&quot;,&quot;size&quot;:50,&quot;sizes&quot;:[]},&quot;jet_parallax_layout_type&quot;:&quot;scroll&quot;,&quot;jet_parallax_layout_direction&quot;:&quot;1&quot;,&quot;jet_parallax_layout_fx_direction&quot;:null,&quot;jet_parallax_layout_z_index&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x&quot;:50,&quot;jet_parallax_layout_bg_x_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_x_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y&quot;:50,&quot;jet_parallax_layout_bg_y_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_y_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size&quot;:&quot;auto&quot;,&quot;jet_parallax_layout_bg_size_tablet&quot;:&quot;&quot;,&quot;jet_parallax_layout_bg_size_mobile&quot;:&quot;&quot;,&quot;jet_parallax_layout_animation_prop&quot;:&quot;transform&quot;,&quot;jet_parallax_layout_on&quot;:[&quot;desktop&quot;,&quot;tablet&quot;]}]}" data-elementor-type="jet-listing-items" data-elementor-id="513" data-elementor-post-type="jet-engine" data-post-id="90545">
					<div data-id="36443ab" data-element_type="column" data-widget_type="image.default">
				<p><a href="https://www.energy-storage.news/leag-enlists-hyperstrong-for-1-6gwh-germany-bess/">
							<img src="https://www.energy-storage.news/wp-content/uploads/elementor/thumbs/LEAG_Kraftwerk_Boxberg-rexk2hsmsjeaovummffnl09bbl86mv7fvqp9ughi2s.jpg" title="LEAG’s Boxberg power plant, where the BESS with HyperStrong will be built. Image: LEAG." alt="LEAG's Boxberg power plant, where the BESS with HyperStrong will be built. Image: LEAG." loading="lazy">								</a>
															</p>
				</div>
				<div data-id="c8cccae" data-element_type="column" data-widget_type="text-editor.default">
				<p>
									Utility and power firm LEAG has partnered with Chinese system integrator HyperStrong for a 400MW/1,600MWh BESS in Saxony, Germany. 								</p>
				</div>
					</div></div>
					</div>
				<div data-id="de27d08" data-element_type="column" data-widget_type="heading.default">
				<p>
					<h2>Most Popular</h2>				</p>
				</div>
					</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[A programmer-friendly I/O abstraction over io_uring and kqueue (2022) (108 pts)]]></title>
            <link>https://tigerbeetle.com/blog/2022-11-23-a-friendly-abstraction-over-iouring-and-kqueue/</link>
            <guid>46073817</guid>
            <pubDate>Thu, 27 Nov 2025 22:41:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://tigerbeetle.com/blog/2022-11-23-a-friendly-abstraction-over-iouring-and-kqueue/">https://tigerbeetle.com/blog/2022-11-23-a-friendly-abstraction-over-iouring-and-kqueue/</a>, See on <a href="https://news.ycombinator.com/item?id=46073817">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Consider this tale of I/O and performance. We’ll start with blocking
I/O, explore io_uring and kqueue, and take home an event loop very
similar to some software you may find familiar.</p>
<p>This is a twist on King’s talk at <a href="https://www.youtube.com/watch?v=Ul8OO4vQMTw">Software You Can Love
Milan ’22</a>.</p>
<h2 id="classical-approach"></h2>
<p>When you want to read from a file you might <code>open()</code> and
then call <code>read()</code> as many times as necessary to fill a
buffer of bytes from the file. And in the opposite direction, you call
<code>write()</code> as many times as needed until everything is
written. It’s similar for a TCP client with sockets, but instead of
<code>open()</code> you first call <code>socket()</code> and then
<code>connect()</code> to your server. Fun stuff.</p>
<p>In the real world though you can’t always read everything you want
immediately from a file descriptor. Nor can you always write everything
you want immediately to a file descriptor.</p>
<p>You can <a href="https://stackoverflow.com/questions/12773509/read-is-not-blocking-in-socket-programming/12775464#12775464">switch
a file descriptor into non-blocking mode</a> so the call won’t block
while data you requested is not available. But system calls are still
expensive, incurring context switches and cache misses. In fact,
networks and disks have become so fast that these costs can start to
approach the cost of doing the I/O itself. For the duration of time a
file descriptor is unable to read or write, you don’t want to waste time
continuously retrying read or write system calls.</p>
<h2 id="batching-and-readiness"></h2>
<p>So you switch to io_uring on Linux or kqueue on FreeBSD/macOS. (I’m
skipping the generation of epoll/select users.) These APIs let you
submit requests to the kernel to learn about readiness: when a file
descriptor is ready to read or write. You can send readiness requests in
batches (also referred to as queues). Completion events, one for each
submitted request, are available in a separate queue.</p>
<p>Being able to batch I/O like this is especially important for TCP
servers that want to multiplex reads and writes for multiple connected
clients.</p>
<p>However in io_uring, you can even go one step further. Instead of
having to call <code>read()</code> or <code>write()</code> in userland
after a readiness event, you can request that the kernel do the
<code>read()</code> or <code>write()</code> itself with a buffer you
provide. Thus almost all of your I/O is done in the kernel, amortizing
the overhead of system calls.</p>
<p>If you haven’t seen io_uring or kqueue before, you’d probably like an
example! Consider this code: a simple, minimal, not-production-ready TCP
echo server.</p>
<div id="cb1"><pre><code><span id="cb1-1"><span>const</span> std <span>=</span> <span>@import</span>(<span>"std"</span>);</span>
<span id="cb1-2"><span>const</span> os <span>=</span> std<span>.</span>os;</span>
<span id="cb1-3"><span>const</span> linux <span>=</span> os<span>.</span>linux;</span>
<span id="cb1-4"><span>const</span> allocator <span>=</span> std<span>.</span>heap<span>.</span>page_allocator;</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span>const</span> State <span>=</span> <span>enum</span>{ accept<span>,</span> recv<span>,</span> send };</span>
<span id="cb1-7"><span>const</span> Socket <span>=</span> <span>struct</span> {</span>
<span id="cb1-8">    handle<span>:</span> os<span>.</span>socket_t<span>,</span></span>
<span id="cb1-9">    buffer<span>:</span> [<span>1024</span>]<span>u8</span><span>,</span></span>
<span id="cb1-10">    state<span>:</span> State<span>,</span></span>
<span id="cb1-11">};</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span>pub</span> <span>fn</span> main() <span>!</span><span>void</span> {</span>
<span id="cb1-14">    <span>const</span> entries <span>=</span> <span>32</span>;</span>
<span id="cb1-15">    <span>const</span> flags <span>=</span> <span>0</span>;</span>
<span id="cb1-16">    <span>var</span> ring <span>=</span> <span>try</span> linux<span>.</span>IO_Uring<span>.</span>init(entries<span>,</span> flags);</span>
<span id="cb1-17">    <span>defer</span> ring<span>.</span>deinit();</span>
<span id="cb1-18"></span>
<span id="cb1-19">    <span>var</span> server<span>:</span> Socket <span>=</span> <span>undefined</span>;</span>
<span id="cb1-20">    server<span>.</span>handle <span>=</span> <span>try</span> os<span>.</span>socket(os<span>.</span>AF<span>.</span>INET<span>,</span> os<span>.</span>SOCK<span>.</span>STREAM<span>,</span> os<span>.</span>IPPROTO<span>.</span>TCP);</span>
<span id="cb1-21">    <span>defer</span> os<span>.</span>closeSocket(server<span>.</span>handle);</span>
<span id="cb1-22"></span>
<span id="cb1-23">    <span>const</span> port <span>=</span> <span>12345</span>;</span>
<span id="cb1-24">    <span>var</span> addr <span>=</span> std<span>.</span>net<span>.</span>Address<span>.</span>initIp4(<span>.</span>{<span>127</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>1</span>}<span>,</span> port);</span>
<span id="cb1-25">    <span>var</span> addr_len<span>:</span> os<span>.</span>socklen_t <span>=</span> addr<span>.</span>getOsSockLen();</span>
<span id="cb1-26"></span>
<span id="cb1-27">    <span>try</span> os<span>.</span>setsockopt(server<span>.</span>handle<span>,</span> os<span>.</span>SOL<span>.</span>SOCKET<span>,</span> os<span>.</span>SO<span>.</span>REUSEADDR<span>,</span> <span>&amp;</span>std<span>.</span>mem<span>.</span>toBytes(<span>@as</span>(<span>c_int</span><span>,</span> <span>1</span>)));</span>
<span id="cb1-28">    <span>try</span> os<span>.</span>bind(server<span>.</span>handle<span>,</span> <span>&amp;</span>addr<span>.</span>any<span>,</span> addr_len);</span>
<span id="cb1-29">    <span>const</span> backlog <span>=</span> <span>128</span>;</span>
<span id="cb1-30">    <span>try</span> os<span>.</span>listen(server<span>.</span>handle<span>,</span> backlog);</span>
<span id="cb1-31"></span>
<span id="cb1-32">    server<span>.</span>state <span>=</span> <span>.</span>accept;</span>
<span id="cb1-33">    _ <span>=</span> <span>try</span> ring<span>.</span>accept(<span>@ptrToInt</span>(<span>&amp;</span>server)<span>,</span> server<span>.</span>handle<span>,</span> <span>&amp;</span>addr<span>.</span>any<span>,</span> <span>&amp;</span>addr_len<span>,</span> <span>0</span>);</span>
<span id="cb1-34"></span>
<span id="cb1-35">    <span>while</span> (<span>true</span>) {</span>
<span id="cb1-36">        _ <span>=</span> <span>try</span> ring<span>.</span>submit_and_wait(<span>1</span>);</span>
<span id="cb1-37"></span>
<span id="cb1-38">        <span>while</span> (ring<span>.</span>cq_ready() <span>&gt;</span> <span>0</span>) {</span>
<span id="cb1-39">            <span>const</span> cqe <span>=</span> <span>try</span> ring<span>.</span>copy_cqe();</span>
<span id="cb1-40">            <span>var</span> client <span>=</span> <span>@intToPtr</span>(<span>*</span>Socket<span>,</span> <span>@intCast</span>(<span>usize</span><span>,</span> cqe<span>.</span>user_data));</span>
<span id="cb1-41"></span>
<span id="cb1-42">            <span>if</span> (cqe<span>.</span>res <span>&lt;</span> <span>0</span>) std<span>.</span>debug<span>.</span>panic(<span>"{}({}): {}"</span><span>,</span> <span>.</span>{</span>
<span id="cb1-43">                client<span>.</span>state<span>,</span></span>
<span id="cb1-44">                client<span>.</span>handle<span>,</span></span>
<span id="cb1-45">                <span>@intToEnum</span>(os<span>.</span>E<span>,</span> <span>-</span>cqe<span>.</span>res)<span>,</span></span>
<span id="cb1-46">            });</span>
<span id="cb1-47"></span>
<span id="cb1-48">            <span>switch</span> (client<span>.</span>state) {</span>
<span id="cb1-49">                <span>.</span>accept <span>=&gt;</span> {</span>
<span id="cb1-50">                    client <span>=</span> <span>try</span> allocator<span>.</span>create(Socket);</span>
<span id="cb1-51">                    client<span>.</span>handle <span>=</span> <span>@intCast</span>(os<span>.</span>socket_t<span>,</span> cqe<span>.</span>res);</span>
<span id="cb1-52">                    client<span>.</span>state <span>=</span> <span>.</span>recv;</span>
<span id="cb1-53">                    _ <span>=</span> <span>try</span> ring<span>.</span>recv(<span>@ptrToInt</span>(client)<span>,</span> client<span>.</span>handle<span>,</span> <span>.</span>{<span>.</span>buffer <span>=</span> <span>&amp;</span>client<span>.</span>buffer}<span>,</span> <span>0</span>);</span>
<span id="cb1-54">                    _ <span>=</span> <span>try</span> ring<span>.</span>accept(<span>@ptrToInt</span>(<span>&amp;</span>server)<span>,</span> server<span>.</span>handle<span>,</span> <span>&amp;</span>addr<span>.</span>any<span>,</span> <span>&amp;</span>addr_len<span>,</span> <span>0</span>);</span>
<span id="cb1-55">                }<span>,</span></span>
<span id="cb1-56">                <span>.</span>recv <span>=&gt;</span> {</span>
<span id="cb1-57">                    <span>const</span> read <span>=</span> <span>@intCast</span>(<span>usize</span><span>,</span> cqe<span>.</span>res);</span>
<span id="cb1-58">                    client<span>.</span>state <span>=</span> <span>.</span>send;</span>
<span id="cb1-59">                    _ <span>=</span> <span>try</span> ring<span>.</span>send(<span>@ptrToInt</span>(client)<span>,</span> client<span>.</span>handle<span>,</span> client<span>.</span>buffer[<span>0</span><span>.</span><span>.</span>read]<span>,</span> <span>0</span>);</span>
<span id="cb1-60">                }<span>,</span></span>
<span id="cb1-61">                <span>.</span>send <span>=&gt;</span> {</span>
<span id="cb1-62">                    os<span>.</span>closeSocket(client<span>.</span>handle);</span>
<span id="cb1-63">                    allocator<span>.</span>destroy(client);</span>
<span id="cb1-64">                }<span>,</span></span>
<span id="cb1-65">            }</span>
<span id="cb1-66">        }</span>
<span id="cb1-67">    }</span>
<span id="cb1-68">}</span></code></pre></div>
<p>This is a great, minimal example. But notice that this code ties
io_uring behavior directly to business logic (in this case, handling
echoing data between request and response). It is fine for a small
example like this. But in a large application you might want to do I/O
throughout the code base, not just in one place. You might not want to
keep adding business logic to this single loop.</p>
<h2 id="central-io-dispatch"></h2>
<p>Instead, you might want to be able to schedule I/O and pass a
callback (and sometimes with some application context) to be called when
the event is complete.</p>
<p>The interface might look like:</p>
<div id="cb2"><pre><code><span id="cb2-1">io_dispatch<span>.</span>dispatch({</span>
<span id="cb2-2">    <span>// some big struct/union with relevant fields for all event types</span></span>
<span id="cb2-3">}<span>,</span> my_callback);</span></code></pre></div>
<p>This is great! Now your business logic can schedule and handle I/O no
matter where in the code base it is.</p>
<p>Under the hood it can decide whether to use io_uring or kqueue
depending on what kernel it’s running on. The dispatch can also batch
these individual calls through io_uring or kqueue to amortize system
calls. The application no longer needs to know the details.</p>
<p>Additionally, we can use this wrapper to stop thinking about
readiness events, just I/O completion. That is, if we dispatch a read
event, the io_uring implementation would actually ask the kernel to read
data into a buffer. Whereas the kqueue implementation would send a
“read” readiness event, do the read back in userland, and then call our
callback.</p>
<p>And finally, now that we’ve got this central dispatcher, we don’t
need spaghetti code in a loop switching on every possible submission and
completion event.</p>
<h2 id="interacting-with-the-submission-and-completion-queue"></h2>
<p>Every time we call io_uring or kqueue we both submit event requests
and poll for completion events. The io_uring and kqueue APIs tie these
two actions together in the same system call.</p>
<p>To sync our requests to io_uring or kqueue we’ll build a
<code>flush</code> function that submits requests and polls for
completion events. (In the next section we’ll talk about how the user of
the central dispatch learns about completion events.)</p>
<p>To make <code>flush</code> more convenient, we’ll build a nice
wrapper around it so that we can submit as many requests (and process as
many completion events) as possible. To avoid accidentally blocking
indefinitely we’ll also introduce a time limit. We’ll call the wrapper
<code>run_for_ns</code>.</p>
<p>Finally we’ll put the user in charge of setting up a loop to call
this <code>run_for_ns</code> function, independent of normal program
execution.</p>
<p>This is now your traditional event loop.</p>
<h2 id="callbacks-and-context"></h2>
<p>You may have noticed that in the API above we passed a callback. The
idea is that after the requested I/O has completed, our callback should
be invoked. But the question remains: how to track this callback between
the submission and completion queue?</p>
<p>Thankfully, io_uring and kqueue events have user data fields. The
user data field is opaque to the kernel. When a submitted event
completes, the kernel sends a completion event back to userland
containing the user data value from the submission event.</p>
<p>We can store the callback in the user data field by setting it to the
callback’s pointer casted to an integer. When the completion for a
requested event comes up, we cast from the integer in the user data
field back to the callback pointer. Then, we invoke the callback.</p>
<h2 id="getting-more-expressive"></h2>
<p>As described above, the struct for <code>io_dispatch.dispatch</code>
could get quite large handling all the different kinds of I/O events and
their arguments. We could make our API a little more expressive by
creating wrapper functions for each event type.</p>
<p>So if we wanted to schedule a read function we could call:</p>
<div id="cb3"><pre><code><span id="cb3-1">io_dispatch<span>.</span>read(fd<span>,</span> <span>&amp;</span>buf<span>,</span> nBytesToRead<span>,</span> callback);</span></code></pre></div>
<p>Or to write, similarly:</p>
<div id="cb4"><pre><code><span id="cb4-1">io_dispatch<span>.</span>write(fd<span>,</span> buf<span>,</span> nBytesToWrite<span>,</span> callback);</span></code></pre></div>
<h2 id="overflow"></h2>
<p>One more thing we need to worry about is that the batch we pass to
io_uring or kqueue has a fixed size (technically, kqueue allows any
batch size but using that might introduce unnecessary allocations). So
we’ll build our own queue on top of our I/O abstraction to keep track of
requests that we could not immediately submit to io_uring or kqueue.</p>
<blockquote>
<p>To keep this API simple we could allocate for each entry in the
queue. Or we could modify the <code>io_dispatch.X</code> calls slightly
to accept a struct that can be used in an <a href="https://www.data-structures-in-practice.com/intrusive-linked-lists/">intrusive
linked list</a> to contain all request context, including the callback.
The latter is <a href="https://github.com/tigerbeetle/tigerbeetle/blob/d15acc663f8882cb02413129e8351bf3238335e6/src/io/linux.zig#L665">what
we do in TigerBeetle</a>.</p>
</blockquote>
<p>Put another way: every time code calls <code>io_dispatch</code>,
we’ll try to immediately submit the requested event to io_uring or
kqueue. But if there’s no room, we store the event in an overflow
queue.</p>
<p>The overflow queue needs to be processed eventually, so we update our
<code>flush</code> function (described in <a href="#callbacks-and-context">Callbacks and context</a> above) to pull
as many events from our overflow queue before submitting a batch to
io_uring or kqueue.</p>
<h2 id="a-step-back"></h2>
<p>We’ve now built something similar to <a href="https://github.com/libuv/libuv">libuv</a>, the I/O library that
Node.js uses. And if you squint, it is basically TigerBeetle’s I/O
library! (And interestingly enough, TigerBeetle’s I/O code was <a href="https://github.com/oven-sh/bun/blob/e14a3af491ece8d1b0309e76ae3022b4fad91f16/src/io/io_linux.zig#L704">adopted</a>
into Bun! Open-source for the win!)</p>
<p>Let’s check out how the <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/darwin.zig#L436">Darwin
version</a> of TigerBeetle’s I/O library (with kqueue) differs from the
<a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/linux.zig#L656">Linux
version</a>. As mentioned, the complete <code>send</code> call in the
Darwin implementation waits for file descriptor readiness (through
kqueue). Once ready, the actual <code>send</code> call is made back in
userland:</p>
<div id="cb5"><pre><code><span id="cb5-1"><span>pub</span> <span>fn</span> send(</span>
<span id="cb5-2">    <span>self</span><span>:</span> <span>*</span>IO<span>,</span></span>
<span id="cb5-3">    <span>comptime</span> Context<span>:</span> <span>type</span><span>,</span></span>
<span id="cb5-4">    context<span>:</span> Context<span>,</span></span>
<span id="cb5-5">    <span>comptime</span> callback<span>:</span> <span>fn</span> (</span>
<span id="cb5-6">        context<span>:</span> Context<span>,</span></span>
<span id="cb5-7">        completion<span>:</span> <span>*</span>Completion<span>,</span></span>
<span id="cb5-8">        result<span>:</span> SendError<span>!</span><span>usize</span><span>,</span></span>
<span id="cb5-9">    ) <span>void</span><span>,</span></span>
<span id="cb5-10">    completion<span>:</span> <span>*</span>Completion<span>,</span></span>
<span id="cb5-11">    socket<span>:</span> os<span>.</span>socket_t<span>,</span></span>
<span id="cb5-12">    buffer<span>:</span> []<span>const</span> <span>u8</span><span>,</span></span>
<span id="cb5-13">) <span>void</span> {</span>
<span id="cb5-14">    <span>self</span><span>.</span>submit(</span>
<span id="cb5-15">        context<span>,</span></span>
<span id="cb5-16">        callback<span>,</span></span>
<span id="cb5-17">        completion<span>,</span></span>
<span id="cb5-18">        <span>.</span>send<span>,</span></span>
<span id="cb5-19">        <span>.</span>{</span>
<span id="cb5-20">            <span>.</span>socket <span>=</span> socket<span>,</span></span>
<span id="cb5-21">            <span>.</span>buf <span>=</span> buffer<span>.</span>ptr<span>,</span></span>
<span id="cb5-22">            <span>.</span>len <span>=</span> <span>@intCast</span>(<span>u32</span><span>,</span> buffer_limit(buffer<span>.</span>len))<span>,</span></span>
<span id="cb5-23">        }<span>,</span></span>
<span id="cb5-24">        <span>struct</span> {</span>
<span id="cb5-25">            <span>fn</span> do_operation(op<span>:</span> <span>anytype</span>) SendError<span>!</span><span>usize</span> {</span>
<span id="cb5-26">                <span>return</span> os<span>.</span>send(op<span>.</span>socket<span>,</span> op<span>.</span>buf[<span>0</span><span>.</span><span>.</span>op<span>.</span>len]<span>,</span> <span>0</span>);</span>
<span id="cb5-27">            }</span>
<span id="cb5-28">        }<span>,</span></span>
<span id="cb5-29">    );</span>
<span id="cb5-30">}</span></code></pre></div>
<p>Compare this to the <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/linux.zig#L656">Linux
version</a> (with io_uring) where the kernel handles everything and
there is no send system call in userland:</p>
<div id="cb6"><pre><code><span id="cb6-1"><span>pub</span> <span>fn</span> send(</span>
<span id="cb6-2">    <span>self</span><span>:</span> <span>*</span>IO<span>,</span></span>
<span id="cb6-3">    <span>comptime</span> Context<span>:</span> <span>type</span><span>,</span></span>
<span id="cb6-4">    context<span>:</span> Context<span>,</span></span>
<span id="cb6-5">    <span>comptime</span> callback<span>:</span> <span>fn</span> (</span>
<span id="cb6-6">        context<span>:</span> Context<span>,</span></span>
<span id="cb6-7">        completion<span>:</span> <span>*</span>Completion<span>,</span></span>
<span id="cb6-8">        result<span>:</span> SendError<span>!</span><span>usize</span><span>,</span></span>
<span id="cb6-9">    ) <span>void</span><span>,</span></span>
<span id="cb6-10">    completion<span>:</span> <span>*</span>Completion<span>,</span></span>
<span id="cb6-11">    socket<span>:</span> os<span>.</span>socket_t<span>,</span></span>
<span id="cb6-12">    buffer<span>:</span> []<span>const</span> <span>u8</span><span>,</span></span>
<span id="cb6-13">) <span>void</span> {</span>
<span id="cb6-14">    completion<span>.*</span> <span>=</span> <span>.</span>{</span>
<span id="cb6-15">        <span>.</span>io <span>=</span> <span>self</span><span>,</span></span>
<span id="cb6-16">        <span>.</span>context <span>=</span> context<span>,</span></span>
<span id="cb6-17">        <span>.</span>callback <span>=</span> <span>struct</span> {</span>
<span id="cb6-18">            <span>fn</span> wrapper(ctx<span>:</span> <span>?*</span><span>anyopaque</span><span>,</span> comp<span>:</span> <span>*</span>Completion<span>,</span> res<span>:</span> <span>*</span><span>const</span> <span>anyopaque</span>) <span>void</span> {</span>
<span id="cb6-19">                callback(</span>
<span id="cb6-20">                    <span>@intToPtr</span>(Context<span>,</span> <span>@ptrToInt</span>(ctx))<span>,</span></span>
<span id="cb6-21">                    comp<span>,</span></span>
<span id="cb6-22">                    <span>@intToPtr</span>(<span>*</span><span>const</span> SendError<span>!</span><span>usize</span><span>,</span> <span>@ptrToInt</span>(res))<span>.*,</span></span>
<span id="cb6-23">                );</span>
<span id="cb6-24">            }</span>
<span id="cb6-25">        }<span>.</span>wrapper<span>,</span></span>
<span id="cb6-26">        <span>.</span>operation <span>=</span> <span>.</span>{</span>
<span id="cb6-27">            <span>.</span>send <span>=</span> <span>.</span>{</span>
<span id="cb6-28">                <span>.</span>socket <span>=</span> socket<span>,</span></span>
<span id="cb6-29">                <span>.</span>buffer <span>=</span> buffer<span>,</span></span>
<span id="cb6-30">            }<span>,</span></span>
<span id="cb6-31">        }<span>,</span></span>
<span id="cb6-32">    };</span>
<span id="cb6-33">    <span>// Fill out a submission immediately if possible, otherwise adds to overflow buffer</span></span>
<span id="cb6-34">    <span>self</span><span>.</span>enqueue(completion);</span>
<span id="cb6-35">}</span></code></pre></div>
<p>Similarly, take a look at <code>flush</code> on <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/linux.zig#L66">Linux</a>
and <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/darwin.zig#L75">macOS</a>
for event processing. Look at <code>run_for_ns</code> on <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/linux.zig#L66]">Linux</a>
and <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/darwin.zig#L75">macOS</a>
for the public API users must call. And finally, look at what puts this
all into practice, the loop calling <code>run_for_ns</code> in
src/main.zig.</p>
<h2 id="windows-and-iocp"></h2>
<p>We’ve come this far and you might be wondering — what about
cross-platform support for Windows? The good news is that Windows also
has a completion based system similar to io_uring but without batching,
called <a href="https://learn.microsoft.com/en-us/windows/win32/fileio/i-o-completion-ports">IOCP</a>.
And for bonus points, TigerBeetle provides the <a href="https://github.com/tigerbeetle/tigerbeetle/blob/9d3552ba137a773d4b81106739e56cba6cd32a03/src/io/windows.zig">same
I/O abstraction over it</a>! But it’s enough to cover just Linux and
macOS in this post. :)</p>
<h2 id="beyond-a-single-thread"></h2>
<p>In both this blog post and in TigerBeetle, we implemented a
single-threaded event loop. Keeping I/O code single-threaded in
userspace is beneficial (whether or not I/O processing is
single-threaded in the kernel is not our concern). It’s the simplest
code and best for workloads that are not embarrassingly parallel. It is
also best for determinism, which is integral to the design of
TigerBeetle because it enables us to do Deterministic Simulation
Testing</p>
<p>But there are other valid architectures for other workloads.</p>
<p>For workloads that are embarrassingly parallel, like many web
servers, you could instead use multiple threads where each thread has
its own queue. In optimal conditions, this architecture has the highest
I/O throughput possible.</p>
<p>But if each thread has its own queue, individual threads can become
starved if an uneven amount of work is scheduled on one thread. In the
case of dynamic amounts of work, the better architecture would be to
have a single queue but multiple worker threads doing the work made
available on the queue.</p>
<h2 id="standalone-cross-platform-evented-io-library"></h2>
<p>Hey, maybe we’ll split this out so you can use it too. It’s written
in Zig so we can easily expose a C API. Any language with a C foreign
function interface (i.e. every language) should work well with it. Keep
an eye on <a href="https://github.com/tigerbeetle">our GitHub</a>.
:)</p>
<p>Additional resources:</p>
<ul>
<li><a href="https://www.usenix.org/system/files/conference/hotos15/hotos15-paper-mcsherry.pdf">https://www.usenix.org/system/files/conference/hotos15/hotos15-paper-mcsherry.pdf</a></li>
<li><a href="https://github.com/ziglang/zig/issues/8224">https://github.com/ziglang/zig/issues/8224</a></li>
<li><a href="https://www.youtube.com/watch?v=lZU6RK0oazM">https://www.youtube.com/watch?v=lZU6RK0oazM</a></li>
<li><a href="https://unixism.net/loti/">https://unixism.net/loti/</a></li>
</ul>
  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[FileZilla Pro "Perpetual License" – A Warning to All Users (103 pts)]]></title>
            <link>https://github.com/x011/FileZilla-Pro-Download</link>
            <guid>46073279</guid>
            <pubDate>Thu, 27 Nov 2025 21:13:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/x011/FileZilla-Pro-Download">https://github.com/x011/FileZilla-Pro-Download</a>, See on <a href="https://news.ycombinator.com/item?id=46073279">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">FileZilla Pro “Perpetual License” - A Warning to All Users</h2><a id="user-content-filezilla-pro-perpetual-license---a-warning-to-all-users" aria-label="Permalink: FileZilla Pro “Perpetual License” - A Warning to All Users" href="#filezilla-pro-perpetual-license---a-warning-to-all-users"></a></p>
<p dir="auto">This is a blunt warning to anyone who ever purchased, or is thinking about purchasing, FileZilla Pro.</p>
<p dir="auto">I bought FileZilla Pro under a <strong>perpetual license</strong> - a one-time payment, lifetime right to use the version I purchased. After reinstalling my operating system, I simply needed to reinstall the software I already paid for.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Here’s what happened:</h3><a id="user-content-heres-what-happened" aria-label="Permalink: Here’s what happened:" href="#heres-what-happened"></a></p>
<ul dir="auto">
<li>Support admitted I <strong>still have the legal right</strong> to use the old version of FileZilla Pro that I originally purchased.</li>
<li>Then they told me they <strong>refuse to provide the installer</strong> for that version.</li>
<li>Their excuse: <em>“For security reasons we do not provide older versions.”</em></li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">The impact:</h3><a id="user-content-the-impact" aria-label="Permalink: The impact:" href="#the-impact"></a></p>
<p dir="auto">If a customer cannot download the installer, the “perpetual license” is <strong>dead</strong>.
It doesn’t matter what rights they acknowledge on paper - they are blocking any practical way to use the software unless you pay again under their new subscription model.</p>
<p dir="auto">There is no way to reinstall.
There is no way to access the product you bought.
Your “perpetual license” effectively becomes worthless the moment you reinstall your OS or lose the installer.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">What this means for users:</h3><a id="user-content-what-this-means-for-users" aria-label="Permalink: What this means for users:" href="#what-this-means-for-users"></a></p>
<p dir="auto">FileZilla is fully aware that customers legally own those old versions.
They openly admit it.
And then they withhold the installer anyway, leaving users with no realistic option except paying again.</p>
<p dir="auto">If you’re considering FileZilla Pro, understand exactly what you are walking into:
You can pay for a perpetual license, and later be denied any way to reinstall the product you legally own.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Name clarification</h3><a id="user-content-name-clarification" aria-label="Permalink: Name clarification" href="#name-clarification"></a></p>
<p dir="auto">Although “Zilla” appears in the name, the FileZilla project is not affiliated with Mozilla in any way. I mention this because, at the time I purchased FileZilla Pro, I personally assumed the project was connected to Mozilla. That assumption made me trust the product more than I should have, and I learned the truth the hard way.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Copyright</h3><a id="user-content-copyright" aria-label="Permalink: Copyright" href="#copyright"></a></p>
<p dir="auto"><strong>Tim Kosse</strong>, FileZilla author and trademark owner</p>
<hr>
<p dir="auto"><h3 tabindex="-1" dir="auto">My Perspective</h3><a id="user-content-my-perspective" aria-label="Permalink: My Perspective" href="#my-perspective"></a></p>
<p dir="auto">Based on my experience, I believe FileZilla’s refusal to provide the installer is driven by financial motives rather than security. In the very first email I received from support, before offering any real help, they immediately suggested that I buy the newest version and even offered me a discount. That interaction, combined with the fact that they were still providing updates to the copy already installed on my computer, makes the security explanation hard to accept and reinforces my belief that the real motive is financial.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Underrated reasons to be thankful V (212 pts)]]></title>
            <link>https://dynomight.net/thanks-5/</link>
            <guid>46073033</guid>
            <pubDate>Thu, 27 Nov 2025 20:37:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://dynomight.net/thanks-5/">https://dynomight.net/thanks-5/</a>, See on <a href="https://news.ycombinator.com/item?id=46073033">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<article>
  <header>
    <img src="https://dynomight.net/img/valley.jpg">
    

  </header>  

  <section>
    

    <ol>
  <li>
    <p>That your dog, while she appears to love you only because she’s been adapted by evolution to appear to love you, really does love you.</p>
  </li>
  <li>
    <p>That if you’re a life form and you cook up a baby and copy your genes to them, you’ll find that the genes have been degraded due to oxidative stress et al., which isn’t cause for celebration, but if you find some other hopefully-hot person and randomly swap in half of their genes, your baby will still be somewhat less fit compared to you and your hopefully-hot friend on average, but now there is variance, so if you cook up several babies, one of them might be as fit or even fitter than you, and that one will likely have more babies than your other babies have, and thus complex life can persist in a universe with increasing entropy.</p>
  </li>
  <li>
    <p>That if we wanted to, we surely <em>could</em> figure out which of the 300-ish strains of rhinovirus are circulating in a given area at a given time and rapidly vaccinate people to stop it and thereby finally “cure” the common cold, and though this is too annoying to pursue right now, it seems like it’s just a matter of time.</p>
  </li>
  <li>
    <p>That if you look back at history, you see that plagues went from Europe to the Americas but not the other way, which suggests that urbanization and travel are great allies for infectious disease, and these both continue today but are held in check by sanitation and vaccines even while we have lots of tricks like UVC light and high-frequency sound and air filtration and waste monitoring and paying people to stay home that we’ve barely even put in play.</p>
  </li>
  <li>
    <p>That while engineered infectious diseases loom ever-larger as a potential very big problem, we also have lots of crazier tricks we <em>could</em> pull out like panopticon viral screening or toilet monitors or daily individualized saliva sampling or engineered microbe-resistant surfaces or even dividing society into cells with rotating interlocks or having people walk around in little personal spacesuits, and while admittedly most of this doesn’t sound awesome, I see no reason this shouldn’t be a battle that we would win.</p>
  </li>
  <li>
    <p>That clean water, unlimited, almost free.</p>
  </li>
  <li>
    <p>That dentistry.</p>
  </li>
  <li>
    <p>That tongues.</p>
  </li>
  <li>
    <p>That radioactive atoms either release a ton of energy but also quickly stop existing—a gram of Rubidium-90 scattered around your kitchen emits as much energy as ~200,000 incandescent lightbulbs but after an hour only 0.000000113g is left—or don’t put out very much energy but keep existing for a long time—a gram of Carbon-14 only puts out the equivalent of 0.0000212 light bulbs but if you start with a gram, you’ll still have 0.999879g after a year—so it isn’t actually <em>that</em> easy to permanently poison the environment with radiation although Cobalt-60 with its medium energy output and medium half-life is unfortunate, medical applications notwithstanding I still wish Cobalt-60 didn’t exist, screw you Cobalt-60.</p>
  </li>
  <li>
    <p>That while curing all cancer would only increase life expectancy by ~3 years and curing all heart disease would only increase life expectancy by ~3 years, and preventing all accidents would only increase life expectancy by ~1.5 years, if we did all of these at the same time and then a lot of other stuff too, eventually the effects would go nonlinear, so trying to cure cancer isn’t actually a waste of time, thankfully.</p>
  </li>
  <li>
    <p>That the peroxisome, while the mitochondria and their stupid Krebs cycle get all the attention, when a fatty-acid that’s too long for them to catabolize comes along, who you gonna call.</p>
  </li>
  <li>
    <p>That we have preferences, that there’s no agreed ordering of how good different things are, which is neat, and not something that would obviously be true for an alien species, and given our limited resources probably makes us happier on net.</p>
  </li>
  <li>
    <p>That cardamom, it is cheap but tastes expensive, if cardamom cost 1000× more, people would brag about how they flew to Sri Lanka so they could taste chai made with fresh cardamom and swear that it changed their whole life.</p>
  </li>
  <li>
    <p>That Gregory of Nyssa, he was right.</p>
  </li>
  <li>
    <p>That Grandma Moses, it’s not too late.</p>
  </li>
  <li>
    <p>That sleep, that probably evolution first made a low-energy mode so we don’t starve so fast and then layered on some maintenance processes, but the effect is that we live in a cycle and when things aren’t going your way it’s comforting that reality doesn’t stretch out before you indefinitely but instead you can look forward to a reset and a pause that’s somehow neither experienced nor skipped.</p>
  </li>
  <li>
    <p>That, glamorous or not, comfortable or not, cheap or not, carbon emitting or not, air travel is very safe.</p>
  </li>
  <li>
    <p>That, for most of the things you’re worried about, the markets are less worried than you and they have the better track record, though not the issue of your mortality.</p>
  </li>
  <li>
    <p>That sexual attraction to romantic love to economic unit to reproduction, it’s a strange bundle, but who are we to argue with success.</p>
  </li>
  <li>
    <p>That every symbolic expression recursively built from differentiable elementary functions has a derivative that can also be written as a recursive combination of elementary functions, although the latter expression may require vastly more terms.</p>
  </li>
  <li>
    <p>That every expression graph built from differentiable elementary functions and producing a scalar output has a gradient that can itself be written as an expression graph, and furthermore that the latter expression graph is always the same size as the first one and is easy to find, and thus that it’s possible to fit very large expression graphs to data.</p>
  </li>
  <li>
    <p>That, eerily, biological life and biological intelligence does not appear to make use of that property of expression graphs.</p>
  </li>
  <li>
    <p>That if you look at something and move your head around, you observe the entire light field, which is a five-dimensional function of three spatial coordinates and two angles, and yet if you do something fancy with lasers, somehow that entire light field can be stored on a single piece of normal two-dimensional film and then replayed later.</p>
  </li>
  <li>
    <p>That, as far as I can tell, the reason five-dimensional light fields can be stored on two-dimensional film simply cannot be explained without quite a lot of wave mechanics, a vivid example of the strangeness of this place and proof that all those physicists with their diffractions and phase conjugations really are up to something.</p>
  </li>
  <li>
    <p>That disposable plastic, littered or not, harmless when consumed as thousands of small particles or not, is popular for a reason.</p>
  </li>
  <li>
    <p>That disposable plastic, when disposed of correctly, is literally carbon sequestration, and that if/when air-derived plastic replaces dead-plankton-derived plastic, this might be incredibly convenient, although it must be said that currently the carbon in disposable plastic only represents a single-digit percentage of total carbon emissions.</p>
  </li>
  <li>
    <p>That rocks can be broken into pieces and then you can’t un-break the pieces but you can check that they came from the same rock, it’s basically cryptography.</p>
  </li>
  <li>
    <p>That the deal society has made is that if you have kids then everyone you encounter is obligated to chip in a bit to assist you, and this seems to mostly work without the need for constant grimy negotiated transactions as Econ 101 would suggest, although the exact contours of this deal seem to be a bit murky.</p>
  </li>
  <li>
    <p>That of all the humans that have ever lived, the majority lived under some kind of autocracy, with the rest distributed among tribal bands, chiefdoms, failed states, and flawed democracies, and only something like 1% enjoyed free elections and the rule of law and civil liberties and minimal corruption, yet we endured and today that number is closer to 10%, and so if you find yourself outside that set, do not lose heart.</p>
  </li>
  <li>
    <p>That if you were in two dimensions and you tried to eat something then maybe your body would split into two pieces since the whole path from mouth to anus would have to be disconnected, so be thankful you’re in three dimensions, although maybe you could have some kind of jigsaw-shaped digestive tract so your two pieces would only jiggle around or maybe you could use the same orifice for both purposes, remember that if you ever find yourself in two dimensions, I guess.</p>
  </li>
</ol>

<p>(<a href="https://dynomight.net/thanks/">previously</a>, <a href="https://dynomight.net/thanks-2/">previously</a>, <a href="https://dynomight.net/thanks-3/">previously</a>, <a href="https://dynomight.net/thanks-4">previously</a>)</p>


  </section>

  <hr>

  

  <section>
    
    
    <p>Comments at
      
        <a href="https://lemmy.world/post/39398444">lemmy</a> or 
        <a href="https://dynomight.substack.com/p/thanks-5">substack</a>.
      
      

  </p></section>
  <hr>
  <section>

    <!-- <h3>related internet content opportunities</h3> -->

<span>Related</span>
<p>
    <a href="https://dynomight.net/arguments-3/">Things to argue about over the holidays instead of politics III</a> · 
    
          <a href="https://dynomight.net/#lists">lists</a>
    
    </p>

      <p>
    <a href="https://dynomight.net/thanks-4/">Underrated reasons to be thankful IV</a> · 
    
          <a href="https://dynomight.net/#lists">lists</a>
    
    </p>

      <p>
    <a href="https://dynomight.net/travel/">Obvious travel advice</a> · 
    
          <a href="https://dynomight.net/#life">life</a>
    
          <a href="https://dynomight.net/#lists">lists</a>
    
    </p>

      <p>
    <a href="https://dynomight.net/things/">Things that don't work</a> · 
    
          <a href="https://dynomight.net/#lists">lists</a>
    
    </p>

      

  </section>
  <hr>
  

</article>


</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[LinkedIn is loud, and corporate is hell (202 pts)]]></title>
            <link>https://ramones.dev/posts/linkedin-is-loud/</link>
            <guid>46072988</guid>
            <pubDate>Thu, 27 Nov 2025 20:30:21 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://ramones.dev/posts/linkedin-is-loud/">https://ramones.dev/posts/linkedin-is-loud/</a>, See on <a href="https://news.ycombinator.com/item?id=46072988">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
            <blockquote>
<p>Disclaimer: this is based on emotions and not much else</p>
</blockquote>
<p>I'm so tired of reading the same post 10x because everyone wants to be included.</p>
<p>What's hot right now is the CloudFlare outage. Everyone misses the actual issue which was that there were no (automated) tests/QA that were done to prevent this bug. Even a feature flag would've been sufficient so they could've seen the issue early-on.</p>
<p>This is what every LinkedIn poster does:</p>
<ul>
<li>Open ChatGPT</li>
<li>"Rewrite this linkedin post about the cloudflare outage"</li>
<li><em>AI steers towards the use of <code>.unwrap()</code></em></li>
<li><em>LinkedIn man doesn't fact check anything or reads the post-mortem</em></li>
</ul>
<p>Result:
"Le unwrap is le dangerous. Here's how the unwrap works"</p>
<p>I'm so fucking tired. I don't care about your company, nor do I care about you. I don't care because YOU don't care either about what you post. You don't care about your career, only how it looks. In hindsight, this is the perfect representation of how LLM's function, so I'm not surprised managers are best friends with ChatGPT.</p>
<p>I'm not surprised corporate social media is lifeless, but I'm surprised no one actually cares. How do these people stay motivated to do anything. It can't just be money, right?</p>
<p>I added a disclaimer because I do feel like this post is very short-sighted. This feeling roots into the fact I'm tired of corporate hell, and these feelings resulted in me not being very productive at work. This also resulted in me being let go soon (also known as a PIP!).</p>
<p>You can skip this part if you don't care about my career.</p>
<p>When I started out at $COMPANY, it was mostly building tools with, from time to time, a manager doing a check-up. This worked amazingly, as I had time to learn and improve, and I was able to deliver.</p>
<p>Fast-forward a few months, we now have 3 managers, 1 dev (hi), and a buttload of busywork that needs to be done yesterday. From what I understand, a manager is supposed to be your safetynet and keep the context switching to a minimum. Tickets should feel like little updates, yet they take up 40% of my work (which could've been spent on solutioning). Since I'm the lead dev, any busywork will move tickets further back. This also means I'm to blame, because I should've been way earlier with alerting <em>them</em> about the project's drift. I'M NOT A PM! It's my job to make the project and keep you up to date. If this isn't sufficient then go to the PM (oh wait, that's not me!). Another big issue I have with this workflow is that we're sometimes moving priorization mid-cycle due to client requests. This is fine if it wasn't low priority stuff a client <em>wants</em> but doesn't <em>need</em>.</p>
<p>I get almost nothing done and I've grown tired of living in Linear. I wouldn't say I'm burnt-out. Similarly to an orgasm, you'd know if you had one. The company has turned into a startup with only the shortcomings and all of the corporate hell I wanted to avoid.</p>
<p>As I mentioned before, I'm being let go in January (as well as other people at the company). 2026 is going to start interestingly, but I think it would be free-ing. I still wish everyone at the company the best, because there are some smart and kind people I will miss.</p>

        </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[DeepSeekMath-V2: Towards Self-Verifiable Mathematical Reasoning [pdf] (210 pts)]]></title>
            <link>https://github.com/deepseek-ai/DeepSeek-Math-V2/blob/main/DeepSeekMath_V2.pdf</link>
            <guid>46072786</guid>
            <pubDate>Thu, 27 Nov 2025 20:03:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/deepseek-ai/DeepSeek-Math-V2/blob/main/DeepSeekMath_V2.pdf">https://github.com/deepseek-ai/DeepSeek-Math-V2/blob/main/DeepSeekMath_V2.pdf</a>, See on <a href="https://news.ycombinator.com/item?id=46072786">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
            


<react-partial partial-name="marketing-navigation" data-ssr="true" data-attempted-ssr="true" data-react-profiling="false">
  
  
  <div data-target="react-partial.reactRoot"><nav aria-label="Global"><ul><li><div><ul><li><div><p><span>AI CODE CREATION</span></p><ul><li><a href="https://github.com/features/copilot" data-analytics-event="{&quot;action&quot;:&quot;github_copilot&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_copilot_link_platform_navbar&quot;}"><div><p><span>GitHub Copilot</span><span>Write better code with AI</span></p></div></a></li><li><a href="https://github.com/features/spark" data-analytics-event="{&quot;action&quot;:&quot;github_spark&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_spark_link_platform_navbar&quot;}"><div><p><span>GitHub Spark</span><span>Build and deploy intelligent apps</span></p></div></a></li><li><a href="https://github.com/features/models" data-analytics-event="{&quot;action&quot;:&quot;github_models&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_models_link_platform_navbar&quot;}"><div><p><span>GitHub Models</span><span>Manage and compare prompts</span></p></div></a></li><li><a href="https://github.com/mcp" data-analytics-event="{&quot;action&quot;:&quot;mcp_registry&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;mcp_registry_link_platform_navbar&quot;}"><div><p><span>MCP Registry<sup>New</sup></span><span>Integrate external tools</span></p></div></a></li></ul></div></li><li><div><p><span>DEVELOPER WORKFLOWS</span></p><ul><li><a href="https://github.com/features/actions" data-analytics-event="{&quot;action&quot;:&quot;actions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;actions_link_platform_navbar&quot;}"><div><p><span>Actions</span><span>Automate any workflow</span></p></div></a></li><li><a href="https://github.com/features/codespaces" data-analytics-event="{&quot;action&quot;:&quot;codespaces&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;codespaces_link_platform_navbar&quot;}"><div><p><span>Codespaces</span><span>Instant dev environments</span></p></div></a></li><li><a href="https://github.com/features/issues" data-analytics-event="{&quot;action&quot;:&quot;issues&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;issues_link_platform_navbar&quot;}"><div><p><span>Issues</span><span>Plan and track work</span></p></div></a></li><li><a href="https://github.com/features/code-review" data-analytics-event="{&quot;action&quot;:&quot;code_review&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;code_review_link_platform_navbar&quot;}"><div><p><span>Code Review</span><span>Manage code changes</span></p></div></a></li></ul></div></li><li><div><p><span>APPLICATION SECURITY</span></p><ul><li><a href="https://github.com/security/advanced-security" data-analytics-event="{&quot;action&quot;:&quot;github_advanced_security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_advanced_security_link_platform_navbar&quot;}"><div><p><span>GitHub Advanced Security</span><span>Find and fix vulnerabilities</span></p></div></a></li><li><a href="https://github.com/security/advanced-security/code-security" data-analytics-event="{&quot;action&quot;:&quot;code_security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;code_security_link_platform_navbar&quot;}"><div><p><span>Code security</span><span>Secure your code as you build</span></p></div></a></li><li><a href="https://github.com/security/advanced-security/secret-protection" data-analytics-event="{&quot;action&quot;:&quot;secret_protection&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;secret_protection_link_platform_navbar&quot;}"><div><p><span>Secret protection</span><span>Stop leaks before they start</span></p></div></a></li></ul></div></li><li><div><p><span>EXPLORE</span></p><ul><li><a href="https://github.com/why-github" data-analytics-event="{&quot;action&quot;:&quot;why_github&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;why_github_link_platform_navbar&quot;}"><span>Why GitHub</span></a></li><li><a href="https://docs.github.com/" data-analytics-event="{&quot;action&quot;:&quot;documentation&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;documentation_link_platform_navbar&quot;}" target="_blank" rel="noreferrer"><span>Documentation</span></a></li><li><a href="https://github.blog/" data-analytics-event="{&quot;action&quot;:&quot;blog&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;blog_link_platform_navbar&quot;}" target="_blank" rel="noreferrer"><span>Blog</span></a></li><li><a href="https://github.blog/changelog" data-analytics-event="{&quot;action&quot;:&quot;changelog&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;changelog_link_platform_navbar&quot;}" target="_blank" rel="noreferrer"><span>Changelog</span></a></li><li><a href="https://github.com/marketplace" data-analytics-event="{&quot;action&quot;:&quot;marketplace&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;marketplace_link_platform_navbar&quot;}"><span>Marketplace</span></a></li></ul></div></li></ul><p><a href="https://github.com/features" data-analytics-event="{&quot;action&quot;:&quot;view_all_features&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;platform&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_features_link_platform_navbar&quot;}"><span>View all features</span></a></p></div></li><li><div><ul><li><div><p><span>BY COMPANY SIZE</span></p><ul><li><a href="https://github.com/enterprise" data-analytics-event="{&quot;action&quot;:&quot;enterprises&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;enterprises_link_solutions_navbar&quot;}"><span>Enterprises</span></a></li><li><a href="https://github.com/team" data-analytics-event="{&quot;action&quot;:&quot;small_and_medium_teams&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;small_and_medium_teams_link_solutions_navbar&quot;}"><span>Small and medium teams</span></a></li><li><a href="https://github.com/enterprise/startups" data-analytics-event="{&quot;action&quot;:&quot;startups&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;startups_link_solutions_navbar&quot;}"><span>Startups</span></a></li><li><a href="https://github.com/solutions/industry/nonprofits" data-analytics-event="{&quot;action&quot;:&quot;nonprofits&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;nonprofits_link_solutions_navbar&quot;}"><span>Nonprofits</span></a></li></ul></div></li><li><div><p><span>BY USE CASE</span></p><ul><li><a href="https://github.com/solutions/use-case/app-modernization" data-analytics-event="{&quot;action&quot;:&quot;app_modernization&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;app_modernization_link_solutions_navbar&quot;}"><span>App Modernization</span></a></li><li><a href="https://github.com/solutions/use-case/devsecops" data-analytics-event="{&quot;action&quot;:&quot;devsecops&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;devsecops_link_solutions_navbar&quot;}"><span>DevSecOps</span></a></li><li><a href="https://github.com/solutions/use-case/devops" data-analytics-event="{&quot;action&quot;:&quot;devops&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;devops_link_solutions_navbar&quot;}"><span>DevOps</span></a></li><li><a href="https://github.com/solutions/use-case/ci-cd" data-analytics-event="{&quot;action&quot;:&quot;ci/cd&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;ci/cd_link_solutions_navbar&quot;}"><span>CI/CD</span></a></li><li><a href="https://github.com/solutions/use-case" data-analytics-event="{&quot;action&quot;:&quot;view_all_use_cases&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_use_cases_link_solutions_navbar&quot;}"><span>View all use cases</span></a></li></ul></div></li><li><div><p><span>BY INDUSTRY</span></p><ul><li><a href="https://github.com/solutions/industry/healthcare" data-analytics-event="{&quot;action&quot;:&quot;healthcare&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;healthcare_link_solutions_navbar&quot;}"><span>Healthcare</span></a></li><li><a href="https://github.com/solutions/industry/financial-services" data-analytics-event="{&quot;action&quot;:&quot;financial_services&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;financial_services_link_solutions_navbar&quot;}"><span>Financial services</span></a></li><li><a href="https://github.com/solutions/industry/manufacturing" data-analytics-event="{&quot;action&quot;:&quot;manufacturing&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;manufacturing_link_solutions_navbar&quot;}"><span>Manufacturing</span></a></li><li><a href="https://github.com/solutions/industry/government" data-analytics-event="{&quot;action&quot;:&quot;government&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;government_link_solutions_navbar&quot;}"><span>Government</span></a></li><li><a href="https://github.com/solutions/industry" data-analytics-event="{&quot;action&quot;:&quot;view_all_industries&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_industries_link_solutions_navbar&quot;}"><span>View all industries</span></a></li></ul></div></li></ul><p><a href="https://github.com/solutions" data-analytics-event="{&quot;action&quot;:&quot;view_all_solutions&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;solutions&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_solutions_link_solutions_navbar&quot;}"><span>View all solutions</span></a></p></div></li><li><div><ul><li><div><p><span>EXPLORE BY TOPIC</span></p><ul><li><a href="https://github.com/resources/articles?topic=ai" data-analytics-event="{&quot;action&quot;:&quot;ai&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;ai_link_resources_navbar&quot;}"><span>AI</span></a></li><li><a href="https://github.com/resources/articles?topic=software-development" data-analytics-event="{&quot;action&quot;:&quot;software_development&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;software_development_link_resources_navbar&quot;}"><span>Software Development</span></a></li><li><a href="https://github.com/resources/articles?topic=devops" data-analytics-event="{&quot;action&quot;:&quot;devops&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;devops_link_resources_navbar&quot;}"><span>DevOps</span></a></li><li><a href="https://github.com/resources/articles?topic=security" data-analytics-event="{&quot;action&quot;:&quot;security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;security_link_resources_navbar&quot;}"><span>Security</span></a></li><li><a href="https://github.com/resources/articles" data-analytics-event="{&quot;action&quot;:&quot;view_all_topics&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;view_all_topics_link_resources_navbar&quot;}"><span>View all topics</span></a></li></ul></div></li><li><div><p><span>EXPLORE BY TYPE</span></p><ul><li><a href="https://github.com/customer-stories" data-analytics-event="{&quot;action&quot;:&quot;customer_stories&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;customer_stories_link_resources_navbar&quot;}"><span>Customer stories</span></a></li><li><a href="https://github.com/resources/events" data-analytics-event="{&quot;action&quot;:&quot;events__webinars&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;events__webinars_link_resources_navbar&quot;}"><span>Events &amp; webinars</span></a></li><li><a href="https://github.com/resources/whitepapers" data-analytics-event="{&quot;action&quot;:&quot;ebooks__reports&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;ebooks__reports_link_resources_navbar&quot;}"><span>Ebooks &amp; reports</span></a></li><li><a href="https://github.com/solutions/executive-insights" data-analytics-event="{&quot;action&quot;:&quot;business_insights&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;business_insights_link_resources_navbar&quot;}"><span>Business insights</span></a></li><li><a href="https://skills.github.com/" data-analytics-event="{&quot;action&quot;:&quot;github_skills&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_skills_link_resources_navbar&quot;}" target="_blank" rel="noreferrer"><span>GitHub Skills</span></a></li></ul></div></li><li><div><p><span>SUPPORT &amp; SERVICES</span></p><ul><li><a href="https://docs.github.com/" data-analytics-event="{&quot;action&quot;:&quot;documentation&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;documentation_link_resources_navbar&quot;}" target="_blank" rel="noreferrer"><span>Documentation</span></a></li><li><a href="https://support.github.com/" data-analytics-event="{&quot;action&quot;:&quot;customer_support&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;customer_support_link_resources_navbar&quot;}" target="_blank" rel="noreferrer"><span>Customer support</span></a></li><li><a href="https://github.com/orgs/community/discussions" data-analytics-event="{&quot;action&quot;:&quot;community_forum&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;community_forum_link_resources_navbar&quot;}"><span>Community forum</span></a></li><li><a href="https://github.com/trust-center" data-analytics-event="{&quot;action&quot;:&quot;trust_center&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;trust_center_link_resources_navbar&quot;}"><span>Trust center</span></a></li><li><a href="https://github.com/partners" data-analytics-event="{&quot;action&quot;:&quot;partners&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;resources&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;partners_link_resources_navbar&quot;}"><span>Partners</span></a></li></ul></div></li></ul></div></li><li><div><ul><li><div><p><span>COMMUNITY</span></p><ul><li><a href="https://github.com/sponsors" data-analytics-event="{&quot;action&quot;:&quot;github_sponsors&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_sponsors_link_open_source_navbar&quot;}"><div><p><span>GitHub Sponsors</span><span>Fund open source developers</span></p></div></a></li></ul></div></li><li><div><p><span>PROGRAMS</span></p><ul><li><a href="https://securitylab.github.com/" data-analytics-event="{&quot;action&quot;:&quot;security_lab&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;security_lab_link_open_source_navbar&quot;}" target="_blank" rel="noreferrer"><span>Security Lab</span></a></li><li><a href="https://maintainers.github.com/" data-analytics-event="{&quot;action&quot;:&quot;maintainer_community&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;maintainer_community_link_open_source_navbar&quot;}" target="_blank" rel="noreferrer"><span>Maintainer Community</span></a></li><li><a href="https://github.com/accelerator" data-analytics-event="{&quot;action&quot;:&quot;accelerator&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;accelerator_link_open_source_navbar&quot;}"><span>Accelerator</span></a></li><li><a href="https://archiveprogram.github.com/" data-analytics-event="{&quot;action&quot;:&quot;archive_program&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;archive_program_link_open_source_navbar&quot;}" target="_blank" rel="noreferrer"><span>Archive Program</span></a></li></ul></div></li><li><div><p><span>REPOSITORIES</span></p><ul><li><a href="https://github.com/topics" data-analytics-event="{&quot;action&quot;:&quot;topics&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;topics_link_open_source_navbar&quot;}"><span>Topics</span></a></li><li><a href="https://github.com/trending" data-analytics-event="{&quot;action&quot;:&quot;trending&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;trending_link_open_source_navbar&quot;}"><span>Trending</span></a></li><li><a href="https://github.com/collections" data-analytics-event="{&quot;action&quot;:&quot;collections&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;open_source&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;collections_link_open_source_navbar&quot;}"><span>Collections</span></a></li></ul></div></li></ul></div></li><li><div><ul><li><div><p><span>ENTERPRISE SOLUTIONS</span></p><ul><li><a href="https://github.com/enterprise" data-analytics-event="{&quot;action&quot;:&quot;enterprise_platform&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;enterprise_platform_link_enterprise_navbar&quot;}"><div><p><span>Enterprise platform</span><span>AI-powered developer platform</span></p></div></a></li></ul></div></li><li><div><p><span>AVAILABLE ADD-ONS</span></p><ul><li><a href="https://github.com/security/advanced-security" data-analytics-event="{&quot;action&quot;:&quot;github_advanced_security&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;github_advanced_security_link_enterprise_navbar&quot;}"><div><p><span>GitHub Advanced Security</span><span>Enterprise-grade security features</span></p></div></a></li><li><a href="https://github.com/features/copilot/copilot-business" data-analytics-event="{&quot;action&quot;:&quot;copilot_for_business&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;copilot_for_business_link_enterprise_navbar&quot;}"><div><p><span>Copilot for Business</span><span>Enterprise-grade AI features</span></p></div></a></li><li><a href="https://github.com/premium-support" data-analytics-event="{&quot;action&quot;:&quot;premium_support&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;enterprise&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;premium_support_link_enterprise_navbar&quot;}"><div><p><span>Premium Support</span><span>Enterprise-grade 24/7 support</span></p></div></a></li></ul></div></li></ul></div></li><li><a href="https://github.com/pricing" data-analytics-event="{&quot;action&quot;:&quot;pricing&quot;,&quot;tag&quot;:&quot;link&quot;,&quot;context&quot;:&quot;pricing&quot;,&quot;location&quot;:&quot;navbar&quot;,&quot;label&quot;:&quot;pricing_link_pricing_navbar&quot;}"><span>Pricing</span></a></li></ul></nav></div>
</react-partial>



        <div>
                


<qbsearch-input data-scope="repo:deepseek-ai/DeepSeek-Math-V2" data-custom-scopes-path="/search/custom_scopes" data-delete-custom-scopes-csrf="KkxTgK84NCfz5QEi2HNQCG4qDA5uRw2sJSfhdJkZsRKyGLvXmzqYxPerZKwOoIRG0Kr2yhAxIb4DeCoobreU0g" data-max-custom-scopes="10" data-header-redesign-enabled="false" data-initial-value="" data-blackbird-suggestions-path="/search/suggestions" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations" data-current-repository="deepseek-ai/DeepSeek-Math-V2" data-current-org="deepseek-ai" data-current-owner="" data-logged-in="false" data-copilot-chat-enabled="false" data-nl-search-enabled="false" data-retain-scroll-position="true">
  <div data-modal-dialog-overlay="" data-action="click:qbsearch-input#searchInputContainerClicked">
  <modal-dialog data-action="close:qbsearch-input#handleClose cancel:qbsearch-input#handleClose" data-target="qbsearch-input.searchSuggestionsDialog" role="dialog" id="search-suggestions-dialog" aria-modal="true" aria-labelledby="search-suggestions-dialog-header" data-view-component="true">
      <h2 id="search-suggestions-dialog-header">Search code, repositories, users, issues, pull requests...</h2>
    
</modal-dialog></div>
  
  <div>
    
<dialog-helper>
  <dialog data-target="qbsearch-input.feedbackDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="feedback-dialog" aria-modal="true" aria-labelledby="feedback-dialog-title" aria-describedby="feedback-dialog-description" data-view-component="true">
    <div data-view-component="true">
    <p>
      <h2 id="feedback-dialog-title">
        Provide feedback
      </h2>
        
    </p>
    
  </div>
      <scrollable-region data-labelled-by="feedback-dialog-title">
        <div data-view-component="true">        <!-- '"` --><!-- </textarea></xmp> --><form id="code-search-feedback-form" data-turbo="false" action="/search/feedback" accept-charset="UTF-8" method="post">
          <p>We read every piece of feedback, and take your input very seriously.</p>
          
          
          <label for="include_email">Include my email address so I can be contacted</label>
</form></div>
      </scrollable-region>
      
</dialog></dialog-helper>

    <custom-scopes data-target="qbsearch-input.customScopesManager">
    
<dialog-helper>
  <dialog data-target="custom-scopes.customScopesModalDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="custom-scopes-dialog" aria-modal="true" aria-labelledby="custom-scopes-dialog-title" aria-describedby="custom-scopes-dialog-description" data-view-component="true">
    <div data-view-component="true">
    <p>
      <h2 id="custom-scopes-dialog-title">
        Saved searches
      </h2>
        <h2 id="custom-scopes-dialog-description">Use saved searches to filter your results more quickly</h2>
    </p>
    
  </div>
      <scrollable-region data-labelled-by="custom-scopes-dialog-title">
        
      </scrollable-region>
      
</dialog></dialog-helper>
    </custom-scopes>
  </div>
</qbsearch-input>


            <div>
              <p><a href="https://github.com/login?return_to=https%3A%2F%2Fgithub.com%2Fdeepseek-ai%2FDeepSeek-Math-V2%2Fblob%2Fmain%2FDeepSeekMath_V2.pdf" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/deepseek-ai/DeepSeek-Math-V2/blob/main/DeepSeekMath_V2.pdf&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="2bfa6d81e1d65d4e56d7bb927010a0798471a3aa1e60971f9890cbb918c112ec" data-analytics-event="{&quot;category&quot;:&quot;Marketing nav&quot;,&quot;action&quot;:&quot;click to go to homepage&quot;,&quot;label&quot;:&quot;ref_page:Marketing;ref_cta:Sign in;ref_loc:Header&quot;}">
                Sign in
              </a>
            </p></div>

              <p><a href="https://github.com/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&amp;source=header-repo&amp;source_repo=deepseek-ai%2FDeepSeek-Math-V2" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/deepseek-ai/DeepSeek-Math-V2/blob/main/DeepSeekMath_V2.pdf&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="2bfa6d81e1d65d4e56d7bb927010a0798471a3aa1e60971f9890cbb918c112ec" data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/<user-name>/<repo-name>/blob/show;ref_cta:Sign up;ref_loc:header logged out&quot;}">
                Sign up
              </a></p><p>
    <react-partial-anchor>
      <tool-tip id="tooltip-0d2917b0-4dfc-4410-bf17-b77e32b21b9e" for="icon-button-ac934fd2-a26a-4deb-87fd-edd042deff63" popover="manual" data-direction="s" data-type="label" data-view-component="true">Appearance settings</tool-tip>

      <template data-target="react-partial-anchor.template">
        <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/primer-react.c918010dadb8d146d90b.module.css">
<link crossorigin="anonymous" media="all" rel="stylesheet" href="https://github.githubassets.com/assets/appearance-settings.753d458774a2f782559b.module.css">

<react-partial partial-name="appearance-settings" data-ssr="false" data-attempted-ssr="false" data-react-profiling="false">
  
  <script type="application/json" data-target="react-partial.embeddedData">{"props":{}}</script>
  <div data-target="react-partial.reactRoot"></div>
</react-partial>


      </template>
    </react-partial-anchor>
  </p>

          </div>
      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[AI CEO – Replace your boss before they replace you (418 pts)]]></title>
            <link>https://replaceyourboss.ai/</link>
            <guid>46072002</guid>
            <pubDate>Thu, 27 Nov 2025 18:37:41 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://replaceyourboss.ai/">https://replaceyourboss.ai/</a>, See on <a href="https://news.ycombinator.com/item?id=46072002">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[The input stack on Linux: An end-to-end architecture overview (120 pts)]]></title>
            <link>https://venam.net/blog/unix/2025/11/27/input_devices_linux.html</link>
            <guid>46071030</guid>
            <pubDate>Thu, 27 Nov 2025 16:55:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://venam.net/blog/unix/2025/11/27/input_devices_linux.html">https://venam.net/blog/unix/2025/11/27/input_devices_linux.html</a>, See on <a href="https://news.ycombinator.com/item?id=46071030">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
  <article>
    <p><img src="https://venam.net/blog/assets/input_devices_linux/astrolabe_img.jpg" alt="An Astrolabe" title="Astrolabe"></p>

<h2 id="intro">Intro</h2>

<p>Let’s explore and deobfuscate the input stack on Linux. Our aim is to
understand its components and what each does. Input handling can be
divided into two parts, separated by a common layer:</p>

<ul>
  <li>Kernel-level handling: It deals with what happens in the kernel and how events are exposed to user-space
    <ul>
      <li>The actual hardware connected to the machine, along with the different buses and I/O/transport subsystems</li>
      <li>The input core subsystem, and the specific device drivers that register on it</li>
    </ul>
  </li>
  <li>Exposed layer (middle)
    <ul>
      <li>The event abstraction subsystem (evdev)</li>
      <li>devtmpfs for device nodes</li>
      <li>sysfs for kernel objects and device attributes</li>
      <li>procfs for an introspection interface of the input core</li>
    </ul>
  </li>
  <li>User-space handling:
    <ul>
      <li>The user-space device manager (udev) and hardware database (hwdb) for device management and setup</li>
      <li>The libinput library for general input, and other libraries such as
XKB for keyboards, to interpret the events and make them manageable</li>
      <li>The Widgets, X Server, X11 window managers, and Wayland compositors,
which rely on everything else</li>
    </ul>
  </li>
</ul>

<p>We’ll try to make sense of all this, one thing at a time, with a logical
and coherent approach.</p>

<p><em>NB: This article compiles my understand, for any correction please
contact me.</em></p>

<h2 id="the-kernels-input-core">The Kernel’s Input Core</h2>

<p>How are input devices and their events handled in the kernel? You might
think it is useless to know, but understanding some of the kernel logic
is what makes things click.<br>
The input core is the central piece of the kernel responsible for handling
input devices and their events. Most input devices go through it, although
some bypass it entirely but these are special use-cases. It provides
common abstract components that sit between the low-level hardware,
and the more useful features for user-space, along with a sort of
publish-subscribe system.</p>

<p>To follow along you can either download the kernel
source, or view it in any browser explorer (such as
<a href="https://github.com/torvalds/linux/blob/master/drivers/input/input.c">this</a>,
<a href="https://elixir.bootlin.com/linux/v6.17.9/source/drivers/input/input.c">this</a>,
or <a href="https://reverser.dev/linux-kernel-explorer">this</a>).</p>

<p>Practically, the input core is found in the kernel under
<code>drivers/input/input.c</code>, it defines the basic functionalities related
to the lifecycle of an input device, defined as a <code>struct input_dev</code>
(<code>input.h</code>). Namely:</p>

<ul>
  <li>Allocating the input device structure (<code>input_allocate_device</code> that
returns a <code>struct input_dev</code>)</li>
  <li>Registering and unregistering the input device in the system
along with setting sane default values
(<code>input_register_device</code> adds to <code>input_dev_list</code>). This also integrates with devtmpfs,
exposing the device, and with procfs, exposing debugging information
(<code>/proc/bus/input/</code>).</li>
  <li>Drivers push events to the input core using <code>input_event</code>. The core then
forwards the events to the registered handlers in
a fan-out fashion (<code>input_register_handler</code> adds an <code>input_handler</code> to <code>input_handler_list</code>). Then handlers forward
them to all clients in user-space (called <code>input_handle</code>) listening
for events on that handler. The clients are registered on
the handler with <code>input_register_handle</code> (similar confusing names).
The user-space client/handle can also grab the handler with exclusivity
through <code>input_grab_device</code> (ex: <code>EVIOCGRAB</code> in evdev).<br>
By default the evdev (event device) is attached as the default input
handler and exposes these events to user-space in a standardized way
via an evdev created character stream in devtmpfs (<code>/dev/input/eventX</code>).</li>
</ul>

<p>An input handler is an implementation of an abstract interface
(<code>include/linux/input.h</code>), which the input core will call. Particularly,
the <code>input_event</code> function in input core will invoke the implementation
of the input handler’s <code>events</code> function. Here’s the interface an input
handler should fulfil:</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>input_handler</span> <span>{</span>
	<span>void</span> <span>(</span><span>*</span><span>event</span><span>)(</span><span>struct</span> <span>input_handle</span> <span>*</span><span>handle</span><span>,</span> <span>unsigned</span> <span>int</span> <span>type</span><span>,</span>
			        <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>);</span>
	<span>unsigned</span> <span>int</span> <span>(</span><span>*</span><span>events</span><span>)(</span><span>struct</span> <span>input_handle</span> <span>*</span><span>handle</span><span>,</span>
			       <span>struct</span> <span>input_value</span> <span>*</span><span>vals</span><span>,</span> <span>unsigned</span> <span>int</span> <span>count</span><span>);</span>
	<span>bool</span> <span>(</span><span>*</span><span>filter</span><span>)(</span><span>struct</span> <span>input_handle</span> <span>*</span><span>handle</span><span>,</span> <span>unsigned</span> <span>int</span> <span>type</span><span>,</span>
			       <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>);</span>
	<span>bool</span> <span>(</span><span>*</span><span>match</span><span>)(</span><span>struct</span> <span>input_handler</span> <span>*</span><span>handler</span><span>,</span>
			       <span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>);</span>
	<span>int</span> <span>(</span><span>*</span><span>connect</span><span>)(</span><span>struct</span> <span>input_handler</span> <span>*</span><span>handler</span><span>,</span>
			      <span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span>
			      <span>const</span> <span>struct</span> <span>input_device_id</span> <span>*</span><span>id</span><span>);</span>
	<span>void</span> <span>(</span><span>*</span><span>disconnect</span><span>)(</span><span>struct</span> <span>input_handle</span> <span>*</span><span>handle</span><span>);</span>
	<span>void</span> <span>(</span><span>*</span><span>start</span><span>)(</span><span>struct</span> <span>input_handle</span> <span>*</span><span>handle</span><span>);</span>
	<span>/* …
	 */</span>
<span>};</span></code></pre></figure>

<p>In the same way, a handle list is simply a pointer to a device and a
handler, along with a function to process events:</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>input_handle</span> <span>{</span>
	<span>void</span> <span>*</span><span>private</span><span>;</span>

	<span>int</span> <span>open</span><span>;</span>
	<span>const</span> <span>char</span> <span>*</span><span>name</span><span>;</span>

	<span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>;</span>
	<span>struct</span> <span>input_handler</span> <span>*</span><span>handler</span><span>;</span>

	<span>unsigned</span> <span>int</span> <span>(</span><span>*</span><span>handle_events</span><span>)(</span><span>struct</span> <span>input_handle</span> <span>*</span><span>handle</span><span>,</span>
				      <span>struct</span> <span>input_value</span> <span>*</span><span>vals</span><span>,</span>
				      <span>unsigned</span> <span>int</span> <span>count</span><span>);</span>

	<span>struct</span> <span>list_head</span>	<span>d_node</span><span>;</span>
	<span>struct</span> <span>list_head</span>	<span>h_node</span><span>;</span>
<span>};</span></code></pre></figure>

<p>And the <code>input_dev</code> abstraction returned by <code>input_allocate_device</code>
is a much biger structure:</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>input_dev</span> <span>{</span>
	<span>const</span> <span>char</span> <span>*</span><span>name</span><span>;</span>
	<span>const</span> <span>char</span> <span>*</span><span>phys</span><span>;</span>
	<span>const</span> <span>char</span> <span>*</span><span>uniq</span><span>;</span>
	<span>struct</span> <span>input_id</span> <span>id</span><span>;</span>
<span>…</span>
	<span>unsigned</span> <span>int</span> <span>keycodemax</span><span>;</span>
	<span>unsigned</span> <span>int</span> <span>keycodesize</span><span>;</span>
	<span>void</span> <span>*</span><span>keycode</span><span>;</span>
<span>…</span>
	<span>int</span> <span>(</span><span>*</span><span>setkeycode</span><span>)(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span>
			  <span>const</span> <span>struct</span> <span>input_keymap_entry</span> <span>*</span><span>ke</span><span>,</span>
			  <span>unsigned</span> <span>int</span> <span>*</span><span>old_keycode</span><span>);</span>
	<span>int</span> <span>(</span><span>*</span><span>getkeycode</span><span>)(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span>
			  <span>struct</span> <span>input_keymap_entry</span> <span>*</span><span>ke</span><span>);</span>
<span>…</span>
	<span>int</span> <span>(</span><span>*</span><span>open</span><span>)(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>);</span>
	<span>void</span> <span>(</span><span>*</span><span>close</span><span>)(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>);</span>
	<span>int</span> <span>(</span><span>*</span><span>flush</span><span>)(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span> <span>struct</span> <span>file</span> <span>*</span><span>file</span><span>);</span>
	<span>int</span> <span>(</span><span>*</span><span>event</span><span>)(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span> <span>unsigned</span> <span>int</span> <span>type</span><span>,</span> <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>);</span>
<span>…</span>
	<span>struct</span> <span>device</span> <span>dev</span><span>;</span>
<span>…</span>
	<span>struct</span> <span>list_head</span>	<span>h_list</span><span>;</span>
	<span>struct</span> <span>list_head</span>	<span>node</span><span>;</span>
<span>};</span></code></pre></figure>

<p>Each actual specific input device driver builds on top of the functions of the
input core in their internal code, adding their own specificities and
advertising what capabilities and features the device can generate. This
creates a polymorphic-like abstraction where common input core logic is
reused, and where input event handlers are abstracted away. In general,
the main role of input drivers is to translate the device specific
protocol to a more standardized protocol, such as evdev, so that it can
be useful in user-space. And additionally, as with most drivers way of
communicating with the rest of the system, they can possibly have extra
configuration through an ioctl interface.</p>

<p>Along with all this, the kernel has a mechanism called sysfs that is
used to expose its internal objects (kobject) to user-space. Anytime
a device is created, it is exposed in <code>/sys/</code> (usually mounted there)
with its properties (<code>/sys/devices/</code>). For the input core part, we can
find it in <code>/sys/class/input/inputN</code>, and within each sub-directories
we have the properties of the object.<br>
Furthermore, when a device is plugged or unplugged (<code>device_add</code>,
<code>device_remove</code> in <code>drivers/base/core.c</code>), the kernel also emits events,
called uevent, via netlink (<code>PF_NETLINK, NETLINK_KOBJECT_UEVENT</code>) which
can then be caught in user-space and acted upon. We’ll see later how
these are handled by udev.</p>

<p>The kobject structure looks like this:</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>kobject</span> <span>{</span>
        <span>const</span> <span>char</span>              <span>*</span><span>name</span><span>;</span>
        <span>struct</span> <span>list_head</span>        <span>entry</span><span>;</span>
        <span>struct</span> <span>kobject</span>          <span>*</span><span>parent</span><span>;</span>
        <span>struct</span> <span>kset</span>             <span>*</span><span>kset</span><span>;</span>
        <span>struct</span> <span>kobj_type</span>        <span>*</span><span>ktype</span><span>;</span>
        <span>struct</span> <span>sysfs_dirent</span>     <span>*</span><span>sd</span><span>;</span>
        <span>struct</span> <span>kref</span>             <span>kref</span><span>;</span>
        <span>unsigned</span> <span>int</span> <span>state_initialized</span><span>:</span><span>1</span><span>;</span>
        <span>unsigned</span> <span>int</span> <span>state_in_sysfs</span><span>:</span><span>1</span><span>;</span>
        <span>unsigned</span> <span>int</span> <span>state_add_uevent_sent</span><span>:</span><span>1</span><span>;</span>
        <span>unsigned</span> <span>int</span> <span>state_remove_uevent_sent</span><span>:</span><span>1</span><span>;</span>
        <span>unsigned</span> <span>int</span> <span>uevent_suppress</span><span>:</span><span>1</span><span>;</span>
<span>};</span></code></pre></figure>

<p>This is a general overview of our understanding of the input core so far:</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/input_core.png" alt="Input Core Overview" title="Input Core Overview"></p>

<h2 id="the-logical-input-device-topological-path">The Logical Input Device Topological Path</h2>

<p>We may commonly say that devices are connected to a machine and magically
handled from there on. Yet, we know that it’s an abstraction and that
there’s more to it. What happens in reality is that the electrical
connection first passes over a bus/host controller, which then let’s the
data be transported. This data is formatted in a specific input protocol
that should be handled by a driver that speaks it and that subsequently
creates a related input device. In most input device cases, the driver
then translates the protocol into evdev <em>“common speech”</em>.<br>
That’s a whole layer of things before reaching the input core. Just like
in the world of networking, one thing wraps another. In this particular
case, devices have parents, a hierarchy, a stack of devices, drivers,
and helpers.</p>

<p>Here’s what that stack is like in theory, with in reality some lines
blurred together:</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/input_topological_path.png" alt="Topology Overview" title="Topology Overview"></p>

<p>In this section, let’s try to understand how the kernel uses
plug’n’play/hotplug to pick the right drivers in this stack, and how we
pass from electrical signal to evdev. To do that we’ll first look at
how the kernel pictures its internal objects, and how these together
somehow create the above hierarchy. Finally, we’ll see some concrete
examples of that, along with some command line tools that can clearly
display this encapsulating behavior.</p>

<p>As we said there’s a hierarchy of kobjects in the kernel from the bus
to its connected devices. These are stored in-memory as a linked list
hierarchy, which is also represented under sysfs as a file system tree.<br>
Specifically, in <code>drivers/base/core.c</code> this is what is used to create
the parent-child relationship:</p>

<figure><pre><code data-lang="c"><span>device_register</span><span>(</span><span>&amp;</span><span>child</span><span>-&gt;</span><span>dev</span><span>);</span>
<span>child</span><span>-&gt;</span><span>dev</span><span>.</span><span>parent</span> <span>=</span> <span>&amp;</span><span>parent</span><span>-&gt;</span><span>dev</span><span>;</span></code></pre></figure>

<p>For example, here’s the path that an input device data might take.</p>

<div><pre><code>/devices/pci0000:00/0000:00:14.0/usb1/1-1/1-1:1.0/
             0003:046D:C31C.0003/input/input6/event3
</code></pre></div>

<ul>
  <li><code>/devices/...</code> — root of the kernel’s sysfs device tree, showing all devices known to the kernel.</li>
  <li><code>pci0000:00/0000:00:14.0</code> — PCI bus and controller (the USB host controller here).</li>
  <li><code>usb1/1-1/1-1:1.0</code> — USB bus and port hierarchy (device 1-1, interface 1.0).</li>
  <li><code>0003:046D:C31C.0003</code> — HID device node (bus <code>0003</code> = USB HID, vendor <code>046D</code> = Logitech, product <code>C31C</code> = specific keyboard).</li>
  <li><code>input/input6</code> — input subsystem device registered under <code>/sys/class/input/input6</code>.</li>
  <li><code>event3</code> — the evdev interface, the character device exposed in <code>/dev/input/event3</code>.</li>
</ul>

<p>How did we end up with this long list, how did it get created? Let’s see
how the kernel stores this info, and what happens from its perpective.<br>
As far as its concerned, the device-related things it knows is summed
up in these types of objects:</p>

<ul>
  <li>bus - a device to which other devices can be attached</li>
  <li>device - a physical/logical device that is attached to a bus</li>
  <li>driver - a software entity that can be associated with a device and
performs operations with it</li>
  <li>class - a type of device that has similar behavior; There is a class
for disks, partitions, serial ports, input, etc.</li>
  <li>subsystem - a view on the structure of the system; Kernel subsystems
include devices (hierarchical view of all devices in the system), buses
(bus view of devices according to how they are attached to buses),
classes, input, etc. We care about the input subsystem.</li>
</ul>

<p>For example, there are different views of the same device. You’ll find
the physical USB device under <code>/sys/bus/usb/devices/</code> and the logical
device of the input class under <code>/sys/class/input/.</code></p>

<p>Let’s go over these objects, tracing the path, starting with buses.<br>
A hardware bus/host controler is a communication channel between the
processor and input/output device. But a kernel bus object is more
generic than this, it’s a logical function which role is to be a point
of connection of devices. All devices are connected to a kernel bus,
even if it needs to be a virtual one. So kernel buses are the root of
the hierarchy.<br>
The main buses are things such as PCI, USB, IDE, SCSI, platform,
ACPI, etc.</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>bus_type</span> <span>{</span>
        <span>const</span> <span>char</span>              <span>*</span><span>name</span><span>;</span>
        <span>const</span> <span>char</span>              <span>*</span><span>dev_name</span><span>;</span>
        <span>struct</span> <span>device</span>           <span>*</span><span>dev_root</span><span>;</span>
        <span>struct</span> <span>bus_attribute</span>    <span>*</span><span>bus_attrs</span><span>;</span>
        <span>struct</span> <span>device_attribute</span> <span>*</span><span>dev_attrs</span><span>;</span>
        <span>struct</span> <span>driver_attribute</span> <span>*</span><span>drv_attrs</span><span>;</span>
        <span>struct</span> <span>subsys_private</span> <span>*</span><span>p</span><span>;</span>
        <span>int</span>   <span>(</span><span>*</span><span>match</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>,</span> <span>struct</span> <span>device_driver</span> <span>*</span><span>drv</span><span>);</span>
        <span>int</span>   <span>(</span><span>*</span><span>uevent</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>,</span> <span>struct</span> <span>kobj_uevent_env</span> <span>*</span><span>env</span><span>);</span>
        <span>int</span>   <span>(</span><span>*</span><span>probe</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
        <span>int</span>   <span>(</span><span>*</span><span>remove</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
        <span>//...</span>
<span>};</span></code></pre></figure>

<p>Kernel buses are the connective tissue of everything, the base of the
infrastructure. As you can see from the structure it’s responsible for
probing the device to get info about it, handling connected/disconnected
events, creating a new node for it, and sending uevent to notify
user-space and triggering a chain reaction.<br>
Yet, one of their most important role is to start the match between
devices and registered device drivers, as can be noted from the <code>match</code>
function. Keep in mind that the matched driver can be another bus, so
this initiates a cascade of different handlers, bubbling up the hierarchy.</p>

<p>A concrete example of this recursion:</p>

<ul>
  <li>A PCI bus controller (the host bridge) is a device on the platform bus.</li>
  <li>The USB bus (usbcore) is a device on the PCI bus (via xHCI controller).</li>
  <li>The HID bus is a device on the USB bus (via usbhid).</li>
  <li>The specific HID protocol driver is a device on the HID bus</li>
</ul>

<p>The low level kernel buses such as the hardware bus/host controlers
generally don’t handle input data directly, though there are some bus/host
controller drivers that do register input devices to the input core,
bypassing everything else in the stack and acting as event sources. These
exceptions are usually for brightness control hotkeys, lid sensors,
built-in special functions keys, etc.. We have for example the drivers
<code>acpi_video</code>, <code>thinkpad_acpi</code>, <code>asus_wmi</code>, etc..</p>

<p>To know how to handle the devices and whether a driver needs to be loaded
from a module, all devices and buses have specially formatted IDs, to
tell us what kind of devices they are. The ID, which we call MODALIAS,
consists of vendor and product ID with some other subsystem-specific
values. Each bus and device has its own scheme for these IDs.<br>
For a USB mouse, it looks something like this:</p>
<div><pre><code>MODALIAS=usb:v046DpC03Ed2000dc00dsc00dp00ic03isc01ip02
</code></pre></div>

<p>This is needed in case the driver isn’t built-in the kernel and instead
was an external module (<code>*.ko</code>). As a reminder, a driver is some piece
of code responsible for handling a type of device, and a module is a
piece of external kernel code that can be dynamically loaded at runtime
when needed. Depending on the distro choices, some drivers are set as
external modules that need to be loaded at runtime.</p>

<p>To achieve this, the kernel, after composing the MODALIAS string, sends
it within the uevent towards user-space. To complete this information,
each external kernel module comes with a list of known MODALIASes it can
handle, so that they can be loaded as needed. These lists are compiled
by programs such as <code>depmod</code> that creates files like <code>modules.alias</code>
in the kernel’s <code>/lib/modules</code> directory for all currently available
modules that aren’t built-in (<code>/lib/modules/VERSION</code>), and the built-in
ones (<code>modules.builtin</code>).</p>

<p>In theory that’s fine, this infrastructure model makes it easy to
dynamically load modules that are not already built-in, but we need
a piece of software in user-space to catch the events and perform the
actual loading. This is a role that udev embodies by calling <code>modprobe</code>
for every event that has a MODALIAS key, regardless of whether a module
needs loading or not. We’ll see more of udev but for now keep in mind
that its doing this hotplug mechanism.</p>

<p>If you’re curious, you can try this udev command to monitor the MODALIAS.</p>

<div><pre><code>devadm monitor --property
</code></pre></div>

<p>Yet, this doesn’t solve what happens to devices that were present at
boot and which need modules. The solution: there’s a file in the device
directory in sysfs with all the uevent generated at boot for every
devices in sysfs file system, appropriately named “uevent”. If you write
“add” to that file the kernel resends the same events as the one lost
during boot. So a simple loop over all uevent files in <code>/sys</code> triggers
all events again.</p>

<p>The MODALIAS value is also stored in sysfs along with the device
properties, here are a few commands to gather information on this:</p>

<div><pre><code>&gt; cat /sys/devices/pci0000:00/0000:00:10.0/modalias 
pci:v00001022d00007812sv00001025sd00000756bc0Csc03i30

&gt; modprobe --resolve-alias $(cat /sys/devices/\
 pci0000:00/0000:00:13.2/usb1/1-0:1.0/usb1-port3/modalias)
Not everything has an associated module

&gt; ls -l /sys/devices/pci0000:00/0000:00:10.0/driver
lrwxrwxrwx 1 root root 0 Oct 25 11:37 driver \
               -&gt; ../../../bus/pci/drivers/xhci_hcd

If the driver link exists, check which module implements it:
&gt; modprobe -R xhci_hcd
xhci_hcd

&gt; modinfo xhci_hcd
name:           xhci_hcd
filename:       (builtin)
license:        GPL
file:           drivers/usb/host/xhci-hcd
author:         Sarah Sharp
description:    'eXtensible' Host Controller (xHC) Driver
license:        GPL
file:           drivers/usb/host/xhci-hcd
description:    xHCI sideband driver for secondary interrupter management
parm:           link_quirk:Don't clear the chain bit on a link TRB (int)
parm:           quirks:Bit flags for quirks to be enabled as default (ullong)

For example that xhci_hcd module is builtin
</code></pre></div>

<p>So far we’ve learned two things: buses which devices are connected to,
and the MODALIAS mechanism to match modules and dynamically load drivers
that aren’t built-in. Let’s see the devices attached to buses as they
appear as kernel objects.</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>device</span> <span>{</span>
        <span>// …</span>
        <span>struct</span> <span>device</span>           <span>*</span><span>parent</span><span>;</span>
        <span>struct</span> <span>device_private</span>   <span>*</span><span>p</span><span>;</span>
        <span>struct</span> <span>kobject</span>          <span>kobj</span><span>;</span>
        <span>const</span> <span>char</span>              <span>*</span><span>init_name</span><span>;</span> <span>/* initial name of the device */</span>
        <span>// …</span>
        <span>struct</span> <span>bus_type</span>         <span>*</span><span>bus</span><span>;</span>       <span>/* type of bus device is on */</span>
        <span>struct</span> <span>device_driver</span>    <span>*</span><span>driver</span><span>;</span>    <span>/* which driver has allocated this
                                             device */</span>
        <span>// …</span>
        <span>const</span> <span>struct</span> <span>class</span>  <span>*</span><span>class</span><span>;</span>
        <span>// …</span>
        <span>void</span>    <span>(</span><span>*</span><span>release</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
<span>};</span></code></pre></figure>

<p>Along with the related driver:</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>device_driver</span> <span>{</span>
         <span>const</span> <span>char</span>              <span>*</span><span>name</span><span>;</span>
         <span>struct</span> <span>bus_type</span>         <span>*</span><span>bus</span><span>;</span>
         <span>struct</span> <span>driver_private</span>   <span>*</span><span>p</span><span>;</span>
         <span>struct</span> <span>module</span>           <span>*</span><span>owner</span><span>;</span>
         <span>const</span> <span>char</span>              <span>*</span><span>mod_name</span><span>;</span>     <span>/* used for built-in modules */</span>
         <span>int</span>     <span>(</span><span>*</span><span>probe</span><span>)</span>        <span>(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
         <span>int</span>     <span>(</span><span>*</span><span>remove</span><span>)</span>       <span>(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
         <span>void</span>    <span>(</span><span>*</span><span>shutdown</span><span>)</span>     <span>(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
         <span>int</span>     <span>(</span><span>*</span><span>suspend</span><span>)</span>      <span>(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>,</span> <span>pm_message_t</span> <span>state</span><span>);</span>
         <span>int</span>     <span>(</span><span>*</span><span>resume</span><span>)</span>       <span>(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
<span>};</span></code></pre></figure>

<p>As you can notice, they also have a probing and lifecycle functions to
be implemented. We also have the registration/unregistration functions
(<code>input_register_device</code> and <code>input_unregister_device</code> in our case)
which will announce that the device is now available in the system (plus
a uevent and other user-space stuff). Each of the registered devices
have an entry in sysfs <code>/sys/devices</code>, along with the information about
its driver, and similar info in <code>/sys/class</code> and <code>/sys/bus</code>. The
device also creates files in devtmpfs that represent its interfaces. Let’s
note that devtmpfs is usually mounted by default to user-space as a virtual
filesystem on most distros.</p>

<p>To check whether devtmpfs is enabled, which is almost always the case today:</p>

<div><pre><code>&gt; zcat /proc/config.gz | grep DEVTMPFS
CONFIG_DEVTMPFS=y
CONFIG_DEVTMPFS_MOUNT=y
CONFIG_DEVTMPFS_SAFE=y

&gt; mount | grep devtmpfs
dev on /dev type devtmpfs (rw,nosuid,relatime,size=2720672k,\
   nr_inodes=680168,mode=755,inode64)

&gt; mount | grep sysfs
 sys on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)
</code></pre></div>

<p>Devices are associated to classes and subsystems that handle them.
The subsystem we care about here is what we’ve seen in the earlier
section: the input core, the input device subsystem.</p>

<figure><pre><code data-lang="c"><span>subsys_initcall</span><span>(</span><span>input_init</span><span>);</span></code></pre></figure>

<p>As for the concept of a class, it’s a high-level view of the device
model, abstracting implementation details. For example there are drivers
for SCSI and ATA but both are in the disks class. Similarly, all input
devices are in the input class, which is what we care about. This is
a grouping mechanism, unrelated to how the devices are connected. They
can be found in sysfs <code>/sys/class/</code>.<br>
The <code>struct class</code> is instantiated in the <code>struct device</code> through
<code>class_register</code> and <code>class_unregister</code>. This will in turn also help
udev, as we’ll see later, better manage the devices in devtmpfs user-space
mapping <code>/dev/</code>, adding a filter for rules.</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>class</span> <span>{</span>
         <span>const</span> <span>char</span>              <span>*</span><span>name</span><span>;</span>
         <span>struct</span> <span>module</span>           <span>*</span><span>owner</span><span>;</span>
         <span>struct</span> <span>kobject</span>          <span>*</span><span>dev_kobj</span><span>;</span>
         <span>struct</span> <span>subsys_private</span>   <span>*</span><span>p</span><span>;</span>
         <span>struct</span> <span>class_attribute</span>          <span>*</span><span>class_attrs</span><span>;</span>
         <span>struct</span> <span>class_device_attribute</span>   <span>*</span><span>class_dev_attrs</span><span>;</span>
         <span>struct</span> <span>device_attribute</span>         <span>*</span><span>dev_attrs</span><span>;</span>
         <span>int</span>     <span>(</span><span>*</span><span>dev_uevent</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>,</span> <span>struct</span> <span>kobj_uevent_env</span> <span>*</span><span>env</span><span>);</span>
         <span>void</span>    <span>(</span><span>*</span><span>class_release</span><span>)(</span><span>struct</span> <span>class</span> <span>*</span><span>class</span><span>);</span>
         <span>void</span>    <span>(</span><span>*</span><span>dev_release</span><span>)(</span><span>struct</span> <span>device</span> <span>*</span><span>dev</span><span>);</span>
         <span>//...</span>
<span>};</span></code></pre></figure>

<p>In the input core:</p>

<figure><pre><code data-lang="c"><span>const</span> <span>struct</span> <span>class</span> <span>input_class</span> <span>=</span> <span>{</span>
    <span>.</span><span>name</span>       <span>=</span> <span>"input"</span><span>,</span>
    <span>.</span><span>devnode</span>    <span>=</span> <span>input_devnode</span><span>,</span>
<span>};</span></code></pre></figure>

<p>This completes our overview of the way the kernel perceives the different
types of objects it manages. However, that didn’t clarify how we ended
up with the example path above other than somehow having a kernel bus and
device hierarchy.<br>
We talked about hardware buses and host controllers drivers that aren’t
handling data and that they delegate this to an upper layer. In theory
this upper layer is split between a kernel bus&amp;device for the transport
layer, aka IO layer, and a kernel bus&amp;device for the protocol layer,
but in reality those might get mixed up (bus&amp;device because it’s both).</p>

<p>The IO layer is responsible for handling the physical electrical
communication with the device, it’s setup, and management. At this level
we have USB, Bluetooth, I2C, SPI, etc.. In drivers that means: <code>usbhid</code>
for HID devices over USB, <code>btusb</code> and <code>hidp</code> for HID over Bluetooth,
<code>i2c-hid</code> for touchpads and keyboards that are wired to the motherboard’s
I2C, <code>psmouse</code> and <code>serio</code> for PS2 mouse, etc..<br>
The protocol or function specific layer then takes over and has as role
to integrate with the input core and translate the raw transport data
into a common format, usually evdev. The evdev format is favored
as it provides a uniform API to represent input devices (via
<code>/dev/input/eventX</code>).</p>

<p>A few examples:</p>

<ul>
  <li>There’s a mouse communication protocol usin 9 pins DE-9 over the RS-232
standard for communication with UART</li>
  <li>The PS/2 mouse which uses a serial transport protocol with 6 pins (<code>serio</code>)</li>
  <li>The atkbd keyboard also over serial transport</li>
  <li>A gamepad that uses HID but the particular case of a sony joystick over USB</li>
  <li>A touchscreen specific driver using I²C or SPI</li>
</ul>

<p>Or as a hierarchical example:</p>

<div><pre><code>[PCI bus]
   └── probes -&gt; xhci_hcd (a PCI driver)
         └── registers usb_hcd with -&gt; [USB core]
                 └── enumerates and manages -&gt; [USB bus]
                        └── matches -&gt; usbhid (a USB driver)
                               └── registers -&gt; [HID bus]
                                      └── matches -&gt; hid-generic, hid-apple, ...
                                            └── registers -&gt; [Input bus]
                                                  └── matches -&gt; evdev, ...
</code></pre></div>

<p>There’s another component of complexity to add: we don’t have a
single protocol for a single transport over a single hardware bus/host
controller. Sometimes there’s a generic protocol layer which is reused
with different transport mechanisms. There can also be a delegation
mechanism for the more specific sub-protocol handlers for specific
devices or modes.<br>
For example, you can have an HID protocol over USB (<code>usbhid</code>), and the
particular part of the HID protocol used for input devices, and the more
specific sub-HID protocol of a type of device (<code>hid-generic</code> and others).</p>

<p>We’ll see an example of this by diving into the HID subsystem which is
the most popular input protocol these days, but first let’s check some
tools that can help us see all that we’ve learned thus far and make
sense of the hierarchy:</p>

<ul>
  <li><code>lspci -vn</code> list info about devices connected via PCI buses</li>
  <li><code>lsusb -v</code> or <code>usb-devices</code> list usb devices information in a more human readable form</li>
  <li><code>dmesg</code> the sys logs</li>
  <li><code>hwinfo --short</code> to probe hardware</li>
</ul>

<p>Yet the best way to get a lot of info about the bus and device hierarchy
is to rely on <code>udevadm</code>, a user-space tool that comes with udev. Here’s
how it looks for an input device:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> udevadm info <span>-a</span> <span>-p</span> <span>$(</span>udevadm info <span>-q</span> path <span>-n</span> /dev/input/event9<span>)</span>


looking at device <span>'/devices/.../input/input6/event9'</span>:
  <span>KERNEL</span><span>==</span><span>"event9"</span>
  <span>SUBSYSTEM</span><span>==</span><span>"input"</span>
  ATTR<span>{</span>name<span>}==</span><span>"Logitech USB Keyboard"</span>
  ...
looking at parent device <span>'/devices/.../input/input6'</span>:
  <span>KERNEL</span><span>==</span><span>"input6"</span>
  <span>SUBSYSTEM</span><span>==</span><span>"input"</span>
  ...
looking at parent device <span>'/devices/.../0003:046D:C31C.0003'</span>:
  <span>KERNELS</span><span>==</span><span>"0003:046D:C31C.0003"</span>
  <span>DRIVERS</span><span>==</span><span>"hid-generic"</span>
  <span>SUBSYSTEMS</span><span>==</span><span>"hid"</span>
  ...
looking at parent device <span>'/devices/.../1-1:1.0'</span>:
  <span>KERNELS</span><span>==</span><span>"1-1:1.0"</span>
  <span>SUBSYSTEMS</span><span>==</span><span>"usb"</span>
  <span>DRIVERS</span><span>==</span><span>"usbhid"</span>
  ...
looking at parent device <span>'/devices/.../1-1'</span>:
  <span>KERNELS</span><span>==</span><span>"1-1"</span>
  <span>SUBSYSTEMS</span><span>==</span><span>"usb"</span>
  <span>DRIVERS</span><span>==</span><span>"usb"</span>
  ...
looking at parent device <span>'/devices/.../0000:00:14.0'</span>:
  <span>KERNELS</span><span>==</span><span>"0000:00:14.0"</span>
  <span>SUBSYSTEMS</span><span>==</span><span>"pci"</span>
  <span>DRIVERS</span><span>==</span><span>"ohci-pci"</span>
  ...</code></pre></figure>

<p><em>NB</em>: It is also a bit more clearer, though for the moment confusing,
to also look at <code>udevadm info --tree</code>. Similarly, the <code>loginctl
seat-status</code> also clearly shows the hierarchy of devices in the current
session. We’ll talk more about the concept of seats later on.</p>

<p>We see the “looking at parent device” block that corresponds to one
<code>struct device</code> in the kernel kobject mapped in sysfs, along with the
driver, when it’s present, and other info it gathers at every step,
walking down the bus hierarchy. Let’s note that not everything has
an associated driver since the hardware topology might not match the
driver topology. That often means one kernel component handles multiple
parts of the stack. In the above trace, <code>hid-generic</code> handles the input
registering.</p>

<p>This example in particular shows:</p>

<div><pre><code>PCI → USB controller → USB device → HID interface → input device → evdev node
</code></pre></div>

<p>Another source of information that we briefly mentioned is the procfs
introspection interface (<code>/proc/bus/input/</code>), it can also help see the
handling of input devices more clearly as it’s a text-based view of what
the kernel input subsystem knows. It is more or less analogous to the
sysfs view but is meant for human-readable diagnostics. In conjunction
with what we’ve learned in the previous input core section, it should
clarify some of our understanding.  It has two files underneath: <code>devices</code>
and <code>handlers</code>.</p>

<p>The <code>devices</code> file contain all the current input devices and has entries
with these fields:</p>

<ul>
  <li><code>I</code>: basic info (bus type, vendor/product/version)</li>
  <li><code>N</code>: name</li>
  <li><code>P</code>: physical path (e.g., <code>isa0060/serio0/input0</code>)</li>
  <li><code>S</code>: sysfs path</li>
  <li><code>U</code>: unique identifier (if provided)</li>
  <li><code>H</code>: list of event handler interfaces bound (like <code>event3</code>, <code>js0</code>, etc.)</li>
  <li><code>B</code>: capability bitmaps (<code>EV</code>, <code>KEY</code>, <code>REL</code>, <code>ABS</code>, etc.) we’ll explore what
this means when looking at evdev</li>
</ul>

<p>For instance:</p>

<figure><pre><code data-lang="shell">I: <span>Bus</span><span>=</span>0003 <span>Vendor</span><span>=</span>1a2c <span>Product</span><span>=</span>6004 <span>Version</span><span>=</span>0110
N: <span>Name</span><span>=</span><span>"SEMICO USB Keyboard Consumer Control"</span>
P: <span>Phys</span><span>=</span>usb-0000:00:12.0-1/input1
S: <span>Sysfs</span><span>=</span>/devices/pci0000:00/0000:00:12.0/usb2/2-1/<span>\</span>
   2-1:1.1/0003:1A2C:6004.001E/input/input53
U: <span>Uniq</span><span>=</span>
H: <span>Handlers</span><span>=</span>kbd event7 
B: <span>PROP</span><span>=</span>0
B: <span>EV</span><span>=</span>1f
B: <span>KEY</span><span>=</span>33eff 0 0 483ffff17aff32d bfd4444600000000 1 <span>\</span>
   130c730b17c000 267bfad9415fed 9e168000004400 10000002
B: <span>REL</span><span>=</span>1040
B: <span>ABS</span><span>=</span>100000000
B: <span>MSC</span><span>=</span>10

I: <span>Bus</span><span>=</span>0003 <span>Vendor</span><span>=</span>1a2c <span>Product</span><span>=</span>6004 <span>Version</span><span>=</span>0110
N: <span>Name</span><span>=</span><span>"SEMICO USB Keyboard System Control"</span>
P: <span>Phys</span><span>=</span>usb-0000:00:12.0-1/input1
S: <span>Sysfs</span><span>=</span>/devices/pci0000:00/0000:00:12.0/usb2/2-1/<span>\</span>
   2-1:1.1/0003:1A2C:6004.001E/input/input54
U: <span>Uniq</span><span>=</span>
H: <span>Handlers</span><span>=</span>kbd event9 
B: <span>PROP</span><span>=</span>0
B: <span>EV</span><span>=</span>13
B: <span>KEY</span><span>=</span>c000 10000000000000 0
B: <span>MSC</span><span>=</span>10</code></pre></figure>

<p>Here you can see that a single physical device can possibly present
itself as multiple input devices with different handlers attached for
separate functions (here the keys of the System Control handler are
fewer). Here, <code>kbd</code> is console handler, and <code>eventN</code> is the evdev
user-space handler. Libinput, which we’ll cover later, uses groups
<code>LIBINPUT_DEVICE_GROUP</code> to logically combine the different devices that
are actually on the same hardware.</p>

<p>The handlers file is about instances of the <code>input_handler</code> that will
be called from input core’s <code>input_event</code> we mentioned before. As we
said most of it is handled by evdev, but there are exceptions such as:</p>

<figure><pre><code data-lang="shell">N: <span>Number</span><span>=</span>0 <span>Name</span><span>=</span>kbd
N: <span>Number</span><span>=</span>1 <span>Name</span><span>=</span>leds
N: <span>Number</span><span>=</span>2 <span>Name</span><span>=</span>evdev <span>Minor</span><span>=</span>64
N: <span>Number</span><span>=</span>3 <span>Name</span><span>=</span>sysrq <span>(</span>filter<span>)</span>
N: <span>Number</span><span>=</span>4 <span>Name</span><span>=</span>rfkill
N: <span>Number</span><span>=</span>5 <span>Name</span><span>=</span>mousedev <span>Minor</span><span>=</span>32
N: <span>Number</span><span>=</span>6 <span>Name</span><span>=</span>joydev <span>Minor</span><span>=</span>0</code></pre></figure>

<p>We’ll talk about joydev later on. As for mousedev, it is there only for
legacy compatibility of old <code>/dev/psaux</code>-style mouse interface.</p>

<p>Let’s now see the example of a dummy input driver, to get the idea across.</p>

<figure><pre><code data-lang="c"><span>// SPDX-License-Identifier: GPL-2.0</span>
<span>#include</span> <span>&lt;linux/module.h&gt;</span><span>
#include</span> <span>&lt;linux/init.h&gt;</span><span>
#include</span> <span>&lt;linux/input.h&gt;</span><span>
#include</span> <span>&lt;linux/timer.h&gt;</span><span>
</span>
<span>static</span> <span>struct</span> <span>input_dev</span> <span>*</span><span>dummy_input_dev</span><span>;</span>
<span>static</span> <span>struct</span> <span>timer_list</span> <span>dummy_timer</span><span>;</span>

<span>static</span> <span>void</span> <span>dummy_timer_func</span><span>(</span><span>struct</span> <span>timer_list</span> <span>*</span><span>t</span><span>)</span>
<span>{</span>
    <span>static</span> <span>bool</span> <span>key_down</span> <span>=</span> <span>false</span><span>;</span>

    <span>/* Simulate key press/release of KEY_A */</span>
    <span>key_down</span> <span>=</span> <span>!</span><span>key_down</span><span>;</span>
    <span>input_event</span><span>(</span><span>dummy_input_dev</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>KEY_A</span><span>,</span> <span>key_down</span><span>);</span>
    <span>input_event</span><span>(</span><span>dummy_input_dev</span><span>,</span> <span>EV_SYN</span><span>,</span> <span>SYN_REPORT</span><span>,</span> <span>0</span><span>);</span>

    <span>/* Reschedule timer */</span>
    <span>mod_timer</span><span>(</span><span>&amp;</span><span>dummy_timer</span><span>,</span> <span>jiffies</span> <span>+</span> <span>msecs_to_jiffies</span><span>(</span><span>2000</span><span>));</span>
<span>}</span>

<span>static</span> <span>int</span> <span>__init</span> <span>dummy_input_init</span><span>(</span><span>void</span><span>)</span>
<span>{</span>
    <span>int</span> <span>err</span><span>;</span>

    <span>dummy_input_dev</span> <span>=</span> <span>input_allocate_device</span><span>();</span>
    <span>if</span> <span>(</span><span>!</span><span>dummy_input_dev</span><span>)</span>
        <span>return</span> <span>-</span><span>ENOMEM</span><span>;</span>

    <span>dummy_input_dev</span><span>-&gt;</span><span>name</span> <span>=</span> <span>"Dummy Input Device"</span><span>;</span>
    <span>dummy_input_dev</span><span>-&gt;</span><span>phys</span> <span>=</span> <span>"dummy/input0"</span><span>;</span>
    <span>dummy_input_dev</span><span>-&gt;</span><span>id</span><span>.</span><span>bustype</span> <span>=</span> <span>BUS_VIRTUAL</span><span>;</span>
    <span>dummy_input_dev</span><span>-&gt;</span><span>id</span><span>.</span><span>vendor</span>  <span>=</span> <span>0x0001</span><span>;</span>
    <span>dummy_input_dev</span><span>-&gt;</span><span>id</span><span>.</span><span>product</span> <span>=</span> <span>0x0001</span><span>;</span>
    <span>dummy_input_dev</span><span>-&gt;</span><span>id</span><span>.</span><span>version</span> <span>=</span> <span>0x0100</span><span>;</span>

    <span>/* Declare we can emit key events */</span>
    <span>__set_bit</span><span>(</span><span>EV_KEY</span><span>,</span> <span>dummy_input_dev</span><span>-&gt;</span><span>evbit</span><span>);</span>
    <span>__set_bit</span><span>(</span><span>KEY_A</span><span>,</span> <span>dummy_input_dev</span><span>-&gt;</span><span>keybit</span><span>);</span>

    <span>err</span> <span>=</span> <span>input_register_device</span><span>(</span><span>dummy_input_dev</span><span>);</span>
    <span>if</span> <span>(</span><span>err</span><span>)</span> <span>{</span>
        <span>input_free_device</span><span>(</span><span>dummy_input_dev</span><span>);</span>
        <span>return</span> <span>err</span><span>;</span>
    <span>}</span>

    <span>/* Setup a timer to inject key events periodically */</span>
    <span>timer_setup</span><span>(</span><span>&amp;</span><span>dummy_timer</span><span>,</span> <span>dummy_timer_func</span><span>,</span> <span>0</span><span>);</span>
    <span>mod_timer</span><span>(</span><span>&amp;</span><span>dummy_timer</span><span>,</span> <span>jiffies</span> <span>+</span> <span>msecs_to_jiffies</span><span>(</span><span>2000</span><span>));</span>

    <span>pr_info</span><span>(</span><span>"dummy_input: registered fake input device</span><span>\n</span><span>"</span><span>);</span>
    <span>return</span> <span>0</span><span>;</span>
<span>}</span>

<span>static</span> <span>void</span> <span>__exit</span> <span>dummy_input_exit</span><span>(</span><span>void</span><span>)</span>
<span>{</span>
    <span>del_timer_sync</span><span>(</span><span>&amp;</span><span>dummy_timer</span><span>);</span>
    <span>input_unregister_device</span><span>(</span><span>dummy_input_dev</span><span>);</span>
    <span>pr_info</span><span>(</span><span>"dummy_input: unregistered</span><span>\n</span><span>"</span><span>);</span>
<span>}</span>

<span>module_init</span><span>(</span><span>dummy_input_init</span><span>);</span>
<span>module_exit</span><span>(</span><span>dummy_input_exit</span><span>);</span>

<span>MODULE_AUTHOR</span><span>(</span><span>"Example Author"</span><span>);</span>
<span>MODULE_DESCRIPTION</span><span>(</span><span>"Minimal Dummy Input Device"</span><span>);</span>
<span>MODULE_LICENSE</span><span>(</span><span>"GPL"</span><span>);</span></code></pre></figure>

<p>That’s it, you should now somewhat have an idea of how we pass from
hardware events, to kernel objects, and end up within the input core
subsystem, which should prepare events for user-space. Let’s now dig on
and explore a few of the topics we’ve grazed in the past two sections.</p>

<h2 id="sysfs">sysfs</h2>

<p>We already covered a lot of ground in understanding sysfs, so let’s
continue and summarize everything we know and complete the full picture.</p>

<p>As we briefly said before, sysfs is a virtual file system representation in
user-space of the kernel objects and their attributes, it’s how the kernel
views the current state of the system, and also how the user can interface
with the parameters of the kernel in a centralized manner. It’s all done
in a very Unixy way by manipulating simple files.<br>
The file mapping happens as such: kernel objects are directories, their
attributes are regular files, and the relationship between objects is
represented as sub-directories and symbolic links.</p>

<p>The object information is categorized as one of the following. Each of
these is a sub-directory under <code>/sys/</code>.</p>

<ul>
  <li>block - all block devices available in the system (disks, partitions)</li>
  <li>bus - types of bus to which physical devices are connected (pci, ide, usb)</li>
  <li>class - drivers classes that are available in the system (net, sound, usb)</li>
  <li>devices - the hierarchical structure of devices connected to the system</li>
  <li>dev - Major and minor device identifier. It can be used to automatically
create entries in the <code>/dev</code> directory. It’s another categorization of
the devices directory</li>
  <li>firmware - information from system firmware (ACPI)</li>
  <li>fs - information about mounted file systems</li>
  <li>kernel - kernel status information (logged-in users, hotplug)</li>
  <li>module - the list of modules currently loaded</li>
  <li>power - information related to the power management subsystem
information is found in standard files that contain an attribute</li>
  <li>device (optionally) - a symbolic link to the directory containing devices; It can be used to discover the hardware devices that provide a particular service (for example, the ethi PCI card)</li>
  <li>driver (optionally) - a symbolic link to the driver directory (located in <code>/sys/bus/*/drivers</code> )</li>
</ul>

<p>As far as we’re concerned, when it comes to input devices, the
<code>/sys/devices/</code> directory is probably one of the most important. It’s
the representation of the hierarchy of devices we’ve talked about in
the previous section.<br>
Pasting the tree here would be cumbersome, but try <code>tree -L 5 | less</code>
within <code>/sys/devices</code> and you’ll clearly see how things fit together,
a direct hierarchical mapping of how devices are connected to each others.<br>
Within this directory we can find interesting information associated to
the device and its type. For usb devices, for example, we have info such
as the bus number, port number, the vendor and product id, manufacturer,
speed, and others.</p>

<p>Furthermore, the <code>/sys/bus</code> directory organizes devices by the type of
bus they are connected to. You can imagine that this isn’t a linear
view since buses can have buses as devices (<code>usb</code> and <code>hid</code> each have
their directory even though <code>hid</code> is probably under <code>usb</code>), but it it
helpful to perceive what is happening, an easy shortcut. Within each
bus directory there are two subdirectories: drivers, that contains the
driver registered for the bus, and devices, that contains symbolic links
to the devices connected to that bus in <code>/sys/devices</code>.</p>

<p>Similarly, the <code>/sys/class</code> directory has another view of the system
from a more functional/type perspective. It’s about what devices do and
not how they’re connected. As far as we’re concerned, the subdirectory
<code>/sys/class/input/</code> is where we’ll find symbolic links to all devices
that have the input class in <code>/sys/devices</code>.<br>
This directory contains both symlinks to input devices and evdev devices,
the latter are usually sub-directories of the former. A notable file in
the input directory is the “capabilities” file, which lists everything
that the device is capable, as far as input is concerned. We’ll revisit
this in the evdev section.</p>

<p>Finally, the last directory that is of interest to us in sysfs is
<code>/sys/module/</code> which provides information and settings for all loaded
kernel modules (the ones that show with <code>lsmod</code>), their dependencies
and parameters.</p>

<div><pre><code>├── hid_generic
│&nbsp;&nbsp; ├── drivers
│&nbsp;&nbsp; │&nbsp;&nbsp; └── hid:hid-generic -&gt; ../../../bus/hid/drivers/hid-generic
│&nbsp;&nbsp; └── uevent

&gt; modinfo hid_generic
name:           hid_generic
filename:       (builtin)
license:        GPL
file:           drivers/hid/hid-generic
description:    HID generic driver
author:         Henrik Rydberg
</code></pre></div>

<p>Lastly, and it might not need to be mentioned, but sysfs needs to be
enabled in the kernel confs. It always is these days since it’s expected
by many software.</p>



<h2 id="hid--human-interface-device">HID — Human Interface Device</h2>

<p>HID, or Human Interface Device, has been mentioned and sprinkled all
over the place in the last sections, we said it’s a device protocol but
what is it exactly?</p>

<p>HID is probably the most important input/output standard device protocol
these days, it’s literally everywhere and most new devices, from mice
to microphones, speak it over all types of transports such as USB, i2c,
Bluetooth, BLE, etc… It’s popular because it’s a universal way to let the
device first describe its capabilities (buttons, keys, axis, etc..),
what it can send/receive (Report Descriptor), and then send/receive them in
the expected way (Input/Output/Feature Reports).<br>
In sum, in the ideal case it would mean avoiding having a specific driver
for every new device out there and instead have a centralized generic way
to handle all categories of devices, all working out-of-the-box. Indeed, in
practice it has worked great and there have only been minor vendor or
hardware quirks fixes (<code>drivers/hid/hid-quirks.c</code> and others).<br>
For example, a HID Report Descriptor may specify that “in a report
with ID 3 the bits from 8 to 15 is the delta x coordinate of a mouse”.
The HID report itself then merely carries the actual data values without
any extra meta information.</p>

<p>The current list of HID devices can be found under the HID
bus in syfs, <code>/sys/bus/hid/devices/</code>. For each device, say
<code>/sys/bus/hid/devices/0003:1B3F:2008.003E/</code>, one can read the
corresponding report descriptor:</p>

<div><pre><code>&gt; hexdump -C /sys/bus/hid/devices/0003:1B3F:2008.003E/report_descriptor
00000000  05 0c 09 01 a1 01 15 00  25 01 09 e9 09 ea 75 01  |........%.....u.|
00000010  95 02 81 02 09 e2 09 cd  09 b5 09 b6 09 8c 95 05  |................|
00000020  81 06 09 00 95 01 81 02  c0                       |.........|
00000029
</code></pre></div>

<p>The raw HID reports can also be read from the <code>hidraw</code> file created by
hid core in devtmpfs <code>/dev/hidrawN</code>.</p>

<p>What does an input device HID Report and Report Descriptor look like?
We won’t go into too much details since the HID specifications are huge
but we’ll only do a tour to get an idea and be productive with what
we know. If you want to dive deeper, check the specifications
<a href="https://www.usb.org/hid">here</a>, it’s divided into a basic structure doc
“HID USB Device Class Definition”, and the HUT, “HID Usage Tables”, which
defines constants to be used by applications.</p>

<p>So as we said, the main logic of the protocol is that HID messages are
called Reports and that to parse them we need a Report Descriptor. The
Report Descriptor is a kind of hashmap stream, it contains Items, which
are 1B header followed by an optional payload of up-to 4B. The Items
don’t make sense by themselves, but do make sense together as a whole
when read as a full stream since each Item has a different meaning. Some
meaning apply locally and others globally.</p>

<p>The encapsulating and/or categorizing Items are the Usage Page, which
is a generic category of thing we’re describing, with its subset of
Usage, which is the specific thing we control within that Page. These
are defined in the “HID Usage Tables” doc. It’s things such as:</p>

<div><pre><code>Usage Page: Generic Desktop (0x01) Usage: Mouse (0x02)
Usage Page: Button (0x09)          Usage: Optional
Usage Page: Consumer Page (0x0C)   Usage: Numeric Key Pad (0x02)
</code></pre></div>

<p>It’s a couple of info to know how to better handle the HID internal data,
it tells you what is actually being handled.</p>

<p>Another grouping mechanism is the Collection, a broader category
to put together all that the device handles. Let’s say a mouse can
have both buttons, a scroll wheel, and axis it moves on, all within
a Collection. There are 3 types of collections that encapsulate each
others: Application (mandatory) the device-level group, Logical (optional)
sub-grouping for related controls, and Physical (optional) sub-grouping
for physical sensors.</p>

<p>Reports within Collections can also be grouped by IDs to facilitate
parsing.</p>

<p>Within all these, within the inner Collections, we finally have the
definition of what the Reports will actually look like. Here’s a subset
of what a Report Descriptor can look like:</p>

<div><pre><code>Report ID (01)
Usage Page (Button)
Usage Minimum (1)
Usage Maximum (5)
Report Count (5)
Report Size (1)
Input (Data,Var,Abs)

Report Size (3)
Report Count (1)
Input (Cnst,Arr,Abs)

Usage Page (Generic Desktop)
Usage (X)
Usage (Y)
Report Count (2)
Report Size (16)
Logical Minimum (-32767)
Logical Maximum (32767)
Input (Data,Var,Rel)
</code></pre></div>

<p>This is all a single report with ID <code>0x01</code>, and we see first that within
the Button page we have values ranging from 1 to 5, a count of fields
in the current report size of 5, for 5 buttons each having one bit. The
<code>Input</code> Item tells us to start processing the Report as input data (there’s
also <code>Output</code> and <code>Feature</code>). It also indicates that buttons have absolute
values, unlike the X/Y axis which are relative.</p>

<p>The <code>Cnst</code> of the following data in the stream stands for constant,
and it’s basically ignored, it’s padding.</p>

<p>And so on, we parse the data afterward, the X/Y relative movements.</p>

<p>One thing to note, is the scope of the meaning of the Items. Some apply
globally, such as the Usage Page, Logical Min/Max, Report Size, Report
Count, etc.. Meanwhile, Usage only apply locally and needs to be set
again. Other Items have special meaning such as Input, Output, Feature,
Collection and End Collection, and are about defining the structure of
data and when to process it.</p>

<p>Here’s a full real example with the Collection grouping mechanism:</p>

<div><pre><code>Usage Page (Generic Desktop)
Usage (Mouse)
Collection (Application)
 Usage Page (Generic Desktop)
 Usage (Mouse)
 Collection (Logical)
  Report ID (26)
  Usage (Pointer)
  Collection (Physical)

   Usage Page (Button)
   Usage Minimum (1)
   Usage Maximum (5)
   Report Count (5)
   Report Size (1)
   Logical Minimum (0)
   Logical Maximum (1)
   Input (Data,Var,Abs)

   Report Size (3)
   Report Count (1)
   Input (Cnst,Arr,Abs)

   Usage Page (Generic Desktop)
   Usage (X)
   Usage (Y)
   Report Count (2)
   Report Size (16)
   Logical Minimum (-32767)
   Logical Maximum (32767)
   Input (Data,Var,Rel)

   Usage (Wheel)
   Physical Minimum (0)
   Physical Maximum (0)
   Report Count (1)
   Report Size (16)
   Logical Minimum (-32767)
   Logical Maximum (32767)
   Input (Data,Var,Rel)
  End Collection
 End Collection
End Collection
</code></pre></div>

<p>As you can see, lots of it may seem redundant within the Logical and
Physical optional sub-collections but they’re often there by default
for hierarchical grouping. They’re not mandatory but common.<br>
Let’s also note that from hid-input’s perspective, one device is created
per top-level Application Collection, so in theory a device can have
many sub-devices.</p>

<p>From the kernel’s perspective, the transport bus notices that a device
is advertised as an HID class and then the data gets routed to the hid
core bus.</p>

<p>For example, this is what the USB transport might notice:</p>

<div><pre><code>bInterfaceClass    = 0x03   ← USB_CLASS_HID
bInterfaceSubClass = 0x01   ← Boot Interface Subclass (optional)
bInterfaceProtocol = 0x02   ← Mouse  (0x01 = Keyboard)
</code></pre></div>

<p>And you can clearly see similar ATTRS in the <code>udevadm</code> trace we took in
earlier in a previous section:</p>

<figure><pre><code data-lang="shell">looking at parent device <span>'/devices/pci0000:00/0000:00:12.0/usb2/2-4/2-4:1.3'</span>:
  <span>KERNELS</span><span>==</span><span>"2-4:1.3"</span>
  <span>SUBSYSTEMS</span><span>==</span><span>"usb"</span>
  <span>DRIVERS</span><span>==</span><span>"usbhid"</span>
  ATTRS<span>{</span>authorized<span>}==</span><span>"1"</span>
  ATTRS<span>{</span>bAlternateSetting<span>}==</span><span>" 0"</span>
  ATTRS<span>{</span>bInterfaceClass<span>}==</span><span>"03"</span>
  ATTRS<span>{</span>bInterfaceNumber<span>}==</span><span>"03"</span>
  ATTRS<span>{</span>bInterfaceProtocol<span>}==</span><span>"00"</span>
  ATTRS<span>{</span>bInterfaceSubClass<span>}==</span><span>"00"</span>
  ATTRS<span>{</span>bNumEndpoints<span>}==</span><span>"01"</span>
  ATTRS<span>{</span>supports_autosuspend<span>}==</span><span>"1"</span></code></pre></figure>

<p>The HID core subsystem is in charge of managing the lifecycle
(connect/disconnect/open/close), parsing the HID report descriptors
to understand the device capabilities. Once parsed, it dispatches
Reports to the HID drivers registered on the HID bus, each driver can
inspect the Usage Page and Usage to decide how and whether to handle
them. This is like a publish-subscribe mechanism. The most specific
registered driver (vendor specific) will match and handle Reports in
whatever way they see fit, otherwise the hid-generic driver is the
fallback.</p>

<p>Several <code>*_connect</code> hooks in the HID core subsystem allow attaching
handlers for different behavior that HID device provide. The most
important for us is the <code>hidinput_connect</code> for the <code>HID_CONNECT_HIDINPUT</code>,
to handle HID input devices. It’s default implementation lives in
<code>hid-input</code> (internally <code>hidinput_report_event</code>). Device specific drivers
can override this behavior if needed. The hid-input role is to bridge
with the input core, allocating and registering the input device via
<code>input_register_device</code>, which will in turn expose <code>/dev/input/eventN</code>,
as we’ve seen before, and translate HID Reports to evdev.<br>
Similarly, in this pub-sub fan-out fashion, another handler is the
default one registered for <code>HID_CONNECT_HIDRAW</code>, from <code>hidraw.c</code>
(<code>hidraw_report_event</code>). This driver will create a raw interface on
devtmpfs (<code>/dev/hidrawN</code>) to interface with raw HID events that aren’t
necessarily input-related.</p>

<p>This looks somewhat like this:</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/hid_core.png" alt="HID Core Overview" title="HID Core Overview"></p>

<p>This is all neat, let’s list a couple of tools that can help us debug
HID and inspect HID Reports Descriptors and Reports.</p>

<ul>
  <li><code>usbhid-dump</code> - will dump USB HID device report descriptors and streams</li>
  <li><a href="https://github.com/abend0c1/hidrdd">hidrdd</a> - verbose description of hid report descriptors</li>
  <li><code>hid-tools</code> - has many sub-tools such as replay, decode, and recording</li>
  <li><code>hid-replay</code> - to test and replay hid events</li>
  <li><a href="https://eleccelerator.com/usbdescreqparser">Online USB Descriptor and Request Parser</a></li>
</ul>

<p>The simplest one in my opinion is hid-tools, here’s an example of a
keyboard with consumer control and system control, the same one we’ve
seen in the procfs introspection interface earlier (<code>/proc/bus/input/</code>):</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> hid-decode /sys/bus/hid/devices/0003:1A2C:6004.004F/report_descriptor

<span># device 0:0</span>

<span># 0x05, 0x0c,        // Usage Page (Consumer Devices)   0</span>
<span># 0x09, 0x01,        // Usage (Consumer Control)        2</span>
<span># 0xa1, 0x01,        // Collection (Application)        4</span>
<span># 0x85, 0x01,        //  Report ID (1)                  6</span>
<span># 0x19, 0x00,        //  Usage Minimum (0)              8</span>
<span># 0x2a, 0x3c, 0x02,  //  Usage Maximum (572)            10</span>
<span># 0x15, 0x00,        //  Logical Minimum (0)            13</span>
<span># 0x26, 0x3c, 0x02,  //  Logical Maximum (572)          15</span>
<span># 0x95, 0x01,        //  Report Count (1)               18</span>
<span># 0x75, 0x10,        //  Report Size (16)               20</span>
<span># 0x81, 0x00,        //  Input (Data,Arr,Abs)           22</span>
<span># 0xc0,              // End Collection                  24</span>

<span># 0x05, 0x01,        // Usage Page (Generic Desktop)    25</span>
<span># 0x09, 0x80,        // Usage (System Control)          27</span>
<span># 0xa1, 0x01,        // Collection (Application)        29</span>
<span># 0x85, 0x02,        //  Report ID (2)                  31</span>
<span># 0x19, 0x81,        //  Usage Minimum (129)            33</span>
<span># 0x29, 0x83,        //  Usage Maximum (131)            35</span>
<span># 0x25, 0x01,        //  Logical Maximum (1)            37</span>
<span># 0x75, 0x01,        //  Report Size (1)                39</span>
<span># 0x95, 0x03,        //  Report Count (3)               41</span>
<span># 0x81, 0x02,        //  Input (Data,Var,Abs)           43</span>
<span># 0x95, 0x05,        //  Report Count (5)               45</span>
<span># 0x81, 0x01,        //  Input (Cnst,Arr,Abs)           47</span>
<span># 0xc0,              // End Collection                  49</span>
<span># </span>
R: 50 05 0c 09 01 a1 01 85 01 19 00 2a 3c 02 15 00 26 3c <span>\</span>
   02 95 01 75 10 81 00 c0 05 01 09 80 a1 01 85 02 19 81 <span>\</span>
   29 83 25 01 75 01 95 03 81 02 95 05 81 01 c0
N: device 0:0
I: 3 0001 0001</code></pre></figure>

<p>You can see it has two Application Collections, so that’s why we had
two entries for the keyboard.</p>

<p>In some cases, the HID Device Descriptor is wrong
and needs some patching, which can either be done in a
special driver, or on a live system dynamically by relying on
<a href="https://libevdev.pages.freedesktop.org/udev-hid-bpf/"><code>udev-hid-bpf</code></a>
which will be invoked before the kernel handles HID.</p>

<h2 id="evdev--event-device">evdev — Event Device</h2>

<p>Let’s tackle the last piece of the exposed middle-layer that we didn’t
explain yet: The Event Device common protocol, the evdev layer.</p>

<p>From what we’ve seen, we know that evdev is a standardization interface,
it decouples and abstracts the underlying devices. It could be a USB
keyboard, a Bluetooth pointer, or PS/2 device, and all the user needs
is to read from the evdev interface, without worrying about their
differences.</p>

<p>It works because evdev registers itself as the default input handler in
the input core, and the main job of most input driver is to translate
to it:</p>

<figure><pre><code data-lang="c"><span>static</span> <span>struct</span> <span>input_handler</span> <span>evdev_handler</span> <span>=</span> <span>{</span>
	<span>.</span><span>events</span>		<span>=</span> <span>evdev_events</span><span>,</span>
	<span>.</span><span>connect</span>	<span>=</span> <span>evdev_connect</span><span>,</span>
	<span>.</span><span>disconnect</span>	<span>=</span> <span>evdev_disconnect</span><span>,</span>
	<span>.</span><span>legacy_minors</span>	<span>=</span> <span>true</span><span>,</span>
	<span>.</span><span>minor</span>		<span>=</span> <span>EVDEV_MINOR_BASE</span><span>,</span>
	<span>.</span><span>name</span>		<span>=</span> <span>"evdev"</span><span>,</span>
	<span>.</span><span>id_table</span>	<span>=</span> <span>evdev_ids</span><span>,</span>
<span>};</span></code></pre></figure>

<p>When its “connect” event is fired, it creates the corresponding evdev
node in <code>/dev/input/eventN</code>. Furthermore, the info is also reflected
in sysfs within the <code>/sys/class/input/eventN</code> directory along with its
related <code>/sys/class/input/inputN</code> device created by the input core, which
it is the children of (<code>eventN</code> within <code>inputN</code>).</p>

<p>The evdev driver also supports certain ioctl to query
its internal state, let a client handle exclusively grab a
device (<code>EVIOCGRAB</code>), or change certain values. The list of ioctl can be found
<a href="https://www.freedesktop.org/software/libevdev/doc/latest/ioctls.html">here</a>
within libevdev, though libevdev doesn’t support all of them (the list
can also be found in <code>include/linux/input.h</code>).</p>

<p>Let’s see what the evdev format is about, and how the input core
translates to it and generates the events.</p>

<p>The evdev protocol is stateful, it doesn’t forward everything to
user-space but only does when it notices a change. To inquire about
its current state one can rely on ioctl instead.</p>

<p>The format of evdev is composed of a series of <code>input_event</code> (from
<code>include/linux/input.h</code>) which look like the structure here under,
grouped in what’s called a sequence or a frame:</p>

<figure><pre><code data-lang="c"><span>struct</span> <span>input_event</span> <span>{</span>
 <span>struct</span> <span>timeval</span> <span>time</span><span>;</span>
 <span>__u16</span> <span>type</span><span>;</span>
 <span>__u16</span> <span>code</span><span>;</span>
 <span>__s32</span> <span>value</span><span>;</span>
<span>};</span></code></pre></figure>

<p>Basically a timestamp along with a type-code couple and an associated
value. The type is the general category to which this event is part of,
and the code the sub-category. For example it could be a relative movement
(type), on the x-axis (code), of 1 unit (value). The available types of
events and codes can be found under <code>include/linux/input-event-codes.h</code>.</p>

<p>The most common types are:</p>

<ul>
  <li><code>EV_KEY</code>: buttons and keyboards</li>
  <li><code>EV_REL</code>: relative events, on axis or others</li>
  <li><code>EV_ABS</code>: absolute axis value, coordinates, touchscreens</li>
</ul>

<p>Each frame ends whenever a synchronization event comes up, the most
common is of type.code(value) <code>EV_SYN.SYN_REPORT(0)</code>. It’s the marker
that it’s time to make sense of the stream, the whole frame.</p>

<p>An example snapshot of a frame of an “absolute touchpad” would look
like this:</p>

<div><pre><code>E: 30.920519 0003 0018 0031     # EV_ABS / ABS_PRESSURE         31
E: 30.920519 0000 0000 0000     # ------------ SYN_REPORT (0) ---------- +13ms
E: 30.933332 0003 0035 2103     # EV_ABS / ABS_MT_POSITION_X    2103
E: 30.933332 0003 0036 1876     # EV_ABS / ABS_MT_POSITION_Y    1876
E: 30.933332 0003 003a 0029     # EV_ABS / ABS_MT_PRESSURE      29
E: 30.933332 0003 0000 2103     # EV_ABS / ABS_X                2103
E: 30.933332 0003 0001 1876     # EV_ABS / ABS_Y                1876
E: 30.933332 0003 0018 0029     # EV_ABS / ABS_PRESSURE         29
E: 30.933332 0000 0000 0000     # ------------ SYN_REPORT (0) ---------- +13ms
E: 30.946156 0003 003a 0017     # EV_ABS / ABS_MT_PRESSURE      17
E: 30.946156 0003 0018 0017     # EV_ABS / ABS_PRESSURE         17
E: 30.946156 0000 0000 0000     # ------------ SYN_REPORT (0) ---------- +13ms
E: 30.959094 0003 0039 -001     # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 30.959094 0001 014a 0000     # EV_KEY / BTN_TOUCH            0
E: 30.959094 0001 0145 0000     # EV_KEY / BTN_TOOL_FINGER      0
E: 30.959094 0003 0018 0000     # EV_ABS / ABS_PRESSURE         0
E: 30.959094 0000 0000 0000     # ------------ SYN_REPORT (0) ---------- +13ms
</code></pre></div>

<p>And of a keyboard:</p>

<div><pre><code>E: 0.000000 0004 0004 458792    # EV_MSC / MSC_SCAN             458792
E: 0.000000 0001 001c 0000      # EV_KEY / KEY_ENTER            0
E: 0.000000 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
E: 0.560004 0004 0004 458976    # EV_MSC / MSC_SCAN             458976
E: 0.560004 0001 001d 0001      # EV_KEY / KEY_LEFTCTRL         1
E: 0.560004 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
[....]
E: 1.172732 0001 001d 0002      # EV_KEY / KEY_LEFTCTRL         2
E: 1.172732 0000 0000 0001      # ------------ SYN_REPORT (1) ----------
E: 1.200004 0004 0004 458758    # EV_MSC / MSC_SCAN             458758
E: 1.200004 0001 002e 0001      # EV_KEY / KEY_C                1
E: 1.200004 0000 0000 0000      # ------------ SYN_REPORT (0) ----------
</code></pre></div>

<p>As we’ve said, it’s stateful, so the events are only sent when there is a
state change, even when the hardware keeps resending the same event. So
for example, if a key is kept pressed, it won’t resend the event until
it’s released.</p>

<p>These events might seem simple on their own but are in fact absolutely
complex to handle, especially touchpads. There are many features such as
pressure, multi-touch, and the tracking of different fingers, which needs an
upper layer to make sense of all this. This is where libinput shines, and
we’ll see that later on. For now just keep in mind it’s a series of event.</p>

<p>So how do drivers use evdev to send events, we’ve talked about
<code>input_event</code> before, but how does it work.</p>

<p>Well, first of before sending any event, the input driver needs at the
registration phase to advertise to the system what it’s capable of,
to say what kind of events it can generate. These event “capabilities”,
as they’re called, are a couple of different bits in sets that are also
inspectable in sysfs <code>/sys/class/input/inputN/capabilities/</code>.</p>

<p>You’ll find the following types of capabilities:</p>

<ul>
  <li><code>ev</code>, set in <code>input_dev-&gt;evbit</code>, Which event types the device can generate (<code>EV_KEY</code>, <code>EV_REL</code>, etc.)</li>
  <li><code>key</code>, set in <code>input_dev-&gt;keybit</code>, Which key/button codes it supports</li>
  <li><code>rel</code>, set in <code>input_dev-&gt;relbit</code>, Which relative axes (e.g., REL_X, REL_WHEEL)</li>
  <li><code>abs</code>, set in <code>input_dev-&gt;absbit</code>, Which absolute axes (e.g., ABS_X, ABS_Y)</li>
  <li><code>led</code>, set in <code>input_dev-&gt;ledbit</code>, LED indicators (e.g., keyboard LEDs)</li>
  <li><code>sw</code> , set in <code>input_dev-&gt;swbit</code>,  Switch states (e.g., lid switch)</li>
  <li><code>ff</code> , set in <code>input_dev-&gt;ffbit</code>,  Force feedback capabilities</li>
  <li><code>msc</code>, set in <code>input_dev-&gt;mscbit</code>, Miscellaneous events</li>
  <li><code>snd</code>, set in <code>input_dev-&gt;sndbit</code>, Sound events</li>
</ul>

<p>As you can see, it’s somewhat related the HID capabilities in a sense,
but applies to all devices.</p>

<p>We’ve also seen these capabilities bits during our inspection of the
input core procfs interface <code>/proc/bus/input/</code> in the <code>B</code> field:</p>

<figure><pre><code data-lang="shell">I: <span>Bus</span><span>=</span>0003 <span>Vendor</span><span>=</span>1a2c <span>Product</span><span>=</span>6004 <span>Version</span><span>=</span>0110
N: <span>Name</span><span>=</span><span>"SEMICO USB Keyboard Consumer Control"</span>
P: <span>Phys</span><span>=</span>usb-0000:00:12.0-1/input1
S: <span>Sysfs</span><span>=</span>/devices/pci0000:00/0000:00:12.0/usb2/<span>\</span>
   2-1/2-1:1.1/0003:1A2C:6004.001E/input/input53
U: <span>Uniq</span><span>=</span>
H: <span>Handlers</span><span>=</span>kbd event7 
B: <span>PROP</span><span>=</span>0
B: <span>EV</span><span>=</span>1f
B: <span>KEY</span><span>=</span>33eff 0 0 483ffff17aff32d bfd4444600000000 <span>\</span>
   1 130c730b17c000 267bfad9415fed 9e168000004400 10000002
B: <span>REL</span><span>=</span>1040
B: <span>ABS</span><span>=</span>100000000
B: <span>MSC</span><span>=</span>10

I: <span>Bus</span><span>=</span>0003 <span>Vendor</span><span>=</span>1a2c <span>Product</span><span>=</span>6004 <span>Version</span><span>=</span>0110
N: <span>Name</span><span>=</span><span>"SEMICO USB Keyboard System Control"</span>
P: <span>Phys</span><span>=</span>usb-0000:00:12.0-1/input1
S: <span>Sysfs</span><span>=</span>/devices/pci0000:00/0000:00:12.0/usb2/<span>\</span>
   2-1/2-1:1.1/0003:1A2C:6004.001E/input/input54
U: <span>Uniq</span><span>=</span>
H: <span>Handlers</span><span>=</span>kbd event9 
B: <span>PROP</span><span>=</span>0
B: <span>EV</span><span>=</span>13
B: <span>KEY</span><span>=</span>c000 10000000000000 0
B: <span>MSC</span><span>=</span>10</code></pre></figure>

<p>However, parsing the bits manually in procfs or sysfs would be cumbersome,
it’s better to rely on tools such as <code>libinput record</code>, check the
<strong>“Supported Events”</strong> section:</p>

<figure><pre><code data-lang="shell">devices:
- node: /dev/input/event5
  evdev:
    <span># Name: SEMICO USB Keyboard</span>
    <span># ID: bus 0x0003 (usb) vendor 0x1a2c \</span>
    <span>#         product 0x6004 version 0x0110</span>
    <span># Supported Events:</span>
    <span># Event type 0 (EV_SYN)</span>
    <span># Event type 1 (EV_KEY)</span>
    <span>#   Event code 1 (KEY_ESC)</span>
    <span>#   Event code 2 (KEY_1)</span>
    <span>#   Event code 3 (KEY_2)</span>
    <span>#   Event code 4 (KEY_3)</span>
    …
    <span>#   Event code 12 (KEY_MINUS)</span>
    <span>#   Event code 13 (KEY_EQUAL)</span>
    <span>#   Event code 14 (KEY_BACKSPACE)</span>
    <span>#   Event code 15 (KEY_TAB)</span>
    <span>#   Event code 16 (KEY_Q)</span>
    …
    <span># Event type 4 (EV_MSC)</span>
    <span>#   Event code 4 (MSC_SCAN)</span>
    <span># Event type 17 (EV_LED)</span>
    <span>#   Event code 0 (LED_NUML)</span>
    <span>#       State 0</span>
    <span>#   Event code 1 (LED_CAPSL)</span>
    <span>#       State 0</span>
    <span>#   Event code 2 (LED_SCROLLL)</span>
    <span>#       State 0</span>
    <span># Event type 20 (EV_REP)</span>
    <span>#   Event code 0 (REP_DELAY)</span>
    <span>#   Event code 1 (REP_PERIOD)</span>
    <span># Properties:</span>
    name: <span>"SEMICO USB Keyboard"</span>
    <span>id</span>: <span>[</span>3, 6700, 24580, 272]
    codes:
      0: <span>[</span>0, 1, 2, 3, 4,…, 13, 14, 15] <span># EV_SYN</span>
      1: <span>[</span>1, 2, 3, 4, 5, 6, 7, 8, 9 …]
      4: <span>[</span>4] <span># EV_MSC</span>
      17: <span>[</span>0, 1, 2] <span># EV_LED</span>
      20: <span>[</span>0, 1] <span># EV_REP</span>
    properties: <span>[]</span>
  hid: <span>[</span>
    0x05, 0x01, 0x09, 0x06, 0xa1, 0x01, 0x05, 0x08, 0x19, 0x01, 0x29,
    0x03, 0x15, 0x00, 0x25, 0x01, 0x75, 0x01, 0x95, 0x03, 0x91, 0x02,
    0x95, 0x05, 0x91, 0x01, 0x05, 0x07, 0x19, 0xe0, 0x29, 0xe7, 0x95,
    0x08, 0x81, 0x02, 0x75, 0x08, 0x95, 0x01, 0x81, 0x01, 0x19, 0x00,
    0x29, 0x91, 0x26, 0xff, 0x00, 0x95, 0x06, 0x81, 0x00, 0xc0
  <span>]</span>
  udev:
    properties:
    - <span>ID_INPUT</span><span>=</span>1
    - <span>ID_INPUT_KEY</span><span>=</span>1
    - <span>ID_INPUT_KEYBOARD</span><span>=</span>1
    - <span>LIBINPUT_DEVICE_GROUP</span><span>=</span>3/1a2c/6004:usb-0000:00:12.0-1
    - <span>DRIVER</span><span>=</span>hid-generic
    virtual: <span>false</span></code></pre></figure>

<p>As you can see it also dumps more information such as the HID Report
Descriptor and the attached udev properties.</p>

<p>Here’s what you can see from the much longer list that a touchpad
generates:</p>

<div><pre><code># Input device name: "SynPS/2 Synaptics TouchPad"
# Input device ID: bus 0x11 vendor 0x02 \
#            product 0x07 version 0x1b1
# Supported events:
#   Event type 0 (EV_SYN)
#     Event code 0 (SYN_REPORT)
#     Event code 1 (SYN_CONFIG)
#     Event code 2 (SYN_MT_REPORT)
#     Event code 3 (SYN_DROPPED)
#     Event code 4 ((null))
#     Event code 5 ((null))
#     Event code 6 ((null))
#     Event code 7 ((null))
#     Event code 8 ((null))
#     Event code 9 ((null))
#     Event code 10 ((null))
#     Event code 11 ((null))
#     Event code 12 ((null))
#     Event code 13 ((null))
#     Event code 14 ((null))
#   Event type 1 (EV_KEY)
#     Event code 272 (BTN_LEFT)
#     Event code 325 (BTN_TOOL_FINGER)
#     Event code 328 (BTN_TOOL_QUINTTAP)
#     Event code 330 (BTN_TOUCH)
#     Event code 333 (BTN_TOOL_DOUBLETAP)
#     Event code 334 (BTN_TOOL_TRIPLETAP)
#     Event code 335 (BTN_TOOL_QUADTAP)
#   Event type 3 (EV_ABS)
#     Event code 0 (ABS_X)
#       Value   2919
#       Min     1024
#       Max     5112
#       Fuzz       0
#       Flat       0
#       Resolution 42
#     Event code 1 (ABS_Y)
#       Value   3711
#       Min     2024
#       Max     4832
#       Fuzz       0
#       Flat       0
#       Resolution 42
#     Event code 24 (ABS_PRESSURE)
#       Value      0
#       Min        0
#       Max      255
#       Fuzz       0
#       Flat       0
#       Resolution 0
#     Event code 28 (ABS_TOOL_WIDTH)
#       Value      0
#       Min        0
#       Max       15
#       Fuzz       0
#       Flat       0
#       Resolution 0
# Properties:
#   Property  type 0 (INPUT_PROP_POINTER)
#   Property  type 2 (INPUT_PROP_BUTTONPAD)
#   Property  type 4 (INPUT_PROP_TOPBUTTONPAD)
</code></pre></div>

<p>As a note, the Properties can let us know whether we’re dealing with
a touchscreen <code>INPUT_PROP_DIRECT</code>, or a touchpad <code>INPUT_PROP_POINTER</code>,
and <code>INPUT_PROP_BUTTONPAD</code> also tells us that it’s a so-called clickpad
(no separate physical buttons but the whole touchpad clicks). These are
hints for libinput to properly handle different kinds of devices.</p>

<p>So after registering its capabilities, the input driver simply reports
its events by relying on the <code>input_event</code> function, or one of it’s
many wrappers:</p>

<figure><pre><code data-lang="c"><span>void</span> <span>input_event</span><span>(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span> <span>unsigned</span> <span>int</span> <span>type</span><span>,</span> <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>);</span>

<span>static</span> <span>inline</span> <span>void</span> <span>input_report_key</span><span>(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span> <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>)</span>
<span>{</span>
	<span>input_event</span><span>(</span><span>dev</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>code</span><span>,</span> <span>!!</span><span>value</span><span>);</span>
<span>}</span>

<span>static</span> <span>inline</span> <span>void</span> <span>input_report_rel</span><span>(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span> <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>)</span>
<span>{</span>
	<span>input_event</span><span>(</span><span>dev</span><span>,</span> <span>EV_REL</span><span>,</span> <span>code</span><span>,</span> <span>value</span><span>);</span>
<span>}</span>

<span>static</span> <span>inline</span> <span>void</span> <span>input_report_abs</span><span>(</span><span>struct</span> <span>input_dev</span> <span>*</span><span>dev</span><span>,</span> <span>unsigned</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>value</span><span>)</span>
<span>{</span>
	<span>input_event</span><span>(</span><span>dev</span><span>,</span> <span>EV_ABS</span><span>,</span> <span>code</span><span>,</span> <span>value</span><span>);</span>
<span>}</span></code></pre></figure>

<p>That’s it mostly to understand evdev! There are multiple tools to help
debug evdev-related issues. We’ve seen <code>libinput record</code>. Similarly,
there’s the <code>evemu</code> suite with its record, device, play functions to
simulate and test devices, and <code>evtest</code>.<br>
There’s also <a href="https://github.com/KarsMulder/evsieve">evsieve</a>, a tool to
intercept and modify evdev events on the fly.<br>
Along with these, the library libevdev, in C and python, is the most
used to integrate with evdev-related things.</p>

<h2 id="udev--hwdb">udev &amp; hwdb</h2>

<p>After going through the kernel and exposed layers, we’re finally in
user-space!<br>
The first component we’ll see is udev, since we mentioned its role
countless times in the previous sections.</p>

<p>Udev, or the dynamic user-space device manager, implemented as the
udev daemon <code>systemd-udevd</code>, has as role to take actions whenever a
uevent (<code>PF_NETLINK, NETLINK_KOBJECT_UEVENT</code>) is sent from the kernel
to user-space. We’ve seen a few of the possible actions it performs,
here’s a summary of the kind of things it does:</p>

<ul>
  <li>Load kernel modules based on the uevent MODALIAS</li>
  <li>Set access rights on device nodes</li>
  <li>Attach properties to devices on detection</li>
  <li>Create symlinks so that devices have more predictable names</li>
  <li>Keep track internally of device info in its internal db</li>
  <li>Use its rule system to take any kind of action on plug/unplug of a device</li>
</ul>

<p>The most important part is the last point: udev has a set of rules against
which it can match devices and their attributes and take all sorts of
actions based on that. The fields it has access to not only come from the
uevents but also from all related info on the system.</p>

<p>These rules, as is the convention for pretty much all big daemons these
days, are read from system locations such as <code>/usr/lib/udev/rules.d</code>,
<code>/usr/local/lib/udev/rules.d</code>, and the volatile runtime in
<code>/run/udev/rules.d</code>, and from the local admin directory of
<code>/etc/udev/rules.d</code> which takes precedence over the other locations. The
directories contains files with a <code>.rules</code> extension and are processed and
ordered lexically (<code>01-example.rules</code> comes before <code>05-example.rules</code>).</p>

<p>Now the syntax of udev rules, which are mainly composed of matching
patterns and actions to perform or properties to set upon match, is
dense and complex (it even has branching). Only a deep study of <code>udev(7)</code>
man page will help. Yet, we can still learn the very basics of it to be
able to understand what’s happening.<br>
Our approach will consist of, first checking two examples, then have a
general overview of the possible components of the syntax, and finally
talking about the particularities of that system.</p>

<p>The first example is quite simple, it will run a script when a specific
keyboard is plugged/unplugged.</p>

<figure><pre><code data-lang="shell"><span>ACTION</span><span>==</span><span>"add"</span>, <span>SUBSYSTEM</span><span>==</span><span>"input"</span>,
  ATTRS<span>{</span><span>id</span>/product<span>}==</span><span>"6004"</span>,
  ATTRS<span>{</span><span>id</span>/vendor<span>}==</span><span>"1a2c"</span>,
  RUN+<span>=</span><span>"/bin/kbd_is_plugged"</span>

<span>ACTION</span><span>==</span><span>"remove"</span>, <span>SUBSYSTEM</span><span>==</span><span>"input"</span>,
  ATTRS<span>{</span><span>id</span>/product<span>}==</span><span>"6004"</span>,
  ATTRS<span>{</span><span>id</span>/vendor<span>}==</span><span>"1a2c"</span>,
  RUN+<span>=</span><span>"/bin/kbd_is_unplugged"</span></code></pre></figure>

<p>The rule is pretty clear about what it does, on “add” or “remove” action
for specific match it’ll execute a script. But you’ll also notice that the
match components such as SUBSYSTEM and ATTRS are things we’ve seen before
in previous traces of <code>udevadm info</code>, which is exactly the point. <code>udevadm
info</code> will show us certain components we can used to match.</p>

<p>The second example is a tad bit more complex, we will parse
<code>/usr/lib/udev/rules.d/60-persistent-input.rules</code>. That file creates
a more persistent naming scheme for input devices in devtmpfs under
<code>/dev/input/by-id</code> and <code>/dev/input/by-path/</code>. Here’s a simplified version
of it.</p>

<figure><pre><code data-lang="shell"><span>ACTION</span><span>==</span><span>"remove"</span>, <span>GOTO</span><span>=</span><span>"persistent_input_end"</span>
SUBSYSTEM!<span>=</span><span>"input"</span>, <span>GOTO</span><span>=</span><span>"persistent_input_end"</span>
<span># …</span>

<span># determine class name for persistent symlinks</span>
ENV<span>{</span>ID_INPUT_KEYBOARD<span>}==</span><span>"?*"</span>, ENV<span>{</span>.INPUT_CLASS<span>}=</span><span>"kbd"</span>
ENV<span>{</span>ID_INPUT_MOUSE<span>}==</span><span>"?*"</span>, ENV<span>{</span>.INPUT_CLASS<span>}=</span><span>"mouse"</span>
<span># …</span>

<span># by-id links</span>
<span>KERNEL</span><span>==</span><span>"event*"</span>, ENV<span>{</span>ID_BUS<span>}==</span><span>"?*"</span>, ENV<span>{</span>.INPUT_CLASS<span>}==</span><span>"?*"</span>,
  ATTRS<span>{</span>bInterfaceNumber<span>}==</span><span>"|00"</span>,
  SYMLINK+<span>=</span><span>"input/by-id/</span><span>$env</span><span>{ID_BUS}-</span><span>$env</span><span>{ID_SERIAL}-event-</span><span>$env</span><span>{.INPUT_CLASS}"</span>

<span># by-path</span>
ENV<span>{</span>.INPUT_CLASS<span>}==</span><span>"?*"</span>, <span>KERNEL</span><span>==</span><span>"event*"</span>,
  ENV<span>{</span>ID_PATH<span>}==</span><span>"?*"</span>, 
  SYMLINK+<span>=</span><span>"input/by-path/</span><span>$env</span><span>{ID_PATH}-event-</span><span>$env</span><span>{.INPUT_CLASS}"</span>

<span># …</span>

<span>LABEL</span><span>=</span><span>"persistent_input_end"</span></code></pre></figure>

<p>We can see multiple things from this short example. First of all,
the branching mechanism with its use of <code>GOTO</code> whenever certain matches
don’t fit the specific use-case. We can also see the standard comparison
operators such as <code>==</code> and <code>!=</code>.<br>
Then we see different variables/values that are either compared against
such as <code>SUBSYSTEM</code>, <code>ACTION</code>, <code>KERNEL</code>, <code>ATTRS{…}</code>, <code>ENV{}</code>, or
assigned such as <code>ENV{…}</code>, <code>GOTO</code>, or <code>SYMLINK</code>. The assignment seems
to either use <code>=</code> or <code>+=</code>.<br>
Furthermore, from this example we can also see some regex-like pattern
matching, and string substitution within assignment.</p>

<p>Yet, overall the idea makes sense. We create some string variable based
on what type of input device we’re dealing with (prepended with <code>.</code>
means it’s only temporary), which we found in <code>ENV{…}</code>, the device
properties. Then for event devices we create two symlink files in
different directories “by-id” and “by-path”. For the by-id it’s composed
of the bus name, followed by the device name, “-event-“, and the input
class we’ve stored in the temporary variable.</p>

<p>Let’s see how that would look for this device:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> udevadm info <span>-p</span> <span>$(</span>udevadm info <span>-q</span> path <span>-n</span> /dev/input/event7<span>)</span>
…
M: event7
…
N: input/event7
…
E: <span>DEVNAME</span><span>=</span>/dev/input/event7
E: <span>MAJOR</span><span>=</span>13
E: <span>MINOR</span><span>=</span>71
E: <span>SUBSYSTEM</span><span>=</span>input
…
E: <span>ID_INPUT</span><span>=</span>1
E: <span>ID_INPUT_KEY</span><span>=</span>1
E: <span>ID_BUS</span><span>=</span>usb
E: <span>ID_MODEL</span><span>=</span>USB_Keyboard
E: <span>ID_MODEL_ENC</span><span>=</span>USB<span>\x</span>20Keyboard
E: <span>ID_MODEL_ID</span><span>=</span>6004
E: <span>ID_SERIAL</span><span>=</span>SEMICO_USB_Keyboard
E: <span>ID_VENDOR</span><span>=</span>SEMICO
E: <span>ID_VENDOR_ENC</span><span>=</span>SEMICO
E: <span>ID_VENDOR_ID</span><span>=</span>1a2c
E: <span>ID_REVISION</span><span>=</span>0110
E: <span>ID_TYPE</span><span>=</span>hid
…</code></pre></figure>

<p>The lines starting with <code>E:</code> are device properties that are in <code>ENV{…}</code>,
the meaning can be found in <code>udevadm(8)</code> manpage, which we’ll see more
of in other examples.<br>
So from this, the device should be symlinked as
<code>/dev/input/by-id/usb-SEMICO_USB_Keyboard-event-kbd</code>, which it indeed is.</p>

<p>That’s a neat example, it gives us a generic idea of udev. Let’s continue
and try to get a more general idea of the udev syntax.</p>

<p>So far we’ve seen that the rules files contain key-value pairs, or
comments starting with <code>#</code> as is standard in most conf files, and
has operators that are either for comparison, <code>==</code> and <code>!=</code>, or for
assignment, we’ve seen <code>=</code> and <code>+=</code>.</p>

<p>The difference between these two assignment operators is that some
variables/keys are lists, and the <code>+=</code> appends to that list, while the
<code>=</code> operator would basically empty the list and set only the single
value in it. Additionally, there are two other assignment operators
we haven’t seen: the <code>-=</code> to remove a value from a list, and the <code>:=</code>
which sets a constant and disallow future change.</p>

<p>How to know if something is a list or a scalar value, and if the key can
be used in comparison or assignment. Well, it depends on the key itself,
which are listed in the man page <code>udev(7)</code>, we’ll see the most common
but first let’s talk about the values.</p>

<p>The values assigned are always strings within double quotes, and use
the usual same escape mechanism that C and other languages use. It also
allows case-insensitive comparison by having the string preceded by “i”,
such as <code>i"casedoesn't matter"</code>.<br>
The strings also allow internal substitution with variables/keys, some
that can be set on the fly, from the match, or from a set of global
ones. It’s similar to a lot of languages: <code>"hello $kernel $env{ID_PATH}"</code>.
This is what we’ve seen in one of our examples.<br>
Furthermore, if a string is used during matching, it can include
glob patterns, also the usual ones, such as <code>*</code> to match zero or more
characters, <code>?</code> to match a single characters, <code>|</code> for the or separator,
and <code>[]</code> to match a set of characters. Obviously, these special characters
will need to be escaped if used as-is.</p>

<p>Now, as we said there are keys used to do matching/searching, and keys
that allow assigning values (list or not), yet what’s confusing is that
lots of keys can be used for both, but not all of them. A quick look at
<code>udev(7)</code> to be sure doesn’t hurt.</p>

<p>Here are some common matching keys:</p>

<ul>
  <li><code>KERNEL</code>: kernel name</li>
  <li><code>SUBSYSTEM</code>: the kernel subsystem the device is associated to</li>
  <li><code>DRIVER</code>: the driver currently handling the device</li>
  <li><code>ACTION</code>: Represents what’s happening on a device. Either <code>add/remove</code>
when the device is created or removed, <code>bind/unbind</code> for the driver,
<code>change</code> when something happens on a device such as a state change (ex:
eject, power plug, brightness), <code>offline/online</code> for memory and cpu,
<code>move</code> when a device is renamed.</li>
  <li><code>ATTR{attributename}</code>: match any sysfs attribute of the device</li>
  <li><code>TAG</code>: arbitrary tags, mostly used for user-space special behavior</li>
  <li><code>ENV{property_name}</code>: Context info, device properties, added by the
kernel or other udev rules associated to device. They are not
environment variables, but do get passed as <code>env</code> to <code>RUN+=</code> commands.</li>
  <li><code>PROGRAM</code> and <code>RESULT</code>: The first executes an external program and
if it’s successful then the match is ok, the second checks the string
result of the last program and uses it as a comparator.</li>
</ul>

<p>Still, there are variants of some of the above to allow a match with any
of the parents of the devices in the topological hierarchy, these include
<code>KERNELS</code>, <code>SUBSYSTEMS</code>, <code>DRIVERS</code>, and <code>ATTRS</code>.</p>

<p>Now, we’ve dealt with the keys used for comparison, let’s see the common
assignment keys:</p>

<ul>
  <li><code>SYMLINK</code>: A list of symlinks to be created</li>
  <li><code>ATTR{attributename}</code>: Value that should be set in sysfs</li>
  <li><code>TAG</code>: A list of special attributes for user-space to act
upon. For example, systemd acts on <code>TAG+="systemd"</code> and will read
<code>ENV{SYSTEMD_WANTS}</code> and interpret it as a unit dependency for the
device. It can be used to automatically start services.</li>
  <li><code>ENV{property_name}</code>: Context info, device properties, of the device. If
the property name is prepended with a dot <code>.</code>, then it will only
temporarily be set.</li>
  <li><code>OWNER</code>, <code>GROUP</code>, <code>MODE</code>: Set permissions on the device</li>
  <li><code>RUN{type}</code>: A list of external programs to run. The type is optional
and defaults to “program”, but it can be “builtin”, which are
plugins. Beware that <code>RUN</code> will timeout, and so it’s always better to
dispatch long running process to starter scripts instead that will exit
directly. <code>systemd-run --user</code> is often used here to execute things
in a normal graphical session such as notifications.</li>
  <li><code>IMPORT{type}</code>: Similar to <code>RUN</code> but used to import a set of variables (<code>ENV</code>)
depending on the type, can be “program”, “builtin”, “file”, “db”,
“parent”, “cmdline”.</li>
  <li><code>LABEL</code>, <code>GOTO</code>: A label and goto to jump to it, creating branching.</li>
</ul>

<p>The <code>RUN{builtin}</code> is a bit of an edge-case within udev since there are
many builtin modules and most of them are blackboxes that are hardly
documented. We know from <code>udevadm test-builtin --help</code> that these exist:</p>

<div><pre><code>blkid           Filesystem and partition probing
btrfs           btrfs volume management
dissect_image   Dissect Disk Images
factory_reset   Factory Reset Mode
hwdb            Hardware database
input_id        Input device properties
keyboard        Keyboard scancode mapping and touchpad/pointingstick characteristics
kmod            Kernel module loader
net_driver      Set driver for network device
net_id          Network device properties
net_setup_link  Configure network link
path_id         Compose persistent device path
uaccess         Manage device node user ACL
usb_id          USB device properties
</code></pre></div>

<p>Unfortunately, what they do isn’t clear unless you step in the code of
<a href="https://github.com/systemd/systemd/blob/main/src/udev/udev-builtin.c">udev-builtin</a>.
For example,
<a href="https://github.com/systemd/systemd/blob/main/src/udev/udev-builtin-input_id.c"><code>input_id</code></a>
will set a series of <code>ENV</code> info on the device depending on what it thinks
it is. Here’s some relevant code snippet:</p>

<figure><pre><code data-lang="c"><span>if</span> <span>(</span><span>is_pointing_stick</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_POINTINGSTICK"</span><span>,</span> <span>"1"</span><span>);</span>
<span>if</span> <span>(</span><span>is_mouse</span> <span>||</span> <span>is_abs_mouse</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_MOUSE"</span><span>,</span> <span>"1"</span><span>);</span>
<span>if</span> <span>(</span><span>is_touchpad</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_TOUCHPAD"</span><span>,</span> <span>"1"</span><span>);</span>
<span>if</span> <span>(</span><span>is_touchscreen</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_TOUCHSCREEN"</span><span>,</span> <span>"1"</span><span>);</span>
<span>if</span> <span>(</span><span>is_joystick</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_JOYSTICK"</span><span>,</span> <span>"1"</span><span>);</span>
<span>if</span> <span>(</span><span>is_tablet</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_TABLET"</span><span>,</span> <span>"1"</span><span>);</span>
<span>if</span> <span>(</span><span>is_tablet_pad</span><span>)</span>
        <span>udev_builtin_add_property</span><span>(</span><span>event</span><span>,</span> <span>"ID_INPUT_TABLET_PAD"</span><span>,</span> <span>"1"</span><span>);</span></code></pre></figure>

<p>And, that’s the tip of the iceberg to understand udev rules. Yet, the ones on
a real system are a monstrously big patchup. The only way to visualize
all of them on your system, in the way they’ll be processed, is with
<code>systemd-analyze cat-config udev/rules.d</code>.</p>

<p>Before getting on with actual examples and tools, let’s take some time
to talk about one of the most important builtin module to udev: <code>hwdb</code>,
the harware db, or <code>systemd-hwdb</code>. Which is an extra mechanism to write
rules for udev to add device properties (<code>ENV{}</code>).</p>

<p>The hardware db is a lookup table that lives in files with the <code>.hwdb</code>
extension under the udev directory in the <code>hwdb.d</code> directory. These
key-values at <code>systemd-hwdb</code> start are compiled in a <code>hwdb.bin</code> file for
quick retrieval. They consist of matches of modalias-like keys and then
a series of assignment for properties. Something like:</p>

<div><pre><code>bluetooth:v0000*
 ID_VENDOR_FROM_DATABASE=Ericsson Technology Licensing
</code></pre></div>

<p>The format is a simple series of match strings, one or multiple, and then
assignment values following it on lines that start with a space. Match
strings can use glob for the match, they’re not really following any
specific format other than <code>prefix:search criteria</code>. Yet, the question is:
how are these modalias-like strings used. And the answer is obviously:
it’s used by udev via its <code>IMPORT</code> of the builtin hwdb to set certain
device properties based on the lookup. For example:</p>

<figure><pre><code data-lang="shell"><span>DRIVERS</span><span>==</span><span>"atkbd"</span>, <span>\</span>
  IMPORT<span>{</span><span>builtin</span><span>}=</span><span>"hwdb 'evdev:atkbd:</span><span>$attr</span><span>{[dmi/id]modalias}'"</span>, <span>\</span>
  ENV<span>{</span>.HAVE_HWDB_PROPERTIES<span>}=</span><span>"1"</span></code></pre></figure>

<p>So udev passes a set of parameters to hwdb, along with the device, and it
will return <code>ENV</code> properties to set. hwdb also has an accompanying command
line tool that works in a similar way and allows querying it. However, it
has no man page, as far as I can see, but the following args are allowed:</p>

<figure><pre><code data-lang="shell"><span>--filter</span> or <span>-f</span>: 
<span>--device</span> or <span>-d</span>:
<span>--subsystem</span> or <span>-s</span>:
<span>--lookup-prefix</span> <span>-p</span>:</code></pre></figure>

<p>So for example when passing <code>--subsystem=usb</code> and a device, hwdb will get
the actual <code>MODALIAS</code> of the device, or construct one from the <code>idVendor</code>,
<code>idProduct</code>, and <code>product</code>, then try to match it in its lookup table.</p>

<p>Anyhow, we won’t spend time breaking down the source code. Let’s just
add that since the <code>hwdb</code> lookup table is compiled at the start, then
when entries are added or modified <code>systemd-hwdb</code> needs to be updated
or notified via:</p>

<figure><pre><code data-lang="shell">systemd-hwdb update <span># compile the hwdb</span></code></pre></figure>

<p>Similarly, the same is also true of udev. However, udev has more granular
reload mechanism, either to reload rules or to re-emit events so that
they can be processed by the new rules:</p>

<figure><pre><code data-lang="shell">udevadm trigger <span># re-emits all the uevents</span>
udevadm trigger /sys/class/input/eventXYZ <span># only re-emit this device events</span>
udevadm control <span>--reload</span> <span># reload all rules but will only apply to new events</span></code></pre></figure>

<p>Let’s see more examples of <code>udevadm</code>, which is the main way to interface
with udev.</p>

<p><code>udevadm info</code> is used to gather information about devices, we’ve seen
it earlier in previous sections. It’s handy to write udev rules. You can
pass it either a devtmpfs path, a sysfs path, a device ID, or a systemd
unit name of <code>.device</code> type (these are the <code>TAG+="systemd"</code> devices to
automatically load other units).</p>

<p>For example, we can walk and find the attribute hierarchy of a certain
device.</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> udevadm info <span>--attribute-walk</span> /dev/input/event5

  looking at device <span>'/devices/pci0000:00/0000:00:12.0/usb2\
      /2-4/2-4:1.0/0003:1A2C:6004.0069/input/input159/event5'</span>:
    <span>KERNEL</span><span>==</span><span>"event5"</span>
    <span>SUBSYSTEM</span><span>==</span><span>"input"</span>
    <span>DRIVER</span><span>==</span><span>""</span>
    ATTR<span>{</span>power/control<span>}==</span><span>"auto"</span>
    ATTR<span>{</span>power/runtime_active_time<span>}==</span><span>"0"</span>
    ATTR<span>{</span>power/runtime_status<span>}==</span><span>"unsupported"</span>
    ATTR<span>{</span>power/runtime_suspended_time<span>}==</span><span>"0"</span>


  looking at parent device <span>'/devices/pci0000:00/0000:00:12.0/usb\
      2/2-4/2-4:1.0/0003:1A2C:6004.0069/input/input159'</span>:
    <span>KERNELS</span><span>==</span><span>"input159"</span>
    <span>SUBSYSTEMS</span><span>==</span><span>"input"</span>
    <span>DRIVERS</span><span>==</span><span>""</span>
    ATTRS<span>{</span>capabilities/abs<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>capabilities/ev<span>}==</span><span>"120013"</span>
    ATTRS<span>{</span>capabilities/ff<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>capabilities/key<span>}==</span><span>"1000000000007 ff800000000007ff </span><span>\</span><span>
        febeffdff3cfffff fffffffffffffffe"</span>
    ATTRS<span>{</span>capabilities/led<span>}==</span><span>"7"</span>
    ATTRS<span>{</span>capabilities/msc<span>}==</span><span>"10"</span>
    ATTRS<span>{</span>capabilities/rel<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>capabilities/snd<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>capabilities/sw<span>}==</span><span>"0"</span>
    ATTRS<span>{</span><span>id</span>/bustype<span>}==</span><span>"0003"</span>
    ATTRS<span>{</span><span>id</span>/product<span>}==</span><span>"6004"</span>
    ATTRS<span>{</span><span>id</span>/vendor<span>}==</span><span>"1a2c"</span>
    ATTRS<span>{</span><span>id</span>/version<span>}==</span><span>"0110"</span>
    ATTRS<span>{</span>inhibited<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>name<span>}==</span><span>"SEMICO USB Keyboard"</span>
    ATTRS<span>{</span>phys<span>}==</span><span>"usb-0000:00:12.0-4/input0"</span>
    ATTRS<span>{</span>power/control<span>}==</span><span>"auto"</span>
    ATTRS<span>{</span>power/runtime_active_time<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>power/runtime_status<span>}==</span><span>"unsupported"</span>
    ATTRS<span>{</span>power/runtime_suspended_time<span>}==</span><span>"0"</span>
    ATTRS<span>{</span>properties<span>}==</span><span>"0"</span>
    ATTRS<span>{</span><span>uniq</span><span>}==</span><span>""</span>

  looking at parent device <span>'/devices/pci0000:00/0000:00:12.0/usb2\
      /2-4/2-4:1.0/0003:1A2C:6004.0069'</span>:
    <span>KERNELS</span><span>==</span><span>"0003:1A2C:6004.0069"</span>
    <span>SUBSYSTEMS</span><span>==</span><span>"hid"</span>
…</code></pre></figure>

<p>It’s something we’ve seen before.</p>

<p>Another option is to rely on <code>udevadm monitor</code>, which is a live trace
of all the uevent being sent.</p>

<p>Yet another option is <code>udevadm test</code> to print the rules that will get
triggered on a certain device uevent. This is useful to check whether
the rules make sense and will get executed.</p>

<p>A last tip to remember when writing udev rules is that <code>ATTR{}</code> is
anything in the files of sysfs. So we can simply match like this:</p>

<div><pre><code>&gt; cat /sys/class/input/event5/device/name
SEMICO USB Keyboard
</code></pre></div>

<p>And the rule would be <code>ATTR{name}=="SEMICO USB Keyboard"</code>.</p>

<p>Finally, let’s have a honorable mention to the mdev and eudev projects,
which are udev-like projects but more compatible with other init systems.</p>

<h2 id="libinput">libinput</h2>

<p>Libinput is a wrapper over udev and evdev. It provides a centralized way
to perform device detection, device event handling, input processing,
along with abstractions and common set of facilities to make the
practical, and user-expected, input handling easier. Today, libinput is
the major input library used by all graphical environments and toolkits,
it’s used by Xorg (through a driver) and Wayland compositors, so we’re
all probably using it indirectly.</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/libinput.png" alt="libinput Overview" title="libinput Overview"></p>

<p>Its basic mechanism works as you’d expect.<br>
As far as udev is concerned, it relies on <code>libudev/sd-device</code> to
enumerate devices and listen to kernel’s uevent. In particular, it
analyzes properties added by udev that helps categorize devices and
override settings (<code>ID_INPUT</code>, <code>ID_INPUT_*</code>, <code>LIBINPUT_*</code>), and filters
which devices it is allowed to handle by looking at which “seat” they’re
associated with. The whole udev part can be skipped by manually passing
events with <code>libinput_path_add_device</code>, but that’s a fallback scenario.<br>
And when it comes to evdev, it gets the handle to the corresponding
input stream devices then continuously read events and processes
them. This processing includes a lot of things such as scaling
touch coordinate, calculating pointer acceleration, debouncing
keys, etc.. Then finally, libinput returns these events in a unified
API as <code>LIBINPUT_EVENT_POINTER_BUTTON</code>, <code>LIBINPUT_EVENT_POINTER_MOTION</code>,
and <code>LIBINPUT_EVENT_POINTER_MOTION_ABSOLUTE</code>.</p>

<p>That also means it handles only the usual input devices such as mice,
keyboards, touchpads/clickpads, switches, trackpoints/pointing sticks,
touchscreens, and graphic tablets. It doesn’t handle joysticks, for
example, since these aren’t used for desktop environment but for games.</p>

<p>The main features handled by libinput are:</p>

<ul>
  <li>Button debouncing</li>
  <li>Clickpad software button behavior, Middle button emulation</li>
  <li>Touchpad pressure-based touch detection</li>
  <li>Palm and thumb detection</li>
  <li>Scrolling, Three-finger drag, and Tap-to-click behaviour</li>
  <li>Gestures</li>
</ul>

<p>We’ll see what these means, but first, why is libinput needed, can’t
udev and evdev be handled directly? Why have another layer of indirection?</p>

<p>The answer is twofold: to avoid having additional separate modules in the
upper stack such as in the X server, and because handling input devices
is messy and not as simple as taking evdev events as-is, they need a
bit more interpretation and cleanup.</p>

<p>Previously, before Wayland got traction, the X11 stack had specific
custom drivers, the xf86 input driver API, for each type of hardware and
use-case. Yet, these xf86 drivers could also have common functionalities
such as two-finger scrolling, which adds confusion. This was mostly a
hack for days before evdev existed, and there was a need for a library
independent of X11 that would centralize this responsibility, instead
of having it dispersed in different places. This makes it easier to
test each options, and have the features interact with one another,
cross-device communication.</p>

<p>Now why not handle it all directly, well because it’s messy. Multiple
devices have bad firmware and might send wrong capabilities and info
in their HID Report Descriptors, which will then be forwarded as-is
with evdev. Plus, having handling these in the driver would be even
more messy. For example, it could say that the size or resolution of
the touchpad is something while it’s something else. Or that the range
of valid inputs is 0 to 10 but that it’s 5-10. That’s why libinput
includes vendor-specific quirks handling in <code>/usr/share/libinput/</code>
along with the help of hwdb, which we’ve seen earlier, that has
<code>/usr/lib/udev/hwdb.d/60-evdev.hwdb</code>.</p>

<p>For example:</p>

<figure><pre><code data-lang="shell"><span>[</span>Aiptek 8000U pressure threshold]
<span>MatchUdevType</span><span>=</span>tablet
<span>MatchBus</span><span>=</span>usb
<span>MatchVendor</span><span>=</span>0x08CA
<span>MatchProduct</span><span>=</span>0x0010
<span>AttrPressureRange</span><span>=</span>70:50</code></pre></figure>

<p>This says that when a udev event is a usb tablet from a specific vendor,
that the pressure range should be change to <code>70:50</code>.</p>

<figure><pre><code data-lang="shell"><span>[</span>Bluetooth Keyboards]
<span>MatchUdevType</span><span>=</span>keyboard
<span>MatchBus</span><span>=</span>bluetooth
<span>AttrKeyboardIntegration</span><span>=</span>external</code></pre></figure>

<p>And this says that when a keyboard’s bus is over Bluetooth, it should
add the libinput attribute to say it’s an external keyboard.</p>

<p>The <code>60-evdev.hwdb</code> is mostly for touchpad’s axis, the device properties
set will look like this:</p>

<figure><pre><code data-lang="shell">EVDEV_ABS_&lt;axis&gt;<span>=</span>&lt;min&gt;:&lt;max&gt;:&lt;res&gt;:&lt;fuzz&gt;:&lt;flat&gt;
<span># where &lt;axis&gt; is the hexadecimal EV_ABS code as listed in linux/input.h and</span>
<span># min, max, res, fuzz, flat are the decimal values to the respective fields of</span>
<span># the struct input_absinfo as listed in linux/input.h. If a field is missing</span>
<span># the field will be left as-is. Not all fields need to be present. e.g. ::45</span>
<span># sets the resolution to 45 units/mm.</span>
<span># resolution: it is given in units per millimeter and thus tells us the</span>
<span># size of the device. in the above case: (5112 - 1024)/42 means the device</span>
<span># is 97mm wide. The resolution is quite commonly wrong, a lot of axis</span>
<span># overrides need the resolution changed to the correct value.</span></code></pre></figure>

<p>Furthermore, apart from quirks, there are hardware physical issues,
such as the fact that some touchpads send out events before the finger
even touches them, or how to handle the difference in pressure on them,
or what to do to track different fingers on multitouch (MT) hardware
which requires handling evdev tracking ID and slots.</p>

<p>Here’s a two-fingers scroll example, see how complex that is:</p>

<div><pre><code>E: 0.000001 0003 0039 0557 # EV_ABS / ABS_MT_TRACKING_ID   557
E: 0.000001 0003 0035 2589 # EV_ABS / ABS_MT_POSITION_X    2589
E: 0.000001 0003 0036 3363 # EV_ABS / ABS_MT_POSITION_Y    3363
E: 0.000001 0003 003a 0048 # EV_ABS / ABS_MT_PRESSURE      48
E: 0.000001 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.000001 0003 0039 0558 # EV_ABS / ABS_MT_TRACKING_ID   558
E: 0.000001 0003 0035 3512 # EV_ABS / ABS_MT_POSITION_X    3512
E: 0.000001 0003 0036 3028 # EV_ABS / ABS_MT_POSITION_Y    3028
E: 0.000001 0003 003a 0044 # EV_ABS / ABS_MT_PRESSURE      44
E: 0.000001 0001 014a 0001 # EV_KEY / BTN_TOUCH            1
E: 0.000001 0003 0000 2589 # EV_ABS / ABS_X                2589
E: 0.000001 0003 0001 3363 # EV_ABS / ABS_Y                3363
E: 0.000001 0003 0018 0048 # EV_ABS / ABS_PRESSURE         48
E: 0.000001 0001 014d 0001 # EV_KEY / BTN_TOOL_DOUBLETAP   1
E: 0.000001 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +0ms
E: 0.027960 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.027960 0003 0035 2590 # EV_ABS / ABS_MT_POSITION_X    2590
E: 0.027960 0003 0036 3395 # EV_ABS / ABS_MT_POSITION_Y    3395
E: 0.027960 0003 003a 0046 # EV_ABS / ABS_MT_PRESSURE      46
E: 0.027960 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.027960 0003 0035 3511 # EV_ABS / ABS_MT_POSITION_X    3511
E: 0.027960 0003 0036 3052 # EV_ABS / ABS_MT_POSITION_Y    3052
E: 0.027960 0003 0000 2590 # EV_ABS / ABS_X                2590
E: 0.027960 0003 0001 3395 # EV_ABS / ABS_Y                3395
E: 0.027960 0003 0018 0046 # EV_ABS / ABS_PRESSURE         46
E: 0.027960 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +27ms
E: 0.051720 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.051720 0003 0035 2609 # EV_ABS / ABS_MT_POSITION_X    2609
E: 0.051720 0003 0036 3447 # EV_ABS / ABS_MT_POSITION_Y    3447
E: 0.051720 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.051720 0003 0036 3080 # EV_ABS / ABS_MT_POSITION_Y    3080
E: 0.051720 0003 0000 2609 # EV_ABS / ABS_X                2609
E: 0.051720 0003 0001 3447 # EV_ABS / ABS_Y                3447
E: 0.051720 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +24ms
[...]
E: 0.272034 0003 002f 0000 # EV_ABS / ABS_MT_SLOT          0
E: 0.272034 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.272034 0003 002f 0001 # EV_ABS / ABS_MT_SLOT          1
E: 0.272034 0003 0039 -001 # EV_ABS / ABS_MT_TRACKING_ID   -1
E: 0.272034 0001 014a 0000 # EV_KEY / BTN_TOUCH            0
E: 0.272034 0003 0018 0000 # EV_ABS / ABS_PRESSURE         0
E: 0.272034 0001 014d 0000 # EV_KEY / BTN_TOOL_DOUBLETAP   0
E: 0.272034 0000 0000 0000 # ------------ SYN_REPORT (0) ---------- +30ms
</code></pre></div>

<p>Additionally, you also have misbehaving keyboards, with bad
firmware, buttons that are old, that get stuck, or send the same
events multiple time (so-called contact bouncing or chatter). We
need a mechanism to decide whether the event is valid or not, that’s
called hardware debouncing, and libinput does it out-of-the-box for us
(<a href="https://wayland.freedesktop.org/libinput/doc/latest/button-debouncing.html">see</a>),
which is truly impressive. This feature, with the help of the upper stack,
may also help people that have certain disabilities with involuntary
muscle movement.</p>

<p>So, for many reasons, libinput is indispensable!<br>
We’ve already covered some of its features, let’s see more.</p>

<p>One of the interesting part of libinput is that it’s minimal in how
it decides to access external things. As we said, you can either opt
for events coming from udev, or manually pass them by path, both will
create libinput internal objects (pointer, keyboard, etc..). Furthermore,
libinput has no configuration files, it’s up to the caller to decide
how to configure each device, as we’ll see Wayland compositors and X11
have different ways. Similarly, it leaves the opening of evdev character
devices up to the caller implementation, usually either manually opening
it, which requires root privileges, or via <code>systemd-logind</code> or <code>seatd</code>, dbus
services which will automatically pass back the file descriptors of evdev
devices associated with the current “seat”.</p>

<p>A seat is a collection of input devices associated with a user
session. That seems redundant, since most machines have only one seat,
yet it only truly makes sense in multi-seat machines: one machine,
multiple input devices, with multiple users. Still, it takes this
particular use-case in consideration.</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> libinput list-devices.
…
Device:           SEMICO USB Keyboard
Kernel:           /dev/input/event5
Id:               usb:1a2c:6004
Group:            6
Seat:             seat0, default
Capabilities:     keyboard 
…


<span>&gt;</span> loginctl seat status <span># will list all input in the hierarchy</span></code></pre></figure>

<p>As you would’ve guessed, the safest and most favored way to get access
to evdev event file descriptors is through the delegation that <code>systemd-logind</code>
provides. This is done in the code by implementing <code>open_restricted</code>
to call the dbus service.<br>
The seat is assigned with the <code>ENV{ID_SEAT}</code> udev property, which can be
controlled with the <code>loginctl</code> command. To permanently attach a device
to a seat.</p>

<div><pre><code>&gt; loginctl attach 'seat0' /sys/devices/…/input/input174
</code></pre></div>

<p>Then checking the device properties in udev:</p>

<figure><pre><code data-lang="shell">E: <span>ID_FOR_SEAT</span><span>=</span>input-pci-0000_00_12_0-usb-0_1_1_0
E: <span>ID_SEAT</span><span>=</span>seat0
E: <span>TAGS</span><span>=</span>:seat:seat0:
E: <span>CURRENT_TAGS</span><span>=</span>:seat:seat0:</code></pre></figure>

<p>There are alternatives to <code>logind</code> such as <code>elogind</code> and
<a href="https://sr.ht/~kennylevinsen/seatd/"><code>seatd</code></a> that don’t depend on
systemd.</p>

<p>Another detail is that we’ve seen that the same physical device can
appear as multiple input devices on the system. With the help of udev,
libinput gets the device property <code>LIBINPUT_DEVICE_GROUP</code> to group them,
like that we can have the whole group under a single seat, which is more
logical than giving access to only part of a physical hardware.</p>

<p>From <code>udevadm info</code>:</p>

<figure><pre><code data-lang="shell">E: <span>ID_PATH_TAG</span><span>=</span>pci-0000_00_12_0-usb-0_1_1_1
E: <span>ID_SEAT</span><span>=</span>seat0
E: <span>LIBINPUT_DEVICE_GROUP</span><span>=</span>3/1a2c/6004:usb-0000:00:12.0-1</code></pre></figure>

<p>And from <code>libinput list-devices</code>, look at the <code>Group</code> part:</p>

<div><pre><code>Device:           SEMICO USB Keyboard
Kernel:           /dev/input/event5
Id:               usb:1a2c:6004
Group:            6
Seat:             seat0, default
Capabilities:     keyboard 
…
Device:           SEMICO USB Keyboard Consumer Control
Kernel:           /dev/input/event6
Id:               usb:1a2c:6004
Group:            6
Seat:             seat0, default
Capabilities:     keyboard pointer 
…
Device:           SEMICO USB Keyboard System Control
Kernel:           /dev/input/event7
Id:               usb:1a2c:6004
Group:            6
Seat:             seat0, default
Capabilities:     keyboard 
</code></pre></div>

<p>You can get more info on this by checking the related udev rule in
<code>80-libinput-device-groups.rules</code>, which calls the built-in program
<code>libinput-device-group</code> with the sysfs mount point. The <code>IMPORT{program}</code>
basically uses a program right within <code>/usr/lib/udev/</code> directory.</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> /usr/lib/udev/libinput-device-group /sys/class/input/input191
<span>LIBINPUT_DEVICE_GROUP</span><span>=</span>3/1a2c/6004:usb-0000:00:12.0-1</code></pre></figure>

<p>As far as the technical features are concerned, there are the ones which
we listed earlier, so let’s explain the rest of them.</p>

<p>It offers full clickpad management. A clickpad (<code>INPUT_PROP_BUTTONPAD</code>)
is basically a touchpad with a single button, which we might not notice at
first because depending on where we press in the “software button area”
at the bottom, we have different behavior. That’s exactly the behavior
that libinput facilitates. It also handles what happens when a finger
enters or exits that area, these sort of edge cases.</p>

<p>Furthermore, libinput handles tap to click, be it one-finger tap for
left click, two-fingers for right click, and three-fingers tap for
middle click. While that seems simple in theory, libinput has to draw
the line between what is considered a tap and what is considered a finger
drag/move; indeed, our fingers aren’t very stable in the real world.<br>
Unfortunately, by default libinput disables tapping when there are other
methods to trigger button clicks, but it can always be enabled again.</p>

<p>When talking about multiple fingers, the hardware needs to support
it obviously, but also libinput needs to track each one individually,
which is done via evdev tracking ID and slots, what we call multi-touch
handling or MT.<br>
Within multi-touch we have the concept of “gestures” and libinput supports
two standard ones: swiping, fingers going in the same direction, and
pinching when fingers move apart or towards each others.</p>

<p>Similarly, there’s also different scrolling use-cases that are supported
by libinput: two-fingers scrolling, similar to a swipe, edge scrolling,
when there’s a specific area on the trackpad used for scrolling, and
on-button scrolling, which scrolls while having a button pressed just by
moving the finger.<br>
The scrolling can either be horizontal or vertical. The user also has
a choice between natural scrolling an traditional scrolling; natural
scrolling matches the motion of the scroll like a phone, and traditional
scrolling matches the scroll bar directin so going downward will move
the page downward.<br>
One thing libinput doesn’t provide when it comes to scrolling is kinetic
scrolling. Basically, scrolling that is faster or slower depending on
the speed. However, it allows widget libraries to implement it by relying
on the <code>libinput_event_pointer_get_axis_source()</code> function.</p>

<p>With all these, libinput offers palm and thumb detection to disable
the clickpad/touchpad when typing, or ignore a thumb in the corner or
accidental touches while other fingers are moving. It achieves this by
detecting the different pressure, speed, or touch sizes reported by evdev,
along with where they are happening (exclusion zones).<br>
It’s also possible to automatically disable the touchpad when typing,
or when the lid is closed.</p>

<p>Lastly, libinput has lua plugins in <code>/usr/lib/libinput/plugins/</code> and
<code>/etc/libinput/plugins</code>. As with other quirk fixing mechanisms in
udev and the quirk directory, the plugins are there for the last few
unfixable issues. They can be used to override evdev events.</p>

<figure><pre><code data-lang="lua"><span>libinput</span><span>:</span><span>register</span><span>(</span><span>1</span><span>)</span> <span>-- register plugin version 1</span>
<span>libinput</span><span>:</span><span>connect</span><span>(</span><span>"new-evdev-device"</span><span>,</span> <span>function</span> <span>(</span><span>_</span><span>,</span> <span>device</span><span>)</span>
    <span>if</span> <span>device</span><span>:</span><span>vid</span><span>()</span> <span>==</span> <span>0x046D</span> <span>and</span> <span>device</span><span>:</span><span>pid</span><span>()</span> <span>==</span> <span>0xC548</span> <span>then</span>
        <span>device</span><span>:</span><span>connect</span><span>(</span><span>"evdev-frame"</span><span>,</span> <span>function</span> <span>(</span><span>_</span><span>,</span> <span>frame</span><span>)</span>
            <span>for</span> <span>_</span><span>,</span> <span>event</span> <span>in</span> <span>ipairs</span><span>(</span><span>frame</span><span>.</span><span>events</span><span>)</span> <span>do</span>
                <span>if</span> <span>event</span><span>.</span><span>type</span> <span>==</span> <span>evdev</span><span>.</span><span>EV_REL</span> <span>and</span> 
                   <span>(</span><span>event</span><span>.</span><span>code</span> <span>==</span> <span>evdev</span><span>.</span><span>REL_HWHEEL</span> <span>or</span> 
                    <span>event</span><span>.</span><span>code</span> <span>==</span> <span>evdev</span><span>.</span><span>REL_HWHEEL_HI_RES</span><span>)</span> <span>then</span>
                    <span>event</span><span>.</span><span>value</span> <span>=</span> <span>-</span><span>event</span><span>.</span><span>value</span>
                <span>end</span>
            <span>end</span>
            <span>return</span> <span>frame</span>
        <span>end</span><span>)</span>
    <span>end</span>
<span>end</span><span>)</span></code></pre></figure>

<p>For example, the above script will reverse the horizontal scroll wheel
(<code>EV_REL.REL_HWHEEL</code>) event value for a certain device vendor and
product ID.</p>

<p>We’ve covered most of the libinput features, now let’s see how to debug
and interface with it.</p>

<p>The main command line interface is <code>libinput</code>, as we’ve seen it can allow
to <code>list-devices</code>, which is a quick summary of the devices it knows about
and on which seat they are connected. Yet most other commands are there
for debugging and testing.</p>

<ul>
  <li><code>libinput debug-gui</code>: is a graphical tool mostly to debug touchpad</li>
  <li><code>libinput debug-events</code>: is a cli tool to debug all events as they are
interpreted by libinput, if you want it’s similar to <code>evtest</code> or <code>xev</code>
in Xorg</li>
  <li><code>libinput record</code> and <code>libinput replay</code>: Used to save and then simulate
again devices. This is amazing if you have a bug and want others to be
able to replicate it on their machines. This is similar to how
<code>hid-tools</code> work.</li>
  <li><code>libinput measure</code>: mostly used for touchpad, to measure things such
as pressure, touch size, tap to click time, etc..</li>
</ul>

<p>The other way to interface with libinput is programmatically. Here’s
the most simple complete example I could come up with:</p>

<figure><pre><code data-lang="c"><span>#include</span> <span>&lt;libinput.h&gt;</span><span>
#include</span> <span>&lt;libudev.h&gt;</span><span>
#include</span> <span>&lt;fcntl.h&gt;</span><span>
#include</span> <span>&lt;unistd.h&gt;</span><span>
#include</span> <span>&lt;stdio.h&gt;</span><span>
#include</span> <span>&lt;errno.h&gt;</span><span>
#include</span> <span>&lt;string.h&gt;</span><span>
</span>

<span>static</span> <span>int</span> <span>open_restricted</span><span>(</span><span>const</span> <span>char</span> <span>*</span><span>path</span><span>,</span> <span>int</span> <span>flags</span><span>,</span> <span>void</span> <span>*</span><span>user_data</span><span>)</span> <span>{</span>
	<span>int</span> <span>fd</span> <span>=</span> <span>open</span><span>(</span><span>path</span><span>,</span> <span>flags</span><span>);</span>
	<span>if</span> <span>(</span><span>fd</span> <span>&lt;</span> <span>0</span><span>)</span>
		<span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"Failed to open %s (%s)</span><span>\n</span><span>"</span><span>,</span> <span>path</span><span>,</span> <span>strerror</span><span>(</span><span>errno</span><span>));</span>
	<span>return</span> <span>fd</span><span>;</span>
<span>}</span>

<span>static</span> <span>void</span> <span>close_restricted</span><span>(</span><span>int</span> <span>fd</span><span>,</span> <span>void</span> <span>*</span><span>user_data</span><span>)</span> <span>{</span>
	<span>close</span><span>(</span><span>fd</span><span>);</span>
<span>}</span>

<span>static</span> <span>const</span> <span>struct</span> <span>libinput_interface</span> <span>interface</span> <span>=</span> <span>{</span>
	<span>.</span><span>open_restricted</span> <span>=</span> <span>open_restricted</span><span>,</span>
	<span>.</span><span>close_restricted</span> <span>=</span> <span>close_restricted</span><span>,</span>
<span>};</span>

<span>int</span> <span>main</span><span>(</span><span>void</span><span>)</span> <span>{</span>
    <span>struct</span> <span>udev</span> <span>*</span><span>udev</span> <span>=</span> <span>udev_new</span><span>();</span>
    <span>if</span> <span>(</span><span>!</span><span>udev</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"Failed to create udev</span><span>\n</span><span>"</span><span>);</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>

    <span>struct</span> <span>libinput</span> <span>*</span><span>li</span> <span>=</span> <span>libinput_udev_create_context</span><span>(</span><span>&amp;</span><span>interface</span><span>,</span> <span>NULL</span><span>,</span> <span>udev</span><span>);</span>
    <span>if</span> <span>(</span><span>!</span><span>li</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"Failed to create libinput context</span><span>\n</span><span>"</span><span>);</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>

    <span>if</span> <span>(</span><span>libinput_udev_assign_seat</span><span>(</span><span>li</span><span>,</span> <span>"seat0"</span><span>)</span> <span>!=</span> <span>0</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"Failed to assign seat</span><span>\n</span><span>"</span><span>);</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>

    <span>struct</span> <span>libinput_event</span> <span>*</span><span>event</span><span>;</span>
    <span>while</span> <span>(</span><span>1</span><span>)</span> <span>{</span>
        <span>libinput_dispatch</span><span>(</span><span>li</span><span>);</span>
        <span>event</span> <span>=</span> <span>libinput_get_event</span><span>(</span><span>li</span><span>);</span>
        <span>if</span> <span>(</span><span>!</span><span>event</span><span>)</span> <span>{</span>
            <span>usleep</span><span>(</span><span>10000</span><span>);</span>
            <span>continue</span><span>;</span>
        <span>}</span>

        <span>if</span> <span>(</span><span>libinput_event_get_type</span><span>(</span><span>event</span><span>)</span> <span>==</span> <span>LIBINPUT_EVENT_KEYBOARD_KEY</span><span>)</span> <span>{</span>
            <span>struct</span> <span>libinput_event_keyboard</span> <span>*</span><span>k</span> <span>=</span> <span>libinput_event_get_keyboard_event</span><span>(</span><span>event</span><span>);</span>
            <span>uint32_t</span> <span>key</span> <span>=</span> <span>libinput_event_keyboard_get_key</span><span>(</span><span>k</span><span>);</span>
            <span>enum</span> <span>libinput_key_state</span> <span>state</span> <span>=</span> <span>libinput_event_keyboard_get_key_state</span><span>(</span><span>k</span><span>);</span>

            <span>printf</span><span>(</span><span>"Key %u is %s</span><span>\n</span><span>"</span><span>,</span>
                   <span>key</span><span>,</span>
                   <span>state</span> <span>==</span> <span>LIBINPUT_KEY_STATE_PRESSED</span> <span>?</span> <span>"PRESSED"</span> <span>:</span> <span>"RELEASED"</span><span>);</span>
        <span>}</span>

        <span>libinput_event_destroy</span><span>(</span><span>event</span><span>);</span>
    <span>}</span>

    <span>libinput_unref</span><span>(</span><span>li</span><span>);</span>
    <span>udev_unref</span><span>(</span><span>udev</span><span>);</span>
    <span>return</span> <span>0</span><span>;</span>
<span>}</span></code></pre></figure>

<p>And to compile it:</p>

<figure><pre><code data-lang="shell">gcc <span>-o</span> key_state key_state.c <span>$(</span>pkg-config <span>--cflags</span> <span>--libs</span> libinput libudev<span>)</span></code></pre></figure>

<p>But what about configuring devices, setting up things that we want to
setup per device. Well, as we’ve said this is done in the upper stack
since libinput has no configuration files, and we’ll cover this later. For
now let’s just list a few of the things that can actually be configured.</p>

<ul>
  <li>tap-to-click related, such as how many fingers are supported</li>
  <li>three-finger drag</li>
  <li>pointer acceleration profiles</li>
  <li>scrolling method natural vs traditional</li>
  <li>left-hand mode</li>
  <li>middle button emulation</li>
  <li>click method</li>
  <li>disable while typing (DWT)</li>
  <li>disable while trackpointing (DWTP)</li>
  <li>direct-input device calibration</li>
  <li>rotation confs (if touchpad is sideways)</li>
  <li>area confs</li>
</ul>

<p>You can glimpse at these on X11 with the command <code>xinput --list-props &lt;device_id&gt;</code>
or at <code>libinput list-devices</code> which we’ve seen earlier that
should show the conf per-device:</p>

<div><pre><code>Device:                  SYNA801A:00 06CB:CEC6 Touchpad
…
Group:                   1
Seat:                    seat0, default
Size:                    122x69mm
Capabilities:            pointer gesture
Tap-to-click:            disabled
Tap-and-drag:            enabled
Tap button map:          left/right/middle
Tap drag lock:           disabled
Left-handed:             disabled
Nat.scrolling:           disabled
Middle emulation:        disabled
Calibration:             n/a
Scroll methods:          *two-finger edge
Scroll button:           n/a
Scroll button lock:      n/a
Click methods:           *button-areas clickfinger
Clickfinger button map:  left/right/middle
Disable-w-typing:        enabled
Disable-w-trackpointing: enabled
Accel profiles:          flat *adaptive custom
Rotation:                n/a
Area rectangle:          n/a

// or another touchpad
Device:                  ETPS/2 Elantech Touchpad
…
Seat:                    seat0, default
Size:                    102x74mm
Capabilities:            pointer gesture
Tap-to-click:            disabled
Tap-and-drag:            enabled
Tap button map:          left/right/middle
Tap drag lock:           disabled
Left-handed:             disabled
Nat.scrolling:           disabled
Middle emulation:        disabled
Calibration:             n/a
Scroll methods:          *two-finger edge 
Scroll button:           n/a
Scroll button lock:      n/a
Click methods:           *button-areas clickfinger 
Clickfinger button map:  left/right/middle
Disable-w-typing:        enabled
Disable-w-trackpointing: enabled
Accel profiles:          flat *adaptive custom
Rotation:                n/a
Area rectangle:          n/a
</code></pre></div>

<p>That’s about it when it comes to libinput. Now we can move to more
specific things in the upper stack.</p>

<h2 id="keyboard-specifics">Keyboard Specifics</h2>

<p>We’re pretty much done with the lower part of the user-space stack, but
before moving on to the graphical library widgets and desktop environments,
let’s take some time to see some of the specific device handling that
are good to know about, namely keyboards, mice, and gamepads.<br>
In this section we’ll see three important concepts related to keyboards:
scancodes to keycodes, console keyboard handling, and XKB.</p>

<h2 id="scancodes-to-keycodes">Scancodes to Keycodes</h2>

<p>Like other input drivers, the role of keyboard drivers is to translate
from raw hardware keys to events that can be normalized and interpreted by
user-space. We call the raw keys scancodes, and the events ones keycodes
(<code>/usr/include/linux/input-event-codes.h</code>). Keycodes are also mapped
to key symbols in user-space unrelated to their actual keycodes, which we
call keysyms.<br>
For example, a scancode can look like a random hex <code>0x1E</code>, a kernel-mapped
event as <code>KEY_A</code>, and a keysym will look like a symbol such as “a” or “A”.</p>

<p>We’ll talk more about keysyms mapping when we see XKB. But let’s focus
on the scancodes to keycode translation for now.</p>

<p>When a keyboard input device registers itself in the input core
(<code>input_register_device</code>) it has to report which keycodes it supports
in its capabilities (<code>keybit</code> capability). In general it has to set its
<code>keycode</code>, <code>keycodemax</code>, and <code>keycodesize</code> fields, which are a map of
the translation of scancodes to keycodes.<br>
These keymaps can either be full fledge dense keymap or sparse keymap,
which means they’re smaller and use less memory. The sparse keys are
mostly used when registering a few entries such as special keys that
don’t need huge arrays.</p>

<p>If a scancode isn’t found in these translation arrays, they’re often
either completely ignored, or the driver returns that it’s an unknown key.</p>

<p>Keyboard input devices can also optionally implement two important
functions: <code>getkeycode</code> and <code>setkeycode</code>, which will by default retrieve
the current keymap and alter the current keymap respectively. Most drivers
fallback to the default mechanism, so this can be taken for granted.</p>

<p>Importantly, the <code>evdev</code> and <code>kbd</code> (console) handlers offer ways to call
these via ioctl interfaces, which will be propagated to the devices
they’re currently handling. For <code>evdev</code> it’s through <code>EVIOCGKEYCODE</code> and
<code>EVIOCSKEYCODE</code>, to get and set keycodes respectively. For the console
handler it’s through <code>KDGETKEYCODE</code> and <code>KDSETKEYCODE</code>. The exception
is that the console driver will propagate it to all handlers, and thus
indirectly to all devices on the platform.</p>

<p>You can also do the runtime patching of scancode to keycode
mapping through udev and hwdb by setting a device property in
<code>ENV{KEYBOARD_KEY_&lt;hex scan code&gt;}=&lt;key code identifier&gt;</code> which will in
turn be caught by <code>systemd/src/udev/udev-builtin-keyboard.c</code> and also
call the same ioctl interfaces.</p>

<p>For example:</p>

<div><pre><code>ENV{KEYBOARD_KEY_b4}=dollar
</code></pre></div>

<p>To find out the actual scancodes the device is generating the <code>showkey(1)</code>
tool from the Linux Keyboard tools project, with the <code>--scancodes</code> flag,
will attach to the console handler and display them in raw mode. And the
<code>setkeycodes(8)</code> command from the same project will propagate it to the
driver via the console input handler.</p>

<p>There are multiple other tools used to do the keycode remapping such
as <code>evmapd</code>, <code>evremap</code>, <code>evdevremapkeys</code>, but these work at the evdev
layer and don’t know about scancodes. So for now, the simplest one to
do scancode to keycode mapping is obviously the built-in one: hwdb.</p>

<p>This mechanism for runtime modifications might save us time instead of
getting our hands dirty and having to modify kernel drivers.</p>

<h2 id="console-keyboard">Console Keyboard</h2>

<p>We’ve discussed the <code>evdev</code> handler extensively, however in the console
it’s the <code>kbd</code> input event handler (<code>drivers/tty/vt/keyboard.c</code>) that is
used, and it’s working in sync with the tty and line discipline mechanism.<br>
This particular handler exposes its devices as TTYs in the infamous
<code>/dev/ttyN</code> and <code>/dev/console</code> (system) and handles all the messiness
of console text-mode input.</p>

<p>The input handlers coexist. When switching from graphical environment
to console, the VT <code>kbd</code> handler takes over.</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/console.png" alt="Console Overview" title="Console Overview"></p>

<p>Obviously, as a console input handler, the <code>kbd</code> handler has much more
work to do, and it has a lot of special handling via ioctl too. From
bell and tone, leds, setting console key rate, modifiers, interpreting
special keys that have meanings for the TTY, switching to other modes
such as raw input mode or graphic (X11, Wayland session), all the push
towards line discipline, etc.. It’s handling things that are often
handled in user-space (key rate is handled in the graphical stack too
as we’ll see). The reason: historical entangling, the console existed
before the graphical stack.</p>

<p>For instance, <code>showkey(1)</code> which we’ve just seen, relies on changing the
mode of the terminal via ioctl <code>KDSKBMODE</code> to <code>K_RAW</code>.<br>
There are a bunch of commands to interface with the ioctl such as
<code>kbdrate(8)</code> to set the keyboard rate, <code>kbdinfo(1)</code> to get more info
about the kbd driver, and <code>kbd_mode(1)</code> to get the current keyboard mode
(raw, xlate, etc..)</p>

<div><pre><code>[Keyboard hardware]
   ↓
[input driver: atkbd, hid-input]
   ↓
[input core]
   ↓
[keyboard.c handler (kbd_event)]
   ↓
[TTY layer (virtual console, ttyN)]
   ↓
[N_TTY line discipline]
   ↓
[read() by shell, echo, canonical editing, etc.]
</code></pre></div>

<p>Furthermore, since it’s taking a bigger role on handling scancode to
keycode, it also somewhat does keycode interpretation via its internal
keymap. That means, the <code>kbd</code> handler can be responsible of handling the
difference in regional keyboard layouts and special keys. This is
something which usually happens in XKB, in user-space, which we’ll see
in the next section.</p>

<p>Thus it has two sets of ioctl: <code>KDSETKEYCODE</code> and <code>KDGETKEYCODE</code> for
low-level scancodes to keycodes, and <code>KDGKBENT</code> and <code>KDSKBENT</code> for the
keycode to symbol/action mapping (internally also confusingly called
<code>key_maps</code>, as you’ll see everyone uses the word “keymap”).</p>

<p>The format of the keymaps translating keycode to symbol (<code>keymaps(5)</code>)
is managed by the kernel for each console, but usually more
easily set with user-space tools also from the <a href="https://kbd-project.org/">Linux keyboard
tools</a> project. For example <code>loadkeys(1)</code> and
<code>dumpkeys(1)</code>. These can rely on files in <code>/usr/share/kbd/keymaps/</code>
for a predefined set of keymaps. Let’s also mention that the default
one is found in <code>/usr/src/linux/drivers/tty/vt/defkeymap.map</code>.</p>

<p>Before we end, let’s mention <code>systemd-localed.service(8)</code> and its
<code>localectl(1)</code> command. It is used to set the keyboard map for
both the console and the graphical environment (XKB in X11 as we’ll see)
based on the current locale. For example, it sets the keymap,
font, and others, of the console and X11 XKB to the value found in
<code>/etc/vconsole.conf</code> (see <code>vconsole.conf(5)</code>) through its service called
<code>systemd-vconsole-setup(8)</code>, which is also called when the console is
initialized with udev. It can also help in setting the same values in
both the console and graphical stack.</p>

<p>Here’s <code>vconsole.conf</code>:</p>

<figure><pre><code data-lang="shell"><span>KEYMAP</span><span>=</span>us
<span>XKBLAYOUT</span><span>=</span>us</code></pre></figure>

<div><pre><code>&gt; localectl
System Locale: LANG=en_US.UTF-8
    VC Keymap: us
   X11 Layout: us
</code></pre></div>

<p><em>NB: Terminal emulators don’t rely on the console input handler at all,
they use pseudo-terminals instead (PTYs). These don’t have VGA console,
nor plug to the kbd handler, nor screen, etc.. They are fed entirely by
user-space programs.</em><br>
Example:</p>

<div><pre><code>Line discipline &lt;-&gt; TTY driver (PTY slave side) &lt;-&gt; user process
 `-&gt; PTY master side &lt;-&gt; xterm process
</code></pre></div>

<p>See <a href="https://venam.net/blog/unix/2017/06/04/terminals.html#generic-arch">this old article</a>
for more details on that.</p>

<div><pre><code>&gt; cat /proc/consoles
tty0                 -WU (EC  p  )    4:2

&gt; cat /proc/tty/drivers

/proc/tty/drivers
/dev/tty             /dev/tty        5       0 system:/dev/tty
/dev/console         /dev/console    5       1 system:console
/dev/ptmx            /dev/ptmx       5       2 system
/dev/vc/0            /dev/vc/0       4       0 system:vtmaster
serial               /dev/ttyS       4 64-95 serial
pty_slave            /dev/pts      136 0-1048575 pty:slave
pty_master           /dev/ptm      128 0-1048575 pty:master
unknown              /dev/tty        4 1-63 console
</code></pre></div>

<p>Now let’s see how the keycode to keysym is done in user-space in the
graphical stack with XKB.</p>

<h2 id="xkb">XKB</h2>

<p>XKB, or X keyboard, is a common library (xkbcommon, xkbregistry,
xkbcompose) with a set of tools, an X11 protocol extension (X
Keyboard Extension), and a database collection of descriptions
(xkeyboard-config). Its role is to handle the keycode to keysym
translation in user-space.<br>
While the name includes “X”, the common library and database are not only
used by Xorg but by most software, including graphical widgets such as
GTK and Qt, and Wayland compositors. We won’t cover the older X protocol
extension here, yet the reason why there’s an “X” in the name is that
it started as an extension and then got separated into a common library.</p>

<p>The two things we’ll focus on are xkbcommon, the xkb core engine that
parse and executes XKB definitions, and the xkeyboard-config, which
is a project compiling a database of keyboard info, layouts, variants,
symbols, and rules. They work together.</p>

<p>As a word of notice, XKB is one of the most complex piece of software I’ve
encountered and its documentation is fiercely lacking and dispersed. It
has its own language, compiler, and the format is extremely convoluted
and inconsistent, often mixing camel case and snake case for no apparent
reasons.<br>
Even in the XKB documentation we find such comments:</p>

<blockquote>
  <p>Todo<br>
   Explain how to configure XKB, with examples</p>
</blockquote>

<blockquote>
  <p>Due to the complexity of the format, this document is still is
construction.</p>
</blockquote>

<p>And internally Xorg devs called it <em>“X Kitten Butcher”</em>.</p>

<p>We’ll try to make it approachable, and break the bad
spell. However, if you ever want more info check <a href="https://xkbcommon.org/doc/current/keymap-text-format-v1-v2.html">the official
format</a>.</p>

<p>In order to perform the translation from keycodes coming from event
handlers to actual symbols, XKB relies on something called an XKB keymap
(yes everything is called a keymap). This XKB keymap is a compilation
of different components coming from the xkeyboard-config database that
are chosen based on the abstract, and more coherent, concept of layout,
variants, models, and options the user pick: <strong>“RMLVO”</strong>.</p>

<p>After this is picked, the XKB client software just has to keep track of
what’s called a state, and then send it along with the received keycode
to receive back the keysym.<br>
A very basic example looks like this:</p>

<figure><pre><code data-lang="c"><span>// create a complete keymap from the xkeyboard-config db</span>
<span>struct</span> <span>xkb_keymap</span> <span>*</span><span>keymap</span><span>;</span>
<span>// .. and a state object to keep track of what special state we're in</span>
<span>//   that could affect the keysym output</span>
<span>struct</span> <span>xkb_state</span> <span>*</span><span>state</span><span>;</span>
<span>…</span>
<span>state</span> <span>=</span> <span>xkb_state_new</span><span>(</span><span>keymap</span><span>);</span>
<span>xkb_state_update_key</span><span>(</span><span>state</span><span>,</span> <span>keycode</span><span>,</span>
    <span>pressed</span> <span>?</span> <span>XKB_KEY_DOWN</span> <span>:</span> <span>XKB_KEY_UP</span><span>);</span>
<span>xkb_keysym_t</span> <span>sym</span> <span>=</span> <span>xkb_state_key_get_one_sym</span><span>(</span><span>state</span><span>,</span> <span>keycode</span><span>);</span></code></pre></figure>

<p>The XKB state object tracks what affects the output of keycode to keysym,
things like modifiers and groups. This example doesn’t mention the idea
of key composing, but we’ll come back to it.</p>

<p>This is important to understand, since you can either have XKB handle
what happens in a specific state when a key is pressed, or do it from
the client side. For example, a client can choose to catch all Ctrl keys
and interpret Ctrl+h as backspace, or leave it up to XKB with a custom
mechanism to know what Ctrl+h means, and the client will receive back
the keysym for backspace directly, with no special handling from its side.<br>
Yet, the downside is that this key combination will apply to everyone
that relies on this XKB keymap.</p>

<p>Before moving forward, we need a little baggage of definitions, and
understanding, otherwise nothing will make sense.</p>

<ul>
  <li>evdev keycodes: the events coming from evdev, the ones listed in
<code>/usr/include/linux/input-event-codes.h</code></li>
  <li>XKB keysyms: Actual symbols (or dead key), actions, and special keys
that XKB will return, they exist in
<code>/usr/include/xkbcommon/xkbcommon-keysyms.h</code></li>
  <li>Modifier Keys: Special keys that can affect other keys such as shift,
alt, ctrl, “win”, etc.. Modifiers are also keysyms.</li>
  <li>Geometry: The physical layout of a keyboard, what it looks like and
where the keys are</li>
  <li>Levels and Groups: Levels is another state a key could be in when you
press a modifier. For example, it’s expected that pressing shift with
“a” will output “A”, upper case “A” is the level 2 of what happens when
pressing the key. A Group is similar but it completely switches the
whole keyboard to another key mapping, as if you switched variants.</li>
</ul>

<p>As you can imagine, there’s a lot at play with levels, groups, modifiers,
and actions that can happen, and that’s apart from the basic idea of
keycodes to keysym.</p>

<p>Even when it comes to keysym, the translation isn’t straight away. XKB
relies on intermediary objects.<br>
XKB keycodes are not straight up evdev keycodes, but 
<code>evdev keycodes + 8</code>. Why 8, someone might ask. Well, the only answer
is backward compatibility from before evdev was a thing, and it’s
still there.</p>

<p>Furthermore, XKB converts these keycodes into physical key
positions values that are compatible with ISO/IEC 9995-1. So we
move from evdev keycodes, to XKB keycodes, to physical abstract
position on a keyboard layout. This is what happens in the keycode
component files under <code>/usr/share/xkeyboard-config-2/keycodes/</code>. Keycodes
have this form within <code>&lt;...&gt;</code> tags. For example:</p>

<div><pre><code>&lt;TLDE&gt; = 49;
&lt;AE01&gt; = 10;
&lt;AE02&gt; = 11;
&lt;AE03&gt; = 12;
&lt;AE04&gt; = 13;
&lt;AE05&gt; = 14;
&lt;AE06&gt; = 15;
&lt;AE07&gt; = 16;
&lt;AE08&gt; = 17;
&lt;AE09&gt; = 18;
&lt;AE10&gt; = 19;
&lt;AE11&gt; = 20;
&lt;AE12&gt; = 21;
&lt;BKSP&gt; = 22;
</code></pre></div>

<p>Remember “49”, “10”, “11” are equivalent to evdev:</p>

<div><pre><code>#define KEY_GRAVE		41
#define KEY_1			2
#define KEY_2			3
#define KEY_3			4
#define KEY_4			5
#define KEY_5			6
#define KEY_6			7
#define KEY_7			8
#define KEY_8			9
#define KEY_9			10
#define KEY_0			11
#define KEY_MINUS		12
#define KEY_EQUAL		13
#define KEY_BACKSPACE		14
</code></pre></div>

<p>Or basically the first row from ISO/IEC 9995-1 on a keyboard.</p>

<p>To make it easier for users to pick an XKB keymap, without
having to know much details, the idea of picking only RMLVO,
Rules-Model-Layout-Variant-Options, was invented. This is an abstraction
on top to pick the components that make up a keymap, and thus come up with
the right keyboard behavior expected by the user. This is managed by the
XKB registry, which graphical environments interact with, this is what
is shown to the user when they’re asked about picking their keyboard
layout, the list of possible layouts and variants on those layouts,
along with special options.</p>

<ul>
  <li>Model – the name of the model of your keyboard</li>
  <li>Layout – the layout(s) you intend to use (usually refer to country code)</li>
  <li>Variant – the variant(s) of the layout(s) you intend to use (minor
and national variants)</li>
  <li>Options – extra XKB configuration options to customize the standard
layout. For example to change modifier keys.</li>
</ul>

<p>To know what’s actually picked as the final keymap, what’s called KcCGST,
we can run <code>xkbcli</code>. For example, for a dvorak keyboard, or a normal
qwerty keyboard:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xkbcli compile-keymap <span>--kccgst</span> <span>\</span>
  <span>--layout</span> us <span>\</span>
  <span>--variant</span> dvorak <span>\</span>
  <span>--options</span> terminate:ctrl_alt_bksp

xkb_keymap <span>{</span>
  xkb_keycodes <span>{</span> include <span>"evdev+aliases(qwerty)"</span> <span>}</span><span>;</span>
  xkb_types <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_compat <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_symbols <span>{</span> include <span>"pc+us(dvorak)+inet(evdev)+terminate(ctrl_alt_bksp)"</span> <span>}</span><span>;</span>
  xkb_geometry <span>{</span> include <span>"pc(pc105)"</span> <span>}</span><span>;</span>
<span>}</span><span>;</span>

<span>&gt;</span> xkbcli compile-keymap <span>--kccgst</span> <span>\</span>
  <span>--layout</span> us <span>\</span>
  <span>--variant</span> qwerty <span>\</span>
  <span>--options</span> terminate:ctrl_alt_bksp

xkb_keymap <span>{</span>
  xkb_keycodes <span>{</span> include <span>"evdev+aliases(qwerty)"</span> <span>}</span><span>;</span>
  xkb_types <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_compat <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_symbols <span>{</span> include <span>"pc+us(qwerty)+inet(evdev)+terminate(ctrl_alt_bksp)"</span> <span>}</span><span>;</span>
  xkb_geometry <span>{</span> include <span>"pc(pc105)"</span> <span>}</span><span>;</span>
<span>}</span><span>;</span></code></pre></figure>

<p>We’ll revisit the RMLVO, let’s just say it’s all about what the “rule”
part refers to: a lookup table with rules mapping the abstract names to
the components of the keymaps which are called KcCGST.</p>

<p>To find your layout and visualize it you can check the <a href="https://xkeyboard-config.freedesktop.org/layouts/gallery/#?model=iso-60&amp;language=tao">gallery here</a> and the <a href="https://xkeyboard-config.freedesktop.org/layouts/analyzer/#?model=iso-60&amp;layout=af">analyzer here</a>.</p>

<p>KcCGST, or the Keycodes, Compat, Geometry, Symbols, Types, are the
component parts of an XKB keymap. This is the actual functional XKB
configuration that is used behind the RMLVO easy facade. In general, XKB
considers it an implementation detail and pushes for users to favor
configuring XKB through RMLVO. Yet, it’s the core of XKB!</p>

<p>The resolution of the RMLVO will create a complete keymap, a self-contain
object that has all the related KcCGST components assembled together. This
complete XKB keymap is what is used by the clients.</p>

<p>To get a quick glimpse at what a full resolved keymap looks like, try
this command:</p>

<div><pre><code>&gt; xkbcli compile-keymap --layout us --rules evdev
</code></pre></div>

<p>Or for a more compact one, look again at the command such as the one we
just did before:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xkbcli compile-keymap <span>--kccgst</span> <span>--layout</span> us <span>--options</span> terminate:ctrl_alt_bksp
xkb_keymap <span>{</span>
  xkb_keycodes <span>{</span> include <span>"evdev+aliases(qwerty)"</span> <span>}</span><span>;</span>
  xkb_types <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_compat <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_symbols <span>{</span> include <span>"pc+us+inet(evdev)+terminate(ctrl_alt_bksp)"</span> <span>}</span><span>;</span>
  xkb_geometry <span>{</span> include <span>"pc(pc105)"</span> <span>}</span><span>;</span>
<span>}</span><span>;</span></code></pre></figure>

<p>Let’s go over these components and explain them.</p>

<p>First of, the KcCGST configurations that come from the keyboard-config
project are often found in the following places in reverse order of
precedence, with the component bundled underneath:</p>

<ul>
  <li><code>/usr/share/X11/xkb</code>, <code>$XKB_CONFIG_ROOT</code>, <code>/usr/share/xkeyboard-config-2/</code></li>
  <li><code>/etc/xkb</code></li>
  <li><code>$XKB_CONFIG_EXTRA_PATH</code></li>
  <li><code>$HOME/.xkb</code></li>
  <li><code>$HOME/.config/xkb</code></li>
</ul>

<p>Most of the components have a useful utility. That’s apart from the
geometry, which is a complex file used to describe what a keyboard
physical layout looks like. It’s not used in the latest xkbcommon
mechanism though, so we’ll skip explaining it.</p>

<p>The XKB configuration format has types: string, numbers, key positions,
and keysym:</p>

<ul>
  <li><code>"hello"</code>, <code>"%S/pc"</code></li>
  <li><code>42</code>, <code>134</code></li>
  <li><code>&lt;AE12&gt;</code>, <code>&lt;BKSP&gt;</code></li>
  <li><code>percent</code>, <code>a</code>, <code>A</code></li>
</ul>

<p>It also has many special keywords, and some structure format. The main
structural format is called a component, basically the components of
the KcCGST. Each XKB conf file is an aggregation of multiple of these
components. They have the form:</p>

<figure><pre><code data-lang="c"><span>&lt;</span><span>generic_flags</span><span>&gt;</span> <span>&lt;</span><span>symbols_flags</span><span>&gt;</span> <span>&lt;</span><span>xkb_componentname</span><span>&gt;</span> <span>"&lt;name&gt;"</span> <span>{</span>

  <span>// body</span>

<span>};</span>

<span>// Example</span>

<span>default</span> <span>partial</span> <span>alphanumeric_keys</span> <span>modifier_keys</span>
<span>xkb_symbols</span> <span>"basic"</span> <span>{</span>
  <span>// body</span>
<span>};</span></code></pre></figure>

<p>The generic flags can be one or many of these:</p>

<ul>
  <li><code>default</code>: One of these “variant” per component file, the default
 values to be used</li>
  <li><code>partial</code>: To be used in another conf</li>
  <li><code>hidden</code>: Only used internally within the file’s scope</li>
</ul>

<p>And the symbols flags can be one or many of these:</p>

<ul>
  <li><code>alphanumeric_keys</code></li>
  <li><code>modifier_keys</code></li>
  <li><code>keypad_keys</code></li>
  <li><code>function_keys</code></li>
  <li><code>alternate_group</code></li>
</ul>

<p>The symbols flags are mostly metadata and don’t affect the XKB processing.
They’re indicators of what the component configuration covers, and if
none are present it’s assumed it covers a complete keyboard.</p>

<p>Let’s start with the most important keywords, the ones used to import
and merge files together, we’ve seen the <code>include</code>. It works by finding
the file of the same component with the specified name, if it exists
in any of the valid conf paths (or if explicitly mentioned with string
substitution shorthands), and then look for the variants inside or the
default value if none are passed: <code>include "file(variant)"</code>.<br>
The <code>include</code> will override any information that already exists:
that is if new values are undefined it will keep the old one, but new
defined values will always override old ones. To avoid this, the <code>augment
"file(variant)"</code> should be used instead, it will update the properties
that are undefined, but keep the defined ones (it’s the reverse). Another
option is the <code>replace "file(variant)"</code> which will, as the name implies,
completely replace the full properties, regardless if some elements are
defined or not.</p>

<p>This “merge resolution” mechanism also applies to values within the
components objects, which can be tagged with <code>augment</code>, <code>override</code>,
<code>replace</code>, too.</p>

<p>As for files, a shorthand exists to have a single statement with multiple
includes concatenated. In this case the following merge mode prefixes
are used:</p>

<ul>
  <li><code>+</code> selects the override merge mode (default).</li>
  <li><code>|</code> selects the augment merge mode.</li>
  <li><code>^</code> selects the replace merge mode.</li>
</ul>

<p>So you can now understand why the following line we’ve seen works, and
how it creates an inheritance mechanism, plugging multiple files together:</p>

<figure><pre><code data-lang="c"><span>xkb_symbols</span> <span>{</span> <span>include</span> <span>"pc+us+inet(evdev)+terminate(ctrl_alt_bksp)"</span> <span>};</span></code></pre></figure>

<p>Let’s now explain what each component does, and wrap up with how the
rules mechanism of the RMLVO then resolves them into an XKB full keymap.</p>

<p>The keycodes file is the most obvious one and the first entry-point
for XKB logic, it translates from XKB keycodes to the physical codes
ISO/IEC 9995-1. The syntax of the components looks something like this:</p>

<figure><pre><code data-lang="c"><span>default</span> <span>xkb_keycodes</span> <span>"mykeycode"</span> <span>{</span>
	<span>// defining the range</span>
	<span>minimum</span> <span>=</span> <span>8</span><span>;</span>
	<span>maximum</span> <span>=</span> <span>255</span><span>;</span>

	<span>// mapping of keycodes to layout keys</span>
	<span>&lt;</span><span>TAB</span><span>&gt;</span> <span>=</span> <span>23</span><span>;</span>
	<span>&lt;</span><span>AD01</span><span>&gt;</span> <span>=</span> <span>24</span><span>;</span>
	<span>&lt;</span><span>AD02</span><span>&gt;</span> <span>=</span> <span>25</span><span>;</span>
	<span>&lt;</span><span>AD03</span><span>&gt;</span> <span>=</span> <span>26</span><span>;</span>
	<span>&lt;</span><span>AD04</span><span>&gt;</span> <span>=</span> <span>27</span><span>;</span>
	<span>&lt;</span><span>AD05</span><span>&gt;</span> <span>=</span> <span>28</span><span>;</span>
	<span>&lt;</span><span>AD06</span><span>&gt;</span> <span>=</span> <span>29</span><span>;</span>
	<span>&lt;</span><span>BKSL</span><span>&gt;</span> <span>=</span> <span>51</span><span>;</span>
	<span>&lt;</span><span>RTRN</span><span>&gt;</span> <span>=</span> <span>36</span><span>;</span>

	<span>// making one physical key name equivalent to another</span>
	<span>alias</span> <span>&lt;</span><span>LatQ</span><span>&gt;</span> <span>=</span> <span>&lt;</span><span>AD01</span><span>&gt;</span><span>;</span>
	<span>alias</span> <span>&lt;</span><span>LatW</span><span>&gt;</span> <span>=</span> <span>&lt;</span><span>AD02</span><span>&gt;</span><span>;</span>
	<span>alias</span> <span>&lt;</span><span>LatE</span><span>&gt;</span> <span>=</span> <span>&lt;</span><span>AD03</span><span>&gt;</span><span>;</span>
	<span>alias</span> <span>&lt;</span><span>LatR</span><span>&gt;</span> <span>=</span> <span>&lt;</span><span>AD04</span><span>&gt;</span><span>;</span>
	<span>alias</span> <span>&lt;</span><span>LatT</span><span>&gt;</span> <span>=</span> <span>&lt;</span><span>AD05</span><span>&gt;</span><span>;</span>
	<span>alias</span> <span>&lt;</span><span>LatY</span><span>&gt;</span> <span>=</span> <span>&lt;</span><span>AD06</span><span>&gt;</span><span>;</span>

	<span>// these are for LEDs, not always used by clients</span>
	<span>indicator</span> <span>1</span>  <span>=</span> <span>"Caps Lock"</span><span>;</span>
	<span>indicator</span> <span>2</span>  <span>=</span> <span>"Num Lock"</span><span>;</span>
	<span>indicator</span> <span>3</span>  <span>=</span> <span>"Scroll Lock"</span><span>;</span>
<span>};</span></code></pre></figure>

<p>The syntax is straight forward, it’s a couple of assignment, with the
possibility to have aliases, and giving names to LEDs, indicators, which
aren’t really leds afaik but keys that lock or latch. By convention it
explicitly names special keys, but other keys as their ISO positions.</p>

<p>Here’s a standard keyboard with its key positions:</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/xkb_key_layout.png" alt="keypositions" title="XKB key positions layout">
Courtesy from <a href="https://www.charvolant.org/doug/xkb/html/img3.png">https://www.charvolant.org/doug/xkb/html/img3.png</a></p>

<p>Let’s move to the types component. This is where the information about
levels, and how to switch between them is defined.</p>

<figure><pre><code data-lang="c"><span>virtual_modifiers</span>  <span>NumLock</span><span>;</span>

<span>type</span> <span>"ONE_LEVEL"</span> <span>{</span>
	<span>modifiers</span> <span>=</span> <span>None</span><span>;</span>
	<span>map</span><span>[</span><span>None</span><span>]</span> <span>=</span> <span>Level1</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Any"</span><span>;</span>
<span>};</span>

<span>type</span> <span>"TWO_LEVEL"</span> <span>{</span>
	<span>modifiers</span> <span>=</span> <span>Shift</span><span>;</span>
	<span>map</span><span>[</span><span>Shift</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Base"</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level2</span><span>]</span> <span>=</span> <span>"Shift"</span><span>;</span>
<span>};</span>

<span>type</span> <span>"ALPHABETIC"</span> <span>{</span>
	<span>modifiers</span> <span>=</span> <span>Shift</span> <span>+</span> <span>Lock</span><span>;</span>
	<span>map</span><span>[</span><span>Shift</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>map</span><span>[</span><span>Lock</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Base"</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level2</span><span>]</span> <span>=</span> <span>"Caps"</span><span>;</span>
<span>};</span>

<span>// override ALPHABETIC Shift will cancel capslock</span>
<span>override</span> <span>type</span> <span>"ALPHABETIC"</span> <span>{</span>
	<span>modifiers</span> <span>=</span> <span>Shift</span> <span>+</span> <span>Lock</span><span>;</span>
	<span>map</span><span>[</span><span>Shift</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>preserve</span><span>[</span><span>Lock</span><span>]</span> <span>=</span> <span>Lock</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Base"</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level2</span><span>]</span> <span>=</span> <span>"Caps"</span><span>;</span>
<span>};</span>

<span>// override ALPHABETIC, Shift will ignore capslock</span>
<span>override</span> <span>type</span> <span>"ALPHABETIC"</span> <span>{</span>
	<span>modifiers</span> <span>=</span> <span>Shift</span><span>;</span>
	<span>map</span><span>[</span><span>Shift</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Base"</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level2</span><span>]</span> <span>=</span> <span>"Caps"</span><span>;</span>
<span>};</span>

<span>// CapsLock acts as Shift with locking, Shift does not cancel CapsLock.</span>
<span>type</span> <span>"ALPHABETIC"</span> <span>{</span>
	<span>modifiers</span> <span>=</span> <span>Shift</span> <span>+</span> <span>Lock</span><span>;</span>
	<span>map</span><span>[</span><span>Shift</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>map</span><span>[</span><span>Lock</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>map</span><span>[</span><span>Shift</span><span>+</span><span>Lock</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Base"</span><span>;</span>
	<span>level_name</span><span>[</span><span>Level2</span><span>]</span> <span>=</span> <span>"Caps"</span><span>;</span>
<span>};</span></code></pre></figure>

<p>The syntax here is more cumbersome. Firstly, there are some definition
lines. In each <code>type</code> entry (which can be prepended with merge syntax
like anything else in this syntax really) of the form <code>type "name"</code>,
we have to define the modifiers that will be used as such:</p>

<figure><pre><code data-lang="c"><span>modifiers</span> <span>=</span> <span>Shift</span> <span>+</span> <span>Lock</span><span>;</span></code></pre></figure>

<p>The <code>+</code>, is just a separator here.<br>
If the modifiers are not real keysym but virtual ones, then those virtual
modifiers also need to be defined earlier in the scope:</p>

<figure><pre><code data-lang="c"><span>virtual_modifiers</span>  <span>NumLock</span><span>;</span></code></pre></figure>

<p>After defining the modifiers that are used for that type, we have a series
of mapping to define the combination and what levels these will achieve.</p>

<figure><pre><code data-lang="c"><span>map</span><span>[</span><span>Shift</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
<span>map</span><span>[</span><span>Lock</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span>
<span>map</span><span>[</span><span>Shift</span><span>+</span><span>Lock</span><span>]</span> <span>=</span> <span>Level2</span><span>;</span></code></pre></figure>

<p>The syntax is also straight forward, it’s a list of mapping from a
combination of modifiers to the <code>LevelX</code> it will take the keysym to.</p>

<p>Afterward, we have a naming section, which is there only for the metadata
information, to give names to levels:</p>

<figure><pre><code data-lang="c"><span>level_name</span><span>[</span><span>Level1</span><span>]</span> <span>=</span> <span>"Base"</span><span>;</span>
<span>level_name</span><span>[</span><span>Level2</span><span>]</span> <span>=</span> <span>"Caps"</span><span>;</span></code></pre></figure>

<p>The only tricky part is the <code>preserve</code> keyword:</p>

<figure><pre><code data-lang="c"><span>preserve</span><span>[</span><span>Lock</span><span>]</span> <span>=</span> <span>Lock</span><span>;</span></code></pre></figure>

<p>This has to do with how XKB consumes modifiers as it processes types
and outputs keysyms, its internal list of effective modifiers. Simply
said, without the <code>preserve</code> when the keysym is sent back to the client
(<code>xkb_state_key_get_one_sym</code>) the state object doesn’t consume the
modifier, so the client can inspect it for further special handling.<br>
The logic within XKB clients looks something like this:</p>

<figure><pre><code data-lang="c"><span>xkb_mod_mask_t</span> <span>mods</span> <span>=</span> <span>xkb_state_serialize_mods</span><span>(</span><span>state</span><span>,</span> <span>XKB_STATE_MODS_EFFECTIVE</span><span>);</span>
<span>xkb_mod_mask_t</span> <span>consumed</span> <span>=</span> <span>xkb_state_key_get_consumed_mods2</span><span>(</span><span>state</span><span>,</span> <span>keycode</span><span>,</span> <span>XKB_CONSUMED_MODE_XKB</span><span>);</span>
<span>xkb_mod_mask_t</span> <span>unconsumed_mods</span> <span>=</span> <span>mods</span> <span>&amp;</span> <span>~</span><span>consumed</span><span>;</span></code></pre></figure>

<p>That’s useful for layout where you have, let’s say Greek letters for
Level1 and Level2, and at Level3 and Level4 there are the usual Latin
letters. So you’d want to preserve <code>Ctrl</code> and <code>Shift</code>, so that the
application can catch <code>Ctrl+c</code> for example, which would be in Level3
(Latin lower-case).</p>

<p>I’ve added different versions of the <code>ALPHABETIC</code> type in the example,
and how the capslock and shift combinations can affect letters.</p>

<p>Later on we’ll see how we assign the levels logic to symbols and
compatibility logic, but let’s just say that XKB will categorize keys
with a heuristic and assign them to default types if no other types were
explicitly chosen. These are:</p>

<ul>
  <li><code>"ONE_LEVEL"</code>: When there are only one level change for the keysym</li>
  <li><code>"TWO_LEVEL"</code>: When there are exacly two levels change for the keysym</li>
  <li><code>"ALPHABETIC"</code>: When the keysym is alphabetic and has two levels</li>
  <li><code>"KEYPAD"</code>: For keypad keys of any level (two usually)</li>
  <li><code>"FOUR_LEVEL_ALPHABETIC"</code>, <code>"FOUR_LEVEL_SEMIALPHABETIC"</code>, 3 to 4 keysym</li>
  <li><code>"FOUR_LEVEL"</code>: When nothing else matches</li>
</ul>

<p>The next component is the XKB compatibility, which is used to translate
key combinations into action statements. Actions can also be attached
directly in the XKB symbols component for each key, however it’s done in
the compatibility layer because it has a mechanism for generic pattern
matching of keysym combinations, so we don’t have to repeat the same
things in different places.<br>
The actions that can be done in the XKB compatibility are varied
from latching/unlatching/locking/unlocking modifiers, changing level,
switching group, etc.. Many of these actions, however, only make sense in
combination with the XKB symbols component, so keep that in mind for now.<br>
A compatibility map looks something like:</p>

<figure><pre><code data-lang="c"><span>default</span> <span>xkb_compatibility</span> <span>"basic"</span>  <span>{</span>
    <span>virtual_modifiers</span> <span>NumLock</span><span>,</span><span>AltGr</span><span>;</span>
<span>...</span>
    <span>interpret</span><span>.</span><span>repeat</span><span>=</span> <span>False</span><span>;</span>
    <span>setMods</span><span>.</span><span>clearLocks</span><span>=</span> <span>True</span><span>;</span>
<span>...</span>
    <span>interpret</span> <span>Shift_Lock</span><span>+</span><span>AnyOf</span><span>(</span><span>Shift</span><span>+</span><span>Lock</span><span>)</span> <span>{</span>
        <span>action</span><span>=</span> <span>LockMods</span><span>(</span><span>modifiers</span><span>=</span><span>Shift</span><span>);</span>
    <span>};</span>
<span>...</span>
    <span>group</span> <span>2</span> <span>=</span> <span>AltGr</span><span>;</span>
<span>...</span>
    <span>indicator</span><span>.</span><span>allowExplicit</span><span>=</span> <span>False</span><span>;</span>
<span>...</span>
    <span>indicator</span> <span>"Caps Lock"</span> <span>{</span>
        <span>whichModState</span><span>=</span> <span>Locked</span><span>;</span>
        <span>modifiers</span><span>=</span> <span>Lock</span><span>;</span>
    <span>};</span>
<span>...</span>
<span>};</span>

<span>default</span> <span>partial</span> <span>xkb_compatibility</span> <span>"pc"</span> <span>{</span>
    <span>// Sets the "Alt" virtual modifier.</span>
    <span>virtual_modifiers</span>  <span>Alt</span><span>;</span>
    <span>setMods</span><span>.</span><span>clearLocks</span><span>=</span> <span>True</span><span>;</span>

    <span>interpret</span> <span>Alt_L</span><span>+</span><span>Any</span> <span>{</span>
	<span>virtualModifier</span><span>=</span> <span>Alt</span><span>;</span>
	<span>action</span> <span>=</span> <span>SetMods</span><span>(</span><span>modifiers</span><span>=</span><span>modMapMods</span><span>);</span>
    <span>};</span>

    <span>interpret</span> <span>Alt_R</span><span>+</span><span>Any</span> <span>{</span>
	<span>virtualModifier</span><span>=</span> <span>Alt</span><span>;</span>
	<span>action</span> <span>=</span> <span>SetMods</span><span>(</span><span>modifiers</span><span>=</span><span>modMapMods</span><span>);</span>
    <span>};</span>
<span>};</span></code></pre></figure>

<p>This has many components, the <code>interpret</code> sections to map keys to actions,
the virtual modifier definitions, indicators, repeat behavior of keys,
and more. The important part is the <code>interpret</code> section which matches
keysym along with a modifier (<code>AnyOfOrNone</code>, <code>AnyOf</code>, <code>Any</code>, <code>NoneOf</code>,
<code>AllOf</code>, <code>Exactly</code>). The body of the interpret can also be more specific
by setting values of <code>useModMapMods</code> to match a certain level.<br>
Default values to params can be set globally such as <code>setMods.clearLocks</code>,
which affects how <code>SetMods</code> and other mods actions behave.<br>
The list of possibilities and actions within the compatibility is
too long to explain here, the list is extensive and can be found
<a href="https://xkbcommon.org/doc/current/keymap-text-format-v1-v2.html#key-actions">here</a>.</p>

<p>Let’s move to the keysym or symbol component, which as you would
have guessed, finally maps physical keys in ISO location format to
symbols. These files are often named after countries or languages or
specific features, <code>us</code>, <code>jp</code>, <code>group</code>.</p>

<figure><pre><code data-lang="c"><span>partial</span> <span>alphanumeric_keys</span>
<span>xkb_symbols</span> <span>"basic"</span> <span>{</span>

    <span>name</span><span>[</span><span>Group1</span><span>]</span><span>=</span> <span>"US/ASCII"</span><span>;</span>
    <span>key</span> <span>&lt;</span><span>ESC</span><span>&gt;</span>  <span>{</span>        <span>[</span> <span>Escape</span>                        <span>]</span>       <span>};</span>
<span>...</span>
    <span>key</span> <span>&lt;</span><span>TLDE</span><span>&gt;</span> <span>{</span>        <span>[</span> <span>quoteleft</span><span>,</span>    <span>asciitilde</span>      <span>]</span>       <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE01</span><span>&gt;</span> <span>{</span>        <span>[</span>         <span>1</span><span>,</span>    <span>exclam</span>          <span>]</span>       <span>};</span>
<span>...</span>
    <span>modifier_map</span> <span>Shift</span>  <span>{</span> <span>Shift_L</span><span>,</span> <span>Shift_R</span> <span>};</span>
<span>...</span>
<span>};</span></code></pre></figure>

<p>It first has a metadata name in the <code>name[GroupX] = "Symbols Name"</code>
property, which can also be used to find which groups the symbols
belong to.<br>
This is also where virtual modifiers are mapped to actual keys with the
<code>modifier_map VIRTUAL_MOD { Symbol1, Symbol2}</code>.<br>
And obviously, that’s where the <code>key &lt;VAL&gt;</code> are mapped to list of groups
within <code>{}</code>, and levels within <code>[]</code>.</p>

<figure><pre><code data-lang="c"><span>key</span> <span>&lt;</span><span>TLDE</span><span>&gt;</span> <span>{</span>        <span>[</span> <span>quoteleft</span><span>,</span>    <span>asciitilde</span>      <span>]</span>       <span>};</span></code></pre></figure>

<p>This means the physical key <code>&lt;TLDE&gt;</code>, in level1 will output a left quote
(backtick), and in level2 will output the tilde character.</p>

<p>Additionally, we can also specify within the curly brackets whether a
specific type should be used instead of the default matching one:</p>

<figure><pre><code data-lang="c"><span>key</span> <span>&lt;</span><span>AE05</span><span>&gt;</span> <span>{</span> <span>[</span><span>parenleft</span><span>,</span> <span>1</span><span>,</span> <span>EuroSign</span><span>],</span> <span>type</span><span>[</span><span>Group1</span><span>]</span> <span>=</span> <span>"FOUR_LEVEL_ALPHABETIC"</span> <span>};</span></code></pre></figure>

<p>Similarly, the actions can be assigned here instead of in the
compatibility component, and the groups can also be explicitly expressed with
the syntax:</p>

<figure><pre><code data-lang="c"><span>key</span> <span>&lt;</span><span>LALT</span><span>&gt;</span> <span>{</span>
    <span>symbols</span><span>[</span><span>Group1</span><span>]</span><span>=</span><span>[</span><span>Alt_L</span><span>],</span>
    <span>actions</span><span>[</span><span>Group1</span><span>]</span><span>=</span><span>[</span><span>SetMods</span><span>(</span><span>modifiers</span><span>=</span><span>modMapMods</span><span>)]</span>
<span>};</span></code></pre></figure>

<p>That all should cover the KcCGST component syntax. It’s very long already,
I know, yet it barely covers the basics. Let’s see a few examples to
grasp the concepts.</p>

<p>In <code>symbol/group</code> we have:</p>

<figure><pre><code data-lang="c"><span>// The left Alt key (while pressed) chooses the next group.</span>
<span>partial</span> <span>modifier_keys</span>
<span>xkb_symbols</span> <span>"lswitch"</span> <span>{</span>
    <span>key</span> <span>&lt;</span><span>LALT</span><span>&gt;</span> <span>{[</span>  <span>Mode_switch</span><span>,</span>  <span>Multi_key</span>  <span>]};</span>
<span>};</span></code></pre></figure>

<p>And in <code>compat/basic</code> we have these <code>interpret</code>:</p>

<figure><pre><code data-lang="c"><span>interpret</span> <span>Mode_switch</span> <span>{</span>
	<span>action</span><span>=</span> <span>SetGroup</span><span>(</span><span>group</span><span>=+</span><span>1</span><span>);</span>
<span>};</span></code></pre></figure>

<p>The <code>Multi_key</code> maps to a compose key in <code>compat/ledcompose</code>:</p>

<figure><pre><code data-lang="c"><span>interpret</span> <span>Multi_key</span><span>+</span><span>Any</span> <span>{</span>
	<span>virtualModifier</span><span>=</span> <span>Compose</span><span>;</span>
	<span>action</span> <span>=</span> <span>LatchMods</span><span>(</span><span>modifiers</span><span>=</span><span>modMapMods</span><span>);</span>
<span>};</span>

<span>indicator</span> <span>"Compose"</span> <span>{</span>
	<span>allowExplicit</span><span>;</span>
	<span>whichModState</span><span>=</span> <span>Latched</span><span>;</span>
	<span>modifiers</span><span>=</span> <span>Compose</span><span>;</span>
<span>};</span></code></pre></figure>

<p>We’ll see in a bit how compose works.</p>

<p>Another example setting <code>&lt;LWIN&gt;</code> to <code>Super_L</code> which sets <code>Mod3</code> modifier.</p>

<figure><pre><code data-lang="c"><span>xkb_compatibility</span> <span>{</span>
   <span>interpret</span> <span>Super_L</span> <span>{</span> <span>action</span> <span>=</span> <span>SetMods</span><span>(</span><span>modifiers</span><span>=</span><span>Mod3</span><span>);</span> <span>};</span>
<span>}</span>

<span>xkb_symbols</span> <span>{</span>
   <span>key</span> <span>&lt;</span><span>LWIN</span><span>&gt;</span> <span>{</span> <span>[</span> <span>Super_L</span> <span>]</span> <span>};</span>
   <span>modifier_map</span> <span>Mod3</span> <span>{</span> <span>Super_L</span> <span>};</span>
<span>}</span></code></pre></figure>

<p>Here’s another example swapping the top row numbers on shift:</p>

<figure><pre><code data-lang="c"><span>default</span> <span>partial</span> <span>alphanumeric_keys</span>
<span>xkb_symbols</span> <span>"basic"</span> <span>{</span>
    <span>include</span> <span>"us(basic)"</span>
    <span>name</span><span>[</span><span>Group1</span><span>]</span><span>=</span> <span>"Banana (US)"</span><span>;</span>
 
    <span>key</span> <span>&lt;</span><span>AE01</span><span>&gt;</span> <span>{</span> <span>[</span> <span>exclam</span><span>,</span>          <span>1</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE02</span><span>&gt;</span> <span>{</span> <span>[</span> <span>at</span><span>,</span>              <span>2</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE03</span><span>&gt;</span> <span>{</span> <span>[</span> <span>numbersign</span><span>,</span>      <span>3</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE04</span><span>&gt;</span> <span>{</span> <span>[</span> <span>dollar</span><span>,</span>          <span>4</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE05</span><span>&gt;</span> <span>{</span> <span>[</span> <span>percent</span><span>,</span>         <span>5</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE06</span><span>&gt;</span> <span>{</span> <span>[</span> <span>asciicircum</span><span>,</span>     <span>6</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE07</span><span>&gt;</span> <span>{</span> <span>[</span> <span>ampersand</span><span>,</span>       <span>7</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE08</span><span>&gt;</span> <span>{</span> <span>[</span> <span>asterisk</span><span>,</span>        <span>8</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE09</span><span>&gt;</span> <span>{</span> <span>[</span> <span>parenleft</span><span>,</span>       <span>9</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE10</span><span>&gt;</span> <span>{</span> <span>[</span> <span>parenright</span><span>,</span>      <span>0</span><span>]</span>     <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE11</span><span>&gt;</span> <span>{</span> <span>[</span> <span>underscore</span><span>,</span>      <span>minus</span><span>]</span> <span>};</span>
    <span>key</span> <span>&lt;</span><span>AE12</span><span>&gt;</span> <span>{</span> <span>[</span> <span>plus</span><span>,</span>            <span>equal</span><span>]</span> <span>};</span>
<span>};</span>
 
<span>// Same as banana but map the euro sign to the 5 key</span>
<span>partial</span> <span>alphanumeric_keys</span>
<span>xkb_symbols</span> <span>"orange"</span> <span>{</span>
    <span>include</span> <span>"banana(basic)"</span>
    <span>name</span><span>[</span><span>Group1</span><span>]</span> <span>=</span> <span>"Banana (Eurosign on 5)"</span><span>;</span>
    <span>include</span> <span>"eurosign(5)"</span>
<span>};</span></code></pre></figure>

<p>Here’s a symbol component which replaces key “B” to have a third level
activated with the right alt to display a broccoli.</p>

<figure><pre><code data-lang="c"><span>partial</span> <span>alphanumeric_keys</span>
<span>xkb_symbols</span> <span>"broccoli"</span> <span>{</span>
    <span>include</span> <span>"us(basic)"</span>
    <span>name</span><span>[</span><span>Group1</span><span>]</span> <span>=</span> <span>"Broccoli"</span><span>;</span>
    <span>key</span> <span>&lt;</span><span>AD05</span><span>&gt;</span> <span>{</span> <span>[</span> <span>b</span><span>,</span> <span>B</span><span>,</span> <span>U1F966</span> <span>]};</span> <span>// 🥦</span>
    <span>include</span> <span>"level3(ralt_switch)"</span>
<span>};</span></code></pre></figure>

<p><em>NB</em>: XKB has keysym to allow controlling the mouse pointer from the
keyboard, this can be useful if clients actually understand these keysym
and act on them.</p>

<p>It’s fine and all but we need the RMLVO so that the users can actually
use the keymap properly without bothering with all that we’ve seen.<br>
The rules are in the <code>rules</code> directory as simple files without extensions,
and are accompanied with two listing files for GUI selectors: <code>*.lst</code>
and <code>*.xml</code> that follow the <code>xkb.dtd</code> in the same directory. The listing
files are simply listing all the models, variants, layouts, and options
available, nothing more, and are used by the XKB registry library. That’s
in turn used by GUI selectors.</p>

<p>The logic exists within the rules files, that have this sort syntax:</p>

<figure><pre><code data-lang="shell"><span>!</span> include %S/evdev
 
<span>!</span> option     <span>=</span> symbols
  custom:foo <span>=</span> +custom<span>(</span>bar<span>)</span>
  custom:baz <span>=</span> +other<span>(</span>baz<span>)</span>

// One may use multiple MLVO components on the LHS
<span>!</span> layout    option          <span>=</span> symbols
  be        caps:digits_row <span>=</span> +capslock<span>(</span>digits_row<span>)</span>
  fr        caps:digits_row <span>=</span> +capslock<span>(</span>digits_row<span>)</span></code></pre></figure>

<p>The full syntax grammar looks like this:</p>

<figure><pre><code data-lang="shell">File         ::<span>=</span> <span>{</span> <span>"!"</span> <span>(</span>Include | Group | RuleSet<span>)</span> <span>}</span>

Include      ::<span>=</span> <span>"include"</span> &lt;ident&gt;

Group        ::<span>=</span> GroupName <span>"="</span> <span>{</span> GroupElement <span>}</span> <span>"</span><span>\n</span><span>"</span>
GroupName    ::<span>=</span> <span>"$"</span>&lt;ident&gt;
GroupElement ::<span>=</span> &lt;ident&gt;

RuleSet      ::<span>=</span> Mapping <span>{</span> Rule <span>}</span>

Mapping      ::<span>=</span> <span>{</span> Mlvo <span>}</span> <span>"="</span> <span>{</span> Kccgst <span>}</span> <span>"</span><span>\n</span><span>"</span>
Mlvo         ::<span>=</span> <span>"model"</span> | <span>"option"</span> | <span>(</span><span>"layout"</span> | <span>"variant"</span><span>)</span> <span>[</span> Index <span>]</span>
Index        ::<span>=</span> <span>"["</span> <span>({</span> NumericIndex <span>}</span> | <span>{</span> SpecialIndex <span>})</span> <span>"]"</span>
NumericIndex ::<span>=</span> 1..XKB_MAX_GROUPS
SpecialIndex ::<span>=</span> <span>"single"</span> | <span>"first"</span> | <span>"later"</span> | <span>"any"</span>
Kccgst       ::<span>=</span> <span>"keycodes"</span> | <span>"symbols"</span> | <span>"types"</span> | <span>"compat"</span> | <span>"geometry"</span>

Rule         ::<span>=</span> <span>{</span> MlvoValue <span>}</span> <span>"="</span> <span>{</span> KccgstValue <span>}</span> <span>"</span><span>\n</span><span>"</span>
MlvoValue    ::<span>=</span> <span>"*"</span> | <span>"&lt;none&gt;"</span> | <span>"&lt;some&gt;"</span> | <span>"&lt;any&gt;"</span> | GroupName | &lt;ident&gt;
KccgstValue  ::<span>=</span> &lt;ident&gt; <span>[</span> <span>{</span> Qualifier <span>}</span> <span>]</span>
Qualifier    ::<span>=</span> <span>":"</span> <span>({</span> NumericIndex <span>}</span> | <span>"all"</span><span>)</span></code></pre></figure>

<p>We won’t go into details, but basically it has lines starting with <code>!</code>
that set certain MLVO values and then map them to KccgstValue specific
component values. There are also variable names that can be defined
as shorthand for multiple values with <code>$var = val1 val2</code>, and there
are string substitutions starting with <code>%</code>. More info can be found
<a href="https://xkbcommon.org/doc/current/rule-file-format.html">here</a>.</p>

<p>So we’ve got the full scope now of RMLVO to KcCGST, the big picture!</p>

<p>We didn’t discuss another sub-feature of XKB called composing, or the
compose key processor. We didn’t mention it because the configuration
doesn’t come with the xkeyboard-config project. It’s loaded independently
by clients that want to perform composition.<br>
For X11 the configuration is found under <code>/usr/share/X11/local/*/Compose</code>
and <code>compose.dir</code>, and the home directory in <code>~/.XCompose</code>. The
content of this directory is mostly deprecated apart from the compose
definitions, which follows the <code>XKB_COMPOSE_FORMAT_TEXT_V1</code> format (see
<code>Compose(5)</code>). It’s a simple format that looks like this:</p>

<div><pre><code>&lt;Multi_key&gt; &lt;e&gt; &lt;'&gt;       : "é"   U00E9
&lt;Multi_key&gt; &lt;'&gt; &lt;e&gt;       : "é"   U00E9
&lt;Multi_key&gt; &lt;o&gt; &lt;slash&gt;   : "ø"   U00F8
&lt;Multi_key&gt; &lt;s&gt; &lt;s&gt;       : "ß"   U00DF
</code></pre></div>

<p>As you can see, this is the <code>&lt;Multi_key&gt;</code> keysym we’ve talked about in
an earlier example, this is where it’s interpreted.</p>

<p>After editing any of the files, the syntax can be validated with <code>xkbcli
compile-compose</code>.</p>

<p>The way the file is used is that clients will pass it to the XKB compose
parser to get an in-memory table of it. Then the client keeps the compose
state, just like the modifier state, and plug it in the main interaction
with XKB we’ve seen earlier. Like this:</p>

<figure><pre><code data-lang="c"><span>// 1. Load compose table (locale-dependent)</span>
<span>struct</span> <span>xkb_compose_table</span> <span>*</span><span>table</span> <span>=</span>
    <span>xkb_compose_table_new_from_locale</span><span>(</span><span>ctx</span><span>,</span> <span>getenv</span><span>(</span><span>"LANG"</span><span>),</span>
                                      <span>XKB_COMPOSE_COMPILE_NO_FLAGS</span><span>);</span>

<span>// 2. Create a compose state</span>
<span>struct</span> <span>xkb_compose_state</span> <span>*</span><span>compose</span> <span>=</span>
    <span>xkb_compose_state_new</span><span>(</span><span>table</span><span>,</span> <span>XKB_COMPOSE_STATE_NO_FLAGS</span><span>);</span>

<span>// 3. For each key press:</span>
<span>xkb_keysym_t</span> <span>sym</span> <span>=</span> <span>xkb_state_key_get_one_sym</span><span>(</span><span>state</span><span>,</span> <span>keycode</span><span>);</span>
<span>xkb_compose_feed_result</span> <span>res</span> <span>=</span> <span>xkb_compose_state_feed</span><span>(</span><span>compose</span><span>,</span> <span>sym</span><span>);</span>

<span>// Feed all keysyms into the compose engine:</span>
<span>xkb_compose_state_feed</span><span>(</span><span>compose_state</span><span>,</span> <span>sym</span><span>);</span>

<span>// 4. Check compose status</span>
<span>switch</span> <span>(</span><span>xkb_compose_state_get_status</span><span>(</span><span>compose_state</span><span>))</span> <span>{</span>
    <span>case</span> <span>XKB_COMPOSE_COMPOSED</span><span>:</span>
        <span>composed_sym</span> <span>=</span> <span>xkb_compose_state_get_one_sym</span><span>(</span><span>compose_state</span><span>);</span>
        <span>// Use composed_sym; DO NOT use 'sym'</span>
        <span>// char buf[64];</span>
        <span>// xkb_compose_state_get_utf8(compose_state, buf, sizeof(buf));</span>
        <span>// printf("→ composed result: %s\n", buf);</span>
        <span>break</span><span>;</span>

    <span>case</span> <span>XKB_COMPOSE_CANCELLED</span><span>:</span>
        <span>// Typically fall back to original sym</span>
        <span>break</span><span>;</span>

    <span>case</span> <span>XKB_COMPOSE_COMPOSING</span><span>:</span>
        <span>// Wait for next key</span>
        <span>break</span><span>;</span>

    <span>case</span> <span>XKB_COMPOSE_NOTHING</span><span>:</span>
        <span>// No composition; use raw 'sym'</span>
        <span>break</span><span>;</span>
<span>}</span>

<span>// otherwise</span>
<span>// xkb_state_key_get_utf8</span></code></pre></figure>

<p>So, to make key composing work, it’s all dependent on the client, be
it in X11 or Wayland. In general widget/toolkit libraries, and Xlib,
does it out-of-the-box and/or easily for us.</p>

<p>Finally, let’s review how to interface with XKB from the command line.</p>

<p>There are a couple of X11 bound, and deprecated legacy, commands such as:</p>

<ul>
  <li><code>xmodmap</code> (pre-XKB even)</li>
  <li><code>setxkbmap</code></li>
  <li><code>xkbcomp</code></li>
  <li><code>xev</code></li>
  <li><code>xkbprint</code></li>
  <li><code>xkbevd</code></li>
</ul>

<p>They will not work on Wayland since they rely on the XKB X11 specific
proto (XKM binary format and others), but are still good to debug certain
behavior on X11, and to directly interface with X11 to configure XKB
interpretation on the fly, since obviously it’s these software that rely
on the library and load the appropriate configurations.</p>

<p>The main interaction these days should all pass through <code>xkbcli</code> and
its subcommands. It comes with a few handy man pages:</p>

<ul>
  <li><code>xkbcli</code></li>
  <li><code>xkbcli-list</code></li>
  <li><code>xkbcli-dump-keymap-x11</code></li>
  <li><code>xkbcli-dump-keymap-wayland</code></li>
  <li><code>xkbcli-interactive-x11</code></li>
  <li><code>xkbcli-interactive-wayland</code></li>
  <li><code>xkbcli-compile-compose</code></li>
  <li><code>xkbcli-how-to-type</code></li>
  <li><code>xkbcli-compile-keymap</code></li>
  <li><code>xkbcli-interactive-evdev</code></li>
</ul>

<div><pre><code>&gt; xkbcli how-to-type 'P'
keysym: P (0x0050)
KEYCODE  KEY NAME  LAYOUT   LAYOUT NAME          LEVEL#  MODIFIERS
33       AD10      1        English (US)         2       [ Shift ]
33       AD10      1        English (US)         2       [ Lock ]
</code></pre></div>

<figure><pre><code data-lang="shell"><span>&gt;</span> xkbcli compile-keymap <span>--kccgst</span> <span>--layout</span> us <span>--options</span> terminate:ctrl_alt_bksp
xkb_keymap <span>{</span>
  xkb_keycodes <span>{</span> include <span>"evdev+aliases(qwerty)"</span> <span>}</span><span>;</span>
  xkb_types <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_compat <span>{</span> include <span>"complete"</span> <span>}</span><span>;</span>
  xkb_symbols <span>{</span> include <span>"pc+us+inet(evdev)+terminate(ctrl_alt_bksp)"</span> <span>}</span><span>;</span>
  xkb_geometry <span>{</span> include <span>"pc(pc105)"</span> <span>}</span><span>;</span>
<span>}</span><span>;</span></code></pre></figure>

<p>To list the whole RMLVO possible values from the registry:</p>



<p>Print current RMLVO:</p>

<div><pre><code>&gt; xkbcli compile-keymap --rmlvo
rules: "evdev"
model: "pc105"
layout: "us"
variant: ""
options: ""
</code></pre></div>

<p>A nice debugging trace for a compose example <code>alt+'+e</code> that outputs “é”.</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xkbcli interactive-x11 <span>--enable-compose</span> <span>--multiline</span>
<span>------------</span>
key down: 0x06c &lt;RALT&gt;
    layout: depressed: 0
            latched:   0
            locked:    0 <span>"English (US)"</span>
            effective: 0 <span>"English (US)"</span>
            key:       0 <span>"English (US)"</span>
    modifiers: depressed: 0x00000000
               latched:   0x00000000
               locked:    0x00000010 Mod2 NumLock
               effective: 0x00000010 Mod2 NumLock
    level: 0
    raw keysyms: Multi_key
    compose: pending
    LEDs: 1 <span>"Num Lock"</span>
<span>------------</span>
key up:   0x06c &lt;RALT&gt;
<span>------------</span>
key down: 0x030 &lt;AC11&gt;
    layout: depressed: 0
            latched:   0
            locked:    0 <span>"English (US)"</span>
            effective: 0 <span>"English (US)"</span>
            key:       0 <span>"English (US)"</span>
    modifiers: depressed: 0x00000000
               latched:   0x00000000
               locked:    0x00000010 Mod2 NumLock
               effective: 0x00000010 Mod2 NumLock
    level: 0
    raw keysyms: apostrophe
    compose: pending
    LEDs: 1 <span>"Num Lock"</span>
<span>------------</span>
key up:   0x030 &lt;AC11&gt;
<span>------------</span>
key down: 0x01a &lt;AD03&gt;
    layout: depressed: 0
            latched:   0
            locked:    0 <span>"English (US)"</span>
            effective: 0 <span>"English (US)"</span>
            key:       0 <span>"English (US)"</span>
    modifiers: depressed: 0x00000000
               latched:   0x00000000
               locked:    0x00000010 Mod2 NumLock
               effective: 0x00000010 Mod2 NumLock
    level: 0
    raw keysyms: e
    composed: eacute <span>"é"</span> <span>(</span>U+00E9, 1 code point<span>)</span>
    LEDs: 1 <span>"Num Lock"</span>
<span>------------</span></code></pre></figure>

<p>Let’s note I have these confs:</p>

<figure><pre><code data-lang="c"><span>// in symbols</span>
<span>key</span> <span>&lt;</span><span>RALT</span><span>&gt;</span> <span>{</span>
  <span>type</span><span>=</span> <span>"TWO_LEVEL"</span><span>,</span>
  <span>symbols</span><span>[</span><span>1</span><span>]</span><span>=</span> <span>[</span>       <span>Multi_key</span><span>,</span>       <span>Multi_key</span> <span>]</span>
<span>};</span>

<span>// in Compose</span>
<span>&lt;</span><span>Multi_key</span><span>&gt;</span> <span>&lt;</span><span>apostrophe</span><span>&gt;</span> <span>&lt;</span><span>e</span><span>&gt;</span> <span>:</span> <span>"é"</span> <span>eacute</span> <span>#</span> <span>LATIN</span> <span>SMALL</span> <span>LETTER</span> <span>E</span> <span>WITH</span> <span>ACUTE</span></code></pre></figure>

<p>There are additional third party projects such as <code>klfcAUR</code> to compile
layouts from JSON.</p>

<p>Probably the most impressive is how you can rely on the geometry and
print it as a PDF, this only works with the legacy tools though:</p>

<div><pre><code>&gt; setxkbmap -print | xkbcomp -xkm - - | xkbprint - - | ps2pdf - mymap.pdf
</code></pre></div>

<p>Another thing that is interesting to know is that the XKB
keymap can be converted to Console keymap with scripts such as the
<a href="https://manpages.debian.org/testing/console-setup/setupcon.1.en.html"><code>setupcon(1)</code></a>
which relies on <code>ckbcomp</code> and others, and will read confs from <code>/etc/default/keyboard</code>.<br>
Obviously, let’s not forget to mention <code>localectl(1)</code> to interface with
<code>systemd-localed.service(8)</code> that is the newer version of
<code>setupcon(1)</code>. It’s sort of a big wrapper over other tools and behavior
to automate things.</p>

<div><pre><code>&gt; localectl
System Locale: LANG=en_US.UTF-8
    VC Keymap: us
   X11 Layout: us
</code></pre></div>

<p>We’ll see how it sets it in X11, but let’s just say it can be used to
list keymaps:</p>



<p>There are also the options <code>list-x11-keymap-models</code>,
<code>list-x11-keymap-layouts</code>, <code>list-x11-keymap-variants [LAYOUT]</code>,
<code>list-x11-keymap-options</code>.</p>

<p>And to set it with <code>set-x11-keymap</code>. However it always tries to convert
the XKB keymap to console keymap whenever it can, if you don’t want that
behavior, you should add this option:</p>

<div><pre><code>&gt; localectl set-x11-keymap --no-convert keymap
</code></pre></div>

<p>Let’s end on a funny note to wrap things up about XKB. Yubikeys work by
simulating keyboards, and thus they have to anticipate a very specific
layout and variant, otherwise inserting a Yubikey would output the
wrong values. To skip this, there are udev device properties (<code>ENV{}</code>
set from hwdb) called <code>XKB_FIXED_LAYOUT</code> and <code>XKB_FIXED_VARIANT</code> that
need to be set and respected by the clients of libxkbcommon.</p>

<p>From <code>60-keyboard.hwdb</code>:</p>

<div><pre><code># Yubico Yubico Yubikey II
evdev:input:b0003v1050p0010*
# Yubico Yubikey NEO OTP+CCID
evdev:input:b0003v1050p0111*
# Yubico Yubikey NEO OTP+U2F+CCID
evdev:input:b0003v1050p0116*
# OKE Electron Company USB barcode reader
evdev:input:b0003v05FEp1010*
 XKB_FIXED_LAYOUT=us
 XKB_FIXED_VARIANT=
</code></pre></div>

<p>Here’s a summary of what was discussed in the XKB stack:</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/xkb.png" alt="XKB Overview" title="XKB Overview"></p>

<h2 id="pointer-specifics">Pointer Specifics</h2>

<p>We’ve seen a lot of complex keyboard specific input behavior, let’s
dabble a bit with pointer devices now, from mice to touchpads.</p>

<h2 id="types-of-touchpads">Types of Touchpads</h2>

<p>Let’s mention a few definitions.<br>
In general we call a pointer the representation of the input device,
and the cursor the drawn icon representation.</p>

<p>We have clickpads, a touchpad that has no separate buttons, but
that is all clickable. The behavior then depends on where the click
happens. Meanwhile, forcepads are like clickpads but they don’t have
any buttons and instead will vibrate when pressed. Lastly, trackpoints
are the little balls/nudge in the middle of the keyboard of Thinkpads,
they’re tagged in udev/hwdb with <code>ID_INPUT_POINTINGSTICK</code> property.</p>

<figure><pre><code data-lang="shell">Device:                  TPPS/2 Elan TrackPoint
trackpoint: the nudge of thinkpads

    <span># Name: TPPS/2 Elan TrackPoint</span>
    <span># ID: bus 0x0011 vendor 0x0002 product 0x000a version 0x0063</span>
    <span># Supported Events:</span>
    <span># Event type 0 (EV_SYN)</span>
    <span># Event type 1 (EV_KEY)</span>
    <span>#   Event code 272 (BTN_LEFT)</span>
    <span>#   Event code 273 (BTN_RIGHT)</span>
    <span>#   Event code 274 (BTN_MIDDLE)</span>
    <span># Event type 2 (EV_REL)</span>
    <span>#   Event code 0 (REL_X)</span>
    <span>#   Event code 1 (REL_Y)</span>
    <span># Properties:</span>
    <span>#    Property 0 (INPUT_PROP_POINTER)</span>
    <span>#    Property 5 (INPUT_PROP_POINTING_STICK)</span>

    properties:
    - <span>ID_INPUT</span><span>=</span>1
    - <span>ID_INPUT_MOUSE</span><span>=</span>1
    - <span>ID_INPUT_POINTINGSTICK</span><span>=</span>1
driver:psmouse</code></pre></figure>

<p>As you can see from the above, the trackpoint also has attached to it
some physical buttons, they’re the ones above the Thinkpad touchpad. It’s
in between a mouse and a touchpad.</p>

<p>There are internal touchpads and external touchpads. The external
touchpads don’t get turned off when the lid is closed, nor disabled
while typing. A graphic tablet such as a wacom device is effectively an
external touchpad.<br>
This information can be embedded in a udev device property called
<code>ENV{ID_INPUT_TOUCHPAD_INTEGRATION}</code>, and set to either “external” or
“internal”. This is part of the hwdb, out-of-the-box:</p>

<figure><pre><code data-lang="shell"> ~ <span>&gt;</span> udevadm info /dev/input/event11  
P: /devices/platform/i8042/serio1/input/input11/event11
M: event11
….
N: input/event11
E: <span>DEVNAME</span><span>=</span>/dev/input/event11
…
E: <span>SUBSYSTEM</span><span>=</span>input
E: <span>ID_INPUT</span><span>=</span>1
E: <span>ID_INPUT_TOUCHPAD</span><span>=</span>1
E: <span>ID_INPUT_WIDTH_MM</span><span>=</span>101
E: <span>ID_INPUT_HEIGHT_MM</span><span>=</span>73
…
E: <span>ID_INPUT_TOUCHPAD_INTEGRATION</span><span>=</span>internal</code></pre></figure>

<p>Last interesting fact is that some touchpad can have capacitive touch,
that means they can detect the finger in a range above the touchpad,
hovering in proximity. This is the <code>BTN_TOOL_FINGER</code> in contrast to
<code>BTN_TOUCH</code>, but they often come together and so you have to discern if
it’s a real touchdown or not. For MT there’s also <code>ABS_MT_PRESSURE</code> and
<code>ABS_MT_DISTANCE</code> that can be used for this. That’s another job that
libinput is good at.</p>

<h2 id="mt--multitouch">MT — MultiTouch</h2>

<p>We quickly went over the concept of MT, or multitouch before, let’s add
a bit more info to that.</p>

<p>Multitouch are touchpads that support tracking more than one finger. They
speak evdev multitouch to user-space (type B), and most often are handled
by the hid-multitouch driver from the kernel side.</p>

<p>The capabilities of an MT touchpad should have something similar to this
(<code>libinput record</code> output or others):</p>

<div><pre><code>key: BTN_LEFT, BTN_TOOL_FINGER, BTN_TOOL_DOUBLETAP, BTN_TOUCH 
     (BTN_TOOL_DOUBLETAP up to BTN_TOOL_QUINTTAP)
abs: ABS_X, ABS_Y, ABS_MT_SLOT, ABS_MT_POSITION_X, ABS_MT_POSITION_Y,
     ABS_MT_TOOL_TYPE, ABS_MT_TRACKING_ID
</code></pre></div>

<p>There can also be <code>ABS_MT_TOUCH_MAJOR</code>, <code>ABS_MT_TOUCH_MINOR</code>,
<code>ABS_MT_WIDTH_MINOR</code>, and <code>ABS_MT_WIDTH_MAJOR</code>, that are used to provide
the size of the contact area in surface or absolute units. There’s
also <code>ABS_MT_ORIENTATION</code>, for the orientation of the touching ellipse
(finger).</p>

<p>For MT, the key events are simple, they tell us how many fingers are
tapping.<br>
Then, fingers are tracked in what’s called “slots” along with a new
unique tracking id each time a finger touchdown again, and like all
evdev it’s a stateful protocol.</p>

<p>So for example, slot 0 gets assigned tracking id 1 when the first finger
is down, then slot 1 gets assigned tracking id 2 when the second finger
is down, then the first finger is lifted and put back down again, and
slot 0 gets assigned tracking id 3.<br>
That can sound complex to track, and again that’s where libinput
shines. Here’s what it looks like in a simplified evdev trace:</p>

<div><pre><code>ABS_MT_SLOT 0
ABS_MT_TRACKING_ID 45
ABS_MT_POSITION_X x[0]
ABS_MT_POSITION_Y y[0]
ABS_MT_SLOT 1
ABS_MT_TRACKING_ID 46
ABS_MT_POSITION_X x[1]
ABS_MT_POSITION_Y y[1]
SYN_REPORT
// slot 0 moves in x position
ABS_MT_SLOT 0
ABS_MT_POSITION_X x[0]
SYN_REPORT
// lifting slot 0
ABS_MT_TRACKING_ID -1
SYN_REPORT
// lifting slot 1
ABS_MT_SLOT 1
ABS_MT_TRACKING_ID -1
SYN_REPORT
</code></pre></div>

<h2 id="synaptics">Synaptics</h2>

<p>Once upon a time everyone was bragging about their synaptics touchpad
confs, yet this is now deprecated in favor of libinput. What was that
all about?</p>

<p>Synaptics, unrelated to synaptics inc, was a complex X11 driver with
so many configurations. It was buggy and had lots of internal magic,
especially its acceleration profiles, which had logic split between the
X11 server and the driver.</p>

<div><pre><code> $ synclient -l
 Parameter settings:
 LeftEdge                = 1310
 RightEdge               = 4826
 TopEdge                 = 2220
 BottomEdge              = 4636
 FingerLow               = 25
 FingerHigh              = 30
 MaxTapTime              = 180
 ...
</code></pre></div>

<p>Synaptics was configured through the command line <code>synclient</code>. They
talked through a special interfaced with a custom protocol (shared memory
segment). That is before X11 had any standard way to dynamically be
configured (with <code>xinput</code>), and before evdev was a thing. This was hacky.</p>

<p>These days X11 and Wayland rely on libinput so this should be used
instead.</p>

<p>The only feature missing from libinput, which is implemented in user-space
by the widget libraries and DE, is non-linear acceleration and speed,
kinetic scrolling. That’s mostly a non-issue.</p>

<h2 id="acceleration-profile">Acceleration Profile</h2>

<p>Simply said, pointer acceleration is the function that multiplies the
movement deltas with a given factor:</p>



<p>One of the main role of libinput is to make pointer movement as precise
as possible on all devices. If the user intends and performs action,
the feedback should be that it’s what they expected to do.</p>

<p>An acceleration profile defines a series of points of the form <code>(x, f(x))</code>,
input to output speed, that are linearly interpolated (a curve is drawn
between them for deduction). For example, flat acceleration is 
<code>[(0.0, 0.0), (1.0, 1.0)]</code>.</p>

<p>The default acceleration, adaptive, is pretty smart, and differs per
device type and resolution, it already has these configured for touchpads
for example:</p>

<ul>
  <li>super-slow: deceleration</li>
  <li>slow: deceleration</li>
  <li>medium: adaptive+deceleration</li>
  <li>fast: adaptive+fast</li>
  <li>flick: fast</li>
</ul>

<p>In general, libinput allows to configure this behavior. We can pick
between 3 pointer acceleration profiles: adaptive (default), flat the
45° one we’ve seen, and custom profiles. Along with different types
of motions the profiles can apply to: motion, scroll, fallback. We can
configure points and steps for each one: the points are the x and y
creating the curve of the acceleration profile we talked about, and the
steps is how the interpolation granularity happens between the points
(a value of 0 will use the default).<br>
In most cases, not touching the acceleration profile provides better
results.</p>

<p>In <code>libinput list-devices</code> for a touchpad:</p>

<div><pre><code>Accel profiles:          flat *adaptive custom
</code></pre></div>

<h2 id="gestures">Gestures</h2>

<p>We’ve seen that libinput offers two types of gestures out-of-the-box:
swiping and pinching. For anything else, one has to rely on third party
libraries. Here are a few:</p>

<ul>
  <li><a href="https://github.com/iberianpig/fusuma">fusuma</a></li>
  <li><a href="https://github.com/bulletmark/libinput-gestures">libinput-gestures</a></li>
  <li><a href="https://github.com/Coffee2CodeNL/gebaar-libinput">gebaar-libinput</a></li>
</ul>

<p>YMMV while using them.</p>



<p>Let’s close this section with a few random details that don’t need
much discussion.</p>

<p>High-end gaming mice are finicky and often normal basic drivers are not
enough to configure their high precision, nor is libinput. That’s why the
<a href="https://libratbag.github.io/">libratbag</a> project exists.</p>

<p>The libwacom (not only wacom) and tools such as Tuhi are used to manage
information needed by libinput to handle drawing tablets. These tablets
come with a tool such as a pen/stylus, it’s specificities are handled too.
For example, pressing certain button to reverse the behavior and start
erasing. There are X11 tools such as <code>xsetwacom</code> that also help.</p>

<p>An interesting software is <code>gpm(8)</code> which is a mouse in
the console that relies on reading directly the mouse stream
character device and interfacing/translating them to <code>TIOCLINUX</code>
<code>TIOCL_SELMOUSEREPORT</code>, terminal ioctl, to draw it. The terminal
will then output specific mouse reporting escape codes (more info
<a href="https://man.archlinux.org/man/console_codes.4.en#Mouse_tracking">here</a>).</p>

<p>Finally, here’s a few pointer specific debug tools:</p>

<ul>
  <li><a href="https://github.com/canadaduane/cleartouch">cleartouch</a></li>
  <li><a href="https://github.com/whot/mtview">mtview</a></li>
  <li><a href="https://github.com/bentiss/mtdiag-qt">mtdiag-qt</a></li>
  <li>The <code>libinput debug-gui</code> and <code>libinput debug-tablet</code></li>
</ul>

<h2 id="gamepad-specifics">Gamepad Specifics</h2>

<p>Gamepads aren’t handled by libinput in user-space, nor do they rely on
the evdev handler in the kernel. Instead they rely on the joydev handler.</p>

<p>The gamepads get associated to their specific drivers, which
will consume all these events. The joydev handler then normalizes
and sends them to user-space in a format called <code>js_event</code> from
<code>include/uapi/linux/joystick.h</code>.<br>
The handler will listen to all devices that support <code>EV_KEY</code>
<code>BTN_JOYSTICK</code> or <code>BTN_GAMEPAD</code> and similar events, and create a stream
device in devtmpfs for it <code>/dev/input/jsN</code>.</p>

<p>The handler character device supports a bunch of standard ioctl calls
to get/set info:</p>

<ul>
  <li><code>JSIOCGVERSION</code>: get driver version</li>
  <li><code>JSIOCGAXES</code>: get number of axes</li>
  <li><code>JSIOCGBUTTONS</code>: get number of buttons</li>
  <li><code>JSIOCGNAME(len)</code>: get identifier string</li>
  <li><code>JSIOCSCORR</code>: set correction values</li>
  <li><code>JSIOCGCORR</code>: get correction values</li>
  <li><code>JSIOCSAXMAP</code>: set axis mapping</li>
  <li><code>JSIOCGAXMAP</code>: get axis mapping</li>
  <li><code>JSIOCSBTNMAP</code>: set button mapping</li>
  <li><code>JSIOCGBTNMAP</code>: get button mapping</li>
</ul>

<p>Obviously, it’s better to do this via tools such as:</p>

<ul>
  <li><code>jstest</code> and <code>jstest-gtk</code></li>
  <li><code>jscal</code></li>
  <li><code>joyful</code></li>
</ul>

<h2 id="upper-stack-x11--wayland">Upper Stack: X11 &amp; Wayland</h2>

<p>We’ve reached the graphical environment with desktop widget libraries such
as GNOME and Qt, and the XServer and Wayland Compositors. They’re
the ones that rely on all types of input events for concrete behavior,
from clicking buttons on the appropriate window, drawing a cursor
on screen, scrolling, and literally all interactions a user has with
a computer.<br>
This upper stack relies on libinput and XKB to make everything happen. As
far as these two are concerned, the role of the upper stack is to
initialize them with the right configurations, and then create the
handling for whatever they’re meant to do.</p>

<p>The big difference between the X11 stack and Wayland stack is related to
the protocol and where these libraries are included. There are no window
managers in Wayland, but compositors that fully implement the standard
protocol of both a display server and window manager at the same time. So
it’s not a two-process equation, the compositor is the one handling
libinput and implementing the desktop interface. Meanwhile, in X11, the
Xserver, which is quite old, has the abstract concept of input drivers,
of which the currently only useful one is <code>xf86-input-libinput</code>. The
X11 input are interfaced with through the X11 protocol with XInput
events shared to the WM and other clients so that they can use them,
and configure the server’s input devices. Similarly, in X11 all the
configurations happen over the X protocol and its extensions, meanwhile
for compositors there’s no agreed way to configure things, so each
compositor can implement their own thing.<br>
Here’s a general picture of the stack (<a href="https://who-t.blogspot.com/2014/09/libinput-common-input-stack-for-wayland.html">courtesy of
who-t, Peter Hutterer</a>):</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/xorg-input-stack.png" alt="Xorg Input stack" title="Xorg Input stack"></p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/libinput-input-stack.png" alt="libinput Wayland Compositor Input Stack" title="libinput Wayland Compositor Input Stack"></p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/Libinput_for_Wayland_compositors.png" alt="libinput Wayland Compositor Input Stack 2" title="libinput Wayland Compositor Input Stack 2"></p>

<p>Obviously, each have their own internal representation and ways of managing
the information they get from libinput, XKB, and others, but this is
outside the scope of this article (<code>wl_pointer</code> and <code>wl_keyboard</code> on
Wayland for example). Let’s focus more on how they configure the input
stack we’ve seen.</p>

<p>The X server has an internal store of information about input devices,
and their drivers, and will apply the default settings for each. To
apply specific configurations for certain devices, we can add snippets
in the X11 config directory, usually <code>/usr/share/X11/xorg.conf.d/</code>.
The <code>libinput(4)</code> driver settings can be passed there for a matching
device.</p>

<figure><pre><code data-lang="shell">Section <span>"InputClass"</span>
        Identifier <span>"libinput touchpad catchall"</span>
        MatchIsTouchpad <span>"on"</span>
        MatchDevicePath <span>"/dev/input/event*"</span>
        MatchProduct <span>"substring of the device name"</span>
        Driver <span>"libinput"</span>
        Option <span>"some option name"</span> <span>"the option value"</span>
EndSection</code></pre></figure>

<p>The “Identifier” is just a human-readable string for logging, meanwhile
the series of “Match” statements can be found in <code>xorg.conf(5)</code>, there’s
quite a few of them and they remind us of udev rules. The “Option”
part is what interests us, these are the settings to pass to libinput
and that can be found in <code>libinput(4)</code>. For example:</p>

<figure><pre><code data-lang="shell">Option <span>"AccelSpeed"</span> <span>"float"</span>
Option <span>"ButtonMapping"</span> <span>"string"</span>
Option <span>"DisableWhileTyping"</span> <span>"bool"</span>
Option <span>"ClickMethod"</span> <span>"string"</span>
Option <span>"Tapping"</span> <span>"on"</span></code></pre></figure>

<p>These should all be very familiar by now.</p>

<p>On the X11 stack, the server will initially set these values to override
the default ones, but afterward, during runtime, any caller can rely on
the X protocol to update them. The <code>xinput(1)</code> command can be used to
debug and test setting X input devices.</p>

<p>To list input devices that the X server is aware of:</p>

<div><pre><code>&gt; xinput list
⎡ Virtual core pointer                          id=2    [master pointer  (3)]
⎜   ↳ Virtual core XTEST pointer                id=4    [slave  pointer  (2)]
⎜   ↳ ETPS/2 Elantech Touchpad                  id=15   [slave  pointer  (2)]
⎜   ↳ SEMICO USB Keyboard Consumer Control      id=10   [slave  pointer  (2)]
⎣ Virtual core keyboard                         id=3    [master keyboard (2)]
    ↳ Virtual core XTEST keyboard               id=5    [slave  keyboard (3)]
    ↳ Power Button                              id=6    [slave  keyboard (3)]
    ↳ Video Bus                                 id=7    [slave  keyboard (3)]
    ↳ Power Button                              id=8    [slave  keyboard (3)]
    ↳ Sleep Button                              id=9    [slave  keyboard (3)]
    ↳ AT Translated Set 2 keyboard              id=14   [slave  keyboard (3)]
    ↳ Acer WMI hotkeys                          id=16   [slave  keyboard (3)]
    ↳ GeneralPlus USB Audio Device              id=17   [slave  keyboard (3)]
    ↳ SEMICO USB Keyboard Consumer Control      id=11   [slave  keyboard (3)]
    ↳ SEMICO USB Keyboard System Control        id=12   [slave  keyboard (3)]
    ↳ SEMICO USB Keyboard                       id=13   [slave  keyboard (3)]
</code></pre></div>

<p><em>NB</em>: Keep in mind the XTEST virtual devices, which only exist within
X11 internally and don’t appear in <code>libinput list-devices</code>, we’ll get
back to these in the next section.</p>

<p>Or list the properties of a particular device entry:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xinput list-props 14
Device <span>'AT Translated Set 2 keyboard'</span>:
        Device Enabled <span>(</span>147<span>)</span>:   1
        libinput Rotation Angle <span>(</span>263<span>)</span>:  0.000000
        libinput Rotation Angle Default <span>(</span>264<span>)</span>:  0.000000
        libinput Send Events Modes Available <span>(</span>265<span>)</span>:     1, 0
        libinput Send Events Mode Enabled <span>(</span>266<span>)</span>:        0, 0
        libinput Send Events Mode Enabled Default <span>(</span>267<span>)</span>:        0, 0
        Device Node <span>(</span>268<span>)</span>:      <span>"/dev/input/event4"</span>
        Device Product ID <span>(</span>269<span>)</span>:        1, 1</code></pre></figure>

<p>Or setting particular properties:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xinput set-prop <span>"the device name"</span> <span>"the property name"</span> value <span>[</span>value2]</code></pre></figure>

<p>For example:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xinput set-prop <span>'ETPS/2 Elantech Touchpad'</span> <span>"libinput Tapping Enabled"</span> <span>'1'</span>
<span>&gt;</span> xinput set-prop <span>'ETPS/2 Elantech Touchpad'</span> <span>"libinput Accel Speed"</span> <span>'-0.1'</span></code></pre></figure>

<p>What happens here is that the client (<code>xinput</code>) talks to the X server
over the X protocol, then the X server talks to its libinput driver
<code>xf86-input-libinput</code> which in turn talks to libinput and updates its
configurations, and the X server keeps track of all this.</p>

<p>These all look somewhat redundant, as you can see, it’s like having an
intermediate layer. That’s why on Wayland there’s no intermediary, if
a client tells it, through whatever configuration means it exposes, to
set certain settings on an input device, it does it directly via libinput.<br>
Yet, the list of input devices is internal to Wayland, and not exposed
directly in the protocol, that’s why it differs in each compositor
implementation.</p>

<p>For instance, if we’re toggling a setting in GNOME, KDE, MATE, or others,
the behavior will be more direct. In GNOME, things happen through
<code>gsettings</code>:</p>

<div><pre><code>&gt; gsettings list-keys  org.gnome.desktop.peripherals.
org.gnome.desktop.peripherals.keyboard
org.gnome.desktop.peripherals.mouse
org.gnome.desktop.peripherals.trackball
org.gnome.desktop.peripherals.pointingstick
org.gnome.desktop.peripherals.touchpad
…
&gt; gsettings list-keys  org.gnome.desktop.peripherals.mouse
accel-profile
double-click
drag-threshold
left-handed
middle-click-emulation
natural-scroll
speed
&gt; gsettings get org.gnome.desktop.peripherals.mouse accel-profile
'default'
</code></pre></div>

<p>So that’s how you’d configure input devices on GNOME Wayland compositor
Mutter. Yet that’s annoying, isn’t there a common way to do this on
Wayland?<br>
There are workarounds such as
<a href="https://github.com/lz42/libinput-config">libinput-config</a> but it’s not
very well maintained.</p>

<p>So, clients in graphical environments need to get input events to
them. On X11 these are called X events, and they can be spied on with the
<code>xev(1)</code> tool, which can help debug issues. It shows events sent to the
particular window chosen.<br>
In theory on X11 one could catch all events on the “root window” is
subscribed to (<code>xev -root</code> does that) or of any other window. Events
conceptually travel down the window hierarchy, and clients only
receive the events for which they have selected an appropriate event
mask. However, the root window always sits at the top of this hierarchy
and can optionally subscribe to essentially all events before they
propagate to child windows, while grabs and higher-priority selections
(such as by the window manager) can intercept or redirect them. That’s
how WMs work, they’re the parent window and have an “event mask” to
catch certain events and input for itself, and is exclusively allowed
to do redirect of certain events such as mapping/moving/configuring
windows.<br>
Meanwhile, a sort of equivalent, but more simple, tool on Wayland is
called <a href="https://github.com/jwrdegoede/wev">wev</a>, we’ll do the comparison
in a bit to help us understand the differences. Here’s a trace of <code>xev</code></p>

<figure><pre><code data-lang="shell"><span>&gt;</span> xev <span>-event</span> keyboard
KeyRelease event, serial 28, synthetic NO, window 0x2e00001,
    root 0x3fa, subw 0x0, <span>time </span>465318306, <span>(</span>81,81<span>)</span>, root:<span>(</span>893,376<span>)</span>,
    state 0x10, keycode 108 <span>(</span>keysym 0xff20, Multi_key<span>)</span>, same_screen YES,
    XLookupString gives 0 bytes: 
    XFilterEvent returns: False
…
KeyRelease event, serial 28, synthetic NO, window 0x2e00001,
    root 0x3fa, subw 0x0, <span>time </span>465318602, <span>(</span>81,81<span>)</span>, root:<span>(</span>893,376<span>)</span>,
    state 0x10, keycode 48 <span>(</span>keysym 0x27, apostrophe<span>)</span>, same_screen YES,
    XLookupString gives 1 bytes: <span>(</span>27<span>)</span> <span>"'"</span>
    XFilterEvent returns: False
KeyPress event, serial 28, synthetic NO, window 0x2e00001,
    root 0x3fa, subw 0x0, <span>time </span>465318866, <span>(</span>81,81<span>)</span>, root:<span>(</span>893,376<span>)</span>,
    state 0x10, keycode 26 <span>(</span>keysym 0x65, e<span>)</span>, same_screen YES,
    XLookupString gives 1 bytes: <span>(</span>65<span>)</span> <span>"e"</span>
    XmbLookupString gives 1 bytes: <span>(</span>65<span>)</span> <span>"e"</span>
    XFilterEvent returns: True
KeyPress event, serial 28, synthetic NO, window 0x2e00001,
    root 0x3fa, subw 0x0, <span>time </span>465318866, <span>(</span>81,81<span>)</span>, root:<span>(</span>893,376<span>)</span>,
    state 0x10, keycode 0 <span>(</span>keysym 0xe9, eacute<span>)</span>, same_screen YES,
    XLookupString gives 0 bytes: 
    XmbLookupString gives 2 bytes: <span>(</span>c3 a9<span>)</span> <span>"é"</span>
    XFilterEvent returns: False</code></pre></figure>

<p>As you can observe here, The Xlib client does a lookup for keycode to
keysym translation by relying on functions such as <code>XLookupString</code> and
<code>XmbLookupString</code>. These particular functions use a keymap logic that
dates back to pre-XKB time, we’ll talk more about them in a bit. Yet,
internally now, the X server does rely on XKB in the backend, just like
for input device info, it keeps a keymap table internally, and it’s
shared over the X protocol with clients (they ask for it at connection,
or lazily when calling functions, and cache it) so that they perform
the translation with Xlib or XCB.<br>
There are two main formats for the shared X server keymap the clients
can rely on: the old “X core keymap”, and an XKB keymap. We’ll discuss
that old core keymap in a bit.<br>
In XCB, the old keymap translation is done via:</p>
<ul>
  <li><code>xcb_key_symbols_get_keycode</code></li>
  <li><code>xcb_key_symbols_get_keysym</code></li>
</ul>

<p>And in Xlib with functions such as:</p>

<ul>
  <li><code>XLookupString</code></li>
  <li><code>Xutf8LookupString</code></li>
  <li><code>XLookupKeysym</code></li>
  <li><code>XkbTranslateKeyCode</code></li>
  <li><code>XkbTranslateKeySym</code></li>
  <li><code>XStringToKeysym</code></li>
  <li><code>XKeysymToKeycode</code></li>
</ul>

<p>Meanwhile, with the newer XKB keymap it’s done via:</p>
<ul>
  <li><code>XkbTranslateKeyCode</code></li>
</ul>

<p>Or in XCB with the <code>xcb_xkb_*</code> functions (you have to do it manually).</p>

<p>In all cases, since XKB is the tech in the backend of the X server
that stores the keymap truth, it’s what needs to be configured. The XKB
configuration can be set statically, along with the usual input confs
we’ve seen earlier, with the Xkb options:</p>

<figure><pre><code data-lang="shell">Section <span>"InputClass"</span>
        Identifier <span>"system-keyboard"</span>
        MatchIsKeyboard <span>"on"</span>
        Option <span>"XkbLayout"</span> <span>"us"</span>
        Option <span>"XkbModel"</span> <span>"pc104"</span>
        Option <span>"XkbVariant"</span> <span>"dvorak"</span>
        Option <span>"XkbOptions"</span> <span>"terminate:ctrl_alt_bksp"</span>
EndSection</code></pre></figure>

<p>There are also two special options that get interpreted when certain
special keysym are generated, the <code>DontVTSwitch</code> which is there to disable
the <code>ctrl+alt+fn</code> sequence to switch virtual terminal, and the <code>DontZap</code>
which catches the <code>Terminate_Server</code> keysym of XKB and will kill the Xorg
server. Both are enabled by default and these options would turn them off.</p>

<p>To change the XKB options on a running X server on-the-fly, we need to
rely on two tools: <code>xkbcomp(1)</code> and <code>setxkbmap(1)</code>. The first one is
used to compile new KcCGST and upload it to the server as a full keymap
in XKM compiled format that the server understands, and the second one
to change the current value of the RMLVO.</p>

<div><pre><code>$ setxkbmap -model thinkpad60 -layout us,sk,de -variant altgr-intl,qwerty \
       -option -option grp:menu_toggle -option grp_led:caps -print
</code></pre></div>

<p>We can get the same info as with <code>xkbcli</code> too:</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> setxkbmap <span>-print</span> <span>-verbose</span> 10
Setting verbose level to 10
locale is C
Trying to load rules file ./rules/evdev...
Trying to load rules file /usr/share/X11/xkb/rules/evdev...
Success.
Applied rules from evdev:
rules:      evdev
model:      pc105
layout:     us
options:    compose:ralt
Trying to build keymap using the following components:
keycodes:   evdev+aliases<span>(</span>qwerty<span>)</span>
types:      <span>complete
</span>compat:     <span>complete
</span>symbols:    pc+us+inet<span>(</span>evdev<span>)</span>+compose<span>(</span>ralt<span>)</span>
geometry:   pc<span>(</span>pc105<span>)</span>
xkb_keymap <span>{</span>
        xkb_keycodes  <span>{</span> include <span>"evdev+aliases(qwerty)"</span> <span>}</span><span>;</span>
        xkb_types     <span>{</span> include <span>"complete"</span>      <span>}</span><span>;</span>
        xkb_compat    <span>{</span> include <span>"complete"</span>      <span>}</span><span>;</span>
        xkb_symbols   <span>{</span> include <span>"pc+us+inet(evdev)+compose(ralt)"</span>       <span>}</span><span>;</span>
        xkb_geometry  <span>{</span> include <span>"pc(pc105)"</span>     <span>}</span><span>;</span>
<span>}</span><span>;</span></code></pre></figure>

<p>Now let’s talk about that pre-XKB logic with functions such as
<code>XLookupKeysym(3)</code> we’ve seen in the <code>xev</code> trace earlier. It’s currently
basically a wrapper over XKB, but that can also bypass it entirely. It
relies on the old “X core keymap table” in the X server, a facade on
the authoritative keymap that is XKB backed. The client asks for it
via a request, cache it, and use it for the mapping of X11 keycode
to X11 keysym. It’s own X11 keycodes are implementation dependent,
but nowadays it’s mostly <code>evdev + 8</code>, and its keysyms are found in
<code>/usr/include/X11/keysymdef.h</code>, which the newer XKB stack also relies
on in X11. So that old keymap is indeed initially filled with the XKB
keymap. The tool <code>xmodmap(1)</code> will help us explore and show some of the
things it handles.</p>

<p>To print its internal keymap table:</p>

<div><pre><code>&gt; xmodmap -pk
There are 7 KeySyms per KeyCode; KeyCodes range from 8 to 255.

    KeyCode Keysym (Keysym)   ...
    Value   Value   (Name)    ...

      8
      9     0xff1b (Escape)   0x0000 (NoSymbol) 0xff1b (Escape)
     10     0x0031 (1)  0x0021 (exclam)   0x0031 (1)  0x0021 (exclam)
     11     0x0032 (2)  0x0040 (at) 0x0032 (2)  0x0040 (at)
     12     0x0033 (3)  0x0023 (numbersign)  0x0033 (3)  0x0023 (numbersign)
     13     0x0034 (4)  0x0024 (dollar)   0x0034 (4)  0x0024 (dollar)
     14     0x0035 (5)  0x0025 (percent)  0x0035 (5)  0x0025 (percent)
     15     0x0036 (6)  0x005e (asciicircum) 0x0036 (6)  0x005e (asciicircum)
     16     0x0037 (7)  0x0026 (ampersand)   0x0037 (7)  0x0026 (ampersand)
     17     0x0038 (8)  0x002a (asterisk) 0x0038 (8)  0x002a (asterisk)
</code></pre></div>

<p>And print the modifiers:</p>

<div><pre><code>&gt; xmodmap -pm
xmodmap:  up to 3 keys per modifier, (keycodes in parentheses):

shift       Shift_L (0x32),  Shift_R (0x3e)
lock        Caps_Lock (0x42)
control     Control_L (0x25),  Control_R (0x69)
mod1        Alt_L (0x40),  Alt_L (0xcc),  Meta_L (0xcd)
mod2        Num_Lock (0x4d)
mod3        ISO_Level5_Shift (0xcb)
mod4        Super_L (0x85),  Super_R (0x86),  Super_L (0xce)
mod5        ISO_Level3_Shift (0x5c)
</code></pre></div>

<p>Or print the keymap as “expressions”:</p>

<figure><pre><code data-lang="shell">keycode   8 <span>=</span>
keycode   9 <span>=</span> Escape NoSymbol Escape
keycode  10 <span>=</span> 1 exclam 1 exclam
keycode  11 <span>=</span> 2 at 2 at
keycode  12 <span>=</span> 3 numbersign 3 numbersign
keycode  13 <span>=</span> 4 dollar 4 dollar
keycode  14 <span>=</span> 5 percent 5 percent
keycode  15 <span>=</span> 6 asciicircum 6 asciicircum
keycode  16 <span>=</span> 7 ampersand 7 ampersand
keycode  17 <span>=</span> 8 asterisk 8 asterisk</code></pre></figure>

<p>Yes, <code>xmodmap</code> has its own configuration in <code>~/.Xmodmap</code> and expression
grammar that looks something like a simplified version of XKB:</p>

<div><pre><code>! remove Caps Lock functionality
remove Lock = Caps_Lock

! make CapsLock (keycode 66) act as Tab
keycode 66 = Tab

! set Menu key (keycode 134) properly
keycode 134 = Menu

! Set Right Alt as Compose (Multi_key)
! Use keysym form so you don't need to know the numeric keycode:
keycode 108 = Multi_key

! ensure Right Alt is not still treated as an Alt modifier
remove Mod1 = Alt_R
</code></pre></div>

<p>Or on-the-fly with:</p>

<figure><pre><code data-lang="shell">xmodmap <span>-e</span> <span>"remove Lock = Caps_Lock"</span>
xmodmap <span>-e</span> <span>"keycode 66 = Tab"</span>
xmodmap <span>-e</span> <span>"keycode 134 = Menu"</span></code></pre></figure>

<p>There’s even the <code>xkeycaps</code> GUI around it, and wrappers like
<a href="https://github.com/alols/xcape"><code>xcape</code></a>.</p>

<p>Yet, GNOME and certain other toolkits and desktop environments
have stopped relying on the old core keymap a long time ago,
deprecating it in favor of the XKB related functions. Still, the
X server will internally reflect these changes in its XKB cache,
making them internally compatible, notifying X clients of teh
change, and it’ll work but temporarily
(mainly with <code>XChangeKeyboardMapping</code> which calls
<a href="https://gitlab.freedesktop.org/xorg/xserver/-/blob/master/xkb/xkbUtils.c#L549"><code>XkbApplyMappingChange</code></a>
in the X Server). It’s fragile and legacy. Also, changing the keymap with
<code>xmodmap</code> is flimsy since any time the XKB keymap is reloading the changes
to the old in-memory X keymap compatibility is lost. Those combined
together means that it isn’t reliable to use the old X11 core keymap.</p>

<p>As you can see yet again, this is quite confusing and redundant, and
obviously Wayland doesn’t have these old layers of indirection and
relies on XKB directly. It also doesn’t need a compiled forms like XKM
to upload keymaps to the server, but it doesn’t even include that upload
part in the protocol anyhow. The keycode to keysym translation is also
done in the client (with calls such as <code>xkb_state_key_get_one_sym</code>)
but the keymap is directly shared along the <code>wl_keyboard</code> object that
it gets accessed to when it wants input access on the seat, so there’s
no need for another round-trip.</p>

<p>Yet, again the configuration of XKB-related stuff on Wayland depends on
the compositor implementation.</p>

<p>For example
<a href="https://github.com/swaywm/wlroots/blob/4984ea49eeaa292d66be9e535d93a4d8185f3e18/examples/simple.c#L113">wlroots</a>
relies on environment variables to set the RMLVO.<br>
GNOME on <code>gsettings</code> with</p>
<div><pre><code>gsettings set org.gnome.desktop.input-sources sources "[('xkb', 'us'), ('xkb', 'fr')]"
</code></pre></div>
<p>Hyprland has</p>
<div><pre><code>hyprctl keyword input:kb_layout "us,fr"
</code></pre></div>
<p>And etc…</p>

<figure><pre><code data-lang="shell"><span>&gt;</span> gsettings list-recursively org.gnome.desktop.input-sources
org.gnome.desktop.input-sources current uint32 0
org.gnome.desktop.input-sources mru-sources @a<span>(</span>ss<span>)</span> <span>[]</span>
org.gnome.desktop.input-sources per-window <span>false
</span>org.gnome.desktop.input-sources show-all-sources <span>false
</span>org.gnome.desktop.input-sources sources <span>[(</span><span>'xkb'</span>, <span>'us'</span><span>)]</span>
org.gnome.desktop.input-sources xkb-model <span>'pc105+inet'</span>
org.gnome.desktop.input-sources xkb-options <span>[</span><span>'compose:ralt'</span><span>]</span></code></pre></figure>

<p>Let’s go back to the
<a href="https://github.com/jwrdegoede/wev/blob/master/wev.c"><code>wev</code></a> tool,
which displays input events on Wayland, it’ll help us understand a
huge difference in input handling on Wayland compared to X11. Unlike X
severs, a Wayland compositor doesn’t propagate and broadcast the events
globally to anyone listening. Instead, clients must explicitly register
a listener for the objects they care about. These are announced via the
global Wayland registry, which it has to register to (<code>wl_registry</code>).<br>
Afterward, a client has to bind and listen to the given seat (<code>wl_seat</code>)
of the given name by the registry (this is where the <code>ENV{ID_SEAT}</code> and
<code>loginctl</code> can help since they often map 1-to-1), and advertise the set of
“seat capabilities” it requires and wants to bind to, such as pointer,
keyboard, or touch. Once bound, the client can now fetch a handle to the
<code>wl_&lt;pointer/keyboard/touch&gt;</code> objects, and register listener handlers
for their events. Let’s note that a <code>wl_keyboard</code> is an abstraction
of all logical keyboard events. So clients aren’t aware of underlying
devices, it’s abstracted and aggregated in the compositor internally,
by its own logic. Plus, for extra security, <code>wl_&lt;pointer/keyboard/touch&gt;</code>
events are only forwarded to the currently focused client. All and all,
it’s very choreographed, unlike in X11.</p>

<p>Beyond the core protocol, there are more “unstable”
or “non-standard” extensions that allow clients to do
more things related to input. Here’s a non-exhaustive
<a href="https://wayland.app/protocols/pointer-constraints-unstable-v1">list</a>:</p>

<ul>
  <li>Repositioning the pointer (<code>wp_pointer_warp_v1</code>)</li>
  <li>Subscribing to high-def keyboard timestamps (<code>zwp_input_timestamps_manager_v1</code>)</li>
  <li>Ignoring keyboard shortcuts from a client (<code>zwp_keyboard_shortcuts_inhibit_manager_v1</code>)</li>
  <li>Adding constraints to pointer motion (<code>zwp_pointer_constraints_v1</code>)</li>
  <li>Register to handle gestures, swipe, pinch, and hold (<code>zwp_pointer_gestures_v1</code>)</li>
  <li>Specific XWayland grabbing of input, monopolizing it (<code>zwp_xwayland_keyboard_grab_manager_v1</code>)</li>
  <li>Grab hotkeys, usually not needed since the compositor do this (<code>hyprland_global_shortcuts_manager_v1</code>)</li>
  <li>Grab/Inhibit an input to a single surface such as lock screen (<code>zwlr_input_inhibit_manager_v1</code>, <code>hyprland_focus_grab_manager_v1</code>)</li>
  <li>Create virtual pointer/keyboard, fake input (<code>zwlr_virtual_pointer_manager_v1</code>, <code>org_kde_kwin_fake_input</code>, <code>zwp_virtual_keyboard_v1</code>)</li>
</ul>

<p>Notice too that nowhere in the protocol is there any interface
to list the compositor’s internal input devices in its registry,
it’s intentionally abstracted away. It’s up to each compositor
to choose if it wants to expose this info. To my knowledge,
there’s only Sway that offers an interface for this through
<a href="https://man.archlinux.org/man/sway-input.5">swaymsg</a>, it’s kind of
similar to <code>gsettings</code>.</p>



<p>The closest compositor-agnostic tools are external utilities such
as <code>libinput list-devices</code> or <code>loginctl seat-status</code>. However, these
enumerate kernel devices, not the compositor’s internal virtual devices,
so you will not see compositor-created synthetic devices there.</p>

<p>In short, which compositor implements which part of the “non-standard”
protocol varies a lot. GNOME uses almost none of the wlroots/WLR
extensions. KDE uses KDE-specific extensions. wlroots-based
compositors share WLR extensions. It’s a mix really, check
<a href="https://wayland.app/protocols/">this</a> for support and more info.</p>

<p>We mentioned before <code>localectl</code> too for setting keyboard keymap
setups that works across environments. Let’s add that when using
the <code>set-x11-keymap</code> option it will modify X11 configurations in
<code>/etc/X11/xorg.conf.d/00-keyboard.conf</code> and pre-fill them for you so
you won’t have to worry about editing anything with the options we’ve
listed. It doesn’t have this option for Wayland though.</p>

<div><pre><code>&gt; localectl [--no-convert] set-x11-keymap layout [model [variant [options]]]
</code></pre></div>

<p>Yet, what if someone on Wayland wants to remap just a specific
key without passing by the static XKB and its mess, just a
quick runtime change. There’s no real solution to that other
than what we’ve already mentioned in the scancode to keycode
section, namely tools that rely on evdev interception to remap events
such as <code>evmapd</code>, <code>evremap</code>, <code>evdevremapkeys</code>, <code>evsieve</code>,
<a href="https://github.com/rvaiya/keyd"><code>keyd</code></a> , <code>kbct</code>, <code>makima</code>,
<a href="https://github.com/sezanzeb/input-remapper/"><code>input-remapper</code></a>,
etc.. A true panoply of tools that are hacks. Most, if not all, of
these  work by intercepting evdev events, creating a new virtual device
(we’ll see how <code>uinput</code> works in the next section), and modifying the
events on-the-fly to write them to the virtual device. This adds a new
unnecessary layer of indirection, which you should obviously avoid if
you are doing anything speed sensitive with the keyboard. Furthermore,
some of these re-include the key composition and a semblance of XKB
logic within them, which creates a total mess.<br>
Let’s continue…</p>

<p>Contrary to everything else in the GUI stack, XKB composition is a
bit less cumbersome. Both Wayland clients, through their toolkits
(GTK, Qt, etc..) and X11, through Xlib with the functions we’ve seen
earlier that do it out-of-the-box (<code>XLookupString</code>), rely on the
same configuration files we’ve discussed in the XKB section. Namely,
<code>/usr/share/X11/locale/&lt;locale&gt;/Compose</code> and the home <code>~/.XCompose</code>. It
follows the simple format described in <code>Compose(5)</code>.</p>

<p>And lastly, one thing that isn’t handled neither in libinput nor XKB is
key repeat: how long when pressing a key will the client wait to print
it again.</p>

<p>In X11 this is configured in the X Server, either as a startup option
<code>-ardelay</code> and <code>-arinterval</code>, or dynamically via <code>xset(1)</code>. There’s the
option to set the delay and interval for a specific key too.</p>

<div><pre><code>&gt; xset r rate delay [rate]
&gt; xset r rate 210 50
</code></pre></div>

<p>If you inspect <code>xev</code> you’ll see that the server resends keys to the
client continuously.</p>

<p>Meanwhile, as with everything else on Wayland, it depends on the
compositor. The compositor sends to the clients the repeat parameters
<code>wl_keyboard.repeat_info(rate, delay)</code> and it’s up to them to respect
it. So, the compositor doesn’t keep forwarding the key to the client but
instead this is handled directly in the client.<br>
And similarly, these are configured in <code>gsettings</code> and other
compositor-specific configurations.</p>

<p>The repeat key rate and delay being delegated to
clients on Wayland has had its share of issues it created though
(<a href="https://www.csslayer.info/wordpress/linux/key-repetition-and-key-event-handling-issue-with-wayland-input-method-protocols/">see</a>)
and some people want to have it <a href="https://gitlab.freedesktop.org/wayland/wayland/-/merge_requests/368">back in the
compositor</a>.</p>

<p>That’s it, we’ve covered most of the things we wanted in the upper
graphical stack.</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/de_upper_stack.png" alt="DE/Upper Stack Overview" title="DE/Upper Stack Overview"></p>

<h2 id="virtual-input-automation-emulation-and-remote-desktop">Virtual Input, Automation, Emulation, and Remote Desktop</h2>

<p>We’ve grazed the topic of virtual inputs before, in this section we’ll
see what types exist and where they’re used, from automation, emulation,
and remote desktop.</p>

<p>The first layer where we can create virtual input devices is at the
kernel layer. It provides two modules that can be used for this:
<code>UHID</code>, User-space I/O driver support for HID subsystem, and uinput,
the User-space input emulation module.</p>

<p>The <a href="https://docs.kernel.org/5.10/hid/uhid.html">uhid module</a>,
as the name implies, allows simulating HID events from user-space
by reading/writing to a special character device in devtmpfs
<code>/dev/uhid</code>. The interface is quite simple as is shown in <a href="https://github.com/torvalds/linux/blob/master/samples/uhid/uhid-example.c">this
example</a>.
However, this is only used for emulating devices and debugging, not for
the average user’s virtual input. This is the underlying mechanism behind
<code>hid-record</code> and <code>hid-replay</code>, which can easily allow debugging hid
issues by reproducing the exact sequences of events on anyone’s machine.</p>

<p>While uhid acts in the HID layer, the uinput module
(<code>drivers/input/misc/uinput.c</code>) acts at the input core layer, which
makes it more approachable for basic input event virtualisation.<br>
It is also a character device in devtmpfs <code>/dev/uinput</code> that exposes
particular ioctl to create, manage, and configure capabilities of a
virtual device, and then allow writing to <code>/dev/uinput</code> file descriptor
to simulate the events of said device. The device will appear, like any
other input device, in devtmpfs and sysfs, since it’ll pass by the same
pipeline with <code>struct input_dev</code> and the default evdev event handler.</p>

<p>There are two main ways to use uinput in the code, via <code>&lt;linux/uinput.h&gt;</code>
or via <code>&lt;libevdev/libevdev-uinput.h&gt;</code>. The libevdev mechanism is simpler
and recommended.</p>

<p>Example 1:</p>

<figure><pre><code data-lang="c"><span>#include</span> <span>&lt;unistd.h&gt;</span><span>
#include</span> <span>&lt;linux/uinput.h&gt;</span><span>
#include</span> <span>&lt;fcntl.h&gt;</span><span>
#include</span> <span>&lt;string.h&gt;</span><span>
#include</span> <span>&lt;stdio.h&gt;</span><span>
#include</span> <span>&lt;errno.h&gt;</span><span>
#include</span> <span>&lt;linux/uinput.h&gt;</span><span>
</span>
<span>void</span> <span>emit</span><span>(</span><span>int</span> <span>fd</span><span>,</span> <span>int</span> <span>type</span><span>,</span> <span>int</span> <span>code</span><span>,</span> <span>int</span> <span>val</span><span>)</span>
<span>{</span>
   <span>struct</span> <span>input_event</span> <span>ie</span><span>;</span>

   <span>ie</span><span>.</span><span>type</span> <span>=</span> <span>type</span><span>;</span>
   <span>ie</span><span>.</span><span>code</span> <span>=</span> <span>code</span><span>;</span>
   <span>ie</span><span>.</span><span>value</span> <span>=</span> <span>val</span><span>;</span>
   <span>/* timestamp values below are ignored */</span>
   <span>ie</span><span>.</span><span>time</span><span>.</span><span>tv_sec</span> <span>=</span> <span>0</span><span>;</span>
   <span>ie</span><span>.</span><span>time</span><span>.</span><span>tv_usec</span> <span>=</span> <span>0</span><span>;</span>

   <span>write</span><span>(</span><span>fd</span><span>,</span> <span>&amp;</span><span>ie</span><span>,</span> <span>sizeof</span><span>(</span><span>ie</span><span>));</span>
<span>}</span>

<span>int</span> <span>main</span><span>(</span><span>void</span><span>)</span>
<span>{</span>
   <span>struct</span> <span>uinput_setup</span> <span>usetup</span><span>;</span>

   <span>int</span> <span>fd</span> <span>=</span> <span>open</span><span>(</span><span>"/dev/uinput"</span><span>,</span> <span>O_WRONLY</span> <span>|</span> <span>O_NONBLOCK</span><span>);</span>


   <span>/*
    * The ioctls below will enable the device that is about to be
    * created, to pass key events, in this case the space key.
    */</span>
   <span>ioctl</span><span>(</span><span>fd</span><span>,</span> <span>UI_SET_EVBIT</span><span>,</span> <span>EV_KEY</span><span>);</span>
   <span>ioctl</span><span>(</span><span>fd</span><span>,</span> <span>UI_SET_KEYBIT</span><span>,</span> <span>KEY_SPACE</span><span>);</span>

   <span>memset</span><span>(</span><span>&amp;</span><span>usetup</span><span>,</span> <span>0</span><span>,</span> <span>sizeof</span><span>(</span><span>usetup</span><span>));</span>
   <span>usetup</span><span>.</span><span>id</span><span>.</span><span>bustype</span> <span>=</span> <span>BUS_USB</span><span>;</span>
   <span>usetup</span><span>.</span><span>id</span><span>.</span><span>vendor</span> <span>=</span> <span>0x1234</span><span>;</span> <span>/* sample vendor */</span>
   <span>usetup</span><span>.</span><span>id</span><span>.</span><span>product</span> <span>=</span> <span>0x5678</span><span>;</span> <span>/* sample product */</span>
   <span>strcpy</span><span>(</span><span>usetup</span><span>.</span><span>name</span><span>,</span> <span>"Example device"</span><span>);</span>

   <span>ioctl</span><span>(</span><span>fd</span><span>,</span> <span>UI_DEV_SETUP</span><span>,</span> <span>&amp;</span><span>usetup</span><span>);</span>
   <span>ioctl</span><span>(</span><span>fd</span><span>,</span> <span>UI_DEV_CREATE</span><span>);</span>

   <span>/*
    * On UI_DEV_CREATE the kernel will create the device node for this
    * device. We are inserting a pause here so that user-space has time
    * to detect, initialize the new device, and can start listening to
    * the event, otherwise it will not notice the event we are about
    * to send. This pause is only needed in our example code!
    */</span>
   <span>sleep</span><span>(</span><span>60</span><span>);</span>

   <span>/* Key press, report the event, send key release, and report again */</span>
   <span>emit</span><span>(</span><span>fd</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>KEY_SPACE</span><span>,</span> <span>1</span><span>);</span>
   <span>emit</span><span>(</span><span>fd</span><span>,</span> <span>EV_SYN</span><span>,</span> <span>SYN_REPORT</span><span>,</span> <span>0</span><span>);</span>
   <span>emit</span><span>(</span><span>fd</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>KEY_SPACE</span><span>,</span> <span>0</span><span>);</span>
   <span>emit</span><span>(</span><span>fd</span><span>,</span> <span>EV_SYN</span><span>,</span> <span>SYN_REPORT</span><span>,</span> <span>0</span><span>);</span>

   <span>/*
    * Give user-space some time to read the events before we destroy the
    * device with UI_DEV_DESTROY.
    */</span>
   <span>sleep</span><span>(</span><span>100</span><span>);</span>

   <span>ioctl</span><span>(</span><span>fd</span><span>,</span> <span>UI_DEV_DESTROY</span><span>);</span>
   <span>close</span><span>(</span><span>fd</span><span>);</span>

   <span>return</span> <span>0</span><span>;</span>
<span>}</span></code></pre></figure>

<p>Compile with</p>

<div><pre><code>gcc -o uinput_test uinput_test.c -Wall -Wextra
</code></pre></div>

<p>And example 2 with libevdev:</p>

<figure><pre><code data-lang="c"><span>#include</span> <span>&lt;libevdev/libevdev.h&gt;</span><span>
#include</span> <span>&lt;libevdev/libevdev-uinput.h&gt;</span><span>
#include</span> <span>&lt;unistd.h&gt;</span><span>
#include</span> <span>&lt;stdio.h&gt;</span><span>
#include</span> <span>&lt;string.h&gt;</span><span>
#include</span> <span>&lt;errno.h&gt;</span><span>
</span>
<span>int</span> <span>main</span><span>(</span><span>void</span><span>)</span>
<span>{</span>
    <span>struct</span> <span>libevdev</span> <span>*</span><span>dev</span> <span>=</span> <span>NULL</span><span>;</span>
    <span>struct</span> <span>libevdev_uinput</span> <span>*</span><span>uidev</span> <span>=</span> <span>NULL</span><span>;</span>
    <span>int</span> <span>err</span><span>;</span>

    <span>/* Allocate and configure the virtual device */</span>
    <span>dev</span> <span>=</span> <span>libevdev_new</span><span>();</span>
    <span>if</span> <span>(</span><span>!</span><span>dev</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"Failed to allocate libevdev device</span><span>\n</span><span>"</span><span>);</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>

    <span>libevdev_set_name</span><span>(</span><span>dev</span><span>,</span> <span>"Example device (libevdev uinput)"</span><span>);</span>
    <span>libevdev_set_id_bustype</span><span>(</span><span>dev</span><span>,</span> <span>BUS_USB</span><span>);</span>
    <span>libevdev_set_id_vendor</span><span>(</span><span>dev</span><span>,</span> <span>0x1234</span><span>);</span>
    <span>libevdev_set_id_product</span><span>(</span><span>dev</span><span>,</span> <span>0x5678</span><span>);</span>

    <span>/* Enable only one key: KEY_SPACE */</span>
    <span>libevdev_enable_event_type</span><span>(</span><span>dev</span><span>,</span> <span>EV_KEY</span><span>);</span>
    <span>libevdev_enable_event_code</span><span>(</span><span>dev</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>KEY_SPACE</span><span>,</span> <span>NULL</span><span>);</span>

    <span>/* Create the uinput device */</span>
    <span>err</span> <span>=</span> <span>libevdev_uinput_create_from_device</span><span>(</span><span>dev</span><span>,</span> <span>LIBEVDEV_UINPUT_OPEN_MANAGED</span><span>,</span> <span>&amp;</span><span>uidev</span><span>);</span>
    <span>if</span> <span>(</span><span>err</span> <span>!=</span> <span>0</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"Failed to create uinput device: %s</span><span>\n</span><span>"</span><span>,</span> <span>strerror</span><span>(</span><span>-</span><span>err</span><span>));</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>

    <span>/* A pause to allow the system (udev etc.) to register the device */</span>
    <span>sleep</span><span>(</span><span>100</span><span>);</span>

    <span>/* Emit a space key press */</span>
    <span>libevdev_uinput_write_event</span><span>(</span><span>uidev</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>KEY_SPACE</span><span>,</span> <span>1</span><span>);</span>
    <span>libevdev_uinput_write_event</span><span>(</span><span>uidev</span><span>,</span> <span>EV_SYN</span><span>,</span> <span>SYN_REPORT</span><span>,</span> <span>0</span><span>);</span>

    <span>/* Emit the key release */</span>
    <span>libevdev_uinput_write_event</span><span>(</span><span>uidev</span><span>,</span> <span>EV_KEY</span><span>,</span> <span>KEY_SPACE</span><span>,</span> <span>0</span><span>);</span>
    <span>libevdev_uinput_write_event</span><span>(</span><span>uidev</span><span>,</span> <span>EV_SYN</span><span>,</span> <span>SYN_REPORT</span><span>,</span> <span>0</span><span>);</span>

    <span>/* Let user-space read the events before destruction (optional) */</span>
    <span>sleep</span><span>(</span><span>200</span><span>);</span>

    <span>libevdev_uinput_destroy</span><span>(</span><span>uidev</span><span>);</span>
    <span>libevdev_free</span><span>(</span><span>dev</span><span>);</span>

    <span>return</span> <span>0</span><span>;</span>
<span>}</span></code></pre></figure>

<p>Compile with</p>

<div><pre><code>gcc $(pkg-config --cflags --libs libevdev) -o libevdev_example example.c
</code></pre></div>

<p>The disadvantage of uhid and uinput is that, since they interface with
the kernel, they require root privilege and relying on HID or evdev might
not be practical for the average day-to-day usage. For example, if we
want to output a symbol, let’s say ‘p’, we have to know its keycode, and
for that we need to know the keymapping, which in turn requires XKB or
others. Thus, we’re back to square one and re-creating the upper input
stack from scratch.</p>

<p>What if we could directly say “send this keycode or keysym, it’s from this
virtual device”, without even needing extra permission if we’re already in
a desktop environment. Well, that’s exactly what the X11 XTEST extension
does, and what some Wayland extensions and mechanisms achieve too.</p>

<p>Remember when we used xinput to list some devices and some virtual ones
were listed:</p>

<div><pre><code>&gt; xinput list
Virtual core pointer                          id=2    [master pointer  (3)]
⎜   ↳ Virtual core XTEST pointer                id=4    [slave  pointer  (2)]
…
Virtual core keyboard                         id=3    [master keyboard (2)]
    ↳ Virtual core XTEST keyboard               id=5    [slave  keyboard (3)]
…
</code></pre></div>

<p>These were created by the XTest extension which was written to support
automated testing of X server. These days this can be used for remote
desktop, task automation, password managers (autofill), and others. When
clients interface through this extension they directly inject keyboard
and mouse events into the X server, bypassing the whole input stack,
and these events are propagated afterward to the X clients.<br>
Let’s see a simple programming example relying on <code>XTEST(3)</code> that will
send the keysym “a”:</p>

<figure><pre><code data-lang="c"><span>#include</span> <span>&lt;X11/Xlib.h&gt;</span><span>
#include</span> <span>&lt;X11/extensions/XTest.h&gt;</span><span>
#include</span> <span>&lt;X11/keysym.h&gt;</span><span>
</span>
<span>int</span> <span>main</span><span>()</span> <span>{</span>
    <span>Display</span> <span>*</span><span>dpy</span> <span>=</span> <span>XOpenDisplay</span><span>(</span><span>NULL</span><span>);</span>
    <span>if</span> <span>(</span><span>!</span><span>dpy</span><span>)</span> <span>return</span> <span>1</span><span>;</span>

    <span>KeyCode</span> <span>kc</span> <span>=</span> <span>XKeysymToKeycode</span><span>(</span><span>dpy</span><span>,</span> <span>XStringToKeysym</span><span>(</span><span>"a"</span><span>));</span>
    <span>XTestFakeKeyEvent</span><span>(</span><span>dpy</span><span>,</span> <span>kc</span><span>,</span> <span>True</span><span>,</span>  <span>0</span><span>);</span>
    <span>XTestFakeKeyEvent</span><span>(</span><span>dpy</span><span>,</span> <span>kc</span><span>,</span> <span>False</span><span>,</span> <span>0</span><span>);</span>

    <span>XFlush</span><span>(</span><span>dpy</span><span>);</span>
    <span>XCloseDisplay</span><span>(</span><span>dpy</span><span>);</span>
    <span>return</span> <span>0</span><span>;</span>
<span>}</span></code></pre></figure>

<p>Compile with:</p>

<div><pre><code>&gt; gcc xtest_min.c -o xtest_min -lX11 -lXtst
</code></pre></div>

<p>That’s clean and easy, now on Wayland the picture is a bit more complex
since the protocol doesn’t allow clients to randomly generate input
events. It was designed this way for security reasons.</p>

<p>As with anything Wayland, there are a few unstable extensions,
though deprecated now, such as <code>zwlr_virtual_pointer_v1</code> and
<code>zwp_virtual_keyboard_manager_v1</code>, mostly wlroots Wayland extensions.</p>

<p>An example of the <code>zwp_virtual_keyboard_manager_v1</code> extension would look
somewhat like this:</p>

<figure><pre><code data-lang="c"><span>#define _POSIX_C_SOURCE 200809L
#include</span> <span>&lt;wayland-client.h&gt;</span><span>
#include</span> <span>"virtual-keyboard-unstable-v1-client-protocol.h"</span><span>
</span>
<span>static</span> <span>struct</span> <span>zwp_virtual_keyboard_v1</span> <span>*</span><span>vk</span><span>;</span>

<span>static</span> <span>void</span> <span>global_add</span><span>(</span><span>void</span> <span>*</span><span>data</span><span>,</span> <span>struct</span> <span>wl_registry</span> <span>*</span><span>reg</span><span>,</span>
                       <span>uint32_t</span> <span>name</span><span>,</span> <span>const</span> <span>char</span> <span>*</span><span>iface</span><span>,</span> <span>uint32_t</span> <span>ver</span><span>)</span> <span>{</span>
    <span>if</span> <span>(</span><span>strcmp</span><span>(</span><span>iface</span><span>,</span> <span>zwp_virtual_keyboard_manager_v1_interface</span><span>.</span><span>name</span><span>)</span> <span>==</span> <span>0</span><span>)</span> <span>{</span>
        <span>auto</span> <span>*</span><span>mgr</span> <span>=</span> <span>wl_registry_bind</span><span>(</span><span>reg</span><span>,</span> <span>name</span><span>,</span>
            <span>&amp;</span><span>zwp_virtual_keyboard_manager_v1_interface</span><span>,</span> <span>1</span><span>);</span>
        <span>// NULL seat → compositor chooses default seat</span>
        <span>vk</span> <span>=</span> <span>zwp_virtual_keyboard_manager_v1_create_virtual_keyboard</span><span>(</span><span>mgr</span><span>,</span> <span>NULL</span><span>);</span>
    <span>}</span>
<span>}</span>

<span>static</span> <span>const</span> <span>struct</span> <span>wl_registry_listener</span> <span>reg_listener</span> <span>=</span> <span>{</span>
    <span>.</span><span>global</span> <span>=</span> <span>global_add</span><span>,</span>
    <span>.</span><span>global_remove</span> <span>=</span> <span>NULL</span>
<span>};</span>

<span>int</span> <span>main</span><span>()</span> <span>{</span>
    <span>struct</span> <span>wl_display</span> <span>*</span><span>d</span> <span>=</span> <span>wl_display_connect</span><span>(</span><span>NULL</span><span>);</span>
    <span>struct</span> <span>wl_registry</span> <span>*</span><span>reg</span> <span>=</span> <span>wl_display_get_registry</span><span>(</span><span>d</span><span>);</span>
    <span>wl_registry_add_listener</span><span>(</span><span>reg</span><span>,</span> <span>&amp;</span><span>reg_listener</span><span>,</span> <span>NULL</span><span>);</span>

    <span>wl_display_roundtrip</span><span>(</span><span>d</span><span>);</span> <span>// wait until vk is ready</span>

    <span>uint32_t</span> <span>keycode</span> <span>=</span> <span>30</span><span>;</span>   <span>// Linux evdev (KEY_A)</span>
    <span>uint32_t</span> <span>state_pressed</span>  <span>=</span> <span>1</span><span>;</span>
    <span>uint32_t</span> <span>state_released</span> <span>=</span> <span>0</span><span>;</span>

    <span>zwp_virtual_keyboard_v1_key</span><span>(</span><span>vk</span><span>,</span> <span>0</span><span>,</span> <span>keycode</span><span>,</span> <span>state_pressed</span><span>);</span>
    <span>zwp_virtual_keyboard_v1_key</span><span>(</span><span>vk</span><span>,</span> <span>0</span><span>,</span> <span>keycode</span><span>,</span> <span>state_released</span><span>);</span>
    <span>wl_display_flush</span><span>(</span><span>d</span><span>);</span>

    <span>return</span> <span>0</span><span>;</span>
<span>}</span></code></pre></figure>

<p>But for a better example check the source of
<a href="https://git.sr.ht/~brocellous/wlrctl/tree/master/item/keyboard.c#L171"><code>wlrctl</code></a>
that also relies on the <code>zwp_virtual_keyboard_manager_v1</code> extension.</p>

<p>Yet, these days, this isn’t the path that Wayland has taken, and none of
the compositors agree on these extensions, instead they rely on libei,
a library to consolidate Emulated Input. This is its architecture:</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/libei_arch.png" alt="libei architecture" title="libei architecture">
Courtesy from <a href="https://libinput.pages.freedesktop.org/libei/">https://libinput.pages.freedesktop.org/libei/</a></p>

<p>It has two pieces: a client side that creates virtual devices and
generates evdev events, and the server side called EIS that lives within
the compositor (but that isn’t limited to Wayland) and is responsible for
giving a file descriptor to the client to interface with, and dispatching
received events to where they need to go. The dispatching could be through
uinput devices, that’s an implementation detail, yet most compositors
just store it as an internal virtual device.</p>

<p>This allows compositor to be aware of who is currently emulating input,
which capabilities they require (keyboard, touch, pointer), and to
restrict and/or suspend devices at any time.</p>

<p>Optionally, the compositor may delegate the file descriptor mechanism to
a xdg-desktop-portal dbus service implemented by the desktop environment
so that it can check with polkit and others the allowed permissions
(<a href="https://flatpak.github.io/xdg-desktop-portal/docs/">see</a>). So it would
look like this:</p>

<div><pre><code>    +--------------------+
    | Wayland compositor |_
    +--------------------+  \
    | libinput | libeis  |   \_wayland______
    +----------+---------+                  \
        |     [eis-0.socket]                 \
 /dev/input/     /   \\       +-------+------------------+
                |      ======&gt;| libei | Wayland client A |
                |      after    +-------+------------------+
         initial|     handover   /
      connection|               / initial request
                |              /  dbus[org.freedesktop.portal.EmulatedInput]
                |              /  or dbus[org.freedesktop.portal.RemoteDesktop]
        +--------------------+
        | xdg-desktop-portal |
        +--------------------+
</code></pre></div>

<p>An example implementation of a client can be found
<a href="https://gitlab.freedesktop.org/libinput/libei/-/blob/main/tools/ei-demo-client.c">here</a>.
Or mixed with an XKB mess to translate from keysym to keycode, for the
pleasure of your eyes:</p>

<figure><pre><code data-lang="c"><span>#include</span> <span>&lt;ei.h&gt;</span><span>
#include</span> <span>&lt;xkbcommon/xkbcommon.h&gt;</span><span>
#include</span> <span>&lt;string.h&gt;</span><span>
</span>
<span>int</span> <span>main</span><span>()</span> <span>{</span>
    <span>// ----------------------------</span>
    <span>// 1. Create an XKB context</span>
    <span>// ----------------------------</span>
    <span>struct</span> <span>xkb_context</span> <span>*</span><span>ctx</span> <span>=</span> <span>xkb_context_new</span><span>(</span><span>XKB_CONTEXT_NO_FLAGS</span><span>);</span>

    <span>// load the default system keymap (XKB rules, model, layout, variant, options)</span>
    <span>struct</span> <span>xkb_keymap</span> <span>*</span><span>keymap</span> <span>=</span>
        <span>xkb_keymap_new_from_names</span><span>(</span><span>ctx</span><span>,</span> <span>NULL</span><span>,</span> <span>XKB_KEYMAP_COMPILE_NO_FLAGS</span><span>);</span>

    <span>if</span> <span>(</span><span>!</span><span>keymap</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"failed to load xkb keymap</span><span>\n</span><span>"</span><span>);</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>


    <span>// ----------------------------</span>
    <span>// 2. Convert keysym → evdev code but only for group 1 and level 1</span>
    <span>// ----------------------------</span>
    <span>xkb_keysym_t</span> <span>sym</span> <span>=</span> <span>xkb_keysym_from_name</span><span>(</span><span>"a"</span><span>,</span> <span>XKB_KEYSYM_NO_FLAGS</span><span>);</span>

    <span>// if we know the key by name it would be much easier</span>
    <span>// xkb_keycode_t code = xkb_keymap_key_by_name(keymap, "AD01"); </span>

    <span>// But better: find the keycode for the keysym</span>
    <span>xkb_keycode_t</span> <span>key</span> <span>=</span> <span>0</span><span>;</span>

    <span>// Iterate keycodes until we find the one producing this keysym</span>
    <span>// That's because keycodes-&gt;keysym is many-to-one</span>
    <span>xkb_keycode_t</span> <span>min</span> <span>=</span> <span>xkb_keymap_min_keycode</span><span>(</span><span>keymap</span><span>);</span>
    <span>xkb_keycode_t</span> <span>max</span> <span>=</span> <span>xkb_keymap_max_keycode</span><span>(</span><span>keymap</span><span>);</span>

    <span>for</span> <span>(</span><span>xkb_keycode_t</span> <span>k</span> <span>=</span> <span>min</span><span>;</span> <span>k</span> <span>&lt;=</span> <span>max</span><span>;</span> <span>k</span><span>++</span><span>)</span> <span>{</span>
        <span>if</span> <span>(</span><span>xkb_keymap_key_get_level</span><span>(</span><span>keymap</span><span>,</span> <span>k</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>)</span> <span>&gt;=</span> <span>0</span><span>)</span> <span>{</span>
            <span>int</span> <span>nsyms</span><span>;</span>
            <span>const</span> <span>xkb_keysym_t</span> <span>*</span><span>syms</span> <span>=</span> <span>xkb_keymap_key_get_syms_by_level</span><span>(</span><span>keymap</span><span>,</span> <span>k</span><span>,</span> <span>0</span><span>,</span> <span>0</span><span>,</span> <span>&amp;</span><span>nsyms</span><span>);</span>
            <span>for</span> <span>(</span><span>int</span> <span>i</span> <span>=</span> <span>0</span><span>;</span> <span>i</span> <span>&lt;</span> <span>nsyms</span><span>;</span> <span>i</span><span>++</span><span>)</span> <span>{</span>
                <span>if</span> <span>(</span><span>syms</span><span>[</span><span>i</span><span>]</span> <span>==</span> <span>sym</span><span>)</span> <span>{</span>
                    <span>key</span> <span>=</span> <span>k</span><span>;</span>
                    <span>break</span><span>;</span>
                <span>}</span>
            <span>}</span>
        <span>}</span>
    <span>}</span>

    <span>if</span> <span>(</span><span>!</span><span>key</span><span>)</span> <span>{</span>
        <span>fprintf</span><span>(</span><span>stderr</span><span>,</span> <span>"could not map keysym</span><span>\n</span><span>"</span><span>);</span>
        <span>return</span> <span>1</span><span>;</span>
    <span>}</span>

    <span>// IMPORTANT: xkbcommon keycodes are **+8** relative to evdev</span>
    <span>int</span> <span>evdev_code</span> <span>=</span> <span>key</span> <span>-</span> <span>8</span><span>;</span>

    <span>struct</span> <span>ei</span> <span>*</span><span>ei</span> <span>=</span> <span>ei_new</span><span>();</span>
    <span>// compositor socket, we'd need to get it through portal in real scenario</span>
    <span>ei_connect</span><span>(</span><span>ei</span><span>,</span> <span>"unix:path=/run/user/1000/ei_socket"</span><span>);</span>

    <span>struct</span> <span>ei_client</span> <span>*</span><span>client</span> <span>=</span> <span>ei_get_client</span><span>(</span><span>ei</span><span>);</span>
    <span>ei_client_set_name</span><span>(</span><span>client</span><span>,</span> <span>"xkb-sender"</span><span>);</span>

    <span>struct</span> <span>ei_device</span> <span>*</span><span>dev</span> <span>=</span> <span>ei_device_new</span><span>(</span><span>client</span><span>,</span> <span>"xkd-virt-keyboard0"</span><span>);</span>
    <span>ei_device_add_capability</span><span>(</span><span>dev</span><span>,</span> <span>EI_DEVICE_CAP_KEYBOARD</span><span>);</span>

    <span>ei_device_start_emulating</span><span>(</span><span>dev</span><span>);</span>


    <span>// press and release</span>
    <span>ei_key</span><span>(</span><span>dev</span><span>,</span> <span>evdev_code</span><span>,</span> <span>true</span><span>);</span>
    <span>ei_key</span><span>(</span><span>dev</span><span>,</span> <span>evdev_code</span><span>,</span> <span>false</span><span>);</span>

    <span>ei_flush</span><span>(</span><span>ei</span><span>);</span>
    <span>ei_disconnect</span><span>(</span><span>ei</span><span>);</span>
    <span>ei_free</span><span>(</span><span>ei</span><span>);</span>
    <span>return</span> <span>0</span><span>;</span>
<span>}</span></code></pre></figure>

<p>Then obviously the EIS side has to catch these events and handle
them. There’s also an example that creates uinput devices found
<a href="https://gitlab.freedesktop.org/libinput/libei/-/blob/main/tools/eis-demo-server.c">here</a>.</p>

<p>The main logic of an EIS is quite straight forward (from the official docs):</p>

<ul>
  <li>create a context with <code>eis_new()</code></li>
  <li>set up a backend with <code>eis_setup_backend_fd()</code> or <code>eis_setup_backend_socket()</code></li>
  <li>register the <code>eis_get_fd()</code> with its own event loop</li>
  <li>call <code>eis_dispatch()</code> whenever the fd triggers</li>
  <li>call <code>eis_get_event()</code> and process incoming events</li>
</ul>

<p>And whenever a new client connects:</p>

<ul>
  <li>accept new clients with <code>eis_client_connect()</code></li>
  <li>create one or more seats for the client with <code>eis_client_new_seat()</code></li>
  <li>wait for <code>EIS_EVENT_SEAT_BIND</code> and then</li>
  <li>create one or more devices with the bound capabilities, see <code>eis_seat_new_device()</code></li>
</ul>

<p>That’s kind of like network programming.</p>

<p>So far, most Wayland compositors implement this mechanism
along with portals. You can see the list of support
<a href="https://gitlab.freedesktop.org/libinput/libei/-/issues/1">here</a>, from
GNOME, KDE, XWayland, and more.</p>

<p>On that note, XWayland is both an X server, and a Wayland client. So it
understands XTest requests. Yet what happens when it receives them is
that internally it relies on libei client side to handle virtual device
events. That means xdotool can work on XWayland with libei context.</p>

<div><pre><code>    +--------------------+             +------------------+
    | Wayland compositor |---wayland---| Wayland client B |
    +--------------------+\            +------------------+
    | libinput | libeis  | \_wayland______
    +----------+---------+                \
        |          |           +-------+------------------+
 /dev/input/       +---brei----| libei |     XWayland     |
                               +-------+------------------+
                                                |
                                                | XTEST
                                                |
                                         +-----------+
                                         |  X client |
                                         +-----------+
</code></pre></div>

<p>This is summarized well
<a href="https://www.semicomplete.com/blog/xdotool-and-exploring-wayland-fragmentation/">here</a>,
I quote:</p>

<blockquote>
  <ul>
    <li>An X11 client sends a key event using XTEST (normal)</li>
    <li>XWayland receives it and initiates Remote Desktop XDG Portal session to … your own system (???)</li>
    <li>XDG Portal uses DBus in an odd way, with many method calls receiving responses via signals because DBus isn’t designed for long asynchronous methods.</li>
    <li>Once the Remote Desktop portal session is setup, Xwayland asks for a file descriptor to talk an libei server (emulated input server).</li>
    <li>After that, libei is used to send events, query the keyboard map, etc.</li>
    <li>You can ask libei for the keyboard mapping (keycodes to keysyms, etc), you get another file descriptor and process that with yet another library, libxkbcommon.</li>
  </ul>
</blockquote>

<p>The main issue is that if the libei client gets its file descriptor
via dbus portal, then every time it asks for it then the user will get
prompted to “Allow remote interaction?”. And most portal software don’t
have config or whitelist rule mechanisms to skip that (as far as I know),
which would make sense while keeping the same security level.</p>

<p>When it comes to remote desktop on Wayland, it’s quite similar, it
relies on the same libei mechanism. Yet, we need to add to the equation,
as far as input goes, a listener that captures input regardless of the
focused window.</p>

<p>The remote desktop is also achieved with libei and a dbus xdg-desktop-portal
either <code>org.freedesktop.portal.RemoteDesktop</code> or
<code>.InputCapture</code>, which will give back to the client
a special file descriptor for listening to the input stream.<br>
And similarly, it is always explicit about asking for
permission to share input or share the screen (or specific
window/surface), and there doesn’t seem to be a general
configuration to turn it off or whitelist certain clients (<a href="https://discourse.gnome.org/t/persistent-remote-desktop-access-api/19415/24">see
discussion</a>).</p>

<p>Let’s note that in the case of Wayland it is the compositor that usually
provides VNC/RDP servers, for example KWin and GNOME Mutter (apart from
<code>wayvnc</code> for wlroots compositors).<br>
Meanwhile, on X11 the remote desktop protocol was part of the X11 protocol
itself from the start, with full access, the whole events. The X server
can be on another machine and clients can communicate with it over the X11
protocol, or the events could be forwarded over ssh and others. VNC and
other remote desktop protocol can rely on how open it is too. Plus, XTEST is
there for injecting events too. There’s no limitation for apps to read the
screen framebuffer either, send it, and draw it in another X session,
but it’s often re-rendered when doing remote desktop. (x11vnc, TigerVNC,
etc..). There have been extensions over the years for security (XACE)
but nobody is relying on them.<br>
There’s also xrdp, but this creates a whole new virtual Xorg session,
so it’s another story.</p>

<p>Let’s now review a couple of tools used for automation.</p>

<p>We’ve already seen quite a lot of the ones that rely on evdev and uinput,
but now they will make more sense with our current context:</p>

<ul>
  <li><code>evemu</code> and <code>evtest</code></li>
  <li><code>libinput record</code> and <code>libinput replay</code></li>
  <li><a href="https://gitlab.freedesktop.org/whot/unplug"><code>unplug</code></a></li>
  <li><code>evsieve</code></li>
  <li><code>keyd</code> - creates a uinput device to remap keys</li>
  <li><code>evmux</code> and <code>inputattach</code> - multiplex multiple evdev devices into a
 single virtual stream</li>
</ul>

<p>The most popular tool that relies on XTEST (plus EWMH and others) is
<code>xdotool</code>.</p>

<p><em>NB</em>: the “toplevel-management” Wayland “unstable” extension somewhat
replaces some of the EWMH, but it’s not implemented by most compositor
for security reasons.</p>

<p>Similar tools to <code>xdotool</code> but that relies on uinput are <code>ydotool</code> and
<a href="https://git.sr.ht/~geb/dotool"><code>dotool</code></a>.</p>

<p>We’ve seen <code>wlrctl</code> that relies on the unstable wayland protocol for
wlroots-based compositors. There’s also <code>wtype</code> that also relies on the
unstable virtual keyboard protocol.</p>

<p>We can also possibly perform automation via very specific desktop
environment mechanisms. That means using something such as GNOME shell
extensions for example, which has a javascript API. KDE has that
concept and the utility <code>kdotool</code> relies on this.</p>

<p>As you’ve observed, the situation is a bit fragmented on Wayland when
it comes to automations, both in utilities and extensions.</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/emulation.png" alt="Emulation Overview" title="Emulation Overview"></p>

<h2 id="input-method">Input Method</h2>

<p>In this last section we’ll explore the concept of input method (IMF &amp;
IME), a mechanism to input keysym/characters that are not natively
available on the user’s input device. This is necessary for languages
that have more graphemes than there are keys on the keyboard.</p>

<p>There are two sides to the equation: the IMF, the input method framework,
and the IME, the input method engine which works within the framework. An
input method framework’s role is to pick the most appropriate way
to enter the text, shape it, and return it to the widget. The IME is
basically the place where input are interpreted in any way shape, form,
or logic, to produce the text that the IMF asked for.<br>
The IMF can also act as wrapper over XKB configs, to allow easily swapping
between keyboard layouts, it coexist with the idea of switching between
different IMEs.<br>
Simply said, the IME is a middleman between the keyboard and the actual
output text when relying on the toolkit/widget.</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/input_method_overview.png" alt="Input Method Overview 1" title="Input Method Overview 1">
Courtesy from <a href="https://nerufic.com/en/posts/how-input-methods-work-in-linux/">https://nerufic.com/en/posts/how-input-methods-work-in-linux/</a></p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/input_method_arch.png" alt="Input Method Overview 2" title="Input Method Overview 2">
Courtesy from <a href="https://www.chromium.org/chromium-os/chromiumos-design-docs/text-input/basic-architecture2.png">https://www.chromium.org/chromium-os/chromiumos-design-docs/text-input/basic-architecture2.png</a></p>

<p>The way the input method plugs into the whole input stack is at the window
client side, within the widget/toolkit library framework in the input
handling event loop. After the client performs the keycode to keysym
translation and composing, it calls the toolkit specifically configured
input method, which will reroute it to the IM pipeline. Within the
pipeline, the IMF implementation will talk over its protocol to have
the IME interpret the input, and return preedit and committed text. This
will in turn be pushed back to the toolkit to display.<br>
That means that simply by relying on input widgets from a framework
such as GTK or Qt, it will automatically handle the integration with the
Input Method.</p>

<p>Some of these input frameworks are swappable, either because they talk
over the same protocol, be it the old deprecated XIM protocol for legacy
purpose (X Input Method over X protocol extension), or because they
plug straight as a module into the widget framework, which is mostly that
case today.</p>

<p>There are a lot of IMFs and IMEs implementations, and interoperability,
<a href="https://wiki.archlinux.org/title/Input_method#List_of_available_input_method_editors">see this list</a>.
These days the two major IMFs are IBus (Intelligent Input Bus, GTK-based like GNOME), and Fcitx5
(Qt-based like KDE).</p>

<p>To swap between them, if they are compatible with the toolkit, one can
set certain environment variables related to their toolkit:</p>

<div><pre><code>GTK_IM_MODULE=ibus
QT_IM_MODULE=ibus
XMODIFIERS=@im=ibus
</code></pre></div>

<p>For example the path that the text will take with Ibus looks like this:</p>

<div><pre><code>Application → GTK/Qt IM module → D-Bus → IBus/Fcitx
               →    IME      → D-Bus → GTK/Qt widget
</code></pre></div>

<p>As you can see, this bypasses all graphic servers, be it the X servers
or Wayland compositors.</p>

<p>Yet for it to work across the Wayland ecosystem, and not only on some
widgets like GTK and Qt (games, electron apps, java apps, sandboxed apps,
etc..), the IMF/IME stack needs to be able to listen to key events from
any application, provided it is focused, get the surrounding context,
take field focus, and inject text into clients. This is why some
“unstable” extensions were created, mostly “text-input-unstable-v3”
(<code>zwp_text_input_v3</code>) and “input-method-v2” (<code>zwp_input_methd_v2</code>)
protocol. With this, there’ll be consistent IM behavior across all
applications without compromising security.</p>

<p>On a side note, this same extension protocol for injecting text can be
used for the speech-to-text accessibility framework. In practice this
can either be done via a virtual input device, or a specific desktop
service mechanism integrated in the toolkits. We have a desktop service
catching voice input, a standalone voice recognizer to convert it to
text, and a virtual keyboard or feature to inject events. For example,
GNOME VoiceInput, Plasma Whisper Integration, QtSpeech, SpeechDispatcher,
Caribou, Onboard, or GNOME Accessibility Services (AT-SPI). We won’t
go into details on that, nor mention text-to-speech, since it’s outside
our scope.</p>

<p>One issue remains though, and it’s related to the key repeat rate
and delay, which on Wayland is implemented client-side. It’s
not implemented by IMs, and tough to handle apparently (<a href="https://www.csslayer.info/wordpress/linux/key-repetition-and-key-event-handling-issue-with-wayland-input-method-protocols/">see</a>).</p>

<p>And that it!</p>

<p><img src="https://venam.net/blog/assets/input_devices_linux/IM.png" alt="IM Overview" title="IM Overview"></p>

<h2 id="conclusion">Conclusion</h2>

<p>Congratulations for making it this far into the article!<br>
We’ve covered a lot of ground, literally from hardware to the very
abstract components of the graphical input stack.</p>

<p>I have some hope that in the future there’s going to be a more common
way to configure the Wayland input stack across compositors and have
fewer discrepancies and fragmentation. I also wish the XKB stack would
one day get cleanup up, but on this one my hopes are pretty low. It’s
fallen victim to entropy and chaos.</p>

<p>A huge gigantic thanks to “who-t” aka Peter Hutterer, whose <a href="https://who-t.blogspot.com/">blog</a> has
been my trusty companion for the past months.</p>

<p>We need more articles like this in the age of AI overlords, so please
share it if you’ve enjoyed it!</p>

<p>Thanks for reading, have a wonderful end of day!</p>

<pre>


</pre>

<p><em>NB: This article compiles my understand, for any correction please
contact me.</em></p>

<pre>




</pre>

<h2 id="diagrams-summary">Diagrams Summary</h2>

<p><img src="https://venam.net/blog/assets/input_devices_linux/input_topological_path.png" alt="Topology Overview" title="Topology Overview"></p>

<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/hid_core.png" alt="HID Core Overview" title="HID Core Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/input_core.png" alt="Input Core Overview" title="Input Core Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/libinput.png" alt="libinput Overview" title="libinput Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/console.png" alt="Console Overview" title="Console Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/xkb.png" alt="XKB Overview" title="XKB Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/de_upper_stack.png" alt="DE/Upper Stack Overview" title="DE/Upper Stack Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/emulation.png" alt="Emulation Overview" title="Emulation Overview"></p>
<pre>

</pre>

<p><img src="https://venam.net/blog/assets/input_devices_linux/IM.png" alt="IM Overview" title="IM Overview"></p>

<pre>




</pre>

<hr>

<h2 id="resources">Resources</h2>

<ul>
  <li>GENERIC, FULL STACK
    <ul>
      <li><a href="https://linuxtouchpad.org/docs/">https://linuxtouchpad.org/docs/</a></li>
      <li><a href="https://linuxtouchpad.org/resources/">https://linuxtouchpad.org/resources/</a></li>
      <li><a href="https://monroeclinton.com/pointing-devices-in-linux/">https://monroeclinton.com/pointing-devices-in-linux/</a></li>
      <li><a href="https://wiki.archlinux.org/title/Keyboard_input">https://wiki.archlinux.org/title/Keyboard_input</a></li>
      <li><a href="https://vkoskiv.com/first-linux-patch/">https://vkoskiv.com/first-linux-patch/</a></li>
      <li><a href="https://linux-kernel-labs.github.io/refs/heads/master/labs/device_model.html">https://linux-kernel-labs.github.io/refs/heads/master/labs/device_model.html</a></li>
      <li><a href="https://apexpenn.github.io/2025/02/13/linux-input-subsystem/">https://apexpenn.github.io/2025/02/13/linux-input-subsystem/</a></li>
    </ul>
  </li>
  <li>HARDWARE INTERFACE
    <ul>
      <li><a href="https://wiki.osdev.org/PS/2_Mouse">https://wiki.osdev.org/PS/2_Mouse</a></li>
      <li><a href="https://isdaman.com/alsos/hardware/mouse/ps2interface.htm">https://isdaman.com/alsos/hardware/mouse/ps2interface.htm</a></li>
      <li><a href="https://www.eecg.utoronto.ca/~jayar/ece241_08F/AudioVideoCores/ps2/ps2.html">https://www.eecg.utoronto.ca/~jayar/ece241_08F/AudioVideoCores/ps2/ps2.html</a></li>
      <li><a href="https://www.cpcwiki.eu/index.php/Serial_RS232_Mouse">https://www.cpcwiki.eu/index.php/Serial_RS232_Mouse</a></li>
      <li><a href="https://eleccelerator.com/usbdescreqparser/">https://eleccelerator.com/usbdescreqparser/</a></li>
    </ul>
  </li>
  <li>KERNEL, MODULES, HID AND OTHERS
    <ul>
      <li><a href="https://who-t.blogspot.com/2018/12/understanding-hid-report-descriptors.html">https://who-t.blogspot.com/2018/12/understanding-hid-report-descriptors.html</a></li>
      <li><a href="https://who-t.blogspot.com/2021/01/parsing-hid-unit-items.html">https://who-t.blogspot.com/2021/01/parsing-hid-unit-items.html</a></li>
      <li><a href="http://bentiss.github.io/hid-replay-docs/">http://bentiss.github.io/hid-replay-docs/</a></li>
      <li><a href="https://gitlab.freedesktop.org/libevdev/hid-tools/">https://gitlab.freedesktop.org/libevdev/hid-tools/</a></li>
      <li><a href="https://docs.kernel.org/hid/hidintro.html">https://docs.kernel.org/hid/hidintro.html</a></li>
      <li><a href="https://docs.kernel.org/hid/hid-transport.html">https://docs.kernel.org/hid/hid-transport.html</a></li>
      <li><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/hid/">https://learn.microsoft.com/en-us/windows-hardware/drivers/hid/</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/hid/hiddev.txt">https://www.kernel.org/doc/Documentation/hid/hiddev.txt</a></li>
      <li><a href="https://www.man7.org/linux//man-pages/man8/usbhid-dump.8.html">https://www.man7.org/linux//man-pages/man8/usbhid-dump.8.html</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/input.txt">https://www.kernel.org/doc/Documentation/input/input.txt</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/input-programming.txt">https://www.kernel.org/doc/Documentation/input/input-programming.txt</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/joystick.txt">https://www.kernel.org/doc/Documentation/input/joystick.txt</a></li>
      <li><a href="https://github.com/libratbag/piper/">https://github.com/libratbag/piper/</a></li>
      <li><a href="https://git.annabunches.net/anna/joyful">https://git.annabunches.net/anna/joyful</a></li>
      <li><a href="https://docs.kernel.org/input/">https://docs.kernel.org/input/</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/">https://www.kernel.org/doc/Documentation/input/</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/event-codes.rst">https://www.kernel.org/doc/Documentation/input/event-codes.rst</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/appletouch.txt">https://www.kernel.org/doc/Documentation/input/appletouch.txt</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/gamepad.rst">https://www.kernel.org/doc/Documentation/input/gamepad.rst</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/multi-touch-protocol.rst">https://www.kernel.org/doc/Documentation/input/multi-touch-protocol.rst</a></li>
      <li><a href="https://github.com/torvalds/linux/blob/master/drivers/input/keyboard/atkbd.c">https://github.com/torvalds/linux/blob/master/drivers/input/keyboard/atkbd.c</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/laptops/thinkpad-acpi.txt">https://www.kernel.org/doc/Documentation/laptops/thinkpad-acpi.txt</a></li>
      <li><a href="https://www.kernel.org/doc/html/latest/driver-api/input.html">https://www.kernel.org/doc/html/latest/driver-api/input.html</a></li>
      <li><a href="https://www.kernelconfig.io/config_devtmpfs_safe">https://www.kernelconfig.io/config_devtmpfs_safe</a></li>
    </ul>
  </li>
  <li>SYSFS MAPPING
    <ul>
      <li><a href="https://www.kernel.org/pub/linux/kernel/people/mochel/doc/papers/ols-2005/mochel.pdf">https://www.kernel.org/pub/linux/kernel/people/mochel/doc/papers/ols-2005/mochel.pdf</a></li>
      <li><a href="https://www.man7.org/linux/man-pages/man5/sysfs.5.html">https://www.man7.org/linux/man-pages/man5/sysfs.5.html</a></li>
      <li><a href="https://www.kernel.org/doc/html/latest/filesystems/sysfs.html">https://www.kernel.org/doc/html/latest/filesystems/sysfs.html</a></li>
    </ul>
  </li>
  <li>UDEV, MDEV, SMDEV, HWDB
    <ul>
      <li><a href="https://codelucky.com/devtmpfs-linux/">https://codelucky.com/devtmpfs-linux/</a></li>
      <li><a href="https://who-t.blogspot.com/2019/02/adding-entries-to-udev-hwdb.html">https://who-t.blogspot.com/2019/02/adding-entries-to-udev-hwdb.html</a></li>
      <li><a href="https://who-t.blogspot.com/2024/04/udev-hid-bpf-quickstart-tooling-to-fix.html">https://who-t.blogspot.com/2024/04/udev-hid-bpf-quickstart-tooling-to-fix.html</a></li>
      <li><a href="https://libevdev.pages.freedesktop.org/udev-hid-bpf/index.html">https://libevdev.pages.freedesktop.org/udev-hid-bpf/index.html</a></li>
      <li><a href="https://lwn.net/Articles/970702/">https://lwn.net/Articles/970702/</a></li>
      <li><a href="https://wiki.archlinux.org/title/Udev">https://wiki.archlinux.org/title/Udev</a></li>
      <li><a href="https://www.man7.org/linux/man-pages/man5/udev.conf.5.html">https://www.man7.org/linux/man-pages/man5/udev.conf.5.html</a></li>
      <li><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd-udevd.service.html">https://www.freedesktop.org/software/systemd/man/latest/systemd-udevd.service.html</a></li>
      <li><a href="https://www.man7.org/linux/man-pages/man8/udevadm.8.html%20udevadm">https://www.man7.org/linux/man-pages/man8/udevadm.8.html udevadm</a></li>
      <li><a href="https://www.freedesktop.org/software/systemd/man/latest/udev.html#">https://www.freedesktop.org/software/systemd/man/latest/udev.html#</a></li>
      <li><a href="https://www.reactivated.net/writing_udev_rules.html">https://www.reactivated.net/writing_udev_rules.html</a></li>
      <li><a href="https://opensource.com/article/18/11/udev">https://opensource.com/article/18/11/udev</a></li>
      <li><a href="https://stackoverflow.com/questions/45987478/udev-rule-for-input-device">https://stackoverflow.com/questions/45987478/udev-rule-for-input-device</a></li>
      <li><a href="https://dataswamp.org/~solene/2025-05-31-linux-killswitch-on-power-disconnect.html">https://dataswamp.org/~solene/2025-05-31-linux-killswitch-on-power-disconnect.html</a></li>
      <li><a href="https://en.wikipedia.org/wiki/Udev">https://en.wikipedia.org/wiki/Udev</a></li>
      <li><a href="https://www.linuxfromscratch.org/lfs/view/12.3/chapter09/udev.html">https://www.linuxfromscratch.org/lfs/view/12.3/chapter09/udev.html</a></li>
      <li><a href="https://documentation.suse.com/sles/12-SP5/html/SLES-all/cha-udev.html">https://documentation.suse.com/sles/12-SP5/html/SLES-all/cha-udev.html</a></li>
      <li><a href="https://wiki.gentoo.org/wiki/Mdev">https://wiki.gentoo.org/wiki/Mdev</a></li>
      <li><a href="https://wiki.gentoo.org/wiki/Udev">https://wiki.gentoo.org/wiki/Udev</a></li>
      <li><a href="https://git.suckless.org/smdev/file/README.html">https://git.suckless.org/smdev/file/README.html</a></li>
      <li><a href="https://www.man7.org/linux/man-pages/man7/hwdb.7.html">https://www.man7.org/linux/man-pages/man7/hwdb.7.html</a></li>
      <li><a href="https://github.com/systemd/systemd/blob/main/hwdb.d/60-evdev.hwdb">https://github.com/systemd/systemd/blob/main/hwdb.d/60-evdev.hwdb</a></li>
      <li><a href="http://www.linux-usb.org/%20(deprecated)">http://www.linux-usb.org/ (deprecated)</a></li>
      <li><a href="https://web.archive.org/web/20160127215232/https://www.kernel.org/doc/pending/hotplug.txt">https://web.archive.org/web/20160127215232/https://www.kernel.org/doc/pending/hotplug.txt</a></li>
      <li><a href="https://elixir.bootlin.com/linux/v3.12.74/source/lib/kobject_uevent.c#L121">https://elixir.bootlin.com/linux/v3.12.74/source/lib/kobject_uevent.c#L121</a></li>
    </ul>
  </li>
  <li>EVDEV, LIBEVDEV, IOCTL
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Evdev#/media/File:Linux_API.svg">https://en.wikipedia.org/wiki/Evdev#/media/File:Linux_API.svg</a></li>
      <li><a href="https://en.wikipedia.org/wiki/Evdev">https://en.wikipedia.org/wiki/Evdev</a></li>
      <li><a href="https://www.kernel.org/doc/Documentation/input/uinput.rst">https://www.kernel.org/doc/Documentation/input/uinput.rst</a></li>
      <li><a href="https://www.freedesktop.org/software/libevdev/doc/latest/ioctls.html">https://www.freedesktop.org/software/libevdev/doc/latest/ioctls.html</a></li>
      <li><a href="https://gitlab.freedesktop.org/libevdev/libevdev">https://gitlab.freedesktop.org/libevdev/libevdev</a></li>
      <li><a href="https://www.freedesktop.org/software/libevdev/doc/latest/">https://www.freedesktop.org/software/libevdev/doc/latest/</a></li>
      <li><a href="https://who-t.blogspot.com/2016/09/understanding-evdev.html">https://who-t.blogspot.com/2016/09/understanding-evdev.html</a></li>
      <li><a href="https://who-t.blogspot.com/2018/07/why-its-not-good-idea-to-handle-evdev.html">https://who-t.blogspot.com/2018/07/why-its-not-good-idea-to-handle-evdev.html</a></li>
      <li><a href="https://who-t.blogspot.com/2018/01/libevdev-python.html">https://who-t.blogspot.com/2018/01/libevdev-python.html</a></li>
      <li><a href="https://gist.github.com/TriceHelix/de47ed38dcb4f7216b26291c47445d99">https://gist.github.com/TriceHelix/de47ed38dcb4f7216b26291c47445d99</a></li>
      <li><a href="https://who-t.blogspot.com/2014/11/analysing-input-events-with-evemu.html">https://who-t.blogspot.com/2014/11/analysing-input-events-with-evemu.html</a></li>
    </ul>
  </li>
  <li>LIBINPUT
    <ul>
      <li><a href="https://blog.martin-graesslin.com/blog/2016/12/how-input-works-creating-a-device/">https://blog.martin-graesslin.com/blog/2016/12/how-input-works-creating-a-device/</a></li>
      <li><a href="https://blog.martin-graesslin.com/blog/2016/12/how-input-works-keyboard-input/">https://blog.martin-graesslin.com/blog/2016/12/how-input-works-keyboard-input/</a></li>
      <li><a href="https://blog.martin-graesslin.com/blog/2016/12/how-input-works-pointer-input/">https://blog.martin-graesslin.com/blog/2016/12/how-input-works-pointer-input/</a></li>
      <li><a href="https://blog.martin-graesslin.com/blog/2017/02/how-input-works-touch-input/">https://blog.martin-graesslin.com/blog/2017/02/how-input-works-touch-input/</a></li>
      <li><a href="https://www.michaelminn.com/linux/peripherals/">https://www.michaelminn.com/linux/peripherals/</a></li>
      <li><a href="https://linuxtouchpad.org/news/2021/12/03/best-of-libinput-on-lwn.html">https://linuxtouchpad.org/news/2021/12/03/best-of-libinput-on-lwn.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/07/libinput-is-done.html">https://who-t.blogspot.com/2016/07/libinput-is-done.html</a></li>
      <li><a href="https://who-t.blogspot.com/2014/09/libinput-common-input-stack-for-wayland.html">https://who-t.blogspot.com/2014/09/libinput-common-input-stack-for-wayland.html</a></li>
      <li><a href="https://who-t.blogspot.com/2019/03/libinputs-internal-building-blocks.html">https://who-t.blogspot.com/2019/03/libinputs-internal-building-blocks.html</a></li>
      <li><a href="https://wiki.archlinux.org/title/Libinput">https://wiki.archlinux.org/title/Libinput</a></li>
      <li><a href="https://who-t.blogspot.com/2017/01/how-libinput-opens-device-nodes.html">https://who-t.blogspot.com/2017/01/how-libinput-opens-device-nodes.html</a></li>
      <li><a href="https://who-t.blogspot.com/2025/06/libinput-and-tablet-tool-eraser-buttons.html">https://who-t.blogspot.com/2025/06/libinput-and-tablet-tool-eraser-buttons.html</a></li>
      <li><a href="https://who-t.blogspot.com/2025/05/libinput-and-lua-plugins.html">https://who-t.blogspot.com/2025/05/libinput-and-lua-plugins.html</a></li>
      <li><a href="https://wayland.freedesktop.org/libinput/doc/latest/lua-plugins.html">https://wayland.freedesktop.org/libinput/doc/latest/lua-plugins.html</a></li>
      <li><a href="https://wayland.freedesktop.org/libinput/doc/latest/">https://wayland.freedesktop.org/libinput/doc/latest/</a></li>
      <li><a href="https://wayland.freedesktop.org/libinput/doc/latest/configuration.html">https://wayland.freedesktop.org/libinput/doc/latest/configuration.html</a></li>
      <li><a href="https://www.x.org/wiki/Events/XDC2014/XDC2014HuttererLibInput/">https://www.x.org/wiki/Events/XDC2014/XDC2014HuttererLibInput/</a></li>
      <li><a href="https://who-t.blogspot.com/2015/02/libinput-device-groups.html">https://who-t.blogspot.com/2015/02/libinput-device-groups.html</a></li>
      <li><a href="https://who-t.blogspot.com/2019/10/libinputs-bus-factor-is-1.html">https://who-t.blogspot.com/2019/10/libinputs-bus-factor-is-1.html</a></li>
      <li><a href="https://who-t.blogspot.com/2017/02/libinput-knows-about-internal-and.html">https://who-t.blogspot.com/2017/02/libinput-knows-about-internal-and.html</a></li>
      <li><a href="https://who-t.blogspot.com/2017/02/libinput-and-lid-switch-events.html">https://who-t.blogspot.com/2017/02/libinput-and-lid-switch-events.html</a></li>
    </ul>
  </li>
  <li>LIBINPUT AND POINTER SPECFICIS
    <ul>
      <li><a href="https://bitmath.se/org/code/mtdev/">https://bitmath.se/org/code/mtdev/</a></li>
      <li><a href="https://who-t.blogspot.com/2015/07/a-short-overview-of-touchpad-devices.html">https://who-t.blogspot.com/2015/07/a-short-overview-of-touchpad-devices.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/12/libinput-touchpad-pointer-acceleration.html">https://who-t.blogspot.com/2016/12/libinput-touchpad-pointer-acceleration.html</a></li>
      <li><a href="https://who-t.blogspot.com/2018/06/x-server-pointer-acceleration-analysis.html">https://who-t.blogspot.com/2018/06/x-server-pointer-acceleration-analysis.html</a></li>
      <li><a href="https://who-t.blogspot.com/2014/09/pointer-acceleration-in-libinput.html">https://who-t.blogspot.com/2014/09/pointer-acceleration-in-libinput.html</a></li>
      <li><a href="https://who-t.blogspot.com/2017/07/libinput-and-pressure-based-palm.html">https://who-t.blogspot.com/2017/07/libinput-and-pressure-based-palm.html</a></li>
      <li><a href="https://who-t.blogspot.com/2019/07/libinputs-new-thumb-detection-code.html">https://who-t.blogspot.com/2019/07/libinputs-new-thumb-detection-code.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/09/synaptics-pointer-acceleration.html">https://who-t.blogspot.com/2016/09/synaptics-pointer-acceleration.html</a></li>
      <li><a href="https://who-t.blogspot.com/2017/01/the-definitive-guide-to-synclient.html">https://who-t.blogspot.com/2017/01/the-definitive-guide-to-synclient.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/07/why-synclient-does-not-work-anymore.html">https://who-t.blogspot.com/2016/07/why-synclient-does-not-work-anymore.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/12/xf86-input-synaptics-is-not-synaptics.html">https://who-t.blogspot.com/2016/12/xf86-input-synaptics-is-not-synaptics.html</a></li>
      <li><a href="https://www.x.org/releases/X11R7.6-RC1/doc/man/man4/synaptics.4.xhtml">https://www.x.org/releases/X11R7.6-RC1/doc/man/man4/synaptics.4.xhtml</a></li>
      <li><a href="https://cookie.engineer/weblog/articles/synaptics-touchpad-on-linux.html">https://cookie.engineer/weblog/articles/synaptics-touchpad-on-linux.html</a></li>
      <li><a href="https://who-t.blogspot.com/2017/10/what-is-libwacom.html">https://who-t.blogspot.com/2017/10/what-is-libwacom.html</a></li>
      <li><a href="https://github.com/tuhiproject/tuhi/">https://github.com/tuhiproject/tuhi/</a></li>
      <li><a href="https://who-t.blogspot.com/2020/02/a-tale-of-missing-touches.html">https://who-t.blogspot.com/2020/02/a-tale-of-missing-touches.html</a></li>
      <li><a href="https://who-t.blogspot.com/2021/07/libinput-and-hold-gestures.html">https://who-t.blogspot.com/2021/07/libinput-and-hold-gestures.html</a></li>
      <li><a href="https://who-t.blogspot.com/2021/08/libinput-and-high-resolution-wheel.html">https://who-t.blogspot.com/2021/08/libinput-and-high-resolution-wheel.html</a></li>
      <li><a href="https://who-t.blogspot.com/2023/01/libinput-and-custom-pointer.html">https://who-t.blogspot.com/2023/01/libinput-and-custom-pointer.html</a></li>
      <li><a href="https://who-t.blogspot.com/2024/03/enforcing-touchscreen-mapping-in-gnome.html">https://who-t.blogspot.com/2024/03/enforcing-touchscreen-mapping-in-gnome.html</a></li>
      <li><a href="https://github.com/iberianpig/fusuma">https://github.com/iberianpig/fusuma</a></li>
      <li><a href="https://github.com/bulletmark/libinput-gestures">https://github.com/bulletmark/libinput-gestures</a></li>
      <li><a href="https://github.com/Coffee2CodeNL/gebaar-libinput">https://github.com/Coffee2CodeNL/gebaar-libinput</a></li>
      <li><a href="https://bill.harding.blog/2019/03/25/linux-touchpad-like-a-macbook-progress-and-a-call-for-help/">https://bill.harding.blog/2019/03/25/linux-touchpad-like-a-macbook-progress-and-a-call-for-help/</a></li>
      <li><a href="https://www.davidrevoy.com/article1002/how-a-kernel-developer-made-my-styluses-work-again">https://www.davidrevoy.com/article1002/how-a-kernel-developer-made-my-styluses-work-again</a></li>
      <li><a href="https://lwn.net/Articles/801767/">https://lwn.net/Articles/801767/</a></li>
      <li><a href="http://github.com/libratbag/libratbag">http://github.com/libratbag/libratbag</a></li>
      <li><a href="https://libratbag.github.io/">https://libratbag.github.io/</a></li>
      <li><a href="https://github.com/libratbag/ratbag-toolbox">https://github.com/libratbag/ratbag-toolbox</a></li>
      <li><a href="https://github.com/libratbag/ratbag-emu">https://github.com/libratbag/ratbag-emu</a></li>
    </ul>
  </li>
  <li>KEYBOARDS SCANCODES TO KEYCODES
    <ul>
      <li><a href="https://docs.kernel.org/input/event-codes.html">https://docs.kernel.org/input/event-codes.html</a></li>
      <li><a href="https://wiki.archlinux.org/title/Map_scancodes_to_keycodes">https://wiki.archlinux.org/title/Map_scancodes_to_keycodes</a></li>
    </ul>
  </li>
  <li>XKB
    <ul>
      <li><a href="https://xkbcommon.org/">https://xkbcommon.org/</a></li>
      <li><a href="https://web.archive.org/web/20170825051821/http://madduck.net:80/docs/extending-xkb/">https://web.archive.org/web/20170825051821/http://madduck.net:80/docs/extending-xkb/</a></li>
      <li><a href="https://man.archlinux.org/man/xkbcli.1%20xkbcli">https://man.archlinux.org/man/xkbcli.1 xkbcli</a></li>
      <li><a href="https://www.charvolant.org/doug/xkb/html/index.html">https://www.charvolant.org/doug/xkb/html/index.html</a></li>
      <li><a href="https://xkbcommon.org/doc/current/user-configuration.html">https://xkbcommon.org/doc/current/user-configuration.html</a></li>
      <li><a href="https://wiki.archlinux.org/title/X_keyboard_extension">https://wiki.archlinux.org/title/X_keyboard_extension</a></li>
      <li><a href="https://who-t.blogspot.com/2021/02/a-pre-supplied-custom-keyboard-layout.html">https://who-t.blogspot.com/2021/02/a-pre-supplied-custom-keyboard-layout.html</a></li>
      <li><a href="https://who-t.blogspot.com/2020/02/user-specific-xkb-configuration-part-1.html">https://who-t.blogspot.com/2020/02/user-specific-xkb-configuration-part-1.html</a></li>
      <li><a href="https://who-t.blogspot.com/2020/07/user-specific-xkb-configuration-part-2.html">https://who-t.blogspot.com/2020/07/user-specific-xkb-configuration-part-2.html</a></li>
      <li><a href="https://who-t.blogspot.com/2020/08/user-specific-xkb-configuration-part-3.html">https://who-t.blogspot.com/2020/08/user-specific-xkb-configuration-part-3.html</a></li>
      <li><a href="https://who-t.blogspot.com/2020/09/user-specific-xkb-configuration-putting.html">https://who-t.blogspot.com/2020/09/user-specific-xkb-configuration-putting.html</a></li>
      <li><a href="https://who-t.blogspot.com/2021/01/auto-updating-xkb-for-new-kernel.html">https://who-t.blogspot.com/2021/01/auto-updating-xkb-for-new-kernel.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/12/new-udev-property-xkbfixedlayout-for.html">https://who-t.blogspot.com/2016/12/new-udev-property-xkbfixedlayout-for.html</a></li>
      <li><a href="https://xkbcommon.org/doc/current/xkb-intro.html#md_doc_2introduction-to-xkb">https://xkbcommon.org/doc/current/xkb-intro.html#md_doc_2introduction-to-xkb</a></li>
      <li><a href="https://x.org/releases/current/doc/kbproto/xkbproto.pdf">https://x.org/releases/current/doc/kbproto/xkbproto.pdf</a></li>
      <li><a href="https://xkeyboard-config.freedesktop.org/">https://xkeyboard-config.freedesktop.org/</a></li>
      <li><a href="https://xkbcommon.org/doc/current/keymap-text-format-v1-v2.html">https://xkbcommon.org/doc/current/keymap-text-format-v1-v2.html</a></li>
      <li><a href="https://xkbcommon.org/doc/current/rule-file-format.html">https://xkbcommon.org/doc/current/rule-file-format.html</a></li>
      <li><a href="https://xkbcommon.org/doc/current/user-configuration.html">https://xkbcommon.org/doc/current/user-configuration.html</a></li>
      <li><a href="https://xkbcommon.org/doc/current/debugging.html">https://xkbcommon.org/doc/current/debugging.html</a></li>
      <li><a href="https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html">https://web.archive.org/web/20190718184358/http://pascal.tsu.ru/en/xkb/internals.html</a></li>
      <li><a href="https://who-t.blogspot.com/2008/09/rmlvo-keyboard-configuration.html">https://who-t.blogspot.com/2008/09/rmlvo-keyboard-configuration.html</a></li>
      <li><a href="https://www.x.org/wiki/XKB/">https://www.x.org/wiki/XKB/</a></li>
      <li><a href="https://medium.com/@damko/a-simple-humble-but-comprehensive-guide-to-xkb-for-linux-6f1ad5e13450">https://medium.com/@damko/a-simple-humble-but-comprehensive-guide-to-xkb-for-linux-6f1ad5e13450</a></li>
    </ul>
  </li>
  <li>UPPER STACK, CONSOLE, XSERVER, WAYLAND
    <ul>
      <li><a href="https://wiki.archlinux.org/title/Input_remap_utilities">https://wiki.archlinux.org/title/Input_remap_utilities</a></li>
      <li><a href="https://who-t.blogspot.com/2016/12/the-future-of-xinput-xmodmap-setxkbmap.html">https://who-t.blogspot.com/2016/12/the-future-of-xinput-xmodmap-setxkbmap.html</a></li>
      <li><a href="https://wiki.archlinux.org/title/Xmodmap">https://wiki.archlinux.org/title/Xmodmap</a></li>
      <li><a href="https://who-t.blogspot.com/2016/01/xorg-project-vs-xorg-foundation.html">https://who-t.blogspot.com/2016/01/xorg-project-vs-xorg-foundation.html</a></li>
      <li><a href="https://who-t.blogspot.com/2015/01/xf86-input-libinput-compatibility-with.html">https://who-t.blogspot.com/2015/01/xf86-input-libinput-compatibility-with.html</a></li>
      <li><a href="https://who-t.blogspot.com/2016/12/xinput-is-not-configuration-ui.html">https://who-t.blogspot.com/2016/12/xinput-is-not-configuration-ui.html</a></li>
      <li><a href="https://who-t.blogspot.com/2018/06/x-server-pointer-acceleration-analysis.html%20Series">https://who-t.blogspot.com/2018/06/x-server-pointer-acceleration-analysis.html Series</a></li>
      <li><a href="https://who-t.blogspot.com/2021/09/an-xorg-release-without-xwayland.html">https://who-t.blogspot.com/2021/09/an-xorg-release-without-xwayland.html</a></li>
      <li><a href="https://en.wikipedia.org/wiki/X.Org_Server">https://en.wikipedia.org/wiki/X.Org_Server</a></li>
      <li><a href="https://en.wikipedia.org/wiki/Wayland_(protocol)">https://en.wikipedia.org/wiki/Wayland_(protocol)</a></li>
      <li><a href="https://mort.coffee/home/wayland-input-latency/">https://mort.coffee/home/wayland-input-latency/</a></li>
      <li><a href="https://drewdevault.com/2018/07/17/Input-handling-in-wlroots.html">https://drewdevault.com/2018/07/17/Input-handling-in-wlroots.html</a></li>
      <li><a href="https://fcitx-im.org/wiki/Input_method_related_environment_variables">https://fcitx-im.org/wiki/Input_method_related_environment_variables</a></li>
      <li><a href="https://gitlab.freedesktop.org/xorg/driver/xf86-input-libinput">https://gitlab.freedesktop.org/xorg/driver/xf86-input-libinput</a></li>
      <li><a href="https://gitlab.freedesktop.org/xorg/app/xmodmap">https://gitlab.freedesktop.org/xorg/app/xmodmap</a></li>
      <li><a href="https://en.wikipedia.org/wiki/Unicode_input#In_X11_and_Wayland_(Linux_and_other_Unix_variants_including_ChromeOS)">https://en.wikipedia.org/wiki/Unicode_input#In_X11_and_Wayland_(Linux_and_other_Unix_variants_including_ChromeOS)</a></li>
      <li><a href="https://nixers.net/showthread.php?tid=1970">https://nixers.net/showthread.php?tid=1970</a></li>
      <li><a href="https://wiki.archlinux.org/title/Xorg/Keyboard_configuration">https://wiki.archlinux.org/title/Xorg/Keyboard_configuration</a></li>
      <li><a href="https://wiki.archlinux.org/title/Linux_console/Keyboard_configuration">https://wiki.archlinux.org/title/Linux_console/Keyboard_configuration</a></li>
      <li><a href="https://manpages.debian.org/testing/console-setup/setupcon.1.en.html">https://manpages.debian.org/testing/console-setup/setupcon.1.en.html</a></li>
      <li><a href="https://github.com/pierre-labastie/blocaled">https://github.com/pierre-labastie/blocaled</a></li>
      <li><a href="http://www.freedesktop.org/wiki/Software/systemd/localed">http://www.freedesktop.org/wiki/Software/systemd/localed</a></li>
    </ul>
  </li>
  <li>AUTOMATION, LIBEI, INPUTFD, &amp; other protoc
    <ul>
      <li><a href="https://docs.kernel.org/5.10/hid/uhid.html">https://docs.kernel.org/5.10/hid/uhid.html</a></li>
      <li><a href="https://www.kernel.org/doc/html/v4.12/input/uinput.html">https://www.kernel.org/doc/html/v4.12/input/uinput.html</a></li>
      <li><a href="https://github.com/torvalds/linux/blob/2eba5e05d9bcf4cdea995ed51b0f07ba0275794a/drivers/hid/uhid.c#L4">https://github.com/torvalds/linux/blob/2eba5e05d9bcf4cdea995ed51b0f07ba0275794a/drivers/hid/uhid.c#L4</a></li>
      <li><a href="https://github.com/torvalds/linux/blob/master/samples/uhid/uhid-example.c">https://github.com/torvalds/linux/blob/master/samples/uhid/uhid-example.c</a></li>
      <li><a href="https://who-t.blogspot.com/2020/08/libei-library-to-support-emulated-input.html">https://who-t.blogspot.com/2020/08/libei-library-to-support-emulated-input.html</a></li>
      <li><a href="https://who-t.blogspot.com/2022/03/libei-adding-support-for-passive.html">https://who-t.blogspot.com/2022/03/libei-adding-support-for-passive.html</a></li>
      <li><a href="https://who-t.blogspot.com/2022/12/libei-opening-portal-doors.html">https://who-t.blogspot.com/2022/12/libei-opening-portal-doors.html</a></li>
      <li><a href="https://who-t.blogspot.com/2023/05/libei-and-fancy-protocol.html">https://who-t.blogspot.com/2023/05/libei-and-fancy-protocol.html</a></li>
      <li><a href="https://who-t.blogspot.com/2017/04/inputfd-protocol-for-direct-access-to.html">https://who-t.blogspot.com/2017/04/inputfd-protocol-for-direct-access-to.html</a></li>
      <li><a href="https://gitlab.freedesktop.org/libinput/libei/-/tree/main">https://gitlab.freedesktop.org/libinput/libei/-/tree/main</a></li>
      <li><a href="https://libinput.pages.freedesktop.org/libei/">https://libinput.pages.freedesktop.org/libei/</a></li>
      <li><a href="https://libinput.pages.freedesktop.org/libei/api/index.html">https://libinput.pages.freedesktop.org/libei/api/index.html</a></li>
      <li><a href="https://github.com/ReimuNotMoe/ydotool">https://github.com/ReimuNotMoe/ydotool</a></li>
      <li><a href="https://who-t.blogspot.com/2025/08/unplug-tool-to-test-input-devices-via.html">https://who-t.blogspot.com/2025/08/unplug-tool-to-test-input-devices-via.html</a></li>
      <li><a href="https://git.sr.ht/~brocellous/wlrctl">https://git.sr.ht/~brocellous/wlrctl</a></li>
      <li><a href="https://www.semicomplete.com/blog/xdotool-and-exploring-wayland-fragmentation/">https://www.semicomplete.com/blog/xdotool-and-exploring-wayland-fragmentation/</a></li>
    </ul>
  </li>
  <li>INPUT METHOD
    <ul>
      <li><a href="https://en.wikipedia.org/wiki/Input_method">https://en.wikipedia.org/wiki/Input_method</a></li>
      <li><a href="https://linuxcommandlibrary.com/man/scim">https://linuxcommandlibrary.com/man/scim</a></li>
      <li><a href="https://wiki.archlinux.org/title/Input_method">https://wiki.archlinux.org/title/Input_method</a></li>
      <li><a href="https://wiki.archlinux.org/title/IBus">https://wiki.archlinux.org/title/IBus</a></li>
      <li><a href="https://www.csslayer.info/wordpress/linux/key-repetition-and-key-event-handling-issue-with-wayland-input-method-protocols/">https://www.csslayer.info/wordpress/linux/key-repetition-and-key-event-handling-issue-with-wayland-input-method-protocols/</a></li>
      <li><a href="https://wayland.app/protocols/xx-input-method-v2">https://wayland.app/protocols/xx-input-method-v2</a></li>
      <li><a href="https://wiki.qt.io/QtCS2021_-_Wayland_text-input-unstable-v4_protocol">https://wiki.qt.io/QtCS2021_-_Wayland_text-input-unstable-v4_protocol</a></li>
      <li><a href="https://www.chromium.org/chromium-os/chromiumos-design-docs/text-input/">https://www.chromium.org/chromium-os/chromiumos-design-docs/text-input/</a></li>
      <li><a href="https://lwn.net/Articles/503320/">https://lwn.net/Articles/503320/</a></li>
      <li><a href="https://nerufic.com/en/posts/how-input-methods-work-in-linux/">https://nerufic.com/en/posts/how-input-methods-work-in-linux/</a></li>
      <li><a href="https://mail.gnome.org/archives/desktop-devel-list/2012-May/msg00093.html">https://mail.gnome.org/archives/desktop-devel-list/2012-May/msg00093.html</a></li>
      <li><a href="https://wiki.gnome.org/Design(2f)OS(2f)LanguageInput.html">https://wiki.gnome.org/Design(2f)OS(2f)LanguageInput.html</a></li>
      <li><a href="https://docs.gtk.org/gtk4/class.IMContext.html">https://docs.gtk.org/gtk4/class.IMContext.html</a></li>
      <li><a href="https://docs.gtk.org/gtk4/property.Settings.gtk-im-module.html">https://docs.gtk.org/gtk4/property.Settings.gtk-im-module.html</a></li>
    </ul>
  </li>
</ul>


	
<br>
<hr>

<p>
If you want to have a more in depth discussion I'm always available by <a href="https://venam.net/blog/about.html">email or irc</a>.
We can discuss and argue about what you like and dislike, about new ideas to consider, opinions, etc..<br>
If you don't feel like "having a discussion" or are intimidated by emails
then you can simply say something small in the comment sections below
and/or share it with your friends.
</p>
<br>






  </article>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Pakistan says rooftop solar output to exceed grid demand in some hubs next year (225 pts)]]></title>
            <link>https://www.reuters.com/sustainability/boards-policy-regulation/pakistan-says-rooftop-solar-output-exceed-grid-demand-some-hubs-next-year-2025-11-22/</link>
            <guid>46070915</guid>
            <pubDate>Thu, 27 Nov 2025 16:42:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.reuters.com/sustainability/boards-policy-regulation/pakistan-says-rooftop-solar-output-exceed-grid-demand-some-hubs-next-year-2025-11-22/">https://www.reuters.com/sustainability/boards-policy-regulation/pakistan-says-rooftop-solar-output-exceed-grid-demand-some-hubs-next-year-2025-11-22/</a>, See on <a href="https://news.ycombinator.com/item?id=46070915">Hacker News</a></p>
Couldn't get https://www.reuters.com/sustainability/boards-policy-regulation/pakistan-says-rooftop-solar-output-exceed-grid-demand-some-hubs-next-year-2025-11-22/: Error: Request failed with status code 401]]></description>
        </item>
    </channel>
</rss>