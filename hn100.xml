<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 16 Apr 2025 09:30:01 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Markov Chain Monte Carlo Without All the Bullshit (2015) (114 pts)]]></title>
            <link>https://www.jeremykun.com/2015/04/06/markov-chain-monte-carlo-without-all-the-bullshit/</link>
            <guid>43700633</guid>
            <pubDate>Wed, 16 Apr 2025 02:01:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.jeremykun.com/2015/04/06/markov-chain-monte-carlo-without-all-the-bullshit/">https://www.jeremykun.com/2015/04/06/markov-chain-monte-carlo-without-all-the-bullshit/</a>, See on <a href="https://news.ycombinator.com/item?id=43700633">Hacker News</a></p>
<div id="readability-page-1" class="page"><p>This article was ported from my old Wordpress blog <a href="https://jeremykun.wordpress.com/2015/04/06/markov-chain-monte-carlo-without-all-the-bullshit/">here,</a> If you see any issues with the rendering or layout, please <a href="mailto:mathintersectprogramming@gmail.com">send me an email</a>.</p><div itemprop="articleBody" id="content"><p>I have a little secret: I don’t like the terminology, notation, and style of writing in statistics. I find it unnecessarily complicated. This shows up when trying to read about Markov Chain Monte Carlo methods. Take, for example, the abstract to the Markov Chain Monte Carlo article in the <a href="https://doi.org/10.1002/0470011815.b2a14021" rel="external">Encyclopedia of Biostatistics.</a></p><blockquote><p>Markov chain Monte Carlo (MCMC) is a technique for estimating by simulation the expectation of a statistic in a complex model. Successive random selections form a Markov chain, the stationary distribution of which is the target distribution. It is particularly useful for the evaluation of posterior distributions in complex Bayesian models. In the Metropolis–Hastings algorithm, items are selected from an arbitrary “proposal” distribution and are retained or not according to an acceptance rule. The Gibbs sampler is a special case in which the proposal distributions are conditional distributions of single components of a vector parameter. Various special cases and applications are considered.</p></blockquote><p>I can only vaguely understand what the author is saying here (and really only because I know ahead of time what MCMC is). There are certainly references to more advanced things than what I’m going to cover in this post. But it seems very difficult to find an explanation of Markov Chain Monte Carlo <em>without</em> superfluous jargon. The “bullshit” here is the implicit claim of an author that such jargon is needed. Maybe it is to explain advanced applications (like attempts to do “inference in Bayesian networks”), but it is certainly not needed to define or analyze the basic ideas.</p><p>So to counter, here’s my own explanation of Markov Chain Monte Carlo, inspired by the treatment of <a href="http://web.archive.org/web/20150204160331/http://research.microsoft.com/en-US/people/kannan/book-no-solutions-aug-21-2014.pdf" rel="external">John Hopcroft and Ravi Kannan</a>.</p><h2 id="the-problem-is-drawing-from-a-distribution">The Problem is Drawing from a Distribution</h2><p>Markov Chain Monte Carlo is a technique to solve the problem of <em>sampling from a complicated distribution.</em> Let me explain by the following imaginary scenario. Say I have a magic box which can estimate probabilities of baby names very well. I can give it a string like “Malcolm” and it will tell me the exact probability $ p_{\textup{Malcolm}}$ that you will choose this name for your next child. So there’s a distribution $ D$ over all names, it’s very specific to your preferences, and for the sake of argument say this distribution is fixed and you don’t get to tamper with it.</p><p>Now comes the problem: I want to <em>efficiently draw</em> a name from this distribution $ D$. This is the problem that Markov Chain Monte Carlo aims to solve. Why is it a problem? Because I have no idea what process you use to pick a name, so I can’t simulate that process myself. Here’s another method you could try: generate a name $ x$ uniformly at random, ask the machine for $ p_x$, and then flip a biased coin with probability $ p_x$ and use $ x$ if the coin lands heads. The problem with this is that there are exponentially many names! The variable here is the number of bits needed to write down a name $ n = |x|$. So either the probabilities $ p_x$ will be exponentially small and I’ll be flipping for a very long time to get a single name, or else there will only be a few names with nonzero probability and it will take me exponentially many draws to find them. Inefficiency is the death of me.</p><p>So this is a serious problem! Let’s restate it formally just to be clear.</p><p><strong>Definition (The sampling problem):</strong> Let $ D$ be a distribution over a finite set $ X$. You are given black-box access to the probability distribution function $ p(x)$ which outputs the probability of drawing $ x \in X$ according to $ D$. Design an efficient randomized algorithm $ A$ which outputs an element of $ X$ so that the probability of outputting $ x$ is approximately $ p(x)$. More generally, output a sample of elements from $ X$ drawn according to $ p(x)$.</p><p>Assume that $ A$ has access to only fair random coins, though this allows one to efficiently simulate flipping a <a href="https://www.jeremykun.com/2014/02/12/simulating-a-biased-coin-with-a-fair-coin/" title="Simulating a Biased Coin with a Fair Coin">biased coin of any desired probability</a>.</p><p>Notice that with such an algorithm we’d be able to do things like estimate the expected value of some random variable $ f : X \to \mathbb{R}$. We could take a large sample $ S \subset X$ via the solution to the sampling problem, and then compute the average value of $ f$ on that sample. This is what a Monte Carlo method does when sampling is easy. In fact, the Markov Chain solution to the sampling problem will allow us to do the sampling <em>and</em> the estimation of $ \mathbb{E}(f)$ in one fell swoop if you want.</p><p>But the core problem is really a sampling problem, and “Markov Chain Monte Carlo” would be more accurately called the “Markov Chain Sampling Method.” So let’s see why a Markov Chain could possibly help us.</p><h2 id="random-walks-the-markov-chain-part-of-mcmc">Random Walks, the “Markov Chain” part of MCMC</h2><p>Markov Chain is essentially a fancy term for a random walk on a graph.</p><p>You give me a directed graph $ G = (V,E)$, and for each edge $ e = (u,v) \in E$ you give me a number $ p_{u,v} \in [0,1]$. In order to make a random walk make sense, the $ p_{u,v}$ need to satisfy the following constraint:</p><p>For any vertex $ x \in V$, the set all values $ p_{x,y}$ on outgoing edges $ (x,y)$ must sum to 1, i.e. form a probability distribution.</p><p>If this is satisfied then we can take a random walk on $ G$ according to the probabilities as follows: start at some vertex $ x_0$. Then pick an outgoing edge at random according to the probabilities on the outgoing edges, and follow it to $ x_1$. Repeat if possible.</p><p>I say “if possible” because an arbitrary graph will not necessarily have any outgoing edges from a given vertex. We’ll need to impose some additional conditions on the graph in order to apply random walks to Markov Chain Monte Carlo, but in any case the idea of randomly walking is well-defined, and we call the whole object $ (V,E, \{ p_e \}_{e \in E})$ a <em>Markov chain.</em></p><p>Here is an example where the vertices in the graph correspond to emotional states.</p><figure><img src="https://www.jeremykun.com/img/2015/markov01.gif" width="646px"><figcaption><h4>An example Markov chain</h4></figcaption></figure><p>In statistics land, they take the “state” interpretation of a random walk very seriously. They call the edge probabilities “state-to-state transitions.” The main theorem we need to do anything useful with Markov chains is the stationary distribution theorem (sometimes called the “Fundamental Theorem of Markov Chains,” and for good reason). What it says intuitively is that for a very long random walk, the probability that you end at some vertex $ v$ is independent of where you started! All of these probabilities taken together is called the <em>stationary distribution</em> of the random walk, and it is uniquely determined by the Markov chain.</p><p>However, for the reasons we stated above (“if possible”), the stationary distribution theorem is not true of every Markov chain. The main property we need is that the graph $ G$ is <em>strongly connected.</em> Recall that a directed graph is called connected if, when you ignore direction, there is a path from every vertex to every other vertex. It is called <em>strongly connected</em> if you still get paths everywhere when considering direction. If we additionally require the stupid edge-case-catcher that no edge can have zero probability, then strong connectivity (of one component of a graph) is equivalent to the following property:</p><p>For every vertex $ v \in V(G)$, an infinite random walk started at $ v$ will return to $ v$ with probability 1.</p><p>In fact it will return infinitely often. This property is called the <em>persistence</em> of the state $ v$ by statisticians. I dislike this term because it appears to describe a property of a vertex, when to me it describes a property of the connected component containing that vertex. In any case, since in Markov Chain Monte Carlo we’ll be picking the graph to walk on (spoiler!) we will ensure the graph is strongly connected by design.</p><p>Finally, in order to describe the stationary distribution in a more familiar manner (using linear algebra), we will write the transition probabilities as a matrix $ A$ where entry $ a_{j,i} = p_{(i,j)}$ if there is an edge $ (i,j) \in E$ and zero otherwise. Here the rows and columns correspond to vertices of $ G$, and each <em>column</em> $ i$ forms the probability distribution of going from state $ i$ to some other state in one step of the random walk. Note $ A$ is the transpose of the weighted adjacency matrix of the directed weighted graph $ G$ where the weights are the transition probabilities (the reason I do it this way is because matrix-vector multiplication will have the matrix on the left instead of the right; see below).</p><p>This matrix allows me to describe things nicely using the language of linear algebra. In particular if you give me a basis vector $ e_i$ interpreted as “the random walk currently at vertex $ i$,” then $ Ae_i$ gives a vector whose $ j$-th coordinate is the probability that the random walk would be at vertex $ j$ after one more step in the random walk. Likewise, if you give me a probability distribution $ q$ over the vertices, then $ Aq$ gives a probability vector interpreted as follows:</p><p>If a random walk is in state $ i$ with probability $ q_i$, then the $ j$-th entry of $ Aq$ is the probability that after one more step in the random walk you get to vertex $ j$.</p><p>Interpreted this way, the stationary distribution is a probability distribution $ \pi$ such that $ A \pi = \pi$, in other words $ \pi$ is an eigenvector of $ A$ with eigenvalue 1.</p><p>A quick side note for avid readers of this blog: this analysis of a random walk is exactly what we did back in the early days of this blog when we studied <a href="https://www.jeremykun.com/2011/06/12/googles-pagerank-introduction/" title="Google’s PageRank – Introduction">the PageRank algorithm</a> for ranking webpages. There we called the matrix $ A$ “a web matrix,” did random walks on it, and found a special eigenvalue whose eigenvector was a “stationary distribution” that we used to rank web pages (this used something called the <a href="https://en.wikipedia.org/wiki/Perron%E2%80%93Frobenius_theorem" rel="external">Perron-Frobenius theorem</a>, which says a random-walk matrix has that special eigenvector). There we described an algorithm to actually find that eigenvector by iteratively multiplying $ A$. The following theorem is essentially a variant of this algorithm but works under weaker conditions; for the web matrix we added additional “fake” edges that give the needed stronger conditions.</p><p><strong>Theorem:</strong> Let $ G$ be a strongly connected graph with associated edge probabilities $ \{ p_e \}_e \in E$ forming a Markov chain. For a probability vector $ x_0$, define $ x_{t+1} = Ax_t$ for all $ t \geq 1$, and let $ v_t$ be the long-term average $ v_t = \frac1t \sum_{s=1}^t x_s$. Then:</p><ol><li>There is a unique probability vector $ \pi$ with $ A \pi = \pi$.</li><li>For all $ x_0$, the limit $ \lim_{t \to \infty} v_t = \pi$.</li></ol><p><em>Proof.</em> Since $ v_t$ is a probability vector we just want to show that $ |Av_t – v_t| \to 0$ as $ t \to \infty$. Indeed, we can expand this quantity as</p><p>$$\displaystyle \begin{aligned} Av_t – v_t &amp;=\frac1t (Ax_0 + Ax_1 + \dots + Ax_{t-1}) – \frac1t (x_0 + \dots + x_{t-1}) \\\ &amp;= \frac1t (x_t – x_0) \end{aligned}$$</p><p>But $ x_t, x_0$ are unit vectors, so their difference is at most 2, meaning $ |Av_t – v_t| \leq \frac2t \to 0$. Now it’s clear that this does not depend on $ v_0$. For uniqueness we will cop out and appeal to the Perron-Frobenius theorem that says any matrix of this form has a unique such (normalized) eigenvector.</p><p>$$\square$$</p><p>One additional remark is that, in addition to computing the stationary distribution by actually computing this average or using an eigensolver, one can analytically solve for it as the inverse of a particular matrix. Define $ B = A-I_n$, where $ I_n$ is the $ n \times n$ identity matrix. Let $ C$ be $ B$ with a row of ones appended to the bottom and the topmost row removed. Then one can show (quite opaquely) that the last column of $ C^{-1}$ is $ \pi$. We leave this as an exercise to the reader, because I’m pretty sure nobody uses this method in practice.</p><p>One final remark is about why we need to take an average over all our $ x_t$ in the theorem above. There is an extra technical condition one can add to strong connectivity, called <em>aperiodicity</em>, which allows one to beef up the theorem so that $ x_t$ itself converges to the stationary distribution. Rigorously, aperiodicity is the property that, regardless of where you start your random walk, after some sufficiently large number of steps $ n$ the random walk has a positive probability of being at every vertex at every subsequent step. As an example of a graph where aperiodicity fails: an undirected cycle on an even number of vertices. In that case there will only be a positive probability of being at certain vertices every <em>other</em> step, and averaging those two long term sequences gives the actual stationary distribution.</p><figure><img src="https://www.jeremykun.com/img/2015/screen-shot-2015-04-07-at-6-55-39-pm.png" width="377px"><figcaption><h4>Image source: Wikipedia</h4></figcaption></figure><p>One way to guarantee that your Markov chain is aperiodic is to ensure there is a positive probability of staying at any vertex. I.e., that your graph has a self-loop. This is what we’ll do in the next section.</p><h2 id="constructing-a-graph-to-walk-on">Constructing a graph to walk on</h2><p>Recall that the problem we’re trying to solve is to draw from a distribution over a finite set $ X$ with probability function $ p(x)$. The MCMC method is to construct a Markov chain whose stationary distribution is exactly $ p$, even when you just have black-box access to evaluating $ p$. That is, you (implicitly) pick a graph $ G$ and (implicitly) choose transition probabilities for the edges to make the stationary distribution $ p$. Then you take a long enough random walk on $ G$ and output the $ x$ corresponding to whatever state you land on.</p><p>The easy part is coming up with a graph that has the right stationary distribution (in fact, “most” graphs will work). The hard part is to come up with a graph where you can prove that the convergence of a random walk to the stationary distribution is fast in comparison to the size of $ X$. Such a proof is beyond the scope of this post, but the “right” choice of a graph is not hard to understand.</p><p>The one we’ll pick for this post is called the <strong>Metropolis-Hastings</strong> algorithm. The input is your black-box access to $ p(x)$, and the output is a set of rules that implicitly define a random walk on a graph whose vertex set is $ X$.</p><p>It works as follows: you pick some way to put $ X$ on a lattice, so that each state corresponds to some vector in $ \{ 0,1, \dots, n\}^d$. Then you add (two-way directed) edges to all neighboring lattice points. For $ n=5, d=2$ it would look like this:</p><figure><a href="https://www.jeremykun.com/img/2015/2dlattice.jpg"><img src="https://www.jeremykun.com/img/2015/2dlattice.jpg" width="195px"></a><figcaption><h4>Image credit http://www.ams.org/samplings/feature-column/fcarc-taxi</h4></figcaption></figure><p>And for $ d=3, n \in \{2,3\}$ it would look like this:</p><figure><a href="https://www.jeremykun.com/img/2015/lattice.gif"><img src="https://www.jeremykun.com/img/2015/lattice.gif" width="343px"></a><figcaption><h4>lattice</h4></figcaption></figure><p>You have to be careful here to ensure the vertices you choose for $ X$ are not disconnected, but in many applications $ X$ is naturally already a lattice.</p><p>Now we have to describe the transition probabilities. Let $ r$ be the maximum degree of a vertex in this lattice ($ r=2d$). Suppose we’re at vertex $ i$ and we want to know where to go next. We do the following:</p><ol><li>Pick neighbor $ j$ with probability $ 1/r$ (there is some chance to stay at $ i$).</li><li>If you picked neighbor $ j$ and $ p(j) \geq p(i)$ then deterministically go to $ j$.</li><li>Otherwise, $ p(j) &lt; p(i)$, and you go to $ j$ with probability $ p(j) / p(i)$.</li></ol><p>We can state the probability weight $ p_{i,j}$ on edge $ (i,j)$ more compactly as</p><p>$$\displaystyle p_{i,j} = \frac1r \min(1, p(j) / p(i)) \\\ p_{i,i} = 1 – \sum_{(i,j) \in E(G); j \neq i} p_{i,j}$$</p><p>It is easy to check that this is indeed a probability distribution for each vertex $ i$. So we just have to show that $ p(x)$ is the stationary distribution for this random walk.</p><p>Here’s a fact to do that: if a probability distribution $ v$ with entries $ v(x)$ for each $ x \in X$ has the property that $ v(x)p_{x,y} = v(y)p_{y,x}$ for all $ x,y \in X$, the $ v$ is the stationary distribution. To prove it, fix $ x$ and take the sum of both sides of that equation over all $ y$. The result is exactly the equation $ v(x) = \sum_{y} v(y)p_{y,x}$, which is the same as $ v = Av$. Since the stationary distribution is the unique vector satisfying this equation, $ v$ has to be it.</p><p>Doing this with out chosen $ p(i)$ is easy, since $ p(i)p_{i,j}$ and $ p(i)p_{j,i}$ are both equal to $ \frac1r \min(p(i), p(j))$ by applying a tiny bit of algebra to the definition. So we’re done! One can just randomly walk according to these probabilities and get a sample.</p><h2 id="last-words">Last words</h2><p>The last thing I want to say about MCMC is to show that you can estimate the expected value of a function $ \mathbb{E}(f)$ simultaneously while random-walking through your Metropolis-Hastings graph (or any graph whose stationary distribution is $ p(x)$). By definition the expected value of $ f$ is $ \sum_x f(x) p(x)$.</p><p>Now what we can do is compute the average value of $ f(x)$ just among those states we’ve visited during our random walk. With a little bit of extra work you can show that this quantity will converge to the true expected value of $ f$ at about the same time that the random walk converges to the stationary distribution. (Here the “about” means we’re off by a constant factor depending on $ f$). In order to prove this you need some extra tools I’m too lazy to write about in this post, but the point is that it works.</p><p>The reason I did not start by describing MCMC in terms of estimating the expected value of a function is because the core problem is a sampling problem. Moreover, there are many applications of MCMC that need nothing more than a sample. For example, MCMC can be used to estimate the volume of an arbitrary (maybe high dimensional) convex set. See <a href="http://www.cs.berkeley.edu/~sinclair/cs294/n1.pdf" rel="external">these lecture notes</a> of Alistair Sinclair for more.</p><p>If demand is popular enough, I could implement the Metropolis-Hastings algorithm in code (it wouldn’t be industry-strength, but perhaps illuminating? I’m not so sure…).</p><p>Until next time!</p><hr><hr></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[CVE program faces swift end after DHS fails to renew contract (1012 pts)]]></title>
            <link>https://www.csoonline.com/article/3963190/cve-program-faces-swift-end-after-dhs-fails-to-renew-contract-leaving-security-flaw-tracking-in-limbo.html</link>
            <guid>43700607</guid>
            <pubDate>Wed, 16 Apr 2025 01:57:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.csoonline.com/article/3963190/cve-program-faces-swift-end-after-dhs-fails-to-renew-contract-leaving-security-flaw-tracking-in-limbo.html">https://www.csoonline.com/article/3963190/cve-program-faces-swift-end-after-dhs-fails-to-renew-contract-leaving-security-flaw-tracking-in-limbo.html</a>, See on <a href="https://news.ycombinator.com/item?id=43700607">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
					<p><span>News Analysis</span></p><p><span>Apr 15, 2025</span><span>6 mins</span></p><p><span><span>Government</span></span><span><span>Threat and Vulnerability Management</span></span></p></div><article id="post-3963190">
	<div>
			<div>
						<div>
			<h2>
				MITRE’s 25-year-old Common Vulnerabilities and Exposures (CVE) program will end April 16 after DHS did not renew its funding contract for reasons unspecified. Experts say ending the program, which served as the crux for most cybersecurity defense programs, is a tragedy.			</h2>
			
		</div>					
						<div id="remove_no_follow">
		<div>




<p>In a stunning development that demolishes a cornerstone of cybersecurity defense, nonprofit R&amp;D organization MITRE said that its contract with the Department of Homeland Security (DHS) to maintain the Common Vulnerabilities and Exposures (CVE) database, which organizes computer vulnerabilities, will expire at midnight on April 16.</p>



<p>Yosry Barsoum, vice president and director of the Center for Securing the Homeland at MITRE, wrote in a missive to the CVE board, “On Wednesday, April 16, 2025, funding for MITRE to develop, operate, and modernize the Common Vulnerabilities and Exposures (CVE®) Program and related programs, such as the Common Weakness Enumeration (CWE™) Program, will expire. The government continues to make considerable efforts to support MITRE’s role in the program, and MITRE remains committed to CVE as a global resource.”</p>



<h2 id="end-of-cve-program-seen-as-tragic">End of CVE program seen as ‘tragic’</h2>



<p>Sasha Romanosky, senior policy researcher at the Rand Corporation, branded the end to the CVE program as “tragic,” a sentiment echoed by many cybersecurity and CVE experts reached for comment.</p>
</div>
							
							<div>


<p>“CVE naming and assignment to software packages and versions are the foundation upon which the software vulnerability ecosystem is based,” Romanosky said. “Without it, we can’t track newly discovered vulnerabilities. We can’t score their severity or predict their exploitation. And we certainly wouldn’t be able to make the best decisions regarding patching them.”</p>

		

			


<p>Ben Edwards, principal research scientist at Bitsight, told CSO, “My reaction is sadness and disappointment. This is a valuable resource that should absolutely be funded, and not renewing the contract is a mistake.”</p>



<p>He added “I am hopeful any interruption is brief and that if the contract fails to be renewed, other stakeholders within the ecosystem can pick up where MITRE left off. The federated framework and openness of the system make this possible, but it’ll be a rocky road if operations do need to shift to another entity.”</p>
</div>
							
							<div>


<h2 id="mitres-cve-program-foundational-to-cybersecurity">MITRE’s CVE program foundational to cybersecurity</h2>



<p>MITRE’s <a href="https://www.cve.org/">CVE program</a> is a foundational pillar of the global cybersecurity ecosystem and is the de facto standard for identifying vulnerabilities and guiding defenders’ vulnerability management programs. It provides foundational data to vendor products across vulnerability management, cyber threat intelligence, security information, event management, and endpoint detection and response.</p>



<p>Although the National Institute of Standards and Technology (NIST) enriches the MITRE CVE records with additional information through its <a href="https://www.nist.gov/itl/nvd">National Vulnerability Database</a> (NVD), and CISA has helped enrich MITRE’s CVE records with its “<a href="https://www.cisa.gov/news-events/news/unlocking-vulnrichment-enriching-cve-data">vulnrichment</a>” program <a href="https://www.csoonline.com/article/2106228/backlogs-at-national-vulnerability-database-prompt-action-from-nist-and-cisa.html">due to funding shortfalls in the NVD program</a>, MITRE is the originator of the <a href="https://www.csoonline.com/article/562175/what-is-cve-its-definition-and-purpose.html">CVE records</a> and serves at the primary source for identifying security flaws.</p>



<p>“If MITRE’s funding goes away, it causes an immediate cascading effect that will impact vulnerability management on a global scale,” Brian Martin, vulnerability historian, CSO of the Security Errata project, and former CVE board member, <a href="https://www.linkedin.com/feed/update/urn:li:activity:7318000614334943232/">wrote</a> on LinkedIn.</p>
</div>
							
							<div>


<p>“First, the federated model and CVE Numbering Authorities (CNA) can no longer assign IDs and send info to MITRE for quick publication. Second, all of that is the foundation for the National Vulnerability Database (NVD), which is already beyond struggling, with a backlog of over 30,000 vulnerabilities and the recent announcement of over 80,000 ‘deferred’ (meaning will not be fully analyzed by their current standards).”</p>



<p>Martin added, “Third, every company that maintains ‘their own vulnerability database’ that is essentially lipstick on the CVE pig will have to find alternate sources of intelligence. Fourth, national vulnerability databases like China’s and Russia’s, among others, will largely dry up (Russia more than China). Fourth [sic], hundreds, if not thousands, of National / Regional CERTs around the world, no longer have that source of free vulnerability intelligence. Fifth [sic], every company in the world that relied on CVE/NVD for vulnerability intelligence is going to experience swift and sharp pains to their vulnerability management program.”</p>



<h2 id="why-is-the-contract-ending">Why is the contract ending?</h2>



<p>It’s unclear what led to DHS’s decision to end the contract after 25 years of funding <a href="https://cyberscoop.com/cve-program-history-mitre-nist-1999-2024/">the highly regarded</a> program. The Trump administration, primarily through Elon Musk’s Department of Government Efficiency initiative, has been slashing government spending across the board, particularly at the Cybersecurity and Infrastructure Security Agency (CISA), through which DHS funds the MITRE CVE program.</p>
</div>
							
							<div>


<p>Although CISA has already been through two funding cuts, press reports suggest that nearly 40% of the agency’s staff, or around 1,300 employees, <a href="https://therecord.media/trump-administration-planning-workforce-cuts-at-cisa">are still slated</a> for termination. However, sources say that compared to the budget cuts made elsewhere in the federal government, the expense of running the CVE program are minor and “won’t break the bank.”</p>



<h2 id="what-happens-next">What happens next?</h2>



<p>Sources close to the CVE program say that starting at midnight on April 16, MITRE will no longer add records to its CVE database. However, historical CVE records will be <a href="https://github.com/CVEProject">available on GitHub</a>.</p>



<p>The real question is whether a private sector alternative to MITRE’s program emerges.</p>
</div>
							
							<div>


<p>“It’s difficult to speculate on what services could be impacted reading the note from MITRE,” Patrick Garrity, a security researcher at threat intelligence firm Vulncheck, told CSO. “The current vulnerability ecosystem is fragile after seeing NIST NVD’s failure last year, and any impacts to the CVE Program could have detrimental impacts on defenders and the security community. VulnCheck remains committed to helping fill any gaps that might arise.”</p>



<p>Garrity <a href="https://www.linkedin.com/feed/update/urn:li:activity:7318000766122618881/">posted on LinkedIn</a>, “Given the current uncertainty surrounding which services at MITRE or within the CVE Program may be affected, VulnCheck has proactively reserved 1,000 CVEs for 2025,” adding that Vulncheck “will continue to provide CVE assignments to the community in the days and weeks ahead.”</p>



<p>A CISA spokesperson told CSO, “CISA is the primary sponsor for the Common Vulnerabilities and Exposure (CVE) program, which is used by government and industry alike to disclose, catalog, and share information on&nbsp;technology vulnerabilities that can put the nation’s critical infrastructure at risk.&nbsp; Although CISA’s contract with the MITRE Corporation will lapse after April 16, we are&nbsp;urgently&nbsp;working to&nbsp;mitigate impact and to maintain CVE services&nbsp;on which global stakeholders rely.”</p>
</div>
							
							</div>					</div>

			<!--right side bar-->
			<div id="rightrail-wrapper">
					<p>
				SUBSCRIBE TO OUR NEWSLETTER			</p>
							<h3>
				From our editors straight to your inbox			</h3>
							<p>
				Get started by entering your email address below.			</p>
				
	</div>
			<!--right side bar ends here-->

		</div>
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Homeland Security funding for CVE program expires (138 pts)]]></title>
            <link>https://www.theregister.com/2025/04/16/homeland_security_funding_for_cve/</link>
            <guid>43700258</guid>
            <pubDate>Wed, 16 Apr 2025 01:05:26 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theregister.com/2025/04/16/homeland_security_funding_for_cve/">https://www.theregister.com/2025/04/16/homeland_security_funding_for_cve/</a>, See on <a href="https://news.ycombinator.com/item?id=43700258">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="body">
<p>US government funding for the world's CVE program – the centralized Common Vulnerabilities and Exposures database of product security flaws – ends Wednesday.</p>
<p>The 25-year-old CVE program plays a huge role in vulnerability management. It is responsible overseeing the assignment and organizing of unique CVE ID numbers, such as <a target="_blank" rel="nofollow" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160">CVE-2014-0160</a> and <a target="_blank" rel="nofollow" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5754">CVE-2017-5754</a>, for specific vulnerabilities, in this case OpenSSL's <a target="_blank" href="https://www.theregister.com/2014/04/09/heartbleed_explained/">Heartbleed</a> and Intel's <a target="_blank" href="https://www.theregister.com/2018/01/02/intel_cpu_design_flaw/">Meltdown</a>, so that when referring to particular flaws and patches, everyone is agreed on exactly what we're all talking about.</p>
<p>It is used by companies big and small, developers, researchers, the public sector, and more as the primary system for identifying and squashing bugs. When multiple people find the same hole, CVEs are useful for ensuring everyone is working toward that one specific issue.</p>
<blockquote>

<p>CVE is a cornerstone of cybersecurity, and any gaps in CVE support will put our critical infrastructure and national security at unacceptable risk</p>
</blockquote>
<p>While the whole world's vulnerability management efforts aren't going to descend into chaos overnight, there is a concern that in a month or two they may. The lack of US government funding means that, unless someone else steps in to fill the gap, this standardized system for naming and tracking vulnerabilities may falter or shut down, new CVEs may no longer be published, and the <a target="_blank" rel="nofollow" href="https://cve.mitre.org/">program's website</a> may go offline.</p>
<p>Not-for-profit outfit MITRE has a contract with the US Department of Homeland Security to operate the CVE program, and on Tuesday the group confirmed this arrangement has not been renewed. This comes as the Trump administration scours around the federal government for costs to trim.</p>

    

<p>"On Wednesday, April 16, funding for MITRE to develop, operate, and modernize the Common Vulnerabilities and Exposures Program and related programs, such as the Common Weakness Enumeration Program, will expire," Yosry Barsoum, MITRE's vice president and director at the Center for Securing the Homeland, told <em>The Register</em>.&nbsp;</p>

        


        

<p>"The government continues to make considerable efforts to support MITRE's role in the program and MITRE remains committed to CVE as a global resource," Barsoum added.</p>
<p>The Common Weakness Enumeration program is a centrally managed <a target="_blank" rel="nofollow" href="https://cwe.mitre.org/">database</a> of bug types.</p>

        

<p>The expiration came to light after a letter sent to CVE program board members was <a target="_blank" href="https://bsky.app/profile/tib3rius.bsky.social/post/3lmulrbygoe2g" rel="nofollow">leaked</a> on Bluesky. In that memo, Barsoum confided:</p>

<p>Historical CVE records will at least remain <a target="_blank" href="https://github.com/CVEProject" rel="nofollow">available at GitHub</a>.</p>
<p>"CVE is a cornerstone of cybersecurity, and any gaps in CVE support will put our critical infrastructure and national security at unacceptable risk," Luta Security founder and CEO Katie Moussouris, who pioneered Microsoft's vulnerability disclosure program, told <em>The Register</em>.</p>
<p>"All industries worldwide depend on the CVE program to keep their heads above water when it comes to managing threats, so an abrupt halt like this would be like depriving the cybersecurity industry of oxygen and expecting it to spontaneously sprout gills," Moussouris said.</p>
<p>It basically works like this: When an individual researcher or an organization discovers a new bug in some product, a CVE program partner — there are currently <a href="https://www.cve.org/PartnerInformation/ListofPartners" rel="nofollow">a few hundred across 40 countries</a> — is asked to assess the vulnerability report and <a target="_blank" rel="nofollow" href="https://blog.httpcs.com/en/cve-en/">assign</a> a unique CVE identifier for the flaw if and as necessary.</p>

        

<p>The program is <a target="_blank" rel="nofollow" href="https://www.cisa.gov/known-exploited-vulnerabilities#:~:text=The%20CVE%20Program%20is%20sponsored,catalog%20publicly%20disclosed%20cybersecurity%20vulnerabilities.">sponsored</a>, and largely <a target="_blank" rel="nofollow" href="https://www.usaspending.gov/award/CONT_AWD_70RCSJ23FR0000015_7001_70RSAT20D00000001_7001">funded</a> by the Cybersecurity and Infrastructure Security Agency, aka CISA, under the umbrella of the US Department of Homeland Security.</p>
<p>"I can say that, having been in this industry for longer than CVEs themselves, it won't be good," Dustin Childs, head of threat awareness at Trend Micro's Zero Day Initiative, told <em>The Register</em>.</p>
<blockquote>

<p>I can say that, having been in this industry for longer than CVEs themselves, it won't be good</p>
</blockquote>
<p>"Before CVEs, each company referred to vulnerabilities using their own vernacular," he added. "Customers were confused about whether they were protected or impacted from a particular bug. And was a time when there were much fewer companies and infinitely fewer bugs."</p>
<p>To put this in perspective: More than <a target="_blank" rel="nofollow" href="https://jerrygamblin.com/2025/01/05/2024-cve-data-review//">40,000 new CVEs</a> were published last year.</p>
<p>"If MITRE were to lose funding for the CVE, we can expect considerable confusion again until someone else picks up the flag," Childs continued, noting that this would require some sort of industry consortium —&nbsp;but nothing along those lines currently exists.</p>
<p>"Vulnerability management will become a mess as enterprises struggle to confirm they are in compliance with regulations and directives," he said. "Let's hope this is resolved quickly."</p>
<ul>

<li><a href="https://www.theregister.com/2016/03/18/mitre_rolls_out_new_federated_faster_cve_system_after_iregi_reveal/">MITRE rolls out new CVE system after <i>Reg</i> reveal</a></li>

<li><a href="https://www.theregister.com/2016/05/25/mitre_fighter_deploys_name_logo_website_combo_in_cve_plea/">MITRE fighter says CVE delays are no laughing matter, names bug ROFL in branding protest</a></li>

<li><a href="https://www.theregister.com/2024/10/02/cve_pileup_nvd_missed_deadline/">NIST's security flaw database still backlogged with 17K+ unprocessed bugs. Not great</a></li>

<li><a href="https://www.theregister.com/2025/04/14/swalwell_cisa_cuts/">Cyber congressman demands answers before CISA gets cut down to size</a></li>

<li><a href="https://www.theregister.com/2025/04/08/cisa_cuts_threat_intel/">As CISA braces for more cuts, threat intel sharing takes a hit</a></li>
</ul>
<p>VulnCheck, a private vulnerability intel company that is also a CVE Naming Authority, aka CNA, on Tuesday said it has proactively <a target="_blank" rel="nofollow" href="https://www.linkedin.com/feed/update/urn:li:activity:7318000766122618881/">reserved</a> 1,000 CVEs for 2025.&nbsp;</p>
<p>Still, this only preserves the functionality of the program for a couple months at best.&nbsp;</p>
<blockquote>

<p>The security industry needs to step in to fill the void</p>
</blockquote>
<p>"MITRE, as a CNA, issues between 300-600 CVEs each month, so by reserving 1,000 hypothetically, we can assign a CVE to vulnerabilities for 1-2 months as long as the core service continues," Patrick Garrity, security researcher at VulnCheck, told <em>The Register</em>.&nbsp;&nbsp;</p>
<p>"The CVE program is a critical resource globally used by nearly every organization in the world, so the implications of a pause will have downstream implications for security tooling, security teams, and every organization that cares about security," he added.</p>
<p>"It would be terrible to see government funding for the CVE program go away, but we also believe that this is a time when the security industry needs to step in to fill the void." ®</p>                                
                    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How dairy robots are changing work for cows and farmers (161 pts)]]></title>
            <link>https://spectrum.ieee.org/lely-dairy-robots</link>
            <guid>43699188</guid>
            <pubDate>Tue, 15 Apr 2025 22:26:35 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://spectrum.ieee.org/lely-dairy-robots">https://spectrum.ieee.org/lely-dairy-robots</a>, See on <a href="https://news.ycombinator.com/item?id=43699188">Hacker News</a></p>
<div id="readability-page-1" class="page"><p>Robots are taking over much of the daily manual labor at dairy farms, including milking, feeding, cleaning, and more. It makes dairy farmers’ lives easier, and makes the cows happier, too.</p><div data-headline="How Dairy Robots Are Changing Work for Cows (and Farmers)"><p><em>
		“Mooooo.”
		</em></p><p><strong>This dairy barn is</strong> full of cows, as you might expect. <a href="https://www.youtube.com/watch?v=g-zYshsAg1E" rel="noopener noreferrer" target="_blank">Cows are being milked</a>, <a href="https://www.youtube.com/watch?v=wm_Iul30Sx0" rel="noopener noreferrer" target="_blank">cows are being fed</a>, <a href="https://www.youtube.com/watch?v=yCJxN_3nnEc" rel="noopener noreferrer" target="_blank">cows are being cleaned up after</a>, and a few very happy cows are even getting <a href="https://www.youtube.com/watch?v=vq1j4ImZxcw" rel="noopener noreferrer" target="_blank">vigorously scratched behind the ears</a>. “I wonder where the farmer is,” remarks my guide, Jan Jacobs. Jacobs doesn’t seem especially worried, though—the several hundred cows in this barn are being well cared for by a small fleet of fully <a href="https://spectrum.ieee.org/tag/autonomous-robots">autonomous robots</a>, and the farmer might not be back for hours. The robots will let him know if anything goes wrong.
</p><p>
	At one of the milking robots, several cows are lined up, nose to tail, politely waiting their turn. The cows can get milked by robot whenever they like, which typically means
	<a href="https://www.lely.com/us/solutions/organic-grazing/faq/" rel="noopener noreferrer" target="_blank"> more frequently than the twice a day</a> at a traditional dairy farm. Not only is getting milked more often more comfortable for the cows, <a href="https://www.lely.com/us/solutions/organic-grazing/production/" rel="noopener noreferrer" target="_blank">cows also produce about 10 percent more milk</a> when the milking schedule is completely up to them.
</p><p>
	“There’s a direct correlation between stress and milk production,” Jacobs says. “Which is nice, because robots make cows happier and therefore, they give more milk, which helps us sell more robots.”
</p><p><a href="https://www.linkedin.com/in/jan-jacobs-59296828/" rel="noopener noreferrer" target="_blank">Jan Jacobs</a> is the human-robot interaction design lead for <a href="https://www.lely.com/us/" rel="noopener noreferrer" target="_blank">Lely</a>, a maker of agricultural machinery. Founded in 1948 in Maassluis, <a href="https://spectrum.ieee.org/tag/netherlands">Netherlands</a>, Lely deployed its first Astronaut milking robot in the early 1990s. The company has since developed other robotic systems that assist with cleaning, feeding, and cow comfort, and the Astronaut milking robot is on its <a href="https://www.lely.com/media/lely-centers-files/brochures/published/astronaut_a5_brochure_e_en.pdf" rel="noopener noreferrer" target="_blank">fifth generation</a>. Lely is now focused entirely on robots for dairy farms, with around 135,000 of them deployed around the world.
</p><h2>Essential Jobs on Dairy Farms</h2><p><span>The weather outside the barn is miserable. It’s late fall in the Netherlands, and a cold rain is gusting in from the sea, which is probably why the cows have quite sensibly decided to stay indoors and why the farmer is still nowhere to be found. Lely requires that dairy farmers who adopt its robots commit to letting their cows move freely between milking, feeding, and resting, as well as inside and outside the barn, at their own pace. “We believe that free cow traffic is a core part of the future of farming,” Jacobs says as we watch one cow stroll away from the milking robot while another takes its place. This is possible only when the farm operates on the cows’ schedule rather than a human’s.</span></p><p>
	A conventional dairy farm relies heavily on human labor. Lely estimates that repetitive daily tasks represent about a third of the average workday of a dairy farmer. In the morning, the cows are milked for the first time. Most dairy cows must be milked at least twice a day or they’ll become uncomfortable, and so the herd will line up on their own. Traditional milking parlors are designed to maximize human milking efficiency. A milking carousel, for instance, slowly rotates cows as they’re milked so that the dairy worker doesn’t have to move between stalls.
</p><p><img alt="Cows entering and exiting a Lely Astronaut milking robot in a modern dairy farm setting." data-rm-shortcode-id="c207a725fbda29ab8e49e44a3e9aaf98" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/cows-entering-and-exiting-a-lely-astronaut-milking-robot-in-a-modern-dairy-farm-setting.jpg?id=59764532&amp;width=980" height="2250" id="3fad0" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/cows-entering-and-exiting-a-lely-astronaut-milking-robot-in-a-modern-dairy-farm-setting.jpg?id=59764532&amp;width=980" width="3600"></p><p><img alt="Automated cow milking machine in a dairy farm, cow in position being milked." data-rm-shortcode-id="4e3ab2f9a50553c4dad2c678fb747a85" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/automated-cow-milking-machine-in-a-dairy-farm-cow-in-position-being-milked.jpg?id=59759842&amp;width=980" height="2438" id="fc35f" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/automated-cow-milking-machine-in-a-dairy-farm-cow-in-position-being-milked.jpg?id=59759842&amp;width=980" width="3900"><small placeholder="Add Photo Caption...">“We were spending 6 hours a day milking,” explains dairy farmer Josie Rozum, whose 120-cow herd at Takes Dairy Farm uses a pair of Astronaut A5 milking robots. “Now that the robots are handling all of that, we can focus more on animal care and comfort.”</small><small placeholder="add photo credit...">Lely</small></p><p>
	An experienced human using well-optimized equipment can attach a milking machine to a cow 
	<a href="https://www.vet.cornell.edu/animal-health-diagnostic-center/programs/quality-milk-production-services/services/parlor-efficiency" rel="noopener noreferrer" target="_blank">in just 20 to 30 seconds</a>. The actual milking takes only a few minutes, but with the average small dairy farm in North America providing a home for <a href="https://hoards.com/article-34810-familiar-dairy-industry-trends-continue.html" rel="noopener noreferrer" target="_blank">several hundred cows</a>, milking typically represents a time commitment of <a href="https://www.sciencedirect.com/science/article/pii/S0022030222003228#fig2" rel="noopener noreferrer" target="_blank">4 to 6 hours per day</a>.
</p><p>
	There are other jobs that must be done every day at a dairy. 
	<a href="https://www.dairyherd.com/news/education/how-often-should-you-push-feed" rel="noopener noreferrer" target="_blank">Cows are happier with continuous access to food</a>, which means feeding them several times a day. <a href="https://www.americandairy.com/dairy-diary/what-do-dairy-cows-eat/" rel="noopener noreferrer" target="_blank">The feed is a mix of roughage (hay), silage (grass), and grain</a>. The cows will eat all of this, but they prefer the grain, and so it’s common to see cows sorting their food by grabbing a mouthful and throwing it up into the air. The lighter roughage and silage flies farther than the grain does, leaving the cow with a pile of the tastier stuff as the rest gets tossed out of reach. This makes “<a href="https://www.dairyherd.com/news/education/how-often-should-you-push-feed" rel="noopener noreferrer" target="_blank">feed pushing</a>” necessary to shove the rest of the feed back within reach of the cow.
</p><p>
	And of course there’s manure. A dairy cow produces an average of 
	<a href="https://thedairylandinitiative.vetmed.wisc.edu/home/housing-module/adult-cow-housing/manure-management/" rel="noopener noreferrer" target="_blank">68 kilograms of manure a day</a>. All that manure has to be collected and the barn floors regularly cleaned.
</p><h2>Dairy <a href="https://spectrum.ieee.org/tag/industry-4-0">Industry 4.0</a></h2><p>
	The amount of labor needed to operate a dairy meant that until the early 1900s, 
	<a href="https://youtu.be/sjmflKg-v2o?t=1049" rel="noopener noreferrer" target="_blank">most family farms could support only about eight cows</a>. The introduction of the first milking machines, called <a href="https://www.surgemilker.com/history.html" rel="noopener noreferrer" target="_blank">bucket milkers</a>, helped farmers milk 10 cows per hour instead of 4 by the mid-1920s. <a href="https://spectrum.ieee.org/tag/rural-electrification">Rural electrification</a> furthered dairy <a href="https://spectrum.ieee.org/tag/automation">automation</a> starting in the 1950s, and since then, both farm size and milk production have increased steadily. In the 1930s, a good dairy cow <a href="https://youtu.be/sjmflKg-v2o?t=1631" rel="noopener noreferrer" target="_blank">produced 3,600 kilograms of milk per year</a>. <a href="https://downloads.usda.library.cornell.edu/usda-esmis/files/h989r321c/mg74sh83p/nc582h285/mkpr0225.pdf" rel="noopener noreferrer" target="_blank">Today, it’s almost 11,000 kilograms</a>, and Lely believes that robots are what will enable small dairy farms to continue to scale sustainably.
</p><p><span data-rm-shortcode-id="3d0c2a865a4f6909e8ce591fab31c88e"><iframe frameborder="0" height="auto" type="lazy-iframe" scrolling="no" data-runner-src="https://www.youtube.com/embed/g-zYshsAg1E?rel=0" width="100%"></iframe></span><small placeholder="Add Photo Credit...">Lely</small></p><p><span>But dairy robots are expensive. A milking robot can cost </span><a href="https://dairy.unl.edu/automatic-milking-systems-good-bad-and-unknown/" target="_blank">several hundred thousand dollars</a><span>, plus an additional </span><a href="https://www.lelycentermidatlantic.com/index.php/2022/02/01/how-much-does-it-cost-to-operate-a-lely-robot/" target="_blank">US $5,000 to $10,000 per year in operating costs</a><span>. The Astronaut A5, Lely’s latest milking robot, uses a laser-guided <a href="https://spectrum.ieee.org/tag/robot-arm">robot arm</a> to clean the cow’s udder before attaching teat cups one at a time. While the cow munches on treats, the Astronaut monitors her milk output, collecting data on 32 parameters, including indicators of the quality of the milk and the health of the cow. When milking is complete, the robot cleans the udder again, and the cow is free to leave as the robot steam cleans itself in preparation for the next cow.</span></p><p><a href="https://www.lely.com/gb/centers/midlands/what-cost-milking-robot/" rel="noopener noreferrer" target="_blank">Lely argues</a> that although the initial cost is higher than that of a traditional milking parlor, the robots pay for themselves over time through higher milk production (due primarily to increased milking frequency) and lower labor costs. Lely’s other robots can also save on labor. The Vector mobile robot handles continuous feeding and feed pushing, and the Discovery Collector is a robotic manure vacuum that keeps the floors clean.
</p><p><img alt="Automated feeding robot is loaded with food by a small overhead crane before it leaves to deliver feed to cows inside a modern barn." data-rm-shortcode-id="9883c894cc153fca40c2315735e6c5f1" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/automated-feeding-robot-is-loaded-with-food-by-a-small-overhead-crane-before-it-leaves-to-deliver-feed-to-cows-inside-a-modern-b.jpg?id=59764133&amp;width=980" height="2777" id="eb199" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/automated-feeding-robot-is-loaded-with-food-by-a-small-overhead-crane-before-it-leaves-to-deliver-feed-to-cows-inside-a-modern-b.jpg?id=59764133&amp;width=980" width="4500"><small placeholder="Add Photo Caption...">At Takes Dairy Farm, Rozum and her family used to spend several hours per day managing food for the cows. “The feeding robot is another amazing piece of the puzzle for our farm that allows us to focus on other things.”</small><small placeholder="Add Photo Credit...">Takes Family Farm</small></p><p>
	For most dairy farmers, though, making more money is not the main reason to get a robot, explains 
	<a href="https://ansci.umn.edu/people/marcia-endres" rel="noopener noreferrer" target="_blank">Marcia Endres</a>, a professor in the department of animal science at the University of Minnesota. Endres specializes in dairy-cattle management, behavior, and welfare, and studies dairy robot adoption. “When we first started doing research on this about 12 years ago, most of the farms that were installing robots were smaller farms that did not want to hire employees,” Endres says. “They wanted to do the work just with family labor, but they also wanted to have more flexibility with their time. They wanted a better lifestyle.”
</p><p>
	Flexibility was key for the Takes family, who 
	<a href="https://youtu.be/vZY8TbBoDd0?t=147" rel="noopener noreferrer" target="_blank">added Lely robots to their dairy farm</a> in Ely, Iowa, four years ago. “When we had our old milking parlor, everything that we did as a family was always scheduled around milking,” says Josie Rozum, who manages the farm and a creamery along with her parents—Dan and Debbie Takes—and three brothers. “With the robots, we can prioritize our personal life a little bit more—we can spend time together on Christmas morning and know that the cows are still getting milked.”
</p><p><a href="https://www.dananddebbies.com/about/the-farm/" rel="noopener noreferrer" target="_blank">Takes Family Dairy Farm</a>’s 120-cow herd is milked by a pair of Astronaut A5 robots, with a Vector and three Discovery Collectors for feeding and cleaning. “They’ve become a crucial part of the team,” explains Rozum. “It would be challenging for us to find outside help, and the robots keep things running smoothly.” The robots also add sustainability to small dairy farms, and not just in the short term. “Growing up on the farm, we experienced the hard work, and we saw what that commitment did to our parents,” Rozum explains. “It’s a very tough lifestyle. Having the robots take over a little bit of that has made dairy farming more appealing to our generation.”
</p><p><span data-rm-shortcode-id="c22f75ac2236f457c18ecd55f872ca53"><iframe frameborder="0" height="auto" type="lazy-iframe" scrolling="no" data-runner-src="https://www.youtube.com/embed/vZY8TbBoDd0?rel=0&amp;start=147" width="100%"></iframe></span><small placeholder="Add Photo Credit...">Takes Dairy Farm</small></p><p>
	Of the 25,000 dairy farms in the <a href="https://spectrum.ieee.org/tag/united-states">United States</a>, Endres estimates about 10 percent have robots. This is 
	<a href="https://www.gminsights.com/industry-analysis/milking-robots-market" rel="noopener noreferrer" target="_blank">about a third of the adoption rate in Europe</a>, <a href="https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Farms_and_farmland_in_the_European_Union_-_statistics" rel="noopener noreferrer" target="_blank">where farms tend to be smaller</a>, so the cost of implementing the robots is lower. Endres says that over the last five years, she’s seen a shift toward robot adoption at larger farms with over 500 cows, due primarily to labor shortages. “These larger dairies are having difficulty finding employees who want to milk cows—it’s a very tedious job. And the robot is always consistent. The farmers tell me, ‘My robot never calls in sick, and never shows up drunk.’ ”
</p><p>
	Endres is skeptical of Lely’s claim that its robots are responsible for increased milk production. “There is no research that proves that cows will be more productive just because of robots,” she says. It may be true that farms that add robots do see increased milk production, she adds, but it’s difficult to measure the direct effect that the robots have. “I have many dairies that I work with where they have both a robotic milking system and a conventional milking system, and if they are managing their cows well, there isn’t a lot of difference in milk production.”
</p><p><img alt="Cow using an automated brush for grooming inside a modern barn." data-rm-shortcode-id="9106b1e71ad19d377f43b164221e0a40" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/cow-using-an-automated-brush-for-grooming-inside-a-modern-barn.jpg?id=59759835&amp;width=980" height="3375" id="3f0b4" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/cow-using-an-automated-brush-for-grooming-inside-a-modern-barn.jpg?id=59759835&amp;width=980" width="4500"><small placeholder="Add Photo Caption...">The Lely Luna cow brush helps to keep cows’ skin healthy. It’s also relaxing and enjoyable, so cows will brush themselves several times a day.</small><small placeholder="Add Photo Credit...">Lely</small></p><p>
	The robots do seem to improve the cows’ lives, however. “Welfare is not just productivity and health—it’s also the affective state, the ability to have a more natural life,” Endres says. “Again, it’s hard to measure, but I think that on most of these robot farms, their affective state is improved.” The cows’ relationship with humans changes too, comments Endres. When the cows no longer associate humans with being told where to go and what to do all the time, they’re 
	<a href="https://youtu.be/sjmflKg-v2o?t=2633" rel="noopener noreferrer" target="_blank">much more relaxed and friendly</a> toward people they meet. Rozum agrees. “We’ve noticed a tremendous change in our cows’ demeanor. They’re more calm and relaxed, just doing their thing in the barn. They’re much more comfortable when they can choose what to do.”
</p><h2>Cows Versus Robots</h2><p>
	Cows are curious and clever <a href="https://spectrum.ieee.org/tag/animals">animals</a>, and have the same instinct that humans have when confronted with a new robot: They want to play with it. Because of this, Lely has had to cow-proof its robots, modifying their design and <a href="https://spectrum.ieee.org/tag/programming">programming</a> so that the machines can function autonomously around cows. Like many <a href="https://spectrum.ieee.org/tag/mobile-robots">mobile robots</a>, Lely’s dairy robots include contact-sensing bumpers that will pause the robot’s motion if it runs into something. On the Vector feeding robot, Lely product engineer 
	<a href="https://www.linkedin.com/in/beltman42/" rel="noopener noreferrer" target="_blank">René Beltman</a> tells me, they had to add a software option to disable the bumper. “The cows learned that, ‘oh, if I just push the bumper, then the robot will stop and put down more feed in my area for me to eat.’ It was a free buffet. So you don’t want the cows to end up controlling the robot.” Emergency stop buttons had to be relocated so that they couldn’t be pressed by questing cow tongues.
</p><p>
	There’s also a social component to cow-robot interaction. Within their herd, cows have a well-established hierarchy, and the robots need to work within this hierarchy to do their jobs. For example, a cow won’t move out of the way if it thinks that another cow is lower in the hierarchy than it is, and it will treat a robot the same way. The engineers had to figure out how the Discovery Collector could drive back and forth to vacuum up manure without getting blocked by cows. “In our early tests, we’d use sensors to have the robot stop to avoid running into any of the cows,” explains Jacobs. “But that meant that the robot became the weakest one in the hierarchy, and it would just end up crying in the corner because the cows wouldn’t move for it. So now, it doesn’t stop.”
</p><p><img alt="Cows resting in pens with a robot cleaning the floor in a modern barn setting." data-rm-shortcode-id="270244739bf55a596082710523ed2eed" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/cows-resting-in-pens-with-a-robot-cleaning-the-floor-in-a-modern-barn-setting.jpg?id=59759837&amp;width=980" height="2102" id="c9d2c" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/cows-resting-in-pens-with-a-robot-cleaning-the-floor-in-a-modern-barn-setting.jpg?id=59759837&amp;width=980" width="3363"><small placeholder="Add Photo Caption...">One of the dirtiest jobs on a dairy farm is handled by the Discovery Collector, an autonomous manure vacuum. The robot relies on wheel odometry and <a href="https://spectrum.ieee.org/tag/ultrasonic-sensors">ultrasonic sensors</a> for navigation because it’s usually covered in manure.</small><small placeholder="Add Photo Credit...">Evan Ackerman</small></p><p>
	“We make the robot drive slower for the first week, when it’s being introduced to a new herd,” adds Beltman. “That gives the cows time to figure out that the robot is at the top of the hierarchy.”
</p><p>
	Besides maintaining their dominance at the top of the herd, the current generation of Lely robots doesn’t interact much with the cows, but that’s changing, Jacobs tells me. Right now, when a robot is driving through the barn, it makes a beeping sound to let the cows know it’s coming. Lely is looking into how to make these sounds more enjoyable for the cows. “This was a recent revelation for me,” Jacobs says. ”We’re not just designing interactions for humans. The cows are our users, too.”
</p><h2>Human-Robot Interaction</h2><p>
	Last year, Jacobs and researchers from <a href="https://spectrum.ieee.org/tag/delft-university-of-technology">Delft University of Technology</a>, in the Netherlands, 
	<a href="https://ieeexplore.ieee.org/document/10660792" rel="noopener noreferrer" target="_blank">presented a paper</a> at the IEEE Human-Robot Interaction (<a href="https://spectrum.ieee.org/tag/hri">HRI</a>) Conference exploring this concept of robot behavior development on working dairy farms. The researchers visited robotic dairies, interviewed dairy farmers, and held workshops within Lely to establish a robot code of conduct—a guide that Lely’s designers and engineers use when considering how their robots should look, sound, and act, for the benefit of both humans and cows. On the engineering side, this includes practical things like colors and patterns for lights and different types of sounds so that information is communicated consistently across platforms.
</p><p>
	But there’s much more nuance to making a robot seem “reliable” or “friendly” to the end user, since such things are not only difficult to define but also difficult to implement in a way that’s appropriate for dairy farmers, who prioritize functionality.
</p><p>
	Jacobs doesn’t want his robots to try to be anyone’s friend—not the cow’s, and not the farmer’s. “The robot is an employee, and it should have a professional relationship,” he says. “So the robot might say ‘Hi,’ but it wouldn’t say, ‘How are you feeling today?’ ” What’s more important is that the robots are trustworthy. For Jacobs, instilling trust is simple: “You cannot gain trust by doing tricks. If your robot is reliable and predictable, people will trust it.”
</p><p><img alt="Automated milking machine attached to cow's udders, with cow standing on a slotted floor." data-rm-shortcode-id="4bec6c118f690770f5c6ecec2f377e4e" data-rm-shortcode-name="rebelmouse-image" data-runner-src="https://spectrum.ieee.org/media-library/automated-milking-machine-attached-to-cow-s-udders-with-cow-standing-on-a-slotted-floor.jpg?id=59759840&amp;width=980" height="2700" id="cf5f5" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/automated-milking-machine-attached-to-cow-s-udders-with-cow-standing-on-a-slotted-floor.jpg?id=59759840&amp;width=980" width="3600"><small placeholder="Add Photo Caption...">The electrically driven, pneumatically balanced <a href="https://spectrum.ieee.org/tag/robotic-arm">robotic arm</a> that the Lely Astronaut uses to milk cows is designed to withstand accidental (or intentional) kicks.</small><small placeholder="Add Photo Credit...">Lely</small></p><p>
	The real challenge, Jacobs explains, is that Lely is largely on its own when it comes to finding the best way of integrating its robots into the daily lives of people who may have never thought they’d have robot employees. “There’s not that much knowledge in the robot world about how to approach these problems,” Jacobs says. “We’re working with almost 20,000 farmers who have a bigger robot workforce than a human workforce. They’re robot managers. And I don’t know that there necessarily are other companies that have a customer base of normal people who have strategic dependence on robots for their livelihood. That is where we are now.”
</p><h2>From Dairy Farmers to Robot Managers</h2><p><span>With the additional time and flexibility that the robots enable, some dairy farmers have been able to diversify. On our way back to Lely’s headquarters, we stop at </span><a href="https://boerderijhetlansingerland.nl/melkveebedrijf/" target="_blank">Farm Het Lansingerland</a><span>, owned by a Lely customer who has added a small restaurant and farm shop to his dairy. Large windows look into the barn so that restaurant patrons can watch the robots at work, caring for the cows that produce the cheese that’s on the menu. A self-guided tour takes you right up next to an Astronaut A5 milking robot, while signs on the floor warn of Vector feeding robots on the move. “This farmer couldn’t expand—this was as many cows as he’s allowed to have here,” Jacobs explains to me over cheese sandwiches. “So, he needs to have additional income streams. That’s why he started these other things. And the robots were essential for that.”</span></p><p>
	The farmer is an early adopter—someone who’s excited about the technology and actively interested in the robots themselves. But most of Lely’s tens of thousands of customers just want a reliable robotic employee, not a science project. “We help the farmer to prepare not just the environment for the robots, but also the mind,” explains Jacobs. “It’s a complete shift in their way of working.”
</p><p>
	Besides managing the robots, the farmer must also learn to manage the massive amount of data that the robots generate about the cows. “The amount of data we get from the robots is a game changer,” says Rozum. “We can track milk production, health, and cow habits in real time. But it’s overwhelming. You could spend all day just sitting at the computer, looking at data and not get anything else done. It took us probably a year to really learn how to use it.”
</p><p>
	The most significant advantages to farmers come from using the data for long-term optimization, says the University of Minnesota’s Endres. “In a conventional barn, the cows are treated as a group,” she says. “But the robots are collecting data about individual animals, which lets us manage them as individuals.” By combining data from a milking robot and a feeding robot, for example, farmers can close the loop, correlating when and how the cows are fed with their milk production. Lely is doing its best to simplify this type of decision making, says Jacobs. “You need to understand what the data means, and then you need to present it to the farmer in an actionable way.”
</p><div id="rebelltitem1" data-id="1" data-reload-ads="false" data-is-image="True" data-href="https://spectrum.ieee.org/lely-dairy-robots/a-robotic-dairy" data-basename="a-robotic-dairy" data-post-id="2671643574" data-published-at="1743515326" data-use-pagination="False"><h3 data-role="headline">
            
                A Robotic Dairy
            
            
        </h3><p><img id="15c0e" data-rm-shortcode-id="523f4b6812182dc0756edd9f83d8e771" data-rm-shortcode-name="rebelmouse-image" lazy-loadable="true" src="https://spectrum.ieee.org/media-library/illustration-of-an-automated-dairy-farm-with-milking-machines-feed-dispensers-and-cows-in-various-areas.png?id=59771554&amp;width=980" data-runner-src="https://spectrum.ieee.org/media-library/illustration-of-an-automated-dairy-farm-with-milking-machines-feed-dispensers-and-cows-in-various-areas.png?id=59771554&amp;width=980" width="3238" height="2134" alt="Illustration of an automated dairy farm with milking machines, feed dispensers, and cows in various areas."><small><p>Chris Philpot</p></small></p><h3>
All dairy farms are different, and farms that decide to give robots a try will often start with just one or two. A highly roboticized dairy barn might look something like this illustration, with a team of many different robots working together to keep the cows comfortable and happy.
</h3><p>
	A: One Astronaut A5 robot can milk up to 60 cows. After the Astronaut cleans the teats, a laser sensor guides a robotic arm to attach the teat cups. Milking takes just a few minutes.
</p><p>
	B: In the feed <a href="https://spectrum.ieee.org/tag/kitchen">kitchen</a>, the Vector robot recharges itself while different ingredients are loaded into its hopper and mixed together. Mixtures can be customized for different groups of cows.
</p><p>
	C: The Vector robot dispenses freshly mixed food in small batches throughout the day. A laser measures the height of leftover food to make sure that the cows are getting the right amounts.
</p><p>
	D: The Discovery Collector is a mop and vacuum for cow manure. It navigates the barn autonomously and returns to its docking station to remove waste, refill water, and wirelessly recharge.</p><p>
	E: As it milks, the Astronaut is collecting a huge amount of data—32 different parameters per teat. If it detects an issue, the farmer is notified, helping to catch health problems early.</p><p>
	F: Automated gates control meadow access and will keep a cow inside if she’s due to be milked soon. Cows are identified using <a href="https://spectrum.ieee.org/tag/rfid">RFID</a> collars, which also track their behavior and health.
</p></div><h2>A Sensible Future for Dairy Robots</h2><p>
	After lunch, we stop by Lely headquarters, where bright red life-size cow statues guard the entrance and all of the conference rooms are dairy themed. We get comfortable in Butter, and I ask Jacobs and Beltman what the future holds for their dairy robots.
</p><p>
	In the near term, Lely is focused on making its existing robots more capable. Its latest 
	<a href="https://www.lely.com/us/press/2024/09/10/lely-introduces-autonomous-feed-pushing-robot-for/" rel="noopener noreferrer" target="_blank">feed-pushing robot</a> is equipped with <a href="https://spectrum.ieee.org/tag/lidar">lidar</a> and <a href="https://spectrum.ieee.org/tag/stereo-cameras">stereo cameras</a>, which allow it to autonomously navigate around large farms without needing to follow a metal strip bolted to the ground. A new <a href="https://www.lely.com/us/press/2024/09/10/lely-zeta-the-start-of-a-new-chapter-in-dairy-farm/" rel="noopener noreferrer" target="_blank">overhead camera system</a> will leverage AI to recognize individual cows and track their behavior, while also providing farmers with an enormous new dataset that could allow Lely’s systems to help farmers make more nuanced decisions about cow welfare. The potential of AI is what Jacobs seems most excited about, although he’s cautious as well. “With AI, we’re suddenly going to take away an entirely different level of work. So, we’re thinking about doing research into the meaningfulness of work, to make sure that the things that we do with AI are the things that farmers <em><em>want</em></em> us to do with AI.”
</p><p>
	“The idea of AI is very intriguing,” comments Rozum. “I think AI could help to simplify things for farmers. It would be a tool, a resource. But we know our cows best, and a farmer’s judgment has to be there too. There’s just some component of dairy farming that you cannot take the human out of. Robots are not going to be successful on a farm unless you have good farmers.”
</p><p>
	Lely is aware of this and knows that its robots have to find the right balance between being helpful, and taking over. “We want to make sure not to take away the kinds of interactions that give dairy farmers joy in their work,” says Beltman. “Like feeding calves—every farmer likes to feed the calves.” Lely does sell an 
	<a href="https://www.lely.com/us/solutions/feeding/calm/" rel="noopener noreferrer" target="_blank">automated calf feeder</a> that many dairy farmers buy, which illustrates the point: What’s the best way of designing robots to give humans the flexibility to do the work that they enjoy?
</p><p>
	“This is where <a href="https://spectrum.ieee.org/topic/robotics/">robotics</a> is going,” Jacobs tells me as he gives me a lift to the train station. “As a human, you could have two other humans and six robots, and that’s your company.” Many industries, he says, look to robots with the objective of minimizing human involvement as much as possible so that the robots can generate the maximum amount of value for whoever happens to be in charge.
</p><p>
	Dairy farms are different. Perhaps that’s because the person buying the robot is the person who most directly benefits from it. But I wonder if the concern over automation of jobs would be mitigated if more companies chose to emphasize the sustainability and joy of work equally with profit. Automation doesn’t have to be zero-sum—if implemented thoughtfully, perhaps robots can make work easier, more efficient, and more fun, too.
</p><p>
	Jacobs certainly thinks so. “That’s my utopia,” he says. “And we’re working in the right direction.”
</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[What the hell is a target triple? (146 pts)]]></title>
            <link>https://mcyoung.xyz/2025/04/14/target-triples/</link>
            <guid>43696756</guid>
            <pubDate>Tue, 15 Apr 2025 18:35:05 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mcyoung.xyz/2025/04/14/target-triples/">https://mcyoung.xyz/2025/04/14/target-triples/</a>, See on <a href="https://news.ycombinator.com/item?id=43696756">Hacker News</a></p>
<div id="readability-page-1" class="page"><div> <p><em>Cross-compiling</em> is taking a computer program and compiling it for a machine that isn’t the one hosting the compilation. Although historically compilers would only compile for the host machine, this is considered an anachronism: all serious native compilers are now cross-compilers.</p> <p>After all, you don’t want to be building your iPhone app on literal iPhone hardware.</p> <p>Many different compilers have different mechanisms for classifying and identifying <em>targets</em>. A target is a platform that the compiler can produce executable code for. However, due to the runaway popularity of LLVM, virtually all compilers now use <em>target triples</em>. You may have already encountered one, such as the venerable <code>x86_64-unknown-linux</code>, or the evil <code>x86_64-pc-windows</code>. This system is convoluted and <em>almost</em> self-consistent.</p> <p>But what is a target triple, and where did they come from?</p> <h2 id="stupid-gcc-conventions"><a href="#stupid-gcc-conventions">Stupid GCC Conventions</a></h2> <p>So if you go poking around the <a href="https://wiki.osdev.org/Target_Triplet">Target Triplet</a> page on OSDev, you will learn both true and false things about target triples, because this page is about GCC, not native compilers in general.</p> <blockquote> <p>Generally, there is no “ground truth” for what a target triple is. There isn’t some standards body that assigns these names. But as we’ll see, LLVM is the trendsetter.</p> </blockquote> <p>If you run the following command you can learn the target triple for your machine:</p> <div><figure><pre><code data-lang="console"><span>$</span><span> </span>gcc <span>-dumpmachine</span>
<span>x86_64-linux-gnu</span></code></pre></figure></div> <p>Now if you’re at all familiar with any system that makes pervasive use of target triples, you will know that this is <em>not a target triple</em>, because this target’s name is <code>x86_64-unknown-linux-gnu</code>, which is what both <code>clang</code> and <code>rustc</code> call-</p> <div><figure><pre><code data-lang="console"><span>$</span><span> </span>clang <span>-dumpmachine</span>
<span>x86_64-pc-linux-gnu
</span><span>$</span><span> </span>rustc <span>-vV</span> | <span>grep </span>host
<span>host: x86_64-unknown-linux-gnu</span></code></pre></figure></div> <p>Oh no.</p> <p>Well, GCC is missing the the <code>pc</code> or <code>unknown</code> component, and that’s specifically a GCC thing; it allows omitting parts of the triple in such a way that is unambiguous. And they are a GCC invention, so perhaps it’s best to start by assessing GCC’s beliefs.</p> <p>According to GCC, a target triple is a string of the form <code>&lt;machine&gt;-&lt;vendor&gt;-&lt;os&gt;</code>. The “machine” part unambiguously identifies the architecture of the system. Practically speaking, this is the assembly language that the compiler will output at the end. The “vendor” part is essentially irrelevant, and mostly is of benefit for sorting related operating systems together. Finally, the “os” part identifies the operating system that this code is being compiled for. The main thing this identifies for a compiler is the executable format: COFF/PE for Windows, Mach-O for Apple’s operating systems, ELF for Linux and friends, and so on (this, however, is an oversimplification).</p> <p>But you may notice that <code>x86_64-unknown-linux-gnu</code> has an extra, fourth entry<sup id="fnref:quad" role="doc-noteref"><a href="#fn:quad" rel="footnote">1</a></sup>, which plays many roles but is most often called the target’s “ABI”. For <code>linux</code>, it identifies the target’s libc, which has consequences for code generation of some language features, such as thread locals and unwinding. It is optional, since many targets only have one ABI.</p> <h3 id="cross-compiling-with-gcc"><a href="#cross-compiling-with-gcc">Cross Compiling with GCC</a></h3> <p>A critical piece of history here is to understand the really stupid way in which GCC does cross compiling. Traditionally, each GCC binary would be built for <em>one</em> target triple. The full name of a GCC binary would include the triple, so when cross-compiling, you would compile with <code>x86_64-unknown-linux-gcc</code>, link with <code>x86_64-unknown-linux-ld</code>, and so on (here, <code>gcc</code> is not the fourth ABI component of a triple; it’s just one of the tools in the <code>x86_64-unknown-linux</code> toolchain).</p> <p>Nobody with a brain does this<sup id="fnref:toolchain" role="doc-noteref"><a href="#fn:toolchain" rel="footnote">2</a></sup>. LLVM and all cross compilers that follow it instead put all of the backends in one binary, and use a compiler flag like <code>--target</code> to select the backend.</p> <p>But regardless, this is where target triples come from, and why they look the way they look: they began as prefixes for the names of binaries in <code>autoconf</code> scripts.</p> <p>But GCC is ancient technology. In the 21st century, LLVM rules all native compilers.</p> <h2 id="names-in-the-ancient-language"><a href="#names-in-the-ancient-language">Names in the Ancient Language</a></h2> <p>LLVM’s target triple list is the one that should be regarded as “most official”, for a few reasons:</p> <ol> <li> <p>Inertia. Everyone and their mother uses LLVM as a middleend and backend, so its naming conventions bubble up into language frontends like <code>clang</code>, <code>rustc</code> <code>swiftc</code>, <code>icc</code>, and <code>nvcc</code>.</p> </li> <li> <p>Upstream work by silicon and operating system vendors. LLVM is what people get hired to work on for the most part, not GCC, so its platform-specific conventions often reflect the preferences of vendors.</p> </li> </ol> <p>These are in no small part because Apple, Google, and Nvidia have armies of compiler engineers contributing to LLVM.</p> <p>The sources for “official” target triples are many. Generally, I would describe a target triple as “official” when:</p> <ol> <li> <p>A major compiler (so, <code>clang</code> or <code>rustc</code>) uses it. Rust does a way better job than LLVM of documenting their targets, so I prefer to give it deference. You can find Rust’s official triples <a href="https://doc.rust-lang.org/rustc/platform-support.html">here</a>.</p> </li> <li> <p>A platform developer (e.g., a hardware manufacturer, OS vendor) distributes a toolchain with a target triple in the <code>arch-vendor-os</code> format.</p> </li> </ol> <p>So, what are the names in class (1)? LLVM does not really go out of its way to provide such a list. But we gotta start somewhere, so source-diving it is.</p> <p>We can dig into <a href="https://llvm.org/doxygen/Triple_8cpp_source.html"><code>Triple.cpp</code></a> in LLVM’s target triple parser. It lists all of the names LLVM recognizes for each part of a triple. Looking at <code>Triple::parseArch()</code>, we have the following names, including many, many aliases. The first item on the right column is LLVM’s preferred name for the architecture, as indicated by <code>Triple::getArchTypeName()</code>.</p> <table> <thead> <tr> <th>Architecture</th> <th>Possible Names</th> </tr> </thead> <tbody> <tr> <td><a href="https://en.wikipedia.org/wiki/X86">Intel x86</a> (32-bit)</td> <td><code>i386</code>, <code>i486</code>, <code>i586</code>, <code>i686</code>, <code>i786</code>, <code>i886</code>, <code>i986</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/X86">Intel x86</a> (64-bit)</td> <td><code>x86_64</code>, <code>amd64</code>, <code>x86_86h</code><sup id="fnref:x86_86h" role="doc-noteref"><a href="#fn:x86_86h" rel="footnote">3</a></sup></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family">ARM</a> (32-bit)</td> <td><code>arm</code>, <code>xscale</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family">ARM</a> (32-bit, big-endian)</td> <td><code>armeb</code>, <code>xscaleeb</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family">ARM</a> (64-bit)</td> <td><code>aarch64</code>, <code>aarch64e</code>, <code>aarch64ec</code>, <code>arm64</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family">ARM</a> (64-bit, big-endian)</td> <td><code>aarch64_be</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family">ARM</a> (64-bit, ILP32<sup id="fnref:ilp32" role="doc-noteref"><a href="#fn:ilp32" rel="footnote">4</a></sup>)</td> <td><code>aarch64_32</code>, <code>arm64_32</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family#Thumb">ARM Thumb</a></td> <td><code>thumb</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARM_architecture_family#Thumb">ARM Thumb</a> (big-endian)</td> <td><code>thumbeb</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/PowerPC">IBM PowerPC</a><sup id="fnref:power" role="doc-noteref"><a href="#fn:power" rel="footnote">5</a></sup> (32-bit)</td> <td><code>powerpc</code>, <code>powerpcspe</code>, <code>ppc</code>, <code>ppc32</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/PowerPC">IBM PowerPC</a> (little-endian)</td> <td><code>powerpcle</code>, <code>ppcle</code>, <code>ppc32le</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/PowerPC">IBM PowerPC</a> (64-bit)</td> <td><code>powerpc64</code>, <code>ppu</code>, <code>ppc64</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/PowerPC">IBM PowerPC</a> (64-bit, little-endian)</td> <td><code>powerpc64le</code>, <code>ppc64le</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/MIPS_architecture">MIPS</a> (32-bit)</td> <td><code>mips</code>, <code>mipseb</code>, <code>mipsallegrex</code>, <code>mipsisa32r6</code>, <code>mipsr6</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/MIPS_architecture">MIPS</a> (32-bit, little-endian)</td> <td><code>mipsel</code>, <code>mipsallegrexel</code>, <code>mipsisa32r6el</code>, <code>mipsr6el</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/MIPS_architecture">MIPS</a> (64-bit)</td> <td><code>mips64</code>, <code>mips64eb</code>, <code>mipsn32</code>, <code>mipsisa64r6</code>, <code>mips64r6</code>, <code>mipsn32r6</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/MIPS_architecture">MIPS</a> (64-bit, little-endian)</td> <td><code>mips64el</code>, <code>mipsn32el</code>, <code>mipsisa64r6el</code>, <code>mips64r6el</code>, <code>mipsn32r6el</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/RISC-V">RISC-V</a> (32-bit)</td> <td><code>riscv32</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/RISC-V">RISC-V</a> (64-bit)</td> <td><code>riscv64</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Z/Architecture">IBM z/Architecture</a></td> <td><code>s390x</code><sup id="fnref:s390x" role="doc-noteref"><a href="#fn:s390x" rel="footnote">6</a></sup>, <code>systemz</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/SPARC">SPARC</a></td> <td><code>sparc</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/SPARC">SPARC</a> (little-endian)</td> <td><code>sparcel</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/SPARC">SPARC</a> (64-bit)</td> <td><code>sparcv6</code>, <code>sparc64</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/WebAssembly">WebAssembly</a> (32-bit)</td> <td><code>wasm32</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/WebAssembly">WebAssembly</a> (64-bit)</td> <td><code>wasm64</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Loongson">Loongson</a> (32-bit)</td> <td><code>loongarch32</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Loongson">Loongson</a> (64-bit)</td> <td><code>loongarch64</code></td> </tr> </tbody> <tbody> <tr> <td><a href="https://en.wikipedia.org/wiki/Radeon_HD_2000_series">Radeon R600</a></td> <td><code>r600</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Graphics_Core_Next">AMD GCN</a></td> <td><code>amdgcn</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Qualcomm_Hexagon">Qualcomm Hexagon</a></td> <td><code>hexagon</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Parallel_Thread_Execution">Nvidia PTX</a><sup id="fnref:ptx" role="doc-noteref"><a href="#fn:ptx" rel="footnote">7</a></sup> (32-bit)</td> <td><code>nvptx</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Parallel_Thread_Execution">Nvidia PTX</a> (64-bit)</td> <td><code>nvptx64</code></td> </tr> <tr> <td>AMD IL<sup id="fnref:amdil" role="doc-noteref"><a href="#fn:amdil" rel="footnote">8</a></sup> (32-bit)</td> <td><code>amdil</code></td> </tr> <tr> <td>AMD IL (64-bit)</td> <td><code>amdil64</code></td> </tr> <tr> <td>Direct-X IL</td> <td><code>dxil</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Heterogeneous_System_Architecture">HSAIL</a> (32-bit)</td> <td><code>hsail</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Heterogeneous_System_Architecture">HSAIL</a> (64-bit)</td> <td><code>hsail64</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Standard_Portable_Intermediate_Representation">Khronos SPIR</a> (32-bit)</td> <td><code>spir</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Standard_Portable_Intermediate_Representation">Khronos SPIR</a> (64-bit)</td> <td><code>spir64</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Standard_Portable_Intermediate_Representation">Khronos SPIR-V</a></td> <td><code>spirv</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Standard_Portable_Intermediate_Representation">Khronos SPIR-V</a> (32-bit)</td> <td><code>spirv32</code>, …</td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Standard_Portable_Intermediate_Representation">Khronos SPIR-V</a> (64-bit)</td> <td><code>spirv64</code>, …</td> </tr> <tr> <td><a href="https://developer.android.com/guide/topics/renderscript/compute">Android RenderScript</a> (32-bit)</td> <td><code>renderscript32</code></td> </tr> <tr> <td><a href="https://developer.android.com/guide/topics/renderscript/compute">Android RenderScript</a> (64-bit)</td> <td><code>renderscript64</code></td> </tr> <tr> <td><a href="https://en.wikichip.org/wiki/movidius/microarchitectures/shave_v2.0">Movidius SHAVE</a></td> <td><code>shave</code></td> </tr> </tbody> <tbody> <tr> <td><a href="https://en.wikipedia.org/wiki/AVR_microcontrollers">Atmel AVR</a></td> <td><code>avr</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Motorola_68000_series">Motorola 68k</a></td> <td><code>m68k</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/ARC_(processor)">Argonaut ARC</a></td> <td><code>arc</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/TI_MSP430">Texas Instruments MSP430</a></td> <td><code>msp430</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Tensilica">Tensilica Xtensa</a></td> <td><code>xtensa</code></td> </tr> <tr> <td><a href="https://c-sky.github.io/">C-SKY</a></td> <td><code>csky</code></td> </tr> <tr> <td><a href="https://github.com/cpc/openasip">OpenASIP</a></td> <td><code>tce</code></td> </tr> <tr> <td><a href="https://github.com/cpc/openasip">OpenASIP</a> (little-endian)</td> <td><code>tcele</code></td> </tr> <tr> <td><a href="https://q3k.org/lanai.html">Myracom Lanai</a></td> <td><code>lanai</code></td> </tr> <tr> <td>XMOS xCore</td> <td><code>xcore</code></td> </tr> <tr> <td>Kalimba<sup id="fnref:idk" role="doc-noteref"><a href="#fn:idk" rel="footnote">9</a></sup></td> <td><code>kalimba</code></td> </tr> <tr> <td>VE<sup id="fnref:idk:1" role="doc-noteref"><a href="#fn:idk" rel="footnote">9</a></sup></td> <td><code>ve</code></td> </tr> </tbody> </table> <p>Here we begin to see that target triples are not a neat system. They are <em>hell</em>. Where a list of architecture names contains a “…”, it means that LLVM accepts many more names.</p> <p>The problem is that architectures often have <em>versions</em> and <em>features</em>, which subtly change how the compiler generates code. For example, when compiling for an <code>x86_64</code>, we may want to specify that we want AVX512 instructions to be used. On LLVM, you might do that with <code>-mattr=+avx512</code>. Every architecture has a subtly-different way of doing this, because every architecture had a <em>different GCC</em>! Each variant of GCC would put different things behind <code>-mXXX</code> flags (<code>-m</code> for “machine”), meaning that the interface is not actually that uniform. The meanings of <code>-march</code>, <code>-mcpu</code>, <code>-mtune</code>, and <code>-mattr</code> thus vary wildly for this reason.</p> <p>Because LLVM is supposed to replace GCC (for the most part), it replicates a lot of this wacky behavior.</p> <p>So uh, we gotta talk about 32-bit ARM architecture names.</p> <h3 id="armtargetparsercpp"><a href="#armtargetparsercpp"><code>ARMTargetParser.cpp</code></a></h3> <p>There is a hellish file in LLVM dedicated to parsing ARM architecture names. Although members of the ARM family have many configurable features (which you can discover with <code>llc -march aarch64 -mattr help</code><sup id="fnref:llc" role="doc-noteref"><a href="#fn:llc" rel="footnote">10</a></sup>), the name of the architecture is somewhat meaningful, and can hav many options, mostly relating to the many versions of ARM that exist.</p> <p>How bad is it? Well, we can look at all of the various ARM targets that <code>rustc</code> supports with <code>rustc --print target-list</code>:</p> <div><figure><pre><code data-lang="console"><span>$</span><span> </span>rustc <span>--print</span> target-list | <span>grep</span> <span>-P</span> <span>'arm|aarch|thumb'</span> <span>\</span>
<span>  | cut -d- -f1 | sort | uniq
aarch64
aarch64_be
arm
arm64_32
arm64e
arm64ec
armeb
armebv7r
armv4t
armv5te
armv6
armv6k
armv7
armv7a
armv7k
armv7r
armv7s
armv8r
thumbv4t
thumbv5te
thumbv6m
thumbv7a
thumbv7em
thumbv7m
thumbv7neon
thumbv8m.base
thumbv8m.main</span></code></pre></figure></div> <p>Most of these are 32-bit ARM versions, with profile information attached. These correspond to the names given <a href="https://en.wikipedia.org/wiki/ARM_architecture_family#Cores">here</a>. Why does ARM stick version numbers in the architecture name, instead of using <code>-mcpu</code> like you would on x86 (e.g. <code>-mcpu alderlake</code>)? I have no idea, because ARM is not my strong suit. It’s likely because of how early ARM support was added to GCC.</p> <p>Internally, LLVM calls these “subarchitectures”, although ARM gets special handling because there’s so many variants. SPIR-V, Direct X, and MIPS all have subarchitectures, so you might see something like <code>dxilv1.7</code> if you’re having a bad day.</p> <p>Of course, LLVM’s ARM support also sports some naughty subarchitectures not part of this system, with naughty made up names.</p> <ul> <li> <p><code>arm64e</code> is an Apple thing, which is an enhancement of <code>aarch64</code> present on some Apple hardware, which adds their own flavor of <a href="https://developer.apple.com/documentation/security/preparing-your-app-to-work-with-pointer-authentication">pointer authentication</a> and some other features.</p> </li> <li> <p><code>arm64ec</code> is a completely unrelated Microsoft invention that is essentially “<code>aarch64</code> but with an <code>x86_64</code>-ey ABI” to make <code>x86_64</code> emulation on what would otherwise be <code>aarch64-pc-windows-msvc</code> target somewhat more amenable.</p> </li> </ul> <blockquote> <p>Why the Windows people invented a whole other ABI instead of making things clean and simple like Apple did with Rosetta on ARM MacBooks? I have no idea, but <a href="http://www.emulators.com/docs/abc_arm64ec_explained.htm">http://www.emulators.com/docs/abc_arm64ec_explained.htm</a> contains various excuses, none of which I am impressed by. My read is that their compiler org was just worse at life than Apple’s, which is not surprising, since Apple does compilers better than anyone else in the business.</p> </blockquote> <p>Actually, since we’re on the topic of the names of architectures, I have a few things I need to straighten out.</p> <h3 id="made-up-names-of-architectures"><a href="#made-up-names-of-architectures">Made Up Names of Architectures</a></h3> <p>x86 and ARM both seem to attract a lot of people making up nicknames for them, which leads to a lot of confusion in:</p> <ol> <li> <p>What the “real” name is.</p> </li> <li> <p>What name a particular toolchain wants.</p> </li> <li> <p>What name you should use in your own cosmopolitan tooling.</p> </li> </ol> <p>Let’s talk about the incorrect names people like to make up for them. Please consider the following a relatively normative reference on what people call these architectures, based on my own experience with many tools.</p> <p>When we say “x86” unqualified, in 2025, we almost always mean <code>x86_64</code>, because 32-bit x86 is dead. If you need to talk about 32-bit x86, you should either say “32-bit x86”, “protected mode”<sup id="fnref:x86-modes" role="doc-noteref"><a href="#fn:x86-modes" rel="footnote">11</a></sup>, or “i386” (the first Intel microarchitecture that implemented protected mode)<sup id="fnref:i386" role="doc-noteref"><a href="#fn:i386" rel="footnote">12</a></sup>. You should not call it <code>x86_32</code> or just <code>x86</code>.</p> <p>You might also call it IA-32 for Intel Architecture 32, (or <code>ia32</code>), but nobody calls it that and you risk confusing people with <code>ia64</code>, or IA-64, the official name of Intel’s failed general-purpose VLIW architecture, <a href="https://en.wikipedia.org/wiki/Itanium">Itanium</a>, which is in no way compatible with x86. <code>ia64</code> was what GCC and LLVM named Itanium triples with. Itanium support was drowned in a bathtub during the Obama administration, so it’s not really relevant anymore. Rust has never had official Itanium support.</p> <p>32-bit x86 is <em>extremely not</em> called “x32”; this is what Linux used to call its x86 ILP32<sup id="fnref:ilp32:1" role="doc-noteref"><a href="#fn:ilp32" rel="footnote">4</a></sup> variant before it was removed (which, following the ARM names, would have been called <code>x86_6432</code>).</p> <p>There are also many ficticious names for 64-bit x86, which you should avoid unless you want the younger generation to make fun of you. <code>amd64</code> refers to AMD’s original implementation of long mode in their K8 microarchitecture, first shipped in their <a href="https://en.wikipedia.org/wiki/Athlon_64">Athlon 64</a> product. AMD still makes the best x86 chips (I am writing this on a machine socketed with a Zen2 Threadripper), sure, but calling it <code>amd64</code> is silly and also looks a lot like <code>arm64</code>, and I am honestly kinda annoyed at how much Go code I’ve seen with files named <code>fast_arm64.s</code> and <code>fast_amd64.s</code>. Debian also uses <code>amd64</code>/<code>arm64</code>, which makes browsing packages kind of annoying.</p> <p>On that topic, you should <em>absolutely not</em> call 64-bit mode <code>k8</code>, after the AMD K8. Nobody except for weird computer taxonomists like me know what that is. But Bazel calls it that, and it’s really irritating<sup id="fnref:piii" role="doc-noteref"><a href="#fn:piii" rel="footnote">13</a></sup>.</p> <p>You should also not call it <code>x64</code>. Although LLVM does accept <code>amd64</code> for historical purposes, no one calls it <code>x64</code> except for Microsoft. And even though it is fairly prevalent on Windows, I absolutely give my gamedev friends a hard time when they write <code>x64</code>.</p> <p>On the ARM side, well. Arm<sup id="fnref:arm-holdings" role="doc-noteref"><a href="#fn:arm-holdings" rel="footnote">14</a></sup> has a bad habit of not using consistent naming for 64-bit ARM, since they used both AArch64 and ARM64 for it. However, in compiler land, <code>aarch64</code> appears to be somewhat more popular.</p> <p>You should also probably stick to the LLVM names for the various architectures, instead of picking your favorite Arm Cortex name (like <code>cortex_m0</code>).</p> <h2 id="vendors-and-operating-systems"><a href="#vendors-and-operating-systems">Vendors and Operating Systems</a></h2> <p>The worst is over. Let’s now move onto examinining the rest of the triple: the platform vendor, and the operating system.</p> <p>The vendor is intended to identify who is responsible for the ABI definition for that target. Although provides little to no value to the compiler itself, but it does help to sort related targets together. Sort of.</p> <p>Returning to <code>llvm::Triple</code>, we can examine <code>Triple::VendorType</code>. Vendors almost always correspond to companies which develop operating systems or other platforms that code runs on, with some exceptions.</p> <p>We can also get the vendors that <code>rustc</code> knows about with a handy dandy command:</p> <div><figure><pre><code data-lang="console"><span>rustc --print target-list | grep -P '\w+-\w+-' | cut -d- -f2 | sort | uniq</span></code></pre></figure></div> <p>The result is this. This is just a representative list; I have left off a few that are not going to be especially recognizeable.</p> <table> <thead> <tr> <th>Vendor</th> <th>Name</th> <th>Example Triple</th> </tr> </thead> <tbody> <tr> <td>Vendor Unknown<sup id="fnref:unknown" role="doc-noteref"><a href="#fn:unknown" rel="footnote">15</a></sup></td> <td><code>unknown</code></td> <td><code>x86_64-unknown-linux</code></td> </tr> <tr> <td>“PC”</td> <td><code>pc</code></td> <td><code>x86_64-pc-windows-msvc</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/AMD">Advanced Micro Devices Inc.</a></td> <td><code>amd</code></td> <td><code>amdgcn-amd-gfx906</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Apple_Inc.">Apple Inc.</a></td> <td><code>apple</code></td> <td><code>aarch64-apple-ios-sim</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Intel">Intel Corporation</a></td> <td><code>intel</code></td> <td><code>i386-intel-elfiamcu</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/IBM">IBM Corporation</a></td> <td><code>ibm</code></td> <td><code>powerpc64-ibm-aix</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Mesa_(computer_graphics)">Mesa3D Project</a></td> <td><code>mesa</code></td> <td><code>amdgcn-mesa-mesa3d</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/MIPS_Technologies">MIPS Technologies LLC</a></td> <td><code>mti</code></td> <td><code>mips-mti-none-elf</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Nintendo">Nintendo</a></td> <td><code>nintendo</code></td> <td><code>armv6k-nintendo-3ds</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Nvidia">Nvidia Corporation</a></td> <td><code>nvidia</code></td> <td><code>nvptx64-nvidia-cuda</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Sony_Interactive_Entertainment">Sony Interactive Entertainment</a></td> <td><code>scei</code>, <code>sie</code>, <code>sony</code></td> <td><code>x86_64-sie-ps5</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Sun_Microsystems">Sun Microsystems</a></td> <td><code>sun</code></td> <td><code>sparcv9-sun-solaris</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/SUSE_S.A.">SUSE S. A.</a></td> <td><code>suse</code></td> <td><code>aarch64-suse-linux</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Red_Hat">Red Hat, Inc</a></td> <td><code>redhat</code></td> <td><code>x86_64-redhat-linux</code></td> </tr> <tr> <td><a href="https://en.wikipedia.org/wiki/Universal_Windows_Platform">Universal Windows Platform</a></td> <td><code>uwp</code></td> <td><code>aarch64-uwp-windows-msvc</code></td> </tr> </tbody> </table> <p>Most vendors are the names of organizations that produce hardware or operating systems. For example <code>suse</code> and <code>redhat</code> are used for those organizations’ Linux distributions, as a funny branding thing. Some vendors are projects, like the <code>mesa</code> vendor used with the Mesa3D OpenGL implementation’s triples.</p> <p>The <code>unknown</code> vendor is used for cases where the vendor is not specified or just not important. For example, the canonical Linux triple is <code>x86_64-unknown-linux</code>… although one could argue it should be <code>x86_64-torvalds-linux</code>. It is not uncommon for companies that sell/distribute Linux distributions to have their own target triples, as do SUSE and sometimes RedHat. Notably, there are no triples with a <code>google</code> vendor, even though <code>aarch64-linux-android</code> and <code>aarch64-unknown-fuchsia</code> should really be called <code>aarch64-google-linux-android</code> and <code>aarch64-google-fuchsia</code>. The target triple system begins to show cracks here.</p> <p>The <code>pc</code> vendor is a bit weirder, and is mostly used by Windows targets. The standard Windows target is <code>x86_64-pc-windows-msvc</code>, but really it should have been <code>x86_64-microsoft-windows-msvc</code>. This is likely complicated by the fact that there is also a <code>x86_64-pc-windows-gnu</code> triple, which is for <a href="https://en.wikipedia.org/wiki/MinGW">MinGW</a> code. This platform, despite running on Windows, is not provided by Microsoft, so it would probably make more sense to be called <code>x86_64-unknown-windows-gnu</code>.</p> <p>But not all Windows targets are <code>pc</code>! <a href="https://en.wikipedia.org/wiki/Universal_Windows_Platform">UWP</a> apps use a different triple, that replaces the <code>pc</code> with <code>uwp</code>. <code>rustc</code> provides targets for Windows 7 backports that use a <code>win7</code> “vendor”.</p> <h3 id="beyond-operating-systems"><a href="#beyond-operating-systems">Beyond Operating Systems</a></h3> <p>The third (or sometimes second, ugh) component of a triple is the operating system, or just “system”, since it’s much more general than that. The main thing that compilers get from this component relates to generating code to interact with the operating system (e.g. SEH on Windows) and various details related to linking, such as object file format and relocations.</p> <p>It’s also used for setting defines like <code>__linux__</code> in C, which user code can use to determine what to do based on the target.</p> <p>We’ve seen <code>linux</code> and <code>windows</code>, but you may have also seen <code>x86_64-apple-darwin</code>. <em>Darwin?</em></p> <p>The operating system formerly known as Mac OS X (now macOS<sup id="fnref:macos" role="doc-noteref"><a href="#fn:macos" rel="footnote">16</a></sup>) is a POSIX operating system. The POSIX substrate that all the Apple-specific things are built on top of is called Darwin. <a href="https://en.wikipedia.org/wiki/Darwin_(operating_system)">Darwin</a> is a free and open source operating system based on Mach, a research kernel whose name survives in Mach-O, the object file format used by all Apple products.</p> <p>All of the little doodads Apple sells use the actual official names of their OSes, like <code>aarch64-apple-ios</code>. For, you know, iOS. On your iPhone. Built with Xcode on your iMac.</p> <p><code>none</code> is a common value for this entry, which usually means a free-standing environment with no operating system. The object file format is usually specified in the fourth entry of the triple, so you might see something like <code>riscv32imc-unknown-none-elf</code>.</p> <p>Sometimes the triple refers not to an operating system, but to a complete hardware product. This is common with game console triples, which have “operating system” names like <code>ps4</code>, <code>psvita</code>, <code>3ds</code>, and <code>switch</code>. (Both Sony and Nintendo use LLVM as the basis for their internal toolchains; the Xbox toolchain is just MSVC).</p> <h2 id="abi-abi"><a href="#abi-abi">ABI! ABI!</a></h2> <p>The fourth entry of the triple (and I repeat myself, yes, it’s still a triple) represents the binary interface for the target, when it is ambiguous.</p> <p>For example, Apple targets never have this, because on an Apple platform, you just shut up and use <code>CoreFoundation.framework</code> as your libc. Except this isn’t true, because of things like <code>x86_64-apple-ios-sim</code>, the iOS simulator running on an x86 host.</p> <p>On the other hand, Windows targets will usually specify <code>-msvc</code> or <code>-gnu</code>, to indicate whether they are built to match MSVC’s ABI or MinGW. Linux targets will usually specify the libc vendor in this position: <code>-gnu</code> for glibc, <code>-musl</code> for musl, <code>-newlib</code> for newlib, and so on.</p> <p>This doesn’t just influence the calling convention; it also influences how language features, such as thread locals and dynamic linking, are handled. This usually requires coordination with the target libc.</p> <p>On ARM free-standing (<code>armxxx-unknown-none</code>) targets, <code>-eabi</code> specifies the ARM EABI, which is a standard embeded ABI for ARM. <code>-eabihf</code> is similar, but indicates that no soft float support is necessary (<code>hf</code> stands for hardfloat). (Note that Rust does not include a vendor with these architectures, so they’re more like <code>armv7r-none-eabi</code>).</p> <p>A lot of jankier targets use the ABI portion to specify the object file, such as the aforementioned <code>riscv32imc-unknown-none-elf</code>.</p> <h2 id="wasm-targets"><a href="#wasm-targets">WASM Targets</a></h2> <p>One last thing to note are the various WebAssembly targets, which completely ignore all of the above conventions. Their triples often only have two components (they are still called triples, hopefully I’ve made that clear by now). Rust is a little bit more on the forefront here than <code>clang</code> (and anyways I don’t want to get into Emscripten) so I’ll stick to what’s going on in <code>rustc</code>.</p> <p>There’s a few variants. <code>wasm32-unknown-unknown</code> (here using <code>unknown</code> instead of <code>none</code> as the system, oops) is a completely bare WebAssebly runtime where none of the standard library that needs to interact with the outside world works. This is essentially for building WebAssembly modules to deploy in a browser.</p> <p>There are also the WASI targets, which provide a standard ABI for talking to the host operating system. These are less meant for browsers and more for people who are using WASI as a security boundary. These have names like <code>wasm32-wasip1</code>, which, unusually, lack a vendor! A “more correct” formulation would have been <code>wasm32-unknown-wasip1</code>.</p> <h2 id="aside-on-go"><a href="#aside-on-go">Aside on Go</a></h2> <p>Go does the correct thing and distributes a cross compiler. This is well and good.</p> <p>Unfortunately, they decided to be different and special and do not use the target triple system for naming their targets. Instead, you set the <code>GOARCH</code> and <code>GOOS</code> environment variables before invoking <code>gc</code>. This will sometimes be shown printed with a slash between, such as <code>linux/amd64</code>.</p> <p>Thankfully, they at least provide documentation for a relevant internal package <a href="https://pkg.go.dev/internal/platform">here</a>, which offers the names of various <code>GOARCH</code> and <code>GOOS</code> values.</p> <p>They use completely different names from everyone else for a few things, which is guaranteed to trip you up. They use call the 32- and 64-bit variants of x86 <code>386</code> (note the lack of leading <code>i</code>) and <code>amd64</code>. They call 64-bit ARM <code>arm64</code>, instead of <code>aarch64</code>. They call little-endian MIPSes <code>mipsle</code> instead of <code>mipsel</code>.</p> <p>They also call 32-bit WebAssembly <code>wasm</code> instead of <code>wasm32</code>, which is a bit silly, and they use <code>js/wasm</code> as their equivalent of <code>wasm32-unknown-unknown</code>, which is <em>very</em> silly.</p> <p>Android is treated as its own operating system, <code>android</code>, rather than being <code>linux</code> with a particular ABI; their system also can’t account for ABI variants in general, since Go originally wanted to not have to link any system libraries, something that does not actually work.</p> <p>If you are building a new toolchain, don’t be clever by inventing a cute target triple convention. All you’ll do is annoy people who need to work with a lot of different toolchains by being different and special.</p> <h2 id="inventing-your-own-triples"><a href="#inventing-your-own-triples">Inventing Your Own Triples</a></h2> <p>Realistically, you probably shouldn’t. But if you must, you should probably figure out what you want out of the triple.</p> <p>Odds are there isn’t anything interesting to put in the vendor field, so you will avoid people a lot of pain by picking <code>unknown</code>. Just include a vendor to avoid pain for people in the future.</p> <p>You should also avoid inventing a new name for an existing architecture. Don’t name your hobby operating system’s triple <code>amd64-unknown-whatever</code>, please. And you definitely don’t want to have an ABI component. One ABI is enough.</p> <p>If you’re inventing a triple for a free-standing environment, but want to specify something about the hardware configuration, you’re probably gonna want to use <code>-none-&lt;abi&gt;</code> for your system. For some firmware use-cases, though, the system entry is a better place, such as for the UEFI triples. Although, I have unforunately seen both <code>x86_64-unknown-uefi</code> and <code>x86_64-pc-none-uefi</code> in the wild.</p> <p>And most imporantly: this sytem was built up organically. Disabuse yourself now of the idea that the system is consistent and that target triples are easy to parse. Trying to parse them will make you very sad.</p>  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[I speak at Harvard as it faces its biggest crisis since 1636 (101 pts)]]></title>
            <link>https://scottaaronson.blog/?p=8805</link>
            <guid>43696010</guid>
            <pubDate>Tue, 15 Apr 2025 17:35:10 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://scottaaronson.blog/?p=8805">https://scottaaronson.blog/?p=8805</a>, See on <a href="https://news.ycombinator.com/item?id=43696010">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="post-8805">
				
<p>Every week, I tell myself I won’t do yet another post about the asteroid striking American academia, and then every week events force my hand otherwise.</p>



<p>No one on earth—<em>certainly</em> no one who reads this blog—could call me blasé about the issue of antisemitism at US universities.  I’ve blasted the takeover of entire departments and unrelated student clubs and campus common areas by the dogmatic belief that the State of Israel (and <em>only</em> Israel, among all nations on earth) should be eradicated, by the use of that belief as a litmus test for entry.  Since October 7, I’ve dealt with comments and emails pretty much every day calling me a genocidal Judeofascist Zionist.</p>



<p>So I hope it means something when I say: <em>today I salute Harvard for standing up to the Trump administration</em>. And I’ll say so in person, when I visit Harvard’s math department later this week to give the <a href="https://cmsa.fas.harvard.edu/event/yip-2025/">Fifth Annual Yip Lecture</a>, on “How Much Math Is Knowable?”  The more depressing the news, I find, the more my thoughts turn to the same questions that bothered Euclid and Archimedes and Leibniz and Russell and Turing.  Actually, what the hell, why don’t I share the abstract for this talk?</p>



<blockquote>
<p>Theoretical computer science has over the years sought more and more refined answers to the question of which mathematical&nbsp;truths are knowable by finite beings like ourselves,&nbsp;bounded in time and space and subject to physical laws.&nbsp; I’ll tell a story that starts with Gödel’s Incompleteness Theorem and Turing’s discovery of uncomputability.&nbsp; I’ll then introduce the spectacular Busy Beaver function, which grows faster than any computable function.&nbsp; Work by me and Yedidia, along with recent improvements by O’Rear and Riebel, has shown that the value of BB(745) is independent of the axioms of set theory; on the other end, an international collaboration proved last year that BB(5) = 47,176,870.&nbsp; I’ll speculate on whether BB(6) will ever be known,&nbsp;by us or our AI successors.&nbsp; I’ll next discuss the P≠NP conjecture and what it&nbsp;does and doesn’t mean for the limits of machine&nbsp;intelligence.&nbsp; As my own specialty is quantum computing,&nbsp;I’ll summarize what we know about how scalable quantum computers, assuming we get&nbsp;them,&nbsp;will expand the&nbsp;boundary of what’s mathematically knowable.&nbsp; I’ll end by talking about hypothetical models even beyond quantum computers, which might expand the boundary of knowability still&nbsp;further, if one is able (for example) to jump into a black hole, create a closed timelike curve, or project oneself onto the holographic boundary of the universe.</p>
</blockquote>



<p>Now back to the depressing news.  What makes me take Harvard’s side is the experience of Columbia. Columbia had already been moving in the right direction on fighting antisemitism, and on enforcing its rules against disruption, before the government even got involved.  Then, once the government <em>did</em> take away funding and present its ultimatum—completely outside the process specified in Title VI law—Columbia’s administration quickly agreed to everything asked, to howls of outrage from the left-leaning faculty. Yet <strong>despite its total capitulation,</strong> the government has <em>continued</em> to hold Columbia’s medical research and other science funding hostage, while inventing a never-ending list of additional demands, whose apparent endpoint is that Columbia submit to state ideological control like a university in Russia or Iran.</p>



<p>By taking this scorched-earth route, the government has effectively telegraphed to all the <em>other</em> universities, as clearly as possible: “actually, we don’t care what you do or don’t do on antisemitism. We just want to destroy you, and antisemitism was our best available pretext, the place where you’d most obviously fallen short of your ideals. But we’re not really trying to cure a sick patient, or force the patient to adopt better health habits: we’re trying to shoot, disembowel, and dismember the patient. That being the case, you might as well fight us and go down with dignity!”</p>



<p>No wonder that my distinguished Harvard friends (and past <em>Shtetl-Optimized</em> guest bloggers) <a href="https://x.com/sapinker/status/1911984035263393798">Steven Pinker</a> and <a href="https://x.com/boazbaraktcs/status/1911841870625558742">Boaz Barak</a>—not exactly known as anti-Zionist woke radicals—have come out in favor of Harvard fighting this in court.  So has Harvard’s past president <a href="https://x.com/LHSummers/status/1911839522058367129">Larry Summers</a>, who’s welcome to guest-blog here as well.  They all understand that events have given us no choice but to fight Trump as if there were no antisemitism, even while we continue to fight antisemitism as if there were no Trump.</p>

		
				
				<p>
					<small>
						This entry was posted
												on Tuesday, April 15th, 2025 at 12:22 pm						and is filed under <a href="https://scottaaronson.blog/?cat=42" rel="category">Obviously I'm Not Defending Aaronson</a>, <a href="https://scottaaronson.blog/?cat=8" rel="category">The Fate of Humanity</a>.
						You can follow any responses to this entry through the <a href="https://scottaaronson.blog/?feed=rss2&amp;p=8805">RSS 2.0</a> feed.

													You can <a href="#respond">leave a response</a>, or <a href="https://scottaaronson.blog/wp-trackback.php?p=8805" rel="trackback">trackback</a> from your own site.

						
					</small>
				</p>

			</div><p>You can use rich HTML in comments!  You can also use basic TeX, by enclosing it within <span>$$ $$</span> for displayed equations or <span>\( \)</span> for inline equations.</p><p>
	After two decades of mostly-open comments, in July 2024 <i>Shtetl-Optimized</i> transitioned to the following policy:
	
</p><p>All comments are treated, by default, as personal missives to me, Scott Aaronson---with no expectation either that they'll appear on the blog or that I'll reply to them.

</p><p>At my leisure and discretion, and in consultation with the <a href="https://scottaaronson.blog/?p=6576"><i>Shtetl-Optimized</i> Committee of Guardians</a>, I'll put on the blog a curated selection of comments that I judge to be particularly interesting or to move the topic forward, and I'll do my best to answer those.  But it will be more like Letters to the Editor.  Anyone who feels unjustly censored is welcome to the rest of the Internet.

</p></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The case of the UI thread that hung in a kernel call (126 pts)]]></title>
            <link>https://devblogs.microsoft.com/oldnewthing/20250411-00/?p=111066</link>
            <guid>43695723</guid>
            <pubDate>Tue, 15 Apr 2025 17:13:31 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://devblogs.microsoft.com/oldnewthing/20250411-00/?p=111066">https://devblogs.microsoft.com/oldnewthing/20250411-00/?p=111066</a>, See on <a href="https://news.ycombinator.com/item?id=43695723">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="single-wrapper">
    
    <article data-clarity-region="article" id="post-111066">
        <div data-bi-area="body_article" data-bi-id="post_page_body_article">
            <p>A customer asked for help with a longstanding but low-frequency hang that they have never been able to figure out. From what they could tell, their UI thread was calling into the kernel, and the call simply hung for no apparent reason. Unfortunately, the kernel dump couldn’t show a stack from user mode because the stack had been paged out. (Which makes sense, because a hung thread isn’t using its stack, so once the system is under some memory pressure, that stack gets paged out.)</p>
<pre>0: kd&gt; !thread 0xffffd18b976ec080 7
THREAD ffffd18b976ec080  Cid 79a0.7f18  Teb: 0000003d7ca28000
    Win32Thread: ffffd18b89a8f170 WAIT: (Suspended) KernelMode Non-Alertable
SuspendCount 1
    ffffd18b976ec360  NotificationEvent
Not impersonating
DeviceMap                 ffffad897944d640
Owning Process            ffffd18bcf9ec080       Image:         contoso.exe
Attached Process          N/A            Image:         N/A
Wait Start TickCount      14112735       Ticks: 1235580 (0:05:21:45.937)
Context Switch Count      1442664        IdealProcessor: 2             
UserTime                  00:02:46.015
KernelTime                00:01:11.515

 nt!KiSwapContext+0x76
 nt!KiSwapThread+0x928
 nt!KiCommitThreadWait+0x370
 nt!KeWaitForSingleObject+0x7a4
 nt!KiSchedulerApc+0xec
 nt!KiDeliverApc+0x5f9
 nt!KiCheckForKernelApcDelivery+0x34
 nt!MiUnlockAndDereferenceVad+0x8d
 nt!MmProtectVirtualMemory+0x312
 nt!NtProtectVirtualMemory+0x1d9
 nt!KiSystemServiceCopyEnd+0x25 (TrapFrame @ ffff8707`a9bef3a0)
 ntdll!ZwProtectVirtualMemory+0x14
 [end of stack trace]
</pre>
<p>Although we couldn’t see what the code was doing in user mode, there was something unusual in the information that was present.</p>
<p>Observe that the offending thread is <i>Suspended</i>. And it appears to have been suspended for over five hours.</p>
<pre>THREAD ffffd18b976ec080  Cid 79a0.7f18  Teb: 0000003d7ca28000
    Win32Thread: ffffd18b89a8f170 WAIT: (<span>Suspended</span>) KernelMode Non-Alertable
SuspendCount 1
    ffffd18b976ec360  NotificationEvent
Not impersonating
DeviceMap                 ffffad897944d640
Owning Process            ffffd18bcf9ec080       Image:         contoso.exe
Attached Process          N/A            Image:         N/A
Wait Start TickCount      14112735       Ticks: 1235580 (<span>0:05:21:45.937</span>)
</pre>
<p>Naturally, a suspended UI thread is going to manifest itself as a hang.</p>
<p>Functions like <code>Suspend­Thread</code> exist primarily for debuggers to use, so we asked them if they had a debugger attached to the process when they captured the kernel dump. They said that they did not.</p>
<p>So who suspended the thread, and why?</p>
<p>The customer then realized that they had a watchdog thread which monitors the UI thread for responsiveness, and every so often, it suspends the UI thread, captures a stack trace, and then resumes the UI thread. And in the dump file, they were able to observe their watchdog thread in the middle of its stack trace capturing code. But why was the stack trace capture taking five hours?</p>
<p>The stack of the watchdog thread looks like this:</p>
<pre>ntdll!ZwWaitForAlertByThreadId(void)+0x14
ntdll!RtlpAcquireSRWLockSharedContended+0x15a
ntdll!RtlpxLookupFunctionTable+0x180
ntdll!RtlLookupFunctionEntry+0x4d
contoso!GetStackTrace+0x72
contoso!GetStackTraceOfUIThread+0x127
...
</pre>
<p>Okay, so we see that the watchdog thread is trying to get a stack trace of the UI thread, but it’s hung inside <code>Rtl­Lookup­Function­Entry</code> which is waiting for a lock.</p>
<p>You know who I bet holds the lock?</p>
<p>The UI thread.</p>
<p>Which is suspended.</p>
<p>The UI thread is probably trying to dispatch an exception, which means that it is walking the stack looking for an exception handler. But in the middle of this search, it got suspended by the watchdog thread. Then the watchdog thread tries to walk the stack of the UI thread, but it can’t do that yet because the function table is locked by the UI thread’s stack walk.</p>
<p>This is a practical exam for a previous discussion: <a title="Why you should never suspend a thread" href="https://devblogs.microsoft.com/oldnewthing/20031209-00/?p=41573"> Why you should never suspend a thread</a>.</p>
<p>Specifically, the title should say “Why you should never suspend a thread <i>in your own process</i>.” Suspending a thread in your own process runs the risk that the thread you suspended was in possession of some resource that the rest of the program needs. In particular, it might possess a resource that is needed by the code which has responsible for eventually resuming the thread. Since it is suspended, it will never get a chance to release those resources, and you end up with a deadlock between the suspended thread and the thread whose job it is to resume that thread.</p>
<p>If you want to suspend a thread and capture stacks from it, you’ll have to do it from another process, so that you don’t deadlock with the thread you suspended.¹</p>
<p><b>Bonus chatter</b>: In this kernel stack, you can see evidence that <a title="The SuspendThread function suspends a thread, but it does so asynchronously" href="https://devblogs.microsoft.com/oldnewthing/20150205-00/?p=44743"> the <code>Suspend­Thread</code> operates asynchronously</a>. When the watchdog thread calls <code>Suspend­Thread</code> to suspend the UI thread, the UI thread was in the kernel, in the middle of changing memory protections. The thread does not suspend immediately, but rather waits for the kernel to finish its work, and then before returning to user mode, the kernel does a <code>Check­For­Kernel­Apc­Delivery</code> to see if there were any requests waiting. It picks up the request to suspend, and that is when the thread actually suspends.²</p>
<p><b>Bonus bonus chatter</b>: “What if the kernel delayed suspending a thread if it held any user-mode locks? Wouldn’t that avoid this problem?” First of all, how would the kernel even know whether a thread held any user-mode locks? There is no reliable signature for a user-mode lock. After all, you can make a user-mode lock out of any byte of memory by using it as a spin lock. Second, even if the kernel somehow could figure out whether a thread held a user-mode lock, you don’t want that to block thread suspension, because that would let a program make itself un-suspendable! Just call <code>AcquireSRWLockShared(some_global_srwlock)</code> and never call the corresponding <code>Release</code> function. Congratulations, the thread perpetually owns the global lock in shared mode and would therefore now be immune from suspension.</p>
<p>¹ Of course, this also requires that the code that does the suspending does not wait on cross-process resources like semaphores, mutexes, or file locks, because those might be held by the suspended thread.</p>
<p>² The kernel doesn’t suspend the thread immediately because it might be in possession of internal kernel locks, and suspending a thread while it owns a kernel lock (such as the lock that synchronizes access to the page tables) would result in the kernel itself deadlocking!</p>
        </div><!-- .entry-content -->

        <!-- AI Disclaimer -->
            </article>
    
</div><div><!-- Author section -->
            <h2>Author</h2>
            <div><div><p><img src="https://devblogs.microsoft.com/oldnewthing/wp-content/uploads/sites/38/2019/02/RaymondChen_5in-150x150.jpg" alt="Raymond Chen"></p></div><p>Raymond has been involved in the evolution of Windows for more than 30 years. In 2003, he began a Web site known as The Old New Thing which has grown in popularity far beyond his wildest imagination, a development which still gives him the heebie-jeebies. The Web site spawned a book, coincidentally also titled The Old New Thing (Addison Wesley 2007). He occasionally appears on the Windows Dev Docs Twitter account to tell stories which convey no useful information.</p></div>        </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[It's easier than ever to de-censor videos (356 pts)]]></title>
            <link>https://www.jeffgeerling.com/blog/2025/its-easier-ever-de-censor-videos</link>
            <guid>43695701</guid>
            <pubDate>Tue, 15 Apr 2025 17:12:22 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.jeffgeerling.com/blog/2025/its-easier-ever-de-censor-videos">https://www.jeffgeerling.com/blog/2025/its-easier-ever-de-censor-videos</a>, See on <a href="https://news.ycombinator.com/item?id=43695701">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Last month I asked people to <a href="https://youtu.be/gaV-O6NPWrI?t=297">hack part of my YouTube video</a>, specifically to de-pixelate the contents of a folder I had pixelated starting at the 4:57 mark.</p>

<p>
<video controls="">
  <source src="https://www.jeffgeerling.com/sites/default/files/depixelate-original-video-ezgif.com-mute-video.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
</p>

<p>For years, people have used the censor tool to blur or pixelate out parts of videos where there's sensitive information. And for years, every time I've used it, I get a few comments from people saying that's not a safe way to censor information.</p>

<p>So is that true?</p>

<p>I wanted to find out, so I put a message saying I'd send fifty bucks to anyone who could tell me what it said under the pixelation. And you know what? Less than a day later, <em>three</em> people solved it, using three slightly different techniques—scary!</p>

<p>This blog post is a lightly edited transcript of the following video:</p>

<div>
<p><iframe src="https://www.youtube.com/embed/acKYYwcxpGk" frameborder="0" allowfullscreen=""></iframe></p>
</div>

<h2>How did they do it?</h2>

<p>But how did they do it? I asked each of them, and they were more than happy to share. For most of us who like reverse-engineering or tinkering, it's fun to share the craft. And even more fun when it's <em>sanctioned</em> fun. Add on a little monetary reward, and that's just icing on the cake.</p>

<p>GitHub user KoKuToru was kind enough to share <a href="https://github.com/KoKuToru/de-pixelate_gaV-O6NPWrI">an entire GitHub repo</a> with the process and the code, along with two different ways that user tried to depixlate my footage.</p>

<p>First a <a href="https://github.com/KoKuToru/de-pixelate_gaV-O6NPWrI/tree/master/v1">brute-force attempt</a> to extract aligned images of just the window, with some code using TensorFlow to extract pixel data and aggregate it into a somewhat-fuzzy (but almost clear enough to read) picture:</p>

<p>
<video controls="">
  <source src="https://www.jeffgeerling.com/sites/default/files/depixelate-v1-result.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
</p>

<p>The idea here is the pixelation is kind of like shutters over a picture. As you move the image beneath, you can peek into different parts of the picture. As long as you have a solid frame of reference, like the window that stays the same size, you can 'accumulate' pixel data from the picture underneath.</p>

<p>Due to the slight error in selecting the window by hand, the final result was slightly blotchy. For the second attempt, GIMP was used to get a better window selection algorithm with ffmpeg, and with a slight bit more data (more frames extracted), a perfectly legible result:</p>

<p>
<video controls="">
  <source src="https://www.jeffgeerling.com/sites/default/files/depixelate-v2-result.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
</p>

<h2>Any way to prevent it?</h2>

<p>Blurring or pixelating video, especially <em>moving</em> video, may lead to similar results as you saw here. Years ago it would've required a supercomputer and a PhD to do this stuff. But today, between AI assistance with the trickier bits of coding, and how fast neural networks run on computers, it's easier and faster than ever to de-pixelate video!</p>

<p>If there's one thing computers are good at, it's finding order in seeming chaos, like how modern tools can <a href="https://www.youtube.com/watch?v=7msuhEq1Vz4">pull a clean voice out of a horrible recording</a>.</p>

<p>The more motion in the video, the more data points the reverse engineering has to play with. And thus, the better the confidence in the results.</p>

<p>If I <em>hadn't</em> moved around my Finder window in the video, I don't think it would've worked. You might get a couple letters right, but it would be very low confidence.</p>

<p>Moving forward, if I <em>do</em> have sensitive data to hide, I'll place a pure-color mask over the area, instead of a blur or pixelation effect.</p>

<p>Intuitively, blur might do better than pixelation... but that might just be my own monkey brain talking. I'd love to hear more in the comments if you've dealt with that kind of image processing in the past.</p>

<p>It's amazing what people can do with a neural network, ingenuity, and time.</p>

<p>I guess the moral of the story is <em>if you don't want people to read censored data... don't post it online</em>.</p>

<p>tl;dr - check out <a href="https://github.com/KoKuToru/de-pixelate_gaV-O6NPWrI/tree/master/v1">KoKoToru's de-pixelate GitHub repo for all the details on how it was done</a>.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Clolog (225 pts)]]></title>
            <link>https://github.com/bobschrag/clolog</link>
            <guid>43695620</guid>
            <pubDate>Tue, 15 Apr 2025 17:04:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/bobschrag/clolog">https://github.com/bobschrag/clolog</a>, See on <a href="https://news.ycombinator.com/item?id=43695620">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">clolog</h2><a id="user-content-clolog" aria-label="Permalink: clolog" href="#clolog"></a></p>
<p dir="auto">Full-featured logic programming (AKA "Prolog") embedded in/callable
from and supporting calls to Clojure.  In the spirit of LogLisp, Lisp
Machine Prolog, and Franz Inc.'s Allegro Prolog, with some extra
goodies.  Emphasis on expressive power and execution transparency,
supporting rapid prototyping, proof-of-concept development, and
outer-loop reasoning (i.e., not real fast, so far).</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Highlights, with examples</h2><a id="user-content-highlights-with-examples" aria-label="Permalink: Highlights, with examples" href="#highlights-with-examples"></a></p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Clojure-based, Lispy (i.e., homoiconic) syntax, e.g., ...</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="(do 
    ;; Set up, clear knowledge base.
    (initialize-prolog)
    ;; Create unit assertion.    
    (<- (has-subtype vertebrate mammal)) 
    ;; Execute query.
    (? ?x ; Answer template
       (has-subtype vertebrate ?x) ; Goal.
       )
    )
  [mammal] ; Answer(s) in vector (perhaps empty)."><pre>(<span>do</span> 
    <span><span>;</span>; Set up, clear knowledge base.</span>
    (<span>initialize-prolog</span>)
    <span><span>;</span>; Create unit assertion.    </span>
    (<span>&lt;-</span> (<span>has-subtype</span> vertebrate mammal)) 
    <span><span>;</span>; Execute query.</span>
    (<span>?</span> ?x <span><span>;</span> Answer template</span>
       (<span>has-subtype</span> vertebrate ?x) <span><span>;</span> Goal.</span>
       )
    )
  [mammal] <span><span>;</span> Answer(s) in vector (perhaps empty).</span></pre></div>
</li>
<li>
<p dir="auto"><strong>Logical variable- ("?var")-containing Clojure seqs (so, lists) and
vectors as "complex" terms---in assertion statements and answer templates</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (? (?a ?b)
     (same [?a 2] [1 ?b]))
[(1 2)]"><pre>&gt; (<span>?</span> (<span>?a</span> ?b)
     (<span>same</span> [?a <span>2</span>] [<span>1</span> ?b]))
[(<span>1</span> <span>2</span>)]</pre></div>
</li>
<li>
<p dir="auto"><strong>Clojure calling predicates</strong></p>
<ul dir="auto">
<li>
<p dir="auto">Truthiness check: <code>truthy?</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (? true (truthy? (+ 1 2)))
[true]"><pre>&gt; (<span>?</span> <span>true</span> (<span>truthy?</span> (<span>+</span> <span>1</span> <span>2</span>)))
[<span>true</span>]</pre></div>
</li>
<li>
<p dir="auto">?var-bearing term unification: <code>evals-from?</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (? ?x (evals-from? ?x (+ 1 2)))
[3]"><pre>&gt; (<span>?</span> ?x (<span>evals-from?</span> ?x (<span>+</span> <span>1</span> <span>2</span>)))
[<span>3</span>]</pre></div>
</li>
<li>
<p dir="auto">Side effect: <code>do</code></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (? nil (do (println &quot;Hello&quot;)))
Hello
[nil]"><pre>&gt; (<span>?</span> <span>nil</span> (<span>do</span> (<span>println</span> <span><span>"</span>Hello<span>"</span></span>)))
Hello
[<span>nil</span>]</pre></div>
</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Access to ?var bindings in Clojure calls---even within quoted
expressions</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (<-- (male laban))
      (? ?y (male ?x) (evals-from? ?y (list '?x))))
[(laban)]"><pre>&gt; (<span>do</span> (<span>&lt;--</span> (<span>male</span> laban))
      (<span>?</span> ?y (<span>male</span> ?x) (<span>evals-from?</span> ?y (<span>list</span> '?x))))
[(<span>laban</span>)]</pre></div>
</li>
<li>
<p dir="auto"><strong>Negation as failure: <code>not</code></strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog) ; Clear knowledge base.
      (? :nothing (not (Huh?))))
[:nothing]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>) <span><span>;</span> Clear knowledge base.</span>
      (<span>?</span> <span>:nothing</span> (<span>not</span> (<span>Huh?</span>))))
[<span>:nothing</span>]</pre></div>
</li>
<li>
<p dir="auto"><strong>Facilitated access to Clojure values (<code>evals-from?</code> shorthand
<code>-&gt;?</code>) in goals with Clojure-calling predicates</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (binding [*leash* true]
    (? true (same (->? (+ 0 1)) 1)))
0. Processing query: ((same (->? (+ 0 1)) 1))
 Applied ->? transform
 (evals-from?): Entering (evals-from? ??-0:0 (+ 0 1))
 (evals-from?): Succeeded (evals-from? 1 (+ 0 1))
 (same): Entering (same 1 1)
 (same): Succeeded (same 1 1)
Recorded answer: true
Answer limit reached. ; Because answer template `true` has no ?vars.
[true]"><pre>&gt; (<span>binding</span> [*leash* <span>true</span>]
    (<span>?</span> <span>true</span> (<span>same</span> (<span>-&gt;?</span> (<span>+</span> <span>0</span> <span>1</span>)) <span>1</span>)))
<span>0.</span> Processing query: ((<span>same</span> (<span>-&gt;?</span> (<span>+</span> <span>0</span> <span>1</span>)) <span>1</span>))
 Applied -&gt;? transform
 (<span>evals-from?</span>): Entering (<span>evals-from?</span> ??-0:0 (<span>+</span> <span>0</span> <span>1</span>))
 (<span>evals-from?</span>): Succeeded (<span>evals-from?</span> <span>1</span> (<span>+</span> <span>0</span> <span>1</span>))
 (<span>same</span>): Entering (<span>same</span> <span>1</span> <span>1</span>)
 (<span>same</span>): Succeeded (<span>same</span> <span>1</span> <span>1</span>)
Recorded answer: <span>true</span>
Answer limit reached. <span><span>;</span> Because answer template `true` has no ?vars.</span>
[<span>true</span>]</pre></div>
</li>
<li>
<p dir="auto"><strong>Built-in term [non-]matching predicates: <code>same</code>, <code>different</code></strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (? (?a ?b)
     (same [?a 2] [1 ?b]))
[(1 2)]

> (? (?a ?b)
     (different [?a 2] [1 ?b]))
[]"><pre>&gt; (<span>?</span> (<span>?a</span> ?b)
     (<span>same</span> [?a <span>2</span>] [<span>1</span> ?b]))
[(<span>1</span> <span>2</span>)]

&gt; (<span>?</span> (<span>?a</span> ?b)
     (<span>different</span> [?a <span>2</span>] [<span>1</span> ?b]))
[]</pre></div>
</li>
<li>
<p dir="auto"><strong>Built-in term inspection predicates: <code>var</code>, <code>ground</code></strong></p>

<div dir="auto" data-snippet-clipboard-copy-content="> (? ?x (same ?x 1) (ground ?x))
[1]"><pre>&gt; (<span>?</span> ?x (<span>same</span> ?x <span>1</span>) (<span>ground</span> ?x))
[<span>1</span>]</pre></div>
</li>
<li>
<p dir="auto"><strong>Built-in unconditional predicates: <code>true</code>, <code>false</code></strong></p>


</li>
<li>
<p dir="auto"><strong>Nestable built-in logical operators: <code>and</code>, <code>or</code>, <code>not</code>, <code>if</code></strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (? ?x (and (if (false)
               (same ?x :succeed)
               (same ?x :fail))
             (evals-from? ?x :fail)
         (or (true) (false))))
[:fail]"><pre>&gt; (<span>?</span> ?x (<span>and</span> (<span>if</span> (<span>false</span>)
               (<span>same</span> ?x <span>:succeed</span>)
               (<span>same</span> ?x <span>:fail</span>))
             (<span>evals-from?</span> ?x <span>:fail</span>)
         (<span>or</span> (<span>true</span>) (<span>false</span>))))
[<span>:fail</span>]</pre></div>
</li>
<li>
<p dir="auto"><strong>"Cut" operator: <code>first</code></strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (sister laban rebecca))
      (<- (sister rachel leah))
      (? [?sibling ?sister]
         (first (sister ?sibling ?sister))))
 [[laban rebecca]]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>sister</span> laban rebecca))
      (<span>&lt;-</span> (<span>sister</span> rachel leah))
      (<span>?</span> [?sibling ?sister]
         (<span>first</span> (<span>sister</span> ?sibling ?sister))))
 [[laban rebecca]]</pre></div>
</li>
<li>
<p dir="auto"><strong>User-custom predicate transforms, supporting (e.g.)
varieties of <code>if</code>, <code>cond</code>, <code>optional</code></strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (create-predicate-transform '((if% ?if ?then ?else)
                              (if (first ?if) ?then ?else)))"><pre>&gt; (<span>create-predicate-transform</span> '((<span>if%</span> ?if ?then ?else)
                              (<span>if</span> (<span>first</span> ?if) ?then ?else)))</pre></div>
</li>
<li>
<p dir="auto"><strong>Full leashing of predicates, including operators</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (binding [*leash* true]
    (? [?sibling ?sister ?x] 
      (if% (sister ?sibling ?sister)
           (evals-from? ?x true)
           (evals-from? ?x false))))
0. Processing query: ((if% (sister ?sibling ?sister) (evals-from? ?x true) (evals-from? ?x false)))
 (if%): Applying logic transform (if% ?if ?then ?else)
 (if): Entering (if (first (sister ?sibling:0 ?sister:0)) (evals-from? ?x:0 true) (evals-from? ?x:0 false))
 (if): Checking 'if' condition (if (first (sister ?sibling:0 ?sister:0)) (evals-from? ?x:0 true) (evals-from? ?x:0 false))
  (if first): Entering first (first (sister ?sibling:0 ?sister:0))
   1. Entering &quot;sister/2&quot;: (sister ?sibling:0 ?sister:0)
   1. Matched head (sister laban rebecca): (sister laban rebecca)
   1. Succeeded &quot;sister/2&quot;: (sister laban rebecca)
  (if first): Succeeded, cutting (first (sister laban rebecca))
 (if): Taking 'then' branch of (if (first (sister laban rebecca)) (evals-from? ?x:0 true) (evals-from? ?x:0 false))
  (if evals-from?): Entering (evals-from? ?x:0 true)
  (if evals-from?): Succeeded (evals-from? true true)
 (if): Succeeded (if (first (sister laban rebecca)) (evals-from? true true) (evals-from? true false))
Recorded answer: [laban rebecca true]
  (if first): Failed (first (sister ?sibling:0 ?sister:0))
 (if): Failed (if (first (sister ?sibling:0 ?sister:0)) (evals-from? ?x:0 true) (evals-from? ?x:0 false))
0. Exhausted query: ((if% (sister ?sibling ?sister) (evals-from? ?x true) (evals-from? ?x false)))
[[laban rebecca true]]"><pre>&gt; (<span>binding</span> [*leash* <span>true</span>]
    (<span>?</span> [?sibling ?sister ?x] 
      (<span>if%</span> (<span>sister</span> ?sibling ?sister)
           (<span>evals-from?</span> ?x <span>true</span>)
           (<span>evals-from?</span> ?x <span>false</span>))))
<span>0.</span> Processing query: ((<span>if%</span> (<span>sister</span> ?sibling ?sister) (<span>evals-from?</span> ?x <span>true</span>) (<span>evals-from?</span> ?x <span>false</span>)))
 (<span>if%</span>): Applying logic transform (<span>if%</span> ?if ?then ?else)
 (<span>if</span>): Entering (<span>if</span> (<span>first</span> (<span>sister</span> ?sibling:0 ?sister:0)) (<span>evals-from?</span> ?x:0 <span>true</span>) (<span>evals-from?</span> ?x:0 <span>false</span>))
 (<span>if</span>): Checking 'if' condition (<span>if</span> (<span>first</span> (<span>sister</span> ?sibling:0 ?sister:0)) (<span>evals-from?</span> ?x:0 <span>true</span>) (<span>evals-from?</span> ?x:0 <span>false</span>))
  (<span>if</span> first): Entering first (<span>first</span> (<span>sister</span> ?sibling:0 ?sister:0))
   <span>1.</span> Entering <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> ?sibling:0 ?sister:0)
   <span>1.</span> Matched head (<span>sister</span> laban rebecca): (<span>sister</span> laban rebecca)
   <span>1.</span> Succeeded <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> laban rebecca)
  (<span>if</span> first): Succeeded, cutting (<span>first</span> (<span>sister</span> laban rebecca))
 (<span>if</span>): Taking 'then' branch of (<span>if</span> (<span>first</span> (<span>sister</span> laban rebecca)) (<span>evals-from?</span> ?x:0 <span>true</span>) (<span>evals-from?</span> ?x:0 <span>false</span>))
  (<span>if</span> evals-from?): Entering (<span>evals-from?</span> ?x:0 <span>true</span>)
  (<span>if</span> evals-from?): Succeeded (<span>evals-from?</span> <span>true</span> <span>true</span>)
 (<span>if</span>): Succeeded (<span>if</span> (<span>first</span> (<span>sister</span> laban rebecca)) (<span>evals-from?</span> <span>true</span> <span>true</span>) (<span>evals-from?</span> <span>true</span> <span>false</span>))
Recorded answer: [laban rebecca <span>true</span>]
  (<span>if</span> first): Failed (<span>first</span> (<span>sister</span> ?sibling:0 ?sister:0))
 (<span>if</span>): Failed (<span>if</span> (<span>first</span> (<span>sister</span> ?sibling:0 ?sister:0)) (<span>evals-from?</span> ?x:0 <span>true</span>) (<span>evals-from?</span> ?x:0 <span>false</span>))
<span>0.</span> Exhausted query: ((<span>if%</span> (<span>sister</span> ?sibling ?sister) (<span>evals-from?</span> ?x <span>true</span>) (<span>evals-from?</span> ?x <span>false</span>)))
[[laban rebecca <span>true</span>]]</pre></div>
</li>
<li>
<p dir="auto"><strong>Symbols interpreted as logic terms or predicates, regardless of their Clojure values</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (<- (false true))
      (? ?x (false ?x)))
[true]

> (do (<- (neg? 3))
      (? true (neg? 3)))
[true]"><pre>&gt; (<span>do</span> (<span>&lt;-</span> (<span>false</span> <span>true</span>))
      (<span>?</span> ?x (<span>false</span> ?x)))
[<span>true</span>]

&gt; (<span>do</span> (<span>&lt;-</span> (<span>neg?</span> <span>3</span>))
      (<span>?</span> <span>true</span> (<span>neg?</span> <span>3</span>)))
[<span>true</span>]</pre></div>
</li>
<li>
<p dir="auto"><strong>Arbitrary Clojure things as terms or predicates, e.g., ...</strong></p>
<ul dir="auto">
<li>
<p dir="auto">Strings (supporting, e.g., RDF URIs)</p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (<- (&quot;false&quot; true))
      (? ?x (&quot;false&quot; ?x)))
[true]"><pre>&gt; (<span>do</span> (<span>&lt;-</span> (<span>"false"</span> <span>true</span>))
      (<span>?</span> ?x (<span>"false"</span> ?x)))
[<span>true</span>]</pre></div>
</li>
<li>
<p dir="auto">Numbers</p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (<- (3 neg?))
      (? ?x (3 ?x)))
[neg?]"><pre>&gt; (<span>do</span> (<span>&lt;-</span> (<span>3</span> neg?))
      (<span>?</span> ?x (<span>3</span> ?x)))
[neg?]</pre></div>
</li>
<li>
<p dir="auto">Complex terms</p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- ([treasure] (buried ?x)))
  (? ?r ([treasure] ?r)))
[(buried ?unbound-0)]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> ([treasure] (<span>buried</span> ?x)))
  (<span>?</span> ?r ([treasure] ?r)))
[(<span>buried</span> ?unbound-0)]</pre></div>
</li>
</ul>
</li>
<li>
<p dir="auto"><strong>Predicates that are ?var-bearing complex terms</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- ([treasure chest] (buried ?x)))
  (? [?r ?thing] ([treasure ?thing] ?r)))
[[(buried ?unbound-0) chest]]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> ([treasure chest] (<span>buried</span> ?x)))
  (<span>?</span> [?r ?thing] ([treasure ?thing] ?r)))
[[(<span>buried</span> ?unbound-0) chest]]</pre></div>
</li>
<li>
<p dir="auto"><strong>Predicates that are ?vars</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (male jacob))
  (? ?pred (?pred jacob)))
[male]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>male</span> jacob))
  (<span>?</span> ?pred (<span>?pred</span> jacob)))
[male]</pre></div>
</li>
<li>
<p dir="auto"><strong>Variadic (variable-tail/arity) predicates and complex terms</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (variadic))
      (<- (variadic 1))
      (<- (variadic 1 2))
      (? ?rest (variadic &amp; ?rest)))
[() (1) (1 2)]

> (do (initialize-prolog)
      (<- (variadic-term [1]))
      (<- (variadic-term [1 2]))
  (? ?rest (variadic-term [1 &amp; ?rest])))
[[] [2]]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>variadic</span>))
      (<span>&lt;-</span> (<span>variadic</span> <span>1</span>))
      (<span>&lt;-</span> (<span>variadic</span> <span>1</span> <span>2</span>))
      (<span>?</span> ?rest (<span>variadic</span> &amp; ?rest)))
[() (<span>1</span>) (<span>1</span> <span>2</span>)]

&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>variadic-term</span> [<span>1</span>]))
      (<span>&lt;-</span> (<span>variadic-term</span> [<span>1</span> <span>2</span>]))
  (<span>?</span> ?rest (<span>variadic-term</span> [<span>1</span> &amp; ?rest])))
[[] [<span>2</span>]]</pre></div>
</li>
<li>
<p dir="auto"><strong>Goals that are ?vars</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (male jacob))
  (? ?goal ?goal)) ; Tell me everything you can prove.
[(male jacob)]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>male</span> jacob))
  (<span>?</span> ?goal ?goal)) <span><span>;</span> Tell me everything you can prove.</span>
[(<span>male</span> jacob)]</pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (male jacob))
  (? ?goal (unasserted) ?goal)) ; ...with what you know so far.
[]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>male</span> jacob))
  (<span>?</span> ?goal (<span>unasserted</span>) ?goal)) <span><span>;</span> ...with what you know so far.</span>
[]</pre></div>
</li>
<li>
<p dir="auto"><strong>Anonymous ?vars</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (sister laban rebecca))
      (<- (sister rachel leah))
      (? true (sister ?_person ?_person)))
[true]

> (? true (sister ? ?))
[true]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>sister</span> laban rebecca))
      (<span>&lt;-</span> (<span>sister</span> rachel leah))
      (<span>?</span> <span>true</span> (<span>sister</span> ?_person ?_person)))
[<span>true</span>]

&gt; (<span>?</span> <span>true</span> (<span>sister</span> ? ?))
[<span>true</span>]</pre></div>
</li>
<li>
<p dir="auto"><strong>Suppression of answers that are (under ?var renaming) duplicates</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (male laban))
  (<- (male jacob))
  (binding [*leash* true]
        (? ?x (or (male ?x) (male ?x)))))
0. Processing query: ((or (male ?x) (male ?x)))
 (or): Entering (or (male ?x:0) (male ?x:0))
  1. Entering &quot;male/1&quot;: (male laban)
  1. Matched head (male laban): (male laban)
  1. Succeeded &quot;male/1&quot;: (male laban)
Recorded answer: laban
  1. Backtracking into &quot;male/1&quot;: (male ?x:0)
  1. Succeeded &quot;male/1&quot;: (male jacob)
Recorded answer: jacob
  1. Backtracking into &quot;male/1&quot;: (male ?x:0)
  1. Failed &quot;male/1&quot;: (male ?x:0)
 (or): Backtracking into (or (male ?x:0) (male ?x:0))
  1. Entering &quot;male/1&quot;: (male laban)
  1. Matched head (male laban): (male laban)
  1. Succeeded &quot;male/1&quot;: (male laban)
Duplicate answer (not recorded): laban
  1. Backtracking into &quot;male/1&quot;: (male ?x:0)
  1. Succeeded &quot;male/1&quot;: (male jacob)
Duplicate answer (not recorded): jacob
  1. Backtracking into &quot;male/1&quot;: (male ?x:0)
  1. Failed &quot;male/1&quot;: (male ?x:0)
 (or): Failed (or (male ?x:0) (male ?x:0))
0. Exhausted query: ((or (male ?x) (male ?x)))
[laban jacob]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>male</span> laban))
  (<span>&lt;-</span> (<span>male</span> jacob))
  (<span>binding</span> [*leash* <span>true</span>]
        (<span>?</span> ?x (<span>or</span> (<span>male</span> ?x) (<span>male</span> ?x)))))
<span>0.</span> Processing query: ((<span>or</span> (<span>male</span> ?x) (<span>male</span> ?x)))
 (<span>or</span>): Entering (<span>or</span> (<span>male</span> ?x:0) (<span>male</span> ?x:0))
  <span>1.</span> Entering <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> laban)
  <span>1.</span> Matched head (<span>male</span> laban): (<span>male</span> laban)
  <span>1.</span> Succeeded <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> laban)
Recorded answer: laban
  <span>1.</span> Backtracking into <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> ?x:0)
  <span>1.</span> Succeeded <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> jacob)
Recorded answer: jacob
  <span>1.</span> Backtracking into <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> ?x:0)
  <span>1.</span> Failed <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> ?x:0)
 (<span>or</span>): Backtracking into (<span>or</span> (<span>male</span> ?x:0) (<span>male</span> ?x:0))
  <span>1.</span> Entering <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> laban)
  <span>1.</span> Matched head (<span>male</span> laban): (<span>male</span> laban)
  <span>1.</span> Succeeded <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> laban)
Duplicate answer (<span>not</span> recorded): laban
  <span>1.</span> Backtracking into <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> ?x:0)
  <span>1.</span> Succeeded <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> jacob)
Duplicate answer (<span>not</span> recorded): jacob
  <span>1.</span> Backtracking into <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> ?x:0)
  <span>1.</span> Failed <span><span>"</span>male/1<span>"</span></span>: (<span>male</span> ?x:0)
 (<span>or</span>): Failed (<span>or</span> (<span>male</span> ?x:0) (<span>male</span> ?x:0))
<span>0.</span> Exhausted query: ((<span>or</span> (<span>male</span> ?x) (<span>male</span> ?x)))
[laban jacob]</pre></div>
</li>
<li>
<p dir="auto"><strong>Optional suppression of answers subsumed by other answers</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
      (<- (sister laban rebecca))
      (<- (sister ?x ?y))
      (binding [*leash* true]
        (? [?x ?y] (sister ?x ?y))))
0. Processing query: ((sister ?x ?y))
 1. Entering &quot;sister/2&quot;: (sister laban rebecca)
 1. Matched head (sister laban rebecca): (sister laban rebecca)
 1. Succeeded &quot;sister/2&quot;: (sister laban rebecca)
Recorded answer: [laban rebecca]
 1. Backtracking into &quot;sister/2&quot;: (sister ?x:0 ?y:0)
 1. Succeeded &quot;sister/2&quot;: (sister ?x:0 ?y:0)
Recorded subsuming answer (discarded 1 subsumed answer(s)):  [?x ?y]
 1. Backtracking into &quot;sister/2&quot;: (sister ?x:0 ?y:0)
 1. Failed &quot;sister/2&quot;: (sister ?x:0 ?y:0)
0. Exhausted query: ((sister ?x ?y))
[[?x ?y]]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
      (<span>&lt;-</span> (<span>sister</span> laban rebecca))
      (<span>&lt;-</span> (<span>sister</span> ?x ?y))
      (<span>binding</span> [*leash* <span>true</span>]
        (<span>?</span> [?x ?y] (<span>sister</span> ?x ?y))))
<span>0.</span> Processing query: ((<span>sister</span> ?x ?y))
 <span>1.</span> Entering <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> laban rebecca)
 <span>1.</span> Matched head (<span>sister</span> laban rebecca): (<span>sister</span> laban rebecca)
 <span>1.</span> Succeeded <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> laban rebecca)
Recorded answer: [laban rebecca]
 <span>1.</span> Backtracking into <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> ?x:0 ?y:0)
 <span>1.</span> Succeeded <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> ?x:0 ?y:0)
Recorded subsuming answer (<span>discarded</span> <span>1</span> subsumed answer(<span>s</span>)):  [?x ?y]
 <span>1.</span> Backtracking into <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> ?x:0 ?y:0)
 <span>1.</span> Failed <span><span>"</span>sister/2<span>"</span></span>: (<span>sister</span> ?x:0 ?y:0)
<span>0.</span> Exhausted query: ((<span>sister</span> ?x ?y))
[[?x ?y]]</pre></div>
</li>
<li>
<p dir="auto"><strong>Failure (i.e., not system error) when no assertions have been
defined for a called logic predicate and arity</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="> (do (initialize-prolog)
               (binding [*leash* true]
                 (? answer (undefined ?arity-1))))
0. Processing query: ((undefined ?arity-1))
 1. Entering &quot;undefined/1&quot;: (undefined ?arity-1:0)
 1. Failed &quot;undefined/1&quot;: (undefined ?arity-1:0)
0. Exhausted query: ((undefined ?arity-1))
[]"><pre>&gt; (<span>do</span> (<span>initialize-prolog</span>)
               (<span>binding</span> [*leash* <span>true</span>]
                 (<span>?</span> answer (<span>undefined</span> ?arity-1))))
<span>0.</span> Processing query: ((<span>undefined</span> ?arity-1))
 <span>1.</span> Entering <span><span>"</span>undefined/1<span>"</span></span>: (<span>undefined</span> ?arity-1:0)
 <span>1.</span> Failed <span><span>"</span>undefined/1<span>"</span></span>: (<span>undefined</span> ?arity-1:0)
<span>0.</span> Exhausted query: ((<span>undefined</span> ?arity-1))
[]</pre></div>
</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Grammar</h2><a id="user-content-grammar" aria-label="Permalink: Grammar" href="#grammar"></a></p>
<p dir="auto">In production rules below, ...</p>
<ul dir="auto">
<li>Angle brackets surround a grammar &lt;element&gt;.</li>
<li>&lt;element&gt;+ denotes one or more of &lt;element&gt;.</li>
<li>&lt;element&gt;* denotes zero or more of &lt;element&gt;.</li>
<li>":-" separates rules' left- and right-hand sides.</li>
<li>"|" separates right-hand sides' alternatives.</li>
</ul>
<p dir="auto">&lt;assertion&gt;: <code>(</code>&lt;head-statement&gt;+ &lt;body-statement&gt;*<code>)</code></p>
<p dir="auto">&lt;head-statement&gt; :- &lt;statement&gt;</p>
<p dir="auto">&lt;body-statement&gt; :- &lt;statement&gt;</p>
<p dir="auto">&lt;statement&gt; :- &lt;fixed-arity-statement&gt; | &lt;variable-arity-statement&gt;</p>
<p dir="auto">&lt;fixed-arity-statement&gt; :- <code>(</code>&lt;predicate&gt;+ &lt;argument-term&gt;*<code>)</code></p>
<p dir="auto">&lt;argument-term&gt; :- &lt;term&gt;</p>
<p dir="auto">&lt;variable-arity-statement&gt; :- <code>(</code>&lt;predicate&gt;+ &lt;term&gt;* <code>&amp;</code> &lt;?var&gt;<code>)</code></p>
<p dir="auto">&lt;predicate&gt; :- &lt;special-predicate&gt; | &lt;assertion-predicate&gt;</p>
<p dir="auto">&lt;special-predicate&gt; :- &lt;built-in-predicate&gt; | &lt;transform-predicate&gt;</p>
<p dir="auto">&lt;built-in-predicate&gt; :- &lt;operator&gt; | &lt;Clojure-calling-predicate&gt; | <code>same</code> | <code>different</code> | <code>var</code> | <code>ground</code> | <code>true</code> | <code>false</code></p>
<p dir="auto">&lt;operator&gt; :- <code>and</code> | <code>or</code> | <code>if</code> | <code>not</code> | <code>first</code></p>
<p dir="auto">&lt;Clojure-calling-predicate&gt; :- <code>truthy?</code> | <code>evals-from?</code> | <code>do</code></p>
<p dir="auto">&lt;transform-predicate&gt;: A predicate constant registered using <code>create-predicate-transform</code></p>
<p dir="auto">&lt;assertion-predicate&gt;: A predicate all of whose assertions (if any) are from calls to one of the <code>&lt;-</code>... macros or <code>assert&lt;-</code>... functions</p>
<p dir="auto">&lt;term&gt; :- &lt;transparent-term&gt; | &lt;opaque-term&gt;</p>
<p dir="auto">&lt;transparent-term&gt; :- &lt;?var&gt; | &lt;complex-term&gt;</p>
<p dir="auto">&lt;complex-term&gt; :- &lt;fixed-artiy-complex-term&gt; | &lt;variable-arity-complex-term&gt;</p>
<p dir="auto">&lt;fixed-arity-complex-term&gt; :- <code>(</code>&lt;term&gt;*<code>)</code> | <code>[</code>&lt;term&gt;*<code>]</code></p>
<p dir="auto">&lt;variable-arity-complex-term&gt; :- <code>(</code>&lt;term&gt;* <code>&amp;</code> &lt;?var&gt;<code>)</code> | <code>[</code>&lt;term&gt;* <code>&amp;</code> &lt;?var&gt;<code>]</code></p>
<p dir="auto">&lt;opaque-term&gt; :- Any Clojure value supporting Clojure <code>=</code> (so, not a regex) that is not a transparent term</p>
<p dir="auto">&lt;?var&gt; :- &lt;binding-?var&gt; | &lt;anonymous-?var&gt;</p>
<p dir="auto">&lt;anonymous-?var&gt; :- <code>?</code> | &lt;<code>_</code>-anonymous-?var&gt;</p>
<p dir="auto">&lt;<code>_</code>-anonymous-?var&gt;: Symbol whose name begins with <code>"?_"</code></p>
<p dir="auto">&lt;constant&gt;: An opaque term or a ?var-free complex term</p>
<p dir="auto">&lt;answer-template&gt; :- &lt;term&gt;</p>
<p dir="auto">Note:</p>
<ul dir="auto">
<li>
<p dir="auto">All predicates are terms.</p>
</li>
<li>
<p dir="auto">All ?vars are symbols.</p>
</li>
<li>
<p dir="auto">Statements and assertions, being lists, are terms.</p>
</li>
<li>
<p dir="auto">The arguments of operators are statements.  See our Built-in predicates
section.</p>
</li>
<li>
<p dir="auto">Outside of Clojure-calling predicates' Clojure form arguments:
Symbols appearing in statements are taken at face value, not evaluated.
A symbol used in Prolog otherwise has no relationship to its value
(or the lack thereof) in Clojure.</p>
</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Additional terminology and conventions</h2><a id="user-content-additional-terminology-and-conventions" aria-label="Permalink: Additional terminology and conventions" href="#additional-terminology-and-conventions"></a></p>
<p dir="auto">Considering for the moment only assertion (not special) predicates,
logic programming <strong>search</strong> processes (or <strong>calls</strong>), in turn from
left to right, each <strong>goal</strong> in an (implicitly) conjunctive <strong>query</strong>
by...</p>
<ul dir="auto">
<li>
<p dir="auto">Identifying assertions whose head statement matches the goal</p>
</li>
<li>
<p dir="auto">Prepending a matching assertion's body statements (AKA the assertion's
<strong>goals</strong>) to the query's remaining goals, after applying the
match's ?var bindings to each such goal</p>
</li>
<li>
<p dir="auto">Processing remaining goals, recursively, ...</p>
<ul dir="auto">
<li>
<p dir="auto"><strong>Backtracking</strong> to remaining matching assertions, when matching a
given assertion <strong>fails</strong></p>
</li>
<li>
<p dir="auto">When no goals remain, <strong>succeed</strong> by...</p>
<ul dir="auto">
<li>
<p dir="auto">Recording an <strong>answer</strong> that realizes the query's <strong>answer
template</strong> according to ?var matches made along the search path</p>
</li>
<li>
<p dir="auto">Backtracking to search for any additional answers.</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p dir="auto">Search generally proceeds depth-first and from left to right.</p>
<p dir="auto">We <strong>match</strong> two statements or transparent terms by associating their
respective terms and ?vars, position by position, with consistent
matching for non-anonymous ?vars.  In matching (AKA "unification"),
...</p>
<ul dir="auto">
<li>
<p dir="auto">A ?var matches a ?var, a transparent term, or a constant.</p>
</li>
<li>
<p dir="auto">Constants match equal (Clojure <code>=</code>) constants.</p>
</li>
<li>
<p dir="auto">Complex terms match recursively.</p>
</li>
<li>
<p dir="auto">A <strong>tail ?var</strong> (last in a statement or complex term, and preceded by
<code>&amp;</code>) matches the (possibly empty) seq or vector of terms remaining in
the parallel traversal of its opposing complex term.</p>
</li>
</ul>
<p dir="auto">One term <strong>subsumes</strong> another if the two terms match and---considering
?var occurrences---the former is at least as general as the latter.</p>
<p dir="auto">A <strong>ground</strong> term has no ?vars (none outside of any opaque included
terms, where they are not treated as ?vars).</p>
<p dir="auto">Here---and in leash (execution tracing) reports---the notation
&lt;predicate&gt;/&lt;integer&gt; (e.g., <code>sibling/2</code>) refers to the
&lt;integer&gt; arity of &lt;predicate&gt;.</p>
<p dir="auto">By convention, we take the first argument of a 2-ary statement to be the
predicate's <strong>subject</strong>, the second to be its <strong>object</strong>.  Thus, in
<code>(brother Jane John)</code>, we take <code>Jane</code> to be the subject (or agent),
<code>John</code> to be the object (or patient).  ("A brother of Jane is John.")</p>
<p dir="auto">A <strong>unit</strong> assertion has only a head statement, no body statements.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">API</h2><a id="user-content-api" aria-label="Permalink: API" href="#api"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Initialization</h3><a id="user-content-initialization" aria-label="Permalink: Initialization" href="#initialization"></a></p>
<p dir="auto">Clear the knowledge base and any existing special predicate
transforms, then execute the transform definitions in function
<code>create-predicate-transforms</code>.</p>

<p dir="auto"><h3 tabindex="-1" dir="auto">Knowledge base and predicate transform contexts</h3><a id="user-content-knowledge-base-and-predicate-transform-contexts" aria-label="Permalink: Knowledge base and predicate transform contexts" href="#knowledge-base-and-predicate-transform-contexts"></a></p>
<p dir="auto">Bind <code>*assertions*</code> and/or <code>*predicate-transforms*</code>, per their doc
strings, to set up contexts for different knowledge bases and/or
transform definitions.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Creating assertions---macros and functions</h3><a id="user-content-creating-assertions---macros-and-functions" aria-label="Permalink: Creating assertions---macros and functions" href="#creating-assertions---macros-and-functions"></a></p>
<p dir="auto">We provide four assertion creation functions and four corresponding
macros.  The macros, which don't require quoting arguments, so are
simpler to use at the REPL or from top level in a file, take their
statement arguments at top-level.  The functions take theirs in a list.</p>
<p dir="auto">An assertion's head statement...</p>
<ul dir="auto">
<li>
<p dir="auto">May not be a ?var.</p>
</li>
<li>
<p dir="auto">May be variadic, but must require arity &gt;= 1 (i.e., must not start
with <code>&amp;</code>).</p>
</li>
<li>
<p dir="auto">Must not have a built-in special predicate in its predicate
position.  We don't flag assertions to transform predicates;
however, once a predicate has been used on the left-hand side of a
transform's defining production rule, we refrain from exercising
same-predicate assertions.</p>
</li>
</ul>
<p dir="auto">See the functions' doc strings for other fine points.</p>
<p dir="auto">The following forms have equivalent effect: Add the assertion with
head statement <code>(sibling ?x ?y)</code> and lone goal statement <code>(brother ?x ?y)</code>
to the knowledge base.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(<- (sibling ?x ?y) (brother ?x ?y)) ; Macro.

(assert<- '((sibling ?x ?y) (brother ?x ?y))) ; Function."><pre>(<span>&lt;-</span> (<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y)) <span><span>;</span> Macro.</span>

(<span>assert&lt;-</span> '((<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y))) <span><span>;</span> Function.</span></pre></div>
<p dir="auto">The following place their constant-predicate, fixed-arity assertion
first for consideration in search.  We provide no explicit control
over the order in which (less conventional) assertions with variadic,
variable, or non-ground complex head statement predicates are examined
during backtracking search.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(<-0 (sibling ?x ?y) (brother ?x ?y)) ; Macro.

(assert<-0 '((sibling ?x ?y) (brother ?x ?y))) ; Function."><pre>(<span>&lt;-0</span> (<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y)) <span><span>;</span> Macro.</span>

(<span>assert&lt;-0</span> '((<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y))) <span><span>;</span> Function.</span></pre></div>
<p dir="auto">The following clear <code>sibling/2</code> before making their assertion.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(<-- (sibling ?x ?y) (brother ?x ?y)) ; Macro.

(assert<-- '((sibling ?x ?y) (brother ?x ?y))) ; Function."><pre>(<span>&lt;--</span> (<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y)) <span><span>;</span> Macro.</span>

(<span>assert&lt;--</span> '((<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y))) <span><span>;</span> Function.</span></pre></div>
<p dir="auto">The following clear the entire knowledge base of all but special
transforms before making their assertion.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(<--- (sibling ?x ?y) (brother ?x ?y)) ; Macro.

(assert<--- '((sibling ?x ?y) (brother ?x ?y))) ; Function."><pre>(<span>&lt;---</span> (<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y)) <span><span>;</span> Macro.</span>

(<span>assert&lt;---</span> '((<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y))) <span><span>;</span> Function.</span></pre></div>
<p dir="auto">The following---when employed systematically---avoid
subsumed-subsuming assertion pairs in the knowledge base, by declining
to add would-be-subsumed assertions and by retracting subsumed
assertions.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(<-_ (sibling ?x ?y) (brother ?x ?y)) ; Macro.

(assert<-_ '((sibling ?x ?y) (brother ?x ?y))) ; Function."><pre>(<span>&lt;-_</span> (<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y)) <span><span>;</span> Macro.</span>

(<span>assert&lt;-_</span> '((<span>sibling</span> ?x ?y) (<span>brother</span> ?x ?y))) <span><span>;</span> Function.</span></pre></div>
<p dir="auto">We retrieve assertions once upon calling a predicate, and assertion or
retraction operations otherwise relevant to that predicate will be
reflected during the call.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Retrieving assertions</h3><a id="user-content-retrieving-assertions" aria-label="Permalink: Retrieving assertions" href="#retrieving-assertions"></a></p>
<p dir="auto">We provide three functions for retrieving assertions by matching their
heads against a statement pattern.  Each returns a vector containing the
knowledge base's assertions whose head statements exhibit the function's
required relationship to <code>statement-pattern</code>.</p>
<p dir="auto">Get assertions whose head matches <code>statement-pattern</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(get-matching-head-assertions statement-pattern)"><pre>(<span>get-matching-head-assertions</span> statement-pattern)</pre></div>
<p dir="auto">Get assertions whose head is subsumed by <code>statement-pattern</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(get-subsumed-head-assertions statement-pattern)"><pre>(<span>get-subsumed-head-assertions</span> statement-pattern)</pre></div>
<p dir="auto">Get assertions whose head subsumes <code>statement-pattern</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(get-subsuming-head-assertions statement-pattern)"><pre>(<span>get-subsuming-head-assertions</span> statement-pattern)</pre></div>
<p dir="auto">We provide two similar functions that match assertions against a
full assertion pattern.</p>
<p dir="auto">Get assertions entirely subsumed by <code>assertion-pattern</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(get-subsumed-assertions assertion-pattern)"><pre>(<span>get-subsumed-assertions</span> assertion-pattern)</pre></div>
<p dir="auto">Get assertions entirely subsuming <code>assertion-pattern</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(get-subsuming-assertions assertion-pattern)"><pre>(<span>get-subsuming-assertions</span> assertion-pattern)</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Retracting assertions</h3><a id="user-content-retracting-assertions" aria-label="Permalink: Retracting assertions" href="#retracting-assertions"></a></p>
<p dir="auto">We provide two functions, and two corresponding macros, for retracting
assertions by matching their head statements against a pattern and
one function to retract assertions entirely matching an assertion pattern.</p>
<p dir="auto">The following have equivalent effect.  As in the assertion retrieval
functions, <code>statement-pattern</code> refers to assertions' head statements.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(retract-subsumed-head-assertions statement-pattern)

(--- statement-pattern)"><pre>(<span>retract-subsumed-head-assertions</span> statement-pattern)

(<span>---</span> statement-pattern)</pre></div>
<p dir="auto">The following have equivalent effect.  Here, <code>assertion</code> must be equal
(Clojure <code>=</code>, including equal ?var symbols) to an assertion in the
knowledge base, for the latter to be retracted.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(retract-specific-assertion assertion) ; Function.

(-- statement-pattern) ; Macro."><pre>(<span>retract-specific-assertion</span> assertion) <span><span>;</span> Function.</span>

(<span>--</span> statement-pattern) <span><span>;</span> Macro.</span></pre></div>
<div dir="auto" data-snippet-clipboard-copy-content="(retract-subsumed-assertions '((?pred deceased-person)))"><pre>(<span>retract-subsumed-assertions</span> '((<span>?pred</span> deceased-person)))</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Querying</h2><a id="user-content-querying" aria-label="Permalink: Querying" href="#querying"></a></p>
<p dir="auto">The following macro and function are equivalent---except that the
macro does not support keyword arguments (instead, bind the
default-value globals).  With a truthy limit, terminate search upon
having recorded so many answers.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(? answer-template &amp; goals) ; Macro.

(query answer-template goals ; Function.
       :limit *answer-count-limit*
       :discard-subsumed *discard-subsumed-answers*)"><pre>(<span>?</span> answer-template &amp; goals) <span><span>;</span> Macro.</span>

(<span>query</span> answer-template goals <span><span>;</span> Function.</span>
       <span>:limit</span> *answer-count-limit*
       <span>:discard-subsumed</span> *discard-subsumed-answers*)</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Leashing</h2><a id="user-content-leashing" aria-label="Permalink: Leashing" href="#leashing"></a></p>
<p dir="auto">For now, leashing is an all-or-nothing proposition.  Perform any query
with <code>*leash*</code> bound truthy, for goal-by-goal reports describing
execution.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(binding [*leash* true]
  ;; Query form(s) in here.
  )"><pre>(<span>binding</span> [*leash* <span>true</span>]
  <span><span>;</span>; Query form(s) in here.</span>
  )</pre></div>
<p dir="auto">As demonstrated in our Highlights section and in
<code>test/prolog/leash-tests.txt</code>, leashing reports...</p>
<ul dir="auto">
<li>Entry into and success or failure of goals</li>
<li>Backtracking into...
<ul dir="auto">
<li>Remaining matching assertions of goals with assertion predicates</li>
<li>Remaining disjuncts (remaining alternatives goals) of <code>or</code> goals</li>
</ul>
</li>
<li><code>first</code> operator-induced cuts</li>
<li>Application of predicate transforms</li>
<li>The discovery of answers and their disposition</li>
<li>Search termination upon reaching an answer count limit.</li>
</ul>
<p dir="auto">Leashing also...</p>
<ul dir="auto">
<li>Indexes reports per depth of assertion nesting</li>
<li>Indicates the nesting of built-in predicates for the current assertion</li>
<li>Left-pads reports per nesting of assertion and built-in predicate goals.</li>
</ul>
<p dir="auto">When <code>*pprint-leash-statements*</code> is truthy, ...<code>"Entering"</code>, ...</p>
<ul dir="auto">
<li><code>"Matched head"</code> leash reports are omitted.</li>
<li><code>"Succeeded"</code>, and <code>"Failed"</code> leash reports pprint (vs. print)
statement content, starting on a new line, with indentation, as in...</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="clolog.core> (binding [*leash* true
                       *pprint-leash-statements* true]
               (query '[?h ?w ?z] '((zebra ?h ?w ?z)) :limit 1))
0. Processing query: ((zebra ?h ?w ?z))
 1. Entering `zebra`/3:
    (zebra ?h:0 ?w:0 ?z:0)

  1. (same): Entering...
             (same
              ?h:0
              ((house norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
               ?anon-4:1
               (house ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
               ?anon-9:1
               ?anon-10:1))

  1. (same): Succeeded...
             (same
              ((house norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
               ?anon-4:1
               (house ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
               ?anon-9:1
               ?anon-10:1)
              ((house norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
               ?anon-4:1
               (house ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
               ?anon-9:1
               ?anon-10:1))

  2. Entering `member`/2:
     (member
      (house englishman ?anon-11:1 ?anon-12:1 ?anon-13:1 red)
      ((house norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
       ?anon-4:1
       (house ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
       ?anon-9:1
       ?anon-10:1))"><pre>clolog.core&gt; (<span>binding</span> [*leash* <span>true</span>
                       *pprint-leash-statements* <span>true</span>]
               (<span>query</span> '[?h ?w ?z] '((<span>zebra</span> ?h ?w ?z)) <span>:limit</span> <span>1</span>))
<span>0.</span> Processing query: ((<span>zebra</span> ?h ?w ?z))
 <span>1.</span> Entering `zebra`/<span>3</span>:
    (<span>zebra</span> ?h:0 ?w:0 ?z:0)

  <span>1.</span> (<span>same</span>): Entering...
             (<span>same</span>
              ?h:0
              ((<span>house</span> norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
               ?anon-4:1
               (<span>house</span> ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
               ?anon-9:1
               ?anon-10:1))

  <span>1.</span> (<span>same</span>): Succeeded...
             (<span>same</span>
              ((<span>house</span> norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
               ?anon-4:1
               (<span>house</span> ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
               ?anon-9:1
               ?anon-10:1)
              ((<span>house</span> norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
               ?anon-4:1
               (<span>house</span> ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
               ?anon-9:1
               ?anon-10:1))

  <span>2.</span> Entering `member`/<span>2</span>:
     (<span>member</span>
      (<span>house</span> englishman ?anon-11:1 ?anon-12:1 ?anon-13:1 red)
      ((<span>house</span> norwegian ?anon-0:1 ?anon-1:1 ?anon-2:1 ?anon-3:1)
       ?anon-4:1
       (<span>house</span> ?anon-5:1 ?anon-6:1 ?anon-7:1 milk ?anon-8:1)
       ?anon-9:1
       ?anon-10:1))</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Built-in predicates</h2><a id="user-content-built-in-predicates" aria-label="Permalink: Built-in predicates" href="#built-in-predicates"></a></p>
<p dir="auto">We support the following built-in predicates.  We borrow some notation
from our Grammar section and allow ourselves to introduce types via
obvious naming (e.g., a &lt;condition-statement&gt; is a
&lt;statement&gt;---distinguished merely by its role/argument position in the
built-in predicate <code>if</code>).  We invoke the exclued middle: If a goal
does not succeed, then it fails.</p>
<ul dir="auto">
<li>
<p dir="auto"><code>(and</code> &lt;statement&gt;*<code>)</code> succeeds if, proceeding from left to right,
every conjunct statement succeeds.</p>
</li>
<li>
<p dir="auto"><code>(or</code> &lt;statement&gt;*<code>)</code> succeeds if, proceeding from left to
right, some disjunct statement succeeds (and remaining disjuncts are
ignored).  Backtracking will explore first alternative ways to
satisfy a failing statement, then subsequent statements.</p>
</li>
<li>
<p dir="auto"><code>(if</code> &lt;condition-statement&gt; &lt;then-statement&gt; &lt;else-statement&gt;<code>)</code>
succeeds if either:</p>
<ul dir="auto">
<li>
<p dir="auto">The condition statement succeeds and the then statement succeeds (in which
case we do not examine the else statement under the bindings for
the condition statement's ?vars)</p>
</li>
<li>
<p dir="auto">The condition statement fails and the else statement succeeds (in which
case we do not examine <code>then-statement</code>).</p>
</li>
</ul>
<p dir="auto">Backtracking will explore alternative ways to satisfy the argument
statements.</p>
</li>
<li>
<p dir="auto"><code>(not</code> &lt;statement&gt;<code>)</code> succeeds if the wrapped statement fails.</p>
</li>
<li>
<p dir="auto"><code>(first</code> &lt;statement&gt;<code>)</code> succeeds if the argument statement succeeds.  This
form (AKA Prolog "cut") skips backtracking to explore other ways of
satisfying the statement, upon its first success.</p>
</li>
<li>
<p dir="auto"><code>(same</code> &lt;term&gt; &lt;term&gt;<code>)</code> succeeds if the two terms match.</p>
</li>
<li>
<p dir="auto"><code>(true)</code> succeeds unconditionally.</p>
</li>
<li>
<p dir="auto"><code>(false)</code> fails unconditionally.</p>
</li>
<li>
<p dir="auto"><code>(var</code> &lt;term&gt;<code>)</code> succeeds if the argument term is a ?var.</p>
</li>
<li>
<p dir="auto"><code>(ground \&lt;term\&gt;)</code> succeeds if the argument term is ground.</p>
</li>
<li>
<p dir="auto"><code>(truthy?</code> &lt;form&gt;<code>)</code> succeeds if the argument form is ground and
the result of its evaluation (in Clojure) is truthy.</p>
</li>
<li>
<p dir="auto"><code>(evals-from?</code> &lt;term&gt; &lt;form&gt;<code>)</code> succeeds if the argument form is
ground and the result of its evaluation (in Clojure) matches the
argument term (often a ?var).</p>
</li>
<li>
<p dir="auto"><code>(do</code> &lt;form&gt;*<code>)</code> succeeds if the whole <code>do</code> expression is ground,
evaluating it (in Clojure) for side effect, only.</p>
</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Creating special transforms</h2><a id="user-content-creating-special-transforms" aria-label="Permalink: Creating special transforms" href="#creating-special-transforms"></a></p>
<p dir="auto">The function call below---performed by <code>initialize-prolog</code>---seeds
Clolog with some transforms for predicates we have found useful in
other Lisp-based Prologs.  As we intend this facility to support
customization, you may wish to copy our version of
<code>create-predicate-transforms</code> and edit it to your liking.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(create-predicate-transforms)"><pre>(<span>create-predicate-transforms</span>)</pre></div>
<p dir="auto"><code>create-predicate-transforms</code> includes calls to
<code>create-predicate-transform</code>.  Each call is a production rule.  During
search, a goal matching <code>source-statement</code> is transformed---via
de-referencing---into <code>target-statement</code>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="(create-predicate-transform source-statement target-statement)"><pre>(<span>create-predicate-transform</span> source-statement target-statement)</pre></div>
<p dir="auto">The execution machinery for transform predicates applies the first
matching transform irrevocably, with no backtracking in case of
failure.  Compared to an assertion predicate defined using using one
assertion per transform and the same statements in each
transform-assertion pair, it is as if the transform predicate's goal
always were wrapped with <code>first</code>.  We consider predicate transforms to
be "macros" for Prolog, affording us cleaner leashing than would
similar assertion predicates.  Assertion predicatess more verbose
leashing may nonetheless be helpful in prototyping and debugging
prospective transforms.  It may help to call
<code>create-predicate-transforms</code> with optional argument <code>debugging?</code>
truthy---and either disregard any effects resulting from backtracking
into prospective transform predicates ultimately intended or (as in
<code>tests/clolog/core_tests.clj</code>) avoid backtracking by limiting the
count of answers found.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Potential future enhancements</h2><a id="user-content-potential-future-enhancements" aria-label="Permalink: Potential future enhancements" href="#potential-future-enhancements"></a></p>
<p dir="auto">We might pursue some of the following ideas towards increasing
expressivity/leashing, robustness/scale, and efficiency, given
motivating use cases.</p>
<ul dir="auto">
<li>
<p dir="auto">Potential enhancements to expressiveness and leashing:</p>
<ul dir="auto">
<li>
<p dir="auto">Accommodate non-ground Clojure expressions in Clojure-calling
forms---in case a called form would use these in crafting
subsequent goal (e.g.).</p>
</li>
<li>
<p dir="auto">Make the local/lexical environment accessible within called
Clojure forms.</p>
</li>
<li>
<p dir="auto">Support RDF, RDFS, selected aspects of OWL (e.g., inverses,
functional dependencies).</p>
</li>
<li>
<p dir="auto">Selective leashing, considering (e.g.) predicate, arity,
report type (e.g., answer disposition).</p>
</li>
<li>
<p dir="auto">Selective detail in leashing, e.g., re <code>if</code> subgoals</p>
</li>
<li>
<p dir="auto">Greater precision in leash report prefixes for n-ary operators
<code>and</code>, <code>or</code> (e.g., indexing potentially like-predicate conjuncts,
disjuncts).</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Potential enhancements to robustness and scale</p>
<ul dir="auto">
<li>
<p dir="auto">Error-check user/application inputs more pervasively.</p>
</li>
<li>
<p dir="auto">Support Prolog stack limits, breakpoints, stepping/debugger
integration.</p>
</li>
<li>
<p dir="auto">Support database integration---access to unit ground assertions.</p>
</li>
</ul>
</li>
<li>
<p dir="auto">Potential efficiency enhancements</p>
<ul dir="auto">
<li>
<p dir="auto">Perform further indexing, including trie-based indexing.</p>
</li>
<li>
<p dir="auto">Qualify seq/vector matching with early check for compatible
lengths of candidate-matching seqs and vectors.</p>
</li>
<li>
<p dir="auto">Decline to explore alternative satisfactions of a ground goal.</p>
</li>
<li>
<p dir="auto">Skirt search branches that cannot instantiate an answer template
?var.</p>
</li>
<li>
<p dir="auto">Support parallelism and/or laziness.</p>
</li>
</ul>
</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto">Copyright © 2023 Robert Carl Schrag</p>
<p dir="auto">This program and the accompanying materials are made available under
the terms of the Eclipse Public License 2.0 which is available at
<a href="http://www.eclipse.org/legal/epl-2.0" rel="nofollow">http://www.eclipse.org/legal/epl-2.0</a>.</p>
<p dir="auto">This Source Code may also be made available under the following
Secondary Licenses when the conditions for such availability set forth
in the Eclipse Public License, v. 2.0 are satisfied: GNU General
Public License as published by the Free Software Foundation, either
version 2 of the License, or (at your option) any later version, with
the GNU Classpath Exception which is available at
<a href="https://www.gnu.org/software/classpath/license.html" rel="nofollow">https://www.gnu.org/software/classpath/license.html</a>.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Generate videos in Gemini and Whisk with Veo 2 (300 pts)]]></title>
            <link>https://blog.google/products/gemini/video-generation/</link>
            <guid>43695592</guid>
            <pubDate>Tue, 15 Apr 2025 17:02:16 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.google/products/gemini/video-generation/">https://blog.google/products/gemini/video-generation/</a>, See on <a href="https://news.ycombinator.com/item?id=43695592">Hacker News</a></p>
<div id="readability-page-1" class="page"><article>

    
    





    

    
      

<div data-analytics-module="{
    &quot;module_name&quot;: &quot;Hero Menu&quot;,
    &quot;section_header&quot;: &quot;Generate videos in Gemini and Whisk with Veo 2&quot;
  }">
  
  <div>
      <div>
          
            <p>Apr 15, 2025</p>
          
          
            <p data-reading-time-render="">[[read-time]] min read</p>
          
        </div>
      
        <p>
          Transform text-based prompts into high-resolution eight-second videos, accessible to Gemini Advanced subscribers. Plus, Google One AI Premium subscribers can use Whisk Animate to turn images into eight-second animated clips.
        </p>
      
    </div>
  
  <div>
  <p>Olivia Sturman</p>
  
    <p>
      Product Manager, Google Labs
    </p>
  
  
</div>
</div>

    

    
      <div>
      <p>
        <video aria-label="Video showcasing how you can generate videos in Gemini" autoplay="" loop="" muted="" playsinline="" poster="https://storage.googleapis.com/gweb-uniblog-publish-prod/original_images/GenerateVideos_Static1_1920x1080.png" src="https://storage.googleapis.com/gweb-uniblog-publish-prod/original_videos/Sized_Gemini_VEO_HeroVideo_16x9_Youtube_v04_1.mp4" type="video/mp4">
          Sorry, your browser doesn't support embedded videos, but don't worry, you can
            <a href="https://storage.googleapis.com/gweb-uniblog-publish-prod/original_videos/Sized_Gemini_VEO_HeroVideo_16x9_Youtube_v04_1.mp4">download it</a>
            and watch it with your favorite video player!
        </video>
      </p>
      
    </div>

    

    
    <div data-reading-time="true" data-component="uni-article-body">

            
              





<uni-article-speakable page-title="Generate videos in Gemini and Whisk with Veo 2" listen-to-article="Listen to article" data-date-modified="2025-04-15T17:00:02.675540+00:00" data-tracking-ids="G-HGNBTNCHCQ,G-6NKTLKV14N" data-voice-list="en.ioh-pngnat:Cyan,en.usb-pngnat:Lime" data-script-src="https://www.gstatic.com/readaloud/player/web/api/js/api.js"></uni-article-speakable>

            

            
            
<!--article text-->

  
    <div data-component="uni-article-paragraph" role="presentation" data-analytics-module="{
           &quot;module_name&quot;: &quot;Paragraph&quot;,
           &quot;section_header&quot;: &quot;Generate videos in Gemini and Whisk with Veo 2&quot;
         }"><p data-block-key="hzfux">Starting today, Gemini Advanced users can generate and share videos using our state-of-the-art video model, <a href="https://blog.google/technology/google-labs/video-image-generation-update-december-2024/">Veo 2</a>. In Gemini, you can now translate text-based prompts into dynamic videos. Google Labs is also making Veo 2 available through <a href="http://labs.google/whisk">Whisk</a>, a generative AI experiment that allows you to create new images using both text and image prompts, and now animate them into videos.</p><h2 data-block-key="6uggf">How to create videos with Gemini</h2><p data-block-key="emffm">Veo 2 represents a <a href="https://deepmind.google/technologies/veo/veo-2/">leap forward</a> in video generation, designed to produce high-resolution, detailed videos with cinematic realism. By better understanding real-world physics and human motion, it delivers fluid character movement, lifelike scenes and finer visual details across diverse subjects and styles.</p><p data-block-key="4v3c0">To generate videos, select Veo 2 from the model dropdown
<a data-ga4-analytics-superscript-click="" data-target="inline text" href="#footnote-1" id="footnote-source-1"><sup>1</sup></a>
 in Gemini. This feature creates an eight-second video clip at 720p resolution, delivered as an MP4 file in a 16:9 landscape format. There is a monthly limit on how many videos you can create, but we will notify you as you approach it.</p><p data-block-key="ebedu"><a href="https://gemini.google/overview/video-generation/">Creating videos</a> with Gemini is simple: just describe the scene you want to create — whether it's a short story, a visual concept, or a specific scene — and Gemini will bring your ideas to life. The more detailed your description, the more control you have over the final video. This opens up a world of fun creative possibilities, letting your imagination go wild to picture unreal combinations, explore varied visual styles from realism to fantasy, or quickly narrate short visual ideas.</p><p data-block-key="c6t8m">One of the best parts of creating is sharing with others. Sharing your video on mobile is easy: simply tap the share button to quickly upload engaging short videos to platforms like TikTok and YouTube Shorts.</p></div>
  

  
    








<uni-image-carousel section-header="Generate videos in Gemini and Whisk with Veo 2" images="[
    
      {
        
          &quot;src&quot;: [&quot; https://storage.googleapis.com/gweb-uniblog-publish-prod/original_videos/Gemini_Generated_Video__37_aDEwjss.mp4 &quot;],
        
        &quot;alt&quot;: &quot;Animation of two figures in white exosuits casting light in a cave&quot;,
        &quot;isVideo&quot;: true,
        &quot;videoTitle&quot;: &quot;Gemini 1&quot;
      },
    
      {
        
          &quot;src&quot;: [&quot; https://storage.googleapis.com/gweb-uniblog-publish-prod/original_videos/Mouse_Reads_Video_Generated.mp4 &quot;],
        
        &quot;alt&quot;: &quot;Animation of an adorable mouse reading a book&quot;,
        &quot;isVideo&quot;: true,
        &quot;videoTitle&quot;: &quot;Gemini 2&quot;
      },
    
      {
        
          &quot;src&quot;: [&quot; https://storage.googleapis.com/gweb-uniblog-publish-prod/original_videos/Gemini_Generated_Video__13.mp4 &quot;],
        
        &quot;alt&quot;: &quot;Animation of cliffs on a beach&quot;,
        &quot;isVideo&quot;: true,
        &quot;videoTitle&quot;: &quot;pacific view&quot;
      },
    
      {
        
          &quot;src&quot;: [&quot; https://storage.googleapis.com/gweb-uniblog-publish-prod/original_videos/KR_Veo2_4.mp4 &quot;],
        
        &quot;alt&quot;: &quot;Animation of pixelated ice cream melting&quot;,
        &quot;isVideo&quot;: true,
        &quot;videoTitle&quot;: &quot;KR_Veo2_4.mp4&quot;
      }
    
  ]">
  
    
      <div slot="caption-slot-0">
        <p data-block-key="27cbd">Prompt: A wide, slow-panning shot of an enormous glacial cavern, bathed in eerie twilight. Pale cyan light filters from above, illuminating frozen candy figures within the ice walls. Two figures in white exosuits, their helmet lights casting beams, trudge through the center. Capture the cavern's scale and stillness.</p>
      </div>
    
  
    
      <div slot="caption-slot-1">
        <p data-block-key="b8xgg">Prompt: An animated shot of a tiny mouse with oversized glasses, reading a book by the light of a glowing mushroom in a cozy forest den.</p>
      </div>
    
  
    
      <div slot="caption-slot-2">
        <p data-block-key="b8xgg">Prompt: Aerial shot of a grassy cliff onto a sandy beach where waves crash against the shore, a prominent sea stack rises from the ocean near the beach, bathed in the warm, golden light of either sunrise or sunset, capturing the serene beauty of the Pacific coastline.</p>
      </div>
    
  
    
      <div slot="caption-slot-3">
        <p data-block-key="b8xgg">Prompt: Time-lapse of a voxel-style ice cream melting under a clear blue sky. The pink, grey, and white scoops slowly lose their shape, dripping down the yellow, blocky cone held by a large, voxel hand with a blue sleeve. Focus on the melting process, highlighting the changing texture and form of the voxel elements as the ice cream deforms and drips, creating a colorful, pixelated melt against the vibrant blue backdrop.</p>
      </div>
    
  
</uni-image-carousel>

  

  
    <div data-component="uni-article-paragraph" role="presentation" data-analytics-module="{
           &quot;module_name&quot;: &quot;Paragraph&quot;,
           &quot;section_header&quot;: &quot;Generate videos in Gemini and Whisk with Veo 2&quot;
         }">
        <p data-block-key="be4dh">Video generation is now rolling out to Gemini Advanced subscribers globally on web and mobile, starting today and continuing over the next few weeks. This feature is available in all languages Gemini supports. Try it out today at <a href="http://gemini.google.com/">gemini.google.com</a>.</p>
      </div>
  

  
    <div data-component="uni-article-paragraph" role="presentation" data-analytics-module="{
           &quot;module_name&quot;: &quot;Paragraph&quot;,
           &quot;section_header&quot;: &quot;Generate videos in Gemini and Whisk with Veo 2&quot;
         }"><h2 data-block-key="be4dh">How Whisk Animate brings your images to life</h2><p data-block-key="qrhp"><a href="https://blog.google/technology/google-labs/whisk/">Introduced in December</a>, Whisk is a Google Labs experiment that helps you quickly explore and visualize new ideas using both text and image prompts. Today, you can animate your creations with Whisk Animate.</p><p data-block-key="2bhtn">Whisk Animate lets you turn your images into vivid eight-second videos using Veo 2. It’s available for Google One AI Premium subscribers globally starting today. Subscribers can try it at <a href="http://labs.google/whisk">labs.google/whisk</a>.</p></div>
  

  
    
  
    


  <uni-youtube-player-article index="5" thumbnail-alt="Video of Whisk Animate" video-id="2yYDI-p5aGs" video-type="video">
  </uni-youtube-player-article>


  


  

  
    <div data-component="uni-article-paragraph" role="presentation" data-analytics-module="{
           &quot;module_name&quot;: &quot;Paragraph&quot;,
           &quot;section_header&quot;: &quot;Generate videos in Gemini and Whisk with Veo 2&quot;
         }"><h2 data-block-key="be4dh">How we approach safety</h2><p data-block-key="94fmg">We’ve taken important steps to make video generation a safe experience. This includes extensive <a href="https://blog.google/technology/safety-security/googles-ai-red-team-the-ethical-hackers-making-ai-safer/">red teaming</a> and evaluation aimed at preventing the generation of content that violates our <a href="https://gemini.google/policy-guidelines/">policies</a>. Additionally, all videos generated with Veo 2 are marked with <a href="https://deepmind.google/technologies/synthid/">SynthID</a>, a digital watermark embedded in each frame, which indicates the videos are AI-generated.</p><p data-block-key="a9rsg">Gemini's outputs are primarily determined by user prompts and like any generative AI tool, there may be instances where it generates content that some individuals find objectionable. We’ll continue to listen to your feedback through the thumbs up/down buttons and make ongoing improvements. For more details, you can <a href="https://gemini.google/our-approach/">read about our approach on our website</a>.</p><p data-block-key="2dv5b">We hope you enjoy making videos in the Gemini app and Whisk as <a href="https://one.google.com/about/ai-premium/">Google One AI Premium subscribers</a>.</p></div>
  

  
    

  
    





<div role="form" data-component="uni-subscribe" data-analytics-module="{
    &quot;module_name&quot;: &quot;Newsletter&quot;,
    &quot;section_header&quot;: &quot;Get more stories from Google in your inbox.&quot;
  }">
    
    
    <div id="newsletter-form--form">
      <form data-method="POST" data-action="https://services.google.com/fb/submissions/thekeywordnewsletterprodv2/">
        <h2 id="subscribe_box_label">
          <span>Get more stories from Google in your inbox.</span>
          
        </h2>
        
      </form>
    </div>
    
    <div>
      <div>
        <p tabindex="-1" role="status" aria-live="off" aria-atomic="false">
          Done. Just one step more.
        </p>
        <p>
          Check your inbox to confirm your subscription.
        </p>
        <p>You are already subscribed to our newsletter.</p>
      </div>
      <p>
        You can also subscribe with a
        
        
      </p>
    </div>
  </div>

  

  


            
            

            
              




            
          </div>
  </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Benn Jordan's AI poison pill and the weird world of adversarial noise (105 pts)]]></title>
            <link>https://cdm.link/benn-jordan-ai-poison-pill/</link>
            <guid>43695401</guid>
            <pubDate>Tue, 15 Apr 2025 16:47:20 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cdm.link/benn-jordan-ai-poison-pill/">https://cdm.link/benn-jordan-ai-poison-pill/</a>, See on <a href="https://news.ycombinator.com/item?id=43695401">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
    	  
<p>Benn Jordan’s latest video proposes a way to fight back when generative AI music services rip off music for their data sets. It’s not ready for prime time yet, but it does offer a window into the wild, wonderful world of adversarial noise poisoning attacks.</p>



<p>Now, if you run in circles like mine, you’ve already gotten, “Hey, have you seen this new Benn Jordan video?” already, and I suspect gotten as far as watching it, but here you go:</p>



<figure><p>
<iframe title="The Art Of Poison-Pilling Music Files" width="500" height="281" src="https://www.youtube.com/embed/xMYm2d9bmEA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>
</p></figure>



<p>Benn’s approaches should have some real legs. There are two reasons to be optimistic. One, this family of techniques works on audio, so it <strong>covers the so-called “<a href="https://en.wikipedia.org/wiki/Analog_hole">analog loophole</a>“</strong>: it functions <em>anywhere</em> sound is heard. Two, there’s a potential to use <strong><em>different</em> methods</strong>, thus obfuscating the results. You can also validate the results, meaning these could be updated if services react.</p>



<p>It’s funny; when I spoke to Roland’s Paul McCabe about that company’s AI initiatives, I suggested a speculative design where you could press a button and block a performance from being trained. Benn actually went directly to the data science researchers to find out how that could be done – even in a live instrumental performance. So yes, this is possible. (Of course, you count as a CDM reader if your favorite music in the entire video is the targeted pressure wave attack at 22:00. The real AI attack would be inaudible to humans, not audible as it is here but – that’s my kind of music.) </p>



<p>Most important of all, though: <strong>these methods reveal how training sets and generative audio relate</strong>. Like Benn, I have interest in generative sound, algorithmic music, machine learning. It’s not about being pro- or anti-AI like this is a sport. We’re talking about the critical examination of a technology that is sucking up a huge amount of resources and reshaping the world around us. What these techniques do – even if the generative models find ways to circumvent them – is reveal something about how the technology works. It busts some of the mythmaking at a time when the world needs transparency, not another Wizard of Oz trick. </p>



<p>The big gotcha – spoiler alert – is that this requires <strong>high-end GPUs and a massive amount of electricity and time</strong> to pull off. Computation doesn’t magically consume less power on its own, either – least of all with semiconductor trade wars looming. But now that the idea is out there, the challenge would be devising a more efficient method; this at least works as a proof of concept.</p>



<p>In short, I’m for it. And I do expect a fear of training will stop some people from sending music to streaming services. It’s not hard to envision, as Benn does, a world where distributors license this technology to give producers added peace of mind. Remember in the early 2000s when we worried about protecting music from human fans? Now we’re protecting it from generative AI.</p>



<p>It’s worth watching the video, though, because the whole world of adversarial noise gets fascinating – and is a way to imagine hacking increasing AI and surveillance. So this is all about more than just the Poisonify concept (though that’s already essential).</p>



<h3>Into the data science</h3>



<p>Here’s more on the harmony cloaking tools developed at University of Tennessee Knoxville:</p>



<p><a href="https://eu.knoxnews.com/story/news/education/2024/12/10/harmonycloak-university-of-tennessee-stops-ai-from-using-copyrighted-music/76338974007/">You can’t hear it, but University of Tennessee tool ‘cloaks’ songs to protect music from AI</a> [<em>Knoxville News</em>]</p>



<p>The site/paper also has a survey:</p>



<p><a href="https://mosis.eecs.utk.edu/harmonycloak.html">HarmonyCloak: Making Music Unlearnable for Generative AI</a></p>



<p>The instrument classification attack, as far as I know, is novel. </p>



<p>Even if it didn’t find its market in digital distribution and DSPs, as Benn notes in the video, the AI detection algorithm research Benn did also remains compelling:</p>



<p><a href="https://musictech.com/news/music/benn-jordan-detect-ai-music/">Benn Jordan has made an algorithm that can detect if music has been made by AI or not</a></p>



<p>You’ll find a lot on adversarial noise, in different contexts – because that can be a method of training neural network classifiers and a way of attacking those systems. (There’s “friendly” and “unfriendly,” basically – even though I know that conflicts with what the word “adversarial” normally means. Think of it as “I’m challenging you to a game of chess to teach you something” versus “I’m challenging you to a game of chess to <em>mind control you</em>.” Sort of.)</p>



<p>And this stuff is moving <em>fast</em>. Here’s Los Alamos National Laboratory, the folks who have never been associated with anything other than friendly uses of science and technology:</p>



<p><a href="https://www.lanl.gov/media/news/0305-ai-adversarial-attacks">New AI defense method shields models from adversarial attacks</a></p>



<p>Or some 2022 proceedings of the International Conference of Neural Information Processing Systems:</p>



<p><a href="https://dl.acm.org/doi/10.5555/3600270.3601138">Friendly noise against adversarial noise:&nbsp;a powerful defense against data poisoning attacks</a></p>



<p>2020 and IBM Watson: [PDF]</p>



<p><a href="https://openaccess.thecvf.com/content_CVPRW_2020/papers/w47/Agarwal_Noise_Is_Inside_Me_Generating_Adversarial_Perturbations_With_Noise_Derived_CVPRW_2020_paper.pdf">Noise is Inside Me! Generating Adversarial Perturbations with Noise Derived from Natural Filters</a></p>



<p>Targeted pressure wave attacks as discussed in the video are being deployed against machines, but they’re also known for use in sonic weapons against humans. That’s likely what was causing serious neurological symptoms in pulsed microwave energy in Cuba, the <a href="https://www.nbcnews.com/news/all/havana-syndrome-likely-caused-microwave-energy-government-study-finds-n1250094">so-called “Havana Syndrome”</a> – <a href="https://www.nationaldefensemagazine.org/articles/2018/9/6/exclusive-doctors-reveal-details-of-neuroweapon-attacks-in-havana">sound as a neuro-weapon</a>.</p>



<p>But as for using sound against machines, here you go:</p>



<p><a href="https://hal.science/hal-03878176/file/Adversarial_attacks_by_random_noises.pdf">Neural Adversarial Attacks with Random Noises</a></p>



<p>And the same broader category of mechanisms that can be used to attack can be used in training:</p>



<p><a href="https://arxiv.org/abs/2109.09901">Modeling Adversarial Noise for Adversarial Training</a></p>



<p><a href="https://arxiv.org/abs/2212.05337">Targeted Adversarial Attacks on Deep Reinforcement Learning Policies via Model Checking</a></p>



<p>An actual data scientist might have some better ideas; I just play one on TV.</p>



<p>Anyway, yes, my idea of fun is making music, I really don’t find genAI music to be fun, but I do also enjoy imagining generating unheard musics by rewiring machine listening to categorize things incorrectly. </p>



<p>And, I mean, obviously we need to do some kind of music compilation of (audible) adversarial noise attacks, though I guess we should be careful how we distribute it. I think I’m only interested in a malfunctioning Alexa, so this might convince me to try to buy someone’s older model just to mess with it. I … also liked the screwed-up musical results better.</p>



<p>If that meandering discourse put you to sleep, here, let me wake you up again with rage.</p>



<p>Here’s the clip that inspired the image at top; it’s a quote from Suno.ai founder Mikey Shulman:</p>







<p>Oh, sorry, that is the text as spoken with an AI-generated version of Anakin Skywalker’s voice. (I was just <a href="https://youtu.be/miVu_LOC0G0?si=-3B196q8P5-PExT5">inspired by this conversation</a>; the sentence construction seemed similar.) Here is the original clip in context, in which he also says people don’t like running (again, maybe suggesting a Darth Vader sort of solution):</p>



<blockquote data-media-max-width="560"><p lang="en" dir="ltr">“It’s not really enjoyable to make music now… it takes a lot of time, it takes a lot of practice, you have to get really good at an instrument or really good at a piece of production software. I think the majority of people don’t enjoy the majority of time they spend making… <a href="https://t.co/zkv73Bhmi9">pic.twitter.com/zkv73Bhmi9</a></p>— Mike Patti (@mpatti) <a href="https://twitter.com/mpatti/status/1878147029764911131?ref_src=twsrc%5Etfw">January 11, 2025</a></blockquote> 

        
    	  
    	  <div><p>Tags: <a href="https://cdm.link/tag/adversarial-noise/" rel="tag">adversarial noise</a>, <a href="https://cdm.link/tag/ai/" rel="tag">AI</a>, <a href="https://cdm.link/tag/ai-weapons/" rel="tag">AI weapons</a>, <a href="https://cdm.link/tag/artists/" rel="tag">artists</a>, <a href="https://cdm.link/tag/benn-jordan/" rel="tag">Benn Jordan</a>, <a href="https://cdm.link/tag/business/" rel="tag">business</a>, <a href="https://cdm.link/tag/darth-vader/" rel="tag">Darth Vader</a>, <a href="https://cdm.link/tag/data-science/" rel="tag">data science</a>, <a href="https://cdm.link/tag/data-sets/" rel="tag">data sets</a>, <a href="https://cdm.link/tag/genai/" rel="tag">genAI</a>, <a href="https://cdm.link/tag/generative-ai/" rel="tag">generative AI</a>, <a href="https://cdm.link/tag/hacks/" rel="tag">hacks</a>, <a href="https://cdm.link/tag/machine-learning-2/" rel="tag">machine learning</a>, <a href="https://cdm.link/tag/opinion/" rel="tag">opinion</a>, <a href="https://cdm.link/tag/poison-pills/" rel="tag">poison pills</a>, <a href="https://cdm.link/tag/streaming/" rel="tag">streaming</a>, <a href="https://cdm.link/tag/the-flashbulb/" rel="tag">The Flashbulb</a></p></div>
    	  
    		      		
    						
				
				
				        
                          
                  	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[OpenAI is building a social network? (202 pts)]]></title>
            <link>https://www.theverge.com/openai/648130/openai-social-network-x-competitor</link>
            <guid>43694877</guid>
            <pubDate>Tue, 15 Apr 2025 16:08:29 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theverge.com/openai/648130/openai-social-network-x-competitor">https://www.theverge.com/openai/648130/openai-social-network-x-competitor</a>, See on <a href="https://news.ycombinator.com/item?id=43694877">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="zephr-anchor"><p>OpenAI is working on its own X-like social network, according to multiple sources familiar with the matter.</p><p>While the project is still in early stages, we’re told there’s an internal prototype focused on <a href="https://www.theverge.com/openai/636529/images-chatgpt-openai-studio-ghibli-copyright">ChatGPT’s image generation</a> that has a social feed. CEO Sam Altman has been privately asking outsiders for feedback about the project, our sources say. It’s unclear if OpenAI’s plan is to release the social network as a separate app or integrate it into ChatGPT, which became the <a href="https://techcrunch.com/2025/04/11/chatgpt-became-the-most-downloaded-app-globally-in-march/">most downloaded app</a> globally last month. An OpenAI spokesperson didn’t respond in time for publication.</p><p>Launching a social network in or around ChatGPT would likely increase Altman’s already-bitter rivalry with Elon Musk. In February, after Musk made <a href="https://www.theverge.com/news/609685/elon-musk-openai-purchase-offer">an unsolicited offer to purchase</a> OpenAI for $97.4 billion, Altman <a href="https://x.com/sama/status/1889059531625464090?lang=en">responded</a>: “no thank you but we will buy twitter for $9.74 billion if you want.”</p><p>Entering the social media market also puts OpenAI on more of a collision course with Meta, which we’re told is planning to add a social feed to its coming standalone app for its AI assistant. When reports of Meta building a rival to the ChatGPT app first surfaced a couple of months ago, Altman <a href="https://x.com/sama/status/1895230925753233763">shot back on X</a> again by saying, “ok fine maybe we’ll do a social app.”</p><p>A social app would also give OpenAI its own unique, real-time data that X and Meta already have to help train their AI models. Musk’s Grok surfaces content from X in its results (Musk recently went so far as <a href="https://www.theverge.com/news/638933/elon-musk-x-xai-acquisition">to merge X and xAI</a> into the same company), while Meta trains Llama on its vast trove of user data.</p><p>One idea behind the OpenAI social prototype is to have AI help people share better content. “The Grok integration with X has made everyone jealous,” says someone working at another big AI lab. “Especially how people create viral tweets by getting it to say something stupid.”</p><p>OpenAI has a lot going on, of course, and it’s unclear if its early-stage social media project will ever see the light of day. But its existence inside OpenAI shows how the company is thinking about expansion at a time when expectations for its future growth are sky high.</p><div><p id="do-you-work-at-openai"><h2><strong>Do you work at OpenAI?</strong></h2></p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[JSX over the Wire (186 pts)]]></title>
            <link>https://overreacted.io/jsx-over-the-wire/</link>
            <guid>43694681</guid>
            <pubDate>Tue, 15 Apr 2025 15:56:18 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://overreacted.io/jsx-over-the-wire/">https://overreacted.io/jsx-over-the-wire/</a>, See on <a href="https://news.ycombinator.com/item?id=43694681">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Suppose you have an API route that returns some data as JSON:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/api/likes/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>json</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>friendLikes</span><span>:</span><span> friendLikes</span><span>,</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>json</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>You also have a React component that needs that data:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>let </span><span>buttonText</span><span> </span><span>=</span><span> </span><span>'</span><span>Like</span><span>'</span><span>;</span></span>
<span data-line=""><span>  </span><span>if</span><span> </span><span>(</span><span>totalLikeCount </span><span>&gt;</span><span> </span><span>0</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>// e.g. "Liked by You, Alice, and 13 others"</span></span>
<span data-line=""><span>    buttonText </span><span>=</span><span> </span><span>formatLikeText</span><span>(</span><span>totalLikeCount</span><span>,</span><span> isLikedByUser</span><span>,</span><span> friendLikes</span><span>);</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>button</span><span> className={</span><span>isLikedByUser</span><span> ? </span><span>'</span><span>liked</span><span>'</span><span> : </span><span>''</span><span>}&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>buttonText</span><span>}</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>How do you get that data into that component?</p>
<p>You could pass it from a parent component using some data fetching library:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>PostLikeButton</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>json</span><span>,</span><span> </span><span>isLoading</span><span>] </span><span>=</span><span> </span><span>useData</span><span>(</span><span>`/api/likes/</span><span>${</span><span>postId</span><span>}</span><span>`</span><span>);</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line=""><span>      totalLikeCount={</span><span>json</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line=""><span>      isLikedByUser={</span><span>json</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line=""><span>      friendLikes={</span><span>json</span><span>.</span><span>friendLikes</span><span>}</span></span>
<span data-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>That’s one way of thinking about it.</p>
<p>But have another look at your API:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/api/likes/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>json</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>friendLikes</span><span>:</span><span> friendLikes</span><span>,</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>json</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>Do these lines remind you of anything?</p>
<p>Props. <em>You’re passing props.</em> You just didn’t specify <em>where to</em>.</p>
<p>But you already know their final destination—<code>LikeButton</code>.</p>
<p>Why not just fill that in?</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/api/likes/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>json</span><span> </span><span>=</span><span> </span><span>(</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line=""><span>      totalLikeCount={</span><span>post</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line=""><span>      isLikedByUser={</span><span>post</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line=""><span>      friendLikes={</span><span>friendLikes</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>json</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>Now the “parent component” of <code>LikeButton</code> is the <em>API itself</em>.</p>
<p>Wait, what?</p>
<p>Weird, I know. We’re going to worry about whether it’s a good idea later. But for now, notice how this inverts the relationship between components and the API. This is sometimes known as the Hollywood Principle: “Don’t call me, I’ll call you.”</p>
<p>Your components don’t call your API.</p>
<p>Instead, your API <em>returns</em> your components.</p>
<p>Why would you ever want to do that?</p>
<hr>
<ul>
<li><a href="#part-1-json-as-components">Part 1: JSON as Components</a></li>
<li><a href="#part-2-components-as-json">Part 2: Components as JSON</a></li>
<li><a href="#part-3-jsx-over-the-wire">Part 3: JSX Over The Wire</a></li>
</ul>
<hr>
<h2 id="part-1-json-as-components"><a target="_self" href="#part-1-json-as-components">Part 1: JSON as Components</a></h2>
<h3 id="model-view-viewmodel"><a target="_self" href="#model-view-viewmodel">Model, View, ViewModel</a></h3>
<p>There is a fundamental tension between how we want to <em>store</em> information and how we want to <em>display</em> it. We generally want to store more things than we display.</p>
<p>For example, consider a Like button on a Post. When we store Likes for a given Post, we might want to represent them as a table of <code>Like</code> rows like this:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> Like </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  createdAt</span><span>:</span><span> </span><span>string</span><span>,</span><span> </span><span>// Timestamp</span></span>
<span data-line=""><span>  likedById</span><span>:</span><span> </span><span>number</span><span>,</span><span> </span><span>// User ID</span></span>
<span data-line=""><span>  postId</span><span>:</span><span> </span><span>number</span><span>     </span><span>// Post ID</span></span>
<span data-line=""><span>};</span></span></code></pre></div>
<p>Let’s call this kind of data a “Model”. It represents the raw shape of the data.</p>

<p>So our Likes database table might contain data of that shape:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>[{</span></span>
<span data-line=""><span>  createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:41.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>  likedById</span><span>:</span><span> </span><span>123</span><span>,</span></span>
<span data-line=""><span>  postId</span><span>:</span><span> </span><span>1001</span></span>
<span data-line=""><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>  createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:42.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>  likedById</span><span>:</span><span> </span><span>456</span><span>,</span></span>
<span data-line=""><span>  postId</span><span>:</span><span> </span><span>1001</span></span>
<span data-line=""><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>  createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:43.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>  likedById</span><span>:</span><span> </span><span>789</span><span>,</span></span>
<span data-line=""><span>  postId</span><span>:</span><span> </span><span>1002</span></span>
<span data-line=""><span>},</span><span> </span><span>/* ... */</span><span>]</span></span></code></pre></div>
<p>However, what we want to <em>display</em> to the user is different.</p>
<p>What we want to display is the <em>number of Likes</em> for that Post, whether the <em>user has already liked it</em>, and the names of <em>their friends who also liked it</em>. For example, the Like button could appear pressed in (which means that you already liked this post) and say “You, Alice, and 13 others liked this.” Or “Alice, Bob, and 12 others liked this.”</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> LikeButtonProps </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line=""><span>  friendLikes</span><span>:</span><span> </span><span>string</span><span>[]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Let’s call this kind of data a “ViewModel”.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> ViewModel </span><span>=</span><span> </span><span>LikeButtonProps</span><span>;</span></span></code></pre></div>
<p>A ViewModel represents data in a way that is directly consumable by the UI (i.e the <em>view</em>). It is often significantly different from the raw Model. In our example:</p>
<ul>
<li>ViewModel’s <code>totalLikeCount</code> is aggregated from individual <code>Like</code> models.</li>
<li>ViewModel’s <code>isLikedByUser</code> is personalized and depends on the user.</li>
<li>ViewModel’s <code>friendLikes</code> is both aggregated and personalized. To calculate it, you’d have to takes the Likes for this post, filter them down to likes from friends, and get the first few friends’ names (which are likely stored in a different table).</li>
</ul>
<p>Clearly, Models will need to turn into ViewModels at some point. The question is <em>where</em> and <em>when</em> this happens in the code, and how that code evolves over time.</p>
<hr>
<h3 id="rest-and-json-api"><a target="_self" href="#rest-and-json-api">REST and JSON API</a></h3>
<p>The most common way to solve this problem is to expose some kind of a JSON API that the client can hit to assemble the ViewModel. There are different ways to design such an API, but the most common way is what’s usually known as REST.</p>
<p>The typical way to approach REST (<a target="_blank" href="https://htmx.org/essays/how-did-rest-come-to-mean-the-opposite-of-rest/">let’s say we’ve never read this article</a>) is to pick some “Resources”—such as a Post, or a Like—and provide JSON API endpoints that list, create, update, and delete such Resources. Naturally, REST does not specify anything about how you should <em>shape</em> these Resources so there’s a lot of flexibility.</p>
<p>Often, you might start by returning the shape of the Model:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// GET /api/post/123</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  title: </span><span>'</span><span>My Post</span><span>'</span><span>,</span></span>
<span data-line=""><span>  content: </span><span>'</span><span>Hello world...</span><span>'</span><span>,</span></span>
<span data-line=""><span>  authorId: </span><span>123</span><span>,</span></span>
<span data-line=""><span>  createdAt: </span><span>'</span><span>2025-04-13T02:04:40.668Z</span><span>'</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>So far so good. But how would you incorporate Likes into this? Maybe <code>totalLikeCount</code> and <code>isLikedByUser</code> could be a part of the Post Resource:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// GET /api/post/123</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  title: </span><span>'</span><span>My Post</span><span>'</span><span>,</span></span>
<span data-line=""><span>  content: </span><span>'</span><span>Hello world...</span><span>'</span><span>,</span></span>
<span data-line=""><span>  authorId: </span><span>123</span><span>,</span></span>
<span data-line=""><span>  createdAt: </span><span>'</span><span>2025-04-13T02:04:40.668Z</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  totalLikeCount: </span><span>13</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  isLikedByUser: </span><span>true</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Now, should <code>friendLikes</code> also go there? We need this information on the client.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// GET /api/post/123</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  title: </span><span>'</span><span>My Post</span><span>'</span><span>,</span></span>
<span data-line=""><span>  authorId: </span><span>123</span><span>,</span></span>
<span data-line=""><span>  content: </span><span>'</span><span>Hello world...</span><span>'</span><span>,</span></span>
<span data-line=""><span>  createdAt: </span><span>'</span><span>2025-04-13T02:04:40.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>  totalLikeCount: </span><span>13</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser: </span><span>true</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes: </span><span>[</span><span>'</span><span>Alice</span><span>'</span><span>,</span><span> </span><span>'</span><span>Bob</span><span>'</span><span>]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Or are we starting to abuse the notion of a Post by adding too much stuff to it? Okay, how about this, maybe we could offer a separate endpoint for a Post’s Likes:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>// GET /api/post/123/likes</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  totalCount: </span><span>13</span><span>,</span></span>
<span data-line=""><span>  likes: </span><span>[{</span></span>
<span data-line=""><span>    createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:41.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>    likedById</span><span>:</span><span> </span><span>123</span><span>,</span></span>
<span data-line=""><span>  </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>    createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:42.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>    likedById</span><span>:</span><span> </span><span>768</span><span>,</span></span>
<span data-line=""><span>  </span><span>},</span><span> </span><span>/* ... */</span><span>]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>So a Post’s Like becomes its own “Resource”.</p>
<p>That’s nice in theory but we’re going to need to know the likers’ names, and we don’t want to make a request for each Like. So we need to “expand” the users here:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// GET /api/post/123/likes</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  totalCount: </span><span>13</span><span>,</span></span>
<span data-line=""><span>  likes: </span><span>[{</span></span>
<span data-line=""><span>    createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:41.668Z</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    likedBy</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      id</span><span>:</span><span> </span><span>123</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>'</span><span>Alice</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      lastName</span><span>:</span><span> </span><span>'</span><span>Lovelace</span><span>'</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>    createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:42.668Z</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    likedBy</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      id</span><span>:</span><span> </span><span>768</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>'</span><span>Bob</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      lastName</span><span>:</span><span> </span><span>'</span><span>Babbage</span><span>'</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>}]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>We also “forgot” which of these Likes are from friends. Should we solve this by having a separate <code>/api/post/123/friend-likes</code> endpoint? Or should we order by friends first and include <code>isFriend</code> into the <code>likes</code> array items so we can disambiguate friends from other likes? Or should we add <code>?filter=friends</code>?</p>
<p>Or should we include the friend likes directly into the Post to avoid two API calls?</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// GET /api/post/123</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  title: </span><span>'</span><span>My Post</span><span>'</span><span>,</span></span>
<span data-line=""><span>  authorId: </span><span>123</span><span>,</span></span>
<span data-line=""><span>  content: </span><span>'</span><span>Hello world...</span><span>'</span><span>,</span></span>
<span data-line=""><span>  createdAt: </span><span>'</span><span>2025-04-13T02:04:40.668Z</span><span>'</span><span>,</span></span>
<span data-line=""><span>  totalLikeCount: </span><span>13</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser: </span><span>true</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes: </span><span>[{</span></span>
<span data-line="" data-highlighted-line=""><span>    createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:41.668Z</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    likedBy</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      id</span><span>:</span><span> </span><span>123</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>'</span><span>Alice</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      lastName</span><span>:</span><span> </span><span>'</span><span>Lovelace</span><span>'</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>},</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    createdAt</span><span>:</span><span> </span><span>'</span><span>2025-04-13T02:04:42.668Z</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    likedBy</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      id</span><span>:</span><span> </span><span>768</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>'</span><span>Bob</span><span>'</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      lastName</span><span>:</span><span> </span><span>'</span><span>Babbage</span><span>'</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>}]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>This seems useful but what if <code>/api/post/123</code> gets called from other screens that don’t need this information—and you’d rather not slow them down? Maybe there could be an opt-in like <code>/api/post/123?expand=friendLikes</code>?</p>
<p>Anyway, the point I’m trying to make here is not that it’s <em>impossible</em> to design a good REST API. The vast majority of apps I’ve seen works this way so it’s at the very least doable. But anyone who designed one and then worked on it for more than a few months knows the drill. <em>Evolving REST endpoints is a pain in the ass.</em></p>
<p>It usually goes like this:</p>
<ol>
<li>Initially, you have to decide how to structure the JSON output. None of the options are <em>cleary better</em> than the rest; mostly you’re just guessing how the app will evolve.</li>
<li>The initial decisions tend to settle down after a few back-and-forth iterations… until the next UI redesign which causes ViewModels to have slightly different shapes. The already existing REST endpoints don’t quite cover the new needs.</li>
<li>It’s possible to add new REST API endpoints, but at some point you’re not really “supposed to” add more because you already defined all the possible Resources. For example, if <code>/posts/123</code> exists, you likely won’t add another “get post” API.</li>
<li>Now you’re running into issues with calculating and sending either <em>not enough</em> or <em>too much</em> data. You either aggressively “expand” fields in the existing Resources or come up with an elaborate set of conventions for doing it on-demand.</li>
<li>Some ViewModels are only needed by a subset of screens but they’re always included in the response because that’s easier than making them configurable.</li>
<li>Some screens resort to cobbling their ViewModels together from multiple API calls because no single response contains all the necessary information anymore.</li>
<li>Then the design and the functionality of your product changes again. <em>Repeat.</em></li>
</ol>
<p>There’s clearly some fundamental tension here, but what is causing it?</p>
<p>First, note how the shape of the ViewModels is determined by the UI. It’s not a reflection of some platonic idea of a Like; rather, it’s dictated by the design. We want to show “You, Ann, and 13 others liked this”, <em>therefore</em> we need these fields:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> LikeButtonProps </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line=""><span>  friendLikes</span><span>:</span><span> </span><span>string</span><span>[]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>If this screen’s design or functionality changes (for example, if you want to show the avatars of your friends who liked the post), the ViewModel will change as well:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> LikeButtonProps </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    firstName</span><span>:</span><span> </span><span>string</span></span>
<span data-line="" data-highlighted-line=""><span>    avatar</span><span>:</span><span> </span><span>string</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>}[]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>But here’s the rub.</p>
<p>REST (or, rather, how REST is broadly used) encourages you to think in terms of Resources rather than Models <em>or</em> ViewModels. At first, your Resources start out as mirroring Models. But a single Model rarely has enough data for a screen, so you develop ad-hoc conventions for nesting Models in a Resource. However, including <em>all</em> the relevant Models (e.g. all Likes of a Post) is often impossible or impractical, so you start adding ViewModel-ish fields like <code>friendLikes</code> to your Resources.</p>
<p>But putting ViewModels in Resources also doesn’t work very well. ViewModels are not abstract concepts like “a post”; each ViewModel describes a <em>specific piece of UI</em>. As a result, the shape of your “Post” Resource grows to encompass the needs of every screen displaying a post. But those needs also <em>change over time,</em> so the “Post” Resource’s shape is at best a compromise between what different screens need now, and at worst a fossilized record of everything they’ve ever needed in the past.</p>
<p>Let me put this more bluntly:</p>
<p><strong>REST Resources don’t have a firm grounding in the reality.</strong> Their shapes are not sufficiently constrained—we’re making up concepts mostly out of thin air. Unlike Models, they’re not grounded in the reality of how the data is stored. And unlike ViewModels, they’re not grounded in the reality of how the data is presented. Unfortunately, nudging them in either direction only makes things worse.</p>
<p>If you keep REST Resources close to the Models, you’ll hurt the user experience. Now things that could be fetched in a single request would require a couple or, god forbid, N calls. This is especially noticeable in products from companies where the backend team “hands off” a REST API to the frontend team and takes no feedback. The API may look simple and elegant but it is completely impractical to consume.</p>
<p>On the other hand, if you nudge REST Resources to stay closer to the ViewModels, you’re hurting maintainability. ViewModels are fickle! Most ViewModels are going to change the next time the corresponding piece of UI is redesigned. But changing the shape of REST Resources is hard—the same Resources are being fetched by many screens. As a result, their shape gradually drifts away from the needs of the current ViewModels, and becomes difficult to evolve. There’s a reason the backend teams often resist adding UI-specific fields to the response: they’ll likely get stale!</p>
<p>This doesn’t necessarily mean that REST itself, as it’s broadly understood, is broken. It can be very nice to use when the Resources are well-defined and their fields are well-chosen. But this often goes against the client’s needs, which is to get all the data <em>for a particular screen</em>. There’s something missing in the middle.</p>
<p>We need a translation layer.</p>
<hr>
<h3 id="api-for-viewmodels"><a target="_self" href="#api-for-viewmodels">API for ViewModels</a></h3>
<p>There is a way to resolve this tension.</p>
<p>You have some latitude with how exactly you could approach it but the main idea is that your client should be able to request <em>all data for a specific screen at once</em>.</p>
<p>It’s such a simple idea!</p>
<p>Instead of requesting “canonical” REST Resources from the client such as:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default"><span data-line=""><span>GET</span><span> </span><span>/data/post/123</span><span>       </span><span># Get Post Resource</span></span>
<span data-line=""><span>GET</span><span> </span><span>/data/post/123/likes</span><span> </span><span># Get Post Likes Resource</span></span></code></pre></div>
<p>you request a ViewModel for <em>a specific screen</em> (i.e. a route):</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default"><span data-line=""><span>GET</span><span> </span><span>/screens/post-details/123</span><span> </span><span># Get ViewModel for the PostDetails screen</span></span></code></pre></div>
<p>This data would include <em>everything</em> that screen needs.</p>
<p>The difference is subtle but profound. You’re no longer trying to define a universal canonical shape of a <em>Post</em>. Rather, you send whatever data the <em>PostDetails screen</em> needs in order to display its components <em>today</em>. If the PostDetails screen gets deleted, this endpoint gets deleted too. If a different screen wants to display some related information (for example, a PostLikedBy popup), it will gets its own route:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default"><span data-line=""><span>GET</span><span> </span><span>/screens/post-details/123</span><span> </span><span># Get ViewModel for the PostDetails screen</span></span>
<span data-line="" data-highlighted-line=""><span>GET</span><span> </span><span>/screens/post-liked-by/123</span><span> </span><span># Get ViewModel for the PostLikedBy screen</span></span></code></pre></div>
<p>Okay, but how does this help?</p>
<p>This avoids the trap of “ungrounded” abstraction. The ViewModel interface for every screen precisely specifies the shape of the server response. If you need to change it or fine-tune it, you can do that without affecting any other screens.</p>
<p>For example, a <code>PostDetails</code> screen ViewModel might look like this:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> PostDetailsViewModel </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>    name</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>    avatar</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>    id</span><span>:</span><span> </span><span>number</span></span>
<span data-line=""><span>  </span><span>},</span></span>
<span data-line=""><span>  friendLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line=""><span>    friendLikes</span><span>:</span><span> </span><span>string</span><span>[]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>};</span></span></code></pre></div>
<p>So that’s what the server would return for <code>/screens/post-details/123</code>. Later, if you want to display avatars of friend likes, you’d just add it to <em>that</em> ViewModel:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> PostDetailsViewModel </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>    name</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>    avatar</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>    id</span><span>:</span><span> </span><span>number</span></span>
<span data-line=""><span>  </span><span>},</span></span>
<span data-line=""><span>  friendLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    friendLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>string</span></span>
<span data-line="" data-highlighted-line=""><span>      avatar</span><span>:</span><span> </span><span>string</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}[]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Note that you’d only have to update <em>that screen’s endpoint</em>. You’re no longer forced to balance what one screen needs with what another screen needs. There are no questions like “which Resource does this field belong to?”, or whether it should be “expanded”. If some screen needs more data than others, you can just include more data in <em>that</em> screen’s response—it doesn’t have to be generic or configurable. <strong>The shape of the server response is exactly determined by each screen’s needs.</strong></p>
<p>This <em>does</em> solve the stated problems with REST.</p>
<p>It also introduces a few novel questions:</p>
<ol>
<li>There’s going to be <em>a lot</em> more endpoints than with REST Resources—an endpoint per screen. How will these endpoints be structured and kept maintainable?</li>
<li>How do you reuse code between the endpoints? Presumably there would be a lot of duplicated data access and other business logic between those endpoints.</li>
<li>How do you convince the backend team to pivot from their REST APIs to this?</li>
</ol>
<p>The last question is probably the first we need to resolve. The backend team will likely have very warranted reservations about this approach. At the very least, if this approach proves terrible, it would be good to have a way to migrate back.</p>
<p>Luckily, there’s no need to throw anything away.</p>
<hr>
<h3 id="backend-for-frontend"><a target="_self" href="#backend-for-frontend">Backend For Frontend</a></h3>
<p>Instead or <em>replacing</em> your existing REST API, you can add a new <em>layer</em> in front of it:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>// You're adding new screen-specific endpoints...</span></span>
<span data-line="" data-highlighted-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>// ...which call your existing REST API here</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>fetch</span><span>(</span><span>`/api/post/</span><span>${</span><span>postId</span><span>}</span><span>`</span><span>).</span><span>then</span><span>(</span><span>r </span><span>=&gt;</span><span> </span><span>r</span><span>.</span><span>json</span><span>()),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>fetch</span><span>(</span><span>`/api/post/</span><span>${</span><span>postId</span><span>}</span><span>/friend-likes`</span><span>).</span><span>then</span><span>(</span><span>r </span><span>=&gt;</span><span> </span><span>r</span><span>.</span><span>json</span><span>()),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    </span><span>postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line=""><span>    </span><span>postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line=""><span>    </span><span>postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line=""><span>      friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>This is not a new idea. Such a layer is often called BFF, or <em>Backend for Frontend.</em> In this case, the job of the BFF is to adapt your REST API to returning ViewModels.</p>
<p><strong>If some screen needs more data, a BFF lets you serve more data to it without changing your entire data model. It keeps screen-specific changes scoped. Crucially, it lets you deliver all the data any screen needs in a single roundtrip.</strong></p>
<p>The BFF doesn’t have to be written in the same language as your REST API. For reasons we’ll get into later, it’s advantageous to write BFF in the same language as your frontend code. You can think of it as <em>a piece of the frontend that happens to run on the server</em>. It’s like the frontend’s “ambassador” to the server. It “adapts” the REST responses into the shape that each screen of the frontend UI actually wants.</p>
<p>Although you can get some of the benefits of BFF with client-only per-route loaders like <a target="_blank" href="https://reactrouter.com/start/framework/data-loading#client-data-loading"><code>clientLoader</code> in React Router</a>, there’s a lot you unlock by actually deploying this layer on the server close to where the REST endpoints are deployed.</p>
<p>For example, even if you <em>do</em> have to make several REST API requests serially one after another to load all the necessary data for a screen, the latency between the BFF and your REST API would be much lower than when making multiple serial requests from the client. If your REST API responses are fast on the internal network, you can cut down literal seconds of what used to be client/sever waterfalls without actually parallelizing the (sometimes inevitable) serial calls.</p>
<p>A BFF also lets you apply data transformations <em>before</em> sending data to the client, which can significantly improve performance on low-end client devices. You can even go as far as to cache or persist some computations on the disk, even <em>between</em> different users, since you have access to the disk—and to server caches like Redis. In that sense, a BFF lets a frontend team have <em>their very own little slice of the server</em>.</p>
<p>Importantly, a BFF gives you a way to experiment with alternatives to your REST APIs without affecting the client application. For example, if your REST API has no other consumers, you can turn it into an internal microservice and avoid exposing it to the world. Moreover, you could turn it into a <em>data access layer</em> rather than an HTTP service, and simply <em>import</em> that data access layer in-process from your BFF:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>import</span><span> </span><span>{</span><span> getPost</span><span>,</span><span> getFriendLikes </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>@your-company/data-layer</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>// Reads from an ORM and applies business logic.</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    </span><span>postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line=""><span>    </span><span>postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line=""><span>    </span><span>postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line=""><span>      friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>(Of course, this part only works if you can write lower-level backend logic in JS.)</p>
<p>This can help you avoid problems like loading the same information many times from the database (no <code>fetch</code> calls means database reads can be batched). It also lets you “drop down” the abstraction level when needed—for example, to run a fine-tuned stored database procedure that isn’t neatly exposed over the REST API.</p>
<p>There’s a lot to like about the BFF pattern. It solves quite a few problems but it also raises new questions. For example, how do you organize its code? If each screen is essentially its own API method, how do you avoid duplication of code? And how do you keep your BFF synchronized with data requirements of the front-end side?</p>
<p>Let’s try to make some progress on answering those.</p>
<hr>
<h3 id="composable-bff"><a target="_self" href="#composable-bff">Composable BFF</a></h3>
<p>Suppose you’re adding a new <code>PostList</code> screen. It’s going to render <em>an array</em> of <code>&lt;PostDetails&gt;</code> components, each of which needs the same data as before:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> PostDetailsViewModel </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>    name</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>    avatar</span><span>:</span><span> </span><span>string</span><span>,</span></span>
<span data-line=""><span>    id</span><span>:</span><span> </span><span>number</span></span>
<span data-line=""><span>  </span><span>},</span></span>
<span data-line=""><span>  friendLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line=""><span>    friendLikes</span><span>:</span><span> </span><span>string</span><span>[]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>};</span></span></code></pre></div>
<p>So the ViewModel for <code>PostList</code> contains an array of <code>PostDetailsViewModel</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> PostListViewModel </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  posts</span><span>:</span><span> </span><span>PostDetailsViewModel</span><span>[]</span></span>
<span data-line=""><span>};</span></span></code></pre></div>
<p>How would you load the data for <code>PostList</code>?</p>
<p>Your first inclination may be to make a series of requests from the client to the existing <code>/screen/post-details/:postId</code> endpoint which already knows how to prepare a ViewModel for a single post. We just need to call it for every post.</p>
<p>But wait, this defeats the entire purpose of the BFF! Making many requests for a single screen is inefficient and is precisely the kind of compromise that we’ve been trying to avoid. <strong>Instead, we’ll add a new BFF endpoint for the new screen.</strong></p>
<p>The new endpoint might initially look like this:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>import</span><span> </span><span>{</span><span> getPost</span><span>,</span><span> getFriendLikes</span><span>,</span><span> getRecentPostIds </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>@your-company/data-layer</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    </span><span>postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line=""><span>    </span><span>postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line=""><span>    </span><span>postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line=""><span>      friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-list</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>// Grab the recent post IDs</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>// For each post ID, load the data in parallel</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>posts</span><span>:</span><span> </span><span>await</span><span> </span><span>Promise</span><span>.</span><span>all</span><span>(</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>async</span><span> postId </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>]);</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>const </span><span>postDetailsViewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>          totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>          isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>          friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>};</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>return</span><span> postDetailsViewModel</span><span>;</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}))</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>};</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line="" data-highlighted-line=""><span>});</span></span></code></pre></div>
<p>However, note that there’s significant code duplication between the endpoints:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>import</span><span> </span><span>{</span><span> getPost</span><span>,</span><span> getFriendLikes</span><span>,</span><span> getRecentPostIds </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>@your-company/data-layer</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-list</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>posts</span><span>:</span><span> </span><span>await</span><span> </span><span>Promise</span><span>.</span><span>all</span><span>(</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>async</span><span> postId </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>]);</span></span>
<span data-line=""><span>      </span><span>const </span><span>postDetailsViewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>          totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>          isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>          friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>}</span></span>
<span data-line=""><span>      </span><span>};</span></span>
<span data-line=""><span>      </span><span>return</span><span> postDetailsViewModel</span><span>;</span></span>
<span data-line=""><span>    </span><span>}))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>It’s almost like there is a notion of “<code>PostDetails</code> ViewModel” begging to be extracted. This should not be surprising—both screens render the same <code>&lt;PostDetails&gt;</code> component, so they need similar code to load the data for it.</p>
<hr>

<p>Let’s extract a <code>PostDetailsViewModel</code> function:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>import</span><span> </span><span>{</span><span> getPost</span><span>,</span><span> getFriendLikes</span><span>,</span><span> getRecentPostIds </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>@your-company/data-layer</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>]);</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>};</span></span>
<span data-line="" data-highlighted-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> await </span><span>PostDetailsViewModel</span><span>({</span><span> </span><span>postId </span><span>});</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-list</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>posts</span><span>:</span><span> </span><span>await</span><span> </span><span>Promise</span><span>.</span><span>all</span><span>(</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>postId </span><span>=&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>PostDetailsViewModel</span><span>({</span><span> postId </span><span>})</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>This makes our BFF endpoints significantly simpler.</p>
<p>In fact, we can go a bit further. Look at this part of <code>PostDetailsViewModel</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>We know that the purpose of the <code>postLikes</code> field is to eventually become props for the <code>LikeButton</code> component—i.e. this field is <code>LikeButton</code>’s ViewModel:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>So let’s extract the logic preparing these props into <code>LikeButtonViewModel</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>import</span><span> </span><span>{</span><span> getPost</span><span>,</span><span> getFriendLikes</span><span>,</span><span> getRecentPostIds </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>@your-company/data-layer</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>]);</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>postLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span><span> </span><span>// It's fine to getPost() here again. Our data layer deduplicates calls via an in-memory cache.</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>LikeButtonViewModel</span><span>({</span><span> postId </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>),</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    postLikes</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Now we have a tree of functions that load data as JSON—our ViewModels.</p>
<p>Depending on your background, this might remind you of a few other things. It might remind you of composing Redux reducers out of smaller reducers. It might also remind you of composing GraphQL fragments out of smaller fragments. Or it might remind you of composing React components from other React components.</p>
<p>Although the code style is a little verbose now, there is something oddly satisfying in breaking apart a screen’s ViewModel into smaller ViewModels. It feels similar to writing a React component tree, except that we’re decomposing a backend API. It’s like <em>the data has its own shape but it roughly lines up with your React component tree</em>.</p>
<p>Let’s see what happens when the UI needs to evolve.</p>
<hr>
<h3 id="evolving-a-viewmodel"><a target="_self" href="#evolving-a-viewmodel">Evolving a ViewModel</a></h3>
<p>Suppose the UI design changes, and we want to display friends’ avatars too:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>type</span><span> LikeButtonProps </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>:</span><span> </span><span>number</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>:</span><span> </span><span>boolean</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    firstName</span><span>:</span><span> </span><span>string</span></span>
<span data-line="" data-highlighted-line=""><span>    avatar</span><span>:</span><span> </span><span>string</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>}[]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Assuming we use TypeScript, we’ll immediately get a type error in the ViewModel:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span></span>
<span data-line=""><span>  { postId } </span><span>:</span><span> </span><span>{</span><span> postId</span><span>:</span><span> </span><span>number</span><span> </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>)</span><span> </span><span>:</span><span> </span><span>LikeButtonProps</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>// 🔴 Type 'string[]' is not assignable to type '{ firstName: string; avatar: string; }[]'.</span></span>
<span data-line="" data-highlighted-line=""><span>    friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>)</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Let’s fix it:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span></span>
<span data-line=""><span>  { postId } </span><span>:</span><span> </span><span>{</span><span> postId</span><span>:</span><span> </span><span>number</span><span> </span><span>}</span></span>
<span data-line=""><span>)</span><span> </span><span>:</span><span> </span><span>LikeButtonProps</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>({</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      avatar</span><span>:</span><span> </span><span>l</span><span>.</span><span>avatar</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Now the BFF response for every screen that includes a <code>LikeButton</code> ViewModel will use the new <code>friendLikes</code> format, which is exactly what the <code>LikeButton</code> React component wants. There are no further changes to make—<em>it just works</em>. We <em>know</em> that it works because <code>LikeButtonViewModel</code> is the only place generating props for a <code>LikeButton</code>, no matter which screen we’re requesting from the BFF. (For now assume that this is true; we’re still yet to decide how exactly to tie them.)</p>
<p>I’d like to call attention to the previous fact because this is quite profound.</p>
<p>When was the last time you could clearly trace the correspondence between a deeply nested piece of server code generating a fragment of data, and a deeply nested piece of the client code consuming that data? We’re clearly onto <em>something</em>.</p>
<hr>
<h3 id="viewmodel-parameters"><a target="_self" href="#viewmodel-parameters">ViewModel Parameters</a></h3>
<p>You might have noticed that ViewModel functions can take parameters. Importantly, these parameters can be specified by the “parent” ViewModel functions and plumbed down—so the client doesn’t need to be aware of them.</p>
<p>For example, suppose you wanted to make the Post List page only display the first paragraph of every post’s content. Let’s add a parameter to its ViewModel:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  truncateContent</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>postLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>LikeButtonViewModel</span><span>({</span><span> postId </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>,</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}),</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line=""><span>    postLikes</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> await </span><span>PostDetailsViewModel</span><span>({</span></span>
<span data-line=""><span>    </span><span>postId</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>truncateContent</span><span>:</span><span> </span><span>false</span></span>
<span data-line=""><span>  </span><span>});</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-list</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>posts</span><span>:</span><span> </span><span>await</span><span> </span><span>Promise</span><span>.</span><span>all</span><span>(</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>postId </span><span>=&gt;</span></span>
<span data-line=""><span>      </span><span>PostDetailsViewModel</span><span>({</span></span>
<span data-line=""><span>        postId</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        truncateContent</span><span>:</span><span> </span><span>true</span></span>
<span data-line=""><span>      </span><span>})</span></span>
<span data-line=""><span>    </span><span>))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>The JSON response for the <code>post-details</code> endpoint still includes the entire posts, but the <code>post-list</code> JSON endpoint will now only serve their abridged summaries. This is a <em>view model</em> concern, and now we have a natural place to express it in code.</p>
<hr>
<h3 id="plumbing-viewmodel-parameters"><a target="_self" href="#plumbing-viewmodel-parameters">Plumbing ViewModel Parameters</a></h3>
<p>Next, suppose you wanted to include avatars only on the Details screen. Let’s edit <code>LikeButtonViewModel</code> to take and respect an <code>includeAvatars</code> parameter:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line=""><span>    friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>({</span></span>
<span data-line=""><span>      firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line=""><span>    </span><span>}))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Now you can plumb it down all the way from the BFF endpoints:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>postLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>LikeButtonViewModel</span><span>({</span><span> postId</span><span>,</span><span> includeAvatars </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>,</span><span> </span><span>{</span></span>
<span data-line=""><span>      maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line=""><span>    </span><span>}),</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line=""><span>    postLikes</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postId</span><span> </span><span>=</span><span> req</span><span>.</span><span>params</span><span>.</span><span>postId</span><span>;</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> await </span><span>PostDetailsViewModel</span><span>({</span></span>
<span data-line=""><span>    </span><span>postId</span><span>,</span></span>
<span data-line=""><span>    </span><span>truncateContent</span><span>:</span><span> </span><span>false</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>includeAvatars</span><span>:</span><span> </span><span>true</span></span>
<span data-line=""><span>  </span><span>});</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span>
<span data-line=""> </span>
<span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/screen/post-list</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line=""><span>  </span><span>const </span><span>viewModel</span><span> </span><span>=</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>posts</span><span>:</span><span> </span><span>await</span><span> </span><span>Promise</span><span>.</span><span>all</span><span>(</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>postId </span><span>=&gt;</span></span>
<span data-line=""><span>      </span><span>PostDetailsViewModel</span><span>({</span></span>
<span data-line=""><span>        postId</span><span>,</span></span>
<span data-line=""><span>        truncateContent</span><span>:</span><span> </span><span>true</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        includeAvatars</span><span>:</span><span> </span><span>false</span></span>
<span data-line=""><span>      </span><span>})</span></span>
<span data-line=""><span>    </span><span>))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>viewModel</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>Again, the client doesn’t pass ad-hoc parameters like <code>?includeAvatars=true</code> to the server to ensure that the avatars are included in the JSON response. Instead, the <code>post-list</code> BFF endpoint itself <em>knows</em> a Post List shouldn’t include avatars, so it can pass <code>includeAvatars: false</code> to <code>PostDetailsViewModel</code>, which plumbs it down to <code>LikeButtonViewModel</code>. The client code doesn’t need to be aware of the server logic at all—all it cares about is that it gets the props that it wants.</p>
<p>For the case when we <em>do</em> show avatars of friends, we might want to show five rather than two. We can make that change directly in <code>LikeButtonViewModel</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line=""><span>    friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>({</span></span>
<span data-line=""><span>      firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line=""><span>      avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line=""><span>    </span><span>}))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Since the <code>LikeButtonViewModel</code> function exists solely to generate the <code>LikeButton</code> props, adding more presentational logic here feels natural. It’s a <em>view</em> model, right? If another view <em>wanted</em> to show a different number of avatars, it could do that. Unlike with REST, there is no canonical notion of a “post”—so any UI can specify <em>exactly</em> the data it needs, from a screen all the way down to a button.</p>
<p>Our ViewModels evolve in the exact lockstep with the needs of the client.</p>
<hr>
<h3 id="composing-viewmodels"><a target="_self" href="#composing-viewmodels">Composing ViewModels</a></h3>
<p>Something interesting is taking shape. We’ve started to split our BFF endpoints into units of reusable logic, and we’ve found that these units let us encapsulate <em>data loading</em> in a similar way as we’ve been encapsulating the <em>user interface</em>. If you squint at ViewModels, you might even see some parallels to components.</p>
<p>And yet the end result of the ViewModel tree is not a UI tree—it’s just JSON.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// GET /screen/post-list</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  </span><span>/* Begin screen/post-list ViewModel */</span></span>
<span data-line=""><span>  posts: </span><span>[{</span></span>
<span data-line=""><span>    </span><span>/* Begin PostDetailsViewModel */</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>"</span><span>JSX Over The Wire</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>"</span><span>Dan</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postContent</span><span>:</span><span> </span><span>"</span><span>Suppose you have an API route that returns some data as JSON.</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>      </span><span>/* Begin LikeButtonViewModel */</span></span>
<span data-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>8</span><span>,</span></span>
<span data-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>false</span><span>,</span></span>
<span data-line=""><span>      friendLikes</span><span>:</span><span> </span><span>[{</span></span>
<span data-line=""><span>        firstName</span><span>:</span><span> </span><span>"</span><span>Alice</span><span>"</span></span>
<span data-line=""><span>      </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>        firstName</span><span>:</span><span> </span><span>"</span><span>Bob</span><span>"</span></span>
<span data-line=""><span>      </span><span>}]</span></span>
<span data-line=""><span>      </span><span>/* End LikeButtonViewModel */</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>    </span><span>/* End PostDetailsViewModel */</span></span>
<span data-line=""><span>  </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>/* Begin PostDetailsViewModel */</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>"</span><span>React for Two Computers</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>"</span><span>Dan</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postContent</span><span>:</span><span> </span><span>"</span><span>I’ve been trying to write this post at least a dozen times.</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postLikes</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>      </span><span>/* Begin LikeButtonViewModel */</span></span>
<span data-line=""><span>      totalLikeCount</span><span>:</span><span> </span><span>13</span><span>,</span></span>
<span data-line=""><span>      isLikedByUser</span><span>:</span><span> </span><span>true</span><span>,</span></span>
<span data-line=""><span>      friendLikes</span><span>:</span><span> </span><span>[{</span></span>
<span data-line=""><span>        firstName</span><span>:</span><span> </span><span>"</span><span>Bob</span><span>"</span></span>
<span data-line=""><span>      </span><span>}]</span></span>
<span data-line=""><span>      </span><span>/* End LikeButtonViewModel */</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>    </span><span>/* End PostDetailsViewModel */</span></span>
<span data-line=""><span>  </span><span>}]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>But what should we <em>do</em> with that JSON?</p>
<p>In the end, <em>somehow</em> we want the props generated by <code>LikeButtonViewModel</code> to end up in the <code>LikeButton</code> component. Likewise, <em>somehow</em> we want the props generated by <code>PostDetailsViewModel</code> to get to the <code>PostDetails</code> component. We don’t want to generate a huge ViewModel tree of JSON just to manually plumb every piece of it down exactly to the component that needs that ViewModel’s data.</p>
<p>We’re building two parallel hierarchies in the two worlds.</p>
<p>But these worlds are not connected yet.</p>
<p>Something is missing.</p>
<hr>
<h3 id="recap-json-as-components"><a target="_self" href="#recap-json-as-components">Recap: JSON as Components</a></h3>
<ul>
<li>For any UI, the data begins its life as Models and ends its life as ViewModels. The transformation between Models and ViewModels has to happen somewhere.</li>
<li>The shape of ViewModels is fully dictated by the design of our user interface. This means that they will evolve over time together with our designs. Also, different screens need different ViewModels aggregated from the same underlying Models.</li>
<li>Modeling data from the server as REST Resources creates a tension. If REST Resources are close to raw Models, it may require multiple roundtrips and complex ad-hoc conventions to obtain the necessary ViewModels for a screen. If REST Resources are close to ViewModels, they get too coupled to the initial screens they were designed to represent, and don’t evolve together with the needs of the client.</li>
<li>We can resolve this tension by creating another layer—a <em>Backend For Frontend</em> (BFF). The job of the BFF is to translate the needs of the client (“give me data for this screen”) to REST calls on the backend. A BFF can also evolve beyond being a facade for REST, and instead load data directly using an in-process data layer.</li>
<li>Since the BFF’s job is to return all the data needed for each screen as a piece of JSON, it is natural to split up the data loading logic into reusable units. A screen’s ViewModel can be decomposed into a tree of ViewModels, corresponding to the pieces of server data that different components will want to receive on the client. These individual ViewModels can then be recombined and composed together.</li>
<li>These ViewModel functions can pass information to each other. This lets us customize the JSON we’re sending depending on the screen. Unlike with REST, we’re no longer trying to design canonical shapes like a “a post object” used throughout all responses. At any point, we can diverge and serve different ViewModels for the same information to different screens—whatever <em>they</em> want. These ViewModels are <em>view</em> models. They can—should?—have presentation logic.</li>
<li>We’re beginning to realize that ViewModels form a very similar structure to React components. <em>ViewModels are like components, but for generating JSON</em>. However, we still haven’t figured out how to actually <em>pass</em> the JSON they’re generating on the server to the components that need it on the client. It’s also annoying to deal with two parallel hierarchies. We’re onto something, but we’re missing something.</li>
</ul>
<p>What are we missing?</p>
<hr>
<h2 id="part-2-components-as-json"><a target="_self" href="#part-2-components-as-json">Part 2: Components as JSON</a></h2>
<h3 id="html-ssi-and-cgi"><a target="_self" href="#html-ssi-and-cgi">HTML, SSI, and CGI</a></h3>
<p>JSON, MVVM, BFF, what the hell was that?!</p>
<p>What an incredibly overengineered way to make a website. These React complexity peddlers are <em>so</em> out of touch. If only they knew the <em>history</em>.</p>
<p>Back in <em>my</em> days, we’d just write a bit of HTML and call it a day.</p>
<p>My <code>index.html</code> homepage would look like this:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>html</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>Welcome to my blog!</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h2</span><span>&gt;</span><span>Latest posts</span><span>&lt;/</span><span>h2</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h3</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>a</span><span> href=</span><span>"</span><span>/jsx-over-the-wire.html</span><span>"</span><span>&gt;</span></span>
<span data-line=""><span>        JSX Over The Wire</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>a</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>h3</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>      Suppose you have an API route that returns some data as JSON. [...]</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h3</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>a</span><span> href=</span><span>"</span><span>/jsx-over-the-wire.html</span><span>"</span><span>&gt;</span></span>
<span data-line=""><span>        React for Two Computers</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>a</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>h3</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>      I’ve been trying to write this post at least a dozen times. [...]</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>    ...</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>html</span><span>&gt;</span></span></code></pre></div>
<p>Then my <code>jsx-over-the-wire.html</code> post details page would look like this:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>html</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>JSX Over The Wire</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>      Suppose you have an API route that returns some data as JSON.</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>    ...</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>html</span><span>&gt;</span></span></code></pre></div>
<p>I’d put these files on a box with Apache and that would be it!</p>
<p>Now suppose I wanted to add a footer to all my pages. That couldn’t be easier. First, let me create a file called <code>includes/footer.html</code> with my footer:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>marquee</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>a</span><span> href=</span><span>"</span><span>/</span><span>"</span><span>&gt;</span><span>overreacted</span><span>&lt;/</span><span>a</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>marquee</span><span>&gt;</span></span></code></pre></div>
<p>Now I can include my footer on any page with <a target="_blank" href="https://en.wikipedia.org/wiki/Server_Side_Includes">Server-Side Includes  (SSI)</a>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>html</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>Welcome to my blog!</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h2</span><span>&gt;</span><span>Latest posts</span><span>&lt;/</span><span>h2</span><span>&gt;</span></span>
<span data-line=""><span>    ...</span></span>
<span data-line="" data-highlighted-line=""><span>    &lt;!--#include virtual="/includes/footer.html" --&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>html</span><span>&gt;</span></span></code></pre></div>
<p>In fact, I don’t want to copy and paste the first paragraph of each blog post into my <code>index.html</code> file so I might use SSI together with <a target="_blank" href="https://en.wikipedia.org/wiki/Common_Gateway_Interface">CGI</a> to <em>generate</em> my index page:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>html</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>Welcome to my blog!</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>h2</span><span>&gt;</span><span>Latest posts</span><span>&lt;/</span><span>h2</span><span>&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>    &lt;!--#include virtual="/cgi-bin/post-details.cgi?jsx-over-the-wire&amp;truncateContent=true" --&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>    &lt;!--#include virtual="/cgi-bin/post-details.cgi?react-for-two-computers&amp;truncateContent=true" --&gt;</span></span>
<span data-line=""><span>    &lt;!--#include virtual="/includes/footer.html" --&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>html</span><span>&gt;</span></span></code></pre></div>
<p>Likewise, the details page will delegate to the same <code>post-details.cgi</code> script:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>html</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>body</span><span>&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>    &lt;!--#include virtual="/cgi-bin/post-details.cgi?jsx-over-the-wire&amp;truncateContent=false" --&gt;</span></span>
<span data-line=""><span>    &lt;!--#include virtual="/includes/footer.html" --&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>body</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>html</span><span>&gt;</span></span></code></pre></div>
<p>Finally, the <code>post-details.cgi</code> script might talk to the database:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default"><span data-line=""><span>#!/bin/sh</span></span>
<span data-line=""><span>echo</span><span> </span><span>"</span><span>Content-type: text/html</span><span>"</span></span>
<span data-line=""><span>echo</span><span> </span><span>""</span></span>
<span data-line=""> </span>
<span data-line=""><span>POST_ID</span><span>=</span><span>"$(</span><span>echo</span><span> "</span><span>$QUERY_STRING</span><span>" | </span><span>cut</span><span> </span><span>-d</span><span>'</span><span>&amp;</span><span>' </span><span>-f1</span><span> | </span><span>tr</span><span> </span><span>-cd</span><span> '</span><span>[:alnum:]._-</span><span>')"</span></span>
<span data-line=""><span>TRUNCATE</span><span>=</span><span>"$(</span><span>echo</span><span> "</span><span>$QUERY_STRING</span><span>" | </span><span>grep</span><span> </span><span>-c</span><span> "</span><span>truncateContent=true</span><span>")"</span></span>
<span data-line=""> </span>
<span data-line=""><span>TITLE</span><span>=</span><span>$(</span><span>mysql</span><span> </span><span>-u</span><span> admin </span><span>-p</span><span>'</span><span>password</span><span>' </span><span>-D</span><span> blog </span><span>--skip-column-names</span><span> </span><span>-e</span><span> </span><span>\</span></span>
<span data-line=""><span>  "</span><span>SELECT title FROM posts WHERE url='</span><span>$POST_ID</span><span>'</span><span>")</span></span>
<span data-line=""><span>CONTENT</span><span>=</span><span>$(</span><span>mysql</span><span> </span><span>-u</span><span> admin </span><span>-p</span><span>'</span><span>password</span><span>' </span><span>-D</span><span> blog </span><span>--skip-column-names</span><span> </span><span>-e</span><span> </span><span>\</span></span>
<span data-line=""><span>  "</span><span>SELECT content FROM posts WHERE url='</span><span>$POST_ID</span><span>'</span><span>")</span></span>
<span data-line=""> </span>
<span data-line=""><span>if</span><span> [ </span><span>"</span><span>$TRUNCATE</span><span>"</span><span> </span><span>=</span><span> </span><span>"</span><span>1</span><span>"</span><span> ]</span><span>;</span><span> </span><span>then</span></span>
<span data-line=""><span>  FIRST_PARAGRAPH</span><span>=</span><span>"$(</span><span>printf</span><span> "</span><span>%s</span><span>" "</span><span>$CONTENT</span><span>" | </span><span>sed</span><span> '</span><span>/^$/q</span><span>')"</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;h3&gt;&lt;a href=</span><span>\"</span><span>/</span><span>$POST_ID</span><span>.html</span><span>\"</span><span>&gt;</span><span>$TITLE</span><span>&lt;/a&gt;&lt;/h3&gt;</span><span>"</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;p&gt;</span><span>$FIRST_PARAGRAPH</span><span> [...]&lt;/p&gt;</span><span>"</span></span>
<span data-line=""><span>else</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;h1&gt;</span><span>$TITLE</span><span>&lt;/h1&gt;</span><span>"</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;p&gt;</span><span>"</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>$CONTENT</span><span>"</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;/p&gt;</span><span>"</span></span>
<span data-line=""><span>fi</span></span></code></pre></div>
<p>We’re in the <em>nineties</em>, okay?</p>
<p>So far everything is very simple, even if a bit tedious to write. What we have here is a server that returns <em>all the data necessary for any given screen in one roundtrip</em>.</p>
<p><em>(Hmm…)</em></p>
<p>Of course, different screens may need the same data, and we don’t want to duplicate the logic. Luckily, we can <em>reuse dynamic includes</em> such as <code>post-details.cgi</code>. We can <em>even pass parameters</em> to them like <code>truncateContent</code>.</p>
<p>The most annoying thing about this code is that working in Bash is really not for the faint-hearted (i.e. not for me). Let’s see if we can improve on that part.</p>
<hr>
<h3 id="php-and-xhp"><a target="_self" href="#php-and-xhp">PHP and XHP</a></h3>
<p>We could translate this entire example to old school PHP, which gives us better control flow, function calls, variables, and so on. However, I want to skip ahead.</p>
<p>No, not to the modern PHP MVC frameworks.</p>
<p>I want to skip ahead to <a target="_blank" href="https://codebeforethehorse.tumblr.com/post/3096387855/an-introduction-to-xhp">XHP</a>.</p>
<p>You see, the problem with the early PHP programs was that they relied on string manipulation of HTML. In that sense the PHP version doesn’t improve by much:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>if</span><span> (</span><span>$truncate</span><span>) {</span></span>
<span data-line=""><span>  </span><span>$splitContent</span><span> </span><span>=</span><span> </span><span>explode</span><span>(</span><span>"</span><span>\n\n</span><span>"</span><span>,</span><span> </span><span>$</span><span>content</span><span>);</span></span>
<span data-line=""><span>  </span><span>$firstParagraph</span><span> </span><span>=</span><span> </span><span>$splitContent</span><span>[</span><span>0</span><span>];</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;h3&gt;&lt;a href=</span><span>\"</span><span>/</span><span>$postId</span><span>.php</span><span>\"</span><span>&gt;</span><span>$title</span><span>&lt;/a&gt;&lt;/h3&gt;</span><span>"</span><span>;</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;p&gt;</span><span>$firstParagraph</span><span> [...]&lt;/p&gt;</span><span>"</span><span>;</span></span>
<span data-line=""><span>} </span><span>else</span><span> {</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;h1&gt;</span><span>$title</span><span>&lt;/h1&gt;</span><span>"</span><span>;</span></span>
<span data-line=""><span>  </span><span>echo</span><span> </span><span>"</span><span>&lt;p&gt;</span><span>$content</span><span>&lt;/p&gt;</span><span>"</span><span>;</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Manipulating HTML as strings leads to code that’s tangled, insecure, and difficult to maintain. Most people in the web development community took that as a signal to embrace <a target="_blank" href="https://guides.rubyonrails.org/layouts_and_rendering.html">Rails-style MVC</a> where all the HTML was safely moved out of the code into separate files called <em>templates</em> (and all the data fetching moved to <em>controllers</em>).</p>
<p>However, that’s not what happened at Facebook.</p>
<p>At Facebook, they had a different idea.</p>
<p>The problem with PHP, said Facebook engineers, was not the manipulation of markup <em>per se</em>. What was bad is <em>unprincipled</em> manipulation of markup, i.e. treating markup as a plain string. Markup has a certain <em>shape</em> to it—stuff contained in other stuff. What we need is a way to build and manipulate that markup without accidentally destroying its contents or interpolating unsafe content into it:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>if</span><span> (</span><span>$truncate</span><span>) {</span></span>
<span data-line=""><span>  </span><span>$splitContent</span><span> </span><span>=</span><span> </span><span>explode</span><span>(</span><span>"</span><span>\n\n</span><span>"</span><span>,</span><span> </span><span>$</span><span>content</span><span>);</span></span>
<span data-line=""><span>  </span><span>$firstParagraph</span><span> </span><span>=</span><span> </span><span>$splitContent</span><span>[</span><span>0</span><span>];</span></span>
<span data-line=""><span>  </span><span>echo</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>h3</span><span>&gt;&lt;</span><span>a</span><span> </span><span>href</span><span>=</span><span>{</span><span>"</span><span>/{</span><span>$postId</span><span>}.php</span><span>"</span><span>}</span><span>&gt;</span><span>{</span><span>$title</span><span>}</span><span>&lt;/</span><span>a</span><span>&gt;&lt;/</span><span>h3</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>p</span><span>&gt;</span><span>{</span><span>$firstParagraph</span><span>} </span><span>[...]&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;;</span></span>
<span data-line=""><span>} </span><span>else</span><span> {</span></span>
<span data-line=""><span>  </span><span>echo</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>$title</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>p</span><span>&gt;</span><span>{</span><span>$content</span><span>}</span><span>&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;;</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>These tags are not strings of HTML! They’re <em>objects</em> than can be <em>turned</em> into HTML.</p>
<p>Now that we’ve moved markup <em>into</em> our code in a maintainable way, we can create our own abstractions. For example, we can define our own <code>&lt;ui:post-details&gt;</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line="" data-highlighted-line=""><span>class</span><span> </span><span>:</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>details</span><span> </span><span>extends</span><span> </span><span>:</span><span>x</span><span>:</span><span>element</span><span> {</span></span>
<span data-line=""><span>  </span><span>protected</span><span> </span><span>function</span><span> </span><span>render</span><span>():</span><span> </span><span>XHPRoot</span><span> {</span></span>
<span data-line=""><span>    </span><span>if</span><span> (</span><span>$this</span><span>-&gt;:</span><span>truncateContent</span><span>) {</span></span>
<span data-line=""><span>      </span><span>$splitContent</span><span> </span><span>=</span><span> </span><span>explode</span><span>(</span><span>"</span><span>\n\n</span><span>"</span><span>,</span><span> </span><span>$</span><span>this</span><span>-&gt;:</span><span>content</span><span>);</span></span>
<span data-line=""><span>      </span><span>$firstParagraph</span><span> </span><span>=</span><span> </span><span>$splitContent</span><span>[</span><span>0</span><span>];</span></span>
<span data-line=""><span>      </span><span>return</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>          </span><span>&lt;</span><span>h3</span><span>&gt;&lt;</span><span>a</span><span> </span><span>href</span><span>=</span><span>{</span><span>"</span><span>/{</span><span>$postId</span><span>}.php</span><span>"</span><span>}</span><span>&gt;</span><span>{</span><span>$this</span><span>-&gt;:</span><span>title</span><span>}</span><span>&lt;/</span><span>a</span><span>&gt;&lt;/</span><span>h3</span><span>&gt;</span></span>
<span data-line=""><span>          </span><span>&lt;</span><span>p</span><span>&gt;</span><span>{</span><span>$firstParagraph</span><span>} </span><span>[...]&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;;</span></span>
<span data-line=""><span>    } </span><span>else</span><span> {</span></span>
<span data-line=""><span>      </span><span>return</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>          </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>{</span><span>$this</span><span>-&gt;:</span><span>title</span><span>}</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>          </span><span>&lt;</span><span>p</span><span>&gt;</span><span>{</span><span>$this</span><span>-&gt;:</span><span>content</span><span>}</span><span>&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;;</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""><span>  }</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>And then we can render it to the page:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>echo</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>details</span></span>
<span data-line=""><span>    </span><span>postId</span><span>=</span><span>"</span><span>jsx-over-the-wire</span><span>"</span></span>
<span data-line=""><span>    </span><span>truncateContent</span><span>=</span><span>{true}</span></span>
<span data-line=""><span>    </span><span>title</span><span>=</span><span>"</span><span>JSX Over The Wire</span><span>"</span></span>
<span data-line=""><span>    </span><span>content</span><span>=</span><span>"</span><span>Suppose you have an API route that returns some data...</span><span>"</span></span>
<span data-line=""><span>  </span><span>/&gt;;</span></span></code></pre></div>
<p>In fact, we can build an entire web application this way. Tags render other tags, which render other tags, and so on. By eschewing the Rails-style MVC model, we’ve accidentally discovered a much older principle: function composition.</p>
<p>One downside of XHP is that it isn’t very well-suited to client interactivity. Since XHP executes on a server that emits HTML, the most that you can do relatively seamlessly is to replace <em>parts</em> of an existing markup with the newly generated HTML markup from the server by updating <code>innerHTML</code> of some DOM node.</p>
<p>Replacing <code>innerHTML</code> wasn’t working out particularly well—especially for the highly interative Ads product—which made an engineer (who was not me, by the way) wonder whether it’s possible to run an XHP-style “tags render other tags” paradigm directly on the client computer without losing state between the re-renders. As you might gave guessed, this led to the <a target="_blank" href="https://legacy.reactjs.org/blog/2016/09/28/our-first-50000-stars.html#archeology">invention of JSX and React.</a></p>
<p>Who cares about React though?</p>
<p>We’re here to shill XHP.</p>
<hr>
<h3 id="async-xhp"><a target="_self" href="#async-xhp">Async XHP</a></h3>
<p>Earlier, <code>&lt;ui:post-details&gt;</code> got <code>title</code> and <code>content</code> from the calling code:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>echo</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>details</span></span>
<span data-line=""><span>    </span><span>postId</span><span>=</span><span>"</span><span>jsx-over-the-wire</span><span>"</span></span>
<span data-line=""><span>    </span><span>truncateContent</span><span>=</span><span>{true}</span></span>
<span data-line=""><span>    </span><span>title</span><span>=</span><span>"</span><span>JSX Over The Wire</span><span>"</span></span>
<span data-line=""><span>    </span><span>content</span><span>=</span><span>"</span><span>Suppose you have an API route that returns some data...</span><span>"</span></span>
<span data-line=""><span>  </span><span>/&gt;;</span></span></code></pre></div>
<p>It was not reading <code>title</code> or <code>content</code> on its own—after all, reading them from a database is (ideally) an <em>asynchronous</em> operation, while XHP tags are synchronous.</p>
<p><em>Were.</em></p>
<p>At some point, engineers at Facebook realized that XHP tags would be a lot more powerful if they could load their own data. <a target="_blank" href="https://hhvm.github.io/xhp-lib/2015/06/01/new-features-in-depth.html#asynchronous-xhp-rendering">Async XHP tags</a> were born:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>class</span><span> </span><span>:</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>details</span><span> </span><span>extends</span><span> </span><span>:</span><span>x</span><span>:</span><span>element</span><span> {</span></span>
<span data-line=""><span>  </span><span>use</span><span> </span><span>XHPAsync</span><span>;</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span>  </span><span>protected</span><span> </span><span>async</span><span> </span><span>function</span><span> </span><span>asyncRender</span><span>(</span><span>): Awaitable&lt;XHPRoot&gt; {</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>$post</span><span> </span><span>=</span><span> </span><span>await</span><span> </span><span>loadPost</span><span>(</span><span>$this</span><span>-&gt;:</span><span>postId</span><span>);</span></span>
<span data-line=""><span>    </span><span>$title</span><span> </span><span>=</span><span> </span><span>$post</span><span>-&gt;</span><span>title</span><span>;</span></span>
<span data-line=""><span>    </span><span>$content</span><span> </span><span>=</span><span> </span><span>$post</span><span>-&gt;</span><span>content</span><span>;</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line=""><span>  }</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Now the <code>&lt;ui:post-details&gt;</code> can <em>load its own data</em> based on <code>postId</code> alone:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>class</span><span> </span><span>:</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>list</span><span> </span><span>extends</span><span> </span><span>:</span><span>x</span><span>:</span><span>element</span><span> {</span></span>
<span data-line=""><span>  </span><span>protected</span><span> </span><span>function</span><span> </span><span>render</span><span>():</span><span> </span><span>XHPRoot</span><span> {</span></span>
<span data-line=""><span>    </span><span>return</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>details</span></span>
<span data-line="" data-highlighted-line=""><span>          </span><span>postId</span><span>=</span><span>"</span><span>jsx-over-the-wire</span><span>"</span></span>
<span data-line=""><span>          </span><span>truncateContent</span><span>=</span><span>{true}</span></span>
<span data-line=""><span>        </span><span>/&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>details</span></span>
<span data-line="" data-highlighted-line=""><span>          </span><span>postId</span><span>=</span><span>"</span><span>react-for-two-computers</span><span>"</span></span>
<span data-line=""><span>          </span><span>truncateContent</span><span>=</span><span>{true}</span></span>
<span data-line=""><span>        </span><span>/&gt;</span></span>
<span data-line=""><span>        </span><span>...</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;;</span></span>
<span data-line=""><span>  }</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>This approach lets you write the entire UI as <em>asynchronous</em> tags rendering other <em>asynchronous</em> tags—until the final HTML is generated. It’s a powerful way to think about UI and data. It lets you write self-contained components that load their own data, and then plug those components anywhere in the tree with a one-liner. And since XHP tags run on the server, the entire screen is resolved <em>in a single roundtrip</em>.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>&lt;</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>list</span><span> </span><span>/&gt;</span><span> </span><span>// An entire page of HTML</span></span></code></pre></div>
<p><strong>I need to emphasize this again. Async XHP allowed <em>self-contained components that load their own data</em> — but! — <em>displaying a screen took a single client/server roundtrip.</em> There aren’t many UI frameworks that satisfy both of these points.</strong></p>
<p>If you’re making a similar framework, there’s a few details you should think about:</p>
<ol>
<li>You want the siblings to be resolved in parallel. For example, the two <code>&lt;ui:post-details&gt;</code> above should <code>loadPost</code> around the same time. Async XHP did this.</li>
<li>You also need some way to <em>unblock</em> the rest of the page if a particular branch of the tree is taking too long. Facebook had a <a target="_blank" href="https://engineering.fb.com/2010/06/04/web/bigpipe-pipelining-web-pages-for-high-performance/">BigPipe  “pagelet”</a> system that flushes the tree “in parts” with explicitly designed loading states acting as the seams.</li>
<li>Ideally, you want a data access layer that’s able to batch reads and share an in-memory cache across different parts of the request. This ensures that even if tags deeper in the tree start “fetching” later than their parents, you’re utilizing both CPU and IO well—there are always some tags to render while waiting for the DB.</li>
</ol>
<p>Overall, async XHP was an incredibly productive mental model to work with—as long as your app was not very interactive. Unfortunately, for highly interactive apps, emitting HTML is not enough. You <em>need</em> to be able to navigate, handle mutations, and refresh content without losing the client-side state. Since XHP targeted HTML, it was a poor fit for rich interfaces, and React gradually took over.</p>
<p><strong>Still, as interfaces were being converted to React, there was a noticeable loss in conceptual simplicity. The UI and the <em>data that it needs</em>—two things that are so naturally described together—were being pulled apart into separate codebases.</strong></p>
<p>GraphQL with <a target="_blank" href="https://relay.dev/">Relay</a> were somewhat bridging that gap and contributed some very important innovations, but using them never felt <em>as direct</em> as writing async XHP.</p>
<hr>
<h3 id="native-templates"><a target="_self" href="#native-templates">Native Templates</a></h3>
<p>XHP had an unlikely comeback at Facebook.</p>
<p>The mental model it offered was so productive that people didn’t just want to write web interfaces with it. They also wanted to make <em>native apps</em> with it.</p>
<p>Think about it.</p>
<p>This piece of XHP is an <em>object:</em></p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>h1</span><span>&gt;{</span><span>$this</span><span>-&gt;</span><span>:title</span><span>}&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>p</span><span>&gt;{</span><span>$this</span><span>-&gt;</span><span>:content</span><span>}&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span></code></pre></div>
<p>Yes, it <em>can</em> be turned into a piece of HTML:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>h1</span><span>&gt;</span><span>JSX Over The Wire</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>&lt;</span><span>p</span><span>&gt;</span><span>Suppose you have an API route that returns some data as JSON</span><span>&lt;/</span><span>p</span><span>&gt;</span></span></code></pre></div>
<p>But it could also be turned into another representation, such as JSON:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>'</span><span>x:frag</span><span>'</span><span>,</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    children: </span><span>[{</span></span>
<span data-line=""><span>      type</span><span>:</span><span> </span><span>'</span><span>h1</span><span>'</span><span>,</span></span>
<span data-line=""><span>      props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>        children</span><span>:</span><span> </span><span>'</span><span>JSX Over The Wire</span><span>'</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>},</span></span>
<span data-line=""><span>    </span><span>{</span></span>
<span data-line=""><span>      type</span><span>:</span><span> </span><span>'</span><span>p</span><span>'</span><span>,</span></span>
<span data-line=""><span>      props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>        children</span><span>:</span><span> </span><span>'</span><span>Suppose you have an API route that returns some data as JSON</span><span>'</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>}]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>There’s nothing that <em>actually</em> constrains you to the primitives available in HTML. For example, <code>&lt;ui:post-details&gt;</code> could have been emitting <a target="_blank" href="https://developer.apple.com/documentation/uikit/uitextview">iOS views</a> instead:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>&lt;</span><span>ios</span><span>:</span><span>UITextView</span><span>&gt;{</span><span>$this</span><span>-&gt;</span><span>:title</span><span>}&lt;/</span><span>ios</span><span>:</span><span>UITextView</span><span>&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>&lt;</span><span>ios</span><span>:</span><span>UITextView</span><span>&gt;{</span><span>$this</span><span>-&gt;</span><span>:content</span><span>}&lt;/</span><span>ios</span><span>:</span><span>UITextView</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span></code></pre></div>
<p>These tags could be transported as JSON over the network to a native iOS app that would read that JSON and construct a native iOS view hierarchy from these tags.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>'</span><span>x:frag</span><span>'</span><span>,</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    children: </span><span>[{</span></span>
<span data-line="" data-highlighted-line=""><span>      type</span><span>:</span><span> </span><span>'</span><span>ios:UITextView</span><span>'</span><span>,</span></span>
<span data-line=""><span>      props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>        children</span><span>:</span><span> </span><span>'</span><span>JSX Over The Wire</span><span>'</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>},</span></span>
<span data-line=""><span>    </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      type</span><span>:</span><span> </span><span>'</span><span>ios:UITextView</span><span>'</span><span>,</span></span>
<span data-line=""><span>      props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>        children</span><span>:</span><span> </span><span>'</span><span>Suppose you have an API route that returns some data as JSON</span><span>'</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>}]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Meanwhile, on the server, you can define your own tags that render those tags:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>class</span><span> :</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>list</span><span> </span><span>extends</span><span> :x:element </span><span>{</span></span>
<span data-line=""><span>  </span><span>protected</span><span> </span><span>function</span><span> </span><span>render</span><span>():</span><span> </span><span>XHPRoot</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>return</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>ui:post-details</span></span>
<span data-line=""><span>          postId=</span><span>"</span><span>jsx-over-the-wire</span><span>"</span></span>
<span data-line=""><span>          truncateContent={</span><span>true</span><span>}</span></span>
<span data-line=""><span>        /&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>ui:post-details</span></span>
<span data-line=""><span>          postId=</span><span>"</span><span>react-for-two-computers</span><span>"</span></span>
<span data-line=""><span>          truncateContent={</span><span>true</span><span>}</span></span>
<span data-line=""><span>        /&gt;</span></span>
<span data-line=""><span>        ...</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>x</span><span>:</span><span>frag</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>In other words, you’d have a server endpoint that returns <em>the entire data that any particular screen needs in a single roundtrip</em>. Where the “data” is the native UI.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="php" data-theme="default"><code data-language="php" data-theme="default"><span data-line=""><span>&lt;</span><span>ui</span><span>:</span><span>post</span><span>-</span><span>list</span><span> </span><span>/&gt;</span><span> </span><span>// A screen of iOS components</span></span></code></pre></div>
<p>You might think this wouldn’t work because a native app can’t rely on a backend in the critical path. However, that’s a misunderstanding of the approach. All you need to ensure is that you <em>request more UI</em> in the same situations as <em>when you would make an API call,</em> and not more often. You’ll also want to have a fallback UI (like a spinner) available instantly <em>just like when making an API call.</em> In fact, you can even bundle the JSON for some of the initial screens directly within your app’s binary.</p>
<p>In practice, system components like <code>ios:UITextView</code> are a bit too low-level to be good primitives for this kind of format. You really want to have a good “palette” of highly interactive primitives since you want <em>some</em> interactions to “skip the server” and be entirely local. For example, you might implement an <code>ios:ColorPicker</code> primitive in the native code so that it follows your finger’s movement, but <em>persist</em> the chosen color using a call to the API that will serve you the next screen as JSON.</p>
<p>Also, if you made the primitives platform-agnostic (which Facebook did), you could use the same server codebase to assemble screens for both iOS and Android:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>nt:flexbox</span><span> flex-direction=</span><span>"</span><span>column</span><span>"</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>nt:text</span><span> font-size={</span><span>24</span><span>} font-weight={</span><span>FontWeight</span><span>::</span><span>BOLD</span><span>}&gt;</span></span>
<span data-line=""><span>    </span><span>{</span><span>$this</span><span>-&gt;</span><span>:title</span><span>}</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>nt:text</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>nt:text</span><span> font-size={</span><span>18</span><span>}&gt;</span></span>
<span data-line=""><span>    </span><span>{</span><span>$this</span><span>-&gt;</span><span>:content</span><span>}</span></span>
<span data-line=""><span>  </span><span>&lt;/</span><span>nt:text</span><span>&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>nt:flexbox</span><span>&gt;</span></span></code></pre></div>
<p>Okay, returning an entire screen as JSON, has anyone done this before?</p>
<hr>
<h3 id="sdui"><a target="_self" href="#sdui">SDUI</a></h3>
<p>This is not a novel idea.</p>
<p>This is not even a controversial idea.</p>
<p>You’ve heard of HTML, right? This is like HTML, but with <em>your</em> design system. Imagine an API endpoint that returns some UI as JSON. Let’s use the JSX syntax:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/app/profile/:personId</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>person</span><span>,</span><span> </span><span>featureFlags</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>findPerson</span><span>(</span><span>req</span><span>.</span><span>params</span><span>.</span><span>personId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFeatureFlags</span><span>(</span><span>req</span><span>.</span><span>user</span><span>.</span><span>id</span><span>)</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""> </span>
<span data-line=""><span>  </span><span>const </span><span>json</span><span> </span><span>=</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>Page</span><span> title={</span><span>`</span><span>${</span><span>person</span><span>.</span><span>firstName</span><span>}</span><span>'s Profile`</span><span>}&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>Header</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>Avatar</span><span> src={</span><span>person</span><span>.</span><span>avatarUrl</span><span>} /&gt;</span></span>
<span data-line=""><span>        </span><span>{</span><span>person</span><span>.</span><span>isPremium </span><span>&amp;&amp;</span><span> </span><span>&lt;</span><span>PremiumBadge</span><span> /&gt;}</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>Header</span><span>&gt;</span></span>
<span data-line=""> </span>
<span data-line=""><span>      </span><span>&lt;</span><span>Layout</span><span> columns={</span><span>featureFlags</span><span>.</span><span>includes</span><span>(</span><span>'</span><span>TWO_COL_LAYOUT</span><span>'</span><span>) ? </span><span>2</span><span> : </span><span>1</span><span>}&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>Panel</span><span> title=</span><span>"</span><span>User Info</span><span>"</span><span>&gt;</span></span>
<span data-line=""><span>          </span><span>&lt;</span><span>UserDetails</span><span> user={</span><span>person</span><span>} /&gt;</span></span>
<span data-line=""><span>          </span><span>{</span><span>req</span><span>.</span><span>user</span><span>.</span><span>id </span><span>===</span><span> </span><span>person</span><span>.</span><span>id </span><span>&amp;&amp;</span><span> </span><span>&lt;</span><span>EditButton</span><span> /&gt;}</span></span>
<span data-line=""><span>        </span><span>&lt;/</span><span>Panel</span><span>&gt;</span></span>
<span data-line=""> </span>
<span data-line=""><span>        </span><span>&lt;</span><span>Panel</span><span> title=</span><span>"</span><span>Activity</span><span>"</span><span>&gt;</span></span>
<span data-line=""><span>          </span><span>&lt;</span><span>ActivityFeed</span><span> userId={</span><span>person</span><span>.</span><span>id</span><span>} limit={</span><span>3</span><span>} /&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;/</span><span>Panel</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>Layout</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>Page</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""> </span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>json</span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>But since you’re essentially coding an API endpoint, you can do anything <em>your API</em> can do—check the feature flags, run server-only logic, read from the data layer.</p>
<p>Again, this is not a new idea.</p>
<p>In fact, it’s how many of the top native apps are built. <a target="_blank" href="https://github.com/novitae/igbloks/tree/main/KNOWLEDGES">Instagram does this</a>, <a target="_blank" href="https://medium.com/airbnb-engineering/a-deep-dive-into-airbnbs-server-driven-ui-system-842244c5f5">Airbnb does this</a>, <a target="_blank" href="https://www.reddit.com/r/androiddev/comments/1046xel/comment/j35yr8c/">Uber does this</a>, <a target="_blank" href="https://www.infoq.com/news/2023/09/reddit-feed-server-driven-ui/">Reddit does this</a>, etc. These companies use in-house frameworks that implement this pattern. Many web developers are completely unaware of this pattern which is ironic because the pattern is incredibly “webby”.</p>
<p>In the native sphere, the pattern is known as “SDUI”—<em>“server driven UI”</em>. This sounds fancy but essentially it’s just JSON endpoints that return UI trees:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>// /app/profile/123</span></span>
<span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>"</span><span>Page</span><span>"</span><span>,</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    title: </span><span>"</span><span>Jae's Profile</span><span>"</span><span>,</span></span>
<span data-line=""><span>    children: </span><span>[{</span></span>
<span data-line=""><span>      type</span><span>:</span><span> </span><span>"</span><span>Header</span><span>"</span><span>,</span></span>
<span data-line=""><span>      props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>        children</span><span>:</span><span> </span><span>[{</span></span>
<span data-line=""><span>          type</span><span>:</span><span> </span><span>"</span><span>Avatar</span><span>"</span><span>,</span></span>
<span data-line=""><span>          props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>            src</span><span>:</span><span> </span><span>"</span><span>https://example.com/avatar.jpg</span><span>"</span></span>
<span data-line=""><span>          </span><span>}</span></span>
<span data-line=""><span>        </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>          type</span><span>:</span><span> </span><span>"</span><span>PremiumBadge</span><span>"</span><span>,</span></span>
<span data-line=""><span>          props</span><span>:</span><span> </span><span>{},</span></span>
<span data-line=""><span>        </span><span>}]</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>      type</span><span>:</span><span> </span><span>"</span><span>Layout</span><span>"</span><span>,</span></span>
<span data-line=""><span>      props</span><span>:</span><span> </span><span>{</span></span>
<span data-line=""><span>        columns</span><span>:</span><span> </span><span>2</span><span>,</span></span>
<span data-line=""><span>        children</span><span>:</span><span> </span><span>[</span></span>
<span data-line=""><span>          </span><span>// ...</span></span>
<span data-line=""><span>        </span><span>]</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>}]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Then, on the native side, you have some concrete implementations of those primitives—<code>Page</code>, <code>Header</code>, <code>Avatar</code>, <code>PremiumBadge</code>, <code>Layout</code>, and so on.</p>
<p>Ultimately, this feels like <em>passing props</em> from the server to the client.</p>
<p>So if we ever find ourselves in a situation where we have a bunch of data prepared on the server, and we need to find a good way to pass pieces of that data to a bunch of functions declared on the client, a format like this might turn out to be handy.</p>
<p>Let’s keep that in mind.</p>
<hr>
<h3 id="recap-components-as-json"><a target="_self" href="#recap-components-as-json">Recap: Components as JSON</a></h3>
<ul>
<li>From the beginning of time, making web apps involved responding to request for a specific screen with all the data needed for that screen. (HTML is data, too.)</li>
<li>From the beginning of time, people looked for ways to make the generation of that “data” dynamic, to split it into reusable logic, and to pass parameters to that logic.</li>
<li>In the early days of the web, it was common to compose HTML by string manipulation. Unfortunately, it was easy to mess up and led to many issues.</li>
<li>This led many in the web community to banish markup to templates. But at Facebook, XHP proposed another approach: markup that produces objects.</li>
<li>It turns out that making markup a first-class coding primitive naturally leads to tags “returning” other tags—instead of MVC, we got functional composition.</li>
<li>XHP evolved into Async XHP, which allowed to keep the logic for rendering some UI close to the logic for loading the data it needs. This was extremely powerful.</li>
<li>Unfortunately, producing HTML as the primary output format is a dead end for interactive applications. You can’t “refresh” HTML in-place without blowing away the state, and state is important.</li>
<li>However, nothing actually constraints us to HTML. If tags are objects, they can be sent as JSON. Many of the most successful <em>native</em> apps are built this paradigm. (And if you need HTML, you can always turn JSON <em>into</em> HTML later on.)</li>
<li>Returning a tag of client primitives as a JSON tree is a nice way to represent “passing props” to the client.</li>
</ul>
<hr>
<h2 id="part-3-jsx-over-the-wire"><a target="_self" href="#part-3-jsx-over-the-wire">Part 3: JSX Over The Wire</a></h2>
<h3 id="what-were-building"><a target="_self" href="#what-were-building">What We’re Building</a></h3>
<p>So far, we’ve explored two separates lines of thought:</p>
<ul>
<li>Directly calling REST APIs from the client layer <a href="#rest-and-json-api">ignores the realities</a> of how user interfaces evolve. We can solve this by <a href="#api-for-viewmodels">adding a new backend layer</a> that assembles the data on the server according to what each screen <em>needs</em>. This layer <a href="#extracting-a-viewmodel">can be split into functions</a> that each specify how to load data for a particular <em>part</em> of the screen. Then these functions can be <a href="#composing-viewmodels">composed together</a>. However, we’re not sure how to actually <em>tie</em> those functions to the components whose props they are preparing.</li>
<li>We can also <a href="#html-ssi-and-cgi">start from plain HTML</a> and “server includes”. If we avoid early MVC-ification and instead explore treating markup as objects, we’ll <a href="#php-and-xhp">eventually invent</a> the concept of <a href="#async-xhp">asynchronous tags</a> that load their own data and return more tags. This approach is very powerful because it lets us build self-contained components without causing multiple client/server roundtrips for fetching a single screen. Emitting HTML <em>as the only target format</em> is a dead end, but as proven by many top native applications using this approach, <a href="#native-templates">emitting JSON</a> retains all the benefits. All you need is a <a href="#sdui">set of client-side primitives</a> that can be composed from the server.</li>
</ul>
<p>It turns out that these are two different ways to talk about the same thing. Ultimately, all we want is a system with these five properties:</p>
<h4 id="dans-async-ui-framework-checklist"><a target="_self" href="#dans-async-ui-framework-checklist">Dan’s Async UI Framework Checklist</a></h4>
<ol>
<li>Our system lets us split a user interface into rich, interactive components.</li>
<li>Components should have a <em>direct connection</em> with the logic that specifies how <em>their</em> server data is computed. If a component receives some information from the server, you should be a single Ctrl+Click or “Find All References” away from every place on the server where <em>that particular component’s</em> props are being calculated. It should be straightforward to change which data is received by which component.</li>
<li>There should be a way to make pieces of UI truly self-contained—including their server data dependencies and corresponding server logic. You should be able to nest a piece of UI inside another piece of UI without worrying what data it needs.</li>
<li>A navigation to a new screen should be possible to complete in one client/server roundtrip. Even if you have hundreds of components that each want to load some data, from the client’s perspective, a screen should arrive as a single response. In fact, we’d like our system to <em>stand in the way</em> of creating client/server waterfalls.</li>
<li>We’d like our system to fully support rich interactivity. This means that, even if some parts of it run on the server, it is <em>unacceptable</em> to require full-page refreshes on navigation or after a mutation. In fact, the system should support in-place refreshing of server data directly within an interactive tree. A component should be able to “receive new props” from the server without losing any client state.</li>
</ol>
<p>Do you know any such systems? (Try scoring the frameworks you know.)</p>
<p>If not, let’s invent one right now.</p>
<hr>
<h3 id="viewmodels-revisited"><a target="_self" href="#viewmodels-revisited">ViewModels, Revisited</a></h3>
<p>Let’s get back to <a href="#plumbing-viewmodel-parameters">the last version</a> of <code>LikeButtonViewModel</code> from earlier:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>    totalLikeCount</span><span>:</span><span> </span><span>post</span><span>.</span><span>totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    isLikedByUser</span><span>:</span><span> </span><span>post</span><span>.</span><span>isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    friendLikes</span><span>:</span><span> </span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l </span><span>=&gt;</span><span> </span><span>({</span></span>
<span data-line="" data-highlighted-line=""><span>      firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}))</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>This function is a <em>slice of the backend</em> that prepares the props for the <code>LikeButton</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser: </span><span>false</span><span>,</span></span>
<span data-line=""><span>  friendLikes: </span><span>[{</span></span>
<span data-line=""><span>    firstName</span><span>:</span><span> </span><span>'</span><span>Alice</span><span>'</span><span>,</span></span>
<span data-line=""><span>    avatar</span><span>:</span><span> </span><span>'</span><span>https://example.com/alice.jpg</span><span>'</span></span>
<span data-line=""><span>  </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>    firstName</span><span>:</span><span> </span><span>'</span><span>Bob</span><span>'</span><span>,</span></span>
<span data-line=""><span>    avatar</span><span>:</span><span> </span><span>'</span><span>https://example.com/bob.jpg</span><span>'</span></span>
<span data-line=""><span>  </span><span>}]</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Eventually we were hoping that the <code>LikeButton</code> will receive these props:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>However, we haven’t come up with any mechanism to connect the two sides yet. Who’s gonna pass the JSON returned by the <code>LikeButtonViewModel</code> to the <code>LikeButton</code> component? How do we tie the ViewModels to their components?</p>
<p>What if we took a page out of <a href="#sdui">SDUI</a> and expressed that by returning a <em>tag</em>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line=""><span>      totalLikeCount={</span><span>post</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line=""><span>      isLikedByUser={</span><span>post</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line=""><span>      friendLikes={</span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l</span><span> </span><span>=&gt;</span><span> ({</span></span>
<span data-line=""><span>        </span><span>firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line=""><span>        </span><span>avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line=""><span>      }))}</span></span>
<span data-line="" data-highlighted-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>As <a href="#sdui">we know</a> from earlier, we can represent this JSX as a tree of JSON. In fact, it’s almost like the original JSON, but now it specifies the receiving component:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  type: </span><span>"</span><span>LikeButton</span><span>"</span><span>,</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line=""><span>    isLikedByUser: </span><span>false</span><span>,</span></span>
<span data-line=""><span>    friendLikes: </span><span>[{</span></span>
<span data-line=""><span>      firstName</span><span>:</span><span> </span><span>'</span><span>Alice</span><span>'</span><span>,</span></span>
<span data-line=""><span>      avatar</span><span>:</span><span> </span><span>'</span><span>https://example.com/alice.jpg</span><span>'</span></span>
<span data-line=""><span>    </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>      firstName</span><span>:</span><span> </span><span>'</span><span>Bob</span><span>'</span><span>,</span></span>
<span data-line=""><span>      avatar</span><span>:</span><span> </span><span>'</span><span>https://example.com/bob.jpg</span><span>'</span></span>
<span data-line=""><span>    </span><span>}]</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Then React on the client would <em>know</em> to pass these props to the <code>LikeButton</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line=""><span>  friendLikes</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>And so we’ve finally stitched the ViewModel and its component together!</p>
<p>We’ve tied the code <em>generating</em> the props with the code <em>consuming</em> those props. Now our ViewModel and our component are a Ctrl+Click away from each other. Since JSX expressions are typechecked, we also get full typechecking for free.</p>
<p>Have a look at the complete picture:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line="" data-highlighted-line=""><span>      totalLikeCount={</span><span>post</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>      isLikedByUser={</span><span>post</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>      friendLikes={</span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l</span><span> </span><span>=&gt;</span><span> ({</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      }))}</span></span>
<span data-line="" data-highlighted-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  friendLikes</span></span>
<span data-line="" data-highlighted-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>let </span><span>buttonText</span><span> </span><span>=</span><span> </span><span>'</span><span>Like</span><span>'</span><span>;</span></span>
<span data-line=""><span>  </span><span>if</span><span> </span><span>(</span><span>totalLikeCount </span><span>&gt;</span><span> </span><span>0</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>// e.g. "Liked by You, Alice, and 13 others"</span></span>
<span data-line=""><span>    buttonText </span><span>=</span><span> </span><span>formatLikeText</span><span>(</span><span>totalLikeCount</span><span>,</span><span> isLikedByUser</span><span>,</span><span> friendLikes</span><span>);</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>button</span><span> className={</span><span>isLikedByUser</span><span> ? </span><span>'</span><span>liked</span><span>'</span><span> : </span><span>''</span><span>}&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>buttonText</span><span>}</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Our ViewModel is just like an <a href="#async-xhp">Async XHP</a> tag, passing some information to our own <code>&lt;LikeButton&gt;</code> primitive that lives on client (just like in <a href="#sdui">SDUI</a>). Together, they represent a self-contained piece of UI that knows how to load its own data.</p>
<p>Let’s do this again with another ViewModel.</p>
<hr>
<h3 id="lets-do-this-again"><a target="_self" href="#lets-do-this-again">Let’s Do This Again</a></h3>
<p>Now let’s revisit the <code>PostDetailsViewModel</code> from <a href="#composing-viewmodels">this section</a>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>postLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>LikeButtonViewModel</span><span>({</span><span> postId</span><span>,</span><span> includeAvatars </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>{</span></span>
<span data-line=""><span>    postTitle</span><span>:</span><span> </span><span>post</span><span>.</span><span>title</span><span>,</span></span>
<span data-line=""><span>    postContent</span><span>:</span><span> </span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>,</span><span> </span><span>{</span></span>
<span data-line=""><span>      maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line=""><span>    </span><span>}),</span></span>
<span data-line=""><span>    postAuthor</span><span>:</span><span> </span><span>post</span><span>.</span><span>author</span><span>,</span></span>
<span data-line=""><span>    postLikes</span></span>
<span data-line=""><span>  </span><span>};</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>We’ve never explicitly written it down, but suppose that there was a matching <code>PostDetails</code> component that can take that JSON and actually render the post:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>PostDetails</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>,</span></span>
<span data-line=""><span>  postLikes</span><span>,</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Let’s connect them together.</p>
<p>First, let’s change <code>PostDetailsViewModel</code> to return a <code>PostDetails</code> <em>tag:</em></p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>postLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>    </span><span>LikeButtonViewModel</span><span>({</span><span> postId</span><span>,</span><span> includeAvatars </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>&lt;</span><span>PostDetails</span></span>
<span data-line=""><span>      postTitle={</span><span>post</span><span>.</span><span>title</span><span>}</span></span>
<span data-line=""><span>      postContent={</span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>, {</span></span>
<span data-line=""><span>        </span><span>maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line=""><span>      </span><span>})}</span></span>
<span data-line=""><span>      postAuthor={</span><span>post</span><span>.</span><span>author</span><span>}</span></span>
<span data-line=""><span>      postLikes={</span><span>postLikes</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Now the JSON it returns will be wrapped into a <code>PostDetails</code> JSX element:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  type: </span><span>"</span><span>PostDetails</span><span>"</span><span>,</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    postTitle: </span><span>"</span><span>JSX Over The Wire</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postAuthor: </span><span>"</span><span>Dan</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postContent: </span><span>"</span><span>Suppose you have an API route that returns some data as JSON.</span><span>"</span><span>,</span></span>
<span data-line=""><span>    postLikes: </span><span>{</span></span>
<span data-line=""><span>      type: </span><span>"</span><span>LikeButton</span><span>"</span><span>,</span></span>
<span data-line=""><span>      props: </span><span>{</span></span>
<span data-line=""><span>        totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line=""><span>        isLikedByUser: </span><span>false</span><span>,</span></span>
<span data-line=""><span>        friendLikes: </span><span>[{</span></span>
<span data-line=""><span>          firstName</span><span>:</span><span> </span><span>"</span><span>Alice</span><span>"</span></span>
<span data-line=""><span>        </span><span>},</span><span> </span><span>{</span></span>
<span data-line=""><span>          firstName</span><span>:</span><span> </span><span>"</span><span>Bob</span><span>"</span></span>
<span data-line=""><span>        </span><span>}]</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>On the client, React will take these props and pass them to <code>PostDetails</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>PostDetails</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>,</span></span>
<span data-line=""><span>  postLikes</span><span>,</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>article</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>h1</span><span>&gt;{</span><span>postTitle</span><span>}&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>div</span><span> dangerouslySetInnerHTML={{ </span><span>__html</span><span>:</span><span> postContent </span><span>}} /&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>p</span><span>&gt;</span><span>by </span><span>{</span><span>postAuthor</span><span>.</span><span>name</span><span>}&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>section</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>{</span><span>postLikes</span><span>}</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>section</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>article</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>And that connects the ViewModel with its component!</p>
<hr>
<h3 id="composing-viewmodels-revisited"><a target="_self" href="#composing-viewmodels-revisited">Composing ViewModels, Revisited</a></h3>
<p>Notice how <code>postLikes</code> in the last example is rendered directly into UI:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>section</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>{</span><span>postLikes</span><span>}</span></span>
<span data-line=""><span>&lt;/</span><span>section</span><span>&gt;</span></span></code></pre></div>
<p>We can do this because it’s the <code>&lt;LikeButton&gt;</code> with its props already preconfigured by <code>LikeButtonViewModel</code>. It was right here in the JSON:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>"</span><span>PostDetails</span><span>"</span><span>,</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line=""><span>    postLikes: </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      type: </span><span>"</span><span>LikeButton</span><span>"</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      props: </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>        totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>// ...</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>You might recall that we obtained it by calling <code>LikeButtonViewModel</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>post</span><span>,</span><span> </span><span>postLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>    </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>LikeButtonViewModel</span><span>({</span><span> postId</span><span>,</span><span> includeAvatars </span><span>}),</span></span>
<span data-line=""><span>  </span><span>]);</span></span>
<span data-line=""><span>  </span><span>// ...</span></span></code></pre></div>
<p>However, having ViewModels manually call other ViewModels inside <code>Promise.all</code> quickly gets very tedious. So we’ll adopt a new convention. Let’s assume that a ViewModel can embed <em>another</em> ViewModel by returning a JSX tag.</p>
<p>This will let us clean up the code quite a bit:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>const </span><span>post</span><span> </span><span>=</span><span> await </span><span>getPost</span><span>(</span><span>postId</span><span>);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>PostDetails</span></span>
<span data-line=""><span>      postTitle={</span><span>post</span><span>.</span><span>title</span><span>}</span></span>
<span data-line=""><span>      postContent={</span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>, {</span></span>
<span data-line=""><span>        </span><span>maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line=""><span>      </span><span>})}</span></span>
<span data-line=""><span>      postAuthor={</span><span>post</span><span>.</span><span>author</span><span>}</span></span>
<span data-line=""><span>      postLikes={</span></span>
<span data-line="" data-highlighted-line=""><span>        &lt;</span><span>LikeButtonViewModel</span></span>
<span data-line="" data-highlighted-line=""><span>          postId={</span><span>postId</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>          includeAvatars={</span><span>includeAvatars</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>        /&gt;</span></span>
<span data-line=""><span>      }</span><span>}</span></span>
<span data-line=""><span>    /&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>After this change, calling <code>PostDetailsViewModel</code> will return “unfinished” JSON:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>"</span><span>PostDetails</span><span>"</span><span>,</span><span> </span><span>// ✅ This is a component on the client</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    postTitle: </span><span>"</span><span>JSX Over The Wire</span><span>"</span><span>,</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line="" data-highlighted-line=""><span>    postLikes: </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      type: LikeButtonViewModel</span><span>,</span><span> </span><span>// 🟡 We haven't run this ViewModel yet</span></span>
<span data-line="" data-highlighted-line=""><span>      props: </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>        postId: </span><span>"</span><span>jsx-over-the-wire</span><span>"</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        includeAvatars: </span><span>false</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>The code responsible for sending JSON to the client will see that it’s a ViewModel (so it still needs to run!), and will call <code>LikeButtonViewModel</code> to get more JSON:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>"</span><span>PostDetails</span><span>"</span><span>,</span><span> </span><span>// ✅ This is a component on the client</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    postTitle: </span><span>"</span><span>JSX Over The Wire</span><span>"</span><span>,</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line="" data-highlighted-line=""><span>    postLikes: </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>      type: </span><span>"</span><span>LikeButton</span><span>"</span><span>,</span><span> </span><span>// ✅ This is a component on the client</span></span>
<span data-line="" data-highlighted-line=""><span>      props: </span><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>        totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>// ...</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>ViewModels will get recursively unfolded as they each contribute their part of the JSON. This might remind you of how <a href="#php-and-xhp">XHP tags can recursively render other XHP tags</a>. The final JSON will be turned on the client into a React component tree.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>&lt;</span><span>PostDetails</span></span>
<span data-line=""><span>  postTitle=</span><span>"</span><span>JSX Over The Wire</span><span>"</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>&gt;</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line=""><span>    totalLikeCount={</span><span>8</span><span>}</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line=""><span>  /&gt;</span></span>
<span data-line=""><span>&lt;/</span><span>PostDetails</span><span>&gt;</span></span></code></pre></div>
<hr>
<h3 id="the-data-always-flows-down"><a target="_self" href="#the-data-always-flows-down">The Data Always Flows Down</a></h3>
<p>To make the JSX look slightly nicer, we can also rename <code>postLikes</code> to <code>children</code>. This will let us nest <code>LikeButtonViewModel</code> as a JSX child of <code>PostDetails</code>.</p>
<p>Here’s the entire code so far. Notice how the data flows down:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>post</span><span> </span><span>=</span><span> await </span><span>getPost</span><span>(</span><span>postId</span><span>);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>PostDetails</span></span>
<span data-line=""><span>      postTitle={</span><span>post</span><span>.</span><span>title</span><span>}</span></span>
<span data-line=""><span>      postContent={</span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>, {</span></span>
<span data-line=""><span>        </span><span>maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line=""><span>      </span><span>})}</span></span>
<span data-line=""><span>      postAuthor={</span><span>post</span><span>.</span><span>author</span><span>}</span></span>
<span data-line=""><span>    &gt;</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>&lt;</span><span>LikeButtonViewModel</span></span>
<span data-line="" data-highlighted-line=""><span>        postId={</span><span>postId</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>        includeAvatars={</span><span>includeAvatars</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>      /&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>PostDetails</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>  </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>  </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>]);</span></span>
<span data-line=""><span>return</span><span> </span><span>(</span></span>
<span data-line="" data-highlighted-line=""><span>  </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line="" data-highlighted-line=""><span>    totalLikeCount={</span><span>post</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    isLikedByUser={</span><span>post</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    friendLikes={</span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l</span><span> </span><span>=&gt;</span><span> ({</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>      </span><span>avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>    }))}</span></span>
<span data-line=""><span>  /&gt;</span></span>
<span data-line=""><span>);</span></span></code></pre></div>
<p>All of the server logic above will execute while generating the JSON. This includes both <code>getPost</code>, <code>parseMarkdown</code>, and <code>getFriendLikes</code>. The response will contain the data <em>for the entire screen</em>, satisfying one of our <a href="#dans-async-ui-framework-checklist">key requirements</a>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line=""><span>  type: </span><span>"</span><span>PostDetails</span><span>"</span><span>,</span><span> </span><span>// ✅ This is a component on the client</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    postTitle: </span><span>"</span><span>JSX Over The Wire</span><span>"</span><span>,</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line=""><span>    postLikes: </span><span>{</span></span>
<span data-line=""><span>      type: </span><span>"</span><span>LikeButton</span><span>"</span><span>,</span><span> </span><span>// ✅ This is a component on the client</span></span>
<span data-line=""><span>      props: </span><span>{</span></span>
<span data-line=""><span>        totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line=""><span>        </span><span>// ...</span></span>
<span data-line=""><span>      </span><span>}</span></span>
<span data-line=""><span>    </span><span>}</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>From the client’s perspective, everything will appear precomputed:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>PostDetails</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>,</span></span>
<span data-line="" data-highlighted-line=""><span>  children</span><span>,</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>article</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>h1</span><span>&gt;{</span><span>postTitle</span><span>}&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>div</span><span> dangerouslySetInnerHTML={{ </span><span>__html</span><span>:</span><span> postContent </span><span>}} /&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>p</span><span>&gt;</span><span>by </span><span>{</span><span>postAuthor</span><span>.</span><span>name</span><span>}&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>section</span><span>&gt;</span></span>
<span data-line="" data-highlighted-line=""><span>        </span><span>{</span><span>children</span><span>}</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>section</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>article</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{ totalLikeCount</span><span>,</span><span> isLikedByUser</span><span>,</span><span> friendLikes }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>// ...</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>In particular, by the time <code>PostDetails</code> runs, the <code>children</code> it receives will be the <code>&lt;LikeButton&gt;</code> tag itself with predefined props. The ViewModels configure the props for the client. <strong>This is why on the client, all the props are “already there”.</strong></p>
<p>Spend some time with the code above and make sure it sinks in.</p>
<p>Yes, this <em>is</em> weird.</p>
<p>It is also glorious.</p>
<p>What we found is a way to compose tags across client-server boundaries where the server parts can be freely wrapped in the client parts, the client parts can be freely wrapped in the server parts, and not only do they <em>just work</em>—we’re also performing the data loading for all of the server parts in <em>a single roundtrip.</em></p>
<p>In fact, this approach satisfies every point on <a href="#dans-async-ui-framework-checklist">my checklist.</a></p>
<p>Now let’s tidy it up and clean up some loose ends.</p>
<hr>
<h3 id="a-router-viewmodel"><a target="_self" href="#a-router-viewmodel">A Router ViewModel</a></h3>
<p>As we refactor our ViewModels to use JSX (for the JSX-sceptical readers—the point here isn’t just the syntax, although the syntax is nice—but <a href="https://overreacted.io/react-as-a-ui-runtime/#lazy-evaluation">lazy evaluation</a>), we might realize that we don’t actually need separate Express routes for every screen.</p>
<p>Instead, we might want to do something like this:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>app</span><span>.</span><span>get</span><span>(</span><span>'</span><span>/*</span><span>'</span><span>,</span><span> </span><span>async</span><span> </span><span>(</span><span>req</span><span>,</span><span> res</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>url</span><span> </span><span>=</span><span> req</span><span>.</span><span>url</span></span>
<span data-line=""><span>  </span><span>const </span><span>json</span><span> </span><span>=</span><span> await </span><span>toJSON</span><span>(&lt;</span><span>RouterViewModel</span><span> url={</span><span>url</span><span>} /&gt;);</span><span> </span><span>// Evaluate JSX</span></span>
<span data-line=""><span>  </span><span>res</span><span>.</span><span>json</span><span>(</span><span>json</span><span>);</span></span>
<span data-line=""><span>});</span></span></code></pre></div>
<p>Then we’d have a Router ViewModel that matches screens to routes:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>RouterViewModel</span><span>(</span><span>{ url }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>let </span><span>route</span><span>;</span></span>
<span data-line=""><span>  </span><span>if</span><span> </span><span>(</span><span>matchRoute</span><span>(</span><span>url</span><span>,</span><span> </span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>))</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>const {</span><span>postId</span><span>} </span><span>=</span><span> </span><span>parseRoute</span><span>(</span><span>url</span><span>,</span><span> </span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>);</span></span>
<span data-line=""><span>    route </span><span>=</span><span> </span><span>&lt;</span><span>PostDetailsRouteViewModel</span><span> postId={</span><span>postId</span><span>} /&gt;;</span></span>
<span data-line=""><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>matchRoute</span><span>(</span><span>url</span><span>,</span><span> </span><span>'</span><span>/screen/post-list</span><span>'</span><span>))</span><span> </span><span>{</span></span>
<span data-line=""><span>    route </span><span>=</span><span> </span><span>&lt;</span><span>PostDetailsRouteViewModel</span><span> /&gt;;</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>  </span><span>return</span><span> route</span><span>;</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>And then each route would also be a ViewModel:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsRouteViewModel</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>&lt;</span><span>PostDetailsViewModel</span><span> postId={</span><span>postId</span><span>} /&gt;</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostListRouteViewModel</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>postId </span><span>=&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>PostDetailsViewModel</span><span> key={</span><span>postId</span><span>} postId={</span><span>postId</span><span>} /&gt;</span></span>
<span data-line=""><span>      </span><span>)}</span></span>
<span data-line=""><span>    </span><span>&lt;/&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>On the server, it’s ViewModels all the way down.</p>
<p>This might seem superfluous at this point. But moving the routing logic <em>into</em> the ViewModel world would let <code>RouterViewModel</code> wrap its output into a client-side <code>&lt;Router&gt;</code> that could re-request the JSON when you navigate to another screen.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>RouterViewModel</span><span>(</span><span>{ url }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>let </span><span>route</span><span>;</span></span>
<span data-line=""><span>  </span><span>if</span><span> </span><span>(</span><span>matchRoute</span><span>(</span><span>url</span><span>,</span><span> </span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>))</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>const {</span><span>postId</span><span>} </span><span>=</span><span> </span><span>parseRoute</span><span>(</span><span>url</span><span>,</span><span> </span><span>'</span><span>/screen/post-details/:postId</span><span>'</span><span>);</span></span>
<span data-line=""><span>    route </span><span>=</span><span> </span><span>&lt;</span><span>PostDetailsRouteViewModel</span><span> postId={</span><span>postId</span><span>} /&gt;;</span></span>
<span data-line=""><span>  </span><span>}</span><span> </span><span>else</span><span> </span><span>if</span><span> </span><span>(</span><span>matchRoute</span><span>(</span><span>url</span><span>,</span><span> </span><span>'</span><span>/screen/post-list</span><span>'</span><span>))</span><span> </span><span>{</span></span>
<span data-line=""><span>    route </span><span>=</span><span> </span><span>&lt;</span><span>PostDetailsRouteViewModel</span><span> /&gt;;</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>&lt;</span><span>Router</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>route</span><span>}</span></span>
<span data-line="" data-highlighted-line=""><span>    </span><span>&lt;/</span><span>Router</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>function</span><span> </span><span>Router</span><span>(</span><span>{ children }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const [</span><span>tree</span><span>,</span><span> </span><span>setTree</span><span>] </span><span>=</span><span> </span><span>useState</span><span>(</span><span>children</span><span>);</span></span>
<span data-line=""><span>  </span><span>// ... maybe add some logic here later ...</span></span>
<span data-line=""><span>  </span><span>return</span><span> tree</span><span>;</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>This could also let us—if we wanted to—implement a more granular router that can split the path into segments, prepare the ViewModels for each segment in parallel when it receives a request, and even re-request individual segments on navigation. This way, we would no longer have to re-request the entire page whenever we need to go to another screen. Of course, we wouldn’t want to implement this kind of logic <em>within</em> the app. Ideally, a framework would do this.</p>
<hr>
<h3 id="server-and-client-components"><a target="_self" href="#server-and-client-components">Server and Client Components</a></h3>
<p>We can drop the pretense now—we’re describing React Server Components:</p>
<ul>
<li>Our “ViewModels” are Server Components.</li>
<li>Our “Components” are Client Components.</li>
</ul>
<p>There are good reasons to call both of them Components. Although in the first part of this post, Server Components <a href="#composable-bff">began their journey as ViewModels</a>, their lineage can be equally convincingly traced back to <a href="#async-xhp">Async XHP tags</a>. Since they no longer have to return JSON objects, and because in practice you’ll often import the same components from both “sides”, it makes sense to say Components. (In fact, in my incomplete example, all Client Components could be moved to the Server.)</p>
<p>In this post, we haven’t discussed the actual mechanism “connecting” the module systems of Server and Client worlds. This will be a topic for another post, but in short, when you <code>import</code> something from a module with <code>'use client'</code>, you don’t get the real thing—you just get a <em>reference</em> which describes <em>how to load</em> it.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>import</span><span> </span><span>{</span><span> LikeButton </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>./LikeButton</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span>console</span><span>.</span><span>log</span><span>(</span><span>LikeButton</span><span>);</span></span>
<span data-line="" data-highlighted-line=""><span>// "src/LikeButton.js#LikeButton"</span></span>
<span data-line=""> </span>
<span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>LikeButtonViewModel</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>  </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>  </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>]);</span></span>
<span data-line=""><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line=""><span>    totalLikeCount={</span><span>post</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line=""><span>    isLikedByUser={</span><span>post</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line=""><span>    friendLikes={</span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l</span><span> </span><span>=&gt;</span><span> ({</span></span>
<span data-line=""><span>      </span><span>firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line=""><span>      </span><span>avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line=""><span>    }))}</span></span>
<span data-line=""><span>  /&gt;</span></span>
<span data-line=""><span>);</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line="" data-highlighted-line=""><span>'</span><span>use client</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line="" data-highlighted-line=""><span>export</span><span> </span><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line=""><span>  friendLikes</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>let </span><span>buttonText</span><span> </span><span>=</span><span> </span><span>'</span><span>Like</span><span>'</span><span>;</span></span>
<span data-line=""><span>  </span><span>if</span><span> </span><span>(</span><span>totalLikeCount </span><span>&gt;</span><span> </span><span>0</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>    </span><span>// e.g. "Liked by You, Alice, and 13 others"</span></span>
<span data-line=""><span>    buttonText </span><span>=</span><span> </span><span>formatLikeText</span><span>(</span><span>totalLikeCount</span><span>,</span><span> isLikedByUser</span><span>,</span><span> friendLikes</span><span>);</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>button</span><span> className={</span><span>isLikedByUser</span><span> ? </span><span>'</span><span>liked</span><span>'</span><span> : </span><span>''</span><span>}&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>buttonText</span><span>}</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>So the generated JSON will contain an instruction for loading the <code>LikeButton</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>{</span></span>
<span data-line="" data-highlighted-line=""><span>  type: </span><span>"</span><span>src/LikeButton.js#LikeButton</span><span>"</span><span>,</span><span> </span><span>// ✅ This is a Client Component</span></span>
<span data-line=""><span>  props: </span><span>{</span></span>
<span data-line=""><span>    totalLikeCount: </span><span>8</span><span>,</span></span>
<span data-line=""><span>    </span><span>// ...</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>React will read that instruction and load it as a <code>&lt;script&gt;</code> tag (or read it from the bundler cache). The format is bundler-specific, which explains why React Server Components requires a bundler integration. (<a target="_blank" href="https://parceljs.org/recipes/rsc/">Parcel just released theirs</a> which isn’t tied to a framework, so it’s perfect if you want to play with how RSC works.)</p>
<p>It’s important that React Server Components emit JSON rather than HTML:</p>
<ul>
<li>Server tree can be refetched in-place without losing state. (React will just do its “virtual DOM” thing, i.e. apply the new props to the already existing components.)</li>
<li>You can target other platforms than web. (Here’s a <a target="_blank" href="https://www.youtube.com/watch?v=djhEgxQf3Kw">cool demo</a>.)</li>
<li>You can still turn that JSON into HTML by executing all the Client Components within it! That’s not <em>required</em> by RSC, but it is definitely doable. That’s why “Client” components may run on the “server”—to output HTML, you’d run both “sides”.</li>
</ul>
<p>To conclude this post, I’ll say the following. I know that React Server Components have not been everyone’s cup of tea. It twists your brain but I think it twists it in a good way. I’ll be posting more about why I’m excited about RSC and will try to distill some of these explanations into shorter posts. But in the meantime, I hope that this post provided some historical background on the <em>motivation</em> behind RSC, <a href="#dans-async-ui-framework-checklist">what it can do</a>, as well as how you could arrive at RSC through your own thinking.</p>
<p>(By the way, if you enjoy more philosophical and whimsical longreads, check out my <a href="https://overreacted.io/react-for-two-computers/">last post</a> which arrives at RSC from the first principles without any history.)</p>
<hr>
<h3 id="recap-jsx-over-the-wire"><a target="_self" href="#recap-jsx-over-the-wire">Recap: JSX Over The Wire</a></h3>
<ul>
<li>React Server Components solve the <a href="#recap-json-as-components">problems outlined in the first part</a> by using <a href="#recap-components-as-json">techniques outlined in the second part</a>. In particular, they let you “componentize” the UI-specific parts of your API and ensure they evolve together with your UI.</li>
<li>This means that there is a direct connection between your components and the server code that prepares their props. You can always “Find All References” to find from where on the server the data is flowing into each of your components.</li>
<li>Because React Server Components emit JSON, they don’t “blow away” the state of the page on refetches. Your components can receive fresh props from the server.</li>
<li>React Server Components emit JSON, but that JSON can <em>also</em> be (optionally) turned to HTML for first render. It’s easy to make HTML out of JSON, but not the inverse.</li>
<li>React Server Components let you create self-contained pieces of UI that take care of preparing their own server data. However, all this preparation occurs within a single roundtrip. Although your code is modular, their execution is coalesced.</li>
<li>RSC is mindbending, I won’t lie. Sometimes you have to think inside-out. But personally, I think RSC is awesome. The tooling is still evolving but I’m excited for its future. I hope to see more technologies thoughtfully blending the boundaries.</li>
</ul>
<hr>
<h3 id="final-code-slightly-edited"><a target="_self" href="#final-code-slightly-edited">Final Code, Slightly Edited</a></h3>
<p>While this isn’t a <em>runnable</em> application (I bet <em>you</em> could get there with <a target="_blank" href="https://nextjs.org/">Next</a> or <a target="_blank" href="https://parceljs.org/recipes/rsc/">Parcel</a>) and might contain mistakes, here’s the complete code example. I’ve done a few renames to drop the “ViewModel” terminology so it looks more idiomatic.</p>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>import</span><span> </span><span>{</span><span> PostDetails</span><span>,</span><span> LikeButton </span><span>}</span><span> </span><span>from</span><span> </span><span>'</span><span>./client</span><span>'</span><span>;</span></span>
<span data-line=""> </span>
<span data-line=""><span>export</span><span> </span><span>async</span><span> </span><span>function</span><span> </span><span>PostDetailsRoute</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>&lt;</span><span>Post</span><span> postId={</span><span>postId</span><span>} /&gt;</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>export</span><span> </span><span>async</span><span> </span><span>function</span><span> </span><span>PostListRoute</span><span>(</span><span>{ postId }</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>postIds</span><span> </span><span>=</span><span> await </span><span>getRecentPostIds</span><span>();</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>postIds</span><span>.</span><span>map</span><span>(</span><span>postId </span><span>=&gt;</span></span>
<span data-line=""><span>        </span><span>&lt;</span><span>Post</span><span> key={</span><span>postId</span><span>} postId={</span><span>postId</span><span>} /&gt;</span></span>
<span data-line=""><span>      </span><span>)}</span></span>
<span data-line=""><span>    </span><span>&lt;/&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>Post</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  truncateContent</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>const </span><span>post</span><span> </span><span>=</span><span> await </span><span>getPost</span><span>(</span><span>postId</span><span>);</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>PostLayout</span></span>
<span data-line=""><span>      postTitle={</span><span>post</span><span>.</span><span>title</span><span>}</span></span>
<span data-line=""><span>      postContent={</span><span>parseMarkdown</span><span>(</span><span>post</span><span>.</span><span>content</span><span>, {</span></span>
<span data-line=""><span>        </span><span>maxParagraphs</span><span>:</span><span> truncateContent </span><span>?</span><span> </span><span>1</span><span> </span><span>:</span><span> </span><span>undefined</span></span>
<span data-line=""><span>      </span><span>})}</span></span>
<span data-line=""><span>      postAuthor={</span><span>post</span><span>.</span><span>author</span><span>}</span></span>
<span data-line=""><span>    &gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>PostLikeButton</span></span>
<span data-line=""><span>        postId={</span><span>postId</span><span>}</span></span>
<span data-line=""><span>        includeAvatars={</span><span>includeAvatars</span><span>}</span></span>
<span data-line=""><span>      /&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>PostLayout</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>async</span><span> </span><span>function</span><span> </span><span>PostLikeButton</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postId</span><span>,</span></span>
<span data-line=""><span>  includeAvatars</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>const [</span><span>post</span><span>,</span><span> </span><span>friendLikes</span><span>] </span><span>=</span><span> await </span><span>Promise</span><span>.</span><span>all</span><span>([</span></span>
<span data-line=""><span>  </span><span>getPost</span><span>(</span><span>postId</span><span>),</span></span>
<span data-line=""><span>  </span><span>getFriendLikes</span><span>(</span><span>postId</span><span>,</span><span> </span><span>{</span><span> limit</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>5</span><span> </span><span>:</span><span> </span><span>2</span><span> </span><span>}),</span></span>
<span data-line=""><span>]);</span></span>
<span data-line=""><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>  </span><span>&lt;</span><span>LikeButton</span></span>
<span data-line=""><span>    totalLikeCount={</span><span>post</span><span>.</span><span>totalLikeCount</span><span>}</span></span>
<span data-line=""><span>    isLikedByUser={</span><span>post</span><span>.</span><span>isLikedByUser</span><span>}</span></span>
<span data-line=""><span>    friendLikes={</span><span>friendLikes</span><span>.</span><span>likes</span><span>.</span><span>map</span><span>(</span><span>l</span><span> </span><span>=&gt;</span><span> ({</span></span>
<span data-line=""><span>      </span><span>firstName</span><span>:</span><span> </span><span>l</span><span>.</span><span>firstName</span><span>,</span></span>
<span data-line=""><span>      </span><span>avatar</span><span>:</span><span> includeAvatars </span><span>?</span><span> </span><span>l</span><span>.</span><span>avatar </span><span>:</span><span> </span><span>null</span><span>,</span></span>
<span data-line=""><span>    }))}</span></span>
<span data-line=""><span>  /&gt;</span></span>
<span data-line=""><span>);</span></span></code></pre></div>
<div data-rehype-pretty-code-fragment=""><pre tabindex="0" data-language="js" data-theme="default"><code data-language="js" data-theme="default"><span data-line=""><span>export</span><span> </span><span>function</span><span> </span><span>PostLayout</span><span>(</span><span>{</span></span>
<span data-line=""><span>  postTitle</span><span>,</span></span>
<span data-line=""><span>  postContent</span><span>,</span></span>
<span data-line=""><span>  postAuthor</span><span>,</span></span>
<span data-line=""><span>  children</span><span>,</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>article</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>h1</span><span>&gt;{</span><span>postTitle</span><span>}&lt;/</span><span>h1</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>div</span><span> dangerouslySetInnerHTML={{ </span><span>__html</span><span>:</span><span> postContent </span><span>}} /&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>p</span><span>&gt;</span><span>by </span><span>{</span><span>postAuthor</span><span>.</span><span>name</span><span>}&lt;/</span><span>p</span><span>&gt;</span></span>
<span data-line=""><span>      </span><span>&lt;</span><span>section</span><span>&gt;</span></span>
<span data-line=""><span>        </span><span>{</span><span>children</span><span>}</span></span>
<span data-line=""><span>      </span><span>&lt;/</span><span>section</span><span>&gt;</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>article</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""><span>export</span><span> </span><span>function</span><span> </span><span>LikeButton</span><span>(</span><span>{</span></span>
<span data-line=""><span>  totalLikeCount</span><span>,</span></span>
<span data-line=""><span>  isLikedByUser</span><span>,</span></span>
<span data-line=""><span>  friendLikes</span></span>
<span data-line=""><span>}</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>  </span><span>let </span><span>buttonText</span><span> </span><span>=</span><span> </span><span>'</span><span>Like</span><span>'</span><span>;</span></span>
<span data-line=""><span>  </span><span>if</span><span> </span><span>(</span><span>totalLikeCount </span><span>&gt;</span><span> </span><span>0</span><span>)</span><span> </span><span>{</span></span>
<span data-line=""><span>    buttonText </span><span>=</span><span> </span><span>formatLikeText</span><span>(</span><span>totalLikeCount</span><span>,</span><span> isLikedByUser</span><span>,</span><span> friendLikes</span><span>);</span></span>
<span data-line=""><span>  </span><span>}</span></span>
<span data-line=""><span>  </span><span>return</span><span> </span><span>(</span></span>
<span data-line=""><span>    </span><span>&lt;</span><span>button</span><span> className={</span><span>isLikedByUser</span><span> ? </span><span>'</span><span>liked</span><span>'</span><span> : </span><span>''</span><span>}&gt;</span></span>
<span data-line=""><span>      </span><span>{</span><span>buttonText</span><span>}</span></span>
<span data-line=""><span>    </span><span>&lt;/</span><span>button</span><span>&gt;</span></span>
<span data-line=""><span>  </span><span>);</span></span>
<span data-line=""><span>}</span></span></code></pre></div>
<p>Happy stitching!</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[TLS certificate lifetimes will officially reduce to 47 days (109 pts)]]></title>
            <link>https://www.digicert.com/blog/tls-certificate-lifetimes-will-officially-reduce-to-47-days</link>
            <guid>43693900</guid>
            <pubDate>Tue, 15 Apr 2025 15:09:22 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.digicert.com/blog/tls-certificate-lifetimes-will-officially-reduce-to-47-days">https://www.digicert.com/blog/tls-certificate-lifetimes-will-officially-reduce-to-47-days</a>, See on <a href="https://news.ycombinator.com/item?id=43693900">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
	 	  
	 	  
	 	  <p><img src="https://www.digicert.com/content/dam/digicert/images/about/blog/blog-article/47-day-blog-hero.png">
	 	  </p>	  
	 </div><div>
	    <p>The CA/Browser Forum has officially <a href="https://groups.google.com/a/groups.cabforum.org/g/servercert-wg/c/bvWh5RN6tYI" target="_blank">voted to amend the TLS Baseline Requirements</a> to set a schedule for shortening both the lifetime of TLS certificates and the reusability of CA-validated information in certificates. The first user impacts of the ballot take place in March 2026.</p>
<p>The ballot was long debated in the <a href="https://www.digicert.com/faq/compliance/what-is-the-certification-authority-browser-forum">CA/Browser Forum</a> and went through several versions, incorporating feedback from <a href="https://www.digicert.com/blog/what-is-a-certificate-authority">certificate authorities</a> and their customers. The voting period ended on April 11, 2025, closing one hotly contested chapter and allowing the certificate world to plan for what comes next.</p>
<h4><span>The new TLS certificate lifetime schedule</span></h4>
<p>The new ballot targets certificate validity of 47 days, making automation essential. Prior to this <a href="https://www.digicert.com/blog/new-certificate-lifetime-proposed-by-apple">proposal by Apple</a>, Google promoted a 90-day maximum lifetime, but they voted in favor of Apple’s proposal almost immediately after the voting period began.</p>
<p>Here’s the schedule:</p>
<ul>
<li><p>The maximum certificate lifetime is going down:</p>
<ul>
<li>From today until March 15, 2026, the maximum lifetime for a <a href="https://www.digicert.com/tls-ssl/tls-ssl-certificates">TLS certificate</a> is 398 days.</li>
<li>As of March 15, 2026, the maximum lifetime for a TLS certificate will be 200 days.</li>
<li>As of March 15, 2027, the maximum lifetime for a TLS certificate will be 100 days.</li>
<li>As of March 15, 2029, the maximum lifetime for a TLS certificate will be 47 days.</li>
</ul>

</li>
<li><p>The maximum period during which domain and <a href="https://www.digicert.com/faq/dns/what-is-my-ip-address">IP address</a> validation information may be reused is going down:</p>
<ul>
<li>From today until March 15, 2026, the maximum period during which domain validation information may be reused is 398 days.</li>
<li>As of March 15, 2026, the maximum period during which domain validation information may be reused is 200 days.</li>
<li>As of March 15, 2027, the maximum period during which domain validation information may be reused is 100 days.</li>
<li>As of March 15, 2029, the maximum period during which domain validation information may be reused is 10 days.</li>
</ul>
</li>
<li><p>As of March 15, 2026, validations of Subject Identity Information (SII) can only be reused for 398 days, down from 825. SII is the company name and other information found in an <a href="https://www.digicert.com/difference-between-dv-ov-and-ev-ssl-certificates">OV (Organization Validated) or EV (Extended Validation) certificate</a>, i.e., everything but the domain name or IP address protected by the certificate. This does not affect DV (Domain Validated) certificates, which have no SII.</p>

</li>
</ul>

	    
	</div><div>
	    <h4><span>Why 47 Days?</span></h4>
<p>47 days might seem like an arbitrary number, but it’s a simple cascade:</p>
<ul>
<li>200 days = 6 maximal month (184 days) + 1/2 30-day month (15 days) + 1 day wiggle room</li>
<li>100 days = 3 maximal month (92 days) + ~1/4 30-day month (7 days) + 1 day wiggle room</li>
<li>47 days = 1 maximal month (31 days) + 1/2 30-day month (15 days) + 1 day wiggle room</li>
</ul>
<h4><span>Apple’s justification for the change</span></h4>
<p>In the ballot, Apple makes many arguments in favor of the moves, one of which is most worth calling out. They state that the CA/B Forum has been telling the world for years, by steadily shortening maximum lifetimes, that automation is essentially mandatory for effective <a href="https://www.digicert.com/tls-ssl/certcentral-tls-ssl-manager">certificate lifecycle</a> management.</p>
<p>The ballot argues that shorter lifetimes are necessary for many reasons, the most prominent being this: The information in certificates is becoming steadily less trustworthy over time, a problem that can only be mitigated by frequently revalidating the information.</p>
<p>The ballot also argues that the revocation system using CRLs and OCSP is unreliable. Indeed, browsers often ignore these features. The ballot has a long section on the failings of the certificate revocation system. Shorter lifetimes mitigate the effects of using potentially revoked certificates. In 2023, CA/B Forum took this philosophy to another level by approving short-lived certificates, which expire within 7 days, and which do not require CRL or OCSP support.</p>
<h4><span>Clearing up confusion about the new rules</span></h4>
<p>Two points about the new rules are likely to cause confusion:</p>
<ol>
<li>The three years for the rule changes are 2026, 2027, and 2029, but the gap between the second set of years is two years long.</li>
<li>As of March 15, 2029, the maximum lifetime for a TLS certificate will be 47 days, but the maximum period during which domain validation information may be reused is <b>only 10 days</b>. Manual revalidation will still technically be possible, but doing so would be a recipe for failure and outages.</li>
</ol>
<p>As a certificate authority, one of the most common questions we hear from customers is whether they’ll be charged more to replace certificates more frequently. The answer is no. Cost is based on an annual subscription, and what we’ve learned is that, once users <a href="https://www.digicert.com/trust-lifecycle-manager">adopt automation</a>, they often voluntarily move to more rapid certificate replacement cycles.</p>
<p>For this reason, and because even the 2027 changes to 100-day certificates will make manual procedures untenable, we expect rapid adoption of automation long before the 2029 changes.</p>
<p>Apple’s statement about automated certificate lifecycle management is indisputable, but it’s something we’ve been long preparing for. DigiCert offers multiple automation solutions through&nbsp;<a href="https://www.digicert.com/trust-lifecycle-manager">Trust Lifecycle Manager</a>&nbsp;and&nbsp;<a href="https://www.digicert.com/tls-ssl/certcentral-tls-ssl-manager">CertCentral</a>, including support for ACME.&nbsp;DigiCert’s ACME allows automation of DV, OV, and EV certificates and includes support for ACME Renewal Information (ARI).</p>
<p><a href="https://www.digicert.com/contact-us">Get in touch</a> for more information on how you can make the best use of automation.</p>
<h4><span>The latest developments in digital trust</span></h4>
<p>Want to learn more about topics like <a href="https://www.digicert.com/blog/category/certificate-management">certificate management</a>, <a href="https://www.digicert.com/blog/category/automation">automation</a>, and <a href="https://www.digicert.com/blog/category/tls-ssl">TLS/SSL</a>? Subscribe to the <a href="https://www.digicert.com/blog">DigiCert blog</a> to ensure you never miss a story.</p>

	    
	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Doge Is Far Short of Its Goal, and Still Overstating Its Progress (114 pts)]]></title>
            <link>https://www.nytimes.com/2025/04/13/us/politics/doge-contracts-savings.html</link>
            <guid>43693584</guid>
            <pubDate>Tue, 15 Apr 2025 14:50:59 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nytimes.com/2025/04/13/us/politics/doge-contracts-savings.html">https://www.nytimes.com/2025/04/13/us/politics/doge-contracts-savings.html</a>, See on <a href="https://news.ycombinator.com/item?id=43693584">Hacker News</a></p>
Couldn't get https://www.nytimes.com/2025/04/13/us/politics/doge-contracts-savings.html: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[ICE Agents Realize They Arrested Wrong Teen, Say 'Take Him Anyway' (156 pts)]]></title>
            <link>https://www.newsweek.com/merwil-gutierrez-ice-wrong-teen-el-salvador-2059783</link>
            <guid>43693531</guid>
            <pubDate>Tue, 15 Apr 2025 14:47:10 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.newsweek.com/merwil-gutierrez-ice-wrong-teen-el-salvador-2059783">https://www.newsweek.com/merwil-gutierrez-ice-wrong-teen-el-salvador-2059783</a>, See on <a href="https://news.ycombinator.com/item?id=43693531">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Federal immigration authorities apprehended a 19-year-old in New York despite realizing he was not the intended target.</p><p>The young man, Merwil Gutiérrez, was later deported to El Salvador's notorious super prison, despite his family's insistence that he has no gang ties or criminal history.</p><p>His father, Wilmer Gutiérrez, is now searching for answers after his son was snatched by Immigration and Customs Enforcement (<a href="https://www.newsweek.com/topic/ice" data-sys="1">ICE</a>) agents.</p><p>"The officers grabbed him and two other boys right at the entrance to our building. One said, 'No, he's not the one,' like they were looking for someone else. But the other said, 'Take him anyway,'" Wilmer told <em>Documented, "</em>an independent, nonprofit newsroom dedicated to reporting for immigrant communities in New York City."</p><figure><div>
<picture width="1200" height="800"><source type="image/webp" media="(min-width: 992px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.webp?w=790&amp;f=11c86a37ac0fdc5231227790fab2d18f 1x"><source type="image/jpeg" media="(min-width: 992px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.jpg?w=790&amp;f=11c86a37ac0fdc5231227790fab2d18f 1x"><source type="image/webp" media="(min-width: 768px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.webp?w=900&amp;f=0a36197be5923039d06e7e286e9f3e75 1x"><source type="image/jpeg" media="(min-width: 768px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.jpg?w=900&amp;f=0a36197be5923039d06e7e286e9f3e75 1x"><source type="image/webp" media="(min-width: 481px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.webp?w=790&amp;f=11c86a37ac0fdc5231227790fab2d18f 1x"><source type="image/jpeg" media="(min-width: 481px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.jpg?w=790&amp;f=11c86a37ac0fdc5231227790fab2d18f 1x"><source type="image/webp" media="(min-width: 0px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.webp?w=450&amp;f=fc07c3695b9f62ca2b32a9b1e3252929 1x"><source type="image/jpeg" media="(min-width: 0px)" srcset="https://d.newsweek.com/en/full/2627197/cecot.jpg?w=450&amp;f=fc07c3695b9f62ca2b32a9b1e3252929 1x"><source type="image/webp" srcset="https://d.newsweek.com/en/full/2627197/cecot.webp?w=1200&amp;f=365a7123f1b2ea961c3a5d887e1d968b"><img loading="lazy" id="i2627197" src="https://d.newsweek.com/en/full/2627197/cecot.jpg?w=1200&amp;f=365a7123f1b2ea961c3a5d887e1d968b" alt="CECOT" width="1200" height="800"></picture></div><figcaption>
<span id="short-cap-description">Inmates remain in a cell at the Counter-Terrorism Confinement Centre (CECOT) mega-prison, where hundreds of members of the MS-13 and 18 Street gangs are being held, in Tecoluca, El Salvador on January 27, 2025. </span>

<span>Marvin Recinos/Getty</span>
</figcaption>  </figure><h2><strong>Why It Matters</strong></h2><p>El Salvador's President Nayib Bukele responded Monday to questions about the deportation of Kilmar Abrego Garcia, stating that he lacked the authority to return individuals sent by the U.S. to the Terrorism Confinement Center (CECOT).</p><p>This remark came amid growing criticism of the government's handling of due process, opponents accusing the administration of bypassing legal safeguards in its treatment of deportees. Critics argue that Garcia's deportation reflects a broader pattern of disregarding constitutional rights, sparking concerns over the erosion of legal protections in the country's justice system.</p><p>President <a href="https://www.newsweek.com/topic/donald-trump" target="_blank" rel="noopener">Donald Trump</a> has pledged to conduct the largest deportation operation in American history as his administration looks to remove millions of undocumented immigrants. The White House has said anyone living in the country unlawfully is considered a "criminal" by the federal government. Since the beginning of Trump's second term, thousands of migrants have been arrested.</p><h2><strong>What To Know</strong></h2><p>Gutiérrez, who fled instability in Venezuela and was pursuing an asylum case in the U.S, was detained in the Bronx by ICE agents conducting a targeted operation.</p><p>According to his father, the agents initially acknowledged he was not the individual they were seeking—but chose to detain him anyway.</p><p>Just days later, Gutiérrez was deported to El Salvador, where he was transferred to a high security prison known for housing members of violent gangs, including the transnational criminal group <em>Tren de Aragua</em>.</p><p>His family and attorneys say he has no criminal record, no gang affiliations, and "not even a tattoo," which authorities often use to profile alleged gang members.</p><p>Wilmer Gutiérrez last spoke to his son on March 16 during a brief call allowed by police. He had spent days searching for information, visiting police stations and courthouses, only to be told there was no record of his son.</p><p>During the call, Merwil Gutiérrez said he was being held in Pennsylvania and expected to be transferred to Texas before returning to Venezuela. That transfer never happened.</p><p>Wilmer Gutiérrez later discovered through a news report that his son had been deported to El Salvador under the Alien Enemies Act of 1798. Videos circulating online showed detainees in harsh conditions, their heads shaved and marched to cells.</p><p>"I could have understood if he'd been sent back to Venezuela," he said. "But why to a foreign country he's never even been to?"</p><p>In May 2023, Wilmer Gutiérrez left Venezuela with his son Merwil and nephew Luis, traveling through Colombia and the Darién Gap into Panama. The monthlong journey eventually brought them to Ciudad Juárez, Mexico, where they applied for Temporary Protected Status (TPS) through the CBP One app. While waiting for their immigration appointment, they took temporary jobs and slept near the border to keep their place in line.</p><p>Before leaving Venezuela, Wilmer had lived in Los Teques, near Caracas, working for the state oil company PDVSA and later running a cellphone repair business. However ongoing political instability and a collapsing economy made it increasingly difficult to support his family, including his three children and his mother, who was battling cancer.</p><h2><strong>What People Are Saying</strong></h2><p><strong>William Parra, an immigration attorney from Inmigración Al Día said:</strong> "Merwil was detained for hanging out with friends and was at the wrong place at the wrong time. ICE was not looking for him, nor is there any evidence whatsoever that Merwil was in any gang."</p><p><strong>Aaron Reichlin-Melnick, senior fellow at the American Immigration Council said in a post on X, formerly Twitter</strong>: "19-year-old Merwil Gutierrez was grabbed off the street in New York City days before he was sent to El Salvador. His family insists he has no connection to <a href="https://www.newsweek.com/topic/tren-de-aragua" data-sys="1">Tren de Aragua</a>. He doesn't even have any tattoos."</p><h2><strong>What Happens Next</strong></h2><p>Gutiérrez's legal team is calling for immediate diplomatic intervention to secure his release and safe return.</p>  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How to Win an Argument with a Toddler (641 pts)]]></title>
            <link>https://seths.blog/2025/04/how-to-win-an-argument-with-a-toddler/</link>
            <guid>43693402</guid>
            <pubDate>Tue, 15 Apr 2025 14:38:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://seths.blog/2025/04/how-to-win-an-argument-with-a-toddler/">https://seths.blog/2025/04/how-to-win-an-argument-with-a-toddler/</a>, See on <a href="https://news.ycombinator.com/item?id=43693402">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
						
			
<p>You can’t.</p>



<p>That’s because toddlers don’t understand what an argument is and aren’t interesting in having one.</p>



<p>Toddlers (which includes defensive bureaucrats, bullies, flat earthers, folks committed to a specific agenda and radio talk show hosts) may indicate that they’d like to have an <a href="https://youtu.be/ohDB5gbtaEQ?si=AvfXoVSSSAzU04WW">argument</a>, but they’re actually engaging in connection, noise, play acting or a chance to earn status. It can be fun to be in opposition, to harangue or even to use power to change someone’s position.</p>



<p>An argument, though, is an exchange of ideas that ought to surface insight and lead to a conclusion.</p>



<p>If you’re regularly having arguments with well-informed people of goodwill, you will probably ‘lose’ half of them–changing your mind based on what you’ve learned. <em>If you’re not changing your mind, it’s likely you’re not actually having an argument</em> (or you’re hanging out with the wrong people.) While it can be fun to change someone else’s position, it’s also a gift to learn enough to change ours.</p>



<p>The toddler puts on a show of having an argument, but they are holding a tantrum in reserve. If they ‘win’ the argument, no tantrum is needed. If they lose, they can tell themselves that they tried but the other person deserved the tantrum because they didn’t listen.</p>



<p>“Tell me about other strongly-held positions you’ve changed as the result of a discussion like this one…” is a direct way to start a conversation about the argument you’re proposing to have. “What sort of information would make it likely you could see this in a different way?”</p>



<p>It probably doesn’t pay to argue over things we have chosen to believe as part of our identity.</p>
			

			

		</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Philosophy Major Snatched by ICE During Citizenship Interview (131 pts)]]></title>
            <link>https://dailynous.com/2025/04/15/philosophy-major-snatched-by-ice-during-citizenship-interview/</link>
            <guid>43693375</guid>
            <pubDate>Tue, 15 Apr 2025 14:36:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://dailynous.com/2025/04/15/philosophy-major-snatched-by-ice-during-citizenship-interview/">https://dailynous.com/2025/04/15/philosophy-major-snatched-by-ice-during-citizenship-interview/</a>, See on <a href="https://news.ycombinator.com/item?id=43693375">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>			<article>

				
<header>
				
			
	
	<hr>
			
	</header><!-- .article__header -->
				<section>
					<p>Mohsen Mahdawi, a philosophy major at Columbia University who is due to graduate later this semester, was attending a US citizenship application interview in Vermont on Monday when Immigration and Customs Enforcement (ICE) agents wearing hoods and masks took him from the building, put him into an unmarked car, and drove off.<span id="more-53466"></span></p>
<p><img fetchpriority="high" decoding="async" src="https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen.png" alt="" width="690" height="649" srcset="https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen.png 1672w, https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen-300x282.png 300w, https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen-1024x963.png 1024w, https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen-768x723.png 768w, https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen-1536x1445.png 1536w, https://dailynous.com/wp-content/uploads/2025/04/mahdawi-mohsen-400x376.png 400w" sizes="(max-width: 690px) 100vw, 690px"></p>
<p>His current whereabouts are “unknown”, said his lawyer, according to the <a href="https://www.bbc.com/news/articles/cwy0332y7xzo" target="_blank" rel="noopener">BBC</a>.</p>
<p>Mahdawi is a green card holder. According to the BBC:</p>
<p><em>His lawyer, Luna Droubi, said: “The Trump administration detained Mohsen Mahdawi in direct retaliation for his advocacy on behalf of Palestinians and because of his identity as a Palestinian.</em></p>
<p><em>“His detention is an attempt to silence those who speak out against the atrocities in Gaza. It is also unconstitutional.”</em></p>
<p><em>The attorney applied to a federal court for a temporary restraining order to prevent US immigration authorities moving Mr Mahdawi out of Vermont or expelling him from the US.</em></p>
<p><em>Judge William Sessions, an Obama appointee, quickly granted that order.</em></p>
<p><em>The court filing says Mr Mahdawi was born in a refugee camp in the West Bank and moved to the US in 2014.</em></p>
<p><em>It describes the philosophy major as a committed Buddhist who believes in “non-violence and empathy as a central tenet of his religion”.</em></p>
<p>Mahdawi was interviewed last year by&nbsp;<em>60 Minutes&nbsp;</em>about the student protests at Columbia regarding Israel’s response to Hamas’s attack on October 7th, 2023. In the interview he says:</p>
<p><em>To be anti-Semitic is unjust. And the fight for the freedom of Palestine and the fight against anti-Semitism go hand in hand, because injustice anywhere is a threat to justice everywhere.</em></p>
<p>A clip of the interview is below.</p>
<p><iframe title="YouTube video player" src="https://www.youtube.com/embed/grj328-hlhA?si=Ij16DfujLKKlXHQm" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen"></iframe></p>
<p>(via Shen-Yi Liao)</p>
<hr>
<p><strong>UPDATE:&nbsp;</strong>A reader passed along the public Facebook post of <a href="https://history.ucla.edu/person/david-myers/" target="_blank" rel="noopener">David Myers</a>, professor of history, holder of the Sady and Ludwig Kahn Chair in Jewish History, and former director of the Center for Jewish Studies at UCLA:</p>
<div dir="auto">
<p><em>Coming off of two days of Passover, I was horrified to discover that my friend, Columbia student Mohsen Mahdawi, was arrested. I met Mohsen at a meeting in late spring 2024 and have been in touch with him ever since. He is a remarkable and humane person who experienced the worst of Israel’s occupation as a young kid in the Jenin refugee camp, took up arms as a teenager, and then decided to foreswear the path of armed struggle for non-violence. He became an activist in the Palestinian solidarity movement at Columbia, all the while believing in the importance of engaging with and talking to those with whom he disagreed. Let’s be clear: Mohsen was arrested not because he was a supporter of violence or a threat to national security but FOR THE CRIME OF BEING PALESTINIAN. His commitment to non-violence was not always popular with some in the Palestinian solidarity movement, and his fierce criticism of the occupation led others to us accuse him–quite scandalously–of being antisemitic. But he had the courage of his convictions, rooted in his core belief in the dignity of all human life.</em></p>
<p><em>His arrest is a profound miscarriage of justice–and in line with the scandalous harassment, arrest, and deportation of others who have dared to express support for the principle of Palestinian liberation. He is indeed a political prisoner of a rogue regime that is descending ever further into authoritarianism. If this is the kind of person they deem a threat, there is no end to their perfidy. Those who care about the rule of law, freedom of expression, and support for the cause of justice in Israel-Palestine cannot remain silent.</em></p>
<p>Professor Myers’ post is <a href="https://www.facebook.com/david.myers.31586" target="_blank" rel="noopener">here</a>.</p>
</div>
				</section>
				<!-- .article__content -->
				
<!-- .article__footer -->

    
    
    
    
    
			</article>
			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Hacking the Postgres Wire Protocol (202 pts)]]></title>
            <link>https://pgdog.dev/blog/hacking-postgres-wire-protocol</link>
            <guid>43693326</guid>
            <pubDate>Tue, 15 Apr 2025 14:33:10 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://pgdog.dev/blog/hacking-postgres-wire-protocol">https://pgdog.dev/blog/hacking-postgres-wire-protocol</a>, See on <a href="https://news.ycombinator.com/item?id=43693326">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        
        <p><strong>Apr 14th, 2025</strong><br>Lev Kokotov</p>
       <p>PgDog is a network proxy and it can see every byte sent between Postgres and the clients. It understands SQL and can infer where queries should go, without requiring changes to application code.</p>

<p>In this article, we discuss how we handle the Postgres wire protocol and manipulate it to serve queries to multiple databases at the same time.</p>

<h3 id="protocol-basics">Protocol basics</h3>

<p>Postgres has two ways to send queries over the network:</p>

<ul>
  <li>Simple protocol</li>
  <li>Extended protocol</li>
</ul>

<p>The simple protocol is called like that on purpose: it’s very simple. It has just one message, called <code>Query</code> which contains everything the server needs to execute it:</p>

<div><pre><code>'Q' | \x00\x00\x00&amp; | SELECT * FROM users WHERE id = 25\0
</code></pre></div>

<p>Postgres messages have a standard format. Each message starts with a single ASCII letter (1 byte), identifying the message type. It’s followed by a 32-bit signed integer, indicating the length of the payload, in bytes, with 4 bytes added for itself. The payload is unique for each message.</p>

<p>To route a query, PgDog needs to understand two things:</p>

<ul>
  <li>Does the query read or write data?</li>
  <li>Does it contain a sharding key, and if so, what is it’s value?</li>
</ul>

<p>To make this work, we need some help. To answer the first question, we could, theoretically, just look at the first word, and if it’s a “SELECT”, assume read intent. While this would work in most cases, we’ll miss some obvious ones, like CTEs.</p>

<p>The tricky part is finding the sharding key. For this, we need to actually interpret the query using a tool that understands SQL syntax. That’s called a parser, and luckily the Rust ecosystem already has a great library, called <code>pg_query</code>. The parser produces an Abstract Syntax Tree, a data structure we can read to find what we need:</p>

<div><pre><code><span>let</span> <span>ast</span> <span>=</span> <span>pg_query</span><span>::</span><span>parse</span><span>(</span><span>"SELECT * FROM users WHERE id = 25"</span><span>);</span>
</code></pre></div>

<p><code>pg_query</code> is special. It doesn’t actually implement parsing SQL. It works by extracting C source code directly from Postgres and wraps it with a nice Rust interface. This allows PgDog to understand <em>all</em> queries that Postgres can.</p>

<p>PgDog is all about sharding Postgres. Once we locate the sharding key in a query, we have to figure out what to do with it. Let’s do a quick detour into Postgres partitions.</p>

<h5 id="the-sharding-function">The sharding function</h5>

<p>Picking the right sharding function is critical. It’s not something you can easily change later. One thing I learned from doing this at Instacart: pick a sharding function which is available in multiple places. Let me explain.</p>

<p>In the real world, whatever you build, won’t be the <em>only</em> way to ingest or read data to/from your system. Either you don’t want to touch production (yet) or you just need to move some things around ad-hoc, you want engineers to be able to pre-process data in advance and have multiple ways to talk to your system.</p>

<p>For this reason, PgDog doesn’t implement a custom sharding function. It’s using the hashing function used in Postgres declarative partitions:</p>

<div><pre><code><span>CREATE</span> <span>TABLE</span> <span>users</span> <span>(</span><span>id</span> <span>BIGINT</span><span>,</span> <span>email</span> <span>VARCHAR</span><span>)</span>
<span>PARTITION</span> <span>BY</span> <span>HASH</span><span>(</span><span>id</span><span>);</span>
</code></pre></div>

<p>If you know the number of shards, you can create the same number of data partitions and just COPY data into the table. If you’re using FOREIGN tables with <code>postgres_fdw</code>, you can interact with your sharded database directly.</p>

<p>To make this work in PgDog, we took a page from the <code>pg_query</code> playbook. We could have implemented the function ourselves, but it’s much better to just take the code from Postgres and wrap it with a Rust interface.</p>

<p>Rust makes this pretty easy. Using the <code>cc</code> (C/C++ compiler) library and by copy/pasting some code, we have a working FFI interface to <code>hashfn.c</code> straight out of the Postgres source code tree. All we need is the right data to pass in, and apply the modulo operation to get the shard number.</p>



<p>Our example has only one filter: <code>id = 25</code>. This is the simplest case, but it’s also the most common one. Getting this value from SQL, using <code>pg_query</code>, is straightforward. Once we have it, we can pass it to the sharding function and we have a shard number.</p>

<center>
  <img src="https://pgdog.dev/assets/images/wire-protocol-query.jpg" width="100%" height="auto" alt="Extended protocol">
</center>

<p>UPDATE and DELETE queries work the same way. They all have (an optional) WHERE-clause, and if it has a filter with our sharding key, we can handle it. If it doesn’t, the query is sent to all shards (more on that below).</p>

<p>More complex examples, like <code>IN (1, 2, 3)</code> or <code>id != 25</code> can be handled as well. For the former, we can hash all values and route the query to the matching shards. For the latter, we send the query to all shards. Some cases of course won’t work, e.g., <code>WHERE id &lt; 25</code>. That’s too many values to hash and this query will hit all shards anyway.</p>

<p>INSERT statements are a bit more interesting and come in two variants:</p>



<p>The first one specifies the column order, so we can just extract the sharding key directly. The second doesn’t, so we have to fetch the schema from Postgres and infer the column order. This is slightly more involved, but still a solvable problem. Not something we’re handling yet, but it’s on the roadmap.</p>

<p>ORMs like Rails and Django tend to be explicit and provide fully-qualified columns and table names for all queries. This makes our job easier, but we can’t always rely on everyone using an ORM and we certainly don’t want to impose arbitrary limitations on our users.</p>

<p>Simple protocol is simple, but things get more interesting if the client uses prepared statements and the extended protocol.</p>

<h5 id="extended-protocol">Extended protocol</h5>

<p>The extended protocol has several messages. For our purposes, we are interested in just two:</p>

<ul>
  <li><code>Parse</code> which has the query and parameter placeholders</li>
  <li><code>Bind</code> which contains the parameter values</li>
</ul>

<p>Separating the two allows Postgres to parse the query once and execute it multiple times with different parameters. This is great for query performance and to avoid SQL injection attacks, but it requires us to do a couple extra steps to get what we need:</p>

<center>
  <img src="https://pgdog.dev/assets/images/wire-protocol-bind.jpeg" width="100%" height="auto" alt="Extended protocol">
</center>

<p>If prepared statements are used, clients typically send one <code>Parse</code> message per query. PgDog parses it and stores the AST in its memory cache. The statements are disambiguated at the global level, so even if multiple clients send the same one, they are evaluated only once.</p>

<p>This optimization is critical to make this fast in production. Parsing SQL isn’t free and we only do it when we have to. The message itself is saved in a memory buffer, while PgDog waits for the actual parameter values to arrive.</p>

<p><code>Bind</code> message(s) follow for each execution of the statement. If the statement is anonymous (unnamed), we only get one <code>Bind</code> message. In either case, we know where the sharding key is located, based on the numbered parameters in the query.</p>

<p>With the sharding key hashed, we can forward both messages to a Postgres server connection and begin executing the query.</p>

<p>Both simple and extended protocols require PgDog to build an internal state of the connection and keep track of messages that flow through. As long as we keep the protocol in sync, we can manipulate what Postgres receives and what messages are sent back to the client. This becomes relevant when we start talking to multiple servers at once.</p>

<h3 id="cross-shard-queries">Cross-shard queries</h3>

<p>Postgres query response contains multiple messages. They are, in order of appearance:</p>

<ul>
  <li><code>RowDescription</code>, which contains column names and their data types</li>
  <li><code>DataRow</code> has the actual values, with one message for each row in the result set</li>
  <li><code>CommandComplete</code> indicates the query finished running and how many rows were affected</li>
  <li><code>ReadyForQuery</code> indicates the server is ready for the next query</li>
</ul>

<center>
  <img src="https://pgdog.dev/assets/images/wire-protocol-response.jpg" width="100%" height="auto" alt="Extended protocol">
</center>

<p>Since PgDog is an independent proxy, Postgres servers have no idea they are executing a multi-shard query. Each server connection will return all of these messages in that order. However, except the <code>DataRow</code> message, the client expects only one message of each kind.</p>

<p>Each message in this pipeline is handled differently. For <code>RowDescription</code>, only the last one is returned. All shards are expected to have the same schema, so these messages should be identical between shards. If they are not, the data types must be compatible, e.g., VARCHAR and TEXT.</p>

<p>There are a few more nuances here. For example, if databases have custom data types created by extensions, like pgvector or PostGIS, their OIDs won’t match across different Postgres databases, and we need to make sure clients are only aware of one set. If text encoding is used (it is, by default), mixing BIGINT and INTEGER can work, although I wouldn’t recommend it. While languages like Ruby and Python don’t distinguish between the two, languages like Rust and Java definitely do.</p>

<p><code>DataRow</code> messages are handled in two possible ways. If the query has an ORDER BY clause, the messages are buffered. Once all of them are received, they are sorted accordingly and returned in the right order to the client. If the rows aren’t ordered, PgDog sends them to the client immediately, in whatever order it receives them from the servers.</p>

<center>
  <img src="https://pgdog.dev/assets/images/wire-protocol-sorting.jpg" width="100%" height="auto" alt="Extended protocol">
</center>

<p>This is where the understanding of SQL starts to take shape. Extracting column values is great, but we need to do more to make sure the query is executed correctly. PgDog isn’t a full coordinator yet, but more features are added every week.</p>

<p><code>CommandComplete</code> message is rewritten to reflect the correct row count. We do this by parsing its contents and summing the number of rows across all messages we received from all shards. <code>ReadyForQuery</code> is forwarded as-is (only the last message) and the cross-shard query is complete.</p>

<p>Protocol manipulation works on both sides of the conversation. PgDog doesn’t stop at manipulating server messages. It goes further and can modify client messages to create a powerful cross-shard data ingestion pipeline.</p>

<h3 id="distributed-copy">Distributed COPY</h3>

<p>The fastest way to write data into Postgres is to use COPY. It’s a special command that can read CSV, text or binary data and write it directly into a table. It can be used to bulk ingest records and to move data between DBs.</p>

<div><pre><code><span>COPY</span> <span>users</span> <span>(</span><span>id</span><span>,</span> <span>email</span><span>)</span> <span>FROM</span> <span>STDIN</span> <span>CSV</span> <span>HEADER</span><span>;</span>
</code></pre></div>

<pre><code>id,email
65,<a href="https://pgdog.dev/cdn-cgi/l/email-protection" data-cfemail="94fcfdd4e4f3f0fbf3baf0f1e2">[email&nbsp;protected]</a>
25,<a href="https://pgdog.dev/cdn-cgi/l/email-protection" data-cfemail="f8949d8eb8889f9c979fd69c9d8e">[email&nbsp;protected]</a>
</code></pre>

<p>Postgres clients send this command using two messages:</p>

<ul>
  <li><code>Query</code> to send the COPY command itself</li>
  <li>A series of <code>CopyData</code> messages that contain the actual rows</li>
</ul>

<p>In a sharded database, this command requires special handling. For each row, PgDog extracts the sharding key, hashes it, and routes it to the right server:</p>

<center>
  <img src="https://pgdog.dev/assets/images/wire-protocol-copy.jpg" width="100%" height="auto" alt="Extended protocol">
</center>

<p>Clients typically send data in chunks, irrespective of encoding boundaries. For example, each <code>CopyData</code> message created by <em>psql</em> is 4096 bytes long and can break CSV records. To make this work, PgDog handles partial CSV records and streaming binary data by buffering one complete row at a time. <code>CopyData</code> messages coming out of PgDog always contain one single and complete row.</p>

<h5 id="performance">Performance</h5>

<p>Distributed COPY, in theory, can linearly scale ingestion speeds for sharded Postgres. With each new shard, the speed of ingestion should increase by <em>1/N</em> where <em>N</em> is the number of shards. Since PgDog is using Tokio and multiple threads, it’s possible to run it on a machine with multiple CPUs and parallelize the hashing and manipulation of data rows. A single ingestion pipeline can push gigabytes of data per second into Postgres, while maintaining schema and data integrity.</p>

<h3 id="next-steps">Next steps</h3>

<p>PgDog is just getting started. While it can manipulate the frontend/backend wire protocol used by clients and Postgres servers, we are going further and applying the same technique to manipulate logical replication streams.</p>

<p>Since PgDog does all this at the network layer, it can run anywhere including managed clouds like AWS RDS, and works with Postgres clones like Aurora, AlloyDB and Cockroach.</p>

<p>If this is interesting, <a href="https://pgdog.dev/cdn-cgi/l/email-protection#4b23220b3b2c2f242c652f2e3d">get in touch</a>! We are looking for early adopters and design partners. We always appreciate <a href="https://github.com/pgdogdev/pgdog">a star</a> on GitHub.</p>

    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[You cannot have our user's data (112 pts)]]></title>
            <link>https://sourcehut.org/blog/2025-04-15-you-cannot-have-our-users-data/</link>
            <guid>43692998</guid>
            <pubDate>Tue, 15 Apr 2025 14:13:19 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://sourcehut.org/blog/2025-04-15-you-cannot-have-our-users-data/">https://sourcehut.org/blog/2025-04-15-you-cannot-have-our-users-data/</a>, See on <a href="https://news.ycombinator.com/item?id=43692998">Hacker News</a></p>
<div id="readability-page-1" class="page"><article>
        <p>As you may have noticed, SourceHut has deployed <a href="https://anubis.techaro.lol/">Anubis</a> to parts of our
services to protect ourselves from aggressive LLM crawlers.<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup> Much ink has been
spilled on the subject of the LLM problem elsewhere, and we needn’t revisit that
here. I do want to take this opportunity, however, to clarify how SourceHut
views this kind of scraper behavior more generally, and how we feel that the
data entrusted to us by our users ought to be used.</p>
<p>Up until this point, we have offered some quiet assurances to this effect in a
few places, notably our terms of service and robots.txt file. Quoting the
former:</p>
<blockquote>
<p>You may use automated tools to obtain public information from the services for
the purposes of archival or open-access research. You may not use this data
for recruiting, solicitation, or profit.</p></blockquote>
<p>This has been part of our terms of service since they were originally written in
2018. With the benefit of hindsight, I might propose a different wording to
better reflect our intentions – but we try not to update the terms of service
too often because we have to send all users an email letting them know we’ve
done so. I have a proposed edit pending to include in the next batch of changes
to the terms which reads as follows:</p>
<blockquote>
<p>You may use automated tools to access public SourceHut data in bulk (i.e.
crawlers, robots, spiders, etc) provided that:</p>
<ol>
<li>Your software obeys the rules set forth in robots.txt</li>
<li>Your software uses a User-Agent header which clearly identifies your
software and its operators, including your contact information</li>
<li>Your software requests data at a rate which does not negatively affect the
performance of our services for other users</li>
</ol>
<p>You may <em>only</em> collect this data for one or more of the following purposes:</p>
<ul>
<li>Search engine indexing</li>
<li>Open-access research</li>
<li>Archival</li>
</ul>
<p>You may not use automated tools to collect SourceHut data for solicitation,
profit, training machine learning models, or any other purpose not enumerated
here without explicit permission from SourceHut staff.</p></blockquote>
<p>This text, or something similar, will be included in our next update to the
terms of service, which will probably ship around the time we finish setting up
our new European billing system.</p>
<p>A careful observer can see our views on scrapers elaborated on in our
<a href="https://git.sr.ht/robots.txt">robots.txt</a> file as well. It begins as follows:</p>
<pre tabindex="0"><code># Our policy
#
# Allowed:
# - Search engine indexers
# - Archival services (e.g. IA)
#
# Disallowed:
# - Marketing or SEO crawlers
# - Anything used to feed a machine learning model
# - Bots which are too agressive by default. This is subjective, if you annoy
#   our sysadmins you'll be blocked.
#
# If you do not respect robots.txt or you deliberately circumvent it we will
# block your subnets and leave a bag of flaming dog shit on your mother's front
# porch.
</code></pre><p>One can infer from the tone of the last sentence that attempting to enforce
robots.txt is a frustrating, thankless task for our sysadmins.</p>
<p>To add to these resources, I’d like to elaborate a bit more on our views on
scrapers for you today. Scrapers have been a thorn in the side of sysadmins for
a very long time, but it’s particularly important as LLM scrapers seize the
entire Internet to feed into expensive, inefficient machine learning models –
ignoring the copyright (<a href="https://nitter.net/mitsuhiko/status/1410886329924194309">or copyleft</a>, as it were) of the data as
they go. The serious costs and widespread performance issues and outages caused
by reckless scrapers has been on everyone’s mind in the sysadmin community as of
late, and has been the subject of much discussion online.</p>
<p>Aside from the much-appreciated responses of incredulity towards LLM operators,
and support and compassion for sysadmins from much of the community, a
significant minority views this problem as less important than we believe it to
be. Many of their arguments reduce to victim blaming – that it’s not that hard
to handle this volume of traffic, that we should be optimized to better deal
with it, that we need more caching or to improve our performance, or that we
should pay a racketeer like CloudFlare to make the problem go away. Some suggest
that sysadmins should be reaching out to LLM companies to offer them more
efficient ways to access our data to address the problem.</p>
<p>Of course, not all software is necessarily able to be as resource efficient as
Joe Naysayer’s static website. Moreover, LLM companies are not particularly
interested in the more expensive route of building software integrations for
each data source they scrape when they could go the cheap route of making us all
pay for the overhead; nor should us sysadmins have to spend the finite time and
resources at <em>our</em> disposal (often much more modest than the resources available
to these LLM companies) negotiating with terrorists and building bespoke
solutions for <em>them</em>.</p>
<p>More important than any of these concerns is to address the underlying
assumption: that these companies are entitled to this data. This assumption has
varied roots, as benign as misplaced Libertarian ideals and as unhinged as the
Rationalism cult belief that AGI is around the corner and everyone ought to be
participating as best they can for the benefit of untold numbers of unborn
future-humans.</p>
<p>It is our view that these companies are <em>not</em> entitled to the data we provide,
nor is anyone else. The intended audience for the publicly available data on
SourceHut is users of and contributors to open source software who are accessing
the data for those purposes. Indeed some profitable use of public SourceHut data
is permitted, as one is entitled to by the <a href="https://opensource.org/osd">Open Source Definition</a>, but we
do not wish to provide our data in bulk for any business, megacorp or startup
alike, who wants to feed it into an LLM or do anything else with it which does
not directly serve our mission, which is to improve open source software.</p>
<p>We would not come to a special arrangement to share this data with any of these
companies, either, even in the unlikely event that they offered to pay for it.
We are funded by paid subscriptions, not by selling our user’s data. It is not
ours to sell – something GitHub, with its own LLM products, would do well to
consider more carefully. The data we have been entrusted with belongs to our
users, and is dedicated to the commons, and we take our role as the stewards of
this data seriously. It is our duty to ensure that it is used in the service of
our users best interests. <a href="https://sourcehut.org/blog/2019-10-23-srht-puts-users-first/">We have always put them first</a>.</p>


      </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[America Underestimates the Difficulty of Bringing Manufacturing Back (260 pts)]]></title>
            <link>https://www.molsonhart.com/blog/america-underestimates-the-difficulty-of-bringing-manufacturing-back</link>
            <guid>43692677</guid>
            <pubDate>Tue, 15 Apr 2025 13:50:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.molsonhart.com/blog/america-underestimates-the-difficulty-of-bringing-manufacturing-back">https://www.molsonhart.com/blog/america-underestimates-the-difficulty-of-bringing-manufacturing-back</a>, See on <a href="https://news.ycombinator.com/item?id=43692677">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="page" role="main">
        
          
<article id="sections" data-page-sections="5fd69ad7154d727871f4df3b">
  
  
    
    


  
  


<div data-content-field="main-content" data-item-id="" data-test="page-section" data-section-theme="white-bold" data-section-id="5fd69ad7154d727871f4df41" data-controller="SectionWrapperController" data-current-styles="{
&quot;imageOverlayOpacity&quot;: 0.15,
&quot;backgroundWidth&quot;: &quot;background-width--full-bleed&quot;,
&quot;sectionHeight&quot;: &quot;section-height--medium&quot;,
&quot;customSectionHeight&quot;: 10,
&quot;horizontalAlignment&quot;: &quot;horizontal-alignment--center&quot;,
&quot;verticalAlignment&quot;: &quot;vertical-alignment--middle&quot;,
&quot;contentWidth&quot;: &quot;content-width--medium&quot;,
&quot;customContentWidth&quot;: 50,
&quot;sectionTheme&quot;: &quot;white-bold&quot;,
&quot;sectionAnimation&quot;: &quot;none&quot;,
&quot;backgroundMode&quot;: &quot;image&quot;
}" data-current-context="{
&quot;video&quot;: {
&quot;playbackSpeed&quot;: 0.5,
&quot;filter&quot;: 1,
&quot;filterStrength&quot;: 0,
&quot;zoom&quot;: 0,
&quot;videoSourceProvider&quot;: &quot;none&quot;
},
&quot;backgroundImageId&quot;: null,
&quot;backgroundMediaEffect&quot;: null,
&quot;divider&quot;: null,
&quot;typeName&quot;: &quot;blog-masonry&quot;
}" data-animation="none">
  <article id="article-">
  
    
    
    
    <div data-block-type="2" data-border-radii="{&quot;topLeft&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;value&quot;:0.0},&quot;topRight&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;value&quot;:0.0},&quot;bottomLeft&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;value&quot;:0.0},&quot;bottomRight&quot;:{&quot;unit&quot;:&quot;px&quot;,&quot;value&quot;:0.0}}" id="item-67f27d5d63c035294cca874b" data-layout-label="Post Body" data-type="item">
  <p>On April 2nd, 2025, our president announced major new taxes on imports from foreign countries (“tariffs”), ranging from 10% to 49%. The stated goal is to bring manufacturing back to the United States and to “make America wealthy again”.</p><p>These tariffs will not work. In fact, they may even do the opposite, fail to bring manufacturing back and make America poorer in the process.</p><p>This article gives the 14 reasons why this is the case, how the United States could bring manufacturing back if it were serious about doing so, and what will ultimately happen with this wrongheaded policy</p><p>I’ve been in the manufacturing industry for 15 years. I’ve manufactured in the USA and in China. I worked in a factory in China. I speak and read Chinese. I’ve purchased millions of dollars worth of goods from the US and China, but also Vietnam, Indonesia, Taiwan, and Cambodia. I’ve also visited many factories in Mexico and consider myself a student of how countries rise and fall.</p><p>In other words, unlike many who have voiced an opinion on this topic, I know what I am talking about. And that’s why I felt compelled to write this article. I had to do it. I’m a first generation American and I love my country and it pains me to see it hurtling at high speed towards an economic brick wall. This article is an attempt to hit the brakes.</p><h3>The 14 Reasons Why these Tariffs Will Not Bring Manufacturing Back</h3><ol data-rte-list="default"><li><div><p><strong>They’re not high enough</strong></p><p>A tariff is a tax on an imported product. For example, when Apple imports an iPhone that was made in China it declares to the United States government what it paid to make that product overseas. Let’s say it’s $100. When there is a 54% tariff, Apple pays $100 to the manufacturer in China and $54 to the US government when importing. In this simplified example, an iPhone used to cost Apple $100, but it now costs $154. For every dollar Apple spends, Apple needs to make profit. So Apple sells iPhones to stores for double what it pays for them. And stores sell iPhones to consumers like you and me for double what it pays for them, as well.</p><p><strong>Before the tariffs, prices looked like this:</strong> <br>Apple bought iPhones it designed for $100<br>Apple sold iPhones for $200 to stores<br>Stores sold iPhones to you and me for $400</p><p><strong>After the tariffs, prices look like this:</strong><br>Apple bought iPhones for $154 ($100 + $54 in import taxes)<br>Apple sells those iPhones for $308 (double what it paid)<br>Stores sell those iPhones to you and me for $616 (double what they paid)</p><p>Now that you know what a tariff is, let me tell to you why they aren’t high enough to bring manufacturing back to the United States.</p><p>In short, manufacturing in the United States is so expensive and our supply chain (we’ll explain that next) is so bad that making that iPhone in the United States without that 54% tariff, would still cost more than in China with 54% tariff. Since it still costs less to make the iPhone in China, both Apple and consumers would prefer it be made there, so it will, and not in the USA.</p></div></li><li><div><p><strong>America’s industrial supply chain for many products is weak.</strong></p><p>Think of a supply chain as a company’s ability to get the components it needs to build a finished product. Suppose you wanted to build and sell wooden furniture. You’re going to need wood, nails, glue, etc. Otherwise you can’t do it. If you want to build an iPhone you need to procure a glass screen, shaped metal, and numerous internal electronic components.</p><p>Now you might be thinking, “what do you mean America has a weak supply chain? I’ve built furniture, I’ve assembled a computer. I can get everything I want at Home Depot and at Amazon.”</p><p>That’s because America has an amazing <em>consumer</em> supply chain, one of the best, if not the best in the world, but this is totally different from having an <em>industrial</em> supply chain.</p><p>When you’re operating a furniture factory, you need an industrial quantity of wood, more wood than any Home Depot near you has in store. And you need it fast and cheap. It turns out that the United States has a good supply chain for wood, which is why, despite higher wages, we export chopsticks to China. We have abundant cheap wood in the forests of the Northern United States. But if you decided to move that chopstick factory to desert Saudi Arabia, you would not succeed, because their supply chain for wood is poor; there simply aren’t any trees for 1,000s of miles.</p><p>When it comes to the iPhone, all the factories which make the needed components are in Asia, which is one reason why, even with a 54% tariff, it’s cheaper to assemble that iPhone in China than in the United States. It’s cheaper and faster to get those components from nearby factories in Asia than it is to get them from the US, which, because said factories no longer exist here, has to buy these components from Asia anyways.</p><p>Supply chains sound complicated, but aren’t. If you can’t get the components you need at a reasonable price and timeline to build a finished product, it doesn’t matter what the tariffs are, you have to import it, because you can’t build it locally.</p></div></li><li><div><p><strong>We don’t know how to make it</strong></p><p>Apple knows how to build an iPhone, but may not know how to make the individual components. It may seem trivial to make that glass that separates your finger from the electronic engineering that powers your ability to access the internet, but it’s difficult. </p><p>The world buys semiconductors from Taiwan, not just because its relatively inexpensive (but more expensive than China) labor and excellent supply chain, but because they know how to make the best semiconductors in the world. Even with infinite money, we cannot duplicate that, because we lack the knowhow.</p><p>A 54% tariff does not solve that problem. We still need to buy semiconductors from Taiwan, which is perhaps why the administration put in an exception for semiconductors, because we need them and because we can’t make them without their help.</p><p>This is a problem which applies to more than just semiconductors. We have forgotten how to make products people wrongly consider to be basic, too.</p><p>My company makes educational toys from plastic called Brain Flakes. To make Brain Flakes, you melt plastic and force it into shaped metal molds. Were we to import the machines and molds needed to do this, it would work for a little while, but as soon as one of those molds broke, we’d be in trouble, because there are almost no moldmakers left in the United States. The people who knew how to build and repair molds have either passed away or are long retired. In the event of a problem, we’d have to order a new mold from China or send ours back, shutting down production for months.</p><p>People trivialize the complexity and difficulty of manufacturing when it’s really hard. And if we don’t know how to make something, it doesn’t matter what the tariff is. It won’t get made in America.</p></div></li><li><div><p><strong>The effective cost of labor in the United States is higher than it looks</strong>Most people think that the reason why we make products in China instead of the United States is cheaper labor. That’s true, but it’s not the whole story. Frankly, the whole story is hard to read. People are not machines, they are not numbers on a spreadsheet or inputs into a manufacturing cost formula. I respect everyone who works hard and the people I have worked with over the years, and I want Americans to live better, happier lives.</p><p>Chinese manufacturing labor isn’t just cheaper. It’s better.</p><p>In China, there are no people who are too fat to work. The workers don’t storm off midshift, never to return to their job. You don’t have people who insist on being paid in cash so that they can keep their disability payments, while they do acrobatics on the factory floor that the non-disabled workers cannot do.</p><p>Chinese workers much less likely to physically attack each other and their manager. They don’t take 30 minute bathroom breaks on company time. They don’t often quit because their out-of-state mother of their children discovered their new job and now receives 60% of their wages as child support. They don’t disappear because they’ve gone on meth benders. And they don’t fall asleep on a box midshift because their pay from yesterday got converted into pills.</p><p>And they can do their times tables. To manufacture, you need to be able to consistently and accurately multiply 7 times 9 and read in English, and a disturbingly large portion of the American workforce cannot do that.</p><p>Chinese workers work longer hours more happily and they’re physically faster with their hands; they can do things that American labor can’t. It’s years of accumulated skill, but it’s also a culture that is oriented around hard work and education that the United States no longer has.</p><p>Sadly, what I describe above are not theoretical situations. These are things that I have experienced or seen with my own eyes. It’s fixable, but the American workforce needs great improvement in order to compete with the world’s, even with tariffs.</p><p>So yes, Chinese wages are lower, but there many countries with wages lower than China’s. It’s the work ethic, knowhow, commitment, combined with top notch infrastructure, that makes China the most powerful manufacturing country in the world today.</p></div></li><li><div><p><strong>We don’t have the infrastructure to manufacture</strong></p><p>The inputs to manufacturing are not just materials, labor, and knowhow. You need infrastructure like electricity and good roads for transportation, too.</p><p>Since the year 2000, US electricity generation per person has been flat. In China, over the same time period, it has increased 400%. China generates over twice as much electricity person today as the United States. Why?</p><p>Manufacturing.</p><p>To run the machines which make the products we use, you need electricity, a lot of it. We already have electricity instability in this country. Without the construction of huge amounts of new energy infrastructure, like nuclear power plants, we cannot meaningfully increase our manufacturing output.</p><p>And it would put huge stress on our roads and create lots more dangerous traffic. When we import finished goods from foreign countries, a truck delivers them from the port or the airport to distribution centers, stores, and where we live and work.</p><p>When you start manufacturing, every single component, from factory to factory, needs to be moved, increasing the number of trucks on the road many times.</p><p>Paving more roads, modernizing our seaports, improving our airports, speeding up our train terminals, and building power plants in the costliest nation in the world to build is a huge undertaking that people are not appreciating when they say “well, we’ll just make it in America”.</p></div></li><li><div><p><strong>Made in America will take time.</strong></p><p>We placed a $50,000 order with our supplier overseas before the election in November 2024. At the time of ordering, there were no import taxes on the goods. By the time it arrived, a 20% tariff had been applied and we had a surprise bill for $10,000. It can easily take 180 days for many products to go from order, to on your doorstep and this tariff policy seems not to understand that.</p><p>It takes at least, in the most favorable of jurisdictions, 2 years (if you can get the permits) to build a factory in the United States. I know because I’ve done it. From there, it can take 6 months to a year for it to become efficient. It can take months for products to come off the assembly lines. All this ignores all the infrastructure that will need to be built (new roads, new power plants, etc.) to service the new factory.</p><p>By the time “made in America” has begun, we will be electing a new president.</p></div></li><li><div><p><strong>Uncertainty and complexity around the tariffs</strong>To start manufacturing in the United States, a company needs to make a large investment. They will need to buy new machinery and if no existing building is suitable, they will need to construct a new building. These things cost money, a lot, in fact. And significantly more in the USA, than they do in other countries. In exchange for this risk, there must be some reward. If that reward is uncertain, no one will do it.</p><p>Within the past month, the president put a 25% tariff on Mexico, and then got rid of it, only to apply it again, and then get rid of it a second time. Then, last week, he was expected to apply new tariffs to Mexico, but didn’t.</p><p>If you’re building a new factory in the United States, your investment will alternate between maybe it will work, and catastrophic loss according to which way the tariffs and the wind blows. No one is building factories right now, and no one is renting them, because there is no certainty that any of these tariffs will last. How do I know? I built a factory in Austin, Texas in an industrial area. I cut its rent 40% two weeks ago and I can’t get a lick of interest from industrial renters.</p><p>The tariffs have frozen business activity because no one wants to take a big risk dependent on a policy that may change next week.</p><p>Even further, the tariffs are confusing, poorly communicated, and complex. Today, if you want to import something from China, you need to add the original import duty, plus a 20% “fentanyl tariff”, plus a 34% “reciprocal tariff”, and an additional 25% “Venezuelan oil” tariff, should it be determined that China is buying Venezualan oil. The problem is there is no list of countries which are importing Venezuelan oil provided by the White House, so you don’t know if you do or don’t need to add that 25% and you also don’t know when any of these tariffs will go into effect because of unclear language.</p><p>As such, you can’t calculate your costs, either with certainty or accuracy, therefore, not only do you not build a factory in the United States, you cease all business activity, the type of thing that can cause a recession, if not worse.</p><p>For the past month, as someone who runs a business in this industry, I have spent a huge portion of my time just trying to keep up with the constant changes, instead of running my business. </p></div></li><li><div><p><strong>Most Americans are going to hate manufacturing</strong></p><p>Americans want less crime, good schools for their kids, and inexpensive healthcare.</p><p>They don’t want to be sewing shirts.</p><p>The people most excited about this new tariff policy tend to be those who’ve never actually made anything, because if you have, you’d know how hard the work is.</p><p>When I first went to China as a naive 24 year old, I told my supplier I was going to “work a day in his factory!” I lasted 4 hours. It was freezing cold, middle of winter, I had to crouch on a small stool, hunched over, assembling little parts with my fingers at 1/4 the speed of the women next to me. My back hurt, my fingers hurt. It was horrible. That’s a lot of manufacturing.</p><p>And enjoy the blackouts, the dangerous trucks on the road, the additional pollution, etc. Be careful what you wish for America. Doing office work and selling ideas and assets is a lot easier than making actual things.</p></div></li><li><div><p><strong>The labor does not exist to make good products</strong>There are over a billion people in China making stuff. As of right now there are 12 million people looking for work in the United States (4% unemployment). Ignoring for a moment the comparative inefficiency of labor and the billions of people making products outside of China, where are the people that are going to do these jobs? Do you simply say “make America great again” 3 times and they will appear with the skills needed to do the work?</p><p>And where are the managers to manage these people? One of the reasons why manufacturing has declined in the United States is a brain drain towards sectors that make more money. Are people who make money on the stock market, in real estate, in venture capital, and in startups going to start sewing shirts? It’s completely and totally unrealistic to assume that people will move from superficially high productivity sectors driven by US Dollar strength to products that are low on the value chain.</p><p>The United States is trying to bring back the jobs that China doesn’t even want. They have policies to reduce low value manufacturing, yet we are applying tariffs to bring it back. It’s incomprehensible.</p></div></li><li><div><p><strong>Automation will not save us.</strong>Most people think that the reason why American manufacturing is not competitive is labor costs. Most people think this can be solved by automation.</p><p>They’re wrong.</p><p>First, China, on a yearly basis installs 7x as many industrial robots as we do in the United States. Second, Chinese robots are cheaper. Third, most of today’s manufacturing done by people cannot be automated. If it could, it would have already been done so, by China, which, again, has increasingly high labor costs relative to the rest of the world.</p><p>The robots you see on social media doing backflips are, today, mostly for show and unreliable off camera. They are not useful in industrial environments where, if a humanoid robot can do it, an industrial machine which is specialized in the task can do it even better. For example, instead of having a humanoid robot doing a repetitive task such as carrying a boxes from one station to another, you can simply set up a cheaper, faster conveyor belt.</p><p>Said another way, the printer in your office, is cheaper and more efficient than both a human and a humanoid robot with a pen, hand drawing each letter.</p><p>It’s unlikely that American ingenuity will be able to counter the flood of Chinese industrial robots which is coming. The first commercially electrical vehicle was designed and built in the United States, but today China is dominating electric vehicle manufacturing across the world. Industrial robots will likely be the same story.</p></div></li><li><div><p><strong>Robots and overseas factory workers don’t file lawsuits, but Americans do</strong>I probably should not have written this article. Not only will I be attacked for being unpatriotic, but what I have written here makes me susceptible to employment lawsuits. For the record, I don’t use a person’s origin to determine whether or not they will do good work. I just look at the person and what they’re capable of. Doing otherwise is bad business because there are talented people everywhere.</p><p>America has an extremely litigious business environment, both in terms of regulation and employment lawsuits. Excessive regulation and an inefficient court system will stifle those with the courage to make in this country.</p></div></li><li><div><p><strong>Enforcement of the tariffs will be uneven and manipulated</strong>Imagine two companies which import goods into the United States. One is based in China, while the other is based in the United States. They both lie about the value of their goods so that they have to pay less tariffs. </p><p>What happens to the China company? Perhaps they lose a shipment when it’s seized by the US government for cheating, but they won’t pay additional fines because they’re in China, where they’re impervious to the US legal system.</p><p>What happens to the USA company? Owners go to prison.</p><p>Who do you think is going to cheat more on tariffs, the China or the US company? </p><p>Exactly.</p><p>So, in other words, paradoxically, the policies which are designed to help Americans, will hurt them more than the competition these policies are designed to punish.</p></div></li><li><div><p><strong>The tariff policies are structured in the wrong way</strong>Why didn’t the jobs come back in 2018 when we initiated our last trade war? We applied tariffs, why didn’t it work?</p><p>Instead of making America great, we made Vietnam great.</p><p>When the United States applied tariffs to China, it shifted huge amounts of manufacturing to Vietnam, which did not have tariffs applied to it. Vietnam, which has a labor force that is a lot more like China’s than the United States’, was able to use its proximity to China for its supply chain and over the past 7 or so years, slowly developed its own. With Vietnamese wages even lower than Chinese wages, instead of the jobs coming to the United States, they just went to Vietnam instead.</p><p>We’re about to make the same mistake again, in a different way.</p><p>Let’s go back to that last example, the China based and the US based companies which were importing goods into the United States. That US based importer could’ve been a manufacturer. Instead of finished iPhones, perhaps they were importing the glass screens because those could not be found in the USA, for final assembly.</p><p>Our government applied tariffs to finished goods and components equally.</p><p>I’ll say that again. They applied the same tax to the components that you need to make things in America that they did to finished goods that were made outside of America.</p><p>Manufacturing works on a lag. To make and sell in America, first you must get the raw materials and components. These tariffs will bankrupt manufacturers before it multiplies them because they need to pay tariffs on the import components that they assemble into finished products.</p><p>And it gets worse.</p><p>They put tariffs on machines. So if you want to start a factory in the United States, all the machinery you need which is not made here, is now significantly more expensive. You may have heard that there is a chronic shortage of transformers needed for power transmission in the United States. Tariffed that too.</p><p>It gets even worse.</p><p>There is no duty drawback for exporting. In the past, even in the United States, if you imported something and then exported it, the tariff you paid on the import would be refunded to you. They got rid of that so we’re not even incentivizing exports to the countries that we are trying to achieve trade parity with.</p><p>Tariffs are applied to the costs of the goods. The way we’ve structured these tariffs, factories in China which import into the United States will pay lower tariffs than American importers, because the Chinese factory will be able to declare the value of the goods at their cost, while the American importer will pay the cost the factory charges them, which is of course higher than the factory’s cost.</p><p>Worse still.</p><p>With a few exceptions like steel and semiconductors, the tariffs were applied to all products, ranging from things that we will never realistically make like our high labor <a href="https://tigerharttoys.com/" target="_blank">Tigerhart stuffed animals</a> to things that don’t even grow in the continental USA, like coffee.</p><p>Call me crazy, but if we’re going to make products in America, we could use some really cheap coffee, but no, they tariffed it! Our educational <a href="https://brainflakes.com/" target="_blank">engineering toy Brain Flakes</a>, also got tariffed. How is the next generation supposed to build a manufacturing powerhouse if it cannot afford products that will develop its engineering ability? It’s like our goal was to make education and raising children more expensive.</p><p>Not only did we put tariffs on the things that would help us make this transformation, we didn’t put higher tariffs on things that hurt us like processed food which makes us tired and fat or fentanyl precursors which kill us.</p><p>The stated goal of many of our tariffs was to stop the import of fentanyl. 2 milligrams of fentanyl will kill an adult. A grain of rice is 65 milligrams. How do you stop that stuff from coming in? It’s basically microscopic.</p><p>Maybe we could do what every other country has done and focus on the demand, instead of the supply, ideally starting with the fentanyl den near my house which keeps my children indoors or in our backyard instead of playing in the neighborhood.</p><p>It’s frustrating to see our great country take on an unrealistic goal like transforming our economy, when so many basic problems should be fixed first.</p></div></li><li><div><p><strong>Michael Jordan sucked at baseball</strong></p><p>America is the greatest economic power of all time. We’ve got the most talented people in the world and we have a multi-century legacy of achieving what so many other countries could not.</p><p>Michael Jordan is arguably the greatest basketball player of all time, perhaps even the greatest athlete of all time.</p><p>He played baseball in his youth. What happened when he switched from basketball to baseball? He went from being an MVP champion to being a middling player in the minor leagues. 2 years later, he was back to playing basketball.</p><p>And that’s exactly what’s going to happen to us.</p></div></li></ol><h3>My prediction for what will happen with the tariffs</h3><div><p>This is probably the worst economic policy I’ve ever seen. Maybe it’s just an opening negotiating position. Maybe it’s designed to crash the economy, lower interest rates, and then refinance the debt. I don’t know.</p><p>But if you take it at face value, there is no way that this policy will bring manufacturing back to the United States and “make America wealthy again”. Again, if anything, it’ll do the opposite; it’ll make us much poorer.</p><p>Many are saying that this tariff policy is the “end of globalization”. I don’t think so.</p><p>Unless this policy is quickly changed, this is the end of America’s participation in globalization. If we had enacted these policies in 2017 or 2018, they stood a much stronger chance of being successful. That was before Covid. China was much weaker economically and militarily then. They’ve been preparing 8 years for this moment and they are ready.</p><p>China trades much less with the United States as a percent of its total exports today than it did 8 years ago, and as such is much less susceptible to punishing tariffs from the United States today than it was back then.</p><p>Chinese made cars, particularly electric vehicles, are taking the world by storm, without the United States. Go to Mexico to Thailand to Germany and you will see Chinese made electric vehicles on the streets. And they’re good, sometimes even better than US made cars, and not just on a per dollar basis, but simply better quality.</p><p>That is what is going to happen to the United States. Globalization will continue without us if these policies continue unchanged.</p><p>That said, I think the tariffs will be changed. There’s no way we continue to place a 46% tariff on Vietnam when 8 years ago we nudged American companies to put all their production there.  Most likely, this policy will continue another round of the same type of investment; rather than replacing made in China with made in the USA, we’ll replace it with made in Vietnam, Mexico, etc.</p><p>Finally, in the process of doing this, regardless of whether or not we reverse the policies, we will have a recession. There isn’t time to build US factories, nor is it realistic or likely to occur, and American importers don’t have the money to pay for the goods they import.</p><p>People are predicting inflation in the cost of goods, but we can just as easily have deflation from economic turmoil.</p><p>The policy is a disaster, how could it be done better? And what’s the point of this anyways?</p></div><h3>The 3 reasons why we want to actually bring manufacturing back</h3><p><br>1. It makes our country stronger. If a foreign country can cut off your supply of essentials such as food, semiconductors, or antibiotics you’re beholden to that country. The United States must have large flexible capacity in these areas.</p><p>2. It makes it easier to innovate. When the factory floor is down the hall, instead of 30 hours of travel away, it’s easier to make improvements and invent. We need to have manufacturing of high value goods, like drones, robots, and military equipment that are necessary for our economic future and safety. It will be difficult for us to apply artificial intelligence to manufacturing if we’re not doing it here.</p><p>3. People can simplistically be divided into three buckets: those of verbal intelligence, those of mathematical intelligence, and those of spatial intelligence. Without a vibrant manufacturing industry, those with the latter type of intelligence cannot fulfill their potential. This is one reason why so many men drop out, smoke weed, and play video games; they aren’t built for office jobs and would excel at manufacturing, but those jobs either don’t exist or pay poorly.</p><h3>How to actually bring manufacturing back</h3><div><p>Every country that has gone on a brilliant run of manufacturing first established the right conditions and then proceeded slowly.</p><p>We’re doing the opposite right now, proceeding fast with the wrong conditions.</p><p>First, the United States must fix basic problems which reduce the effectiveness of our labor. For example, everyone needs to be able to graduate with the ability to do basic mathematics. American healthcare is way too expensive and it needs to be fixed if the United States wants to be competitive with global labor. I’m not saying healthcare should be socialized or switched to a completely private system, but whatever we’re doing now clearly is not working, and it needs to be fixed.</p><p>We need to make Americans healthy again. Many people are too obese to work. Crime and drugs. It needs to stop.</p><p>And to sew, we must first repair the social fabric.</p><p>From Covid lockdowns to the millions of people who streamed over our border, efforts must be made to repair society. Manufacturing and economic transformations are hard, particularly the way in which we’re doing it. Patriotism and unity are required to tolerate hardship, and we seem to be at all-time lows for those right now.</p><p>Let’s focus on America’s strengths in high end manufacturing, agriculture, and innovation instead of applying tariffs to all countries and products blindly. We should be taxing automated drones for agriculture at 300% to encourage their manufacture here, instead of applying the same blanket tariff of 54% to that that we apply to t-shirts.</p><p>The changes in the policies needed are obvious. Tax finished products higher than components. Let exporters refund their import duties. Enforce the tariffs against foreign companies more strenuously than we do against US importers.</p><p>If American companies want to sell in China, they must incorporate there, register capital, and name a person to be a legal representative. To sell in Europe, we must register for their tax system and nominate a legal representative. For Europeans and Chinese to sell in the United States, none of this is needed, nor do federal taxes need to be paid.</p><p>We can level the playing field without causing massive harm to our economy by adopting policies like these which cause foreign companies to pay the taxes domestic ones pay.</p><p>And if we want to apply tariffs, do it slowly. Instead of saying that products will be tariffed at 100% tomorrow, say they’ll be 25% next year, 50% after that, 75% after that, and 100% in year four. And then make it a law instead of a presidential decree so that there is certainty so people feel comfortable taking the risks necessary to make in America.</p></div><p>Sadly, a lot of the knowhow to make products is outside of this country. Grant manufacturing visas, not for labor, but for knowhow. Make it easy for foreign countries to teach us how they do waht they do best.</p><h3>Conclusion and final thoughts</h3><p>I care about this country and the people in it. I hope we change our mind on this policy before it’s too late. Because if we don’t, it might break the country. And, really, this country needs to be fixed.</p>
</div>
  
</article>

</div>

  
</article>


          

          
            
              

            
          
        
      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[HNInternal: Launch HN: mrge.io (YC X25) – Cursor for code review (188 pts)]]></title>
            <link>https://news.ycombinator.com/item?id=43692476</link>
            <guid>43692476</guid>
            <pubDate>Tue, 15 Apr 2025 13:34:21 GMT</pubDate>
            <description><![CDATA[<p>See on <a href="https://news.ycombinator.com/item?id=43692476">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        <tbody><tr id="43692476">
      <td><span></span></td>      <td><center><a id="up_43692476" href="https://news.ycombinator.com/vote?id=43692476&amp;how=up&amp;goto=item%3Fid%3D43692476"></a></center></td><td><span><a href="https://news.ycombinator.com/item?id=43692476">Launch HN: mrge.io (YC X25) – Cursor for code review</a></span></td></tr><tr><td colspan="2"></td><td><span>
          <span id="score_43692476">111 points</span> by <a href="https://news.ycombinator.com/user?id=pomarie">pomarie</a> <span title="2025-04-15T13:34:21 1744724061"><a href="https://news.ycombinator.com/item?id=43692476">4 hours ago</a></span> <span id="unv_43692476"></span> | <a href="https://news.ycombinator.com/hide?id=43692476&amp;goto=item%3Fid%3D43692476">hide</a> | <a href="https://hn.algolia.com/?query=Launch%20HN%3A%20mrge.io%20%28YC%20X25%29%20%E2%80%93%20Cursor%20for%20code%20review&amp;type=story&amp;dateRange=all&amp;sort=byDate&amp;storyText=false&amp;prefix&amp;page=0">past</a> | <a href="https://news.ycombinator.com/fave?id=43692476&amp;auth=438905132074b5697342bcc8a5dee0b9b512a7a5">favorite</a> | <a href="https://news.ycombinator.com/item?id=43692476">69&nbsp;comments</a>        </span>
              </td></tr>
    <tr><td></td></tr><tr><td colspan="2"></td><td><div><p>Hey HN, we’re building mrge (<a href="https://www.mrge.io/home">https://www.mrge.io/home</a>), an AI code review platform to help teams merge code faster with fewer bugs. Our early users include Better Auth, Cal.com, and n8n—teams that handle a lot of PRs every day.</p><p>Here’s a demo video: <a href="https://www.youtube.com/watch?v=pglEoiv0BgY" rel="nofollow">https://www.youtube.com/watch?v=pglEoiv0BgY</a></p><p>We (Allis and Paul) are engineers who faced this problem when we worked together at our last startup. Code review quickly became our biggest bottleneck—especially as we started using AI to code more. We had more PRs to review, subtle AI-written bugs slipped through unnoticed, and we (humans) increasingly found ourselves rubber-stamping PRs without deeply understanding the changes.</p><p>We’re building mrge to help solve that. Here’s how it works:</p><p>1. Connect your GitHub repo via our Github app in two clicks (and optionally download our desktop app). Gitlab support is on the roadmap!</p><p>2. AI Review: When you open a PR, our AI reviews your changes directly in an ephemeral and secure container. It has context into not just that PR, but your whole codebase, so it can pick up patterns and leave comments directly on changed lines. Once the review is done, the sandbox is torn down and your code deleted – we don’t store it for obvious reasons.</p><p>3. Human-friendly review workflow: Jump into our web app (it’s like Linear but for PRs). Changes are grouped logically (not alphabetically), with important diffs highlighted, visualized, and ready for faster human review.</p><p>The AI reviewer works a bit like Cursor in the sense that it navigates your codebase using the same tools a developer would—like jumping to definitions or grepping through code.</p><p>But a big challenge was that, unlike Cursor, mrge doesn’t run in your local IDE or editor. We had to recreate something similar entirely in the cloud.</p><p>Whenever you open a PR, mrge clones your repository and checks out your branch in a secure and isolated temporary sandbox.  We provision this sandbox with shell access and a Language Server Protocol (LSP) server. The AI reviewer then reviews your code, navigating the codebase exactly as a human reviewer would—using shell commands and common editor features like "go to definition" or "find references". When the review finishes, we immediately tear down the sandbox and delete the code—we don’t want to permanently store it for obvious reasons.</p><p>We know cloud-based review isn't for everyone, especially if security or compliance requires local deployments. But a cloud approach lets us run SOTA AI models without local GPU setups, and provide a consistent, single AI review per PR for an entire team.</p><p>The platform itself focuses entirely on making <i>human</i> code reviews easier. A big inspiration came from productivity-focused apps like Linear or Superhuman, products that show just how much thoughtful design can impact everyday workflows. We wanted to bring that same feeling into code review.</p><p>That’s one reason we built a desktop app. It allowed us to deliver a more polished experience, complete with keyboard shortcuts and a snappy interface.</p><p>Beyond performance, the main thing we care about is making it easier for humans to read and understand code. For example, traditional review tools sort changed files alphabetically—which forces reviewers to figure out the order in which they should review changes. In mrge, files are automatically grouped and ordered based on logical connections, letting reviewers immediately jump in.</p><p>We think the future of coding isn’t about AI replacing humans—it’s about giving us better tools to quickly understand high-level changes, abstracting more and more of the code itself. As code volume continues to increase, this shift is going to become increasingly important.</p><p>You can sign up now (<a href="https://www.mrge.io/home">https://www.mrge.io/home</a>). mrge is currently free while we're still early. Our plan for later is to charge closed-source projects on a per-seat basis, and to continue giving mrge away for free to open source ones.</p><p>We’re very actively building and would love your honest feedback!</p></div></td></tr>        <tr><td></td></tr><tr><td colspan="2"></td><td></td></tr>  </tbody></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How the U.S. Became a Science Superpower (306 pts)]]></title>
            <link>https://steveblank.com/2025/04/15/how-the-u-s-became-a-science-superpower/</link>
            <guid>43692360</guid>
            <pubDate>Tue, 15 Apr 2025 13:24:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://steveblank.com/2025/04/15/how-the-u-s-became-a-science-superpower/">https://steveblank.com/2025/04/15/how-the-u-s-became-a-science-superpower/</a>, See on <a href="https://news.ycombinator.com/item?id=43692360">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

					<p>Prior to WWII the U.S was a distant second in science and engineering. By the time the war was over, U.S. science and engineering had blown past the British, and led the world for 85 years.</p>
<hr>
<p>It happened because two very different people were the science advisors to their nation’s leaders. Each had radically different views on how to use their country’s resources to build advanced weapon systems. Post war, it meant Britain’s early lead was ephemeral while the U.S. built the foundation for a science and technology innovation ecosystem that led the world – until now.</p>
<p><strong>The British – Military Weapons Labs<br>
</strong>When Winston Churchill became the British prime minister in 1940, he had at his side his science advisor, Professor Frederick Lindemann, his friend for 20 years. Lindemann headed up the physics department at Oxford and was the director of the Oxford <a href="https://en.wikipedia.org/wiki/Clarendon_Laboratory">Clarendon Laboratory</a>. Already at war with Germany, Britain’s wartime priorities focused on defense and intelligence technology projects, e.g. weapons that used electronics, radar, physics, etc. – a <a href="https://en.wikipedia.org/wiki/Chain_Home">radar-based air defense network</a> called Chain Home, <a href="https://en.wikipedia.org/wiki/AI_Mark_VIII_radar">airborne radar on night fighters</a>, and plans for a nuclear weapons program – the <a href="https://en.wikipedia.org/wiki/MAUD_Committee">MAUD Committee</a> which started the British nuclear weapons program code-named <a href="https://en.wikipedia.org/wiki/Tube_Alloys">Tube Alloys</a>. And their codebreaking organization at Bletchley Park was starting to read secret German messages – the Enigma – using the <a href="https://en.wikipedia.org/wiki/Colossus_computer">earliest computers</a> ever built.</p>
<p><a href="https://www.amazon.com/Prof-life-times-Frederick-Lindemann/dp/0224063170"><img data-recalc-dims="1" fetchpriority="high" decoding="async" data-attachment-id="32256" data-permalink="https://steveblank.com/2025/04/15/how-the-u-s-became-a-science-superpower/lindemann-book-cover/" data-orig-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?fit=311%2C475&amp;ssl=1" data-orig-size="311,475" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Lindemann Book cover" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?fit=196%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?fit=311%2C475&amp;ssl=1" src="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?resize=254%2C388&amp;ssl=1" alt="" width="254" height="388" srcset="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?w=311&amp;ssl=1 311w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?resize=196%2C300&amp;ssl=1 196w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Lindemann-Book-cover.jpg?resize=98%2C150&amp;ssl=1 98w" sizes="(max-width: 254px) 100vw, 254px"></a></p>
<p>As early as the mid 1930s, the British, fearing Nazi Germany, developed prototypes of these weapons using their existing military and government research labs. The <a href="https://en.wikipedia.org/wiki/Telecommunications_Research_Establishment">Telecommunications Research Establishment</a> built early-warning Radar, critical to Britain’s survival during the <a href="https://en.wikipedia.org/wiki/Battle_of_Britain">Battle of Britain</a>, and electronic warfare to protect British bombers over Germany. The <a href="https://en.wikipedia.org/wiki/Admiralty_Research_Laboratory">Admiralty Research Lab</a> built Sonar and anti-submarine warfare systems. The Royal Aircraft Establishment was developing <a href="https://en.wikipedia.org/wiki/Gloster_Meteor">jet fighters</a>. The labs then contracted with British companies to manufacture the weapons in volume. British government labs viewed their universities as a source of talent, but they had no role in weapons development.</p>
<p>Under Churchill, Professor Lindemann influenced which projects received funding and which were sidelined. Lindemann’s WWI experience as a researcher and test pilot on the staff of the&nbsp;<a href="https://en.wikipedia.org/wiki/Royal_Aircraft_Factory">Royal Aircraft Factory</a>&nbsp;at&nbsp;<a href="https://en.wikipedia.org/wiki/Farnborough,_Hampshire">Farnborough</a> gave him confidence in the competence of British military research and development labs. His <em>top-down, centralized approach</em> <em>with weapons</em><em> development </em>primarily<em> in government research labs</em> shaped British innovation during WW II – and led to its demise post-war.</p>
<p><strong>The Americans – University Weapons Labs<br>
</strong>Unlike Britain, the U.S. lacked a science advisor. It wasn’t until June 1940, that Vannevar Bush, ex-MIT dean of engineering, told President Franklin Roosevelt that World War II would be the first war won or lost on the basis of advanced technology electronics, radar, physics problems, etc.</p>
<p><a href="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?ssl=1"><img data-recalc-dims="1" decoding="async" data-attachment-id="32254" data-permalink="https://steveblank.com/2025/04/15/how-the-u-s-became-a-science-superpower/bush-on-time-cover/" data-orig-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?fit=337%2C447&amp;ssl=1" data-orig-size="337,447" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Bush on Time Cover" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?fit=226%2C300&amp;ssl=1" data-large-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?fit=337%2C447&amp;ssl=1" src="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?resize=259%2C343&amp;ssl=1" alt="" width="259" height="343" srcset="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?w=337&amp;ssl=1 337w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?resize=226%2C300&amp;ssl=1 226w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Bush-on-Time-Cover.jpg?resize=113%2C150&amp;ssl=1 113w" sizes="(max-width: 259px) 100vw, 259px"></a>Unlike Lindemann, Bush had a 20-year-long contentious history with the U.S. Navy and a dim view of government-led R&amp;D. Bush contended that the government research labs were slow and second rate. He convinced the President that while the Army and Navy ought to be in charge of making conventional weapons – planes, ships, tanks, etc. — scientists from academia could develop better&nbsp;advanced technology weapons and deliver them faster than Army and Navy research labs. And he argued the only way the scientists could be productive was if they worked in a university setting in <em>civilian-run</em> weapons labs run by university professors. To the surprise of the Army and Navy Service chiefs, Roosevelt agreed to let Bush build exactly that organization to coordinate and fund all advanced weapons <em>research</em>.</p>
<p>(While Bush had no prior relationship with the President, Roosevelt had been the Assistant Secretary of the Navy during World War I and like Bush had seen first-hand its dysfunction. Over the next four years they worked well together. Unlike Churchill, Roosevelt had little interest in science and accepted Bush’s opinions on the direction of U.S. technology programs, giving Bush sweeping authority.)</p>
<p>In 1941, Bush upped the game by convincing the President that in addition to research, <em>development, acquisition and deployment of these weapons also ought to be done by professors in universities</em>. There they would be tasked to <a href="http://www.amazon.com/Scientists-against-James-Phinney-Baxter/dp/0262520125/">develop military weapons systems and solve military problems</a> to defeat Germany and Japan. (The weapons were then manufactured in volume by U.S. corporations Western Electric, GE, RCA, Dupont, Monsanto, Kodak, Zenith, Westinghouse, Remington Rand and Sylvania.) To do this Bush created the&nbsp;Office of Scientific Research and Development (OSR&amp;D).</p>
<p><a href="http://www.archives.gov/research/guide-fed-records/groups/227.html#227.1">OSR&amp;D</a> headquarters divided the wartime work into 19 “divisions,” 5 “committees,” and 2 “panels,” each solving a unique part of the military war effort. There were no formal requirements.</p>
<p><a href="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?ssl=1"><img data-recalc-dims="1" decoding="async" data-attachment-id="32153" data-permalink="https://steveblank.com/?attachment_id=32153" data-orig-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?fit=1260%2C1135&amp;ssl=1" data-orig-size="1260,1135" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Office of Science Research and Development" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?fit=300%2C270&amp;ssl=1" data-large-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?fit=468%2C421&amp;ssl=1" src="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?resize=468%2C421&amp;ssl=1" alt="" width="468" height="421" srcset="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?resize=1024%2C922&amp;ssl=1 1024w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?resize=300%2C270&amp;ssl=1 300w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?resize=150%2C135&amp;ssl=1 150w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?resize=768%2C692&amp;ssl=1 768w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?w=1260&amp;ssl=1 1260w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Office-of-Science-Research-and-Development.jpg?w=936&amp;ssl=1 936w" sizes="(max-width: 468px) 100vw, 468px"></a>Staff at OSRD worked with their military liaisons to understand what the most important military problems were and then each OSR&amp;D division came up with solutions. These efforts spanned an enormous range of tasks – the development of advanced electronics, radar, <a href="http://calteches.library.caltech.edu/3672/1/Snyder.pdf">rockets</a>, <a href="https://dosits.org/people-and-sound/history-of-underwater-acoustics/world-war-ii-1941-1945/">sonar</a>, new weapons like the <a href="https://en.wikipedia.org/wiki/Proximity_fuze#:~:text=Work%20on%20the%20radio%20shell,innovations%20of%20World%20War%20II.">proximity fuse</a>, <a href="http://www.globalsecurity.org/military/systems/munitions/napalm.htm">Napalm</a>, the Bazooka and new drugs such as <a href="http://www.lib.niu.edu/2001/iht810139.html">penicillin</a>, cures for malaria, chemical warfare, and <a href="https://steveblank.com/2023/08/29/before-there-was-oppenheimer-there-was-vannevar-bush/">nuclear weapons</a>.</p>
<p>Each&nbsp; division was run by a professor hand-picked by Bush. And they were located in universities –&nbsp; MIT, Harvard, Johns Hopkins, Caltech, Columbia and the University of Chicago all ran major weapons systems programs. Nearly 10,000 scientists and engineers, professors and their grad students received draft deferments to work in these university labs.</p>
<p><strong>Americans – Unlimited Dollars<br>
</strong>What changed U.S. universities, and the world forever, was government money. Lots of it. Prior to WWII most advanced technology research in the U.S. was done in corporate innovation labs (GE, AT&amp;T, Dupont, RCA, Westinghouse, NCR, Monsanto, Kodak, IBM, et al.) Universities had no government funding (<a href="https://www.congress.gov/crs-product/R45897" target="_blank" rel="noopener">except for agriculture</a>) for research. Academic research had been funded by non-profits, mostly the Rockefeller and Carnegie foundations and industry. Now, for the first time, U.S. universities were getting more money than they had ever seen. Between 1941 and 1945, OSR&amp;D gave $9 billion (in 2025 dollars) to the top U.S. research universities. This made universities full partners in wartime research, not just talent pools for government projects as was the case in Britain.</p>
<p><strong>The British – Wartime Constraints<br>
</strong>Wartime Britain had very different constraints. First, England was under daily attack.<a href="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?ssl=1"><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="32262" data-permalink="https://steveblank.com/2025/04/15/how-the-u-s-became-a-science-superpower/blitz-aftermath/" data-orig-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?fit=1920%2C1499&amp;ssl=1" data-orig-size="1920,1499" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Blitz aftermath" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?fit=300%2C234&amp;ssl=1" data-large-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?fit=468%2C365&amp;ssl=1" src="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?resize=252%2C197&amp;ssl=1" alt="" width="252" height="197" srcset="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?resize=300%2C234&amp;ssl=1 300w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?resize=1024%2C799&amp;ssl=1 1024w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?resize=150%2C117&amp;ssl=1 150w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?resize=768%2C600&amp;ssl=1 768w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?resize=1536%2C1199&amp;ssl=1 1536w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?w=1920&amp;ssl=1 1920w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?w=936&amp;ssl=1 936w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/Blitz-aftermath.jpg?w=1404&amp;ssl=1 1404w" sizes="auto, (max-width: 252px) 100vw, 252px"></a> They were being bombed by air and blockaded by submarines, so it was logical that they <a href="https://www.youtube.com/watch?v=C6uV-BojTw4">focused on a smaller set of high-priority projects</a> to counter these threats. Second, the country was teetering on bankruptcy. It couldn’t afford the broad and deep investments that the U.S. made. (Illustrated by their abandonment of their nuclear weapons programs when they realized how much it would cost to turn the research into industrial scale engineering.) This meant that many other areas of innovation—such as early computing and nuclear research—were underfunded compared to their American counterparts.</p>
<p><strong>Post War – Britain<br>
</strong>Churchill was voted out of office in 1945. With him went Professor Lindemann and the coordination of British science and engineering. Britain would be without a science advisor until 1951-55 when Churchill returned for a second term and brought back Lindemann with him.</p>
<p>The end of the war led to extreme downsizing of the British military including severe cuts to all the government labs that had developed Radar, electronics, computing, etc.</p>
<p>With post-war Britain financially exhausted, post-war austerity limited its ability to invest in large-scale innovation. There were no post-war plans for government follow-on investments. The differing economic realities of the U.S. and Britain also played a key role in shaping their innovation systems. The United States had an enormous industrial base, abundant capital, and a large domestic market, which enabled large-scale investment in research and development. In Britain, a socialist government came to power. Churchill’s successor, Labor’s Clement Attlee, dissolved the British empire, nationalized banking, power and light, transport, and iron and steel, all which reduced competition and slowed technological progress.</p>
<p>While British research institutions like Cambridge and Oxford remained leaders in theoretical science, they struggled to scale and commercialize their breakthroughs. For instance Alan Turing’s and Tommy Flower’s pioneering work on <a href="https://www.tnmoc.org/colossus" target="_blank" rel="noopener">computing at Bletchley Park</a> didn’t turn into a thriving British computing industry—unlike in the U.S., where companies like ERA, Univac, NCR and IBM built on their wartime work.</p>
<p>Without the same level of government support for dual-use technologies or commercialization, and with private capital absent for new businesses, Britain’s post-war innovation ecosystem never took off.</p>
<p><strong>Post War – The U.S.<br>
</strong>Meanwhile in the U.S. universities and companies realized that the wartime government funding for research had been an amazing accelerator for science, engineering, and medicine. Everyone, including Congress, agreed that the U.S. government should continue to play a large role in continuing it. In 1945, Vannevar Bush published a report “<a href="https://nsf-gov-resources.nsf.gov/2023-04/EndlessFrontier75th_w.pdf">Science, The Endless Frontier</a>” advocating for government funding of basic research in universities, colleges, and research institutes. Congress argued on how to best organize federal support of science.</p>
<p>By the end of the war, OSR&amp;D funding had taken technologies that had been just research papers or considered impossible to build at scale and made them commercially viable – computers, rockets, radar, Teflon, synthetic fibers, nuclear power, etc. Innovation clusters formed around universities like MIT and Harvard which had received large amounts of OSR&amp;D funding (<a href="https://en.wikipedia.org/wiki/MIT_Radiation_Laboratory">MIT’s Radiation Lab or “Rad Lab”</a> employed 3,500 civilians during WWII and developed and built 100 radar systems deployed in theater,) or around professors who ran one of the OSR&amp;D divisions – like <a href="https://steveblank.com/2009/04/27/the-secret-history-of-silicon-valley-part-vi-the-secret-life-of-fred-terman-and-stanford/">Fred Terman at Stanford</a>.</p>
<p>When the war ended, the <a href="https://en.wikipedia.org/wiki/United_States_Atomic_Energy_Commission" target="_blank" rel="noopener">Atomic Energy Commission</a> spun out of the <a href="https://en.wikipedia.org/wiki/Manhattan_Project" target="_blank" rel="noopener">Manhattan Project</a> in 1946 and the military services took back advanced weapons development. In 1950 Congress set up the <a href="https://www.nsf.gov/" target="_blank" rel="noopener">National Science Foundation</a> to fund all basic science in the U.S. (except for Life Sciences, a role the new <a href="https://www.nih.gov/" target="_blank" rel="noopener">National Institutes of Health</a> would assume.) Eight years later <a href="https://www.darpa.mil/" target="_blank" rel="noopener">DARPA</a> and <a href="https://www.nasa.gov/" target="_blank" rel="noopener">NASA</a> would also form as federal research agencies.</p>
<p><a href="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?ssl=1"><img data-recalc-dims="1" loading="lazy" decoding="async" data-attachment-id="32155" data-permalink="https://steveblank.com/?attachment_id=32155" data-orig-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?fit=1447%2C1072&amp;ssl=1" data-orig-size="1447,1072" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="OSRD Genealogy" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?fit=300%2C222&amp;ssl=1" data-large-file="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?fit=468%2C347&amp;ssl=1" src="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?resize=468%2C347&amp;ssl=1" alt="" width="468" height="347" srcset="https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?resize=1024%2C759&amp;ssl=1 1024w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?resize=300%2C222&amp;ssl=1 300w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?resize=150%2C111&amp;ssl=1 150w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?resize=768%2C569&amp;ssl=1 768w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?w=1447&amp;ssl=1 1447w, https://i0.wp.com/steveblank.com/wp-content/uploads/2025/04/OSRD-Genealogy.jpg?w=936&amp;ssl=1 936w" sizes="auto, (max-width: 468px) 100vw, 468px"></a>Ironically, Vannevar Bush’s influence would decline even faster than Professor Lindemann’s. When President Roosevelt died in April 1945 and Secretary of War Stimson retired in September 1945, all the knives came out from the military leadership Bush had bypassed in the war. His arguments on how to reorganize OSR&amp;D made more enemies in Congress. By 1948 Bush had retired from government service. He would never again play a role in the U.S. government.</p>
<p><strong>Divergent Legacies<br>
</strong>Britain’s focused, centralized model using government research labs was created in a struggle for short-term survival. They achieved brilliant breakthroughs but lacked the scale, integration and capital needed to dominate in the post-war world.</p>
<p>The U.S. built a decentralized, collaborative ecosystem, one that tightly integrated massive government funding of universities for research and prototypes while private industry built the solutions in volume.</p>
<p>A key component of this U.S. research ecosystem was the genius of the <a href="https://www.insidehighered.com/news/government/science-research-policy/2025/04/14/doe-puts-15-cap-universities-indirect-research" target="_blank" rel="noopener">indirect cost reimbursement system</a>. Not only did the U.S. fund researchers in universities by paying the cost of their salaries, the U.S. gave universities money for the researchers facilities and administration. This was the secret sauce that allowed U.S. universities to build world-class labs for cutting-edge research that were the envy of the world. Scientists flocked to the U.S. causing other countries to complain of a “brain drain.”</p>
<p>Today, U.S. universities license 3,000 patents, 3,200 copyrights and 1,600 other licenses to technology startups and existing companies. Collectively, they spin out over 1,100 science-based startups each year, which lead to countless products and tens of thousands of new jobs. This university/government ecosystem became the blueprint for modern innovation ecosystems for other countries.</p>
<p><strong>Summary<br>
</strong>By the end of the war, the U.S. and British innovation systems had produced radically different outcomes. Both systems were influenced by the experience and personalities of their nations science advisor.</p>
<ul>
<li>Britain remained a leader in theoretical science and defense technology, but its socialist government economic policies led to its failure to commercialize wartime innovations.</li>
<li>The U.S. emerged as the global leader in science and technology, with innovations like electronics, microwaves, computing, and nuclear power driving its post-war economic boom.</li>
<li>The university-industry-government partnership became the foundation of Silicon Valley, the aerospace sector, and the biotechnology industry.</li>
<li>Today, China’s leadership has spent the last three decades investing heavily to surpass the U.S. in science and technology.</li>
<li>In 2025, with the abandonment of U.S. government support for university research, the long run of U.S. dominance in science may be over. Others will lead.</li>
</ul>
					
					<p>
						Filed under: <a href="https://steveblank.com/category/science-and-industrial-policy/" rel="category tag">Science and Industrial Policy</a> |					</p>

				</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Chroma, Ubisoft's internal tool used to simulate color-blindness, open sourced (200 pts)]]></title>
            <link>https://github.com/ubisoft/Chroma</link>
            <guid>43692089</guid>
            <pubDate>Tue, 15 Apr 2025 13:04:26 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/ubisoft/Chroma">https://github.com/ubisoft/Chroma</a>, See on <a href="https://news.ycombinator.com/item?id=43692089">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">Chroma</h2><a id="user-content-chroma" aria-label="Permalink: Chroma" href="#chroma"></a></p>
<p dir="auto"><strong>Chroma</strong> helps in simulating different types of color blindness occurring in society.</p>
<p dir="auto">Main purpose of this is to simulate 3 major <a href="https://en.wikipedia.org/wiki/Color_blindness" rel="nofollow">Color Blindness</a> types <em>Protanopia</em>, <em>Deuteranopia</em> and <em>Tritanopia</em> for our different games and aid accessibility team in performing various complex testing.</p>
<p dir="auto">Following are key features:</p>
<ul dir="auto">
<li>
<p dir="auto">Color Simulation on single monitor. This solution works on top of game and can be maximized as per requirement.</p>
</li>
<li>
<p dir="auto">Work on all games. No dependency on any specific game or engine.</p>
</li>
<li>
<p dir="auto">High performance. Able to simulation live gameplay upto 60 FPS.</p>
</li>
<li>
<p dir="auto">Accurate results.</p>
</li>
<li>
<p dir="auto">Simulation of all type of color blind forms.</p>
</li>
<li>
<p dir="auto">Only available solution which capture screen live gameplay screen and simulate.</p>
</li>
<li>
<p dir="auto">Easy screenshot to log error.</p>
</li>
<li>
<p dir="auto">Easy and configurable UI.</p>
</li>
<li>
<p dir="auto">For more details look into userguide <a href="https://github.com/ubisoft/Chroma/blob/main/source/Userguide.pdf">here</a>.</p>
</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Known Issue During CMake Process</h2><a id="user-content-known-issue-during-cmake-process" aria-label="Permalink: Known Issue During CMake Process" href="#known-issue-during-cmake-process"></a></p>
<p dir="auto">If you encounter the following error while running CMake without Visual Studio 2022:</p>
<div data-snippet-clipboard-copy-content="error C2039: 'wait_for': is not a member of 'winrt::impl'"><pre><code>error C2039: 'wait_for': is not a member of 'winrt::impl'
</code></pre></div>
<p dir="auto">This issue may occur due to an outdated <code>CPPWinRT</code> library. To resolve it, install the <code>Microsoft.Windows.CppWinRT</code> NuGet package using the following command:</p>
<div dir="auto" data-snippet-clipboard-copy-content="nuget install Microsoft.Windows.CppWinRT"><pre>nuget install Microsoft.Windows.CppWinRT</pre></div>
<p dir="auto">Alternatively, ensure that your development environment is using an updated version of <code>CPPWinRT</code>. <strong>The best option to avoid this issue is to use Visual Studio 2022.</strong></p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[WEIRD – a way to be on the web (101 pts)]]></title>
            <link>https://a.weird.one</link>
            <guid>43691891</guid>
            <pubDate>Tue, 15 Apr 2025 12:42:54 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://a.weird.one">https://a.weird.one</a>, See on <a href="https://news.ycombinator.com/item?id=43691891">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><!--[--><!--[--><!----><!----><p><img src="https://a.weird.one/stars.svg" alt=""></p> <section> <p><img src="https://a.weird.one/cloud.svg" alt=""></p> </section><!----> <section><div><h2>Cultivate your personal space on the interwebs</h2> <p>from scribble-saplings to digital garden, in communion with fellow
      weirdos.</p></div> <div><p>Weird is a brand new thing, but: Think of it as if <a href="https://wordpress.org/">WordPress</a> and <a href="https://notion.com/">Notion</a> had a Linktree-shaped baby. That is to say, a WordPress-type website engine
        with the editing experience of Notion and the simplicity of <a href="https://linktr.ee/">Linktree</a>.</p> </div></section><!----> <div><!----><!---
Each markdown "paragraph" will be a "marquee" message
They all display one after another horizontally

For now we just want to use paragraphs here and avoid stuff like
headings, links and so on even though they're supported. A link that's hard to click (because it moves) is bad UX
-->

<p>Say hello, again, to the weird web</p>
<p>Village-scale software 🏘️ </p>
<p>Like itch.io, but for any Open Web project </p>
<p>Like a distributed Wikipedia for projects</p>
<p>Like the internet archive for - you guessed it - projects 💫</p>
<p>A social network for your thoughts</p>
<p>An ecosystem for living ideas 🌱</p>
<!----></div><!----> <section><div><h2>Essentials</h2> <ul><!--[--><li><p><b>Digital homeownership:</b> <!--[--><!--[!--><a href="https://blog.muni.town/digital-homeownership/">Every profile on Weird-net is also a website</a><!--]--><!--[-->; use our (sub)domain or bring your own.<!--]--><!--]--></p></li><li><p><b>2-minute site creation:</b> <!--[--><!--[-->Escape the <!--]--><!--[!--><a href="https://blog.muni.town/content-imperative/">content-creation imperative</a><!--]--><!--[-->by grabbing whatever self-links you’ve got and re-consolidate your digital identity.<!--]--><!--]--></p></li><li><p><b>Reclaim your captured content:</b> <!--[--><!--[-->Automated pipelines for <!--]--><!--[!--><a href="https://blog.muni.town/data-defragmentation/">PESOS &amp; POSSE posting strategies</a><!--]--><!--[-->. Write (or at least post) like <!--]--><!--[!--><a href="https://www.mollywhite.net/">Molly White</a><!--]--><!--[--> and <!--]--><!--[!--><a href="https://pluralistic.net/">Cory Doctorow</a><!--]--><!--[-->!<!--]--><!--]--></p></li><li><p><b>Grow web gardens:</b> <!--[--><!--[-->Forget about chronological web logs, we're doing <!--]--><!--[!--><a href="https://maggieappleton.com/nontechnical-gardening">digital gardening</a><!--]--><!--[--> now. Casually plop your tiny blurb-seeds down and cultivate them at your leisure.<!--]--><!--]--></p></li><li><p><b>Enter the indieverse:</b> <!--[--><!--[-->Connect to the <!--]--><!--[!--><a href="https://github.com/muni-town/weird/discussions/283">WWWapps Directory&nbsp;weird#283</a><!--]--><!--[-->, outside the dreary confines of big tech. 🚧Coming soon<!--]--><!--]--></p></li><li><p><b>Find the others:</b> <!--[--><!--[-->Participate in the <!--]--><!--[!--><a href="https://blog.muni.town/chatty-community-gardens/">chatty community gardens</a><!--]--><!--[--> of <!--]--><!--[!--><a href="https://blog.muni.town/federated-webrings/">federated webrings</a><!--]--><!--[-->. 🚧Coming soon<!--]--><!--]--></p></li><!--]--></ul></div><!----> <div><div><div><p><span>just like milk and honey...</span></p><h2>Weird is a combination of two things that go together</h2></div> <p><img alt="Milk and honey" loading="lazy" height="350" src="https://a.weird.one/honeymilk.svg"></p></div> <div><div><p><span><!----><span slot="icon">➢</span><!----></span></p><h3><!----><span slot="title">Magic Website Creator</span><!----></h3> <div><!----><p>To fully inhabit the World Wide Web you need to create your digital self within it.</p>
<p>For a lot of us, the “simple” prospect of filling in that web page with content presents an insurmountable <a href="https://en.wikipedia.org/wiki/Writer%27s_block">writer’s block</a>.</p>
<p>That’s why we start with <em>link lists</em> as a primitive building block. Make a <em>list</em> of 1, 3 or however many <code>links</code> that say something, anything, about you.</p>
<p>Whatever you’ve listed, you’ve done it! You told us something about your self, and with that you are taking up a bit of space on the web, as you should.</p>
<!----></div></div><!----> <div><p><span><!----><span slot="icon">➣</span><!----></span></p><h3><!----><span slot="title">Web Passports</span><!----></h3> <div><!----><p>Weird is the “Google-login” button of the alt-web. A <a href="https://blog.erlend.sh/web-of-the-people">web of the people</a>, powered by people's websites instead of those pesky totalitarian mega-platforms.</p>
<p>By making - or merely connecting - your website with Weird you will soon be able to access and interact with the small, open and indie web just as easily as the regular web works today. Same conveniences, without the dark patterns, spying and data theft.</p>
<!----></div></div><!----></div></div></section><!----> <div><!----><!---
Each markdown "paragraph" will be a "marquee" message
They all display one after another horizontally

For now we just want to use paragraphs here and avoid stuff like
headings, links and so on even though they're supported. A link that's hard to click (because it moves) is bad UX
-->

<p>Say hello, again, to the weird web</p>
<p>Village-scale software 🏘️ </p>
<p>Like itch.io, but for any Open Web project </p>
<p>Like a distributed Wikipedia for projects</p>
<p>Like the internet archive for - you guessed it - projects 💫</p>
<p>A social network for your thoughts</p>
<p>An ecosystem for living ideas 🌱</p>
<!----></div><!----> <section><div><div><!----><h3>Intro to Project Weird</h3>
<p>'Agentic Developers' are the infrastructure-minded partners of '<a href="https://maggieappleton.com/home-cooked-software">Barefoot Developers</a>'. </p>
<p><a href="https://github.com/muni-town/agentic-fediverse">Agentic development</a> is happening when we build products based on the combined principles of local-first and peer-to-peer, maximizing for user agency by way of user-centric design.</p>
<!----></div><!----> <div role="button" tabindex="0"><p><img src="https://img.youtube.com/vi/YgYKKCmcE04/maxresdefault.jpg" alt="Agentic Product Development - Erlend Sogge Heggen" loading="lazy"></p></div><!----></div><!----> <div><p><img alt="hand pointing" loading="lazy" src="https://a.weird.one/magic-hand.svg" height="300"></p> </div><!----></section><!----> <!----><!----><!----><!----><!--]--> <!--[!--><!--]--><!--]-->
			
			
		</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[4chan hacked. Hacker reopens /QA/ and leaks all admins emails (451 pts)]]></title>
            <link>https://old.reddit.com/r/4chan/comments/1jzkjlg/4chan_hacked_hacker_reopens_qa_and_leaks_all/</link>
            <guid>43691334</guid>
            <pubDate>Tue, 15 Apr 2025 11:30:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://old.reddit.com/r/4chan/comments/1jzkjlg/4chan_hacked_hacker_reopens_qa_and_leaks_all/">https://old.reddit.com/r/4chan/comments/1jzkjlg/4chan_hacked_hacker_reopens_qa_and_leaks_all/</a>, See on <a href="https://news.ycombinator.com/item?id=43691334">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><hr>

<h2>Community:</h2>

<p><strong>Posts:</strong> /<a href="https://www.reddit.com/r/4chan/new/">new</a>/ /<a href="https://www.reddit.com/r/4chan/hot/">hot</a>/ /<a href="https://www.reddit.com/r/4chan/rising/">rising</a>/ /<a href="https://www.reddit.com/r/4chan/gilded/">gilded</a>/<br>
<strong>Best:</strong> /<a href="https://www.reddit.com/r/4chan/top/">day</a>/ /<a href="https://www.reddit.com/r/4chan/top/?sort=top&amp;t=week">week</a>/ /<a href="https://www.reddit.com/r/4chan/top/?sort=top&amp;t=month">month</a>/ /<a href="https://www.reddit.com/r/4chan/top/?sort=top&amp;t=year">year</a>/ /<a href="https://www.reddit.com/r/4chan/top/?sort=top&amp;t=all">all</a>/  </p>

<p><strong><em>Chat now with local singles!</em></strong>  </p>

<p>/<a href="https://www.reddit.com/chat/r/4chan/channel/343662_6b2573d529f800ceef326da71e13bb6a9de782e3/join">a</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_f86d5fc7bdaf09c426df7813bf1c67d46d15006f/join">b</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_eed3db47f1f7ca1ddab9d42d877a3614e3bb7ea9/join">biz</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_3f2b65504a81d3e556358bb5f1530fe68baf1f94/join">ck</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_15e946f2db5eb0d8787e4809523b56042323a63d/join">co</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_eefc635a36d1c9d910b370f956ac544ab298409f/join">diy</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/205434_04282ce39a208ce313848d0d5ea095efa5bae118/join">fa</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_baef63c244205db7f0a6a76c19ab7bde4ad5c858/join">fit</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_43510f7693eaba06afae4c1a9aa6b22d62887e15/join">k</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_258d605db8a8cb7f5bc088e30eb444c841aa121f/join">lit</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_3a9f6a817e8ae39b957b48cc11e2508b9489790d/join">mlp</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_2d76e3016c21a3a2b0fcf89abb377e2f52c3d739/join">mlpol</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_a96b341a1c565b265df18811b70f112d53f6527d/join">mu</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_6fa799f46bd3df5d302bd4fd91b13f4adb5cbb30/join">o</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_b3345e56f2e198ca1581ace327f42984e87bd71a/join">pol</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_df887d49f86f8597ca61658ea9bb83d735e49c29/join">r9k</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_dc72c284199781a4f5755ee6e505ddb3c054946a/join">s4s</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_4d4c8fbe77a6b408cce295a1724f258273582aaa/join">sci</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_5b6dd40f7d4733b7e547b0fc7fb6ec88db2dc70c/join">sp</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_0e092be5e18cdb325616bcaceef0f738bdf40af3/join">tg</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_5d0e6e3cd84c84bcce15e81691be2a85e5e4b6a0/join">tv</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_6a7a801d2abbef0fa6642376b93781f9d4debeb0/join">v</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_69df75f21b7947bf5c9d79cc35cadf3d1e6ff1e0/join">x</a>/ /<a href="https://www.reddit.com/chat/r/4chan/channel/343662_8252e0b914aa70162e238f3f0fcbc351d4eb948a/join">help desk</a>/  </p>

<p><strong>More Subreddits:</strong>   </p>

<p>/<a href="https://old.reddit.com/r/ChrisChanSonichu">ChrisChanSonichu</a>/</p>

<p>/<a href="https://old.reddit.com/r/r4chanmeta">r4chanmeta</a>/ /<a href="https://old.reddit.com/r/titsorgtfo">titsorgtfo</a>/ /<a href="https://old.reddit.com/r/4chanExploitables">4chanExploitables</a>/ /<a href="https://old.reddit.com/r/4ChanMeta">4ChanMeta</a>/ /<a href="https://old.reddit.com/r/Gondola">Gondola</a>/ /<a href="https://old.reddit.com/r/braveryjerk">braveryjerk</a>/ /<a href="https://old.reddit.com/r/4chanCopypasta">4chanCopypasta</a>/ /<a href="https://old.reddit.com/r/baneposting">baneposting</a>/</p>

<hr>

<h2>Rules:</h2>

<ol>
<li><p><strong>Mods = Gods</strong><br>
Do NOT break any rules that the mods might invent on the spot.  </p></li>
<li><p><strong>4chan Only</strong><br>
Do NOT post anything unrelated to 4chan. Do NOT link directly to 4chan.org. Do NOT post anything from unrelated websites. Screencaps from 4chan are ideal.  </p></li>
<li><p><strong>New Content Only</strong><br>
Do NOT post screencaps over a year old, do NOT repost, and do NOT omit the date and time stamp. Those posts belong in <a href="https://old.reddit.com/r/classic4chan">/r/classic4chan</a> (RIP).</p></li>
<li><p><strong>High Quality Only</strong><br>
This applies to quality content and quality presentation. Crop your post so it's actually legible. Don't post garbage that isn't entertaining.  </p></li>
<li><p><strong>No Redditry</strong><br>
Do NOT act like a basic reddit bitch. This includes cliche reddit phrases, subreddit mentions, puns, song lyrics, novelty accounts, getting lots of karma on a single post, sperging out at someone like a 13 year old on Xbox, and other dummy things that make you a manchild.<br>
E.g. not my proudest fap, <a href="https://old.reddit.com/r/theydidthemath">/r/theydidthemath</a>, I did nazi that coming, cake day, Fake and Gay, /u/[somethingstupid], 1000 upvotes, etc.  </p></li>
<li><p><strong>No Doxxing</strong><br>
Do NOT reveal personal information, or post 4chan screenshots that contain personal information of any individual. Do not post 4chan screenshots of Reddit account names or calls for raids. Remember, NYPA.  </p></li>
<li><p><strong>No CP</strong><br>
Do not post nude images of underage children, or say that nude images of underage children aren't child pornography, or say that nude images of underage children are okay, or describe images of underage children in text form.<br>
If we see you do this anywhere on Reddit, we will report you to the law enforcement agency of where you live.</p></li>
<li><p><strong>NSFW marking</strong><br>
Do NOT forget to mark NSFW content. The overall subreddit is SFW, so people need to really know when a submission is legit NSFW. (Potty Words are not NSFW).  </p></li>
<li><p><strong>No Grooming</strong><br>
No agendaposting.</p></li>
<li><p><strong>Admin abuse</strong><br>
The admins bypassed the mods and directly took action on the subreddit.</p></li>
</ol>

<hr>

<h2>Mods Statement:</h2>

<hr>

<p>We personally severely dislike reddit and everyone who frequents it. We believe it's a shitty, destructive echo chamber that does public harm as an internet publisher. We think this website discourages real interpersonal communication, and encourages addict-like consumption.</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Whistleblower details how DOGE may have taken sensitive NLRB data (752 pts)]]></title>
            <link>https://www.npr.org/2025/04/15/nx-s1-5355896/doge-nlrb-elon-musk-spacex-security</link>
            <guid>43691142</guid>
            <pubDate>Tue, 15 Apr 2025 10:55:41 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.npr.org/2025/04/15/nx-s1-5355896/doge-nlrb-elon-musk-spacex-security">https://www.npr.org/2025/04/15/nx-s1-5355896/doge-nlrb-elon-musk-spacex-security</a>, See on <a href="https://news.ycombinator.com/item?id=43691142">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="storytext">
      <div id="resg-s1-59636">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/400/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/800/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1300/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/2000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/2600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/png">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/1100/quality/50/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3600x2025+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fad%2F9a%2F7e9500df48c4b4523a0001c3be41%2Fdoge-main.png" alt="" fetchpriority="high">
        </picture>
</div>
<div>
    <div>
        <p>
                The DOGE team may have taken data related to union organizing and labor complaints and hid its tracks, according to a whistleblower.
                <b aria-label="Image credit">
                    
                    Charlotte Gomez for NPR
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Charlotte Gomez for NPR
        
    </span>
</p></div>
   </div>
   <p>In the first days of March, a team of advisers from President Trump's new Department of Government Efficiency initiative arrived at the Southeast Washington, D.C., headquarters of the National Labor Relations Board.</p>   <p>The small, independent federal agency investigates and adjudicates complaints about unfair labor practices. It stores reams of potentially sensitive data, from confidential information about employees who want to form unions to proprietary business information.</p>   <p>The DOGE employees, who are effectively led by White House adviser and billionaire tech CEO Elon Musk, appeared to have their sights set on accessing the NLRB's internal systems. They've said their unit's overall mission is to review agency data for compliance with the new administration's policies and to cut costs and maximize efficiency.</p>   
   <p>But according to an official whistleblower disclosure shared with Congress and other federal overseers that was obtained by NPR, subsequent interviews with the whistleblower and records of internal communications, technical staff members were alarmed about what DOGE engineers did when they were granted access, particularly when those staffers noticed a spike in data leaving the agency. It's possible that the data included sensitive information on unions, ongoing legal cases and corporate secrets — data that four labor law experts tell NPR should almost never leave the NLRB and that has nothing to do with making the government more efficient or cutting spending.</p>   
   
<!-- END ID="RESNX-S1-5355896-100" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>Meanwhile, according to the disclosure and records of internal communications, members of the DOGE team asked that their activities not be logged on the system and then appeared to try to cover their tracks behind them, turning off monitoring tools and manually deleting records of their access — evasive behavior that several cybersecurity experts interviewed by NPR compared to what criminal or state-sponsored hackers might do.</p>   <div id="resg-s1-59679">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/6750x4500+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F48%2Ff5%2F1bb3e223420e87981a07ebfe8776%2Fgettyimages-2203694324.jpg" alt="White House senior adviser Elon Musk walks to the White House after landing in Marine One with President Trump on March 9." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                White House senior adviser Elon Musk walks to the White House after landing in Marine One with President Trump on March 9.
                <b aria-label="Image credit">
                    
                    Samuel Corum/Getty Images
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Samuel Corum/Getty Images
        
    </span>
</p></div>
   </div>
   <p>The employees grew concerned that the NLRB's confidential data could be exposed, particularly after they started detecting suspicious log-in attempts from an IP address in Russia, according to the disclosure. Eventually, the disclosure continued, the IT department launched a formal review of what it deemed a serious, ongoing security breach or potentially illegal removal of personally identifiable information. The whistleblower believes that the suspicious activity warrants further investigation by agencies with more resources, like the Cybersecurity and Infrastructure Security Agency or the FBI.</p>   
   <p>The labor law experts interviewed by NPR fear that if the data gets out, it could be abused, including by private companies with cases before the agency that might get insights into damaging testimony, union leadership, legal strategies and internal data on competitors — Musk's SpaceX among them. It could also intimidate whistleblowers who might speak up about unfair labor practices, and it could sow distrust in the NLRB's independence, they said.</p>   
   
<!-- END ID="RESNX-S1-5355896-101" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>The new revelations about DOGE's activities at the labor agency come from a whistleblower in the IT department of the NLRB, who disclosed his concerns to Congress and the U.S. Office of Special Counsel in a detailed report that was then provided to NPR. Meanwhile, his attempts to raise concerns internally within the NLRB preceded someone "physically taping a threatening note" to his door that included sensitive personal information and overhead photos of him walking his dog that appeared to be taken with a drone, according to a cover letter attached to his disclosure filed by his attorney, Andrew Bakaj of the nonprofit Whistleblower Aid.</p>   <p>The whistleblower's account is corroborated by internal documentation and was reviewed by 11 technical experts across other government agencies and the private sector. In total, NPR spoke to over 30 sources across the government, the private sector, the labor movement, cybersecurity and law enforcement who spoke to their own concerns about how DOGE and the Trump administration might be handling sensitive data, and the implications for its exposure. Much of the following account comes from the whistleblower's official disclosure and interviews with NPR.</p>   <p>"I can't attest to what their end goal was or what they're doing with the data," said the whistleblower, Daniel Berulis, in an interview with NPR. "But I can tell you that the bits of the puzzle that I can quantify are scary. ... This is a very bad picture we're looking at."</p>   
   
<!-- END ID="RESNX-S1-5355896-102" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>The whistleblower's story sheds further light on how DOGE is operating inside federal systems and comes on the heels of <a href="https://www.npr.org/2025/03/26/nx-s1-5339842/doge-data-access-privacy-act-social-security-treasury-opm-lawsuit" target="_blank">testimony in more than a dozen court cases</a> across the United States that reveal how DOGE rapidly gained access to <a href="https://www.npr.org/2025/03/11/nx-s1-5305054/doge-elon-musk-security-data-information-privacy" target="_blank">private financial and personal information on hundreds of millions of Americans</a>. It's unclear how or whether DOGE is protecting the privacy of that data. Meanwhile, the threatening note, though its origins are unknown, is reflective of the current climate of fear and intimidation toward whistleblowers.</p>   
   
<!-- END ID="RESNX-S1-5355896-103" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>Tim Bearese, the NLRB's acting press secretary, denied that the agency granted DOGE access to its systems and said DOGE had not requested access to the agency's systems. Bearese said the agency conducted an investigation after Berulis raised his concerns but "determined that no breach of agency systems occurred."</p>   <p>Notwithstanding the NLRB's denial, the whistleblower's disclosure to Congress and other federal overseers includes forensic data and records of conversations with colleagues that provide evidence of DOGE's access and activities. Meanwhile, NPR's extensive reporting makes clear that DOGE's access to data is a widespread concern. Across the government, 11 sources directly familiar with internal operations in federal agencies and in Congress told NPR that they share Berulis' concerns, and some have seen other evidence that DOGE is exfiltrating sensitive data for unknown reasons.</p>   
   <p>A representative of DOGE did not respond to NPR's requests for comment.<br></p>   <h3>Taking apart computers to protecting government data</h3>   <p>Instead of a brand-new car for a 16th-birthday present, Berulis got his first computer.</p>   <p>It's a familiar story for tech nerds the world over: He methodically took the machine apart "to figure out how it works," just like he had dissected radios from the thrift store years earlier. "I electrocuted myself once," he recalled.</p>   <p>Berulis was always interested in public service, but the traditional paths didn't suit him.</p>   
   
<!-- END ID="RESNX-S1-5355896-104" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>A knee injury prevented him from joining the military. He served as a volunteer firefighter for a period and donated his time working for a local rape crisis hotline, answering calls from victims in need of someone to listen. But, he told NPR, "I had an interest in serving my country."</p>   <p>Berulis had been a technical consultant for many years, including in auditing and modernizing corporate systems, when a job opened up at the National Labor Relations Board.</p>   <div id="resg-s1-60225">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8523x5682+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F7a%2F5b%2F795c00cd46f99044a94aa1d5923c%2Fdoge-edit-1.jpg" alt="Daniel Berulis started working at the National Labor Relations Board about six months before President Trump started his second term." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                Daniel Berulis started working at the National Labor Relations Board about six months before President Trump started his second term.
                <b aria-label="Image credit">
                    
                    Grace Raver/NPR
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Grace Raver/NPR
        
    </span>
</p></div>
   </div>
   <p>While he didn't know much about the agency, Berulis<strong> </strong>quickly found its mission to protect employees' rights in line with his long-standing desire "to help people."</p>   <p>He started about six months before President Trump was inaugurated for his second term this past January. Berulis said he hit the ground running, securing the NLRB's cloud-based data servers and reinforcing what's called "zero trust" principles, which means that users can get access only to the parts of the system they need in order to do their jobs — no more, no less. That way, if an attacker gets hold of a single username and password, the attacker can't access the whole system.</p>   <p>"When I first started, it was a dream come true," he said. "There was a great opportunity to build up and do some good." But after the inauguration, he described a "culture of fear" descending over the agency.<br></p>   
   <h3>DOGE arrives&nbsp;</h3>   <p>The first week of March, engineers associated with DOGE arrived at the NLRB's headquarters, according to Berulis' disclosure. Beforehand, they had asked about what software, hardware, programming languages and applications the NLRB was using. DOGE learned that it used commercially available cloud infrastructure that businesses typically use, which connects to government cloud systems at other agencies and can be accessed remotely.</p>   <p>Berulis said he and several colleagues saw a black SUV and police escort enter the garage, after which building security let the DOGE staffers in. They interacted with a small number of staffers, never introducing themselves to most of the IT team.</p>   <p>Berulis says he was told by colleagues that DOGE employees demanded the highest level of access, what are called "tenant owner level" accounts inside the independent agency's computer systems, with essentially unrestricted permission to read, copy and alter data, according to Berulis' disclosure.</p>   <p>When an IT staffer suggested a streamlined process to activate those accounts in a way that would let their activities be tracked, in accordance with NLRB security policies, the IT staffers were told to stay out of DOGE's way, the disclosure continues.</p>   <p>For cybersecurity professionals, a failure to log activity is a cardinal sin and contradicts best practices as recommended by the <a href="https://www.nist.gov/cyberframework" target="_blank">National Institute of Standards and Technology</a> and the Department of Homeland Security's Cybersecurity and Infrastructure Security Agency, as well as the FBI and the National Security Agency.</p>   <p>"That was a huge red flag," said Berulis. "That's something that you just don't do. It violates every core concept of security and best practice."</p>   <div data-crop-type="" id="resg-s1-59634">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/400/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/800/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1300/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/png">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1100/quality/50/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F09%2Fe2%2F9f2467c44b4d83977ce269bc6eed%2Fdoge-spot-01.png" alt="Doge_Spot_01.png" loading="lazy">
        </picture>
</div>
   <p>Those forensic digital records are important for record-keeping requirements and they allow for troubleshooting, but they also allow experts to investigate potential breaches, sometimes even tracing the attacker's path back to the vulnerability that let them inside a network. The records can also help experts see what data might have been removed. Basic logs would likely not be enough to demonstrate the extent of a bad actor's activities, but it would be a start. There's no reason for any legitimate user to turn off logging or other security tools, cybersecurity experts say.</p>   
   <p>"None of this is normal," said Jake Braun, the executive director of the Cyber Policy Initiative at the University of Chicago's Harris School of Public Policy and former acting principal deputy national cyber director at the White House, in an interview with NPR about the whistleblower's disclosure. "This type of activity is why the government buys insider-threat-monitoring technology. So we can know things like this are happening and stop sensitive data exfiltration before it happens," he told NPR.</p>   <p>However, the NLRB's budget hasn't had the money to pay for tools like that for years, Berulis said.<br></p>   <h3>A backdoor to government systems?</h3>   <p>A couple of days after DOGE arrived, Berulis saw something else that alarmed him while browsing the internet over the weekend.</p>   <p>Massachusetts Institute of Technology graduate and DOGE engineer Jordan Wick had been sharing information about coding projects he was working on to his public account with GitHub, a website that allows developers to create, store and collaborate on code.</p>   <p>After journalist Roger Sollenberger started <a href="https://x.com/SollenbergerRC/status/1895609294810464390" target="_blank">posting on X</a> about the account, Berulis noticed something Wick was working on: a project, or repository, titled "NxGenBdoorExtract."</p>   <p>Wick made it private before Berulis could investigate further, he told NPR. But to Berulis, the title itself was revealing.</p>   <p>"So when I saw this tool, I immediately panicked, just for lack of a better term," he said. "I kind of had a conniption and said, 'Whoa, whoa, whoa.'" He immediately alerted his whole team.</p>   <p>While NPR was unable to recover the code for that project, the name itself suggests that Wick could have been designing a backdoor, or "Bdoor," to extract files from the NLRB's internal case management system, known as NxGen, according to several cybersecurity experts who reviewed Berulis' conclusions.</p>   <p>Wick did not respond to NPR's requests for comment.</p>   <div id="resg-s1-60224">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/400/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/800/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1300/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/2000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/2600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/png">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/1100/quality/50/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/538x575+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F8f%2Fe2%2Fb5ea0e5d406bba8c5eb9fc343604%2Fdoge-github-data-annotation.png" alt="A screenshot of DOGE engineer Jordan Wick's public GitHub account that shows &quot;NxGenBdoorExtract.&quot; The name itself suggests that Wick could have been designing a backdoor, or &quot;Bdoor,&quot; to extract files from the NLRB's internal case management system." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                A screenshot of DOGE engineer Jordan Wick's public GitHub account that shows "NxGenBdoorExtract." The name itself suggests that Wick could have been designing a backdoor, or "Bdoor," to extract files from the NLRB's internal case management system.
                <b aria-label="Image credit">
                    
                    Daniel Berulis/Annotation by NPR
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Daniel Berulis/Annotation by NPR
        
    </span>
</p></div>
   </div>
   <p>"It definitely seems rather odd to name it that," said one of the engineers who built NxGen and asked for anonymity so as not to jeopardize their ability to work with the government again. "Or brazen, if you're not worried about consequences."</p>   
   <p>"The whole idea of removing logging and [getting] tenant-level access is the most disturbing part to me," the engineer said.</p>   <p>NxGen is an <a href="https://www.governmentattic.org/57docs/NLRBnxGenCMSreplace2024-2025.pdf" target="_blank">internal system</a> that was designed specifically for the NLRB in-house, according to several of the engineers who created the tool and who all spoke to NPR on condition of anonymity to avoid retaliation or adverse consequences for any future government work.</p>   <p>The engineers explained that while many of the NLRB's records are eventually made public, the NxGen case management system hosts proprietary data from corporate competitors, personal information about union members or employees voting to join a union, and witness testimony in ongoing cases. Access to that data is protected by numerous federal laws, including the Privacy Act.</p>   <p>Those engineers were also concerned by DOGE staffers' insistence that their activities not be logged, allowing them to probe the NLRB's systems and discover information about potential security flaws or vulnerabilities without being detected.</p>   <p>"If he didn't know the backstory, any [chief information security officer] worth his salt would look at network activity like this and assume it's a nation-state attack from China or Russia," said Braun, the former White House cyber official.<br></p>   <h3>Putting the puzzle pieces together</h3>   <p>About a week after arriving, the DOGE engineers had left the NLRB and deleted their accounts, according to Berulis' disclosure to Congress.</p>   <p>In the office, Berulis had had limited visibility into what the DOGE team was up to in real time.</p>   <p>That's partly because, he said, the NLRB isn't advanced when it comes to detecting insider threats or potentially malicious actors inside the agency itself. "We as an agency have not evolved to account for those," he explained. "We were looking for [bad actors] outside," he said.</p>   <p>But he counted on DOGE leaving at least a few traces of its activity behind, puzzle pieces he could assemble to try to put together a picture of what happened — details he included in his official disclosure.</p>   
   <p>First, at least one DOGE account was created and later deleted for use in the NLRB's cloud systems, hosted by Microsoft: "<a href="mailto:DogeSA_2d5c3e0446f9@nlrb.microsoft.com" target="_blank">DogeSA_2d5c3e0446f9@nlrb.microsoft.com</a>."</p>   <p>Then, DOGE engineers installed what's called a "container," a kind of opaque virtual computer that can run programs on a machine without revealing its activities to the rest of the network. On its own, that wouldn't be suspicious, though it did allow the engineers to work invisibly and left no trace of its activities once it was removed.</p>   <p>Then, Berulis started tracking sensitive data leaving the places it's meant to live, according to his official disclosure. First, he saw a chunk of data exiting the NxGen case management system's "nucleus," inside the NLRB system, Berulis explained. Then, he saw a large spike in outbound traffic leaving the network itself.</p>   <div id="resg-s1-60219">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2048x1455+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F3e%2F38%2F4f7753974f60b1833783b65ddd52%2Fdoge-data-leaving.jpg" alt="This screenshot shows a large spike in outbound traffic leaving the NLRB system." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                This screenshot shows a large spike in outbound traffic leaving the NLRB system.
                <b aria-label="Image credit">
                    
                    Whistleblower Aid
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Whistleblower Aid
        
    </span>
</p></div>
   </div>
   <p>From what he could see, the data leaving, almost all text files, added up to around 10 gigabytes — or the equivalent of a full stack of encyclopedias if someone printed them, he explained. It's a sizable chunk of the total data in the NLRB system, though the agency itself hosts over 10 terabytes in historical data. It's unclear which files were copied and removed or whether they were consolidated and compressed, which could mean even more data was exfiltrated. It's also possible that DOGE ran queries looking for specific files in the NLRB's system and took only what it was looking for, according to the disclosure.</p>   <p data-pym-loader="" data-child-src="https://apps.npr.org/dailygraphics/graphics/doge-nlrb-diagrams-20250404/container.html" id="responsive-embed-doge-nlrb-diagrams-20250404-container"> Loading... </p>
   
<!-- END ID="RESNX-S1-5355896-105" CLASS="BUCKETWRAP STATICHTML" -->
   <p>Regardless, that kind of spike is extremely unusual, Berulis explained, because data almost never directly leaves from the NLRB's databases. In his disclosure, Berulis shared a screenshot tracking data entering and exiting the system, and there's only one noticeable spike of data going out. He also confirmed that no one at the NLRB had been saving backup files that week or migrating data for any projects.</p>   <p>Even when external parties like lawyers or overseers like the inspector general are granted guest accounts on the system, it's only to view the files relevant to their case or investigation, explained labor law experts who worked with or at the NLRB, in interviews with NPR.</p>   <p>"None of that confidential and deliberative information should ever leave the agency," said Richard Griffin, who was the NLRB general counsel from 2013 to 2017, in an interview with NPR.<br></p>   <h3>"We are under assault right now"</h3>   <p>For cybersecurity experts, that spike in data leaving the system is a key indicator of a breach, Berulis explained.</p>   
   <p>"We are under assault right now," he remembered thinking.</p>   <p>When Berulis asked his IT colleagues whether they knew why the data was exfiltrated or whether anyone else had been using containers to run code on the system in recent weeks, no one knew anything about it or the other unusual activities on the network, according to his disclosure. In fact, when they looked into the spike, they found that logs that were used to monitor outbound traffic from the system were absent. Some actions taken on the network, including data exfiltration, had no attribution — except to a "deleted account," he continued. "Nobody knows who deleted the logs or how they could have gone missing," Berulis<strong> </strong>said.</p>   <p>The IT team met to discuss insider threats — namely, the DOGE engineers, whose activities it had little insight into or control over. "We had no idea what they did," he explained. Those conversations are reflected in his official disclosure.</p>   <p>They eventually launched a formal breach investigation, according to the disclosure, and prepared a request for assistance from the Cybersecurity and Infrastructure Security Agency (CISA). However, those efforts were disrupted without an explanation, Berulis said. That was deeply troubling to Berulis, who felt he needed help to try to get to the bottom of what happened and determine what new vulnerabilities might be exploited as a result.</p>   <p>In the days after Berulis and his colleagues prepared a request for CISA's help investigating the breach, Berulis found a printed letter in an envelope taped to his door, which included threatening language, sensitive personal information and overhead pictures of him walking his dog, according to the cover letter attached to his official disclosure. It's unclear who sent it, but the letter made specific reference to his decision to report the breach. Law enforcement is investigating the letter.</p>   
   <p>"If the underlying disclosure wasn't concerning enough, the targeted, physical intimidation and surveillance of my client is. If this is happening to Mr. Berulis, it is likely happening to others and brings our nation more in line with authoritarian regimes than with open and free democracies," wrote Bakaj, his attorney, in a statement sent to NPR. "It is time for everyone – and Congress in particular – to acknowledge the facts and stop our democracy, freedom, and liberties from slipping away, something that will take generations to repair."</p>   <p>In part because of the stymied internal investigation and the attempts to silence him, Berulis decided to come forward publicly.</p>   <p>In fact, despite all that, Berulis managed to uncover some stranger and more troubling details about what happened while DOGE was logged on, which he enumerated in his official declaration.</p>   <p>Unknown users also gave themselves a high-level access key, what's called a SAS token, meaning "shared access signature," to access storage accounts, before deleting it. Berulis said there was no way to track what they did with it.</p>   <p>Someone had disabled controls that would prevent insecure or unauthorized mobile devices from logging on to the system without the proper security settings. There was an interface exposed to the public internet, potentially allowing malicious actors access to the NLRB's systems. Internal alerting and monitoring systems were found to be manually turned off. Multifactor authentication was disabled. And Berulis noticed that an unknown user had exported a "user roster," a file with contact information for outside lawyers who have worked with the NLRB.</p>   <p>Berulis said he noticed five PowerShell downloads on the system, a task automation program that would allow engineers to run automated commands. There were several code libraries that got his attention — tools that he said appeared to be designed to automate and mask data exfiltration. There was a tool to generate a seemingly endless number of IP addresses called "requests-ip-rotator," and a commonly used automation tool for web developers called "browserless" — both repositories starred or favorited by Wick, the DOGE engineer, according to an archive of his GitHub account reviewed by NPR.</p>   
   <p>While investigating the data taken from the agency, Berulis tried to determine its ultimate destination. But whoever had exfiltrated it had disguised its destination too, according to the disclosure.</p>   <p>DOGE staffers had permission to access the system, but removing data is another matter.</p>   <p>Berulis says someone appeared to be doing something called DNS tunneling to prevent the data exfiltration from being detected. He came to that conclusion, outlined in his disclosure, after he saw a traffic spike in DNS requests parallel to the data being exfiltrated, a spike 1,000 times the normal number of requests.</p>   <p>When someone uses this kind of technique, they set up a domain name that pings the target system with questions or queries. But they configure the compromised server so that it answers those DNS queries by sending out packets of data, allowing the attacker to steal information that has been broken down into smaller chunks.</p>   <p>"We've seen Russian threat actors do things like this on U.S. government systems," said one threat intelligence researcher who requested anonymity because they weren't authorized to speak publicly by their employer. That analyst, who has extensive experience hunting nation-state-sponsored hackers, reviewed the whistleblower's technical claims.</p>   <p>"The difference is, they were given the keys to the front door," the researcher continued. While the researcher clarified that it would be difficult to fully verify what happened without full access to the NLRB system, they said Berulis' conclusions and accompanying evidence were a cause for concern. "None of this is standard," they said.</p>   <p>Russ Handorf, who served in the FBI for a decade in various cybersecurity roles, also reviewed Berulis' extensive technical forensic records and analysis and spoke to NPR about his conclusions.</p>   <p>"All of this is alarming," he said. "If this was a publicly traded company, I would have to report this [breach] to the Securities and Exchange Commission. The timeline of events demonstrates a lack of respect for the institution and for the sensitivity of the data that was exfiltrated. There is no reason to increase the security risk profile by disabling security controls and exposing them, less guarded, to the internet. They didn't exercise the more prudent standard practice of copying the data to encrypted and local media for escort."</p>   <p>"Until there's an investigation done, there's no way to definitively prove who did it," Handorf concluded.<br></p>   <h3>"No reason whatsoever for accessing the information"</h3>   <div id="resg-s1-60227">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5000x3335+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Ff0%2F87%2F4722e7324f15aaa3ec8dbfdcebea%2Fgettyimages-1172591604.jpg" alt="The National Labor Relations Board seal hangs inside a hearing room at the agency's headquarters in Washington, D.C., in 2019." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                The National Labor Relations Board seal hangs inside a hearing room at the agency's headquarters in Washington, D.C., in 2019.
                <b aria-label="Image credit">
                    
                    Andrew Harrer/Bloomberg via Getty Images
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Andrew Harrer/Bloomberg via Getty Images
        
    </span>
</p></div>
   </div>
   <p>DOGE's intentions with regard to the NLRB data remain unclear. Many of the systems that DOGE embedded itself in across the rest of the government <a href="https://www.npr.org/2025/03/08/nx-s1-5321323/trump-doge-gsa-federal-buildings" target="_blank">have payment or employment data</a>, information that it could use to evaluate which grants and programs to halt and whom to fire.</p>   
   
<!-- END ID="RESNX-S1-5355896-106" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>But the case management system is very different.</p>   <p>It houses information about ongoing contested labor cases, lists of union activists, internal case notes, personal information from Social Security numbers to home addresses, proprietary corporate data and more information that never gets published openly.</p>   
   
<!-- END ID="RESNX-S1-5355896-107" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>Experts interviewed by NPR acknowledge that there are inefficiencies across government that warrant further review, but they say they don't see a single legitimate reason that DOGE staffers would need to remove the data from the case management system to resolve those problems.</p>   <p>"There is no reason whatsoever for accessing the information. Now, could any agency be more efficient? More effective? Positively. But what you need for that is people who understand what the agency does. That is not by mining data, putting algorithms in and creating a breach of security," said Harley Shaiken, a professor emeritus at the University of California, Berkeley who specializes in labor and information technology.</p>   <p>"There is nothing that I can see about what DOGE is doing that follows any of the standard procedures for how you do an audit that has integrity and that's meaningful and will actually produce results that serve the normal auditing function, which is to look for fraud, waste and abuse," said Sharon Block, the executive director of Harvard Law School's Center for Labor and a Just Economy and a former NLRB board member.</p>   <p>"The mismatch between what they're doing and the established, professional way to do what they say they're doing ... that just kind of gives away the store, that they are not actually about finding more efficient ways for the government to operate," Block said.</p>   <p>For labor law experts, the mere possibility that sensitive records were copied is a serious danger that could create a chilling effect for employees everywhere who turn to the National Labor Relations Board for protection.</p>   <p>"Just saying that they have access to the data is intimidating," said Kate Bronfenbrenner, the director of labor education research at Cornell University and co-director of the Worker Empowerment Research Network. "People are going to go, 'I'm not going to testify before the board because, you know, my employer might get access.'"</p>   <p>Bronfenbrenner, the child of immigrant parents who fled the Soviet Union and Nazi-controlled Germany, said she spends a lot of time thinking about how systems can crumble under the right circumstances. "You know, there's this belief that we have these checks and balances … but anyone who's part of the labor movement should know that's not true," she told NPR.</p>   <p>With access to the data, it would make it easier for companies to fire employees for union organizing or keep blacklists of organizers — illegal activities under federal labor laws enforced by the NLRB. But "people get fired in this country all the time for the lawful act of trying to organize a union," said Block.</p>   <p>Having a copy of the opposing counsel's notes as companies prepare for legal challenges would also be an attractive possibility, she continued.</p>   
   
<!-- END ID="RESNX-S1-5355896-108" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>It's not just employees who might suffer if this data got out. Companies also sometimes provide detailed statements on internal business planning and corporate structure in the midst of unfair-labor-practice complaint proceedings. If a company was attempting to fire someone who it alleged had disclosed trade secrets and was fighting an unfair-labor-practice complaint based around that decision, those trade secrets might come up in the board's investigation too. That information would be valuable to competitors, regulators and others.</p>   <p>Overall, the potential exposure of the NLRB's data could have serious implications.</p>   <p>"I think it is very concerning," said Shaiken. "It could result in damage to individual workers, to union-organizing campaigns and to unions themselves," he said.</p>   <p>"It is bringing a wrecking ball into the dentist office, meaning this is wildly disproportionate and raises real dangers," Shaiken continued.<br></p>   <h3>A conflict of interest and the dangers of exposure</h3>   <p>Labor law experts were particularly concerned about what they described as clear conflicts of interest, particularly when it comes to Elon Musk, his companies and his vast network of former employees and allies who are now getting access to government jobs and data.</p>   
   
<!-- END ID="RESNX-S1-5355896-109" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>Trump and Musk, during an interview with Fox News's Sean Hannity, said Musk would recuse himself from anything involving his companies. "I haven't asked the president for anything ever," <a href="https://www.whitehouse.gov/remarks/2025/02/interview-of-president-trump-and-elon-musk-by-sean-hannity-the-sean-hannity-show/" target="_blank">Musk said</a>. "I'm getting a sort of a daily proctology exam here. You know, it's not like I'll be getting away [with] something in the dead of night." However, DOGE has been granted high-level access to a lot of data that could benefit Musk, and there has been no evidence of a firewall preventing misuse of that data.</p>   
   
<!-- END ID="RESNX-S1-5355896-110" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>There are multiple ongoing cases involving Musk and the NLRB. For one, after a group of former SpaceX employees lodged a complaint with the NLRB, lawyers representing SpaceX, some of whom were <a href="https://www.npr.org/2025/03/27/nx-s1-5341559/lawyer-represented-musk-spacex-downsize-federal-contractors-watchdog" target="_blank">recently hired into government jobs</a>, <a href="https://www.npr.org/2024/11/18/nx-s1-5192918/spacex-amazon-nlrb-labor-board-elon-musk" target="_blank">filed suit against the NLRB.</a> They argued that the agency's structure is unconstitutional.</p>   <div id="resg-s1-60218">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/8256x5504+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F77%2Ff8%2F29b23df04f55968adadb2255f074%2Fgettyimages-2185639186.jpg" alt="Elon Musk speaks with then-President-elect Donald Trump and guests at a viewing of the launch of the sixth test flight of the SpaceX Starship rocket on November 19, 2024, in Brownsville, Texas." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                Elon Musk speaks with then-President-elect Donald Trump and guests at a viewing of the launch of the sixth test flight of the SpaceX Starship rocket on Nov. 19, 2024, in Brownsville, Texas.
                <b aria-label="Image credit">
                    
                    Brandon Bell/Getty Images
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Brandon Bell/Getty Images
        
    </span>
</p></div>
   </div>
   <p>Sen. Chris Murphy, D-Conn. <a href="https://www.murphy.senate.gov/newsroom/press-releases/murphy-presses-labor-secretary-nominee-on-protecting-sensitive-data-and-the-nlrb-from-elon-musk" target="_blank">raised his concerns </a>about Musk accessing sensitive labor investigation data on cases against his companies or competitors during the confirmation hearing for Trump's labor secretary, Lori Chavez-DeRemer, in mid-February. He pressed her to answer whether she believed the NLRB is constitutional and to commit to keeping sensitive data confidential. While she said she was committed to "privacy" and said she respects the NLRB's "authority," she insisted that Trump "has the executive power to exercise it as he sees fit."</p>   <p>All this is happening in the context of a broader attempt by the White House to hamstring labor agencies.</p>   <p>The NLRB was created "to guarantee workers' rights to organize and to address problems that workers have in the workplace," said Shaiken, of UC Berkeley. Under President Joe Biden, he recalled, the labor movement enjoyed an unusual amount of support from Washington. "But what we have seen is a sharp slamming of the brakes to that and putting the vehicle in reverse in terms of what Trump has done so far," he continued.</p>   <p>In addition to sending DOGE to the NLRB, the Trump administration tried to neutralize the board's power to enforce labor law by removing its member Gwynne Wilcox. Courts have gone <a href="https://bsky.app/profile/kyledcheney.bsky.social/post/3lm7wvvih4c27" target="_blank">back and forth</a> on whether Wilcox's removal was illegal, as presidents are meant to demonstrate cause for dismissal of independent board members.</p>   <p>Representatives of DOGE and former colleagues of Musk's who have been installed across the federal government have failed to reassure the public or the courts that they have taken the proper precautions to protect the data they're ingesting and that private business interests won't influence how that data is used or what policy decisions are made, Block and the other labor law experts interviewed by NPR say.</p>   <p>"It's not that he's a random person who's getting information that a random person shouldn't have access to," said Harvard Law's Block. "But if they really did get everything, then he has information about the cases the government is building against him," she said.</p>   <p>"DOGE is, whether they admit it or not, headed by somebody who is the subject of active investigation and prosecution of cases. It is incredibly troubling," she said.</p>   <p>Musk's company xAI could also benefit from sucking up all the data DOGE has collected to train its algorithms. Cybersecurity experts like Bruce Schneier, a well-known cryptographer and adjunct lecturer at the Harvard Kennedy School, have <a href="https://www.hks.harvard.edu/faculty-research/policy-topics/science-technology-data/doge-putting-countrys-data-and-computing" target="_blank">pointed to this concern</a> at length in interviews and written pieces.</p>   <p>According to two federal government sources who were not authorized to speak publicly about their workplaces and who shared email documentation with NPR, managers have consistently been warning employees that their data could be subject to AI review, particularly their email responses to the Musk-led campaign to get federal employees to detail "what they did last week" in five bullet points every Monday.</p>   <p>"It's not a flight of imagination to see several DOGE staffers release some of that [data] surreptitiously to Musk or people close to him," said Shaiken.<br></p>   <h3>Access for adversaries</h3>   <div data-crop-type="" id="resg-s1-59635">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/400/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/800/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1300/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2000/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/2600/quality/85/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/png">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/1100/quality/50/format/png/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/2500x1875+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F31%2Fac%2F88dc9f014080a4834083d858806b%2Fdoge-spot-02.png" alt="Doge_Spot_02.png" loading="lazy">
        </picture>
</div>
   <p>If the data isn't properly protected after it leaves the agency or if DOGE left a digital door open to the agency itself, data could also be exposed to potential sale or theft by criminals or foreign adversaries. An attacker could also try to take advantage of the connections between the NLRB's cloud account and other government cloud environments, using their access to the NLRB as a foothold to move to other networks.</p>   <p>"Both criminals and foreign adversaries traditionally have used information like this to enrich themselves through a variety of actions," explained Handorf, the former FBI cyber official. "That includes blackmail, targeting and prioritizing intellectual property theft for espionage or even harming a company to enrich another."</p>   <p>Within minutes after DOGE accessed the NLRB's systems, someone with an IP address in Russia started trying to log in, according to Berulis' disclosure. The attempts were "near real-time," according to the disclosure. Those attempts were blocked, but they were especially alarming. Whoever was attempting to log in was using one of the newly created DOGE accounts — and the person had the correct username and password, according to Berulis. While it's possible the user was disguising their location, it's highly unlikely they'd appear to be coming from Russia if they wanted to avoid suspicion, cybersecurity experts interviewed by NPR explained.</p>   <p>On their own, a few failed login attempts from a Russian IP address aren't a smoking gun, those cybersecurity experts interviewed by NPR said. But given the overall picture of activity, it's a concerning sign that foreign adversaries may already be searching for ways into government systems that DOGE engineers may have left exposed.</p>   <p>"When you move fast and break stuff, the opportunity to ride the coattails of authorized access is ridiculously easy to achieve," said Handorf. What he means is that if DOGE engineers left access points to the network open, it would be very easy for spies or criminals to break in and steal data behind DOGE.</p>   <p>He said he could also see foreign adversaries trying to recruit or pay DOGE team members for access to sensitive data. "It would not surprise me if DOGE is accidentally compromised."</p>   <p>"This is exactly why we usually architect systems using best practices like the principle of least privilege," Ann Lewis, the former director of Technology Transformation Services at the General Services Administration, told NPR in an interview. "The principle of least privilege is a fundamental cybersecurity concept … that states that users should have only the minimum rights, roles and permissions required to perform their roles and responsibilities. This protects access to high-value data and critical assets and helps prevent unauthorized access, accidental damage from user errors and malicious actions. "</p>   <p>Bakaj, Berulis' lawyer, told NPR in a written statement: "This case has been particularly sensitive as it involves the possibility of sophisticated foreign intelligence gaining access to sensitive government systems, which is why we went to the Senate Intelligence Committee directly."<br></p>   <h3><strong>A troubling pattern</strong></h3>   <p>The NLRB isn't alone in those concerns.</p>   <p>In over a dozen lawsuits in federal courts <a href="https://www.npr.org/2025/03/26/nx-s1-5339842/doge-data-access-privacy-act-social-security-treasury-opm-lawsuit" target="_blank">around the country</a>, judges have demanded that DOGE explain why it needs such expansive access to sensitive data on Americans, from Social Security records to private medical records and tax information. But the Trump administration has been unable to give consistent and clear answers, largely dismissing cybersecurity and privacy concerns.</p>   <p>In one case dealing with Treasury Department payment systems that control trillions of dollars in federal spending, U.S. District Judge Jeannette Vargas <a href="https://www.npr.org/2025/03/31/nx-s1-5345708/doge-data-access-labor-cfpb-hhs" target="_blank">blocked DOGE access</a> on Feb. 21, finding "a real possibility exists that sensitive information has already been shared outside of the Treasury Department, in potential violation of federal law."</p>   <p>It's an <a href="https://oversightdemocrats.house.gov/news/press-releases/committee-democrats-are-shining-light-doges-dark-dealings" target="_blank">area of focus </a>for Democratic lawmakers on the House Committee on Oversight and Government Reform.</p>   <div id="resg-s1-60265">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/3128x2085+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2F00%2F20%2Fbce2d3214d218b126bca9a259595%2Fap25072786044651.jpg" alt="U.S. District Judge Jeannette Vargas blocked DOGE access to the Treasury Department over the possibility that &quot;sensitive information has already been shared outside of the Treasury Department.&quot;" loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                U.S. District Judge Jeannette Vargas blocked DOGE access to the Treasury Department over the possibility that "sensitive information has already been shared outside of the Treasury Department."
                <b aria-label="Image credit">
                    
                    Alex Brandon/AP
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Alex Brandon/AP
        
    </span>
</p></div>
   </div>
   <p>An aide for the Democratic minority on the House Oversight Committee who was not authorized to speak publicly told NPR that the committee is in possession of multiple verifiable reports showing that DOGE has exfiltrated sensitive government data across agencies for unknown purposes, revealing that Berulis' disclosure is not an isolated incident.</p>   
   
<!-- END ID="RESNX-S1-5355896-111" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>But government cybersecurity officials are already resigning or being fired, forced to relocate or put on administrative leave all over the federal government, from the <a href="https://www.npr.org/2025/02/11/nx-s1-5293521/foreign-influence-elections-cisa-trump" target="_blank">Cybersecurity and Infrastructure Security Agency</a> to the <a href="https://www.npr.org/2025/03/20/nx-s1-5333655/interior-department-budget-cuts-doge" target="_blank">Interior Department</a>. That has limited their power to respond to the ongoing disruptions or keep track of what DOGE is doing.</p>   
   
<!-- END ID="RESNX-S1-5355896-112" CLASS="BUCKETWRAP INTERNALLINK INSETTWOCOLUMN INSET2COL " -->
   <p>One of the first people to speak out about DOGE's access to sensitive data was Erie Meyer, who resigned as the chief technology officer at the Consumer Financial Protection Bureau (CFPB) in February. She has provided testimony in ongoing court cases surrounding DOGE's access and also spoke to NPR in an interview. The CFPB has sensitive and potentially market-moving data. Meyer said DOGE employees granted themselves "God-tier" access to the CFPB's systems, turned off auditing and event logs and put the cybersecurity experts responsible for insider threat detection on administrative leave. When IT experts at the CFPB planned to conduct an "after action" report on DOGE's activities, they were stonewalled, she continued.</p>   <p>When she heard about how DOGE engineers operated at the NLRB, particularly the steps they took to obfuscate their activities, she recognized a pattern.</p>   <p>"I am trembling," she said upon hearing about the potential exposure of data from the NLRB. "They can get every piece of whistleblower testimony, every report, everything. This is not good."</p>   <p>Other technical employees working with government agencies who spoke to NPR shared Berulis' concerns.</p>   <p>"Our cyber teams are pissed because they have to sit on their hands when every single alarm system we have regarding insider threats is going off," said one employee at an agency of the Interior Department who requested anonymity, fearing retribution. Cybersecurity teams wanted to shut off new users' access to the system, the employee continued, but were ordered to stand down.</p>   <p>Meanwhile, in a <a href="https://federalnewsnetwork.com/commentary/2025/03/letter-to-the-editor-46-former-gsa-executives-say-cuts-to-cause-irreversible-damage/?readmore=1" target="_blank">letter published</a> on March 13 on Federal News Network, 46 former senior officials from the General Services Administration, one of the government agencies hardest hit by DOGE's cost-cutting efforts and that oversees nearly all federal buildings and purchasing, wrote that they believed "highly-sensitive IT systems are being put at risk and sensitive information is being downloaded to unknown, unvetted external sources in clear violation of privacy and data-protection rules."<br></p>   <h3>The tip of the iceberg</h3>   <p>The Trump administration could be trying to codify DOGE's practices into how the government shares information, said Kel McClanahan, the executive director of nonprofit public interest law firm National Security Counselors, who is representing federal employees in a lawsuit concerning the Office of Personnel Management's use of a private email server.</p>   <p>Weeks after DOGE staffers descended on federal buildings across Washington, Trump issued an <a href="https://www.whitehouse.gov/fact-sheets/2025/03/fact-sheet-president-donald-j-trump-eliminates-information-silos-to-stop-waste-fraud-and-abuse-60f3/" target="_blank">executive order</a> urging increased data sharing "by eliminating information silos" in what's seen by experts like McClanahan as an attempt to give DOGE engineers further top cover in accessing and amalgamating sensitive federal data, despite laws concerning privacy and cybersecurity.</p>   <p>"The entire reason we have a Privacy Act is that Congress realized 50 years ago that the federal government was just overflowing with information about normal everyday people and needed some guardrails in place," McClanahan told NPR. "The information silos are there for a reason," he continued. "It's astonishing to me that the very people who not a handful of years ago were screaming about the government tracking us with vaccines now cheer for feeding every piece of information about themselves into Elon Musk's stupid Skynet."</p>   <p>DOGE appears to still be in the process of visiting federal agencies across the country, including just recently the Securities and Exchange Commission, according to one former government source directly familiar with the matter who requested anonymity to share information they weren't authorized to share. Across the government, it's unclear how much sensitive data has been removed and collected and combined.</p>   <p>It's also unclear where the labor data went and who has access to it. But for experts in workers' rights, the threat is immediate and existential.</p>   <p>"This shocks the conscience," said Richard Griffin, the former general counsel of the NLRB. "And if DOGE operatives captured and removed case files, it could constitute a violation of the <a href="https://www.npr.org/2025/03/13/1238261955/over-a-dozen-lawsuits-to-stop-doge-data-access-are-betting-on-a-1974-law" target="_blank">Privacy Act</a>."</p>   <p>For Berulis, it was important to speak out, because he believes people deserve to know how the government's data and computer systems are at risk, and to prevent further damage. As a former IT consultant, Berulis says he would have been fired for operating like DOGE.</p>   <div id="resg-s1-60230">
            <div data-crop-type="">
        <picture>
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/400/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/800/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1300/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/2000/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/2600/quality/85/format/webp/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/webp">
            <source srcset="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/400/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 400w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/800/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 800w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 1000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1300/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 1300w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 1600w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/2000/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 2000w,
https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/2600/quality/85/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg 2600w" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg" sizes="(min-width: 1300px) 1238px, (min-width: 1025px) calc(100vw - 60px), (min-width: 768px) calc(100vw - 60px), calc(100vw - 30px)" type="image/jpeg">
            <img src="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/1100/quality/50/format/jpeg/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg" data-template="https://npr.brightspotcdn.com/dims3/default/strip/false/crop/5666x3777+0+0/resize/{width}/quality/{quality}/format/{format}/?url=http%3A%2F%2Fnpr-brightspot.s3.amazonaws.com%2Fed%2Fe4%2F8bca795840cfa0e88e4efe5b0144%2Fdoge-edit-3.jpg" alt="Daniel Berulis hopes that there might be further investigations into mishandling of sensitive data across the federal government." loading="lazy">
        </picture>
</div>
<div>
    <div>
        <p>
                Daniel Berulis hopes that there might be further investigations into mishandling of sensitive data across the federal government.
                <b aria-label="Image credit">
                    
                    Grace Raver/NPR
                    
                </b>
                <b><b>hide caption</b></b>
            </p>


            <p><b><b>toggle caption</b></b>
    </p></div>

    <p><span aria-label="Image credit">
        
        Grace Raver/NPR
        
    </span>
</p></div>
   </div>
   <p>Disclosing his concerns "was a moral imperative at this point," he said. "I've never encountered this in my 20 years of IT."</p>   <p>His hope is that there might be further investigations into mishandling of sensitive data across the federal government.</p>   <p>"I believe with all my heart that this goes far beyond just case data," he said. "I know there are [people] at other agencies who have seen similar behavior. I firmly believe that this is happening maybe even to a greater extent at other agencies."</p>   <p>For overseers, investigators and IT experts in a similar position, he hopes to provide a road map of what to look for.</p>   <p>"It was my goal by disclosing to Congress not to focus on me at all, but to give them information that they might not necessarily have, the things that you don't necessarily look for unless you know where to look," he continued.</p>   <p>The NLRB said it would cooperate with any investigations that stem from Berulis' disclosure to Congress.</p>   <p>"As an agency protecting employee rights, the NLRB respects its employee's right to bring whistleblower claims to Congress and the Office of Special Counsel, and the Agency looks forward to working with those entities to resolve the complaints," said Bearese, the agency's acting spokesperson, in a statement.</p>   <p>Berulis had a simple request for the DOGE engineers: "Be transparent. If you have nothing to hide, don't delete logs, don't be covert. ... Be open, because that's what efficiency is really about. If this is all a huge misunderstanding, then just prove it. Put it out there. That's all I'm asking."</p>   <p>But ultimately, if the systems that DOGE accesses are left insecure, it might not matter if its intentions are honorable, he concluded.</p>   <p>"This could just be the start of the operation. ... They still haven't crossed that boundary where they're plugged into every federal system out there," he continued. "So maybe there is still time."</p>   <p><strong><em>NPR's Stephen Fowler contributed reporting. NPR's Brett Neely edited this story.&nbsp;</em></strong></p>   <p><em>Have information or evidence to share about DOGE's access to data inside the federal government?&nbsp;Reach out to the author, </em><a href="https://www.npr.org/people/1038324514/jenna-mclaughlin" target="_blank"><em>Jenna McLaughlin</em></a><em>, through encrypted communications on Signal at jennamclaughlin.54. </em><a href="https://www.npr.org/people/1219684807/stephen-fowler" target="_blank"><em>Stephen Fowler</em></a><em> is available on Signal at stphnfwlr.25. Please use a nonwork device.</em></p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Teuken-7B-Base and Teuken-7B-Instruct: Towards European LLMs (238 pts)]]></title>
            <link>https://arxiv.org/abs/2410.03730</link>
            <guid>43690955</guid>
            <pubDate>Tue, 15 Apr 2025 10:17:17 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://arxiv.org/abs/2410.03730">https://arxiv.org/abs/2410.03730</a>, See on <a href="https://news.ycombinator.com/item?id=43690955">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content-inner">
    
    
    <div><p><span>Authors:</span><a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Ali,+M" rel="nofollow">Mehdi Ali</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Fromm,+M" rel="nofollow">Michael Fromm</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Thellmann,+K" rel="nofollow">Klaudia Thellmann</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Ebert,+J" rel="nofollow">Jan Ebert</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Weber,+A+A" rel="nofollow">Alexander Arno Weber</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Rutmann,+R" rel="nofollow">Richard Rutmann</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Jain,+C" rel="nofollow">Charvi Jain</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=L%C3%BCbbering,+M" rel="nofollow">Max Lübbering</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Steinigen,+D" rel="nofollow">Daniel Steinigen</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Leveling,+J" rel="nofollow">Johannes Leveling</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Klug,+K" rel="nofollow">Katrin Klug</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Buschhoff,+J+S" rel="nofollow">Jasper Schulze Buschhoff</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Jurkschat,+L" rel="nofollow">Lena Jurkschat</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Abdelwahab,+H" rel="nofollow">Hammam Abdelwahab</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Stein,+B+J" rel="nofollow">Benny Jörg Stein</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Sylla,+K" rel="nofollow">Karl-Heinz Sylla</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Denisov,+P" rel="nofollow">Pavel Denisov</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Brandizzi,+N" rel="nofollow">Nicolo' Brandizzi</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Saleem,+Q" rel="nofollow">Qasid Saleem</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Bhowmick,+A" rel="nofollow">Anirban Bhowmick</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Helmer,+L" rel="nofollow">Lennard Helmer</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=John,+C" rel="nofollow">Chelsea John</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Suarez,+P+O" rel="nofollow">Pedro Ortiz Suarez</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Ostendorff,+M" rel="nofollow">Malte Ostendorff</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Jude,+A" rel="nofollow">Alex Jude</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Manjunath,+L" rel="nofollow">Lalith Manjunath</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Weinbach,+S" rel="nofollow">Samuel Weinbach</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Penke,+C" rel="nofollow">Carolin Penke</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Filatov,+O" rel="nofollow">Oleg Filatov</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Asaadi,+S" rel="nofollow">Shima Asaadi</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Barth,+F" rel="nofollow">Fabio Barth</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Sifa,+R" rel="nofollow">Rafet Sifa</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=K%C3%BCch,+F" rel="nofollow">Fabian Küch</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Herten,+A" rel="nofollow">Andreas Herten</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=J%C3%A4kel,+R" rel="nofollow">René Jäkel</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Rehm,+G" rel="nofollow">Georg Rehm</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Kesselheim,+S" rel="nofollow">Stefan Kesselheim</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=K%C3%B6hler,+J" rel="nofollow">Joachim Köhler</a>, <a href="https://arxiv.org/search/cs?searchtype=author&amp;query=Flores-Herr,+N" rel="nofollow">Nicolas Flores-Herr</a></p></div>            
    <p><a href="https://arxiv.org/pdf/2410.03730">View PDF</a>
    <a href="https://arxiv.org/html/2410.03730v2">HTML (experimental)</a></p><blockquote>
            <span>Abstract:</span>We present two multilingual LLMs designed to embrace Europe's linguistic diversity by supporting all 24 official languages of the European Union. Trained on a dataset comprising around 60% non-English data and utilizing a custom multilingual tokenizer, our models address the limitations of existing LLMs that predominantly focus on English or a few high-resource languages. We detail the models' development principles, i.e., data composition, tokenizer optimization, and training methodologies. The models demonstrate competitive performance across multilingual benchmarks, as evidenced by their performance on European versions of ARC, HellaSwag, MMLU, and TruthfulQA.
    </blockquote>

    <!--CONTEXT-->
    
  </div><div>
      <h2>Submission history</h2><p> From: Mehdi Ali [<a href="https://arxiv.org/show-email/1a532cfd/2410.03730" rel="nofollow">view email</a>]      <br>            <strong><a href="https://arxiv.org/abs/2410.03730v1" rel="nofollow">[v1]</a></strong>
        Mon, 30 Sep 2024 16:05:38 UTC (391 KB)<br>
    <strong>[v2]</strong>
        Tue, 15 Oct 2024 17:09:40 UTC (4,358 KB)<br>
</p></div></div>]]></description>
        </item>
    </channel>
</rss>