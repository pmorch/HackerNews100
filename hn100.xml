<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Mon, 05 Aug 2024 18:30:02 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Andy Warhol's lost Amiga art found (191 pts)]]></title>
            <link>https://dfarq.homeip.net/andy-warhols-lost-amiga-art-found/</link>
            <guid>41162311</guid>
            <pubDate>Mon, 05 Aug 2024 15:33:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://dfarq.homeip.net/andy-warhols-lost-amiga-art-found/">https://dfarq.homeip.net/andy-warhols-lost-amiga-art-found/</a>, See on <a href="https://news.ycombinator.com/item?id=41162311">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>After 39 years, Andy Warhol’s lost Amiga art has been found. And it’s for sale. Details of the reemergence help to shed light on an earlier discovery from about a decade ago. And those details come from the very person who taught Andy Warhol how to use a computer. In this blog post, I’ll put these discoveries in context, and offer some thoughts from both an art teacher and a sales engineer.</p><h2>The lost Andy Warhol image of Debbie Harry</h2><figure id="attachment_35575" aria-describedby="caption-attachment-35575"><a href="https://dfarq.homeip.net/andy-warhols-lost-amiga-art-found/andy-warhol-debbie-harry-amiga-art/" rel="attachment wp-att-35575"><img fetchpriority="high" decoding="async" src="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-debbie-harry-amiga-art.jpg?resize=294%2C300&amp;ssl=1" alt="Debbie Harry by Andy Warhol, Amiga art from 1985" width="294" height="300" srcset="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-debbie-harry-amiga-art.jpg?resize=294%2C300&amp;ssl=1 294w, https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-debbie-harry-amiga-art.jpg?resize=55%2C55&amp;ssl=1 55w, https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-debbie-harry-amiga-art.jpg?w=490&amp;ssl=1 490w" sizes="(max-width: 294px) 100vw, 294px" data-recalc-dims="1"></a><figcaption id="caption-attachment-35575">The original digital copy of this famous Andy Warhol-created image of Debbie Harry resurfaced in July 2024.</figcaption></figure><p>Commodore famously commissioned Andy Warhol to demonstrate the artistic capabilities of its new <a href="https://dfarq.homeip.net/amiga-1000-ten-years-ahead-of-its-time/">Amiga 1000 computer</a> in 1985. As part of his demonstration, Warhol created some digital art images, including a self-portrait of himself sitting in front of the computer, which in turn was displaying the self portrait. Another image he created was a famous portrait of Debbie Harry, the photogenic lead singer of the New Wave band Blondie.</p><p>In recounting the event, Debbie Harry said in her autobiography that she had a copy of the images from the event, and as far as she knew, only one other person had a copy. She did not identify the other person.</p><h3>The unnamed other person</h3><p>In July 2024, former Commodore engineer <a href="https://www.artnews.com/art-news/news/andy-warhol-lost-portrait-blondie-debbie-harry-resurfaces-1234713192/">Jeff Bruette came forward and said he owns a print of the image Andy Warhol created</a> at the event, and a signed floppy disk containing eight images that Andy Warhol created that day. He said he’s had them on display in his home for about 39 years.</p><p>Some of the accounts of the Warhol art resurfacing describe Bruette as a technician, and although that was essentially the role he was serving at the event, he was much more than a technician. He was a long time Commodore employee, and he programmed two popular early Commodore 64 games that Commodore distributed commercially, Gorf and Wizard of Wor. Bruette also acted as the product manager of the graphics software Warhol used.</p><p>He was more than a technician to Andy Warhol as well. He was the one who taught Andy Warhol how to use an Amiga. For that matter, he probably taught Andy Warhol almost everything he knew about computers in general, not just Amigas.</p><h2>Andy Warhol’s demonstration Amiga art</h2><p>The digital images Andy Warhol created are rudimentary by today’s standards, and in some ways, perhaps less ambitious then some of the thumbnails I create for my blog posts. But this was 39 years ago, and I have much better tools than he did. The maximum resolution he had to work with was 640 pixels in one direction and 400 pixels the other direction. And while he had 4,096 colors to choose from, he could only use 32 of them at a time. He had a digital camera available to him, but it wasn’t a digital camera in any modern sense. It was really best suited to taking monochromatic images.</p><p>To a casual viewer, they look like low resolution images with a very limited number of colors, and it’s not completely unfair to say they bear some resemblance to something my kids would have created in Microsoft Paint when they were little.</p><h3>An art teacher’s impression</h3><p>But when I showed the images to my wife, a former high school art teacher, the first thing she noticed was his choice of colors. He deliberately chose colors that contrasted with each other, and the other colors he used were colors you would get from mixing two or more of the other colors he used. Rule number one of painting, she said, is to never use black or brown, but make your own from the other colors you’re using. Warhol’s images contain odd shades that result from mixing other colors in the image together.</p><p>When you look at Andy Warhol paintings, his style suited these specific tools. He often worked from photographs, creating stark images containing bold flood fills with only a few colors. Sometimes he would cut up photographs, or have someone else cut up the photographs, then he would arrange the pieces and then paint what he saw.</p><p>With the Amiga, he could do all of this digitally. So the choice of Andy Warhol to demonstrate how to use the machine was a brilliant idea. This computer with advanced graphics capabilities for its time, and the ability to multitask and switch between different tools so he could cut up and resize images and then paste the result into the image he was working on couldn’t have suited him any better if he’d designed it himself.</p><p>Problem was, he didn’t know how to use a computer.</p><h3>Andy Warhol’s body language</h3><figure id="attachment_35581" aria-describedby="caption-attachment-35581"><a href="https://dfarq.homeip.net/andy-warhols-lost-amiga-art-found/andy-warhol-self-portrait-amiga-art-2/" rel="attachment wp-att-35581"><img decoding="async" src="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-self-portrait-amiga-art-2.jpg?resize=195%2C300&amp;ssl=1" data-src="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-self-portrait-amiga-art-2.jpg?resize=195%2C300&amp;ssl=1" alt="Andy Warhol self portrait with Amiga computer" width="195" height="300" data-srcset="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-self-portrait-amiga-art-2.jpg?resize=195%2C300&amp;ssl=1 195w, https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/andy-warhol-self-portrait-amiga-art-2.jpg?w=416&amp;ssl=1 416w" data-sizes="(max-width: 195px) 100vw, 195px" data-recalc-dims="1"></a><figcaption id="caption-attachment-35581">Note how Warhol is holding the mouse in this self portrait, keeping his fingers clear of the mouse buttons.</figcaption></figure><p>In all of the photographs I have seen of Andy Warhol with an Amiga, I noticed something. He is never, ever holding the mouse the way I would hold it. He has a death grip on the sides with his thumb on one side and his index and pinky finger on the other. And then he has his pointer and middle fingers curled up, as far away from the two mouse buttons and he can possibly get them while still being able to maintain the death grip on the mouse body. It betrays a fear of accidentally clicking either of the mouse buttons and another fear of accidentally dropping the mouse, or perhaps even accidentally moving the mouse.</p><h3>Warhol’s lament</h3><p>I read somewhere that Andy Warhol didn’t think he was very good at demonstrating how to use the computer, and he wished he could get good at it, because it seemed like a really good way to make money. I asked Jeff Bruette about that, and he said that was consistent with his experience with Warhol. “He saw the things that [AmigaWorld magazine’s art director] was able to create and how I could fluidly click the tools, colors, and menus to create things. He was completely inexperienced with computers and struggled with the process,” Bruette said.</p><p>“In fact, we would go through things together in the morning. After breaking for lunch he’d need a refresher on the difference between the right and left mouse buttons. True story,” he added.</p><p>For those unfamiliar with the Amiga, the left mouse button works like the left mouse button in Windows and other operating systems. The right mouse button activated the pull-down menus at the top of the screen. Conceptually, it was similar to context menus in today’s operating systems.</p><h3>A modern sales engineer’s critique</h3><p>Warhol’s results in creating his computer art were inconsistent. The famous image of Debbie Harry was not the result of the live demonstration. It came from a rehearsal earlier in the day. When he tried to recreate the image live with an audience, the result didn’t look like an Andy Warhol painting. Bruette shared the image in a private group, so I don’t feel like I am at liberty to share it, but I’ll share the story.</p><p>The lighting conditions were different during the event than they had been at rehearsal, so the photo he started with had different contrast. The flood fill to the right of Debbie Harry went fine. When he filled her hair, it was fine on the right side of the image, but not so good on the left. And exactly zero of his other flood fills did what he intended. Without the level of undo that modern paint programs have, he didn’t have an easy way to correct even that first mistake. His efforts to correct it just ended up blowing out her face. Instead of looking like an Andy Warhol painting of Debbie Harry, it looked like what you’d get if you told an impressionist to paint a woman with long hair.</p><p>In my day job, one of my responsibilities happens to be giving product demos. I’ve experienced demos where one mistake compounds the next. You learn to roll with it, but it takes practice.</p><p>When Commodore released the video of the event, they spliced in the image from the rehearsal session.</p><h3>What about flood fills?</h3><p>I’ve heard several stories from other Commodore engineers about how the flood fill function in the software they were using would crash the machine. I’m pretty sure those stories have even ended up in books about Commodore. Bruette said the flood fills were working in the versions of the software Warhol had, and that’s pretty clear even from the images in Warhol’s estate.</p><p>To create Warhol-style digital art, you need to be able to capture an image from a camera, resize it, copy and paste it, select your colors, and do flood fills on it. In a pinch you can get by without resizing and copying and pasting, but not having flood fills would be a showstopper.</p><h2>How the earlier discovery relates</h2><figure id="attachment_35582" aria-describedby="caption-attachment-35582"><a href="https://dfarq.homeip.net/andy-warhols-lost-amiga-art-found/warhol-self-portrait-1985/" rel="attachment wp-att-35582"><img decoding="async" src="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/warhol-self-portrait-1985.jpg?resize=300%2C225&amp;ssl=1" data-src="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/warhol-self-portrait-1985.jpg?resize=300%2C225&amp;ssl=1" alt="A self portrait from Warhol's own collection" width="300" height="225" data-srcset="https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/warhol-self-portrait-1985.jpg?resize=300%2C225&amp;ssl=1 300w, https://i0.wp.com/dfarq.homeip.net/wp-content/uploads/2024/08/warhol-self-portrait-1985.jpg?w=534&amp;ssl=1 534w" data-sizes="(max-width: 300px) 100vw, 300px" data-recalc-dims="1"></a><figcaption id="caption-attachment-35582">In this portion of an image recovered from Warhol’s estate in 2014, you can see how he was messing around with copying and pasting images and flood fills, two techniques he widely used in his other art.</figcaption></figure><p>In 2014, a series of images was recovered from disks found in Andy Warhol’s estate. His personal effects included two pre-production Amiga computers and a collection of disks containing not just the files he created, but also the software he used to create those images, including a previously undiscovered early version of the operating system. In <a href="https://dfarq.homeip.net/the-warhol-amiga-discovery-in-context/">a blog post I wrote at the time</a>, I speculated that the images were the result of him trying to learn how to use the computer.</p><p>Looking at the images again, I think they were more than that. He was experimenting with techniques. One of the images appears to be a photograph of himself where he clicked around with the fill function. But when you look at the image more closely, you can see where he had three different images of himself of differing sizes, and he superimposed the three, then he started messing around with fills.</p><h3>Insights into how (and what) Warhol learned</h3><p>I can almost see and hear Jeff Bruette explaining the capabilities of the computer to Andy Warhol, and then him walking through what Bruette had just described, trying to create in his own style using what he had just learned.</p><p>That’s because I had to do something similar. The discomfort level in the photographs of Andy Warhol with the computer remind me of something. I was in the odd position of teaching my own teachers about computers from the time I was a teenager into my mid 20s. Many of them had the same level of discomfort with the mouse. I would fire up Solitaire and have them play that to get used to clicking and dragging. Bruette didn’t have that luxury when tutoring Warhol.</p><h2>The lost opportunity</h2><p>I always wished Commodore had <a href="https://dfarq.homeip.net/the-trade-off-of-fidelity-and-convenience-in-marketing-and-how-it-doomed-my-favorite-company/">pursued the Andy Warhol connection further</a>. Now I understand why it didn’t happen. I don’t think Commodore marketing recognized the opportunity, but I also don’t think Andy Warhol was comfortable with it. It wasn’t the same as sitting William Shatner down in front of a VIC-20 with a simulated screen on the TV and showing him how to position his hands so it looked like he was typing and showing him where the cameras were so he could make sure he was looking at the camera while he was smiling. He was trying to do it right, he struggled to do it live, and he gave up.</p><p>He was trying to be a modern day sales engineer, but without the benefit of the professional training that I received. I also had at least five years of professional experience with the product I was demonstrating before gaining the title of sales engineer. I also sometimes had to give product demos at another company, a company whose software was not as far along, and where I had about the same level of experience and as Andy Warhol did, and let’s just say that didn’t go as well.</p><h3>A possible workaround</h3><p>But they had options. They could have done a Shatner-like maneuver in print advertising, having Warhol mime in front of the computer, with a copy of the image on screen but the mouse unplugged, just to make it look like he was producing it live. And then they could have added some text about how this new computer is the first one ever that works the way Andy Warhol does.</p><p>At any rate, I think it’s fantastic that the images Andy Warhol created on that day survive, we now know where the copy is, and the person who preserved them for 39 years will have a chance to get them into the hands of someone who will enjoy them, and use the proceeds to fund his retirement. That sounds like a win all around to me, and it closes the loop on some details of Andy Warhol’s involvement with the Amiga computer.</p><div itemtype="http://schema.org/Person" itemscope="" itemprop="author"><p>David Farquhar is a computer security professional, entrepreneur, and author. He started his career as a part-time computer technician in 1994, worked his way up to system administrator by 1997, and has specialized in vulnerability management since 2013. He invests in real estate on the side and his hobbies include O gauge trains, baseball cards, and retro computers and video games. A University of Missouri graduate, he holds CISSP and Security+ certifications. He lives in St. Louis with his family.</p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Apple Intelligence beta flagged a phishing email as "Priority" (199 pts)]]></title>
            <link>https://social.panic.com/@cabel/112905175504595751</link>
            <guid>41159680</guid>
            <pubDate>Mon, 05 Aug 2024 10:12:04 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://social.panic.com/@cabel/112905175504595751">https://social.panic.com/@cabel/112905175504595751</a>, See on <a href="https://news.ycombinator.com/item?id=41159680">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Japan's Nikkei Posts Biggest Single-Day Fall Since 1987 After Weak U.S. Data (102 pts)]]></title>
            <link>https://www.wsj.com/finance/stocks/japan-stocks-fall-sharply-after-weak-u-s-jobs-data-yen-strengthening-3903689f</link>
            <guid>41159372</guid>
            <pubDate>Mon, 05 Aug 2024 09:05:48 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.wsj.com/finance/stocks/japan-stocks-fall-sharply-after-weak-u-s-jobs-data-yen-strengthening-3903689f">https://www.wsj.com/finance/stocks/japan-stocks-fall-sharply-after-weak-u-s-jobs-data-yen-strengthening-3903689f</a>, See on <a href="https://news.ycombinator.com/item?id=41159372">Hacker News</a></p>
Couldn't get https://www.wsj.com/finance/stocks/japan-stocks-fall-sharply-after-weak-u-s-jobs-data-yen-strengthening-3903689f: Error: Request failed with status code 401]]></description>
        </item>
        <item>
            <title><![CDATA[Postgres stores data on disk – this one's a page turner (324 pts)]]></title>
            <link>https://drew.silcock.dev/blog/how-postgres-stores-data-on-disk/</link>
            <guid>41159180</guid>
            <pubDate>Mon, 05 Aug 2024 08:28:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://drew.silcock.dev/blog/how-postgres-stores-data-on-disk/">https://drew.silcock.dev/blog/how-postgres-stores-data-on-disk/</a>, See on <a href="https://news.ycombinator.com/item?id=41159180">Hacker News</a></p>
<div id="readability-page-1" class="page"><article> <p>I remember when I first started on server-side applications – the kind that need to persist data – and not getting what the big deal about databases was. Why are databases such a big thing? Can’t we just store some data on disk and read / write from it when we need to? (<strong>Spoiler:</strong> no.)</p>
<p>Once I started working with real-life applications instead of just hobby projects, I realised that databases are basically magic, and SQL is the arcane tongue that allows you to channel that magic. In fact, it’s easy to think of databases like a black box where you make sure your tables are indexed sensibly and your queries aren’t doing anything silly, and the rest <em>just happens</em>.</p>
<p>But really, databases aren’t <em>that</em> complicated. I mean, they kind of are but if you dig inside the database engine a bit, you realise that it’s really just some immensely powerful and clever abstractions and that, like most software, most of the actual complexity in these pieces of software comes from the edge cases, often around concurrency.</p>
<p>I’d like crack open the hard shell of database engines with some friendly introductions to those who are familiar with relational databases but don’t know their inner machinations. I’m going to talk about PostgreSQL because that’s what I’m most familiar with, and it’s also the most popular database in use by developers according to the <a href="https://survey.stackoverflow.co/2023/#section-most-popular-technologies-databases">Stack Overflow Developer Survey 2023</a> and <a href="https://survey.stackoverflow.co/2024/technology#1-databases">Stack Overflow Developer Survey 2024</a>.</p>
<p>To start things off, I’m going to discuss how Postgres actually stores data on disk. I mean, it’s all just files, right?</p>
<h2 id="loading-a-nice-fresh-postgres-install">Loading a nice fresh Postgres install</h2>
<p>Postgres stores all its data in a directory sensibly called <code>/var/lib/postgresql/data</code> <sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup> . Let’s spin up an empty Postgres installation with Docker and mount the data directory in a local folder so that we can see what’s going on in there. (Feel free to follow along and explore the files for yourself!)</p>
<div><figure><pre data-language="shell"><code><div><div><p>1</p></div><p><span>docker</span><span> </span><span>run</span><span> </span><span>--rm</span><span> </span><span>-v</span><span> </span><span>./pg-data:/var/lib/postgresql/data</span><span> </span><span>-e</span><span> </span><span>POSTGRES_PASSWORD=password</span><span> </span><span>postgres:16</span></p></div></code></pre></figure></div>
<p>You should see a bunch of text saying all kinds of interesting things like <code>selecting dynamic shared memory implementation ... posix</code> and <code>performing post-bootstrap initialization ... ok</code> and then eventually <code>LOG:  database system is ready to accept connections</code>. Now kill the server with ctrl-C so that we can have a look at what files have been created.</p>
<div><figure><pre data-language="console"><code><div><div><p>1</p></div><p><span>$ ls -l pg-data</span></p></div><div><div><p>2</p></div><p><span>drwx------     -   base/</span></p></div><div><div><p>3</p></div><p><span>drwx------     -   global/</span></p></div><div><div><p>4</p></div><p><span>drwx------     -   pg_commit_ts/</span></p></div><div><div><p>5</p></div><p><span>drwx------     -   pg_dynshmem/</span></p></div><div><div><p>6</p></div><p><span>.rw-------@ 5.7k   pg_hba.conf</span></p></div><div><div><p>7</p></div><p><span>.rw-------@ 2.6k   pg_ident.conf</span></p></div><div><div><p>8</p></div><p><span>drwx------     -   pg_logical/</span></p></div><div><div><p>9</p></div><p><span>drwx------     -   pg_multixact/</span></p></div><div><div><p>10</p></div><p><span>drwx------     -   pg_notify/</span></p></div><div><div><p>11</p></div><p><span>drwx------     -   pg_replslot/</span></p></div><div><div><p>12</p></div><p><span>drwx------     -   pg_serial/</span></p></div><div><div><p>13</p></div><p><span>drwx------     -   pg_snapshots/</span></p></div><div><div><p>14</p></div><p><span>drwx------     -   pg_stat/</span></p></div><div><div><p>15</p></div><p><span>drwx------     -   pg_stat_tmp/</span></p></div><div><div><p>16</p></div><p><span>drwx------     -   pg_subtrans/</span></p></div><div><div><p>17</p></div><p><span>drwx------     -   pg_tblspc/</span></p></div><div><div><p>18</p></div><p><span>drwx------     -   pg_twophase/</span></p></div><div><div><p>19</p></div><p><span>.rw-------     3   PG_VERSION</span></p></div><div><div><p>20</p></div><p><span>drwx------     -   pg_wal/</span></p></div><div><div><p>21</p></div><p><span>drwx------     -   pg_xact/</span></p></div><div><div><p>22</p></div><p><span>.rw-------@   88   postgresql.auto.conf</span></p></div><div><div><p>23</p></div><p><span>.rw-------@  30k   postgresql.conf</span></p></div><div><div><p>24</p></div><p><span>.rw-------    36   postmaster.opts</span></p></div></code></pre></figure></div>
<p>There’s a lot of folders here, but if you look, most of them are empty.</p>
<p>Before we dig into these, a quick terminology overview:</p>

















































<table><thead><tr><th>Term</th><th>Meaning</th></tr></thead><tbody><tr><td>Database cluster</td><td>The term ‘cluster’ is a bit overloaded here - we’re using it the <a href="https://www.postgresql.org/docs/current/creating-cluster.html">same way that the Postgres docs use it</a>, meaning a single instance of a PostgreSQL server which is running multiple databases on the same machine (where each database is created with <code>create database mydbname</code>).</td></tr><tr><td>Database connection</td><td>When a client connects to the Postgres server, it initiates a database connection. When this happens, Postgres creates a sub-process on the server.</td></tr><tr><td>Database session</td><td>Once the connection has been authenticated, the client has established a session, which it can then use to execute SQL.</td></tr><tr><td>Transaction a.k.a. tx, xact</td><td>SQL is executed within the session inside transactions, which are units of work which are executed, committed and succeed or fail as a single unit of work. If a transaction fails, it is rolled back and all the changes made in the transaction are undone.</td></tr><tr><td>Snapshot</td><td>Each transaction sees its own copy of the database, called its snapshot. If you have multiple sessions reading and writing the same data at the same time, they will in general not see the exact same data but will see different snapshots depending on the exact timing of the transactions. It’s possible to synchronise and export snapshots.</td></tr><tr><td>Schema</td><td>A database consists of multiple schemas (or <em>schemata</em>, if you’re being pretentious), each of which is a logical namespace for tables, functions, triggers and every thing that databases store. The default schema is called <code>public</code> and if you don’t specify a schema, it’s the same as manually specifying <code>public</code>.</td></tr><tr><td>Table</td><td>A database consists of multiple tables, each of which represents a single unordered collection of items with a particular number of columns, each of a specific type.</td></tr><tr><td>Tablespace</td><td>A tablespace is a physical separation (as opposed to schemas, which are a logical separation). We’ll see more about tablespaces later.</td></tr><tr><td>Row</td><td>A table consists of multiple unordered rows, each of which is a single collection of data points defining a specific <em>thing</em>.</td></tr><tr><td>Tuple</td><td>A tuple is very similar to a row, but a tuple is immutable. The state of a specific row at a specific time is a tuple, but a tuple is a more general term for a collection of data points. When you return data from a query, you can get tuples.</td></tr></tbody></table>
<p>Now let’s do a quick overview of what all these top-level files and folders are for. You don’t need to worry about every single one of these – most of them cover more complicated use cases, which is why they’re empty for us – but I still think it’s interesting to know what each files and folder is for.</p>





































































































<table><thead><tr><th>Directory</th><th>Explanation</th></tr></thead><tbody><tr><td><code>  base/</code></td><td>Contains a subdirectory for each database. Inside each sub-directory are the files with the actual data in them. We’ll dig into this more in a second.</td></tr><tr><td><code>  global/</code></td><td>Directly contains files for cluster-wide tables like <code>pg_database</code>.</td></tr><tr><td><code>  pg_commit_ts/</code></td><td>As the name suggests, contains timestamps for transaction commits. We don’t have any commits or transactions yet, so this is empty.</td></tr><tr><td><code>  pg_dynshmem/</code></td><td>Postgres uses multiple processes (not multiple threads, although there has been <a href="https://www.postgresql.org/message-id/31cc6df9-53fe-3cd9-af5b-ac0d801163f4%40iki.fi">discussion around it</a>) so in order to share memory between processes, Postgres has a dynamic shared memory subsystem. This can use <a href="https://man7.org/linux/man-pages/man3/shm_open.3.html"><code>shm_open</code></a>, <a href="https://man7.org/linux/man-pages/man2/shmget.2.html"><code>shmget</code></a> or <a href="https://man7.org/linux/man-pages/man2/mmap.2.html"><code>mmap</code></a> on Linux – by default it uses <code>shm_open</code>. The shared memory object files are stored in this folder.</td></tr><tr><td><code>  pg_hba.conf</code></td><td>This is the <a href="https://www.postgresql.org/docs/current/auth-pg-hba-conf.html">Host-Based Authentication (HBA) file</a> which allows you to configure access to your cluster based on hostname. For instance, by default this file has <code>host all all 127.0.0.1/32 trust</code> which means “trust anyone connecting to any database without a password if they’re connecting from localhost”. If you’ve ever wondered why you don’t need to put your password in when running <code>psql</code> on the same machine as the server, this is why.</td></tr><tr><td><code>  pg_ident.conf</code></td><td>This is a <a href="https://www.postgresql.org/docs/current/auth-username-maps.html">user name mapping file</a> which isn’t particularly interesting for our purposes.</td></tr><tr><td><code>  pg_logical/</code></td><td>Contains status data for logical decoding. We don’t have time to talk about how the Write-Ahead Log (WAL) works in full, but in short, Postgres writes changes that it’s going to make to the WAL, then if it crashes it can just re-read and re-run all the operations in the WAL to get back to the expected database state. The process of turning the WAL back into the high-level operations – for the purposes of recovery, replication, or auditing –  is called logical decoding and Postgres stores files related to this process in here.</td></tr><tr><td><code>  pg_multixact/</code></td><td>”xact” is what the Postgres calls transactions so this contains status data for multitransactions. Multitransactions are a <a href="https://www.highgo.ca/2020/06/12/transactions-in-postgresql-and-their-mechanism/">thing that happens when you’ve got multiple sessions</a> who are all trying to do a row-level lock on the same rows.</td></tr><tr><td><code>  pg_notify/</code></td><td>In Postgres you can <a href="https://tapoueh.org/blog/2018/07/postgresql-listen-notify/">listen for changes on a channel and notify listeners of changes</a>. This is useful if you have an application that wants to action something whenever a particular event happens. For instance, if you have an application that wants to know every time a row is added or updated in a particular table so that it can synchronise with an external system. You can set up a trigger which notifies all the listeners whenever this change occurs. Your application can then listen for that notification and update the external data store however it wants to.</td></tr><tr><td><code>  pg_replslot/</code></td><td>Replication is the mechanism by which databases can synchronise between multiple running server instances. For instance, if you have some really important data that you don’t want to lose, you could set up a couple of replicas so that if your main database dies and you lose all your data, you can recover from one of the replicas. This can be physical replication (literally copying disk files) and logical replication (basically copying the WAL to all the replicas so that the main database can eb reconstructed from the replica’s WAL via logical decoding.) This folder contains data for the various replication slots, which are a way of ensuring WAL entries are kept for particular replicas even when it’s not needed by the main database.</td></tr><tr><td><code>  pg_serial/</code></td><td>Contains information on committed serialisable transactions. Serialisable transactions are the highest level of strictness for transaction isolation, which you can read more about <a href="https://www.postgresql.org/docs/current/transaction-iso.html">in the docs</a>.</td></tr><tr><td><code>  pg_snapshots/</code></td><td>Contains exported snapshots, used e.g. by <code>pg_dump</code> which can dump a database in parallel.</td></tr><tr><td><code>  pg_stat/</code></td><td>Postgres calculates statistics for the various tables which it uses to inform sensible query plans and plan executions. For instance, if the query planner knows it needs to do a sequential scan across a table, it can look at approximately how many rows are in that table to determine how much memory should be allocated. This folder contains permanent statistics files calculated form the tables. Understanding statistics is really important to analysing and fixing poor query performance.</td></tr><tr><td><code>  pg_stat_tmp/</code></td><td>Similar to <code>pg_stat/</code> apart from this folder contains temporary files relating to the statistics that Postgres keeps, not the permanent files.</td></tr><tr><td><code>  pg_subtrans/</code></td><td>Subtransactions are another kind of transaction, like multitransactions. They’re a way to split a single transaction into multiple smaller subtransactions, and this folder contains status data for them.</td></tr><tr><td><code>  pg_tblspc/</code></td><td>Contains symbolic references to the different tablespaces. A <a href="https://www.postgresql.org/docs/current/manage-ag-tablespaces.html">tablespace</a> is a physical location which can be used to store some of the database objects, as configured by the DB administrator. For instance, if you have a really frequently used index, you could use a tablespace to put that index on a super speedy expensive solid state drive while the rest of the table sits on a cheaper, slower disk.</td></tr><tr><td><code>  pg_twophase/</code></td><td>It’s possible to <a href="https://www.postgresql.org/docs/current/sql-prepare-transaction.html">“prepare”</a> transactions, which means that the transaction is dissociated from the current session and is stored on disk. This is useful for two-phase commits, where you want to commit changes to multiple systems at the same time and ensure that both transactions either fail and rollback or succeed and commit</td></tr><tr><td><code>  PG_VERSION</code></td><td>This one’s easy – it’s got a single number in which is the major version of Postgres we’re in, so in this case we’d expect this to have the number <code>16</code> in.</td></tr><tr><td><code>  pg_wal/</code></td><td>This is where the Write-Ahead Log (WAL) files are stored.</td></tr><tr><td><code>  pg_xact/</code></td><td>Contains status data for transaction commits, i.e. metadata logs.</td></tr><tr><td><code>  postgresql.auto.conf</code></td><td>This contains server configuration parameters, like <code>postgresql.conf</code>, but is automatically written to by <code>alter system</code> commands, which are SQL commands that you can run to dynamically modify server parameters.</td></tr><tr><td><code>  postgresql.conf</code></td><td>This file contains all the possible server parameters you can configure for a Postgres instance. This goes all the way from <code>autovacuum_naptime</code> to <code>zero_damaged_pages</code>. If you want to understand all the possible Postgres server parameters and what they do in human language, I’d highly recommend checking out <a href="https://postgresqlco.nf/">postgresqlco.nf</a></td></tr><tr><td><code>  postmaster.opts</code></td><td>This simple file contains the full CLI command used to invoke Postgres the last time that it was run.</td></tr></tbody></table>
<p>There’s also a file called <code>postmaster.pid</code> which you only see while the Postgres process is actively running, which contains information about the postmaster process ID, what port its listening on, what time it started, etc. We won’t see that here because we stopped our Postgres server to examine the files.</p>
<p>So that was quite intense – don’t worry if you didn’t fully understand what all those things mean – it’s all super interesting stuff but you don’t need to follow most of that to understand what we’re going to talk about, which is the actual database storage.</p>
<h2 id="exploring-the-database-folders">Exploring the database folders</h2>
<p>Okay, so we mentioned the <code>base/</code> directory above, which has a subdirectory for each individual database in your cluster. Let’s take a look at what we’ve got here:</p>
<div><figure><pre data-language="console"><code><div><div><p>1</p></div><p><span>$ ls -l pg-data/base</span></p></div><div><div><p>2</p></div><p><span>drwx------ -   1/</span></p></div><div><div><p>3</p></div><p><span>drwx------ -   4/</span></p></div><div><div><p>4</p></div><p><span>drwx------ -   5/</span></p></div></code></pre></figure></div>
<p>Wait, why are there already 3 folders in here? We haven’t even created any databases yet.</p>
<p>The reason is that when you start up a fresh Postgres server, Postgres will automatically create 3 databases for you. They are:</p>
<ul>
<li><code>postgres</code> – when you connect to a server, you need the name of a database to connect to, but you don’t always know what the name is. This is also true of database management tools. While it’s not strictly necessary, you can almost always rely on the <code>postgres</code> database existing – once you’ve connected to this empty, default database, you can list all the other databases on the server, create new databases, and so on.</li>
<li><code>template0</code>, <code>template1</code> – as the name suggests, these databases are templates used to create future databases.</li>
</ul>
<p>Why are the subdirectories called numbers instead of names?</p>
<p>Well in Postgres, all the system tables for things like namespaces, roles, tables and functions use an Object IDentifier (OID) to identify them. In this case, <code>1</code>, <code>4</code> and <code>5</code> are the OIDs for <code>postgres</code>, <code>template0</code> and <code>template1</code>.</p>
<h2 id="lets-play-with-some-data">Let’s play with some data</h2>
<p>These in-built tables don’t have anything in them and are generally pretty boring, so let’s create ourselves a new database and put them data in so that we can examine the data files themselves.</p>
<p>First, let’s run and detach the Postgres container so that we can query it.</p>
<div><figure><pre data-language="shell"><code><div><div><p>1</p></div><p><span>docker</span><span> </span><span>run</span><span> </span><span>-d</span><span> </span><span>--rm</span><span> </span><span>-v</span><span> </span><span>./pg-data:/var/lib/postgresql/data</span><span> </span><span>-e</span><span> </span><span>POSTGRES_PASSWORD=password</span><span> </span><span>postgres:16</span></p></div></code></pre></figure></div>
<p>We could use anything as our play dataset, but I like geography so let’s make a table with some countries in. Let’s download some country data into our container and load it into a new database.</p>
<div><figure><pre data-language="shell"><code><div><div><p>1</p></div><p><span>curl</span><span> </span><span>'https://raw.githubusercontent.com/lukes/ISO-3166-Countries-with-Regional-Codes/master/all/all.csv'</span><span> </span><span>\</span></p></div><div><div><p>2</p></div><p><span>    </span><span>--output</span><span> </span><span>./pg-data/countries.csv</span></p></div></code></pre></figure></div>
<p>We can use a local tool like psql or TablePlus to examine the database, but we’re going to just exec into the container and use psql from inside the container. This way, we don’t have to worry about mapping ports or mismatching psql and Postgres server versions. (Also, it’s easier for everyone to follow along at home.)</p>
<div><figure><pre data-language="shell"><code><div><div><p>1</p></div><p><span>pg_container_id</span><span>=</span><span>$(</span><span>docker</span><span> </span><span>ps</span><span> </span><span>--filter</span><span> </span><span>expose=</span><span>5432</span><span> </span><span>--format</span><span> </span><span>"{{.ID}}"</span><span>)</span></p></div><div><div><p>2</p></div><p><span>docker</span><span> </span><span>exec</span><span> </span><span>-it</span><span> $pg_container_id </span><span>psql</span><span> </span><span>-U</span><span> </span><span>postgres</span></p></div></code></pre></figure></div>
<p>Here we’re getting the container ID of the running Postgres container by filtering by containers which expose port 5432 as Postgres does and putting that into the <code>docker exec</code> command to give us an interactive psql shell. The <code>-U postgres</code> is because the default Postgres user in the official Docker image is <code>postgres</code>, not <code>root</code> which is the psql default.</p>
<p>If that works, you should see something like:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>psql (</span><span>16</span><span>.</span><span>3</span><span> (Debian </span><span>16</span><span>.</span><span>3</span><span>-</span><span>1</span><span>.pgdg120</span><span>+</span><span>1</span><span>))</span></p></div><div><div><p>2</p></div><p><span>Type</span><span> </span><span>"help"</span><span> </span><span>for</span><span> help.</span></p></div><div><p>3</p></div><div><div><p>4</p></div><p><span>postgres</span><span>=</span><span>#</span></p></div></code></pre></figure></div>
<p>Now let’s create our new database and load the data in: <sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="" aria-describedby="footnote-label">2</a></sup></p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>create</span><span> </span><span>database</span><span> </span><span>blogdb</span><span>;</span></p></div><div><div><p>2</p></div><p><span>\c blogdb;</span></p></div><div><p>3</p></div><div><div><p>4</p></div><p><span>create</span><span> </span><span>table</span><span> </span><span>countries</span><span> (</span></p></div><div><div><p>5</p></div><p><span><span>  </span></span><span>id </span><span>integer</span><span> </span><span>primary key</span><span> </span><span>generated</span><span> </span><span>always</span><span> </span><span>as</span><span> </span><span>identity</span><span>,</span></p></div><div><div><p>6</p></div><p><span>  </span><span>name</span><span> </span><span>text</span><span> </span><span>not null</span><span> </span><span>unique</span><span>,</span></p></div><div><div><p>7</p></div><p><span><span>  </span></span><span>alpha_2 </span><span>char</span><span>(</span><span>2</span><span>) </span><span>not null</span><span>,</span></p></div><div><div><p>8</p></div><p><span><span>  </span></span><span>alpha_3 </span><span>char</span><span>(</span><span>3</span><span>) </span><span>not null</span><span>,</span></p></div><div><div><p>9</p></div><p><span><span>  </span></span><span>numeric_3 </span><span>char</span><span>(</span><span>3</span><span>) </span><span>not null</span><span>,</span></p></div><div><div><p>10</p></div><p><span><span>  </span></span><span>iso_3166_2 </span><span>text</span><span> </span><span>not null</span><span>,</span></p></div><div><div><p>11</p></div><p><span><span>  </span></span><span>region </span><span>text</span><span>,</span></p></div><div><div><p>12</p></div><p><span><span>  </span></span><span>sub_region </span><span>text</span><span>,</span></p></div><div><div><p>13</p></div><p><span><span>  </span></span><span>intermediate_region </span><span>text</span><span>,</span></p></div><div><div><p>14</p></div><p><span><span>  </span></span><span>region_code </span><span>char</span><span>(</span><span>3</span><span>),</span></p></div><div><div><p>15</p></div><p><span><span>  </span></span><span>sub_region_code </span><span>char</span><span>(</span><span>3</span><span>),</span></p></div><div><div><p>16</p></div><p><span><span>  </span></span><span>intermediate_region_code </span><span>char</span><span>(</span><span>3</span><span>)</span></p></div><div><div><p>17</p></div><p><span>);</span></p></div><div><p>18</p></div><div><div><p>19</p></div><p><span>copy</span><span> countries (</span></p></div><div><div><p>20</p></div><p><span>  </span><span>name</span><span>,</span></p></div><div><div><p>21</p></div><p><span><span>  </span></span><span>alpha_2,</span></p></div><div><div><p>22</p></div><p><span><span>  </span></span><span>alpha_3,</span></p></div><div><div><p>23</p></div><p><span><span>  </span></span><span>numeric_3,</span></p></div><div><div><p>24</p></div><p><span><span>  </span></span><span>iso_3166_2,</span></p></div><div><div><p>25</p></div><p><span><span>  </span></span><span>region,</span></p></div><div><div><p>26</p></div><p><span><span>  </span></span><span>sub_region,</span></p></div><div><div><p>27</p></div><p><span><span>  </span></span><span>intermediate_region,</span></p></div><div><div><p>28</p></div><p><span><span>  </span></span><span>region_code,</span></p></div><div><div><p>29</p></div><p><span><span>  </span></span><span>sub_region_code,</span></p></div><div><div><p>30</p></div><p><span><span>  </span></span><span>intermediate_region_code</span></p></div><div><div><p>31</p></div><p><span>)</span></p></div><div><div><p>32</p></div><p><span>from</span><span> </span><span>'/var/lib/postgresql/data/countries.csv'</span></p></div><div><div><p>33</p></div><p><span>delimiter </span><span>','</span><span> csv header;</span></p></div><div><p>34</p></div><div><div><p>35</p></div><p><span>-- Check that the data got loaded into the table ok.</span></p></div><div><div><p>36</p></div><p><span>select</span><span> </span><span>*</span><span> </span><span>from</span><span> countries </span><span>limit</span><span> </span><span>10</span><span>;</span></p></div><div><p>37</p></div><div><div><p>38</p></div><p><span>-- Should say 249.</span></p></div><div><div><p>39</p></div><p><span>select</span><span> </span><span>count</span><span>(</span><span>*</span><span>) </span><span>from</span><span> countries;</span></p></div></code></pre></figure></div>
<p>Great, so we’ve got a table with 249 rows and a single index corresponding to our unique constraint on the <code>name</code> column.</p>
<h2 id="show-me-the-files">Show me the files</h2>
<p>Let’s take another look at our <code>base/</code> folder:</p>
<div><figure><pre data-language="console"><code><div><div><p>1</p></div><p><span>$ ls -l pg-data/base</span></p></div><div><div><p>2</p></div><p><span>drwx------ -   1/</span></p></div><div><div><p>3</p></div><p><span>drwx------ -   4/</span></p></div><div><div><p>4</p></div><p><span>drwx------ -   5/</span></p></div><div><div><p>5</p></div><p><span>drwx------ -   16388/</span></p></div></code></pre></figure></div>
<p>In this case it’s pretty obvious that our <code>blogdb</code> is <code>16388</code> but if you’re working with loads of database on the same cluster, you might not know. If you’re following along from home, it probably has a different value. If you want to find out, simply do:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>postgres</span><span>=</span><span># </span><span>select</span><span> </span><span>oid</span><span>, datname </span><span>from</span><span> pg_database;</span></p></div><div><div><p>2</p></div><p><span>  </span><span>oid</span><span>  |  datname</span></p></div><div><div><p>3</p></div><p><span>-------+-----------</span></p></div><div><div><p>4</p></div><p><span>     </span><span>5</span><span> | postgres</span></p></div><div><div><p>5</p></div><p><span> </span><span>16388</span><span> | blogdb</span></p></div><div><div><p>6</p></div><p><span>     </span><span>1</span><span> | template1</span></p></div><div><div><p>7</p></div><p><span>     </span><span>4</span><span> | template0</span></p></div><div><div><p>8</p></div><p><span>(</span><span>4</span><span> </span><span>rows</span><span>)</span></p></div></code></pre></figure></div>
<p>Let’s have a peek at what’s inside this folder:</p>
<div><figure><pre data-language="console"><code><div><div><p>1</p></div><p><span>$ cd pg-data/base/16388</span></p></div><div><div><p>2</p></div><p><span>$ ls -l </span><span>.</span></p></div><div><div><p>3</p></div><p><span>.rw------- 8.2k   112</span></p></div><div><div><p>4</p></div><p><span>.rw------- 8.2k   113</span></p></div><div><div><p>5</p></div><p><span>.rw------- 8.2k   174</span></p></div><div><div><p>6</p></div><p><span>.rw------- 8.2k   175</span></p></div><div><div><p>7</p></div><p><span>.rw------- 8.2k   548</span></p></div><div><div><p>8</p></div><p><span>.rw------- 8.2k   549</span></p></div><div><div><p>9</p></div><p><span>.rw-------    0   826</span></p></div><div><div><p>10</p></div><p><span>.rw------- 8.2k   827</span></p></div><div><div><p>11</p></div><p><span>.rw------- 8.2k   828</span></p></div><div><div><p>12</p></div><p><span>.rw------- 123k   1247</span></p></div><div><div><p>13</p></div><p><span>.rw-------  25k   1247_fsm</span></p></div><div><div><p>14</p></div><p><span>.rw------- 8.2k   1247_vm</span></p></div><div><div><p>15</p></div><p><span>.rw------- 475k   1249</span></p></div><div><div><p>16</p></div><p><span>.rw-------  25k   1249_fsm</span></p></div><div><div><p>17</p></div><p><span>...</span></p></div><div><div><p>18</p></div><p><span>.rw-------  25k   16390_fsm</span></p></div><div><div><p>19</p></div><p><span>.rw-------    0   16393</span></p></div><div><div><p>20</p></div><p><span>.rw------- 8.2k   16394</span></p></div><div><div><p>21</p></div><p><span>.rw-------  16k   16395</span></p></div><div><div><p>22</p></div><p><span>.rw-------  16k   16397</span></p></div><div><div><p>23</p></div><p><span>.rw-------  524   pg_filenode.map</span></p></div><div><div><p>24</p></div><p><span>.rw------- 160k   pg_internal.init</span></p></div><div><div><p>25</p></div><p><span>.rw-------    3   PG_VERSION</span></p></div><div><div><p>26</p></div><p><span>$ ls -l </span><span>|</span><span> </span><span>wc</span><span> </span><span>-l</span></p></div><div><div><p>27</p></div><p><span>306</span></p></div><div><div><p>28</p></div><p><span>$ du -h </span><span>.</span></p></div><div><div><p>29</p></div><p><span>7.6M    .</span></p></div></code></pre></figure></div>
<p>There’s a surprising number of files in there considering we’ve only got 249 rows. So what’s going on?</p>
<p>There are a few useful system catalogs that we can use to make sense of this:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>-- First, let's get the OID of the 'public' namespace that our table lives in - you need</span></p></div><div><div><p>2</p></div><p><span>-- to run this in the 'blogdb' database, otherwise you'll get the OID of the 'public'</span></p></div><div><div><p>3</p></div><p><span>-- namespace for the database you're currently connected to.</span></p></div><div><div><p>4</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> to_regnamespace(</span><span>'public'</span><span>)::</span><span>oid</span><span>;</span></p></div><div><div><p>5</p></div><p><span><span> </span></span><span>to_regnamespace</span></p></div><div><div><p>6</p></div><p><span>-----------------</span></p></div><div><div><p>7</p></div><p><span>            </span><span>2200</span></p></div><div><div><p>8</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>9</p></div><div><div><p>10</p></div><p><span>-- Now let's list all the tables, indexes, etc. that live in this namespace.</span></p></div><div><div><p>11</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> </span><span>*</span><span> </span><span>from</span><span> pg_class</span></p></div><div><div><p>12</p></div><p><span>blogdb</span><span>-</span><span># </span><span>where</span><span> relnamespace </span><span>=</span><span> to_regnamespace(</span><span>'public'</span><span>)::</span><span>oid</span><span>;</span></p></div><div><div><p>13</p></div><p><span>  </span><span>oid</span><span>  |      relname       | relnamespace | reltype | reloftype | relowner | relam | relfilenode | reltablespace | relpages | reltuples | relallvisible | reltoastrelid | relhasindex | relisshared | relpersistence | relkind | relnatts | relchecks | relhasrules | relhastriggers | relhassubclass | relrowsecurity | relforcerowsecurity | relispopulated | relreplident | relispartition | relrewrite | relfrozenxid | relminmxid | relacl | reloptions | relpartbound</span></p></div><div><div><p>14</p></div><p><span>-------+--------------------+--------------+---------+-----------+----------+-------+-------------+---------------+----------+-----------+---------------+---------------+-------------+-------------+----------------+---------+----------+-----------+-------------+----------------+----------------+----------------+---------------------+----------------+--------------+----------------+------------+--------------+------------+--------+------------+--------------</span></p></div><div><div><p>15</p></div><p><span> </span><span>16389</span><span> | countries_id_seq   |         </span><span>2200</span><span> |       </span><span>0</span><span> |         </span><span>0</span><span> |       </span><span>10</span><span> |     </span><span>0</span><span> |       </span><span>16389</span><span> |             </span><span>0</span><span> |        </span><span>1</span><span> |         </span><span>1</span><span> |             </span><span>0</span><span> |             </span><span>0</span><span> | f           | f           | p              | S       |        </span><span>3</span><span> |         </span><span>0</span><span> | f           | f              | f              | f              | f                   | t              | n            | f              |          </span><span>0</span><span> |            </span><span>0</span><span> |          </span><span>0</span><span> |        |            |</span></p></div><div><div><p>16</p></div><p><span> </span><span>16390</span><span> | countries          |         </span><span>2200</span><span> |   </span><span>16392</span><span> |         </span><span>0</span><span> |       </span><span>10</span><span> |     </span><span>2</span><span> |       </span><span>16390</span><span> |             </span><span>0</span><span> |        </span><span>4</span><span> |       </span><span>249</span><span> |             </span><span>0</span><span> |         </span><span>16393</span><span> | t           | f           | p              | r       |       </span><span>12</span><span> |         </span><span>0</span><span> | f           | f              | f              | f              | f                   | t              | d            | f              |          </span><span>0</span><span> |          </span><span>743</span><span> |          </span><span>1</span><span> |        |            |</span></p></div><div><div><p>17</p></div><p><span> </span><span>16395</span><span> | countries_pkey     |         </span><span>2200</span><span> |       </span><span>0</span><span> |         </span><span>0</span><span> |       </span><span>10</span><span> |   </span><span>403</span><span> |       </span><span>16395</span><span> |             </span><span>0</span><span> |        </span><span>2</span><span> |       </span><span>249</span><span> |             </span><span>0</span><span> |             </span><span>0</span><span> | f           | f           | p              | i       |        </span><span>1</span><span> |         </span><span>0</span><span> | f           | f              | f              | f              | f                   | t              | n            | f              |          </span><span>0</span><span> |            </span><span>0</span><span> |          </span><span>0</span><span> |        |            |</span></p></div><div><div><p>18</p></div><p><span> </span><span>16397</span><span> | countries_name_key |         </span><span>2200</span><span> |       </span><span>0</span><span> |         </span><span>0</span><span> |       </span><span>10</span><span> |   </span><span>403</span><span> |       </span><span>16397</span><span> |             </span><span>0</span><span> |        </span><span>2</span><span> |       </span><span>249</span><span> |             </span><span>0</span><span> |             </span><span>0</span><span> | f           | f           | p              | i       |        </span><span>1</span><span> |         </span><span>0</span><span> | f           | f              | f              | f              | f                   | t              | n            | f              |          </span><span>0</span><span> |            </span><span>0</span><span> |          </span><span>0</span><span> |        |            |</span></p></div><div><div><p>19</p></div><p><span>(</span><span>4</span><span> </span><span>rows</span><span>)</span></p></div></code></pre></figure></div>
<p>We can see here that we’ve only actually got 4 table-like objects – the rest of the files in this folder are boilerplate – if you look in the DB folders for <code>template0</code>, <code>template1</code> or <code>postgres</code> (i.e. <code>1/</code>, <code>2/</code>, or <code>5/</code>) you’ll see that almost all of the files are exactly the same as our <code>blogdb</code> database.</p>
<p>So what are these <code>pg_class</code> objects and how do they relate to all these files?</p>
<p>Well we can see that <code>countries</code> is there with oid and relfilenode values of 16390 – that’s our actual table. There’s also <code>countries_pkey</code> with oid and relfilenode values of 16395 – that’s the index for our primary key. There’s <code>countries_name_key</code> with 16397 – the index for our name unique constraint – and finally <code>countries_id_seq</code> with 16389 – the sequence used to generate new ID values (we use <code>primary key generated always as identity</code>, which just like <code>serial</code> generates new values in a numerically increasing sequence).</p>
<p>The relfilenode here corresponds to the “filenode” of the object, which is the name of the file on disk. Let’s start off with our <code>countries</code> table.</p>
<div><figure><pre data-language="console"><code><div><div><p>1</p></div><p><span>$ ls -l 16390</span><span>*</span></p></div><div><div><p>2</p></div><p><span>.rw-------@ 33k   16390</span></p></div><div><div><p>3</p></div><p><span>.rw-------@ 25k   16390_fsm</span></p></div></code></pre></figure></div>
<p>For a general object, you’re likely to see three or more files: <sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="" aria-describedby="footnote-label">3</a></sup></p>
<ul>
<li><code>{filenode}</code> – Postgres splits large objects into multiple files called segments, to avoid issues some operating systems have with large files (mostly historical, to be honest). By default these are 1 GB in size, although this is configurable. This is the first segment file.</li>
<li><code>{filenode}.1</code>, <code>{filenode}.2</code> – these are the subsequent segment files. We don’t have &gt; 1 GB of data yet so we don’t have these.</li>
<li><code>{filenode}_fsm</code> – this is the <a href="https://www.postgresql.org/docs/current/storage-fsm.html">Free Space Map (FSM)</a> file for the object, which contains a binary tree telling you how much free space is available in each page of the heap. Don’t worry, we’re going to explain exactly what the heap and pages are in a minute.</li>
<li><code>{filenode}_vm</code> – this is the <a href="https://www.postgresql.org/docs/current/storage-vm.html">Visibility Map (VM)</a> file for the object, which tells you about the visibility of tuples in your pages. We’ll go into this a bit more later as well.</li>
</ul>
<h2 id="whats-the-heap">What’s the heap?</h2>
<p>All these main segment data files (excluding the FSM and VM) are called the <em>heap</em>.</p>
<p>Something really important about tables which isn’t obvious at first is that, even though they might have sequential primary keys, tables are <em>not ordered</em>. (Hence why we need a separate sequence object to be able to produce the sequential ID values.) For this reason tables are sometimes called a <em>bag</em> of rows. Postgres calls it a <em>heap</em>. For any real-life table that’s being added to and updated and vacuumed, the rows in the heap will <em>not</em> be in sequential order of their primary key.</p>
<p>Importantly, the heap in Postgres is very different to the heap in system memory (as opposed to the stack). They are related concepts and if you’re familiar with the structure of the stack vs. heap in memory you might find the page diagram in the next section very familiar, but it’s important to remember that they are very much separate concepts.</p>
<p>The object heap consists of many different pages (also known as blocks) sequentially stored in the file.</p>
<h2 id="so-whats-a-page">So what’s a page?</h2>
<p>Within a single segment file, you will find multiple pages of fixed size stitched together. By default, a page is 8 KB in size so we’d expect all our object files to be multiple of 8 KB. In this case, our table file is 32 KB which means there must be 4 pages in it.</p>
<p>You might be thinking – why use pages? Why not just have one page per segment? The answer is that each page is written in one atomic operation and the larger the size of the page, the more likely there will be a write failure during the write. The higher the page size, the more performant the database will be while the higher the page size, the higher the likelihood of write failures. The Postgres maintainers chose 8 KB as the default and they know what they’re doing so there’s generally no reason to change this.</p>
<p>This diagram shows what the structure of a page is, and how it relates to the segment and whole object.</p>
<img alt="Postgres database layout" src="https://drew.silcock.dev/media/how-postgres-stores-data-on-disk/database-layout-dark.png">
<img alt="Postgres database layout" src="https://drew.silcock.dev/media/how-postgres-stores-data-on-disk/database-layout-light.png">

<p>In our example here, our main table is 2.7 GiB which requires 3 separate segments of 1 GiB each. 131,072 pages of size 8 KiB into 1 GiB and each page consists of around 40 items (based on each item taking up about 200 bytes).</p>
<h2 id="page-layout">Page layout</h2>
<p>Let’s dive down into our page layout.</p>
<p>You can see that there are three areas of the page:</p>
<ul>
<li>The header &amp; line pointers, which grow “upwards”, meaning line pointer n + 1 has a higher initial offset into the page than line pointer n – the end of the final line pointer is called “lower”.</li>
<li>The special data &amp; items which grow “downwards”, meaning item n + 1 has a lower initial offset into the page than item n – the end of the final item is called “upper”.</li>
<li>The free space, which is in between the last line pointer and the last item, i.e. goes from “lower” to “upper” – you can calculate the remaining free space in the page by doing “upper” - “lower”.</li>
</ul>
<p>The page header itself contains things like:</p>
<ul>
<li>A checksum of the page</li>
<li>The offset to the end of the line pointers (a.k.a. “lower”)</li>
<li>The offset to the end of the free space (i.e. to the start of the items, a.k.a. “upper”)</li>
<li>The offset to the start of the special space</li>
<li>Version information</li>
</ul>
<p>There’s actually an in-built extension called <a href="https://www.postgresql.org/docs/current/pageinspect.html"><code>pageinspect</code></a> which we can use to look at our page header information:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>blogdb</span><span>=</span><span># </span><span>create</span><span> extension pageinspect;</span></p></div><div><div><p>2</p></div><p><span>CREATE</span><span> EXTENSION</span></p></div><div><p>3</p></div><div><div><p>4</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> </span><span>*</span><span> </span><span>from</span><span> page_header(get_raw_page(</span><span>'countries'</span><span>, </span><span>0</span><span>));</span></p></div><div><div><p>5</p></div><p><span><span>    </span></span><span>lsn    | </span><span>checksum</span><span> | flags | lower | upper | special | pagesize | </span><span>version</span><span> | prune_xid</span></p></div><div><div><p>6</p></div><p><span>-----------+----------+-------+-------+-------+---------+----------+---------+-----------</span></p></div><div><div><p>7</p></div><p><span> </span><span>0</span><span>/</span><span>1983F70 |        </span><span>0</span><span> |     </span><span>0</span><span> |   </span><span>292</span><span> |   </span><span>376</span><span> |    </span><span>8192</span><span> |     </span><span>8192</span><span> |       </span><span>4</span><span> |         </span><span>0</span></p></div><div><div><p>8</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>9</p></div><div><div><p>10</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> </span><span>*</span><span> </span><span>from</span><span> page_header(get_raw_page(</span><span>'countries'</span><span>, </span><span>1</span><span>));</span></p></div><div><div><p>11</p></div><p><span><span>    </span></span><span>lsn    | </span><span>checksum</span><span> | flags | lower | upper | special | pagesize | </span><span>version</span><span> | prune_xid</span></p></div><div><div><p>12</p></div><p><span>-----------+----------+-------+-------+-------+---------+----------+---------+-----------</span></p></div><div><div><p>13</p></div><p><span> </span><span>0</span><span>/</span><span>19858E0 |        </span><span>0</span><span> |     </span><span>0</span><span> |   </span><span>308</span><span> |   </span><span>408</span><span> |    </span><span>8192</span><span> |     </span><span>8192</span><span> |       </span><span>4</span><span> |         </span><span>0</span></p></div><div><div><p>14</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>15</p></div><div><div><p>16</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> </span><span>*</span><span> </span><span>from</span><span> page_header(get_raw_page(</span><span>'countries'</span><span>, </span><span>2</span><span>));</span></p></div><div><div><p>17</p></div><p><span><span>    </span></span><span>lsn    | </span><span>checksum</span><span> | flags | lower | upper | special | pagesize | </span><span>version</span><span> | prune_xid</span></p></div><div><div><p>18</p></div><p><span>-----------+----------+-------+-------+-------+---------+----------+---------+-----------</span></p></div><div><div><p>19</p></div><p><span> </span><span>0</span><span>/</span><span>1987278</span><span> |        </span><span>0</span><span> |     </span><span>0</span><span> |   </span><span>296</span><span> |   </span><span>416</span><span> |    </span><span>8192</span><span> |     </span><span>8192</span><span> |       </span><span>4</span><span> |         </span><span>0</span></p></div><div><div><p>20</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>21</p></div><div><div><p>22</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> </span><span>*</span><span> </span><span>from</span><span> page_header(get_raw_page(</span><span>'countries'</span><span>, </span><span>3</span><span>));</span></p></div><div><div><p>23</p></div><p><span><span>    </span></span><span>lsn    | </span><span>checksum</span><span> | flags | lower | upper | special | pagesize | </span><span>version</span><span> | prune_xid</span></p></div><div><div><p>24</p></div><p><span>-----------+----------+-------+-------+-------+---------+----------+---------+-----------</span></p></div><div><div><p>25</p></div><p><span> </span><span>0</span><span>/</span><span>19882C8 |        </span><span>0</span><span> |     </span><span>0</span><span> |   </span><span>196</span><span> |  </span><span>3288</span><span> |    </span><span>8192</span><span> |     </span><span>8192</span><span> |       </span><span>4</span><span> |         </span><span>0</span></p></div><div><div><p>26</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div></code></pre></figure></div>
<p>The first thing you might notice is that <code>special</code> is the same as <code>pagesize</code> – this is just saying that there is no special data section for this page. The special data section is not used for table pages, only for other types like indexes where it stores information about the binary tree structure.</p>
<p>You might be wondering why all the <code>checksum</code> values are all 0. Turns out that Postgres <a href="https://www.postgresql.org/docs/current/checksums.html">disables checksum protection by default</a> for performance reasons and you have to <a href="https://www.postgresql.org/docs/current/app-initdb.html#APP-INITDB-DATA-CHECKSUMS">manually enable it</a>.</p>
<p>If we compare the <code>lower</code> and <code>upper</code> values for these pages, we can see that:</p>
<ul>
<li>Page 0 has 376 - 292 = 84 bytes of free space</li>
<li>Page 1 has 408 - 308 = 100 bytes of free space</li>
<li>Page 2 has 416 - 296 = 120 bytes of free space</li>
<li>Page 3 has 3288 - 196 = 3092 bytes of free space.</li>
</ul>
<p>We can infer from this that:</p>
<ul>
<li>The rows in our countries table is ~100 bytes as that’s how much space is left in the full pages.</li>
<li>Page 3 is the final page as there’s plenty of space left in there.</li>
</ul>
<p>We can confirm the row size using the <code>heap_page_items()</code> function from pageinspect:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> lp, lp_off, lp_len, t_ctid, t_data</span></p></div><div><div><p>2</p></div><p><span>blogdb</span><span>-</span><span># </span><span>from</span><span> heap_page_items(get_raw_page(</span><span>'countries'</span><span>, </span><span>1</span><span>))</span></p></div><div><div><p>3</p></div><p><span>blogdb</span><span>-</span><span># </span><span>limit</span><span> </span><span>10</span><span>;</span></p></div><div><div><p>4</p></div><p><span><span> </span></span><span>lp | lp_off | lp_len | t_ctid |                                                                                                                           t_data</span></p></div><div><div><p>5</p></div><p><span>----+--------+--------+--------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></p></div><div><div><p>6</p></div><p><span>  </span><span>1</span><span> |   </span><span>8064</span><span> |    </span><span>123</span><span> | (</span><span>1</span><span>,</span><span>1</span><span>)  | \x440000002545717561746f7269616c204775696e656107475109474e51093232361d49534f20333136362d323a47510f416672696361275375622d5361686172616e204166726963611d4d6964646c6520416672696361093030320932303209303137</span></p></div><div><div><p>7</p></div><p><span>  </span><span>2</span><span> |   </span><span>7944</span><span> |    </span><span>114</span><span> | (</span><span>1</span><span>,</span><span>2</span><span>)  | \x45000000114572697472656107455209455249093233321d49534f20333136362d323a45520f416672696361275375622d5361686172616e204166726963611f4561737465726e20416672696361093030320932303209303134</span></p></div><div><div><p>8</p></div><p><span>  </span><span>3</span><span> |   </span><span>7840</span><span> |     </span><span>97</span><span> | (</span><span>1</span><span>,</span><span>3</span><span>)  | \x46000000114573746f6e696107454509455354093233331d49534f20333136362d323a45450f4575726f7065214e6f72746865726e204575726f706503093135300931353409202020</span></p></div><div><div><p>9</p></div><p><span>  </span><span>4</span><span> |   </span><span>7720</span><span> |    </span><span>116</span><span> | (</span><span>1</span><span>,</span><span>4</span><span>)  | \x47000000134573776174696e6907535a0953575a093734381d49534f20333136362d323a535a0f416672696361275375622d5361686172616e2041667269636121536f75746865726e20416672696361093030320932303209303138</span></p></div><div><div><p>10</p></div><p><span>  </span><span>5</span><span> |   </span><span>7600</span><span> |    </span><span>115</span><span> | (</span><span>1</span><span>,</span><span>5</span><span>)  | \x4800000013457468696f70696107455409455448093233311d49534f20333136362d323a45540f416672696361275375622d5361686172616e204166726963611f4561737465726e20416672696361093030320932303209303134</span></p></div><div><div><p>11</p></div><p><span>  </span><span>6</span><span> |   </span><span>7448</span><span> |    </span><span>148</span><span> | (</span><span>1</span><span>,</span><span>6</span><span>)  | \x490000003946616c6b6c616e642049736c616e647320284d616c76696e61732907464b09464c4b093233381d49534f20333136362d323a464b13416d657269636173414c6174696e20416d657269636120616e64207468652043617269626265616e1d536f75746820416d6572696361093031390934313909303035</span></p></div><div><div><p>12</p></div><p><span>  </span><span>7</span><span> |   </span><span>7344</span><span> |    </span><span>103</span><span> | (</span><span>1</span><span>,</span><span>7</span><span>)  | \x4a0000001d4661726f652049736c616e647307464f0946524f093233341d49534f20333136362d323a464f0f4575726f7065214e6f72746865726e204575726f706503093135300931353409202020</span></p></div><div><div><p>13</p></div><p><span>  </span><span>8</span><span> |   </span><span>7248</span><span> |     </span><span>89</span><span> | (</span><span>1</span><span>,</span><span>8</span><span>)  | \x4b0000000b46696a6907464a09464a49093234321d49534f20333136362d323a464a114f6365616e6961154d656c616e6573696103093030390930353409202020</span></p></div><div><div><p>14</p></div><p><span>  </span><span>9</span><span> |   </span><span>7144</span><span> |     </span><span>97</span><span> | (</span><span>1</span><span>,</span><span>9</span><span>)  | \x4c0000001146696e6c616e640746490946494e093234361d49534f20333136362d323a46490f4575726f7065214e6f72746865726e204575726f706503093135300931353409202020</span></p></div><div><div><p>15</p></div><p><span> </span><span>10</span><span> |   </span><span>7048</span><span> |     </span><span>95</span><span> | (</span><span>1</span><span>,</span><span>10</span><span>) | \x4d0000000f4672616e636507465209465241093235301d49534f20333136362d323a46520f4575726f70651f5765737465726e204575726f706503093135300931353509202020</span></p></div><div><div><p>16</p></div><p><span>(</span><span>10</span><span> </span><span>rows</span><span>)</span></p></div></code></pre></figure></div>
<p>Here <code>lp</code> means the line pointer, <code>lp_off</code> means the offset to the start of the item, <code>lp_len</code> is the size of the item in bytes and <code>t_ctid</code> refers to the ctid of the item. The ctid (Current Tuple ID)<sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="" aria-describedby="footnote-label">4</a></sup> tells you where the item is located in the form <code>(page index, item index within page)</code> so <code>(1, 1)</code> means the first item in page 1 (pages are zero-indexed, item index is not for some reason).</p>
<p>We can also see the actual data for the item here as well, which is pretty cool – this long hex string is exactly the bytes that Postgres has stored on disk. Let’s check which row we’re looking at with some Python:</p>
<div><figure><pre data-language="bash"><code><div><div><p>1</p></div><p><span>$</span><span> </span><span>row_data=</span><span>$(</span><span>docker</span><span> </span><span>exec</span><span> $pg_container_id </span><span>psql</span><span> </span><span>-U</span><span> </span><span>postgres</span><span> </span><span>blogdb</span><span> </span><span>--tuples-only</span><span> </span><span>-c</span><span> </span><span>"select t_data from heap_page_items(get_raw_page('countries', 1)) limit 1;"</span><span>)</span></p></div><div><div><p>2</p></div><p><span>$</span><span> </span><span>python3</span><span> </span><span>-c</span><span> </span><span>"print(bytearray.fromhex(r'</span><span>$row_data</span><span>'.strip().replace('</span><span>\\\\</span><span>x', '')).decode('utf-8', errors='ignore'))"</span><span> </span><span>&gt;</span><span> </span><span>row_data.bin</span></p></div><div><div><p>3</p></div><p><span>$</span><span> </span><span>cat</span><span> </span><span>row_data.bin</span></p></div><div><div><p>4</p></div><p><span>D%Equatorial</span><span> </span><span>GuineaGQ</span><span>   </span><span>GNQ</span><span>     </span><span>226ISO</span><span> </span><span>3166-2:GQAfrica'Sub-Saharan AfricaMiddle Africa  002     202     017</span></p></div><div><div><p>5</p></div><p><span>$ hexyl row_data.bin</span></p></div><div><div><p>6</p></div><p><span>┌────────┬─────────────────────────┬─────────────────────────┬────────┬────────┐</span></p></div><div><div><p>7</p></div><p><span>│00000000│ 44 00 00 00 25 45 71 75 ┊ 61 74 6f 72 69 61 6c 20 │D⋄⋄⋄%Equ┊atorial │</span></p></div><div><div><p>8</p></div><p><span>│00000010│ 47 75 69 6e 65 61 07 47 ┊ 51 09 47 4e 51 09 32 32 │Guinea•G┊Q_GNQ_22│</span></p></div><div><div><p>9</p></div><p><span>│00000020│ 36 1d 49 53 4f 20 33 31 ┊ 36 36 2d 32 3a 47 51 0f │6•ISO 31┊66-2:GQ•│</span></p></div><div><div><p>10</p></div><p><span>│00000030│ 41 66 72 69 63 61 27 53 ┊ 75 62 2d 53 61 68 61 72 │Africa'S┊ub-Sahar│</span></p></div><div><div><p>11</p></div><p><span>│00000040│</span><span> </span><span>61</span><span> </span><span>6e</span><span> </span><span>20</span><span> </span><span>41</span><span> </span><span>66</span><span> </span><span>72</span><span> </span><span>69</span><span> </span><span>63</span><span> </span><span>┊</span><span> </span><span>61</span><span> </span><span>1d</span><span> </span><span>4d</span><span> </span><span>69</span><span> </span><span>64</span><span> </span><span>64</span><span> </span><span>6c</span><span> </span><span>65</span><span> </span><span>│an</span><span> </span><span>Afric┊a•Middle│</span></p></div><div><div><p>12</p></div><p><span>│00000050│</span><span> </span><span>20</span><span> </span><span>41</span><span> </span><span>66</span><span> </span><span>72</span><span> </span><span>69</span><span> </span><span>63</span><span> </span><span>61</span><span> </span><span>09</span><span> </span><span>┊</span><span> </span><span>30</span><span> </span><span>30</span><span> </span><span>32</span><span> </span><span>09</span><span> </span><span>32</span><span> </span><span>30</span><span> </span><span>32</span><span> </span><span>09</span><span> </span><span>│</span><span> </span><span>Africa_┊002_202_│</span></p></div><div><div><p>13</p></div><p><span>│00000060│</span><span> </span><span>30</span><span> </span><span>31</span><span> </span><span>37</span><span> </span><span>0a</span><span>             </span><span>┊</span><span>                         </span><span>│017_</span><span>    </span><span>┊</span><span>        </span><span>│</span></p></div><div><div><p>14</p></div><p><span>└────────┴─────────────────────────┴─────────────────────────┴────────┴────────┘</span></p></div><div><div><p>15</p></div><p><span>$</span><span> </span><span>docker</span><span> </span><span>exec</span><span> $pg_container_id </span><span>psql</span><span> </span><span>-U</span><span> </span><span>postgres</span><span> </span><span>blogdb</span><span> </span><span>-c</span><span> </span><span>"select * from countries where name = 'Equatorial Guinea';"</span></p></div><div><div><p>16</p></div><p><span> </span><span>ctid</span><span>  </span><span>|</span><span> </span><span>id</span><span> </span><span>|</span><span>       </span><span>name</span><span>        </span><span>|</span><span> </span><span>alpha_2</span><span> </span><span>|</span><span> </span><span>alpha_3</span><span> </span><span>|</span><span> </span><span>numeric_3</span><span> </span><span>|</span><span>  </span><span>iso_3166_2</span><span>   </span><span>|</span><span> </span><span>region</span><span> </span><span>|</span><span>     </span><span>sub_region</span><span>     </span><span>|</span><span> </span><span>intermediate_region</span><span> </span><span>|</span><span> </span><span>region_code</span><span> </span><span>|</span><span> </span><span>sub_region_code</span><span> </span><span>|</span><span> </span><span>intermediate_region_code</span></p></div><div><div><p>17</p></div><p><span>-------+----+-------------------+---------+---------+-----------+---------------+--------+--------------------+---------------------+-------------+-----------------+--------------------------</span></p></div><div><div><p>18</p></div><p><span><span> </span></span><span>(</span><span>1,1</span><span>) </span><span>|</span><span> </span><span>68</span><span> </span><span>|</span><span> </span><span>Equatorial</span><span> </span><span>Guinea</span><span> </span><span>|</span><span> </span><span>GQ</span><span>      </span><span>|</span><span> </span><span>GNQ</span><span>     </span><span>|</span><span> </span><span>226</span><span>       </span><span>|</span><span> </span><span>ISO</span><span> </span><span>3166-2:GQ</span><span> </span><span>|</span><span> </span><span>Africa</span><span> </span><span>|</span><span> </span><span>Sub-Saharan</span><span> </span><span>Africa</span><span> </span><span>|</span><span> </span><span>Middle</span><span> </span><span>Africa</span><span>       </span><span>|</span><span> </span><span>002</span><span>         </span><span>|</span><span> </span><span>202</span><span>             </span><span>|</span><span> </span><span>017</span></p></div><div><div><p>19</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div></code></pre></figure></div>
<p>Ahah, we are looking at the data for Equatorial Guinea, the only continental African country to speak Spanish as an official language. (If you’re wondering why <code>(1,1)</code> isn’t Afghanistan, the country with ID 1, remember that the pages start at 0 so we’d expect to find Afghanistan at <code>(0,1)</code>.)</p>
<p>We can see here that each column is being stored right next to each other with a random byte in between each one. Let’s dive in:</p>
<ul>
<li><code>0x 44 00 00 00</code> = <code>68</code> (must be little endian) so the first 4 bytes is the row’s ID</li>
<li>Then, there’s a random byte like <code>0x25</code> or <code>0x07</code> followed by the column data – the rest of the columns are string types so they’re all stored in UTF-8. If you know what these inter-column bytes mean, leave a comment below! I can’t figure it out.</li>
</ul>
<p>Individual values that are too big to store in here (e.g. they’re more than 8 KiB in size) get stored in a separate relation, or <a href="https://www.postgresql.org/docs/current/storage-toast.html">TOASTed</a> – this will be the topic of a future post 🍞.</p>
<h2 id="what-happens-when-a-row-gets-modifed-or-deleted">What happens when a row gets modifed or deleted?</h2>
<p>Postgres uses MVCC (Multiversion Concurrency Control) to handle concurrent access to data. The “multiversion” here means that when a transaction comes in and modifies a row, it doesn’t touch the existing tuple on disk at all. Instead, it creates a new tuples at the end of the last page with the modified row. When it commits the update, it swaps the version of the data that a new transaction will see from the old tuple to the new one.</p>
<p>Let’s see this in action:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> ctid </span><span>from</span><span> countries </span><span>where</span><span> </span><span>name</span><span> </span><span>=</span><span> </span><span>'Antarctica'</span><span>;</span></p></div><div><div><p>2</p></div><p><span><span> </span></span><span>ctid</span></p></div><div><div><p>3</p></div><p><span>-------</span></p></div><div><div><p>4</p></div><p><span><span> </span></span><span>(</span><span>0</span><span>,</span><span>9</span><span>)</span></p></div><div><div><p>5</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>6</p></div><div><div><p>7</p></div><p><span>blogdb</span><span>=</span><span># </span><span>update</span><span> countries </span><span>set</span><span> region </span><span>=</span><span> </span><span>'The South Pole'</span><span> </span><span>where</span><span> </span><span>name</span><span> </span><span>=</span><span> </span><span>'Antarctica'</span><span>;</span></p></div><div><div><p>8</p></div><p><span>UPDATE</span><span> </span><span>1</span></p></div><div><p>9</p></div><div><div><p>10</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> ctid </span><span>from</span><span> countries </span><span>where</span><span> </span><span>name</span><span> </span><span>=</span><span> </span><span>'Antarctica'</span><span>;</span></p></div><div><div><p>11</p></div><p><span><span>  </span></span><span>ctid</span></p></div><div><div><p>12</p></div><p><span>--------</span></p></div><div><div><p>13</p></div><p><span><span> </span></span><span>(</span><span>3</span><span>,</span><span>44</span><span>)</span></p></div><div><div><p>14</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>15</p></div><div><div><p>16</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> lp, lp_off, lp_len, t_ctid, t_data</span></p></div><div><div><p>17</p></div><p><span>blogdb</span><span>-</span><span># </span><span>from</span><span> heap_page_items(get_raw_page(</span><span>'countries'</span><span>, </span><span>0</span><span>))</span></p></div><div><div><p>18</p></div><p><span>blogdb</span><span>-</span><span># offset </span><span>8</span><span> </span><span>limit</span><span> </span><span>1</span><span>;</span></p></div><div><div><p>19</p></div><p><span><span> </span></span><span>lp | lp_off | lp_len | t_ctid | t_data</span></p></div><div><div><p>20</p></div><p><span>----+--------+--------+--------+--------</span></p></div><div><div><p>21</p></div><p><span>  </span><span>9</span><span> |      </span><span>0</span><span> |      </span><span>0</span><span> |        |</span></p></div><div><div><p>22</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div></code></pre></figure></div>
<p>We can see that once we update the row, its ctid changes from <code>(0,9)</code> to <code>(3,44)</code> (which is probably at the end of the last page). The old data and ctid is also wiped from the old item location.</p>
<p>What about deletions? Let’s take a look:</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>blogdb</span><span>=</span><span># </span><span>delete</span><span> </span><span>from</span><span> countries </span><span>where</span><span> </span><span>name</span><span> </span><span>=</span><span> </span><span>'Equatorial Guinea'</span><span>;</span></p></div><div><div><p>2</p></div><p><span>DELETE</span><span> </span><span>1</span></p></div><div><p>3</p></div><div><div><p>4</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> lp, lp_off, lp_len, t_ctid, t_data</span></p></div><div><div><p>5</p></div><p><span>blogdb</span><span>-</span><span># </span><span>from</span><span> heap_page_items(get_raw_page(</span><span>'countries'</span><span>, </span><span>1</span><span>))</span></p></div><div><div><p>6</p></div><p><span>blogdb</span><span>-</span><span># </span><span>limit</span><span> </span><span>1</span><span>;</span></p></div><div><div><p>7</p></div><p><span><span> </span></span><span>lp | lp_off | lp_len | t_ctid |                                                                                                  t_data</span></p></div><div><div><p>8</p></div><p><span>----+--------+--------+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></p></div><div><div><p>9</p></div><p><span>  </span><span>1</span><span> |   </span><span>8064</span><span> |    </span><span>123</span><span> | (</span><span>1</span><span>,</span><span>1</span><span>)  | \x440000002545717561746f7269616c204775696e656107475109474e51093232361d49534f20333136362d323a47510f416672696361275375622d5361686172616e204166726963611d4d6964646c6520416672696361093030320932303209303137</span></p></div><div><div><p>10</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div></code></pre></figure></div>
<p>The data is still there! That’s because Postgres doesn’t bother actually deleting the data, it just marks the data as deleted. But you might be thinking, if rows are constantly getting deleted and added, you’ll end up with constantly increasing segments files full of deleted data (called “dead tuples” in the Postgres lingo). This is where vacuuming comes in. Let’s trigger a manual vacuum and see what happens.</p>
<div><figure><pre data-language="sql"><code><div><div><p>1</p></div><p><span>blogdb</span><span>=</span><span># vacuum full;</span></p></div><div><div><p>2</p></div><p><span>VACUUM</span></p></div><div><p>3</p></div><div><div><p>4</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> lp, lp_off, lp_len, t_ctid, t_data</span></p></div><div><div><p>5</p></div><p><span>blogdb</span><span>-</span><span># </span><span>from</span><span> heap_page_items(get_raw_page(</span><span>'countries'</span><span>, </span><span>1</span><span>))</span></p></div><div><div><p>6</p></div><p><span>blogdb</span><span>-</span><span># </span><span>limit</span><span> </span><span>1</span><span>; </span><span>-- This used to be the dead tuple where 'Equatorial Guinea' was.</span></p></div><div><div><p>7</p></div><p><span><span> </span></span><span>lp | lp_off | lp_len | t_ctid |                                                                        t_data</span></p></div><div><div><p>8</p></div><p><span>----+--------+--------+--------+------------------------------------------------------------------------------------------------------------------------------------------------------</span></p></div><div><div><p>9</p></div><p><span>  </span><span>1</span><span> |   </span><span>8088</span><span> |     </span><span>97</span><span> | (</span><span>1</span><span>,</span><span>1</span><span>)  | \x46000000114573746f6e696107454509455354093233331d49534f20333136362d323a45450f4575726f7065214e6f72746865726e204575726f706503093135300931353409202020</span></p></div><div><div><p>10</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>11</p></div><div><div><p>12</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> lp, lp_off, lp_len, t_ctid, t_data</span></p></div><div><div><p>13</p></div><p><span>blogdb</span><span>-</span><span># </span><span>from</span><span> heap_page_items(get_raw_page(</span><span>'countries'</span><span>, </span><span>0</span><span>))</span></p></div><div><div><p>14</p></div><p><span>blogdb</span><span>-</span><span># offset </span><span>8</span><span> </span><span>limit</span><span> </span><span>1</span><span>; </span><span>-- This used to be the dead tuple where the old 'Antarctica' version was.</span></p></div><div><div><p>15</p></div><p><span><span> </span></span><span>lp | lp_off | lp_len | t_ctid |                                                                                                               t_data</span></p></div><div><div><p>16</p></div><p><span>----+--------+--------+--------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</span></p></div><div><div><p>17</p></div><p><span>  </span><span>9</span><span> |   </span><span>7192</span><span> |    </span><span>136</span><span> | (</span><span>0</span><span>,</span><span>9</span><span>)  | \x0a00000029416e746967756120616e64204261726275646107414709415447093032381d49534f20333136362d323a414713416d657269636173414c6174696e20416d657269636120616e64207468652043617269626265616e1543617269626265616e093031390934313909303239</span></p></div><div><div><p>18</p></div><p><span>(</span><span>1</span><span> </span><span>row</span><span>)</span></p></div><div><p>19</p></div><div><div><p>20</p></div><p><span>blogdb</span><span>=</span><span># </span><span>select</span><span> ctid, </span><span>name</span><span> </span><span>from</span><span> countries</span></p></div><div><div><p>21</p></div><p><span>blogdb</span><span>-</span><span># </span><span>where</span><span> </span><span>name</span><span> </span><span>=</span><span> </span><span>'Antarctica'</span><span> </span><span>or</span><span> ctid </span><span>=</span><span> </span><span>'(0,9)'</span><span> </span><span>or</span><span> ctid </span><span>=</span><span> </span><span>'(1,1)'</span><span>;</span></p></div><div><div><p>22</p></div><p><span><span>  </span></span><span>ctid  |        </span><span>name</span></p></div><div><div><p>23</p></div><p><span>--------+---------------------</span></p></div><div><div><p>24</p></div><p><span><span> </span></span><span>(</span><span>0</span><span>,</span><span>9</span><span>)  | Antigua </span><span>and</span><span> Barbuda</span></p></div><div><div><p>25</p></div><p><span><span> </span></span><span>(</span><span>1</span><span>,</span><span>1</span><span>)  | Estonia</span></p></div><div><div><p>26</p></div><p><span><span> </span></span><span>(</span><span>3</span><span>,</span><span>42</span><span>) | Antarctica</span></p></div><div><div><p>27</p></div><p><span>(</span><span>3</span><span> </span><span>rows</span><span>)</span></p></div></code></pre></figure></div>
<p>Now that we’ve vacuumed, a couple of things have happened:</p>
<ul>
<li>The dead tuple where the outdated first version of the Antarctica row was located has now been replaced with Antigua and Barbuda, which is the next country along.</li>
<li>The dead tuple where the Equatorial Guinea row was located has now been replaced with Estonia, the next country along.</li>
<li>Antarctica has moved from <code>(3,44)</code> down to <code>(3,42)</code> because the 2 dead tuples has now been cleaned out and the Antarctica row can move down 2 slots.</li>
</ul>
<h2 id="what-about-indexes">What about indexes?</h2>
<p>Indexes work exactly the same as tables! The only difference is that the tuple stored as items in each page contains the indexed data instead of the full row data and the special data contains sibling node information for the binary tree.</p>
<p><strong>Exercise for the reader:</strong> Find the segment file for the <code>name</code> column unique index and investigate the values of the <code>t_data</code> in each item and “special data” for each page. Comment below what you find!</p>
<h2 id="why-would-i-ever-need-to-know-any-of-this">Why would I ever need to know any of this?</h2>
<p>There’s a few reasons:</p>
<ul>
<li>It’s interesting!</li>
<li>It helps understand how Postgres queries your data on disk, how MVCC works and lots more that’s really useful when you’re trying to gain a deep understanding of how your database works for the purpose of fine-tuning performance.</li>
<li>In certain rare circumstances, it can actually be quite useful for data recovery. Take the following examples:
<ul>
<li>You have someone who through incompetence or malice decides to corrupt your database by removing or messing up a couple of files on disk. Postgres can no longer understand the database so starting Postgres up will just result in a corrupted state. You can swoop in and use your knowledge to manually recover the data. This would still be a fairly large undertaking to do this, and in real life you’d probably call in a professional data recovery specialist, but maybe in this imaginary scenario your company can’t afford one so you have to make do.</li>
<li>Someone accidentally set the super-important customers table on the production database as unlogged<sup><a href="#user-content-fn-5" id="user-content-fnref-5" data-footnote-ref="" aria-describedby="footnote-label">5</a></sup> and then the server crashes. Because in an unlogged table changes aren’t written to the WAL, a database recovery via logical decoding will not include any of the unlogged table data. If you restart the server, Postgres will wipe clean the whole unlogged table because it will restore the database state from the WAL. However, if you copy out the raw database files, you can use the knowledge you have gained from this post to recover the contents of the data. (There’s probably a tool that does this already, but if not you could write your own – that would be an interesting project…)</li>
</ul>
</li>
<li>It’s a good conversation starter at parties <sup><a href="#user-content-fn-6" id="user-content-fnref-6" data-footnote-ref="" aria-describedby="footnote-label">6</a></sup>.</li>
</ul>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="https://ketansingh.me/posts/how-postgres-stores-rows/">Ketan Singh – How Postgres Stores Rows</a></li>
<li><a href="https://www.postgresql.org/docs/current/storage.html">PostgreSQL Documentation – Chapter 73. Database Physical Storage</a></li>
<li><a href="https://www.youtube.com/watch?v=L-dw1yRFYVg">Advanced SQL (Summer 2020), U Tübingen – DB2 — Chapter 03 — Video #09 — Row storage in PostgreSQL, heap file page layout</a></li>
<li><a href="https://www.youtube.com/watch?v=1D81vXw2T_w">15-445/645 Intro to Database Systems (Fall 2019), Carnegie Mellon University – 03 - Database Storage I</a></li>
<li><a href="https://medium.com/quadcode-life/structure-of-heap-table-in-postgresql-d44c94332052">Structure of Heap Table in PostgreSQL</a></li>
<li><a href="https://pgpedia.info/categories/data-directory.html">pgPedia – Data Directory</a></li>
</ul>
<h2 id="future-topics">Future topics</h2>
<p>Database engines is an endlessly interesting topic, and there’s lots more I’d like to write about in this series. Some ideas are:</p>
<ul>
<li>How Postgres stores oversized values – let’s raise a TOAST</li>
<li>How Postgres handles concurrency – MVCC is the real MVP</li>
<li>How Postgres turns a SQL string into data</li>
<li>How Postgres ensures data integrity – where’s WAL</li>
</ul>
<p>If you’d like me to write about one of these, leave a comment below 🙂</p>
<h2 id="updates">Updates</h2>
<ul>
<li>2024-08-05 – Rephrased the explanation of logical decoding based on <a href="https://news.ycombinator.com/item?id=41160109">HN comment from dfox</a>, added explanation of why checksums are all 0 after <a href="https://news.ycombinator.com/item?id=41160233">HN discussion</a>, expanded teaser for future TOAST post.</li>
</ul>
<section data-footnotes="">
<ol>
<li id="user-content-fn-1">
<p>Technically, the data directory is whatever you specify in environment variable <code>PGDATA</code> and it’s possible to put some of the cluster config files elsewhere, but the only reason you’d be messing with any of that is if you were hosting multiple clusters on the same machine using different Postgres server instances, which is a more advanced use case than we’re interesting in here. <a href="#user-content-fnref-1" data-footnote-backref="" aria-label="Back to reference 1">↩</a></p>
</li>
<li id="user-content-fn-2">
<p>You might be wondering why the numeric country code is stored as <code>char(3)</code> instead of <code>integer</code>. You could store it as an integer if you want, but – exactly like phone numbers – it doesn’t make any sense to say “Austria ÷ Afghanistan = Antarctica” (even though numerically it’s true) so what’s the point in storing it as an integer? Really it’s still a 3-character identifier, it’s just restricting the available characters to 0-9 instead of a-z as with the alpha-2 and alpha-3 country codes. <a href="#user-content-fnref-2" data-footnote-backref="" aria-label="Back to reference 2">↩</a></p>
</li>
<li id="user-content-fn-3">
<p>There’s also a filed called <code>{filenode}_init</code> which is used to store initialisation information for unlogged tables, but you won’t see these unless you’re using unlogged tables. <a href="#user-content-fnref-3" data-footnote-backref="" aria-label="Back to reference 3">↩</a></p>
</li>
<li id="user-content-fn-4">
<p>I think this is what the C stands for but I’m not sure. <a href="#user-content-fnref-4" data-footnote-backref="" aria-label="Back to reference 4">↩</a></p>
</li>
<li id="user-content-fn-5">
<p>You can pretend that you’ve never accidentally run a query on prod instead of your local dev database, but we all do it sooner or later. <a href="#user-content-fnref-5" data-footnote-backref="" aria-label="Back to reference 5">↩</a></p>
</li>
<li id="user-content-fn-6">
<p>It’s not, please don’t do this unless you don’t want to be invited back to said parties. <a href="#user-content-fnref-6" data-footnote-backref="" aria-label="Back to reference 6">↩</a></p>
</li>
</ol>
</section>   </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Stop Killing Games (430 pts)]]></title>
            <link>https://eci.ec.europa.eu/045/public/</link>
            <guid>41159063</guid>
            <pubDate>Mon, 05 Aug 2024 08:06:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://eci.ec.europa.eu/045/public/">https://eci.ec.europa.eu/045/public/</a>, See on <a href="https://news.ycombinator.com/item?id=41159063">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Starting Hospice (604 pts)]]></title>
            <link>https://jakeseliger.com/2024/08/04/starting-hospice-the-end/</link>
            <guid>41157974</guid>
            <pubDate>Mon, 05 Aug 2024 03:35:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://jakeseliger.com/2024/08/04/starting-hospice-the-end/">https://jakeseliger.com/2024/08/04/starting-hospice-the-end/</a>, See on <a href="https://news.ycombinator.com/item?id=41157974">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
						
<p>I’m entering hospice. It’s time, and realistically past time. The <a href="https://jakeseliger.com/2023/07/22/i-am-dying-of-squamous-cell-carcinoma-and-the-treatments-that-might-save-me-are-just-out-of-reach/">squamous cell carcinoma tumors are growing</a>, and the two doses of spot radiation I got on June 10 and 12 have <a href="https://jakeseliger.com/2024/07/29/more-isnt-always-better-death-and-over-treatment-as-a-downside-of-agenticness/">utterly destroyed whatever quality of life I had</a>. This weekend, a nurse came by and did some planning with <a href="https://bessstillman.substack.com/">Bess</a> and me. Our extensive efforts to find and start another clinical trial have turned out to be futile, and I’ve withdrawn from the next-best potential clinical trial, <a href="https://clinicaltrials.gov/study/NCT05935098?term=BGB-A3055&amp;rank=1">BGB-A3055</a> in Dallas, at NEXT Oncology, because there’s no feasible way for me to do it (the people at NEXT, however, are and have been amazing: if you’re looking at clinical trials or live in Dallas, schedule a consult). HonorHealth in Scottsdale, where I live, has a <a href="https://www.clinicaltrials.gov/study/NCT05973487?term=tscan002&amp;rank=1">TScan</a> slot, but my physical condition remains terrible for essentially the reasons <a href="https://jakeseliger.com/2024/07/29/more-isnt-always-better-death-and-over-treatment-as-a-downside-of-agenticness/">I’ve written about so extensively</a> that there’s no need to belabor them. My days and nights are filled with unrelenting coughing, hacking, and pain. My whole jaw area is numb, likely from tumor growth. I wonder how much (or many?) of the headache I’m experiencing actually come from tumors, rather than coughing and other problems.</p>



<p>Why hospice? Bess wants the support, after I’m done. There are rules and bureaucracy even in death, and although she admits to being bad at asking for help, she feels overwhelmed now, and certainly will be later. Her bandwidth, she says, is only for me. The details about what comes after are too much, and too distracting.&nbsp;</p>



<p>I’ll keep reading messages until close to the end, though I may not have the strength or presence of mind to reply. I exist in a hazy, druggy fog. I’ve heard Tyler Cowen say in podcasts that he finds the fascination with people’s last words to be overblown, because at the end of life people are rarely at their cognitive peaks and often forget the constraints and desires that drove much of their lives (I’m paraphrasing and have probably gotten some nuance incorrect).</p>



<p>One virtue of a prolonged end is that I feel like I’ve said everything I have to say. I don’ t know that I have a favorite, but I’m fond of “<a href="https://jakeseliger.com/2023/08/21/i-know-what-happens-to-me-after-i-die-but-what-about-those-left-behind/">I know what happens to me after I die, but what about those left behind?</a>”&nbsp;Same with “<a href="https://jakeseliger.com/2023/07/23/how-do-we-evaluate-our-lives-at-the-end-what-counts-what-matters/">How do we evaluate our lives, at the end? What counts, what matters?</a>” I’m tempted to keep citing others, but if you scroll down into the archives you will find them. I meant to turn these essays into a memoir, but that is a project never to be completed by me. Bess assures me that she’s going to complete the project and do her best to get it published. We’ve created so much together in the process of building our life, and Bess says that doesn’t need to stop just because I’m not physically here, and that putting both our baby and our book into the world gives her immediate future the purpose that she’ll badly need.</p>



<p>Though having my life cut short by cancer is horrible, I’ve still in many ways been lucky. Most people never find the person who completes them, I think, and I have. I’ve been helped so much. Numerous oncologists have gone above and beyond.&nbsp;Many people, friends and strangers, have asked if there is anything they can do to help. The #1 thing is to support Bess and our soon-to-be-born daughter, Athena, whatever “support” may mean—the most obvious way is <a href="https://www.gofundme.com/f/help-the-fight-against-cancer-with-jake-s">the Go Fund Me</a>, as any remaining funds will go to Athena. I wish she could grow up with her father, but that is not an option. Being a single mom is hard;<a href="#_ftn1" id="_ftnref1">[1]</a> growing up without a parent is hard; I cannot see what Athena’s future holds, except that I think and hope it will be bright, even though I will not be in it, save for the ways in which friends and family promise to keep me alive for her.</p>



<p>If you want to donate to research, I don’t know the absolute best place, but one good-seeming choice is <a href="https://arcinstitute.org/model">the Arc Institute</a>: “Arc researchers pursue both curiosity-driven exploration and goal-oriented research. The institute will initially focus on complex diseases, including neurodegeneration, cancer, and immune dysfunction.” They don’t have a turn-key donation page up yet, however, so send them an email and ask: “Why not?” I also got a lot of care under <a href="https://providers.ucsd.edu/details/22435/medical-oncology-cancer">Dr. Assuntina Sacco</a> at <a href="https://giveto.ucsd.edu/giving/home/gift-referral/c5ed27e7-9f35-41a3-bf51-74eb34105478">UCSD’s Moores Cancer Center</a>, which does have a turn-key donation page. Let’s make the future better in every way than the past. Donations can be made in memory of someone who has passed.</p>



<p>I wrote earlier, in “<a href="https://jakeseliger.com/2023/10/16/how-do-you-say-goodbye/">How do you say goodbye?</a>”,</p>



<blockquote>
<p>The gift must be given back, sooner or later, willingly or unwillingly, and sadly it seems that I will be made to give it back before my time. I have learned much, experienced much, made many mistakes, enjoyed my triumphs, suffered my defeats, and, most vitally, experienced love. So many people live who never get that last one, and I have been lucky enough to.</p>
</blockquote>



<p>One friend wrote to me: “You did good—when the time comes, I hope that brings you additional peace.” Many of us don’t get what I’ve had: the opportunity to live a full, generative life with people who I love and who love me back. Yet I was able to have all of it, for a time.</p>



<hr>



<p><a href="#_ftnref1" id="_ftn1">[1]</a> Though if anyone can do it, and find a way to do it successfully, it will be Bess.</p>



<figure><a href="https://jakeseliger.com/wp-content/uploads/2024/08/hospice-and-the-end.jpg"><img data-attachment-id="9004" data-permalink="https://jakeseliger.com/2024/08/04/starting-hospice-the-end/hospice-and-the-end/" data-orig-file="https://jakeseliger.com/wp-content/uploads/2024/08/hospice-and-the-end.jpg" data-orig-size="2048,1405" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="hospice and the end" data-image-description="" data-image-caption="" data-medium-file="https://jakeseliger.com/wp-content/uploads/2024/08/hospice-and-the-end.jpg?w=300" data-large-file="https://jakeseliger.com/wp-content/uploads/2024/08/hospice-and-the-end.jpg?w=550" tabindex="0" role="button" width="1024" height="702" src="https://jakeseliger.com/wp-content/uploads/2024/08/hospice-and-the-end.jpg?w=1024" alt=""></a></figure>
					</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Japan stocks plunge as much as 7% as Asia shares extend sell-off (127 pts)]]></title>
            <link>https://www.cnbc.com/2024/08/05/asia-markets.html</link>
            <guid>41157605</guid>
            <pubDate>Mon, 05 Aug 2024 02:04:21 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.cnbc.com/2024/08/05/asia-markets.html">https://www.cnbc.com/2024/08/05/asia-markets.html</a>, See on <a href="https://news.ycombinator.com/item?id=41157605">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="RegularArticle-ArticleBody-5" data-module="ArticleBody" data-test="articleBody-2" data-analytics="RegularArticle-articleBody-5-2"><div id="ArticleBody-InlineImage-107383735" data-test="InlineImage"><p>Pedestrians cross an intersection in the Shibuya district of Tokyo, Japan, on Tuesday, Feb. 6, 2024.&nbsp;</p><p>Bloomberg | Bloomberg | Getty Images</p></div><div><p>Japan stocks confirmed a bear market on Monday as Asia-Pacific markets continued <a href="https://www.cnbc.com/2024/08/01/stock-market-today-live-updates.html">the sell-off</a> from last week, with the Nikkei 225 and Topix dropping over 12%.</p><p>The benchmark indexes have fallen more than 20% from their all-time highs on July 11.</p><p>The 12.4% loss on the Nikkei — which saw it close at 31,458.42 — was the worst day for the index since the "Black Monday" of 1987. The loss of 4,451.28 points on the index was also the largest in terms of points in its entire history.</p></div><div id="Placeholder-ArticleBody-Video-108015973" data-test="VideoPlaceHolder" role="region" tabindex="0" data-vilynx-id="7000347673" aria-labelledby="Placeholder-ArticleBody-Video-108015973"><p><img src="https://image.cnbcfm.com/api/v1/image/108015974-17228165621722816560-35676403890-1080pnbcnews.jpg?v=1722816561&amp;w=750&amp;h=422&amp;vtcrop=y" alt="Going back to Japanese stocks right now is like catching a falling knife: CIO"><span></span><span></span></p></div><div><p>The Nikkei also erased all its gains so far this year, moving into a loss position year to date.</p><p>The broad-based Topix also saw a rout as it tumbled 12.23% and closed at 2,227.15.</p><p>Heavyweight trading houses such as <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-2"><a href="https://www.cnbc.com/quotes/8058.T-JP/">Mitsubishi</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span>, <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-3"><a href="https://www.cnbc.com/quotes/8031.T-JP/">Mitsui and Co</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span>, <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-4"><a href="https://www.cnbc.com/quotes/8053.T-JP/">Sumitomo</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> and <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-5"><a href="https://www.cnbc.com/quotes/8002.T-JP/">Marubeni</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> all plunged over 14%, with Mitsui seeing a wipeout of almost 20% of its market cap.</p></div><div role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256" aria-labelledby="title desc" role="img" focusable="false" preserveAspectRatio="xMinYMin"><title>Stock Chart Icon</title><desc>Stock chart icon</desc><g transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"><path d="M 87.994 0 H 69.342 c -1.787 0 -2.682 2.16 -1.418 3.424 l 5.795 5.795 l -33.82 33.82 L 28.056 31.196 l -3.174 -3.174 c -1.074 -1.074 -2.815 -1.074 -3.889 0 L 0.805 48.209 c -1.074 1.074 -1.074 2.815 0 3.889 l 3.174 3.174 c 1.074 1.074 2.815 1.074 3.889 0 l 15.069 -15.069 l 14.994 14.994 c 1.074 1.074 2.815 1.074 3.889 0 l 1.614 -1.614 c 0.083 -0.066 0.17 -0.125 0.247 -0.202 l 37.1 -37.1 l 5.795 5.795 C 87.84 23.34 90 22.445 90 20.658 V 2.006 C 90 0.898 89.102 0 87.994 0 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 65.626 37.8 v 49.45 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 23.518 L 65.626 37.8 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 47.115 56.312 V 87.25 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 42.03 L 47.115 56.312 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 39.876 60.503 c -1.937 0 -3.757 -0.754 -5.127 -2.124 l -6.146 -6.145 V 87.25 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 59.844 C 41.952 60.271 40.933 60.503 39.876 60.503 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 22.937 46.567 L 11.051 58.453 c -0.298 0.298 -0.621 0.562 -0.959 0.8 V 87.25 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 48.004 L 22.937 46.567 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path></g></svg><p><img src="https://static-redesign.cnbcfm.com/dist/a54b41835a8b60db28c2.svg" alt="hide content"></p></div><div><p>Monday's decline follows Friday's rout when Japan's <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-6"><a href="https://www.cnbc.com/quotes/.N225/">Nikkei 225</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> and Topix fell more than 5% and 6%, respectively. The broader <a href="https://www.cnbc.com/2024/08/02/japans-nikkei-set-for-almost-4percent-plunge-as-asia-markets-poised-to-open-lower.html">Topix marked its worst day in eight years</a>, while the Nikkei marked its worst day since March 2020.</p><p>In Monday trading, the <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-8"><a href="https://www.cnbc.com/quotes/JPY=/">yen</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> also strengthened to its highest level against the dollar since January, and was last trading at 142.09.</p></div><div role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256" aria-labelledby="title desc" role="img" focusable="false" preserveAspectRatio="xMinYMin"><title>Stock Chart Icon</title><desc>Stock chart icon</desc><g transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)"><path d="M 87.994 0 H 69.342 c -1.787 0 -2.682 2.16 -1.418 3.424 l 5.795 5.795 l -33.82 33.82 L 28.056 31.196 l -3.174 -3.174 c -1.074 -1.074 -2.815 -1.074 -3.889 0 L 0.805 48.209 c -1.074 1.074 -1.074 2.815 0 3.889 l 3.174 3.174 c 1.074 1.074 2.815 1.074 3.889 0 l 15.069 -15.069 l 14.994 14.994 c 1.074 1.074 2.815 1.074 3.889 0 l 1.614 -1.614 c 0.083 -0.066 0.17 -0.125 0.247 -0.202 l 37.1 -37.1 l 5.795 5.795 C 87.84 23.34 90 22.445 90 20.658 V 2.006 C 90 0.898 89.102 0 87.994 0 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 65.626 37.8 v 49.45 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 23.518 L 65.626 37.8 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 47.115 56.312 V 87.25 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 42.03 L 47.115 56.312 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 39.876 60.503 c -1.937 0 -3.757 -0.754 -5.127 -2.124 l -6.146 -6.145 V 87.25 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 59.844 C 41.952 60.271 40.933 60.503 39.876 60.503 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path><path d="M 22.937 46.567 L 11.051 58.453 c -0.298 0.298 -0.621 0.562 -0.959 0.8 V 87.25 c 0 1.519 1.231 2.75 2.75 2.75 h 8.782 c 1.519 0 2.75 -1.231 2.75 -2.75 V 48.004 L 22.937 46.567 z" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"></path></g></svg><p><img src="https://static-redesign.cnbcfm.com/dist/a54b41835a8b60db28c2.svg" alt="hide content"></p></div><div><p>South Korea's <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-9"><a href="https://www.cnbc.com/quotes/.KS11/">Kospi</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> fell 8.77%, closing at 2,441.55, and the small-cap Kodaq saw a 11.3% wipeout, ending at 691.28.</p><p>Due to the magnitude of the sell-off, the exchanges hit circuit breakers, halting trade for <a href="https://open.krx.co.kr/contents/OPN/05/05000000/OPN05000000.jsp#fe3647848b826aa1ddee224c4b5526f4=1&amp;amp;view=2024080505" target="_blank">the Kospi index at 2.14 p.m. Seoul and at 1.56 p.m. for the Kosdaq</a>. The halt was for 20 minutes. Circuit breakers are activated if stocks rise or fall 8%.</p><p>Investors, meanwhile, awaited key trade data from China and Taiwan this week, a well as central bank decisions from Australia and India.</p><p>China's service sector expanded at a faster pace in July, with the country's purchasing managers' index climbing to 52.1 in July, up from 51.2 in June.</p><p><a href="https://www.pmi.spglobal.com/Public/Home/PressRelease/7edab8209d2246279f622725025f6d51" target="_blank">The Caixin survey</a> said the acceleration of growth was due to faster new business growth, "supported by sustained improvements in underlying demand conditions and an expansion of services offerings."</p></div><div><p>Taiwan's benchmark index, the <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-12"><a href="https://www.cnbc.com/quotes/.TWII/">Taiwan Weighted Index</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span>, was down over 8%, dragged by tech and real estate stocks , while Australia's&nbsp;<a href="https://www.cnbc.com/quotes/.AXJO/">S&amp;P/ASX 200</a> fell 3.7% to 7,649.6.</p><p>The Reserve Bank of Australia kicks off its two-day monetary policy meeting Monday. Economists polled by Reuters expect the central bank to hold rates steady at 4.35%, but markets will monitor the monetary policy statement for clarity on whether the RBA is still considering a rate hike.</p><p>Hong Kong <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-14"><a href="https://www.cnbc.com/quotes/.HSI/">Hang Seng index</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> was down 1.61%, while mainland China's CSI 300 was down 0.48%, seeing the smallest loss in Asia.</p></div><div><p>On Friday in the U.S., stocks fell sharply as a much&nbsp;<a href="https://www.cnbc.com/2024/08/02/job-growth-totals-114000-in-july-much-less-than-expected-as-unemployment-rate-rises-to-4point3percent.html">weaker-than-anticipated jobs report</a>&nbsp;for July ignited worries that the economy could be falling into a recession.</p><p>The Nasdaq was the first of the three major benchmarks to enter correction territory, down more than 10% from its record high. The S&amp;P 500 and Dow were 5.7% and 3.9% below their all-time highs, respectively.</p><p>The <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-16"><a href="https://www.cnbc.com/quotes/.SPX/">S&amp;P 500</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> dropped 1.84%, while the&nbsp;<a href="https://www.cnbc.com/quotes/.IXIC/">Nasdaq Composite</a>&nbsp;lost 2.43%. The&nbsp;<a href="https://www.cnbc.com/quotes/.DJI/">Dow Jones Industrial Average</a>&nbsp;fell 610.71 points, or 1.51%.</p><p><em>—CNBC's Pia Singh and Hakyung Kim contributed to this report.</em></p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Building Lego Machines to Destroy Tall Lego Towers (229 pts)]]></title>
            <link>https://kottke.org/24/07/building-lego-machines-to-destroy-tall-lego-towers</link>
            <guid>41157595</guid>
            <pubDate>Mon, 05 Aug 2024 02:02:20 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://kottke.org/24/07/building-lego-machines-to-destroy-tall-lego-towers">https://kottke.org/24/07/building-lego-machines-to-destroy-tall-lego-towers</a>, See on <a href="https://news.ycombinator.com/item?id=41157595">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content-container">
<p>

posted <time datetime="2024-07-31T19:12:10Z">Jul 31 @ 03:12 PM</time> by <a href="http://www.kottke.org/">Jason Kottke</a><span>  ·  <span>gift link</span></span>



</p>




<p><iframe loading="lazy" width="560" height="315" src="https://www.youtube.com/embed/HY6q9hwYcoc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe></p>

<p><a href="https://www.youtube.com/@BrickTechnology">Brick Technology</a>’s new video features increasingly powerful Lego machines designed to topple ever stronger towers. I love their iterative engineering videos (and those from <a href="https://www.youtube.com/@BrickExperimentChannel">Brick Experiment Channel</a>). As I’ve written about these videos <a href="https://kottke.org/23/07/can-a-lego-car-roll-downhill-forever">before</a>:</p>

<blockquote><p>They’re not even really about Lego…that’s just the playful hook to get you through the door. They’re really about science and engineering — trial and error, repeated failure, iteration, small gains, switching tactics when confronted with dead ends, how innovation can result in significant advantages. Of course, none of this is unique to engineering; these are all factors in any creative endeavor — painting, sports, photography, writing, programming. But the real magic here is seeing it all happen in just a few minutes.</p></blockquote>

<p>I am uncomfortably close to buying some Technic and Mindstorms to dork around with my own little machines. (via <a href="https://waxy.org/">waxy</a>)</p>

<ul><li><a href="https://kottke.org/tag/Lego">Lego</a></li><li><a href="https://kottke.org/tag/video">video</a></li></ul>








</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How I Program in 2024 (297 pts)]]></title>
            <link>http://akkartik.name/post/programming-2024</link>
            <guid>41157494</guid>
            <pubDate>Mon, 05 Aug 2024 01:28:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="http://akkartik.name/post/programming-2024">http://akkartik.name/post/programming-2024</a>, See on <a href="https://news.ycombinator.com/item?id=41157494">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
  <p>Jul 31, 2024</p>
<p><b>How I program in 2024</b></p><p>
I talk a lot here about <a href="https://akkartik.name/freewheeling">using computers freely</a>, how to select programs to use, how to decide if a program is trustworthy infrastructure one can safely depend on in the long term. I also spend my time building such infrastructure, because there isn't a lot of it out there. As I do so, I'm always acutely aware that <em>I'm just not very good at it.</em> At best I can claim I try to compensate for limited means with good, transparent intentions.

</p><p>
I just spent <a href="https://akkartik.name/post/2024-06-05-devlog">a month</a> of my free time, off and on, <a href="https://akkartik.name/post/2024-07-22-devlog">rewriting the core</a> of a program I've been using and incrementally modifying for 2 years. I've been becalmed since. Partly this is the regular cadence of my subconscious reflecting on what just happened, what I learned from it, taking some time to decide where to go next. But I'm also growing aware this time of a broader arc in my life:

<!-- more -->

</p><ul>

<li> Back in 2015 I was suspicious of abstractions and big on tests and version control. Code seemed awash in bad abstractions, while tests and versions seemed like the key advances of the 2000s. I thought our troubles stemmed from bad incentives, using abstractions too much, and not using tests and versions enough. <a href="https://github.com/akkartik/mu1">Mu1</a> was an attempt at designing a platform with tests and <a href="https://akkartik.name/post/wart-layers">layers</a> (more like versions, less like abstractions) as foundational constraints influencing everything else.

</li><li> In 2017 I started reworking Mu1 into the current <a href="https://github.com/akkartik/mu">Mu</a>. <a href="https://github.com/akkartik/mu/tree/main/linux/bootstrap#readme">At the start</a> I used all my new ideas for tests and layers. But over time I stopped using them. Mu today has tons of tests, but they are conventional tests, and I never got around to porting over my infrastructure for layers.

</li><li> In 2022 I started working on <a href="https://akkartik.name/freewheeling-apps">Freewheeling Apps</a>. I started out with no tests, got frustrated at some point and wrote thorough tests for a core piece, the text editor. But I struggled to find ways to test the rest, and also found I was getting by fine anyway.

</li><li> Now it's 2024, and a month ago I deleted all my tests. I also started radically reworking my text editor, in a way that would have made me worried about merge conflicts with other Freewheeling Apps. In effect I stopped thinking about version control. Giving up tests and versions, I ended up with a much better program. The cognitive dissonance is now impossible to ignore.

</li></ul>

<p>
After mulling it over for a few days, I think my current synthesis on <a href="https://akkartik.name/freewheeling">programming durable things</a> is:

</p><ol>

<li> Building durably for lots of people is too hard, just don't even try. Be ruled by what you know well, who you know well and <a href="https://en.wikipedia.org/wiki/Dunbar%27s_number">Dunbar's number</a>.
</li><li> Most software out there is incurably infected by incentives to serve lots of people in the short term. Focus as far as possible on software without lots of logos on the website, stuff that is easy to build, has few dependencies, definitely doesn't auto-update. Once you filter by these restrictions, the amount of durable software humanity has created so far is tiny.
</li><li> Small changes in context (people/places/features you want to support) often radically change how well a program fits its context. Our dominant milieu of short-termism doesn't prepare us for this fact.
</li><li> Given this tiny body of past work and low coverage per program, any new program you decide to build is quite likely striking out into the unknown in some way or other. You often won't know <em>quite</em> what you're doing in some direction or other. (In my example above, I was trying to insert special "drawing lines" in a text editor. Questions that raised: can the cursor lie on a drawing? Can I try to draw in one line while the cursor is on another? Drawings are taller than text lines. Can a drawing be partially visible at top of screen? Can I draw on a partially visible drawing? My answers to these questions were sub-optimal for a long time, leading to hacks piled on hacks.)
</li><li> Types, abstractions, tests, versions, state machines, immutability, formal analysis, all these are tools available to us in unfamiliar terrain. Use them to taste.
</li><li> You'll inevitably end up over-using some of these tools, the ones you gravitate towards. The ideal quantity to use these tools is tiny, much more miniscule than any of us is trained to think by our dominant milieu of short-termism. The excess is <em>tech debt.</em> It keeps us from noticing that a program is unnecessarily complex, less durable than it could be, harder to change when the context shifts.
</li><li> When your understanding of the context stabilizes, there's value in throwing away vast swathes of a program, and redoing it from scratch.
</li><li> Before you set out to rewrite, you have to spend some time importing everything into your brain at once. Everything you want from the program, all the scenarios the program has to cater to. This is hard. The goal is to get to a point where you can build everything all at once.
</li><li> Build everything all at once.

</li></ol>

<p>
In my case, tests and versions actively hindered getting to the end of this evolution. Tests let me forget concerns. Version control kept me attached to the past. Both were counter-productive. It took a major reorientation to let go of them.

</p><p>
All the software I've written in my life — and all my Freewheeling Apps so far — are at level 6 in this trajectory. Only <a href="https://akkartik.name/post/2024-07-22-devlog">the output of the past month</a> feels like it might have gotten to level 9. We'll see.

</p><p>
It seems likely that a program can grow so complex it becomes impossible to import into memory in level 8. That seems to describe most software so far, certainly most software written by more than a couple of people. Even my text editor, small as it is, was daunting enough I spent much of the month girding myself to face the terror.

</p><p>
Not all software necessarily <em>needs</em> to get to level 9. I think many of my Freewheeling Apps are simple enough and evolve slowly enough that they would stabilize to a bug-free state with just a handful of people using them, regardless of my initial design choices. Particularly now that I know how to streamline one complex piece at their core. Still, it's good to be aware of how things <em>might</em> be improved, if it becomes worthwhile.

</p><p>
One thing that feels definitely useful in getting to level 9 is <a href="https://www.youtube.com/watch?v=rX0ItVEVjHc">data-oriented design</a>. It's not a tool you can blindly apply but a way of thinking you have to grow into, to look past immediate data structure choices at the big picture of how your program accesses data. Just don't let tools like <a href="https://en.wikipedia.org/wiki/Entity_component_system">ECS</a> blind you to the essential intellectual activity.

</p><p>
These levels are probably not quite right. I'm probably under-estimating tools I have less experience with.

</p><p>
I wonder what levels lie beyond these.

</p><p>
(I last wrote some thoughts on how I program <a href="https://akkartik.name/post/four-repos">back in 2019</a>. It's nice to see signs of evolution.)


  </p><p>
  <em>Comments gratefully appreciated. Please send them to me
  <a href="http://akkartik.name/contact">by any method of your choice</a> and I'll include them
  here.</em>
</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Uncovered Euripides fragments are 'kind of a big deal' (166 pts)]]></title>
            <link>https://www.colorado.edu/asmagazine/2024/08/01/uncovered-euripides-fragments-are-kind-big-deal</link>
            <guid>41157192</guid>
            <pubDate>Mon, 05 Aug 2024 00:11:33 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.colorado.edu/asmagazine/2024/08/01/uncovered-euripides-fragments-are-kind-big-deal">https://www.colorado.edu/asmagazine/2024/08/01/uncovered-euripides-fragments-are-kind-big-deal</a>, See on <a href="https://news.ycombinator.com/item?id=41157192">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p><em>CU Boulder Classics scholars identify previously unknown fragments of two lost tragedies by Greek tragedian Euripides</em></p>
<hr>
<p>After months of intense scrutiny, two University of Colorado Boulder scholars have deciphered and interpreted what they believe to be the most significant new fragments of works by classical Greek tragedian Euripides in more than half a century.</p>
<p>In November 2022, Basem Gehad, an archaeologist with the Egyptian Ministry of Tourism and Antiquities, sent a papyrus unearthed at the ancient site of Philadelphia in Egypt to <a href="https://www.colorado.edu/classics/yvona-trnka-amrhein" target="_blank">Yvona Trnka-Amrhein</a>, assistant professor of <a href="https://www.colorado.edu/classics/" target="_blank">classics</a>. The two scholars have also recently discovered the upper half of a colossal statue of the ancient Egyptian Pharaoh Ramesses II in their joint excavation project at Hermopolis Magna.</p>
<p>She began to pore over the high-resolution photo of the papyrus (Egyptian law prohibits physically removing any artifact from the country), scrutinizing its 98 lines.</p>
<div>
<p><img alt="Yvona Trnka-Amrhein and John Gilbert" src="https://www.colorado.edu/asmagazine/sites/default/files/styles/medium/public/article-image/trnka-amrhein_and_gilbert.jpg?itok=BmqncZZr"></p>
<p>CU Boulder classicists&nbsp;Yvona Trnka-Amrhein&nbsp;(left) and John Gibert (right) spent months studying a small square of papyrus and&nbsp;became confident it contains previously unknown material from two fragmentary Euripides plays, <em>Polyidus</em> and <em>Ino</em>.</p>
</div>
<p>“It was very clearly tragedy,” she says.</p>
<p>Using the <a href="https://stephanus.tlg.uci.edu/" target="_blank">Thesaurus Linguae Graecae</a>, a comprehensive, digitized database of ancient Greek texts maintained by the University of California, Irvine, Trnka-Amrhein confirmed she was looking at previously unknown excerpts from mostly lost Euripidean plays.</p>
<p>“After more digging, I realized I should call in an expert in Euripides fragments,” she says. “Luckily, my mentor in the department is just that!”</p>
<p>Working together, Trnka-Amrhein and renowned classics Professor <a href="https://www.colorado.edu/classics/john-gibert" target="_blank">John Gibert</a> embarked on many months of grueling work, meticulously poring over a high-resolution photo of the 10.5-square-inch papyrus They made out words and ensured that the words they thought they were seeing fit the norms of tragic style and meter.</p>
<p>Eventually, they became confident that they were working with new material from two fragmentary Euripides plays, <em>Polyidus</em> and <em>Ino</em>. Twenty-two of the lines were previously known in slightly varied versions, but “80 percent was brand-new stuff,” Gibert says.</p>
<p>“We don’t think there has been a find of this significance since the 1960s,” he says.</p>
<p>“This is a large and unusual papyrus for this day and age,” Trnka-Amrhein says. “It’s kind of a big deal in the field.”</p>
<p><strong>Retelling a Cretan myth</strong></p>
<p><em>Polyidus </em>retells an ancient Cretan myth in which King Minos and Queen Pasiphaë demand that the eponymous seer resurrect their son Glaucus after he drowns in a vat of honey.</p>
<p>“Actually, it has a relatively happy ending. It’s not one of these tragedies where everyone winds up dead,” Trnka-Amrhein says: Polyidus is able to revive the boy using an herb he previously saw one snake use to revive another.</p>
<p>The papyrus contains part of a scene in which Minos and Polyidus debate the morality of resurrecting the dead, she says.</p>
<div>
<p><img alt="Marble statue of Euripides" src="https://www.colorado.edu/asmagazine/sites/default/files/styles/medium/public/article-image/louvre_euripides_sculpture.jpg?itok=JLNoyNfl"></p>
<p>A marble statuette of Euripides, found in 1704 CE in the Esquiline Hill at Rome and dated to the 2nd century CE, lists several of the tragedian's works on the back panel. It is on display at the Louvre-Lens Museum in France. (Photo:&nbsp;Pierre André/Wikimedia Commons)</p>
</div>
<p><em>Ino</em> came close to being one of Euripides’ best-known plays, Gibert says. Part of the text was inscribed on cliffs in Armenia that were destroyed in modern conflict. Fortunately, early 20th-century Russian scholars had preserved the images in drawings.</p>
<p>The eponymous character is an aunt of the Greek god Dionysus and part of the royal family of Thebes. In previously known fragments of a related play, Ino is an evil stepmother intent on killing her husband the Thessalian king’s children from a previous marriage. The new fragment introduces a new plot, Trnka-Amrhein says.</p>
<p>“Another woman is the evil stepmother, and Ino is the victim,” she says. “The third wife of the king is trying to eliminate Ino’s children. … Ino turns the tables on her, causing her to kill her own children and commit suicide. It’s a more traditional tragedy: death, mayhem, suicide.”</p>
<p>Of course, in matters of ancient Greek, there is always room for interpretation, and such bold claims will receive careful scrutiny from other experts. Gibert and Trnka-Amrhein decided not to pull any punches with their conclusions.</p>
<p>“We could play it safe,” Gibert says. “We are establishing a solid foundation, and on top of that we are sticking our necks out a little.”</p>
<p>They’ve already entered the gauntlet of scrutiny, making their case to 13 experts in Washington, D.C., in June and having their first edition of the fragment accepted for publication in August.</p>
<p>On Sept. 14, they will host the Ninth Fountain Symposium on the CU Boulder campus, supported by long-time Boulder resident and classics enthusiast Dr. Celia M. Fountain. The day-long event will feature three illustrious experts: Professor Paul Schubert, a Swiss specialist in papyrology; specialist in ancient Greek literature and drama Laura Swift of Oxford University; and Professor Sarah Iles Johnston, an expert in Greek religion, goddesses and magic from the Ohio State University. They will be joined by Trnka-Amrhein, Gibert and Associate Professor of Classics <a href="https://www.colorado.edu/classics/laurialan-reitzammer" target="_blank">Laurialan Reitzammer</a>.</p>
<p>“In a departure, instead of having the guests give hour-long papers, we’re going to present for 20 to 25 minutes each, in pairs, in dialogue, followed by Q-and-A,” Gibert says.</p>
<p>And as the academic year gets underway, Gibert says he and Trnka-Amrhein will “take the show on the road” to such places as Dartmouth and Harvard.</p>
<p>“John’s contacts and readers in the Euripides world have given us reassurance we’re not going to have too much pie on our faces,” Trnka-Amrhein says. “We feel extremely lucky to have worked on this material and look forward to the world’s reactions.”</p>
<p><small><em>Top image:&nbsp;A marble bas-relief show Euripides (seated), a standing woman holding out a theater mask to him (left) and the god Dionysus (right), dated to between the 1st century BCE and the 1st century CE, from the Misthos collection in the Istanbul (Turkey) Archaeological Museum. (Photo:&nbsp;John-Grégoire/Wikimedia Commons)</em></small></p>
<hr>
<p><em>Did you enjoy this article?&nbsp;<a href="https://cu.tfaforms.net/73" target="_blank">Subcribe to our newsletter.</a>&nbsp;Passionate about classics?&nbsp;<a href="https://www.colorado.edu/classics/giving" target="_blank">Show your support.</a></em></p>

</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Free e-book about WebGPU Programming (378 pts)]]></title>
            <link>https://shi-yan.github.io/webgpuunleashed/</link>
            <guid>41156872</guid>
            <pubDate>Sun, 04 Aug 2024 22:56:22 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://shi-yan.github.io/webgpuunleashed/">https://shi-yan.github.io/webgpuunleashed/</a>, See on <a href="https://news.ycombinator.com/item?id=41156872">Hacker News</a></p>
<div id="readability-page-1" class="page"><article>
            <div><p><img onclick="openImage(this)" src="https://shi-yan.github.io/webgpuunleashed/thumb_meta.png" original_src="meta.png" alt="By Shi Yan" sources="[]"></p><p>By Shi Yan</p></div><p>Welcome to "WebGPU Unleashed" - your gateway to the dynamic world of graphics programming. This free book will teach you graphics programming in JavaScript using WebGPU, drawing from my own learning journey.</p><p>Why did I write this book? Recently, a friend asked me what his child should learn to get started with graphics programming. A few years ago, OpenGL was the go-to API for beginners, with DirectX as an alternative for those interested in game development.</p><p>However, the graphics API landscape has evolved significantly in recent years. A new generation of APIs has emerged, including Vulkan, Metal, and DirectX 12. These APIs are more lightweight and performant but require more verbose code. While similar in concept, they're more fragmented than OpenGL, with some only available on specific platforms. This fragmentation often confuses beginners, leaving them unsure which API to start with.</p><p>Enter WebGPU, a new graphics API conceptually similar to others but with a different goal: bringing native graphics capabilities to the web. Unlike other APIs with native implementations in graphics drivers, WebGPU is essentially a wrapper for the aforementioned APIs. This makes WebGPU appealing as a first API for several reasons:</p><ol><li><p>As a wrapper, WebGPU aims to be a common denominator of other APIs, making it relatively simpler.</p></li><li><p>As the web graphics API standard, WebGPU is available on all platforms.</p></li><li><p>For those interested in native development, there are WebGPU implementations available in C++ and Rust.</p></li></ol><p>With WebGPU's recent release, now is an ideal time to learn it.</p><p>We'll begin with an overview of GPU drivers and the GPU pipeline - topics often overlooked in other graphics API books. Many students who can implement simple graphics applications lack understanding of GPU drivers and how graphics software interacts with underlying hardware. I believe covering these topics is essential.</p><p>Following this overview, we'll explore the simplest usage of WebGPU: drawing triangles, the basic elements of 3D graphics. While this might sound basic, mastering it is crucial for understanding more complex concepts. We'll then cover 2D rendering techniques and 3D scene control, necessary skills for implementing full graphics applications for the web.</p><p>In the advanced chapters, we'll look into GPU computing using WebGPU and explore advanced rendering techniques beyond simple triangles. GPU compute on the web, previously unavailable through WebGL, is now possible with WebGPU. This opens up exciting possibilities, including potential GPU AI inference for web applications.</p><p>As the book's final tutorial, we'll implement Gaussian splatting rendering - a complex example combining GPU compute and rendering. At the time of writing, Gaussian splatting is a cutting-edge scene representation and rendering technique, capable of capturing and rendering 3D scenes from real life with a high degree of realism and real-time performance.</p><div><p><iframe src="https://www.youtube.com/embed/QUGcWsJCCmU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe></p></div><p>I've put considerable effort into presenting this book's content. Initially planned as a traditional book, I realized that an interactive web format would be more effective for a tech book. This approach allows for:</p><ul><li><p>Better explanation of concepts through videos</p></li><li><p>Easy citation of references via links</p></li><li><p>An online playground hosting all code samples, where you can run demos and modify code</p></li></ul><a href="https://shi-yan.github.io/webgpuunleashed/code/code.html#5_06_skeleton_animation" target="_blank"><svg style="margin-right:10px;vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" height="32" width="32" fill="#dadadb" viewBox="0 -960 960 960"><path d="M189-160q-60 0-102.5-43T42-307q0-9 1-18t3-18l84-336q14-54 57-87.5t98-33.5h390q55 0 98 33.5t57 87.5l84 336q2 9 3.5 18.5T919-306q0 61-43.5 103.5T771-160q-42 0-78-22t-54-60l-28-58q-5-10-15-15t-21-5H385q-11 0-21 5t-15 15l-28 58q-18 38-54 60t-78 22Zm3-80q19 0 34.5-10t23.5-27l28-57q15-31 44-48.5t63-17.5h190q34 0 63 18t45 48l28 57q8 17 23.5 27t34.5 10q28 0 48-18.5t21-46.5q0 1-2-19l-84-335q-7-27-28-44t-49-17H285q-28 0-49.5 17T208-659l-84 335q-2 6-2 18 0 28 20.5 47t49.5 19Zm348-280q17 0 28.5-11.5T580-560q0-17-11.5-28.5T540-600q-17 0-28.5 11.5T500-560q0 17 11.5 28.5T540-520Zm80-80q17 0 28.5-11.5T660-640q0-17-11.5-28.5T620-680q-17 0-28.5 11.5T580-640q0 17 11.5 28.5T620-600Zm0 160q17 0 28.5-11.5T660-480q0-17-11.5-28.5T620-520q-17 0-28.5 11.5T580-480q0 17 11.5 28.5T620-440Zm80-80q17 0 28.5-11.5T740-560q0-17-11.5-28.5T700-600q-17 0-28.5 11.5T660-560q0 17 11.5 28.5T700-520Zm-360 60q13 0 21.5-8.5T370-490v-40h40q13 0 21.5-8.5T440-560q0-13-8.5-21.5T410-590h-40v-40q0-13-8.5-21.5T340-660q-13 0-21.5 8.5T310-630v40h-40q-13 0-21.5 8.5T240-560q0 13 8.5 21.5T270-530h40v40q0 13 8.5 21.5T340-460Zm140-20Z"></path></svg>Launch Playground - 5_06_skeleton_animation</a><p>All code snippets in the book are cross-referenced from the playground samples. To avoid overwhelming readers with verbose code, I've included only relevant code segments in the articles. navigation between the text and the playground is very easy .</p><p>Another advantage of this online format is the ability to receive reader feedback. If you have suggestions or improvements, please feel free to share them through GitHub discussions and issues.</p><p>Let's embark on this WebGPU journey together!</p>
        </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Age is a simple, modern and secure file encryption tool, format, and Go library (222 pts)]]></title>
            <link>https://github.com/FiloSottile/age</link>
            <guid>41156793</guid>
            <pubDate>Sun, 04 Aug 2024 22:42:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/FiloSottile/age">https://github.com/FiloSottile/age</a>, See on <a href="https://news.ycombinator.com/item?id=41156793">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto">
    <themed-picture data-catalyst-inline="true"><picture>
        <source media="(prefers-color-scheme: dark)" srcset="https://github.com/FiloSottile/age/raw/main/logo/logo_white.svg">
        <source media="(prefers-color-scheme: light)" srcset="https://github.com/FiloSottile/age/raw/main/logo/logo.svg">
        <img alt="The age logo, a wireframe of St. Peters dome in Rome, with the text: age, file encryption" width="600" src="https://github.com/FiloSottile/age/raw/main/logo/logo.svg">
    </picture></themed-picture>
</p>
<p dir="auto"><a href="https://pkg.go.dev/filippo.io/age" rel="nofollow"><img src="https://camo.githubusercontent.com/92ae44bb521718570d4d40f7e7983eb8af43e8109cd03ad3a85b59a2c964c0ba/68747470733a2f2f706b672e676f2e6465762f62616467652f66696c6970706f2e696f2f6167652e737667" alt="Go Reference" data-canonical-src="https://pkg.go.dev/badge/filippo.io/age.svg"></a>
<a href="https://filippo.io/age/age.1" rel="nofollow"><img src="https://camo.githubusercontent.com/f533193192e68df274d6d526b7dd289469b3b5ee6da9cb96231d23802dacce9a/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6167652831292d6d616e253230706167652d6c6967687467726579" alt="man page" data-canonical-src="https://img.shields.io/badge/age(1)-man%20page-lightgrey"></a>
<a href="https://age-encryption.org/v1" rel="nofollow"><img src="https://camo.githubusercontent.com/ecee07dc5914d937dc21247830190264d48cad226493ae8a936cc3de49edcfc4/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2543322541372532332d73706563696669636174696f6e2d626c756576696f6c6574" alt="C2SP specification" data-canonical-src="https://img.shields.io/badge/%C2%A7%23-specification-blueviolet"></a></p>
<p dir="auto">age is a simple, modern and secure file encryption tool, format, and Go library.</p>
<p dir="auto">It features small explicit keys, no config options, and UNIX-style composability.</p>
<div data-snippet-clipboard-copy-content="$ age-keygen -o key.txt
Public key: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
$ tar cvz ~/data | age -r age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p > data.tar.gz.age
$ age --decrypt -i key.txt data.tar.gz.age > data.tar.gz"><pre><code>$ age-keygen -o key.txt
Public key: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
$ tar cvz ~/data | age -r age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p &gt; data.tar.gz.age
$ age --decrypt -i key.txt data.tar.gz.age &gt; data.tar.gz
</code></pre></div>
<p dir="auto">📜 The format specification is at <a href="https://age-encryption.org/v1" rel="nofollow">age-encryption.org/v1</a>. age was designed by <a href="https://twitter.com/Benjojo12" rel="nofollow">@Benjojo12</a> and <a href="https://twitter.com/FiloSottile" rel="nofollow">@FiloSottile</a>.</p>
<p dir="auto">📬 Follow the maintenance of this project by subscribing to <a href="https://filippo.io/newsletter" rel="nofollow">Maintainer Dispatches</a>!</p>
<p dir="auto">🦀 An alternative interoperable Rust implementation is available at <a href="https://github.com/str4d/rage">github.com/str4d/rage</a>.</p>
<p dir="auto">🔑 Hardware PIV tokens such as YubiKeys are supported through the <a href="https://github.com/str4d/age-plugin-yubikey">age-plugin-yubikey</a> plugin.</p>
<p dir="auto">✨ For more plugins, implementations, tools, and integrations, check out the <a href="https://github.com/FiloSottile/awesome-age">awesome age</a> list.</p>
<p dir="auto">💬 The author pronounces it <code>[aɡe̞]</code> <a href="https://translate.google.com/?sl=it&amp;text=aghe" rel="nofollow">with a hard <em>g</em></a>, like GIF, and is always spelled lowercase.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<markdown-accessiblity-table><table>
    <tbody><tr>
        <td>Homebrew (macOS or Linux)</td>
        <td>
            <code>brew install age</code>
        </td>
    </tr>
    <tr>
        <td>MacPorts</td>
        <td>
            <code>port install age</code>
        </td>
    </tr>
    <tr>
        <td>Alpine Linux v3.15+</td>
        <td>
            <code>apk add age</code>
        </td>
    </tr>
    <tr>
        <td>Arch Linux</td>
        <td>
            <code>pacman -S age</code>
        </td>
    </tr>
    <tr>
        <td>Debian 12+ (Bookworm)</td>
        <td>
            <code>apt install age</code>
        </td>
    </tr>
    <tr>
        <td>Debian 11 (Bullseye)</td>
        <td>
            <code>apt install age/bullseye-backports</code>
            (<a href="https://backports.debian.org/Instructions/#index2h2" rel="nofollow">enable backports</a> for age v1.0.0+)
        </td>
    </tr>
    <tr>
        <td>Fedora 33+</td>
        <td>
            <code>dnf install age</code>
        </td>
    </tr>
    <tr>
        <td>Gentoo Linux</td>
        <td>
            <code>emerge app-crypt/age</code>
        </td>
    </tr>
    <tr>
        <td>NixOS / Nix</td>
        <td>
            <code>nix-env -i age</code>
        </td>
    </tr>
    <tr>
        <td>openSUSE Tumbleweed</td>
        <td>
            <code>zypper install age</code>
        </td>
    </tr>
    <tr>
        <td>Ubuntu 22.04+</td>
        <td>
            <code>apt install age</code>
        </td>
    </tr>
    <tr>
        <td>Void Linux</td>
        <td>
            <code>xbps-install age</code>
        </td>
    </tr>
    <tr>
        <td>FreeBSD</td>
        <td>
            <code>pkg install age</code> (security/age)
        </td>
    </tr>
    <tr>
        <td>OpenBSD 6.7+</td>
        <td>
            <code>pkg_add age</code> (security/age)
        </td>
    </tr>
    <tr>
        <td>Chocolatey (Windows)</td>
        <td>
            <code>choco install age.portable</code>
        </td>
    </tr>
    <tr>
        <td>Scoop (Windows)</td>
        <td>
            <code>scoop bucket add extras &amp;&amp; scoop install age</code>
        </td>
    </tr>
    <tr>
        <td>pkgx</td>
        <td>
            <code>pkgx install age</code>
        </td>
    </tr>
</tbody></table></markdown-accessiblity-table>
<p dir="auto">On Windows, Linux, macOS, and FreeBSD you can use the pre-built binaries.</p>
<div data-snippet-clipboard-copy-content="https://dl.filippo.io/age/latest?for=linux/amd64
https://dl.filippo.io/age/v1.1.1?for=darwin/arm64
..."><pre><code>https://dl.filippo.io/age/latest?for=linux/amd64
https://dl.filippo.io/age/v1.1.1?for=darwin/arm64
...
</code></pre></div>
<p dir="auto">If your system has <a href="https://go.dev/dl/" rel="nofollow">a supported version of Go</a>, you can build from source.</p>
<div data-snippet-clipboard-copy-content="go install filippo.io/age/cmd/...@latest"><pre><code>go install filippo.io/age/cmd/...@latest
</code></pre></div>
<p dir="auto">Help from new packagers is very welcome.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Verifying the release signatures</h3><a id="user-content-verifying-the-release-signatures" aria-label="Permalink: Verifying the release signatures" href="#verifying-the-release-signatures"></a></p>
<p dir="auto">If you download the pre-built binaries, you can check their
<a href="https://www.sigsum.org/" rel="nofollow">Sigsum</a> proofs, which are like signatures with extra
transparency: you can cryptographically verify that every proof is logged in a
public append-only log, so you can hold the age project accountable for every
binary release we ever produced. This is similar to what the <a href="https://go.dev/blog/module-mirror-launch" rel="nofollow">Go Checksum
Database</a> provides.</p>
<div data-snippet-clipboard-copy-content="cat << EOF > age-sigsum-key.pub
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEjDYFJ4WVbxRLcgbppmPaMFS/Wbq+1r9cl4qdJTyRVL
EOF
cat << EOF > sigsum-trust-policy.txt
log 154f49976b59ff09a123675f58cb3e346e0455753c3c3b15d465dcb4f6512b0b https://poc.sigsum.org/jellyfish
witness poc.sigsum.org/nisse 1c25f8a44c635457e2e391d1efbca7d4c2951a0aef06225a881e46b98962ac6c
witness rgdd.se/poc-witness  28c92a5a3a054d317c86fc2eeb6a7ab2054d6217100d0be67ded5b74323c5806
group  demo-quorum-rule all poc.sigsum.org/nisse rgdd.se/poc-witness
quorum demo-quorum-rule
EOF

curl -JO &quot;https://dl.filippo.io/age/v1.2.0?for=darwin/arm64&quot;
curl -JO &quot;https://dl.filippo.io/age/v1.2.0?for=darwin/arm64&amp;proof&quot;

go install sigsum.org/sigsum-go/cmd/sigsum-verify@v0.6.2
sigsum-verify -k age-sigsum-key.pub -p sigsum-trust-policy.txt \
    age-v1.2.0-darwin-arm64.tar.gz.proof < age-v1.2.0-darwin-arm64.tar.gz"><pre><code>cat &lt;&lt; EOF &gt; age-sigsum-key.pub
ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEjDYFJ4WVbxRLcgbppmPaMFS/Wbq+1r9cl4qdJTyRVL
EOF
cat &lt;&lt; EOF &gt; sigsum-trust-policy.txt
log 154f49976b59ff09a123675f58cb3e346e0455753c3c3b15d465dcb4f6512b0b https://poc.sigsum.org/jellyfish
witness poc.sigsum.org/nisse 1c25f8a44c635457e2e391d1efbca7d4c2951a0aef06225a881e46b98962ac6c
witness rgdd.se/poc-witness  28c92a5a3a054d317c86fc2eeb6a7ab2054d6217100d0be67ded5b74323c5806
group  demo-quorum-rule all poc.sigsum.org/nisse rgdd.se/poc-witness
quorum demo-quorum-rule
EOF

curl -JO "https://dl.filippo.io/age/v1.2.0?for=darwin/arm64"
curl -JO "https://dl.filippo.io/age/v1.2.0?for=darwin/arm64&amp;proof"

go install sigsum.org/sigsum-go/cmd/sigsum-verify@v0.6.2
sigsum-verify -k age-sigsum-key.pub -p sigsum-trust-policy.txt \
    age-v1.2.0-darwin-arm64.tar.gz.proof &lt; age-v1.2.0-darwin-arm64.tar.gz
</code></pre></div>
<p dir="auto">You can learn more about what's happening above in the <a href="https://www.sigsum.org/getting-started/" rel="nofollow">Sigsum
docs</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Usage</h2><a id="user-content-usage" aria-label="Permalink: Usage" href="#usage"></a></p>
<p dir="auto">For the full documentation, read <a href="https://filippo.io/age/age.1" rel="nofollow">the age(1) man page</a>.</p>
<div data-snippet-clipboard-copy-content="Usage:
    age [--encrypt] (-r RECIPIENT | -R PATH)... [--armor] [-o OUTPUT] [INPUT]
    age [--encrypt] --passphrase [--armor] [-o OUTPUT] [INPUT]
    age --decrypt [-i PATH]... [-o OUTPUT] [INPUT]

Options:
    -e, --encrypt               Encrypt the input to the output. Default if omitted.
    -d, --decrypt               Decrypt the input to the output.
    -o, --output OUTPUT         Write the result to the file at path OUTPUT.
    -a, --armor                 Encrypt to a PEM encoded format.
    -p, --passphrase            Encrypt with a passphrase.
    -r, --recipient RECIPIENT   Encrypt to the specified RECIPIENT. Can be repeated.
    -R, --recipients-file PATH  Encrypt to recipients listed at PATH. Can be repeated.
    -i, --identity PATH         Use the identity file at PATH. Can be repeated.

INPUT defaults to standard input, and OUTPUT defaults to standard output.
If OUTPUT exists, it will be overwritten.

RECIPIENT can be an age public key generated by age-keygen (&quot;age1...&quot;)
or an SSH public key (&quot;ssh-ed25519 AAAA...&quot;, &quot;ssh-rsa AAAA...&quot;).

Recipient files contain one or more recipients, one per line. Empty lines
and lines starting with &quot;#&quot; are ignored as comments. &quot;-&quot; may be used to
read recipients from standard input.

Identity files contain one or more secret keys (&quot;AGE-SECRET-KEY-1...&quot;),
one per line, or an SSH key. Empty lines and lines starting with &quot;#&quot; are
ignored as comments. Passphrase encrypted age files can be used as
identity files. Multiple key files can be provided, and any unused ones
will be ignored. &quot;-&quot; may be used to read identities from standard input.

When --encrypt is specified explicitly, -i can also be used to encrypt to an
identity file symmetrically, instead or in addition to normal recipients."><pre><code>Usage:
    age [--encrypt] (-r RECIPIENT | -R PATH)... [--armor] [-o OUTPUT] [INPUT]
    age [--encrypt] --passphrase [--armor] [-o OUTPUT] [INPUT]
    age --decrypt [-i PATH]... [-o OUTPUT] [INPUT]

Options:
    -e, --encrypt               Encrypt the input to the output. Default if omitted.
    -d, --decrypt               Decrypt the input to the output.
    -o, --output OUTPUT         Write the result to the file at path OUTPUT.
    -a, --armor                 Encrypt to a PEM encoded format.
    -p, --passphrase            Encrypt with a passphrase.
    -r, --recipient RECIPIENT   Encrypt to the specified RECIPIENT. Can be repeated.
    -R, --recipients-file PATH  Encrypt to recipients listed at PATH. Can be repeated.
    -i, --identity PATH         Use the identity file at PATH. Can be repeated.

INPUT defaults to standard input, and OUTPUT defaults to standard output.
If OUTPUT exists, it will be overwritten.

RECIPIENT can be an age public key generated by age-keygen ("age1...")
or an SSH public key ("ssh-ed25519 AAAA...", "ssh-rsa AAAA...").

Recipient files contain one or more recipients, one per line. Empty lines
and lines starting with "#" are ignored as comments. "-" may be used to
read recipients from standard input.

Identity files contain one or more secret keys ("AGE-SECRET-KEY-1..."),
one per line, or an SSH key. Empty lines and lines starting with "#" are
ignored as comments. Passphrase encrypted age files can be used as
identity files. Multiple key files can be provided, and any unused ones
will be ignored. "-" may be used to read identities from standard input.

When --encrypt is specified explicitly, -i can also be used to encrypt to an
identity file symmetrically, instead or in addition to normal recipients.
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Multiple recipients</h3><a id="user-content-multiple-recipients" aria-label="Permalink: Multiple recipients" href="#multiple-recipients"></a></p>
<p dir="auto">Files can be encrypted to multiple recipients by repeating <code>-r/--recipient</code>. Every recipient will be able to decrypt the file.</p>
<div data-snippet-clipboard-copy-content="$ age -o example.jpg.age -r age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p \
    -r age1lggyhqrw2nlhcxprm67z43rta597azn8gknawjehu9d9dl0jq3yqqvfafg example.jpg"><pre><code>$ age -o example.jpg.age -r age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p \
    -r age1lggyhqrw2nlhcxprm67z43rta597azn8gknawjehu9d9dl0jq3yqqvfafg example.jpg
</code></pre></div>
<p dir="auto"><h4 tabindex="-1" dir="auto">Recipient files</h4><a id="user-content-recipient-files" aria-label="Permalink: Recipient files" href="#recipient-files"></a></p>
<p dir="auto">Multiple recipients can also be listed one per line in one or more files passed with the <code>-R/--recipients-file</code> flag.</p>
<div data-snippet-clipboard-copy-content="$ cat recipients.txt
# Alice
age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
# Bob
age1lggyhqrw2nlhcxprm67z43rta597azn8gknawjehu9d9dl0jq3yqqvfafg
$ age -R recipients.txt example.jpg > example.jpg.age"><pre><code>$ cat recipients.txt
# Alice
age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p
# Bob
age1lggyhqrw2nlhcxprm67z43rta597azn8gknawjehu9d9dl0jq3yqqvfafg
$ age -R recipients.txt example.jpg &gt; example.jpg.age
</code></pre></div>
<p dir="auto">If the argument to <code>-R</code> (or <code>-i</code>) is <code>-</code>, the file is read from standard input.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Passphrases</h3><a id="user-content-passphrases" aria-label="Permalink: Passphrases" href="#passphrases"></a></p>
<p dir="auto">Files can be encrypted with a passphrase by using <code>-p/--passphrase</code>. By default age will automatically generate a secure passphrase. Passphrase protected files are automatically detected at decrypt time.</p>
<div data-snippet-clipboard-copy-content="$ age -p secrets.txt > secrets.txt.age
Enter passphrase (leave empty to autogenerate a secure one):
Using the autogenerated passphrase &quot;release-response-step-brand-wrap-ankle-pair-unusual-sword-train&quot;.
$ age -d secrets.txt.age > secrets.txt
Enter passphrase:"><pre><code>$ age -p secrets.txt &gt; secrets.txt.age
Enter passphrase (leave empty to autogenerate a secure one):
Using the autogenerated passphrase "release-response-step-brand-wrap-ankle-pair-unusual-sword-train".
$ age -d secrets.txt.age &gt; secrets.txt
Enter passphrase:
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Passphrase-protected key files</h3><a id="user-content-passphrase-protected-key-files" aria-label="Permalink: Passphrase-protected key files" href="#passphrase-protected-key-files"></a></p>
<p dir="auto">If an identity file passed to <code>-i</code> is a passphrase encrypted age file, it will be automatically decrypted.</p>
<div data-snippet-clipboard-copy-content="$ age-keygen | age -p > key.age
Public key: age1yhm4gctwfmrpz87tdslm550wrx6m79y9f2hdzt0lndjnehwj0ukqrjpyx5
Enter passphrase (leave empty to autogenerate a secure one):
Using the autogenerated passphrase &quot;hip-roast-boring-snake-mention-east-wasp-honey-input-actress&quot;.
$ age -r age1yhm4gctwfmrpz87tdslm550wrx6m79y9f2hdzt0lndjnehwj0ukqrjpyx5 secrets.txt > secrets.txt.age
$ age -d -i key.age secrets.txt.age > secrets.txt
Enter passphrase for identity file &quot;key.age&quot;:"><pre><code>$ age-keygen | age -p &gt; key.age
Public key: age1yhm4gctwfmrpz87tdslm550wrx6m79y9f2hdzt0lndjnehwj0ukqrjpyx5
Enter passphrase (leave empty to autogenerate a secure one):
Using the autogenerated passphrase "hip-roast-boring-snake-mention-east-wasp-honey-input-actress".
$ age -r age1yhm4gctwfmrpz87tdslm550wrx6m79y9f2hdzt0lndjnehwj0ukqrjpyx5 secrets.txt &gt; secrets.txt.age
$ age -d -i key.age secrets.txt.age &gt; secrets.txt
Enter passphrase for identity file "key.age":
</code></pre></div>
<p dir="auto">Passphrase-protected identity files are not necessary for most use cases, where access to the encrypted identity file implies access to the whole system. However, they can be useful if the identity file is stored remotely.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">SSH keys</h3><a id="user-content-ssh-keys" aria-label="Permalink: SSH keys" href="#ssh-keys"></a></p>
<p dir="auto">As a convenience feature, age also supports encrypting to <code>ssh-rsa</code> and <code>ssh-ed25519</code> SSH public keys, and decrypting with the respective private key file. (<code>ssh-agent</code> is not supported.)</p>
<div data-snippet-clipboard-copy-content="$ age -R ~/.ssh/id_ed25519.pub example.jpg > example.jpg.age
$ age -d -i ~/.ssh/id_ed25519 example.jpg.age > example.jpg"><pre><code>$ age -R ~/.ssh/id_ed25519.pub example.jpg &gt; example.jpg.age
$ age -d -i ~/.ssh/id_ed25519 example.jpg.age &gt; example.jpg
</code></pre></div>
<p dir="auto">Note that SSH key support employs more complex cryptography, and embeds a public key tag in the encrypted file, making it possible to track files that are encrypted to a specific public key.</p>
<p dir="auto"><h4 tabindex="-1" dir="auto">Encrypting to a GitHub user</h4><a id="user-content-encrypting-to-a-github-user" aria-label="Permalink: Encrypting to a GitHub user" href="#encrypting-to-a-github-user"></a></p>
<p dir="auto">Combining SSH key support and <code>-R</code>, you can easily encrypt a file to the SSH keys listed on a GitHub profile.</p>
<div data-snippet-clipboard-copy-content="$ curl https://github.com/benjojo.keys | age -R - example.jpg > example.jpg.age"><pre><code>$ curl https://github.com/benjojo.keys | age -R - example.jpg &gt; example.jpg.age
</code></pre></div>
<p dir="auto">Keep in mind that people might not protect SSH keys long-term, since they are revokable when used only for authentication, and that SSH keys held on YubiKeys can't be used to decrypt files.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Zero regrets: Firefox power user kept 7,500 tabs open for two years (140 pts)]]></title>
            <link>https://www.techspot.com/news/102871-zero-regrets-firefox-power-user-kept-7500-tabs.html</link>
            <guid>41156568</guid>
            <pubDate>Sun, 04 Aug 2024 21:51:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.techspot.com/news/102871-zero-regrets-firefox-power-user-kept-7500-tabs.html">https://www.techspot.com/news/102871-zero-regrets-firefox-power-user-kept-7500-tabs.html</a>, See on <a href="https://news.ycombinator.com/item?id=41156568">Hacker News</a></p>
<div id="readability-page-1" class="page"><p>
Serving tech enthusiasts for over 25 years.
<br> TechSpot means tech analysis and advice <a href="https://www.techspot.com/ethics.html" target="_blank">you&nbsp;can&nbsp;trust</a>.
</p><div>
<p id="why-it-matters"><strong>In brief:</strong> For most of us, having more than a couple dozen browser tabs open at once feels like a cluttered nightmare. But for one software engineer, managing nearly 7,500 active Firefox tabs is just another day at the office. </p>
<p>Hazel, who prefers not to share her last name, is what you'd call a hardcore Firefox fan and self-proclaimed "tab hoarder." She recently posted a screenshot showing a mind-boggling 7,470 tabs open simultaneously in the Mozilla browser. Turns out, <a href="https://www.techspot.com/downloads/19-mozilla-firefox.html">Firefox</a> had some trouble restoring the gargantuan tab load initially, but Hazel was able to revive the vast digital collection via the browser's profile cache functionality.</p>
<p>"I feel like a part of me is restored," Hazel wrote on X after getting her 7,000+ tabs back from the great digital beyond. We've all felt that little pang of anxiety when our browser crashes with tons of tabs we've been meaning to get back to, so we get it.</p>
<p>But what's the deal with Hazel's extreme browser usage? In her words, the memory impact of running that many Firefox tabs is actually "marginal." The session file containing all 7,470 tabs is only around 70MB in size, and Firefox optimizes things by only loading tabs into memory if they've been opened recently.</p>
<blockquote data-lazy-function="loadTwitter">
<p dir="ltr" lang="en">thank you to everyone who provided info on how to restore an old session from the profiles cache... i feel like a part of me is restored <a href="https://t.co/IGNGIrNfHB">pic.twitter.com/IGNGIrNfHB</a></p> 
– hazelâÂÂï¸Â (@sodiumPen) <a href="https://twitter.com/sodiumPen/status/1785302403039764665?ref_src=twsrc%5Etfw">April 30, 2024</a></blockquote>
<p>This aligns with what Mozilla told <a href="https://www.pcmag.com/news/firefox-power-user-keeps-7400-plus-browser-tabs-open-for-2-years">PCMag</a> about the browser's ability to handle extreme tab hoarding. A Mozilla representative confirmed that having countless tabs open consumes "practically no memory whatsoever" in Firefox.</p>
<p>"We're working hard to provide people with even better tools for managing dozens to thousands of tabs," the Mozilla spokesperson said. "While we think it's amazing that anyone has 7,000 active tabs, it also shows the degree to which tab management is a common problem."</p>
<p>Indeed, <a href="https://www.techspot.com/news/86510-tab-groups-chrome-ready-make-browser-nice-tidy.html">tab groups</a> have been a highly requested Firefox feature for years now. If it had that functionality, users like Hazel could easily group together all 7,500 of their open tabs, minimize the group, and temporarily pretend that massive tab debt doesn't exist – at least until they need to dive back in.</p>
<p>Currently, Firefox users can create different user profiles to segregate workflows and open tab sets, but more granular tab organization is on the way. Mozilla says it will roll out an improved profiles system and new tab management capabilities later in 2024.</p>
<p>In the meantime, there are third-party Firefox <a href="https://addons.mozilla.org/en-US/firefox/addon/simple-tab-groups/">add-ons</a> that can help tame tab situations like these to a certain extent.</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Cortex A73's Not-So-Infinite Reordering Capacity (167 pts)]]></title>
            <link>https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/</link>
            <guid>41156474</guid>
            <pubDate>Sun, 04 Aug 2024 21:30:00 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/">https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/</a>, See on <a href="https://news.ycombinator.com/item?id=41156474">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>Cortex A73 aimed to address the power and thermal issues that prevented Arm’s early 64-bit cores from reaching their full potential. It started a trend that saw Arm successfully capture the smartphone CPU market, and did so by emphasizing efficiency. Part of this effort appears to be a unique out-of-order retirement mechanism.</p>
<div>
<figure><a href="https://chipsandcheese.com/?attachment_id=30612"><img decoding="async" width="688" height="458" data-attachment-id="30612" data-permalink="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/lol_0720/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?fit=4609%2C3068&amp;ssl=1" data-orig-size="4609,3068" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;11&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D850&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1722692202&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;105&quot;,&quot;iso&quot;:&quot;64&quot;,&quot;shutter_speed&quot;:&quot;8&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="LOL_0720" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?fit=2163%2C1440&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?fit=688%2C458&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=688%2C458&amp;ssl=1" alt="" srcset="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=3245%2C2160&amp;ssl=1 3245w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=768%2C511&amp;ssl=1 768w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=1536%2C1022&amp;ssl=1 1536w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=2048%2C1363&amp;ssl=1 2048w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=1200%2C799&amp;ssl=1 1200w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=1600%2C1065&amp;ssl=1 1600w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?resize=1320%2C879&amp;ssl=1 1320w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0720.jpg?w=1376&amp;ssl=1 1376w" sizes="(max-width: 688px) 100vw, 688px" data-recalc-dims="1"></a><figcaption>One of the DDR4 chips feeding the Amlogic S922X’s four A73 cores (and other on-chip stuff). Out-of-order execution tries to mitigate the impact of memory access latency</figcaption></figure></div>
<p>This feature frustrated my prior attempts to dig into A73’s architecture. <a href="https://blog.stuffedcow.net/2013/05/measuring-rob-capacity/">Henry Wong’s methodology</a> for measuring structure sizes largely didn’t work except for scheduling capacity. muffiny_mcmuffinface on Discord suggested blocking retirement with an unresolved branch, and that did the trick.</p>
<h2>Out-of-Order Retire</h2>
<p>With conventional out-of-order execution, an in-order frontend brings instructions into the core. The rename/allocate stage assigns backend resources to the instruction. Then the backend calculates results for those instructions without waiting to know whether the instructions actually need to be executed. These speculative results are contained in various internal core structures until they’re known to be good. Register values are held in the speculative portion of renamed register files, and values to be written out to memory are held in a store buffer. Finally, instructions can be retired (leave the core) when they have passed all checks, and all instructions before it have also passed their checks. On retirement, register values are made program-visible and pending store data is written out to the memory hierarchy. Retirement also frees entries from internal core structures, making them available for newer incoming instructions. Therefore, how far a CPU can move past a stalled instruction is limited by how many entries it has in internal structures like register files, load/store buffers, and so on.</p>
<p>In-order retirement is a straightforward way to preserve the illusion of in-order execution, which programs and operating systems expect. If something funny happens, like a program accessing virtual memory that doesn’t have corresponding physical memory mapped, the operating system expects to handle that “exception” with program state preserved right as it was before the offending instruction would be executed. Preserving that state lets the operating system fix the issue, for example by paging to disk, and resume the program as if nothing had happened.</p>
<div>
<figure><a href="https://chipsandcheese.com/?attachment_id=30557"><img decoding="async" width="667" height="557" data-attachment-id="30557" data-permalink="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/a73_testing/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_testing.png?fit=667%2C557&amp;ssl=1" data-orig-size="667,557" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73_testing" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_testing.png?fit=667%2C557&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_testing.png?fit=667%2C557&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_testing.png?resize=667%2C557&amp;ssl=1" alt="" data-recalc-dims="1"></a></figure></div>
<p>A CPU’s backend can accomplish this by discarding (not retiring) all instructions after the one that hit an exception. It can then show known-good state at the exact point of the exception. If a CPU designer got smart and tried to retire an instruction out-of-order, the core could find itself in an unrecoverable state if an earlier instruction hits an exception. But A73 can do exactly that in certain cases, and at least one of those cases is an incomplete load. I suspect A73 can determine when a load is guaranteed to complete successfully. If address translation competes and access checks against the page table entry are good, there shouldn’t be anything causing the load to fail short of a catastrophic memory subsystem failure. </p>
<div>
<figure><a href="https://chipsandcheese.com/?attachment_id=30563"><img decoding="async" width="688" height="356" data-attachment-id="30563" data-permalink="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/a73_intrf/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_intrf.png?fit=776%2C402&amp;ssl=1" data-orig-size="776,402" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73_intrf" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_intrf.png?fit=776%2C402&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_intrf.png?fit=688%2C356&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_intrf.png?resize=688%2C356&amp;ssl=1" alt="" srcset="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_intrf.png?w=776&amp;ssl=1 776w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_intrf.png?resize=768%2C398&amp;ssl=1 768w" sizes="(max-width: 688px) 100vw, 688px" data-recalc-dims="1"></a><figcaption>Works like a charm. That’s 40 integer registers allocated to store results before A73 can no longer extract further instruction level parallelism</figcaption></figure></div>
<p>In that case, A73 can start retiring instructions ahead of the incomplete load, secure in the knowledge that the results it’s committing early won’t have to be thrown out. However, A73 can’t do so past an incomplete branch because it doesn’t know if it predicted that branch correctly. A branch mispredict doesn’t require any attention from software, but the core needs to preserve results from instructions before the branch in order to recover. Therefore, Henry Wong’s methodology can be modified for A73 by adding a branch dependent on the cache miss. To keep mispredictions from influencing results, the branch is never taken.</p>
<h2>Working with a Shoestring Power and Area Budget</h2>
<p>This modified methodology shows substantial shrinks to most core stuctures compared to A73’s predecessors.</p>
<div>
<figure><a href="https://chipsandcheese.com/a73-drawio-1/"><img loading="lazy" decoding="async" width="688" height="679" data-attachment-id="30561" data-permalink="https://chipsandcheese.com/a73-drawio-1/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73.drawio-1.png?fit=882%2C870&amp;ssl=1" data-orig-size="882,870" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73.drawio-1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73.drawio-1.png?fit=882%2C870&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73.drawio-1.png?fit=688%2C679&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73.drawio-1.png?resize=688%2C679&amp;ssl=1" alt="" srcset="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73.drawio-1.png?w=882&amp;ssl=1 882w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73.drawio-1.png?resize=768%2C758&amp;ssl=1 768w" sizes="(max-width: 688px) 100vw, 688px" data-recalc-dims="1"></a></figure></div>
<h3>Register Files</h3>
<p>On A57, register file entries were 32 bits wide to make register file storage go as far as possible. I suspect those early 64-bit Arm cores were expected to handle a lot of 32-bit code, and wasting the upper half of a 64-bit register wasn’t ideal. 64-bit integer registers and 128-bit vectors were handled by allocating multiple 32-bit registers. A72 made register file entries 64-bits wide and improved FMA performance, which would require more register file storage and more ports.</p>
<blockquote>
<p>Register file area is mostly limited by the width and number of access ports, and not so much the number of storage cells per entry</p>
<p>Kai Troester, AMD at Hot Chips 2023</p>
</blockquote>
<p>A73 ditches that approach in favor of separate integer and floating point register files. The integer register file has 64-bit entries, with 41 available for speculative results. FP/vector registers are 128-bits wide, with 38 entries available for speculative results. Dedicated register files allow lower port counts from each register file. When building Zen 4’s FP/vector register file, AMD was able to use 512-bit entries with minimal area growth because port count and width had a larger influence register file area than the width of each entry. Arm likely made a similar observation with A73. A unified register file with small entries would make the most of storage cell capacity, but that was the wrong way to go for area efficiency. It was probably the wrong way to go for power efficiency too.</p>
<div>
<figure><a href="https://chipsandcheese.com/a73_rf/"><img loading="lazy" decoding="async" width="638" height="364" data-attachment-id="30566" data-permalink="https://chipsandcheese.com/a73_rf/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_rf.png?fit=638%2C364&amp;ssl=1" data-orig-size="638,364" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73_rf" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_rf.png?fit=638%2C364&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_rf.png?fit=638%2C364&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_rf.png?resize=638%2C364&amp;ssl=1" alt="" data-recalc-dims="1"></a></figure></div>
<p>Cortex A72 had a comparatively high number of execution ports, all of which required inputs from one register file. Certainly there are techniques to prevent power and area from exploding like using two duplicate copies of the register file to increase read port count, but it’s impossible figure out details like that from software.</p>
<p>Besides being more area efficient, A73’s register file setup can give it an advantage in vector code. 35 vector register file entries are available for 128-bit results, compared to 31 on A72. A73’s advantage should be even more significant in practice because scalar integer and vector operations won’t contend for capacity in the same register file. </p>
<p>However, A73 can’t perfectly allocate all entries across both register files, and caps out at 66 in-flight instructions with an even mix of operations that write to scalar and vector registers. Other CPUs have similar limitations. Intel CPUs have a “<a href="https://stackoverflow.com/questions/60264057/what-resource-stall-other-might-mean">Physical Register Reclaim Tabl</a>e” that tracks which register should be freed when an instruction retires. Lack of entries in that structure can cause a stall before all register file entries are exhausted. A73 may have a similar structure.</p>
<h3>Memory Accesses, and Branches?</h3>
<p>A73 can have 50 in-flight loads, which is massive compared to its other structures. In fact, 50 in-flight loads can only be achieved by using both integer and vector destination registers. Otherwise, reordering capacity will be limited by how much register file capacity you can reserve to hold loaded data. This is a substantial improvement over A72’s 32 entry load queue, and is unlikely to be a relevant limitation in practice.</p>
<p>Stores are a different story. Cortex A73 can only have 11 in-flight stores after an unresolved branch, a regression from A72’s already small 15 entry store queue. Curiously, independent branches appear to share the same 11 entry resource. If this resource fills, subsequent branches can’t get into the core even if scheduler capacity is available. That creates a funny situation where A73 can have more incomplete branches in flight than complete ones.</p>
<div>
<figure><a href="https://chipsandcheese.com/?attachment_id=30602"><img loading="lazy" decoding="async" width="688" height="303" data-attachment-id="30602" data-permalink="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/a73_branches_stores/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_branches_stores.png?fit=1093%2C482&amp;ssl=1" data-orig-size="1093,482" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73_branches_stores" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_branches_stores.png?fit=1093%2C482&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_branches_stores.png?fit=688%2C303&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_branches_stores.png?resize=688%2C303&amp;ssl=1" alt="" srcset="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_branches_stores.png?w=1093&amp;ssl=1 1093w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_branches_stores.png?resize=768%2C339&amp;ssl=1 768w" sizes="(max-width: 688px) 100vw, 688px" data-recalc-dims="1"></a></figure></div>
<p>Perhaps stores and branches need to reserve at least one slot in some kind of 11 entry verification queue. If a slot isn’t available, the incoming instruction can’t enter the backend even if a scheduler entry is free. Branches and stores both need extra care before their results can be committed. Branches can be mispredicted. Committing a store means writing its data to cache, making it visible to other cores. Whatever the case, this 11 entry buffer is likely a very hot structure. Capacity is low even if it’s only used by stores. Branches will further increase pressure on those 11 entries.</p>
<h3>Memory Ordering Woes</h3>
<p>Stores cause another problem for A73 besides taking up valuable space in a small structure. A73 doesn’t have a way to speculate whether a load will be dependent on a prior in-flight store. That means loads can’t be executed until all prior store addresses are known.</p>
<p>Memory dependence prediction isn’t new. Intel’s first implementation was in the 2006-era Core 2, while AMD did so in 2011 with Bulldozer. It’s a huge advantage because most loads don’t overlap with a prior store. Loads that miss cache are among the highest latency instructions a CPU will have to deal with. A73’s inability to do memory dependence speculation will cause loads to be delayed even when that delay isn’t needed to ensure memory operations execute in the right order. That in turn will put more pressure on the core’s limited reordering capacity.</p>
<h3>No ROB-Like Structure?</h3>
<p>Most out-of-order CPUs use a reorder buffer (ROB) to ensure in-order retirement. The ROB is a list of in-flight instructions being tracked in the backend, and is kept in program order. Reordering capacity can be capped by the ROB’s size if no other resources are exhausted first.</p>
<p>A73 doesn’t appear to have such a structure. NOPs are a good way of finding ROB capacity because they don’t take space in the register file, load/store queues, or other more specific resources. They’re just an instruction that does nothing, taking up a ROB slot. But NOPs have basically infinite reordering capacity even past an unresolved branch.</p>
<figure><img loading="lazy" decoding="async" width="612" height="362" data-attachment-id="30609" data-permalink="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/a73_norob/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_norob.png?fit=612%2C362&amp;ssl=1" data-orig-size="612,362" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73_norob" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_norob.png?fit=612%2C362&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_norob.png?fit=612%2C362&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_norob.png?resize=612%2C362&amp;ssl=1" alt="" data-recalc-dims="1"></figure>
<p>I also extended Henry Wong’s technique of combining in-flight writes to the integer and FP register files by mixing stores in. At that point, A73 can track 76 in-flight instructions, showing that I’m not hitting a reordering capacity limit even when maxing out three separate underlying resources. There’s a practical limit of about 76 instructions with the store queue and register files utilized to their maximum capacity.</p>
<h2>Final Words</h2>
<p>Out-of-order retirement is part of Arm’s strategy to maintain good performance with smaller core structures. In a sense, it’s goal is similar to that of Skymont’s 16-wide retire stage. Both cores are trying to deallocate resources faster, letting them achieve a certain level of performance with smaller internal core structures. As mentioned in the prior article, that makes A73 a fascinating architecture.</p>
<div>
<figure><a href="https://chipsandcheese.com/?attachment_id=30614"><img loading="lazy" decoding="async" width="688" height="458" data-attachment-id="30614" data-permalink="https://chipsandcheese.com/2024/08/04/cortex-a73s-not-so-infinite-reordering-capacity/lol_0717/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?fit=4169%2C2775&amp;ssl=1" data-orig-size="4169,2775" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;2&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D850&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1722691972&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;50&quot;,&quot;iso&quot;:&quot;64&quot;,&quot;shutter_speed&quot;:&quot;0.5&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="LOL_0717" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?fit=2163%2C1440&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?fit=688%2C458&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=688%2C458&amp;ssl=1" alt="" srcset="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=3245%2C2160&amp;ssl=1 3245w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=768%2C511&amp;ssl=1 768w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=1536%2C1022&amp;ssl=1 1536w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=2048%2C1363&amp;ssl=1 2048w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=1200%2C799&amp;ssl=1 1200w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=1600%2C1065&amp;ssl=1 1600w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?resize=1320%2C879&amp;ssl=1 1320w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/LOL_0717.jpg?w=1376&amp;ssl=1 1376w" sizes="(max-width: 688px) 100vw, 688px" data-recalc-dims="1"></a><figcaption>Single board computer used to test A73</figcaption></figure></div>
<p>But when A73 has to lean on its core structures, it’s often at a disadvantage compared to A72 or A57. The question then is whether out-of-order retirement is effective enough to keep A73’s performance competitive. Certainly in some cases, A73’s strategy works well and gets it very close to A57. That’s an impressive feat considering how much smaller A73’s structures are in certain places. libx264 encoding is an example of this. Other cases aren’t so clear though, and file compression is a counterexample.</p>
<div>
<figure><a href="https://chipsandcheese.com/a73_a57_ipc-1/"><img loading="lazy" decoding="async" width="688" height="396" data-attachment-id="30584" data-permalink="https://chipsandcheese.com/a73_a57_ipc-1/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_a57_ipc-1.png?fit=940%2C541&amp;ssl=1" data-orig-size="940,541" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a73_a57_ipc-1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_a57_ipc-1.png?fit=940%2C541&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_a57_ipc-1.png?fit=688%2C396&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_a57_ipc-1.png?resize=688%2C396&amp;ssl=1" alt="" srcset="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_a57_ipc-1.png?w=940&amp;ssl=1 940w, https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2024/08/a73_a57_ipc-1.png?resize=768%2C442&amp;ssl=1 768w" sizes="(max-width: 688px) 100vw, 688px" data-recalc-dims="1"></a></figure></div>
<p>But IPC is only part of the picture. It’s all too easy to tunnel vision on IPC and lose sight of the forest. Clock speed matters, and A73’s lower power draw lets it reach higher clock speeds than A57. The Amlogic S922’s four A73 cores run at 2.2 GHz and can stay there with passive cooling. The Tegra X1’s four A57 cores run at 1.8 GHz, and don’t go faster even though the Nintendo Switch has active cooling.</p>
<div>
<figure><a href="https://chipsandcheese.com/2023/12/12/cortex-a57-nintendo-switchs-cpu/a57_minibench-1/"><img loading="lazy" decoding="async" width="480" height="288" data-attachment-id="24510" data-permalink="https://chipsandcheese.com/2023/12/12/cortex-a57-nintendo-switchs-cpu/a57_minibench-1/" data-orig-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2023/12/a57_minibench-1.png?fit=480%2C288&amp;ssl=1" data-orig-size="480,288" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="a57_minibench-1" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2023/12/a57_minibench-1.png?fit=480%2C288&amp;ssl=1" data-large-file="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2023/12/a57_minibench-1.png?fit=480%2C288&amp;ssl=1" tabindex="0" role="button" src="https://i0.wp.com/chipsandcheese.com/wp-content/uploads/2023/12/a57_minibench-1.png?resize=480%2C288&amp;ssl=1" alt="" data-recalc-dims="1"></a><figcaption>Actual performance is very close</figcaption></figure></div>
<p>Thus A73 is able to provide comparable performance at lower power. It does so by running a smaller, narrower core at higher clocks. A73 is a reminder that building a higher IPC architecture is not always the best way to go. The same applies to targeting higher clock speeds. Both strategies can do well, and both can fail depending on how well engineers balance the core for the applications it has to serve.</p>
<p>If you like our articles and journalism, and you want to support us in our endeavors, then consider heading over to our&nbsp;<a href="https://www.patreon.com/ChipsandCheese">Patreon</a>&nbsp;or our&nbsp;<a href="https://www.paypal.com/donate/?hosted_button_id=4EMPH66SBGVSQ">PayPal</a>&nbsp;if you want to toss a few bucks our way. If you would like to talk with the Chips and Cheese staff and the people behind the scenes, then consider joining our&nbsp;<a href="https://discord.gg/TwVnRhxgY2">Discord</a>.</p>

<div data-post_id="10949" data-instance_id="1" data-additional_class="pp-multiple-authors-layout-boxed.multiple-authors-target-the-content" data-original_class="pp-multiple-authors-boxes-wrapper pp-multiple-authors-wrapper box-post-id-10949 box-instance-id-1">
<p><span>
<ul>
<li>
<div>
<p><img alt="clamchowder" src="https://secure.gravatar.com/avatar/7c39d2e6d35e77c8fd15c4b2d9ce4e64?s=80&amp;d=identicon&amp;r=g" srcset="https://secure.gravatar.com/avatar/7c39d2e6d35e77c8fd15c4b2d9ce4e64?s=160&amp;d=identicon&amp;r=g 2x" height="80" width="80"> </p>
</div>

</li>
</ul>
</span>
</p></div>





</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Qub – a framework for building websites with QBasic (101 pts)]]></title>
            <link>https://github.com/jamonholmgren/qub</link>
            <guid>41156222</guid>
            <pubDate>Sun, 04 Aug 2024 20:46:15 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/jamonholmgren/qub">https://github.com/jamonholmgren/qub</a>, See on <a href="https://news.ycombinator.com/item?id=41156222">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">Qub -- QBasic Website Generator</h2><a id="user-content-qub----qbasic-website-generator" aria-label="Permalink: Qub -- QBasic Website Generator" href="#qub----qbasic-website-generator"></a></p>
<p dir="auto">Qub (pronounced "cube") is a CLI that generates a web server and framework for building websites in <a href="https://qb64.com/" rel="nofollow">QB64</a> -- a more modern variant of QBasic.</p>
<markdown-accessiblity-table></markdown-accessiblity-table>
<p dir="auto"><h2 tabindex="-1" dir="auto">Getting started</h2><a id="user-content-getting-started" aria-label="Permalink: Getting started" href="#getting-started"></a></p>
<p dir="auto"><em>(Note: macOS &amp; Linux only)</em></p>
<p dir="auto">To get started, set up your <code>qub</code> alias first. This is the quick &amp; easy way:</p>
<div data-snippet-clipboard-copy-content="alias qub=&quot;source <(curl -sSL https://raw.githubusercontent.com/jamonholmgren/qub/main/src/cli.sh)&quot;"><pre><code>alias qub="source &lt;(curl -sSL https://raw.githubusercontent.com/jamonholmgren/qub/main/src/cli.sh)"
</code></pre></div>
<p dir="auto">However, some are understandably uncomfortable with running a script directly from the internet. If you'd like to run it locally, here's how:</p>
<details>
<summary><strong>Manual setup</strong></summary>
Download it:
<div data-snippet-clipboard-copy-content="curl -sSL https://raw.githubusercontent.com/jamonholmgren/qub/main/src/cli.sh > ./qub.sh"><pre><code>curl -sSL https://raw.githubusercontent.com/jamonholmgren/qub/main/src/cli.sh &gt; ./qub.sh
</code></pre></div>
<p dir="auto">Open the <code>qub.sh</code> file in your editor and review it. If you're comfortable with what it's doing, alias it:</p>
<div data-snippet-clipboard-copy-content="alias qub=&quot;source $PWD/qub.sh&quot;"><pre><code>alias qub="source $PWD/qub.sh"
</code></pre></div>
</details>
<p dir="auto">Now, you should be able to run the CLI:</p>
<div data-snippet-clipboard-copy-content="qub
qub --version
qub --help
qub create
qub update"><pre><code>qub
qub --version
qub --help
qub create
qub update
</code></pre></div>
<p dir="auto"><em><strong>Windows Support:</strong> Qub has only been tested on macOS and Linux. It might work on Windows WSL (Windows Subsystem for Linux) or Git Bash on Windows. If you want to help test and make it run on Windows, please open an issue or PR!</em></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Creating a website</h2><a id="user-content-creating-a-website" aria-label="Permalink: Creating a website" href="#creating-a-website"></a></p>
<p dir="auto">To create a website, run <code>qub create</code> and follow the prompts:</p>

<p dir="auto">It'll ask you for your domain name (e.g. jamon.dev) which doubles as your project's folder name. It will also ask if you want to install QB64 (I recommend you do).</p>
<p dir="auto">When done, you can CD into the new folder and run <code>./bin/build</code> to build the website. Then, run <code>./server</code> to start the web server. Visit <a href="http://localhost:6464/" rel="nofollow">http://localhost:6464/</a> to view the website.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Modifying your website</h2><a id="user-content-modifying-your-website" aria-label="Permalink: Modifying your website" href="#modifying-your-website"></a></p>
<p dir="auto">Your new website has the following folder structure:</p>
<div data-snippet-clipboard-copy-content="bin
qub
  server.bas
  qub.conf
web
  pages
    home.html
    contact.html
  static
    scripts.js
    styles.css
  layout.html
README.md"><pre><code>bin
qub
  server.bas
  qub.conf
web
  pages
    home.html
    contact.html
  static
    scripts.js
    styles.css
  layout.html
README.md
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">qub/server.bas</h3><a id="user-content-qubserverbas" aria-label="Permalink: qub/server.bas" href="#qubserverbas"></a></p>
<p dir="auto">This is the Qub web server. You can periodically update it by running <code>qub update</code>. Note this will blow away any modifications you've made, so be careful!</p>
<p dir="auto">Qub's web server was originally based on <a href="https://github.com/smokingwheels/Yacy_front_end">Yacy</a> by SmokingWheels, but has been heavily modified since. It comes with a number of features:</p>
<ul>
<li> Page routing (e.g. jamon.dev/links renders web/pages/links.html)</li>
<li> Individual header and footer and  support</li>
<li> Static file serving (css, js, etc)</li>
<li> Binary file serving (images, fonts, etc)</li>
<li> Custom 404 page support</li>
<li> Basic dynamic variable support (e.g. <code>&lt;!--$YEAR--&gt;</code> in web/layout.html, etc)</li>
<li> Custom port support (via ./qub.conf)</li>
<li> Customizable dynamic variable support (coming soon)</li>
<li> 301 redirects support (coming soon)</li>
<li> Custom 500 page support (coming soon)</li>
<li> More customizable templating support (coming soon)</li>
</ul>
<p dir="auto">It does not (and probably won't) support HTTPS or HTTP2. I recommend putting CloudFlare in front of it in production (more in the <a href="#deploy-guide">deploy guide</a> below).</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Common included files</h3><a id="user-content-common-included-files" aria-label="Permalink: Common included files" href="#common-included-files"></a></p>
<p dir="auto">In the <code>web</code> folder, you'll find a layout.html file.</p>
<p dir="auto">This is the standard layout for your website, and includes your html's head and body sections,
with placeholder comments for dynamic content like what page is being rendered.</p>
<div dir="auto" data-snippet-clipboard-copy-content="<!DOCTYPE html>
<html>
  <head>
    <!-- other stuff -->
    <title><!--$TITLE--></title>
  </head>
  <body>
    <!-- whatever you want to wrap your page content with -->
    <!--$BODY-->
    <!-- footer content, etc -->
  </body>
</html>"><pre><span>&lt;!DOCTYPE html<span>&gt;</span></span>
<span>&lt;</span><span>html</span><span>&gt;</span>
  <span>&lt;</span><span>head</span><span>&gt;</span>
    <span>&lt;!-- other stuff --&gt;</span>
    <span>&lt;</span><span>title</span><span>&gt;</span><span>&lt;!--$TITLE--&gt;</span><span>&lt;/</span><span>title</span><span>&gt;</span>
  <span>&lt;/</span><span>head</span><span>&gt;</span>
  <span>&lt;</span><span>body</span><span>&gt;</span>
    <span>&lt;!-- whatever you want to wrap your page content with --&gt;</span>
    <span>&lt;!--$BODY--&gt;</span>
    <span>&lt;!-- footer content, etc --&gt;</span>
  <span>&lt;/</span><span>body</span><span>&gt;</span>
<span>&lt;/</span><span>html</span><span>&gt;</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">web/pages</h3><a id="user-content-webpages" aria-label="Permalink: web/pages" href="#webpages"></a></p>
<p dir="auto">This is where your website's pages go. Each page is an HTML file. You can add as many as you want, and they'll be routed automatically (minus the .html extension).</p>
<p dir="auto">So, for example, if you add <code>web/pages/links.html</code>, it will be available at <code>example.com/links</code>. If you add a folder it'll route to that as well, so <code>web/pages/blog/2023.html</code> will be available at <code>example.com/blog/2023</code>.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">web/static</h3><a id="user-content-webstatic" aria-label="Permalink: web/static" href="#webstatic"></a></p>
<p dir="auto">You'll put your static files here -- CSS, JS, images, fonts, etc. They'll be served at <code>example.com/static/</code> (e.g. <code>example.com/static/styles.css</code>). Any image files, fonts, PDFs, etc will be served as binary files (e.g. <code>example.com/static/logo.png</code>).</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">404.html</h3><a id="user-content-404html" aria-label="Permalink: 404.html" href="#404html"></a></p>
<p dir="auto">If you want to customize your 404 page, you can do so by editing <code>web/pages/404.html</code>. This is shown if the router is unable to find a page for the given URL. It'll also respond with the proper 404 status code.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Deploy Guide</h2><a id="user-content-deploy-guide" aria-label="Permalink: Deploy Guide" href="#deploy-guide"></a></p>
<p dir="auto">COMING SOON!</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">History</h2><a id="user-content-history" aria-label="Permalink: History" href="#history"></a></p>
<p dir="auto">When I was twelve, I built my first game in QBasic -- and kept building games and small apps (we called them "programs" in those days) for years. I have a lot of nostalgia and a special place in my heart for QBasic.</p>
<p dir="auto">A few years ago, I was talking about rebuilding my website in something different, just for a fun challenge, and my friend Mark Villacampa said <a href="https://twitter.com/MarkVillacampa/status/1594426506754801664" rel="nofollow">"do it in BASIC you coward!"</a>. I took on the challenge and built <a href="https://jamon.dev/" rel="nofollow">jamon.dev</a> in QB64.</p>
<p dir="auto">Once I had a working website, I realized that I wanted to make it easier for other people to build websites in QB64, so I started building Qub, aided by <a href="https://github.com/knewter">@knewter</a> who is another QBasic fan from way back.</p>
<p dir="auto">Qub is not particularly important to modern technology in the grand scheme of things, but it's been a blast to work on. I hope you enjoy it!</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Future</h2><a id="user-content-future" aria-label="Permalink: Future" href="#future"></a></p>
<p dir="auto">I'd love to build more QBasic-powered server capabilities. I'm still learning how to utilize QB64 -- for example, in old QBasic, you couldn't include external files, but in QB64 you can.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">TODO</h2><a id="user-content-todo" aria-label="Permalink: TODO" href="#todo"></a></p>
<ul>
<li> Make the default template look nicer, better template README</li>
<li> YouTube video on Jamon's Code Quests</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto">MIT -- see <a href="https://github.com/jamonholmgren/qub/blob/main/LICENSE">LICENSE</a> for details.</p>
<p dir="auto">QB64 is licensed under the <a href="https://github.com/QB64Official/qb64/blob/master/licenses/COPYING.TXT">MIT</a> license.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Puget Systems' Perspective on Intel CPU Instability Issues (171 pts)]]></title>
            <link>https://www.pugetsystems.com/blog/2024/08/02/puget-systems-perspective-on-intel-cpu-instability-issues/</link>
            <guid>41156104</guid>
            <pubDate>Sun, 04 Aug 2024 20:27:50 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.pugetsystems.com/blog/2024/08/02/puget-systems-perspective-on-intel-cpu-instability-issues/">https://www.pugetsystems.com/blog/2024/08/02/puget-systems-perspective-on-intel-cpu-instability-issues/</a>, See on <a href="https://news.ycombinator.com/item?id=41156104">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-29233">

<div id="content" tabindex="-1">
<p>You may have heard about instability issues with Intel Core 13th and 14th Gen desktop processors. The issue has attracted more attention as time goes on. I am posting to share what we’ve experienced here at Puget Systems and what we’re doing about it.</p>
<p>The issue gained attention over the past three months, led by <a href="https://www.youtube.com/watch?v=si4DTxFUUvM&amp;t=67s">GamersNexus</a>, <a href="https://www.youtube.com/watch?v=QzHcrbT5D_Y">Level1Techs</a>, and others. Details were vague at first because the issue tended to surface only over time. Early on it looked like it was related to motherboard power management, making it uncertain whether it was a motherboard issue, an Intel issue, or both. As time went on and more information and speculation developed, the issue became particularly alarming because it seemed to represent a physical degradation of the processor, which is not recoverable. The concern is not only with the nature of the instability, but the incident rate. Some game development studios and cloud gaming providers have come forward with concerning failure rates upwards of 50%.</p>
<p>Last week, Intel posted an <a href="https://community.intel.com/t5/Processors/July-2024-Update-on-Instability-Reports-on-Intel-Core-13th-and/m-p/1617113">official statement</a>, in which they shared that elevated voltage requests to the processor was a significant factor, and that a microcode patch would be delivered once validated, with mid-August as the target release date. Intel did not officially address the physical degradation issue, but the general community consensus is that the microcode update is expected to prevent, but not reverse, that degradation.</p>
<h2 id="h-how-puget-systems-is-unique">How Puget Systems is Unique</h2>
<p>At Puget Systems, we HAVE seen the issue, but our experience has been much more muted in terms of timeline and failure rate. In order to answer why, I have to give a little bit of history. </p>
<p>Going all the way back to 2017, with the Intel 8700K processor, we published an article titled <a href="https://www.pugetsystems.com/blog/2017/10/07/Why-Do-Hardware-Reviewers-Get-Different-Benchmark-Results-1058/">Why Do Hardware Reviewers Get Different Benchmark Results?</a> which helped call attention to the fact that motherboards were shipping with “Multicore Enhancement” enabled, which set the CPU “All Core Turbo” to be equal to the “Single Core Turbo” frequency. This essentially was overclocking the CPU, by pushing it past official Intel specifications, and had negative effects on stability and temperatures. At Puget Systems, we have always valued stability first and we actively made the choice to follow Intel specifications. Behind the scenes, this meant encouraging Intel to make those specifications public on <a href="https://ark.intel.com/content/www/us/en/ark.html#@PanelLabel122139">Intel ARK</a> and pushing motherboard ODMs to follow Intel guidance as their default settings. <a href="https://www.youtube.com/watch?v=zi-zU2p2ykc">JayzTwoCents</a> helped drive public awareness of the issue, and for a short time it appeared that things were back on track.</p>
<p>Since that time, our stance at Puget Systems has been to mistrust the default settings on any motherboard. Instead, we commit internally to test and apply BIOS settings — <em>especially </em>power settings — according to our own best practices, with an emphasis on following Intel and AMD guidelines. With Intel Core CPUs in particular, we pay close attention to voltage levels and time durations at which those levels are sustained. This has been especially challenging when those guidelines are difficult to find and when motherboard makers brand features with their own unique naming. </p>
<p>Nevertheless, we kept that approach with confidence due to the high amount of real-world testing we do here. We’ve even developed our own suite of <a href="https://www.pugetsystems.com/pugetbench/">PugetBench Benchmarks</a>, whose goal is to test real-world scenarios, guided by years of experience and learning through our customers and partners. Our approach has always led us to be conservative with our power settings, especially when <a href="https://www.pugetsystems.com/labs/articles/power-draw-and-cooling-14th-gen-intel-core-processors/">we have shown</a> that the real-world performance impact to be a small 1-2% range.</p>
<h2 id="h-puget-systems-intel-core-failure-rates">Puget Systems Intel Core Failure Rates</h2>
<p>So, with that understanding of WHY we may be seeing things differently than others in the industry — what ARE we seeing here at Puget Systems?</p>
<figure><img decoding="async" width="1024" height="481" src="https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Generation-1024x481.png" alt="" srcset="https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Generation-1024x481.png 1024w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Generation-300x141.png 300w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Generation-768x360.png 768w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Generation.png 1142w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>
<p>Even though failure rates (as a percentage) are the most consequential, I think showing the absolute number of failures illustrates our experience best. I decided to go back all the way to the launch of Intel Core 10th Gen to give some historical perspective. Starting with 10th Gen, we have only sold the top 2 SKUs (XX700K and XX900K) in volume, which gives us a nice clean set of data.</p>
<p>Looking at that chart, you’ll notice a few things. First, your attention undoubtedly is drawn to the recent spike of failures with Intel Core 14th Gen. Second, you can see that Intel Core 11th Gen CPUs had a failure rate at nearly the same level, even though it didn’t get as much press at that time, that I can recall. Third, I’ll draw your attention to a steady and elevated failure rate on 13th Gen processors.</p>
<p>I can also plot this same data, but instead of coloring it by CPU generation, I’ll color it based on whether we caught the issue on our production floor (shop failure), or if the issue made it out to the customer (field failure). Obviously, a field failure is dramatically more severe of a problem because it now impacts our customer experience.</p>
<figure><img decoding="async" width="1024" height="481" src="https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Type-1024x481.png" alt="" srcset="https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Type-1024x481.png 1024w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Type-300x141.png 300w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Type-768x360.png 768w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-Core-CPU-Failures-Per-Month-and-Type.png 1142w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>
<p>The most concerning part of all of this to us here at Puget Systems is the rise in the number of failures in the field, which we haven’t seen this high since 11th Gen. We’re seeing ALL of these failures happen after 6 months, which means we do expect elevated failure rates to continue for the foreseeable future and possibly even after Intel issues the microcode patch.</p>
<p>Based on this information, we are <strong>definitely </strong>experiencing CPU failures higher than our historical average, especially with 14th Gen. We have enough data to know that we don’t have an acute problem on the horizon with 13th Gen — it is more of a slow burn. We do expect an elevated failure rate on 14th Gen while Intel finishes finding a root cause and issuing a microcode update. While the number of failures we are experiencing is definitely higher than our historical average, it is difficult to classify 5-7 failures a month in the field as a huge issue, and it is definitely a lower rate of failure than we are hearing about from others in the industry. The recent spike in 14th Gen failure rates stands out mostly because how incredibly low historical CPU failure rates tend to be.</p>
<p>We believe that our commitment to internally developed power settings is why we have been much less impacted than others by these Intel stability issues. This is shaping our approach over the coming months.</p>
<h2 id="h-failure-rates-in-context">Failure Rates in Context</h2>
<p>Everything I’ve shown you so far is our raw number of failures, but what matters most is failure rate percentages. Let’s look at total failure rates in the context of multiple generations and with comparison to AMD Ryzen CPUs.</p>
<figure><img loading="lazy" decoding="async" width="1024" height="454" src="https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-CPU-Failure-Totals-by-Group-1024x454.png" alt="" srcset="https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-CPU-Failure-Totals-by-Group-1024x454.png 1024w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-CPU-Failure-Totals-by-Group-300x133.png 300w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-CPU-Failure-Totals-by-Group-768x341.png 768w, https://www.pugetsystems.com/wp-content/uploads/2024/07/Puget-Systems-Intel-CPU-Failure-Totals-by-Group.png 1350w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>
<p>You can see that in context, the Intel Core 13th and 14th Gen processors do have an elevated failure rate but not at a show-stopper level. The concern for the future reliability of those CPUs is much more the issue at hand, rather than the failure rates we are seeing today. If it is true that the 14th Gen CPUs will continue to have increasing failures over time, this could end up being a much bigger problem as time goes by and is something we will, of course, be keeping a close eye on. 14th Gen isn’t as rock solid as Intel’s 10th or 12th Gen processors, but at least for us, it isn’t yet at critical levels.</p>
<p>Based on the failure rate data we currently have, it is interesting to see that 14th Gen is still nowhere near the failure rates of the Intel Core 11th Gen processors back in 2021 and also substantially lower than AMD Ryzen 5000 (both in terms of shop and field failures) or Ryzen 7000 (in terms of shop failures, if not field). We aren’t including AMD here to try to deflect from the issues Intel is currently experiencing but rather to put into context why we have not yet adjusted our Intel vs. AMD strategy in our workstations.</p>
<h2 id="h-our-plan-of-action">Our Plan of Action</h2>
<p>Even if we are not seeing the same level of failures as others, this is a real issue that we are addressing internally. But what exactly are we doing about it?</p>
<ol>
<li><strong>In the majority of cases, we are staying the course for now.</strong> Various BIOS updates have been launched by motherboard manufacturers to provide more conservative power settings, but in our opinion, they don’t quite hit the mark. They are either too conservative in some places (leading to unacceptable loss in performance) or they are not conservative enough. We trust our internally developed settings more. We also are concerned with the rise in failure rate, but it is not at a level of severity that changes our CPU recommendations for our customer workflows.</li>
<li><strong>We will immediately validate the Intel microcode update when it is released.</strong> We will start with internal testing for stability and performance. If it passes that testing, we will begin using it on our shipping configurations as soon as possible.</li>
<li><strong>We will contact all our affected customers to provide the Intel microcode update.</strong> We will do this after gaining some internal experience and confidence with the update, and have developed detailed guides on how to install it while preserving our recommended BIOS settings.</li>
<li><strong>We are extending our warranty to 3 years for all customers affected by this issue, regardless of warranty purchased.</strong> With a Puget Systems PC, you should be able to count on it working for you. If we no longer have supply of 13th or 14th Gen processors, we’ll upgrade you to a more current generation.</li>
</ol>
<p>We’ll all stay tuned together for Intel to release their microcode update in August. In the meantime if you have any questions or concerns, please reach out to <a href="https://www.pugetsystems.com/press/#h-contacts">me directly</a> or our <a href="https://www.pugetsystems.com/support/">support team</a>!</p>

</div>
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Enum class improvements for C++17, C++20 and C++23 (101 pts)]]></title>
            <link>https://www.cppstories.com/2024/enum-improvements/</link>
            <guid>41155996</guid>
            <pubDate>Sun, 04 Aug 2024 20:09:37 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.cppstories.com/2024/enum-improvements/">https://www.cppstories.com/2024/enum-improvements/</a>, See on <a href="https://news.ycombinator.com/item?id=41155996">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
          <p><img src="https://www.cppstories.com/2024/images/enum_improvements.png" alt=""></p><div>
        
        <p>Table of Contents</p>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#enum-class-recap">Enum Class Recap</a></li>
    <li><a href="#c17-initialization-with-brace-initialization-from-underlying-type">C++17: Initialization with Brace Initialization from Underlying Type</a></li>
    <li><a href="#c20-using-enum">C++20: Using Enum</a></li>
    <li><a href="#c23-stdto_underlying">C++23: <code>std::to_underlying</code></a></li>
    <li><a href="#future-improvements">Future improvements</a></li>
    <li><a href="#summary">Summary</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
        
                
        
      </div>                
        <p>The evolution of the C++ language continues to bring powerful features that enhance code safety, readability, and maintainability. Among these improvements, we got changes and additions to <code>enum class</code> functionalities across C++17, C++20, and C++23. In this blog post, we’ll explore these advancements, focusing on initialization improvements in C++17, the introduction of the <code>using enum</code> keyword in C++20, and the <code>std::to_underlying</code> utility in C++23.</p>
<p>Let’s go.</p>
<h2 id="enum-class-recap">
Enum Class Recap 
  
&nbsp;
    
</h2>

<p>Before diving into the enhancements, let’s briefly recap what <code>enum class</code> is. An <code>enum class</code> (scoped enumeration) provides a type-safe way of defining a set of named constants. Unlike traditional (unscoped) enums, <code>enum class</code> does not implicitly convert to integers or other types, preventing accidental misuse. Here’s a basic example:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>#include</span> <span>&lt;iostream&gt;</span><span>
</span></span></span><span><span><span></span>
</span></span><span><span><span>enum</span> <span>class</span> <span>Color</span> <span>{</span>
</span></span><span><span>    <span>Red</span><span>,</span>
</span></span><span><span>    <span>Green</span><span>,</span>
</span></span><span><span>    <span>Blue</span>
</span></span><span><span><span>};</span>
</span></span><span><span>
</span></span><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>    
</span></span><span><span>    <span>Color</span> <span>color</span> <span>=</span> <span>Color</span><span>::</span><span>Red</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>if</span> <span>(</span><span>color</span> <span>==</span> <span>Color</span><span>::</span><span>Red</span><span>)</span>
</span></span><span><span>        <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"The color is red.</span><span>\n</span><span>"</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>color</span> <span>=</span> <span>Color</span><span>::</span><span>Blue</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>if</span> <span>(</span><span>color</span> <span>==</span> <span>Color</span><span>::</span><span>Blue</span><span>)</span>
</span></span><span><span>        <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"The color is blue.</span><span>\n</span><span>"</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>// std::cout &lt;&lt; color; // error, no matching &lt;&lt; operator
</span></span></span><span><span><span></span>    <span>// int i = color;      // error: cannot convert
</span></span></span><span><span><span></span><span>}</span>
</span></span></code></pre></div><p>Run <a href="https://godbolt.org/z/c4P6n8z9Y">@Compiler Explorer</a></p>
<p>Notice the two lines near the end of the <code>main</code> function. You’ll get compiler errors as there’s no implicit conversion to integer types.</p>
<p>As a comparison here’s a similar example, but with unscoped enums:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>#include</span> <span>&lt;iostream&gt;</span><span>
</span></span></span><span><span><span></span>
</span></span><span><span><span>enum</span> <span>Color</span> <span>{</span>
</span></span><span><span>    <span>Red</span><span>,</span>
</span></span><span><span>    <span>Green</span><span>,</span>
</span></span><span><span>    <span>Blue</span>
</span></span><span><span><span>};</span>
</span></span><span><span>
</span></span><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>    
</span></span><span><span>    <span>Color</span> <span>color</span> <span>=</span> <span>Red</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>if</span> <span>(</span><span>color</span> <span>==</span> <span>Red</span><span>)</span>
</span></span><span><span>        <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"The color is red.</span><span>\n</span><span>"</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>color</span> <span>=</span> <span>Blue</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>if</span> <span>(</span><span>color</span> <span>==</span> <span>Blue</span><span>)</span>
</span></span><span><span>        <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"The color is blue.</span><span>\n</span><span>"</span><span>;</span>
</span></span><span><span>
</span></span><span><span>    <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>color</span><span>;</span> <span>// fine, prints integer value!
</span></span></span><span><span><span></span>    <span>int</span> <span>i</span> <span>=</span> <span>color</span><span>;</span>      <span>// fine, can convert...
</span></span></span><span><span><span></span><span>}</span>
</span></span></code></pre></div><p>Run <a href="https://godbolt.org/z/xaorMje9W">@Compiler Explorer</a></p>
<p>In short, while <code>enum classes</code> give us a separate scope for all of the enum values, they also enforce better type safety. There are no implicit conversions to integral values, and thus, you have better control over your design.</p>
<p>While the basics are simple, let’s now go to several improvements that are handy in the latest C++ revisions.</p>
<h2 id="c17-initialization-with-brace-initialization-from-underlying-type">
C++17: Initialization with Brace Initialization from Underlying Type 
  
&nbsp;
    
</h2>

<p>Enum class might sometimes feel too restrictive, and having some conversions might be handy:</p>
<p>In <a href="https://wg21.link/P0138R2">P0138</a> accepted for C++17 we have the following example:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>enum</span> <span>class</span> <span>Handle</span> <span>:</span> <span>uint32_t</span> <span>{</span> <span>Invalid</span> <span>=</span> <span>0</span> <span>};</span> 
</span></span><span><span><span>Handle</span> <span>h</span> <span>{</span> <span>42</span> <span>};</span> <span>// OK
</span></span></span></code></pre></div><p>In short, when you use <code>enum class</code> to define strong types, it’s helpful to allow initializing from the underlying type without any errors. This wasn’t possible before C++17.</p>
<p>However, the change was cautious so that enums are still safe - they can be used only for uniform/brace initialization. Have a look at this code:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>#include</span> <span>&lt;iostream&gt;</span><span>
</span></span></span><span><span><span></span>
</span></span><span><span><span>enum</span> <span>class</span> <span>Handle</span> <span>:</span> <span>uint32_t</span> <span>{</span> <span>Invalid</span> <span>=</span> <span>0</span> <span>};</span> 
</span></span><span><span>
</span></span><span><span><span>void</span> <span>process</span><span>(</span><span>Handle</span> <span>h</span><span>)</span> <span>{</span>
</span></span><span><span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>    
</span></span><span><span>    <span>Handle</span> <span>h</span> <span>{</span> <span>42</span> <span>};</span> <span>// OK
</span></span></span><span><span><span></span>
</span></span><span><span>    <span>// process({10}); // error
</span></span></span><span><span><span></span>    <span>process</span><span>(</span><span>Handle</span><span>{</span><span>10</span><span>});</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div><p>You cannot just pass <code>{10}</code> as the parameter for the <code>process</code> function. You still have to be explicit about the type.</p>
<p>In C++14, you could use <code>process(static_cast&lt;Handle&gt;(10));</code> so, as you can see, the C++17 version is much better.</p>
<h2 id="c20-using-enum">
C++20: Using Enum 
  
&nbsp;
    
</h2>

<p>C++20 introduced the <code>using enum</code> syntax, which enhances the usability of enums, particularly in contexts where scoped enums are preferred for their type safety. This feature allows you to bring all the enumerators of an enum into the current scope without losing the benefits of scoped enums.</p>
<p>Consider the following example:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>enum</span> <span>class</span> <span>ComputeStatus</span> <span>{</span>
</span></span><span><span>    <span>Ok</span><span>,</span>
</span></span><span><span>    <span>Error</span><span>,</span>
</span></span><span><span>    <span>FileError</span><span>,</span>
</span></span><span><span>    <span>NotEnoughMemory</span><span>,</span>
</span></span><span><span>    <span>TimeExceeded</span><span>,</span>
</span></span><span><span>    <span>Unknown</span>
</span></span><span><span><span>};</span>
</span></span></code></pre></div><p>In previous C++ versions, using these enumerators required qualifying them with the enum class name:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>ComputeStatus</span> <span>s</span> <span>=</span> <span>ComputeStatus</span><span>::</span><span>NotEnoughMemory</span><span>;</span>
</span></span></code></pre></div><p>C++20 simplifies this with the <code>using enum</code> declaration:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>
</span></span><span><span>    <span>using</span> <span>enum</span> <span>ComputeStatus</span><span>;</span>
</span></span><span><span>    <span>ComputeStatus</span> <span>s</span> <span>=</span> <span>NotEnoughMemory</span><span>;</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div><p>It’s probably no sense in this silly code above, but how about the following case:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>    
</span></span><span><span>    <span>ComputeStatus</span> <span>s</span> <span>=</span> <span>ComputeStatus</span><span>::</span><span>Ok</span><span>;</span>
</span></span><span><span>    <span>switch</span> <span>(</span><span>s</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>case</span> <span>ComputeStatus</span><span>::</span><span>Ok</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"ok"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>ComputeStatus</span><span>::</span><span>Error</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"Error"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>ComputeStatus</span><span>::</span><span>FileError</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"FileError"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>ComputeStatus</span><span>::</span><span>NotEnoughMemory</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"NotEnoughMemory"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>ComputeStatus</span><span>::</span><span>TimeExceeded</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"Time..."</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>default</span><span>:</span> <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"unknown..."</span><span>;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div><p>We can convert it into:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>    
</span></span><span><span>    <span>ComputeStatus</span> <span>s</span> <span>=</span> <span>ComputeStatus</span><span>::</span><span>Ok</span><span>;</span>
</span></span><span><span>    <span>switch</span> <span>(</span><span>s</span><span>)</span> <span>{</span>
</span></span><span><span>        <span>using</span> <span>enum</span> <span>ComputeStatus</span><span>;</span>	<span>// &lt;&lt; &lt;&lt;
</span></span></span><span><span><span></span>        <span>case</span> <span>Ok</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"ok"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>Error</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"Error"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>FileError</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"FileError"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>NotEnoughMemory</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"NotEnoughMemory"</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>case</span> <span>TimeExceeded</span><span>:</span> 
</span></span><span><span>            <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"Time..."</span><span>;</span> <span>break</span><span>;</span>
</span></span><span><span>        <span>default</span><span>:</span> <span>std</span><span>::</span><span>cout</span> <span>&lt;&lt;</span> <span>"unknown..."</span><span>;</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div><p>Run <a href="https://godbolt.org/z/fdjEThd8Y">@Compiler Explorer</a></p>
<p>Or have a look at the following example:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>struct</span> <span>ComputeEngine</span> <span>{</span>
</span></span><span><span>    <span>enum</span> <span>class</span> <span>ComputeStatus</span> <span>{</span>
</span></span><span><span>        <span>Ok</span><span>,</span>
</span></span><span><span>        <span>Error</span><span>,</span>
</span></span><span><span>        <span>FileError</span><span>,</span>
</span></span><span><span>        <span>NotEnoughMemory</span><span>,</span>
</span></span><span><span>        <span>TimeExceeded</span><span>,</span>
</span></span><span><span>        <span>Unknown</span>
</span></span><span><span>    <span>};</span>
</span></span><span><span>    <span>using</span> <span>enum</span> <span>ComputeStatus</span><span>;</span>
</span></span><span><span><span>};</span>
</span></span><span><span>
</span></span><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>    
</span></span><span><span>    <span>ComputeEngine</span><span>::</span><span>ComputeStatus</span> <span>s</span> <span>=</span> <span>ComputeEngine</span><span>::</span><span>Ok</span><span>;</span>
</span></span><span><span><span>}</span>
</span></span></code></pre></div><p>You can bring all enumerations into the scope of <code>ComputeEngine</code> and still benefit from <code>enum class</code> features.</p>
<p>This C++20 improvement makes the code cleaner and reduces verbosity, especially in cases where multiple enumerators are frequently used within a scope. It allows for a more streamlined and readable approach without sacrificing the type safety provided by scoped enums.</p>
<h2 id="c23-stdto_underlying">
C++23: <code>std::to_underlying</code> 
  
&nbsp;
    
</h2>

<p>C++23 further enhances enum class usability with the introduction of <code>std::to_underlying</code>, a utility function that converts an enum value to its underlying integral type. This feature addresses the common need to convert enum values to integers for storage, comparison, or interoperability with APIs that expect integral types.</p>
<p>The idea for this appeared in a wonderful book by Scott Meyers - <a href="https://amzn.to/3t5tmS4">Effective Modern C++: 42 Specific Ways to Improve Your Use of C++11 and C++14</a>. Finally in C++23 we can enjoy this feature being standardized.</p>
<p>Before C++23, converting an enum to its underlying type required explicit casting:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>enum</span> <span>class</span> <span>Permissions</span> <span>:</span> <span>uint8_t</span> <span>{</span>
</span></span><span><span>    <span>Execute</span> <span>=</span> <span>1</span><span>,</span>
</span></span><span><span>	<span>Write</span> <span>=</span> <span>2</span><span>,</span>
</span></span><span><span>    <span>Read</span> <span>=</span> <span>4</span>
</span></span><span><span><span>};</span>
</span></span><span><span>
</span></span><span><span><span>uint8_t</span> <span>value</span> <span>=</span> <span>static_cast</span><span>&lt;</span><span>uint8_t</span><span>&gt;</span><span>(</span><span>Permissions</span><span>::</span><span>Read</span><span>);</span>
</span></span></code></pre></div><p>With <code>std::to_underlying</code>, this conversion becomes more straightforward and expressive:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>#include</span> <span>&lt;type_traits&gt;</span><span>
</span></span></span><span><span><span></span>
</span></span><span><span><span>int</span> <span>main</span><span>()</span> <span>{</span>
</span></span><span><span>    <span>Permissions</span> <span>p</span> <span>=</span> <span>Permissions</span><span>::</span><span>Read</span><span>;</span>
</span></span><span><span>    <span>auto</span> <span>value</span> <span>=</span> <span>std</span><span>::</span><span>to_underlying</span><span>(</span><span>p</span><span>);</span> <span>// C++23
</span></span></span><span><span><span></span><span>}</span>
</span></span></code></pre></div><p>The <code>std::to_underlying</code> function improves code readability and reduces the boilerplate associated with type casting. It also clarifies the intent, making it evident that the purpose is to obtain the underlying value of the <code>enum</code>.</p>
<p>Read more in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1682r0.html">P1682R0: std::to_underlying for enumerations</a></p>
<h2 id="future-improvements">
Future improvements 
  
&nbsp;
    
</h2>

<p>One important update that we may receive soon is support for C++26 reflections - check out <a href="https://wg21.link/P2996">P2996</a> (the proposal has not been accepted yet, but is expected to be approved soon…). Reflection opens up numerous exciting possibilities, such as the ability to convert enums into strings.</p>
<p>See this example from the proposal:</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span><span>template</span> <span>&lt;</span><span>typename</span> <span>E</span><span>&gt;</span>
</span></span><span><span>  <span>requires</span> <span>std</span><span>::</span><span>is_enum_v</span><span>&lt;</span><span>E</span><span>&gt;</span>
</span></span><span><span><span>constexpr</span> <span>std</span><span>::</span><span>string</span> <span>enum_to_string</span><span>(</span><span>E</span> <span>value</span><span>)</span> <span>{</span>
</span></span><span><span>  <span>template</span> <span>for</span> <span>(</span><span>constexpr</span> <span>auto</span> <span>e</span> <span>:</span> <span>std</span><span>::</span><span>meta</span><span>::</span><span>enumerators_of</span><span>(</span><span>^</span><span>E</span><span>))</span> <span>{</span>
</span></span><span><span>    <span>if</span> <span>(</span><span>value</span> <span>==</span> <span>[</span><span>:</span><span>e</span><span>:])</span> <span>{</span>
</span></span><span><span>      <span>return</span> <span>std</span><span>::</span><span>string</span><span>(</span><span>std</span><span>::</span><span>meta</span><span>::</span><span>name_of</span><span>(</span><span>e</span><span>));</span>
</span></span><span><span>    <span>}</span>
</span></span><span><span>  <span>}</span>
</span></span><span><span>  <span>return</span> <span>"&lt;unnamed&gt;"</span><span>;</span>
</span></span><span><span><span>}</span>
</span></span><span><span>
</span></span><span><span><span>enum</span> <span>Color</span> <span>{</span> <span>red</span><span>,</span> <span>green</span><span>,</span> <span>blue</span> <span>};</span>
</span></span><span><span><span>static_assert</span><span>(</span><span>enum_to_string</span><span>(</span><span>Color</span><span>::</span><span>red</span><span>)</span> <span>==</span> <span>"red"</span><span>);</span>
</span></span><span><span><span>static_assert</span><span>(</span><span>enum_to_string</span><span>(</span><span>Color</span><span>(</span><span>42</span><span>))</span> <span>==</span> <span>"&lt;unnamed&gt;"</span><span>);</span>
</span></span></code></pre></div><p>See at <a href="https://godbolt.org/z/Y5va8MqzG">EDG experimental implementation</a> @CompilerExplorer</p>
<p>Of course, you don’t have to wait till C++26 and you can rely on third-party libraries like <a href="https://github.com/Neargye/magic_enum"><code>Neargye/magic_enum</code> @Github</a>. (Thanks to mentioning that in the comment, <a href="https://github.com/maxpagani">maxpagani</a>).</p>
<h2 id="summary">
Summary 
  
&nbsp;
    
</h2>

<p>In this article, we covered some of the new features introduced in C++17, C++20, and C++23 for enum classes. Enum classes provide type safety, but there are situations where we may need to relax some restrictions and write more concise code. We also explored the potential use case for C++26 reflection.</p>
<h4 id="back-to-you">
Back to you 
    
</h4>

<ul>
<li>Have you tried the latest improvements for <code>enum class</code>?</li>
<li>Do you use <code>enum class</code> for strong types or some other techniques?</li>
</ul>
<p>Share your feedback below in the comments.</p>

      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Airlines are running out of 4-digit flight numbers (222 pts)]]></title>
            <link>https://viewfromthewing.com/airlines-are-running-out-of-flight-numbers-and-they-dont-know-what-to-do-about-it/</link>
            <guid>41155462</guid>
            <pubDate>Sun, 04 Aug 2024 18:46:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://viewfromthewing.com/airlines-are-running-out-of-flight-numbers-and-they-dont-know-what-to-do-about-it/">https://viewfromthewing.com/airlines-are-running-out-of-flight-numbers-and-they-dont-know-what-to-do-about-it/</a>, See on <a href="https://news.ycombinator.com/item?id=41155462">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-210523">

	
	<!-- .entry-header -->

	
	
	<div>
		<p>Airlines use up to four digits for flight numbers.  That means they can have up to 9,999 flights (since there’s no flight zero), and no one comes close.  American Airlines <a href="https://americanairlines.gcs-web.com/#:~:text=About%20American%20Airlines%20Group,in%20more%20than%2050%20countries." target="_blank" rel="noopener">operates around 6,700 daily flights</a> including its American Eagle regional services.  So they should have plenty of room to grow!
</p><p>Except they don’t.  American Airlines, Delta, and United are running out of flight numbers, and nobody knows what to do about it.</p>
<p><img decoding="async" src="https://viewfromthewing.com/wp-content/uploads/2023/06/20230619_064640.jpg"></p>
<p>In fact, this topic came up at an American Airlines employee meeting last week.  After the airline’s second quarter earnings call, top executives talk to employees and take questions.  A worker in IT raised it: “We’re running out of flight numbers. Are we looking at 5-digit or some other solution?”</p>
<p>The airline’s Senior Vice President or Network Planning Brian Znotins laid out the challenge and what they’re doing about it.</p>
<ul><li>They actually have more than 9,999 flights that they want to put their flight number on<br>
</li><li>That’s because they have partners where they codeshare.  They want to sell American Airlines ‘flights’ from Doha to cities in India and Pakistan, for instance.  They want to sell American Airlines flights that are operated by Alaska Airlines.</li></ul>
<p>Here’s the full answer, along with how they triage the problem – for instance by assigning the same flight number to more than one flight a day (although that means they need for it to be flights that would never both be in the air at the same time, such as where the same plane is used and can’t reasonably be substituted):</p>
<blockquote><p>With consolidation in the industry, airlines have been running out of flight numbers.  …[Codeshares have caused us to be] running out of flight numbers.  We have more than 9,999 flights that we would like to go out and number.  And so ways to save flight numbers, we actually have a model that goes and conserves flight numbers so that we can continue to add where we want to. Our regional partners…we have to add flight number ranges for that.  </p>
<p>Believe it or not there’s a whole body of work that revolves around flight numbers and it’s not just 1989 to Kansas City for the Super Bowl.</p>
<p>Needless to say, the actual answer to the question is we run through-flights and we also do something called an ‘out and back flight number’ where a flight going to a station will have the same flight number  as the return flight back to the hub, and that’s also so we can conserve flight numbers.</p>
<p>Now on the technical side we’re working in systems that originated in the 60s. We have two-letter airline codes and we have four-digit flight numbers. You think of this as like a Y2K issue if you remember that. It is immensely difficult to find ways to add another digit to this field, and it’s really only a problem for three airlines in the world. The remaining airlines don’t run into this issue.</p>
<p>So for us, and other two big competitors, we found workarounds for it. And I think the technology investment would be too great…</p></blockquote>	<!-- /1019006/BoardingArea_DynamicContent -->
	
	
<p><img decoding="async" src="https://viewfromthewing.com/wp-content/uploads/2015/06/IMG_9691.jpg"></p>
<p>The computer systems airlines use are built on top of systems that are built on top of systems that date back sixty years.  So it’s hard to adjust for this.  And, as with Y2k, older systems economized on data size for storage and processing reasons.  Abbreviations were used.  For instance <a href="https://viewfromthewing.com/how-united-airlines-elite-status-levels-have-evolved/" target="_blank" rel="noopener">that’s how United Airlines elite status levels got their names</a>, “1K” was used instead of 1000K or 100,000 mile status because they only had two digits to designate it. It was meant as an internal tag, not to be public with customers, but it eventually stuck.</p>
<p>Back in April, American Airlines <a href="https://viewfromthewing.com/american-airlines-has-too-many-flights-for-its-flight-numbers-so-theyre-making-a-change-roundup/" target="_blank" rel="noopener">shifted their flight numbers</a> so that mainline flights extended not only from 1 to 2,999 but out to 3,139.</p>
<p><img decoding="async" src="https://viewfromthewing.com/wp-content/uploads/2024/04/Screenshot-2024-04-23-093602.png"></p>
<p>They also still have <a href="https://viewfromthewing.com/american-airlines-will-be-the-biggest-airline-for-the-4th-of-july-by-a-lot/" target="_blank" rel="noopener">fun with flight numbers</a> for instance running flight 1776 between Philadelphia and Boston; flight 1492 to Columbus; AAA777 to Las Vegas; and flight 420 to Denver.</p>
<p>And American Airlines CEO Robert Isom chimed in on the answer to the question about limits to flight numbers noting that “we have aspirations to be a lot bigger, so over time let’s put that down as a project.”</p>
	
	

	
	

			</div><!-- .entry-content -->

	
	
	<!-- .entry-footer -->

	
</article></div>]]></description>
        </item>
    </channel>
</rss>