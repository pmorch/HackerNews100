<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Thu, 29 Jan 2026 08:30:20 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[We can't send mail farther than 500 miles (2002) (300 pts)]]></title>
            <link>https://web.mit.edu/jemorris/humor/500-miles</link>
            <guid>46805665</guid>
            <pubDate>Thu, 29 Jan 2026 03:58:33 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://web.mit.edu/jemorris/humor/500-miles">https://web.mit.edu/jemorris/humor/500-miles</a>, See on <a href="https://news.ycombinator.com/item?id=46805665">Hacker News</a></p>
&lt;Not HTML&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Maine’s ‘Lobster Lady’ who fished for nearly a century dies aged 105 (124 pts)]]></title>
            <link>https://www.theguardian.com/us-news/2026/jan/28/maine-lobster-lady-dies-aged-105</link>
            <guid>46804854</guid>
            <pubDate>Thu, 29 Jan 2026 02:11:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.theguardian.com/us-news/2026/jan/28/maine-lobster-lady-dies-aged-105">https://www.theguardian.com/us-news/2026/jan/28/maine-lobster-lady-dies-aged-105</a>, See on <a href="https://news.ycombinator.com/item?id=46804854">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="maincontent"><p><a href="https://www.theguardian.com/us-news/maine" data-link-name="in body link">Maine</a>’s governor has hailed the life of a woman who spent nearly 100 years fishing for lobsters as “amazing” and expressed hopes that her memory inspires “the next century of hardworking” fishers in the state.</p><p>The subject of Governor Janet Mills’ tribute, Virginia “Ginny” Oliver, died on 21 January at age 105, according to an obituary <a href="https://www.legacy.com/us/obituaries/legacyremembers/virginia-oliver-obituary?id=60635890" data-link-name="in body link">published</a> on Monday by her family.</p><p>Some regard stories such as that of Oliver, who came to be known as her state’s “Lobster Lady”, as evidence of the growing number of Americans who extend their working days well past the typical retirement age as the cost of living in the US has soared, wages have stagnated and many therefore have been unable to save.</p><p>Nonetheless, as recently as 2021, Oliver told the Associated Press she fell in love with trapping lobsters from the moment she started in the business at eight years old, alongside her father and older brother.</p><p>“I like doing it – I like being along the water,” she said when discussing her career in the largely male-dominated industry she chose. “And so I’m going to keep on doing it just as long as I can.”</p><p>Oliver would get up before dawn and use small fish colloquially known as poagies to lure lobsters from her boat, the Virginia, which was first owned by her late husband. As she established a remarkable 97-year tenure on the waters, and word of it spread, she became the subject of documentaries, major US television networks’ news stories and children’s books, including one titled The Lobster Lady, her obituary recounted.</p><p><a href="https://www.theguardian.com/film/mark-hamill" data-link-name="in body link">Mark Hamill</a>, the famed actor, was among those who joined the following that Oliver developed throughout the years. Hamill, best known for his role as Luke Skywalker in the Star Wars film saga, “celebrated her tenacity on social media”, Oliver’s obituary noted.</p><p>The obituary also said that Oliver at one point earned an honorary invitation to join Great Britain’s Cardiff Royal Naval Association. Mills once presented Oliver with a special recognition on her birthday.</p><p>“Despite her fame, friends and family said she remained humble and spirited,” Oliver’s obituary added. “Her personal aesthetic delighted her fans – she wore lipstick and earrings every day she went out on the boat, because, as she said, ‘you never know who you are going to see.’”</p><p>Lobster evolved from working-class food to a pricey restaurant delicacy over the course of Oliver’s fishing life. Its price per pound swelled from 28 cents when she first started to $6.14 – or 22 times more expensive.</p><p>Oliver fished for lobster until a fall at age 103, said <a href="https://www.facebook.com/barbarawalsh.author/posts/i-always-teared-up-when-i-hugged-ginny-goodbye-wondering-if-it-would-be-the-last/1658293695150785/" data-link-name="in body link">a statement</a> from her friend, author and Pulitzer prize-winning journalist Barbara Walsh.</p><p>Walsh joined Mills in paying tribute to Oliver, saying the late fisher “believed in living, laughing and doing what she loved”.</p><p>“She was sassy and spirited, always declaring on land and at sea, ‘I’m the boss,’” Walsh’s tribute statement said. “Sail on, sweet Ginny. May your spirit forever soar above the sea.”</p><p>Meanwhile, the <a href="https://www.theguardian.com/us-news/maine" data-link-name="in body link" data-component="auto-linked-tag">Maine</a> Lobster festival, which once designated her the grand marshal of its parade, issued a statement honoring Oliver as “more than a local icon”.</p><p>“Virginia was … a living piece of Maine’s maritime history,” the festival’s statement said.</p><p>Oliver’s survivors include her children and grandchildren, according to her obituary.</p><p><em>Associated Press contributed reporting</em></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Render Mermaid diagrams as SVGs or ASCII art (196 pts)]]></title>
            <link>https://github.com/lukilabs/beautiful-mermaid</link>
            <guid>46804828</guid>
            <pubDate>Thu, 29 Jan 2026 02:08:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/lukilabs/beautiful-mermaid">https://github.com/lukilabs/beautiful-mermaid</a>, See on <a href="https://news.ycombinator.com/item?id=46804828">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text">
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">Why We Built This</h2><a id="user-content-why-we-built-this" aria-label="Permalink: Why We Built This" href="#why-we-built-this"></a></p>
<p dir="auto">Diagrams are essential for AI-assisted programming. When you're working with an AI coding assistant, being able to visualize data flows, state machines, and system architecture—directly in your terminal or chat interface—makes complex concepts instantly graspable.</p>
<p dir="auto"><a href="https://mermaid.js.org/" rel="nofollow">Mermaid</a> is the de facto standard for text-based diagrams. It's brilliant. But the default renderer has problems:</p>
<ul dir="auto">
<li><strong>Aesthetics</strong> — Might be personal preference, but wished they looked more professional</li>
<li><strong>Complex theming</strong> — Customizing colors requires wrestling with CSS classes</li>
<li><strong>No terminal output</strong> — Can't render to ASCII for CLI tools</li>
<li><strong>Heavy dependencies</strong> — Pulls in a lot of code for simple diagrams</li>
</ul>
<p dir="auto">We built <code>beautiful-mermaid</code> at <a href="https://craft.do/" rel="nofollow">Craft</a> to power diagrams in <a href="https://agents.craft.do/" rel="nofollow">Craft Agents</a>. It's fast, beautiful, and works everywhere—from rich UIs to plain terminals.</p>
<p dir="auto">The ASCII rendering engine is based on <a href="https://github.com/AlexanderGrooff/mermaid-ascii">mermaid-ascii</a> by Alexander Grooff. We ported it from Go to TypeScript and extended it Thank you Alexander for the excellent foundation! (And inspiration that this was possible.)</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"></a></p>
<ul dir="auto">
<li><strong>5 diagram types</strong> — Flowcharts, State, Sequence, Class, and ER diagrams</li>
<li><strong>Dual output</strong> — SVG for rich UIs, ASCII/Unicode for terminals</li>
<li><strong>15 built-in themes</strong> — And dead simple to add your own</li>
<li><strong>Full Shiki compatibility</strong> — Use any VS Code theme directly</li>
<li><strong>Live theme switching</strong> — CSS custom properties, no re-render needed</li>
<li><strong>Mono mode</strong> — Beautiful diagrams from just 2 colors</li>
<li><strong>Zero DOM dependencies</strong> — Pure TypeScript, works everywhere</li>
<li><strong>Ultra-fast</strong> — Renders 100+ diagrams in under 500ms</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="npm install beautiful-mermaid
# or
bun add beautiful-mermaid
# or
pnpm add beautiful-mermaid"><pre>npm install beautiful-mermaid
<span><span>#</span> or</span>
bun add beautiful-mermaid
<span><span>#</span> or</span>
pnpm add beautiful-mermaid</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Quick Start</h2><a id="user-content-quick-start" aria-label="Permalink: Quick Start" href="#quick-start"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">SVG Output</h3><a id="user-content-svg-output" aria-label="Permalink: SVG Output" href="#svg-output"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="import { renderMermaid } from 'beautiful-mermaid'

const svg = await renderMermaid(`
  graph TD
    A[Start] --> B{Decision}
    B -->|Yes| C[Action]
    B -->|No| D[End]
`)"><pre><span>import</span> <span>{</span> <span>renderMermaid</span> <span>}</span> <span>from</span> <span>'beautiful-mermaid'</span>

<span>const</span> <span>svg</span> <span>=</span> <span>await</span> <span>renderMermaid</span><span>(</span><span>`</span>
<span>  graph TD</span>
<span>    A[Start] --&gt; B{Decision}</span>
<span>    B --&gt;|Yes| C[Action]</span>
<span>    B --&gt;|No| D[End]</span>
<span>`</span><span>)</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">ASCII Output</h3><a id="user-content-ascii-output" aria-label="Permalink: ASCII Output" href="#ascii-output"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="import { renderMermaidAscii } from 'beautiful-mermaid'

const ascii = renderMermaidAscii(`graph LR; A --> B --> C`)"><pre><span>import</span> <span>{</span> <span>renderMermaidAscii</span> <span>}</span> <span>from</span> <span>'beautiful-mermaid'</span>

<span>const</span> <span>ascii</span> <span>=</span> <span>renderMermaidAscii</span><span>(</span><span>`graph LR; A --&gt; B --&gt; C`</span><span>)</span></pre></div>
<div data-snippet-clipboard-copy-content="┌───┐     ┌───┐     ┌───┐
│   │     │   │     │   │
│ A │────►│ B │────►│ C │
│   │     │   │     │   │
└───┘     └───┘     └───┘"><pre><code>┌───┐     ┌───┐     ┌───┐
│   │     │   │     │   │
│ A │────►│ B │────►│ C │
│   │     │   │     │   │
└───┘     └───┘     └───┘
</code></pre></div>
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">Theming</h2><a id="user-content-theming" aria-label="Permalink: Theming" href="#theming"></a></p>
<p dir="auto">The theming system is the heart of <code>beautiful-mermaid</code>. It's designed to be both powerful and dead simple.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">The Two-Color Foundation</h3><a id="user-content-the-two-color-foundation" aria-label="Permalink: The Two-Color Foundation" href="#the-two-color-foundation"></a></p>
<p dir="auto">Every diagram needs just two colors: <strong>background</strong> (<code>bg</code>) and <strong>foreground</strong> (<code>fg</code>). That's it. From these two colors, the entire diagram is derived using <code>color-mix()</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const svg = await renderMermaid(diagram, {
  bg: '#1a1b26',  // Background
  fg: '#a9b1d6',  // Foreground
})"><pre><span>const</span> <span>svg</span> <span>=</span> <span>await</span> <span>renderMermaid</span><span>(</span><span>diagram</span><span>,</span> <span>{</span>
  <span>bg</span>: <span>'#1a1b26'</span><span>,</span>  <span>// Background</span>
  <span>fg</span>: <span>'#a9b1d6'</span><span>,</span>  <span>// Foreground</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">This is <strong>Mono Mode</strong>—a coherent, beautiful diagram from just two colors. The system automatically derives:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Element</th>
<th>Derivation</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text</td>
<td><code>--fg</code> at 100%</td>
</tr>
<tr>
<td>Secondary text</td>
<td><code>--fg</code> at 60% into <code>--bg</code></td>
</tr>
<tr>
<td>Edge labels</td>
<td><code>--fg</code> at 40% into <code>--bg</code></td>
</tr>
<tr>
<td>Connectors</td>
<td><code>--fg</code> at 30% into <code>--bg</code></td>
</tr>
<tr>
<td>Arrow heads</td>
<td><code>--fg</code> at 50% into <code>--bg</code></td>
</tr>
<tr>
<td>Node fill</td>
<td><code>--fg</code> at 3% into <code>--bg</code></td>
</tr>
<tr>
<td>Node stroke</td>
<td><code>--fg</code> at 20% into <code>--bg</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Enriched Mode</h3><a id="user-content-enriched-mode" aria-label="Permalink: Enriched Mode" href="#enriched-mode"></a></p>
<p dir="auto">For richer themes, you can provide optional "enrichment" colors that override specific derivations:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const svg = await renderMermaid(diagram, {
  bg: '#1a1b26',
  fg: '#a9b1d6',
  // Optional enrichment:
  line: '#3d59a1',    // Edge/connector color
  accent: '#7aa2f7',  // Arrow heads, highlights
  muted: '#565f89',   // Secondary text, labels
  surface: '#292e42', // Node fill tint
  border: '#3d59a1',  // Node stroke
})"><pre><span>const</span> <span>svg</span> <span>=</span> <span>await</span> <span>renderMermaid</span><span>(</span><span>diagram</span><span>,</span> <span>{</span>
  <span>bg</span>: <span>'#1a1b26'</span><span>,</span>
  <span>fg</span>: <span>'#a9b1d6'</span><span>,</span>
  <span>// Optional enrichment:</span>
  <span>line</span>: <span>'#3d59a1'</span><span>,</span>    <span>// Edge/connector color</span>
  <span>accent</span>: <span>'#7aa2f7'</span><span>,</span>  <span>// Arrow heads, highlights</span>
  <span>muted</span>: <span>'#565f89'</span><span>,</span>   <span>// Secondary text, labels</span>
  <span>surface</span>: <span>'#292e42'</span><span>,</span> <span>// Node fill tint</span>
  <span>border</span>: <span>'#3d59a1'</span><span>,</span>  <span>// Node stroke</span>
<span>}</span><span>)</span></pre></div>
<p dir="auto">If an enrichment color isn't provided, it falls back to the <code>color-mix()</code> derivation. This means you can provide just the colors you care about.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">CSS Custom Properties = Live Switching</h3><a id="user-content-css-custom-properties--live-switching" aria-label="Permalink: CSS Custom Properties = Live Switching" href="#css-custom-properties--live-switching"></a></p>
<p dir="auto">All colors are CSS custom properties on the <code>&lt;svg&gt;</code> element. This means you can switch themes instantly without re-rendering:</p>
<div dir="auto" data-snippet-clipboard-copy-content="// Switch theme by updating CSS variables
svg.style.setProperty('--bg', '#282a36')
svg.style.setProperty('--fg', '#f8f8f2')
// The entire diagram updates immediately"><pre><span>// Switch theme by updating CSS variables</span>
<span>svg</span><span>.</span><span>style</span><span>.</span><span>setProperty</span><span>(</span><span>'--bg'</span><span>,</span> <span>'#282a36'</span><span>)</span>
<span>svg</span><span>.</span><span>style</span><span>.</span><span>setProperty</span><span>(</span><span>'--fg'</span><span>,</span> <span>'#f8f8f2'</span><span>)</span>
<span>// The entire diagram updates immediately</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Built-in Themes</h3><a id="user-content-built-in-themes" aria-label="Permalink: Built-in Themes" href="#built-in-themes"></a></p>
<p dir="auto">15 carefully curated themes ship out of the box:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Theme</th>
<th>Type</th>
<th>Background</th>
<th>Accent</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>zinc-light</code></td>
<td>Light</td>
<td><code>#FFFFFF</code></td>
<td>Derived</td>
</tr>
<tr>
<td><code>zinc-dark</code></td>
<td>Dark</td>
<td><code>#18181B</code></td>
<td>Derived</td>
</tr>
<tr>
<td><code>tokyo-night</code></td>
<td>Dark</td>
<td><code>#1a1b26</code></td>
<td><code>#7aa2f7</code></td>
</tr>
<tr>
<td><code>tokyo-night-storm</code></td>
<td>Dark</td>
<td><code>#24283b</code></td>
<td><code>#7aa2f7</code></td>
</tr>
<tr>
<td><code>tokyo-night-light</code></td>
<td>Light</td>
<td><code>#d5d6db</code></td>
<td><code>#34548a</code></td>
</tr>
<tr>
<td><code>catppuccin-mocha</code></td>
<td>Dark</td>
<td><code>#1e1e2e</code></td>
<td><code>#cba6f7</code></td>
</tr>
<tr>
<td><code>catppuccin-latte</code></td>
<td>Light</td>
<td><code>#eff1f5</code></td>
<td><code>#8839ef</code></td>
</tr>
<tr>
<td><code>nord</code></td>
<td>Dark</td>
<td><code>#2e3440</code></td>
<td><code>#88c0d0</code></td>
</tr>
<tr>
<td><code>nord-light</code></td>
<td>Light</td>
<td><code>#eceff4</code></td>
<td><code>#5e81ac</code></td>
</tr>
<tr>
<td><code>dracula</code></td>
<td>Dark</td>
<td><code>#282a36</code></td>
<td><code>#bd93f9</code></td>
</tr>
<tr>
<td><code>github-light</code></td>
<td>Light</td>
<td><code>#ffffff</code></td>
<td><code>#0969da</code></td>
</tr>
<tr>
<td><code>github-dark</code></td>
<td>Dark</td>
<td><code>#0d1117</code></td>
<td><code>#4493f8</code></td>
</tr>
<tr>
<td><code>solarized-light</code></td>
<td>Light</td>
<td><code>#fdf6e3</code></td>
<td><code>#268bd2</code></td>
</tr>
<tr>
<td><code>solarized-dark</code></td>
<td>Dark</td>
<td><code>#002b36</code></td>
<td><code>#268bd2</code></td>
</tr>
<tr>
<td><code>one-dark</code></td>
<td>Dark</td>
<td><code>#282c34</code></td>
<td><code>#c678dd</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<div dir="auto" data-snippet-clipboard-copy-content="import { renderMermaid, THEMES } from 'beautiful-mermaid'

const svg = await renderMermaid(diagram, THEMES['tokyo-night'])"><pre><span>import</span> <span>{</span> <span>renderMermaid</span><span>,</span> <span>THEMES</span> <span>}</span> <span>from</span> <span>'beautiful-mermaid'</span>

<span>const</span> <span>svg</span> <span>=</span> <span>await</span> <span>renderMermaid</span><span>(</span><span>diagram</span><span>,</span> <span>THEMES</span><span>[</span><span>'tokyo-night'</span><span>]</span><span>)</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Adding Your Own Theme</h3><a id="user-content-adding-your-own-theme" aria-label="Permalink: Adding Your Own Theme" href="#adding-your-own-theme"></a></p>
<p dir="auto">Creating a theme is trivial. At minimum, just provide <code>bg</code> and <code>fg</code>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const myTheme = {
  bg: '#0f0f0f',
  fg: '#e0e0e0',
}

const svg = await renderMermaid(diagram, myTheme)"><pre><span>const</span> <span>myTheme</span> <span>=</span> <span>{</span>
  <span>bg</span>: <span>'#0f0f0f'</span><span>,</span>
  <span>fg</span>: <span>'#e0e0e0'</span><span>,</span>
<span>}</span>

<span>const</span> <span>svg</span> <span>=</span> <span>await</span> <span>renderMermaid</span><span>(</span><span>diagram</span><span>,</span> <span>myTheme</span><span>)</span></pre></div>
<p dir="auto">Want richer colors? Add any of the optional enrichments:</p>
<div dir="auto" data-snippet-clipboard-copy-content="const myRichTheme = {
  bg: '#0f0f0f',
  fg: '#e0e0e0',
  accent: '#ff6b6b',  // Pop of color for arrows
  muted: '#666666',   // Subdued labels
}"><pre><span>const</span> <span>myRichTheme</span> <span>=</span> <span>{</span>
  <span>bg</span>: <span>'#0f0f0f'</span><span>,</span>
  <span>fg</span>: <span>'#e0e0e0'</span><span>,</span>
  <span>accent</span>: <span>'#ff6b6b'</span><span>,</span>  <span>// Pop of color for arrows</span>
  <span>muted</span>: <span>'#666666'</span><span>,</span>   <span>// Subdued labels</span>
<span>}</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Full Shiki Compatibility</h3><a id="user-content-full-shiki-compatibility" aria-label="Permalink: Full Shiki Compatibility" href="#full-shiki-compatibility"></a></p>
<p dir="auto">Use <strong>any VS Code theme</strong> directly via Shiki integration. This gives you access to hundreds of community themes:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import { getSingletonHighlighter } from 'shiki'
import { renderMermaid, fromShikiTheme } from 'beautiful-mermaid'

// Load any theme from Shiki's registry
const highlighter = await getSingletonHighlighter({
  themes: ['vitesse-dark', 'rose-pine', 'material-theme-darker']
})

// Extract diagram colors from the theme
const colors = fromShikiTheme(highlighter.getTheme('vitesse-dark'))

const svg = await renderMermaid(diagram, colors)"><pre><span>import</span> <span>{</span> <span>getSingletonHighlighter</span> <span>}</span> <span>from</span> <span>'shiki'</span>
<span>import</span> <span>{</span> <span>renderMermaid</span><span>,</span> <span>fromShikiTheme</span> <span>}</span> <span>from</span> <span>'beautiful-mermaid'</span>

<span>// Load any theme from Shiki's registry</span>
<span>const</span> <span>highlighter</span> <span>=</span> <span>await</span> <span>getSingletonHighlighter</span><span>(</span><span>{</span>
  <span>themes</span>: <span>[</span><span>'vitesse-dark'</span><span>,</span> <span>'rose-pine'</span><span>,</span> <span>'material-theme-darker'</span><span>]</span>
<span>}</span><span>)</span>

<span>// Extract diagram colors from the theme</span>
<span>const</span> <span>colors</span> <span>=</span> <span>fromShikiTheme</span><span>(</span><span>highlighter</span><span>.</span><span>getTheme</span><span>(</span><span>'vitesse-dark'</span><span>)</span><span>)</span>

<span>const</span> <span>svg</span> <span>=</span> <span>await</span> <span>renderMermaid</span><span>(</span><span>diagram</span><span>,</span> <span>colors</span><span>)</span></pre></div>
<p dir="auto">The <code>fromShikiTheme()</code> function intelligently maps VS Code editor colors to diagram roles:</p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Editor Color</th>
<th>Diagram Role</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>editor.background</code></td>
<td><code>bg</code></td>
</tr>
<tr>
<td><code>editor.foreground</code></td>
<td><code>fg</code></td>
</tr>
<tr>
<td><code>editorLineNumber.foreground</code></td>
<td><code>line</code></td>
</tr>
<tr>
<td><code>focusBorder</code> / keyword token</td>
<td><code>accent</code></td>
</tr>
<tr>
<td>comment token</td>
<td><code>muted</code></td>
</tr>
<tr>
<td><code>editor.selectionBackground</code></td>
<td><code>surface</code></td>
</tr>
<tr>
<td><code>editorWidget.border</code></td>
<td><code>border</code></td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">Supported Diagrams</h2><a id="user-content-supported-diagrams" aria-label="Permalink: Supported Diagrams" href="#supported-diagrams"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Flowcharts</h3><a id="user-content-flowcharts" aria-label="Permalink: Flowcharts" href="#flowcharts"></a></p>
<div data-snippet-clipboard-copy-content="graph TD
  A[Start] --> B{Decision}
  B -->|Yes| C[Process]
  B -->|No| D[End]
  C --> D"><pre><code>graph TD
  A[Start] --&gt; B{Decision}
  B --&gt;|Yes| C[Process]
  B --&gt;|No| D[End]
  C --&gt; D
</code></pre></div>
<p dir="auto">All directions supported: <code>TD</code> (top-down), <code>LR</code> (left-right), <code>BT</code> (bottom-top), <code>RL</code> (right-left).</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">State Diagrams</h3><a id="user-content-state-diagrams" aria-label="Permalink: State Diagrams" href="#state-diagrams"></a></p>
<div data-snippet-clipboard-copy-content="stateDiagram-v2
  [*] --> Idle
  Idle --> Processing: start
  Processing --> Complete: done
  Complete --> [*]"><pre><code>stateDiagram-v2
  [*] --&gt; Idle
  Idle --&gt; Processing: start
  Processing --&gt; Complete: done
  Complete --&gt; [*]
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Sequence Diagrams</h3><a id="user-content-sequence-diagrams" aria-label="Permalink: Sequence Diagrams" href="#sequence-diagrams"></a></p>
<div data-snippet-clipboard-copy-content="sequenceDiagram
  Alice->>Bob: Hello Bob!
  Bob-->>Alice: Hi Alice!
  Alice->>Bob: How are you?
  Bob-->>Alice: Great, thanks!"><pre><code>sequenceDiagram
  Alice-&gt;&gt;Bob: Hello Bob!
  Bob--&gt;&gt;Alice: Hi Alice!
  Alice-&gt;&gt;Bob: How are you?
  Bob--&gt;&gt;Alice: Great, thanks!
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Class Diagrams</h3><a id="user-content-class-diagrams" aria-label="Permalink: Class Diagrams" href="#class-diagrams"></a></p>
<div data-snippet-clipboard-copy-content="classDiagram
  Animal <|-- Duck
  Animal <|-- Fish
  Animal: +int age
  Animal: +String gender
  Animal: +isMammal() bool
  Duck: +String beakColor
  Duck: +swim()
  Duck: +quack()"><pre><code>classDiagram
  Animal &lt;|-- Duck
  Animal &lt;|-- Fish
  Animal: +int age
  Animal: +String gender
  Animal: +isMammal() bool
  Duck: +String beakColor
  Duck: +swim()
  Duck: +quack()
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">ER Diagrams</h3><a id="user-content-er-diagrams" aria-label="Permalink: ER Diagrams" href="#er-diagrams"></a></p>
<div data-snippet-clipboard-copy-content="erDiagram
  CUSTOMER ||--o{ ORDER : places
  ORDER ||--|{ LINE_ITEM : contains
  PRODUCT ||--o{ LINE_ITEM : &quot;is in&quot;"><pre><code>erDiagram
  CUSTOMER ||--o{ ORDER : places
  ORDER ||--|{ LINE_ITEM : contains
  PRODUCT ||--o{ LINE_ITEM : "is in"
</code></pre></div>
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">ASCII Output</h2><a id="user-content-ascii-output-1" aria-label="Permalink: ASCII Output" href="#ascii-output-1"></a></p>
<p dir="auto">For terminal environments, CLI tools, or anywhere you need plain text, render to ASCII or Unicode box-drawing characters:</p>
<div dir="auto" data-snippet-clipboard-copy-content="import { renderMermaidAscii } from 'beautiful-mermaid'

// Unicode mode (default) — prettier box drawing
const unicode = renderMermaidAscii(`graph LR; A --> B`)

// Pure ASCII mode — maximum compatibility
const ascii = renderMermaidAscii(`graph LR; A --> B`, { useAscii: true })"><pre><span>import</span> <span>{</span> <span>renderMermaidAscii</span> <span>}</span> <span>from</span> <span>'beautiful-mermaid'</span>

<span>// Unicode mode (default) — prettier box drawing</span>
<span>const</span> <span>unicode</span> <span>=</span> <span>renderMermaidAscii</span><span>(</span><span>`graph LR; A --&gt; B`</span><span>)</span>

<span>// Pure ASCII mode — maximum compatibility</span>
<span>const</span> <span>ascii</span> <span>=</span> <span>renderMermaidAscii</span><span>(</span><span>`graph LR; A --&gt; B`</span><span>,</span> <span>{</span> <span>useAscii</span>: <span>true</span> <span>}</span><span>)</span></pre></div>
<p dir="auto"><strong>Unicode output:</strong></p>
<div data-snippet-clipboard-copy-content="┌───┐     ┌───┐
│   │     │   │
│ A │────►│ B │
│   │     │   │
└───┘     └───┘"><pre><code>┌───┐     ┌───┐
│   │     │   │
│ A │────►│ B │
│   │     │   │
└───┘     └───┘
</code></pre></div>
<p dir="auto"><strong>ASCII output:</strong></p>
<div data-snippet-clipboard-copy-content="+---+     +---+
|   |     |   |
| A |---->| B |
|   |     |   |
+---+     +---+"><pre><code>+---+     +---+
|   |     |   |
| A |----&gt;| B |
|   |     |   |
+---+     +---+
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">ASCII Options</h3><a id="user-content-ascii-options" aria-label="Permalink: ASCII Options" href="#ascii-options"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="renderMermaidAscii(diagram, {
  useAscii: false,      // true = ASCII, false = Unicode (default)
  paddingX: 5,          // Horizontal spacing between nodes
  paddingY: 5,          // Vertical spacing between nodes
  boxBorderPadding: 1,  // Padding inside node boxes
})"><pre><span>renderMermaidAscii</span><span>(</span><span>diagram</span><span>,</span> <span>{</span>
  <span>useAscii</span>: <span>false</span><span>,</span>      <span>// true = ASCII, false = Unicode (default)</span>
  <span>paddingX</span>: <span>5</span><span>,</span>          <span>// Horizontal spacing between nodes</span>
  <span>paddingY</span>: <span>5</span><span>,</span>          <span>// Vertical spacing between nodes</span>
  <span>boxBorderPadding</span>: <span>1</span><span>,</span>  <span>// Padding inside node boxes</span>
<span>}</span><span>)</span></pre></div>
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">API Reference</h2><a id="user-content-api-reference" aria-label="Permalink: API Reference" href="#api-reference"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto"><code>renderMermaid(text, options?): Promise&lt;string&gt;</code></h3><a id="user-content-rendermermaidtext-options-promisestring" aria-label="Permalink: renderMermaid(text, options?): Promise<string>" href="#rendermermaidtext-options-promisestring"></a></p>
<p dir="auto">Render a Mermaid diagram to SVG. Auto-detects diagram type.</p>
<p dir="auto"><strong>Parameters:</strong></p>
<ul dir="auto">
<li><code>text</code> — Mermaid source code</li>
<li><code>options</code> — Optional <code>RenderOptions</code> object</li>
</ul>
<p dir="auto"><strong>RenderOptions:</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bg</code></td>
<td><code>string</code></td>
<td><code>#FFFFFF</code></td>
<td>Background color</td>
</tr>
<tr>
<td><code>fg</code></td>
<td><code>string</code></td>
<td><code>#27272A</code></td>
<td>Foreground color</td>
</tr>
<tr>
<td><code>line</code></td>
<td><code>string?</code></td>
<td>—</td>
<td>Edge/connector color</td>
</tr>
<tr>
<td><code>accent</code></td>
<td><code>string?</code></td>
<td>—</td>
<td>Arrow heads, highlights</td>
</tr>
<tr>
<td><code>muted</code></td>
<td><code>string?</code></td>
<td>—</td>
<td>Secondary text, labels</td>
</tr>
<tr>
<td><code>surface</code></td>
<td><code>string?</code></td>
<td>—</td>
<td>Node fill tint</td>
</tr>
<tr>
<td><code>border</code></td>
<td><code>string?</code></td>
<td>—</td>
<td>Node stroke color</td>
</tr>
<tr>
<td><code>font</code></td>
<td><code>string</code></td>
<td><code>Inter</code></td>
<td>Font family</td>
</tr>
<tr>
<td><code>transparent</code></td>
<td><code>boolean</code></td>
<td><code>false</code></td>
<td>Render with transparent background</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto"><code>renderMermaidAscii(text, options?): string</code></h3><a id="user-content-rendermermaidasciitext-options-string" aria-label="Permalink: renderMermaidAscii(text, options?): string" href="#rendermermaidasciitext-options-string"></a></p>
<p dir="auto">Render a Mermaid diagram to ASCII/Unicode text. Synchronous.</p>
<p dir="auto"><strong>AsciiRenderOptions:</strong></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>useAscii</code></td>
<td><code>boolean</code></td>
<td><code>false</code></td>
<td>Use ASCII instead of Unicode</td>
</tr>
<tr>
<td><code>paddingX</code></td>
<td><code>number</code></td>
<td><code>5</code></td>
<td>Horizontal node spacing</td>
</tr>
<tr>
<td><code>paddingY</code></td>
<td><code>number</code></td>
<td><code>5</code></td>
<td>Vertical node spacing</td>
</tr>
<tr>
<td><code>boxBorderPadding</code></td>
<td><code>number</code></td>
<td><code>1</code></td>
<td>Inner box padding</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto"><code>fromShikiTheme(theme): DiagramColors</code></h3><a id="user-content-fromshikithemetheme-diagramcolors" aria-label="Permalink: fromShikiTheme(theme): DiagramColors" href="#fromshikithemetheme-diagramcolors"></a></p>
<p dir="auto">Extract diagram colors from a Shiki theme object.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto"><code>THEMES: Record&lt;string, DiagramColors&gt;</code></h3><a id="user-content-themes-recordstring-diagramcolors" aria-label="Permalink: THEMES: Record<string, DiagramColors>" href="#themes-recordstring-diagramcolors"></a></p>
<p dir="auto">Object containing all 15 built-in themes.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto"><code>DEFAULTS: { bg: string, fg: string }</code></h3><a id="user-content-defaults--bg-string-fg-string-" aria-label="Permalink: DEFAULTS: { bg: string, fg: string }" href="#defaults--bg-string-fg-string-"></a></p>
<p dir="auto">Default colors (<code>#FFFFFF</code> / <code>#27272A</code>).</p>
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">Attribution</h2><a id="user-content-attribution" aria-label="Permalink: Attribution" href="#attribution"></a></p>
<p dir="auto">The ASCII rendering engine is based on <a href="https://github.com/AlexanderGrooff/mermaid-ascii">mermaid-ascii</a> by Alexander Grooff. We ported it from Go to TypeScript and extended it with:</p>
<ul dir="auto">
<li>Sequence diagram support</li>
<li>Class diagram support</li>
<li>ER diagram support</li>
<li>Unicode box-drawing characters</li>
<li>Configurable spacing and padding</li>
</ul>
<p dir="auto">Thank you Alexander for the excellent foundation!</p>
<hr>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto">MIT — see <a href="https://github.com/lukilabs/beautiful-mermaid/blob/main/LICENSE">LICENSE</a> for details.</p>
<hr>
<p dir="auto">Built with care by the team at <a href="https://craft.do/" rel="nofollow">Craft</a></p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Ross Stevens Donates $100M to Pay Every US Olympian and Paralympian $200k (163 pts)]]></title>
            <link>https://www.townandcountrymag.com/leisure/sporting/a70171886/ross-stevens-american-olympians-donation/</link>
            <guid>46803549</guid>
            <pubDate>Wed, 28 Jan 2026 23:55:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.townandcountrymag.com/leisure/sporting/a70171886/ross-stevens-american-olympians-donation/">https://www.townandcountrymag.com/leisure/sporting/a70171886/ross-stevens-american-olympians-donation/</a>, See on <a href="https://news.ycombinator.com/item?id=46803549">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-journey-body="standard-article"><p data-journey-content="true" data-node-id="0">How much <a href="https://www.townandcountrymag.com/leisure/sporting/a61804802/olympic-medalists-pay-explained/" target="_blank" data-vars-ga-outbound-link="https://www.townandcountrymag.com/leisure/sporting/a61804802/olympic-medalists-pay-explained/" data-vars-ga-ux-element="Hyperlink" data-vars-ga-call-to-action="Olympians get paid" data-node-id="0.1">Olympians get paid</a> depends entirely on the country they compete for. The International Olympic Committee (IOC) does not give out cash prizes, only a medal, but many countries do award their athletes based on whether or not they won a gold, silver, or bronze. However, if an American athlete competes (and medals) at the Olympics, the U.S. government does not pay them anything.</p><p data-journey-content="true" data-node-id="1">Billionaire financier Ross Stevens is changing that. Starting with the upcoming Milan Cortina Olympics, he will give $200,000 to every U.S. Olympic and Paralympic athlete—even if they don’t win a medal. Per the <a href="https://www.wsj.com/sports/olympics/team-usa-milan-cortina-e131245d?st=Hhm2s6&amp;reflink=desktopwebshare_permalink" target="_blank" data-vars-ga-outbound-link="https://www.wsj.com/sports/olympics/team-usa-milan-cortina-e131245d?st=Hhm2s6&amp;reflink=desktopwebshare_permalink" data-vars-ga-ux-element="Hyperlink" data-vars-ga-call-to-action="Wall Street Journal" data-node-id="1.1"><em data-node-id="1.1.0">Wall Street Journal</em></a>, “Half will come 20 years after their first qualifying Olympic appearance or at age 45, whichever comes later. Another $100,000 will be in the form of a guaranteed benefit for their families after they pass away.”</p><p data-journey-content="true" data-node-id="2">His entire donation to the U.S. Olympic &amp; Paralympic Committee (USOPC), <a href="https://www.usopc.org/news/2025/march/04/united-states-olympic-paralympic-committee-and-united-states-olympic-paralympic-foundation-announce-100-million-gift-to-support-post-games-financial-security-for-team-usa-athletes" target="_blank" data-vars-ga-outbound-link="https://www.usopc.org/news/2025/march/04/united-states-olympic-paralympic-committee-and-united-states-olympic-paralympic-foundation-announce-100-million-gift-to-support-post-games-financial-security-for-team-usa-athletes" data-vars-ga-ux-element="Hyperlink" data-vars-ga-call-to-action="announced last March" data-node-id="2.1">announced last March</a>, is $100 million—a record breaking gift to the organization. “I do not believe that financial insecurity should stop our nation’s elite athletes from breaking through to new frontiers of excellence,” Stevens said upon the announcement of his gift.</p><p data-journey-content="true" data-node-id="4">This won’t be the only source of income for American Olympic and Paralympic athletes; many receive money from endorsement and sponsorship deals, and the national governing body of each sport financially supports their athletes differently. However, Stevens’ gift looks to their retirement.</p><p data-journey-content="true" data-node-id="6">Called the Stevens Financial Security Awards (Stevens Awards), the gift is intended to provide financial support to those who represent the U.S. on the world stage. “In the heart of every Team USA athlete lies a story of dedication, sacrifice and triumph,” said USOPC Chair Gene Sykes. “These extraordinary individuals have committed their lives to their sport, often at the expense of traditional career paths and financial savings. As they approach the end of their competitive journeys—often as young as 25 or 30—many face a daunting reality: the lack of financial savings to support them and their loved ones in their post-athletic life.”</p><p data-journey-content="true" data-node-id="7">He added, “Because of Ross’ extraordinary generosity and philanthropic creativity, we can create more than a financial safety net— we can build a springboard that will propel these athletes to even greater heights beyond their Olympic and Paralympic careers.”</p><div data-journey-blur="partial" data-ad-exclude="true"><p><span><img src="https://hips.hearstapps.com/rover/profile_photos/121b4598-31f9-4716-af00-a68368fb7913_1643729378.file?fill=1:1&amp;resize=120:*" alt="Headshot of Emily Burack" title="Headshot of Emily Burack" width="100%" height="100%" decoding="async" loading="lazy"></span></p><div><p>Emily Burack (she/her) is the Senior News Editor for Town &amp; Country, where she covers entertainment, celebrities, the royals, and a wide range of other topics. Before joining T&amp;C, she was the deputy managing editor at Hey Alma, a Jewish culture site. Follow her @emburack on Twitter and Instagram.</p></div></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Please Don't Say Mean Things about the AI I Just Invested a Billion Dollars In (559 pts)]]></title>
            <link>https://www.mcsweeneys.net/articles/please-dont-say-mean-things-about-the-ai-that-i-just-invested-a-billion-dollars-in</link>
            <guid>46803356</guid>
            <pubDate>Wed, 28 Jan 2026 23:36:23 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.mcsweeneys.net/articles/please-dont-say-mean-things-about-the-ai-that-i-just-invested-a-billion-dollars-in">https://www.mcsweeneys.net/articles/please-dont-say-mean-things-about-the-ai-that-i-just-invested-a-billion-dollars-in</a>, See on <a href="https://news.ycombinator.com/item?id=46803356">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
      <p><i>“[Nvidia <span>CEO</span>] Jensen Huang Is Begging You to Stop Being So Negative About AI” — <a href="https://gizmodo.com/jensen-huang-is-begging-you-to-stop-being-so-negative-about-ai-2000709335">Headline from Gizmodo</a></i></p>
<p>- - </p><p>—</p>
<p>Guys, enough is enough. Bullying is a serious issue, and it’s time for me to speak out. There’s an extremely hurtful narrative going around that my product, a revolutionary new technology that exists to scam the elderly and make you distrust anything you see online, is harmful to society. This slander is totally unwarranted, and I would really appreciate it if everyone would stop being so mean about this thing I just invested a billion dollars in.</p>
<p>As someone who desperately needs this technology to work out, I can honestly say it is the most essential tool ever created in all of human history. Don’t mercilessly ridicule it just because it steals the joy out of your hobbies and creates sexually explicit images of women without their consent. Seriously, please stop! It really hurts my feelings.</p>
<p>It’s easy to throw stones if you think about the job displacement and ecological destruction caused by this pointless technology. But such black-and-white, not-wanting-billionaires-to-get-richer thinking is, quite frankly, cruel. You can’t just measure the value of something in terms of “whether or not it makes everything worse for everyone.” The world is much more complicated than that.</p>
<p>This technology is going to fuel innovation across industries and solve all problems of feminism and equal rights. Yes, it’s expanding the surveillance state, and yes, it’s destroying the education system, and yes, it’s being trained on copyrighted work without permission, and yes, it’s being used to create lethal autonomous weapons systems that can identify, target, and kill without human input, but… I forget my point, but ultimately, I think you should embrace it.</p>
<p>Lately, I feel like I just can’t win with you guys. Please, just use my evil technology. What’s so wrong with that? Just use it. I’m begging you. I want to continue living my immoral technofascist life without any criticism.</p>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[In 6 violent encounters, evidence contradicts immigration officials' narratives (171 pts)]]></title>
            <link>https://www.reuters.com/world/us/evidence-contradicts-trump-immigration-officials-accounts-violent-encounters-2026-01-27/</link>
            <guid>46803229</guid>
            <pubDate>Wed, 28 Jan 2026 23:25:41 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.reuters.com/world/us/evidence-contradicts-trump-immigration-officials-accounts-violent-encounters-2026-01-27/">https://www.reuters.com/world/us/evidence-contradicts-trump-immigration-officials-accounts-violent-encounters-2026-01-27/</a>, See on <a href="https://news.ycombinator.com/item?id=46803229">Hacker News</a></p>
Couldn't get https://www.reuters.com/world/us/evidence-contradicts-trump-immigration-officials-accounts-violent-encounters-2026-01-27/: Error: Request failed with status code 401]]></description>
        </item>
        <item>
            <title><![CDATA[The UK paid £4.1M for a bookmarks site (342 pts)]]></title>
            <link>https://mahadk.com/posts/ai-skills-hub</link>
            <guid>46803119</guid>
            <pubDate>Wed, 28 Jan 2026 23:16:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mahadk.com/posts/ai-skills-hub">https://mahadk.com/posts/ai-skills-hub</a>, See on <a href="https://news.ycombinator.com/item?id=46803119">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>  <p>The UK Government recently unveiled its <a href="https://www.gov.uk/government/news/free-ai-training-for-all-as-government-and-industry-programme-expands-to-provide-10-million-workers-with-key-ai-skills-by-2030">‘AI Skills Hub’</a>, which wants to provide 10 million workers with AI skills by 2030. The main site was delivered by PwC for the low, low price of.. <a href="https://www.find-tender.service.gov.uk/Notice/001337-2025">£4.1 million (~$5,657,000).</a></p>
<p><img src="https://cdn.mahadk.com/s/v3/fa4d19cdf4b054d4_image.png" alt="Image of the procurement contract"></p>
<p>It is <em>not</em> good. Like, at all - the UI is insanely bad and it’s clear that this was just a vibecoded site (to be fair, this is the <em>AI</em> Skills Hub, but c’mon, where is the pride in your work? I would be ashamed to even release this as a prototype!)</p>
<p><img src="https://cdn.mahadk.com/s/v3/fa0761d06de95286_image.png" alt="Image of the AI Skills Hub"></p>
<p>PwC didn’t even write any of the course content! The only thing the Skills Hub does is link out to external pages, like Salesforce’s free Trailhead learning platform:</p>
<p><img src="https://cdn.mahadk.com/s/v3/9aed674092d49d24_image.png" alt="Screenshot of Salesforce's Trailhead learning platform"></p>
<p>Note that I’m fairly certain this course already existed before the contract was even awarded, so all the site does is.. link out to other sites?</p>
<p>PwC itself also admits that the site does not properly meet accessibility standards:</p>
<p><img src="https://cdn.mahadk.com/s/v3/f346a09eb011342a_image.png" alt="Accessibility policy"></p>
<p>Even for those without a disability, the lack of here in this regard means that the site can be very confusing and buggy as a result.</p>
<h2 id="incorrect-laws">Incorrect laws</h2>
<p>The site has a course on “AI and intellectual property”. One thing it mentions is <a href="https://en.wikipedia.org/wiki/Fair_use">fair use</a>:</p>
<p><img src="https://cdn.mahadk.com/s/v3/1e8f7dc501128b15_image.png" alt="Fair use"></p>
<p><a href="https://x.com/ednewtonrex/status/2016443895505203379">(credits for the photo)</a></p>
<p>Except that <em>fair use is not a thing in the UK</em> - that’s a US concept! The UK uses what’s known as “fair dealing”, which is more restrictive than fair use, so the details here are plain wrong.</p>
<h2 id="lack-of-care-lack-of-craft">Lack of care, lack of craft</h2>
<p>The interface for this website has also not been clearly thought out - one glaring example is the process of actually enrolling in a course.</p>
<p>On the course page, the “Enroll Now” button is <em>tiny</em>, and if you don’t see it and try scrolling down to the bottom, you will find yourself nothing but a comment section!</p>
<p><img src="https://cdn.mahadk.com/s/v3/61dc1d957dc892f8_image.png" alt="Image of the course page"></p>
<p>Then you have other bugs too, like the “Skills &amp; Training Gap Analysis” - which is linked at the top of the site! - apparently being closed off to the public for no reason:</p>
<p><img src="https://cdn.mahadk.com/s/v3/f03c15b9365950ff_image.png" alt="Image of the S&amp;T Gap Analysis page"></p>
<hr>
<p>To be honest, seeing this made me angry.</p>
<p>I’m angry at the sheer <em>wastefulness</em> of the UK Government here. Our public services are collapsing - while £4 million is admittedly chump change for the UK government, there are real people behind these numbers - families waiting months for NHS appointments, children in crumbling schools, vulnerable people not getting the care they need. The waste feels particularly galling when you realise that almost no one will actually use this site!</p>
<p>I’m also angry that the small webdev businesses we have here in the UK were left out of this - for less than 5% of the cost, we’d have a <em>better</em> website and help out small businesses who actually care about their work, instead of handing the project to a multinational company that made nearly $60 billion in revenue in a year and has zero qualms about ripping off the British taxpayer.</p>
<p>Do better.</p>  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Tesla ending Models S and X production (268 pts)]]></title>
            <link>https://www.cnbc.com/2026/01/28/tesla-ending-model-s-x-production.html</link>
            <guid>46802867</guid>
            <pubDate>Wed, 28 Jan 2026 22:53:54 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.cnbc.com/2026/01/28/tesla-ending-model-s-x-production.html">https://www.cnbc.com/2026/01/28/tesla-ending-model-s-x-production.html</a>, See on <a href="https://news.ycombinator.com/item?id=46802867">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="RegularArticle-ArticleBody-5" data-module="ArticleBody" data-test="articleBody-2" data-analytics="RegularArticle-articleBody-5-2"><div id="ArticleBody-InlineImage-106844785" data-test="InlineImage"><p>A Model X is on display at a Tesla showroom on February 13, 2021 in Beijing, China.</p><p>VCG | Visual China Group | Getty Images</p></div><div><p><span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-1"><a href="https://www.cnbc.com/quotes/TSLA/">Tesla</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> CEO <a href="https://www.cnbc.com/elon-musk/">Elon Musk</a> said on Wednesday that the automaker is ending production of its Model S and X vehicles, and will use the factory in Fremont, California, to build Optimus humanoid robots. </p><p>"It's time to basically bring the Model S and X programs to an end with an honorable discharge," Musk said on the company's fourth-quarter <a href="https://www.cnbc.com/2026/01/28/tesla-tsla-2025-q4-earnings.html">earnings</a> call. "If you're interested in buying a Model S and X, now would be the time to order it."</p><p>After the original Roadster, the two models are Tesla's oldest vehicles, and in recent years the company has slashed prices as global competition for electric vehicles has soared. Tesla started selling the Model S sedan in 2012, and the <a href="https://www.cnbc.com/2015/09/30/tesla-delivers-model-x-electric-suv-to-take-on-luxury-carmakers.html">Model X SUV</a> three years later. </p><p>On Tesla's website, the Model S currently starts at about $95,000, while the Model X starts at around $100,000</p><p>Tesla's far more popular models are the 3 and Y, which accounted for 97% of the company's 1.59 million <a href="https://ir.tesla.com/press-release/tesla-fourth-quarter-2025-production-deliveries-deployments" target="_blank">deliveries</a> last year. The Model 3 now starts at about $37,000, and the Model Y is around $40,000. Tesla debuted more affordable versions of the vehicles late last year. </p><p>In its earnings announcement on Wednesday, Tesla reported its first annual revenue decline on record, with sales falling in three of the past four quarters. Musk has been trying to turn attention away from traditional EVs and toward a future of driverless cars and humanoid robots, areas where the company currently has virtually no business.</p><p>Tesla is developing Optimus with the aim of someday selling it as a bipedal, intelligent robot capable of everything from factory work to babysitting. The company said in the release that it plans to unveil the third generation of Optimus this quarter, its "first design meant for mass production."</p><p>Musk said on the call that Tesla is replacing its production line for S and X in Fremont "with a 1 million unit per year line of Optimus."</p><p>"Because it is a completely new supply chain," Musk said, "there's really nothing from the existing supply chain that exists in Optimus."</p><p>Tesla expects to boost headcount at the Fremont facility, Musk added, "and to significantly increase output."</p><p><strong>This is breaking news. Please refresh for updates.</strong></p><p><strong>WATCH:</strong> <a href="https://www.cnbc.com/video/2026/01/28/fast-money-traders-on-how-they-are-playing-tesla-after-earnings-report-boosts-stocks.html">How traders are playing Tesla</a></p></div><div id="Placeholder-ArticleBody-Video-108258644" data-test="VideoPlaceHolder" role="region" tabindex="0" data-vilynx-id="7000402215" aria-labelledby="Placeholder-ArticleBody-Video-108258644"><p><img src="https://image.cnbcfm.com/api/v1/image/108258657-1769639965310-1769639465-43735086212-hd.jpg?v=1769639966&amp;w=750&amp;h=422&amp;vtcrop=y" alt="'Fast Money' traders on how they are playing Tesla after earnings report boosts stocks"><span></span><span></span></p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Somebody used spoofed ADSB signals to raster the meme of JD Vance (475 pts)]]></title>
            <link>https://alecmuffett.com/article/143548</link>
            <guid>46802067</guid>
            <pubDate>Wed, 28 Jan 2026 21:50:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://alecmuffett.com/article/143548">https://alecmuffett.com/article/143548</a>, See on <a href="https://news.ycombinator.com/item?id=46802067">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>This, if it is still visible: </p>



<p><a href="https://globe.adsbexchange.com/?icao=adfdf9&amp;lat=26.678&amp;lon=-80.030&amp;zoom=14.4&amp;showTrace=2026-01-28">https://globe.adsbexchange.com/?icao=adfdf9&amp;lat=26.678&amp;lon=-80.030&amp;zoom=14.4&amp;showTrace=2026-01-28</a></p>



<p>Via:</p>



<figure><div><blockquote data-width="500" data-dnt="true"><p lang="en" dir="ltr">Someone is spoofing as a VC-25A / Air Force One making the meme image on ADSB. Call sign " VANCE1 " <a href="https://t.co/yZMj7bfJUU">pic.twitter.com/yZMj7bfJUU</a></p>— ??_???????????? (@SR_Planespotter) <a href="https://twitter.com/SR_Planespotter/status/2016394753772863848?ref_src=twsrc%5Etfw">January 28, 2026</a></blockquote></div></figure>



<p>Next up, age verification for ADSB? </p>




<div> <p><a href="https://alecmuffett.com/tti-cache/143548.png">⊞</a>
</p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Jellyfin LLM/"AI" Development Policy (185 pts)]]></title>
            <link>https://jellyfin.org/docs/general/contributing/llm-policies/</link>
            <guid>46801976</guid>
            <pubDate>Wed, 28 Jan 2026 21:42:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://jellyfin.org/docs/general/contributing/llm-policies/">https://jellyfin.org/docs/general/contributing/llm-policies/</a>, See on <a href="https://news.ycombinator.com/item?id=46801976">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><header><h2>Jellyfin LLM/"AI" Development Policy</h2></header>
<p>The rise of LLMs as a useful development tool over the last year or so has been significant. The power and flexibility of tools like Claude Code and ChatGPT have given a lot of functionality both to experienced developers and new developers alike. But there are trade-offs.</p>
<p>The Jellyfin project has, from day one, had a major focus on code quality - readability, simplicity, conciseness. This is a mostly manual effort driven by a dedicated team of individuals, and is motivated by a desire to fix the code Jellyfin is based off of which, without beating a dead horse too much, was extremely fragile, spaghettified, and prone to over-engineered complexity.</p>
<p>We are seeing a precipitous rise in contributors using AI within the Jellyfin ecosystem, both in the server and for clients, as well as a rise in criticism and concern about LLMs generally. At this time we are writing this policy to address exactly what we expect and desire with respect to contributions and interactions within our community that may use LLMs. These rules apply to all of our official projects and community spaces.</p>
<h2 id="general-guidelines">General Guidelines<a href="#general-guidelines" aria-label="Direct link to General Guidelines" title="Direct link to General Guidelines" translate="no">​</a></h2>
<ol>
<li>
<p>LLM output is <strong>expressly prohibited</strong> for any direct communication, including the following:</p>
<ul>
<li>issues or comments</li>
<li>feature requests or comments</li>
<li>pull request bodies or comments</li>
<li>forum/chat/etc. posts or comments</li>
</ul>
<p>In short, if you are posting <strong>any</strong> of those things, the output must be your own words, explanation, description, etc., not a verbatim dump of an LLM's output. We expect you to understand what you're posting. Violating this rule will result in closure/deletion of the offending item(s).</p>
<p>An exception will be made for <strong>LLM-assisted translations</strong> if you are having trouble accurately conveying your intent in English. Please explicitly note this ("I have translated this from MyLanguage with an LLM") and, if possible, post in your original language as well.</p>
</li>
<li>
<p>LLM code contributions are subject to more granularity below, but the general principle is that "pure 'vibe coding' will be rejected" and "you are responsible for what you commit". We will review in that vein. If the <strong>code looks terrible</strong>, it will be <strong>rejected as such</strong>.</p>
</li>
</ol>
<h2 id="llm-code-contributions-to-official-projects">LLM Code Contributions to Official Projects<a href="#llm-code-contributions-to-official-projects" aria-label="Direct link to LLM Code Contributions to Official Projects" title="Direct link to LLM Code Contributions to Official Projects" translate="no">​</a></h2>
<p>The use of LLMs for code is controversial and open to much interpretation. These guidelines are our best effort attempt to ensure that knowledgeable developers who seek to use these tools as a legitimate aid are not overly-hindered, while also preventing an ongoing flood of slop contributions that violate our core ethos above. These apply to <strong>all official Jellyfin projects</strong>.</p>
<ol>
<li>Contributions should be <strong>concise and focused</strong>. If the PR claims to target X, and is also touching unrelated Y and Z, it will be rejected. This includes incidental changes to unrelated functionality, a hallmark of poorly-worded or too-general prompts. Similarly, a large PR must be <strong>broken into multiple small, manageable commits</strong> for review and history purposes.</li>
<li>Formatting and quality <strong>standards must be upheld</strong>. Excessive unhelpful comments, spaghetti code, spaces on empty lines, etc. will be interpreted as pure LLM output and rejected; you must <strong>clean up the mess</strong> before submitting. Also <strong>do not commit LLM metafiles</strong> (e.g. <code>.claude</code> configs) or any other editor-created non-code files.</li>
<li>You must <strong>review the output</strong> and be able to <strong>explain</strong> in the PR body - <strong>without</strong> LLM output as noted above - <strong>what is being changed and why</strong>. Your PR body (and, if applicable, commit bodies) should be providing context to other developers about why a change was made, and if your name is on it, we want <strong>your</strong> words and explanations, not an LLM's. If <strong>you can't explain</strong> what the LLM did, we are <strong>not interested</strong> in the change.</li>
<li>The changes must be <strong>tested</strong>. The code should build and run correctly, or it will be rejected. You should also <strong>explicitly test the functionality being modified</strong>.</li>
<li>You must be able and willing to <strong>handle review feedback</strong> and implement the suggested change(s) as required. What this means in practice is, if you do not know what has been changed or why (see #3), and thus can't implement suggested changes or discuss them <strong>yourself</strong>, then we are <strong>not interested</strong> in the change. Just dumping reviewer feedback into an LLM and expecting what comes out to be "good enough", is not.</li>
<li><strong>Features or refactors</strong> require <strong>an in-depth level of understanding</strong> about what is being changed and why. It is obvious to our reviewers when changes are made without the developer making them understanding what is happening. These will be rejected. And as noted in #1, the PR must <strong>contain multiple discrete commits</strong>. <em>We</em> will squash commits as deemed appropriate after review. Large changes must also follow our other development policies (discussion, review, implementation, testing process).</li>
<li>The <strong>final discretion always lies with the reviewers</strong>. If your PR is not capable of being reasonably reviewed, for any reason (over-complexity, size, squashed commits, etc.) it will be rejected, and this goes just as much for non-LLM-assisted PRs as it does for LLM-assisted PRs. You will be asked to split such a PR up into multiple PRs that each present a focused, concise set of changes instead.</li>
</ol>
<p>The golden rule is this: <strong>do not just let an LLM loose on the codebase with a vague vibe prompt and then commit the results as-is</strong>. This is lazy development, will <strong>always</strong> result in a <strong>poor-quality contribution</strong> from our perspective, and we are not at all interested in such slop. <strong>Make an effort</strong> or please do not bother. And again, you are free to use LLMs to <strong>assist</strong> you, but not as the sole source of code changes.</p>

<p>You are of course free to do whatever you wish for your own non-official projects. However, we will be enforcing the following rules for any <strong>sharing of such projects within our communities</strong>.</p>
<ol>
<li>Any primarily-LLM-developed projects should be <strong>clearly marked as such</strong>. It is up to users to decide if this is acceptable to them or not. If you used an LLM for secondary assistance (e.g. docs, formatting, etc.) in an obvious way, we would err towards disclosure as well.</li>
<li>You <strong>must</strong> respect and follow licenses. If you are basing your project off of existing code, <strong>following its license is not optional</strong>. You must <strong>credit existing contributors in full</strong> for <strong>all contributions</strong>. Do not <strong>mangle the Git history</strong>, and do not <strong>commit pending 3rd party changes as your own</strong> (i.e. by copying the code and then committing it). Doing so will result in, not just rejection, but a ban from our organization and community. We have a <strong>zero tolerance policy</strong> for code theft and bad-faith attribution attempts.</li>
<li>For members of the community, <strong>do not report</strong> LLM-generated tools, clients, etc. <strong>on that basis alone</strong>, and do not engage in anti-LLM "witch hunts". As mentioned above, this is <strong>permitted</strong> and it is your choice whether to "support" said tool/client/etc. or not.</li>
<li>We, the moderators, are not going to play "LLM police" about 3rd party projects by nitpicking to try to "find LLM contributions" that otherwise follow our rules here; this is tedious and a waste of our time and effort. What this means in practice is that rule #1 is up to the author, and rule #3 must be interpreted in that vein. If you <strong>only suspect</strong> a tool is LLM-generated and violates rule #1, then downvote/ignore it and move on. <strong>Only if</strong> we see <strong>blatant breaking of rule #1</strong> we will enforce it, but again we will not be going through code line by line playing the "was this LLM generated?" game. Rule #2 will always be enforced regardless of LLM-ness or not.</li>
</ol></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Apple to Soon Take Up to 30% Cut from All Patreon Creators in iOS App (263 pts)]]></title>
            <link>https://www.macrumors.com/2026/01/28/patreon-apple-tax/</link>
            <guid>46801419</guid>
            <pubDate>Wed, 28 Jan 2026 20:59:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.macrumors.com/2026/01/28/patreon-apple-tax/">https://www.macrumors.com/2026/01/28/patreon-apple-tax/</a>, See on <a href="https://news.ycombinator.com/item?id=46801419">Hacker News</a></p>
<div id="readability-page-1" class="page"><div role="main" id="maincontent"><article expanded="true"><div data-io-article-url="/2026/01/28/patreon-apple-tax/"><p>Apple has set a new deadline of November 1, 2026 for all <a href="https://apps.apple.com/us/app/patreon/id1044456188">Patreon</a> creators to switch from Patreon's legacy billing system to the App Store's in-app purchase system in the Patreon app on the iPhone and iPad, as <a href="https://techcrunch.com/2026/01/28/apple-tells-patreon-to-move-creators-to-in-app-purchase-for-subscriptions-by-november/">reported by <em>TechCrunch</em></a>.</p>
<p><img src="https://images.macrumors.com/t/juCKbtsR6vHD7VJNMPfqcM2EVg0=/400x0/article-new/2026/01/Tim-Cooking.jpg?lossy" srcset="https://images.macrumors.com/t/juCKbtsR6vHD7VJNMPfqcM2EVg0=/400x0/article-new/2026/01/Tim-Cooking.jpg?lossy 400w,https://images.macrumors.com/t/PfYdfRInOmELVWISdbgtd2cZV0A=/800x0/article-new/2026/01/Tim-Cooking.jpg?lossy 800w,https://images.macrumors.com/t/HPvkDF3sphYEAzKX3QfLArhr0no=/1600x0/article-new/2026/01/Tim-Cooking.jpg 1600w,https://images.macrumors.com/t/mA15gUqGqDeRPDXf1g4fX10o200=/2500x0/filters:no_upscale()/article-new/2026/01/Tim-Cooking.jpg 2500w" sizes="(max-width: 900px) 100vw, 697px" alt="Tim Cooking" width="1600" height="900"><em><small>Note: This image has been edited to include a pile of cash.</small></em></p><p>Patreon is a platform where creators such as YouTubers can receive payments from fans, which can be a valuable revenue stream alongside ads and sponsorships.</p>
<p>Apple initially told Patreon that its creators must move to the App Store's in-app purchase system <a href="https://www.macrumors.com/2024/08/12/patreon-in-app-purchase-fees/">by November 2025</a>, or else Patreon would risk removal from the App Store, but the deadline was pushed back. Apple considers payments from supporters to creators on Patreon to be digital goods that it is entitled to receive a commission on.</p>
<p>Apple receives a 30% commission on in-app purchases and subscriptions, but this drops to 15% for a subscription that has been ongoing for more than a year.</p>
<p>Patreon gives creators the option to either increase their prices in the iOS app only, or absorb the fee themselves, keeping prices the same across platforms.</p>
<p>On the iPhone and iPad, Patreon users who wish to support a creator can sidestep the App Store's commission by completing their payment via Patreon's website.</p>
<p>Patreon said it is disappointed with how Apple has navigated this policy.</p>
<p>According to <em>TechCrunch</em>, only 4% of Patreon creators are still using the platform's legacy billing system, with the rest having already switched over.</p>
<p>Patreon has <a href="https://support.patreon.com/hc/en-us/articles/28801582599181-iOS-In-app-Purchases-and-Migrating-to-Subscription-Billing-FAQ">shared a FAQ</a> with more details for creators.</p>
</div></article><p><h2>Popular Stories</h2></p><div><h3><a href="https://www.macrumors.com/2026/01/26/apple-unveils-first-two-products-of-2026/">Apple Unveils First New Products of 2026</a></h3><p>Apple today introduced its first two physical products of 2026: a second-generation AirTag and the Black Unity Connection Braided Solo Loop for the Apple Watch.
Read our coverage of each announcement to learn more:Apple Unveils New AirTag With Longer Range, Louder Speaker, and More
Apple Introduces New Black Unity Apple Watch BandBoth the new AirTag and the Black Unity Connection Braided...</p></div><div><h3><a href="https://www.macrumors.com/2026/01/26/iphone-5s-software-update/">iPhone 5s Gets New Software Update 13 Years After Launch</a></h3><p>Monday January 26, 2026 3:56 pm PST by <a href="https://www.macrumors.com/author/juli-clover/" rel="author">Juli Clover</a></p><p>Alongside iOS 26.2.1, Apple today released an updated version of iOS 12 for devices that are still running that operating system update, eight years after the software was first released.
iOS 12.5.8 is available for the iPhone 5s and the iPhone 6, meaning Apple is continuing to support these devices for 13 and 12 years after launch, respectively. The iPhone 5s came out in September 2013,...</p></div><div><h3><a href="https://www.macrumors.com/2026/01/26/apple-announces-new-airtag/">Apple Unveils New AirTag With Longer Range, Louder Speaker, and More</a></h3><p>Apple today introduced the second-generation AirTag, with key features including longer range for tracking items and a louder speaker.
For those who are not familiar, the AirTag is a small accessory that you can attach to your backpack, keys, or other items. Then, you can track the location of those items in the Find My app on the iPhone, iPad, Mac, Apple Watch, and iCloud.com.
The new...</p></div><div><h3><a href="https://www.macrumors.com/2026/01/25/rumored-apple-products/">Apple to Launch These 20+ Products This Year</a></h3><p>2026 promises to be yet another busy year for Apple, with the company rumored to be planning more than 20 product announcements over the coming months.
Beyond the usual updates to iPhones, iPads, Macs, and Apple Watches, Apple is expected to release its all-new smart home hub, which was reportedly delayed until the more personalized version of Siri is ready. Other unique products rumored for ...</p></div><div><h3><a href="https://www.macrumors.com/2026/01/27/apples-next-launch-is-tomorrow/">Apple's Next Launch is Today</a></h3><p>Tuesday January 27, 2026 2:39 pm PST by <a href="https://www.macrumors.com/author/joe-rossignol/" rel="author">Joe Rossignol</a></p><p>Update: Apple Creator Studio is now available.
Apple Creator Studio launches this Wednesday, January 28. The all-in-one subscription provides access to the Final Cut Pro, Logic Pro, Pixelmator Pro, Motion, Compressor, and MainStage apps, with U.S. pricing set at $12.99 per month or $129 per year.
A subscription to Apple Creator Studio also unlocks "intelligent features" and "premium...</p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Native Instruments enters into insolvency proceedings (103 pts)]]></title>
            <link>https://www.engadget.com/audio/native-instruments-enters-into-insolvency-proceedings-leaving-its-future-uncertain-183206826.html</link>
            <guid>46800645</guid>
            <pubDate>Wed, 28 Jan 2026 19:51:05 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.engadget.com/audio/native-instruments-enters-into-insolvency-proceedings-leaving-its-future-uncertain-183206826.html">https://www.engadget.com/audio/native-instruments-enters-into-insolvency-proceedings-leaving-its-future-uncertain-183206826.html</a>, See on <a href="https://news.ycombinator.com/item?id=46800645">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-article-body="true"><p>Music hardware and software manufacturer Native Instruments has entered into preliminary insolvency proceedings, <a data-i13n="cpos:1;pos:1" href="https://cdm.link/ni-insolvency/" rel="nofollow noopener" target="_blank" data-ylk="slk:according to a report by Create Digital Music;cpos:1;pos:1;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;according to a report by Create Digital Music&quot;,&quot;yLinkPosition&quot;:&quot;1&quot;,&quot;yPosition&quot;:&quot;1&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}"><ins>according to a report by </ins><em><ins>Create Digital Music</ins></em></a>. This is the company behind iconic software like Massive, Traktor and Kontakt and hardware like Maschine+. Native Instruments also owns the brands iZotope, Brainworx and Plugin Alliance.</p><p>We don't have many specifics as to what this entails and what the future of the company will look like. We do know that an administrator has been appointed to handle restructuring and, potentially, to sell off existing assets. Native Instruments employs hundreds of people and their fates also remain uncertain.</p><p>A private equity firm called Francisco Partners owns a majority stake in the company. It also owns majority stakes in entities like GoodRX and Verifone, among others. This isn't the first time Native Instruments has been forced into major restructuring. The company experienced plenty of layoffs and uncertainty <a data-i13n="cpos:2;pos:1" href="https://djtechtools.com/2019/09/03/shakeups-layoffs-whats-happening-at-native-instruments/" rel="nofollow noopener" target="_blank" data-ylk="slk:between 2019 and 2020;cpos:2;pos:1;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;between 2019 and 2020&quot;,&quot;yLinkPosition&quot;:&quot;2&quot;,&quot;yPosition&quot;:&quot;1&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}"><ins>between 2019 and 2020</ins></a> before being purchased by private equity.</p><p>Again, we have no idea how this will shake out. It's possible that new investors will jump on board and it goes back to business as usual. It's also possible everything will be scrapped for parts and sold to the highest bidder.</p><div><blockquote><div><p>Plugin Alliance, with entities in the US and Germany, says there's no immediate impact of the NI insolvency on them. <a href="https://t.co/u6smg1X0t4" rel="nofollow noopener" target="_blank" data-ylk="slk:https://t.co/u6smg1X0t4;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;https&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}">https://t.co/u6smg1X0t4</a> <a href="https://t.co/ok7BRwo3BU" rel="nofollow noopener" target="_blank" data-ylk="slk:pic.twitter.com/ok7BRwo3BU;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;pic.twitter.com/ok7BRwo3BU&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}">pic.twitter.com/ok7BRwo3BU</a></p><p>— cdmblogs (@cdmblogs) <a href="https://twitter.com/cdmblogs/status/2016499892064014356?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank" data-ylk="slk:January 28, 2026;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;January 28, 2026&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}">January 28, 2026</a></p></div></blockquote></div><p>We do know that subsidiary Plugin Alliance seems to be unaffected. It issued a <a data-i13n="cpos:3;pos:1" href="https://www.gearnews.com/native-instruments-insolvency/" rel="nofollow noopener" target="_blank" data-ylk="slk:statement on Facebook;cpos:3;pos:1;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;statement on Facebook&quot;,&quot;yLinkPosition&quot;:&quot;3&quot;,&quot;yPosition&quot;:&quot;1&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}">statement on Facebook</a> saying that it isn't involved with the proceedings and that operations will continue as normal. This means new plugins will be released, along with updates for current software.</p><p>Everything else is still up in the air. This is troubling for those who have heavily invested in the company's ecosystem of products. I'm one of them. Any hope I had for a <a data-i13n="cpos:4;pos:1" href="https://www.engadget.com/maschine-plus-native-instruments-virtual-instruments-groovebox-155725975.html" data-ylk="slk:hardware refresh of the Maschine+;cpos:4;pos:1;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;hardware refresh of the Maschine+&quot;,&quot;yLinkPosition&quot;:&quot;4&quot;,&quot;yPosition&quot;:&quot;1&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}"><ins>hardware refresh of the Maschine+</ins></a> just went out the window.</p><iframe height="auto" loading="lazy" src="https://www.youtube.com/embed/D4u79Z3_7xw?si=VjUk1AlbtO89Dx0e" title="youtube embed content" width="100%" data-pw="iframe"></iframe><p>If the company's robust line of software goes up for sale, Akai is likely the best bet. It has already begun incorporating <a data-i13n="cpos:5;pos:1" href="https://www.engadget.com/entertainment/music/many-akai-devices-will-soon-support-native-instruments-sound-packs-140059822.html" data-ylk="slk:Native Instruments software into MPC machines;cpos:5;pos:1;elm:context_link;itc:0;sec:content-canvas" data-yga="{&quot;yLinkText&quot;:&quot;Native Instruments software into MPC machines&quot;,&quot;yLinkPosition&quot;:&quot;5&quot;,&quot;yPosition&quot;:&quot;1&quot;,&quot;yLinkElement&quot;:&quot;context_link&quot;,&quot;yModuleName&quot;:&quot;content-canvas&quot;,&quot;yHasCommerce&quot;:false}"><ins>Native Instruments software into MPC machines</ins></a>.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: A MitM proxy to see what your LLM tools are sending (160 pts)]]></title>
            <link>https://github.com/jmuncor/sherlock</link>
            <guid>46799898</guid>
            <pubDate>Wed, 28 Jan 2026 18:52:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/jmuncor/sherlock">https://github.com/jmuncor/sherlock</a>, See on <a href="https://news.ycombinator.com/item?id=46799898">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">Sherlock</h2><a id="user-content-sherlock" aria-label="Permalink: Sherlock" href="#sherlock"></a></p>
  <p dir="auto">
    <strong>LLM API Traffic Inspector &amp; Token Usage Dashboard</strong>
  </p>
  <p dir="auto">
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/f12b46fe26968f97149ee10725a248ec02c28ce205f9f5d3c40ef06a38de8ea0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e31302b2d3337373641423f6c6f676f3d707974686f6e266c6f676f436f6c6f723d7768697465"><img src="https://camo.githubusercontent.com/f12b46fe26968f97149ee10725a248ec02c28ce205f9f5d3c40ef06a38de8ea0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d332e31302b2d3337373641423f6c6f676f3d707974686f6e266c6f676f436f6c6f723d7768697465" alt="Python" data-canonical-src="https://img.shields.io/badge/python-3.10+-3776AB?logo=python&amp;logoColor=white"></a>
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/8bb50fd2278f18fc326bf71f6e88ca8f884f72f179d3e555e20ed30157190d0d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d677265656e2e737667"><img src="https://camo.githubusercontent.com/8bb50fd2278f18fc326bf71f6e88ca8f884f72f179d3e555e20ed30157190d0d/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d677265656e2e737667" alt="License" data-canonical-src="https://img.shields.io/badge/license-MIT-green.svg"></a>
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/09bd1562a600554ab1374f91b4008b5ab76f2b940faeb41a15b6946cffc63a62/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f706c6174666f726d2d6d61634f532532302537432532304c696e75782d6c69676874677265792e737667"><img src="https://camo.githubusercontent.com/09bd1562a600554ab1374f91b4008b5ab76f2b940faeb41a15b6946cffc63a62/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f706c6174666f726d2d6d61634f532532302537432532304c696e75782d6c69676874677265792e737667" alt="Platform" data-canonical-src="https://img.shields.io/badge/platform-macOS%20%7C%20Linux-lightgrey.svg"></a>
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/3b1e543a676609e6d74d9b2079b0f9ceb22976b2d14e351901bfbb6b28d9a461/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f70726f78792d6d69746d70726f78792d6f72616e67652e737667"><img src="https://camo.githubusercontent.com/3b1e543a676609e6d74d9b2079b0f9ceb22976b2d14e351901bfbb6b28d9a461/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f70726f78792d6d69746d70726f78792d6f72616e67652e737667" alt="mitmproxy" data-canonical-src="https://img.shields.io/badge/proxy-mitmproxy-orange.svg"></a>
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/c55777bc9bb31c546f01368c76676f01b722560af7b40cd14f62af97550f87db/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c4c4d2d416e7468726f706963253230436c617564652d626c756576696f6c65742e737667"><img src="https://camo.githubusercontent.com/c55777bc9bb31c546f01368c76676f01b722560af7b40cd14f62af97550f87db/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c4c4d2d416e7468726f706963253230436c617564652d626c756576696f6c65742e737667" alt="Anthropic" data-canonical-src="https://img.shields.io/badge/LLM-Anthropic%20Claude-blueviolet.svg"></a>
  </p>
  <p dir="auto">
    <a href="#installation">Installation</a> •
    <a href="#quick-start">Quick Start</a> •
    <a href="#features">Features</a> •
    <a href="#commands">Commands</a> •
    <a href="#contributing">Contributing</a>
  </p>

<hr>
<p dir="auto">Sherlock is a transparent proxy that intercepts HTTPS traffic to LLM APIs and displays real-time token usage in a beautiful terminal dashboard. Track your AI costs, debug prompts, and monitor context window usage across your development session.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Why Sherlock?</h2><a id="user-content-why-sherlock" aria-label="Permalink: Why Sherlock?" href="#why-sherlock"></a></p>
<ul dir="auto">
<li><strong>Track Token Usage</strong>: See exactly how many tokens each request consumes</li>
<li><strong>Monitor Context Windows</strong>: Visual fuel gauge shows cumulative usage against your limit</li>
<li><strong>Debug Prompts</strong>: Automatically saves every prompt as markdown and JSON for review</li>
<li><strong>Zero Code Changes</strong>: Works with any tool that respects proxy environment variables</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="# Clone the repository
git clone https://github.com/jmuncor/sherlock.git
cd sherlock

# Install in development mode
pip install -e ."><pre><span><span>#</span> Clone the repository</span>
git clone https://github.com/jmuncor/sherlock.git
<span>cd</span> sherlock

<span><span>#</span> Install in development mode</span>
pip install -e <span>.</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Requirements</h3><a id="user-content-requirements" aria-label="Permalink: Requirements" href="#requirements"></a></p>
<ul dir="auto">
<li>Python 3.10+</li>
<li>Node.js (for intercepting Node.js applications like Claude Code)</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Quick Start</h2><a id="user-content-quick-start" aria-label="Permalink: Quick Start" href="#quick-start"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">1. Start Sherlock</h3><a id="user-content-1-start-sherlock" aria-label="Permalink: 1. Start Sherlock" href="#1-start-sherlock"></a></p>

<p dir="auto">On first run, Sherlock will:</p>
<ul dir="auto">
<li>Generate the mitmproxy CA certificate</li>
<li>Prompt you to install it in your system trust store</li>
<li>Ask where to save intercepted prompts</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">2. Run Your LLM Tools</h3><a id="user-content-2-run-your-llm-tools" aria-label="Permalink: 2. Run Your LLM Tools" href="#2-run-your-llm-tools"></a></p>
<p dir="auto">In a separate terminal, use Sherlock to proxy your commands:</p>
<div dir="auto" data-snippet-clipboard-copy-content="# For Claude Code
sherlock claude

# For any command
sherlock run --node your-llm-tool"><pre><span><span>#</span> For Claude Code</span>
sherlock claude

<span><span>#</span> For any command</span>
sherlock run --node your-llm-tool</pre></div>
<p dir="auto">That's it! Watch the dashboard update in real-time as you interact with LLM APIs.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Live Terminal Dashboard</h3><a id="user-content-live-terminal-dashboard" aria-label="Permalink: Live Terminal Dashboard" href="#live-terminal-dashboard"></a></p>
<div data-snippet-clipboard-copy-content="┌─────────────────────────────────────────────────────────────┐
│  🔍 SHERLOCK - LLM Traffic Inspector                        │
├─────────────────────────────────────────────────────────────┤
│  Context Usage  ████████████░░░░░░░░░░░░░░░░  42%           │
│                 (84,231 / 200,000 tokens)                   │
├─────────────────────────────────────────────────────────────┤
│  Time     Provider    Model                      Tokens     │
│  14:23:01 Anthropic   claude-sonnet-4-20250514   12,847     │
│  14:23:45 Anthropic   claude-sonnet-4-20250514   8,234      │
│  14:24:12 Anthropic   claude-sonnet-4-20250514   15,102     │
├─────────────────────────────────────────────────────────────┤
│  Last Prompt: &quot;Can you help me refactor this function...&quot;   │
└─────────────────────────────────────────────────────────────┘"><pre><code>┌─────────────────────────────────────────────────────────────┐
│  🔍 SHERLOCK - LLM Traffic Inspector                        │
├─────────────────────────────────────────────────────────────┤
│  Context Usage  ████████████░░░░░░░░░░░░░░░░  42%           │
│                 (84,231 / 200,000 tokens)                   │
├─────────────────────────────────────────────────────────────┤
│  Time     Provider    Model                      Tokens     │
│  14:23:01 Anthropic   claude-sonnet-4-20250514   12,847     │
│  14:23:45 Anthropic   claude-sonnet-4-20250514   8,234      │
│  14:24:12 Anthropic   claude-sonnet-4-20250514   15,102     │
├─────────────────────────────────────────────────────────────┤
│  Last Prompt: "Can you help me refactor this function..."   │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Prompt Archive</h3><a id="user-content-prompt-archive" aria-label="Permalink: Prompt Archive" href="#prompt-archive"></a></p>
<p dir="auto">Every intercepted request is saved as:</p>
<ul dir="auto">
<li><strong>Markdown</strong> - Human-readable format with metadata</li>
<li><strong>JSON</strong> - Raw API request body for debugging</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">Context Fuel Gauge</h3><a id="user-content-context-fuel-gauge" aria-label="Permalink: Context Fuel Gauge" href="#context-fuel-gauge"></a></p>
<p dir="auto">Visual progress bar with color-coded warnings:</p>
<ul dir="auto">
<li>🟢 Green: &lt; 50% usage</li>
<li>🟡 Yellow: 50-80% usage</li>
<li>🔴 Red: &gt; 80% usage</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Commands</h2><a id="user-content-commands" aria-label="Permalink: Commands" href="#commands"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sherlock</code></td>
<td>Start the proxy and dashboard</td>
</tr>
<tr>
<td><code>sherlock start</code></td>
<td>Same as above (explicit)</td>
</tr>
<tr>
<td><code>sherlock claude</code></td>
<td>Run Claude Code with proxy configured</td>
</tr>
<tr>
<td><code>sherlock run &lt;cmd&gt;</code></td>
<td>Run any command with proxy configured</td>
</tr>
<tr>
<td><code>sherlock run --node &lt;cmd&gt;</code></td>
<td>Run Node.js app with proxy configured</td>
</tr>
<tr>
<td><code>sherlock check-certs</code></td>
<td>Verify CA certificate installation</td>
</tr>
<tr>
<td><code>sherlock install-certs</code></td>
<td>Show certificate installation instructions</td>
</tr>
<tr>
<td><code>sherlock env</code></td>
<td>Print proxy environment variables</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Options</h3><a id="user-content-options" aria-label="Permalink: Options" href="#options"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="sherlock start [OPTIONS]

Options:
  -p, --port NUM          Proxy port (default: 8080)
  -l, --limit NUM         Token limit for fuel gauge (default: 200000)
  --persist               Save token history across sessions
  --skip-cert-check       Skip certificate verification"><pre>sherlock start [OPTIONS]

Options:
  -p, --port NUM          Proxy port (default: 8080)
  -l, --limit NUM         Token limit <span>for</span> fuel gauge (default: 200000)
  --persist               Save token <span>history</span> across sessions
  --skip-cert-check       Skip certificate verification</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">How It Works</h2><a id="user-content-how-it-works" aria-label="Permalink: How It Works" href="#how-it-works"></a></p>
<div data-snippet-clipboard-copy-content="┌──────────────────────────────────────────────────────────────────┐
│                      Your LLM Application                        │
│              (with proxy environment variables)                  │
└─────────────────────────────┬────────────────────────────────────┘
                              │ HTTPS
                              ▼
┌──────────────────────────────────────────────────────────────────┐
│                     mitmproxy (port 8080)                        │
│                   + Sherlock Interceptor                         │
└─────────────────────────────┬────────────────────────────────────┘
                              │ Parsed events
                              ▼
┌──────────────────────────────────────────────────────────────────┐
│                    Sherlock Dashboard                            │
│              Token tracking • Request log • Prompt preview       │
└──────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ~/.sherlock/prompts/
                    ├── 2024-01-15_14-23-01_anthropic.md
                    └── 2024-01-15_14-23-01_anthropic.json"><pre><code>┌──────────────────────────────────────────────────────────────────┐
│                      Your LLM Application                        │
│              (with proxy environment variables)                  │
└─────────────────────────────┬────────────────────────────────────┘
                              │ HTTPS
                              ▼
┌──────────────────────────────────────────────────────────────────┐
│                     mitmproxy (port 8080)                        │
│                   + Sherlock Interceptor                         │
└─────────────────────────────┬────────────────────────────────────┘
                              │ Parsed events
                              ▼
┌──────────────────────────────────────────────────────────────────┐
│                    Sherlock Dashboard                            │
│              Token tracking • Request log • Prompt preview       │
└──────────────────────────────────────────────────────────────────┘
                              │
                              ▼
                    ~/.sherlock/prompts/
                    ├── 2024-01-15_14-23-01_anthropic.md
                    └── 2024-01-15_14-23-01_anthropic.json
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Supported Providers</h2><a id="user-content-supported-providers" aria-label="Permalink: Supported Providers" href="#supported-providers"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Provider</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Anthropic (Claude)</td>
<td>✅ Supported</td>
</tr>
<tr>
<td>OpenAI</td>
<td>🔜 Coming soon</td>
</tr>
<tr>
<td>Google Gemini</td>
<td>🔜 Coming soon</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h2 tabindex="-1" dir="auto">Configuration</h2><a id="user-content-configuration" aria-label="Permalink: Configuration" href="#configuration"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Certificate Setup</h3><a id="user-content-certificate-setup" aria-label="Permalink: Certificate Setup" href="#certificate-setup"></a></p>
<p dir="auto">Sherlock uses mitmproxy to intercept HTTPS traffic. On first run, it will guide you through installing the CA certificate.</p>
<p dir="auto"><strong>macOS:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo security add-trusted-cert -d -r trustRoot \
  -k /Library/Keychains/System.keychain \
  ~/.mitmproxy/mitmproxy-ca-cert.pem"><pre>sudo security add-trusted-cert -d -r trustRoot \
  -k /Library/Keychains/System.keychain \
  <span>~</span>/.mitmproxy/mitmproxy-ca-cert.pem</pre></div>
<p dir="auto"><strong>Ubuntu/Debian:</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo cp ~/.mitmproxy/mitmproxy-ca-cert.pem \
  /usr/local/share/ca-certificates/mitmproxy-ca-cert.crt
sudo update-ca-certificates"><pre>sudo cp <span>~</span>/.mitmproxy/mitmproxy-ca-cert.pem \
  /usr/local/share/ca-certificates/mitmproxy-ca-cert.crt
sudo update-ca-certificates</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Environment Variables</h3><a id="user-content-environment-variables" aria-label="Permalink: Environment Variables" href="#environment-variables"></a></p>
<p dir="auto">For manual proxy configuration:</p>
<div dir="auto" data-snippet-clipboard-copy-content="export HTTP_PROXY=&quot;http://127.0.0.1:8080&quot;
export HTTPS_PROXY=&quot;http://127.0.0.1:8080&quot;
export NODE_EXTRA_CA_CERTS=&quot;$HOME/.mitmproxy/mitmproxy-ca-cert.pem&quot;"><pre><span>export</span> HTTP_PROXY=<span><span>"</span>http://127.0.0.1:8080<span>"</span></span>
<span>export</span> HTTPS_PROXY=<span><span>"</span>http://127.0.0.1:8080<span>"</span></span>
<span>export</span> NODE_EXTRA_CA_CERTS=<span><span>"</span><span>$HOME</span>/.mitmproxy/mitmproxy-ca-cert.pem<span>"</span></span></pre></div>
<p dir="auto">Or use the helper:</p>

<p dir="auto"><h2 tabindex="-1" dir="auto">Contributing</h2><a id="user-content-contributing" aria-label="Permalink: Contributing" href="#contributing"></a></p>
<p dir="auto">Contributions are welcome! Here's how you can help:</p>
<ol dir="auto">
<li><strong>Fork</strong> the repository</li>
<li><strong>Create</strong> a feature branch (<code>git checkout -b feature/amazing-feature</code>)</li>
<li><strong>Commit</strong> your changes (<code>git commit -m 'Add amazing feature'</code>)</li>
<li><strong>Push</strong> to the branch (<code>git push origin feature/amazing-feature</code>)</li>
<li><strong>Open</strong> a Pull Request</li>
</ol>
<p dir="auto"><h3 tabindex="-1" dir="auto">Development Setup</h3><a id="user-content-development-setup" aria-label="Permalink: Development Setup" href="#development-setup"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/yourusername/sherlock.git
cd sherlock
python -m venv venv
source venv/bin/activate
pip install -e ."><pre>git clone https://github.com/yourusername/sherlock.git
<span>cd</span> sherlock
python -m venv venv
<span>source</span> venv/bin/activate
pip install -e <span>.</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Adding Provider Support</h3><a id="user-content-adding-provider-support" aria-label="Permalink: Adding Provider Support" href="#adding-provider-support"></a></p>
<p dir="auto">To add support for a new LLM provider:</p>
<ol dir="auto">
<li>Add the API host to <code>sherlock/config.py</code></li>
<li>Create a parser function in <code>sherlock/parser.py</code></li>
<li>Update the <code>parse_request()</code> function to route to your parser</li>
</ol>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto">This project is licensed under the MIT License - see the <a href="https://github.com/jmuncor/sherlock/blob/main/LICENSE">LICENSE</a> file for details.</p>
<hr>
<p dir="auto">
  <em>See what's really being sent to the LLM. Learn. Optimize. Repeat.</em>
</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[LM Studio 0.4 (140 pts)]]></title>
            <link>https://lmstudio.ai/blog/0.4.0</link>
            <guid>46799477</guid>
            <pubDate>Wed, 28 Jan 2026 18:23:14 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lmstudio.ai/blog/0.4.0">https://lmstudio.ai/blog/0.4.0</a>, See on <a href="https://news.ycombinator.com/item?id=46799477">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Today we are thrilled to share <strong node="[object Object]">LM Studio 0.4.0</strong>, the next generation of LM Studio.</p>
<p>This release introduces parallel requests with continuous batching for high throughput serving, all-new non-GUI deployment option, new stateful REST API, and a refreshed user interface.</p>
<div><p><img src="https://lmstudio.ai/assets/blog/0.4.0/app-screen.png" alt="LM Studio 0.4.0 is here" data-caption=""></p></div>
<p><strong node="[object Object]">LM Studio 0.4.0 highlights include</strong>:</p>
<ul node="[object Object]">
<li>Deploy LM Studio's core on cloud servers, in CI, or anywhere without GUI.</li>
<li>Parallel requests to the same model with continuous batching (instead of queueing).</li>
<li>New stateful REST API endpoint: <code dir="ltr">/v1/chat</code> that allows using local MCPs.</li>
<li>Refreshed application UI with chat export, split view, developer mode, and in-app docs.</li>
</ul>
<p>Read on for more details!</p>
<hr node="[object Object]">
<h2 id="deploy-on-servers-deploy-in-ci-deploy-anywhere" node="[object Object]"><span>Deploy on servers, deploy in CI, deploy anywhere</span><a href="#deploy-on-servers-deploy-in-ci-deploy-anywhere" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<div><p><img src="https://lmstudio.ai/assets/blog/0.4.0/daemon@2x.png" alt="Daemon mode" data-caption=""></p></div>
<p>Today we're introducing <code dir="ltr">llmster</code>: it's the core of the LM Studio desktop app, but packaged to be server-native, without reliance on the GUI. We've rearchitected our software to separate the GUI from the core functionality, allowing <code dir="ltr">llmster</code> to run as a standalone daemon.</p>
<p>This means <code dir="ltr">llmster</code> can be run completely independently of the app and deployed anywhere: Linux boxes, cloud servers, your GPU rig, or even Google Colabs. It can of course still be run on your local machine without the GUI, for those who prefer terminal-based workflows.</p>
<h3 id="how-to-install-llmster" node="[object Object]"><span>How to install <code dir="ltr">llmster</code></span><a href="#how-to-install-llmster" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong node="[object Object]">Linux / Mac</strong></p>
<pre dir="ltr"><div><pre tabindex="0"><code><span><span>curl</span><span> -fsSL</span><span> https://lmstudio.ai/install.sh </span><span>|</span><span> bash</span></span>
<span></span></code></pre></div></pre>
<p><strong node="[object Object]">Windows</strong></p>
<pre dir="ltr"><div><pre tabindex="0"><code><span><span>irm</span><span> https://lmstudio.ai/install.ps1 </span><span>|</span><span> iex</span></span>
<span></span></code></pre></div></pre>
<h3 id="using-llmster" node="[object Object]"><span>Using <code dir="ltr">llmster</code></span><a href="#using-llmster" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul node="[object Object]">
<li>Start the daemon: <code dir="ltr">lms daemon up</code></li>
<li>Download a model: <code dir="ltr">lms get &lt;model&gt;</code></li>
<li>Start the local server: <code dir="ltr">lms server start</code></li>
<li>Open an interactive session: <code dir="ltr">lms chat</code></li>
<li>Update your runtime: <code dir="ltr">lms runtime update llama.cpp</code> (and <code dir="ltr">lms runtime update mlx</code> on macOS)</li>
</ul>
<div><p><img src="https://lmstudio.ai/assets/blog/0.4.0/llmster@2x.png" alt="Llmster" data-caption=""></p></div>
<hr node="[object Object]">
<h2 id="parallel-requests" node="[object Object]"><span>Parallel Requests</span><a href="#parallel-requests" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Alongside LM Studio 0.4.0, our llama.cpp engine is graduating to version 2.0.0. With it we're introducing support for concurrent inference requests to the same model.</p>
<div><p><video loop="" controls="" muted="" playsinline="" data-caption="Run parallel requests in the app with Split View" caption="Run parallel requests in the app with Split View">
  <source src="https://files.lmstudio.ai/parallel-gui.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video></p><div><p>Run parallel requests in the app with Split View</p></div></div>
<h3 id="max-concurrent-predictions-and-unified-kv-cache" node="[object Object]"><span>Max Concurrent Predictions and Unified KV Cache</span><a href="#max-concurrent-predictions-and-unified-kv-cache" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>You will find 2 new load options in the model loader dialog:</p>
<ul node="[object Object]">
<li>
<p><strong node="[object Object]">Max Concurrent Predictions</strong>: sets the maximum number of concurrent requests that can be processed by the model. Requests beyond this limit will be queued.</p>
</li>
<li>
<p><strong node="[object Object]">Unified KV Cache</strong>: when enabled, preallocated resources will not be hard-partitioned per concurrent request, allowing varying request sizes per request. This is enabled by default.</p>
</li>
</ul>
<p>Parallel requests work thanks to llama.cpp's open-source continuous batching implementation, adopted in LM Studio's llm-engine. This capability has not yet made it into our MLX engine, but it is actively in the works and will land soon.</p>
<hr node="[object Object]">
<h2 id="ui-refresh" node="[object Object]"><span>UI Refresh</span><a href="#ui-refresh" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>We have refreshed LM Studio's user interface from the ground up for a more consistent and pleasant experience.</p>
<div><p><img src="https://lmstudio.ai/assets/blog/0.4.0/export@2x.png" alt="Export your chats" data-caption="Export your chats" caption="Export your chats"></p></div>
<h4>Export chats to PDF, markdown, or text</h4>
<p>You can now export your chats to PDF, markdown, or plain text. Click the ••• menu on a chat and head to "Export" for all available options.</p>
<h4>Split View</h4>
<p>You can now open multiple chat sessions side by side using Split View. Click the new Split View icon in the top right corner of the chat window to open a new chat pane.</p>
<h4>Developer Mode</h4>
<p>Developer Mode is a new setting that exposes advanced options in the app. You can enable it from Settings &gt; Developer. Once enabled, it'll reveal all advanced options across the app, including in the model loader dialog and sidebars.</p>
<h4>In-app docs</h4>
<p>Head over to the Developer tab to see the new in-app documentation. It covers the new REST API, CLI commands, and advanced configuration options.</p>
<hr node="[object Object]">
<h2 id="new-cli-experience" node="[object Object]"><span>New CLI Experience</span><a href="#new-cli-experience" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<div><p><video loop="" controls="" muted="" playsinline="" data-caption="New CLI experience" caption="New CLI experience">
  <source src="https://files.lmstudio.ai/lms-chat.mov" type="video/mp4">
  Your browser does not support the video tag.
</video></p></div>
<h3 id="introducing-lms-chat" node="[object Object]"><span>Introducing <code dir="ltr">lms chat</code></span><a href="#introducing-lms-chat" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>With LM Studio 0.4.0, we're introducing a brand-new CLI experience centered around the <code dir="ltr">lms chat</code> command. This command opens an interactive chat session directly in your terminal, allowing you to chat with your models and download new ones.</p>
<p>Run <code dir="ltr">lms chat --help</code> to see all available options.</p>
<hr node="[object Object]">
<h2 id="new-stateful-rest-api-endpoint-v1chat" node="[object Object]"><span>New stateful REST API endpoint: <code dir="ltr">/v1/chat</code></span><a href="#new-stateful-rest-api-endpoint-v1chat" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<div><p><img src="https://lmstudio.ai/assets/blog/0.4.0/tokens@2x.png" alt="Server" data-caption=""></p></div>
<h3 id="v1chat-endpoint" node="[object Object]"><span><code dir="ltr">/v1/chat</code> endpoint</span><a href="#v1chat-endpoint" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><code dir="ltr">/v1/chat</code> is a new first-party REST endpoint for chatting with local models from your apps.</p>
<p>Unlike typical "stateless" chat APIs, <code dir="ltr">/v1/chat</code> is <strong node="[object Object]">stateful</strong>: you can start a conversation, get back a <code dir="ltr">response_id</code>, and then continue it by passing <code dir="ltr">previous_response_id</code> on your next request. This keeps requests small and makes it easy to build multi-step workflows on top of LM Studio.</p>
<p>Responses also include detailed stats (tokens in/out, speed, time to first token), so you can track performance and tune load/inference settings.</p>
<p>And when you need tools, <code dir="ltr">/v1/chat</code> can also enable your locally configured MCPs - gated by permission keys.</p>
<h3 id="permission-keys" node="[object Object]"><span>Permission keys</span><a href="#permission-keys" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>To allow you to control which client accesses your LM Studio server, we've introduced permission keys. You can generate and manage permission keys from the Settings &gt; Server tab in the app.</p>
<h2 id="and-a-lot-more" node="[object Object]"><span>And a lot more!</span><a href="#and-a-lot-more" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Please let us know how you like it! We'd love to hear your feedback.</p>
<p>Special thanks to the 0.4.0 beta group. Your feedback and bug reports have been invaluable &lt;3.</p>
<p>Below is the full list of release notes items.</p>
<pre dir="ltr"><div><pre tabindex="0"><code><span><span>### LM Studio 0.4.0 - Release Notes</span></span>
<span></span>
<span><span>Welcome to LM Studio 0.4.0 👾!</span></span>
<span><span>- We're excited to introduce the next generation of LM Studio.</span></span>
<span><span>- New features include:</span></span>
<span><span>  - `llmster`: the LM Studio Daemon for headless deployments w/o GUI on servers or cloud instances</span></span>
<span><span>  - Parallel inference requests (instead of queued) for high throughput use cases</span></span>
<span><span>  - New stateful REST API with local MCP server support - `POST /v1/chat`</span></span>
<span><span>  - A completely revamped UI experience ✨</span></span>
<span></span>
<span><span>**Build 17**</span></span>
<span></span>
<span><span>- MCPs will now only be loaded when needed, instead of at app startup</span></span>
<span><span>- Fixed a bug where some fields in app settings could get reset after update</span></span>
<span></span>
<span><span>**Build 16**</span></span>
<span></span>
<span><span>- New icons and placements for Discover, My Models buttons</span></span>
<span><span>- Fixed a bug where generators wouldn't show in the top bar model picker when selected</span></span>
<span><span>- Fixed a bug which prevented additional quantizations from being downloaded for staff pick models that were already downloaded</span></span>
<span><span>- Fixed a bug where `lms import` will sometimes not work properly if llmster (daemon) is also installed</span></span>
<span><span>- Fixed a bug in `/api/v1/chat` that caused server errors when inputs were empty or `top_k` exceeded 500</span></span>
<span><span>- Fixed a bug where `lms ls` and `lms load` sometimes would fail after waking up the LM Studio service</span></span>
<span><span>- Fixed a bug where sometimes token counting would not work properly for gpt-oss models</span></span>
<span></span>
<span><span>**Build 15**</span></span>
<span></span>
<span><span>- Introduce Parallel Requests with Continuous Batching 🚀</span></span>
<span><span>  - When loading a model, you can now select n_parallel to allow multiple requests to be processed in parallel.</span></span>
<span><span>  - When enabled, instead of queuing requests one by one, the model will process up to N requests simultaneously.</span></span>
<span><span>  - By default, parallel slots are set to 4 (with unified KV set to true, which should result in no additional memory overhead).</span></span>
<span><span>  - This is supported for LM Studio's llama.cpp engine, with MLX coming later.</span></span>
<span><span>- Introducing Split View in Chat: view two chats side by side.</span></span>
<span><span>  - Drag and drop chat tabs to either half of the window to split the view.</span></span>
<span><span>  - Close one side of the split view with the 'x' button in the top right of each pane.</span></span>
<span><span>- Introducing 🔧 Developer Mode: a simplification of the previous Developer/Power User/User 3 mode switch.</span></span>
<span><span>  - Developer Mode combines the previous Developer and Power User modes into a single mode with all advanced features enabled.</span></span>
<span><span>  - You can turn on Developer Mode in Settings &gt; Developer.</span></span>
<span><span>- New setting: enforce allowing only one new empty chat at a time (default: enabled)</span></span>
<span><span>  - Change in Settings &gt; Chat</span></span>
<span><span>- New 🔭 Model Search experience</span></span>
<span><span>  - Access via the 🔍 button on the top right or by pressing Cmd/Ctrl + Shift + M</span></span>
<span><span>  - Model format filter preferences persist between app restarts</span></span>
<span><span>  - Modal is resizable and remembers its size between app restarts</span></span>
<span><span>- Limit number of open tabs to 1 per pane. Support showing 2 side-by-side chat tabs.</span></span>
<span><span>  - Selecting a new chat replaces the current tab in that pane.</span></span>
<span><span>- Add button to create a new chat in the sidebar</span></span>
<span><span>- Pressing Cmd/Ctrl + L while the model picker is open will dismiss it</span></span>
<span><span>- On narrow window size show right hand sidebar as an ephemeral overlay</span></span>
<span><span>- Support for the LFM2 tool call format</span></span>
<span><span>- CLI now uses commit hash for versioning instead of semantic version numbers</span></span>
<span><span>- Updates to UI details in hardware settings</span></span>
<span><span>- Fixed a bug where moving large number of conversations would sometimes only move part of them</span></span>
<span><span>- Fixed a bug where `lms ls` sometimes would show incomplete list of models on startup</span></span>
<span><span>- Fixed a bug in deleting tool confirmation preferences in settings</span></span>
<span><span>- Fixed a UI bug in app onboarding</span></span>
<span><span>- Fixed a visual bug in Models Table selected row affecting the Architecture and Format columns</span></span>
<span><span>- Fixed a bug where undoing pasted content in chat input would not work as expected</span></span>
<span><span>- Fixed a bug where a leading decimal in a numeric input would parse as a 0</span></span>
<span><span>- Fixed a bug rendering multiple images in a conversation message</span></span>
<span><span>- Fixed a bug where a documentation sidebar section would sometimes get stuck in expanded state</span></span>
<span><span>- Fixed a bug where chat names would sometimes be empty</span></span>
<span><span>- Fixed a visual bug in rendering keyboard shortcuts on Windows and Linux</span></span>
<span><span>- Fixed a bug where model loader would sometimes close due to mouse move shortly after opening</span></span>
<span><span>- Fixed a bug rendering titles in preset conflict resolver dialog</span></span>
<span><span>- Fixed a bug where reloading with new load parameters would not apply next time the same model is used for a chat</span></span>
<span><span>- Fixed a bug where the model loading will get stuck if the cpu moe slider is maxed out</span></span>
<span><span>- Fixed a bug where exporting chats with very large images to PDF would fail</span></span>
<span><span>- Fixed a responsive UI overlap bug in the app header</span></span>
<span><span>- [Windows] Fixed a bug where the default embedding model will not be available after in-app update</span></span>
<span><span>- Adds download, copy, and reveal in working directory buttons to generated images in chat</span></span>
<span></span>
<span><span>**Build 14**</span></span>
<span></span>
<span><span>- (Build 14 was skipped)</span></span>
<span></span>
<span><span>**Build 13**</span></span>
<span></span>
<span><span>- App setting to control primary navigation position: 'top' or 'left'</span></span>
<span><span>- [Mac] New tray menu icon 👾 (experimental, might change)</span></span>
<span><span>- `/api/v1` endpoints and `/v1/responses` API now return better formatted errors</span></span>
<span><span>- Significantly reduce the size of the app update asset</span></span>
<span></span>
<span><span>**Build 12**</span></span>
<span></span>
<span><span>- Bugfix: New chats to be created with the same model as the previously focused chat</span></span>
<span><span>- Bring back gear button to change load parameters for currently loaded model</span></span>
<span><span>- Bring back context fullness indicator and current input token counter</span></span>
<span><span>- New in My Models: right-click on tab header to choose which columns to show/hide</span></span>
<span><span>- New in My Models: Capabilities and Format columns</span></span>
<span><span>- Fixed a flicker in model picker floating panel upon first open</span></span>
<span><span>  - P.S. you can open the model picker from anywhere in the app with Cmd/Ctrl + L</span></span>
<span><span>- Fixed focus + Enter on Eject button not working inside model picker</span></span>
<span><span>- Updated chat terminal and messages colors and style</span></span>
<span><span>- Fixed dragging and dropping chats/folders in the sidebar</span></span>
<span></span>
<span><span>**Build 11**</span></span>
<span></span>
<span><span>- ✨👾 Completely revamped UI - this is a work in progress, give us feedback!</span></span>
<span><span>- [CLI] New `lms chat` experience!</span></span>
<span><span>  - Support slash commands, thinking highlighting and pasting larger content</span></span>
<span><span>  - Slash commands available: /model, /download, /system-prompt, /help and /exit</span></span>
<span><span>- [CLI] New: `lms runtime survey` to print info about available GPUs!</span></span>
<span><span>- FunctionGemma support</span></span>
<span><span>- Added a slider to control n_cpu_moe</span></span>
<span><span>- New REST API endpoint: `api/v1/models/unload` to unload models</span></span>
<span><span>- Breaking change: in `api/v1/models/load` endpoint response, introduced in this beta, `model_instance_id` has been renamed to `instance_id`.</span></span>
<span><span>- Display live processing status for each loaded LLM on the Developer page</span></span>
<span><span>  - Prompt processing progress percentage → token generation count</span></span>
<span><span>- Improved PDF rendering quality for tool requests and responses</span></span>
<span><span>- Significantly increased the reliability and speed of deleting multiple chats at once</span></span>
<span><span>- Updated style of chat message generation info</span></span>
<span><span>- Updated layout of Hardware settings page and other settings rows</span></span>
<span><span>- Fixed a bug where sometimes models are indexed before all files are downloaded</span></span>
<span><span>- Fixed a bug where exporting larger PDFs would sometimes fail</span></span>
<span><span>- Fixed a bug where pressing the chat clear hotkey multiple times would open multiple confirmation dialogs</span></span>
<span><span>- Fixed a bug where pressing the chat clear hotkey would sometimes duplicate the chat</span></span>
<span><span>- Fixed a bug where pressing the duplicate hotkey on the release notes would create a glitched chat tab</span></span>
<span><span>- Fixed a bug where `lms help` would not work</span></span>
<span><span>- Fixed a bug where deleting models or canceling downloads would leave behind empty folders</span></span>
<span><span>- Fixed a styling bug in the GPU section on the Hardware page</span></span>
<span><span>- [MLX] Fixed a bug where the bf16 model format was not recognized as a valid quantization</span></span>
<span></span>
<span><span>**Build 10**</span></span>
<span></span>
<span><span>- (Build 10 was skipped)</span></span>
<span></span>
<span><span>**Build 9**</span></span>
<span></span>
<span><span>- (Build 9 was skipped)</span></span>
<span></span>
<span><span>**Build 8**</span></span>
<span></span>
<span><span>- Fixed a bug where the default system prompt was still sent to the model even after the system prompt field was cleared.</span></span>
<span><span>- Fixed a bug where exported chats did not include the correct system prompt.</span></span>
<span><span>- Fixed a bug where the token count was incorrect when a default system prompt existed but the system prompt field was cleared.</span></span>
<span><span>- Fix a bug where sometimes the tool call results are not being added to the context correctly</span></span>
<span><span>- Fix chat clearing with hotkey (Cmd/Ctrl + Shift + Option/Alt + D) would clear wrong chat</span></span>
<span><span>- Fix a bug where Ctrl/Cmd + N would sometimes create two new chats</span></span>
<span><span>- Updated style for Integrations panel and select</span></span>
<span><span>- Fixed cURL copy button for embedding models displaying additional incorrect requests</span></span>
<span><span>- Fix "ghost chats" caused by moving conversations/deleting conversations</span></span>
<span></span>
<span><span>**Build 7**</span></span>
<span></span>
<span><span>- Fix jinja prompt formatting bug for some models where EOS tokens were not being included properly</span></span>
<span><span>- Bring back release notes viewer for Runtime available update</span></span>
<span><span>- Prevent tooltip from staying open when hovering tooltip content</span></span>
<span><span>- Fix a bug in deleting multiple chats at once</span></span>
<span><span>- Minor fix to overlapping labels in model loader</span></span>
<span><span>- Support for EssentialAI's rnj-1 model</span></span>
<span></span>
<span><span>**Build 6**</span></span>
<span></span>
<span><span>- Fixed a bug where Qwen3-Next user messages would not appear in formatted prompts properly</span></span>
<span></span>
<span><span>**Build 5**</span></span>
<span></span>
<span><span>- Fixed a bug where quickly deleting multiple conversations will sometimes soft-lock the app</span></span>
<span><span>- Fixed another bug that prevented the last remaining open tab from being closed</span></span>
<span></span>
<span><span>**Build 4**</span></span>
<span></span>
<span><span>- Fixed a bug where the last remaining open tab sometimes could not be closed</span></span>
<span><span>- Fixed a bug where `lms log stream` would exit immediately</span></span>
<span><span>- Fixed a bug where the server port would get printed as [object Object]</span></span>
<span><span>- Image validation checks in `v1/chat` and `v1/responses` REST API now run without model loading</span></span>
<span><span>- Fixed a bug where images without extensions were not classified correctly</span></span>
<span><span>- Fix bug in move-to-trash onboarding dialog radio selection where some parts of the label were not clickable</span></span>
<span><span>- Fix several clickable areas bugs in Settings windows buttons</span></span>
<span><span>- Fixed a bug where certain settings may get adjusted unexpectedly when using llmster (for example, the JIT model loading may become disabled)</span></span>
<span><span>- New and improved Runtime page style and structure</span></span>
<span><span>- Fixes a bug where guardrail settings were not showing up in User UI mode</span></span>
<span><span>- Fixed a bug where `lms log stream` would exit immediately</span></span>
<span></span>
<span><span>**Build 3**</span></span>
<span></span>
<span><span>- Introducing 'llmster': the LM Studio Daemon!</span></span>
<span><span>  - True headless, no GUI version of the process that powers LM Studio</span></span>
<span><span>  - Run it on servers, cloud instances, or any machine without a graphical interface</span></span>
<span><span>  - Load models on CPU/GPU and serve them, use via `lms` CLI or our APIs</span></span>
<span><span>  - To install:</span></span>
<span><span>    - Linux/Mac: `curl -fsSL https://lmstudio.ai/install.sh | bash`</span></span>
<span><span>    - Windows: `irm https://lmstudio.ai/install.ps1 | iex`</span></span>
<span><span>- Support for MistralAI Ministral models (3B, 8B, 13B)</span></span>
<span><span>- Improved `lms` output and help messages style. Run `lms --help` to explore!</span></span>
<span><span>- Get llama.cpp level logs with `lms log stream -s runtime` in the terminal</span></span>
<span><span>- `lms get` interactive mode now shows the latest model catalog options</span></span>
<span><span>- New and improved style for Downloads panel</span></span>
<span><span>- New and improved style for App Settings</span></span>
<span><span>- We're trying something out: Model search now in its own tab</span></span>
<span><span>  - still iterating on the UI for this page, please give us feedback!</span></span>
<span></span>
<span><span>**Build 2**</span></span>
<span></span>
<span><span>- Show release notes in a dedicated tab after app updates</span></span>
<span><span>- Add support to display images in exported PDFs and exported markdown files</span></span>
<span><span>- Quick Docs is now Developer Docs, with refreshed documentation and direct access from the welcome page.</span></span>
<span><span>- Allow creating permission tokens without allowed MCP permissions</span></span>
<span><span>- Fixed a bug where sometimes images created by MCPs are not showing up</span></span>
<span><span>- Fixed a bug where sometimes the plugin chips not working</span></span>
<span><span>- Fixed a bug where the "thinking" blocks will sometimes expand erroneously</span></span>
<span><span>- Fixed a bug where certain tabs would not open correctly</span></span>
<span><span>- Fixed a bug where sometimes the model list would not load</span></span>
<span><span>- Fixed a bug where in-app docs article titles would sometimes wiggle on scroll</span></span>
<span><span>- Fixed a visual bug in Preset 'resolve conflicts' modal</span></span>
<span><span>- Fixed a bug where sometimes Download button would continue showing for an already downloaded model</span></span>
<span><span>- Fixed a bug where chat sidebar buttons wouldn't be visible on narrow screens</span></span>
<span><span>- Display model indexing errors as buttons rather than hints</span></span>
<span></span>
<span><span>**Build 1**</span></span>
<span></span>
<span><span>- Welcome to the 0.4.0 Beta!</span></span>
<span></span>
<span></span></code></pre></div></pre>
<hr node="[object Object]">
<h3 id="resources" node="[object Object]"><span>Resources</span><a href="#resources" aria-label="Link to this section"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul node="[object Object]">
<li>We are hiring! Check out our <a href="https://lmstudio.ai/careers" node="[object Object]" target="_blank" rel="noopener noreferrer">careers page</a> for open roles.</li>
<li>Download LM Studio: <a href="https://lmstudio.ai/download" node="[object Object]" target="_blank" rel="noopener noreferrer">lmstudio.ai/download</a></li>
<li>Report bugs: <a href="https://github.com/lmstudio-ai/lmstudio-bug-tracker/issues" node="[object Object]" target="_blank" rel="noopener noreferrer">lmstudio-bug-tracker</a></li>
<li>X / Twitter: <a href="https://twitter.com/lmstudio" node="[object Object]" target="_blank" rel="noopener noreferrer">@lmstudio</a></li>
<li>Discord: <a href="https://discord.gg/lmstudio" node="[object Object]" target="_blank" rel="noopener noreferrer">LM Studio Community</a></li>
</ul></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[That's Not How Email Works, HSBC (266 pts)]]></title>
            <link>https://danq.me/2026/01/28/hsbc-dont-understand-email/</link>
            <guid>46799304</guid>
            <pubDate>Wed, 28 Jan 2026 18:12:02 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://danq.me/2026/01/28/hsbc-dont-understand-email/">https://danq.me/2026/01/28/hsbc-dont-understand-email/</a>, See on <a href="https://news.ycombinator.com/item?id=46799304">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-27343" data-post-id="27343">
          
          <div>
            <p>
              I have a credit card with HSBC<sup><a id="footnote-ref-27343-1" name="footnote-ref-27343-1" href="#footnote-27343-1" title="Long, long ago I also had a current account with HSBC which I forgot to close when I switched banks… 20 years ago… and I possibly still owe them for the six pence the account was in debt at the time.">1</a></sup>:
              you know, <a href="https://danq.me/2004/07/19/hsbc-advertising/">the bank with virtue-signalling multiculturalism</a> in their ads.
            </p>
            <p>
              Not long ago I received a letter from them telling me that emails to me were being “returned undelivered” and they needed me to update the email address on my account.
            </p>
            <h2>
              “What’s happening?”
            </h2>
            <figure id="attachment_27344" aria-describedby="caption-attachment-27344">
              <a href="#lightbox-p-attachment_27344" title="Zoom in on image" aria-haspopup="dialog" role="button"><img decoding="async" fetchpriority="high" src="https://bcdn.danq.me/_q23u/2025/09/20250930_131403-640x360.jpg" alt="Posted letter from HSBC saying that emails to me have been returned undelivered, held in front of a screen showing a recent email from HSBC sitting in my Inbox." width="640" height="360" srcset="https://bcdn.danq.me/_q23u/2025/09/20250930_131403-640x360.jpg 640w, https://danq.me/_q23u/2025/09/20250930_131403-477x269.jpg 477w" sizes="100vw"></a>
              <figcaption id="caption-attachment-27344">
                I don’t know what emails are being “returned undelivered” to HSBC, but it isn’t any of the ones sitting, read, in my email client.
              </figcaption>
            </figure>
            <p>
              I logged into my account, per the instructions in the letter, and discovered <strong>my correct email address already right there</strong>, much to my… lack of surprise<sup><a id="footnote-ref-27343-2" name="footnote-ref-27343-2" href="#footnote-27343-2" title="After all, I’d been reading their emails!">2</a></sup>.
            </p>
            <p>
              So I kicked off a live chat via their app, with an agent called Ankitha. Over the course of a drawn-out hour-long conversation, they repeatedly told to tell me <em>how</em> to update my
              email address (which was never my question). Eventually, when they understood that <em>my email address was already correct</em>, then they concluded the call, saying (emphasis mine):
            </p>
            <blockquote>
              <p>
                I can understand your frustration, but <strong>if the bank has sent the letter, you will have to update the e-mail address</strong>.
              </p>
            </blockquote>
            <p>
              This is the point at which a normal person would probably just change the email address in their online banking to a “spare” email address.
            </p>
            <p>
              But aside from the fact that I’d rather not<sup><a id="footnote-ref-27343-3" name="footnote-ref-27343-3" href="#footnote-27343-3" title="After all, as I’ll stress again: the email address HSBC have for me, and are using, is already correct.">3</a></sup>, by this point I’d caught the scent of a deeper underlying issue.
              After all, didn’t I have <a href="https://danq.me/2021/11/16/email-tracking-and-paperless-banking/">a conversation a&nbsp;<em>little</em> like this one but with a different bank</a>, about four years
              ago?
            </p>
            <figure id="attachment_27348" aria-describedby="caption-attachment-27348">
              <a href="#lightbox-p-attachment_27348" title="Zoom in on image" aria-haspopup="dialog" role="button"><img decoding="async" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually-640x360.jpg" alt="Phone screen showing a live chat interface. The other party says &quot;I can understand your frustration, but if the bank has sent the letter, you will have to update the e-mail address.&quot; and then &quot;Thank you for being so understanding and patiently waiting. Thank you for contacting HSBC, if there is anything else you need please feel free to come back to us. Have a pleasant rest of the day.&quot;, before ending the conversation." width="640" height="360" srcset="https://bcdn.danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually-640x360.jpg 640w, https://danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually-1280x720.jpg 1280w, https://danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually-980x551.jpg 980w, https://danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually-477x269.jpg 477w" sizes="100vw"></a>
              <figcaption id="caption-attachment-27348">
                Perhaps I should be grateful that they didn’t say that I have to change <a href="https://danq.me/2007/03/08/q/">my name</a>, which can sometimes&nbsp; be significantly more awkward than my email
                address…
              </figcaption>
            </figure>
            <p>
              So I called Customer Services directly<sup><a id="footnote-ref-27343-4" name="footnote-ref-27343-4" href="#footnote-27343-4" title="In future, I’ll just do this in the first instance. The benefits of live chat being able to be done “in the background” while one gets on with some work are totally outweighed when the entire exchange takes an hour only to reach an unsatisfactory conclusion, whereas a telephone call got things sorted (well hopefully…) within 10 minutes.">4</a></sup>,
              who told me that <strong>if my email address is already correct then I can ignore their letter</strong>.
            </p>
            <p>
              I suggested that perhaps their letter template might need updating so it doesn’t say “action required” if action is <em>not</em> required. Or that perhaps what they mean to say is
              “action required: check your email address is correct”.
            </p>
            <figure id="attachment_27349" aria-describedby="caption-attachment-27349">
              <a href="#lightbox-p-attachment_27349" title="Zoom in on image" aria-haspopup="dialog" role="button"><img decoding="async" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected1.png" alt="Edited version of the letter, now saying 'What's happening? We need to ensure that the email address we're using for you is correct' and 'Action required: Please check that you've been receiving our emails and that the address in your account is correct'." width="640" height="360" srcset="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected1.png 640w, https://danq.me/_q23u/2025/09/hsbc-letter-email-corrected1-477x269.png 477w" sizes="100vw"></a>
              <figcaption id="caption-attachment-27349">
                Say what you mean, HSBC! I’ve suggested an improvement to your letter template.
              </figcaption>
            </figure>
            <p>
              So anyway, apparently everything’s fine… although I reserved final judgement until I’d seen that they were still sending me emails!
            </p>
            <h2>
              “Action required”
            </h2>
            <p>
              I think I can place a solid guess about what went wrong here. But it makes me feel like we’re living in the Darkest Timeline.
            </p>
            <figure id="attachment_27351" aria-describedby="caption-attachment-27351">
              <a href="#lightbox-p-attachment_27351" title="Zoom in on image" aria-haspopup="dialog" role="button"><img decoding="async" loading="lazy" src="https://bcdn.danq.me/_q23u/2025/09/The_darkest_timeline1.gif" alt="Scene from Community episode 'Remedial Chaos Theory'. Pierce lies injured on the floor, tended to by Annie and Abed, while Jeff swings a flaming blanket around his head. Troy stands in shock at the door, holding a pile of pizza boxes." width="500" height="281"></a>
              <figcaption id="caption-attachment-27351">
                You know the one I mean. Somebody rolled a ‘1’, didn’t they…
              </figcaption>
            </figure>
            <p>
              I dissected HSBC’s latest email to me: it was of the “your latest statement is available” variety. Deep within the email, down at the bottom, is this code:
            </p>
            <figure>
              <div>
                <pre>&lt;<span>img</span> <span>src</span><span>=</span><span>"http://www.email1.hsbc.co.uk:8080/Tm90IHRoZSByZWFsIEhTQkMgcGF5bG9hZA=="</span>
   <span>width</span><span>=</span><span>"1"</span>
  <span>height</span><span>=</span><span>"1"</span>
     <span>alt</span><span>=</span><span>""</span>&gt;

&lt;<span>img</span> <span>src</span><span>=</span><span>"http://www.email1.hsbc.co.uk:8080/QWxzbyBub3QgcmVhbCBIU0JDIHBheWxvYWQ="</span>
   <span>width</span><span>=</span><span>"1"</span>
  <span>height</span><span>=</span><span>"1"</span>
     <span>alt</span><span>=</span><span>""</span>&gt;
</pre>
              </div>
            </figure>
            <p>
              What you’re seeing are two <em>tracking pixels</em>: tiny 1×1 pixel images, usually transparent or white-on-white to make them even-more invisible, used to surreptitiously track when
              somebody reads an email. When you open an email from HSBC – potentially&nbsp;<em>every</em> time you open an email from them – your email client connects to those web addresses to get
              the necessary images. The code at the end of each identifies the email they were contained within, which in turn can be linked back to the recipient.
            </p>
            <p>
              You know how invasive a read-receipt feels? Tracking pixels are like those… but turned up to eleven. While a read-receipt only says “the recipient read this email” (usually only after
              the recipient gives consent for it to do so), a tracking pixel can often track <em>when</em> and&nbsp;<em>how often</em> you refer to an email<sup><a id="footnote-ref-27343-5" name="footnote-ref-27343-5" href="#footnote-27343-5" title="A tracking pixel can also collect additional personal information about you, such as your IP address at the time that you opened the email, which might disclose your location.">5</a></sup>.
            </p>
            <p>
              If I re-read a year-old email from HSBC, they’re saying that they want to know about it.
            </p>
            <p>
              But it gets worse. Because HSBC are using <code>http://</code>, rather than <code>https://</code> URLs for their tracking pixels, they’re also saying that every time you read an email
              from them, they’d like <em>everybody on the same network as you</em> to be able to know that you did so, too. If you’re at my house, on my WiFi, and you open an email from HSBC, not
              only might HSBC know about it, but <em>I</em> might know about it too.
            </p>
            <p>
              An easily-avoidable security failure there, HSBC… which isn’t the kind of thing one hopes to hear about a bank!
            </p>
            <figure id="attachment_27353" aria-describedby="caption-attachment-27353">
              <a href="#lightbox-p-attachment_27353" title="Zoom in on image" aria-haspopup="dialog" role="button"><img decoding="async" loading="lazy" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-tracking-pixel-highlight-zoomin-640x229.gif" alt="Zoom-in animation showing two tracking pixels at the bottom of an email, rendered visible in red and blue." width="640" height="229" srcset="https://bcdn.danq.me/_q23u/2025/09/hsbc-tracking-pixel-highlight-zoomin-640x229.gif 640w, https://danq.me/_q23u/2025/09/hsbc-tracking-pixel-highlight-zoomin-980x351.gif 980w" sizes="100vw"></a>
              <figcaption id="caption-attachment-27353">
                Tracking pixels are usually invisible, so I turned these ones visible so you can see where they hide.
              </figcaption>
            </figure>
            <p>
              But… tracking pixels don’t actually work. At least, they doesn’t work <em>on me</em>. Like many privacy-conscious individuals, my devices are configured to block tracking pixels (and a
              variety of other instruments of surveillance capitalism) right out of the gate.
            </p>
            <p>
              This means that even though I <em>do</em> read most of the non-spam email that lands in my Inbox, the sender <em>doesn’t get to know that I did</em> so unless I choose to tell them.
              This is the way that email was <em>designed</em> to work, and is the only way that a sender can be confident that it <em>will</em> work.
            </p>
            <p>
              But we’re in the Darkest Timeline. <strong><a href="https://www.bbc.co.uk/news/technology-56071437">Tracking pixels have become so endemic</a> that HSBC have clearly come to the opinion
              that&nbsp;if they can’t track when I open their emails, I must not be receiving their emails</strong>. So they wrote me a letter to tell me that my emails have been “returned
              undelivered” (which seems to be an outright lie).
            </p>
            <p>
              Surveillance capitalism has become so ubiquitous that it’s become transparent. Transparent like the invisible spies at the bottom of your bank’s emails.
            </p>
            <figure id="attachment_27356" aria-describedby="caption-attachment-27356">
              <a href="#lightbox-p-attachment_27356" title="Zoom in on image" aria-haspopup="dialog" role="button"><img decoding="async" loading="lazy" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected2.png" alt="The letter from HSBC again, but this time corrected to say 'We cannot conceive that there's anybody left who hasn't given up on trying to fight back against surveillance capitalism. Action required: turn off your privacy software so we can watch you read our emails. (We'll be letting anybody you live with read them too.)" width="640" height="360" srcset="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected2.png 640w, https://danq.me/_q23u/2025/09/hsbc-letter-email-corrected2-477x269.png 477w" sizes="100vw"></a>
              <figcaption id="caption-attachment-27356">
                I’ve changed my mind. Maybe <em>this</em> is what HSBC’s letter should have said.
              </figcaption>
            </figure>
            <p>
              So in summary, with only a little speculation:
            </p>
            <ol>
              <li>
                <strong>Surveillance capitalism became widespread</strong> enough that HSBC came to assume that tracking pixels have bulletproof reliability.
              </li>
              <li>
                <strong>HSBC started using tracking pixels</strong> them to check whether emails are being received (even though that’s not what they do when they&nbsp;<em>are</em> reliable, which
                they’re not).
                <ul>
                  <li>(Oh, and their tracking pixels are badly-implemented, if they worked they’d “leak” data to other people on my network<sup><a id="footnote-ref-27343-6" name="footnote-ref-27343-6" href="#footnote-27343-6" title="It could be even worse still, actually! A sophisticated attacker could “inject” images into the bottom of a HSBC email; those images could, for example, be pictures of text saying things like “You need to urgently call HSBC on [attacker’s phone number].” This would allow a scammer to hijack a legitimate HSBC email by injecting their own content into the bottom of it. Seriously, HSBC, you ought to fix this.">6</a></sup>.)
                  </li>
                </ul>
              </li>
              <li>
                <strong>Eventually, HSBC assumed their tracking was bulletproof.</strong> Because HSBC couldn’t track how often, when, and where I was reading their emails… they posted me a letter to
                tell me I needed to change my email address.
              </li>
            </ol>
            <h2>
              What do I think HSBC should do?
            </h2>
            <p>
              Instead of sending me a misleading letter about undelivered emails, perhaps a better approach for HSBC could be:
            </p>
            <ol>
              <li>
                <strong>At an absolute minimum</strong><strong>, stop using unencrypted connections for tracking pixels</strong>. I do not want to open a bank email on a cafe’s public WiFi and have
                <em>everybody in the cafe</em> potentially know who I bank with… and that I just opened an email from them! I certainly don’t want attackers injecting content into the bottom of
                legitimate emails.
              </li>
              <li>
                <strong>Stop assuming that if somebody blocks your attempts to spy on them via your emails, it means they’re not getting your emails</strong>. It doesn’t mean that. It’s never meant
                that. There are all kinds of reasons that your tracking pixels might not work, and they’re not even all privacy-related reasons!
              </li>
              <li>
                <strong>Or, better yet: just stop trying to surveil your customers’ email habits in the first place?</strong> You already sit on a wealth of personal and financial information which
                you can, and probably do, data-mine for your own benefit. Can you at least <em>try</em> to pay lip service to <a href="https://www.hsbc.com/-/files/hsbc/our-approach/risk-and-responsibility/pdfs/240715-hsbc-principles-for-the-ethical-use-of-data-and-ai.pdf">your own published principles on the
                ethical use of data</a> and, if I may quote them, “use only that data which is appropriate for the purpose” and “embed privacy considerations into design and approval processes”.
              </li>
              <li>
                <strong>If you need to check that an email address is valid, do&nbsp;<em>that</em>, not an unreliable proxy for it</strong>. Instead of this letter, you could have sent an email that
                said “We need to check that you’re receiving our emails. Please click this link to confirm that you are.” This not only achieves informed consent for your tracking, but it can be
                more-secure too because you can authenticate the user during the process.
              </li>
            </ol>
            <p>
              Also, to quote your own principles once more: when you make a mistake like assuming your spying is a flawless way to detect the validity of email addresses, perhaps you should “be
              transparent with our customers and other stakeholders about how we use their data”.
            </p>
            <p>
              Wouldn’t that be better than writing to a customer to say that their emails are being returned undelivered (when they’re not)… and then having your staff tell them that having received
              such an email they have no choice but to change the email address they use (which is then disputed by your <em>other</em> staff)?
            </p>
            <p>
              <code>&lt;/rant&gt;</code>
            </p>
            
            <dialog id="lightbox-attachment_27344">
              <p id="lightbox-p-attachment_27344">
                <a href="https://bcdn.danq.me/_q23u/2025/09/20250930_131403.jpg"><img decoding="async" fetchpriority="high" src="https://bcdn.danq.me/_q23u/2025/09/20250930_131403.jpg" alt="Posted letter from HSBC saying that emails to me have been returned undelivered, held in front of a screen showing a recent email from HSBC sitting in my Inbox." width="640" height="360" sizes="100vw" loading="lazy"></a>
              </p><a href="#attachment_27344" title="Close image" role="button">×</a>
            </dialog>
            <dialog id="lightbox-attachment_27348">
              <p id="lightbox-p-attachment_27348">
                <a href="https://bcdn.danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually.jpg"><img decoding="async" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-say-no-you-have-to-change-your-email-address-actually.jpg" alt="Phone screen showing a live chat interface. The other party says &quot;I can understand your frustration, but if the bank has sent the letter, you will have to update the e-mail address.&quot; and then &quot;Thank you for being so understanding and patiently waiting. Thank you for contacting HSBC, if there is anything else you need please feel free to come back to us. Have a pleasant rest of the day.&quot;, before ending the conversation." width="640" height="360" sizes="100vw" loading="lazy"></a>
              </p><a href="#attachment_27348" title="Close image" role="button">×</a>
            </dialog>
            <dialog id="lightbox-attachment_27349">
              <p id="lightbox-p-attachment_27349">
                <a href="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected1.png"><img decoding="async" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected1.png" alt="Edited version of the letter, now saying 'What's happening? We need to ensure that the email address we're using for you is correct' and 'Action required: Please check that you've been receiving our emails and that the address in your account is correct'." width="640" height="360" sizes="100vw" loading="lazy"></a>
              </p><a href="#attachment_27349" title="Close image" role="button">×</a>
            </dialog>
            <dialog id="lightbox-attachment_27351">
              <p id="lightbox-p-attachment_27351">
                <a href="https://bcdn.danq.me/_q23u/2025/09/The_darkest_timeline1.gif"><img decoding="async" loading="lazy" src="https://bcdn.danq.me/_q23u/2025/09/The_darkest_timeline1.gif" alt="Scene from Community episode 'Remedial Chaos Theory'. Pierce lies injured on the floor, tended to by Annie and Abed, while Jeff swings a flaming blanket around his head. Troy stands in shock at the door, holding a pile of pizza boxes." width="500" height="281"></a>
              </p><a href="#attachment_27351" title="Close image" role="button">×</a>
            </dialog>
            <dialog id="lightbox-attachment_27353">
              <p id="lightbox-p-attachment_27353">
                <a href="https://bcdn.danq.me/_q23u/2025/09/hsbc-tracking-pixel-highlight-zoomin.gif"><img decoding="async" loading="lazy" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-tracking-pixel-highlight-zoomin.gif" alt="Zoom-in animation showing two tracking pixels at the bottom of an email, rendered visible in red and blue." width="640" height="229" sizes="100vw"></a>
              </p><a href="#attachment_27353" title="Close image" role="button">×</a>
            </dialog>
            <dialog id="lightbox-attachment_27356">
              <p id="lightbox-p-attachment_27356">
                <a href="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected2.png"><img decoding="async" loading="lazy" src="https://bcdn.danq.me/_q23u/2025/09/hsbc-letter-email-corrected2.png" alt="The letter from HSBC again, but this time corrected to say 'We cannot conceive that there's anybody left who hasn't given up on trying to fight back against surveillance capitalism. Action required: turn off your privacy software so we can watch you read our emails. (We'll be letting anybody you live with read them too.)" width="640" height="360" sizes="100vw"></a>
              </p><a href="#attachment_27356" title="Close image" role="button">×</a>
            </dialog>
            
          </div>
          
        </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Computer History Museum Launches Digital Portal to Its Collection (148 pts)]]></title>
            <link>https://computerhistory.org/press-releases/computer-history-museum-launches-digital-portal-to-its-vast-collection/</link>
            <guid>46798994</guid>
            <pubDate>Wed, 28 Jan 2026 17:54:54 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://computerhistory.org/press-releases/computer-history-museum-launches-digital-portal-to-its-vast-collection/">https://computerhistory.org/press-releases/computer-history-museum-launches-digital-portal-to-its-vast-collection/</a>, See on <a href="https://news.ycombinator.com/item?id=46798994">Hacker News</a></p>
<div id="readability-page-1" class="page"><p><strong>Gordon and Betty Moore Foundation Funded OpenCHM to Digitize One-of-a-Kind Archive </strong></p><div>
	<p><b><span data-contrast="none">MOUNTAIN VIEW, Calif. <span lang="EN-US" xml:lang="EN-US" data-contrast="none"><span>–</span></span> </span></b><span data-contrast="none">January&nbsp;21, 2026 <span lang="EN-US" xml:lang="EN-US" data-contrast="none"><span>–</span></span> The&nbsp;</span><a href="https://computerhistory.org/"><span data-contrast="none">Computer History Museum</span></a><span data-contrast="none"> (CHM), a leader in decoding technology—its computing past, digital present, and future impact on humanity</span><span data-contrast="none">—announced the launch of OpenCHM, a new digital portal providing global access to its unparalleled collection. </span></p>
<p><span data-contrast="none">“OpenCHM&nbsp;is designed to inspire discovery, spark curiosity, and make the stories of the digital age more accessible to everyone, everywhere,” said CHM President and CEO Marc Etkind. “We’re unlocking the collection for new audiences to explore.”</span><span data-ccp-props="{}">&nbsp;</span></p>
<p>OpenCHM is funded by the Gordon and Betty Moore Foundation and other generous donors, and this launch represents a major milestone in CHM's multi-year digitization initiative. Designed in collaboration with KeepThinking, the portal is powered by their innovative Qi collection management system.</p>
<p><b><span data-contrast="none">“We were excited by the prospect of CHM opening up their unique collections to broader audiences, from scholars and teachers to students and the public. The balance of the engaging, curated narratives by CHM’s own historians and field experts along with the tools and capabilities to explore one’s own interests makes the platform truly compelling. The Moore Foundation also values the OpenCHM team's </span></b><b><span data-contrast="none">commitment to thoughtful design and documentation, which we hope will inspire and enable other organizations to share their collections more openly</span></b><b><span data-contrast="none">.”—Janet Coffey, Program Director, Science, Gordon and Betty Moore Foundation</span></b><span data-ccp-props="{&quot;134233117&quot;:false,&quot;134233118&quot;:false,&quot;201341983&quot;:0,&quot;335551550&quot;:1,&quot;335551620&quot;:1,&quot;335559685&quot;:0,&quot;335559737&quot;:0,&quot;335559738&quot;:0,&quot;335559739&quot;:160,&quot;335559740&quot;:279}">&nbsp;</span></p>
<p><span data-contrast="none">The OpenCHM platform expands worldwide access to CHM’s vast collection through a digital portal, and ongoing digitization regularly adds more historical materials. Along with the collection, the portal introduces new digital storytelling and discovery tools designed to bring the history of the technology revolution</span><span data-contrast="none">&nbsp;to life for both experts and general audiences. </span><span data-ccp-props="{}">&nbsp;</span></p>
<p><span data-contrast="none">OpenCHM&nbsp;features include:</span><span data-ccp-props="{}">&nbsp;</span></p>
<ul>
	<li aria-setsize="-1" data-leveltext="" data-font="Symbol" data-listid="1" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-aria-posinset="1" data-aria-level="1"><b><span data-contrast="none">Advanced search tools</span></b><span data-contrast="none">&nbsp;with smart filters for documents, images, software, objects, and more&nbsp;allowing&nbsp;users&nbsp;to&nbsp;explore&nbsp;specific artifacts, archives, and oral histories.</span><span data-ccp-props="{}">&nbsp;</span></li>
	<li aria-setsize="-1" data-leveltext="" data-font="Symbol" data-listid="1" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-aria-posinset="1" data-aria-level="1"><b><span data-contrast="none">Curator&nbsp;picks&nbsp;and stories</span></b><span data-contrast="none">&nbsp;that highlight visionary pioneers and groundbreaking innovations.</span><span data-ccp-props="{}">&nbsp;</span></li>
	<li aria-setsize="-1" data-leveltext="" data-font="Symbol" data-listid="1" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-aria-posinset="1" data-aria-level="1"><b><span data-contrast="none">Highlights&nbsp;and discovery wall&nbsp;</span></b><span data-contrast="none">showcasing&nbsp;rare and iconic artifacts.</span><span data-ccp-props="{}">&nbsp;</span></li>
	<li aria-setsize="-1" data-leveltext="" data-font="Symbol" data-listid="1" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-aria-posinset="1" data-aria-level="1"><b><span data-contrast="none">My&nbsp;albums</span></b><span data-contrast="none">&nbsp;empowers&nbsp;users&nbsp;to&nbsp;create, save, and share custom folders filled with the materials they choose.</span><span data-ccp-props="{}">&nbsp;</span></li>
	<li aria-setsize="-1" data-leveltext="" data-font="Symbol" data-listid="1" data-list-defn-props="{&quot;335552541&quot;:1,&quot;335559685&quot;:720,&quot;335559991&quot;:360,&quot;469769226&quot;:&quot;Symbol&quot;,&quot;469769242&quot;:[8226],&quot;469777803&quot;:&quot;left&quot;,&quot;469777804&quot;:&quot;&quot;,&quot;469777815&quot;:&quot;hybridMultilevel&quot;}" data-aria-posinset="1" data-aria-level="1"><b><span data-contrast="none">Developer portal</span></b><span data-contrast="none">&nbsp;offering access to APIs, sample code, and registration.</span><span data-ccp-props="{}">&nbsp;</span></li>
</ul>
<p><span data-contrast="none">OpenCHM&nbsp;advances CHM’s mission to preserve and interpret the history of technology while making it&nbsp;broadly accessible&nbsp;as a public resource.</span><span data-ccp-props="{}">&nbsp;</span></p>
<p><b><span data-contrast="none">About CHM</span></b><span data-contrast="none"> </span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;<br>
</span><span data-contrast="none">The&nbsp;</span><a href="http://www.computerhistory.org/"><span data-contrast="none">Computer History Museum</span></a><span data-contrast="none">&nbsp;(CHM) is the leading museum decoding computing’s ongoing impact on our world. We are uniquely positioned to cull the key lessons of the past and—through our research, exhibits, events, and incomparable collection of computing artifacts—create informed digital citizens empowered to make the choices that will shape a better future.&nbsp;</span><span data-ccp-props="{&quot;201341983&quot;:0,&quot;335559739&quot;:0,&quot;335559740&quot;:240}">&nbsp;</span></p>
<p><b><span data-contrast="none">Press contact:</span></b><span data-contrast="none">&nbsp;Carina Sweet,&nbsp;</span><a href="https://computerhistory.org/cdn-cgi/l/email-protection#7b18080c1e1e0f3b1814160b0e0f1e091312080f1409025514091c"><span data-contrast="none"><span data-cfemail="3457474351514074575b5944414051465c5d47405b464d1a5b4653">[email&nbsp;protected]</span></span></a><span data-contrast="none">, 650.810.1059</span></p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Mousefood – Build embedded terminal UIs for microcontrollers (201 pts)]]></title>
            <link>https://github.com/ratatui/mousefood</link>
            <guid>46798402</guid>
            <pubDate>Wed, 28 Jan 2026 17:20:31 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/ratatui/mousefood">https://github.com/ratatui/mousefood</a>, See on <a href="https://news.ycombinator.com/item?id=46798402">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><div dir="auto"><h2 tabindex="-1" dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ratatui/mousefood/blob/599f1026d37c8d6308a6df64a234dbefaedc0c6f/assets/logo/mousefood.svg?raw=true"><img src="https://github.com/ratatui/mousefood/raw/599f1026d37c8d6308a6df64a234dbefaedc0c6f/assets/logo/mousefood.svg?raw=true" alt="Mousefood"></a></h2><a id="" aria-label="Permalink: " href="#"></a></div>
<p dir="auto"><a href="https://crates.io/crates/mousefood" rel="nofollow"><img src="https://camo.githubusercontent.com/a1f106fdc71e9cd5156ce382ebc02eafab13171ab608078351984f64ab85f749/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f6d6f757365666f6f643f6c6f676f3d72757374267374796c653d666c61742d73717561726526636f6c6f723d656265393466" alt="Crate" data-canonical-src="https://img.shields.io/crates/v/mousefood?logo=rust&amp;style=flat-square&amp;color=ebe94f"></a>
<a href="https://docs.rs/mousefood" rel="nofollow"><img src="https://camo.githubusercontent.com/0b83b40ad07bdae4f036f3fd7014cc74ae340de9ec14bcabdab01e7eb5aa00e6/68747470733a2f2f696d672e736869656c64732e696f2f646f637372732f6d6f757365666f6f643f6c6f676f3d72757374267374796c653d666c61742d737175617265" alt="Docs" data-canonical-src="https://img.shields.io/docsrs/mousefood?logo=rust&amp;style=flat-square"></a>
<a href="https://github.com/ratatui/mousefood/blob/main/.github/workflows/ci.yml"><img src="https://camo.githubusercontent.com/6475d8db8734ced5a2cc928a062fff4c5ad84af83ae257225bc94ed6a19fca8d/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f616374696f6e732f776f726b666c6f772f7374617475732f726174617475692f6d6f757365666f6f642f63692e796d6c3f7374796c653d666c61742d737175617265266c6f676f3d676974687562" alt="CI" data-canonical-src="https://img.shields.io/github/actions/workflow/status/ratatui/mousefood/ci.yml?style=flat-square&amp;logo=github"></a>
<a href="https://deps.rs/crate/mousefood" rel="nofollow"><img src="https://camo.githubusercontent.com/5430f7a1ac018a0591a40c9fac875a55af6da581f356012ec939b6fc17a3b0a1/68747470733a2f2f646570732e72732f63726174652f6d6f757365666f6f642f6c61746573742f7374617475732e7376673f7374796c653d666c61742d737175617265" alt="Deps" data-canonical-src="https://deps.rs/crate/mousefood/latest/status.svg?style=flat-square"></a></p>
<p dir="auto"><strong>Mousefood</strong> - a no-std
<a href="https://crates.io/crates/embedded-graphics" rel="nofollow">embedded-graphics</a> backend
for <a href="https://crates.io/crates/ratatui" rel="nofollow">Ratatui</a>!</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ratatui/mousefood/blob/599f1026d37c8d6308a6df64a234dbefaedc0c6f/assets/demo.jpg?raw=true"><img src="https://github.com/ratatui/mousefood/raw/599f1026d37c8d6308a6df64a234dbefaedc0c6f/assets/demo.jpg?raw=true" alt="demo"></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/ratatui/mousefood/blob/599f1026d37c8d6308a6df64a234dbefaedc0c6f/assets/demo.gif?raw=true"><img src="https://github.com/ratatui/mousefood/raw/599f1026d37c8d6308a6df64a234dbefaedc0c6f/assets/demo.gif?raw=true" alt="animated demo" data-animated-image=""></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Quickstart</h2><a id="user-content-quickstart" aria-label="Permalink: Quickstart" href="#quickstart"></a></p>
<p dir="auto">Add mousefood as a dependency:</p>

<p dir="auto">Exemplary setup:</p>
<div dir="auto" data-snippet-clipboard-copy-content="use mousefood::embedded_graphics::{mock_display::MockDisplay, pixelcolor::Rgb888};
use mousefood::prelude::*;
use ratatui::widgets::{Block, Paragraph};
use ratatui::{Frame, Terminal};

fn main() -> Result<(), Box<dyn std::error::Error>> {
    // replace this with your display driver
    // e.g. ILI9341, ST7735, SSD1306, etc.
    let mut display = MockDisplay::<Rgb888>::new();

    let backend = EmbeddedBackend::new(&amp;mut display, EmbeddedBackendConfig::default());
    let mut terminal = Terminal::new(backend)?;

    terminal.draw(draw)?;
    Ok(())
}

fn draw(frame: &amp;mut Frame) {
    let block = Block::bordered().title(&quot;Mousefood&quot;);
    let paragraph = Paragraph::new(&quot;Hello from Mousefood!&quot;).block(block);
    frame.render_widget(paragraph, frame.area());
}"><pre><span>use</span> mousefood<span>::</span>embedded_graphics<span>::</span><span>{</span>mock_display<span>::</span><span>MockDisplay</span><span>,</span> pixelcolor<span>::</span><span>Rgb888</span><span>}</span><span>;</span>
<span>use</span> mousefood<span>::</span>prelude<span>::</span><span>*</span><span>;</span>
<span>use</span> ratatui<span>::</span>widgets<span>::</span><span>{</span><span>Block</span><span>,</span> <span>Paragraph</span><span>}</span><span>;</span>
<span>use</span> ratatui<span>::</span><span>{</span><span>Frame</span><span>,</span> <span>Terminal</span><span>}</span><span>;</span>

<span>fn</span> <span>main</span><span>(</span><span>)</span> -&gt; <span>Result</span><span>&lt;</span><span>(</span><span>)</span><span>,</span> <span>Box</span><span>&lt;</span><span>dyn</span> std<span>::</span>error<span>::</span><span>Error</span><span>&gt;</span><span>&gt;</span> <span>{</span>
    <span>// replace this with your display driver</span>
    <span>// e.g. ILI9341, ST7735, SSD1306, etc.</span>
    <span>let</span> <span>mut</span> display = <span>MockDisplay</span><span>::</span><span>&lt;</span><span>Rgb888</span><span>&gt;</span><span>::</span><span>new</span><span>(</span><span>)</span><span>;</span>

    <span>let</span> backend = <span>EmbeddedBackend</span><span>::</span><span>new</span><span>(</span><span>&amp;</span><span>mut</span> display<span>,</span> <span>EmbeddedBackendConfig</span><span>::</span><span>default</span><span>(</span><span>)</span><span>)</span><span>;</span>
    <span>let</span> <span>mut</span> terminal = <span>Terminal</span><span>::</span><span>new</span><span>(</span>backend<span>)</span>?<span>;</span>

    terminal<span>.</span><span>draw</span><span>(</span>draw<span>)</span>?<span>;</span>
    <span>Ok</span><span>(</span><span>(</span><span>)</span><span>)</span>
<span>}</span>

<span>fn</span> <span>draw</span><span>(</span><span>frame</span><span>:</span> <span>&amp;</span><span>mut</span> <span>Frame</span><span>)</span> <span>{</span>
    <span>let</span> block = <span>Block</span><span>::</span><span>bordered</span><span>(</span><span>)</span><span>.</span><span>title</span><span>(</span><span>"Mousefood"</span><span>)</span><span>;</span>
    <span>let</span> paragraph = <span>Paragraph</span><span>::</span><span>new</span><span>(</span><span>"Hello from Mousefood!"</span><span>)</span><span>.</span><span>block</span><span>(</span>block<span>)</span><span>;</span>
    frame<span>.</span><span>render_widget</span><span>(</span>paragraph<span>,</span> frame<span>.</span><span>area</span><span>(</span><span>)</span><span>)</span><span>;</span>
<span>}</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Special characters</h3><a id="user-content-special-characters" aria-label="Permalink: Special characters" href="#special-characters"></a></p>
<p dir="auto">Embedded-graphics includes bitmap fonts that have a very limited
set of characters to save space (ASCII, ISO 8859 or JIS X0201).
This makes it impossible to draw most of Ratatui's widgets,
which heavily use box-drawing glyphs, Braille,
and other special characters.</p>
<p dir="auto">Mousefood by default uses <a href="https://crates.io/crates/embedded-graphics-unicodefonts" rel="nofollow"><code>embedded-graphics-unicodefonts</code></a>,
which provides embedded-graphics fonts with a much larger set of characters.</p>
<p dir="auto"><h4 tabindex="-1" dir="auto">Alternatives</h4><a id="user-content-alternatives" aria-label="Permalink: Alternatives" href="#alternatives"></a></p>
<p dir="auto">In order to save space and <a href="#performance-and-hardware-support">speed up rendering</a>,
the <code>fonts</code> feature can be disabled by turning off the default crate features.
<a href="https://crates.io/crates/ibm437" rel="nofollow"><code>ibm437</code></a> is a good alternative that includes
some drawing characters, but is not as large as embedded-graphics-unicodefonts.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Bold and italic fonts</h3><a id="user-content-bold-and-italic-fonts" aria-label="Permalink: Bold and italic fonts" href="#bold-and-italic-fonts"></a></p>
<p dir="auto">Bold and italic modifiers are supported, but this requires providing fonts
through <code>EmbeddedBackendConfig</code>.
If only regular font is provided, it serves as a fallback.
All fonts must be of the same size.</p>
<div dir="auto" data-snippet-clipboard-copy-content="use mousefood::embedded_graphics::{mock_display::MockDisplay, pixelcolor::Rgb888};
use mousefood::{EmbeddedBackend, EmbeddedBackendConfig, fonts};
use ratatui::Terminal;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let mut display = MockDisplay::<Rgb888>::new();
    let config = EmbeddedBackendConfig {
        font_regular: fonts::MONO_6X13,
        font_bold: Some(fonts::MONO_6X13_BOLD),
        font_italic: Some(fonts::MONO_6X13_ITALIC),
        ..Default::default()
    };
    let backend = EmbeddedBackend::new(&amp;mut display, config);
    let _terminal = Terminal::new(backend)?;
    Ok(())
}"><pre><span>use</span> mousefood<span>::</span>embedded_graphics<span>::</span><span>{</span>mock_display<span>::</span><span>MockDisplay</span><span>,</span> pixelcolor<span>::</span><span>Rgb888</span><span>}</span><span>;</span>
<span>use</span> mousefood<span>::</span><span>{</span><span>EmbeddedBackend</span><span>,</span> <span>EmbeddedBackendConfig</span><span>,</span> fonts<span>}</span><span>;</span>
<span>use</span> ratatui<span>::</span><span>Terminal</span><span>;</span>

<span>fn</span> <span>main</span><span>(</span><span>)</span> -&gt; <span>Result</span><span>&lt;</span><span>(</span><span>)</span><span>,</span> <span>Box</span><span>&lt;</span><span>dyn</span> std<span>::</span>error<span>::</span><span>Error</span><span>&gt;</span><span>&gt;</span> <span>{</span>
    <span>let</span> <span>mut</span> display = <span>MockDisplay</span><span>::</span><span>&lt;</span><span>Rgb888</span><span>&gt;</span><span>::</span><span>new</span><span>(</span><span>)</span><span>;</span>
    <span>let</span> config = <span>EmbeddedBackendConfig</span> <span>{</span>
        <span>font_regular</span><span>:</span> fonts<span>::</span><span>MONO_6X13</span><span>,</span>
        <span>font_bold</span><span>:</span> <span>Some</span><span>(</span>fonts<span>::</span><span>MONO_6X13_BOLD</span><span>)</span><span>,</span>
        <span>font_italic</span><span>:</span> <span>Some</span><span>(</span>fonts<span>::</span><span>MONO_6X13_ITALIC</span><span>)</span><span>,</span>
        ..<span>Default</span><span>::</span><span>default</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>
    <span>let</span> backend = <span>EmbeddedBackend</span><span>::</span><span>new</span><span>(</span><span>&amp;</span><span>mut</span> display<span>,</span> config<span>)</span><span>;</span>
    <span>let</span> _terminal = <span>Terminal</span><span>::</span><span>new</span><span>(</span>backend<span>)</span>?<span>;</span>
    <span>Ok</span><span>(</span><span>(</span><span>)</span><span>)</span>
<span>}</span></pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://github.com/ratatui/mousefood/blob/6640da9402794ea8f9370e0dc2b4bd1ebf2c6356/assets/bold_italic.png?raw=true"><img alt="Bold and Italic fonts" src="https://github.com/ratatui/mousefood/raw/6640da9402794ea8f9370e0dc2b4bd1ebf2c6356/assets/bold_italic.png?raw=true"></a>
</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Color theme</h3><a id="user-content-color-theme" aria-label="Permalink: Color theme" href="#color-theme"></a></p>
<p dir="auto">Colors can be remapped using <code>color_theme</code> on <code>EmbeddedBackendConfig</code>.
By default the ANSI palette is used.</p>
<div dir="auto" data-snippet-clipboard-copy-content="use mousefood::{ColorTheme, EmbeddedBackend, EmbeddedBackendConfig};
use mousefood::embedded_graphics::{mock_display::MockDisplay, pixelcolor::Rgb888};

fn main() -> Result<(), Box<dyn std::error::Error>> {
    let mut display = MockDisplay::<Rgb888>::new();
    let theme = ColorTheme {
        background: Rgb888::new(5, 5, 5),
        foreground: Rgb888::new(240, 240, 240),
        yellow: Rgb888::new(255, 200, 0),
        ..ColorTheme::ansi()
    };

    let config = EmbeddedBackendConfig {
        color_theme: theme,
        ..Default::default()
    };
    let backend = EmbeddedBackend::new(&amp;mut display, config);
    Ok(())
}"><pre><span>use</span> mousefood<span>::</span><span>{</span><span>ColorTheme</span><span>,</span> <span>EmbeddedBackend</span><span>,</span> <span>EmbeddedBackendConfig</span><span>}</span><span>;</span>
<span>use</span> mousefood<span>::</span>embedded_graphics<span>::</span><span>{</span>mock_display<span>::</span><span>MockDisplay</span><span>,</span> pixelcolor<span>::</span><span>Rgb888</span><span>}</span><span>;</span>

<span>fn</span> <span>main</span><span>(</span><span>)</span> -&gt; <span>Result</span><span>&lt;</span><span>(</span><span>)</span><span>,</span> <span>Box</span><span>&lt;</span><span>dyn</span> std<span>::</span>error<span>::</span><span>Error</span><span>&gt;</span><span>&gt;</span> <span>{</span>
    <span>let</span> <span>mut</span> display = <span>MockDisplay</span><span>::</span><span>&lt;</span><span>Rgb888</span><span>&gt;</span><span>::</span><span>new</span><span>(</span><span>)</span><span>;</span>
    <span>let</span> theme = <span>ColorTheme</span> <span>{</span>
        <span>background</span><span>:</span> <span>Rgb888</span><span>::</span><span>new</span><span>(</span><span>5</span><span>,</span> <span>5</span><span>,</span> <span>5</span><span>)</span><span>,</span>
        <span>foreground</span><span>:</span> <span>Rgb888</span><span>::</span><span>new</span><span>(</span><span>240</span><span>,</span> <span>240</span><span>,</span> <span>240</span><span>)</span><span>,</span>
        <span>yellow</span><span>:</span> <span>Rgb888</span><span>::</span><span>new</span><span>(</span><span>255</span><span>,</span> <span>200</span><span>,</span> <span>0</span><span>)</span><span>,</span>
        ..<span>ColorTheme</span><span>::</span><span>ansi</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>

    <span>let</span> config = <span>EmbeddedBackendConfig</span> <span>{</span>
        <span>color_theme</span><span>:</span> theme<span>,</span>
        ..<span>Default</span><span>::</span><span>default</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>
    <span>let</span> backend = <span>EmbeddedBackend</span><span>::</span><span>new</span><span>(</span><span>&amp;</span><span>mut</span> display<span>,</span> config<span>)</span><span>;</span>
    <span>Ok</span><span>(</span><span>(</span><span>)</span><span>)</span>
<span>}</span></pre></div>
<p dir="auto"><h4 tabindex="-1" dir="auto">Built-in themes</h4><a id="user-content-built-in-themes" aria-label="Permalink: Built-in themes" href="#built-in-themes"></a></p>
<p dir="auto">Mousefood includes popular color themes that can be used directly:</p>
<ul dir="auto">
<li><code>ColorTheme::ansi()</code> - Standard ANSI colors (default)</li>
<li><code>ColorTheme::tokyo_night()</code> - Tokyo Night dark theme with blue/purple tones</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">Simulator</h3><a id="user-content-simulator" aria-label="Permalink: Simulator" href="#simulator"></a></p>
<p dir="auto">Mousefood can be run in a simulator using
<a href="https://crates.io/crates/embedded-graphics-simulator" rel="nofollow">embedded-graphics-simulator</a> crate.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ratatui/mousefood/blob/66d4010deed18f755cc3148a7f682f4119b7f664/assets/simulator.png?raw=true"><img src="https://github.com/ratatui/mousefood/raw/66d4010deed18f755cc3148a7f682f4119b7f664/assets/simulator.png?raw=true" alt="Screenshot of a window running the simulator with a mousefood application"></a></p>
<p dir="auto">Run simulator example:</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/ratatui/mousefood.git
cd mousefood/examples/simulator
cargo run"><pre>git clone https://github.com/ratatui/mousefood.git
<span>cd</span> mousefood/examples/simulator
cargo run</pre></div>
<p dir="auto">For more details, view the <a href="https://github.com/ratatui/mousefood/blob/main/examples/simulator">simulator example</a>.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">EPD support</h3><a id="user-content-epd-support" aria-label="Permalink: EPD support" href="#epd-support"></a></p>
<p dir="auto"><h4 tabindex="-1" dir="auto">WeAct Studio</h4><a id="user-content-weact-studio" aria-label="Permalink: WeAct Studio" href="#weact-studio"></a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ratatui/mousefood/blob/fa70cdd46567a51895caf10c44fff4104602e880/assets/epd-weact.jpg?raw=true"><img src="https://github.com/ratatui/mousefood/raw/fa70cdd46567a51895caf10c44fff4104602e880/assets/epd-weact.jpg?raw=true" alt="WeAct epd demo"></a></p>
<p dir="auto">Support for EPD (e-ink displays) produced by WeAct Studio
(<code>weact-studio-epd</code> driver) can be enabled using <code>epd-weact</code> feature.</p>
<p dir="auto">This driver requires some additional configuration.
Follow the <a href="https://docs.rs/weact-studio-epd" rel="nofollow"><code>weact-studio-epd</code></a>
crate docs and apply the same <code>flush_callback</code> pattern used in the <a href="#waveshare">Waveshare example below</a>.</p>
<details>
  <summary>Setup example</summary>
<div dir="auto" data-snippet-clipboard-copy-content="use mousefood::prelude::*;
use weact_studio_epd::graphics::Display290BlackWhite;
use weact_studio_epd::WeActStudio290BlackWhiteDriver;

fn main() -> Result<(), Box<dyn std::error::Error>> {
    // Configure SPI + GPIO + delay provider for your board.
    // let (spi_interface, busy, rst, delay) = ...;

    let mut driver = WeActStudio290BlackWhiteDriver::new(spi_interface, busy, rst, delay);
    let mut display = Display290BlackWhite::new();

    driver.init()?;

    let config = EmbeddedBackendConfig {
        flush_callback: Box::new(move |d| {
            driver.full_update(d).expect(&quot;epd update failed&quot;);
        }),
        ..Default::default()
    };

    let backend = EmbeddedBackend::new(&amp;mut display, config);
    let _terminal = Terminal::new(backend)?;
    Ok(())
}"><pre><span>use</span> mousefood<span>::</span>prelude<span>::</span><span>*</span><span>;</span>
<span>use</span> weact_studio_epd<span>::</span>graphics<span>::</span><span>Display290BlackWhite</span><span>;</span>
<span>use</span> weact_studio_epd<span>::</span><span>WeActStudio290BlackWhiteDriver</span><span>;</span>

<span>fn</span> <span>main</span><span>(</span><span>)</span> -&gt; <span>Result</span><span>&lt;</span><span>(</span><span>)</span><span>,</span> <span>Box</span><span>&lt;</span><span>dyn</span> std<span>::</span>error<span>::</span><span>Error</span><span>&gt;</span><span>&gt;</span> <span>{</span>
    <span>// Configure SPI + GPIO + delay provider for your board.</span>
    <span>// let (spi_interface, busy, rst, delay) = ...;</span>

    <span>let</span> <span>mut</span> driver = <span>WeActStudio290BlackWhiteDriver</span><span>::</span><span>new</span><span>(</span>spi_interface<span>,</span> busy<span>,</span> rst<span>,</span> delay<span>)</span><span>;</span>
    <span>let</span> <span>mut</span> display = <span>Display290BlackWhite</span><span>::</span><span>new</span><span>(</span><span>)</span><span>;</span>

    driver<span>.</span><span>init</span><span>(</span><span>)</span>?<span>;</span>

    <span>let</span> config = <span>EmbeddedBackendConfig</span> <span>{</span>
        <span>flush_callback</span><span>:</span> <span>Box</span><span>::</span><span>new</span><span>(</span><span>move</span> |d| <span>{</span>
            driver<span>.</span><span>full_update</span><span>(</span>d<span>)</span><span>.</span><span>expect</span><span>(</span><span>"epd update failed"</span><span>)</span><span>;</span>
        <span>}</span><span>)</span><span>,</span>
        ..<span>Default</span><span>::</span><span>default</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>

    <span>let</span> backend = <span>EmbeddedBackend</span><span>::</span><span>new</span><span>(</span><span>&amp;</span><span>mut</span> display<span>,</span> config<span>)</span><span>;</span>
    <span>let</span> _terminal = <span>Terminal</span><span>::</span><span>new</span><span>(</span>backend<span>)</span>?<span>;</span>
    <span>Ok</span><span>(</span><span>(</span><span>)</span><span>)</span>
<span>}</span></pre></div>
</details>
<p dir="auto"><h4 tabindex="-1" dir="auto">Waveshare</h4><a id="user-content-waveshare" aria-label="Permalink: Waveshare" href="#waveshare"></a></p>
<p dir="auto">Support for EPD (e-ink displays) produced by Waveshare Electronics
(<code>epd-waveshare</code> driver) can be enabled using <code>epd-waveshare</code> feature.</p>
<details>
  <summary>Setup example</summary>
<div dir="auto" data-snippet-clipboard-copy-content="use mousefood::prelude::*;
use epd_waveshare::{epd2in9_v2::*, prelude::*};

fn main() -> Result<(), Box<dyn std::error::Error>> {
    // Configure SPI + GPIO + delay provider for your board.
    // let (mut spi_device, busy, dc, rst, mut delay) = ...;

    let mut epd = Epd2in9::new(&amp;mut spi_device, busy, dc, rst, &amp;mut delay, None)?;
    let mut display = Display2in9::default();

    let config = EmbeddedBackendConfig {
        flush_callback: Box::new(move |d| {
            epd.update_and_display_frame(&amp;mut spi_device, d.buffer(), &amp;mut delay)
                .expect(&quot;epd update failed&quot;);
        }),
        ..Default::default()
    };

    let backend = EmbeddedBackend::new(&amp;mut display, config);
    let _terminal = Terminal::new(backend)?;
    Ok(())
}"><pre><span>use</span> mousefood<span>::</span>prelude<span>::</span><span>*</span><span>;</span>
<span>use</span> epd_waveshare<span>::</span><span>{</span>epd2in9_v2<span>::</span><span>*</span><span>,</span> prelude<span>::</span><span>*</span><span>}</span><span>;</span>

<span>fn</span> <span>main</span><span>(</span><span>)</span> -&gt; <span>Result</span><span>&lt;</span><span>(</span><span>)</span><span>,</span> <span>Box</span><span>&lt;</span><span>dyn</span> std<span>::</span>error<span>::</span><span>Error</span><span>&gt;</span><span>&gt;</span> <span>{</span>
    <span>// Configure SPI + GPIO + delay provider for your board.</span>
    <span>// let (mut spi_device, busy, dc, rst, mut delay) = ...;</span>

    <span>let</span> <span>mut</span> epd = <span>Epd2in9</span><span>::</span><span>new</span><span>(</span><span>&amp;</span><span>mut</span> spi_device<span>,</span> busy<span>,</span> dc<span>,</span> rst<span>,</span> <span>&amp;</span><span>mut</span> delay<span>,</span> <span>None</span><span>)</span>?<span>;</span>
    <span>let</span> <span>mut</span> display = <span>Display2in9</span><span>::</span><span>default</span><span>(</span><span>)</span><span>;</span>

    <span>let</span> config = <span>EmbeddedBackendConfig</span> <span>{</span>
        <span>flush_callback</span><span>:</span> <span>Box</span><span>::</span><span>new</span><span>(</span><span>move</span> |d| <span>{</span>
            epd<span>.</span><span>update_and_display_frame</span><span>(</span><span>&amp;</span><span>mut</span> spi_device<span>,</span> d<span>.</span><span>buffer</span><span>(</span><span>)</span><span>,</span> <span>&amp;</span><span>mut</span> delay<span>)</span>
                <span>.</span><span>expect</span><span>(</span><span>"epd update failed"</span><span>)</span><span>;</span>
        <span>}</span><span>)</span><span>,</span>
        ..<span>Default</span><span>::</span><span>default</span><span>(</span><span>)</span>
    <span>}</span><span>;</span>

    <span>let</span> backend = <span>EmbeddedBackend</span><span>::</span><span>new</span><span>(</span><span>&amp;</span><span>mut</span> display<span>,</span> config<span>)</span><span>;</span>
    <span>let</span> _terminal = <span>Terminal</span><span>::</span><span>new</span><span>(</span>backend<span>)</span>?<span>;</span>
    <span>Ok</span><span>(</span><span>(</span><span>)</span><span>)</span>
<span>}</span></pre></div>
</details>
<p dir="auto">See the full embedded example at <a href="https://github.com/ratatui/mousefood/tree/main/examples/epd-waveshare-demo"><code>examples/epd-waveshare-demo</code></a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Performance and hardware support</h2><a id="user-content-performance-and-hardware-support" aria-label="Permalink: Performance and hardware support" href="#performance-and-hardware-support"></a></p>
<p dir="auto">Flash memory on most embedded devices is very limited. Additionally,
to achieve high frame rate when using the <code>fonts</code> feature,
it is recommended to use <code>opt-level = 3</code>,
which can make the resulting binary even larger.</p>
<p dir="auto">Mousefood is hardware-agnostic.
Successfully tested on:</p>
<ul dir="auto">
<li>ESP32 (Xtensa)</li>
<li>ESP32-C6 (RISC-V)</li>
<li>STM32</li>
<li>RP2040</li>
<li>RP2350</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Docs</h2><a id="user-content-docs" aria-label="Permalink: Docs" href="#docs"></a></p>
<p dir="auto">Full API docs are available on <a href="https://docs.rs/mousefood" rel="nofollow">docs.rs</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Contributing</h2><a id="user-content-contributing" aria-label="Permalink: Contributing" href="#contributing"></a></p>
<p dir="auto">All contributions are welcome!</p>
<p dir="auto">Before opening a pull request, please read the <a href="https://github.com/ratatui/mousefood/blob/main/CONTRIBUTING.md">contributing guidelines</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Built with Mousefood</h2><a id="user-content-built-with-mousefood" aria-label="Permalink: Built with Mousefood" href="#built-with-mousefood"></a></p>
<p dir="auto">Here are some projects built using Mousefood:</p>
<ul dir="auto">
<li><a href="https://github.com/orhun/tuitar">Tuitar</a> - A portable guitar training tool.</li>
<li><a href="https://github.com/intuis/mnyaoo32">Mnyaoo32</a> - An eccentric way to consume IRC messages using ESP32.</li>
<li><a href="https://github.com/Julien-cpsn/Phone-OS">Phone-OS</a> - A modern phone OS for ESP32 CYD.</li>
</ul>
<p dir="auto">Send a pull request to add your project here!</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto"><a href="https://github.com/ratatui/mousefood/blob/main/LICENSE-MIT"><img src="https://camo.githubusercontent.com/c3957e1022b48e04bf5149c28553b7f6635004b71d7d64ccab3966725659f002/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d4d49542d79656c6c6f772e7376673f7374796c653d666c61742d73717561726526636f6c6f723d386439376233" alt="License MIT" data-canonical-src="https://img.shields.io/badge/License-MIT-yellow.svg?style=flat-square&amp;color=8d97b3"></a>
<a href="https://github.com/ratatui/mousefood/blob/main/LICENSE-APACHE"><img src="https://camo.githubusercontent.com/81843b554babacdbe84fccac5ca72d83531f10d31a9a989e062e6b1c83331d06/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4c6963656e73652d417061636865253230322e302d626c75652e7376673f7374796c653d666c61742d73717561726526636f6c6f723d386439376233" alt="License Apache 2.0" data-canonical-src="https://img.shields.io/badge/License-Apache%202.0-blue.svg?style=flat-square&amp;color=8d97b3"></a></p>
<p dir="auto">Mousefood is dual-licensed under
<a href="https://github.com/ratatui/mousefood/blob/main/LICENSE-APACHE">Apache 2.0</a> and <a href="https://github.com/ratatui/mousefood/blob/main/LICENSE-MIT">MIT</a> terms.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Spinning around: Please don’t – Common problems with spin locks (116 pts)]]></title>
            <link>https://www.siliceum.com/en/blog/post/spinning-around/</link>
            <guid>46797868</guid>
            <pubDate>Wed, 28 Jan 2026 16:48:59 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.siliceum.com/en/blog/post/spinning-around/">https://www.siliceum.com/en/blog/post/spinning-around/</a>, See on <a href="https://news.ycombinator.com/item?id=46797868">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-astro-cid-vw24gqkt=""><article data-astro-cid-vw24gqkt=""><h2 id="intro">Intro</h2>
<p>This is the 3<sup>rd</sup> project in less than a year where I’ve seen issues with spin-loops. I’ve been dealing with spinning threads for many years now, and I won’t lie: over the years I’ve been both on the offender and victim side.<br>
I’m getting tired of seeing the same issues again and again, which usually makes for a good reason to write a blog post so that, hopefully, people will read it and stop making the same mistakes others did.</p>
<p>Actually, many others have written about this, covering various issues related to spin locks <sup><a href="#user-content-fn-1" id="user-content-fnref-1" data-footnote-ref="" aria-describedby="footnote-label">1</a></sup> <sup><a href="#user-content-fn-2" id="user-content-fnref-2" data-footnote-ref="" aria-describedby="footnote-label">2</a></sup> <sup><a href="#user-content-fn-3" id="user-content-fnref-3" data-footnote-ref="" aria-describedby="footnote-label">3</a></sup> <sup><a href="#user-content-fn-4" id="user-content-fnref-4" data-footnote-ref="" aria-describedby="footnote-label">4</a></sup> <sup><a href="#user-content-fn-5" id="user-content-fnref-5" data-footnote-ref="" aria-describedby="footnote-label">5</a></sup> <sup><a href="#user-content-fn-x" id="user-content-fnref-x" data-footnote-ref="" aria-describedby="footnote-label">6</a></sup>. But I guess there’s never enough material on those subjects. Some are about speed, others about fairness, a few about priority inversion, NUMA, and sometimes even about actually broken code.<br>
If this list hasn’t convinced you that things do spin out of control when using spin-locks, and that you should use OS primitives instead, keep reading. I’ll cover what you should not do when implementing your own spin-lock. Notice I said what you should <strong>NOT</strong> do, because, <strong>again</strong>, you should <em>probably</em> not use a spin-lock at all these days.<br>
And if you do… make sure you really, REALLY, <strong>REALLY</strong> know what you’re doing (<em>spoiler: it will always come back to bite you when you least expect it</em>).</p>
<p>Note this is a story about spin loops in general, not about locking algorithms for which there are many <sup><a href="#user-content-fn-5" id="user-content-fnref-5-2" data-footnote-ref="" aria-describedby="footnote-label">5</a></sup>.</p>
<h2 id="the-broken-spin-lock">The broken spin-lock</h2>
<p>Let’s start with the basics, you want to implement your own spinlock.</p>
<blockquote>
<p>🤪 “It’s easy! You simply have a boolean, a <code>lock</code> and an <code>unlock</code> function.”</p>
</blockquote>
<p>Right…</p>
<p><em>For demonstration purposes, we are using <code>int</code> instead of <code>bool</code> as you might have something more complicated to do with it, such as storing metadata (for example: the thread ID). There are also quite a few pieces of code around that do not implement a spin-lock per se, but mutate some other content such as pointers.</em></p>
<pre tabindex="0" data-language="cpp"><code><span><span>class</span><span> BrokenSpinLock</span></span>
<span><span>{</span></span>
<span><span>    // Using int32_t instead of bool on purpose, don't mind it.</span></span>
<span><span>    int32_t</span><span> isLocked </span><span>=</span><span> 0</span><span>;</span></span>
<span><span>public:</span></span>
<span><span>    void</span><span> lock</span><span>()</span></span>
<span><span>    {</span></span>
<span><span>        while</span><span> (isLocked </span><span>!=</span><span> 0</span><span>)</span><span> // (1)</span></span>
<span><span>        {</span></span>
<span><span>            // Loop again until not locked anymore</span></span>
<span><span>        }</span></span>
<span><span>                            // (2)</span></span>
<span><span>        isLocked </span><span>=</span><span> 1</span><span>;</span><span>       // (3)</span></span>
<span><span>    }</span><span>                       // (4)</span></span>
<span></span>
<span><span>    void</span><span> unlock</span><span>()</span></span>
<span><span>    {</span></span>
<span><span>        isLocked </span><span>=</span><span> 0</span><span>;</span></span>
<span><span>    }</span></span>
<span><span>};</span></span></code></pre>
<p>Those who have dealt with multi-threading before will immediately spot the issue. The code is not thread-safe as, if multiple threads attempt to use this lock, we could read invalid values of <code>isLocked</code> (<em>in theory, and on a CPU where tearing could happen on its word size</em>).
Worse, even if this could not happen, a wild race-condition could appear.<br>
Consider the following example where two threads would call <code>lock</code> at the exact same time:</p>
<pre tabindex="0" data-language="plaintext"><code><span><span>(1) ThreadA: Sees `isLocked == 0` | ThreadB: Sees `isLocked == 0` </span></span>
<span><span>(2) ThreadA: Leaves the loop      | ThreadB: Leaves the loop       </span></span>
<span><span>(3) ThreadA: Writes 1 to isLocked | ThreadB: Writes 1 to isLocked </span></span></code></pre>
<p>Now we have two threads who think they have successfully acquired the lock!</p>
<p>Some may also have heard about this shiny little thing called <code>atomic</code> variables/operations.<br>
To oversimplify: atomic operations guarantee that other threads cannot observe a partial/intermediate state of the operation and thus race-conditions can not occur (<em>on those specific operations and memory</em>).</p>
<blockquote>
<p>💡 While named after the Greek <code>atomos</code> that means “that which cannot be divided”, <code>atomic</code> operations might as well be as dangerous and difficult to use as nuclear energy.</p>
</blockquote>
<p>Let’s replace <code>isLocked</code> by an atomic version: <code>std::atomic&lt;int&gt;</code>. Though our code does not suffer from a race-condition on the data itself, we still do not know if the thread that sets <code>isLocked</code> to <code>1</code> is the one that now owns the lock. But we can now do an <a href="https://en.cppreference.com/w/cpp/atomic/atomic/exchange.html"><code>exchange</code></a> operation atomically, which solves our little problem!</p>
<p>Instead of first checking if the lock is locked, then writing, we actually write our value and get the previous value, in a single atomic operation! If the previous value was <code>0</code>, then it means we’re the one who actually did the locking. Otherwise we will see a <code>1</code>, meaning the lock was already held either before we tried, or because another thread’s exchange completed before ours.</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>) </span><span>!=</span><span> 0</span><span>) {}</span></span>
<span><span>}</span></span></code></pre>
<p>Let’s replay the scenario. Even if both threads execute the exchange simultaneously, atomicity guarantees one will finish before the other, for example Thread <strong>B</strong>’s:</p>
<pre tabindex="0" data-language="plaintext"><code><span><span>ThreadA: `isLocked.exchange(1)` | ThreadB: `isLocked.exchange(1)` </span></span>
<span><span>ThreadA: Writes 1, sees 1       | ThreadB: Writes 1, sees 0       </span></span>
<span><span>ThreadA: Writes 1, sees 1       | ThreadB: Now owns the lock!</span></span>
<span><span>ThreadA: ...                    | ThreadB: ... </span></span>
<span><span>ThreadA: ...                    | ThreadB: `unlock()`, writes 0 </span></span>
<span><span>ThreadA: Writes 1, sees 0       | ThreadB: ... </span></span>
<span><span>ThreadA: Now owns the lock!     | ThreadB: ... </span></span></code></pre>
<p>Good, we now have a working spin-lock, but we still have a long way to go.</p>
<blockquote>
<p>💡 In the CPU lingua, a memory <strong>read</strong>/<strong>write</strong> is called a memory <strong>load</strong>/<strong>store</strong></p>
</blockquote>
<h2 id="the-spin-lock-that-burned-cpus">The spin-lock that burned CPUs</h2>
<p>You may have realized that our spin-lock will… spin doing nothing, the loop is empty.</p>
<blockquote>
<p>🤪 “Great, it’ll attempt to take ownership faster”</p>
</blockquote>
<p>Well, that’s only true if you want to burn your CPU. Since the CPU has no way of knowing that you are waiting and not doing any meaningful work, it might stay at a high frequency.
Modern CPUs can change the frequency of the cores to save energy, and effectively also lower the CPU core temperature. This is clearly not desirable behavior, especially on mobile/embedded devices.</p>
<p>Not convinced or do not care about the planet? (shame on you!) Then at least think about your users’ power bill. Still not convinced? What if I told you this can actually be slower than doing something in the loop?<br>
Imagine that a lot of threads are attempting to lock your spin-lock. Only one can win. But worse, due to its nature you always do memory writes, which need to be synchronized between the different cores of your CPU!</p>
<p>From Intel’s Optimization Reference Manual <sup><a href="#user-content-fn-3" id="user-content-fnref-3-2" data-footnote-ref="" aria-describedby="footnote-label">3</a></sup> <strong>11.4.2</strong>:</p>
<blockquote>
<p>On a modern microprocessor with a superscalar speculative execution engine, a loop like this results in the issue of
multiple simultaneous read requests from the spinning thread. These requests usually execute out-of-order with each
read request being allocated a buffer resource. On detection of a write by a worker thread to a load that is in progress,
the processor <strong>must guarantee</strong> no violations of memory order occur. The necessity of maintaining the order of
outstanding memory operations inevitably <strong>costs the processor a severe penalty</strong> that impacts all threads.</p>
</blockquote>
<p>And the issue will keep getting bigger with recent CPUs that have many cores and sometimes NUMA memory.</p>
<blockquote>
<p>This penalty occurs on the Intel Core Solo and Intel Core Duo processors. However, the penalty on these
processors is small compared with penalties suffered on the Intel Xeon processors. There the performance penalty for
exiting the loop is about <strong>25 times more severe</strong>.</p>
</blockquote>
<p>If you still need some convincing… this is even worse if you enable SMT (hyperthreading):</p>
<blockquote>
<p>On a processor supporting Intel HT Technology, spin-wait loops can consume a significant portion of the execution
bandwidth of the processor. One logical processor executing a spin-wait loop can <strong>severely impact the performance</strong> of
the other logical processor.</p>
</blockquote>
<p>Now that I hopefully have your attention, here’s how to <del>solve</del> mitigate the issue:<br>
The best way to avoid “bothering” your neighbours is to <del>avoid spin loops</del> tell the CPU you are waiting to be notified of a memory change/doing a spinloop!
On x86 CPUs, this is done with the <a href="https://www.felixcloutier.com/x86/pause"><code>PAUSE</code></a> instruction. It was designed exactly for this use-case!</p>
<blockquote>
<p>The penalty of exiting from a <strong>spin-wait loop can be avoided by inserting a <code>PAUSE</code> instruction in the loop</strong>. In spite of
the name, the <code>PAUSE</code> instruction <strong>improves performance</strong> by introducing a slight delay in the loop and effectively
causing the memory read requests to be issued at a rate that allows immediate detection of any store to the
synchronization variable. This <strong>prevents the occurrence of a long delay due to memory order violation</strong>.</p>
</blockquote>
<p>You can modify the code to use this instruction with compiler intrinsics:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> cpu_pause</span><span>()</span></span>
<span><span>{</span></span>
<span><span>#if</span><span> defined</span><span>(</span><span>__i386__</span><span>) </span><span>||</span><span> defined</span><span>(</span><span>__x86_64__</span><span>) </span><span>||</span><span> defined</span><span>(</span><span>_M_IX86</span><span>) </span><span>||</span><span> defined</span><span>(</span><span>_M_X64</span><span>)</span></span>
<span><span>    _mm_pause</span><span>();</span></span>
<span><span>#elif</span><span> defined</span><span>(__arm__) </span><span>||</span><span> defined</span><span>(__aarch64__) </span><span>||</span><span> defined</span><span>(</span><span>_M_ARM</span><span>) </span><span>||</span><span> defined</span><span>(</span><span>_M_ARM64</span><span>) </span><span>||</span><span> defined</span><span>(_M_ARM64EC)</span></span>
<span><span>    __yield</span><span>();</span></span>
<span><span>#else</span></span>
<span><span>    #error</span><span> "unknown instruction set"</span></span>
<span><span>#endif</span></span>
<span><span>}</span></span>
<span></span>
<span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        cpu_pause</span><span>();</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<h2 id="the-spin-lock-that-didnt-wait-enough">The spin-lock that didn’t wait enough</h2>
<p>As already mentioned, the penalty of synchronizing data between CPU cores is getting more expensive as new CPUs get more cores, get multiple core complexes or NUMA architectures.
Resolving conflicts (multiple cores trying to do atomic stores) thus needs to be mitigated in some way.
A traditional approach is to use a <em>backoff</em> strategy that increases the number of <code>PAUSE</code> instructions for each attempt at locking.</p>
<p>The one you will find most (recommended by the Intel Optimization Manual, 2.7.4), is the exponential backoff:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    const</span><span> int</span><span> maxPauses </span><span>=</span><span> 64</span><span>;</span><span> // MAX_BACKOFF</span></span>
<span><span>    int</span><span> nbPauses </span><span>=</span><span> 1</span><span>;</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        for</span><span> (</span><span>int</span><span> i </span><span>=</span><span> 0</span><span>; i</span><span>&lt;</span><span>nbPauses; i</span><span>++</span><span>)</span></span>
<span><span>            cpu_pause</span><span>();</span></span>
<span><span>        // Multiply the number of pauses by 2 until we reach the max backoff count.</span></span>
<span><span>        nbPauses </span><span>=</span><span> nbPauses </span><span>&lt;</span><span> maxPauses </span><span>?</span><span> nbPauses </span><span>*</span><span> 2</span><span> :</span><span> nbPauses;</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<p>As mentioned by Intel:</p>
<blockquote>
<p>The number of <code>PAUSE</code> instructions are increased by a factor of 2 until some <code>MAX_BACKOFF</code> is reached which is subject
to tuning.</p>
</blockquote>
<p>We also mix it with a bit of randomness by using <code>rdtsc</code>, and let’s refactor the yielding part into a structure that can be easily swapped:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>struct</span><span> Yielder</span></span>
<span><span>{</span></span>
<span><span>    static</span><span> const</span><span> int</span><span> maxPauses </span><span>=</span><span> 64</span><span>;</span><span> // MAX_BACKOFF</span></span>
<span><span>    int</span><span> nbPauses </span><span>=</span><span> 1</span><span>;</span></span>
<span><span>    void</span><span> do_yield</span><span>()</span></span>
<span><span>    {</span></span>
<span><span>        // jitter is in the range of [0;nbPauses-1].</span></span>
<span><span>        // We can use bitwise AND since nbPauses is a power of 2.</span></span>
<span><span>        const</span><span> int</span><span> jitter </span><span>=</span><span> static_cast&lt;int&gt;</span><span>(</span><span>__rdtsc</span><span>() </span><span>&amp;</span><span> (nbPauses </span><span>-</span><span> 1</span><span>));</span></span>
<span><span>        // So subtracting we get a value between [1;nbPauses]</span></span>
<span><span>        const</span><span> int</span><span> nbPausesThisLoop </span><span>=</span><span> nbPauses </span><span>-</span><span> jitter;</span></span>
<span><span>        for</span><span> (</span><span>int</span><span> i </span><span>=</span><span> 0</span><span>; i </span><span>&lt;</span><span> nbPausesThisLoop; i</span><span>++</span><span>) </span></span>
<span><span>            cpu_pause</span><span>();</span></span>
<span><span>        // Multiply the number of pauses by 2 until we reach the max backoff count.</span></span>
<span><span>        nbPauses </span><span>=</span><span> nbPauses </span><span>&lt;</span><span> maxPauses </span><span>?</span><span> nbPauses </span><span>*</span><span> 2</span><span> :</span><span> nbPauses;</span></span>
<span><span>    }</span></span>
<span><span>}</span></span>
<span></span>
<span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    Yielder yielder;</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        yielder.</span><span>do_yield</span><span>();</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<h2 id="the-spin-lock-that-waited-too-long">The spin-lock that waited too long</h2>
<p>Remember the comment above about <code>MAX_BACKOFF</code> being subject to tuning?
Well you’d better make sure to tune it for the exact CPU you’ll be working on.<br>
Let’s have a look at the following table listing the measured<sup><a href="#user-content-fn-w" id="user-content-fnref-w" data-footnote-ref="" aria-describedby="footnote-label">7</a></sup> duration of <code>PAUSE</code> in cycles:</p>













































<div data-astro-cid-zg6ajjo3=""> <table data-astro-cid-zg6ajjo3=""> <thead><tr><th>Sandy   Bridge</th><th>Ivy Bridge</th><th>Haswell</th><th>Broadwell</th><th>Skylake</th><th>Kaby Lake</th><th>Coffee Lake</th><th>Cannon Lake</th><th>Cascade Lake</th><th>Ice Lake</th><th>Rocket Lake</th><th>Alder Lake-P</th><th>Tremont</th><th>Alder Lake-E</th><th>AMD Zen+</th><th>AMD Zen2</th><th>AMD Zen3</th><th>AMD Zen4</th></tr></thead><tbody><tr><td>11.00</td><td>10.00</td><td>9.00</td><td>9.00</td><td>140.00</td><td>140.00</td><td>152.50</td><td>157.00</td><td>40.00</td><td>138.20</td><td>138.20</td><td>160.17</td><td>176.00</td><td>61.80</td><td>3.00</td><td>65.00</td><td>65.00</td><td>65.00</td></tr></tbody> </table> </div> 
<p>And that’s where the issue lies. Depending on the architecture, you may get more than 10x changes in cycles per <code>PAUSE</code>.<br>
Old CPUs tended to have small <code>PAUSE</code> duration of <strong>~10</strong> cycles on Intel, <strong>~3</strong> on AMD, where <em>new</em> architectures have a duration of <strong>100-160</strong> cycles on Intel, and <strong>~60</strong> cycles on AMD.
And this might get worse in the future!</p>
<p>This actually is also now part of the latest Intel Optimization Reference Manual <sup><a href="#user-content-fn-3" id="user-content-fnref-3-3" data-footnote-ref="" aria-describedby="footnote-label">3</a></sup> 2.7.4:</p>
<blockquote>
<p>The latency of the <code>PAUSE</code> instruction in prior generation microarchitectures is about 10 cycles, whereas in Skylake Client microarchitecture it has been extended to as many as 140 cycles.</p>
</blockquote>
<p>How to fix this, you ask? I’ll defer to Intel’s advice again and limit the duration of the <code>PAUSE</code> loop using CPU cycles instead of a counter:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>static</span><span> inline</span><span> bool</span><span> before</span><span>(</span><span>uint64_t</span><span> a</span><span>, </span><span>uint64_t</span><span> b</span><span>)</span></span>
<span><span>{</span></span>
<span><span>    return</span><span> ((</span><span>int64_t</span><span>)b </span><span>-</span><span> (</span><span>int64_t</span><span>)a) </span><span>&gt;</span><span> 0</span><span>;</span></span>
<span><span>}</span></span>
<span><span>void</span><span> pollDelay</span><span>(</span><span>uint32_t</span><span> clocks</span><span>)</span></span>
<span><span>{</span></span>
<span><span>    uint64_t</span><span> endTime </span><span>=</span><span> _rdtsc</span><span>()</span><span>+</span><span> clocks;</span></span>
<span><span>    for</span><span> (; </span><span>before</span><span>(</span><span>_rdtsc</span><span>(), endTime); )</span></span>
<span><span>        cpu_pause</span><span>();</span></span>
<span><span>}</span></span></code></pre>
<blockquote>
<p>As the <code>PAUSE</code> latency has been increased significantly, workloads that are sensitive to <code>PAUSE</code> latency will suffer some
performance loss.<br>
[…]<br>
Notice that in the Skylake Client microarchitecture the <code>RDTSC</code> instruction counts at the machine’s guaranteed P1
frequency independently of the current processor clock (see the INVARIANT TSC property), and therefore, when
running in Intel® Turbo-Boost-enabled mode, the delay will remain constant, but the number of instructions that
could have been executed will change.</p>
</blockquote>
<p>Let’s implement this:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>struct</span><span> Yielder</span></span>
<span><span>{</span></span>
<span><span>    static</span><span> const</span><span> int</span><span> maxPauses </span><span>=</span><span> 64</span><span>;</span><span> // MAX_BACKOFF</span></span>
<span><span>    int</span><span> nbPauses </span><span>=</span><span> 1</span><span>;</span></span>
<span><span>    </span></span>
<span><span>    const</span><span> int</span><span> maxCycles </span><span>=</span><span> /*Some value*/</span><span>;</span></span>
<span><span>    </span></span>
<span><span>    void</span><span> do_yield</span><span>()</span></span>
<span><span>    {</span></span>
<span><span>        uint64_t</span><span> beginTSC </span><span>=</span><span> __rdtsc</span><span>();</span></span>
<span><span>        uint64_t</span><span> endTSC </span><span>=</span><span> beginTSC </span><span>+</span><span> maxCycles;</span><span> // Max duration of the yield</span></span>
<span><span>        // jitter is in the range of [0;nbPauses-1].</span></span>
<span><span>        // We can use bitwise AND since nbPauses is a power of 2.</span></span>
<span><span>        const</span><span> int</span><span> jitter </span><span>=</span><span> static_cast&lt;int&gt;</span><span>(beginTSC </span><span>&amp;</span><span> (nbPauses </span><span>-</span><span> 1</span><span>));</span></span>
<span><span>        // So subtracting we get a value between [1;nbPauses]</span></span>
<span><span>        const</span><span> int</span><span> nbPausesThisLoop </span><span>=</span><span> nbPauses </span><span>-</span><span> jitter;</span></span>
<span><span>        for</span><span> (</span><span>int</span><span> i </span><span>=</span><span> 0</span><span>; i </span><span>&lt;</span><span> nbPausesThisLoop </span><span>&amp;&amp;</span><span> before</span><span>(</span><span>__rdtsc</span><span>(), endTSC); i</span><span>++</span><span>) </span></span>
<span><span>            cpu_pause</span><span>();</span></span>
<span><span>        // Multiply the number of pauses by 2 until we reach the max backoff count.</span></span>
<span><span>        nbPauses </span><span>=</span><span> nbPauses </span><span>&lt;</span><span> maxPauses </span><span>?</span><span> nbPauses </span><span>*</span><span> 2</span><span> :</span><span> nbPauses;</span></span>
<span><span>    }</span></span>
<span><span>}</span></span>
<span></span>
<span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    Yielder yield;</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        yield.</span><span>do_yield</span><span>();</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<p>This method has two main advantages:</p>
<ul>
<li>We define the max duration of a <code>PAUSE</code> loop in terms of <code>TSC</code> cycles, which is (on most modern CPUs) independent of the actual frequency of the core or duration of <code>PAUSE</code>.</li>
<li>If the operating system happens to preempt our thread in the middle of the loop, it will stop yielding after being rescheduled if maximum duration has been exceeded. Otherwise we could call <code>PAUSE</code> more than necessary on a thread wakeup.</li>
</ul>
<p>You’ll notice that we kept the exponential backoff as a plain counter. This is to avoid having to compute the duration of a single <code>PAUSE</code> (<em>this would require getting rid of the jitter</em>).
However, we still need to choose a value for <code>maxCycles</code>. This again is purely empirical and needs tuning, but one may assume the duration of a context switch is about 3µs. Depending on the system and actual switch this can be more or be less. But it should be in the same order of magnitude.
We can then estimate the TSC cycles/µs conversion to be ~3200cycles/µs  for a 3.2Ghz clock. Another common frequency for the TSC is 2.5GHz.
While obviously incorrect, this is a good guesstimate for a default value on PC. At worst, you’ll most likely get a 2x difference with the real value, which is way better than the x10 you could get with the varying <code>PAUSE</code> durations!</p>
<p>I did however mention this is a default value, and the best thing to do is to retrieve the real value, either from the OS or by measuring it. Sadly TSC calibration is not officially exposed by Linux/Windows, so the best way is to measure the TSC against the system high resolution clock. Ideally this should be done asynchronously (don’t do it on your application main thread at boot, please).</p>
<pre tabindex="0" data-language="cpp"><code><span><span>// Please, do this asynchronously and not during your main thread init</span></span>
<span><span>// Otherwise you will make your application boot longer for nothing!</span></span>
<span><span>// Note there are more accurate ways to do this, but we do not need a very high precision nor accuracy.</span></span>
<span><span>// You may also split this function in two and do some meaningful amount of work instead of sleeping.</span></span>
<span><span>uint64_t</span><span> MeasureCyclesPerUs</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    const</span><span> auto</span><span> clockBefore </span><span>=</span><span> std</span><span>::</span><span>chrono</span><span>::</span><span>high_resolution_clock</span><span>::</span><span>now</span><span>();</span></span>
<span><span>    const</span><span> uint64_t</span><span> cyclesBefore </span><span>=</span><span> __rdtsc</span><span>();</span></span>
<span><span>    std</span><span>::</span><span>this_thread</span><span>::</span><span>sleep_for</span><span>(</span><span>std</span><span>::</span><span>chrono</span><span>::microseconds{</span><span>10</span><span>});</span></span>
<span><span>    const</span><span> auto</span><span> clockAfter </span><span>=</span><span> std</span><span>::</span><span>chrono</span><span>::</span><span>high_resolution_clock</span><span>::</span><span>now</span><span>();</span></span>
<span><span>    const</span><span> uint64_t</span><span> cyclesAfter </span><span>=</span><span> __rdtsc</span><span>();</span></span>
<span><span>    const</span><span> auto</span><span> clockDelta </span><span>=</span><span> clockAfter </span><span>-</span><span> clockBefore;</span></span>
<span><span>    const</span><span> uint64_t</span><span> cyclesDelta </span><span>=</span><span> cyclesAfter </span><span>-</span><span> cyclesBefore;</span></span>
<span><span>    const</span><span> uint64_t</span><span> cyclesPerUs </span><span>=</span><span> (</span><span>1000</span><span> *</span><span> cyclesDelta) </span><span>/</span><span> std</span><span>::</span><span>chrono</span><span>::</span><span>nanoseconds</span><span>(clockDelta).</span><span>count</span><span>();</span></span>
<span><span>    return</span><span> cyclesPerUs;</span></span>
<span><span>}</span></span></code></pre>
<blockquote>
<p>💡 Windows actually “exposes” this value as <a href="https://ntdoc.m417z.com/kuser_shared_data#cyclesperyield"><code>CyclesPerYield</code></a> in the kernel shared data at offset <code>0x2D6</code>. This is used internally by synchronization primitives to determine how many <code>PAUSE</code> instructions it should issue. However I wouldn’t recommend using those internals unless your code sanitizes the value.</p>
</blockquote>
<h2 id="the-spin-lock-that-used-too-many-barriers">The spin-lock that used too many barriers</h2>
<p>We only briefly touched the topic of <code>atomics</code>. All atomic operations actually take an optional parameter which is the <a href="https://en.cppreference.com/w/cpp/atomic/memory_order.html">memory order</a>.
I don’t want to spend too much time on this as entire talks are dedicated to it, and it’s not an easy topic.</p>
<p>However do know this: not providing the parameter is equivalent to using <code>std::memory_order_seq_cst</code> (sequentially consistent) which enforces the most restrictions. On some platforms this may even flush your cache via memory barriers!
Our previous example can actually be re-written using acquire/release semantics:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    Yielder yield;</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>, </span><span>std</span><span>::memory_order_acquire) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        yield.</span><span>do_yield</span><span>();</span></span>
<span><span>    }</span></span>
<span><span>}</span></span>
<span></span>
<span><span>void</span><span> unlock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    isLocked.</span><span>store</span><span>(</span><span>0</span><span>, </span><span>std</span><span>::memory_order_release);</span></span>
<span><span>}</span></span></code></pre>
<p>On my x64 machine and exponential backoff:</p>

























<div data-astro-cid-zg6ajjo3=""> <table data-astro-cid-zg6ajjo3=""> <thead><tr><th>Lock Type</th><th>Uncontended (ops/s)</th><th>Contended (ops/s)</th></tr></thead><tbody><tr><td>ExpBackoff+SeqCst</td><td>313M</td><td>55.3M</td></tr><tr><td>ExpBackoff+AcqRel</td><td>612M</td><td>58.7M</td></tr><tr><td>ExpBackoff+Acquire</td><td>652M</td><td>65.3M</td></tr></tbody> </table> </div> 
<p>You may have a look at the various assemblies generated on this compiler explorer example <a href="https://godbolt.org/z/GjEEWPsj8">https://godbolt.org/z/GjEEWPsj8</a>.</p>
<h2 id="the-spin-lock-that-saturated-the-load-ports">The spin-lock that saturated the load ports</h2>
<p>A spin-lock should be fast, otherwise you would just use your average system lock.
While we mitigated the inter-core synchronization with the jitter and exponential backoff, there are ways to reduce the cache coherency <sup><a href="#user-content-fn-f" id="user-content-fnref-f" data-footnote-ref="" aria-describedby="footnote-label">8</a></sup> traffic under contention.
This has been mentioned by many in the past <sup><a href="#user-content-fn-a" id="user-content-fnref-a" data-footnote-ref="" aria-describedby="footnote-label">9</a></sup> <sup><a href="#user-content-fn-b" id="user-content-fnref-b" data-footnote-ref="" aria-describedby="footnote-label">10</a></sup> <sup><a href="#user-content-fn-y" id="user-content-fnref-y" data-footnote-ref="" aria-describedby="footnote-label">11</a></sup> but it doesn’t hurt to remind it again. Instead of looping over a <em>Test-And-Set</em> (aka <em>Compare-And-Swap</em>) operation, prefer using both <em>Test</em> and <em>Test-And-Set</em> operations!
It also applies to our <em>Load-And-Test</em> (aka <em>Exchange</em>) operation.</p>
<p>So instead of:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    Yielder yield;</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>, </span><span>std</span><span>::memory_order_acquire) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        yield.</span><span>do_yield</span><span>();</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<p>Do:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    Yielder yield;</span></span>
<span><span>    // Actually start by an exchange, we assume the lock is not already taken</span></span>
<span><span>    // This is because the main use case of a spinlock is when there's no contention!</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>, </span><span>std</span><span>::memory_order_acquire) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        // To avoid locking the cache line with a write access, always only read before attempting the writes</span></span>
<span><span>        do</span><span> {</span></span>
<span><span>            yield.</span><span>do_yield</span><span>();</span><span> // Yield while we fail to obtain the lock.</span></span>
<span><span>        } </span><span>while</span><span> (isLocked.</span><span>load</span><span>(</span><span>std</span><span>::memory_order_relaxed) </span><span>!=</span><span> 0</span><span>);</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<h2 id="the-spin-lock-that-didnt-handle-priority-inversion">The spin-lock that didn’t handle priority inversion</h2>
<p>Priority inversion is one of the worst things that could (and will) happen with a spinlock. And it impacts most severely the platforms that need them the most! (Embedded, real-time OSes, …)
Let’s have a look at the issue:</p>
<ol>
<li>A <strong>low-priority thread</strong> acquires your spinlock</li>
<li>A <strong>high-priority thread</strong> tries to acquire the lock and starts spinning</li>
<li>The OS scheduler preempts the low-priority thread to run another thread with medium/high priority (anything higher than “low”)</li>
<li>There are no cores left to run the <strong>low priority thread</strong> as they are all used by higher priority threads.</li>
<li>The high-priority thread burns CPU cycles spinning forever.</li>
</ol>
<blockquote>
<p>🤪 “Let’s use <code>std::this_thread::yield()</code>?”</p>
</blockquote>
<p>Meh, did you test it on multiple systems? I’ll play along and give it a try.</p>
<pre tabindex="0" data-language="cpp"><code><span><span>struct</span><span> Yielder</span></span>
<span><span>{</span></span>
<span><span>    void</span><span> do_yield_expo_and_jitter</span><span>()</span></span>
<span><span>    {</span></span>
<span><span>        // Same as before, exponential backoff and jitter</span></span>
<span><span>    }</span></span>
<span></span>
<span><span>    void</span><span> do_yield</span><span>()</span></span>
<span><span>    {</span></span>
<span><span>        do_yield_expo_and_jitter</span><span>();</span></span>
<span><span>        if</span><span> (nbPauses </span><span>&gt;=</span><span> maxPauses)</span></span>
<span><span>        {</span></span>
<span><span>            std</span><span>::</span><span>this_thread</span><span>::</span><span>yield</span><span>();</span><span> // Yield thread back to the OS</span></span>
<span><span>            nbPauses </span><span>=</span><span> 1</span><span>;</span></span>
<span><span>        }</span></span>
<span><span>    }</span></span>
<span><span>}</span></span></code></pre>
<p>Now when we reach the maximum number of iterations, we make the thread yield its quantum to the operating system (<a href="https://github.com/microsoft/STL/blob/cbe2ee99caf122555a305d18f69e57c75b3fe5ec/stl/src/cthread.cpp#L86"><code>SwitchToThread</code></a> on Windows, <code>sched_yield</code> on Linux) so that another thread may be scheduled.
While in practice this may, sometimes, solve the issue as the OS is now free to schedule other threads including the <strong>low priority one</strong>, this is not mandatory!
Some implementations may end up just rescheduling the thread that just yielded since it’s of higher priority.</p>
<p>You may have also seen implementations that use <code>Sleep(0)</code> on Windows. This is better than <code>SwitchToThread</code> (which can only yield to a thread ready to run on the current core, per the <a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-switchtothread?redirectedfrom=MSDN">docs</a><sup><a href="#user-content-fn-stt" id="user-content-fnref-stt" data-footnote-ref="" aria-describedby="footnote-label">12</a></sup>. Same for normal Linux schedulers<sup><a href="#user-content-fn-q" id="user-content-fnref-q" data-footnote-ref="" aria-describedby="footnote-label">13</a></sup>). However this used to<sup><a href="#user-content-fn-s" id="user-content-fnref-s" data-footnote-ref="" aria-describedby="footnote-label">14</a></sup> only yield to threads of <strong>same or higher</strong> priorities, and <strong>still does</strong> on the real-time version of the OS! For example on an embedded device, or a console.
The only way to schedule any thread on real-time kernels, be it Windows or Linux, is to sleep for a non-zero duration… which we obviously would like to avoid!</p>
<p>So the <a href="https://github.com/dotnet/runtime/blob/379d100b3cc18394064a276d7610e88a2aa09b6f/src/libraries/System.Private.CoreLib/src/System/Threading/SpinWait.cs#L183-L192">solution</a> that the DotNet runtime team came up with is to start with <code>SwitchToThread</code>, then <code>Sleep(0)</code> then <code>Sleep(1)</code>!</p>
<pre tabindex="0" data-language="cpp"><code><span><span>// We prefer to call Thread.Yield first, triggering a SwitchToThread. This</span></span>
<span><span>// unfortunately doesn't consider all runnable threads on all OS SKUs. In</span></span>
<span><span>// some cases, it may only consult the runnable threads whose ideal processor</span></span>
<span><span>// is the one currently executing code. Thus we occasionally issue a call to</span></span>
<span><span>// Sleep(0), which considers all runnable threads at equal priority. Even this</span></span>
<span><span>// is insufficient since we may be spin waiting for lower priority threads to</span></span>
<span><span>// execute; we therefore must call Sleep(1) once in a while too, which considers</span></span>
<span><span>// all runnable threads, regardless of ideal processor and priority, but may</span></span>
<span><span>// remove the thread from the scheduler's queue for 10+ms, if the system is</span></span>
<span><span>// configured to use the (default) coarse-grained system timer.</span></span></code></pre>

<p>So we dealt with the priority inversion at the cost of potential sleeps.</p>
<blockquote>
<p>🤪 “Ship it!”</p>
</blockquote>
<p>Please god no… Yes, you (<em>most likely</em>) avoid the worst case scenario (<em>the livelock</em>), but really, is it fine?</p>
<p>Let’s stop for a second here and assume we never did more than yield.</p>
<p>As you may have already guessed, a livelock is only half the story (<em>this is starting to be a recurring pattern, isn’t it?</em>).
The fact is, the issue could happen even if all your threads have the same priority! (<em>Yes, I saw you coming asking for an easy fix by removing priorities.</em>)
Consider the following scenario:</p>
<ul>
<li>4 cores machine</li>
<li>4 high priority threads: <strong>A</strong>, <strong>B</strong>, <strong>C</strong>, <strong>D</strong> (<em>your thread pool</em>)</li>
<li>4 other high priority threads: <strong>X</strong>, <strong>Y</strong>, <strong>W</strong>, <strong>Z</strong> (<em>controlled by a 3rd party, those suck. Please library writers, don’t spawn threads on your own, thank you!</em>).</li>
<li>Thread <strong>A</strong> acquires the lock</li>
<li>Threads <strong>B</strong>, <strong>C</strong>, <strong>D</strong> spin, trying to acquire it.</li>
</ul>
<p>At this point, we have the following:</p>

















<div data-astro-cid-zg6ajjo3=""> <table data-astro-cid-zg6ajjo3=""> <thead><tr><th>Core 0</th><th>Core 1</th><th>Core 2</th><th>Core 3</th></tr></thead><tbody><tr><td>Thread A</td><td>Thread B</td><td>Thread C</td><td>Thread D</td></tr></tbody> </table> </div> 
<ul>
<li>Thread <strong>X</strong> gets scheduled (<em><strong>A</strong> somehow released its quantum, still holds the lock</em>)</li>
</ul>

















<div data-astro-cid-zg6ajjo3=""> <table data-astro-cid-zg6ajjo3=""> <thead><tr><th>Core 0</th><th>Core 1</th><th>Core 2</th><th>Core 3</th></tr></thead><tbody><tr><td>Thread X</td><td>Thread B</td><td>Thread C</td><td>Thread D</td></tr></tbody> </table> </div> 
<ul>
<li>Thread <strong>B</strong> yields, <strong>Y</strong> is scheduled</li>
</ul>

















<div data-astro-cid-zg6ajjo3=""> <table data-astro-cid-zg6ajjo3=""> <thead><tr><th>Core 0</th><th>Core 1</th><th>Core 2</th><th>Core 3</th></tr></thead><tbody><tr><td>Thread X</td><td>Thread Y</td><td>Thread C</td><td>Thread D</td></tr></tbody> </table> </div> 
<ul>
<li>Thread <strong>Y</strong> yields, <strong>B</strong> is scheduled again, <strong>C</strong> and <strong>D</strong> yield to <strong>W</strong> and <strong>Z</strong></li>
</ul>

















<div data-astro-cid-zg6ajjo3=""> <table data-astro-cid-zg6ajjo3=""> <thead><tr><th>Core 0</th><th>Core 1</th><th>Core 2</th><th>Core 3</th></tr></thead><tbody><tr><td>Thread X</td><td>Thread B</td><td>Thread W</td><td>Thread Z</td></tr></tbody> </table> </div> 
<p>I could continue this for a long time. Even though thread <strong>A</strong> might get scheduled again, it might not! This depends on your scheduler’s internals. Especially since yielding may yield only to the ready threads of the current core<sup><a href="#user-content-fn-stt" id="user-content-fnref-stt-2" data-footnote-ref="" aria-describedby="footnote-label">12</a></sup> <sup><a href="#user-content-fn-q" id="user-content-fnref-q-2" data-footnote-ref="" aria-describedby="footnote-label">13</a></sup>. At the time of writing this article, this actually is a known issue with <a href="https://github.com/google/sanitizers/issues/614">Address Sanitizer</a>!</p>
<p>Oh, and even if it did get scheduled, you probably lost a lot of time switching from one thread to the other, this is your typical lock convoy<sup><a href="#user-content-fn-c" id="user-content-fnref-c" data-footnote-ref="" aria-describedby="footnote-label">15</a></sup> and is what Linus Torvalds more or less hints here<sup><a href="#user-content-fn-4" id="user-content-fnref-4-2" data-footnote-ref="" aria-describedby="footnote-label">4</a></sup> <sup><a href="#user-content-fn-l" id="user-content-fnref-l" data-footnote-ref="" aria-describedby="footnote-label">16</a></sup> <sup><a href="#user-content-fn-q" id="user-content-fnref-q-3" data-footnote-ref="" aria-describedby="footnote-label">13</a></sup>:</p>
<blockquote>
<p>And no, adding random “<code>sched_yield()</code>” calls while you’re spinning on the spinlock will not really help. It will easily result in scheduling storms while people are yielding to all the wrong processes.</p>
</blockquote>
<p>So no, simply using the same priority for all threads or sleeping is not fine. Let’s see what we can do about it.</p>
<h2 id="the-spin-lock-that-spoke-to-the-os">The spin-lock that spoke to the OS</h2>
<p>The real problem, when you spin in a loop, is that you expect things to go fast so that your thread may continue.<br>
But by yielding this way you defeat a lot of the kernel heuristics. It has no way to know what you actually meant, and may schedule anything (or nothing) but threads from your process. Worse, it may degrade your thread priority, move it to lower frequency cores, and you lose any kind of priority boost when waking up due to the lock being released…<br>
That’s clearly not what we want. If only there was a way to communicate our intent to the OS…</p>
<p>Well that’s exactly what Linux did when introducing the <a href="https://www.man7.org/linux/man-pages/man2/futex.2.html">futex</a> API! Since we’re waiting in a loop for a value to change, just notify the OS about it and let it handle things from there.
Windows also implements this with the <a href="https://learn.microsoft.com/en-us/windows/win32/api/synchapi/nf-synchapi-waitonaddress"><code>WaitOnAddress</code></a> API, which we’ll be demonstrating here:</p>
<pre tabindex="0" data-language="cpp"><code><span><span>void</span><span> do_yield</span><span>(</span><span>int32_t*</span><span> address</span><span>, </span><span>int32_t</span><span> comparisonValue</span><span>, </span><span>uint32_t</span><span> timeoutMs</span><span>)</span></span>
<span><span>{</span></span>
<span><span>    do_yield_expo_and_jitter</span><span>();</span></span>
<span><span>    if</span><span> (nbPauses </span><span>&gt;=</span><span> maxPauses)</span></span>
<span><span>    {</span></span>
<span><span>        // The thread will stay asleep while the value at the given address doesn't change and `WakeByAddressSingle`/`WakeByAddressAll` isn't called.</span></span>
<span><span>        // We might have a spurious wakeup though, so the value needs to be checked afterward, which we already do since we spin.</span></span>
<span><span>        WaitOnAddress</span><span>(address, </span><span>&amp;</span><span>comparisonValue, </span><span>sizeof</span><span>(comparisonValue), timeoutMs);</span></span>
<span><span>        nbPauses </span><span>=</span><span> 1</span><span>;</span></span>
<span><span>    }</span></span>
<span><span>}</span></span>
<span><span>void</span><span> lock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    Yielder yield;</span></span>
<span><span>    while</span><span> (isLocked.</span><span>exchange</span><span>(</span><span>1</span><span>, </span><span>std</span><span>::memory_order_acquire) </span><span>!=</span><span> 0</span><span>)</span></span>
<span><span>    {</span></span>
<span><span>        do</span><span> {</span></span>
<span><span>            yield.</span><span>do_yield</span><span>(</span><span>&amp;</span><span>isLocked, </span><span>1</span><span> /*while locked*/</span><span> , </span><span>1</span><span> /*ms*/</span><span>);</span></span>
<span><span>        } </span><span>while</span><span> (isLocked.</span><span>load</span><span>(</span><span>std</span><span>::memory_order_relaxed) </span><span>!=</span><span> 0</span><span>);</span></span>
<span><span>    }</span></span>
<span><span>}</span></span>
<span><span>void</span><span> unlock</span><span>()</span></span>
<span><span>{</span></span>
<span><span>    isLocked </span><span>=</span><span> 0</span><span>;</span></span>
<span><span>    WakeByAddressSingle</span><span>(</span><span>&amp;</span><span>isLocked);</span><span> // Notify a potential thread waiting, if any.</span></span>
<span><span>}</span></span></code></pre>
<p>Windows’ <code>WaitOnAddress</code> internally does a single iteration before issuing the system call, but Linux’s futex API is a direct syscall. That’s why we call <code>WaitOnAddress</code> only after spinning a bit.<br>
This lets us have a similar spinning strategy on all platforms, which ensures a more consistent behavior.</p>
<blockquote>
<p>💡 You may notice that we always end up calling <code>WakeByAddressSingle</code> even if there’s no other thread waiting. While not that slow on Windows, this is slow on Linux since it will do a syscall. To avoid that one would usually store some state such as the number of waiting (parked) threads.</p>
</blockquote>
<blockquote>
<p>🤪 “Wait! Wasn’t <code>std::atomic_wait</code> added to the standard recently?”</p>
</blockquote>
<p>Yes! And this is what one should have used if implementers did the right thing from the get-go (<em>and more importantly did the same thing for each implementation</em>), but this was not the case…<sup><a href="#user-content-fn-z" id="user-content-fnref-z" data-footnote-ref="" aria-describedby="footnote-label">17</a></sup></p>
<ul>
<li><code>libc++</code> (clang) <a href="https://github.com/llvm/llvm-project/blob/46db8d822ecdf36a714de5e1acf187736a3af5d1/libcxx/include/__atomic/atomic_sync.h#L56">used to</a> do exponential backoff with <strong>thread yields</strong> before <code>futex</code>. At least it got <a href="https://github.com/llvm/llvm-project/commit/699f19605579f25083152a9ad21e14c2751d5d66">fixed</a> in January 2025 but it still does exponential backoff.</li>
<li>MSVC STL does the <a href="https://github.com/microsoft/STL/blob/cbe2ee99caf122555a305d18f69e57c75b3fe5ec/stl/inc/atomic#L449">right thing</a>™ <em>imho</em> and goes almost straight to the OS since the first implementation. Good job!</li>
<li>So <a href="https://github.com/gcc-mirror/gcc/blob/c65fdb6b03d9146ee9a1ffcfcbc689b004b2b463/libstdc%2B%2B-v3/include/bits/atomic_wait.h#L298">does</a> <code>libstdc++</code> (GCC)!</li>
</ul>
<p>So if you use it, you may get a built-in exponential backoff, or not. Both implementations actually make sense from an implementer’s point of view (<em>Do you expect <code>std::atomic_wait</code> users to use it with their own backoff strategies? Or directly as condition variables?</em>), but this difference ends up being problematic since the code behaves differently between implementations.<br>
In the end, as usual with the <code>std</code> library, you’re better off using the OS primitives directly if you want portable behaviour that you control.</p>
<blockquote>
<p>As mentioned, Windows’ <code>WaitOnAddress</code> will do a single spin before doing a syscall. The duration of <code>PAUSE</code> is computed on process start by the loader in <code>LdrpInitializeProcess</code> and stored in <code>ntdll.dll!RtlpWaitOnAddressSpinCycleCount</code>.</p>
</blockquote>
<h2 id="the-spin-lock-that-was-unfair">The spin-lock that was unfair</h2>
<p>An issue with some lock algorithms is that they may be unfair: this is what happens when under contention a thread may never actually grab the ownership of the lock if other threads are faster.<br>
This time I’ll simply give a warning and ask you to trust me as this article is starting to be lengthy. You may have encountered some “ticket” locks that attempt to enhance the fairness of the lock. While it may look good on paper, it’s actually not so good in practice.</p>
<p>Not only is it slower due to its complexity, but as mentioned before only the OS really knows what’s good for scheduling. And if you want to use a <code>futex</code>-like API you end up having to wake up all potential waiters instead of just the one you want. So please, rely on the OS primitives for fairness instead. (<em>Even if we didn’t have those primitives, a random+exponential backoff may perform better than a ticket lock anyway!</em>)</p>
<h2 id="the-spin-locks-that-were-falsely-sharing">The spin-locks that were falsely sharing</h2>
<p>Here comes another tidbit of CPU architecture: even if you write to different variables, they may share the same cacheline!
And this is really bad for performance when you do atomic operations on the same cacheline, even if the addresses are different.
To fix this issue, you may enforce alignment of your variables or use padding in a <code>struct</code>. False sharing is also known as destructive interference, which led to the standard’s <a href="https://en.cppreference.com/w/cpp/thread/hardware_destructive_interference_size.html"><code>std::hardware_destructive_interference_size</code></a> value!</p>
<pre tabindex="0" data-language="cpp"><code><span><span>alignas</span><span>(</span><span>std</span><span>::hardware_destructive_interference_size) MyLock lock1;</span></span>
<span><span>alignas</span><span>(</span><span>std</span><span>::hardware_destructive_interference_size) MyLock lock2;</span></span></code></pre>
<p>This is however not a silver bullet!<br>
While you will avoid false sharing, you may also fill your TLB and L1 cache faster which may lead to more cache thrashing.</p>
<p>You may even encounter cache bank conflicts. Cache bank conflicts only exist on some CPUs, but don’t trust manufacturers to avoid them. From 3.6.1.3 of the Intel Optimization Reference Manual:</p>
<blockquote>
<ul>
<li><em>“In the Sandy Bridge microarchitecture, the internal organization of the L1D cache may manifest […]”</em></li>
<li><em>“The L1D cache bank conflict issue does not apply to Haswell microarchitecture.”</em></li>
<li><em>“In the Golden Cove microarchitecture, bank conflicts often happen when multiple loads access […]”</em></li>
</ul>
<p>💡 So this was once an issue, then fixed, then it came back in another form.</p>
</blockquote>
<p>These are thankfully <strong>mitigated</strong> thanks to the random+exponential backoff, but are getting worse (<em>this pattern of “yes, but” should really annoy you by now, that’s the whole point of this article</em>).</p>
<blockquote>
<p>Whenever possible, avoid reading the same memory location within a tight loop or using
multiple load operations.</p>
</blockquote>
<p>And the only way to really fix that is to… actually park the thread by calling an OS primitive such as a futex! You should also avoid doing multiple loads per loop, as recommended <a href="#the-spin-lock-that-saturated-the-load-ports">previously</a>.</p>
<h2 id="what-about-specialized-instructions">What about specialized instructions?</h2>
<blockquote>
<p>🤪 “I’ve read about <code>MWAIT</code> and <code>TPAUSE</code>.”</p>
</blockquote>
<p>And you should probably have read further as those are privileged instructions! But yes they do have the same look as a futex wait/wake, which is very tempting.
And, to be fair, AMD does offer a userland alternative which is <code>monitorx</code> and <code>mwaitx</code> that we can use!</p>
<p>One advantage of <code>mwaitx</code> is that you can tell the CPU to wait for a given TSC count instead of having to loop! So it can be used to replace the <code>_mm_pause</code> loop when supported, and that’s actually what Windows’ locking primitives such as <code>WaitOnAddress</code> or <code>AcquireSRWLockExclusive</code> do internally!
Not only is the “API” easier (<em>you provide a timestamp for the wakeup date</em>) but it can save power! <sup><a href="#user-content-fn-k" id="user-content-fnref-k" data-footnote-ref="" aria-describedby="footnote-label">18</a></sup> <sup><a href="#user-content-fn-p" id="user-content-fnref-p" data-footnote-ref="" aria-describedby="footnote-label">19</a></sup><br>
Just do not use it for <em>long</em> periods since you are still delaying potential work from other threads by not explicitly yielding to the OS.</p>
<blockquote>
<p>💡 <code>mwaitx</code> can spuriously wake up, but this is fine for our usage since we’ll just spin and try again!</p>
</blockquote>
<h2 id="conclusion">Conclusion</h2>
<p>You’ll notice I barely mentioned ARM, that’s because I do not have enough experience with this architecture to give any advice other than you should use the proper memory ordering for decent performance.</p>
<p>If you read this far, I’ll say it again: in most (and pretty much all) cases you should not even need to worry about the performance of your locks. The best lock is the one you don’t use.</p>
<p>Again, from Linus: <sup><a href="#user-content-fn-4" id="user-content-fnref-4-3" data-footnote-ref="" aria-describedby="footnote-label">4</a></sup></p>
<blockquote>
<p>Because you <strong>should never ever think that you’re clever enough</strong> to write your own locking routines.. Because the <strong>likelihood is that you aren’t</strong> (and by that “you” <strong>I very much include myself</strong> - we’ve tweaked all the in-kernel locking over decades, and gone through the simple test-and-set to ticket locks to cacheline-efficient queuing locks, and even people who know what they are doing tend to get it wrong several times).</p>
<p>There’s a reason why you can find decades of academic papers on locking. <strong>Really. It’s hard.</strong></p>
</blockquote>
<p>But if you do, even after all those warnings, at least make sure you follow best practices and especially the pre-requisites for a spinlock to be efficient:</p>
<ul>
<li>There is low contention</li>
<li>The critical section (work done under the lock) is very small. (Consider that “small” varies with the number of threads competing for the lock…)</li>
<li>Notify your OS about what you’re doing (<code>futex</code>, <code>WaitOnAddress</code>, …)</li>
</ul>
<h2 id="bonus">Bonus!</h2>
<p>List of projects/libraries that do (<em>or did</em>) it wrong and that I happened to stumble upon:</p>
<ul>
<li><a href="https://github.com/mjansson/rpmalloc/blob/feb43aee0d4dcca9fd91b3dd54311c34c6cc6187/rpmalloc/rpmalloc.c#L284">RPMalloc</a>: the one that led to this rant, we had a dependency using it on console, and it caused livelocks. It only loops with a single CPU yield. Bad for perf, impossible (<em>read: will break</em>) to use on embedded platforms with a realtime scheduler.</li>
<li><a href="https://github.com/openbsd/src/blob/2a75873a967dc6c5bd16ad89b9dbf8713041be1b/lib/libc/thread/rthread.c#L167-L180">OpenBSD’s libc</a> goes straight to an OS thread <code>yield</code></li>
<li><a href="https://www.gnu.org/software/libc/">Glibc</a> goes straight to <code>futex</code> by default
<ul>
<li>default mutex is the <a href="https://github.com/bminor/glibc/blob/f9e61cd446d45016e20b6fe85ab87364ebdbec1b/nptl/pthread_mutex_lock.c#L87">“simple”</a> one and only checks value once before going straight to the OS</li>
<li><a href="https://github.com/bminor/glibc/blob/f9e61cd446d45016e20b6fe85ab87364ebdbec1b/nptl/pthread_mutex_lock.c#L117"><code>PTHREAD_MUTEX_ADAPTIVE_NP</code></a> is mostly good! The number of spins is fixed by default
but can be tweaked using the tunable <a href="https://github.com/bminor/glibc/commit/6310e6be9b7c322d56a45729b3ebcd22e26dd0c2"><code>glibc.pthread.mutex_spin_count</code></a></li>
</ul>
</li>
<li><a href="https://github.com/uxlfoundation/oneTBB">Intel TBB</a>:
<ul>
<li><a href="https://github.com/uxlfoundation/oneTBB/blob/0cd32ab10a84eabf780bb699b17430deb028c0a4/include/oneapi/tbb/spin_mutex.h#L74"><code>tbb::spinlock</code></a>: simple backoff with 16 yields</li>
<li><code>tbb::mutex</code>: Pure <code>_mm_pause</code> backoff with <a href="https://github.com/uxlfoundation/oneTBB/blob/0cd32ab10a84eabf780bb699b17430deb028c0a4/include/oneapi/tbb/detail/_utils.h#L123-L133">fixed count</a>, then thread yield backoff, <a href="https://github.com/uxlfoundation/oneTBB/blob/0cd32ab10a84eabf780bb699b17430deb028c0a4/include/oneapi/tbb/detail/_waitable_atomic.h#L60-L70">then uses a futex wait</a> on linux, or plain semaphore on other platforms</li>
</ul>
</li>
<li><a href="https://github.com/WebKit/WebKit/">Webkit</a>:
<ul>
<li>OS <a href="https://github.com/WebKit/WebKit/blob/202580d81145c23c273cc4d3a82dae062c449321/Source/WTF/wtf/LockAlgorithmInlines.h#L60">Thread yield</a> (<code>SwitchToThread</code>/<code>sched_yield</code>) on CAS failure</li>
<li><a href="https://github.com/WebKit/WebKit/blob/77b3be1d7a731a6280de28e4637392c8ec4f7fb2/Source/WTF/wtf/LockAlgorithmInlines.h#L43">Hardcoded spincount</a></li>
<li>Duplicated <a href="https://github.com/WebKit/WebKit/blob/77b3be1d7a731a6280de28e4637392c8ec4f7fb2/Source/WTF/wtf/WordLock.cpp#L62">here</a></li>
<li>Same thing <a href="https://github.com/WebKit/WebKit/blob/77b3be1d7a731a6280de28e4637392c8ec4f7fb2/Source/bmalloc/bmalloc/Mutex.cpp#L57">here</a></li>
<li>Even though they have <a href="https://github.com/WebKit/WebKit/blob/a05334f6848b4433928b4a0b5120e6a765a55f69/Source/WTF/benchmarks/ToyLocks.h">benchmarks</a> (<em>both for speed and fairness</em>)!</li>
</ul>
</li>
<li><a href="https://github.com/google/sanitizers/wiki/AddressSanitizer">AddressSanitizer (ASAN)</a>
<ul>
<li>The <a href="https://github.com/google/sanitizers/issues/614">Issue</a> =&gt; can livelock with a realtime scheduler</li>
<li>The <a href="https://github.com/llvm/llvm-project/blob/23e35bd43cf18ee479e6d5df08189db4591c403c/compiler-rt/lib/sanitizer_common/sanitizer_mutex.cpp#L19-L29">Implementation</a></li>
<li>Yield is done by <a href="https://github.com/llvm/llvm-project/blob/23e35bd43cf18ee479e6d5df08189db4591c403c/compiler-rt/lib/sanitizer_common/sanitizer_linux.cpp#L595">sched_yield</a> on linux and <a href="https://github.com/llvm/llvm-project/blob/23e35bd43cf18ee479e6d5df08189db4591c403c/compiler-rt/lib/sanitizer_common/sanitizer_win.cpp#L847"><code>Sleep(0)</code></a> on Windows</li>
</ul>
</li>
<li><a href="https://github.com/dotnet/runtime">DotNet</a> runtime still uses <a href="https://github.com/dotnet/runtime/blob/9202b4c14523718f5bcbf14025d5286cbf738f70/src/libraries/System.Private.CoreLib/src/System/Threading/SpinWait.cs#L195-L210"><code>Sleep</code></a> instead of WaitOnAddress</li>
<li>And so many others…</li>
</ul>
<section data-footnotes="">
<ol>
<li id="user-content-fn-1">
<p><a href="https://probablydance.com/2019/12/30/measuring-mutexes-spinlocks-and-how-bad-the-linux-scheduler-really-is/">Measuring Mutexes, Spinlocks and how Bad the Linux Scheduler Really Is</a> - Malte Skarupke <a href="#user-content-fnref-1" data-footnote-backref="" aria-label="Back to reference 1">↩</a></p>
</li>
<li id="user-content-fn-2">
<p><a href="https://matklad.github.io/2020/01/02/spinlocks-considered-harmful.html">Spinlocks Considered Harmful</a> - matklad <a href="#user-content-fnref-2" data-footnote-backref="" aria-label="Back to reference 2">↩</a></p>
</li>
<li id="user-content-fn-3">
<p><a href="https://www.intel.com/content/www/us/en/developer/articles/technical/intel64-and-ia32-architectures-optimization.html">Intel® 64 and IA-32 Architectures Optimization Reference Manual</a> <a href="#user-content-fnref-3" data-footnote-backref="" aria-label="Back to reference 3">↩</a> <a href="#user-content-fnref-3-2" data-footnote-backref="" aria-label="Back to reference 3-2">↩<sup>2</sup></a> <a href="#user-content-fnref-3-3" data-footnote-backref="" aria-label="Back to reference 3-3">↩<sup>3</sup></a></p>
</li>
<li id="user-content-fn-4">
<p><a href="https://www.realworldtech.com/forum/?threadid=189711&amp;curpostid=189723">Linus Torvalds on spinlocks</a> (1) - Real World Technologies Forum <a href="#user-content-fnref-4" data-footnote-backref="" aria-label="Back to reference 4">↩</a> <a href="#user-content-fnref-4-2" data-footnote-backref="" aria-label="Back to reference 4-2">↩<sup>2</sup></a> <a href="#user-content-fnref-4-3" data-footnote-backref="" aria-label="Back to reference 4-3">↩<sup>3</sup></a></p>
</li>
<li id="user-content-fn-5">
<p><a href="https://hal.science/hal-02084060/file/journal.pdf">Lock–Unlock: Is That All? A Pragmatic Analysis of Locking in Software Systems</a> - Rachid Guerraoui, Hugo Guiroux, Renaud Lachaize, Vivien Quéma, Vasileios Trigonakis. ACM Transactions on Computer Systems, 2019, pp.1-149. <a href="#user-content-fnref-5" data-footnote-backref="" aria-label="Back to reference 5">↩</a> <a href="#user-content-fnref-5-2" data-footnote-backref="" aria-label="Back to reference 5-2">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-x">
<p><a href="https://web.archive.org/web/20240925152810/https://www.intel.com/content/www/us/en/developer/articles/technical/spin-locks-considered-harmful.html">Spin Locks Considered Harmful, and How to Write Them When We Must</a> - Intel (via The Wayback Machine) <a href="#user-content-fnref-x" data-footnote-backref="" aria-label="Back to reference 6">↩</a></p>
</li>
<li id="user-content-fn-w">
<p><a href="https://uops.info/table.html?search=PAUSE&amp;cb_tp=on&amp;cb_SNB=on&amp;cb_IVB=on&amp;cb_HSW=on&amp;cb_BDW=on&amp;cb_SKL=on&amp;cb_KBL=on&amp;cb_CFL=on&amp;cb_CNL=on&amp;cb_CLX=on&amp;cb_ICL=on&amp;cb_RKL=on&amp;cb_ADLP=on&amp;cb_TRM=on&amp;cb_ADLE=on&amp;cb_ZENp=on&amp;cb_ZEN2=on&amp;cb_ZEN3=on&amp;cb_ZEN4=on&amp;cb_measurements=on&amp;cb_base=on&amp;cb_sse=on&amp;cb_others=on&amp;checkbox=on">uops.info table for PAUSE</a> <a href="#user-content-fnref-w" data-footnote-backref="" aria-label="Back to reference 7">↩</a></p>
</li>
<li id="user-content-fn-f">
<p><a href="https://fgiesen.wordpress.com/2014/07/07/cache-coherency/">Cache coherency primer</a> - Fabian Giesen <a href="#user-content-fnref-f" data-footnote-backref="" aria-label="Back to reference 8">↩</a></p>
</li>
<li id="user-content-fn-a">
<p><a href="https://gpuopen.com/download/GDC2024_AMD_Ryzen_Processor_Software_Optimization.pdf">AMD Ryzen Processor Software Optimization (GDC 2024)</a> - Ken Mitchell <a href="#user-content-fnref-a" data-footnote-backref="" aria-label="Back to reference 9">↩</a></p>
</li>
<li id="user-content-fn-b">
<p><a href="https://gpuopen.com/download/gdc_2018_sponsored_optimizing_for_ryzen.pdf">AMD RYZEN™ Cpu Optimization (GDC 2018)</a> - Ken Mitchell &amp; Elliot Kim <a href="#user-content-fnref-b" data-footnote-backref="" aria-label="Back to reference 10">↩</a></p>
</li>
<li id="user-content-fn-y">
<p><a href="https://rigtorp.se/spinlock/">Correctly implementing a spinlock in C++</a> - Erik Rigtorp <a href="#user-content-fnref-y" data-footnote-backref="" aria-label="Back to reference 11">↩</a></p>
</li>
<li id="user-content-fn-stt">
<p><a href="https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-switchtothread?redirectedfrom=MSDN">SwitchToThread docs</a> - Microsoft <a href="#user-content-fnref-stt" data-footnote-backref="" aria-label="Back to reference 12">↩</a> <a href="#user-content-fnref-stt-2" data-footnote-backref="" aria-label="Back to reference 12-2">↩<sup>2</sup></a></p>
</li>
<li id="user-content-fn-q">
<p><a href="https://www.realworldtech.com/forum/?threadid=189711&amp;curpostid=189837">Linus Torvalds on spinlocks</a> (3) - Real World Technologies Forum <a href="#user-content-fnref-q" data-footnote-backref="" aria-label="Back to reference 13">↩</a> <a href="#user-content-fnref-q-2" data-footnote-backref="" aria-label="Back to reference 13-2">↩<sup>2</sup></a> <a href="#user-content-fnref-q-3" data-footnote-backref="" aria-label="Back to reference 13-3">↩<sup>3</sup></a></p>
</li>
<li id="user-content-fn-s">
<p><a href="https://learn.microsoft.com/en-us/archive/blogs/khen1234/sleeping-vs-yielding">Sleeping vs. Yielding</a> - Ken Henderson <a href="#user-content-fnref-s" data-footnote-backref="" aria-label="Back to reference 14">↩</a></p>
</li>
<li id="user-content-fn-c">
<p><a href="https://davekilian.com/lock-convoys.html">A Complete Guide to Lock Convoys</a> - Dave Kilian <a href="#user-content-fnref-c" data-footnote-backref="" aria-label="Back to reference 15">↩</a></p>
</li>
<li id="user-content-fn-l">
<p><a href="https://www.realworldtech.com/forum/?threadid=189711&amp;curpostid=189752">Linus Torvalds on spinlocks</a> (2) - Real World Technologies Forum <a href="#user-content-fnref-l" data-footnote-backref="" aria-label="Back to reference 16">↩</a></p>
</li>
<li id="user-content-fn-z">
<p><a href="https://blog.bearcats.nl/atomic-wait/">Implementing atomic wait and notify</a> - Blat Blatnik <a href="#user-content-fnref-z" data-footnote-backref="" aria-label="Back to reference 17">↩</a></p>
</li>
<li id="user-content-fn-k">
<p><a href="https://github.com/SpecialKO/SpecialK/commit/5b55f447eb4d3ab839f73255bd9f6aa5ade20aeb">SpecialK’s commit automating <code>mwaitx</code>’s usage</a> - Andon M. Coleman <a href="#user-content-fnref-k" data-footnote-backref="" aria-label="Back to reference 18">↩</a></p>
</li>
<li id="user-content-fn-p">
<p><a href="https://dl.acm.org/doi/pdf/10.1145/3676151.3719370">An Analysis of User-space Idle State Instructions on x86 Processors</a> - Malte-Christian Kuns, Hannes Tröpgen, Robert Schöne. ICPE ‘25: Proceedings of the 16th ACM/SPEC International Conference on Performance Engineering, 2025, pp.232-239. <a href="#user-content-fnref-p" data-footnote-backref="" aria-label="Back to reference 19">↩</a></p>
</li>
</ol>
</section></article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Oban, the job processing framework from Elixir, has come to Python (224 pts)]]></title>
            <link>https://www.dimamik.com/posts/oban_py/</link>
            <guid>46797594</guid>
            <pubDate>Wed, 28 Jan 2026 16:32:00 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.dimamik.com/posts/oban_py/">https://www.dimamik.com/posts/oban_py/</a>, See on <a href="https://news.ycombinator.com/item?id=46797594">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

<article>
     
    <div><h2 id="setting-the-stage">Setting the Stage</h2>
<p>I’ve used <a href="https://github.com/oban-bg/oban">Oban in Elixir</a> for almost as long as I’ve been writing software in Elixir, and it has always been an essential tool for processing jobs. I always knew Oban was cool, but I never dug deeper. This article is a collection of my notes and observations on how the Python implementation of Oban works and what I’ve learned while exploring its codebase. I’ll also try to compare it with the Elixir version and talk about concurrency in general.</p>
<h2 id="surface-level">Surface Level</h2>
<p><a href="https://oban.pro/docs/py/index.html">Oban</a> allows you to <strong>insert and process jobs using only your database</strong>. You can insert the job to send a confirmation email in the same database transaction where you create the user. If one thing fails, everything is rolled back.</p>
<p>Additionally, like most job processing frameworks, Oban has <a href="https://oban.pro/docs/py/0.5.0/defining_queues.html">queues</a> with local and global queue limits. But unlike others, it <strong>stores your completed jobs</strong> and can <a href="https://oban.pro/docs/py/0.5.0/writing_jobs.html#recording-results">even keep their results if needed</a>. It has built-in <a href="https://oban.pro/docs/py/0.5.0/periodic_jobs.html#periodic-jobs">cron scheduling</a> and <a href="https://oban.pro/docs/py/0.5.0/managing_queues.html">many more features</a> to control how your jobs are processed.</p>
<p>Oban comes in two versions - <a href="https://oban.pro/docs/py/index.html">Open Source Oban-py</a> and <a href="https://oban.pro/docs/py_pro/adoption.html">commercial Oban-py-pro</a>.</p>
<p>OSS Oban has a few limitations, which are automatically lifted in the Pro version:</p>
<ul>
<li><strong>Single-threaded asyncio execution</strong> - concurrent but not truly parallel, so CPU-bound jobs block the event loop.</li>
<li><strong>No bulk inserts</strong> - each job is inserted individually.</li>
<li><strong>No bulk acknowledgements</strong> - each job completion is persisted individually.</li>
<li><strong>Inaccurate rescues</strong> - jobs that are long-running might get rescued even if the producer is still alive. Pro version uses smarter heartbeats to track producer liveness.</li>
</ul>
<p>In addition, Oban-py-pro comes with a few extra features you’d configure separately, like <a href="https://oban.pro/docs/py_pro/0.5.0/workflow.html">workflows</a>, <a href="https://oban.pro/docs/py_pro/0.5.0/relay.html">relay</a>, <a href="https://oban.pro/docs/py_pro/0.5.0/unique_jobs.html">unique jobs</a>, and <a href="https://oban.pro/docs/py_pro/0.5.0/smart_concurrency.html">smart concurrency</a>.</p>
<p>OSS Oban-py is a great start for your hobby project, or if you’d want to evaluate Oban philosophy itself, but for any bigger scale - I’d go with <a href="https://oban.pro/docs/py_pro/index.html">Oban Pro</a>. The pricing seems very compelling, considering the amount of work put into making the above features work.</p>
<p>I obviously can’t walk you through the Pro version features, but let’s start with the basics. How Oban Py works under the hood, from the job insertion until the job execution. Stay tuned.</p>
<h2 id="going-deeper---job-processing-path">Going Deeper - Job Processing Path</h2>
<p>Let’s get straight to it. You insert your job:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span>from</span> oban <span>import</span> job
</span></span><span><span>
</span></span><span><span><span>@job</span>(queue<span>=</span><span>"default"</span>)
</span></span><span><span><span>async</span> <span>def</span> <span>send_email</span>(to: str, subject: str, body: str):
</span></span><span><span>    <span># Simple and clean, but no access to job context</span>
</span></span><span><span>    <span>await</span> smtp<span>.</span>send(to, subject, body)
</span></span><span><span>
</span></span><span><span><span>await</span> send_email<span>.</span>enqueue(<span>"<a href="https://www.dimamik.com/cdn-cgi/l/email-protection" data-cfemail="cbbeb8aeb98baeb3aaa6bba7aee5a8a4a6">[email&nbsp;protected]</a>"</span>, <span>"Hello"</span>, <span>"World"</span>)
</span></span></code></pre></div><p>After the insertion, the job lands in the <code>oban_jobs</code> database table with <code>state = 'available'</code>. Oban fires off a PostgreSQL <code>NOTIFY</code> on the <code>insert</code> channel:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># oban.py:414-419</span>
</span></span><span><span><span># Single inserts go through bulk insert path</span>
</span></span><span><span>result <span>=</span> <span>await</span> self<span>.</span>_query<span>.</span>insert_jobs(jobs)
</span></span><span><span>queues <span>=</span> {job<span>.</span>queue <span>for</span> job <span>in</span> result <span>if</span> job<span>.</span>state <span>==</span> <span>"available"</span>}
</span></span><span><span><span>await</span> self<span>.</span>_notifier<span>.</span>notify(<span>"insert"</span>, [{<span>"queue"</span>: queue} <span>for</span> queue <span>in</span> queues])
</span></span></code></pre></div><p>Every Oban node listening on that channel receives the notification. <strong>The Stager</strong> on each node gets woken up, but each <strong>Stager</strong> only cares about queues it’s actually running. Be aware that each node decides which queues it runs, so if the current node runs this queue, the producer is notified:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _stager.py:95-99</span>
</span></span><span><span><span>async</span> <span>def</span> <span>_on_notification</span>(self, channel: str, payload: dict) <span>-&gt;</span> <span>None</span>:
</span></span><span><span>    queue <span>=</span> payload[<span>"queue"</span>]
</span></span><span><span>
</span></span><span><span>    <span>if</span> queue <span>in</span> self<span>.</span>_producers:
</span></span><span><span>        self<span>.</span>_producers[queue]<span>.</span>notify()
</span></span></code></pre></div><p>That <code>notify()</code> call sets an <code>asyncio.Event</code>, breaking <strong>the Producer</strong> out of its wait loop, so it can dispatch the jobs to the workers:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _producer.py:244-262</span>
</span></span><span><span><span>async</span> <span>def</span> <span>_loop</span>(self) <span>-&gt;</span> <span>None</span>:
</span></span><span><span>    <span>while</span> <span>True</span>:
</span></span><span><span>        <span>try</span>:
</span></span><span><span>            <span># &lt;--- This is where the event is received ---&gt;</span>
</span></span><span><span>            <span>await</span> asyncio<span>.</span>wait_for(self<span>.</span>_notified<span>.</span>wait(), timeout<span>=</span><span>1.0</span>)
</span></span><span><span>        <span>except</span> asyncio<span>.</span>TimeoutError:
</span></span><span><span>            <span>continue</span>
</span></span><span><span>        <span>except</span> asyncio<span>.</span>CancelledError:
</span></span><span><span>            <span>break</span>
</span></span><span><span>
</span></span><span><span>        <span># &lt;--- Reset the event so it can be triggered for the next batch ---&gt;</span>
</span></span><span><span>        self<span>.</span>_notified<span>.</span>clear()
</span></span><span><span>
</span></span><span><span>        <span>try</span>:
</span></span><span><span>            <span># &lt;--- A little debounce to potentially process multiple jobs at once ---&gt;</span>
</span></span><span><span>            <span>await</span> self<span>.</span>_debounce()
</span></span><span><span>            <span># &lt;--- Dispatch (Produce) the jobs from the database to the workers ---&gt;</span>
</span></span><span><span>            <span>await</span> self<span>.</span>_produce()
</span></span><span><span>        <span>except</span> asyncio<span>.</span>CancelledError:
</span></span><span><span>            <span>break</span>
</span></span><span><span>        <span>except</span> <span>Exception</span>:
</span></span><span><span>            logger<span>.</span>exception(<span>"Error in producer for queue </span><span>%s</span><span>"</span>, self<span>.</span>_queue)
</span></span></code></pre></div><p>Before fetching the jobs, <strong>the producer</strong> persists all pre-existing job completions (acks) to the database to make sure queue limits are respected. Next, it fetches new jobs, transitioning their state to executing at the same time. A slightly more complex version of this SQL is used:</p>
<div><pre tabindex="0"><code data-lang="sql"><span><span><span>-- fetch_jobs.sql (simplified)
</span></span></span><span><span><span></span><span>WITH</span> locked_jobs <span>AS</span> (
</span></span><span><span>  <span>SELECT</span> priority, scheduled_at, id
</span></span><span><span>  <span>FROM</span>
</span></span><span><span>  oban_jobs
</span></span><span><span>  <span>WHERE</span> <span>state</span> <span>=</span> <span>'available'</span> <span>AND</span> queue <span>=</span> <span>%</span>(queue)s
</span></span><span><span>  <span>ORDER</span> <span>BY</span> priority <span>ASC</span>, scheduled_at <span>ASC</span>, id <span>ASC</span>
</span></span><span><span>  <span>LIMIT</span> <span>%</span>(demand)s
</span></span><span><span>  <span>FOR</span> <span>UPDATE</span> SKIP LOCKED
</span></span><span><span>)
</span></span><span><span><span>UPDATE</span> oban_jobs oj
</span></span><span><span><span>SET</span>
</span></span><span><span>  attempt <span>=</span> oj.attempt <span>+</span> <span>1</span>,
</span></span><span><span>  attempted_at <span>=</span> timezone(<span>'UTC'</span>, now()),
</span></span><span><span>  attempted_by <span>=</span> <span>%</span>(attempted_by)s,
</span></span><span><span>  <span>state</span> <span>=</span> <span>'executing'</span>
</span></span><span><span><span>FROM</span> locked_jobs
</span></span><span><span><span>WHERE</span> oj.id <span>=</span> locked_jobs.id
</span></span></code></pre></div><p>And this is <strong>the first really cool part</strong>.</p>
<p><strong>Segue to <em>FOR UPDATE SKIP LOCKED</em>.</strong></p>
<ul>
<li>
<p><code>FOR UPDATE</code> - Locks the selected rows so no other transaction can modify them until this transaction completes. This prevents two producers from grabbing the same job.</p>
</li>
<li>
<p><code>SKIP LOCKED</code> - If a row is already locked by another transaction, skip it instead of waiting. This is crucial for concurrency.</p>
</li>
</ul>
<p>Why this matters for job queues:
Imagine two producer instances (A and B) trying to fetch jobs simultaneously:</p>
<table>
  <thead>
      <tr>
          <th>Without SKIP LOCKED</th>
          <th>With SKIP LOCKED</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>A locks job #1</td>
          <td>A locks job #1</td>
      </tr>
      <tr>
          <td>B <strong>waits</strong> for job #1 to unlock</td>
          <td>B <strong>skips</strong> job #1, takes job #2</td>
      </tr>
      <tr>
          <td>Slow, sequential processing</td>
          <td>Fast, parallel processing</td>
      </tr>
  </tbody>
</table>
<p>Back in Python, we know that the jobs we just fetched should be processed immediately. When we fetched the job, we already transitioned its state and respected the queue demand.</p>
<p>Each job gets dispatched as an <strong>async task</strong>:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span>jobs <span>=</span> <span>await</span> self<span>.</span>_get_jobs()
</span></span><span><span><span>for</span> job <span>in</span> jobs:
</span></span><span><span>    task <span>=</span> self<span>.</span>_dispatcher<span>.</span>dispatch(self, job)
</span></span><span><span>    task<span>.</span>add_done_callback(
</span></span><span><span>        <span>lambda</span> _, job_id<span>=</span>job<span>.</span>id: self<span>.</span>_on_job_complete(job_id)
</span></span><span><span>    )
</span></span><span><span>
</span></span><span><span>    self<span>.</span>_running_jobs[job<span>.</span>id] <span>=</span> (job, task)
</span></span></code></pre></div><p><code>add_done_callback</code> ensures that independent of success or failure, we can attach a callback to handle job completion.</p>
<p><strong>The dispatcher</strong> controls how exactly the job is run. For the non-pro Oban version, it just uses <code>asyncio.create_task</code> to run the job in the event loop:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _producer.py:69-71</span>
</span></span><span><span><span>class</span> <span>LocalDispatcher</span>:
</span></span><span><span>    <span>def</span> <span>dispatch</span>(self, producer: Producer, job: Job) <span>-&gt;</span> asyncio<span>.</span>Task:
</span></span><span><span>        <span>return</span> asyncio<span>.</span>create_task(producer<span>.</span>_execute(job))
</span></span></code></pre></div><p><a href="https://oban.pro/releases/py_pro">For pro version</a>, local asyncio dispatcher is automatically replaced with a pool of processes, so you don’t need to do anything to have true parallelism across multiple cores.</p>
<p>After the job is dispatched, <strong>the Executor</strong> takes over. It resolves your worker class from the string name, runs it, and pattern-matches the result:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _executor.py:73-83</span>
</span></span><span><span><span>async</span> <span>def</span> <span>_process</span>(self) <span>-&gt;</span> <span>None</span>:
</span></span><span><span>  self<span>.</span>worker <span>=</span> resolve_worker(self<span>.</span>job<span>.</span>worker)()
</span></span><span><span>  self<span>.</span>result <span>=</span> <span>await</span> self<span>.</span>worker<span>.</span>process(self<span>.</span>job)
</span></span></code></pre></div><div><pre tabindex="0"><code data-lang="python"><span><span><span># _executor.py:95-133</span>
</span></span><span><span><span>match</span> result:
</span></span><span><span>    <span>case</span> <span>Exception</span>() <span>as</span> error:
</span></span><span><span>        <span># Retry or discard based on attempt count</span>
</span></span><span><span>    <span>case</span> Cancel(reason<span>=</span>reason):
</span></span><span><span>        <span># Mark cancelled</span>
</span></span><span><span>    <span>case</span> Snooze(seconds<span>=</span>seconds):
</span></span><span><span>        <span># Reschedule with decremented attempt</span>
</span></span><span><span>    <span>case</span> _:
</span></span><span><span>        <span># Completed successfully</span>
</span></span></code></pre></div><p>And that’s <strong>the second cool part</strong>! You see how similar it is to <a href="https://hexdocs.pm/elixir/pattern-matching.html">Elixir’s pattern matching</a>? I love how it’s implemented!</p>
<p>When execution finishes, the result gets queued for acknowledgement:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _producer.py:315</span>
</span></span><span><span>self<span>.</span>_pending_acks<span>.</span>append(executor<span>.</span>action)
</span></span></code></pre></div><p>The completion callback notifies <strong>the Producer</strong> to wake up again-fetch more jobs, and batch-ack the finished ones in a single query.</p>
<p>That’s the hot path: <code>Insert → Notify → Fetch (with locking) → Execute → Ack.</code> Five hops from your code to completion. What about the background processes? What about errors and retries? What about periodic jobs, cron, and all these other pieces? Stay tuned.</p>
<h2 id="the-undercurrents---background-processes">The Undercurrents - Background Processes</h2>
<p>Oban runs several background loops that keep the system healthy.</p>
<h3 id="leader-election">Leader Election</h3>
<p>In a cluster, you don’t want every node pruning jobs or rescuing orphans. Oban elects a single leader:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _leader.py:107-113</span>
</span></span><span><span><span>async</span> <span>def</span> <span>_election</span>(self) <span>-&gt;</span> <span>None</span>:
</span></span><span><span>    self<span>.</span>_is_leader <span>=</span> <span>await</span> self<span>.</span>_query<span>.</span>attempt_leadership(
</span></span><span><span>        self<span>.</span>_name, self<span>.</span>_node, int(self<span>.</span>_interval), self<span>.</span>_is_leader
</span></span><span><span>    )
</span></span></code></pre></div><div><pre tabindex="0"><code data-lang="sql"><span><span><span>-- Cleanup expired leaders first
</span></span></span><span><span><span></span><span>DELETE</span> <span>FROM</span>
</span></span><span><span>  oban_leaders
</span></span><span><span><span>WHERE</span>
</span></span><span><span>  expires_at <span>&lt;</span> timezone(<span>'UTC'</span>, now())
</span></span></code></pre></div><div><pre tabindex="0"><code data-lang="sql"><span><span><span>-- If current node is a leader, it re-elects itself
</span></span></span><span><span><span></span><span>INSERT</span> <span>INTO</span> oban_leaders (name, node, elected_at, expires_at)
</span></span><span><span><span>VALUES</span> (
</span></span><span><span>  <span>%</span>(name)s,
</span></span><span><span>  <span>%</span>(node)s,
</span></span><span><span>  timezone(<span>'UTC'</span>, now()),
</span></span><span><span>  timezone(<span>'UTC'</span>, now()) <span>+</span> interval <span>'%(ttl)s seconds'</span>
</span></span><span><span>)
</span></span><span><span><span>ON</span> CONFLICT (name) <span>DO</span> <span>UPDATE</span> <span>SET</span>
</span></span><span><span>  <span>-- Only update if we're the same node (i.e. current leader re-electing itself).
</span></span></span><span><span><span></span>  <span>-- Other nodes can't overwrite an active leader's lease.
</span></span></span><span><span><span></span>  expires_at <span>=</span> EXCLUDED.expires_at
</span></span><span><span><span>WHERE</span>
</span></span><span><span>  oban_leaders.node <span>=</span> EXCLUDED.node
</span></span><span><span>RETURNING node
</span></span></code></pre></div><div><pre tabindex="0"><code data-lang="sql"><span><span><span>-- Try to insert as a new leader if no leader exists
</span></span></span><span><span><span></span><span>INSERT</span> <span>INTO</span> oban_leaders (
</span></span><span><span>  name, node, elected_at, expires_at
</span></span><span><span>) <span>VALUES</span> (
</span></span><span><span>  <span>%</span>(name)s,
</span></span><span><span>  <span>%</span>(node)s,
</span></span><span><span>  timezone(<span>'UTC'</span>, now()),
</span></span><span><span>  timezone(<span>'UTC'</span>, now()) <span>+</span> interval <span>'%(ttl)s seconds'</span>
</span></span><span><span>)
</span></span><span><span><span>ON</span> CONFLICT (name) <span>DO</span> <span>NOTHING</span>
</span></span><span><span>RETURNING node
</span></span></code></pre></div><p>The leader refreshes twice as often to hold onto the role:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _leader.py:101-105</span>
</span></span><span><span><span># Sleep for half interval if leader (to boost their refresh interval and allow them to</span>
</span></span><span><span><span># retain leadership), full interval otherwise</span>
</span></span><span><span>sleep_duration <span>=</span> self<span>.</span>_interval <span>/</span> <span>2</span> <span>if</span> self<span>.</span>_is_leader <span>else</span> self<span>.</span>_interval
</span></span></code></pre></div><p>When a node shuts down cleanly, it resigns and notifies the cluster:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _leader.py:83-87</span>
</span></span><span><span><span>if</span> self<span>.</span>_is_leader:
</span></span><span><span>    payload <span>=</span> {<span>"action"</span>: <span>"resign"</span>, <span>"node"</span>: self<span>.</span>_node, <span>"name"</span>: self<span>.</span>_name}
</span></span><span><span>
</span></span><span><span>    <span>await</span> self<span>.</span>_notifier<span>.</span>notify(<span>"leader"</span>, payload)
</span></span><span><span>    <span>await</span> self<span>.</span>_query<span>.</span>resign_leader(self<span>.</span>_name, self<span>.</span>_node)
</span></span></code></pre></div><p>And that’s <strong>the third cool part</strong>! Leader election is delegated entirely to PostgreSQL. Oban uses <code>INSERT ... ON CONFLICT</code> with a TTL-based lease - no Raft, no consensus protocol, no external coordination service. If the leader dies, its lease expires and the next node to run the election query takes over. Simple, effective, and zero additional infrastructure.</p>
<h3 id="lifeline-rescuing-orphaned-jobs">Lifeline: Rescuing Orphaned Jobs</h3>
<p>Workers crash. Containers get killed. When that happens, jobs can get stuck executing indefinitely. <strong>The Lifeline</strong> process (leader-only) rescues them:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _lifeline.py:73-77</span>
</span></span><span><span><span>async</span> <span>def</span> <span>_rescue</span>(self) <span>-&gt;</span> <span>None</span>:
</span></span><span><span>    <span>if</span> <span>not</span> self<span>.</span>_leader<span>.</span>is_leader:
</span></span><span><span>        <span>return</span>
</span></span><span><span>
</span></span><span><span>    <span>await</span> use_ext(<span>"lifeline.rescue"</span>, _rescue, self<span>.</span>_query, self<span>.</span>_rescue_after)
</span></span></code></pre></div><p>Oban-py rescue mechanics are purely time-based - any job in <code>executing</code> state longer than <code>rescue_after</code> (default: 5 minutes) gets moved back. Unlike the Oban Pro version, it doesn’t check whether the producer that owns the job is still alive. This means legitimately long-running jobs could be rescued and executed a second time.</p>
<p>The takeaway is that you should set <code>rescue_after</code> higher than your longest expected job duration, and design workers to be idempotent.</p>
<p>The SQL itself is straightforward - jobs stuck executing get moved back to available or discarded if they’ve exhausted retries:</p>
<div><pre tabindex="0"><code data-lang="sql"><span><span><span>-- rescue_jobs.sql (simplified)
</span></span></span><span><span><span></span><span>UPDATE</span> oban_jobs
</span></span><span><span><span>SET</span>
</span></span><span><span>  <span>state</span> <span>=</span> <span>CASE</span>
</span></span><span><span>    <span>WHEN</span> attempt <span>&gt;=</span> max_attempts <span>THEN</span> <span>'discarded'</span>
</span></span><span><span>    <span>ELSE</span> <span>'available'</span>
</span></span><span><span>  <span>END</span>,
</span></span><span><span>  meta <span>=</span> <span>CASE</span>
</span></span><span><span>    <span>WHEN</span> attempt <span>&gt;=</span> max_attempts <span>THEN</span> meta
</span></span><span><span>    <span>ELSE</span> meta <span>||</span> jsonb_build_object(<span>'rescued'</span>, coalesce((meta<span>-&gt;&gt;</span><span>'rescued'</span>)::int, <span>0</span>) <span>+</span> <span>1</span>)
</span></span><span><span>  <span>END</span>
</span></span><span><span><span>WHERE</span>
</span></span><span><span>  <span>state</span> <span>=</span> <span>'executing'</span>
</span></span><span><span>  <span>AND</span> attempted_at <span>&lt;</span> timezone(<span>'UTC'</span>, now()) <span>-</span> make_interval(secs <span>=&gt;</span> <span>%</span>(rescue_after)s)
</span></span></code></pre></div><p>The rescued counter in meta lets you track how often jobs needed saving.</p>
<h3 id="pruner-cleaning-up-old-jobs">Pruner: Cleaning Up Old Jobs</h3>
<p>Without pruning, your oban_jobs table grows forever. <strong>The Pruner</strong> (also leader-only) deletes terminal jobs older than max_age (default: 1 day):</p>
<div><pre tabindex="0"><code data-lang="sql"><span><span><span>-- prune_jobs.sql
</span></span></span><span><span><span></span><span>WITH</span> jobs_to_delete <span>AS</span> (
</span></span><span><span><span>SELECT</span> id <span>FROM</span> oban_jobs
</span></span><span><span><span>WHERE</span>
</span></span><span><span>(<span>state</span> <span>=</span> <span>'completed'</span> <span>AND</span> completed_at <span>&lt;=</span> timezone(<span>'UTC'</span>, now()) <span>-</span> make_interval(secs <span>=&gt;</span> <span>%</span>(max_age)s)) <span>OR</span>
</span></span><span><span>(<span>state</span> <span>=</span> <span>'cancelled'</span> <span>AND</span> cancelled_at <span>&lt;=</span> timezone(<span>'UTC'</span>, now()) <span>-</span> make_interval(secs <span>=&gt;</span> <span>%</span>(max_age)s)) <span>OR</span>
</span></span><span><span>(<span>state</span> <span>=</span> <span>'discarded'</span> <span>AND</span> discarded_at <span>&lt;=</span> timezone(<span>'UTC'</span>, now()) <span>-</span> make_interval(secs <span>=&gt;</span> <span>%</span>(max_age)s))
</span></span><span><span><span>ORDER</span> <span>BY</span> id <span>ASC</span>
</span></span><span><span><span>LIMIT</span> <span>%</span>(<span>limit</span>)s
</span></span><span><span>)
</span></span><span><span><span>DELETE</span> <span>FROM</span> oban_jobs <span>WHERE</span> id <span>IN</span> (<span>SELECT</span> id <span>FROM</span> jobs_to_delete)
</span></span></code></pre></div><p>The LIMIT prevents long-running deletes from blocking other operations.</p>
<h3 id="retry--backoff-mechanics">Retry &amp; Backoff Mechanics</h3>
<p>When a job raises an exception, <strong>the Executor</strong> decides its fate:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _executor.py:96-109</span>
</span></span><span><span><span>match</span> result:
</span></span><span><span>    <span>case</span> <span>Exception</span>() <span>as</span> error:
</span></span><span><span>        <span>if</span> self<span>.</span>job<span>.</span>attempt <span>&gt;=</span> self<span>.</span>job<span>.</span>max_attempts:
</span></span><span><span>            self<span>.</span>action <span>=</span> AckAction(
</span></span><span><span>                job<span>=</span>self<span>.</span>job,
</span></span><span><span>                state<span>=</span><span>"discarded"</span>,
</span></span><span><span>                error<span>=</span>self<span>.</span>_format_error(error),
</span></span><span><span>            )
</span></span><span><span>        <span>else</span>:
</span></span><span><span>            self<span>.</span>action <span>=</span> AckAction(
</span></span><span><span>                job<span>=</span>self<span>.</span>job,
</span></span><span><span>                state<span>=</span><span>"retryable"</span>,
</span></span><span><span>                error<span>=</span>self<span>.</span>_format_error(error),
</span></span><span><span>                schedule_in<span>=</span>self<span>.</span>_retry_backoff(),
</span></span><span><span>            )
</span></span></code></pre></div><p>Simple rule: under <code>max_attempts</code> - retry, otherwise - discard.</p>
<p>The default backoff uses jittery-clamped exponential growth with randomness to prevent thundering herds:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span># _backoff.py:66-87</span>
</span></span><span><span><span>def</span> <span>jittery_clamped</span>(attempt: int, max_attempts: int, <span>*</span>, clamped_max: int <span>=</span> <span>20</span>) <span>-&gt;</span> int:
</span></span><span><span>    <span>if</span> max_attempts <span>&lt;=</span> clamped_max:
</span></span><span><span>        clamped_attempt <span>=</span> attempt
</span></span><span><span>    <span>else</span>:
</span></span><span><span>        clamped_attempt <span>=</span> round(attempt <span>/</span> max_attempts <span>*</span> clamped_max)
</span></span><span><span>
</span></span><span><span>    time <span>=</span> exponential(clamped_attempt, mult<span>=</span><span>1</span>, max_pow<span>=</span><span>100</span>, min_pad<span>=</span><span>15</span>)
</span></span><span><span>
</span></span><span><span>    <span>return</span> jitter(time, mode<span>=</span><span>"inc"</span>)
</span></span></code></pre></div><p>And that’s <strong>the fourth cool thing</strong>! Backoff includes jitter to prevent <a href="https://en.wikipedia.org/wiki/Thundering_herd_problem">thundering herds</a> - without it, all failed jobs from the same batch would retry at the exact same moment, spiking load all over again.</p>
<p>The formula: 15 + 2^attempt seconds, with up to 10% added jitter. Attempt 1 waits ~17s. Attempt 5 waits ~47s. Attempt 10 waits ~1039s (~17 minutes).</p>
<p>The clamping handles jobs with high <code>max_attempts</code> - if you set <code>max_attempts=100</code>, it scales the attempt number down proportionally so you don’t wait years between retries.</p>
<p>Workers can override this with custom backoff:</p>
<div><pre tabindex="0"><code data-lang="python"><span><span><span>@worker</span>(queue<span>=</span><span>"default"</span>)
</span></span><span><span><span>class</span> <span>MyWorker</span>:
</span></span><span><span>    <span>async</span> <span>def</span> <span>process</span>(self, job: Job):
</span></span><span><span>        <span>...</span>
</span></span><span><span>
</span></span><span><span>    <span>def</span> <span>backoff</span>(self, job: Job) <span>-&gt;</span> int:
</span></span><span><span>        <span># Linear backoff: 60s, 120s, 180s...</span>
</span></span><span><span>        <span>return</span> job<span>.</span>attempt <span>*</span> <span>60</span>
</span></span></code></pre></div><h2 id="surfacing---takeaways">Surfacing - Takeaways</h2>
<ul>
<li><strong>PostgreSQL does the heavy lifting.</strong> <code>FOR UPDATE SKIP LOCKED</code> for concurrent job fetching, <code>LISTEN/NOTIFY</code> for real-time signaling, <code>ON CONFLICT</code> for leader election - the database isn’t just storage, it’s the coordination layer. There’s no Redis, no ZooKeeper, no external broker. One less thing to operate.</li>
<li><strong>Oban-py is concurrent, but not parallel</strong>. Async IO allows multiple jobs to be in-flight, but the event loop is single-threaded. For I/O-bound workloads, this is fine. For CPU-bound tasks, consider using the Pro version with a process pool.</li>
<li><strong>Leader election is simple and effective.</strong> No consensus protocol, no Raft - just an <code>INSERT ... ON CONFLICT</code> with a TTL. The leader refreshes at 2x the normal rate to hold the lease. If it dies, the lease expires and another node takes over. Good enough for pruning and rescuing.</li>
<li><strong>The codebase is a pleasure to read.</strong> Clear naming, consistent patterns, and well-separated concerns - exploring it felt more like reading a well-written book than understanding a library.</li>
<li><strong>OSS gets you far, Pro fills the gaps.</strong> Bulk operations, smarter rescues, and true parallelism are all Pro-only - but for what you get, Pro license feels like a great deal.</li>
</ul>
<p>Overall, <a href="https://oban.pro/docs/py/index.html">Oban.py</a> is a clean and well-structured port. If you’re coming from Elixir and miss Oban, or if you’re in Python and want a database-backed job queue that doesn’t require external infrastructure beyond PostgreSQL - it’s worth looking at.</p>


    </div>

    
</article>
            </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Amazon axes 16,000 jobs as it pushes AI and efficiency (631 pts)]]></title>
            <link>https://www.reuters.com/legal/litigation/amazon-cuts-16000-jobs-globally-broader-restructuring-2026-01-28/</link>
            <guid>46796745</guid>
            <pubDate>Wed, 28 Jan 2026 15:39:11 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.reuters.com/legal/litigation/amazon-cuts-16000-jobs-globally-broader-restructuring-2026-01-28/">https://www.reuters.com/legal/litigation/amazon-cuts-16000-jobs-globally-broader-restructuring-2026-01-28/</a>, See on <a href="https://news.ycombinator.com/item?id=46796745">Hacker News</a></p>
Couldn't get https://www.reuters.com/legal/litigation/amazon-cuts-16000-jobs-globally-broader-restructuring-2026-01-28/: Error: Request failed with status code 401]]></description>
        </item>
        <item>
            <title><![CDATA[Airfoil (2024) (410 pts)]]></title>
            <link>https://ciechanow.ski/airfoil/</link>
            <guid>46795908</guid>
            <pubDate>Wed, 28 Jan 2026 14:32:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://ciechanow.ski/airfoil/">https://ciechanow.ski/airfoil/</a>, See on <a href="https://news.ycombinator.com/item?id=46795908">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>The dream of soaring in the sky like a bird has captivated the human mind for <a href="https://en.wikipedia.org/wiki/Icarus">ages</a>. Although many failed, some eventually <a href="https://en.wikipedia.org/wiki/Wright_Flyer">succeeded</a> in achieving that goal. These days we take air transportation for granted, but the physics of flight can still be puzzling.</p>
<p>In this article we’ll investigate what makes airplanes fly by looking at the forces generated by the flow of air around the aircraft’s wings. More specifically, we’ll focus on the cross section of those wings to reveal the shape of an <a href="https://en.wikipedia.org/wiki/Airfoil"><em>airfoil</em></a> – you can see it presented in <span><strong>yellow</strong></span> below:</p>


<p>We’ll find out how the shape and the <span><strong>orientation</strong></span> of the <span><strong>airfoil</strong></span> helps airplanes remain airborne. We’ll also learn about the behavior and properties of air and other flowing matter. In the demonstration below, you can see a fluid flowing around a <span><strong>gray cube</strong></span>. Using the slider to change just one <span><strong>property</strong></span> of this substance, we can end up with vastly different effects on the liveliness of that flow:</p>


<p>Over the course of this blog post we’ll build some intuitions for why these different effects happen to airfoils and other objects placed in flowing air. We’ll start this journey by looking at some of the methods we can use to visualize the motion of the air.</p>
<h2 id="visualizing-flow">Visualizing Flow<a href="https://ciechanow.ski/airfoil/#visualizing-flow" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>If you’ve ever been outside in a grassy area on a windy fall day, you may have witnessed something similar to the little scene seen below. The slider lets you control the <span><strong>speed of time</strong></span> to observe in detail how the <span><strong>falling leaves</strong></span> and the bending <span><strong>blades of grass</strong></span> are visibly affected by the wind sweeping through this area:</p>


<p>We intuitively understand that it’s the flowing air that pushes the vegetation around, but note that we only observe the effects that the wind has on other objects – we can’t see the motion of the air <em>itself</em>. I could show you a similarly windy scene without the <span><strong>grass</strong></span> and <span><strong>leaves</strong></span>, and I could try to convince you that there is something going on there, but that completely empty demonstration wouldn’t be very gratifying.</p>
<p>Since the air’s transparency prevents us from tracking its movement directly, we have to come up with some other ways that can help us see its motion. Thankfully, the little outdoor scene already provides us with some ideas.</p>
<p>Notice that as the wind hits a blade of grass, that blade naturally bends in the direction of the blowing gust, and the faster that gust, the stronger the bending. A&nbsp;single blade indicates the direction and speed of the flow of air in that area.</p>
<p>In the next demonstration we’re looking at the same grassy field from above. When seen from this perspective, all the <span><strong>blades</strong></span> form short lines that are locally aligned with the wind. The more leaned over a blade of grass is, the longer the line it forms. We can mimic this behavior with a collection of <span><strong>small arrows</strong></span> placed all over the area, as seen on the right side:</p>


<p>Each <span><strong>arrow</strong></span> represents the direction and the speed of the flow of air at that location – the longer the <span><strong>arrow</strong></span>, the faster the flow. In these windy conditions the flow varies from place to place and it also changes over time, which we can clearly see in the motion of the <span><strong>arrows</strong></span>.</p>
<p>Note that we have some flexibility in how the speed of wind corresponds to the length of an <span><strong>arrow</strong></span>. I adjusted the lengths of the <span><strong>arrows</strong></span> to prevent them from visually overlapping, but I also made sure to maintain their <em>relative</em> lengths – if one <span><strong>arrow</strong></span> is twice as long as the other, then the flow at that location is also twice as fast.</p>
<p>For visual clarity I’m also not packing the <span><strong>arrows</strong></span> as densely as the <span><strong>blades of grass</strong></span> are placed, but it’s important to note that <em>every</em> point in the flow has its own velocity which contributes to the complete velocity <a href="https://en.wikipedia.org/wiki/Vector_field"><em>field</em></a> present in this area. If we wanted to, we could draw a <span><strong>velocity arrow</strong></span> at any of the seemingly empty spots on the right side.</p>
<p>The arrows are convenient, but the grassy scene also has another aid for visualizing flows. Many light objects like <span><strong>leaves</strong></span>, flower petals, dust, or smoke are very easily influenced by the motion of the surrounding air. They quickly change their velocity to match the flow of the wind. We can replicate the behavior of these light objects with <span><strong>little markers</strong></span> that are pushed around by that flow. You can see them on the right side:</p>


<p>These little <span><strong>markers</strong></span> also show us the motion of the air. Each <span><strong>marker</strong></span> represents an object so small and light that it instantly picks up the speed of the surrounding airflow. We’d have a hard time seeing these miniscule specks at their actual sizes, so I’m drawing the <span><strong>markers</strong></span> as visible dots.</p>
<p>In fact, the motion of each <span><strong>marker</strong></span> is equivalent to the motion of the parcel of air right around it. If you <a href="#" onclick="grass3_f0();return false;">slow down time</a>, you’ll be able to see how each <span><strong>marker</strong></span> just moves in the direction of the <span><strong>arrows</strong></span> underneath it. I also made each <span><strong>marker</strong></span> leave a little ghost trail behind it – this lets us track the path the air, as represented by the <span><strong>marker</strong></span>, took on the way to its current position.</p>
<p>Let’s pause for a second to emphasize what the <span><strong>grass</strong></span>-like <span><strong>arrows</strong></span> and <span><strong>leaf</strong></span>-like <span><strong>markers</strong></span> represent –&nbsp;they both show the <em>velocity</em> of the flow of air, but in slightly different ways. An <span><strong>arrow</strong></span> is attached to its fixed point in space, so it represents the current direction and speed of the flow at <em>that location</em>. The whole collection of arrows lets us easily see what the entire flow is doing at the moment.</p>
<p>On the other hand, the little <span><strong>markers</strong></span> are actively following the flow, letting us see how the air is actually <em>moving</em> through space, with the ghosty trails giving us some historical overview of where this parcel of air has come from.</p>
<p>The two methods we’ve seen so far are very versatile, but sometimes we don’t care about the local direction of the flow, only its speed – in the middle of this grassy field one might get cold from a fast blowing wind regardless of the direction from which that wind is coming. This brings us the third way of visualizing flow:</p>


<p>In this method we show the <em>speed</em> of the airflow using colors of varying brightness – the faster the wind, the brighter the color. You can see the whole <strong><span>spectrum of colors</span></strong> in the scale below the plot.</p>
<p>This method shows the speed of the flow at <em>all</em> locations giving us a more fine-grained insight into the motion of air at the cost of the directional information. To help with that I’ll sometimes overlay the regular arrows on top to let us know where the flow is going as well.</p>
<p>You may have noticed that all these methods present a flat, two dimensional view of the flow. It’s based on the assumption that the wind in our little scene doesn’t change with elevation, and that it also doesn’t blow towards or away from the ground.</p>
<p>In reality, the air velocity could vary in all three dimensions, and that air could also flow upwards or downwards. Thankfully, the air flows we’ll consider in this article will be two dimensional and the simple flat drawings will suffice.</p>
<p>Before we finish this section, let me bring up visualization of a simple airflow, but this time I’ll give you some control over its <span><strong>direction</strong></span>, which you can change using the second slider. The first one once more controls the <span><strong>speed of time</strong></span>:</p>



<p>Don’t be misled by the frozen arrows, the wind is actually blowing there. Remember that the arrows represent the local velocity of the flow of air, so while the velocity doesn’t change, the <em>position</em> of each packet of air does. You can see those changes by tracking the <span><strong>markers</strong></span> moving around with the flow. This demonstration represents a <a href="https://en.wikipedia.org/wiki/Fluid_dynamics#Steady_vs_unsteady_flow"><em>steady flow</em></a>, which means that its properties don’t change over time.</p>
<p>So far we’ve been exploring the notion of airflow’s velocity on a more intuitive level, with a general understanding that’s it’s “the air” moving around in some direction and at some speed. I illustrated that concept using simple <span><strong>arrows↑</strong></span>, <span><strong>markers&nbsp;•</strong></span>, and <strong><span>varying colors</span></strong>, but we’re now ready to investigate the details hiding behind those straightforward graphical representations.</p>
<p>To do that, we have to look at individual particles of air. Although I <a href="https://ciechanow.ski/sound/#air">briefly discussed</a> the particle nature of air before, this time around we’re going to take a closer look at the motion of these molecules, and what it means for airflow as a whole.</p>
<h2 id="velocity">Velocity<a href="https://ciechanow.ski/airfoil/#velocity" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>Let’s take a look at the air particles in a small, marked out volume of space seen in the demonstration below – you can drag the cube around to change the viewing angle. The slider controls the <span><strong>speed of time</strong></span>:</p>


<p>You’re witnessing the motion of over twelve thousand air particles. It may seem like a lot, but this cube is <em>extremely</em> <span>tiny</span>, its sides are only 80 nanometers long. To put this in perspective using more familiar sizes, if that cube’s side measured just <span>1 inch</span><span>1 centimeter</span>, it would contain around <span>410 quintillion, or 4.1×10<sup>20</sup></span><span>25 quintillion, or 2.5×10<sup>19</sup></span> particles.</p>
<p>The particles are zipping around in random directions, constantly entering and leaving this region. However, despite all this motion what you’re seeing here is a simulation of <em>still</em> air.</p>
<p>To understand how all this movement ends up creating still conditions, we first have to look at the velocity of each particle – I’ll visualize it with a small arrow in the direction of motion. To make things a easier to see, I’ll also <span><strong>highlight</strong></span> a few of the particles while fading out the rest of them:</p>


<p>The length of an arrow is proportional to the speed of a particle, so when you <a href="#" onclick="particles2_f0();return false;">freeze the time</a> you should be able to see how some particles are slower and some are faster. This speed variation follows a <a href="https://en.wikipedia.org/wiki/Maxwell%E2%80%93Boltzmann_distribution">certain distribution</a> that’s related to temperature – the warmer the air, the faster the motion of its particles.</p>
<p>At room temperature the average speed of a particle in air is an astonishing <span>1030&nbsp;mph</span><span>1650&nbsp;km/h</span>, which is many times higher than even <a href="https://en.wikipedia.org/wiki/Saffir%E2%80%93Simpson_scale#Category_5">the most severe hurricanes</a>. Given the size of the cube, this means that even at the <a href="#" onclick="particles2_f1();return false;">fastest speed of simulation</a> everything happens 11 <em>billion</em> times slower than in real life.</p>
<p>If you paid close attention, you may have also noticed that sometimes the particles randomly change direction and speed of their motion – this happens when molecules collide. Each particle experiences roughly ten billion collisions per second. We’ll get back to these interactions later on, but for now let’s try to figure out how all this turmoil creates still air.</p>
<p>Having just seen the small velocity arrows of individual particles, let’s calculate the <em>average</em> velocity of a group of three <span><strong>particles</strong></span>, using the process shown below. We first take the velocity arrows <span><strong>from</strong></span> <span><strong>each</strong></span> <span><strong>particle</strong></span> and place them head to toe, one after another. Then we connect the start of the <span><strong>first arrow</strong></span> with the end of the <span><strong>last arrow</strong></span> to create the <span><strong>sum</strong></span> of all velocities. Finally, we divide, or scale down, the length of this <span><strong>sum</strong></span> by the number of particles to get the <span><strong>average velocity</strong></span>:</p>

<p>In the next demonstration we’re repeating this whole procedure by tallying up all the particles inside the <span><strong>red box</strong></span>. You can change the <span><strong>size</strong></span> of that region with the second slider. The <strong>large arrow</strong> in the middle shows the average velocity of particles in the box. To make that <strong>central arrow</strong> visible, I’m making it much larger than the tiny arrows tied to particles:</p>



<p>The counter in the bottom part of the demonstration tracks the current number of particles in the <span><strong>red cube</strong></span>. That value fluctuates as the molecules enter and leave that region. While aggregating over a small number of particles creates a very <a href="#" onclick="particles3_f0();return false;">noisy readout</a>, it doesn’t take <em>that</em> many particles to get a much <a href="#" onclick="particles3_f1();return false;">steadier measure</a>.</p>
<p>Recall that the scale of the <strong>large central arrow</strong> is much larger than the scale of individual tiny arrows attached to each particle. Despite that increase in size, the <strong>arrow</strong> practically disappears when we average out a larger number of particles and we can clearly see that the average velocity of particles is more or less zero even in this extremely small volume.</p>
<p>In still conditions, all these motions in different directions average out to nothing. As some particles enter the area from a random direction, the others also leave it in a random way. The <em>bulk</em> of air doesn’t really go anywhere and the particles just meander in a random fashion.</p>
<p>An imperfect, but convenient analogy is to imagine a swarm of bees flying in the air. While all the individual insects are actively roaming around at different speeds, the group as a whole may steadily stay in one place.</p>
<p>All these experiments form the key to understanding what happens when wind sweeps through an area. In the demonstration below, we’re once again watching a small volume of space, but this time you can control the <span><strong>speed</strong></span> of the blowing wind:</p>



<p>Notice the <span>mph</span><span>km/h</span> speedometer in the bottom of the demonstration. This is not a mistake –&nbsp;even with <a href="#" onclick="particles4_f0();return false;">hurricane-level wind speeds</a> it’s very hard to see any difference in the motion of the particles. Perhaps you’ve managed to see the tiniest shifts in the small particle arrows as you drag the <span><strong>second slider</strong></span> around with <a href="#" onclick="particles4_f1();return false;">time paused</a>, but it’s difficult to even perceive from which direction the wind is blowing.</p>
<p>However, when we use the procedure of averaging the velocity of all the particles, we can reveal the motion of their group in the box of a given <span><strong>size</strong></span>, at a specific <span><strong>speed</strong></span> of the flow:</p>




<p>Because the motion of each individual particle is so disordered, we have to look at many of them at once to discern any universal characteristics. And when we do <a href="#" onclick="particles5_f0();return false;">just that</a>, from all the chaos emerges order.</p>
<p>It’s important to note that with this approach we’re tracking the velocity of the flow within the same region of space outlined by the <span><strong>red box</strong></span> – the molecules keep entering and leaving this area as the flow moves and the <strong>arrow</strong> in the middle shows the average velocity of the air’s particles in that <span><strong>area</strong></span>.</p>
<p>This is <em>exactly</em> what the grass-like arrows we’ve played with in the previous section represent – each one shows the average velocity of air particles in that local region of space. The <strong>big arrow</strong> we just saw in the middle of the swarm in the <span><strong>averaging red box</strong></span> is equivalent to each of the <span><strong>arrows</strong></span> seen below:</p>


<p>Naturally, the <span><strong>averaging box</strong></span> needs to be large enough to avoid the jitteriness related to aggregation of too few particles, but at any scale that we could care about the noisy readout completely disappears.</p>
<p>The <em>average</em> motion of particles is very different than the motion of each individual molecule. Even in very fast flows, many of the molecules move in the opposite direction than what the arrow indicates, but if we tally up all the particle motion, the air as a whole does make forward progress in the direction of velocity.</p>
<p>Up to this point, we’ve mostly looked at the flow of air by looking at wind and the way it moves through space, but what we consider a motion of air is relative. Let’s see how, by merely changing the point of view, we can create a motion of air in otherwise windless conditions.</p>
<h2 id="relative-velocity">Relative Velocity<a href="https://ciechanow.ski/airfoil/#relative-velocity" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>Let’s zoom away from the world of microscopic particles to look at the motion of larger bodies. In the demonstration below, you can see two different views of the same <span><strong>car</strong></span> driving in the left direction. In the top part, the camera stays firmly on the ground, but in the bottom part, the camera tracks the motion of the <span><strong>vehicle</strong></span>. If needed, you can restart the scene with the button in the bottom left corner or tweak the <span><strong>speed of time</strong></span> with the slider:</p>


<p>These two views show the exact same scene – we’re just changing what the camera is focusing on. As seen in the top part, from the perspective of the static camera, it’s only the <span><strong>car</strong></span> that has some velocity in the left direction.</p>
<p>On the other hand, from the perspective of the camera focused on the <span><strong>vehicle</strong></span>, the <span><strong>car</strong></span> doesn’t move, but <em>everything else</em> does. The poles and road markings all move to the right with a speed equal to that of the <span><strong>car</strong></span>. This shouldn’t come as a surprise from daily experience in any form of transportation – when you’re sitting in a moving vehicle, static things in the surrounding environment seem to move towards and past you.</p>
<p>The very same rules apply to any region of air – I’ve outlined some of them with dashed boxes <span></span>  up in the sky. For the observer on the ground that air is still, but from the <span><strong>car’s</strong></span> perspective, that air is moving.</p>
<p>With that in mind, let’s see the same scene, but this time I’ll add the familiar small arrows showing the air’s velocity as “seen” by the camera:</p>


<p>From the point of view of the <span><strong>car</strong></span>, as seen in the bottom view, the air is moving to the right, as if there was some wind blowing right at the <span><strong>vehicle</strong></span>. You’ve probably felt this many times by sticking your hand out the window – it feels no different than if you were standing still on the ground with the wind hitting your fingers.</p>
<p>In fact, there is absolutely no difference between “regular” wind and wind experienced by the <span><strong>car</strong></span>  or your hand sticking out the window – both are simply a motion of air relative to some object. This means that we can use our arrows to represent any motion of air, as long as we note what that motion is relative to.</p>
<p>You may have also noticed that the moving <span><strong>car</strong></span> affects the motion of air in its vicinity. Let me bring up the previous demonstration one more time:</p>


<p>In the top view, we can see how the front of the <span><strong>vehicle</strong></span> pushes the air forward, and how the air “bends” and speeds up around the shape of the <span><strong>car</strong></span> to roughly follow its shape, only to end up circling right behind the <span><strong>machine</strong></span>.</p>
<p>The same effects are seen in the bottom view – they’re just experienced differently. For example, the air right in front of the <span><strong>car</strong></span> slows down, while the air on top moves even faster than the rest of the undisturbed, distant air.</p>
<p>We’ll soon explore <em>why</em> the air behaves this way when flowing around an object, but for now let’s raise above the ground to see the motion of an <span><strong>airplane</strong></span> flying in the sky. We’ll use the familiar setup of a camera kept steady relative the ground, as seen in the top part, and a camera that follows the <span><strong>airplane</strong></span>, seen in the bottom part:</p>


<p>Before we continue, notice that it’s getting a little hard to pay close attention to what happens to the moving objects in the ground-fixed camera view – the bodies quickly leave the field of view of the demonstrations. For the rest of this article I’ll stick to the camera style seen in the bottom part of the demonstration – this will let us directly track the interaction between the object and the air that flows around that object.</p>
<p>From the point of view of the <span><strong>airplane</strong></span>, it also experiences a flow of incoming air as seen by the air “boxes” approaching the <span><strong>plane</strong></span>, which is very similar to the car example. What’s completely different from the car example is the fact that the <span><strong>airplane</strong></span> somehow stays suspended in the air, despite gravity pulling it down towards the ground. This means that there must be some other force acting on it to prevent the plane from falling from the sky.</p>
<p>Let’s compare these two vehicles by looking at the basic forces affecting their motion, starting with the diagram of forces acting on the <span><strong>car</strong></span>:</p>


<p>The down-pulling <span><strong>gravity force</strong></span> is counteracted by the <span><strong>reaction forces</strong></span> from the ground – they act through the <span><strong>car’s</strong></span> tires to prevent the <span><strong>car</strong></span> from sinking. The air drag and other forms of resistance <span><strong>push</strong></span> the car back, but the <span><strong>car’s</strong></span> tires powered by the engine keep <span><strong>propelling</strong></span> the car forward.</p>
<p>In my previous article I presented a <a href="https://ciechanow.ski/bicycle/#forces">more elaborate description</a> of the interplay between forces and objects, but to briefly recap here, if forces acting on an object are balanced, then that object will maintain its current velocity.</p>
<p>All forces on the <span><strong>car</strong></span> <em>are</em> balanced and the <span><strong>vehicle</strong></span> moves forward with constant speed, and it doesn’t move at all in the up or down direction – the <span><strong>object’s</strong></span> velocity is indeed constant.</p>
<p>Let’s draw a similar diagram of forces for the flying <span><strong>plane</strong></span>:</p>


<p>We still have the <span><strong>air drag</strong></span> that pushes the <span><strong>vehicle</strong></span> back, and the <span><strong>plane’s</strong></span> propeller powered by the engine keeps  <span><strong>pushing</strong></span> it forward. As a result the <span><strong>plane</strong></span> moves forward with constant speed.</p>
<p>We also have the down-pulling <span><strong>gravity</strong></span>. This time, however, that <span><strong>gravity</strong></span> is not countered by the reaction forces from the ground, but instead it’s balanced by <a href="https://en.wikipedia.org/wiki/Lift_(force)"><em>lift</em></a>, a <span><strong>force</strong></span> that pushes the <span><strong>plane</strong></span> up. When <span><strong>gravity</strong></span> and <span><strong>lift</strong></span> are equalized, the plane doesn’t move up or down either.</p>
<p>Airplanes create most of their lift with wings, which are carefully designed to generate that force. While length, area, and the overall geometry of the wings are very important, in this article we’ll focus on the shape of the cross-section of a wing which I highlighted below in <span><strong>yellow</strong></span>:</p>

<p>This is an <span><strong>airfoil</strong></span>, the protagonist of this article. This <span><strong>airfoil</strong></span> has a smooth, rounded front and a sharp trailing edge. Let’s take a closer look at the flow of air around this <span><strong>airfoil</strong></span> using the grass-like arrows that show the velocity of air at that location:</p>


<p>These arrows paint an interesting picture, but in the demonstration below I’ve also added the little leaf-like <strong>markers</strong> that track the motion of air parcels in the flow. I&nbsp;steadily release a whole line of them from the left side, but you can also <span>click</span><span>tap</span> anywhere in the flow to drop a <strong>marker</strong> at that location. You can do this in any demonstration that has a little hand symbol in the bottom right corner:</p>

<p>The <strong>markers</strong> show that the flow splits ahead of the <span><strong>airfoil</strong></span>, then it gently changes direction to glide above and below the <span><strong>shape</strong></span>. Moreover, the <strong>markers</strong> right in front of the <span><strong>airfoil</strong></span> gradually slow down and lag behind their neighbors. The air somehow senses the presence of the body.</p>
<p>It may be hard to see, but the top and bottom sections of this <span><strong>airfoil</strong></span> aren’t symmetric. This asymmetric design is very important, but right now it will needlessly complicate our discussion on how the flow around this shape arises.</p>
<p>To simplify things a little, let’s use a less complicated shape of a <em>symmetric</em> <span><strong>airfoil</strong></span> – you can see it in the demonstration below. I overlay the previous asymmetric shape with a <span>dashed</span> outline to show the difference between the two:</p>

<p>The motion of air around this airfoil is very similar – the flow changes its direction and speed when it passes around an object. Until now we’ve simply been observing that the flow changes to adapt to the shape of the body, but it’s finally time to understand <em>why</em> it happens. To explain that behavior we need to go back to the world of air particles to discuss the concept of pressure.</p>
<h2 id="pressure">Pressure<a href="https://ciechanow.ski/airfoil/#pressure" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>As we’ve discussed, even in the seemingly steady conditions the particles of air are zipping around at high speeds colliding with each other at an incredible rate. The surface of any object placed in the air will also experience these bounces.</p>
<p>In the demonstration below, you can see air particles bombarding a <span><strong>small box</strong></span>. Every time a collision happens I briefly mark it with a <strong>dark spot</strong> on the surface of that <span><strong>cube</strong></span>:</p>


<p>To understand the implications of these collisions, let’s first take a look at objects with more ordinary sizes. In the demonstration below, <span><strong>tennis balls</strong></span> are hitting a large <span><strong>cardboard box</strong></span> from the left and right side. By dragging the slider you can change the <span><strong>intensity</strong></span> of both streams of balls:</p>


<p>When a <span><strong>tennis ball</strong></span> hits the <span><strong>box</strong></span>, the collision imparts some force on it, causing the <span><strong>box</strong></span> to move. However, in this simulation the collisions from all the <span><strong>balls</strong></span> on each side balance each other out, so the <span><strong>box</strong></span> doesn’t make any consistent progress in either direction.</p>
<p>In real air, the situation is similar, but at vastly different scales. The mass of each particle constituting air is absolutely miniscule, so the impact of an individual collision on any object of meaningful size is completely imperceptible.</p>
<p>Moreover, each air particle hitting an object has a different speed, and it strikes the surface of that object at a different angle – some hit the object straight on, but some barely graze it. Due to the enormous number of these collisions happening at every instant of time, all these variations average out, and even a small section of surface of any body experiences uniform bombardment.</p>
<p>In aggregate, we say that the air exerts <a href="https://en.wikipedia.org/wiki/Pressure"><em>pressure</em></a> on any object present in that air. The magnitude of this pressure depends on the intensity of these collisions across an area.</p>
<p>Let’s see how this pressure manifests on our <span><strong>tiny cube</strong></span>. In the demonstration below, you can use the second slider to control the <span><strong>number of air molecules</strong></span> present in this volume:</p>



<p>The <span><strong>black arrows</strong></span> you see on the sides of the cube symbolize the magnitude of pressure on these walls. As we <em>uniformly</em> increase the <span><strong>number of particles</strong></span> in this volume, the intensity of collisions, and thus the <span><strong>pressure</strong></span>, also increases. Because the collisions happen at more or less the same rate on every side of the <span><strong>box</strong></span>, the net balance of forces is also maintained and the <span><strong>cube</strong></span> doesn’t move, regardless of how big or small the overall <span><strong>pressure</strong></span> is.</p>
<p>This is exactly what happens in the Earth’s atmosphere – everything is constantly squeezed by relatively high pressure caused by the barrage of countless air particles. That pressure is typically balanced either by an object’s material, which resists compression like a spring, or by the air itself that fills the insides of the object. When that inner air is removed, the seemingly innocuous atmospheric pressure <a href="https://www.youtube.com/watch?v=0N17tEW_WEU&amp;t=165s">reveals its might</a>.</p>
<p>The underlying particle nature also shows us that pressure is never negative. Without any particle collisions, we reach the lowest possible pressure of zero. Beyond that, any impacts on the surface of an object create some amount of positive pressure.</p>
<p>In the demonstrations we’ve seen so far, the <em>balanced</em> number of collisions on each wall was very important for keeping the objects steady. Unsurprisingly, more interesting things happen when this harmony isn’t maintained. Let’s first investigate this scenario using the <span><strong>tennis balls</strong></span>. In the demonstration below, the slider controls if it’s the <span><strong>left side or the right side</strong></span> that’s shooting more balls:</p>


<p>As you can see, if one of the sides has a <a href="#" onclick="balls2_f0();return false;">higher number of collisions</a>, the forces acting on the <span><strong>box</strong></span> are no longer balanced and the <span><strong>box</strong></span> starts to move.</p>
<p>The very same situation happens in air, which you can witness in the simulation below. Notice that the volume in which the <span><strong>tiny cube</strong></span> exists has more particles on one side than the other. Observe what happens to <span><strong>cube</strong></span> once you let <span><strong>the time run</strong></span> using the slider:</p>


<p>The higher number of particle collisions on one side of the <span><strong>cube</strong></span> creates higher <span><strong>pressure forces</strong></span> on that wall. The uneven forces end up pushing the <span><strong>block</strong></span> to the side. In this demonstration, the pressure re-balances after a while and the <span><strong>cube</strong></span> stops moving.</p>
<p>Intuitively, the air exerts an imbalanced net force on the <span><strong>cube</strong></span> only when different parts of that <span><strong>object</strong></span> experience different pressure – it’s the <em>spatial variation</em> in pressure that creates an acting net force. When the <em>difference</em> in pressure between any two points increases, the net force acting on the object also grows.</p>
<p>It’s easy to see that a larger number of collisions on the left side of an object would start to exert a net force pushing that object to the right, but, perhaps surprisingly, the same rules apply to any chunk of air itself.</p>
<p>In the demonstration below, I once again made one half of the test volume contain more particles than the other half. As you <span><strong>unpause</strong></span> the demonstration, observe the average velocity of molecules in the  <span><strong>marked out</strong></span> section of air:</p>



<p>The particles on the more occupied side can easily travel to the less crowded side, because there are fewer particles there to collide with and bounce back from. Additionally, each particle in the less populated section is more likely to hit a particle in the more populated section, which will typically cause that particle from the desolate side to bounce back where it came from.</p>
<p>The particles end up, on average, traveling from the area of high pressure to the area of lower pressure. Even though we don’t have any clean borders between different sections, we can still see the bulk of particles getting accelerated towards the less dense section.</p>
<p>Once again, the initial pressure differences in the test volume dissipate after a while. On their own, these freely suspended pressure variations quickly disappear, but we will soon see how, with the aid of airflow, these areas of different pressure can be sustained indefinitely.</p>
<p>In the examples we’ve been playing with, the notion of increased pressure came from an increased number of collisions, which in turn came from an increased number of particles in the area. This shows that, all other things being equal, pressure is tied to the local density of the air, which was very easy to perceive in an increased concentration of molecules.</p>
<p>However, the pressure can also grow due to increased average speed of the particles, which in turn comes with increased temperature. As particles get faster, each collision gets more impactful and it pushes on an object or other particles a bit harder, causing the overall pressure to also increase. In the demonstration below, we can simulate this with <span><strong>tennis balls</strong></span> hitting the <span><strong>cardboard box</strong></span> at the same rate, but with <span><strong>different speeds</strong></span>, which you can control with the slider:</p>


<p>As we make the <span><strong>balls</strong></span> on one side of the <span><strong>box</strong></span> <a href="#" onclick="balls3_f0();return false;">faster</a>, their impacts also become stronger and the <span><strong>package</strong></span> starts moving to the right, even though the <em>number</em> of collisions per second is equal on both sides.</p>
<p>The important point from these discussions is that air pressure exerts force on everything inside it, be it a solid object or any parcel of air. It’s a little unintuitive that the air itself both exerts the pressure and it also “feels” the pressure, but it’s all just a consequence of very rapid motions of particles and the collisions between them happening at an enormous rate.</p>
<p>Recall that even in small volumes of air there are billions of billions of particles, and each particle experiences roughly ten billion collisions per second. What we’ve simulated at a micro scale and in slow motion as countable, individual interactions, very quickly smooths out into a uniform and uninterrupted notion of force-exerting pressure.</p>
<p>This fact lets us abandon the molecules and their collisions yet again. It’s not a big loss, since counting the number and intensity of collisions was never convenient in the first place, but we can now investigate some other ways of visualizing pressure in a region of air.</p>
<h2 id="visualizing-pressure">Visualizing Pressure<a href="https://ciechanow.ski/airfoil/#visualizing-pressure" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>As we’ve seen in the particle simulations, pressure can vary from place to place. One of the most convenient ways to express this variation is to use colors of different intensities. Let’s see how that simple approach could work here. In the demonstration below, the dashed circles represent regions of high <span></span> and low <span></span> pressure – you can drag them around to change their position:</p>

<p>This map of pressure is colored with <strong><span data-color0="E3BFBB" data-color1="E5432E">varying shades of red</span></strong> as indicated by the scale below – the <span><strong>redder</strong></span> the color, the <span><strong>higher</strong></span> the pressure. The small triangle <span>▼</span> in the middle of the scale indicates the location of the  base, <em>static</em> pressure present in the atmosphere.</p>
<p>In this simulation we have complete control over where the different locations of <span><strong>lower</strong></span>  and <span><strong>higher</strong></span> pressure are. To make things more interesting, each draggable pressure circle has a different strength and range. You can infer this variation from color changes around these points.</p>
<p>Let’s put an <span><strong>airfoil</strong></span> in this area to see how it’s affected by the pressure of the surrounding air. The <span><strong>arrows</strong></span> seen below symbolize the force that pressure exerts on the surface of the <span><strong>airfoil</strong></span> at that location. They’re the exact same <span><strong>arrows</strong></span> that we’ve seen acting on the walls of the tiny yellow cube, here we just see them at a larger scale:</p>

<p>As you move around the locations of <span><strong>lower</strong></span>  and <span><strong>higher</strong></span> pressure, the <span><strong>forces</strong></span> acting on the surface of the <span><strong>airfoil</strong></span> also change, matching what we’ve seen with little cubes bombarded by air particles. The static pressure always exerts some base load, but in the areas of <span><strong>higher</strong></span> pressure the <span><strong>surface forces</strong></span> are higher, and in the areas of <span><strong>lower</strong></span> pressure the <span><strong>surface forces</strong></span> are lower than these base forces.</p>
<p>Note that you can also move the pressure circles into the <span><strong>airfoil</strong></span>, but it only serves as a convenience to let you customize the shape of the air pressure field <em>around</em> that body – we don’t particularly care about the pressure inside the solid itself.</p>
<p>When we tally up all the <span><strong>pressure forces</strong></span> acting on each piece of the <span><strong>airfoil’s</strong></span> surface, we end up with the <span><strong>net force</strong></span> acting on that object. In the demonstration below, I’m showing it with the <span><strong>big arrow</strong></span> at the center of the <span><strong>airfoil</strong></span>:</p>

<p>By changing the distribution of pressure around the <span><strong>airfoil</strong></span>, we can affect the <span><strong>total force</strong></span> that this object feels.</p>
<p>The reddish plots we’ve been looking at are correct, but a little inconvenient. Recall that <span><strong>final net force</strong></span> on the object depends only on the <em>differences</em> of pressure – when we uniformly increased the number of collisions on the walls of the tiny cube, it steadily remained in place.</p>
<p>This means that the static background pressure doesn’t matter for the <span><strong>cumulative forces</strong></span> acting on an object. It’s only the differences relative to that static pressure that affect the overall balance. This lets us overhaul our visual representation of pressure – we can use no color where the pressure has the static value, use <span><strong>blue color</strong></span> when the pressure is <span><strong>lower</strong></span> than the static pressure, and use <span><strong>red color</strong></span> when the pressure is <span><strong>higher</strong></span> than the static pressure:</p>

<p>This is the <em>exact</em> same distribution of pressure that we’ve just seen. All the pressure demos in this section are connected, and here we simply changed the reference point against which we present the pressure variation.</p>
<p>If we then throw in the <span><strong>airfoil</strong></span> back into the mix we can now also adjust the <span><strong>arrows</strong></span> representing the <span><strong>forces</strong></span> that the pressure exerts on the surface of that <span><strong>object</strong></span>:</p>

<p>The areas of <span><strong>higher</strong></span> pressure still seem to push on the surface of the <span><strong>airfoil</strong></span>, but the areas of <span><strong>lower</strong></span> pressure now seem to <em>pull</em> it. However, I need to emphasize once more that pressure <em>always</em> pushes on the object, and we can only talk about a pulling force when we discard that uniform, pushing contribution coming from the static pressure. In those “pulling” areas the pressure is still pushing, it just pushes less intensely.</p>
<p>I will also use the convenient terms of <span><strong>positive</strong></span> and <span><strong>negative</strong></span> pressure, but remember that this refers to their difference from the static pressure. The phrase “pressure lower than static pressure” is a mouthful, so the expression “negative pressure” is very handy, even when it hides the fact that pressure is always positive.</p>
<p>While the color variations used here show the true nature of the smoothly varying pressure changes, they make it a little hard to see how quickly those changes happen. To fix this, I’ll also draw the <a href="https://en.wikipedia.org/wiki/Contour_line"><em>contour lines</em></a> that join the locations of the same pressure – they’re very similar to lines of the same altitude you may have seen on maps:</p>

<p>Every point on one of those contour lines has the same value of pressure, and each subsequent line is drawn at the same increment of pressure – you can see this in the scale placed below the plot. This means that the closer the lines are together, the more quickly the pressure changes in that area.</p>
<p>The mathematical concept that describes the direction and rapidness of these changes is known as a <a href="https://en.wikipedia.org/wiki/Gradient"><em>gradient</em></a>. Informally, gradient describes how some property changes from one point to another, and, thankfully, this notion tracks closely with how this word is used in graphic design to describe smooth color changes. Wherever you see a <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E"> color gradient</span></strong> , this also implies that there is a <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">pressure gradient</span></strong>  – the pressure changes from place to place.</p>
<p>This spatial variation is particularly important for the motion of air. Recall that the air pressure differences don’t just exert forces on solid objects, but also on the air itself – any small parcel of air is subject to the same whims of pressure forces.</p>
<p>Those spatial variations in pressure end up pushing the air around, changing its velocity. Let’s see this in action using the little leaf-like <strong>markers</strong> that are moved around by pressure differences. In the demonstration below, I’m steadily releasing the <strong>markers</strong> from the left side –&nbsp;notice how their trajectory changes when you modify the pressure field:</p>


<p>You may still find it a little difficult to grasp how pressure differences affect the motion of a parcel of air. Luckily, we can draw parallels between the contour lines of pressure seen on these pressure maps and the contour lines of elevation seen on traditional maps. This lets us build a little pressure-landscape analogy.</p>
<p>In the demonstration below, the very same distribution of pressure is expressed as a mountainy landscape. <span><strong>Positive</strong></span> pressure lifts the ground above the base level and <span><strong>negative</strong></span> pressure depresses it below the base level. A parcel of air moves like a marble that loses speed when climbing uphill and accelerates when rolling downhill. You can drag the demo around to change the viewing angle:</p>


<p>Notice that when the pressure changes more rapidly and the contour lines are closer, the steepness of the corresponding hill or valley also increases, and so do the forces acting on a parcel of air. If the pressure is increasing by a large amount, it may even make the <strong>marker</strong> go back. This landscape analogy also shows that the static pressure doesn’t matter for the motion of air parcels, as any changes in static pressure would just lift all the areas by the same amount without changing their steepness.</p>
<p>When watching these air parcels move around, you may have noticed that things were a little bit off. For example, it’s possible for air parcels coming from different directions to arrive at the same location, and then continue to travel in different directions. You can see an example of that on the left side of the demonstration below, with the slider letting you <span><strong>scrub back and forth in time</strong></span>:</p>


<p>Recall that the markers always follow the local velocity of air, so the motion seen in the left part implies that the air at the <a href="#" onclick="parcels_crossing_f0();return false;">location of the meetup</a> of the <span><strong>two</strong></span> <span><strong>markers</strong></span>  has two different velocities at the same time, which is not realistic.</p>
<p>It’s worth pointing out that the situation seen on right side, where <span><strong>one marker</strong></span> merely <a href="#" onclick="parcels_crossing_f1();return false;">intersects</a> the <strong><span data-color0="F0D9C0" data-color1="E09F56">historical path</span></strong> of the <span><strong>other</strong></span>, <em>can</em> be realistic, as long as we’re dealing with an unsteady flow, where the <span><strong>velocity</strong></span> of the air at the crossing location has changed since the <span><strong>first marker</strong></span> was there. For steady conditions in which no changes occur over time, the scenario seen on the right is also not physically correct.</p>
<p>We’ll look at some unsteady flows later in the article, but for now we’re interested in steady conditions so the crossing paths of our <strong>markers</strong> indicate implausible velocities. Even more dubious result happen when we simulate the motion of these <strong>markers</strong> with an <span><strong>airfoil</strong></span> present in the flow:</p>


<p>For most distributions of pressure, the air markers will flow right through the <span><strong>body</strong></span>. This is clearly wrong! The demonstrations we’ve seen so far correctly represent what would happen to individual air parcels and bodies placed in these pressure fields, but those pressure fields themselves were completely made up and didn’t correspond to any physical reality. Our mistake was that we completely ignored any interactions between the pressure of the air and the <em>motion</em> of that air.</p>
<p>The flow of air, the pressure of air, and the shape of the objects placed in that air are all tied together – for a given incoming flow speed and the shape of the object, we can’t just arbitrarily arrange the pressure field like we did in our artificial demonstrations. Instead, that pressure field will arise on its own.</p>
<p>Let’s see a <em>real</em> distribution of pressure around this airfoil and witness how it affects the motion of air parcels around it:</p>

<p>The behavior of air parcels now matches our intuitive expectations – the <strong>markers</strong> don’t go through the body, and in these steady conditions they also don’t cross paths.</p>
<p>We’re now one step closer to understanding how the flow of air takes its shape to move around an <span><strong>airfoil</strong></span> – it’s the pressure differences that cause the flow to change its direction and speed.</p>
<p>The pressure field we’ve just seen clearly works – regions of <span><strong>lower</strong></span> and <span><strong>higher</strong></span> pressure guide the air around the airfoil. However, it’s still unclear how these areas emerged in the first place. Let’s try to follow nature’s path to see how this pressure distribution is created and sustained in a flow.</p>
<h2 id="airfoil-flow">Airfoil Flow<a href="https://ciechanow.ski/airfoil/#airfoil-flow" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>Before we start building the correct pressure field from scratch, let’s first establish two guiding principles that the flow around any object has to follow.</p>
<p>Firstly, the air can’t penetrate solid walls. A valid pressure field should either completely stop the flow at the surface of the object, or redirect that flow to make it travel in the direction perpendicular to the walls. This means that the markers that we track can never get inside the object.</p>
<p>Secondly, we also have the restrictions on the relative motion of the markers. For now we’ll only be interested in steady conditions, which means that the markers can’t cross their paths – we expect the ghostly historical trails to never intersect.</p>
<p>Let’s first focus on the pressure field in front of the airfoil. In the demonstration below, I created an <em>artificial</em> pressure field in that frontal region, you can control it using the slider:</p>


<p>It should quickly become clear that to prevent the approaching air from getting into the object, the pressure in the frontal region has to be <span><strong>positive</strong></span>, so that it pushes the incoming air away.</p>
<p>If that <span><strong>positive pressure</strong></span> in front is <a href="#" onclick="symmetric_airfoil_fvm4_f0();return false;">too low</a> the air can still erroneously flow through the object. If that pressure is <a href="#" onclick="symmetric_airfoil_fvm4_f1();return false;">too high</a>, the air parcels arriving at the airfoil will turn back and incorrectly cross paths with the incoming air. When the pressure is <a href="#" onclick="symmetric_airfoil_fvm4_f2();return false;">just right</a>, the air parcels don’t go through the wall, and, at least in front of the object, they also don’t cross their paths.</p>
<p>The faster the incoming flow, the higher the pushing force required to slow down and redirect the incoming air. In the demonstration below, you can also control the <span><strong>speed</strong></span> of that incoming air using the second slider:</p>



<p>While for <a href="#" onclick="symmetric_airfoil_fvm5_f0();return false;">slow flows</a>, only a small amount of <span><strong>positive pressure</strong></span>  is <a href="#" onclick="symmetric_airfoil_fvm5_f1();return false;">enough</a> to stop the incoming air, for <a href="#" onclick="symmetric_airfoil_fvm5_f2();return false;">fast flows</a>, the pressure in front of the airfoil has to become <a href="#" onclick="symmetric_airfoil_fvm5_f3();return false;">much higher</a>.</p>
<p>The pressure needed to stop air at a given velocity is known as <a href="https://en.wikipedia.org/wiki/Stagnation_pressure"><em>stagnation pressure</em></a> and it’s proportional to the <em>square</em> of that velocity – twice as high speed requires four times larger pressure.  Naturally, when there is <a href="#" onclick="symmetric_airfoil_fvm5_f4();return false;">no flow</a>, no pressure is required as the air no longer tries to flow through the object.</p>
<p>In the previous two demonstrations, we manually adjusted the pressure to get the correct result, but in nature this process happens on its own – it’s the flow <em>itself</em> that creates this region of increased pressure in front of the object.</p>
<p>As the incoming parcels of air arrive at the surface of the airfoil, they can’t continue going forward, but air parcels from further up ahead continuously want to keep flowing into this region. This compresses the air close to the object, which causes the pressure in front to increase, which then helps to slow down the incoming flow.</p>
<p>This mechanism is self-balancing – if the pressure is too low to push away the incoming air parcels, the air parcels will compact the existing air more, causing an increase in pressure. If the pressure is too high, it will easily push the incoming air away, which relieves the frontal area, causing the pressure to decrease. Any fluctuations quickly settle to an equilibrium that balances the pressure in the entire frontal region.</p>
<p>Let’s look at the distribution of the <span><strong>positive</strong></span> frontal pressure once more:</p>

<p>Notice that the <span><strong>positive pressure</strong></span> isn’t limited to just the close vicinity of the airfoil, but it spreads out much further ahead to gradually reach the value of the static pressure, far away from the airfoil itself.</p>
<p>All in all, we have a large area of increasing pressure that starts far away from the body and ends at its surface. Those pressure differences create a pressure “hill” that not only gradually slows the incoming air down, but it also redirects that air to flow around the object.</p>
<p>It seems that with our frontal pressure field we’ve easily completed our goal of preventing the air from flowing through the walls of the body. However, our second guideline of non-crossing marker paths is still not fulfilled – this condition is broken above and below the airfoil.</p>
<p>Let’s first try to rectify this manually. In the demonstration below, you can control the pressure in these two regions using the slider:</p>


<p>While <span><strong>positive</strong></span> values of pressure in those zones make the <a href="#" onclick="symmetric_airfoil_fvm6_f0();return false;">problem worse</a>, <span><strong>negative</strong></span> values get us <a href="#" onclick="symmetric_airfoil_fvm6_f1();return false;">much closer</a> to the expected behavior – in the top and bottom areas the <strong>markers</strong> no longer veer off into different directions. However, that pressure can’t be <a href="#" onclick="symmetric_airfoil_fvm6_f2();return false;"><em>too</em> low</a>, otherwise it will pull the <strong>markers</strong> back into the body.</p>
<p>In real flow, these regions of <span><strong>lower</strong></span> pressure arise on their own, but the explanation for this phenomenon is a little less straightforward than what I’ve described for the area of <span><strong>positive</strong></span> pressure in the frontal region. We can get <em>some</em>, albeit a bit hand-wavy,  understanding by observing what happens to the air <strong>markers</strong> when those <span><strong>negative</strong></span> regions are <a href="#" onclick="symmetric_airfoil_fvm6_f3();return false;">missing</a>.</p>
<p>In that scenario, the incoming air parcels no longer reach those areas above and below the airfoil, causing some local depletion of air that has since left those zones. This decreases the pressure in those regions, and that lower pressure attracts the surrounding air to flow into those less occupied spaces.</p>
<p>If that lower pressure is <em>too</em> negative, more air will come in and the pressure will rise. If the pressure is not negative enough, those region will get depleted again. Once again, it’s the flow itself that creates the balancing system – without the flow no pressure differences would arise.</p>
<p>As we’ll see later on, in more extreme scenarios that negative pressure can alter the flow more dramatically, and the regions of “missing” air get filled through other means, but for now let’s close things up by tweaking the pressure in the rear part of the airfoil:</p>


<p>Some amount of <span><strong>positive</strong></span> pressure in the rear <a href="#" onclick="symmetric_airfoil_fvm7_f0();return false;">prevents</a> the air parcels from smashing into each other after leaving the airfoil. Intuitively, this pressure arises naturally from the flow, because as the air slides off from the ends of the top and bottom sides, it all arrives into the same region, creating some compression.</p>
<p>If that compressive pressure in the rear is too low, more air will manage to get in, which will further increase the pressure. If that pressure is too high, it will push the incoming air away, which depletes the area and the pressure decreases. The system balances itself yet again.</p>
<p>The quite informal description of these balances that I’ve presented can be formalized mathematically using the <a href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_equations"><em>Navier–Stokes equations</em></a>. These equations describe the motion of liquids and gasses, collectively known as <a href="https://en.wikipedia.org/wiki/Fluid"><em>fluids</em></a>, subject to various forces like gravity, or, most importantly for us, pressure.</p>
<p>Navier–Stokes equations are <a href="https://en.wikipedia.org/wiki/Navier%E2%80%93Stokes_existence_and_smoothness"><em>notoriously difficult</em></a> to solve analytically, but a lot of insight about the behavior of fluids can be gained with computer simulations with various degrees of complexity.</p>
<p>In this article, I’m also employing simulations to investigate the flow of air around objects. However, the computer models used here are quite simplified and they don’t reflect the <em>full</em> richness of physics involved in the motion of air. These <em>slow-motion</em> demonstrations are intended to present the broad strokes of the delicate interaction between the air and the airfoil, but I would advise against relying on them when building an airworthy airplane.</p>
<p>With all of these caveats in place, let’s get back to the pressure distribution around a symmetric airfoil. We’re done recreating the nature-made pressure field, but there is one small aspect that we haven’t yet accounted for.</p>
<p>For our experiments, I kept the pressure steady in time so that we could focus on its general outlines. In practice, a pressure field imposed by a fast flow around any object will experience some degree of instability, which you can see in the demonstration below. You can once more drop the markers at any location to track the flow in the area:</p>

<p>As the pressure builds up on one side, it redirects the flow, which changes the pressure again. The pressure ends up oscillating back and forth like a swing. The pressure distribution and the flow direction are once again at the mercy of their mutual balance, one affecting the other. We’ll soon see some other examples of these unstable behaviors.</p>
<p>As we’ve just seen, the variation in pressure doesn’t just happen in the close vicinity of the airfoil, but it stretches quite far away from the body itself. This means that the velocity of the flow is also affected quite far away from the shape.</p>
<p>However, when it comes to the forces exerted on the airfoil, it’s only the pressure right at the surface of the airfoil that matters. Let’s bring back the two tools we’ve used before: <span><strong>surface arrows</strong></span> that show how the air pushes or “pulls” on the airfoil, and the <span><strong>net force</strong></span> arrow that tallies up the net results of <span><strong>these forces</strong></span>:</p>

<p>As the pressure field fluctuates, the resulting <span><strong>net force</strong></span> also moves around. Let’s decompose this force into two different components, one  <span><strong>perpendicular</strong></span> to the flow, and one <span><strong>parallel</strong></span> to it:</p>

<p>The force acting in the direction perpendicular to the flow is known as <span><strong>lift</strong></span>, and the one acting in the direction of the flow is known as <span><strong>pressure drag</strong></span>, or <a href="https://en.wikipedia.org/wiki/Parasitic_drag#Form_drag"><em>form drag</em></a>. As the name implies, this component of drag is created by the distribution of pressure around the shape.</p>
<p>For this airfoil, the <span><strong>pressure drag</strong></span> is very tiny. While airfoils are specifically designed to minimize the overall drag, most of that force hindering their motion comes from another source – we’ll discuss it soon enough.</p>
<p>Notice that as this flow fluctuates, the <span><strong>lift</strong></span> force jumps around, but averaged over time the upward and downward swings of that <span><strong>force</strong></span> end up balancing each other. This airfoil in <em>this</em> configuration doesn’t generate any continuous lift.</p>
<p>This shouldn’t come as a surprise since this situation is completely symmetric, so the pressure forces on the upper and lower sides of the airfoil are, on average, completely balanced. However, there is an easy way to disturb that symmetry. In the demonstration below, we’re once again meeting the plain, symmetric airfoil, but this time we can gently <span><strong>tilt</strong></span> it using the slider:</p>


<p>The <span><strong>slider</strong></span> controls the so-called <a href="https://en.wikipedia.org/wiki/Angle_of_attack"><em>angle of attack</em></a>, which is spanned between some reference line on the body, like the one joining the front and back, and the direction of the incoming flow. I’m showing this angle right in the middle of the airfoil.</p>
<p>As we <a href="#" onclick="symmetric_airfoil_fvm20_f0();return false;">change</a> the <span><strong>angle of attack</strong></span>, the shape that the airflow “sees” is no longer symmetrical relative to the incoming direction of that flow. The velocity and pressure fields adapt in their mutual push and pull to form a new, asymmetric distribution. Notice that the stagnation point of <span><strong>high pressure</strong></span> has moved around, and the little markers that indicate the motion of air now travel on very different paths below and above and below the airfoil.</p>
<p>If we then put the <span><strong>pressure arrows</strong></span> back in, we can tally them all up to get the resulting <span><strong>lift</strong></span> and <span><strong>pressure drag</strong></span>. When compared to the previous simulation, I’m scaling down all the arrows to make them fit in the bounds of the demonstration:</p>


<p>When this symmetric airfoil is <a href="#" onclick="symmetric_airfoil_fvm21_f0();return false;">tilted up</a>, the asymmetric pressure distribution generates a <span><strong>lift force</strong></span> that pushes the object up. Conversely, for a <a href="#" onclick="symmetric_airfoil_fvm21_f1();return false;">downward tilted airfoil</a>, the pressure forces <span><strong>push</strong></span> the airfoil down.</p>
<p>Naturally, we’re typically interested in upward-pointing forces, and when the <span><strong>lift</strong></span> generated by the wings is equal to the weight of the plane, the plane will stay in the air without raising or falling to the ground – we’re finally flying.</p>
<p>Let’s plot the dependence between the <span><strong>lifting force</strong></span> and the <span><strong>angle of attack</strong></span> of an airfoil – you can see it in the right side of the demonstration below. Note that this plot presents time-averaged and <em>settled</em> values, so you may have to wait a little for the flow to normalize and the <span><strong>lift</strong></span> to start oscillating around the expected value:</p>


<p>Clearly, as the <span><strong>angle of attack</strong></span> increases, so does the generated <span><strong>lift</strong></span>. The same thing happens on the other end of the spectrum, where a more negative  <span><strong>angle of attack</strong></span> creates more negative lift. Note that for this symmetric airfoil the positive and negative sides of the diagram are just mirror images of each other, so let’s focus only on positive  <span><strong>angles of attack</strong></span>.</p>
<p>One could naively hope that we could keep increasing the  <span><strong>angle of attack</strong></span> to generate more and more <span><strong>lift</strong></span>. Let’s see what happens in practice:</p>


<p>Initially, the <span><strong>lift</strong></span> force indeed keeps increasing with the <span><strong>angle of attack</strong></span>, but at some point <a href="#" onclick="symmetric_airfoil_fvm23_f0();return false;">it plateaus</a>. Once that <em>critical</em> angle of attack is surpassed, the <span><strong>lift</strong></span> force <a href="#" onclick="symmetric_airfoil_fvm23_f1();return false;">starts to fall</a> after the flow <a href="#" onclick="symmetric_airfoil_fvm23_f2();return false;">fully develops</a>.</p>
<p>What we’re witnessing here is known as a <a href="https://en.wikipedia.org/wiki/Stall_(fluid_dynamics)"><em>stall</em></a>. The onset of a stall imposes limits on how much <span><strong>lift</strong></span> the wings of an airplane can generate from merely increasing the angle of attack.</p>
<p>Notice that when the stall happens, the pressure distribution on the upper part of the airfoil becomes very erratic – it’s not only the surface <span><strong>pressure arrows</strong></span> that are changing rapidly, but the whole pressure field in that area is very disturbed.</p>
<p>Let’s bring in the velocity arrows and markers to get a better feel on what’s going on in that region:</p>


<p>At high angles of attack, the flow above the upper part of the airfoil becomes very complicated. If you <span>click</span><span>tap</span> in that region to drop a few markers, you’ll notice that the air is trapped in various swirling eddies that are eventually shed to fly away with rest of the flow.</p>
<p>We’re witnessing <a href="https://en.wikipedia.org/wiki/Flow_separation"><em>flow separation</em></a>, where the main part of the flow detaches from the surface and doesn’t follow its shape anymore. The interactions in the complicated flow right above the airfoil affect the pressure field, which then <em>decreases</em> <span><strong>lift</strong></span>.</p>
<p>There is a lot going on there, but to understand how these effects arise we have to talk about a property that affects the flow of every fluid: viscosity.</p>
<h2 id="viscosity">Viscosity<a href="https://ciechanow.ski/airfoil/#viscosity" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>You might have heard the term <a href="https://en.wikipedia.org/wiki/Viscosity"><em>viscosity</em></a> used to describe “thickness” of different liquids, with a classic example that contrasts the slowness of the flow of honey to the rapidness of the flow of water.</p>
<p>Viscosity is also a property of gasses like air, but before I describe this concept more formally, we’ll first build an intuitive understanding of what viscosity is and what it does to the flow of different fluids.</p>
<p>In the demonstration below, the fluid flows in from the left side, but note that the flow in the top half is faster than the flow in the bottom half, which is reflected by the different lengths of the arrows. Dragging the slider to the left decreases the <span><strong>viscosity</strong></span> of the fluid, and dragging the slider to the right increases <span><strong>viscosity</strong></span>:</p>


<p>While we can see some changes to the arrows as we move the slider around, you probably agree that, for this flow, the arrow-based visualization isn’t very rewarding. Let’s add the color-based <strong><span>visualization of speed</span></strong> distribution in this flow:</p>


<p>We can now see how <span><strong>viscosity</strong></span> blends the speed variation between different sections of the fluid. For highly <a href="#" onclick="fdm2_f0();return false;">viscous fluids</a>, this mixing behavior spreads very easily and the initially distinct velocities of the two layers average out quite rapidly.</p>
<p>At <a href="#" onclick="fdm2_f1();return false;">lower viscosity</a> these two layers with different speeds remain quite separated. If you make the viscosity <a href="#" onclick="fdm2_f2();return false;">low enough</a>, you may even notice that, after a while, the flow develops some interesting wave-like phenomena – we’ll get back to these soon.</p>
<p>All this mixing behavior may remind you of a <a href="https://en.wikipedia.org/wiki/Diffusion"><em>diffusion</em></a> process, where some quantity, like temperature or concentration, evens out over time. Let’s see some basic diffusion in action. In the simulation below, I filled half of the bottle with with <span><strong>red-dyed water</strong></span>, while the other half is filled with <span><strong>blue-dyed water</strong></span>. The slider lets you control the <span><strong>speed of time</strong></span>:</p>


<p>As <a href="#" onclick="bottle_f0();return false;">time passes</a>, the sharp difference between the two layer blends more and more to eventually completely disappear. Clearly, there is some similarity between the diffusion of differently <span><strong>colored</strong></span> <span><strong>dyes</strong></span> and the averaging of velocity that we’ve seen in the earlier example.</p>
<p>In our flow demonstrations, <span><strong>viscosity</strong></span> seemed to have controlled the diffusion of velocity. To define it more precisely, <span><strong>viscosity</strong></span> controls the diffusion of <a href="https://en.wikipedia.org/wiki/Momentum"><em>momentum</em></a>, which is a product of velocity <em>and</em> mass. The simplified fluids we’re looking at have more or less constant density, so each equally-sized parcel of those fluids has the same mass. Therefore, if it makes things easier for you, wherever you see the word momentum you can think of velocity, but in more complex scenarios these differences can matter.</p>
<p>Let me bring in the previous flow simulation one more time:</p>


<p>You’ve probably noticed that, as the flow moves to the right, the size of this blended region increases. When the regions of fluid with different momentums meet for the first time, they barely have any time to average out, and the blending is minimal. As time passes, these regions of fluid get to average out more, similarly to how two different layers of dyed water mix more over time.</p>
<p>However, as time is passing, these parcels also <em>keep moving</em>, and that stronger blending happens further to the right. The downstream regions had more time to mix and average out, so the visible thickness of the blended region on the right side is also larger.</p>
<p>With higher <span><strong>viscosity</strong></span>, the size of blended region grows much more quickly, which lets us be more precise about our working definition – <span><strong>viscosity</strong></span> controls the <em>rate</em> of the diffusion of momentum.</p>
<p>So far we’ve only observed flows with nicely separated horizontal layers, but <span><strong>viscosity</strong></span> averages momentum between <em>any</em> two regions of fluids. In the demonstration below, you can witness how <span><strong>viscosity</strong></span> affects a swirly motion of fluid in a <a href="https://en.wikipedia.org/wiki/Vortex"><em>vortex</em></a>:</p>


<p>Notice that with <a href="#" onclick="fdm4_f0();return false;">high viscosity</a> any differences in velocity are very quickly diluted out into nothing, but with <a href="#" onclick="fdm4_f1();return false;">low viscosity</a> the revolving motion can survive for quite a while.</p>
<p><span><strong>Viscosity</strong></span> has a damping or smoothing effect that makes it much harder to sustain any large variation in a velocity field. Let’s see how this affects the motion of objects in fluids of various viscosity. In the demonstration below, we’re tracking a velocity field close to a very <span><strong>thin plate</strong></span> put directly in the stream of an incoming fluid of adjustable <span><strong>viscosity</strong></span>:</p>


<p>With <a href="#" onclick="fdm5_f0();return false;">high viscosity</a>, there is a large region of slow down around the <span><strong>plate</strong></span> that regains its speed fairly quickly behind the object. At <a href="#" onclick="fdm5_f1();return false;">lower viscosity</a> that surrounding region is much smaller, but it extends much further behind the <span><strong>plate</strong></span>. For <a href="#" onclick="fdm5_f2();return false;">very low viscosity</a> we’re once again seeing some more unusual behavior that we’ll get back to in a minute.</p>
<p>From the dark colors we can easily see that right by the surface of the <span><strong>plate</strong></span> the fluid doesn’t move at all – it sticks to that surface. This velocity difference between the halted flow at the wall and the moving outer flow gets smoothed out over time by <span><strong>viscosity</strong></span>, similar to how it blended in the flow between two different layers of fluid.</p>
<p>As before, with higher <span><strong>viscosity</strong></span>, the velocity averaging process becomes more rapid, and the blended region becomes more widespread. This averaging effect doesn’t just alter the velocity of fluid, but it also affects the plate. In some sense, the <span><strong>viscosity</strong></span> also wants to make the velocity of the surface of the <span><strong>plate</strong></span> to be more like the velocity of the surrounding flow.</p>
<p>The viscosity makes the flow want to pull the <span><strong>plate</strong></span> with it, which creates a <a href="https://en.wikipedia.org/wiki/Shear_force"><em>shearing force</em></a> that tries to slide the surface of this object away. The net effect is that that viscosity creates additional drag known as <a href="https://en.wikipedia.org/wiki/Skin_friction_drag"><em>skin friction drag</em></a> that wants to slow down any object moving in it.</p>
<p>All of these effects underline why highly viscous fluids are “thick”. Viscosity not only quickly averages any local differences in velocity, which prevents those fluids from flowing easily, but it also represses motion of objects in those fluids – you’ve likely experienced the difficulty of moving a spoon through a jar of honey.</p>
<p>The flow of any fluid exhibits tiny, random disturbances. In fluids with high viscosity, these variations are very quickly dispersed, so their motion is rarely erratic. Fluids with low viscosity aren’t as effective at damping motion, and these disturbances can grow to create oscillatory patterns. We’ve seen glimpses of them in the previous simulations, but here is another example:</p>


<p>At lower viscosity the flow becomes <a href="#" onclick="fdm10_f0();return false;">quite wave-y</a>. Those <a href="https://en.wikipedia.org/wiki/Kelvin%E2%80%93Helmholtz_instability"><em>instabilities</em></a> happen at the border of regions of fluid with different velocities, like where the slow wake behind a plate is in contact with the fast external flow. In those regions, any tiny random intrusion of slower flow into the faster flow can get magnified and rolled over like a wave.</p>
<p>In our discussion of the motion of air around an airfoil, we’ve seen how the flow, the pressure field, and the shape of the body have effects on each other. These influences can be quite dynamic in nature, with distributions of velocity and pressure swinging back and forth in a never-ending fight for dominance.</p>
<p>In the demonstration below, we can see a more dramatic example of these battles, where, depending on the <span><strong>viscosity</strong></span>, the flow around a <span><strong>gray cube</strong></span> can take many different forms:</p>


<p>With very <a href="#" onclick="fdm9_f0();return false;">high viscosity</a>, the flow is completely stable, but as <a href="#" onclick="fdm9_f1();return false;">viscosity decreases</a>, it starts to regularly oscillate from side to side, <a href="https://en.wikipedia.org/wiki/Vortex_shedding"><em>shedding vortices</em></a> in the process. At <a href="#" onclick="fdm9_f2();return false;">very low viscosity</a>, the motion becomes even more erratic.</p>
<p>While I can’t easily simulate it here, with further decrease in viscosity, the flow <a href="https://www.youtube.com/watch?v=c8zKWaxohng">can develop</a> full featured <a href="https://en.wikipedia.org/wiki/Turbulence"><em>turbulence</em></a> in which highly irregular and chaotic mixing motions occur at different scales. Turbulent flow stands in contrast to <a href="https://en.wikipedia.org/wiki/Laminar_flow"><em>laminar flow</em></a>, in which neighboring areas of fluid move in an orderly way past each other without any varying fluctuations.</p>
<p>Although we’ve put most of our focus on <span><strong>viscosity</strong></span>, which is often denoted with the Greek letter <strong>μ</strong>, the general behavior of the flow also depends on its velocity <strong>u</strong>, density <strong>ρ</strong>, and the size <strong>L</strong> of the body or container involved in the flow. These parameters are tied together by the <a href="https://en.wikipedia.org/wiki/Reynolds_number"><em>Reynolds number</em></a> <strong>Re</strong>:</p>
<p>
Re = <span>
    <span>ρ · u · L</span>
    <span>/</span>
    <span>μ</span> 
</span>
</p>
<p>Flows with the same Reynolds numbers exhibit similar behavior, which means that if we make the obstacle size <strong>L</strong> twice as large and we halve the speed of the flow <strong>u</strong>, the Reynolds number won’t change and neither will the characteristics of the flow – it will exhibit the same smooth or oscillatory motion.</p>
<p>The Reynolds number also “predicts” the onset of turbulence. When we increase the speed of the flow <strong>u</strong>, or decrease the viscosity <strong>μ</strong>, the Reynolds number rises. When it reaches a high enough value, turbulence is likely to occur.</p>
<p>Let’s quantify the difference in viscosity between different fluids. The precise values aren’t that important to us, but to briefly be a bit more formal, viscosity is expressed in units of pascal-seconds, or <strong>Pa·s</strong>. To let us use more manageable numbers, the following table uses millipascal-seconds, or <strong>mPa·s</strong>:</p>
<table>
<tbody><tr><td>honey</td><td>~10000 <span>mPa·s</span></td></tr>
<tr><td>olive oil</td><td>~100 <span>mPa·s</span></td></tr>
<tr><td>water</td><td>1.0 <span>mPa·s</span></td></tr>
<tr><td>air</td><td>0.018 <span>mPa·s</span></td></tr>
</tbody></table>
<p>These values are measured at <span>68 °F</span><span>20 °C</span>, but many fluids like oil get much less viscous with increased temperature. As expected, honey is significantly more viscous than water. Compared to water, the viscosity of air is around 50 times less still, but even a very low viscosity has effects on flow and its interaction with solid walls.</p>
<p>To understand how viscosity arises in gasses like air, we have to once more get back to the world of particles. So far we’ve been watching them from a distance, with individual collisions barely perceptible in the moving swarm. This time we’re going take a closer look at these interactions.</p>
<p>In the demonstration below, you can experience a simplified simulation of <span><strong>two</strong></span> <span><strong>molecules</strong></span> colliding in space. Each molecule represents nitrogen or oxygen – these two elements constitute the vast majority of air, and, in normal conditions, each one consists of two atoms.</p>
<p>You can drag the <span><strong>orange particle</strong></span> around, and once you let go I’ll automatically aim it so that it hits the <span><strong>blue particle</strong></span>. The speed of the <span><strong>orange molecule</strong></span> is four times larger than the speed of the <span><strong>blue one</strong></span>:</p>

<p>Notice that after the collision, it’s the <span><strong>orange molecule</strong></span> that’s slow, and it’s the <span><strong>blue one</strong></span> that’s fast. In this demonstration the two particles have the same mass and they collide straight on, so they simply end up trading velocities.</p>
<p>More generally, particles of different masses that strike each other at different angles will exchange some amount of momentum. Recall that the heavier the particle, or the faster it moves, the higher its momentum.</p>
<p>Let’s see how this behavior ends up affecting the average velocities of larger quantities of molecules. In the <span><strong>paused</strong></span> demonstration below, air molecules are grouped into two different parts. The air in the <span><strong>blue region</strong></span> has higher velocity than the air in the <span><strong>red region</strong></span>, which you can see in the black arrows showing the <span><strong>average velocity</strong></span> in those regions. Notice what happens to <span><strong>these averages</strong></span> as you let <span><strong>time flow</strong></span> by dragging the slider:</p>



<p>At the very beginning, the <span><strong>average velocities</strong></span> in these <span><strong>two</strong></span> <span><strong>sections</strong></span> are visibly different, but they quickly even out when fast particles from the <span><strong>blue region</strong></span> flow into the slower <span><strong>red region</strong></span>, and the slower particles from the <span><strong>red region</strong></span> move into the faster <span><strong>blue region</strong></span>, balancing the initial velocity differences.</p>
<p>Moreover, some of the faster particles collide with slower particles in the <span><strong>red region</strong></span> and some of the slower particles collide with faster particles from <span><strong>above</strong></span>. The faster particles lose some of their higher momentum, while the slower particles gain some of the momentum. All of these effects “dilute” some of those average velocity differences between the two regions.</p>
<p>You may also remember that when we observed a flow of fluid around a flat plate, that fluid wasn’t moving at all right on the surface of that plate, because it was stuck to it. Let’s see how this behavior may arise on a microscopic scale.</p>
<p>In the demonstration below, we’re watching the familiar air particles right next to the <span><strong>surface of an object</strong></span>. To make tracking easier, I’m <span><strong>highlighting</strong></span> some of the particles in the vicinity of this <span><strong>surface</strong></span>:</p>


<p>When seen at a very large magnification, this <span><strong>surface</strong></span>, like almost all surfaces, isn’t perfectly smooth and has various peaks and valleys. The particles hitting these irregularities get bounced in more or less random directions. Some of the unlucky molecules can even get stuck for a while in these local crevices.</p>
<p>Close to the <span><strong>surface</strong></span>, the random collisions with peaks and valleys prevent the particles from making bulk progress in <em>any</em> direction. The average velocity of the air flow by the wall is more or less zero. Some molecular interactions between the particles and the <span><strong>surface</strong></span> can also prevent the fluid from moving.</p>
<p>This sticking behavior is known as the <a href="https://en.wikipedia.org/wiki/No-slip_condition"><em>no‑slip condition</em></a> and it holds true for most typical flows of fluids that we experience day to day. It’s only in extreme conditions of very rarified gasses in the upper parts of the atmosphere or flows in microscopic capillaries that can break this assumption.</p>
<p>Let’s leave the world of particles behind for the last time and see how these two effects play an important role of influencing the airflow close to the surface of any object.</p>
<h2 id="boundary-layer">Boundary Layer<a href="https://ciechanow.ski/airfoil/#boundary-layer" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>Let’s take another look at a <span><strong>thin plate</strong></span>  placed in the stream of incoming fluid:</p>

<p>From this broader perspective, it’s hard to see how the flow interacts with the surface of that <span><strong>plate</strong></span>, because the effects of viscosity are limited to the region close to that surface. Let’s focus our attention on the small area that I’ve outlined with a <span>dashed</span> line, right in the top part of the <span><strong>plate</strong></span>. Here it is zoomed up close:</p>

<p>We can once more see that, due to the no-slip condition, the velocity is zero at the <span><strong>wall</strong></span>, and then it <strong><span>grows to meet</span></strong> the velocity of the flow further away from the surface itself. What we’re seeing here is known as the <a href="https://en.wikipedia.org/wiki/Boundary_layer"><em>boundary layer</em></a>, which spans the region between the <span><strong>surface</strong></span> of the object and the “outer” flow, which is mostly unaffected by the presence of the object.</p>
<p>Because the velocity in the boundary layer smoothly approaches the speed of the outer flow, it doesn’t have a well-defined end point. One of the choices is to agree that the boundary layer ends where the speed reaches 99% of the speed of the surrounding flow far away from the <span><strong>solid surface</strong></span>. Let me visualize this boundary in the flow using a <span><strong>dashed line</strong></span>:</p>

<p>As we move with the flow along the distance of the plate, the viscosity keeps averaging out the velocity differences, making the boundary layer thicker – this is similar to what we’ve seen at larger scales with highly viscous flows around objects.</p>
<p>Let’s quantify the distribution of speed in the boundary layer a little more precisely. In the demonstration below, I put the velocity arrows back in. I then connected the ends of these arrows with a thin line to show a <em>profile</em> of velocity at that location along the <span><strong>surface</strong></span>:</p>

<p>Notice that, initially, the velocity close to the wall increases almost linearly, but then it smoothly tapers to reach the speed of the external flow. The velocity profile close to the surface has a certain steepness, which I’m showing with the <span><strong>white dotted line</strong></span>. This line determines the amount of skin friction drag at that spot – the closer to the <span><strong>surface</strong></span>, or more horizontal, the <span><strong>line</strong></span> is, the higher the skin drag.</p>
<p>As the differences in velocity become less severe, the force with which viscosity wants to drag the surface with the flow also decreases. In the conditions present in the demonstration, the skin friction drag decreases over distance.</p>
<p>At this point you hopefully have an intuitive grasp of how viscosity affects the flow close to the surface of the object. From our earlier discussion, you may also remember that pressure differences also affect how the flow behaves, with parcels of air slowing down when climbing the hill of <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">increasing pressure</span></strong> and accelerating on the downhill of the <strong><span data-color0="E5432E" data-color1="dddddd" data-color2="3F90CD">decreasing pressure</span></strong>.</p>
<p>In the boundary layer flows we played with, the pressure distribution was more or less constant in the investigated region. Let’s see how the flow changes when we vary that pressure.</p>
<p>In the top part of the demonstration below we see the exact same view of velocity we’ve experimented with so far. In the bottom part of the demonstration below you can see the pressure distribution in the boundary layer, which you can change using the slider below.</p>


<p>If the pressure <a href="#" onclick="boundary4_f0();return false;">decreases</a> in the direction of the flow in the boundary layer, we say that the pressure gradient is <em>favorable</em>. <strong><span data-color0="E5432E" data-color1="dddddd" data-color2="3F90CD">Favorable pressure gradient</span></strong> accelerates the air, and the boundary layer doesn’t grow as quickly, since the slowdown caused by viscosity is opposed by that acceleration.</p>
<p>When the pressure <a href="#" onclick="boundary4_f1();return false;">increases</a> in the direction of the flow, we say that the pressure gradient is <em>adverse</em>. <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">Adverse pressure gradient</span></strong> pushes <em>against</em> the direction of motion of the air. Far away from the <span><strong>surface</strong></span>, the air has enough momentum that the adverse pressure merely slows the flow down. However, close to the <span><strong>surface</strong></span>, the flow in the boundary layer was slow in the first place, so a pushing <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">adverse pressure gradient</span></strong> may even reverse the direction of the flow.</p>
<p>When the flow in the boundary layer gets reversed, we say that the boundary layer <em>separates</em>. This region of reversed flow can form a sort of wedge that can lift the rest of the flow away from the <span><strong>surface</strong></span>.</p>
<p>Let’s take a step back from the subtleties of boundary layers to see how what we’ve learned corresponds to behavior of a flow around an airfoil. Let me once more bring up the demonstration that brought us here in the first place:</p>


<p>As we move across the surface of the airfoil, the <span><strong>high pressure</strong></span> at the stagnation point up front gradually decreases to reach <span><strong>minimum</strong></span> close to the “peak” of that curved surface. Across this transition the <strong><span data-color0="E5432E" data-color1="dddddd" data-color2="3F90CD">pressure gradient is favorable</span></strong>, and that distribution works in our favor – the boundary layer stays nicely attached to the surface.</p>
<p>However, as the air reaches the valley of the <span><strong>lowest pressure</strong></span>, it then has to start climbing back up to reach the <span><strong>slightly positive</strong></span> pressure in the rear of the airfoil. For <a href="#" onclick="symmetric_airfoil_fvm24a_f0();return false;">small values</a> of the  <span><strong>angle of attack</strong></span>, the pressure pit from which the air has to climb out is not very deep and the <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">adverse pressure gradient</span></strong> isn’t very strong, so the boundary layer remains attached.</p>
<p>As we <a href="#" onclick="symmetric_airfoil_fvm24a_f1();return false;">increase</a> the <span><strong>angle of attack</strong></span> of the airfoil, the pressure on top becomes <span><strong>lower</strong></span> and <span><strong>lower</strong></span>. For even <a href="#" onclick="symmetric_airfoil_fvm24a_f2();return false;">higher angles</a>, the <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">adverse pressure gradient</span></strong> becomes so strong that it  <a href="#" onclick="symmetric_airfoil_fvm24a_f3();return false;">eventually</a> reverses the flow in the boundary layer, creating separation. Let’s look at this region up close to see how the arrows of velocity in the separated region point in the other direction:</p>

<p>If you <span>click</span><span>tap</span> to add <strong>markers</strong> in the bottom right corner of the simulation you’ll notice that many of them move <em>against</em> the bulk of the flow – the boundary layer and the flow have separated.</p>
<p>We’ll get back to looking at airfoils soon enough, but we still have a few things to wrap up in the world of boundary layers.</p>
<p>The boundary layers we’ve looked at so far were <em>laminar</em> – the layers of fluid with different velocities flowed in an orderly way on top of each other. However, at higher flow speeds and over larger distances, or at high Reynolds numbers, the flow in the boundary layer transitions to a <em>turbulent</em> flow:</p>

<p>Be aware that what you’re seeing here is a very simplified simulation of a turbulent boundary layer. Turbulence is inherently three dimensional and it contains various evolving structures of different sizes that are extremely computationally expensive to evaluate in detail. Thankfully, you can find many videos of <a href="https://www.youtube.com/watch?v=Wr984EOmNaY">computer</a> <a href="https://www.youtube.com/watch?v=wXsl4eyupUY">simulations</a> and <a href="https://www.youtube.com/watch?v=e1TbkLIDWys">real flows</a> showing turbulent boundary layers.</p>
<p>While the laminar boundary layers we’ve seen in the past exhibited very organized flows, the turbulent one is very chaotic, with large and small swirls causing the flow to mix very rapidly. The transition from laminar to turbulent boundary layer happens spontaneously, but for a given flow speed, the location of the transition depends on surface roughness, steadiness of the flow outside of the boundary layer, and presence of pressure gradients.</p>
<p>At any given moment, the velocity profile in the turbulent boundary layer is very unsteady, but it can be averaged over time to get the mean distribution of speed. Let’s compare the <em>time-averaged</em> profiles of the <span><strong>laminar</strong></span> and <span><strong>turbulent</strong></span> boundary layers:</p>

<p>In the dynamic simulation of the <span><strong>turbulent</strong></span> boundary layer, we saw how the slower flow close to the <span><strong>surface</strong></span> rapidly mixed with the upper regions of the flow. This slows down those faster sections, and we need to go farther away from the <span><strong>surface</strong></span> for these sluggish intrusions to stop affecting the flow. For this reason, the <span><strong>turbulent</strong></span> boundary layer is thicker and grows faster than a <span><strong>laminar</strong></span> boundary layer.</p>
<p>On the other hand, the strong <span><strong>turbulent</strong></span>  mixing causes the fast external flow to get close to the body, so the overall velocity profile by the <span><strong>surface</strong></span> increases much more quickly in the <span><strong>turbulent</strong></span> case as opposed to <span><strong>laminar</strong></span> case – I’m showing that with <span><strong>white dotted lines</strong></span>.</p>
<p>Recall that the more horizontal the velocity profile at the <span><strong>surface</strong></span> of the object, the bigger the skin friction drag – a <span><strong>turbulent</strong></span>  boundary layer has higher skin friction drag than a <span><strong>laminar</strong></span> layer. Despite the cost of increased friction drag, a <span><strong>turbulent</strong></span>  boundary layer is often beneficial.</p>
<p>Because of that higher velocity closer to the surface, a turbulent boundary layer is more resistant to <strong><span data-color0="3F90CD" data-color1="dddddd" data-color2="E5432E">adverse pressure gradients</span></strong> and it can stay attached to the surface of an object for longer distances.</p>
<p>For some objects like golf balls, which purposefully make their boundary layer turbulent by roughing up the surface with little dimples, the delayed separation also decreases the <span><strong>pressure drag</strong></span> caused by uneven pressure distribution. That reduction more than compensates for the increased skin friction drag, making the dimply golf balls fly farther than equivalent smooth balls.</p>
<p>For airfoils, a turbulent boundary layer delays separation of the flow, which can help prevent stall at higher angles of attack, but at normal cruising conditions the increased skin friction becomes an important drawback. For many aerodynamic shapes in typical conditions, the skin friction drag is the primary contributor to the total drag that these objects experience.</p>
<p>As we’ve seen, by increasing the angle of attack on an airfoil, the lift force grows up to a certain limit, at which the boundary layer separates over most of the upper surface. By staying under this limit, a symmetric airfoil can safely generate lift force.</p>
<p>However, when it comes to  <span><strong>angle of attack</strong></span> and <span><strong>lift</strong></span>, the shape of an airfoil isn’t particularly unique in its <span><strong>lift</strong></span>-creation capabilities. Most simple elongated shapes generate <span><strong>lift</strong></span> when put in a flow at an  <span><strong>angle of attack</strong></span>. In the demonstration below, you can <span><strong>tilt</strong></span> a <span><strong>flat plate</strong></span> and see the forces exerted by the pressure field around it:</p>


<p>You may be surprised to see that, at small  <span><strong>angles of attack</strong></span>, this flat plate also generates <span><strong>lift</strong></span>. An airfoil-like shape is not a requirement for <span><strong>lift</strong></span> generation. After all, paper airplanes with their flat wings can fly just fine. <span><strong>Lift</strong></span> is just an outcome of the pressure distribution created and sustained by the flow.</p>
<p>Although it doesn’t take a sophisticated shape to generate lift at an angle of attack, a well-designed airfoil can often create more lift and with lower drag. In the last section of this article, we’ll explore how other variations to the shape of an airfoil can affect its characteristics.</p>
<h2 id="airfoil-shapes">Airfoil Shapes<a href="https://ciechanow.ski/airfoil/#airfoil-shapes" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>Let’s go back to the simple symmetric airfoil we’ve been playing with thus far. This time, however, we’re able to control its <span><strong>thickness</strong></span> using the slider:</p>


<p>Notice that as we increase the <span><strong>thickness</strong></span> of the airfoil, the pressure on the top and bottom sections of the shape becomes more <span><strong>negative</strong></span>. For this symmetric airfoil at 0° angle of attack the thickness doesn’t change much other than increasing the <span><strong>pressure drag</strong></span>.</p>
<p>However, if we break the symmetry of the shape, we can use thickness-dependence to make one side of the airfoil have a higher <span><strong>negative</strong></span> pressure than the other. In the demonstration below, you can control the “thickness” of the upper surface of the airfoil using the slider:</p>


<p>Notice that an asymmetric shape creates an asymmetric pressure distribution, which ends up creating <span><strong>lift</strong></span> without any changes to angle of attack. With some slight tweaking of this shape we finally recreated the asymmetric shape we first saw on the airplane in the early sections of this article.</p>
<p>Naturally, when combined with an increasing <span><strong>angle of attack</strong></span>, this airfoil will generate even more <span><strong>lift</strong></span> until it eventually reaches stalling conditions:</p>


<p>While symmetric airfoils are sometimes used in acrobatic airplanes, which often find themselves flying upside down, most typical planes use an asymmetric airfoil shape.</p>
<p>The underlying mechanism of <span><strong>lift</strong></span> generation by changing the <span><strong>angle of attack</strong></span> or by shaping the object differently is ultimately the same – we’re changing the placement and orientation of the surface of the body relative to the incoming flow. The flow reacts by changing the velocity and pressure distribution, and the resulting pressure field creates the forces on that object.</p>
<p>This all means that we have a lot of flexibility in how an airfoil is shaped, as long as the resulting pressure distribution fulfills the design goals of achieving a certain amount of lift while minimizing drag.</p>
<p>For example, in some applications it’s important to minimize the skin friction drag caused by a turbulent boundary layer. Some <em>laminar flow airfoils</em> achieve this by shaping the airfoil to move the “pit” of <span><strong>negative pressure</strong></span> further to the back of the airfoil:</p>


<p>The <strong><span data-color0="E5432E" data-color1="dddddd" data-color2="3F90CD">favorable pressure gradient</span></strong> between the front and the lowest pressure point extends over a longer distance across the surface of this airfoil, which, at least in principle, helps to keep the boundary layer laminar to keep the skin friction low.</p>
<p>Notice that even this unusual airfoil had a rounded front and a sharp back. The roundness of the front helps the air smoothly flow around this area at different  <span><strong>angles of attack</strong></span>, and the sharp back reduces the pressure drag by avoiding the separation of the flow.</p>
<p>The velocity of the flow around the airfoil is also a contributing factor to the design of the shape. Let’s look at the speed distribution in the flow around a simple asymmetric airfoil using the <strong><span>varying colors</span></strong> and <strong>markers</strong>:</p>


<p>The flow above the airfoil is faster than the incoming flow as indicated by brighter colors. The markers that start in the same line don’t end up sliding off the airfoil in the same formation – the ones on top are further ahead. This is particularly visible for <a href="#" onclick="airfoil_fvm3_f0();return false;">larger</a> values of the <span><strong>angles of attack</strong></span>.</p>
<p>This acceleration in the upper part becomes another point of consideration for airfoil design. While commercial airliners don’t fly faster than the speed of sound, the accelerated flow in the top part of an airfoil <em>can</em> break that barrier. This creates a shockwave that can sometimes be <a href="https://www.youtube.com/watch?v=HekbC6Pl4_Y">seen in flight</a>. Modern airliners use <a href="https://en.wikipedia.org/wiki/Supercritical_airfoil">supercritical airfoils</a> that are designed to reduce these drag-causing shockwaves by carefully controlling the speed of the flow around the wing.</p>
<p>Planes designed to fly <em>above</em> the speed of sound use <a href="https://en.wikipedia.org/wiki/Supersonic_airfoils"><em>supersonic airfoils</em></a> that are quite different from the shapes we’ve seen. These airfoils have a thin profile and their front edge is sharp and not rounded. <a href="https://en.wikipedia.org/wiki/Supersonic_speed"><em>Supersonic</em></a> flows of air are more complicated than what we’ve explored in this article, as variations in density and temperature become an important component of the behavior of the flow.</p>
<p>Many of the airfoils used today are designed specifically for the plane they’ll be used in. Moreover, that cross-sectional shape may change across the length of the wing. Real airplanes are three dimensional and the <a href="https://en.wikipedia.org/wiki/Wing_configuration">overall shape of the wings</a> also significantly affects the lift and drag of an airplane, but ultimately all the resulting forces are an outcome of interactions between the flow and the body.</p>
<h2 id="further-reading-and-watching">Further Reading and Watching<a href="https://ciechanow.ski/airfoil/#further-reading-and-watching" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>John Anderson’s <a href="https://www.mheducation.com/highered/product/fundamentals-aerodynamics-anderson/1264151926.html">Fundamentals of Aerodynamics</a> is a very well-written textbook on aerodynamics. Over the course of over a thousand pages, the author presents a classic exposition of the motion of fluids and their interactions with bodies put in those flows.</p>
<p><a href="https://www.wiley.com/en-us/Understanding+Aerodynamics%3A+Arguing+from+the+Real+Physics-p-9781119967514">Understanding Aerodynamics</a> by Doug McLean is a great textbook that takes a different approach of explaining aerodynamic phenomena using physical reasoning. For me, the crowning achievement of the publication is showing that many popular explanations of the origins of lift are either incorrect or they’re based on merely mathematically convenient theorems. The author’s <a href="https://www.youtube.com/watch?v=QKCK4lJLQHU">video lecture</a> gives an overview of some of these misconceptions.</p>
<p>In this article, I’m using <a href="https://en.wikipedia.org/wiki/Computational_fluid_dynamics"><em>computational fluid dynamics</em></a> to simulate the flow of air around different objects. For an approachable introduction to these methods I enjoyed Tony Saad’s <a href="https://www.youtube.com/playlist?list=PLEaLl6Sf-KIC7oet7zvNfW03aocrIq-s4">series of lectures</a> on the topic. For an alternative, and slightly more rigorous approach, Lorena Barba created <a href="https://lorenabarba.com/blog/cfd-python-12-steps-to-navier-stokes/">12 steps to Navier-Stokes</a>. That website is also accompanied by <a href="https://www.youtube.com/playlist?list=PL30F4C5ABCE62CB61">video lectures</a>.</p>
<p>Finally, YouTuber <a href="https://www.youtube.com/@braintruffle/videos">braintruffle</a> created a series of <a href="https://www.youtube.com/playlist?list=PLMoTR49uj6ld32zLVWmcGXaW7w2ey7Vh4">beautiful videos</a> that start with the behavior of fluids on a quantum scale and build up increasingly abstract models that can be used in more practical applications. The videos are packed with interesting takes on fluid mechanics, and they’re worth watching for their visuals alone.</p>
<h2 id="final-words">Final Words<a href="https://ciechanow.ski/airfoil/#final-words" arialabel="Anchor"><img src="https://ciechanow.ski/images/anchor.png" width="16px" height="8px"></a> </h2>
<p>If you were to sit on a flying airplane and look out the window to glance at its wings, you’d often have a hard time seeing anything going on. However, in that crisp clearness of air whose invisible flow sustains the varied pressure field, lies the hidden source of lift that overcomes the might of gravity to keep the plane safely above the ground.</p>
<p>Since the first human flight, we’ve now mastered the art of soaring in the skies by bending the flow of air to our will, using physical quantities like pressure and velocity to help shape our designs. These tangible concepts are ultimately just a manifestation of motions and collisions of billions of inanimate air particles that somehow conspire to assemble the forces we need.</p>
<p>I hope this deeper, technical exploration of airfoils hasn’t diminished your appreciation of the greatness of flight. Perhaps paradoxically, by seeing how all the pieces fit together, you’ll find the whole thing even more magical.</p>
    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Microsoft forced me to switch to Linux (1677 pts)]]></title>
            <link>https://www.himthe.dev/blog/microsoft-to-linux</link>
            <guid>46795864</guid>
            <pubDate>Wed, 28 Jan 2026 14:28:21 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.himthe.dev/blog/microsoft-to-linux">https://www.himthe.dev/blog/microsoft-to-linux</a>, See on <a href="https://news.ycombinator.com/item?id=46795864">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><p>January 26, 2026</p><h2>What's better than a devil you don't know?<br>The devil you do.</h2>

<p>I've used Windows for as long as I've been alive. At 6 years old, my first computer was a Windows 98 machine, with an Athlon XP 1900+ (Palomino core) and a GeForce 440 MX, blessed with a generous 256 megabytes of RAM.</p>

<p>Looking back, I kinda got scammed with that graphics card, but what could I do? I was a silly kid. (The missing shader support came back to bite me in the ass)</p>
<p>Also, is it weird that I still remember the specs of my first computer, 22 years later?</p>

<p>Anyway, Windows has been familiar and comfortable. I knew all the workarounds and how to extract maximum efficiency from it.</p>
<p>I was a happy user, for over 20 years, and Windows has been my go-to for everything computer-related.</p>

<p>Even after becoming a software developer and using a macbook, I'd still find myself reaching for Windows at times.</p>
<p>That is, until Microsoft decided to turn it into something completely unrecognizable and unusable.</p>

<p><img src="https://www.himthe.dev/img/blog/microslop/1.png" alt="Microsoft is a company that turns OS into slop"></p>
<br>
<h2>It all came crashing down</h2>

<p>I think it started with the Windows 10 full-screen ads.</p>

<p>You know, those friendly suggestions telling you to try OneDrive or to "use the recommended browser settings" (<em>reads as "please try Edge and OneDrive, we're desperate"</em>).</p>

<p><img src="https://www.himthe.dev/img/blog/microslop/5.png" alt="Windows 10 full-screen ads"></p>

<p>Actually, scratch that, I think it really started with the non-consensual updates:</p>
<br>
<blockquote>
<p>Oh you're doing work? That's so cute... we're gonna close whatever apps you had open, because we're updating now. We own your computer.</p>
</blockquote>
<blockquote>
<p>You had unsaved work? Too bad, it's gone, get bent.</p>
</blockquote>
<p>At first I ignored it, and carried on as normal. Sure, I'd get mad from time to time and I'd complain.</p>
<p>But hey, nothing beats the convenience of being able to have all of your applications in one place</p>
<h4>Right? Right?</h4>

<p>My breaking point came with the 24H2 update. It installed on my system <em>without my consent</em>, like any other major update.
I knew there were problems with it, people were already complaining on Reddit, so I just postponed it, and kept postponing it.</p>

<p>All it took was for me to leave my computer on and unattended for a while, and <strong>BOOM</strong>, just like that -  the major OS update that nobody wanted, it was on my computer.</p>
<br>
<h2>The Chrome Seizure Incident</h2>
<p><em>Spoiler: all hell broke loose.</em></p>

<p>As soon as 24H2 landed on my machine, I encountered a bug so bizarre I thought I was losing my marbles.<br>
If Chrome was positioned <em>under</em> any other window, it would start having what I can only describe as a visual seizure.<br>
Here's Ableton Live with Chrome (Reddit) under it:</p>

<p><img src="https://www.himthe.dev/img/blog/microslop/2.gif" alt="Windows 24H2 being a piece of shit"></p>

<p>Worse, there was a decent chance this would trigger a full system lock, leaving me smashing my desk in impotent rage. I shit you not.</p>
<p><img src="https://www.himthe.dev/img/blog/microslop/3.gif" alt="Gif of of XQC raging"></p>
<br>
<div><p>I tried to rollback. The rollback failed with an error. I reinstalled Windows. The bug persisted.<br>
Like digital herpes, I just couldn't get rid of it.</p><p>
The solution? Installing an Insider build. Yes, the solution to Microsoft's broken stable release was to use their <em>unstable</em> release.</p></div>
<br>
<h2>The Sequel I Never Wanted</h2>

<p>The Insider build worked...sort of. But now I had a new bug: Chrome would randomly lock up for about 30 seconds when a video was playing.
My options were to wait it out or press Ctrl+Alt+Delete and Esc to force my way back to a working browser.
After some digging, I discovered this was caused by an NVIDIA-Microsoft driver incompatibility.</p>

<p>Links here:</p>
<ul>
<li><a href="https://support.google.com/chrome/thread/319305305/chrome-freezes-when-i-play-any-video">Link 1</a></li>
<li><a href="https://www.elevenforum.com/t/edge-and-chrome-freezes-after-24h2-update.32199">Link 2</a></li>
<li><a href="https://learn.microsoft.com/en-us/answers/questions/3946330/win11-24h2-fullscreen-videos-are-freezing-in-all-b">Link 3</a></li>
<li><a href="https://forums.developer.nvidia.com/t/system-hard-freeze-crash-when-using-video-super-resolution-vsr/343511">Link 4</a></li>
<li><a href="https://forums.tomsguide.com/threads/google-chrome-keeps-freezing-when-playing-youtube-videos.382695/">Link 5</a></li>
<li><a href="https://learn.microsoft.com/en-us/answers/questions/3881462/how-can-i-disable-windows-mpo-in-2025-%2824h2-window?page=2">Link 6</a></li>
</ul>

<p>I've found out that the flickers and the chrome lock-up issues are likely caused by the Multiplane Overlay (MPO) pipeline. Microsoft blamed NVIDIA for not correctly implementing it in their drivers. NVIDIA blamed Microsoft.
What's clear is that if you were facing this issue, you were essentially screwed because these 2 companies would just pass the hot potato to each other.</p>
<p>I should mention that this bug persisted even after I went off the Insider build and on 25H2. And when I posted on r/Microsoft, they just deleted it.</p>
<p>The latest and greatest OS surely cannot be broken beyond repair, surely I'm using my PC wrong.</p>

<p>So there I was, finally grasping the reality of what you're up against, as a Windows user:</p>
<ul>
<li>Random bugs that break basic functionality</li>
<li>Updates that install without permission and brick my system</li>
<li>Copilot and OneDrive ads appearing in every corner of the OS</li>
<li>Copilot buttons everywhere, coming for every application</li>
<li>Can't even make a local account without hacking the setup with Rufus (they even removed the terminal workaround)</li>
<li>Zero actionable fixes or even an aknowledgment of their fuckups</li>
</ul>

<p>People often say Linux is "too much work.".</p>
<p>And I agree. They're completely justified to complain. There's the documentation page diving, the forums, the reddit threads. And, most importantly, you have to basically rewire your brain and stop expecting it to behave like Windows used to.</p>

<p>But I looked at the list above and realized: Windows is now <em>also</em> too much work.<br>
And the difference with Windows is that you're going to do all that work while actively fighting your computer only for it to be undone when the next surprise update comes and ruins everything.</p>

<p>You might be thinking "just disable updates, man" or "just install LTSC", or "just run some random debloat script off of GitHub".
<strong>Why?</strong> Why would I jump through all these hoops? I'd rather put in the effort for an OS that knows what consent is and respects me as a user.</p>
<br>
<h2>Could the grass actually be greener on the other side?</h2>

<p>To set the stage: I'm a software developer and a musician.</p>
<br>
<ul>
<li><a href="https://github.com/xndbogdan">GitHub</a></li>
<li><a href="https://open.spotify.com/artist/2mKbWigSc3yk0U9uxJDVRK?si=5xDceGSsSyqIWAYsj9BerQ">Spotify</a></li>
</ul>

<p>As you can imagine, I was legitimately worried about app support on Linux, and how it would distrupt my workflow.</p>

<p>But after Chrome crashing for the 10000th time, I said "enough is enough", and decided to go big. I installed <a href="https://cachyos.org/">CachyOS</a>, a performance-focused Arch-based distribution, on my main machine (9800X3D, RTX 5080).</p>

<p>It wasn't a painless process. In fact, sleep mode was broken from the start,
and my system would fail to detect the monitor after waking up.</p>
<p>What's more, Ableton Live does not have a native Linux build, only Windows and macOS. So I couldn't use it anymore, at least not without fucking around with Wine (which doesn't fully support it), or without keeping a Windows VM and taking an L on audio latency.</p>

<p>But unlike Windows, on CachyOS I could actually fix my NVIDIA woes by following <a href="https://discuss.cachyos.org/t/nvidia-and-sleep-failing-to-detect-monitor/12029/11">this thread</a> on their forum.</p>
<p>All I had to do was add the NVIDIA modules to mkinitcpio. One config change, a command to rebuild the initramfs, and problem solved.</p>
<p>I also found a good native alternative to Ableton Live - <a href="https://www.bitwig.com/">Bitwig Studio</a>, which bothered to release a native Linux Build.</p>

<p>Thanks to the constant progress that was made with Pipewire, I'm getting audio latency on par with Mac OS, and lower than Windows.
And my workflow didn't even change that much, since Bitwig is made by ex-Ableton developers that seem to give a shit.</p>

<p>As for my development tools, on Windows you already accept the fact that <strong>you WILL</strong> use WSL or docker, so realistically I just cut the broken middleman.</p>

<p>Now compare that to the Windows fuckery above.</p>
<br>
<h2>What You're Signing Up For</h2>

<p>If 3 years ago you would have told me that Microsoft would singlehandedly sabotage their own OS, doing more Linux marketing than the most neckbearded Linux fanboy (or the most femboy Thinkpad enjoyer), I'd have laughed in your face,
called you delusional, and then hurled some more insults your way.</p>

<p><strong>Yet here we are</strong>, I've been dual-booting CachyOS for over a year, and in the last month I've been using it exclusively.</p>

<p>So what is the actual state of Linux in 2026, from my honest perspective?</p>
<br>
<h5>Web Browsing</h5>
<p>All major browsers (Chrome, Firefox, Edge, Brave) have native Linux builds. Full support. No compromises.<br>
Video playback works flawlessly, with hardware acceleration even. On AMD, on NVidia and yes, on Intel too.</p>
<br>
<h5>Software Development</h5>
<p>Linux is the <em>preferred</em> platform for development.</p>
<p>Better terminal support, native package managers, Docker runs natively without the WSL overhead, and your production servers are probably running Linux anyway.</p>
<p>Hell, even Microsoft has their own Linux distro, <a href="https://github.com/microsoft/azurelinux">Azure Linux</a> (Formerly CBL-Mariner).</p>
<br>
<h5>Content Creation</h5>
<p>This is where people assume Linux falls short. And they're right, but not completely:</p>
<ul>
<li><strong>Adobe Suite</strong>: Runs via Winboat. Far from perfect (no video acceleration, laggy at times), but functional</li>
<li><strong>DaVinci Resolve</strong>: Native Linux app. Professional-grade video editing, free tier available</li>
<li><strong>Kdenlive</strong>: Native Linux app, completely free and open source</li>
</ul>
<br>
<h5>Music Production</h5>
<ul>
<li><strong>Bitwig Studio</strong>: Incredible DAW that was designed that runs natively on Linux</li>
<li><strong>Ardour</strong>: Native, free, open-source DAW</li>
<li><strong>Audio latency</strong>: Thanks to PipeWire, Linux audio latency is actually <em>lower</em> than Windows</li>
</ul>
<br>
<h5>Gaming</h5>
<p>Here's where things get interesting. The perception is that gaming on Linux is a compromise. In 2026, that's increasingly untrue:</p>
<ul>
<li><strong>Proton/Wine</strong>: Pretty much all games without kernel-level anti-cheat work out of the box through Steam's Proton compatibility layer</li>
<li><strong>Performance</strong>: For AMD GPUs, gaming performance is on par with Windows, on average</li>
<li><strong>NVIDIA</strong>: There was a 10-30% performance penalty on Intel/NVIDIA GPU setups, but recent Vulkan extensions are taking care of that.</li>
</ul>
<p>NVIDIA has released beta drivers making use of these improvements, and once Wine/DXVK/Proton are updated to make use of the extensions, the performance delta should be essentially gone</p>

<p>The only real limitation is that some games with anti-cheat like Valorant, Call of Duty or League of Legends won't run.
But honestly I think not being able to launch League of Legends is actually a feature - one final reason to install Linux.</p>

<p>It's not all bad, though. <a href="https://store.steampowered.com/app/1808500/ARC_Raiders/">Arc Raiders</a> makes use of Easy Anti-Cheat, yet runs flawlessly. In fact, I've been playing it like a madman.
It goes to show that if the developers want to, it's possible.</p>
<br>
<h5>3D Modeling</h5>
<p>Still falls short compared to Windows and Mac OS (Autodesk, I'm looking at you).</p>
<p>The silver lining is that Blender has a native build. So if it's your main application, you're good to go.</p>
<br>
<h5>General Usage</h5>
<p>Basic operations are <em>so much faster</em> on Linux.
Opening directories, launching applications, system responsiveness.
It's like your computer took a line of coke, and is now ready to work.</p>

<p>No more waiting for the Start menu to decide it wants to open. No more File Explorer hanging when you need it the most.</p>

<p>Since we're on the topic of Linux improvements, I want to address the elephant in the room - people who keep saying "I want to switch", but keep moving the goalposts:</p>
<br>
<blockquote>
<p>"I'll switch when Linux supports X."</p>
</blockquote>
<blockquote>
<p><em>Linux supports X.</em></p>
</blockquote>
<blockquote>
<p>"Okay, but what about Y?"</p>
</blockquote>
<blockquote>
<p><em>Linux supports Y.</em></p>
</blockquote>
<blockquote>
<p>"Well, Z is still missing..."</p>
</blockquote>

<p>If you're always finding the next reason not to switch, you're not looking for solutions, <strong>you're looking for excuses to stay complacent</strong>.</p>
<p>I was that person, so I would know.</p>

<p>At the same time, <strong>I want to take it down a notch</strong> and say that there are still plenty of use cases (Especially creative work, and like stated previously, 3D modelling and also Game Dev) where it simply doesn't make sense to switch.</p>
<p>So if you're in that scenario, don't feel pressured, just wait for things to improve.</p>
<br>
<hr>
<p>And if you don't plan on ever switching, more power to you.</p>
<p>I'm not here to judge, just here to vent my Microsoft frustrations.</p>

<p>And I didn't really want to switch either, because who wants to re-learn how their computer should be operated from scratch?
What I really wanted was for Windows to work, but Microsoft didn't.</p>
<br>
<h2>The Windows Retrospective</h2>

<p>While I'm enjoying my new Linux setup, Windows 11 is having a miserable year, and we're only a month in!</p>
<p>According to <a href="https://www.windowslatest.com/2026/01/21/windows-11-had-20-major-update-problems-in-2025-and-and-2026-started-badly-too-what-are-you-doing-microsoft/">Windows Latest</a>, there were over <strong>20 major update problems</strong> in 2025 alone, and 2026 is starting off strong, with the January update causing black screens and Outlook crashes.</p>

<p><strong>Here's a quick 2025 Spotify Wrapped of the bugs Windows users dealt with:</strong></p>
<ul>
<li>USB audio devices randomly stopped working</li>
<li>Webcams failed to be detected</li>
<li>BitLocker settings became inaccessible</li>
<li>Adobe Premiere Pro couldn't drag clips on the timeline</li>
<li>Cursor constantly spinning for no reason</li>
<li>Remote Desktop sessions randomly disconnecting</li>
<li>The Copilot app accidentally getting deleted (okay, this is actually a good change for once)</li>
<li>Blue screens of death in mandatory security updates</li>
<li>Windows Hello face recognition broken</li>
<li>File Explorer becoming unresponsive</li>
<li>FPS drops and system reboots while gaming</li>
<li>Task Manager spawning infinite copies of itself</li>
<li>Dark mode breaking with white flashes</li>
</ul>

<p>And the company's response? Crickets. They're busy boasting that 30% of their code is currently being written by AI. Don't worry, Microsoft, we can definitely tell.</p>

<p>For the remainder of 2026, Microsoft is cooking up a big one: replacing more and more native apps with React Native.
But don't let the name fool you, there's nothing "native" about it.
These are projects designed to be easily ported across any machine and architecture, because underneath it all, it's just JavaScript.</p>
<p>And each one spawns its own Chromium process, gobbling up your RAM so you can enjoy the privilege of opening <a href="https://devblogs.microsoft.com/react-native/rnw-settings-win11/">the Settings app</a>.</p>

<p>I could maybe understand this for a weather widget. But when it's coming for core system apps, it's <strong>LAZY!</strong></p>
<p>I'm gonna go full conspiracy nut here, but I bet it's because the LLM understands JavaScript better, and Microsoft can't be asked to pay actual humans to write proper native code.</p>

<p>Meanwhile, <a href="https://www.windowscentral.com/microsoft/microsoft-ceo-satya-nadella-really-wants-you-to-stop-calling-ai-slop-in-2026">entire governments are abandoning Windows for Linux</a>, the term <a href="https://www.windowscentral.com/artificial-intelligence/microslop-trends-on-social-media-backlash-to-microsofts-on-going-ai-obsession-continues">"Microslop" is trending on social media</a>, and <a href="https://www.windowscentral.com/microsoft/windows-11/2025-has-been-an-awful-year-for-windows-11-with-infuriating-bugs-and-constant-unwanted-features">Windows 11's reputation is at its lowest point ever</a>.</p>
<br>
<h2>Not Because I Wanted To, But Because Microsoft Forced My Hand</h2>

<p>So here I am. Fully switched to Linux.</p>
<p>Not because I'm some open-source idealist or command-line warrior (I'm just some guy), but because Microsoft turned into Microslop.</p>
<p><img src="https://www.himthe.dev/img/blog/microslop/4.png" alt="New Microslop logo"></p>

<p>Meanwhile, Microsoft CEO Satya Nadella wrote a <a href="https://techcrunch.com/2026/01/05/microsofts-nadella-wants-us-to-stop-thinking-of-ai-as-slop/">blog post</a> asking people to stop calling AI-generated content "slop" and to think of AI as "bicycles for the mind."<br></p>

<p><strong>Well, Mr Satya, I have a couple of bicycles that will blow your mind:</strong></p>
<p>You are the biggest Linux evangelist there ever was, you single-handedly convinced countless people to ditch your buggy, ad-ridden, bloated, slop-infested mess of an OS.</p>
<p>And worst of all, you're like a pit bull that has lock-jawed onto OpenAI's ballsack, and you're not letting go, not matter how much we tell you to.</p>

<p>So we're calling slop for what it is: disgusting slop.</p>
<p>You're chasing profit like your life depends on it, yet you've completely forgotten the very thing that generates profit: <strong>user satisfaction</strong>.</p>

<p>Now you're stuck in a circlejerk of fake value in a fake bubble, and OpenAI's hand is so far up your ass they're playing shadow puppets with your tonsils.</p>

<p>The time to switch is now. The tools are ready. The only question is: <strong>are you?</strong></p>
<div><p>Satya came down from his cloud in the sky,</p><p>With Copilot dreams and a gleam in his eye,</p><p>He sprinkled AI on each app, every field,</p><p>Till users cried "Fuck!", and the slop was revealed.</p></div>
</article><!--$--><!--/$--></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: I built a small browser engine from scratch in C++ (129 pts)]]></title>
            <link>https://github.com/beginner-jhj/mini_browser</link>
            <guid>46795540</guid>
            <pubDate>Wed, 28 Jan 2026 14:03:28 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/beginner-jhj/mini_browser">https://github.com/beginner-jhj/mini_browser</a>, See on <a href="https://news.ycombinator.com/item?id=46795540">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">TL;DR</h2><a id="user-content-tldr" aria-label="Permalink: TL;DR" href="#tldr"></a></p>
<ul dir="auto">
<li>Built a small browser engine in C++ to understand how browsers render HTML to the screen.</li>
<li>Implemented core structures: HTML/CSS parsing, layout calculation, and rendering from scratch.</li>
<li>This is a learning-focused project, not a production browser.</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Introduction</h2><a id="user-content-introduction" aria-label="Permalink: Introduction" href="#introduction"></a></p>
<p dir="auto">Hello, I'm a korean high school senior (Grade 12) planning to major in Computer Science.</p>
<p dir="auto">I wanted to understand not just how to use technology, but how it works internally. I've built several websites with HTML, CSS, and JavaScript, but I never really understood how the browser executing this code actually works.</p>
<p dir="auto">"How does a browser render HTML to the screen?"</p>
<p dir="auto">To answer this question, I spent about 8 weeks building a browser engine from scratch.</p>
<p dir="auto">C++ was entirely new to me, and I struggled with countless bugs, but I eventually completed a small browser that can parse HTML, apply CSS, and render images. While not perfect, it was sufficient to understand the core principles of how browsers work.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Table of Contents</h2><a id="user-content-table-of-contents" aria-label="Permalink: Table of Contents" href="#table-of-contents"></a></p>
<ul dir="auto">
<li><a href="#key-features">Key Features</a></li>
<li><a href="#tech-stack">Tech Stack</a></li>
<li><a href="#build--run">Build &amp; Run</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#project-structure">Project Structure</a></li>
<li><a href="#supported-css-properties">Supported CSS Properties</a></li>
<li><a href="#challenges--solutions">Challenges &amp; Solutions</a></li>
<li><a href="#what-i-learned">What I Learned</a></li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Key Features</h2><a id="user-content-key-features" aria-label="Permalink: Key Features" href="#key-features"></a></p>
<p dir="auto">This browser supports the following features:</p>
<ol dir="auto">
<li><strong>HTML Parsing</strong>: Tokenization, DOM tree construction, automatic error correction</li>
<li><strong>CSS Rendering</strong>: Selector matching, style inheritance, Cascade application</li>
<li><strong>Layout</strong>: Block/Inline layouts, Position property support</li>
<li><strong>Images</strong>: Local/network/Data URL support, asynchronous loading, caching</li>
<li><strong>Navigation</strong>: Link clicking, event bubbling, history (back/forward)</li>
</ol>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/132197860/541103314-40c3bfc2-8b28-412a-9849-b098f9ca60da.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk2MzI1MDIsIm5iZiI6MTc2OTYzMjIwMiwicGF0aCI6Ii8xMzIxOTc4NjAvNTQxMTAzMzE0LTQwYzNiZmMyLThiMjgtNDEyYS05ODQ5LWIwOThmOWNhNjBkYS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMTI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDEyOFQyMDMwMDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03ODg0YzJlYjhkNzczM2RkOWRjNGY3NDM3NTRlYWI3ZGQ3NGI2ZmE3NWQzZDg0MmJkZDZhNTFkZmI3NGM5YjI5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ssgqZ7qEs6aSaFA1S3x7RcUFA3lHub17_xoQqleV8kw"><img width="400" height="250" alt="Image" src="https://private-user-images.githubusercontent.com/132197860/541103314-40c3bfc2-8b28-412a-9849-b098f9ca60da.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk2MzI1MDIsIm5iZiI6MTc2OTYzMjIwMiwicGF0aCI6Ii8xMzIxOTc4NjAvNTQxMTAzMzE0LTQwYzNiZmMyLThiMjgtNDEyYS05ODQ5LWIwOThmOWNhNjBkYS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMTI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDEyOFQyMDMwMDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT03ODg0YzJlYjhkNzczM2RkOWRjNGY3NDM3NTRlYWI3ZGQ3NGI2ZmE3NWQzZDg0MmJkZDZhNTFkZmI3NGM5YjI5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.ssgqZ7qEs6aSaFA1S3x7RcUFA3lHub17_xoQqleV8kw"></a>
<a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/132197860/541109781-f0c27381-4b47-49c3-8839-a34d8e150cda.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk2MzI1MDIsIm5iZiI6MTc2OTYzMjIwMiwicGF0aCI6Ii8xMzIxOTc4NjAvNTQxMTA5NzgxLWYwYzI3MzgxLTRiNDctNDljMy04ODM5LWEzNGQ4ZTE1MGNkYS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMTI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDEyOFQyMDMwMDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zNzY2YTBjMjQ0OWI5MjkwNTRkMTMxMjU2OWQ5NGMyMzg4N2M5Nzc2NzJmYjJjYWYyODEwZWRlODZiYWMyNWJkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.0mDIUtrRIVmjVL9x7bwQ79gihRtOfeXx04TlvqoVLjE"><img width="400" height="250" alt="Image" src="https://private-user-images.githubusercontent.com/132197860/541109781-f0c27381-4b47-49c3-8839-a34d8e150cda.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3Njk2MzI1MDIsIm5iZiI6MTc2OTYzMjIwMiwicGF0aCI6Ii8xMzIxOTc4NjAvNTQxMTA5NzgxLWYwYzI3MzgxLTRiNDctNDljMy04ODM5LWEzNGQ4ZTE1MGNkYS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjYwMTI4JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI2MDEyOFQyMDMwMDJaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zNzY2YTBjMjQ0OWI5MjkwNTRkMTMxMjU2OWQ5NGMyMzg4N2M5Nzc2NzJmYjJjYWYyODEwZWRlODZiYWMyNWJkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.0mDIUtrRIVmjVL9x7bwQ79gihRtOfeXx04TlvqoVLjE"></a>
<p dir="auto"><h2 tabindex="-1" dir="auto">Tech Stack</h2><a id="user-content-tech-stack" aria-label="Permalink: Tech Stack" href="#tech-stack"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Component</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Language</strong></td>
<td>C++17</td>
</tr>
<tr>
<td><strong>GUI Framework</strong></td>
<td>Qt6 (Core, Gui, Network)</td>
</tr>
<tr>
<td><strong>Build System</strong></td>
<td>CMake 3.16+</td>
</tr>
<tr>
<td><strong>Rendering</strong></td>
<td>Qt Graphics View Framework</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h2 tabindex="-1" dir="auto">Build &amp; Run</h2><a id="user-content-build--run" aria-label="Permalink: Build &amp; Run" href="#build--run"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Prerequisites</h3><a id="user-content-prerequisites" aria-label="Permalink: Prerequisites" href="#prerequisites"></a></p>
<ul dir="auto">
<li>macOS, Linux, or Windows (MSVC support)</li>
<li>CMake 3.16+</li>
<li>Qt6 installed (development libraries)</li>
<li>C++17-compatible compiler</li>
</ul>
<p dir="auto"><strong>Install Qt6 on macOS (using Homebrew)</strong>:</p>

<p dir="auto"><strong>Linux (Ubuntu/Debian)</strong>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="sudo apt-get install qt6-base-dev cmake build-essential"><pre>sudo apt-get install qt6-base-dev cmake build-essential</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Build</h3><a id="user-content-build" aria-label="Permalink: Build" href="#build"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="# 1. Navigate to project directory
cd /path/to/small_browser

# 2. Create and enter build directory
mkdir -p build &amp;&amp; cd build

# 3. Configure with CMake
cmake ..

# 4. Build
make

# After build completes, executable: ./browser"><pre><span><span>#</span> 1. Navigate to project directory</span>
<span>cd</span> /path/to/small_browser

<span><span>#</span> 2. Create and enter build directory</span>
mkdir -p build <span>&amp;&amp;</span> <span>cd</span> build

<span><span>#</span> 3. Configure with CMake</span>
cmake ..

<span><span>#</span> 4. Build</span>
make

<span><span>#</span> After build completes, executable: ./browser</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Run</h3><a id="user-content-run" aria-label="Permalink: Run" href="#run"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="# From build directory
./browser

# Or with full path
./build/browser"><pre><span><span>#</span> From build directory</span>
./browser

<span><span>#</span> Or with full path</span>
./build/browser</pre></div>
<p dir="auto">The GUI window will appear. You can test rendering by opening HTML files from the test_html_files directory.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Run Tests</h3><a id="user-content-run-tests" aria-label="Permalink: Run Tests" href="#run-tests"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="# From build directory
cd test
ctest"><pre><span><span>#</span> From build directory</span>
<span>cd</span> <span>test</span>
ctest</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Architecture</h2><a id="user-content-architecture" aria-label="Permalink: Architecture" href="#architecture"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Browser Rendering Pipeline</h3><a id="user-content-browser-rendering-pipeline" aria-label="Permalink: Browser Rendering Pipeline" href="#browser-rendering-pipeline"></a></p>
<p dir="auto">Real browsers follow a 5-stage pipeline to render HTML to screen:</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/5cc27fcb37aabaf7aed7445ab7a39704d76575ac694693f79bec94e9fc4abad3/68747470733a2f2f776562706572662e746970732f7374617469632f34653733633939393263653362393137376263633830613231313362333133382f39303662352f42726f7773657252656e646572696e67506970656c696e6530312e706e67"><img width="600" height="300" src="https://camo.githubusercontent.com/5cc27fcb37aabaf7aed7445ab7a39704d76575ac694693f79bec94e9fc4abad3/68747470733a2f2f776562706572662e746970732f7374617469632f34653733633939393263653362393137376263633830613231313362333133382f39303662352f42726f7773657252656e646572696e67506970656c696e6530312e706e67" data-canonical-src="https://webperf.tips/static/4e73c9992ce3b9177bcc80a2113b3138/906b5/BrowserRenderingPipeline01.png"></a></p>
<p dir="auto">This project implements this pipeline as follows:</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Stage 1: Tokenization</h3><a id="user-content-stage-1-tokenization" aria-label="Permalink: Stage 1: Tokenization" href="#stage-1-tokenization"></a></p>
<p dir="auto"><strong>Goal</strong>: Convert HTML string into tokens</p>
<p dir="auto">The first step breaks down HTML text into small units (tokens) that the parser can understand.</p>
<p dir="auto"><strong>Core Struct</strong>:</p>
<ul dir="auto">
<li><code>TOKEN</code> (include/html/token.h)
<ul dir="auto">
<li><code>TOKEN_TYPE</code>: START_TAG, END_TAG, TEXT</li>
<li><code>value</code>: tag name or text content</li>
<li><code>attributes</code>: tag attributes (key-value map)</li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Implementation</strong>:</p>
<ul dir="auto">
<li><code>HTML_TOKENIZER</code> (include/html/html_tokenizer.h, src/html/html_tokenizer.cpp)
<ul dir="auto">
<li>Role: Parse HTML string and convert to TOKEN vector</li>
<li>Key method: <code>tokenize()</code></li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Example</strong>:</p>
<div data-snippet-clipboard-copy-content="Input: <div class=&quot;container&quot;>Hello</div>
Output: 
  - TOKEN{START_TAG, &quot;div&quot;, {&quot;class&quot;: &quot;container&quot;}}
  - TOKEN{TEXT, &quot;Hello&quot;}
  - TOKEN{END_TAG, &quot;div&quot;}"><pre><code>Input: &lt;div class="container"&gt;Hello&lt;/div&gt;
Output: 
  - TOKEN{START_TAG, "div", {"class": "container"}}
  - TOKEN{TEXT, "Hello"}
  - TOKEN{END_TAG, "div"}
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Stage 2: DOM Tree Construction</h3><a id="user-content-stage-2-dom-tree-construction" aria-label="Permalink: Stage 2: DOM Tree Construction" href="#stage-2-dom-tree-construction"></a></p>
<p dir="auto"><strong>Goal</strong>: Create DOM tree from tokens</p>
<p dir="auto">Organize tokens into a hierarchical tree structure (DOM Tree).</p>
<p dir="auto"><strong>Core Classes</strong>:</p>
<ul dir="auto">
<li>
<p dir="auto"><code>NODE</code> (include/html/node.h, src/html/node.cpp)</p>
<ul dir="auto">
<li><code>NODE_TYPE</code>: ELEMENT, TEXT</li>
<li>Properties:
<ul dir="auto">
<li><code>m_tag_name</code>: element's tag name (e.g., "div", "p")</li>
<li><code>m_text</code>: text node content</li>
<li><code>m_children</code>: child nodes</li>
<li><code>m_attributes</code>: attribute map (id, class, src, etc.)</li>
<li><code>m_parent</code>: parent node</li>
<li><code>m_computed_style</code>: calculated style information</li>
</ul>
</li>
</ul>
</li>
<li>
<p dir="auto"><code>HTML_PARSER</code> (include/html/html_parser.h, src/html/html_parser.cpp)</p>
<ul dir="auto">
<li>Role: Parse token stream and build DOM tree</li>
<li>Key method: <code>parse()</code></li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Memory Structure</strong>:</p>
<div data-snippet-clipboard-copy-content="root NODE
├── NODE (tag: html)
│   ├── NODE (tag: head)
│   │   └── NODE (tag: title)
│   │       └── NODE (text: &quot;My Page&quot;)
│   └── NODE (tag: body)
│       ├── NODE (tag: div, attributes: {class: &quot;container&quot;})
│       │   └── NODE (text: &quot;Hello World&quot;)
│       └── NODE (tag: img, attributes: {src: &quot;image.png&quot;})"><pre><code>root NODE
├── NODE (tag: html)
│   ├── NODE (tag: head)
│   │   └── NODE (tag: title)
│   │       └── NODE (text: "My Page")
│   └── NODE (tag: body)
│       ├── NODE (tag: div, attributes: {class: "container"})
│       │   └── NODE (text: "Hello World")
│       └── NODE (tag: img, attributes: {src: "image.png"})
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Stage 3: Style Calculation (CSSOM &amp; Style Application)</h3><a id="user-content-stage-3-style-calculation-cssom--style-application" aria-label="Permalink: Stage 3: Style Calculation (CSSOM &amp; Style Application)" href="#stage-3-style-calculation-cssom--style-application"></a></p>
<p dir="auto"><strong>Goal</strong>: Parse CSS rules and apply styles to each node</p>
<p dir="auto">Parse CSS file to extract style rules, then calculate final styles for each DOM node following CSS Cascade rules.</p>
<p dir="auto"><strong>Core Structures/Classes</strong>:</p>
<ul dir="auto">
<li>
<p dir="auto"><code>CSS_RULE</code> (include/css/css_rule.h)</p>
<ul dir="auto">
<li><code>selector</code>: CSS selector (e.g., ".container", "#redBtn")</li>
<li><code>properties</code>: style properties (color, font-size, width, etc.)</li>
</ul>
</li>
<li>
<p dir="auto"><code>COMPUTED_STYLE</code> (include/css/computed_style.h)</p>
<ul dir="auto">
<li>Final style applied to each node</li>
<li>Property examples:
<ul dir="auto">
<li><code>color</code>: text color</li>
<li><code>font_size</code>: font size</li>
<li><code>font_weight</code>: font weight</li>
<li><code>display</code>: BLOCK, INLINE, NONE</li>
<li><code>margin_top/bottom/left/right</code>: margin values</li>
<li><code>padding_top/bottom/left/right</code>: padding values</li>
<li><code>background_color</code>: background color</li>
<li><code>position</code>: Static, Relative, Absolute, Fixed</li>
</ul>
</li>
</ul>
</li>
<li>
<p dir="auto"><code>CSS_PARSER</code> (include/css/css_parser.h, src/css/css_parser.cpp)</p>
<ul dir="auto">
<li>CSS rule parsing</li>
</ul>
</li>
<li>
<p dir="auto"><code>CSSOM</code> (include/css/cssom.h, src/css/cssom.cpp)</p>
<ul dir="auto">
<li>CSS Object Model management</li>
</ul>
</li>
<li>
<p dir="auto"><code>apply_style()</code> (include/css/apply_style.h, src/css/apply_style.cpp)</p>
<ul dir="auto">
<li>Apply CSS rules to DOM nodes</li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Style Calculation Process</strong>:</p>
<div data-snippet-clipboard-copy-content="1. Parse CSS rules → store as CSS_RULE
2. For each NODE:
   - Find matching selectors
   - Calculate specificity (I simplified this)
   - Apply Cascade rules
   - Create COMPUTED_STYLE"><pre><code>1. Parse CSS rules → store as CSS_RULE
2. For each NODE:
   - Find matching selectors
   - Calculate specificity (I simplified this)
   - Apply Cascade rules
   - Create COMPUTED_STYLE
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Stage 4: Layout Calculation</h3><a id="user-content-stage-4-layout-calculation" aria-label="Permalink: Stage 4: Layout Calculation" href="#stage-4-layout-calculation"></a></p>
<p dir="auto"><strong>Goal</strong>: Calculate position and size of each element</p>
<p dir="auto">Based on styled nodes, calculate each element's position (x, y) and dimensions (width, height) on screen.</p>
<p dir="auto"><strong>Core Structs</strong>:</p>
<ul dir="auto">
<li>
<p dir="auto"><code>LAYOUT_BOX</code> (include/css/layout_tree.h)</p>
<ul dir="auto">
<li><code>node</code>: corresponding DOM node</li>
<li><code>style</code>: applied COMPUTED_STYLE</li>
<li><code>x, y</code>: position</li>
<li><code>width, height</code>: dimensions</li>
<li><code>children</code>: child LAYOUT_BOX elements</li>
</ul>
</li>
<li>
<p dir="auto"><code>LINE_STATE</code> (include/css/layout_tree.h)</p>
<ul dir="auto">
<li>Track current state during inline layout calculation</li>
<li><code>current_x, current_y</code>: current position</li>
<li><code>line_height</code>: current line height</li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Helper Functions</strong> (include/css/layout_tree.h, src/css/layout_tree.cpp)</p>
<ul dir="auto">
<li>Role: Generate LAYOUT_BOX tree from DOM nodes</li>
<li>Key functions:
<ul dir="auto">
<li><code>layout_block_element()</code>: calculate block layout</li>
<li><code>layout_inline_element()</code>: calculate inline layout</li>
<li><code>layout_text_element()</code>: calculate text node size</li>
<li><code>layout_image_element()</code>: calculate image element layout</li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Layout Algorithm</strong>:</p>
<div data-snippet-clipboard-copy-content="BLOCK elements:
  - Use full width
  - Children arranged vertically
  
INLINE elements:
  - Arranged horizontally
  - Flow like text
  
Margin/Padding handling:
  - total_width = margin_left + border + padding + content + padding + border + margin_right"><pre><code>BLOCK elements:
  - Use full width
  - Children arranged vertically
  
INLINE elements:
  - Arranged horizontally
  - Flow like text
  
Margin/Padding handling:
  - total_width = margin_left + border + padding + content + padding + border + margin_right
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Stage 5: Rendering (Painting)</h3><a id="user-content-stage-5-rendering-painting" aria-label="Permalink: Stage 5: Rendering (Painting)" href="#stage-5-rendering-painting"></a></p>
<p dir="auto"><strong>Goal</strong>: Draw calculated layout on screen</p>
<p dir="auto">Traverse LAYOUT_BOX tree and render each element graphically.</p>
<p dir="auto"><strong>Core Classes</strong>:</p>
<ul dir="auto">
<li><code>Renderer</code> (include/gui/renderer.h, src/gui/renderer.cpp)
<ul dir="auto">
<li>Role: Draw layout boxes to Qt Graphics</li>
<li>Key methods:
<ul dir="auto">
<li><code>paint_layout()</code>: render entire layout box tree</li>
<li><code>draw_element_box()</code>: draw element box (background, border)</li>
<li><code>draw_text_node()</code>: render text</li>
</ul>
</li>
<li>Uses Qt's <code>QPainter</code> to draw on screen</li>
</ul>
</li>
</ul>
<p dir="auto"><strong>Rendering Order</strong>:</p>
<div data-snippet-clipboard-copy-content="1. Fill background color
2. Draw borders
3. Handle padding area
4. Render text
5. Render images (using cached images)
6. Traverse child elements"><pre><code>1. Fill background color
2. Draw borders
3. Handle padding area
4. Render text
5. Render images (using cached images)
6. Traverse child elements
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Complete Pipeline Flow</h3><a id="user-content-complete-pipeline-flow" aria-label="Permalink: Complete Pipeline Flow" href="#complete-pipeline-flow"></a></p>
<div data-snippet-clipboard-copy-content="HTML String
    ↓
[HTML_TOKENIZER] - Tokenization
    ↓ TOKEN vector
[HTML_PARSER] - DOM Construction
    ↓ NODE tree
[CSS_PARSER + CSSOM + apply_style()] - Style Calculation
    ↓ NODE + COMPUTED_STYLE
[Helper Functions] - Layout
    ↓ LAYOUT_BOX tree
[RENDERER] - Painting
    ↓
Screen Output"><pre><code>HTML String
    ↓
[HTML_TOKENIZER] - Tokenization
    ↓ TOKEN vector
[HTML_PARSER] - DOM Construction
    ↓ NODE tree
[CSS_PARSER + CSSOM + apply_style()] - Style Calculation
    ↓ NODE + COMPUTED_STYLE
[Helper Functions] - Layout
    ↓ LAYOUT_BOX tree
[RENDERER] - Painting
    ↓
Screen Output
</code></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Additional Components</h3><a id="user-content-additional-components" aria-label="Permalink: Additional Components" href="#additional-components"></a></p>
<ul dir="auto">
<li>
<p dir="auto"><strong>IMAGE_CACHE_MANAGER</strong> (include/gui/image_cache_manager.h)</p>
<ul dir="auto">
<li>Cache downloaded images to prevent duplicate loads</li>
<li>Store QPixmap</li>
</ul>
</li>
<li>
<p dir="auto"><strong>MAIN_WINDOW</strong> (include/gui/main_window.h, src/gui/main_window.cpp)</p>
<ul dir="auto">
<li>Qt main window</li>
<li>Provide user interface</li>
</ul>
</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">Project Structure</h3><a id="user-content-project-structure" aria-label="Permalink: Project Structure" href="#project-structure"></a></p>
<div data-snippet-clipboard-copy-content="include/
  ├── html/           # HTML parsing (token.h, node.h, html_tokenizer.h, html_parser.h)
  ├── css/            # CSS parsing &amp; layout (computed_style.h, css_parser.h, layout_tree.h, etc.)
  └── gui/            # Rendering &amp; UI (renderer.h, main_window.h, etc.)

src/
  ├── html/           # HTML parsing implementation
  ├── css/            # CSS &amp; layout implementation
  └── gui/            # Rendering implementation"><pre><code>include/
  ├── html/           # HTML parsing (token.h, node.h, html_tokenizer.h, html_parser.h)
  ├── css/            # CSS parsing &amp; layout (computed_style.h, css_parser.h, layout_tree.h, etc.)
  └── gui/            # Rendering &amp; UI (renderer.h, main_window.h, etc.)

src/
  ├── html/           # HTML parsing implementation
  ├── css/            # CSS &amp; layout implementation
  └── gui/            # Rendering implementation
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Supported CSS Properties</h2><a id="user-content-supported-css-properties" aria-label="Permalink: Supported CSS Properties" href="#supported-css-properties"></a></p>
<p dir="auto">This browser supports the following CSS properties. All property parsing is defined in the <code>COMPUTED_STYLE</code> struct in <a href="https://github.com/beginner-jhj/mini_browser/blob/main/include/css/computed_style.h">include/css/computed_style.h</a>, with implementation in <a href="https://github.com/beginner-jhj/mini_browser/blob/main/src/css/computed_style.cpp">src/css/computed_style.cpp</a>.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Font Properties</h3><a id="user-content-font-properties" aria-label="Permalink: Font Properties" href="#font-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>color</code></td>
<td>Text color</td>
<td>Color name, hex (#RRGGBB)</td>
<td>black</td>
</tr>
<tr>
<td><code>font-size</code></td>
<td>Font size</td>
<td>Number + px (e.g., 16px)</td>
<td>16px</td>
</tr>
<tr>
<td><code>font-weight</code></td>
<td>Font weight</td>
<td>normal, bold, 100-900</td>
<td>normal</td>
</tr>
<tr>
<td><code>font-style</code></td>
<td>Font style</td>
<td>normal, italic</td>
<td>normal</td>
</tr>
<tr>
<td><code>font-family</code></td>
<td>Font name</td>
<td>Font name</td>
<td>Arial</td>
</tr>
<tr>
<td><code>line-height</code></td>
<td>Line height</td>
<td>Number (multiplier)</td>
<td>font-size * 1.5</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Background Properties</h3><a id="user-content-background-properties" aria-label="Permalink: Background Properties" href="#background-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>background-color</code></td>
<td>Background color</td>
<td>Color name, hex (#RRGGBB)</td>
<td>transparent</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Dimension Properties</h3><a id="user-content-dimension-properties" aria-label="Permalink: Dimension Properties" href="#dimension-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>width</code></td>
<td>Element width</td>
<td>Number + px, auto</td>
<td>auto (-1)</td>
</tr>
<tr>
<td><code>height</code></td>
<td>Element height</td>
<td>Number + px, auto</td>
<td>auto (-1)</td>
</tr>
<tr>
<td><code>box-sizing</code></td>
<td>Box sizing method</td>
<td>content-box, border-box</td>
<td>content-box</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Margin/Padding Properties</h3><a id="user-content-marginpadding-properties" aria-label="Permalink: Margin/Padding Properties" href="#marginpadding-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>margin-top</code></td>
<td>Top margin</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>margin-right</code></td>
<td>Right margin</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>margin-bottom</code></td>
<td>Bottom margin</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>margin-left</code></td>
<td>Left margin</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>margin</code></td>
<td>Margin shorthand</td>
<td>1-4 values</td>
<td>0</td>
</tr>
<tr>
<td><code>padding-top</code></td>
<td>Top padding</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>padding-right</code></td>
<td>Right padding</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>padding-bottom</code></td>
<td>Bottom padding</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>padding-left</code></td>
<td>Left padding</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>padding</code></td>
<td>Padding shorthand</td>
<td>1-4 values</td>
<td>0</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><strong>Shorthand Examples</strong>:</p>
<ul dir="auto">
<li><code>margin: 10px;</code> → 10px on all sides</li>
<li><code>margin: 10px 20px;</code> → 10px top/bottom, 20px left/right</li>
<li><code>margin: 10px 20px 30px;</code> → 10px top, 20px left/right, 30px bottom</li>
<li><code>margin: 10px 20px 30px 40px;</code> → 10px top, 20px right, 30px bottom, 40px left</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">Border Properties</h3><a id="user-content-border-properties" aria-label="Permalink: Border Properties" href="#border-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>border-width</code></td>
<td>Border width</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>border-color</code></td>
<td>Border color</td>
<td>Color name, hex (#RRGGBB)</td>
<td>black</td>
</tr>
<tr>
<td><code>border-style</code></td>
<td>Border style</td>
<td>solid, dashed, dotted, etc.</td>
<td>solid</td>
</tr>
<tr>
<td><code>border</code></td>
<td>Border shorthand</td>
<td>width color style</td>
<td>0 black solid</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Layout Properties</h3><a id="user-content-layout-properties" aria-label="Permalink: Layout Properties" href="#layout-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>display</code></td>
<td>Display type</td>
<td>block, inline, none</td>
<td>inline</td>
</tr>
<tr>
<td><code>position</code></td>
<td>Position type</td>
<td>static, relative, absolute, fixed</td>
<td>static</td>
</tr>
<tr>
<td><code>top</code></td>
<td>Top position (relative, absolute, fixed)</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>right</code></td>
<td>Right position (relative, absolute, fixed)</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>bottom</code></td>
<td>Bottom position (relative, absolute, fixed)</td>
<td>Number + px</td>
<td>0</td>
</tr>
<tr>
<td><code>left</code></td>
<td>Left position (relative, absolute, fixed)</td>
<td>Number + px</td>
<td>0</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Text Properties</h3><a id="user-content-text-properties" aria-label="Permalink: Text Properties" href="#text-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>text-align</code></td>
<td>Text alignment</td>
<td>left, center, right, justify</td>
<td>left</td>
</tr>
<tr>
<td><code>text-decoration</code></td>
<td>Text decoration</td>
<td>none, underline, line-through, overline</td>
<td>none</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Other Properties</h3><a id="user-content-other-properties" aria-label="Permalink: Other Properties" href="#other-properties"></a></p>
<markdown-accessiblity-table><table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Possible Values</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>opacity</code></td>
<td>Opacity</td>
<td>0 - 1</td>
<td>1</td>
</tr>
<tr>
<td><code>visibility</code></td>
<td>Element visibility</td>
<td>visible, hidden (true/false)</td>
<td>visible</td>
</tr>
</tbody>
</table></markdown-accessiblity-table>
<p dir="auto"><h3 tabindex="-1" dir="auto">Implementation Details</h3><a id="user-content-implementation-details" aria-label="Permalink: Implementation Details" href="#implementation-details"></a></p>
<p dir="auto"><strong>Property Parsing &amp; Setting</strong> (<a href="https://github.com/beginner-jhj/mini_browser/blob/main/src/css/computed_style.cpp">src/css/computed_style.cpp</a>):</p>
<ul dir="auto">
<li><code>init_setters()</code>: Register setter functions for all CSS properties</li>
<li><code>parse_color()</code>: Parse color values (hex, named colors)</li>
<li><code>parse_font_size()</code>: Parse font size</li>
<li><code>parse_string_to_float()</code>: Parse numeric values</li>
<li><code>parse_display_type()</code>: Parse display values</li>
<li><code>parse_text_align()</code>: Parse text-align values</li>
<li><code>parse_box_sizing()</code>: Parse box-sizing values</li>
<li><code>parse_text_decoration()</code>: Parse text-decoration values</li>
<li><code>parse_position_type()</code>: Parse position values</li>
<li><code>parse_spacing_shorthand()</code>: Parse margin/padding shorthand</li>
</ul>
<p dir="auto"><strong>Style Inheritance</strong> (<a href="https://github.com/beginner-jhj/mini_browser/blob/main/src/css/computed_style.cpp">src/css/computed_style.cpp</a>):</p>
<ul dir="auto">
<li><code>inherit_color()</code></li>
<li><code>inherit_font_size()</code></li>
<li><code>inherit_font_weight()</code></li>
<li><code>inherit_font_style()</code></li>
<li><code>inherit_font_family()</code></li>
<li><code>inherit_line_height()</code></li>
<li><code>inherit_text_align()</code></li>
<li><code>inherit_visibility()</code></li>
<li><code>inherit_text_decoration()</code></li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Challenges &amp; Solutions</h2><a id="user-content-challenges--solutions" aria-label="Permalink: Challenges &amp; Solutions" href="#challenges--solutions"></a></p>
<p dir="auto">I was new to C++, and unexpected problems and bugs appeared continuously from start to finish. While some issues remain unresolved, I'll share the 3 most difficult challenges and how I overcame them.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">1. String Parsing (HTML Tokenization, CSS Parsing)</h3><a id="user-content-1-string-parsing-html-tokenization-css-parsing" aria-label="Permalink: 1. String Parsing (HTML Tokenization, CSS Parsing)" href="#1-string-parsing-html-tokenization-css-parsing"></a></p>
<p dir="auto"><strong>The Challenge:</strong></p>
<p dir="auto">Writing parsers required managing many different states. HTML parsing needed to handle start tags, end tags, text, comments—so many cases. I had no idea how to even start.</p>
<p dir="auto"><strong>The Solution:</strong></p>
<p dir="auto">I read two key articles to understand parser fundamentals:</p>
<ul dir="auto">
<li><a href="https://scrapingant.com/blog/c-plus-plus-parse-html" rel="nofollow">https://scrapingant.com/blog/c-plus-plus-parse-html</a></li>
<li><a href="https://kangdanne.tistory.com/331" rel="nofollow">https://kangdanne.tistory.com/331</a></li>
</ul>
<p dir="auto">After understanding the basic principles, I wrote a few simple parsers myself. Once comfortable with how parsers work, I could independently write the complete CSS parsing logic.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">2. Rendering</h3><a id="user-content-2-rendering" aria-label="Permalink: 2. Rendering" href="#2-rendering"></a></p>
<p dir="auto"><strong>The Challenge:</strong></p>
<p dir="auto">Rendering required managing even more states than parsing. <code>LINE_STATE</code>, <code>LAYOUT_BOX</code>—complex state tracking. I had to implement recursion, which I wasn't familiar with. Plus, I needed to handle different element types (boxes, inline, text) separately.</p>
<p dir="auto"><strong>The Solution:</strong></p>
<p dir="auto">I used Claude AI extensively to understand rendering logic and reviewed the generated code carefully. Rather than using AI code directly, I reviewed it thoroughly and asked questions to understand the underlying principles. After becoming comfortable with rendering logic, I could modify the codebase and fix bugs, which proved I truly understood it.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">3. Image Caching &amp; Layout Reflowing</h3><a id="user-content-3-image-caching--layout-reflowing" aria-label="Permalink: 3. Image Caching &amp; Layout Reflowing" href="#3-image-caching--layout-reflowing"></a></p>
<p dir="auto"><strong>The Challenge:</strong></p>
<p dir="auto">Fetching HTTP/HTTPS images from external servers was the most complex part. I couldn't stop layout calculation while downloading images, so I needed to understand asynchronous processing. While I theoretically understood image caching and reflowing, implementation required considering so many details.</p>
<p dir="auto"><strong>The Solution:</strong></p>
<p dir="auto">I invested 3-5 hours designing a solid, robust image caching/reflowing system. With proper architecture in place, implementation became much easier. Through this process, I clearly understood the difference between multithreading async and non-blocking I/O async.</p>
<hr>
<p dir="auto">Overcoming these three challenges taught me more than just technical skills—it taught me <strong>how to approach problems and the importance of design</strong>. While not perfect, this is the project's greatest value.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">What I Learned</h2><a id="user-content-what-i-learned" aria-label="Permalink: What I Learned" href="#what-i-learned"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Technical Knowledge</h3><a id="user-content-technical-knowledge" aria-label="Permalink: Technical Knowledge" href="#technical-knowledge"></a></p>
<p dir="auto">Through this project, I gained hands-on understanding of <strong>how real browsers work</strong>. Beyond the concept of "browsers render HTML," I now understand how tokenization, layout calculation, and final rendering stages interact. This will help me predict browser behavior and optimize performance in future web development.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">More Importantly: Software Engineering Skills</h3><a id="user-content-more-importantly-software-engineering-skills" aria-label="Permalink: More Importantly: Software Engineering Skills" href="#more-importantly-software-engineering-skills"></a></p>
<p dir="auto">But the most valuable lessons transcended this specific project:</p>
<p dir="auto"><strong>1. Systematic Debugging</strong></p>
<p dir="auto">When facing endless bugs, I learned not to randomly fix code but to form hypotheses and test them. Through proper logging, I tracked program state and systematically identified where problems occurred. This debugging discipline will serve me across all programming languages.</p>
<p dir="auto"><strong>2. Persistence &amp; Grit</strong></p>
<p dir="auto">Many times I wanted to give up when problems remained unsolved for days. But by breaking problems into pieces and accumulating small progress, I eventually overcame them. I realized this persistence is essential for success in any field.</p>
<p dir="auto"><strong>3. The Value of Pragmatism</strong></p>
<p dir="auto">Perfect software doesn't exist. This browser still lacks support for many CSS properties and HTML elements, and has various bugs. But I learned that shipping imperfect but working software beats chasing ideal perfection. This pragmatism is crucial in the real software industry.</p>
<p dir="auto"><strong>4. The Power of "Why?"</strong></p>
<p dir="auto">When receiving code from AI or tutorials, I didn't just check if it worked. I constantly asked "Why does this work?", "Is this part really necessary?", "Are there alternative approaches?" This curiosity and deep exploration led to understanding principles, not just surface-level learning.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Closing Thoughts</h2><a id="user-content-closing-thoughts" aria-label="Permalink: Closing Thoughts" href="#closing-thoughts"></a></p>
<p dir="auto">The greatest achievement of this project isn't the completed browser.</p>
<p dir="auto"><strong>It's developing problem-solving ability.</strong></p>
<p dir="auto">Systematic debugging, persistent effort, "completion over perfection" pragmatism,
and the habit of always asking "Why?"</p>
<p dir="auto">These will help me tackle every problem I face ahead.</p>
<hr>
<p dir="auto">Honestly, experienced developers might complete this more elegantly,</p>
<p dir="auto">but to a student new to C++, <strong>it seemed nearly impossible</strong>.</p>
<p dir="auto">Yet I still took on the challenge. Why?</p>
<p dir="auto">It was simple:</p>
<ul dir="auto">
<li>I was curious</li>
<li>It looked fun</li>
<li>I thought I could do it</li>
</ul>
<p dir="auto">So I created a folder, opened an editor, and started coding.</p>
<div dir="auto" data-snippet-clipboard-copy-content="mkdir mini_browser
cd mini_browser
# Let's go"><pre>mkdir mini_browser
<span>cd</span> mini_browser
<span><span>#</span> Let's go</span></pre></div>
<p dir="auto">There were many difficulties.
5-hour debugging sessions. 3-day unsolved bugs.</p>
<p dir="auto">But 8 weeks later, I have a working browser.</p>
<hr>
<p dir="auto"><strong>Are you facing something that seems impossible right now?</strong></p>
<p dir="auto">Just start.</p>
<p dir="auto">Imperfect is okay.
Slow is okay.
Stuck is okay.</p>
<p dir="auto"><strong>Without starting, it stays impossible forever.
With starting, it becomes possible.</strong></p>
<p dir="auto">Thank you for reading this long journey. 🚀</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[ICE and Palantir: US agents using health data to hunt illegal immigrants (430 pts)]]></title>
            <link>https://www.bmj.com/content/392/bmj.s168</link>
            <guid>46794365</guid>
            <pubDate>Wed, 28 Jan 2026 12:18:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bmj.com/content/392/bmj.s168">https://www.bmj.com/content/392/bmj.s168</a>, See on <a href="https://news.ycombinator.com/item?id=46794365">Hacker News</a></p>
Couldn't get https://www.bmj.com/content/392/bmj.s168: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: The HN Arcade (311 pts)]]></title>
            <link>https://andrewgy8.github.io/hnarcade/</link>
            <guid>46793693</guid>
            <pubDate>Wed, 28 Jan 2026 10:50:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://andrewgy8.github.io/hnarcade/">https://andrewgy8.github.io/hnarcade/</a>, See on <a href="https://news.ycombinator.com/item?id=46793693">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>HN Arcade — A directory of games from Hacker News Show HN.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[I Stopped Following the News (140 pts)]]></title>
            <link>https://mertbulan.com/2026/01/28/why-i-stopped-following-the-news/</link>
            <guid>46792580</guid>
            <pubDate>Wed, 28 Jan 2026 08:33:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mertbulan.com/2026/01/28/why-i-stopped-following-the-news/">https://mertbulan.com/2026/01/28/why-i-stopped-following-the-news/</a>, See on <a href="https://news.ycombinator.com/item?id=46792580">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
  <article>
    <p>If I have to pick my favourite German word, I would probably pick “neugierig” because it describes me very well. It means curious, but that is not the literal meaning. Like many German words, it comes from two parts: neu and gierig. Neu means new, and gierig means greedy. So the literal idea behind neugierig is being greedy for new things. That fits me well.</p>

<p>I really enjoy learning new things. That is why I read a lot, watch documentaries, and explore different topics. I am greedy for new information. This also includes what is happening around the world.</p>

<p>For years, I followed the news to keep an eye on what was happening in my country, in the world, and in the tech industry. I curated a list of sources that matched my taste, from international newspapers to YouTube channels, Reddit, and tech-focused websites. Every day, I checked these sources through their websites or my RSS reader to stay up to date.</p>

<p>At the end of last year, I had some time to reflect on my habits. I thought about what makes me happy, what makes me stressed, and how the things I do every day contribute to my goals.</p>

<p>When I looked at the time I spent reading the news and how I felt afterward, I realised it was not helping me at all. Most of the time, I felt more stressed than informed. I also noticed that almost every source focuses heavily on negative stories, simply because those attract more attention and clicks.</p>

<p>When it comes to world news, I started to see the same patterns repeating. A lot of headlines about political figures, conflicts far away, and problems I have no control over. I asked myself how much of this actually affects my daily life, and I could not come up with a good answer. Many things are happening in the world, but they rarely change anything in my day-to-day routine. That made me question why I was following them so closely.</p>

<p>The same applies to tech news. Most of it revolves around big personalities, constant AI updates, startups getting acquired, people becoming rich, hardware I will probably never buy, and rumours about products that may never be released. In most cases, none of this has any real impact on my life. New technologies are usually easy to learn when they become relevant, and it is hard to know which ones will still matter in a few years.</p>

<p>After thinking about whether I really need to follow the news, I decided that I do not. This does not mean I do not care about the world or the tech industry. I am just not interested in following daily updates that do not add much value to my life.</p>

<p>One thing I am still interested in is what is happening in my city. For that, I recently discovered a newsletter from Die Zeit called <a rel="nofollow noopener" target="_blank" href="https://www.zeit.de/serie/elbvertiefung">Elbvertiefung</a>. Every weekday at 6 AM, they send a short newsletter about what happened in Hamburg, and sometimes they also recommend a book or a new restaurant or cafe. I start my day by reading it. Since it is in German, it also helps me improve my language skills.</p>

<p>For the rest of the news, I am considering subscribing to a magazine that covers important events in Germany, the EU, or the world every few months. This kind of format filters out short-term noise and fear-driven stories. These publications usually make money by selling the magazine rather than ads, so they tend to focus more on quality. (If you have any recommendations, feel free to <a href="https://mertbulan.com/contact">reach out</a>.)</p>

<p>At the beginning of this year, I decided to stop following the news. As a result, I started reading more. Last year, I finished 20 books. This year, just in January, I finished 7 books. I still satisfy my curiosity and learn new things, but I just changed the medium. And I feel much better because of it.</p>

  </article>
</div><div id="mc_embed_shell">
    <p>If you liked this article, subscribe to get notified by email whenever a new one is published!</p>

    
    
    
    
  </div><div>
      <p><a href="https://mertbulan.com/2026/01/22/when-the-tech-industry-becomes-disgusting/">
        <img data-src="/images/posts/when-the-tech-industry-becomes-disgusting.webp" alt="Why I Stopped Following the News" src="https://mertbulan.com/images/posts/when-the-tech-industry-becomes-disgusting.webp">
      </a></p>
    </div></div>]]></description>
        </item>
    </channel>
</rss>