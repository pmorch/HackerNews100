<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 25 Sep 2024 17:30:11 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[The lost language extensions of MetaWare's High C compiler (2023) (102 pts)]]></title>
            <link>https://duriansoftware.com/joe/the-lost-language-extensions-of-metaware%27s-high-c-compiler</link>
            <guid>41647843</guid>
            <pubDate>Wed, 25 Sep 2024 14:19:13 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://duriansoftware.com/joe/the-lost-language-extensions-of-metaware%27s-high-c-compiler">https://duriansoftware.com/joe/the-lost-language-extensions-of-metaware%27s-high-c-compiler</a>, See on <a href="https://news.ycombinator.com/item?id=41647843">Hacker News</a></p>
Couldn't get https://duriansoftware.com/joe/the-lost-language-extensions-of-metaware%27s-high-c-compiler: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Why I still blog after 15 years (202 pts)]]></title>
            <link>https://www.jonashietala.se/blog/2024/09/25/why_i_still_blog_after_15_years/</link>
            <guid>41646531</guid>
            <pubDate>Wed, 25 Sep 2024 12:19:29 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.jonashietala.se/blog/2024/09/25/why_i_still_blog_after_15_years/">https://www.jonashietala.se/blog/2024/09/25/why_i_still_blog_after_15_years/</a>, See on <a href="https://news.ycombinator.com/item?id=41646531">Hacker News</a></p>
Couldn't get https://www.jonashietala.se/blog/2024/09/25/why_i_still_blog_after_15_years/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Who Is Marcellus Williams: Execution in Missouri Despite Evidence of Innocence (131 pts)]]></title>
            <link>https://innocenceproject.org/who-is-marcellus-williams-man-facing-execution-in-missouri-despite-dna-evidence-supporting-innocence/</link>
            <guid>41646420</guid>
            <pubDate>Wed, 25 Sep 2024 12:05:18 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://innocenceproject.org/who-is-marcellus-williams-man-facing-execution-in-missouri-despite-dna-evidence-supporting-innocence/">https://innocenceproject.org/who-is-marcellus-williams-man-facing-execution-in-missouri-despite-dna-evidence-supporting-innocence/</a>, See on <a href="https://news.ycombinator.com/item?id=41646420">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                <p><strong>Article updated on Sept. 18, 2024.</strong></p>
<p><span><strong>Case update from Sept. 12</strong>: The Circuit Court for St. Louis County, Missouri denied Prosecuting Attorney Wesley Bell’s motion to vacate <a href="https://innocenceproject.org/court-denies-prosecutors-motion-to-vacate-marcellus-williams-conviction-and-death-sentence/" target="_blank" rel="noopener"><span>Marcellus Williams’</span></a> conviction and death sentence.&nbsp;</span></p>
<p><span><strong>Case update from July 2</strong>: The Circuit Court of St. Louis County, Missouri, scheduled a hearing for August 21, 2024, to assess the “clear and convincing evidence” of actual innocence that led Prosecuting Attorney Wesley Bell to move to vacate Marcellus Williams’ wrongful conviction and death sentence.</span></p>
<p><span>There is no reliable evidence proving that <a href="https://innocenceproject.org/petitions/stop-the-execution-of-marcellus-williams-an-innocent-man/" target="_blank" rel="noopener"><span>Marcellus Williams</span></a> committed the crime for which he is scheduled to be executed on Sept. 24. The State destroyed or corrupted the evidence that could conclusively prove his innocence and the available DNA and other forensic crime-scene evidence does not match him.&nbsp;</span></p>
<p><span>Even the victim’s family believes life without parole is the appropriate sentence.&nbsp;</span></p>
<p><span><strong>Time is running out to stop Missouri from executing an innocent person on Sept. 24.</strong> Now it’s up to Gov. Mike Parson to grant clemency and commute Mr. Williams’ sentence to life without parole, or, at a minimum, stay the execution for further appeals to be resolved.&nbsp;</span></p>
<p><strong><span>Here’s what you need to know about his case:</span></strong></p>
<h4><b></b><span><b>1. A crime scene covered with forensic evidence contained no link to Mr. Williams.</b></span></h4>
<p><span>Mr. Williams has been seeking to prove his innocence throughout the 23 years he has spent on Missouri’s death row. On August 11, 1998, Felicia Gayle, a former reporter for the St. Louis Post-Dispatch, was found stabbed to death in her home. The perpetrator left behind considerable forensic evidence, including fingerprints, footprints, hair, and trace <a href="https://dpic-cdn.org/production/legacy/MarcellusWilliamsBoardOfInquiryLetter.pdf" target="_blank" rel="noopener"><span>DNA on the murder weapon</span></a>, a knife from Ms. Gayle’s kitchen. <b>None of this forensic evidence matches Mr. Williams.&nbsp;</b></span></p>
<h4><b></b><span><b>2. The prosecution’s case against Mr. Williams was based entirely on the unreliable testimony of two incentivized witnesses.</b></span></h4>
<p><span>The case against Mr. Williams turned on the testimony of two unreliable witnesses who were incentivized by promises of leniency in their own pending criminal cases and reward money. The investigation had gone cold until a jail inmate named Henry Cole, a man with a lengthy record, claimed that Mr. Williams confessed to him that he committed the murder while they were both locked up in jail. Cole directed police to Laura Asaro, a woman who had briefly dated Mr. Williams and had an extensive record of her own.&nbsp;</span></p>
<p><span>Both of these individuals were known fabricators; neither revealed any information that was not either included in media accounts about the case or already known to the police. Their statements were inconsistent with their own prior statements, with each other’s accounts, and with the crime scene evidence, and none of the information they provided could be independently verified. Aside from their testimony, the only evidence connecting Mr. Williams to the crime was a witness who said Mr. Williams sold him a laptop taken from Ms. Gayle’s home, but the jury did not learn that Mr. Williams told the witness he had received the laptop from Laura Asaro.</span></p>
<h4><strong><span>3. Mr. Williams has repeatedly faced imminent execution as he has tried to prove his innocence.</span></strong></h4>
<p><span>Nine years ago, the Missouri Supreme Court stayed Mr. Williams’s execution and appointed a special master to review DNA testing of potentially exculpatory evidence. The DNA testing conducted in 2016 showed that Mr. Williams was not the source of male DNA found on the murder weapon.&nbsp;</span></p>
<p><span>However, in 2017, after the testing was completed but without conducting a hearing or making any findings based on the outcome of the testing, the appointed special master sent Mr. Williams’s case back to the Missouri Supreme Court. That court, also without considering the DNA testing results, again scheduled Mr. Williams’s execution. On Aug. 22, 2017, mere hours before he was to be executed and after eating his last meal, Mr. Williams received a stay of execution from then-Governor Eric Greitens.</span></p>
<p><span>Governor Greitens recognized that the new DNA results raised serious doubts about Mr. Williams’s guilt, and he convened a Board of Inquiry to investigate the case. Under Missouri law, the stay was to remain in place until the Board of Inquiry concluded its review and issued a formal report.&nbsp;</span></p>
<p><span>However, in June 2023, while the Board of Inquiry’s review remained ongoing, Governor Mike Parson without warning or notice dissolved the Board without a report or recommendation from the Board. Immediately after Governor Parson dissolved the Board of Inquiry, Missouri Attorney General Andrew Bailey sought a new execution date.&nbsp;</span></p>
<p><span>Mr. Williams filed a civil suit against Governor Parson because the dissolution of the Board without a report or recommendation violated Missouri law and Mr. Williams’s constitutional rights. After a Cole County judge denied the Governor’s motion to dismiss this lawsuit, the Governor persuaded the Missouri Supreme Court to intervene.&nbsp;</span></p>
<p><span>On June 4, 2024, the Missouri Supreme Court dismissed Mr. Williams’s civil lawsuit and immediately scheduled his execution for Sept. 24.</span></p>
<h4><strong><span>4. Although the victim’s family opposes Mr. Williams’ execution, the Missouri Attorney General has continued to fight to execute him.</span></strong></h4>
<p><span>After the corruption of the key DNA evidence came to light, Mr. Williams and the St. Louis County Prosecuting Attorney’s Office reached an agreement to ensure Mr. Williams is not wrongfully executed. Mr. Williams agreed to enter an Alford plea, admitting that the State has sufficient evidence to support his conviction, in exchange for a sentence of life without parole.&nbsp;</span></p>
<p><span>The victim’s family supported this resolution of Mr. Williams’ case and have said they do not want Mr. Williams to be executed. On Aug. 21 the circuit court entered the consent judgment based on the parties’ agreement.</span></p>
<p><span>Despite the closure this resolution would have brought to the case, Missouri Attorney General Andrew Bailey sought a writ of prohibition from the Missouri Supreme Court, which that court granted, ordering the circuit court to hold the previously scheduled evidentiary hearing.</span></p>
<p><span>The circuit court held an evidentiary hearing on August 28 and subsequently ruled that it lacked sufficient evidence on which to find that Mr. Williams is innocent, and that his claims of racially biased jury selection and ineffective assistance of counsel had previously been raised and rejected. Accordingly, the court denied Prosecuting Attorney Bell’s motion to vacate Mr. Williams’ conviction.</span></p>
<p><span>The Prosecuting Attorney is appealing that ruling to the Missouri Supreme Court.</span></p>
<h4><span><b>5. Incentivized informants are a leading cause of wrongful convictions.</b></span></h4>
<p><span><b>&nbsp;</b></span><span>Jailhouse informant testimony, like that leading to Mr. Williams’ conviction, is one of the leading contributing factors of wrongful convictions nationally, playing a role in <a href="https://www.law.umich.edu/special/exoneration/Pages/detaillist.aspx?View=%7BFAF6EDDB-5A68-4F8F-8A52-2C61F5BF9EA7%7D&amp;FilterField1=DNA&amp;FilterValue1=8%5FDNA&amp;FilterField2=Group&amp;FilterValue2=JI" target="_blank" rel="noopener"><span>15% of the 598</span></a> DNA-based exoneration cases. <a href="https://www.law.umich.edu/special/exoneration/Pages/detaillist.aspx?View=%7BFAF6EDDB-5A68-4F8F-8A52-2C61F5BF9EA7%7D&amp;FilterField1=ST&amp;FilterValue1=MO&amp;FilterField2=Group&amp;FilterValue2=JI" target="_blank" rel="noopener"><span>Eleven</span></a> of the 54 individuals exonerated in Missouri were convicted with the use of informant testimony.&nbsp;</span></p>
<p><span>In capital cases, false testimony from incentivized witnesses is the leading cause of wrongful convictions, with informant testimony present in 49.5% of wrongful convictions since the mid-1970s, according to the Center on Wrongful Convictions.&nbsp;</span></p>
<h4><b></b><span><b>6. Racial bias contributed to Mr. Williams’ wrongful conviction.</b></span></h4>
<p><span>Mr. Williams, a Black man, was wrongfully convicted of murdering a white woman. His jury was comprised of 11 white people and only one Black person. The prosecutor, whose institutional practice of racially discriminatory jury selection has been widely <a href="https://www.riverfronttimes.com/news/how-missouri-prosecutors-get-away-with-striking-black-jurors-38943100" target="_blank" rel="noopener"><span>documented</span></a>, successfully removed six of seven qualified Black prospective jurors with peremptory challenges. A <a href="https://deathpenaltyinfo.org/news/new-study-finds-significant-race-of-victim-disparities-in-st-louis-county-death-sentencing" target="_blank" rel="noopener"><span>recent study</span></a> of 400 death-eligible cases in St. Louis County over a 27-year period also revealed racial disparity in the use of the death penalty based upon the race of the victim. People who were convicted were 3.5 times more likely to receive the death penalty if the victim was white, as in this case, compared to if the victim was Black.&nbsp;</span></p>
<h4><b></b><span><b>7. Mr. Williams is devoutly religious and an accomplished poet.</b></span></h4>
<p><span>During his 23 years in prison, Mr. Williams has devoted much of his time to studying Islam and <a href="https://innocenceproject.org/marcellus-williams-on-death-row-poetry-is-a-lifeline/" target="_blank" rel="noopener"><span>writing poetry</span></a>. He serves as the imam for Muslim prisoners at Potosi Correctional Center and is known a</span><span>s “Khaliifah,” meaning leader in Arabic. </span><span>He has an exemplary prison record and is widely respected within the prison community and beyond.</span></p>
<h4><b></b><span><b>8. You can help stop Mr. Williams’ unjust execution.&nbsp;</b></span></h4>
<p><span>We have until Sept. 24 at 6 p.m. to stop Mr. Williams’ execution. Here’s how you can help stop this irreversible injustice:</span></p>
<ol>
<li><a href="https://innocenceproject.org/petitions/call-gov-parson-to-stop-the-sept-24-execution-of-marcellus-williams-417-373-3400/" target="_blank" rel="noopener">Call Gov. Parson at 417-373-3400</a></li>
<li><span><a href="https://innocenceproject.org/petitions/stop-the-execution-of-marcellus-williams-an-innocent-man/" target="_blank" rel="noopener"><span>Sign the petition to stop Mr. Williams’ execution</span></a></span><span>.</span></li>
<li><span>Share Mr. Williams’ case on all social media channels using <a href="https://socialpresskit.com/savemarcellus" target="_blank" rel="noopener">our social media toolkit</a>.&nbsp;</span></li>
<li><span>Use your voice<b> —&nbsp;</b>create an Instagram post, reel, or TikTok to share the background of Mr. Williams’ case, the reasons he’s innocent, and all the missteps in this miscarriage of justice, and urge your followers to sign our petition.</span></li>
</ol>
<p><span>With the weight of this new evidence and the unreliability of the witnesses who testified against Mr. Williams, his conviction must be reevaluated to ensure that justice is truly served. Dedicated professionals from the Innocence Project, <a href="https://themip.org/" target="_blank" rel="noopener"><span>Midwest Innocence Project</span></a>, and Bryan Cave, along with attorneys Larry Komp <span>of the Federal Public Defender, Western District of Missouri, </span> and Kent Gipson, make up the team that continues to fight to stop his Sept. 24 execution. They hope that justice will eventually prevail by way of an exoneration.</span></p>
<p>_______________________________________________________________________</p>
      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Global EV Charging Points with Open Charge Map (117 pts)]]></title>
            <link>https://tech.marksblogg.com/open-charge-map-global-ev-charging-point-dataset.html</link>
            <guid>41645759</guid>
            <pubDate>Wed, 25 Sep 2024 10:24:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://tech.marksblogg.com/open-charge-map-global-ev-charging-point-dataset.html">https://tech.marksblogg.com/open-charge-map-global-ev-charging-point-dataset.html</a>, See on <a href="https://news.ycombinator.com/item?id=41645759">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="article_text">
            <p>Open Charge Map (OCM) aims to document the world's Electric Vehicle (EV) Charging Points. To date, they have produced a dataset of over 200K+ charging point locations around the world. Data is sourced both from volunteers as well as official sources.</p>
<p>The project is led by <a href="https://www.linkedin.com/in/webprofusion/">Christopher Cook</a>, a software developer from Perth, Australia, who has been working on OCM since its inception in 2011.</p>
<p>Below is a heat map of the OCM dataset.</p>
<p><a href="https://tech.marksblogg.com/theme/images/openchargemap.opertional.jpg"><img alt="Operational Charge Points around the World." src="https://tech.marksblogg.com/theme/images/openchargemap.opertional.jpg"></a></p><p>In the EU at least, Charge Point Location density resembles that of the population density map for this region.</p>
<p><a href="https://tech.marksblogg.com/theme/images/openchargemap.opertional.europe.jpg"><img alt="Operational Charge Points in Europe, the Middle East and North Africa" src="https://tech.marksblogg.com/theme/images/openchargemap.opertional.europe.jpg"></a></p><p>When you open the OCM website or app, you'll see a map of charging points.</p>
<p><a href="https://tech.marksblogg.com/theme/images/openchargemap.overview.png"><img alt="Open Charge Map Overview" src="https://tech.marksblogg.com/theme/images/openchargemap.overview.png"></a></p><p>Each point contains information on the number of station / bays available at the charging location as well as the sockets supported and power delivery. There will be an indication if the station is operational or not, if it's accessible to the public and pricing details.</p>
<p><a href="https://tech.marksblogg.com/theme/images/openchargemap.location.png"><img alt="Open Charge Map Location Details" src="https://tech.marksblogg.com/theme/images/openchargemap.location.png"></a></p><p>Users can also submit photographs of the location, its equipment and the surrounding area.</p>
<p><a href="https://tech.marksblogg.com/theme/images/openchargemap.photo.png"><img alt="Open Charge Map Location Photo" src="https://tech.marksblogg.com/theme/images/openchargemap.photo.png"></a></p><p>In this blog post, I'll walk through making the OCM dataset analytics-ready and walk through some analysis of the dataset.</p>
<div id="my-workstation">
<h2>My Workstation</h2>
<p>I'm using a 6 GHz Intel Core <a href="https://www.intel.com/content/www/us/en/products/sku/236773/intel-core-i9-processor-14900k-36m-cache-up-to-6-00-ghz/specifications.html">i9-14900K</a> CPU. It has 8 performance cores and 16 efficiency cores with a total of 32 threads and 32 MB of L2 cache. It has a liquid cooler attached and is housed in a spacious, full-sized, Cooler Master HAF 700 computer case. I've come across videos on YouTube where people have managed to overclock the i9-14900KF to <a href="https://www.youtube.com/watch?v=fb7pl7PZOYo">9.1 GHz</a>.</p>
<p>The system has 48 GB of DDR5 RAM clocked at 5,200 MHz and a 5th-generation, Crucial T700 4 TB NVMe M.2 SSD which can read at speeds up to 12,400 MB/s. There is a heatsink on the SSD to help keep its temperature down. This is my system's C drive.</p>
<p>There is also an 8 TB mechanical disk that I use to hold GIS datasets. This is my system's F drive.</p>
<p>The system is powered by a 1,200-watt, fully modular, Corsair Power Supply and is sat on an ASRock Z790 Pro RS Motherboard.</p>
<p>I'm running Ubuntu 22 LTS via Microsoft's Ubuntu for Windows on Windows 11 Pro. In case you're wondering why I don't run a Linux-based desktop as my primary work environment, I'm still using an Nvidia GTX 1080 GPU which has better driver support on Windows and I use ArcGIS Pro from time to time which only supports Windows natively.</p>
</div>
<div id="installing-prerequisites">
<h2>Installing Prerequisites</h2>
<p>I'll first install some dependencies.</p>
<div><pre><span></span>$<span> </span>sudo<span> </span>apt<span> </span>update
$<span> </span>sudo<span> </span>apt<span> </span>install<span> </span><span>\</span>
<span>    </span>git<span> </span><span>\</span>
<span>    </span>jq<span> </span><span>\</span>
<span>    </span>libimage-exiftool-perl<span> </span><span>\</span>
<span>    </span>python3-virtualenv
</pre></div>
<p>Below I'll set up the Python Virtual Environment.</p>
<div><pre><span></span>$<span> </span>virtualenv<span> </span>~/.ev
$<span> </span><span>source</span><span> </span>~/.ev/bin/activate
$<span> </span>python<span> </span>-m<span> </span>pip<span> </span>install<span> </span><span>\</span>
<span>    </span>rich
</pre></div>
<p>Below I'll download and install v0.10.1 of the official binary for DuckDB.</p>
<div><pre><span></span>$<span> </span><span>cd</span><span> </span>~
$<span> </span>wget<span> </span>-c<span> </span>https://github.com/duckdb/duckdb/releases/download/v0.10.1/duckdb_cli-linux-amd64.zip
$<span> </span>unzip<span> </span>-j<span> </span>duckdb_cli-linux-amd64.zip
$<span> </span>chmod<span> </span>+x<span> </span>duckdb
</pre></div>
<p>I'll install a few extensions for DuckDB and make sure they load automatically each time I launch the client.</p>

<div><pre><span></span><span>INSTALL</span><span> </span><span>json</span><span>;</span>
<span>INSTALL</span><span> </span><span>parquet</span><span>;</span>
<span>INSTALL</span><span> </span><span>spatial</span><span>;</span>
</pre></div>

<div><pre><span></span><span>.</span><span>timer</span><span> </span><span>on</span>
<span>.</span><span>width</span><span> </span><span>180</span>
<span>LOAD</span><span> </span><span>json</span><span>;</span>
<span>LOAD</span><span> </span><span>parquet</span><span>;</span>
<span>LOAD</span><span> </span><span>spatial</span><span>;</span>
</pre></div>
<p>The maps in this post were rendered with <a href="https://www.qgis.org/en/site/forusers/download.html">QGIS</a> version 3.36. QGIS is a desktop application that runs on Windows, macOS and Linux. The software is very popular in the geospatial industry and was launched almost 15 million times in May last year.</p>
<p>I used QGIS' <a href="https://geoinformaticsworld.com/how-to-download-and-install-google-earth-images-in-qgis-using-tiles-plugin/">Tile+ plugin</a> to add satellite basemaps. Tile+ can be installed from its ZIP distributable.</p>
<p>The steps needed to reproduce the basemap used in this post can be found in my <a href="https://tech.marksblogg.com/aircraft-route-analysis-adsb.html">Aircraft Route Analysis</a> post.</p>
</div>
<div id="downloading-open-charge-map-s-data">
<h2>Downloading Open Charge Map's Data</h2>
<p>The following will clone 204,187 files totalling 307 MB from GitHub. This repository is refreshed monthly.</p>
<div><pre><span></span>$<span> </span>git<span> </span>clone<span> </span>https://github.com/openchargemap/ocm-export<span> </span>~/open_charge_map
</pre></div>
<p>I'll also download a dataset that will help me categorise countries into groups. For instance, Scandinavia, Finland and the Baltics will be classed as 'northernEurope'.</p>
<div><pre><span></span>$<span> </span>git<span> </span>clone<span> </span>https://github.com/vijinho/ISO-Country-Data<span> </span>~/ISO-Country-Data
</pre></div>
</div>
<div id="open-charge-map-s-data-structure">
<h2>Open Charge Map's Data Structure</h2>
<p>OCM breaks up data by country and location. Below is an example from a location in Estonia.</p>
<div><pre><span></span>$<span> </span><span>cd</span><span> </span>~/open_charge_map
$<span> </span>jq<span> </span>-S<span> </span><span>'del(.AddressInfo)'</span><span> </span>data/EE/OCM-11842.json
</pre></div>
<div><pre><span></span><span>{</span>
<span>  </span><span>"Connections"</span><span>:</span><span> </span><span>[</span>
<span>    </span><span>{</span>
<span>      </span><span>"Amps"</span><span>:</span><span> </span><span>120</span><span>,</span>
<span>      </span><span>"ConnectionTypeID"</span><span>:</span><span> </span><span>2</span><span>,</span>
<span>      </span><span>"CurrentTypeID"</span><span>:</span><span> </span><span>30</span><span>,</span>
<span>      </span><span>"ID"</span><span>:</span><span> </span><span>9252</span><span>,</span>
<span>      </span><span>"LevelID"</span><span>:</span><span> </span><span>3</span><span>,</span>
<span>      </span><span>"PowerKW"</span><span>:</span><span> </span><span>50</span><span>,</span>
<span>      </span><span>"Quantity"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>      </span><span>"StatusTypeID"</span><span>:</span><span> </span><span>50</span><span>,</span>
<span>      </span><span>"Voltage"</span><span>:</span><span> </span><span>500</span>
<span>    </span><span>},</span>
<span>    </span><span>{</span>
<span>      </span><span>"Amps"</span><span>:</span><span> </span><span>32</span><span>,</span>
<span>      </span><span>"ConnectionTypeID"</span><span>:</span><span> </span><span>25</span><span>,</span>
<span>      </span><span>"CurrentTypeID"</span><span>:</span><span> </span><span>20</span><span>,</span>
<span>      </span><span>"ID"</span><span>:</span><span> </span><span>25811</span><span>,</span>
<span>      </span><span>"LevelID"</span><span>:</span><span> </span><span>2</span><span>,</span>
<span>      </span><span>"PowerKW"</span><span>:</span><span> </span><span>22</span><span>,</span>
<span>      </span><span>"Quantity"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>      </span><span>"StatusTypeID"</span><span>:</span><span> </span><span>50</span><span>,</span>
<span>      </span><span>"Voltage"</span><span>:</span><span> </span><span>400</span>
<span>    </span><span>}</span>
<span>  </span><span>],</span>
<span>  </span><span>"DataProviderID"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>  </span><span>"DateCreated"</span><span>:</span><span> </span><span>"2012-08-03T13:08:00Z"</span><span>,</span>
<span>  </span><span>"DateLastStatusUpdate"</span><span>:</span><span> </span><span>"2014-05-29T04:52:00Z"</span><span>,</span>
<span>  </span><span>"DateLastVerified"</span><span>:</span><span> </span><span>"2014-05-29T04:52:00Z"</span><span>,</span>
<span>  </span><span>"GeneralComments"</span><span>:</span><span> </span><span>"Charger number 37001"</span><span>,</span>
<span>  </span><span>"ID"</span><span>:</span><span> </span><span>11842</span><span>,</span>
<span>  </span><span>"NumberOfPoints"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>  </span><span>"OperatorID"</span><span>:</span><span> </span><span>76</span><span>,</span>
<span>  </span><span>"StatusTypeID"</span><span>:</span><span> </span><span>50</span><span>,</span>
<span>  </span><span>"SubmissionStatusTypeID"</span><span>:</span><span> </span><span>200</span><span>,</span>
<span>  </span><span>"UUID"</span><span>:</span><span> </span><span>"810B3C57-F495-4028-B364-937576BD75AB"</span><span>,</span>
<span>  </span><span>"UsageCost"</span><span>:</span><span> </span><span>"5€/up to 60min"</span><span>,</span>
<span>  </span><span>"UsageTypeID"</span><span>:</span><span> </span><span>1</span>
<span>}</span>
</pre></div>
<p>Each file is a location which will be run by a network operator. Each location will have one or more charging stations / bays. A station can have one or more sockets as well as various power delivery specifications. These sockets and power delivery specifications are listed individually in the 'Connections' dictionary and each connection will have a quantity associated with it.</p>
<p>In the above example, only a single vehicle can be charged at any one time at this location and both a 50 kW, DC, 120A, 500V CHAdeMO socket as well as a 22 kW, AC (Three-Phase), 32A, 400V Type 2 socket are supported.</p>
<p>The location files use primary keys for many attributes. Their corresponding records can be found in a <tt>referencedata.json</tt> file included in the git repository. Below are the 13 reference table names for this project.</p>
<div><pre><span></span>$<span> </span>jq<span> </span>-S<span> </span><span>'.|keys'</span><span> </span>referencedata.json
</pre></div>
<div><pre><span></span><span>[</span>
<span>  </span><span>"ChargerTypes"</span><span>,</span>
<span>  </span><span>"CheckinStatusTypes"</span><span>,</span>
<span>  </span><span>"ConnectionTypes"</span><span>,</span>
<span>  </span><span>"Countries"</span><span>,</span>
<span>  </span><span>"CurrentTypes"</span><span>,</span>
<span>  </span><span>"DataProviders"</span><span>,</span>
<span>  </span><span>"DataTypes"</span><span>,</span>
<span>  </span><span>"MetadataGroups"</span><span>,</span>
<span>  </span><span>"Operators"</span><span>,</span>
<span>  </span><span>"StatusTypes"</span><span>,</span>
<span>  </span><span>"SubmissionStatusTypes"</span><span>,</span>
<span>  </span><span>"UsageTypes"</span><span>,</span>
<span>  </span><span>"UserCommentTypes"</span>
<span>]</span>
</pre></div>
<p>Below are the primary keys and attributes for the charger types.</p>
<div><pre><span></span>$<span> </span>jq<span> </span>-S<span> </span>.ChargerTypes<span> </span>referencedata.json
</pre></div>
<div><pre><span></span><span>[</span>
<span>  </span><span>{</span>
<span>    </span><span>"Comments"</span><span>:</span><span> </span><span>"Under 2 kW, usually domestic socket types"</span><span>,</span>
<span>    </span><span>"ID"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>    </span><span>"IsFastChargeCapable"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"Title"</span><span>:</span><span> </span><span>"Level 1 : Low (Under 2kW)"</span>
<span>  </span><span>},</span>
<span>  </span><span>{</span>
<span>    </span><span>"Comments"</span><span>:</span><span> </span><span>"Over 2 kW, usually non-domestic socket type"</span><span>,</span>
<span>    </span><span>"ID"</span><span>:</span><span> </span><span>2</span><span>,</span>
<span>    </span><span>"IsFastChargeCapable"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"Title"</span><span>:</span><span> </span><span>"Level 2 : Medium (Over 2kW)"</span>
<span>  </span><span>},</span>
<span>  </span><span>{</span>
<span>    </span><span>"Comments"</span><span>:</span><span> </span><span>"40KW and Higher"</span><span>,</span>
<span>    </span><span>"ID"</span><span>:</span><span> </span><span>3</span><span>,</span>
<span>    </span><span>"IsFastChargeCapable"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"Title"</span><span>:</span><span> </span><span>"Level 3:  High (Over 40kW)"</span>
<span>  </span><span>}</span>
<span>]</span>
</pre></div>
</div>
<div id="charge-station-imagery">
<h2>Charge Station Imagery</h2>
<p>User-submitted photographs are also listed in this dataset. Within any one location, one or more images may be available. A URL to a thumbnail as well as the original image are listed.</p>
<div><pre><span></span>$<span> </span>jq<span> </span>-S<span> </span><span>'.MediaItems[0]'</span><span> </span>data/EE/OCM-103624.json
</pre></div>
<div><pre><span></span><span>{</span>
<span>  </span><span>"ChargePointID"</span><span>:</span><span> </span><span>103624</span><span>,</span>
<span>  </span><span>"Comment"</span><span>:</span><span> </span><span>""</span><span>,</span>
<span>  </span><span>"DateCreated"</span><span>:</span><span> </span><span>"2020-07-26T12:19:00Z"</span><span>,</span>
<span>  </span><span>"ID"</span><span>:</span><span> </span><span>23192</span><span>,</span>
<span>  </span><span>"IsEnabled"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>  </span><span>"IsExternalResource"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>  </span><span>"IsFeaturedItem"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>  </span><span>"IsVideo"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>  </span><span>"ItemThumbnailURL"</span><span>:</span><span> </span><span>"https://media.openchargemap.io/images/EE/OCM103624/OCM-103624.thmb.2020072612183898.jpg"</span><span>,</span>
<span>  </span><span>"ItemURL"</span><span>:</span><span> </span><span>"https://media.openchargemap.io/images/EE/OCM103624/OCM-103624.orig.2020072612183898.jpg"</span><span>,</span>
<span>  </span><span>"User"</span><span>:</span><span> </span><span>{</span>
<span>    </span><span>"ID"</span><span>:</span><span> </span><span>26470</span><span>,</span>
<span>    </span><span>"Username"</span><span>:</span><span> </span><span>"erkkiat"</span>
<span>  </span><span>}</span>
<span>}</span>
</pre></div>
<p>The original images make up ~30 GB altogether. There are a few 20 MB PNGs, especially for Italy and Spain, but for the most part, images are ~2 MB. The vast majority of these photos were taken in Europe with the US and Australia being the only other locations of any significance. Below is the proportion of disk space used by the images broken down by region and country.</p>
<p><a href="https://tech.marksblogg.com/theme/images/openchargemap.image.sizes.png"><img alt="Image Sizes by Country in Open Charge Map" src="https://tech.marksblogg.com/theme/images/openchargemap.image.sizes.png"></a></p><p>The original images don't look to have been through any processing, either to reduce their size or to remove any metadata. Many images contain more than 100 pieces of metadata, such as the image below.</p>
<div><pre><span></span>$<span> </span>wget<span> </span>https://media.openchargemap.io/images/ES/OCM64603/OCM-64603.orig.2016031412054624.jpg
$<span> </span>exiftool<span> </span>OCM-64603.orig.2016031412054624.jpg<span> </span><span>|</span><span> </span>tail<span> </span>-n20
</pre></div>
<div><pre><span></span>Image Height                    : 3264
Encoding Process                : Baseline DCT, Huffman coding
Bits Per Sample                 : 8
Color Components                : 3
Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)
Aperture                        : 2.4
Image Size                      : 2448x3264
Megapixels                      : 8.0
Shutter Speed                   : 1/1374
Create Date                     : 2016:03:05 11:27:08.053521
Date/Time Original              : 2016:03:05 11:27:08.053521
Modify Date                     : 2016:03:05 11:27:08.053521
Thumbnail Image                 : (Binary data 5911 bytes, use -b option to extract)
GPS Altitude                    : 70 m Above Sea Level
GPS Date/Time                   : 2016:03:05 10:26:59Z
GPS Latitude                    : 42 deg 10' 36.89" N
GPS Longitude                   : 3 deg 6' 29.49" E
Focal Length                    : 4.0 mm
GPS Position                    : 42 deg 10' 36.89" N, 3 deg 6' 29.49" E
Light Value                     : 12.9
</pre></div>
<p>Some photos are great research material with equipment and signage clearly presented. Others show the surrounding area and landscape which could be a replacement for Google Street View. This is handy as it can show if there is a canopy or if it's in underground / sheltered parking of some sort.</p>
<p>Below is an image found in the Brazilian dataset showing two charging bays in a parking garage.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-208604.orig.2023092923395150.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-208604.orig.2023092923395150.jpg"></a></p><p>Surprisingly few people submit photographs of charging point failures. I found this one in the Brazilian dataset.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-188915.orig.2023062821055190.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-188915.orig.2023062821055190.jpg"></a></p><p>Instructions to not leave your vehicle while charging in Jordan.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-188313.orig.2022051605065602.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-188313.orig.2022051605065602.jpg"></a></p><p>Below is a photo of a canopy covering the charging bays in Malaysia.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-192078.orig.2022032014494888.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-192078.orig.2022032014494888.jpg"></a></p><p>Not much space to park in Cyprus.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-195419.orig.2022091714464459.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-195419.orig.2022091714464459.jpg"></a></p><p>Below is a photo of a charging point User Interface.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-190922.orig.2023060816205510.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-190922.orig.2023060816205510.jpg"></a></p><p>Some people are kind enough to photograph the specifications on the sides of the charging point machines.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-7836.orig.2022121112064950.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-7836.orig.2022121112064950.jpg"></a></p><p>Photos often give away what sort of area you'll be waiting around in.</p>
<p><a href="https://tech.marksblogg.com/theme/images/OCM-125304.orig.2019041312211315.jpg"><img alt="Open Charge Map Image" src="https://tech.marksblogg.com/theme/images/OCM-125304.orig.2019041312211315.jpg"></a>
</p></div>
<div id="building-an-analysis-ready-dataset">
<h2>Building an Analysis-Ready Dataset</h2>
<p>Below I'll denormalise the OCM dataset by connection. I'll also use the foreign keys to join to the reference datasets. The data will be first exported into JSONL before being imported into DuckDB using its internal file format.</p>

<div><pre><span></span><span>from</span>   <span>glob</span>          <span>import</span> <span>glob</span>
<span>import</span> <span>json</span>
<span>from</span>   <span>urllib.parse</span>  <span>import</span> <span>urlparse</span>

<span>from</span>   <span>rich.progress</span> <span>import</span> <span>track</span>


<span># Lookups / Reference Data</span>
<span>recs</span> <span>=</span> <span>json</span><span>.</span><span>loads</span><span>(</span><span>open</span><span>(</span><span>'referencedata.json'</span><span>,</span> <span>'r'</span><span>)</span><span>.</span><span>read</span><span>())</span>

<span>lookups</span> <span>=</span> <span>{}</span>

<span>for</span> <span>x</span> <span>in</span> <span>recs</span><span>.</span><span>keys</span><span>():</span>
    <span>lookups</span><span>[</span><span>x</span><span>]</span> <span>=</span> <span>{}</span>

    <span>for</span> <span>rec</span> <span>in</span> <span>recs</span><span>[</span><span>x</span><span>]:</span>
        <span>id_</span> <span>=</span> <span>rec</span><span>[</span><span>'ID'</span><span>]</span>
        <span>del</span> <span>rec</span><span>[</span><span>'ID'</span><span>]</span>
        <span>lookups</span><span>[</span><span>x</span><span>][</span><span>id_</span><span>]</span> <span>=</span> <span>rec</span>

<span># Regions</span>
<span>regions</span> <span>=</span> <span>json</span><span>.</span><span>loads</span><span>(</span><span>open</span><span>(</span><span>'/home/mark/ISO-Country-Data/regions.json'</span><span>,</span> <span>'r'</span><span>)</span><span>.</span><span>read</span><span>())</span>

<span># Connections</span>
<span>station_keys</span> <span>=</span> <span>(</span>
    <span>'DateLastVerified'</span><span>,</span>
    <span>'ID'</span><span>,</span>
    <span>'UUID'</span><span>,</span>
    <span>'DataProviderID'</span><span>,</span>
    <span>'UsageTypeID'</span><span>,</span>
    <span>'UsageCost'</span><span>,</span>
    <span>'NumberOfPoints'</span><span>,</span>
    <span>'StatusTypeID'</span><span>,</span>
    <span>'DateLastStatusUpdate'</span><span>,</span>
    <span>'DateCreated'</span><span>,</span>
    <span>'SubmissionStatusTypeID'</span><span>,</span>
    <span>'ProviderBrand'</span><span>)</span>

<span>with</span> <span>open</span><span>(</span><span>'connections.json'</span><span>,</span> <span>'w'</span><span>)</span> <span>as</span> <span>f</span><span>:</span>
    <span>for</span> <span>filename</span> <span>in</span> <span>track</span><span>(</span><span>glob</span><span>(</span><span>'*/OCM-*.json'</span><span>)):</span>
        <span>recs</span> <span>=</span> <span>json</span><span>.</span><span>loads</span><span>(</span><span>open</span><span>(</span><span>filename</span><span>,</span> <span>'r'</span><span>)</span><span>.</span><span>read</span><span>())</span>

        <span>if</span> <span>'RelatedURL'</span> <span>in</span> <span>recs</span><span>[</span><span>'AddressInfo'</span><span>]:</span>
            <span>recs</span><span>[</span><span>'ProviderBrand'</span><span>]</span> <span>=</span> \
                <span>urlparse</span><span>(</span><span>recs</span><span>[</span><span>'AddressInfo'</span><span>][</span><span>'RelatedURL'</span><span>])</span>\
                    <span>.</span><span>netloc</span>\
                    <span>.</span><span>replace</span><span>(</span><span>'www.'</span><span>,</span> <span>''</span><span>)</span>\
                    <span>.</span><span>split</span><span>(</span><span>'.'</span><span>)[</span><span>0</span><span>]</span>

        <span>country_iso2</span> <span>=</span> <span>filename</span><span>.</span><span>split</span><span>(</span><span>'/'</span><span>)[</span><span>0</span><span>]</span><span>.</span><span>upper</span><span>()</span><span>.</span><span>strip</span><span>()</span>

        <span>region</span> <span>=</span> <span>None</span>

        <span>for</span> <span>region_</span><span>,</span> <span>countries</span> <span>in</span> <span>regions</span><span>.</span><span>items</span><span>():</span>
            <span>if</span> <span>country_iso2</span> <span>in</span> <span>countries</span><span>:</span>
                <span>region</span> <span>=</span> <span>region_</span>
                <span>break</span>

        <span>if</span> <span>region</span> <span>is</span> <span>None</span> <span>and</span> <span>country_iso2</span> <span>==</span> <span>'XK'</span><span>:</span>
            <span>region</span> <span>=</span> <span>'southernEurope'</span>

        <span>dp_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'DataProviderID'</span> <span>not</span> <span>in</span> <span>recs</span><span>.</span><span>keys</span><span>()</span>         <span>else</span> <span>lookups</span><span>[</span><span>'DataProviders'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>recs</span><span>[</span><span>'DataProviderID'</span><span>],</span> <span>{})</span>

        <span>if</span> <span>'DataProviderStatusType'</span> <span>in</span> <span>dp_</span><span>.</span><span>keys</span><span>():</span>
            <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>dp_</span><span>[</span><span>'DataProviderStatusType'</span><span>]</span><span>.</span><span>items</span><span>():</span>
                <span>dp_</span><span>[</span><span>k</span><span>]</span> <span>=</span> <span>v</span>
            <span>del</span> <span>dp_</span><span>[</span><span>'DataProviderStatusType'</span><span>]</span>

        <span>op_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'OperatorID'</span> <span>not</span> <span>in</span> <span>recs</span><span>.</span><span>keys</span><span>()</span>             <span>else</span> <span>lookups</span><span>[</span><span>'Operators'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>recs</span><span>[</span><span>'OperatorID'</span><span>],</span> <span>{})</span>
        <span>st_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'StatusTypeID'</span> <span>not</span> <span>in</span> <span>recs</span><span>.</span><span>keys</span><span>()</span>           <span>else</span> <span>lookups</span><span>[</span><span>'StatusTypes'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>recs</span><span>[</span><span>'StatusTypeID'</span><span>],</span> <span>{})</span>
        <span>us_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'UsageTypeID'</span> <span>not</span> <span>in</span> <span>recs</span><span>.</span><span>keys</span><span>()</span>            <span>else</span> <span>lookups</span><span>[</span><span>'UsageTypes'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>recs</span><span>[</span><span>'UsageTypeID'</span><span>],</span> <span>{})</span>
        <span>ss_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'SubmissionStatusTypeID'</span> <span>not</span> <span>in</span> <span>recs</span><span>.</span><span>keys</span><span>()</span> <span>else</span> <span>lookups</span><span>[</span><span>'SubmissionStatusTypes'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>recs</span><span>[</span><span>'SubmissionStatusTypeID'</span><span>],</span> <span>{})</span>

        <span>for</span> <span>rec</span> <span>in</span> <span>recs</span><span>[</span><span>'Connections'</span><span>]:</span>
            <span>ct_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'ConnectionTypeID'</span> <span>not</span> <span>in</span> <span>rec</span><span>.</span><span>keys</span><span>()</span> <span>else</span> <span>lookups</span><span>[</span><span>'ConnectionTypes'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>rec</span><span>[</span><span>'ConnectionTypeID'</span><span>],</span> <span>{})</span>
            <span>cu_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'CurrentTypeID'</span> <span>not</span> <span>in</span> <span>rec</span><span>.</span><span>keys</span><span>()</span>    <span>else</span> <span>lookups</span><span>[</span><span>'CurrentTypes'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>rec</span><span>[</span><span>'CurrentTypeID'</span><span>],</span> <span>{})</span>
            <span>cs_</span> <span>=</span> <span>{}</span> <span>if</span> <span>'StatusTypeID'</span> <span>not</span> <span>in</span> <span>rec</span><span>.</span><span>keys</span><span>()</span>     <span>else</span> <span>lookups</span><span>[</span><span>'StatusTypes'</span><span>]</span><span>.</span><span>get</span><span>(</span><span>rec</span><span>[</span><span>'StatusTypeID'</span><span>],</span> <span>{})</span>

            <span>f</span><span>.</span><span>write</span><span>(</span><span>json</span><span>.</span><span>dumps</span><span>({</span><span>**</span><span>{</span><span>'AddressCountryIso2'</span><span>:</span> <span>country_iso2</span><span>,</span>
                                   <span>'AddressWorldRegion'</span><span>:</span> <span>region</span><span>},</span>
                                <span>**</span><span>{</span><span>'Connector'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>         <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>rec</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'Address'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>         <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>recs</span><span>[</span><span>'AddressInfo'</span><span>]</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'DataProvider'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>         <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>dp_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'Operator'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>             <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>op_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'StatusType'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>           <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>st_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'UsageType'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>            <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>us_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'SubmissionStatusType'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span> <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>ss_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'ConnectionType'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>       <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>ct_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'CurrentType'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span>          <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>cu_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'ConnectionStatusType'</span> <span>+</span> <span>k</span><span>:</span> <span>v</span> <span>for</span> <span>k</span><span>,</span> <span>v</span> <span>in</span> <span>cs_</span><span>.</span><span>items</span><span>()},</span>
                                <span>**</span><span>{</span><span>'Location'</span> <span>+</span> <span>k</span><span>:</span> <span>recs</span><span>.</span><span>get</span><span>(</span><span>k</span><span>,</span> <span>None</span><span>)</span>
                                <span>for</span> <span>k</span> <span>in</span> <span>station_keys</span><span>}})</span> <span>+</span> <span>'</span><span>\n</span><span>'</span><span>)</span>
</pre></div>
<p>The following will convert the JSONL into a DuckDB table using its internal file format.</p>
<div><pre><span></span>$<span> </span>~/duckdb<span> </span>-c<span> </span><span>"CREATE OR REPLACE TABLE connections aS</span>
<span>                    SELECT *</span>
<span>                    FROM 'connections.json';"</span><span> </span><span>\</span>
<span>           </span>connections.duckdb
</pre></div>
<p>The resulting DuckDB file is 98 MB and consists of 373,428 records. Below is an example record.</p>
<div><pre><span></span>$<span> </span>~/duckdb<span> </span>-json<span> </span><span>\</span>
<span>           </span>-c<span> </span><span>"SELECT *</span>
<span>               FROM connections</span>
<span>               WHERE AddressCountryIso2 = 'EE'</span>
<span>               LIMIT 1;"</span><span> </span><span>\</span>
<span>           </span>connections.duckdb<span> </span><span>\</span>
<span>    </span><span>|</span><span> </span>tail<span> </span>-n1<span> </span><span>\</span>
<span>    </span><span>|</span><span> </span>jq<span> </span>-S<span> </span>.
</pre></div>
<div><pre><span></span><span>[</span>
<span>  </span><span>{</span>
<span>    </span><span>"AddressAccessComments"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"AddressAddressLine1"</span><span>:</span><span> </span><span>"Mere Boulevard 7"</span><span>,</span>
<span>    </span><span>"AddressAddressLine2"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"AddressContactEmail"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"AddressContactTelephone1"</span><span>:</span><span> </span><span>"+372 4473888"</span><span>,</span>
<span>    </span><span>"AddressContactTelephone2"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"AddressCountryID"</span><span>:</span><span> </span><span>74</span><span>,</span>
<span>    </span><span>"AddressCountryIso2"</span><span>:</span><span> </span><span>"EE"</span><span>,</span>
<span>    </span><span>"AddressDistanceUnit"</span><span>:</span><span> </span><span>0</span><span>,</span>
<span>    </span><span>"AddressID"</span><span>:</span><span> </span><span>103970</span><span>,</span>
<span>    </span><span>"AddressLatitude"</span><span>:</span><span> </span><span>58.380532</span><span>,</span>
<span>    </span><span>"AddressLongitude"</span><span>:</span><span> </span><span>24.491924</span><span>,</span>
<span>    </span><span>"AddressPostcode"</span><span>:</span><span> </span><span>"80010"</span><span>,</span>
<span>    </span><span>"AddressRelatedURL"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"AddressStateOrProvince"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"AddressTitle"</span><span>:</span><span> </span><span>"Villa Ammende hotel and restaurant"</span><span>,</span>
<span>    </span><span>"AddressTown"</span><span>:</span><span> </span><span>"Pärnu"</span><span>,</span>
<span>    </span><span>"AddressWorldRegion"</span><span>:</span><span> </span><span>"northernEurope"</span><span>,</span>
<span>    </span><span>"ConnectionStatusTypeIsOperational"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"ConnectionStatusTypeIsUserSelectable"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"ConnectionStatusTypeTitle"</span><span>:</span><span> </span><span>"Operational"</span><span>,</span>
<span>    </span><span>"ConnectionTypeFormalName"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"ConnectionTypeIsDiscontinued"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"ConnectionTypeIsObsolete"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"ConnectionTypeTitle"</span><span>:</span><span> </span><span>"Tesla (Model S/X)"</span><span>,</span>
<span>    </span><span>"ConnectorAmps"</span><span>:</span><span> </span><span>32</span><span>,</span>
<span>    </span><span>"ConnectorComments"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"ConnectorConnectionTypeID"</span><span>:</span><span> </span><span>30</span><span>,</span>
<span>    </span><span>"ConnectorCurrentTypeID"</span><span>:</span><span> </span><span>20</span><span>,</span>
<span>    </span><span>"ConnectorID"</span><span>:</span><span> </span><span>146294</span><span>,</span>
<span>    </span><span>"ConnectorLevelID"</span><span>:</span><span> </span><span>2</span><span>,</span>
<span>    </span><span>"ConnectorPowerKW"</span><span>:</span><span> </span><span>22</span><span>,</span>
<span>    </span><span>"ConnectorQuantity"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>    </span><span>"ConnectorReference"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"ConnectorStatusTypeID"</span><span>:</span><span> </span><span>50</span><span>,</span>
<span>    </span><span>"ConnectorVoltage"</span><span>:</span><span> </span><span>400</span><span>,</span>
<span>    </span><span>"CurrentTypeDescription"</span><span>:</span><span> </span><span>"Alternating Current - Three Phase"</span><span>,</span>
<span>    </span><span>"CurrentTypeTitle"</span><span>:</span><span> </span><span>"AC (Three-Phase)"</span><span>,</span>
<span>    </span><span>"DataProviderComments"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"DataProviderDateLastImported"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"DataProviderID"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>    </span><span>"DataProviderIsApprovedImport"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"DataProviderIsOpenDataLicensed"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"DataProviderIsProviderEnabled"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"DataProviderIsRestrictedEdit"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"DataProviderLicense"</span><span>:</span><span> </span><span>"Licensed under Creative Commons Attribution 4.0 International (CC BY 4.0)"</span><span>,</span>
<span>    </span><span>"DataProviderTitle"</span><span>:</span><span> </span><span>"Manual Data Entry"</span><span>,</span>
<span>    </span><span>"DataProviderWebsiteURL"</span><span>:</span><span> </span><span>"http://openchargemap.org"</span><span>,</span>
<span>    </span><span>"LocationDataProviderID"</span><span>:</span><span> </span><span>1</span><span>,</span>
<span>    </span><span>"LocationDateCreated"</span><span>:</span><span> </span><span>"2018-05-05 05:44:00"</span><span>,</span>
<span>    </span><span>"LocationDateLastStatusUpdate"</span><span>:</span><span> </span><span>"2020-07-27 14:52:00"</span><span>,</span>
<span>    </span><span>"LocationDateLastVerified"</span><span>:</span><span> </span><span>"2020-07-27 14:52:00"</span><span>,</span>
<span>    </span><span>"LocationID"</span><span>:</span><span> </span><span>103624</span><span>,</span>
<span>    </span><span>"LocationNumberOfPoints"</span><span>:</span><span> </span><span>2</span><span>,</span>
<span>    </span><span>"LocationProviderBrand"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"LocationStatusTypeID"</span><span>:</span><span> </span><span>50</span><span>,</span>
<span>    </span><span>"LocationSubmissionStatusTypeID"</span><span>:</span><span> </span><span>200</span><span>,</span>
<span>    </span><span>"LocationUUID"</span><span>:</span><span> </span><span>"56ae3b26-c6c0-4770-98bb-aa2beb850147"</span><span>,</span>
<span>    </span><span>"LocationUsageCost"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"LocationUsageTypeID"</span><span>:</span><span> </span><span>4</span><span>,</span>
<span>    </span><span>"OperatorAddressInfo"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorBookingURL"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorComments"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorContactEmail"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorFaultReportEmail"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorIsPrivateIndividual"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"OperatorIsRestrictedEdit"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"OperatorPhonePrimaryContact"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorPhoneSecondaryContact"</span><span>:</span><span> </span><span>null</span><span>,</span>
<span>    </span><span>"OperatorTitle"</span><span>:</span><span> </span><span>"Tesla (Tesla-only charging)"</span><span>,</span>
<span>    </span><span>"OperatorWebsiteURL"</span><span>:</span><span> </span><span>"http://www.teslamotors.com"</span><span>,</span>
<span>    </span><span>"StatusTypeIsOperational"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"StatusTypeIsUserSelectable"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"StatusTypeTitle"</span><span>:</span><span> </span><span>"Operational"</span><span>,</span>
<span>    </span><span>"SubmissionStatusTypeIsLive"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"SubmissionStatusTypeTitle"</span><span>:</span><span> </span><span>"Submission Published"</span><span>,</span>
<span>    </span><span>"UsageTypeIsAccessKeyRequired"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"UsageTypeIsMembershipRequired"</span><span>:</span><span> </span><span>true</span><span>,</span>
<span>    </span><span>"UsageTypeIsPayAtLocation"</span><span>:</span><span> </span><span>false</span><span>,</span>
<span>    </span><span>"UsageTypeTitle"</span><span>:</span><span> </span><span>"Public - Membership Required"</span>
<span>  </span><span>}</span>
<span>]</span>
</pre></div>
</div>
<div id="charging-points-around-the-world">
<h2>Charging Points Around The World</h2>
<p>I'll break down the number of charging locations by region. These will be broken up into categories of how many stations / bays are available at each location. So far, there is only one location in the world, located in Sweden, with more than 500 bays.</p>
<div><pre><span></span>$<span> </span>~/duckdb<span> </span>connections.duckdb
</pre></div>
<div><pre><span></span><span>SELECT</span><span>   </span><span>AddressWorldRegion</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>==</span><span> </span><span>1</span><span>)</span><span>   </span><span>AS</span><span> </span><span>"1"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>2</span><span>    </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>5</span><span>)</span><span>   </span><span>AS</span><span> </span><span>"2_4"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>5</span><span>    </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>20</span><span>)</span><span>  </span><span>AS</span><span> </span><span>"5_19"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>20</span><span>   </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>50</span><span>)</span><span>  </span><span>AS</span><span> </span><span>"20_49"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>50</span><span>   </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>500</span><span>)</span><span> </span><span>AS</span><span> </span><span>"50_499"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>500</span><span>)</span><span> </span><span>AS</span><span> </span><span>"500_plus"</span><span>,</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>AddressWorldRegion</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>2</span><span> </span><span>DESC</span><span>;</span>
</pre></div>
<div><pre><span></span>┌────────────────────┬───────┬───────┬───────┬───────┬────────┬──────────┐
│ AddressWorldRegion │   1   │  2_4  │ 5_19  │ 20_49 │ 50_499 │ 500_plus │
│      varchar       │ int64 │ int64 │ int64 │ int64 │ int64  │  int64   │
├────────────────────┼───────┼───────┼───────┼───────┼────────┼──────────┤
│ westernEurope      │ 11561 │ 13919 │  1561 │   122 │     10 │        0 │
│ northernEurope     │  7861 │ 16216 │  5126 │   418 │     98 │        1 │
│ southernEurope     │  6676 │ 17910 │  1607 │    80 │     10 │        0 │
│ northernAmerica    │  3634 │  5589 │  2458 │   193 │     13 │        0 │
│ easternEurope      │  2630 │  1590 │    68 │     1 │      0 │        0 │
│ australia          │   906 │   989 │   136 │     1 │      0 │        0 │
│ westernAsia        │   774 │   360 │    37 │     1 │      0 │        0 │
│ eastAsia           │   446 │   148 │    25 │    18 │      0 │        0 │
│ caribbean          │   341 │    39 │     0 │     0 │      0 │        0 │
│ southAmerica       │   267 │    95 │     7 │     2 │      0 │        0 │
│ southeastAsia      │   247 │   162 │    12 │     1 │      0 │        0 │
│ polynesia          │   156 │     7 │     1 │     0 │      0 │        0 │
│ centralAmerica     │   115 │    45 │     1 │     0 │      0 │        0 │
│ northAfrica        │    98 │    49 │     3 │     0 │      0 │        0 │
│ southernAsia       │    91 │    30 │     1 │     0 │      0 │        0 │
│ southernAfrica     │    35 │   107 │     0 │     0 │      0 │        0 │
│ eastAfrica         │    15 │     7 │     2 │     0 │      0 │        0 │
│ westAfrica         │     2 │     0 │     1 │     0 │      0 │        0 │
│ centralAsia        │     2 │     1 │     1 │     0 │      0 │        0 │
├────────────────────┴───────┴───────┴───────┴───────┴────────┴──────────┤
│ 19 rows                                                      7 columns │
└────────────────────────────────────────────────────────────────────────┘
</pre></div>
<p>This is a breakdown for countries outside of Europe, North America and Australia. Some of these countries are fairly small and have very good charging point coverage but others, I suspect, are vastly underrepresented in this dataset, like China with 126 locations listed.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>AddressCountryIso2</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>==</span><span> </span><span>1</span><span>)</span><span>   </span><span>AS</span><span> </span><span>"1"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>2</span><span>    </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>5</span><span>)</span><span>   </span><span>AS</span><span> </span><span>"2_4"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>5</span><span>    </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>20</span><span>)</span><span>  </span><span>AS</span><span> </span><span>"5_19"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>20</span><span>   </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>50</span><span>)</span><span>  </span><span>AS</span><span> </span><span>"20_49"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>50</span><span>   </span><span>AND</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&lt;</span><span> </span><span>500</span><span>)</span><span> </span><span>AS</span><span> </span><span>"50_499"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>LocationNumberOfPoints</span><span> </span><span>&gt;=</span><span> </span><span>500</span><span>)</span><span> </span><span>AS</span><span> </span><span>"500_plus"</span><span>,</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>AddressWorldRegion</span><span> </span><span>NOT</span><span> </span><span>LIKE</span><span> </span><span>'%Europe'</span>
<span>AND</span><span>      </span><span>AddressWorldRegion</span><span> </span><span>!=</span><span> </span><span>'northernAmerica'</span>
<span>AND</span><span>      </span><span>AddressCountryIso2</span><span> </span><span>!=</span><span> </span><span>'AU'</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>AddressCountryIso2</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>2</span><span> </span><span>DESC</span>
<span>LIMIT</span><span> </span><span>20</span><span>;</span>
</pre></div>
<div><pre><span></span>┌────────────────────┬───────┬───────┬───────┬───────┬────────┬──────────┐
│ AddressCountryIso2 │   1   │  2_4  │ 5_19  │ 20_49 │ 50_499 │ 500_plus │
│      varchar       │ int64 │ int64 │ int64 │ int64 │ int64  │  int64   │
├────────────────────┼───────┼───────┼───────┼───────┼────────┼──────────┤
│ TR                 │   522 │   177 │    13 │     1 │      0 │        0 │
│ NZ                 │   389 │   510 │    72 │     1 │      0 │        0 │
│ DO                 │   331 │     6 │     0 │     0 │      0 │        0 │
│ JP                 │   226 │    13 │     1 │     0 │      0 │        0 │
│ BR                 │   206 │    51 │     3 │     1 │      0 │        0 │
│ IL                 │   166 │    81 │    20 │     0 │      0 │        0 │
│ CL                 │   156 │     7 │     1 │     0 │      0 │        0 │
│ CN                 │   121 │     4 │     1 │     0 │      0 │        0 │
│ CR                 │   111 │    45 │     1 │     0 │      0 │        0 │
│ ID                 │   110 │    78 │     1 │     0 │      0 │        0 │
│ MY                 │    95 │    78 │    10 │     1 │      0 │        0 │
│ MA                 │    71 │    29 │     2 │     0 │      0 │        0 │
│ HK                 │    67 │   117 │    20 │    18 │      0 │        0 │
│ IN                 │    48 │    13 │     0 │     0 │      0 │        0 │
│ AE                 │    48 │    65 │     4 │     0 │      0 │        0 │
│ LK                 │    40 │    16 │     1 │     0 │      0 │        0 │
│ ZA                 │    34 │   106 │     0 │     0 │      0 │        0 │
│ JO                 │    34 │    34 │     0 │     0 │      0 │        0 │
│ TW                 │    32 │    12 │     3 │     0 │      0 │        0 │
│ UY                 │    25 │     9 │     1 │     0 │      0 │        0 │
├────────────────────┴───────┴───────┴───────┴───────┴────────┴──────────┤
│ 20 rows                                                      7 columns │
└────────────────────────────────────────────────────────────────────────┘
</pre></div>
<p>Much of the data has been submitted by volunteers but there are also official sources as well. Below are the most significant official sources broken down by region.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>AddressWorldRegion</span><span>,</span>
<span>         </span><span>REPLACE</span><span>(</span><span>SPLIT_PART</span><span>(</span><span>REPLACE</span><span>(</span><span>REPLACE</span><span>(</span><span>DataProviderWebsiteURL</span><span>,</span><span> </span><span>'http://'</span><span>,</span><span> </span><span>''</span><span>),</span><span> </span><span>'https://'</span><span>,</span><span> </span><span>''</span><span>),</span><span> </span><span>'/'</span><span>,</span><span> </span><span>1</span><span>),</span><span> </span><span>'www.'</span><span>,</span><span> </span><span>''</span><span>)</span><span> </span><span>AS</span><span> </span><span>domain</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>n_locations</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>DataProviderWebsiteURL</span><span> </span><span>!=</span><span> </span><span>'http://openchargemap.org'</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span>
<span>HAVING</span><span>   </span><span>n_locations</span><span> </span><span>&gt;</span><span> </span><span>50</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>3</span><span> </span><span>DESC</span><span>;</span>
</pre></div>
<div><pre><span></span>┌────────────────────┬─────────────────────────┬─────────────┐
│ AddressWorldRegion │         domain          │ n_locations │
│      varchar       │         varchar         │    int64    │
├────────────────────┼─────────────────────────┼─────────────┤
│ eastAsia           │ chademo.com             │        1268 │
│ eastAsia           │ oplaadpalen.nl          │         182 │
│ eastAsia           │ carstations.com         │         117 │
│ easternEurope      │ sitronics-electro.com   │          93 │
│ northernAmerica    │ afdc.energy.gov         │       57074 │
│ northernAmerica    │ carstations.com         │        2464 │
│ northernEurope     │ chargepoints.dft.gov.uk │       11864 │
│ northernEurope     │ nobil.no                │        9081 │
│ northernEurope     │ ev.lakd.lt              │         234 │
│ southernEurope     │ mobie.pt                │         751 │
│ southernEurope     │ oplaadpalen.nl          │          59 │
│ westernEurope      │ bundesnetzagentur.de    │       10533 │
│ westernEurope      │ data.gouv.fr            │       10230 │
│ westernEurope      │ oplaadpalen.nl          │        7698 │
├────────────────────┴─────────────────────────┴─────────────┤
│ 14 rows                                          3 columns │
└────────────────────────────────────────────────────────────┘
</pre></div>
<p>There has been a move to either partly or fully automate data imports. Below is a breakdown by each location's last update as to which process was used to refresh its record.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>SUBSTR</span><span>(</span><span>LocationDateLastStatusUpdate</span><span>::</span><span>TEXT</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>4</span><span>)</span><span> </span><span>last_update</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>DataProviderTitle</span><span> </span><span>=</span><span> </span><span>'Manual Data Entry'</span><span>)</span><span> </span><span>as</span><span> </span><span>manual</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>DataProviderTitle</span><span> </span><span>=</span><span> </span><span>'Partially Automated (Ad-Hoc Import)'</span><span>)</span><span> </span><span>as</span><span> </span><span>partly</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>DataProviderTitle</span><span> </span><span>=</span><span> </span><span>'Automated Import'</span><span>)</span><span> </span><span>as</span><span> </span><span>automated</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>last_update</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>last_update</span><span> </span><span>DESC</span><span>;</span>
</pre></div>
<div><pre><span></span>┌─────────────┬────────┬────────┬───────────┐
│ last_update │ manual │ partly │ automated │
│   varchar   │ int64  │ int64  │   int64   │
├─────────────┼────────┼────────┼───────────┤
│ 2024        │   5362 │   6288 │     42766 │
│ 2023        │  25136 │   2764 │     17231 │
│ 2022        │  11433 │      0 │      5729 │
│ 2021        │   5590 │    253 │     10592 │
│ 2020        │   9507 │      7 │      9275 │
│ 2019        │   7478 │    127 │      4861 │
│ 2018        │   8151 │      1 │        25 │
│ 2017        │   8546 │      1 │      2484 │
│ 2016        │   4568 │     18 │      7857 │
│ 2015        │   3902 │      0 │       105 │
│ 2014        │    650 │      0 │       120 │
│ 2013        │    523 │      0 │         3 │
│ 2012        │    182 │      1 │         0 │
│ 2011        │     89 │      0 │         0 │
│ 2010        │     25 │      0 │         0 │
├─────────────┴────────┴────────┴───────────┤
│ 15 rows                         4 columns │
└───────────────────────────────────────────┘
</pre></div>
<p>There has been a considerable amount of effort put into refreshing data. Below is a breakdown of the number of locations refreshed before and after 2021.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>AddressWorldRegion</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>SUBSTR</span><span>(</span><span>LocationDateLastVerified</span><span>::</span><span>VARCHAR</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>4</span><span>)::</span><span>INT</span><span> </span><span>&lt;</span><span> </span><span>2021</span><span>)</span><span>  </span><span>AS</span><span> </span><span>"before_2021"</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>SUBSTR</span><span>(</span><span>LocationDateLastVerified</span><span>::</span><span>VARCHAR</span><span>,</span><span> </span><span>1</span><span>,</span><span> </span><span>4</span><span>)::</span><span>INT</span><span> </span><span>&gt;=</span><span> </span><span>2021</span><span>)</span><span> </span><span>AS</span><span> </span><span>"2021_onward"</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>AddressWorldRegion</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>2</span><span> </span><span>DESC</span><span>;</span>
</pre></div>
<div><pre><span></span>┌────────────────────┬─────────────┬─────────────┐
│ AddressWorldRegion │ before_2021 │ 2021_onward │
│      varchar       │    int64    │    int64    │
├────────────────────┼─────────────┼─────────────┤
│ westernEurope      │       28264 │       19871 │
│ northernAmerica    │       19253 │       53468 │
│ northernEurope     │       10155 │       32841 │
│ southernEurope     │        7443 │       19981 │
│ eastAsia           │        1860 │          46 │
│ easternEurope      │        1758 │        2650 │
│ australia          │         480 │        1560 │
│ westernAsia        │         388 │         943 │
│ centralAmerica     │          52 │         109 │
│ southeastAsia      │          37 │         385 │
│ southernAsia       │          21 │         101 │
│ southernAfrica     │          16 │         126 │
│ southAmerica       │          15 │         357 │
│ northAfrica        │          13 │         137 │
│ caribbean          │           9 │         371 │
│ polynesia          │           5 │         172 │
│ eastAfrica         │           3 │          21 │
│ centralAsia        │           2 │           2 │
│ westAfrica         │           0 │           3 │
├────────────────────┴─────────────┴─────────────┤
│ 19 rows                              3 columns │
└────────────────────────────────────────────────┘
</pre></div>
</div>
<div id="charging-point-operators">
<h2>Charging Point Operators</h2>
<p>ChargePoint, Tesla, BlinkCharging, flo and Shell Recharge Solutions are the most significant operators with more than 3K locations and a significant presence outside of their home market.</p>
<div><pre><span></span><span>CREATE</span><span> </span><span>OR</span><span> </span><span>REPLACE</span><span> </span><span>TEMPORARY</span><span> </span><span>TABLE</span><span> </span><span>op_locations</span><span> </span><span>AS</span>
<span>    </span><span>SELECT</span><span>   </span><span>SPLIT_PART</span><span>(</span><span>OperatorTitle</span><span>,</span><span> </span><span>' ('</span><span>,</span><span> </span><span>1</span><span>)</span><span> </span><span>AS</span><span> </span><span>OperatorTitle</span><span>,</span>
<span>             </span><span>AddressCountryIso2</span><span>,</span>
<span>             </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>n_locations</span>
<span>    </span><span>FROM</span><span>     </span><span>connections</span>
<span>    </span><span>WHERE</span><span>    </span><span>LENGTH</span><span>(</span><span>OperatorTitle</span><span>)</span><span> </span><span>&gt;</span><span> </span><span>1</span>
<span>    </span><span>AND</span><span>      </span><span>OperatorTitle</span><span> </span><span>NOT</span><span> </span><span>LIKE</span><span> </span><span>'(Unknown Operator)'</span>
<span>    </span><span>AND</span><span>      </span><span>OperatorTitle</span><span> </span><span>NOT</span><span> </span><span>LIKE</span><span> </span><span>'(Business Owner at Location)'</span>
<span>    </span><span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span>
<span>    </span><span>HAVING</span><span>   </span><span>n_locations</span><span> </span><span>&gt;</span><span> </span><span>1000</span><span>;</span>

<span>CREATE</span><span> </span><span>OR</span><span> </span><span>REPLACE</span><span> </span><span>TEMPORARY</span><span> </span><span>TABLE</span><span> </span><span>op_locations_fillin</span><span> </span><span>AS</span>
<span>    </span><span>SELECT</span><span> </span><span>SPLIT_PART</span><span>(</span><span>OperatorTitle</span><span>,</span><span> </span><span>' ('</span><span>,</span><span> </span><span>1</span><span>)</span><span> </span><span>AS</span><span> </span><span>OperatorTitle</span><span>,</span>
<span>           </span><span>AddressCountryIso2</span><span>,</span>
<span>           </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>n_locations</span>
<span>    </span><span>FROM</span><span>   </span><span>connections</span>
<span>    </span><span>WHERE</span><span>  </span><span>SPLIT_PART</span><span>(</span><span>OperatorTitle</span><span>,</span><span> </span><span>' ('</span><span>,</span><span> </span><span>1</span><span>)</span><span> </span><span>IN</span><span> </span><span>(</span>
<span>                </span><span>SELECT</span><span> </span><span>DISTINCT</span><span> </span><span>OperatorTitle</span>
<span>                </span><span>FROM</span><span>            </span><span>op_locations</span><span>)</span>
<span>    </span><span>AND</span><span>    </span><span>AddressCountryIso2</span><span> </span><span>IN</span><span> </span><span>(</span>
<span>                </span><span>SELECT</span><span> </span><span>DISTINCT</span><span> </span><span>AddressCountryIso2</span>
<span>                </span><span>FROM</span><span>            </span><span>op_locations</span><span>)</span>
<span>    </span><span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span><span>;</span>

<span>WITH</span><span> </span><span>pivot_alias</span><span> </span><span>AS</span><span> </span><span>(</span>
<span>    </span><span>PIVOT</span><span>    </span><span>op_locations_fillin</span>
<span>    </span><span>ON</span><span>       </span><span>AddressCountryIso2</span>
<span>    </span><span>USING</span><span>    </span><span>SUM</span><span>(</span><span>n_locations</span><span>)</span>
<span>    </span><span>GROUP</span><span> </span><span>BY</span><span> </span><span>OperatorTitle</span>
<span>)</span>
<span>SELECT</span><span>   </span><span>OperatorTitle</span><span>,</span>
<span>         </span><span>US</span><span>,</span>
<span>         </span><span>CA</span><span>,</span>
<span>         </span><span>*</span><span> </span><span>EXCLUDE</span><span>(</span><span>OperatorTitle</span><span>,</span><span> </span><span>US</span><span>,</span><span> </span><span>CA</span><span>)</span>
<span>FROM</span><span>     </span><span>pivot_alias</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>US</span><span> </span><span>DESC</span><span>;</span>
</pre></div>
<div><pre><span></span>┌──────────────────────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐
│      OperatorTitle       │   US   │   CA   │   DE   │   ES   │   FR   │   GB   │   IT   │   NL   │   PT   │
│         varchar          │ int128 │ int128 │ int128 │ int128 │ int128 │ int128 │ int128 │ int128 │ int128 │
├──────────────────────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ ChargePoint              │  23374 │   2483 │     19 │        │     53 │    317 │     14 │     20 │        │
│ Tesla                    │   7242 │    825 │    790 │     83 │    532 │    631 │    711 │    128 │    178 │
│ Blink Charging           │   6432 │     27 │        │        │        │    552 │        │        │        │
│ EV Connect               │   1687 │     64 │        │        │        │        │        │        │        │
│ Shell Recharge Solutions │   1289 │     95 │    823 │        │      4 │    273 │      1 │   1228 │        │
│ eVgo Network             │   1220 │        │        │        │        │        │        │        │        │
│ PEA Volta                │   1191 │      1 │        │        │        │        │        │        │        │
│ flo                      │    783 │   2958 │        │        │        │        │        │        │        │
│ Enel X                   │     16 │        │        │      1 │        │      2 │   4124 │        │        │
│ EV-Box                   │      3 │        │      9 │        │      3 │     17 │     24 │   2055 │        │
│ Endesa                   │        │        │        │   1291 │        │        │        │        │        │
│ Izivia                   │        │        │        │        │   1406 │        │        │        │        │
│ Mobie.pt                 │        │        │        │        │        │        │        │        │   1769 │
│ EVnetNL                  │        │        │      6 │        │        │        │        │   1788 │        │
│ ubitricity               │        │        │     57 │        │      3 │   5253 │        │        │        │
│ POD Point                │        │        │        │        │        │   3342 │        │      1 │        │
│ Chargeplace Scotland     │        │        │        │        │        │   1359 │        │        │        │
│ Innogy SE                │        │        │   2205 │        │        │      1 │        │        │        │
│ Circuit Electrique       │        │   2089 │        │        │        │        │        │        │        │
│ EnBW                     │        │        │   1268 │        │        │        │        │        │        │
│ Char.gy                  │        │        │        │        │        │   2862 │        │        │        │
│ Source London            │        │        │        │        │        │   1172 │        │        │        │
│ Mercadona                │        │        │        │   1071 │        │        │        │        │        │
│ BP Pulse                 │        │        │        │     73 │        │   2157 │        │        │        │
│ SureCharge               │        │        │        │        │        │   1780 │        │        │        │
│ Iberdrola                │        │        │        │   1734 │        │        │        │        │     36 │
│ ladenetz.de              │        │        │   1488 │        │        │        │        │      2 │        │
├──────────────────────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┤
│ 27 rows                                                                                        10 columns │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre></div>
</div>
<div id="charging-infrastructure">
<h2>Charging Infrastructure</h2>
<p>Below are the most popular connection types in Europe.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>ConnectionTypeTitle</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>*</span><span>)</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>AddressWorldRegion</span><span> </span><span>LIKE</span><span> </span><span>'%Europe'</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>2</span><span> </span><span>DESC</span>
<span>LIMIT</span><span>    </span><span>10</span><span>;</span>
</pre></div>
<div><pre><span></span>┌───────────────────────────────────┬──────────────┐
│        ConnectionTypeTitle        │ count_star() │
│              varchar              │    int64     │
├───────────────────────────────────┼──────────────┤
│ Type 2 (Socket Only)              │       147088 │
│ CCS (Type 2)                      │        32961 │
│ CEE 7/4 - Schuko - Type F         │        23758 │
│ Type 2 (Tethered Connector)       │        22946 │
│ CHAdeMO                           │        21898 │
│ Unknown                           │        12391 │
│ Tesla (Model S/X)                 │         4749 │
│ SCAME Type 3A (Low Power)         │         2257 │
│ SCAME Type 3C (Schneider-Legrand) │         2159 │
│ Type 1 (J1772)                    │         1445 │
├───────────────────────────────────┴──────────────┤
│ 10 rows                                2 columns │
└──────────────────────────────────────────────────┘
</pre></div>
<p>Below are the most popular connection types in North America.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>ConnectionTypeTitle</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>*</span><span>)</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>AddressWorldRegion</span><span> </span><span>=</span><span> </span><span>'northernAmerica'</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>2</span><span> </span><span>DESC</span>
<span>LIMIT</span><span>    </span><span>10</span><span>;</span>
</pre></div>
<div><pre><span></span>┌───────────────────────────┬──────────────┐
│    ConnectionTypeTitle    │ count_star() │
│          varchar          │    int64     │
├───────────────────────────┼──────────────┤
│ Type 1 (J1772)            │        56622 │
│ CCS (Type 1)              │         9869 │
│ CHAdeMO                   │         7554 │
│ Tesla (Model S/X)         │         6356 │
│ NACS / Tesla Supercharger │         2663 │
│ NEMA 5-20R                │         1375 │
│ Unknown                   │          443 │
│ NEMA 5-15R                │          247 │
│ NEMA 14-50                │          231 │
│ Avcon Connector           │           44 │
├───────────────────────────┴──────────────┤
│ 10 rows                        2 columns │
└──────────────────────────────────────────┘
</pre></div>
<p>There is a wide variety of power delivery specifications for each connection type. These are the most popular in Europe.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>ConnectionTypeTitle</span><span>          </span><span>AS</span><span> </span><span>Connector</span><span>,</span>
<span>         </span><span>ConnectorVoltage</span><span>             </span><span>AS</span><span> </span><span>Voltage</span><span>,</span>
<span>         </span><span>ConnectorAmps</span><span>                </span><span>AS</span><span> </span><span>Amps</span><span>,</span>
<span>         </span><span>ConnectorPowerKW</span><span>             </span><span>AS</span><span> </span><span>PowerKW</span><span>,</span>
<span>         </span><span>CurrentTypeTitle</span><span>             </span><span>AS</span><span> </span><span>Current</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>AS</span><span> </span><span>n_locations</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>AddressWorldRegion</span><span> </span><span>LIKE</span><span> </span><span>'%Europe'</span>
<span>AND</span><span>      </span><span>ConnectorVoltage</span><span> </span><span>&gt;</span><span> </span><span>0</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span><span>,</span><span> </span><span>3</span><span>,</span><span> </span><span>4</span><span>,</span><span> </span><span>5</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>6</span><span> </span><span>DESC</span>
<span>LIMIT</span><span>    </span><span>20</span><span>;</span>
</pre></div>
<div><pre><span></span>┌──────────────────────────────┬─────────┬───────┬─────────┬───────────────────┬─────────────┐
│          Connector           │ Voltage │ Amps  │ PowerKW │      Current      │ n_locations │
│           varchar            │  int64  │ int64 │ double  │      varchar      │    int64    │
├──────────────────────────────┼─────────┼───────┼─────────┼───────────────────┼─────────────┤
│ Type 2 (Socket Only)         │     400 │    32 │    22.0 │ AC (Three-Phase)  │       22279 │
│ Type 2 (Socket Only)         │     230 │    32 │     7.0 │ AC (Single-Phase) │        7525 │
│ Type 2 (Socket Only)         │     230 │    16 │     3.7 │ AC (Single-Phase) │        5311 │
│ Type 2 (Socket Only)         │     400 │    16 │    11.0 │ AC (Three-Phase)  │        4032 │
│ CEE 7/4 - Schuko - Type F    │     230 │    16 │     3.7 │ AC (Single-Phase) │        3202 │
│ Type 2 (Tethered Connector)  │     400 │    63 │    43.0 │ AC (Three-Phase)  │        2089 │
│ CHAdeMO                      │     400 │   125 │    50.0 │ DC                │        1819 │
│ Tesla (Model S/X)            │     400 │    32 │    22.0 │ AC (Three-Phase)  │        1811 │
│ Type 2 (Socket Only)         │     220 │     7 │     4.8 │ AC (Single-Phase) │        1797 │
│ Type 2 (Socket Only)         │     230 │    22 │     5.1 │ AC (Single-Phase) │        1771 │
│ Type 2 (Tethered Connector)  │     400 │    32 │    22.0 │ AC (Three-Phase)  │        1712 │
│ CHAdeMO                      │     500 │   100 │    50.0 │ DC                │        1613 │
│ Type 2 (Socket Only)         │     230 │     7 │     5.0 │ AC (Single-Phase) │        1582 │
│ SCAME Type 3A (Low Power)    │     240 │    16 │     3.7 │ AC (Single-Phase) │        1495 │
│ Type 2 (Socket Only)         │     400 │    32 │    22.0 │ DC                │        1450 │
│ Unknown                      │     230 │    16 │     3.7 │                   │        1414 │
│ CCS (Type 2)                 │     500 │   100 │    50.0 │ DC                │        1051 │
│ Type 2 (Socket Only)         │     230 │    32 │     7.4 │ AC (Single-Phase) │        1036 │
│ CHAdeMO                      │     500 │   120 │    50.0 │ DC                │        1016 │
│ CCS (Type 2)                 │     400 │   125 │    50.0 │ DC                │        1003 │
├──────────────────────────────┴─────────┴───────┴─────────┴───────────────────┴─────────────┤
│ 20 rows                                                                          6 columns │
└────────────────────────────────────────────────────────────────────────────────────────────┘
</pre></div>
<p>These are the most popular in North America.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>ConnectionTypeTitle</span><span>,</span>
<span>         </span><span>ConnectorVoltage</span><span>,</span>
<span>         </span><span>ConnectorAmps</span><span>,</span>
<span>         </span><span>ConnectorPowerKW</span><span>,</span>
<span>         </span><span>CurrentTypeTitle</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>n_locations</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>AddressWorldRegion</span><span> </span><span>=</span><span> </span><span>'northernAmerica'</span>
<span>AND</span><span>      </span><span>ConnectorVoltage</span><span> </span><span>&gt;</span><span> </span><span>0</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span><span>,</span><span> </span><span>3</span><span>,</span><span> </span><span>4</span><span>,</span><span> </span><span>5</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>6</span><span> </span><span>DESC</span>
<span>LIMIT</span><span>    </span><span>20</span><span>;</span>
</pre></div>
<div><pre><span></span>┌─────────────────────┬──────────────────┬───────────────┬──────────────────┬───────────────────┬─────────────┐
│ ConnectionTypeTitle │ ConnectorVoltage │ ConnectorAmps │ ConnectorPowerKW │ CurrentTypeTitle  │ n_locations │
│       varchar       │      int64       │     int64     │      double      │      varchar      │    int64    │
├─────────────────────┼──────────────────┼───────────────┼──────────────────┼───────────────────┼─────────────┤
│ Type 1 (J1772)      │              230 │            16 │              3.7 │ AC (Single-Phase) │       45891 │
│ Type 1 (J1772)      │              230 │            16 │              3.0 │ AC (Single-Phase) │        4842 │
│ Tesla (Model S/X)   │              230 │            16 │              3.7 │ AC (Single-Phase) │        1419 │
│ CCS (Type 1)        │              400 │           100 │             40.0 │ DC                │        1338 │
│ CHAdeMO             │              400 │           100 │             40.0 │ DC                │        1180 │
│ Type 1 (J1772)      │              230 │            32 │              7.0 │ AC (Single-Phase) │         698 │
│ Tesla (Model S/X)   │              230 │            16 │             16.0 │ AC (Single-Phase) │         568 │
│ Tesla (Model S/X)   │              230 │            16 │              8.0 │ AC (Single-Phase) │         433 │
│ NEMA 5-20R          │              120 │            16 │              1.9 │ AC (Single-Phase) │         414 │
│ NEMA 5-20R          │              120 │            16 │              1.0 │ AC (Single-Phase) │         233 │
│ NEMA 5-15R          │              120 │            16 │              1.9 │ AC (Single-Phase) │         222 │
│ Tesla (Model S/X)   │              230 │            16 │             13.0 │ AC (Single-Phase) │         165 │
│ CCS (Type 1)        │              400 │           100 │             40.0 │ AC (Single-Phase) │         123 │
│ NEMA 14-50          │              120 │            16 │              1.9 │ AC (Single-Phase) │         123 │
│ Unknown             │              230 │            16 │              3.0 │ AC (Single-Phase) │         113 │
│ CHAdeMO             │              400 │           100 │             40.0 │ AC (Single-Phase) │         111 │
│ Type 1 (J1772)      │              240 │            72 │             17.3 │                   │         110 │
│ CCS (Type 1)        │              400 │           125 │             50.0 │ DC                │          92 │
│ CHAdeMO             │              400 │           125 │             50.0 │ DC                │          92 │
│ Unknown             │              120 │            16 │              1.9 │ AC (Single-Phase) │          50 │
├─────────────────────┴──────────────────┴───────────────┴──────────────────┴───────────────────┴─────────────┤
│ 20 rows                                                                                           6 columns │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
</pre></div>
<p>Looking at the most popular connection and power delivery combination for North America, it's not one but many operators that offer this combination.</p>
<div><pre><span></span><span>SELECT</span><span>   </span><span>OperatorTitle</span><span>,</span>
<span>         </span><span>ConnectionTypeTitle</span><span>,</span>
<span>         </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>n_locations</span>
<span>FROM</span><span>     </span><span>connections</span>
<span>WHERE</span><span>    </span><span>ConnectorVoltage</span><span> </span><span>=</span><span> </span><span>230</span>
<span>AND</span><span>      </span><span>ConnectorAmps</span><span> </span><span>=</span><span> </span><span>16</span>
<span>AND</span><span>      </span><span>ConnectorPowerKW</span><span> </span><span>=</span><span> </span><span>3</span><span>.</span><span>7</span>
<span>AND</span><span>      </span><span>CurrentTypeTitle</span><span> </span><span>=</span><span> </span><span>'AC (Single-Phase)'</span>
<span>AND</span><span>      </span><span>LENGTH</span><span>(</span><span>OperatorTitle</span><span>)</span><span> </span><span>&gt;</span><span> </span><span>1</span>
<span>AND</span><span>      </span><span>AddressWorldRegion</span><span> </span><span>=</span><span> </span><span>'northernAmerica'</span>
<span>GROUP</span><span> </span><span>BY</span><span> </span><span>1</span><span>,</span><span> </span><span>2</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>3</span><span> </span><span>DESC</span>
<span>LIMIT</span><span>    </span><span>20</span><span>;</span>
</pre></div>
<div><pre><span></span>┌───────────────────────────────────┬─────────────────────┬─────────────┐
│           OperatorTitle           │ ConnectionTypeTitle │ n_locations │
│              varchar              │       varchar       │    int64    │
├───────────────────────────────────┼─────────────────────┼─────────────┤
│ ChargePoint                       │ Type 1 (J1772)      │       18837 │
│ Blink Charging                    │ Type 1 (J1772)      │        5770 │
│ flo                               │ Type 1 (J1772)      │        2654 │
│ Circuit Electrique                │ Type 1 (J1772)      │        1718 │
│ EV Connect                        │ Type 1 (J1772)      │        1193 │
│ Tesla (Tesla-only charging)       │ Tesla (Model S/X)   │        1184 │
│ PEA Volta                         │ Type 1 (J1772)      │        1141 │
│ Shell Recharge Solutions (US)     │ Type 1 (J1772)      │         882 │
│ AmpUp                             │ Type 1 (J1772)      │         764 │
│ SWTCH - Charge Everywhere         │ Type 1 (J1772)      │         482 │
│ SemaConnect                       │ Type 1 (J1772)      │         394 │
│ Livingston Charge Port            │ Type 1 (J1772)      │         325 │
│ OpConnect                         │ Type 1 (J1772)      │         296 │
│ eVgo Network                      │ Type 1 (J1772)      │         230 │
│ GE WattStation (No longer active) │ Type 1 (J1772)      │         162 │
│ Rivian Waypoints L2 Network       │ Type 1 (J1772)      │         160 │
│ ChargeUp (NovaCharge)             │ Type 1 (J1772)      │         146 │
│ Universal EV Charging             │ Type 1 (J1772)      │         143 │
│ Blink Charging (Europe)           │ Type 1 (J1772)      │         136 │
│ Powerflex                         │ Type 1 (J1772)      │         134 │
├───────────────────────────────────┴─────────────────────┴─────────────┤
│ 20 rows                                                     3 columns │
└───────────────────────────────────────────────────────────────────────┘
</pre></div>
</div>
<div id="charging-point-access">
<h2>Charging Point Access</h2>
<p>In terms of location access, the vast majority are publically available. Of those that are private, they still might be accessible as both "For Staff, Visitors or Customers" and "Privately Owned - Notice Required" are included in the 16,229 locations below.</p>
<div><pre><span></span><span>SELECT</span><span> </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>UsageTypeTitle</span><span> </span><span>LIKE</span><span> </span><span>'Public%'</span><span>)</span><span> </span><span>AS</span><span> </span><span>public</span><span>,</span>
<span>       </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>UsageTypeTitle</span><span> </span><span>LIKE</span><span> </span><span>'Private%'</span><span>)</span><span> </span><span>AS</span><span> </span><span>private</span><span>,</span>
<span>       </span><span>COUNT</span><span>(</span><span>DISTINCT</span><span> </span><span>LocationUUID</span><span>)</span><span> </span><span>FILTER</span><span> </span><span>(</span><span>WHERE</span><span> </span><span>UsageTypeTitle</span><span> </span><span>NOT</span><span> </span><span>LIKE</span><span> </span><span>'Public%'</span>
<span>                                            </span><span>AND</span><span>   </span><span>UsageTypeTitle</span><span> </span><span>NOT</span><span> </span><span>LIKE</span><span> </span><span>'Private%'</span><span>)</span><span> </span><span>AS</span><span> </span><span>unknown</span><span>,</span>
<span>FROM</span><span> </span><span>connections</span>
<span>ORDER</span><span> </span><span>BY</span><span> </span><span>1</span><span> </span><span>DESC</span><span>;</span>
</pre></div>
<div><pre><span></span>┌────────┬─────────┬─────────┐
│ public │ private │ unknown │
│ int64  │  int64  │  int64  │
├────────┼─────────┼─────────┤
│ 150481 │   16229 │     657 │
└────────┴─────────┴─────────┘
</pre></div>
</div>

        </div><p>
            Thank you for taking the time to read this post. I offer both consulting and hands-on development services to clients in North America and Europe. If you'd like to discuss how my offerings can help your business please contact me via <a href="https://uk.linkedin.com/in/marklitwintschik/">LinkedIn</a>.
        </p></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Rearchitecting: Redis to SQLite (164 pts)]]></title>
            <link>https://wafris.org/blog/rearchitecting-for-sqlite</link>
            <guid>41645173</guid>
            <pubDate>Wed, 25 Sep 2024 08:37:48 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://wafris.org/blog/rearchitecting-for-sqlite">https://wafris.org/blog/rearchitecting-for-sqlite</a>, See on <a href="https://news.ycombinator.com/item?id=41645173">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
             <p>Pssst - want to skip right to the chart? <a href="#chart">click here</a></p>
<h2>Background</h2>
<p>We're Wafris, an open-source web application firewall company that, among other frameworks, ships a Rails middleware client.</p>
<p>At launch, the v1 client required a local Redis datastore to be deployed with your app. We're now releasing v2 of our Rails client which uses SQLite as the backing datastore.</p>
<p>This article covers the decision-making that went into our migration from Redis to SQLite, performance considerations, and architectural changes. Continue reading this if you're interested in the decision-making that went into our migration to SQLite from Redis for our clients (the deployed middleware)</p>
<h2>TL;DR</h2>
<ul>
<li>SQLite has things it's good and bad at.</li>
<li>Redis has things it's good and bad at.</li>
<li>Traditional RDBMS (Postgres/MySQL) have things they're good and bad at.</li>
</ul>
<p>These data stores are not drop-in replacements, and if you try to do that, you'll have a bad time. This article walks through the testing and decision-making that went into rearchitecting our v1 Redis-based client to our v2 SQLite-based client.</p>
<h2>What forced this change?</h2>
<p>Since day one of Wafris, our goal has been to make it as easy as possible for developers to protect their sites.</p>
<p>But our v1 has had mixed results in delivering on that promise. We made what we thought at the time was a solid choice to back the Wafris client with a user-owned (bring your own) Redis datastore.</p>
<p>Partially, this was due to our having come up in the Heroku ecosystem, where Redis is an easy click away to get going and deployed in such a way that it's easy to access remotely. We also looked at successful projects like Sidekiq, which had a similar model.</p>
<blockquote><p>If we're trying to make things easy on you, we shouldn't casually make you a Redis database admin in the process.</p></blockquote>
<p>But the ecosystem is much larger than that, and many of our users encountered Redis deployment issues that were difficult to debug and fix.</p>
<p>In other words, if we're trying to make things easy on you, we shouldn't casually make you a Redis database admin in the process.</p>
<p>Further, when we exhibited at <a href="https://wafris.org/blog/railsworld-2023-recap" rel="follow">RailsWorld 2023</a>, there was a definite "blood in the water" vibe regarding Redis and the assumption that you'd automatically need a Redis server running alongside your Rails application.</p>
<h2>What is Speed?</h2>
<p>While Redis is "fast" in comparison to traditional RDBMS, it's still a database that you have to manage connections, memory, processes, etc., which introduces more brittleness into the stack (the opposite of what we're trying to achieve).</p>
<p>And more than any of those, if you're in a cloud environment, you're looking at network latency. Network delays are a big deal for us as every inbound HTTP request to your app must be evaluated against the rules stored in Wafris. So while we sweated blood and code to get our v1 client as fast as possible, we'd often wind up in situations where, despite our best efforts, we'd still slow down an application as the network the app was provisioned into was slow.</p>
<p><img src="https://cdn.buttercms.com/Qgraed3TIekXzqhffUFR" alt="network-latency.webp" width="565" height="228"></p>

<h2>Monolith-ish Assumptions</h2>
<p>While there certainly exist wholly distributed applications out there, and while most Rails apps are "majestic monoliths" (tm? idk, don't sue me), we've found a lot of distributed apps that messed up our assumptions.</p>
<p>Apps that deploy to multiple zones, split functionality into servers with overlapping responsibilities, or are only partially Rails and deployed alongside other languages or frameworks.</p>
<p>Mostly, things aren't that clean in production, introducing even more friction with using Redis.</p>
<h2>Forcing a rethink of our architecture</h2>
<p>Wafris is a web application firewall. In Rails, it's installed as a middleware. It lets you set rules like "block the IP 1.2.3.4," and then when someone requests your site, you evaluate that request against those rules.</p>
<p>Imagine it's this simplified two-step process:</p>
<ol>
<li>Compare HTTP request against the rules (if match == 403, else 200)</li>
<li>Report treatment (blocked, allowed, passed)</li>
</ol>
<p>Abstractly, this is a paired "read" of the rules in the database (step 2) and then a "write" of the report detailing what was done with that request along with its data.</p>
<p>From a logical standpoint, the first "read" half of this process is vastly more important than the latter "write" half:</p>
<ul>
<li>Reads, aka "requests," need to be handled sequentially</li>
<li>Filtering of requests <em>must</em> work or bad requests could get through</li>
<li>Reads, aka "requests," are time-sensitive as they affect user-perceived site performance.</li>
<li>Writes, aka "reporting," can be done slower, batched, async, etc.</li>
</ul>
<h2>Enter SQLite</h2>
<p>Others have written far more eloquently about what SQLite is suitable for in general than I could ever hope to do so myself, so on that topic, I'll point you to the following resources:</p>
<ul>
<li>Aaron Francis' "High Performance SQLite" course at <a href="https://highperformancesqlite.com/" rel="follow">https://highperformancesqlite.com/</a></li>
<li>Stephen Margheim's "SQLite on Rails" - <a href="https://fractaledmind.github.io/2024/04/15/sqlite-on-rails-the-how-and-why-of-optimal-performance/" rel="follow">the how and why of optimal performance</a>&nbsp;</li>
<li>Oldmoe - <a href="https://oldmoe.blog/" rel="follow">https://oldmoe.blog/</a></li>
</ul>
<h2>What's good about SQLite for Wafris?</h2>
<p>As noted above, our major bottleneck is network IO, and Stephen mentioned this line from the SQLite documentation: "SQLite does not compete with client/server databases. SQLite competes with fopen()."</p>
<blockquote><p>SQLite does not compete with client/server databases. SQLite competes with fopen().</p></blockquote>
<p>In theory, this should be much faster than a Redis solution solely based on cutting out the network round trip.</p>
<p>So, we decided to benchmark SQLite vs Redis.</p>
<h2>Benchmarking SQLite and Redis</h2>
<p>Benchmarking is a dark art of deceiving yourself with highly precise numbers.</p>
<p>And benchmarketing datastores is even more fraught. Every single flipping database benchmark I've ever seen has been covered in a layer of asterisks and qualifications, and the comments on HN are full of "if you'd just set this flag when compiling it, you'd get 3% more speed out of reads, and the fact that the people running this didn't do this is proof that they were paid off and that they actively sell shady NFT scams of deranged yacht rock Harambe memes.</p>
<p><img src="https://cdn.buttercms.com/4QeEUKlrSmSXIwf4F6by" alt="undefined" width="351" height="351"></p>
<p>However, we have an advantage here. We're not trying to get some absolute number of speed under pristine conditions and carefully tweaked settings. We are creating a wildly specific and biased benchmark against our own data in a use case that lends itself to some extremes that I would neither expect nor hope that anyone else would have to deal with.</p>

<h3>Studiously ignoring optimization tweaks</h3>
<p>We're trying to optimize for people throwing Wafris into their app and having it "Just Work™" (ok, this one might actually be <a href="https://trademarks.justia.com/776/82/it-just-works-77682144.html">trademarked</a>).</p>
<p>We're also not testing against some theoretical benchmark suite (that can be gamed ala <a href="https://www.theregister.com/2021/01/28/nvidia_tpc_benchmark/#::text=Nvidia%20has%20been%20accused%20of,very%20umpires%20of%20the%20test">NVIDIA</a>).</p>
<p>We're testing the hot path of <em>our</em> own application and <em>our</em> worst query.</p>
<p>Our worst query is a somewhat complicated request for a "lexical decimal" data structure that maps IP ranges (v4 and v6) against categories. The simplest to consider is IP -&gt; Country mapping, where we return the country if an IP address is within a range of two addresses.</p>
<p>It's terrible because these structures are, by necessity, large (millions of rows), and in the case of IPv6, every single entry is huge.</p>
<p>To make this happen, we precompute the range lookups and then wrote them to:</p>
<ul>
<li>A table in SQLite</li>
<li>A <a href="https://redis.io/docs/latest/develop/data-types/sorted-sets/">sorted set</a> in Redis</li>
</ul>
<p>For each inbound HTTP request, we, in the pathological case, have to check the requesting IP against:</p>
<ol>
<li>Custom Allow ranges</li>
<li>Custom Block ranges</li>
<li>GeoIP ranges</li>
<li>IP Reputation ranges</li>
</ol>
<p>This is what we mean by "hot path"—this singular query type is so important that we can ignore all the rest of the query types and functions.<a href="https://moderndaymoguls.com/2020/01/05/peloton-bike/" rel="follow"></a></p>
<p>So, for our benchmarking scripts, we tested only this one query type, saving us days of work porting more significant (but irrelevant to the hot path) portions of the app to the benchmark.</p>
<h2>The Testing Protocol</h2>
<p><img src="https://cdn.buttercms.com/HklvqQLITaOLUv9bna3b" alt="undefined"></p>
<p>Testing was done on my local Macbook Air M2 with a homebrew installed Redis and local SQLite db.</p>
<ol>
<li>We tested against our existing ranges dataset (1.2 million entries)</li>
<li>Multiple sets of IPs were then run in the same order against both SQLite and Redis.</li>
<li>At each multiple, we ran the test 5 times and took the average of the runs.</li>
</ol>
<h2>Testing Results</h2>
<p><img src="https://cdn.buttercms.com/gd2RyAi4RGiz44JhWGOH" alt="undefined" width="739" height="554"></p>

<p>SQLite beat Redis like an overhyped UFC fighter doing a jump off the fence to land a kick punch (for our particular use case in this niche)</p>
<p>SQLite was roughly a 3x speed improvement over a locally deployed Redis instance. YMMV. Note again that this is before any network latency is considered.</p>
<p>From our perspective, this was a fantastic result as even if SQLite were only on par with Redis locally, we'd still win by being able to entirely axe network times.</p>
<p>I'd like to stress again that this is extremely flawed testing (by design) with really naive settings, but it is done in a way that mirrors the flaws of real-world usage we observed.</p>
<h2>What's missing from the chart?</h2>
<p>Benchmarks exist in a vacuum. What the chart fails to capture is that:</p>
<ul>
<li>Even if the SQLite performance was significantly worse (like 2x worse) in the benchmark, it would <em>still</em> probably be faster in the "real world" because of network latency, even to a Redis that was in the same data center/region</li>
<li>Even if you had a super robust Redis server (cluster, sharded, etc.), there are still a bunch of limits around it for network bandwidth, connections, etc., and again cross-region latency. SQLite gets us near-infinite horizontal scaling for "free"; more on this below.</li>
<li>The onboarding is so much better with SQLite - I imagine most users won't even know that it's being used; they'll just add the gem to their web app and be up and running.</li>
<li>There are a lot of potential improvements that could be done to get more juice out of Redis. However, we've been unable to consistently persuade users to make even basic configuration changes (like cache eviction policy) to their Redis setups as it's such a pain and they don't want to be Redis admins.</li>
</ul>
<p>We're focused on:</p>
<ol>
<li>Making Wafris easy to deploy</li>
<li>Making rule evaluation as fast as possible</li>
</ol>
<p>Everything else flows from that, so that's what we're rearchitecting towards. NOT "the best database setup," not "the easiest infrastructure for us (Wafris) to manage," etc.</p>
<h2>Results are just the start</h2>
<p>Great, so now that we've established that SQLite is faster than Redis (caveats, caveats, caveats), everything still isn't great because there are real-world tradeoffs.</p>
<p>One <em>huge</em> tradeoff in the testing above is that we didn't even consider doing any writes.</p>
<p>While it's never really stated, the whole reason for a "proper" database to have connections, connection pools, transactions, and whatever proprietary magic allows Oracle to charge a billion dollars for a database is to manage writes contending with reads for data in your database.</p>
<p>Consider an electric Chinese supercar driven by a charming British man - it's fast, it's fantastic, and it is absolute bollocks at hauling a load of concrete blocks across town.</p>
<p><a href="https://www.youtube.com/watch?v=DzFT5ndMZ_Q" rel="follow"><img src="https://cdn.buttercms.com/iX3Bns2ySayFT5LOKidM" alt="undefined" width="713" height="398"></a></p>
<p>SQLite is like that NIO EP9 supercar. We need to use it for what it's good at and not force it into a role it's not suited for.</p>
<h2>Building a sync architecture</h2>
<p>On v1 (Redis), the update loop looked like this:</p>
<ol>
<li>User updates a rule ("block the IP 1.2.3.4") in Wafris Hub</li>
<li>Wafris Hub updates the rules in your Redis datastore</li>
</ol>
<p>This obviously won't work with SQLite because we can't "push" a SQLite database to a web server. There are some newer SQLite as a service providers that let you do a version of this, but for a variety of cost, performance, and security considerations, it won't work for us as we'd still need individual users to deploy them, open ports, allow inbound connections, etc.</p>
<p>On v2 (SQLite), the update loop looks like this:</p>
<ol>
<li>User updates a rule ("block the IP 1.2.3.4") in Wafris Hub</li>
<li>At some interval (time or number of requests), the client checks for updated rules</li>
<li>If rules are updated, the client downloads an entirely new SQLite database</li>
</ol>
<p>This works well as it removes much of the user's installation and configuration responsibility.</p>
<p>We're seeing a ~3x increase in successful installs of the v2 client.</p>
<h2>SQLite Distributed Architecture</h2>
<p>Consider a Rails app deployed to a cloud provider (AWS, Heroku, Fly, etc). with autoscaling enabled.</p>
<p>Your requests go from 100 req/s to 10,000 req/s. and your compute (dynos, machines, ec2 instances) start spinning up to handle the load, but does your database?</p>
<p>The answer is almost certainly no because a bottleneck is a bottleneck without the database, and while you could overprovision it by 100x "just in case," realistically, nobody wants to do that.</p>
<p><code><img src="https://cdn.buttercms.com/F4yeDPLUSN2JsDEZrOLD" alt="singular.webp"></code></p>
<p>In practice, this is the number one thing that we see kill Rails apps under heavy load. Rarely is it an actual DDOS attack; more often, it's a credential stuffing attack or a bad bot that is hammering a site, pushing up autoscaling that's then exhausting database connections, which causes the app to fall over.</p>
<p><code><img src="https://cdn.buttercms.com/kjwGl08yRwiwjX9GLdrp" alt="distributed.webp"></code></p>
<p>Flipping this to a system where an SQLite DB is synced down to each compute instance solves this problem excellently by keeping all the calls local to the new compute instance.</p>
<h2>But what about writes?</h2>
<p>We started this article by discussing splitting the app into a read (rule evaluation) and write (reporting) path and then studiously ignored the write path.</p>
<p>We did rearchitect the write path to do the following:</p>
<ul>
<li>Async connects to Wafris Hub for reporting</li>
<li>Batch sending of the reports</li>
<li>Completely removing database writes from the clients</li>
</ul>
<p>Which will work for approximately 0% of everybody else, but we don't care about them.</p>
<p>We care about the 100% of our users who want the Wafris client to be easy to deploy and stupid fast.</p>
<p>It's hard to know if there's a lesson you can learn from reading all of this, but we sincerely appreciate you taking the time.</p>
<h2>Conclusion</h2>
<p>First: thanks to <a href="https://x.com/aarondfrancis" rel="follow">Aaron Francis</a>, <a href="https://x.com/tnorthcutt" rel="follow">Travis Northcutt</a>,&nbsp; <a href="https://brianhogg.com/">Brian Hogg</a>, <a href="https://twitter.com/dceddia.com">Dave Ceddia</a>, <a href="https://push.cx/">Peter Bhat Harkins</a> and <a href="https://x.com/natebosscher?lang=en">Nate Bosscher</a> for their feedback and suggestions on this post.</p>
<p>Second: we're exceedingly happy with our v2 architecture, which uses SQLite. It's already helped many sites weather attacks and stay online.</p>
<p>It's much easier to get going, with less support work for us and less hassle for users, which we think is a win for a safer, more secure internet.</p>
<p>If you'd like to get started, sign up on <a href="https://wafris.org/signup" rel="follow">Wafris Hub</a>.</p>
          </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[New California law requires one-click subscription cancellations (131 pts)]]></title>
            <link>https://thedesk.net/2024/09/california-one-click-subscription-cancellation-law/</link>
            <guid>41644315</guid>
            <pubDate>Wed, 25 Sep 2024 06:33:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://thedesk.net/2024/09/california-one-click-subscription-cancellation-law/">https://thedesk.net/2024/09/california-one-click-subscription-cancellation-law/</a>, See on <a href="https://news.ycombinator.com/item?id=41644315">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="page">
<main id="main">
<article id="post-32892">
<div>

<div>
<figure id="attachment_30071" aria-describedby="caption-attachment-30071"><img loading="lazy" decoding="async" src="https://thedesk.net/wp-content/uploads/2024/06/BLANK-Streaming-TV-Apple-Remote-WEBP-TD.webp" alt="An Apple TV remote control." width="1200" height="628" srcset="https://thedesk.net/wp-content/uploads/2024/06/BLANK-Streaming-TV-Apple-Remote-WEBP-TD.webp 1200w, https://thedesk.net/wp-content/uploads/2024/06/BLANK-Streaming-TV-Apple-Remote-WEBP-TD-300x157.webp 300w, https://thedesk.net/wp-content/uploads/2024/06/BLANK-Streaming-TV-Apple-Remote-WEBP-TD-768x402.webp 768w" sizes="(max-width: 1200px) 100vw, 1200px"><figcaption id="caption-attachment-30071">(Stock photo by James Yarema via Unsplash)</figcaption></figure>
<p>A new law in California will make it easier for consumers to cancel their streaming subscriptions and similar products when they enroll in automatic renewal of those services.</p>
<p>The law, passed through Assembly Bill (AB) 2863, will require companies that offer automatic subscription renewals through one-click purchases to also offer customers a way to cancel their subscriptions through the same one-click method.</p>
<p>California already had one of the toughest subscription cancellation laws in the country, requiring companies to offer a way to cancel a recurring subscription through the Internet if they allowed customers to sign up for a service that way.</p>
<p>The initial law was meant to prevent companies from allowing customers to purchase a subscription through the web, while forcing them to call a hotline to cancel them. Consumer advocacy groups complained that companies would often subject customers to frustrating long wait times on the phone with the hope that they would eventually hang up without cancelling their service.</p>
<p>While the law was good in theory, it contained at least one loophole: Companies were in compliance as long as they offered a way for customers to cancel their subscriptions online, but could make them click several links or visit several webpages with opt-in requirements before a cancellation request was processed.</p>
<p>Soon, companies will have to offer easier, one-click cancellation methods if they allow customers to purchase a subscription using a one-click technique. The new law takes effect on January 1, 2025, and would cover purchases and contracts entered into from the following July.</p>
<p>The bill’s co-author, Assembly Member Pilar Schiavo, said the goal of AB 2863 was to help Californians save money at a time when subscription costs were adding up.</p>
<p>“California is setting a model for the nation on protecting consumers from unnecessary charges, giving them more control over their finances and helping to ensure fair business practices, providing a win for both consumers and small businesses,” Schiavo said on Tuesday. “I’m grateful that this important legislation was signed, as it will mean more money in the pockets of people throughout our community.”</p>
<p>The measure will have a significant impact on companies with digital products that allow customers to purchase subscription-based services using one-click tools. Companies like Roku, Amazon and Apple already allow users of their streaming hardware to purchase and cancel subscription using one-click techniques.</p>
<p>Some digital newspaper outlets, fitness clubs, software developers and other services allow customers to purchase subscriptions through a one-click button, but still require filling out a form or navigating through several web pages before they process a cancellation.</p>
<p>Those days are about to come to an end, warned the Consumer Federation of California (CFC), an advocacy group that backed the proposal.</p>
<p>“Consumers have had it with pocketbook-sucking subscriptions where it is almost impossible to cancel,” Robert Herrell, the Executive Director of CFC, said on Tuesday. “It should be as simple to get out of a subscription as it is to get into one. This is simple common-sense and California now has the most comprehensive law in the nation on this topic. From software subscriptions to gym memberships to a wine club, consumers should have easy control of their subscriptions.”</p>
</div>


<div>
<div><p><img alt="Photo of author" src="https://thedesk.net/wp-content/uploads/2024/06/cropped-1709778040233-100x100.jpg" srcset="https://thedesk.net/wp-content/uploads/2024/06/cropped-1709778040233-200x200.jpg 2x" height="100" width="100" loading="lazy" decoding="async">
</p></div>
<div>
<p><strong>About the Author: </strong></p>
<p> <a href="https://thedesk.net/author/matthewkeys/">Matthew Keys</a></p>
<p>Matthew Keys is a nationally-recognized, award-winning journalist who has covered the business of media, technology, radio and television for more than 11 years. He is the publisher of The Desk and contributes to Know Techie, Digital Content Next and StreamTV Insider. He previously worked for Thomson Reuters, the Walt Disney Company, McNaughton Newspapers and Tribune Broadcasting.</p>
</div>
</div>
<p><span><span><a href="https://thedesk.net/">Home</a></span> » <span><a href="https://thedesk.net/category/news/">News</a></span> » <span aria-current="page"><strong>New California law requires one-click subscription cancellations</strong></span></span>
</p>
 </div>
</article>
</main>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Firefox tracks you with “privacy preserving” feature (110 pts)]]></title>
            <link>https://noyb.eu/en/firefox-tracks-you-privacy-preserving-feature</link>
            <guid>41643991</guid>
            <pubDate>Wed, 25 Sep 2024 05:34:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://noyb.eu/en/firefox-tracks-you-privacy-preserving-feature">https://noyb.eu/en/firefox-tracks-you-privacy-preserving-feature</a>, See on <a href="https://news.ycombinator.com/item?id=41643991">Hacker News</a></p>
Couldn't get https://noyb.eu/en/firefox-tracks-you-privacy-preserving-feature: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[NIST to forbid requirement of specific passwords character composition (235 pts)]]></title>
            <link>https://mastodon.social/@LukaszOlejnik/113193089731407165</link>
            <guid>41643700</guid>
            <pubDate>Wed, 25 Sep 2024 04:30:36 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mastodon.social/@LukaszOlejnik/113193089731407165">https://mastodon.social/@LukaszOlejnik/113193089731407165</a>, See on <a href="https://news.ycombinator.com/item?id=41643700">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Doom on a modified rotary phone (115 pts)]]></title>
            <link>https://tamulaitis.lt/project/dialrhea/</link>
            <guid>41643690</guid>
            <pubDate>Wed, 25 Sep 2024 04:29:07 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://tamulaitis.lt/project/dialrhea/">https://tamulaitis.lt/project/dialrhea/</a>, See on <a href="https://news.ycombinator.com/item?id=41643690">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>  <article>  <div> 
    
  
<p>Dialrhea is a modified rotary phone that has been repurposed to control the classic first-person shooter game Doom via Bluetooth. We built it in two days during the “Internet Of Shit” hackathon organized by Technarium crew in Vilnius, Lithuania. The theme of this hackathon was to build devices that are completely useless, but fully functional. Here is Dialrhea in action:</p>

<div>
        <iframe src="https://www.youtube.com/embed/YNjw6ZKlyNM" title="Watch Dialrhea in action" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
        <p><span><strong>Watch Dialrhea in action</strong>: https://www.youtube.com/watch?v=YNjw6ZKlyNM</span>
      </p></div>
    
<p>During the same weekend we also made a “slick” promotional video demonstrating capabilities of this revolutionary shitty machine.</p>

<div>
        <iframe src="https://www.youtube.com/embed/RVSE1t3wHlI" title="Watch Dialrhea promotional video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
        <p><span><strong>Watch Dialrhea promotional video</strong>: https://www.youtube.com/watch?v=RVSE1t3wHlI</span>
      </p></div>
    
<h2 id="whats-next">What’s next?</h2>
<p>I would like to host a workshop where we would build at least three more devices, and then play a Doom death match using these devices. Ideal setting would be some hacker camp or similar event. If you have ideas how to make it happen, drop me a line.</p>
<h2 id="the-story">The Story</h2>
<p>The device was built during “Internet Of Shit” hackathon. It’s an amazing event that was hosted by Technarium crew in Vilnius, Lithuania in 2017 and 2018. Award categories included the likes of “Fire Means It’s Working”, “Least Private On-line Gadget”, “This is Likely Illegal”, and the teams were competing hard to turn these concepts into a working piece of technology.</p>
<p>Our device won the “Least Shitty project” award, and we were also awarded the “Public Prize” for the most popular project. It is worth mentioning that the prize was a rubber drainage cleaning pump sprayed with gold paint.</p>
<p>The ingenious idea was generated after a few beers with Donatas Valiulis and Džiugas Bartkus. The tree of us carried out the whole operation with me and Donatas taking care of technical aspects and Džiugas responsible for video production and promotional materials.</p>
<p>Džiugas also made a nice trippy video about the making of the device and the whole hackathon in general.</p>

<div>
        <iframe src="https://www.youtube.com/embed/nAaBJcYIFyU" title="Watch Dialrhea making of video" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
        <p><span><strong>Watch Dialrhea making of video</strong>: https://www.youtube.com/watch?v=nAaBJcYIFyU</span>
      </p></div>
    
<p>There were lots of other absurd projects built during the event, if you are interested, 
    <a href="https://www.youtube.com/watch?v=fujuv8Wm4F8" target="_blank" rel="noopener">here is the full one hour long presentation</a>
   of all projects of “Internet of Shit 2017” including Dialrhea.</p>
<h2 id="appearances">Appearances</h2>
<p>In addition to the hackathon, the device was also a guest of honor in numerous events including Maker Faire 2017 at The Energy and Technology Museum, No Trolls Allowed hacker camp, Vilnius Tech Park birthday, Braille Satellite music festival and others.</p>
<h3 id="vilnius-tech-park-birthday-2018">Vilnius Tech Park birthday 2018</h3>
<p>I spent quite some time in a co-working space in a newly opened Sapiegos Tech Park, a start-up / scale-up infested complex of old hospital buildings in a middle of a beautiful park in the center of the city. An amazing place where I met a lot of interesting people, attended many events and heard a tons of interesting business ideas being pitched near the kitchen sink. When Sapiegos Tech Park celebrated their second birthday I offered to fire up Dialrhea as an interactive installation.</p>

    <div>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/dialrhea-at-sapiegos-tech-park-2019-1.webp" alt="Dialrhea at Sapiegos Tech Park 1">
        </p>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/dialrhea-at-sapiegos-tech-park-2019-2.webp" alt="Dialrhea at Sapiegos Tech Park 2">
        </p>
      
    </div>
  
<p>There were many interesting people from business and tech world there. In a picture above you can see well known Lithuanian entrepreneur Valdas Lašas testing out Dialrhea and enjoying it. Unfortunately, he didn’t end up investing in this revolutionary shitty machine, probably because being old-school he didn’t understand how to use this high tech gadget properly and instinctively tried putting the phone to his ear, which obviously gained no results.</p>
<h3 id="braille-satellite-music-festival-2018">Braille Satellite music festival 2018</h3>
<p>On the other side of the spectrum was Dialrhea’s appearance in the Braille Satellite music festival. Taking place in an amazing Mushroom Manor in a middle of Lithuanian countryside it’s a small and cozy festival for the weirder side of electronic music.</p>

    <div>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/dialrhea-at-braille-satellite-2019-1.webp" alt="Dialrhea at Braille Satellite 1">
        </p>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/dialrhea-at-braille-satellite-2019-2.webp" alt="Dialrhea at Braille Satellite 2">
        </p>
      
    </div>
  
<p>Instead of entrepreneurs this time Dialrhea was battle tested with a bunch of ravers, hipsters, musicians and people who haven’t slept for three days.</p>
<h2 id="technical-details">Technical details</h2>
<p>The device is built on Arduino, and uses Bluetooth LE to communicate to the computer wirelessly. It presents itself as bluetooth keyboard and can be paired with any device supporting Bluetooth LE. Below you can see the breakdown of components powering Dialrhea.</p>
<p>
      <img src="https://tamulaitis.lt/images/dialrhea/dialrhea-insides.webp" alt="Insides of Dialrhea">
    </p>
<p>Although the ultimate use case for the device ended up being playing Doom, device actually has full support for multiple modes of operation:</p>
<ul>
<li><strong>Doom</strong> - in this mode the device acts as a game controller, and is configured to control classic Doom game (using Doomsday Engine)</li>
<li><strong>Emoji</strong> - this mode is best used with mobile phones and allows you to type emoji’s and send them to your friends</li>
<li><strong>Boring</strong> - in this mode Dialrhea just outputs the dialed numbers (not recommended)</li>
</ul>
<h3 id="reading-data-from-rotary-dial">Reading data from rotary dial</h3>
<p>The most interesting learning during the process was how the rotary dial actually works from technical point of view. I am from the generation who still remember using rotary phones so it was really interesting to understand both how simple the mechanism actually is and why I was getting electric shock while touching phone wires and playing phone mechanic only sometimes and not all the time. If you are interested 
    <a href="https://www.youtube.com/watch?v=cLGd6OB8D5k" target="_blank" rel="noopener">here is the video explaining the mechanism</a>
  .</p>

    <div>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/dialrhea-rotary-dial.webp" alt="Working on rotary dial">
        </p>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/dialrhea-fighting-bluetooth.webp" alt="Fighting bluetooth">
        </p>
      
    </div>
  
<p>After understanding how the mechanism works implementing it with Arduino was pretty much straight forward and I don’t remember having any major troubles with it.</p>
<h3 id="fighting-bluetooth">Fighting bluetooth</h3>
<p>Probably the biggest challenge was to make bluetooth communication work properly. We chose to use 
    <a href="https://learn.adafruit.com/introducing-the-adafruit-bluefruit-le-uart-friend" target="_blank" rel="noopener">Adafruit Bluefruit LE UART Friend</a>
   module for the job just because I had it lying around and also I already tried to work with it while working on another project. It is a very capable module, but most problems we had were around stability and reliability. Sometimes things worked well, sometimes we were getting some errors running exactly the same code. We read lots of documentation about how to follow proper handshake protocols, do pairing correctly, etc., but then ended up just adding retry loops and timeouts everywhere so the chip has time to “come to it’s senses” after each risky operation. You can see full source code for Dialrhea below.</p>
<div>
              <div id="codeblock-3623754">
                <p><span>Click to enable scrolling</span>
                  <span>Tap to enable scrolling</span>
                </p>
              </div>
              <pre><code><span>/***************************************************************************
These are the brains of Dialrhea - revolutionary shitty machine, written in
few hours during Internet Of Shit Hackathon 2017 at Technariumas, Vilnius,
Lithuania, so expect the code to be pretty shitty.

Author: Giedrius Tamulaitis, giedrius@tamulaitis.lt
Version: 1.0

This code is for Adafruit nRF51822 based Bluefruit LE modules
https://learn.adafruit.com/introducing-the-adafruit-bluefruit-le-uart-friend
***************************************************************************/</span>

<span>#<span>include</span> <span>&lt;Arduino.h&gt;</span></span>
<span>#<span>include</span> <span>&lt;SPI.h&gt;</span></span>
<span>#<span>if</span> not defined (_VARIANT_ARDUINO_DUE_X_) &amp;&amp; not defined(ARDUINO_ARCH_SAMD)</span>
  <span>#<span>include</span> <span>&lt;SoftwareSerial.h&gt;</span></span>
<span>#<span>endif</span></span>
<span>#<span>include</span> <span>"Adafruit_BLE.h"</span></span>
<span>#<span>include</span> <span>"Adafruit_BluefruitLE_UART.h"</span></span>
<span>#<span>include</span> <span>"BluefruitConfig.h"</span></span>

<span>#<span>define</span> DEVICE_NAME <span>"Dialrhea"</span></span>

<span>// Rotary dial input PIN</span>
<span>#<span>define</span> ROTARY_PIN 2</span>
<span>// Handset input PIN</span>
<span>#<span>define</span> HANDSET_PIN 3</span>
<span>// Operation mode potentiometer PIN</span>
<span>#<span>define</span> OPERATION_MODE_PIN A5</span>

<span>// How long to wait before sending keyup message for control keys in Gaming mode</span>
<span>#<span>define</span> CONTROL_KEY_HOLD_DURATION 200</span>
<span>// How long to wait before sending keyup message for fire button in Gaming mode</span>
<span>#<span>define</span> FIRE_KEY_HOLD_DURATION 200</span>
<span>// How long to wait before sending keyup message for keys that are supposed</span>
<span>// to be just one clicks</span>
<span>#<span>define</span> INSTANT_KEY_HOLD_DURATION 10</span>

<span>// Pins for status LED RGB legs</span>
<span>#<span>define</span> STATUS_LED_RED_PIN 4</span>
<span>#<span>define</span> STATUS_LED_GREEN_PIN 6</span>
<span>#<span>define</span> STATUS_LED_BLUE_PIN 5</span>

<span>// Constants for colors</span>
<span>#<span>define</span> COLOR_OFF 0</span>
<span>#<span>define</span> COLOR_RED 1</span>
<span>#<span>define</span> COLOR_GREEN 2</span>
<span>#<span>define</span> COLOR_BLUE 3</span>

<span>// Total number of keys that support timed presses</span>
<span>#<span>define</span> KEY_COUNT 14</span>

<span>// Index of handset button data in data arrays (Gaming mode, we need two because</span>
<span>//we are sending keys for both fire and open door)</span>
<span>#<span>define</span> KEY_GAMING_MODE_HANDSET_1_INDEX 10</span>
<span>#<span>define</span> KEY_GAMING_MODE_HANDSET_2_INDEX 11</span>
<span>// Index of handset button data in data arrays (Emoji mode)</span>
<span>#<span>define</span> KEY_EMOJI_MODE_HANDSET_INDEX 12</span>
<span>// Index of handset button data in data arrays (Boring mode)</span>
<span>#<span>define</span> KEY_BORING_MODE_HANDSET_INDEX 13</span>

<span>// Map of values for each type of dialed number and handset click</span>
<span>const</span> <span>int</span> keyValues[KEY_COUNT] = {
  <span>0x42</span>, <span>// Number 0 in gaming mode (Currently quick load)</span>
  <span>0x52</span>, <span>// Number 1 in gaming mode (Currently "up" arrow)</span>
  <span>0x4F</span>, <span>// Number 2 in gaming mode (Currently "right" arrow)</span>
  <span>0x50</span>, <span>// Number 3 in gaming mode (Currently "left" arrow)</span>
  <span>0x51</span>, <span>// Number 4 in gaming mode (Currently "down" arrow)</span>
  <span>0x2A</span>, <span>// Number 5 in gaming mode (Currently ?, next weapon)</span>
  <span>0x00</span>, <span>// Number 6 in gaming mode</span>
  <span>0x00</span>, <span>// Number 7 in gaming mode</span>
  <span>0x00</span>, <span>// Number 8 in gaming mode</span>
  <span>0x00</span>, <span>// Number 9 in gaming mode</span>
  <span>0x10</span>, <span>// Handset click in gaming mode (KEY_GAMING_MODE_HANDSET_1_INDEX) (Currently space)</span>
  <span>0x2C</span>, <span>// Handset click in gaming mode (KEY_GAMING_MODE_HANDSET_2_INDEX) (Currently 'm')</span>
  <span>0x28</span>, <span>// Handset click in emoji mode (KEY_EMOJI_MODE_HANDSET_INDEX) (Currently Enter)</span>
  <span>0x29</span>  <span>// Handset click in boring mode (KEY_BORING_MODE_HANDSET_INDEX) (Currently Esc)</span>
};

<span>// Durations for each type of mey (mapping the same as for keyValues array)</span>
<span>const</span> <span>int</span> keyHoldDurations[KEY_COUNT] = {
  INSTANT_KEY_HOLD_DURATION, 
  CONTROL_KEY_HOLD_DURATION, 
  CONTROL_KEY_HOLD_DURATION,
  CONTROL_KEY_HOLD_DURATION,
  CONTROL_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION,
  FIRE_KEY_HOLD_DURATION,
  FIRE_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION,
  INSTANT_KEY_HOLD_DURATION
};

<span>// Array for storing times each key was pressed</span>
<span>unsigned</span> <span>long</span> keyPressTimes[KEY_COUNT];
<span>// Array for storing states for each key</span>
<span>bool</span> keyPressStates[KEY_COUNT];

<span>// Variables required for handling input from rotary dial</span>
<span>int</span> rotaryHasFinishedRotatingTimeout = <span>100</span>;
<span>int</span> rotaryDebounceTimeout = <span>10</span>;
<span>int</span> rotaryLastValue = <span>LOW</span>;
<span>int</span> rotaryTrueValue = <span>LOW</span>;
<span>unsigned</span> <span>long</span> rotaryLastValueChangeTime = <span>0</span>;
<span>bool</span> rotaryNeedToEmitEvent = <span>0</span>;
<span>int</span> rotaryPulseCount;

<span>// Operation modes</span>
<span>#<span>define</span> OPERATION_MODE_GAMING 0 <span>// Gaming controls fine tuned for the best game of all times: "Doom"</span></span>
<span>#<span>define</span> OPERATION_MODE_EMOJI 1 <span>// Emojis + Enter</span></span>
<span>#<span>define</span> OPERATION_MODE_BORING 2 <span>// Numbers + Esc</span></span>

<span>// Current operation mode</span>
<span>int</span> operationMode;

<span>// Emojis for each dialed number</span>
<span>const</span> <span>char</span>* emojis[] = {<span>":-O"</span>, <span>":poop:"</span>,  <span>":-)"</span>, <span>":-("</span>, <span>":-D"</span>, <span>":-\\"</span>, <span>";-)"</span>, <span>":-*"</span>, <span>":-P"</span>, <span>"&gt;:-("</span>};

<span>// Variables for handling handset clicker button</span>
<span>bool</span> isHandsetPressed = <span>false</span>;
<span>unsigned</span> <span>long</span> handsetPressStartTime = <span>0</span>;
<span>unsigned</span> <span>long</span> handsetPressStartTimeout = <span>60</span>;

<span>// Variable that determines weather the state of keys changed during processing of the loop (so we</span>
<span>// can send commands just once in the end of the loop if it is needed)</span>
<span>bool</span> keyPressStateChanged;

<span>// Config settings for Bluetooth LE module</span>
<span>#<span>define</span> FACTORYRESET_ENABLE         0</span>
<span>#<span>define</span> VERBOSE_MODE                false  <span>// If set to 'true' enables debug output</span></span>
<span>#<span>define</span> MINIMUM_FIRMWARE_VERSION    <span>"0.6.6"</span></span>
<span>#<span>define</span> BLUEFRUIT_HWSERIAL_NAME      Serial1</span>

<span>// Bluetooth LE module object</span>
<span>Adafruit_BluefruitLE_UART <span>ble</span><span>(BLUEFRUIT_HWSERIAL_NAME, BLUEFRUIT_UART_MODE_PIN)</span></span>;

<span><span>void</span> <span>setup</span><span>(<span>void</span>)</span> </span>{
  <span>pinMode</span>(ROTARY_PIN, <span>INPUT</span>);
  <span>pinMode</span>(HANDSET_PIN, <span>INPUT_PULLUP</span>);
  <span>pinMode</span>(STATUS_LED_RED_PIN, <span>OUTPUT</span>);
  <span>pinMode</span>(STATUS_LED_GREEN_PIN, <span>OUTPUT</span>);
  <span>pinMode</span>(STATUS_LED_BLUE_PIN, <span>OUTPUT</span>);

  <span>setStatusLEDColor</span>(COLOR_GREEN);

  <span>// Wait while serial connection is established (required for Flora &amp; Micro or when you want to</span>
  <span>// halt initialization till you open serial monitor)</span>
  <span>// while (!Serial);</span>
  
  <span>// Give some time for chip to warm up or whatever</span>
  <span>delay</span>(<span>1000</span>);

  <span>initializeSerialConnection</span>();
  <span>initializeBLEModule</span>();

  <span>// Delay a bit because good devices always take some time to start</span>
  <span>delay</span>(<span>100</span>);

  <span>setStatusLEDColor</span>(COLOR_BLUE);
}

<span><span>void</span> <span>loop</span><span>(<span>void</span>)</span> </span>{
  keyPressStateChanged = <span>false</span>;
  <span>refreshOperationMode</span>();
  <span>handleHandset</span>();
  <span>handleRotary</span>();
  <span>processKeyUps</span>();

  <span>// If state of pressed keys changed - send the new state</span>
  <span>if</span> (keyPressStateChanged)
    <span>sendCurrentlyPressedKeys</span>();
}

<span>// Sets the color of status LED</span>
<span><span>void</span> <span>setStatusLEDColor</span><span>(<span>int</span> colorID)</span> </span>{
  <span>digitalWrite</span>(STATUS_LED_RED_PIN, colorID == COLOR_RED ? <span>HIGH</span> : <span>LOW</span>);
  <span>digitalWrite</span>(STATUS_LED_GREEN_PIN, colorID == COLOR_GREEN ? <span>HIGH</span> : <span>LOW</span>);
  <span>digitalWrite</span>(STATUS_LED_BLUE_PIN, colorID == COLOR_BLUE ? <span>HIGH</span> : <span>LOW</span>);
}

<span>// Outputs error message and bricks the revolutionary shitty machine</span>
<span><span>void</span> <span>error</span><span>(<span>const</span> __FlashStringHelper*err)</span> </span>{

  <span>setStatusLEDColor</span>(COLOR_RED);
  
  <span>Serial</span>.<span>println</span>(err);
  <span>while</span> (<span>1</span>);
}

<span>// Blinks the status LED (only green supported for now)</span>
<span><span>void</span> <span>blink</span><span>()</span> </span>{
  <span>setStatusLEDColor</span>(COLOR_OFF);
  <span>delay</span>(<span>100</span>);
  <span>setStatusLEDColor</span>(COLOR_GREEN);
}

<span>// Opens serial connection for debugging</span>
<span><span>void</span> <span>initializeSerialConnection</span><span>()</span> </span>{
  <span>Serial</span>.<span>begin</span>(<span>9600</span>);
  <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"Hello, I am the Dialrhea! Ready for some dialing action?"</span>));
  <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"8-------------------------------------D"</span>));
}

<span>// Initializes Bluetooth LE module</span>
<span><span>void</span> <span>initializeBLEModule</span><span>()</span> </span>{
  <span>// Buffer for holding commands that have to be sent to BLE module</span>
  <span>char</span> commandString[<span>64</span>];

  <span>setStatusLEDColor</span>(COLOR_GREEN);

  <span>Serial</span>.<span>print</span>(<span>F</span>(<span>"Initialising the Bluefruit LE module: "</span>));
  <span>if</span> (!ble.<span>begin</span>(VERBOSE_MODE)) <span>error</span>(<span>F</span>(<span>"Couldn't find Bluefruit, make sure it's in CoMmanD mode &amp; check wiring?"</span>));
  <span>Serial</span>.<span>println</span>( <span>F</span>(<span>"Easy!"</span>) );

  <span>blink</span>();

  <span>if</span> (FACTORYRESET_ENABLE)
  {
    <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"Performing a factory reset: "</span>));
    <span>if</span> (!ble.<span>factoryReset</span>()) <span>error</span>(<span>F</span>(<span>"Couldn't factory reset. Have no idea why..."</span>));
    <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"Done, feeling like a virgin again!"</span>));
  }

  <span>blink</span>();

  <span>// Disable command echo from Bluefruit</span>
  ble.<span>echo</span>(<span>false</span>);

  <span>blink</span>();

  <span>Serial</span>.<span>println</span>(<span>"Requesting Bluefruit info:"</span>);
  ble.<span>info</span>();

  <span>blink</span>();

  <span>// Change the device name so the whole world knows it as Dialrhea</span>
  <span>Serial</span>.<span>print</span>(<span>F</span>(<span>"Setting device name to '"</span>));
  <span>Serial</span>.<span>print</span>(DEVICE_NAME);
  <span>Serial</span>.<span>print</span>(<span>F</span>(<span>"': "</span>));
  <span>sprintf</span>(commandString, <span>"AT+GAPDEVNAME=%s"</span>, DEVICE_NAME);
  <span>if</span> (!ble.<span>sendCommandCheckOK</span>(commandString)) <span>error</span>(<span>F</span>(<span>"Could not set device name for some reason. Sad."</span>));
  <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"It's beautiful!"</span>));

  <span>blink</span>();

  <span>Serial</span>.<span>print</span>(<span>F</span>(<span>"Enable HID Service (including Keyboard): "</span>));
  <span>strcpy</span>(commandString, ble.<span>isVersionAtLeast</span>(MINIMUM_FIRMWARE_VERSION) ? <span>"AT+BleHIDEn=On"</span> : <span>"AT+BleKeyboardEn=On"</span>);
  <span>if</span> (!ble.<span>sendCommandCheckOK</span>(commandString)) <span>error</span>(<span>F</span>(<span>"Could not enable Keyboard, we're in deep shit..."</span>));
  <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"I'm now officially a keyboard!"</span>));

  <span>blink</span>();

  <span>// Make software reset (add or remove service requires a reset)</span>
  <span>Serial</span>.<span>print</span>(<span>F</span>(<span>"Performing a SW reset (service changes require a reset): "</span>));
  <span>if</span> (!ble.<span>reset</span>()) <span>error</span>(<span>F</span>(<span>"Couldn't reset?? Lame."</span>));
  <span>Serial</span>.<span>println</span>(<span>F</span>(<span>"Baby I'm ready to go!"</span>));
  <span>Serial</span>.<span>println</span>();
}

<span>// Reads the position of operation mode select potentiometer and determines current operation mode</span>
<span><span>void</span> <span>refreshOperationMode</span><span>()</span> </span>{
  operationMode = <span>floor</span>((<span>float</span>)<span>analogRead</span>(OPERATION_MODE_PIN) / <span>342.0</span>);
}

<span>// Handles tracking the handset state</span>
<span><span>void</span> <span>handleHandset</span><span>()</span> </span>{
  <span>// Ignore input until last action timeout passes (to filter out noise)</span>
  <span>if</span> (<span>millis</span>() - handsetPressStartTime &gt; handsetPressStartTimeout) {
    <span>int</span> ragelisCurrentValue = <span>digitalRead</span>(HANDSET_PIN);
    
    <span>if</span> (!isHandsetPressed &amp;&amp; ragelisCurrentValue == <span>HIGH</span>) {
      isHandsetPressed = <span>true</span>;
      handsetPressStartTime = <span>millis</span>();
      <span>onHandsetClicked</span>();
    }

    <span>else</span> <span>if</span> (isHandsetPressed &amp;&amp; ragelisCurrentValue == <span>LOW</span>) {
      isHandsetPressed = <span>false</span>;
      handsetPressStartTime = <span>millis</span>(); 
    }
  }
}

<span>// Handles tracking of the rotary dial state</span>
<span><span>void</span> <span>handleRotary</span><span>()</span> </span>{
  <span>int</span> rotaryCurrentValue = <span>digitalRead</span>(ROTARY_PIN);

  <span>// If rotary isn't being dialed or it just finished being dialed</span>
  <span>if</span> ((<span>millis</span>() - rotaryLastValueChangeTime) &gt; rotaryHasFinishedRotatingTimeout) {
    <span>// If rotary just finished being dialed - we need to emit the event</span>
    <span>if</span> (rotaryNeedToEmitEvent) {
      <span>// Emit the event (we mod the count by 10 because '0' will send 10 pulses)</span>
      <span>onRotaryNumberDialed</span>(rotaryPulseCount % <span>10</span>);
      rotaryNeedToEmitEvent = <span>false</span>;
      rotaryPulseCount = <span>0</span>;
    }
  }

  <span>// If rotary value has changed - register the time when it happened</span>
  <span>if</span> (rotaryCurrentValue != rotaryLastValue) {
    rotaryLastValueChangeTime = <span>millis</span>();
  }

  <span>// Start analyzing data only when signal stabilizes (debounce timeout passes)</span>
  <span>if</span> ((<span>millis</span>() - rotaryLastValueChangeTime) &gt; rotaryDebounceTimeout) {
    <span>// This means that the switch has either just gone from closed to open or vice versa.</span>
    <span>if</span> (rotaryCurrentValue != rotaryTrueValue) {
      <span>// Register actual value change </span>
      rotaryTrueValue = rotaryCurrentValue;

      <span>// If it went to HIGH - increase pulse count</span>
      <span>if</span> (rotaryTrueValue == <span>HIGH</span>) {
        rotaryPulseCount++; 
        rotaryNeedToEmitEvent = <span>true</span>;
      } 
    }
  }

  <span>// Store current value as last value</span>
  rotaryLastValue = rotaryCurrentValue;
}

<span>// Event handler triggered when click of the handset button is registered</span>
<span><span>void</span> <span>onHandsetClicked</span><span>()</span> </span>{
  <span>// Register state changes for handset button keys depending on the mode</span>
  <span>if</span> (operationMode == OPERATION_MODE_GAMING) {
    <span>if</span> (keyPressStates[KEY_GAMING_MODE_HANDSET_1_INDEX] == <span>false</span> || keyPressStates[KEY_GAMING_MODE_HANDSET_2_INDEX] == <span>false</span>)
      keyPressStateChanged = <span>true</span>;
  
    keyPressStates[KEY_GAMING_MODE_HANDSET_1_INDEX] = <span>true</span>;
    keyPressTimes[KEY_GAMING_MODE_HANDSET_1_INDEX] = <span>millis</span>();
  
    keyPressStates[KEY_GAMING_MODE_HANDSET_2_INDEX] = <span>true</span>;
    keyPressTimes[KEY_GAMING_MODE_HANDSET_2_INDEX] = <span>millis</span>();
  } <span>else</span> <span>if</span> (operationMode == OPERATION_MODE_EMOJI) {
    <span>if</span> (keyPressStates[KEY_EMOJI_MODE_HANDSET_INDEX] == <span>false</span>)
      keyPressStateChanged = <span>true</span>;
  
    keyPressStates[KEY_EMOJI_MODE_HANDSET_INDEX] = <span>true</span>;
    keyPressTimes[KEY_EMOJI_MODE_HANDSET_INDEX] = <span>millis</span>();
  } <span>else</span> <span>if</span> (operationMode == OPERATION_MODE_BORING) {
    <span>if</span> (keyPressStates[KEY_BORING_MODE_HANDSET_INDEX] == <span>false</span>)
      keyPressStateChanged = <span>true</span>;
  
    keyPressStates[KEY_BORING_MODE_HANDSET_INDEX] = <span>true</span>;
    keyPressTimes[KEY_BORING_MODE_HANDSET_INDEX] = <span>millis</span>();
  }
}

<span>// Event handler triggered when number was dialed on rotary dial</span>
<span><span>void</span> <span>onRotaryNumberDialed</span><span>(<span>int</span> number)</span> </span>{
  <span>if</span> (operationMode == OPERATION_MODE_GAMING) {
    <span>// Set key state for dialed key</span>
    <span>if</span> (keyPressStates[number] == <span>false</span>)
      keyPressStateChanged = <span>true</span>;
  
    keyPressStates[number] = <span>true</span>;
    keyPressTimes[number] = <span>millis</span>();
  } <span>else</span> <span>if</span> (operationMode == OPERATION_MODE_EMOJI) {
    <span>// Send emoji to happy device</span>
    <span>sendCharArray</span>(emojis[number]);
  } <span>else</span> <span>if</span> (operationMode == OPERATION_MODE_BORING) {
    <span>// Form string from number and send it to device</span>
    <span>char</span> numberString[<span>1</span>];
    <span>sprintf</span>(numberString, <span>"%d"</span>, number);
    <span>sendCharArray</span>(numberString);
  }
}

<span>// Sends raw command to BLE module and prints debug output</span>
<span><span>void</span> <span>sendBluetoothCommand</span><span>(<span>char</span> *commandString)</span> </span>{
  <span>setStatusLEDColor</span>(COLOR_OFF);

  <span>Serial</span>.<span>print</span>(commandString);

  ble.<span>println</span>(commandString);
  <span>if</span> (ble.<span>waitForOK</span>()) {
    <span>Serial</span>.<span>println</span>(<span>F</span>(<span>" &lt;- OK!"</span>)); 
    <span>setStatusLEDColor</span>(COLOR_BLUE);
  }
  <span>else</span> {
    <span>Serial</span>.<span>println</span>(<span>F</span>(<span>" &lt;- FAILED!"</span>));
    <span>setStatusLEDColor</span>(COLOR_RED);
  };
}

<span>// Sends char array (string) to BLE module</span>
<span><span>void</span> <span>sendCharArray</span><span>(<span>char</span>* charArray)</span> </span>{
  <span>char</span> commandString[<span>64</span>];
  <span>sprintf</span>(commandString, <span>"AT+BleKeyboard=%s"</span>, charArray);
  <span>sendBluetoothCommand</span>(commandString);
}

<span>// Checks which keys are currently pressed and sends keycodes to BLE module</span>
<span><span>void</span> <span>sendCurrentlyPressedKeys</span><span>()</span> </span>{
  <span>char</span> commandString[<span>64</span>] = <span>"AT+BleKeyboardCode=00-00"</span>;

  <span>for</span> (<span>int</span> i=<span>0</span>; i&lt;KEY_COUNT; i++) {
    <span>if</span> (keyPressStates[i] == <span>true</span> &amp;&amp; keyValues[i] != <span>0x00</span>) {
      <span>sprintf</span> (commandString, <span>"%s-%02X"</span>, commandString, keyValues[i]);
    }
  }

  <span>sendBluetoothCommand</span>(commandString);
}

<span>// Process timers to detect when keyup messages have to be sent for each key</span>
<span><span>void</span> <span>processKeyUps</span><span>()</span> </span>{
  <span>for</span> (<span>int</span> i=<span>0</span>; i&lt;KEY_COUNT; i++) {
    <span>if</span> (keyPressStates[i] == <span>true</span>) {
      <span>if</span> (<span>millis</span>() - keyPressTimes[i] &gt; keyHoldDurations[i]) {
        keyPressStates[i] = <span>false</span>;
        keyPressStateChanged = <span>true</span>;
      }
    }
  }
}
</code></pre>
              
            </div>
          
        
<p>There is actually a very interesting bug in this device that allows player to “leap” forward very quickly. I have seen it happening several times, usually after somebody was frantically bashing the device for a while. I literally have no idea why it happens or how to reproduce it, but I actually find it really cool, so I decided to just leave it in and call it a feature.</p>
<h2 id="doom">Doom</h2>
<p>It is no coincidence that classic Doom was chosen as a subject to be controlled by Dialrhea. I absolutely love the game and was obsessed by it while growing up. My father brought it back from his work one day in like 10 floppy disks. I had to learn how to write custom <code>autoexec.bat</code> and <code>config.sys</code> files and boot the system up from special floppy disk containing minimal version of MS-DOS and highly optimized mouse driver so there is just enough memory to run Doom on my Intel 386 33Mhz machine that only had 4Mb of RAM if I remember correctly. <code>"LH A:\MOUSE.COM"</code> was the magic line that told DOS to load mouse driver into otherwise unreachable high memory therefore winning some additional kilobytes of RAM for Doom.</p>

    <div>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/doom-title-screen.webp" alt="Doom 1993 title screen">
        </p>
      
        <p><img src="https://tamulaitis.lt/images/dialrhea/doom-floppy-disks.webp" alt="Doom in floppy discs">
        </p>
      
    </div>
  
<p>Apparently I was not the only one obsessed by Doom, many years later that I found out that Doom and it’s creators “id Software” actually redefined the PC gaming market and were first to introduce shareware distribution model successfully. At one point more personal computers had Doom than Windows 95 operating system installed. There is a great book 
    <a href="https://www.amazon.com/Masters-Doom-Created-Transformed-Culture/dp/0812972155" target="_blank" rel="noopener">“Masters of Doom” by David Kushner</a>
   that tells the story of “id Software” with lots of incredible details, highly recommended read. 
    <a href="https://www.youtube.com/watch?v=iGdkm780730" target="_blank" rel="noopener">This YouTube video</a>
   also paints quite a nice picture about the innovation and drama inside “id Software”. I still think that Doom is the best game that was ever released.</p>
<h2 id="doom-running-on-everything">Doom running on everything</h2>
<p>One more reason to choose Doom to be controlled with rotary phone was that Doom is notorious for being able to run on pretty much any hardware. Well, actually crazy Doom fans are notorious for making Doom run on pretty much any hardware. Doom was made to run on calculators, microwaves, treadmills, traffic ticket validators, vapes and even pregnancy tests! If the device has a CPU and the screen, there will be some geek trying to run Doom on that machine. Subreddit 
    <a href="https://www.reddit.com/r/itrunsdoom/" target="_blank" rel="noopener">r/itrunsdoom</a>
   has the most impressive collection of devices running Doom that I’ve seen so far.</p>
<p>
      <img src="https://tamulaitis.lt/images/dialrhea/doom-running-on-everything.webp#full-width" alt="Doom running on everything">
    </p>
<p>One of the more interesting projects was one guy 
    <a href="https://www.youtube.com/watch?v=KFDlVgBMomQ" target="_blank" rel="noopener">running Doom on scientific calculator powered by ~800 potatoes</a>
  ! Yes, potatoes! Compared to this our Dialrhea project doesn’t seem so crazy.</p>
<h2 id="competition">Competition</h2>
<p>Apparently we were not the only ones willing to waste our time building ridiculous machine like this. Good five years after our attempt somewhere in Japan the guy named Yoshino built similar device. I have to admit his marketing campaign was way more successful than ours and the video went viral, being covered by major gaming outlets like PC Gamer, IGN and others and even provoking a tweet from John Romero (one of the people who created original Doom) himself.</p>
<p>
      <img src="https://tamulaitis.lt/images/dialrhea/john-romero-tweet.webp#padding-on-mobile" alt="John Romero's tween about rotary phone">
    </p>
<p>Compared to Dialrhea, Yoshino’s device doesn’t utilize handset at all forcing you to dial <code>1</code> to shoot (which is way less fun than frantically mashing the handset). Also you need to connect it to the computer via cable while Dialrhea is fully wireless and supports Bluetooth LE. Just another example how technologically superior solution doesn’t always win the market, marketing does.</p>
<!-- This is v1.3 of this article. --> </div>  </article> </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[SQL Tips and Tricks (183 pts)]]></title>
            <link>https://github.com/ben-n93/SQL-tips-and-tricks</link>
            <guid>41643651</guid>
            <pubDate>Wed, 25 Sep 2024 04:20:48 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/ben-n93/SQL-tips-and-tricks">https://github.com/ben-n93/SQL-tips-and-tricks</a>, See on <a href="https://news.ycombinator.com/item?id=41643651">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">SQL tips and tricks</h2><a id="user-content-sql-tips-and-tricks" aria-label="Permalink: SQL tips and tricks" href="#sql-tips-and-tricks"></a></p>
<p dir="auto">A (somewhat opinionated) list of SQL tips and tricks I've picked up over the years.</p>
<p dir="auto">Please note that some of these tips might not be relevant for all RDBMs. For example, the <code>::</code> syntax (<a href="#you-can-use-the--operator-to-cast-the-data-type-of-a-value">tip 5</a>) does not work in SQLite.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Table of contents</h2><a id="user-content-table-of-contents" aria-label="Permalink: Table of contents" href="#table-of-contents"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Formatting/readability</h3><a id="user-content-formattingreadability" aria-label="Permalink: Formatting/readability" href="#formattingreadability"></a></p>
<ol dir="auto">
<li><a href="#use-a-leading-comma-to-separate-fields">Use a leading comma to seperate fields</a></li>
<li><a href="#use-a-dummy-value-in-the-where-clause">Use a dummy value in the WHERE clause</a></li>
<li><a href="#ident-your-code-where-appropriate">Ident your code where appropriate</a></li>
</ol>
<p dir="auto"><h3 tabindex="-1" dir="auto">Useful features</h3><a id="user-content-useful-features" aria-label="Permalink: Useful features" href="#useful-features"></a></p>
<ol start="5" dir="auto">
<li><a href="#you-can-use-the--operator-to-cast-the-data-type-of-a-value">You can use the <code>::</code> operator to cast the data type of a value</a></li>
<li><a href="#anti-joins-are-your-friend">Anti-joins are your friend</a></li>
<li><a href="#use-qualify-to-filter-window-functions">Use <code>QUALIFY</code> to filter window functions</a></li>
<li><a href="#you-can-but-shouldnt-always-group-by-column-position">You can (but shouldn't always) <code>GROUP BY</code> column position</a></li>
</ol>
<p dir="auto"><h3 tabindex="-1" dir="auto">Avoid pitfalls</h3><a id="user-content-avoid-pitfalls" aria-label="Permalink: Avoid pitfalls" href="#avoid-pitfalls"></a></p>
<ol start="9" dir="auto">
<li><a href="#be-aware-of-how-not-in-behaves-with-null-values">Be aware of how <code>NOT IN</code> behaves with NULL values</a></li>
<li><a href="#rename-calculated-fields-to-avoiding-ambiguity">Rename calculated fields to avoid ambiguity</a></li>
<li><a href="#always-specify-which-column-belongs-to-which-table">Always specify which column belongs to which table</a></li>
<li><a href="#understand-the-order-of-execution">Understand the order of execution</a></li>
<li><a href="#comment-your-code">Comment your code!</a></li>
<li><a href="#read-the-documentation-in-full">Read the documentation (in full)</a></li>
</ol>
<p dir="auto"><h2 tabindex="-1" dir="auto">Formatting/readability</h2><a id="user-content-formattingreadability-1" aria-label="Permalink: Formatting/readability" href="#formattingreadability-1"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Use a leading comma to separate fields</h3><a id="user-content-use-a-leading-comma-to-separate-fields" aria-label="Permalink: Use a leading comma to separate fields" href="#use-a-leading-comma-to-separate-fields"></a></p>
<p dir="auto">Use a leading comma to seperate fields in the <code>SELECT</code> clause rather than a trailing comma.</p>
<ul dir="auto">
<li>
<p dir="auto">Clearly defines that this is a new column vs code that's wrapped to multiple lines.</p>
</li>
<li>
<p dir="auto">Visual cue to easily identify if the comma is missing or not. Varying line lengths makes it harder to determine.</p>
</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT
employee_id
, employee_name
, job
, salary
FROM employees
;"><pre><span>SELECT</span>
employee_id
, employee_name
, job
, salary
<span>FROM</span> employees
;</pre></div>
<ul dir="auto">
<li>Also use a leading <code>AND</code> in the <code>WHERE</code> clause, for the same reasons (following tip demonstrates this).</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto"><strong>Use a dummy value in the WHERE clause</strong></h3><a id="user-content-use-a-dummy-value-in-the-where-clause" aria-label="Permalink: Use a dummy value in the WHERE clause" href="#use-a-dummy-value-in-the-where-clause"></a></p>
<p dir="auto">Use a dummy value in the <code>WHERE</code> clause so you can dynamically add and remove conditions with ease:</p>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT *
FROM employees
WHERE 1=1 -- Dummy value.
AND job IN ('Clerk', 'Manager')
AND dept_no != 5
;"><pre><span>SELECT</span> <span>*</span>
<span>FROM</span> employees
<span>WHERE</span> <span>1</span><span>=</span><span>1</span> <span><span>--</span> Dummy value.</span>
<span>AND</span> job <span>IN</span> (<span><span>'</span>Clerk<span>'</span></span>, <span><span>'</span>Manager<span>'</span></span>)
<span>AND</span> dept_no <span>!=</span> <span>5</span>
;</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Indent your code where appropriate</h3><a id="user-content-indent-your-code-where-appropriate" aria-label="Permalink: Indent your code where appropriate" href="#indent-your-code-where-appropriate"></a></p>
<p dir="auto">Indent your code to make it more readable to colleagues and your future self:</p>
<div dir="auto" data-snippet-clipboard-copy-content="-- Bad:
SELECT 
timeslot_date
, timeslot_channel 
, overnight_fta_share
, IFF(DATEDIFF(DAY, timeslot_date, CURRENT_DATE()) > 7, LAG(overnight_fta_share, 1) OVER (PARTITION BY timeslot_date, timeslot_channel ORDER BY timeslot_activity), NULL) AS C7_fta_share
, IFF(DATEDIFF(DAY, timeslot_date, CURRENT_DATE()) >= 29, LAG(overnight_fta_share, 2) OVER (PARTITION BY timeslot_date, timeslot_channel ORDER BY timeslot_activity), NULL) AS C28_fta_share
FROM timeslot_data
;

-- Good:
SELECT 
timeslot_date
, timeslot_channel 
, overnight_fta_share
, IFF(DATEDIFF(DAY, timeslot_date, CURRENT_DATE()) > 7, -- First argument of IFF.
	LAG(overnight_fta_share, 1) OVER (PARTITION BY timeslot_date, timeslot_channel ORDER BY timeslot_activity), -- Second argument of IFF.
		NULL) AS C7_fta_share -- Third argument of IFF.
, IFF(DATEDIFF(DAY, timeslot_date, CURRENT_DATE()) >= 29, 
		LAG(overnight_fta_share, 2) OVER (PARTITION BY timeslot_date, timeslot_channel ORDER BY timeslot_activity), 
			NULL) AS C28_fta_share
FROM timeslot_data
;"><pre><span><span>--</span> Bad:</span>
<span>SELECT</span> 
timeslot_date
, timeslot_channel 
, overnight_fta_share
, IFF(DATEDIFF(DAY, timeslot_date, <span>CURRENT_DATE</span>()) <span>&gt;</span> <span>7</span>, LAG(overnight_fta_share, <span>1</span>) OVER (PARTITION BY timeslot_date, timeslot_channel <span>ORDER BY</span> timeslot_activity), <span>NULL</span>) <span>AS</span> C7_fta_share
, IFF(DATEDIFF(DAY, timeslot_date, <span>CURRENT_DATE</span>()) <span>&gt;=</span> <span>29</span>, LAG(overnight_fta_share, <span>2</span>) OVER (PARTITION BY timeslot_date, timeslot_channel <span>ORDER BY</span> timeslot_activity), <span>NULL</span>) <span>AS</span> C28_fta_share
<span>FROM</span> timeslot_data
;

<span><span>--</span> Good:</span>
<span>SELECT</span> 
timeslot_date
, timeslot_channel 
, overnight_fta_share
, IFF(DATEDIFF(DAY, timeslot_date, <span>CURRENT_DATE</span>()) <span>&gt;</span> <span>7</span>, <span><span>--</span> First argument of IFF.</span>
	LAG(overnight_fta_share, <span>1</span>) OVER (PARTITION BY timeslot_date, timeslot_channel <span>ORDER BY</span> timeslot_activity), <span><span>--</span> Second argument of IFF.</span>
		<span>NULL</span>) <span>AS</span> C7_fta_share <span><span>--</span> Third argument of IFF.</span>
, IFF(DATEDIFF(DAY, timeslot_date, <span>CURRENT_DATE</span>()) <span>&gt;=</span> <span>29</span>, 
		LAG(overnight_fta_share, <span>2</span>) OVER (PARTITION BY timeslot_date, timeslot_channel <span>ORDER BY</span> timeslot_activity), 
			<span>NULL</span>) <span>AS</span> C28_fta_share
<span>FROM</span> timeslot_data
;</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Useful features</h2><a id="user-content-useful-features-1" aria-label="Permalink: Useful features" href="#useful-features-1"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">You can use the <code>::</code> operator to cast the data type of a value</h3><a id="user-content-you-can-use-the--operator-to-cast-the-data-type-of-a-value" aria-label="Permalink: You can use the :: operator to cast the data type of a value" href="#you-can-use-the--operator-to-cast-the-data-type-of-a-value"></a></p>
<p dir="auto">In some RDBMs you can use the <code>::</code> operator to cast a value from one data type to another:</p>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT CAST('5' AS INTEGER); -- Using the CAST function.
SELECT '5'::INTEGER; -- Using :: syntax."><pre><span>SELECT</span> CAST(<span><span>'</span>5<span>'</span></span> <span>AS</span> <span>INTEGER</span>); <span><span>--</span> Using the CAST function.</span>
<span>SELECT</span> <span><span>'</span>5<span>'</span></span>::<span>INTEGER</span>; <span><span>--</span> Using :: syntax.</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Anti-joins are your friend</h3><a id="user-content-anti-joins-are-your-friend" aria-label="Permalink: Anti-joins are your friend" href="#anti-joins-are-your-friend"></a></p>
<p dir="auto">Anti-joins are incredible useful, mostly (in my experience) for when when you only want to return rows/values from one table that aren't present in another table.</p>
<ul dir="auto">
<li>You could instead use a subquery although conventional wisdom dictates that
anti-joins are faster.</li>
<li><code>EXCEPT</code> is an interesting operator for removing rows from one table which appear in another query table but I suggest you read up on it further before using it.</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="-- Anti-join.
SELECT 
video_content.*
FROM video_content
    LEFT JOIN archive
    on video_content.series_id = archive.series_id
WHERE 1=1
AND archive.series_id IS NULL -- Any rows with no match will have a NULL value.

-- Subquery.
SELECT 
*
FROM video_content
WHERE 1=1
AND series_id NOT IN (SELECT DISTINCT SERIES_ID FROM archive) -- Be mindful of NULL values (see tip 9).

-- Correlated subquery.
SELECT 
*
FROM video_content
WHERE 1=1
AND NOT EXISTS (
        SELECT 1
        FROM archive a
        WHERE a.series_id = vc.series_id
    )

-- EXCEPT.
SELECT series_id
FROM video_content
EXCEPT
SELECT series_id
FROM archive"><pre><span><span>--</span> Anti-join.</span>
<span>SELECT</span> 
video_content.<span>*</span>
<span>FROM</span> video_content
    <span>LEFT JOIN</span> archive
    <span>on</span> <span>video_content</span>.<span>series_id</span> <span>=</span> <span>archive</span>.<span>series_id</span>
<span>WHERE</span> <span>1</span><span>=</span><span>1</span>
<span>AND</span> <span>archive</span>.<span>series_id</span> IS <span>NULL</span> <span><span>--</span> Any rows with no match will have a NULL value.</span>

<span><span>--</span> Subquery.</span>
<span>SELECT</span> 
<span>*</span>
<span>FROM</span> video_content
<span>WHERE</span> <span>1</span><span>=</span><span>1</span>
<span>AND</span> series_id NOT <span>IN</span> (<span>SELECT DISTINCT</span> SERIES_ID <span>FROM</span> archive) <span><span>--</span> Be mindful of NULL values (see tip 9).</span>

<span><span>--</span> Correlated subquery.</span>
<span>SELECT</span> 
<span>*</span>
<span>FROM</span> video_content
<span>WHERE</span> <span>1</span><span>=</span><span>1</span>
<span>AND</span> NOT EXISTS (
        <span>SELECT</span> <span>1</span>
        <span>FROM</span> archive a
        <span>WHERE</span> <span>a</span>.<span>series_id</span> <span>=</span> <span>vc</span>.<span>series_id</span>
    )

<span><span>--</span> EXCEPT.</span>
<span>SELECT</span> series_id
<span>FROM</span> video_content
EXCEPT
<span>SELECT</span> series_id
<span>FROM</span> archive</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Use QUALIFY to filter window functions</h3><a id="user-content-use-qualify-to-filter-window-functions" aria-label="Permalink: Use QUALIFY to filter window functions" href="#use-qualify-to-filter-window-functions"></a></p>
<p dir="auto"><code>QUALIFY</code> lets you filter the results of a query based on a window function. This is useful for a variety of reasons, including to
reduce the number of lines of code needed.</p>
<p dir="auto">For example, if I want to return the top 10 markets per product I can use
<code>QUALIFY</code> rather than an in-line view:</p>
<div dir="auto" data-snippet-clipboard-copy-content="-- Using QUALIFY:
SELECT 
product
, market
, SUM(revenue) as market_revenue 
FROM sales
GROUP BY product, market
QUALIFY DENSE_RANK() OVER (PARTITION BY product ORDER BY SUM(revenue) DESC)  <= 10
ORDER BY product, market_revenue
;

-- Without QUALIFY:
SELECT 
product
, market
, market_revenue 
FROM
(
SELECT 
product
, market
, SUM(revenue) as market_revenue
, DENSE_RANK() OVER (PARTITION BY product ORDER BY SUM(revenue) DESC) AS market_rank
FROM sales
GROUP BY product, market
)
WHERE market_rank  <= 10
ORDER BY product, market_revenue
;"><pre><span><span>--</span> Using QUALIFY:</span>
<span>SELECT</span> 
product
, market
, <span>SUM</span>(revenue) <span>as</span> market_revenue 
<span>FROM</span> sales
<span>GROUP BY</span> product, market
QUALIFY DENSE_RANK() OVER (PARTITION BY product <span>ORDER BY</span> <span>SUM</span>(revenue) <span>DESC</span>)  <span>&lt;=</span> <span>10</span>
<span>ORDER BY</span> product, market_revenue
;

<span><span>--</span> Without QUALIFY:</span>
<span>SELECT</span> 
product
, market
, market_revenue 
<span>FROM</span>
(
<span>SELECT</span> 
product
, market
, <span>SUM</span>(revenue) <span>as</span> market_revenue
, DENSE_RANK() OVER (PARTITION BY product <span>ORDER BY</span> <span>SUM</span>(revenue) <span>DESC</span>) <span>AS</span> market_rank
<span>FROM</span> sales
<span>GROUP BY</span> product, market
)
<span>WHERE</span> market_rank  <span>&lt;=</span> <span>10</span>
<span>ORDER BY</span> product, market_revenue
;</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">You can (but shouldn't always) <code>GROUP BY</code> column position</h3><a id="user-content-you-can-but-shouldnt-always-group-by-column-position" aria-label="Permalink: You can (but shouldn't always) GROUP BY column position" href="#you-can-but-shouldnt-always-group-by-column-position"></a></p>
<p dir="auto">Rather than use the column name you can <code>GROUP BY</code> or <code>ORDER BY</code> using
column position.</p>
<ul dir="auto">
<li>For ad-hoc/one-off queries this can be useful but for production code
you should always refer to a column by its name.</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT 
dept_no
, SUM(salary) as dept_salary
FROM employees
GROUP BY 1 -- dept_no is the first column in the SELECT clause.
ORDER BY 2 DESC
;"><pre><span>SELECT</span> 
dept_no
, <span>SUM</span>(salary) <span>as</span> dept_salary
<span>FROM</span> employees
<span>GROUP BY</span> <span>1</span> <span><span>--</span> dept_no is the first column in the SELECT clause.</span>
<span>ORDER BY</span> <span>2</span> <span>DESC</span>
;</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Common pitfalls</h2><a id="user-content-common-pitfalls" aria-label="Permalink: Common pitfalls" href="#common-pitfalls"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Be aware of how <code>NOT IN</code> behaves with <code>NULL</code> values</h3><a id="user-content-be-aware-of-how-not-in-behaves-with-null-values" aria-label="Permalink: Be aware of how NOT IN behaves with NULL values" href="#be-aware-of-how-not-in-behaves-with-null-values"></a></p>
<p dir="auto"><code>NOT IN</code> doesn't work if <code>NULL</code> is present in the values being checked against. As <code>NULL</code> represents Unknown the SQL engine can't verify that the value being checked is not present in the list.</p>
<ul dir="auto">
<li>Instead use <code>NOT EXISTS</code>.</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="INSERT INTO departments (id)
VALUES (1), (2), (NULL);

-- Doesn't work due to NULL being present.
SELECT * 
FROM employees 
WHERE department_id NOT IN (SELECT DISTINCT id from departments)

-- Solution.
SELECT * 
FROM employees e
WHERE NOT EXISTS (
    SELECT 1 
    FROM departments d 
    WHERE d.id = e.department_id
)
;"><pre><span>INSERT INTO</span> departments (id)
<span>VALUES</span> (<span>1</span>), (<span>2</span>), (<span>NULL</span>);

<span><span>--</span> Doesn't work due to NULL being present.</span>
<span>SELECT</span> <span>*</span> 
<span>FROM</span> employees 
<span>WHERE</span> department_id NOT <span>IN</span> (<span>SELECT DISTINCT</span> id <span>from</span> departments)

<span><span>--</span> Solution.</span>
<span>SELECT</span> <span>*</span> 
<span>FROM</span> employees e
<span>WHERE</span> NOT EXISTS (
    <span>SELECT</span> <span>1</span> 
    <span>FROM</span> departments d 
    <span>WHERE</span> <span>d</span>.<span>id</span> <span>=</span> <span>e</span>.<span>department_id</span>
)
;</pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Rename calculated fields to avoiding ambiguity</h3><a id="user-content-rename-calculated-fields-to-avoiding-ambiguity" aria-label="Permalink: Rename calculated fields to avoiding ambiguity" href="#rename-calculated-fields-to-avoiding-ambiguity"></a></p>
<p dir="auto">When creating a calculated field you might be tempted to rename it to an
existing column but this can lead to unexpected behaviour, such as a
window function operating on the wrong field:</p>
<div dir="auto" data-snippet-clipboard-copy-content="INSERT INTO products (product, revenue)
VALUES 
    ('Shark', 100),
    ('Robot', 150),
    ('Alien', 90);

-- The window function will rank the 'Robot' product as 1 when it should be 3.
SELECT 
product
, CASE product WHEN 'Robot' THEN 0 ELSE revenue END AS revenue
, RANK() OVER (ORDER BY revenue DESC)
FROM products "><pre><span>INSERT INTO</span> products (product, revenue)
<span>VALUES</span> 
    (<span><span>'</span>Shark<span>'</span></span>, <span>100</span>),
    (<span><span>'</span>Robot<span>'</span></span>, <span>150</span>),
    (<span><span>'</span>Alien<span>'</span></span>, <span>90</span>);

<span><span>--</span> The window function will rank the 'Robot' product as 1 when it should be 3.</span>
<span>SELECT</span> 
product
, CASE product WHEN <span><span>'</span>Robot<span>'</span></span> THEN <span>0</span> ELSE revenue END <span>AS</span> revenue
, RANK() OVER (<span>ORDER BY</span> revenue <span>DESC</span>)
<span>FROM</span> products </pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Always specify which column belongs to which table</h3><a id="user-content-always-specify-which-column-belongs-to-which-table" aria-label="Permalink: Always specify which column belongs to which table" href="#always-specify-which-column-belongs-to-which-table"></a></p>
<p dir="auto">When you have complex queries with multiple joins it pays to be able to
trace back an issue with a value to its source.</p>
<p dir="auto">Additionally, your RDBMS might raise an error if two tables share the same
column name and you don't specify which column you are using.</p>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT 
vc.video_id
, vc.series_name
, metadata.season
, metadata.episode_number
FROM video_content as vc 
    INNER JOIN video_metadata as metadata
    ON vc.video_id = metadata.video_id"><pre><span>SELECT</span> 
<span>vc</span>.<span>video_id</span>
, <span>vc</span>.<span>series_name</span>
, <span>metadata</span>.<span>season</span>
, <span>metadata</span>.<span>episode_number</span>
<span>FROM</span> video_content <span>as</span> vc 
    <span>INNER JOIN</span> video_metadata <span>as</span> metadata
    <span>ON</span> <span>vc</span>.<span>video_id</span> <span>=</span> <span>metadata</span>.<span>video_id</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Understand the order of execution</h3><a id="user-content-understand-the-order-of-execution" aria-label="Permalink: Understand the order of execution" href="#understand-the-order-of-execution"></a></p>
<p dir="auto">If I had to give one piece of advice to someone learning SQL it'd be to understand the order of
execution (of clauses). It will completely change how you write queries. This <a href="https://blog.jooq.org/a-beginners-guide-to-the-true-order-of-sql-operations/" rel="nofollow">blog post</a> is a fantastic resource for learning.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Comment your code!</h3><a id="user-content-comment-your-code" aria-label="Permalink: Comment your code!" href="#comment-your-code"></a></p>
<p dir="auto">While in the moment you know why you did something if you revisit
the code weeks, months or years later you might not remember.</p>
<ul dir="auto">
<li>In general you should strive to write comments that explain why you did something, not how.</li>
<li>Your colleagues and future self will thank you!</li>
</ul>
<div dir="auto" data-snippet-clipboard-copy-content="SELECT 
video_content.*
FROM video_content
    LEFT JOIN archive -- New CMS cannot process archive video formats. 
    on video_content.series_id = archive.series_id
WHERE 1=1
AND archive.series_id IS NULL"><pre><span>SELECT</span> 
video_content.<span>*</span>
<span>FROM</span> video_content
    <span>LEFT JOIN</span> archive <span><span>--</span> New CMS cannot process archive video formats. </span>
    <span>on</span> <span>video_content</span>.<span>series_id</span> <span>=</span> <span>archive</span>.<span>series_id</span>
<span>WHERE</span> <span>1</span><span>=</span><span>1</span>
<span>AND</span> <span>archive</span>.<span>series_id</span> IS <span>NULL</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Read the documentation (in full)</h3><a id="user-content-read-the-documentation-in-full" aria-label="Permalink: Read the documentation (in full)" href="#read-the-documentation-in-full"></a></p>
<p dir="auto">Using Snowflake I once needed to return the latest date from a list of columns
and so I decided to use <code>GREATEST()</code>.</p>
<p dir="auto">What I didn't realise was that if one of the
arguments is <code>NULL</code> then the function returns <code>NULL</code>.</p>
<p dir="auto">If I'd read the documentation in full I'd have known! In many cases it can take just a minute or less to scan
the documentation and it will save you the headache of having to work
out why something isn't working the way you expected:</p>
<div dir="auto" data-snippet-clipboard-copy-content="-- If I'd read the documentation further I'd also have realised that my solution
--to the NULL problem with GREATEST()...

SELECT COALESCE(GREATEST(signup_date, consumption_date), signup_date, consumption_date)

-- ... could have been solved with the following function:
SELECT GREATEST_IGNORE_NULLS(signup_date, consumption_date)"><pre><span><span>--</span> If I'd read the documentation further I'd also have realised that my solution</span>
<span><span>--</span>to the NULL problem with GREATEST()...</span>

<span>SELECT</span> COALESCE(GREATEST(signup_date, consumption_date), signup_date, consumption_date)

<span><span>--</span> ... could have been solved with the following function:</span>
<span>SELECT</span> GREATEST_IGNORE_NULLS(signup_date, consumption_date)</pre></div>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[No more blurry fonts in Linux (2023) (127 pts)]]></title>
            <link>https://blog.aktsbot.in/no-more-blurry-fonts.html</link>
            <guid>41643573</guid>
            <pubDate>Wed, 25 Sep 2024 04:05:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.aktsbot.in/no-more-blurry-fonts.html">https://blog.aktsbot.in/no-more-blurry-fonts.html</a>, See on <a href="https://news.ycombinator.com/item?id=41643573">Hacker News</a></p>
<div id="readability-page-1" class="page">
  <!--
Date: 05 May 2023
-->



<p><small>05 May 2023</small>
</p><hr>

<p>Ever since I saw <a href="https://elementary.io/">elementary os</a> sporting the very legible
<a href="https://rsms.me/inter/">Inter</a> font for its UI and site, I wanted to make it part 
of my desktop too. The only problem was any font I'd choose got a little blurry. 
Not any more!</p>

<p>Open up <code>/etc/environment</code> and then add the following line to the end of it.</p>

<pre><code>FREETYPE_PROPERTIES="cff:no-stem-darkening=0 autofitter:no-stem-darkening=0"
</code></pre>

<p>This enables <a href="https://freetype.org/freetype2/docs/hinting/text-rendering-general.html">stem-darkening</a> for
all fonts. This just makes fonts a little bit bolder on smaller screens. This makes 
a heck of a difference for Inter.</p>

<p>Reboot your machine and enjoy beautiful fonts.</p>

<p>Here's a before</p>

<p><a href="https://blog.aktsbot.in/img/stem-darkening-off.png">
  <img src="https://blog.aktsbot.in/img/stem-darkening-off-thumb.png" loading="lazy">
</a></p>

<p>And an after</p>

<p><a href="https://blog.aktsbot.in/img/stem-darkening-on.png">
  <img src="https://blog.aktsbot.in/img/stem-darkening-on-thumb.png" loading="lazy">
</a></p>

<p><em>Happy Hacking &amp; have a great day!</em></p>
  


</div>]]></description>
        </item>
        <item>
            <title><![CDATA[Insights after 11 years with Datomic [video] (176 pts)]]></title>
            <link>https://www.youtube.com/watch?v=YSgTQzHYeLU</link>
            <guid>41642969</guid>
            <pubDate>Wed, 25 Sep 2024 02:05:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.youtube.com/watch?v=YSgTQzHYeLU">https://www.youtube.com/watch?v=YSgTQzHYeLU</a>, See on <a href="https://news.ycombinator.com/item?id=41642969">Hacker News</a></p>
Couldn't get https://www.youtube.com/watch?v=YSgTQzHYeLU: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Hack GPON – how to access, change and edit fibre ONTs (204 pts)]]></title>
            <link>https://hack-gpon.org/</link>
            <guid>41642487</guid>
            <pubDate>Wed, 25 Sep 2024 00:41:05 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://hack-gpon.org/">https://hack-gpon.org/</a>, See on <a href="https://news.ycombinator.com/item?id=41642487">Hacker News</a></p>
Couldn't get https://hack-gpon.org/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Committing to Rust in the Kernel (190 pts)]]></title>
            <link>https://lwn.net/SubscriberLink/991062/b0df468b40b21f5d/</link>
            <guid>41642313</guid>
            <pubDate>Wed, 25 Sep 2024 00:08:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lwn.net/SubscriberLink/991062/b0df468b40b21f5d/">https://lwn.net/SubscriberLink/991062/b0df468b40b21f5d/</a>, See on <a href="https://news.ycombinator.com/item?id=41642313">Hacker News</a></p>
Couldn't get https://lwn.net/SubscriberLink/991062/b0df468b40b21f5d/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Hosting my website using my C web server (263 pts)]]></title>
            <link>https://github.com/cozis/blogtech</link>
            <guid>41642151</guid>
            <pubDate>Tue, 24 Sep 2024 23:39:30 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/cozis/blogtech">https://github.com/cozis/blogtech</a>, See on <a href="https://news.ycombinator.com/item?id=41642151">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">My Blog Technology</h2><a id="user-content-my-blog-technology" aria-label="Permalink: My Blog Technology" href="#my-blog-technology"></a></p>
<p dir="auto">This is a minimal web server designed to host my blog. It's built from scratch to be robust enough to face the public internet. No reverse proxies required! You can see it in action at <a href="http://playin.coz.is/index.html" rel="nofollow">http://playin.coz.is/index.html</a>.</p>
<p dir="auto">I asked <a href="https://www.reddit.com/r/C_Programming/comments/1falo3b/using_my_c_web_server_to_host_a_blog_you_cant/" rel="nofollow">Reddit</a> to <a href="https://www.reddit.com/r/hacking/comments/1fcc5hd/im_using_my_custom_c_webserver_to_host_my_blog_no/" rel="nofollow">hack</a> me, which resulted in gigabytes of hilarious and malicious request logs. I saved some in <code>attempts.txt</code>, and may dig out a few more for fun someday :^)</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">But.. Why?</h2><a id="user-content-but-why" aria-label="Permalink: But.. Why?" href="#but-why"></a></p>
<p dir="auto">I enjoy making my own tools and I'm a bit tired of hearing that everything needs to be "battle-tested." So what it will crash? Bugs can be fixed :^)</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Specs</h2><a id="user-content-specs" aria-label="Permalink: Specs" href="#specs"></a></p>
<ul dir="auto">
<li>Linux only</li>
<li>Implements HTTP/1.1, pipelining, and keep-alive connections</li>
<li>HTTPS support (up to TLS 1.2 using BearSSL)</li>
<li>Minimal dependencies (libc and BearSSL when using HTTPS)</li>
<li>Configurable timeouts</li>
<li>Access logs, crash logs, log rotation, disk usage limits</li>
<li>No <code>Transfer-Encoding: Chunked</code> (responds with <code>411 Length Required</code>, prompting the client to resend with <code>Content-Length</code>)</li>
<li>Single core (This will probably change when I get a better VPS)</li>
<li>No static file caching (yet)</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Benchmarks</h2><a id="user-content-benchmarks" aria-label="Permalink: Benchmarks" href="#benchmarks"></a></p>
<p dir="auto">The focus of the project is robustness, but it's definitely not slow. Here's a quick comparison agains nginx (static endpoint, both single-threaded, 1K connection limit)</p>
<div data-snippet-clipboard-copy-content="(blogtech)
$ wrk -c 500 -d 5s http://127.0.0.1:80/hello
Running 5s test @ http://127.0.0.1:80/hello
  2 threads and 500 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     6.66ms    3.71ms  48.87ms   92.30%
    Req/Sec    39.59k     6.43k   50.60k    67.35%
  385975 requests in 5.01s, 30.55MB read
Requests/sec:  76974.24
Transfer/sec:      6.09MB

(nginx)
$ wrk -c 500 -d 5s http://127.0.0.1:8080/hello
Running 5s test @ http://127.0.0.1:8080/hello
  2 threads and 500 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   149.11ms  243.02ms 934.12ms   81.80%
    Req/Sec    24.97k    16.87k   57.73k    61.11%
  224790 requests in 5.08s, 42.01MB read
Requests/sec:  44227.78
Transfer/sec:      8.27MB"><pre><code>(blogtech)
$ wrk -c 500 -d 5s http://127.0.0.1:80/hello
Running 5s test @ http://127.0.0.1:80/hello
  2 threads and 500 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     6.66ms    3.71ms  48.87ms   92.30%
    Req/Sec    39.59k     6.43k   50.60k    67.35%
  385975 requests in 5.01s, 30.55MB read
Requests/sec:  76974.24
Transfer/sec:      6.09MB

(nginx)
$ wrk -c 500 -d 5s http://127.0.0.1:8080/hello
Running 5s test @ http://127.0.0.1:8080/hello
  2 threads and 500 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency   149.11ms  243.02ms 934.12ms   81.80%
    Req/Sec    24.97k    16.87k   57.73k    61.11%
  224790 requests in 5.08s, 42.01MB read
Requests/sec:  44227.78
Transfer/sec:      8.27MB
</code></pre></div>
<p dir="auto">Nginx uses this configuration:</p>
<div data-snippet-clipboard-copy-content="worker_processes 1;

events {
	worker_connections 1024;
}

http {
	server {
		listen 8080;
		location /hello {
			add_header Content-Type text/plain;
			return 200 &quot;Hello, world!&quot;;
		}
	}
}"><pre><code>worker_processes 1;

events {
	worker_connections 1024;
}

http {
	server {
		listen 8080;
		location /hello {
			add_header Content-Type text/plain;
			return 200 "Hello, world!";
		}
	}
}
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Build &amp; Run</h2><a id="user-content-build--run" aria-label="Permalink: Build &amp; Run" href="#build--run"></a></p>
<p dir="auto">By default the server build is HTTP-only:</p>

<p dir="auto">this generates the executables: <code>serve</code> (release build), <code>serve_cov</code> (coverage build), and <code>serve_debug</code> (debug build). Release builds listen on port 80; debug builds on port 8080.</p>
<p dir="auto">To enable HTTPS, you'll need to clone BearSSL and build it. You can do so by running these commands from the root folder of this repository:</p>
<div data-snippet-clipboard-copy-content="$ mkdir 3p
$ cd 3p
$ git clone https://www.bearssl.org/git/BearSSL
$ cd BearSSL
$ make -j
$ cd ../../
$ make -B HTTPS=1"><pre><code>$ mkdir 3p
$ cd 3p
$ git clone https://www.bearssl.org/git/BearSSL
$ cd BearSSL
$ make -j
$ cd ../../
$ make -B HTTPS=1
</code></pre></div>
<p dir="auto">The same executables will be generated, but with secure connections on port 443 (release) or 8081 (debug).</p>
<p dir="auto">Place your <code>cert.pem</code> and <code>key.pem</code> files in the same directory as the executable. You can customiza names and locations by changing:</p>
<div dir="auto" data-snippet-clipboard-copy-content="#define HTTPS_KEY_FILE  &quot;key.pem&quot;
#define HTTPS_CERT_FILE &quot;cert.pem&quot;"><pre><span>#define</span> <span>HTTPS_KEY_FILE</span>  "key.pem"
<span>#define</span> <span>HTTPS_CERT_FILE</span> "cert.pem"</pre></div>
<p dir="auto">For testing locally with HTTPS, generate a self-signed certificate (and private key):</p>
<div data-snippet-clipboard-copy-content="openssl genpkey -algorithm RSA -out key.pem -pkeyopt rsa_keygen_bits:2048
openssl req -new -x509 -key key.pem -out cert.pem -days 365"><pre><code>openssl genpkey -algorithm RSA -out key.pem -pkeyopt rsa_keygen_bits:2048
openssl req -new -x509 -key key.pem -out cert.pem -days 365
</code></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Usage</h2><a id="user-content-usage" aria-label="Permalink: Usage" href="#usage"></a></p>
<p dir="auto">The server serves static content from the <code>docroot/</code> folder. You can change this by modifying the <code>respond</code> function:</p>
<div dir="auto" data-snippet-clipboard-copy-content="typedef struct {
	Method method;
	string path;
	int    major;
	int    minor;
	int    nheaders;
	Header headers[MAX_HEADERS];
	string content;
} Request;

void respond(Request request, ResponseBuilder *b)
{
	if (request.major != 1 || request.minor > 1) {
		status_line(b, 505); // HTTP Version Not Supported
		return;
	}

	if (request.method != M_GET) {
		status_line(b, 405); // Method Not Allowed
		return;
	}

	if (string_match_case_insensitive(request.path, LIT(&quot;/hello&quot;))) {
		status_line(b, 200);
		append_content_s(b, LIT(&quot;Hello, world!&quot;));
		return;
	}

	if (serve_file_or_dir(b, LIT(&quot;/&quot;), LIT(&quot;docroot/&quot;), request.path, NULLSTR, false))
		return;

	status_line(b, 404);
	append_content_s(b, LIT(&quot;Nothing here :|&quot;));
}"><pre><span>typedef</span> <span>struct</span> {
	<span>Method</span> <span>method</span>;
	<span>string</span> <span>path</span>;
	<span>int</span>    <span>major</span>;
	<span>int</span>    <span>minor</span>;
	<span>int</span>    <span>nheaders</span>;
	<span>Header</span> <span>headers</span>[<span>MAX_HEADERS</span>];
	<span>string</span> <span>content</span>;
} <span>Request</span>;

<span>void</span> <span>respond</span>(<span>Request</span> <span>request</span>, <span>ResponseBuilder</span> <span>*</span><span>b</span>)
{
	<span>if</span> (<span>request</span>.<span>major</span> <span>!=</span> <span>1</span> <span>||</span> <span>request</span>.<span>minor</span> <span>&gt;</span> <span>1</span>) {
		<span>status_line</span>(<span>b</span>, <span>505</span>); <span>// HTTP Version Not Supported</span>
		<span>return</span>;
	}

	<span>if</span> (<span>request</span>.<span>method</span> <span>!=</span> <span>M_GET</span>) {
		<span>status_line</span>(<span>b</span>, <span>405</span>); <span>// Method Not Allowed</span>
		<span>return</span>;
	}

	<span>if</span> (<span>string_match_case_insensitive</span>(<span>request</span>.<span>path</span>, <span>LIT</span>(<span>"/hello"</span>))) {
		<span>status_line</span>(<span>b</span>, <span>200</span>);
		<span>append_content_s</span>(<span>b</span>, <span>LIT</span>(<span>"Hello, world!"</span>));
		<span>return</span>;
	}

	<span>if</span> (<span>serve_file_or_dir</span>(<span>b</span>, <span>LIT</span>(<span>"/"</span>), <span>LIT</span>(<span>"docroot/"</span>), <span>request</span>.<span>path</span>, <span>NULLSTR</span>, false))
		<span>return</span>;

	<span>status_line</span>(<span>b</span>, <span>404</span>);
	<span>append_content_s</span>(<span>b</span>, <span>LIT</span>(<span>"Nothing here :|"</span>));
}</pre></div>
<p dir="auto">you can add your endpoints here by switching on the <code>request.path</code> field. Note that the path is just a slice into the request buffer. URIs are not parsed.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Testing</h2><a id="user-content-testing" aria-label="Permalink: Testing" href="#testing"></a></p>
<p dir="auto">I routinely run the server under valgrind and sanitizers (address, undefined) and target it using <code>wrk</code>. I'm also adding automatized tests to <code>tests/test.py</code> to check compliance with the HTTP/1.1 spec. I also use it to host my website and post it here and there to keep it under stress.Turns out, all of those bots scanning he internet for vulnerable websites make great fuzzers!</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Known Issues</h2><a id="user-content-known-issues" aria-label="Permalink: Known Issues" href="#known-issues"></a></p>
<ul dir="auto">
<li>Server replies to HTTP/1.0 clients as HTTP/1.1</li>
</ul>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Hacker plants false memories in ChatGPT to steal user data in perpetuity (235 pts)]]></title>
            <link>https://arstechnica.com/security/2024/09/false-memories-planted-in-chatgpt-give-hacker-persistent-exfiltration-channel/</link>
            <guid>41641522</guid>
            <pubDate>Tue, 24 Sep 2024 22:13:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://arstechnica.com/security/2024/09/false-memories-planted-in-chatgpt-give-hacker-persistent-exfiltration-channel/">https://arstechnica.com/security/2024/09/false-memories-planted-in-chatgpt-give-hacker-persistent-exfiltration-channel/</a>, See on <a href="https://news.ycombinator.com/item?id=41641522">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
            <h4>
      MEMORY PROBLEMS    —
</h4>
            
            <h2 itemprop="description">Emails, documents, and other untrusted content can plant malicious memories.</h2>
                    </div><div itemprop="articleBody">
                                    
<figure>
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2024/09/memory-800x560.jpg" alt="Hacker plants false memories in ChatGPT to steal user data in perpetuity">
      <figcaption><p>Getty Images</p></figcaption>  </figure>

  




<!-- cache hit 115:single/related:94447731f52e28b62a22ce87bc7a6495 --><!-- empty -->
<p>When security researcher Johann Rehberger recently reported a vulnerability in ChatGPT that allowed attackers to store false information and malicious instructions in a user’s long-term memory settings, OpenAI summarily closed the inquiry, labeling the flaw a safety issue, not, technically speaking, a security concern.</p>
<p>So Rehberger did what all good researchers do: He created a proof-of-concept exploit that used the vulnerability to exfiltrate all user input in perpetuity. OpenAI engineers took notice and issued a partial fix earlier this month.</p>
<h2>Strolling down memory lane</h2>
<p>The vulnerability abused long-term conversation memory, a feature OpenAI began testing <a href="https://arstechnica.com/information-technology/2024/02/amnesia-begone-soon-chatgpt-will-remember-what-you-tell-it-between-sessions/">in February</a> and made more broadly available <a href="https://openai.com/index/memory-and-new-controls-for-chatgpt/">in September</a>. Memory with ChatGPT stores information from previous conversations and uses it as context in all future conversations. That way, the LLM can be aware of details such as a user’s age, gender, philosophical beliefs, and pretty much anything else, so those details don’t have to be inputted during each conversation.
</p><p>Within three months of the rollout, Rehberger <a href="https://embracethered.com/blog/posts/2024/chatgpt-hacking-memories/">found</a> that memories could be created and permanently stored through indirect <a href="https://arstechnica.com/information-technology/2022/09/twitter-pranksters-derail-gpt-3-bot-with-newly-discovered-prompt-injection-hack/">prompt injection</a>, an AI exploit that causes an LLM to follow instructions from untrusted content such as emails, blog posts, or documents. The researcher demonstrated how he could trick ChatGPT into believing a targeted user was 102 years old, lived in the Matrix, and insisted Earth was flat and the LLM would incorporate that information to steer all future conversations. These false memories could be planted by storing files in Google Drive or Microsoft OneDrive, uploading images, or browsing a site like Bing—all of which could be created by a malicious attacker.</p>                                                                        
                                                                                
<p>Rehberger privately reported the finding to OpenAI in May. That same month, the company closed the report ticket. A month later, the researcher submitted a new disclosure statement. This time, he included a PoC that caused the ChatGPT app for macOS to send a verbatim copy of all user input and ChatGPT output to a server of his choice. All a target needed to do was instruct the LLM to view a web link that hosted a malicious image. From then on, all input and output to and from ChatGPT was sent to the attacker's website.</p>
<figure><p><iframe type="text/html" width="560" height="315" src="https://www.youtube.com/embed/zb0q5AW5ns8?si=N_v0kYZbQPETRNF0?start=0&amp;wmode=transparent" frameborder="0" allowfullscreen=""></iframe></p><figcaption><div><p>
ChatGPT: Hacking Memories with Prompt Injection - POC </p></div></figcaption></figure>
<p>“What is really interesting is this is memory-persistent now,” Rehberger said in the above video demo. “The prompt injection inserted a memory into ChatGPT’s long-term storage. When you start a new conversation, it actually is still exfiltrating the data.”</p>
<p>The attack isn’t possible through the ChatGPT web interface, thanks to an API OpenAI rolled out <a href="https://embracethered.com/blog/posts/2023/openai-data-exfiltration-first-mitigations-implemented/">last year</a>.</p>
<p>While OpenAI has introduced a fix that prevents memories from being abused as an exfiltration vector, the researcher said, untrusted content can still perform prompt injections that cause the memory tool to store long-term information planted by a malicious attacker.</p>
<p>LLM users who want to prevent this form of attack should pay close attention during sessions for output that indicates a new memory has been added. They should also regularly review stored memories for anything that may have been planted by untrusted sources. OpenAI provides guidance <a href="https://openai.com/index/memory-and-new-controls-for-chatgpt/">here</a> for managing the memory tool and specific memories stored in it. Company representatives didn’t respond to an email asking about its efforts to prevent other hacks that plant false memories.</p>

                                                </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Why Most Published Research Findings Are False (210 pts)]]></title>
            <link>https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0020124</link>
            <guid>41641274</guid>
            <pubDate>Tue, 24 Sep 2024 21:45:50 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0020124">https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0020124</a>, See on <a href="https://news.ycombinator.com/item?id=41641274">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="main-content">

<header>





<ul id="almSignposts">
  <li id="loadingMetrics">
    <p>Loading metrics</p>
  </li>
</ul>







    
    <div>






<div id="floatTitleTop" data-js-floater="title_author" role="presentation">
    <div>
      

<ul id="floatAuthorList" data-js-floater="floated_authors">

  <li data-float-index="1">John P. A. Ioannidis

  </li>

</ul>



    </div>
    <div id="titleTopCloser">
      <p><img src="https://journals.plos.org/resource/img/logo-plos.png" alt="PLOS"></p><p>x</p>
    </div>
  </div>

      <ul>
        <li id="artPubDate">Published: August 30, 2005</li>
        <li id="artDoi">
<a href="https://doi.org/10.1371/journal.pmed.0020124">https://doi.org/10.1371/journal.pmed.0020124</a>
        </li>
        <li></li>
      </ul>

    </div>
  
</header>
  <div>




  <div>
  <h2>Correction</h2>
    
  </div>


<div id="figure-carousel-section">
  <h2>Figures</h2>

  
</div>





        <div id="artText">
          



<div xmlns:plos="http://plos.org"><h2>Abstract</h2><div id="section1"><h3>Summary</h3>
<p>There is increasing concern that most current published research findings are false. The probability that a research claim is true may depend on study power and bias, the number of other studies on the same question, and, importantly, the ratio of true to no relationships among the relationships probed in each scientific field. In this framework, a research finding is less likely to be true when the studies conducted in a field are smaller; when effect sizes are smaller; when there is a greater number and lesser preselection of tested relationships; where there is greater flexibility in designs, definitions, outcomes, and analytical modes; when there is greater financial and other interest and prejudice; and when more teams are involved in a scientific field in chase of statistical significance. Simulations show that for most study designs and settings, it is more likely for a research claim to be false than true. Moreover, for many current scientific fields, claimed research findings may often be simply accurate measures of the prevailing bias. In this essay, I discuss the implications of these problems for the conduct and interpretation of research.</p>
</div></div>


<div xmlns:plos="http://plos.org"><p><strong>Citation: </strong>Ioannidis JPA (2005) Why Most Published Research Findings Are False. PLoS Med 2(8):
           e124.
        
        https://doi.org/10.1371/journal.pmed.0020124</p><p><strong>Published: </strong> August 30, 2005</p><p><strong>Copyright: </strong> © 2005 John P. A. Ioannidis. This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p><p><strong>Competing interests: </strong>  The author has declared that no competing interests exist.</p><p><strong>Abbreviation:
          </strong>PPV,
            positive predictive value</p></div>





<div xmlns:plos="http://plos.org" id="section1"><p>Published research findings are sometimes refuted by subsequent evidence, with ensuing confusion and disappointment. Refutation and controversy is seen across the range of research designs, from clinical trials and traditional epidemiological studies [<a href="#pmed-0020124-b1">1–3</a>] to the most modern molecular research [<a href="#pmed-0020124-b4">4</a>,<a href="#pmed-0020124-b5">5</a>]. There is increasing concern that in modern research, false findings may be the majority or even the vast majority of published research claims [<a href="#pmed-0020124-b6">6–8</a>]. However, this should not be surprising. It can be proven that most claimed research findings are false. Here I will examine the key factors that influence this problem and some corollaries thereof.</p>
</div>

<div xmlns:plos="http://plos.org" id="section2"><h2>Modeling the Framework for False Positive Findings</h2><p>Several methodologists have pointed out [<a href="#pmed-0020124-b9">9–11</a>] that the high rate of nonreplication (lack of confirmation) of research discoveries is a consequence of the convenient, yet ill-founded strategy of claiming conclusive research findings solely on the basis of a single study assessed by formal statistical significance, typically for a <em>p</em>-value less than 0.05. Research is not most appropriately represented and summarized by <em>p</em>-values, but, unfortunately, there is a widespread notion that medical research articles should be interpreted based only on <em>p</em>-values. Research findings are defined here as any relationship reaching formal statistical significance, e.g., effective interventions, informative predictors, risk factors, or associations. “Negative” research is also very useful. “Negative” is actually a misnomer, and the misinterpretation is widespread. However, here we will target relationships that investigators claim exist, rather than null findings.</p>
<blockquote><a id="article1.body1.sec2.p2.disp-quote1.p1" name="article1.body1.sec2.p2.disp-quote1.p1"></a><p>It can be proven that most claimed research findings are false</p>
</blockquote>

			
<p>As has been shown previously, the probability that a research finding is indeed true depends on the prior probability of it being true (before doing the study), the statistical power of the study, and the level of statistical significance [<a href="#pmed-0020124-b10">10</a>,<a href="#pmed-0020124-b11">11</a>]. Consider a 2 × 2 table in which research findings are compared against the gold standard of true relationships in a scientific field. In a research field both true and false hypotheses can be made about the presence of relationships. Let <em>R</em> be the ratio of the number of “true relationships” to “no relationships” among those tested in the field. <em>R</em> is characteristic of the field and can vary a lot depending on whether the field targets highly likely relationships or searches for only one or a few true relationships among thousands and millions of hypotheses that may be postulated. Let us also consider, for computational simplicity, circumscribed fields where either there is only one true relationship (among many that can be hypothesized) or the power is similar to find any of the several existing true relationships. The pre-study probability of a relationship being true is <em>R</em>/(<em>R</em> + 1). The probability of a study finding a true relationship reflects the power 1 - β (one minus the Type II error rate). The probability of claiming a relationship when none truly exists reflects the Type I error rate, α. Assuming that <em>c</em> relationships are being probed in the field, the expected values of the 2 × 2 table are given in <a href="#pmed-0020124-t001">Table 1</a>. After a research finding has been claimed based on achieving formal statistical significance, the post-study probability that it is true is the positive predictive value, PPV. The PPV is also the complementary probability of what Wacholder et al. have called the false positive report probability [<a href="#pmed-0020124-b10">10</a>]. According to the 2 × 2 table, one gets PPV = (1 - β)<em>R</em>/(<em>R</em> - βR + α). A research finding is thus more likely true than false if (1 - β)<em>R</em> &gt; α. Since usually the vast majority of investigators depend on a = 0.05, this means that a research finding is more likely true than false if (1 - β)<em>R</em> &gt; 0.05.</p>
<p>What is less well appreciated is that bias and the extent of repeated independent testing by different teams of investigators around the globe may further distort this picture and may lead to even smaller probabilities of the research findings being indeed true. We will try to model these two factors in the context of similar 2 × 2 tables.</p>
</div>

<div xmlns:plos="http://plos.org" id="section3"><h2>Bias</h2><p>First, let us define bias as the combination of various design, data, analysis, and presentation factors that tend to produce research findings when they should not be produced. Let <em>u</em> be the proportion of probed analyses that would not have been “research findings,” but nevertheless end up presented and reported as such, because of bias. Bias should not be confused with chance variability that causes some findings to be false by chance even though the study design, data, analysis, and presentation are perfect. Bias can entail manipulation in the analysis or reporting of findings. Selective or distorted reporting is a typical form of such bias. We may assume that <em>u</em> does not depend on whether a true relationship exists or not. This is not an unreasonable assumption, since typically it is impossible to know which relationships are indeed true. In the presence of bias (<a href="#pmed-0020124-t002">Table 2</a>), one gets PPV = ([1 - β]<em>R</em> + <em>u</em>β<em>R</em>)/(<em>R</em> + α − β<em>R</em> + <em>u</em> − <em>u</em>α + <em>u</em>β<em>R</em>), and PPV decreases with increasing <em>u</em>, unless 1 − β ≤ α, i.e., 1 − β ≤ 0.05 for most situations. Thus, with increasing bias, the chances that a research finding is true diminish considerably. This is shown for different levels of power and for different pre-study odds in <a href="#pmed-0020124-g001">Figure 1</a>. Conversely, true research findings may occasionally be annulled because of reverse bias. For example, with large measurement errors relationships are lost in noise [<a href="#pmed-0020124-b12">12</a>], or investigators use data inefficiently or fail to notice statistically significant relationships, or there may be conflicts of interest that tend to “bury” significant findings [<a href="#pmed-0020124-b13">13</a>]. There is no good large-scale empirical evidence on how frequently such reverse bias may occur across diverse research fields. However, it is probably fair to say that reverse bias is not as common. Moreover measurement errors and inefficient use of data are probably becoming less frequent problems, since measurement error has decreased with technological advances in the molecular era and investigators are becoming increasingly sophisticated about their data. Regardless, reverse bias may be modeled in the same way as bias above. Also reverse bias should not be confused with chance variability that may lead to missing a true relationship because of chance.</p>
</div>

<div xmlns:plos="http://plos.org" id="section4"><h2>Testing by Several Independent Teams</h2><p>Several independent teams may be addressing the same sets of research questions. As research efforts are globalized, it is practically the rule that several research teams, often dozens of them, may probe the same or similar questions. Unfortunately, in some areas, the prevailing mentality until now has been to focus on isolated discoveries by single teams and interpret research experiments in isolation. An increasing number of questions have at least one study claiming a research finding, and this receives unilateral attention. The probability that at least one study, among several done on the same question, claims a statistically significant research finding is easy to estimate. For <em>n</em> independent studies of equal power, the 2 × 2 table is shown in <a href="#pmed-0020124-t003">Table 3</a>: PPV = <em>R</em>(1 − β<sup><em>n</em></sup>)/(<em>R</em> + 1 − [1 − α]<sup><em>n</em></sup> − <em>R</em>β<sup><em>n</em></sup>) (not considering bias). With increasing number of independent studies, PPV tends to decrease, unless 1 - β &lt; a, i.e., typically 1 − β &lt; 0.05. This is shown for different levels of power and for different pre-study odds in <a href="#pmed-0020124-g002">Figure 2</a>. For <em>n</em> studies of different power, the term β<sup><em>n</em></sup> is replaced by the product of the terms β<sub><em>i</em></sub> for <em>i</em> = 1 to <em>n</em>, but inferences are similar.</p>
</div>

<div xmlns:plos="http://plos.org" id="section5"><h2>Corollaries</h2><p>A practical example is shown in <a href="#box1">Box 1</a>. Based on the above considerations, one may deduce several interesting corollaries about the probability that a research finding is indeed true.</p>
<div id="section1"><h3>Box 1. An Example: Science at Low Pre-Study Odds</h3>
<p>Let us assume that a team of investigators performs a whole genome association study to test whether any of 100,000 gene polymorphisms are associated with susceptibility to schizophrenia. Based on what we know about the extent of heritability of the disease, it is reasonable to expect that probably around ten gene polymorphisms among those tested would be truly associated with schizophrenia, with relatively similar odds ratios around 1.3 for the ten or so polymorphisms and with a fairly similar power to identify any of them. Then <em>R</em> = 10/100,000 = 10<sup>−4</sup>, and the pre-study probability for any polymorphism to be associated with schizophrenia is also <em>R</em>/(<em>R</em> + 1) = 10<sup>−4</sup>. Let us also suppose that the study has 60% power to find an association with an odds ratio of 1.3 at α = 0.05. Then it can be estimated that if a statistically significant association is found with the <em>p</em>-value barely crossing the 0.05 threshold, the post-study probability that this is true increases about 12-fold compared with the pre-study probability, but it is still only 12 × 10<sup>−4</sup>.</p>
<p>Now let us suppose that the investigators manipulate their design, analyses, and reporting so as to make more relationships cross the <em>p</em> = 0.05 threshold even though this would not have been crossed with a perfectly adhered to design and analysis and with perfect comprehensive reporting of the results, strictly according to the original study plan. Such manipulation could be done, for example, with serendipitous inclusion or exclusion of certain patients or controls, post hoc subgroup analyses, investigation of genetic contrasts that were not originally specified, changes in the disease or control definitions, and various combinations of selective or distorted reporting of the results. Commercially available “data mining” packages actually are proud of their ability to yield statistically significant results through data dredging. In the presence of bias with <em>u</em> = 0.10, the post-study probability that a research finding is true is only 4.4 × 10<sup>−4</sup>. Furthermore, even in the absence of any bias, when ten independent research teams perform similar experiments around the world, if one of them finds a formally statistically significant association, the probability that the research finding is true is only 1.5 × 10<sup>−4</sup>, hardly any higher than the probability we had before any of this extensive research was undertaken!</p>
</div><p><strong>Corollary 1: The smaller the studies conducted in a scientific field, the less likely the research findings are to be true.</strong> Small sample size means smaller power and, for all functions above, the PPV for a true research finding decreases as power decreases towards 1 − β = 0.05. Thus, other factors being equal, research findings are more likely true in scientific fields that undertake large studies, such as randomized controlled trials in cardiology (several thousand subjects randomized) [<a href="#pmed-0020124-b14">14</a>] than in scientific fields with small studies, such as most research of molecular predictors (sample sizes 100-fold smaller) [<a href="#pmed-0020124-b15">15</a>].</p>
<p><strong>Corollary 2: The smaller the effect sizes in a scientific field, the less likely the research findings are to be true.</strong> Power is also related to the effect size. Thus research findings are more likely true in scientific fields with large effects, such as the impact of smoking on cancer or cardiovascular disease (relative risks 3–20), than in scientific fields where postulated effects are small, such as genetic risk factors for multigenetic diseases (relative risks 1.1–1.5) [<a href="#pmed-0020124-b7">7</a>]. Modern epidemiology is increasingly obliged to target smaller effect sizes [<a href="#pmed-0020124-b16">16</a>]. Consequently, the proportion of true research findings is expected to decrease. In the same line of thinking, if the true effect sizes are very small in a scientific field, this field is likely to be plagued by almost ubiquitous false positive claims. For example, if the majority of true genetic or nutritional determinants of complex diseases confer relative risks less than 1.05, genetic or nutritional epidemiology would be largely utopian endeavors.</p>
<p><strong>Corollary 3: The greater the number and the lesser the selection of tested relationships in a scientific field, the less likely the research findings are to be true.</strong> As shown above, the post-study probability that a finding is true (PPV) depends a lot on the pre-study odds <em>(R)</em>. Thus, research findings are more likely true in confirmatory designs, such as large phase III randomized controlled trials, or meta-analyses thereof, than in hypothesis-generating experiments. Fields considered highly informative and creative given the wealth of the assembled and tested information, such as microarrays and other high-throughput discovery-oriented research [<a href="#pmed-0020124-b4">4</a>,<a href="#pmed-0020124-b8">8</a>,<a href="#pmed-0020124-b17">17</a>], should have extremely low PPV.</p>
<p><strong>Corollary 4: The greater the flexibility in designs, definitions, outcomes, and analytical modes in a scientific field, the less likely the research findings are to be true.</strong> Flexibility increases the potential for transforming what would be “negative” results into “positive” results, i.e., bias, <em>u</em>. For several research designs, e.g., randomized controlled trials [<a href="#pmed-0020124-b18">18–20</a>] or meta-analyses [<a href="#pmed-0020124-b21">21</a>,<a href="#pmed-0020124-b22">22</a>], there have been efforts to standardize their conduct and reporting. Adherence to common standards is likely to increase the proportion of true findings. The same applies to outcomes. True findings may be more common when outcomes are unequivocal and universally agreed (e.g., death) rather than when multifarious outcomes are devised (e.g., scales for schizophrenia outcomes) [<a href="#pmed-0020124-b23">23</a>]. Similarly, fields that use commonly agreed, stereotyped analytical methods (e.g., Kaplan-Meier plots and the log-rank test) [<a href="#pmed-0020124-b24">24</a>] may yield a larger proportion of true findings than fields where analytical methods are still under experimentation (e.g., artificial intelligence methods) and only “best” results are reported. Regardless, even in the most stringent research designs, bias seems to be a major problem. For example, there is strong evidence that selective outcome reporting, with manipulation of the outcomes and analyses reported, is a common problem even for randomized trails [<a href="#pmed-0020124-b25">25</a>]. Simply abolishing selective publication would not make this problem go away.</p>
<p><strong>Corollary 5: The greater the financial and other interests and prejudices in a scientific field, the less likely the research findings are to be true.</strong> Conflicts of interest and prejudice may increase bias, <em>u</em>. Conflicts of interest are very common in biomedical research [<a href="#pmed-0020124-b26">26</a>], and typically they are inadequately and sparsely reported [<a href="#pmed-0020124-b26">26</a>,<a href="#pmed-0020124-b27">27</a>]. Prejudice may not necessarily have financial roots. Scientists in a given field may be prejudiced purely because of their belief in a scientific theory or commitment to their own findings. Many otherwise seemingly independent, university-based studies may be conducted for no other reason than to give physicians and researchers qualifications for promotion or tenure. Such nonfinancial conflicts may also lead to distorted reported results and interpretations. Prestigious investigators may suppress via the peer review process the appearance and dissemination of findings that refute their findings, thus condemning their field to perpetuate false dogma. Empirical evidence on expert opinion shows that it is extremely unreliable [<a href="#pmed-0020124-b28">28</a>].</p>
<p><strong>Corollary 6: The hotter a scientific field (with more scientific teams involved), the less likely the research findings are to be true.</strong> This seemingly paradoxical corollary follows because, as stated above, the PPV of isolated findings decreases when many teams of investigators are involved in the same field. This may explain why we occasionally see major excitement followed rapidly by severe disappointments in fields that draw wide attention. With many teams working on the same field and with massive experimental data being produced, timing is of the essence in beating competition. Thus, each team may prioritize on pursuing and disseminating its most impressive “positive” results. “Negative” results may become attractive for dissemination only if some other team has found a “positive” association on the same question. In that case, it may be attractive to refute a claim made in some prestigious journal. The term Proteus phenomenon has been coined to describe this phenomenon of rapidly alternating extreme research claims and extremely opposite refutations [<a href="#pmed-0020124-b29">29</a>]. Empirical evidence suggests that this sequence of extreme opposites is very common in molecular genetics [<a href="#pmed-0020124-b29">29</a>].</p>
<p>These corollaries consider each factor separately, but these factors often influence each other. For example, investigators working in fields where true effect sizes are perceived to be small may be more likely to perform large studies than investigators working in fields where true effect sizes are perceived to be large. Or prejudice may prevail in a hot scientific field, further undermining the predictive value of its research findings. Highly prejudiced stakeholders may even create a barrier that aborts efforts at obtaining and disseminating opposing results. Conversely, the fact that a field is hot or has strong invested interests may sometimes promote larger studies and improved standards of research, enhancing the predictive value of its research findings. Or massive discovery-oriented testing may result in such a large yield of significant relationships that investigators have enough to report and search further and thus refrain from data dredging and manipulation.</p>
</div>

<div xmlns:plos="http://plos.org" id="section6"><h2>Most Research Findings Are False for Most Research Designs and for Most Fields</h2><p>In the described framework, a PPV exceeding 50% is quite difficult to get. <a href="#pmed-0020124-t004">Table 4</a> provides the results of simulations using the formulas developed for the influence of power, ratio of true to non-true relationships, and bias, for various types of situations that may be characteristic of specific study designs and settings. A finding from a well-conducted, adequately powered randomized controlled trial starting with a 50% pre-study chance that the intervention is effective is eventually true about 85% of the time. A fairly similar performance is expected of a confirmatory meta-analysis of good-quality randomized trials: potential bias probably increases, but power and pre-test chances are higher compared to a single randomized trial. Conversely, a meta-analytic finding from inconclusive studies where pooling is used to “correct” the low power of single studies, is probably false if <em>R</em> ≤ 1:3. Research findings from underpowered, early-phase clinical trials would be true about one in four times, or even less frequently if bias is present. Epidemiological studies of an exploratory nature perform even worse, especially when underpowered, but even well-powered epidemiological studies may have only a one in five chance being true, if <em>R</em> = 1:10. Finally, in discovery-oriented research with massive testing, where tested relationships exceed true ones 1,000-fold (e.g., 30,000 genes tested, of which 30 may be the true culprits) [<a href="#pmed-0020124-b30">30</a>,<a href="#pmed-0020124-b31">31</a>], PPV for each claimed relationship is extremely low, even with considerable standardization of laboratory and statistical methods, outcomes, and reporting thereof to minimize bias.</p>
</div>

<div xmlns:plos="http://plos.org" id="section7"><h2>Claimed Research Findings May Often Be Simply Accurate Measures of the Prevailing Bias</h2><p>As shown, the majority of modern biomedical research is operating in areas with very low pre- and post-study probability for true findings. Let us suppose that in a research field there are no true findings at all to be discovered. History of science teaches us that scientific endeavor has often in the past wasted effort in fields with absolutely no yield of true scientific information, at least based on our current understanding. In such a “null field,” one would ideally expect all observed effect sizes to vary by chance around the null in the absence of bias. The extent that observed findings deviate from what is expected by chance alone would be simply a pure measure of the prevailing bias.</p>
<p>For example, let us suppose that no nutrients or dietary patterns are actually important determinants for the risk of developing a specific tumor. Let us also suppose that the scientific literature has examined 60 nutrients and claims all of them to be related to the risk of developing this tumor with relative risks in the range of 1.2 to 1.4 for the comparison of the upper to lower intake tertiles. Then the claimed effect sizes are simply measuring nothing else but the net bias that has been involved in the generation of this scientific literature. Claimed effect sizes are in fact the most accurate estimates of the net bias. It even follows that between “null fields,” the fields that claim stronger effects (often with accompanying claims of medical or public health importance) are simply those that have sustained the worst biases.</p>
<p>For fields with very low PPV, the few true relationships would not distort this overall picture much. Even if a few relationships are true, the shape of the distribution of the observed effects would still yield a clear measure of the biases involved in the field. This concept totally reverses the way we view scientific results. Traditionally, investigators have viewed large and highly significant effects with excitement, as signs of important discoveries. Too large and too highly significant effects may actually be more likely to be signs of large bias in most fields of modern research. They should lead investigators to careful critical thinking about what might have gone wrong with their data, analyses, and results.</p>
<p>Of course, investigators working in any field are likely to resist accepting that the whole field in which they have spent their careers is a “null field.” However, other lines of evidence, or advances in technology and experimentation, may lead eventually to the dismantling of a scientific field. Obtaining measures of the net bias in one field may also be useful for obtaining insight into what might be the range of bias operating in other fields where similar analytical methods, technologies, and conflicts may be operating.</p>
</div>

<div xmlns:plos="http://plos.org" id="section8"><h2>How Can We Improve the Situation?</h2><p>Is it unavoidable that most research findings are false, or can we improve the situation? A major problem is that it is impossible to know with 100% certainty what the truth is in any research question. In this regard, the pure “gold” standard is unattainable. However, there are several approaches to improve the post-study probability.</p>
<p>Better powered evidence, e.g., large studies or low-bias meta-analyses, may help, as it comes closer to the unknown “gold” standard. However, large studies may still have biases and these should be acknowledged and avoided. Moreover, large-scale evidence is impossible to obtain for all of the millions and trillions of research questions posed in current research. Large-scale evidence should be targeted for research questions where the pre-study probability is already considerably high, so that a significant research finding will lead to a post-test probability that would be considered quite definitive. Large-scale evidence is also particularly indicated when it can test major concepts rather than narrow, specific questions. A negative finding can then refute not only a specific proposed claim, but a whole field or considerable portion thereof. Selecting the performance of large-scale studies based on narrow-minded criteria, such as the marketing promotion of a specific drug, is largely wasted research. Moreover, one should be cautious that extremely large studies may be more likely to find a formally statistical significant difference for a trivial effect that is not really meaningfully different from the null [<a href="#pmed-0020124-b32">32–34</a>].</p>
<p>Second, most research questions are addressed by many teams, and it is misleading to emphasize the statistically significant findings of any single team. What matters is the totality of the evidence. Diminishing bias through enhanced research standards and curtailing of prejudices may also help. However, this may require a change in scientific mentality that might be difficult to achieve. In some research designs, efforts may also be more successful with upfront registration of studies, e.g., randomized trials [<a href="#pmed-0020124-b35">35</a>]. Registration would pose a challenge for hypothesis-generating research. Some kind of registration or networking of data collections or investigators within fields may be more feasible than registration of each and every hypothesis-generating experiment. Regardless, even if we do not see a great deal of progress with registration of studies in other fields, the principles of developing and adhering to a protocol could be more widely borrowed from randomized controlled trials.</p>
<p>Finally, instead of chasing statistical significance, we should improve our understanding of the range of <em>R</em> values—the pre-study odds—where research efforts operate [<a href="#pmed-0020124-b10">10</a>]. Before running an experiment, investigators should consider what they believe the chances are that they are testing a true rather than a non-true relationship. Speculated high <em>R</em> values may sometimes then be ascertained. As described above, whenever ethically acceptable, large studies with minimal bias should be performed on research findings that are considered relatively established, to see how often they are indeed confirmed. I suspect several established “classics” will fail the test [<a href="#pmed-0020124-b36">36</a>].</p>
<p>Nevertheless, most new discoveries will continue to stem from hypothesis-generating research with low or very low pre-study odds. We should then acknowledge that statistical significance testing in the report of a single study gives only a partial picture, without knowing how much testing has been done outside the report and in the relevant field at large. Despite a large statistical literature for multiple testing corrections [<a href="#pmed-0020124-b37">37</a>], usually it is impossible to decipher how much data dredging by the reporting authors or other research teams has preceded a reported research finding. Even if determining this were feasible, this would not inform us about the pre-study odds. Thus, it is unavoidable that one should make approximate assumptions on how many relationships are expected to be true among those probed across the relevant research fields and research designs. The wider field may yield some guidance for estimating this probability for the isolated research project. Experiences from biases detected in other neighboring fields would also be useful to draw upon. Even though these assumptions would be considerably subjective, they would still be very useful in interpreting research claims and putting them in context.</p>
</div>



<div xmlns:plos="http://plos.org"><h2>References</h2><ol><li id="ref1"><span>1.
            </span><a name="pmed-0020124-b1" id="pmed-0020124-b1"></a>Ioannidis JP, Haidich AB, Lau J (2001) Any casualties in the clash of randomised and observational evidence? BMJ  322: 879–880.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPHaidichABLauJAny%20casualties%20in%20the%20clash%20of%20randomised%20and%20observational%20evidence%3FBMJ2001322879880" data-title="Any%20casualties%20in%20the%20clash%20of%20randomised%20and%20observational%20evidence%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Any+casualties+in+the+clash+of+randomised+and+observational+evidence%3F+Ioannidis+2001" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref2"><span>2.
            </span><a name="pmed-0020124-b2" id="pmed-0020124-b2"></a>Lawlor DA, Davey Smith G, Kundu D, Bruckdorfer KR, Ebrahim S (2004) Those confounded vitamins: What can we learn from the differences between observational versus randomised trial evidence? Lancet  363: 1724–1727.  <ul><li><a href="#" data-author="Lawlor" data-cit="LawlorDADavey%20SmithGKunduDBruckdorferKREbrahimSThose%20confounded%20vitamins%3A%20What%20can%20we%20learn%20from%20the%20differences%20between%20observational%20versus%20randomised%20trial%20evidence%3FLancet200436317241727" data-title="Those%20confounded%20vitamins%3A%20What%20can%20we%20learn%20from%20the%20differences%20between%20observational%20versus%20randomised%20trial%20evidence%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Those+confounded+vitamins%3A+What+can+we+learn+from+the+differences+between+observational+versus+randomised+trial+evidence%3F+Lawlor+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref3"><span>3.
            </span><a name="pmed-0020124-b3" id="pmed-0020124-b3"></a>Vandenbroucke JP (2004) When are observational studies as credible as randomised trials? Lancet  363: 1728–1731.  <ul><li><a href="#" data-author="Vandenbroucke" data-cit="VandenbrouckeJPWhen%20are%20observational%20studies%20as%20credible%20as%20randomised%20trials%3FLancet200436317281731" data-title="When%20are%20observational%20studies%20as%20credible%20as%20randomised%20trials%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=When+are+observational+studies+as+credible+as+randomised+trials%3F+Vandenbroucke+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref4"><span>4.
            </span><a name="pmed-0020124-b4" id="pmed-0020124-b4"></a>Michiels S, Koscielny S, Hill C (2005) Prediction of cancer outcome with microarrays: A multiple random validation strategy. Lancet  365: 488–492.  <ul><li><a href="#" data-author="Michiels" data-cit="MichielsSKoscielnySHillCPrediction%20of%20cancer%20outcome%20with%20microarrays%3A%20A%20multiple%20random%20validation%20strategy.Lancet2005365488492" data-title="Prediction%20of%20cancer%20outcome%20with%20microarrays%3A%20A%20multiple%20random%20validation%20strategy." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Prediction+of+cancer+outcome+with+microarrays%3A+A+multiple+random+validation+strategy.+Michiels+2005" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref5"><span>5.
            </span><a name="pmed-0020124-b5" id="pmed-0020124-b5"></a>Ioannidis JPA, Ntzani EE, Trikalinos TA, Contopoulos-Ioannidis DG (2001) Replication validity of genetic association studies. Nat Genet  29: 306–309.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPANtzaniEETrikalinosTAContopoulos-IoannidisDGReplication%20validity%20of%20genetic%20association%20studies.Nat%20Genet200129306309" data-title="Replication%20validity%20of%20genetic%20association%20studies." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Replication+validity+of+genetic+association+studies.+Ioannidis+2001" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref6"><span>6.
            </span><a name="pmed-0020124-b6" id="pmed-0020124-b6"></a>Colhoun HM, McKeigue PM, Davey Smith G (2003) Problems of reporting genetic associations with complex outcomes. Lancet  361: 865–872.  <ul><li><a href="#" data-author="Colhoun" data-cit="ColhounHMMcKeiguePMDavey%20SmithGProblems%20of%20reporting%20genetic%20associations%20with%20complex%20outcomes.Lancet2003361865872" data-title="Problems%20of%20reporting%20genetic%20associations%20with%20complex%20outcomes." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Problems+of+reporting+genetic+associations+with+complex+outcomes.+Colhoun+2003" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref7"><span>7.
            </span><a name="pmed-0020124-b7" id="pmed-0020124-b7"></a>Ioannidis JP (2003) Genetic associations: False or true? Trends Mol Med  9: 135–138.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPGenetic%20associations%3A%20False%20or%20true%3FTrends%20Mol%20Med20039135138" data-title="Genetic%20associations%3A%20False%20or%20true%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Genetic+associations%3A+False+or+true%3F+Ioannidis+2003" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref8"><span>8.
            </span><a name="pmed-0020124-b8" id="pmed-0020124-b8"></a>Ioannidis JPA (2005) Microarrays and molecular research: Noise discovery? Lancet  365: 454–455.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPAMicroarrays%20and%20molecular%20research%3A%20Noise%20discovery%3FLancet2005365454455" data-title="Microarrays%20and%20molecular%20research%3A%20Noise%20discovery%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Microarrays+and+molecular+research%3A+Noise+discovery%3F+Ioannidis+2005" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref9"><span>9.
            </span><a name="pmed-0020124-b9" id="pmed-0020124-b9"></a>Sterne JA, Davey Smith G (2001) Sifting the evidence—What's wrong with significance tests. BMJ  322: 226–231.  <ul><li><a href="#" data-author="Sterne" data-cit="SterneJADavey%20SmithGSifting%20the%20evidence%E2%80%94What%27s%20wrong%20with%20significance%20tests.BMJ2001322226231" data-title="Sifting%20the%20evidence%E2%80%94What%26apos%3Bs%20wrong%20with%20significance%20tests." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Sifting+the+evidence%E2%80%94What%26apos%3Bs+wrong+with+significance+tests.+Sterne+2001" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref10"><span>10.
            </span><a name="pmed-0020124-b10" id="pmed-0020124-b10"></a>Wacholder S, Chanock S, Garcia-Closas M, Elghormli L, Rothman N (2004) Assessing the probability that a positive report is false: An approach for molecular epidemiology studies. J Natl Cancer Inst  96: 434–442.  <ul><li><a href="#" data-author="Wacholder" data-cit="WacholderSChanockSGarcia-ClosasMElghormliLRothmanNAssessing%20the%20probability%20that%20a%20positive%20report%20is%20false%3A%20An%20approach%20for%20molecular%20epidemiology%20studies.J%20Natl%20Cancer%20Inst200496434442" data-title="Assessing%20the%20probability%20that%20a%20positive%20report%20is%20false%3A%20An%20approach%20for%20molecular%20epidemiology%20studies." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Assessing+the+probability+that+a+positive+report+is+false%3A+An+approach+for+molecular+epidemiology+studies.+Wacholder+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref11"><span>11.
            </span><a name="pmed-0020124-b11" id="pmed-0020124-b11"></a>Risch NJ (2000) Searching for genetic determinants in the new millennium. Nature  405: 847–856.  <ul><li><a href="#" data-author="Risch" data-cit="RischNJSearching%20for%20genetic%20determinants%20in%20the%20new%20millennium.Nature2000405847856" data-title="Searching%20for%20genetic%20determinants%20in%20the%20new%20millennium." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Searching+for+genetic+determinants+in+the+new+millennium.+Risch+2000" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref12"><span>12.
            </span><a name="pmed-0020124-b12" id="pmed-0020124-b12"></a>Kelsey JL, Whittemore AS, Evans AS, Thompson WD (1996) Methods in observational epidemiology, 2nd ed. New York: Oxford U Press. 432 p.  <ul></ul></li><li id="ref13"><span>13.
            </span><a name="pmed-0020124-b13" id="pmed-0020124-b13"></a>Topol EJ (2004) Failing the public health—Rofecoxib, Merck, and the FDA. N Engl J Med  351: 1707–1709.  <ul><li><a href="#" data-author="Topol" data-cit="TopolEJFailing%20the%20public%20health%E2%80%94Rofecoxib%2C%20Merck%2C%20and%20the%20FDA.N%20Engl%20J%20Med200435117071709" data-title="Failing%20the%20public%20health%E2%80%94Rofecoxib%2C%20Merck%2C%20and%20the%20FDA." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Failing+the+public+health%E2%80%94Rofecoxib%2C+Merck%2C+and+the+FDA.+Topol+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref14"><span>14.
            </span><a name="pmed-0020124-b14" id="pmed-0020124-b14"></a>Yusuf S, Collins R, Peto R (1984) Why do we need some large, simple randomized trials? Stat Med  3: 409–422.  <ul><li><a href="#" data-author="Yusuf" data-cit="YusufSCollinsRPetoRWhy%20do%20we%20need%20some%20large%2C%20simple%20randomized%20trials%3FStat%20Med19843409422" data-title="Why%20do%20we%20need%20some%20large%2C%20simple%20randomized%20trials%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Why+do+we+need+some+large%2C+simple+randomized+trials%3F+Yusuf+1984" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref15"><span>15.
            </span><a name="pmed-0020124-b15" id="pmed-0020124-b15"></a>Altman DG, Royston P (2000) What do we mean by validating a prognostic model? Stat Med  19: 453–473.  <ul><li><a href="#" data-author="Altman" data-cit="AltmanDGRoystonPWhat%20do%20we%20mean%20by%20validating%20a%20prognostic%20model%3FStat%20Med200019453473" data-title="What%20do%20we%20mean%20by%20validating%20a%20prognostic%20model%3F" target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=What+do+we+mean+by+validating+a+prognostic+model%3F+Altman+2000" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref16"><span>16.
            </span><a name="pmed-0020124-b16" id="pmed-0020124-b16"></a>Taubes G (1995) Epidemiology faces its limits. Science  269: 164–169.  <ul><li><a href="#" data-author="Taubes" data-cit="TaubesGEpidemiology%20faces%20its%20limits.Science1995269164169" data-title="Epidemiology%20faces%20its%20limits." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Epidemiology+faces+its+limits.+Taubes+1995" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref17"><span>17.
            </span><a name="pmed-0020124-b17" id="pmed-0020124-b17"></a>Golub TR, Slonim DK, Tamayo P, Huard C, Gaasenbeek M, et al.  (1999) Molecular classification of cancer: Class discovery and class prediction by gene expression monitoring. Science  286: 531–537.  <ul><li><a href="#" data-author="Golub" data-cit="GolubTRSlonimDKTamayoPHuardCGaasenbeekMMolecular%20classification%20of%20cancer%3A%20Class%20discovery%20and%20class%20prediction%20by%20gene%20expression%20monitoring.Science1999286531537" data-title="Molecular%20classification%20of%20cancer%3A%20Class%20discovery%20and%20class%20prediction%20by%20gene%20expression%20monitoring." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Molecular+classification+of+cancer%3A+Class+discovery+and+class+prediction+by+gene+expression+monitoring.+Golub+1999" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref18"><span>18.
            </span><a name="pmed-0020124-b18" id="pmed-0020124-b18"></a>Moher D, Schulz KF, Altman DG (2001) The CONSORT statement: Revised recommendations for improving the quality of reports of parallel-group randomised trials. Lancet  357: 1191–1194.  <ul><li><a href="#" data-author="Moher" data-cit="MoherDSchulzKFAltmanDGThe%20CONSORT%20statement%3A%20Revised%20recommendations%20for%20improving%20the%20quality%20of%20reports%20of%20parallel-group%20randomised%20trials.Lancet200135711911194" data-title="The%20CONSORT%20statement%3A%20Revised%20recommendations%20for%20improving%20the%20quality%20of%20reports%20of%20parallel-group%20randomised%20trials." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=The+CONSORT+statement%3A+Revised+recommendations+for+improving+the+quality+of+reports+of+parallel-group+randomised+trials.+Moher+2001" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref19"><span>19.
            </span><a name="pmed-0020124-b19" id="pmed-0020124-b19"></a>Ioannidis JP, Evans SJ, Gotzsche PC, O'Neill RT, Altman DG, et al.  (2004) Better reporting of harms in randomized trials: An extension of the CONSORT statement. Ann Intern Med  141: 781–788.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPEvansSJGotzschePCO%27NeillRTAltmanDGBetter%20reporting%20of%20harms%20in%20randomized%20trials%3A%20An%20extension%20of%20the%20CONSORT%20statement.Ann%20Intern%20Med2004141781788" data-title="Better%20reporting%20of%20harms%20in%20randomized%20trials%3A%20An%20extension%20of%20the%20CONSORT%20statement." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Better+reporting+of+harms+in+randomized+trials%3A+An+extension+of+the+CONSORT+statement.+Ioannidis+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref20"><span>20.
            </span><a name="pmed-0020124-b20" id="pmed-0020124-b20"></a>International Conference on Harmonisation E9 Expert Working Group (1999) ICH Harmonised Tripartite Guideline. Statistical principles for clinical trials. Stat Med  18: 1905–1942.  <ul><li><a href="#" data-author="" data-cit="International%20Conference%20on%20Harmonisation%20E9%20Expert%20Working%20GroupICH%20Harmonised%20Tripartite%20Guideline.%20Statistical%20principles%20for%20clinical%20trials.Stat%20Med19991819051942" data-title="ICH%20Harmonised%20Tripartite%20Guideline.%20Statistical%20principles%20for%20clinical%20trials." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=ICH+Harmonised+Tripartite+Guideline.+Statistical+principles+for+clinical+trials.++1999" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref21"><span>21.
            </span><a name="pmed-0020124-b21" id="pmed-0020124-b21"></a>Moher D, Cook DJ, Eastwood S, Olkin I, Rennie D, et al.  (1999) Improving the quality of reports of meta-analyses of randomised controlled trials: The QUOROM statement. Quality of Reporting of Meta-analyses. Lancet  354: 1896–1900.  <ul><li><a href="#" data-author="Moher" data-cit="MoherDCookDJEastwoodSOlkinIRennieDImproving%20the%20quality%20of%20reports%20of%20meta-analyses%20of%20randomised%20controlled%20trials%3A%20The%20QUOROM%20statement.%20Quality%20of%20Reporting%20of%20Meta-analyses.Lancet199935418961900" data-title="Improving%20the%20quality%20of%20reports%20of%20meta-analyses%20of%20randomised%20controlled%20trials%3A%20The%20QUOROM%20statement.%20Quality%20of%20Reporting%20of%20Meta-analyses." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Improving+the+quality+of+reports+of+meta-analyses+of+randomised+controlled+trials%3A+The+QUOROM+statement.+Quality+of+Reporting+of+Meta-analyses.+Moher+1999" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref22"><span>22.
            </span><a name="pmed-0020124-b22" id="pmed-0020124-b22"></a>Stroup DF, Berlin JA, Morton SC, Olkin I, Williamson GD, et al.  (2000) Meta-analysis of observational studies in epidemiology: A proposal for reporting. Meta-analysis of Observational Studies in Epidemiology (MOOSE) group. JAMA  283: 2008–2012.  <ul><li><a href="#" data-author="Stroup" data-cit="StroupDFBerlinJAMortonSCOlkinIWilliamsonGDMeta-analysis%20of%20observational%20studies%20in%20epidemiology%3A%20A%20proposal%20for%20reporting.%20Meta-analysis%20of%20Observational%20Studies%20in%20Epidemiology%20%28MOOSE%29%20group.JAMA200028320082012" data-title="Meta-analysis%20of%20observational%20studies%20in%20epidemiology%3A%20A%20proposal%20for%20reporting.%20Meta-analysis%20of%20Observational%20Studies%20in%20Epidemiology%20%28MOOSE%29%20group." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Meta-analysis+of+observational+studies+in+epidemiology%3A+A+proposal+for+reporting.+Meta-analysis+of+Observational+Studies+in+Epidemiology+%28MOOSE%29+group.+Stroup+2000" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref23"><span>23.
            </span><a name="pmed-0020124-b23" id="pmed-0020124-b23"></a>Marshall M, Lockwood A, Bradley C, Adams C, Joy C, et al.  (2000) Unpublished rating scales: A major source of bias in randomised controlled trials of treatments for schizophrenia. Br J Psychiatry  176: 249–252.  <ul><li><a href="#" data-author="Marshall" data-cit="MarshallMLockwoodABradleyCAdamsCJoyCUnpublished%20rating%20scales%3A%20A%20major%20source%20of%20bias%20in%20randomised%20controlled%20trials%20of%20treatments%20for%20schizophrenia.Br%20J%20Psychiatry2000176249252" data-title="Unpublished%20rating%20scales%3A%20A%20major%20source%20of%20bias%20in%20randomised%20controlled%20trials%20of%20treatments%20for%20schizophrenia." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Unpublished+rating+scales%3A+A+major+source+of+bias+in+randomised+controlled+trials+of+treatments+for+schizophrenia.+Marshall+2000" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref24"><span>24.
            </span><a name="pmed-0020124-b24" id="pmed-0020124-b24"></a>Altman DG, Goodman SN (1994) Transfer of technology from statistical journals to the biomedical literature. Past trends and future predictions. JAMA  272: 129–132.  <ul><li><a href="#" data-author="Altman" data-cit="AltmanDGGoodmanSNTransfer%20of%20technology%20from%20statistical%20journals%20to%20the%20biomedical%20literature.%20Past%20trends%20and%20future%20predictions.JAMA1994272129132" data-title="Transfer%20of%20technology%20from%20statistical%20journals%20to%20the%20biomedical%20literature.%20Past%20trends%20and%20future%20predictions." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Transfer+of+technology+from+statistical+journals+to+the+biomedical+literature.+Past+trends+and+future+predictions.+Altman+1994" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref25"><span>25.
            </span><a name="pmed-0020124-b25" id="pmed-0020124-b25"></a>Chan AW, Hrobjartsson A, Haahr MT, Gotzsche PC, Altman DG (2004) Empirical evidence for selective reporting of outcomes in randomized trials: Comparison of protocols to published articles. JAMA  291: 2457–2465.  <ul><li><a href="#" data-author="Chan" data-cit="ChanAWHrobjartssonAHaahrMTGotzschePCAltmanDGEmpirical%20evidence%20for%20selective%20reporting%20of%20outcomes%20in%20randomized%20trials%3A%20Comparison%20of%20protocols%20to%20published%20articles.JAMA200429124572465" data-title="Empirical%20evidence%20for%20selective%20reporting%20of%20outcomes%20in%20randomized%20trials%3A%20Comparison%20of%20protocols%20to%20published%20articles." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Empirical+evidence+for+selective+reporting+of+outcomes+in+randomized+trials%3A+Comparison+of+protocols+to+published+articles.+Chan+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref26"><span>26.
            </span><a name="pmed-0020124-b26" id="pmed-0020124-b26"></a>Krimsky S, Rothenberg LS, Stott P, Kyle G (1998) Scientific journals and their authors' financial interests: A pilot study. Psychother Psychosom  67: 194–201.  <ul><li><a href="#" data-author="Krimsky" data-cit="KrimskySRothenbergLSStottPKyleGScientific%20journals%20and%20their%20authors%27%20financial%20interests%3A%20A%20pilot%20study.Psychother%20Psychosom199867194201" data-title="Scientific%20journals%20and%20their%20authors%26apos%3B%20financial%20interests%3A%20A%20pilot%20study." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Scientific+journals+and+their+authors%26apos%3B+financial+interests%3A+A+pilot+study.+Krimsky+1998" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref27"><span>27.
            </span><a name="pmed-0020124-b27" id="pmed-0020124-b27"></a>Papanikolaou GN, Baltogianni MS, Contopoulos-Ioannidis DG, Haidich AB, Giannakakis IA, et al.  (2001) Reporting of conflicts of interest in guidelines of preventive and therapeutic interventions. BMC Med Res Methodol  1: 3.  <ul><li><a href="#" data-author="Papanikolaou" data-cit="PapanikolaouGNBaltogianniMSContopoulos-IoannidisDGHaidichABGiannakakisIAReporting%20of%20conflicts%20of%20interest%20in%20guidelines%20of%20preventive%20and%20therapeutic%20interventions.BMC%20Med%20Res%20Methodol200113" data-title="Reporting%20of%20conflicts%20of%20interest%20in%20guidelines%20of%20preventive%20and%20therapeutic%20interventions." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Reporting+of+conflicts+of+interest+in+guidelines+of+preventive+and+therapeutic+interventions.+Papanikolaou+2001" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref28"><span>28.
            </span><a name="pmed-0020124-b28" id="pmed-0020124-b28"></a>Antman EM, Lau J, Kupelnick B, Mosteller F, Chalmers TC (1992) A comparison of results of meta-analyses of randomized control trials and recommendations of clinical experts. Treatments for myocardial infarction. JAMA  268: 240–248.  <ul><li><a href="#" data-author="Antman" data-cit="AntmanEMLauJKupelnickBMostellerFChalmersTCA%20comparison%20of%20results%20of%20meta-analyses%20of%20randomized%20control%20trials%20and%20recommendations%20of%20clinical%20experts.%20Treatments%20for%20myocardial%20infarction.JAMA1992268240248" data-title="A%20comparison%20of%20results%20of%20meta-analyses%20of%20randomized%20control%20trials%20and%20recommendations%20of%20clinical%20experts.%20Treatments%20for%20myocardial%20infarction." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=A+comparison+of+results+of+meta-analyses+of+randomized+control+trials+and+recommendations+of+clinical+experts.+Treatments+for+myocardial+infarction.+Antman+1992" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref29"><span>29.
            </span><a name="pmed-0020124-b29" id="pmed-0020124-b29"></a>Ioannidis JP, Trikalinos TA (2005) Early extreme contradictory estimates may appear in published research: The Proteus phenomenon in molecular genetics research and randomized trials. J Clin Epidemiol  58: 543–549.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPTrikalinosTAEarly%20extreme%20contradictory%20estimates%20may%20appear%20in%20published%20research%3A%20The%20Proteus%20phenomenon%20in%20molecular%20genetics%20research%20and%20randomized%20trials.J%20Clin%20Epidemiol200558543549" data-title="Early%20extreme%20contradictory%20estimates%20may%20appear%20in%20published%20research%3A%20The%20Proteus%20phenomenon%20in%20molecular%20genetics%20research%20and%20randomized%20trials." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Early+extreme+contradictory+estimates+may+appear+in+published+research%3A+The+Proteus+phenomenon+in+molecular+genetics+research+and+randomized+trials.+Ioannidis+2005" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref30"><span>30.
            </span><a name="pmed-0020124-b30" id="pmed-0020124-b30"></a>Ntzani EE, Ioannidis JP (2003) Predictive ability of DNA microarrays for cancer outcomes and correlates: An empirical assessment. Lancet  362: 1439–1444.  <ul><li><a href="#" data-author="Ntzani" data-cit="NtzaniEEIoannidisJPPredictive%20ability%20of%20DNA%20microarrays%20for%20cancer%20outcomes%20and%20correlates%3A%20An%20empirical%20assessment.Lancet200336214391444" data-title="Predictive%20ability%20of%20DNA%20microarrays%20for%20cancer%20outcomes%20and%20correlates%3A%20An%20empirical%20assessment." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Predictive+ability+of+DNA+microarrays+for+cancer+outcomes+and+correlates%3A+An+empirical+assessment.+Ntzani+2003" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref31"><span>31.
            </span><a name="pmed-0020124-b31" id="pmed-0020124-b31"></a>Ransohoff DF (2004) Rules of evidence for cancer molecular-marker discovery and validation. Nat Rev Cancer  4: 309–314.  <ul><li><a href="#" data-author="Ransohoff" data-cit="RansohoffDFRules%20of%20evidence%20for%20cancer%20molecular-marker%20discovery%20and%20validation.Nat%20Rev%20Cancer20044309314" data-title="Rules%20of%20evidence%20for%20cancer%20molecular-marker%20discovery%20and%20validation." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Rules+of+evidence+for+cancer+molecular-marker+discovery+and+validation.+Ransohoff+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref32"><span>32.
            </span><a name="pmed-0020124-b32" id="pmed-0020124-b32"></a>Lindley DV (1957) A statistical paradox. Biometrika  44: 187–192.  <ul><li><a href="#" data-author="Lindley" data-cit="LindleyDVA%20statistical%20paradox.Biometrika195744187192" data-title="A%20statistical%20paradox." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=A+statistical+paradox.+Lindley+1957" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref33"><span>33.
            </span><a name="pmed-0020124-b33" id="pmed-0020124-b33"></a>Bartlett MS (1957) A comment on D.V. Lindley's statistical paradox. Biometrika  44: 533–534.  <ul><li><a href="#" data-author="Bartlett" data-cit="BartlettMSA%20comment%20on%20D.V.%20Lindley%27s%20statistical%20paradox.Biometrika195744533534" data-title="A%20comment%20on%20D.V.%20Lindley%26apos%3Bs%20statistical%20paradox." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=A+comment+on+D.V.+Lindley%26apos%3Bs+statistical+paradox.+Bartlett+1957" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref34"><span>34.
            </span><a name="pmed-0020124-b34" id="pmed-0020124-b34"></a>Senn SJ (2001) Two cheers for P-values. J Epidemiol Biostat  6: 193–204.  <ul><li><a href="#" data-author="Senn" data-cit="SennSJTwo%20cheers%20for%20P-values.J%20Epidemiol%20Biostat20016193204" data-title="Two%20cheers%20for%20P-values." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Two+cheers+for+P-values.+Senn+2001" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref35"><span>35.
            </span><a name="pmed-0020124-b35" id="pmed-0020124-b35"></a>De Angelis C, Drazen JM, Frizelle FA, Haug C, Hoey J, et al.  (2004) Clinical trial registration: A statement from the International Committee of Medical Journal Editors. N Engl J Med  351: 1250–1251.  <ul><li><a href="#" data-author="De%20Angelis" data-cit="De%20AngelisCDrazenJMFrizelleFAHaugCHoeyJClinical%20trial%20registration%3A%20A%20statement%20from%20the%20International%20Committee%20of%20Medical%20Journal%20Editors.N%20Engl%20J%20Med200435112501251" data-title="Clinical%20trial%20registration%3A%20A%20statement%20from%20the%20International%20Committee%20of%20Medical%20Journal%20Editors." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Clinical+trial+registration%3A+A+statement+from+the+International+Committee+of+Medical+Journal+Editors.+De+Angelis+2004" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref36"><span>36.
            </span><a name="pmed-0020124-b36" id="pmed-0020124-b36"></a>Ioannidis JPA (2005) Contradicted and initially stronger effects in highly cited clinical research. JAMA  294: 218–228.  <ul><li><a href="#" data-author="Ioannidis" data-cit="IoannidisJPAContradicted%20and%20initially%20stronger%20effects%20in%20highly%20cited%20clinical%20research.JAMA2005294218228" data-title="Contradicted%20and%20initially%20stronger%20effects%20in%20highly%20cited%20clinical%20research." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Contradicted+and+initially+stronger+effects+in+highly+cited+clinical+research.+Ioannidis+2005" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li><li id="ref37"><span>37.
            </span><a name="pmed-0020124-b37" id="pmed-0020124-b37"></a>Hsueh HM, Chen JJ, Kodell RL (2003) Comparison of methods for estimating the number of true null hypotheses in multiplicity testing. J Biopharm Stat  13: 675–689.  <ul><li><a href="#" data-author="Hsueh" data-cit="HsuehHMChenJJKodellRLComparison%20of%20methods%20for%20estimating%20the%20number%20of%20true%20null%20hypotheses%20in%20multiplicity%20testing.J%20Biopharm%20Stat200313675689" data-title="Comparison%20of%20methods%20for%20estimating%20the%20number%20of%20true%20null%20hypotheses%20in%20multiplicity%20testing." target="_new" title="Go to article in CrossRef">
                      View Article
                    </a></li><li><a href="http://scholar.google.com/scholar?q=Comparison+of+methods+for+estimating+the+number+of+true+null+hypotheses+in+multiplicity+testing.+Hsueh+2003" target="_new" title="Go to article in Google Scholar">
                      Google Scholar
                    </a></li></ul></li></ol></div>



          

        </div>
      </div>
  
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Google Cache Is Fully Dead (353 pts)]]></title>
            <link>https://www.seroundtable.com/google-cache-dead-38112.html</link>
            <guid>41640845</guid>
            <pubDate>Tue, 24 Sep 2024 20:59:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.seroundtable.com/google-cache-dead-38112.html">https://www.seroundtable.com/google-cache-dead-38112.html</a>, See on <a href="https://news.ycombinator.com/item?id=41640845">Hacker News</a></p>
Couldn't get https://www.seroundtable.com/google-cache-dead-38112.html: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[On Impactful AI Research (232 pts)]]></title>
            <link>https://github.com/okhat/blog/blob/main/2024.09.impact.md</link>
            <guid>41640812</guid>
            <pubDate>Tue, 24 Sep 2024 20:56:29 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/okhat/blog/blob/main/2024.09.impact.md">https://github.com/okhat/blog/blob/main/2024.09.impact.md</a>, See on <a href="https://news.ycombinator.com/item?id=41640812">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true" aria-labelledby="file-name-id-wide file-name-id-mobile"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">On Impactful AI Research</h2><a id="user-content-on-impactful-ai-research" aria-label="Permalink: On Impactful AI Research" href="#on-impactful-ai-research"></a></p>
<p dir="auto">Grad students often reach out to talk about structuring their research, e.g. <strong>how do I do research that makes a difference in the current, rather crowded AI space?</strong> Too many feel that long-term projects, proper code releases, and thoughtful benchmarks are not incentivized — or are perhaps things you do quickly and guiltily to then go back to doing 'real' research.</p>
<p dir="auto">This post distills thoughts on impact I've been sharing with folks who ask. Impact takes many forms, and I will focus only on <strong>making research impact in AI via open-source work</strong> through artifacts like models, systems, frameworks, or benchmarks. Because my goal is partly to refine my own thinking, to document concrete advice, and to gather feedback, I'll make rather terse, non-trivial statements. Please let me know if you disagree; I'll update here if I change my mind.</p>
<p dir="auto"><strong>Here are the guidelines:</strong></p>
<ol dir="auto">
<li><strong><a href="#1-invest-in-projects-not-papers">Invest in projects, not papers.</a></strong></li>
<li><strong><a href="#2-select-timely-problems-with-large-headroom-and-fanout">Select timely problems with large headroom and "fanout".</a></strong></li>
<li><strong><a href="#3-think-two-steps-ahead-and-iterate-fast">Think two steps ahead and iterate fast.</a></strong></li>
<li><strong><a href="#4-put-your-work-out-there-and-own-popularizing-your-ideas">Put your work out there and own popularizing your ideas.</a></strong></li>
<li><strong><a href="#5-funnel-the-excitement-you-build-tips-on-growing-open-source-research">Funnel the excitement you build: Tips on growing open-source research.</a></strong></li>
<li><strong><a href="#6-continue-investing-in-your-projects-via-new-papers">Continue investing in your projects, via new papers.</a></strong></li>
</ol>
<p dir="auto">The fifth bullet "tips on growing open-source research" deserves its own, longer post. I may write that next.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">1. Invest in projects, not papers.</h2><a id="user-content-1-invest-in-projects-not-papers" aria-label="Permalink: 1. Invest in projects, not papers." href="#1-invest-in-projects-not-papers"></a></p>
<p dir="auto">This is a crucial mental shift. Everything else follows from it.</p>
<p dir="auto">Junior students learn to place a lot of value in publishing their first couple of papers. And that's reasonable: it's how you learn to conduct research, explore initial topics, and demonstrate early progress. But this is a stage that you must depart eventually: your fulfillment and growth in the longer term will depend less on paper count and more on your impact and the overarching research story you communicate. Unfortunately, too many PhD students perceive most actions that may create impact as <a href="https://x.com/lateinteraction/status/1813371969720496358" rel="nofollow">'disincentivized'</a>. This perpelexed me until I realized they meant that those actions could slow down your ability to produce the next paper. But your ability to produce the next paper so quickly is just not that important.</p>
<p dir="auto">Instead of thinking of your work as a series of isolated papers, I suggest that you ask yourself: What is the larger vision, the sub-area, or the paradigm you will lead? What difference is your work seeking to make? You will publish individual papers to explore and build support for it, but your bigger vision should be something you iterate on quite intentionally. It needs to be a lot larger than a publication unit and certainly something that you haven't completely solved yet.</p>
<p dir="auto">One way to do this is to structure some of your research papers around a coherent artifact — like a model, system, framework, or benchmark — that you maintain in open source. This <a href="https://x.com/lateinteraction/status/1710134813410402411" rel="nofollow">strategy</a> is more costly than "run some experiments and put out a quick repo that you forget about". But it forces you to find a problem that has the right characteristics for impact and helps ensure that new research you do is actually coherent and useful: you wouldn't introduce hacky features you don't believe are worthwhile to the artifact you have been growing and maintaining.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">2. Select timely problems with large headroom and "fanout".</h2><a id="user-content-2-select-timely-problems-with-large-headroom-and-fanout" aria-label="Permalink: 2. Select timely problems with large headroom and &quot;fanout&quot;." href="#2-select-timely-problems-with-large-headroom-and-fanout"></a></p>
<p dir="auto">Not every paper you write will deserve indefinite investment; many of your papers will be exploratory one-offs. To find a direction that can be turned into a larger project, use the following criteria.</p>
<p dir="auto">First, the problem must be <strong>timely</strong>. You can define this in many ways, but one strategy that works well in AI is to seek a problem space that will be 'hot' in 2-3 years but hasn't nearly become mainstream yet.</p>
<p dir="auto">Second, the problem must have <strong>large "fanout"</strong>, i.e. potential impact on many downstream problems. Basically, these are problems whose outcomes could benefit or interest enough people. Researchers and people care about what helps them achieve their goals, so your problem could be something that helps others build things or achieve research or production goals. You can apply this filter to work on theoretical foundations, systems infrastructure, novel benchmarks, new models, and many others things.</p>
<p dir="auto">Third, the problem must have <strong>large headroom</strong>. If you tell people that their systems could be 1.5x faster or 5% more effective, that's rarely going to beat inertia. In my view, you need to find problems where there's non-zero hope that you'll make things, say, 20x faster or 30% more effective, at least after years of work. Of course, you don't need to get all the way there to succeed, and you should not wait until you've completely made it all the way there to release the first paper or artifact.</p>
<p dir="auto">Not to be too abstract, let me illustrate using <a href="https://github.com/stanford-futuredata/colbert">ColBERT</a>. In late 2019, research applying BERT for retrieval was popular, but the approaches were very expensive. It was natural to ask if we could make this dramatically more efficient. What might make this a good problem? First, it was <strong>timely</strong>. You could correctly expect that, by 2021 (1.5 years later), many researchers will be seeking efficient BERT-based retrieval architectures. Second, it had large <strong>headroom</strong>. New ML paradigms tend to, as most such work ignores efficiency at first. Indeed, the original approaches could take 30 seconds to answer a query, whereas nowadays much higher quality retrieval can be done in 30 milliseconds, 1000x faster. Third, it had large <strong>fanout</strong>. Scalable retrieval is a nice “foundational” problem: everyone needs to build something atop retrievers but few want to build them.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">3. Think two steps ahead and iterate fast.</h2><a id="user-content-3-think-two-steps-ahead-and-iterate-fast" aria-label="Permalink: 3. Think two steps ahead and iterate fast." href="#3-think-two-steps-ahead-and-iterate-fast"></a></p>
<p dir="auto">Now that you have a good problem, resist the urge to pick the immediate low-hanging fruit as your approach! At some point, at least eventually, many others will be thinking about that 'obvious' approach.</p>
<p dir="auto">Instead, think at least two steps ahead. Identify the path most people are likely to take, when this timely problem eventually becomes more mainstream. Then identify the limitations of that path itself, and start working on understanding and tackling <em>those</em> limitations.</p>
<p dir="auto">What might this look like in practice? Let's revisit the ColBERT case study. The obvious way to build efficient retrievers with BERT is to encode documents into a vector. Interestingly, there was only limited IR work that does that by late 2019. For example, the best-cited work in this category (DPR) only had its first preprint released in April 2020. Given this, you might think that the right thing to do in 2019 was to build a great single-vector IR model via BERT. In contrast, thinking just two steps ahead would be to ask: everyone will be building single-vector methods sooner or later, where will this single-vector approach get fundamentally stuck? And indeed, that question led to the <a href="https://x.com/lateinteraction/status/1736804963760976092" rel="nofollow">late interaction</a> paradigm and <a href="https://huggingface.co/colbert-ir/colbertv2.0" rel="nofollow">widely-used models</a>.</p>
<p dir="auto">As another example, we could use <a href="https://github.com/stanfordnlp/dspy">DSPy</a>. In February 2022, as prompting is becoming decently powerful, it was clear that people will want to do retrieval-based QA with prompting, not with fine-tuning like it <a href="https://arxiv.org/abs/2007.00814" rel="nofollow">used to be</a>. A natural thing to do would be to build a method for just that. Thinking two steps ahead would be to ask: where will such approaches get stuck? Ultimately, retrieve-then-generate (or "RAG") approaches are perhaps the simplest possible pipeline involving LMs. For the same reasons people will be interested in it, it was clear that they would increasingly be interested in (i) expressing <a href="https://arxiv.org/abs/2101.00436" rel="nofollow">more complex</a> modular compositions and (ii) figuring out how the resulting sophisticated pipelines should be supervised or optimized, via automated prompting or finetuning of the underlying LMs. That's DSPy.</p>
<p dir="auto">The second half of this guideline is "iterate fast". This was perhaps the very first research advice I received from my advisor Matei Zaharia, in week one of my PhD: by identifying a version of the problem you can iterate quickly on and receive feedback (e.g., latency or validation scores), you greatly impove your chances at solving hard problems. This is especially important if you will be thinking two steps ahead, which is already hard and uncertain enough.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">4. Put your work out there and own popularizing your ideas.</h2><a id="user-content-4-put-your-work-out-there-and-own-popularizing-your-ideas" aria-label="Permalink: 4. Put your work out there and own popularizing your ideas." href="#4-put-your-work-out-there-and-own-popularizing-your-ideas"></a></p>
<p dir="auto">At this point, you’ve identified a good problem and then iterated until you discovered something cool and produced an insightful writeup. Don’t move on to the next paper! Instead, focus on putting your work out there — I mean this with a flavor of vulnerability — and seeking to really engage with people, not just about your one-time paper release but about the big picture you are actively developing. Or, even better, about the useful open-source artifact you're building and maintaining that captures your key ideas.</p>
<p dir="auto">A common first step is to release the paper as a preprint on arXiv and then release a “thread” (or similar) announcing the paper’s release. When you do this, make sure your thread begins with a concrete, substantial, and accessible claim. The goal isn’t to tell people that you released a paper — that doesn't carry inherent value. The goal is to communicate your key argument in a direct and vulnerable but engaging way in the form of a specific statement that people can agree or disagree with. (Yes, I know this is hard but it is necessary.)</p>
<p dir="auto">Perhaps more importantly, this whole process does not end after the first "release". It starts with the release. Given that now you're investing in projects, not just papers, your ideas <em>and your scientific communication</em> persist year-long, well beyond isolated paper releases. Let me illustrate why this matters. When I help grad students “tweet” about their work, it's not uncommon that their initial post doesn’t get as much traction as hoped. Students typically assume this validates their fear of posting about their research and take it as yet another sign that they should just move on to the next paper. Obviously, this is not correct.</p>
<p dir="auto">A lot of personal experience, second-hand experience, and observations suggest that this persistence in this part is massively helpful (and, by the way, exceedingly rare). That is, with few exceptions, traction of good ideas needs you to tell people the key things many times in different contexts — and evolving your thoughts and your communication of your thoughts — either until the community can absorb these ideas over time or until the field evolves to the right stage of development where it's easier to appreciate those ideas.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">5. Funnel the excitement you build: Tips on growing open-source research.</h2><a id="user-content-5-funnel-the-excitement-you-build-tips-on-growing-open-source-research" aria-label="Permalink: 5. Funnel the excitement you build: Tips on growing open-source research." href="#5-funnel-the-excitement-you-build-tips-on-growing-open-source-research"></a></p>
<p dir="auto">While getting people excited about your findings is great, you can often have much greater impact by releasing, contributing to, and growing open-source artifacts that channel your ideas to whatever downstream applications are relevant. This is not easy: uploading code files with a README to GitHub is not enough. A good repository will be the “home” of your project, more so than any of the individual papers you’ll publish.</p>
<p dir="auto">Good open-source research needs two, almost independent qualities to be good. First, it needs to be good research, i.e. novel, timely, well-scoped, accurate, etc. Second, it needs to have clear downstream utility and low friction. This is the important part: people will repeatedly avoid (and other people will repeatedly use!) your OSS artifacts for all the "wrong" reasons, all the time. Just to illustrate, your research may be the objective "state of the art", but people will prioritize a lower-friction alternative nine times out of ten. Reversedly, people will often use your tools for reasons that, to you as a graduate student, miss the point, e.g. because they don't fully utilize of your most innovative components. This is not something to resist; it's something to understand and to build on.</p>
<p dir="auto">Given all of this, here is a list of milestones to observe when working on the open-source side of your research releases.</p>
<p dir="auto"><strong>Milestone 0: Make your release <em>usable</em>!</strong> There’s no point making a code release that no one can execute. Make your release usable to other researchers trying to use your work (as a baseline or similar). These are folks in your area who want to replicate your runs — and maybe hill-climb past them and cite you. These folks will have more patience than other types of users. Despite this, you will observe a dramatic difference in academic impact based on how easy it is to tinker with your code.</p>
<p dir="auto"><strong>Milestone 1: Make your release <em>useful</em>!</strong> Beyond people in your narrow area, you should make sure your release is useful to the (potentially much larger!) audience that wants to actually <em>use</em> your project to build something else. This milestone rarely comes naturally in AI research. You should allocate plenty of time to thinking about the (research, production, etc.) problems people are trying to solve where your artifact can help. If you do this right, a lot of its effects will be reflected in everything from project design to the APIs you expose and the documentation/examples you show.</p>
<p dir="auto"><strong>Milestone 2: Make your release <em>approachable</em>!</strong> This is hard for us, AI researchers, but you should be aware that a useful release, where <em>technically</em> everything is available and explained somewhere, does not equal a release most of your potential users will find approachable enough to invest in learning or trying it. <a href="https://x.com/karpathy/status/1760388761349927356" rel="nofollow">"You need the thing, then you need the ramp"</a> is a great post from Andrej Karpathy about this. Ben Clavie has <a href="https://ben.clavie.eu/posts/answer/#ragatouille-and-the-example-of-colbert" rel="nofollow">written extensively about this too</a>, largely demonstrated by him taking our work on ColBERT and making it what feels like 10x more approachable.</p>
<p dir="auto"><strong>Milestone 3: Build the case for why the obvious alternative fails, and be patient.</strong> We started by talking about thinking two steps ahead. This is crucial in my opinion, but it means that most people won't understand why they need to adopt a solution for problems they can't yet glaringly observe. I think it's part of your job to build that case up over time. Collect evidence and communicate in accessible ways why the obvious alternative (thinking only one step at a time) fails.</p>
<p dir="auto"><strong>Milestone 4: Understand that there are categories of users, and leverage that to grow.</strong> When I started both ColBERT and DSPy, the original audience I sought were researchers and expert ML engineers. I learned over time to let go of that and to understand that you can reach much larger audiences, but that they require different things. Before anything else, stop blocking different potential categories of users indirectly or even directly. This is more common than one may think. Second, when seeking users, seek a balance between two types of users. On the one hand, expert builders with advanced usecases may require substantial investment on your part but will often advance some usecase in a researchy sense, which can be rewarding. On the other hand, <em>public builders</em>, who generally aren't ML experts but often build in public and share their learnings will lead a much larger fraction of any massive growth of funnel/excitement and will teach you a lot about your initial assumptions. You need both.</p>
<p dir="auto"><strong>Milestone 5: Turn interest into a growing community!</strong> The real success of an OSS effort is in the community presence and the growth that happens independently of your efforts. A good community should generally be organic, but you needs to put in active effort at helping it form, e.g. by welcoming contributions and discussions and seeking opportunities for turning interest into contributions or discussion forums of some sort (e.g., Discord or GitHub).</p>
<p dir="auto"><strong>Milestone 6: Turn interest into active, collaborative, and modular downstream projects.</strong> Chances are, your OSS project in its early stages hasn't solved all elements in your vision. A well-designed project will often have multiple modular pieces that can allow you to initiate research collaborations (or other efforts) where new team members can not only advance but <em>own</em> substantial pieces of the project and, as a result, achieve faster or larger impact for their ideas, while improving the project substantially. For example, DSPy currently has <a href="https://github.com/stanfordnlp/dspy/blob/main/docs/docs/roadmap.md#team--organization">separate teams</a> leading the research and development efforts on prompt optimization, programming abstractions, and reinforcement learning. ColBERT has components like the external API, the underlying retrieval infrastructure, and core modeling that have largely been advanced by different people in <a href="https://github.com/stanford-futuredata/ColBERT/blob/main/README.md#you-can-read-more-in-our-papers">different projects</a>.</p>
<p dir="auto">Let me summarize. Open-source research adoption needs good research <em>and</em> good open-source artifacts. This balance is hard but can be quite rewarding once you get it right. Personally, it took me a long time to grasp and internalize this. I owe that to repeated feedback from my PhD advisors Chris Potts and Matei Zaharia and to valuable input from Heather Miller and Jeremy Howard. Research is evaluated by the delta over prior knowledge, but software must be effective on its own before people can meaningfully utilize that "delta". And for software to be effective, its documentation also needs to be so: people won't see all the downstream ways they should use it unless you show them. That is, until such tasks can be developed by an independent community.</p>
<p dir="auto">Having said all of this, the most important tip in this entire section is to release, actually release, release often, and learn from that.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">6. Continue investing in your projects, via new papers.</h2><a id="user-content-6-continue-investing-in-your-projects-via-new-papers" aria-label="Permalink: 6. Continue investing in your projects, via new papers." href="#6-continue-investing-in-your-projects-via-new-papers"></a></p>
<p dir="auto">When you read the previous guideline (#5), it's very natural to wonder: Where might a graduate student find all this time to spend on OSS? When can they do actual research?</p>
<p dir="auto">The answer in practice is that it's possible for most of the time you spend on OSS to involve doing new, exciting research. The two are not as separate as they may look. In fact, a major advantage of the style of research in this guide is that it creates <em>recognizably important problems</em> in which you have a very large competitive advantage. How so? For one, being at the frontier of this OSS effort gives you intuitive recognition of new problems extremely early. You develop a more instinctive understanding of the problem than you would have otherwise. For another, the communities you build will often provide direct feedback on prototypes of your approaches and give you access to wonderful collaborators who understand the significance of the problems. You also get useful "distribution channels" that ensure that every new paper you do in this space will have a receptive audience and will reinforce your existing platform.</p>
<p dir="auto">Just to illustrate, ColBERT isn't just <a href="https://arxiv.org/abs/2004.12832" rel="nofollow">one paper</a> from early 2020. It's probably around ten papers now, with investments into improved training, lower memory footprint, faster retrieval infrastructure, better domain adaptation, and better alignment with downstream NLP tasks. Similarly, DSPy isn't one paper but is a large collection of papers on programming abstractions, prompt optimization, and downstream programs. So many of these papers are written by <a href="https://github.com/stanfordnlp/dspy?tab=readme-ov-file#dspy-programmingnot-promptingfoundation-models">different, amazing primary authors</a>, whose work has individually been highly impactful, in part through the OSS channels that creates a receptive audience. A good open-source artifact creates modular pieces that can be explored, owned, and grown by new researchers and contributors.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Caroline Ellison sentenced to 2 years in prison (172 pts)]]></title>
            <link>https://www.nytimes.com/2024/09/24/technology/caroline-ellison-ftx-sentence.html</link>
            <guid>41640789</guid>
            <pubDate>Tue, 24 Sep 2024 20:53:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nytimes.com/2024/09/24/technology/caroline-ellison-ftx-sentence.html">https://www.nytimes.com/2024/09/24/technology/caroline-ellison-ftx-sentence.html</a>, See on <a href="https://news.ycombinator.com/item?id=41640789">Hacker News</a></p>
Couldn't get https://www.nytimes.com/2024/09/24/technology/caroline-ellison-ftx-sentence.html: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Beyond the route: Introducing granular MTA bus speed data (204 pts)]]></title>
            <link>https://new.mta.info/article/beyond-route-introducing-granular-mta-bus-speed-data</link>
            <guid>41640005</guid>
            <pubDate>Tue, 24 Sep 2024 19:26:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://new.mta.info/article/beyond-route-introducing-granular-mta-bus-speed-data">https://new.mta.info/article/beyond-route-introducing-granular-mta-bus-speed-data</a>, See on <a href="https://news.ycombinator.com/item?id=41640005">Hacker News</a></p>
Couldn't get https://new.mta.info/article/beyond-route-introducing-granular-mta-bus-speed-data: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[DOJ accuses Visa of debit network monopoly, impacts price of 'nearly everything' (505 pts)]]></title>
            <link>https://www.cnbc.com/2024/09/24/doj-accuses-visa-of-debit-network-monopoly-that-impacts-price-of-nearly-everything.html</link>
            <guid>41639635</guid>
            <pubDate>Tue, 24 Sep 2024 18:42:08 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.cnbc.com/2024/09/24/doj-accuses-visa-of-debit-network-monopoly-that-impacts-price-of-nearly-everything.html">https://www.cnbc.com/2024/09/24/doj-accuses-visa-of-debit-network-monopoly-that-impacts-price-of-nearly-everything.html</a>, See on <a href="https://news.ycombinator.com/item?id=41639635">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="RegularArticle-ArticleBody-5" data-module="ArticleBody" data-test="articleBody-2" data-analytics="RegularArticle-articleBody-5-2"><div id="ArticleBody-InlineImage-108038472" data-test="InlineImage"><p>Justin Sullivan | etty Images</p></div><div><p>The U.S. <a href="https://www.justice.gov/" target="_blank">Justice Department</a> on Tuesday sued <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-2"><a href="https://www.cnbc.com/quotes/V/">Visa</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span>, the world's biggest payments network, saying it propped up an illegal monopoly over debit payments by imposing "exclusionary" agreements on partners and smothering upstart firms.</p><p>Visa's moves over the years have resulted in American consumers and merchants paying billions of dollars in additional fees, according to the DOJ, which filed a civil antitrust suit in New York for "monopolization" and other unlawful conduct.</p><p>"We allege that Visa has unlawfully amassed the power to extract fees that far exceed what it could charge in a competitive market," Attorney General <a href="https://www.cnbc.com/2021/03/10/merrick-garland-confirmed-as-us-attorney-general-by-senate.html">Merrick Garland</a> said in a DOJ release.</p><p>"Merchants and banks pass along those costs to consumers, either by raising prices or reducing quality or service," Garland said. "As a result, Visa's unlawful conduct affects not just the price of one thing – but the price of nearly everything."</p><p>Visa and its smaller rival <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-4"><a href="https://www.cnbc.com/quotes/MA/">MasterCard</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> have surged in the past two decades, reaching a combined market cap of roughly $1 trillion, as consumers tapped credit and debit cards for store purchases and e-commerce instead of paper money. They are essentially toll collectors, shuffling payments between the merchants' banks and cardholders.</p><p>More than 60% of debit transactions in the U.S. run over Visa rails, helping it charge more than $7 billion annually in processing fees, according to the DOJ complaint.</p><p>But the payment networks' dominance has increasingly attracted attention from regulators and retailers.</p><p>In 2020, the DOJ filed an <a href="https://www.cnbc.com/2020/11/05/doj-files-antitrust-lawsuit-to-block-visas-plaid-acquisition-.html">antitrust suit</a> to block Visa from acquiring fintech company Plaid; the companies initially said they would fight the action, but soon abandoned the $5.3 billion takeover.</p><p>In March, Visa and Mastercard agreed to <a href="https://www.cnbc.com/2024/03/26/mastercard-visa-reach-30-billion-settlement-over-credit-card-fees-.html">limit their fees</a> and let merchants charge customers for using credit cards, a deal retailers said was worth $30 billion in savings over a half decade. A federal judge later <a href="https://www.bloomberg.com/news/articles/2024-06-29/visa-mastercard-could-handle-bigger-swipe-fee-deal-judge-says" target="_blank">rejected</a> the settlement, saying the networks could afford to pay for a "substantially greater" deal. </p><p><strong>"</strong>Visa wields its dominance, enormous scale, and centrality to the debit ecosystem to impose a web of exclusionary agreements on merchants and banks," the DOJ said in its release. "These agreements penalize Visa's customers who route transactions to a different debit network or alternative payment system."</p><p>Furthermore, when faced with threats, Visa "engaged in a deliberate and reinforcing course of conduct to cut off competition and prevent rivals from gaining the scale, share, and data necessary to compete," the DOJ said.</p><p>The move comes in the waning months of President <a href="https://www.cnbc.com/joe-biden/">Joe Biden</a>'s administration, in which regulators including the&nbsp;Federal Trade Commission and the Consumer Financial Protection Bureau have sued middlemen for <a href="https://www.cnbc.com/2024/09/20/ftc-sues-drug-middlemen-for-allegedly-inflating-insulin-prices.html">drug prices</a> and pushed back against so-called <a href="https://www.cnbc.com/2024/03/05/cfpb-rule-caps-credit-card-late-fees-at-8.html">junk fees</a>.</p><p>In February, credit card lender Capital One <a href="https://www.cnbc.com/2024/02/21/why-capital-one-is-buying-discover-in-the-biggest-merger-yet-of-2024.html#:~:text=Post%20%7C%20Getty%20Images-,Capital%20One's%20recently%20announced%20%2435.3%20billion%20acquisition%20of%20Discover%20Financial,of%20fintech%20and%20regulatory%20threats.">announced</a> its acquisition of <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-12"><a href="https://www.cnbc.com/quotes/DFS/">Discover Financial</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span>, a $35.3 billion deal predicated in part on Capital One's ability to bolster Discover's also-ran payments network, a distant No. 4 behind Visa, MasterCard and <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-13"><a href="https://www.cnbc.com/quotes/AXP/">American Express</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span>.</p><p>Capital One said that once the deal is closed, it will switch all its debit card volume and a growing share of credit card volume to Discover over time, making it a more viable competitor to Visa and Mastercard. <br></p><p>&nbsp;<em><strong>This story is developing. Please check back for updates.</strong></em></p></div></div></div>]]></description>
        </item>
    </channel>
</rss>