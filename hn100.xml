<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Wed, 07 Feb 2024 00:00:08 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[SQL for data scientists in 100 queries (183 pts)]]></title>
            <link>https://gvwilson.github.io/sql-tutorial/</link>
            <guid>39281178</guid>
            <pubDate>Tue, 06 Feb 2024 21:50:26 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://gvwilson.github.io/sql-tutorial/">https://gvwilson.github.io/sql-tutorial/</a>, See on <a href="https://news.ycombinator.com/item?id=39281178">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
      
      
<!-- 0 -->

<section>

  <h2 id="what-this-is">☆ what this is</h2>

  <ul>
    <li>notes and working examples that instructors can use to perform a lesson
      <ul>
        <li>do <em>not</em> expect novices with no prior SQL experience to be able to learn from them</li>
      </ul>
    </li>
    <li>musical analogy
      <ul>
        <li>this is the chord changes and melody</li>
        <li>we expect instructors to create an arrangement and/or improvise while delivering</li>
        <li>see <a href="https://teachtogether.tech/"><em>Teaching Tech Together</em></a> for background</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="scope">☆ scope</h2>

  <ul>
    <li><a href="http://teachtogether.tech/en/index.html#s:process-personas">intended audience</a>
      <ul>
        <li>Rachel has a master’s degree in cell biology
and now works in a research hospital doing cell assays.</li>
        <li>She learned a bit of R in an undergrad biostatistics course
and has been through <a href="https://swcarpentry.github.io/shell-novice/">the Carpentries lesson on the Unix shell</a>.</li>
        <li>Rachel is thinking about becoming a data scientist
and would like to understand how data is stored and managed.</li>
        <li>Her work schedule is unpredictable and highly variable,
so she needs to be able to learn a bit at a time.</li>
      </ul>
    </li>
    <li>prerequisites
      <ul>
        <li>basic Unix command line: <code>cd</code>, <code>ls</code>, <code>*</code> wildcard</li>
        <li>basic tabular data analysis: filtering rows, aggregating within groups</li>
      </ul>
    </li>
    <li>learning outcomes
      <ol>
        <li>Explain the difference between a database and a database manager.</li>
        <li>Write SQL to select, filter, sort, group, and aggregate data.</li>
        <li>Define tables and insert, update, and delete records.</li>
        <li>Describe different types of join and write queries that use them to combine data.</li>
        <li>Use windowing functions to operate on adjacent rows.</li>
        <li>Explain what transactions are and write queries that roll back when constraints are violated.</li>
        <li>Explain what triggers are and write SQL to create them.</li>
        <li>Manipulate JSON data using SQL.</li>
        <li>Interact with a database using Python directly, from a Jupyter notebook, and via an ORM.</li>
      </ol>
    </li>
  </ul>

</section>
<section>

  <h2 id="setup">☆ setup</h2>

  <ul>
    <li>Download <a href="https://github.com/gvwilson/sql-tutorial/raw/main/sql-tutorial.zip">the latest release</a></li>
    <li>Unzip the file in a temporary directory to create:
      <ul>
        <li><code>./db/*.db</code>: the SQLite databases used in the examples</li>
        <li><code>./src/*.*</code>: SQL queries, Python scripts, and other source code</li>
        <li><code>./out/*.*</code>: expected output for examples</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="background-concepts">☆ background concepts</h2>

  <ul>
    <li>A <a href="#g:database">database</a> is a collection of data that can be searched and retrieved</li>
    <li>A <a href="#g:dbms">database management system</a> (DBMS) is a program that manages a particular kind of database</li>
    <li>Each DBMS stores data in its own way
      <ul>
        <li><a href="https://sqlite.org/">SQLite</a> stores each database in a single file</li>
        <li><a href="https://www.postgresql.org/">PostgreSQL</a> spreads information across many files for higher performance</li>
      </ul>
    </li>
    <li>DBMS can be a library embedded in other programs (<a href="https://sqlite.org/">SQLite</a>) or a server (<a href="https://www.postgresql.org/">PostgreSQL</a>)</li>
    <li>A <a href="#g:rdbms">relational database management system</a> (RDBMS) stores data in tables and uses <a href="https://en.wikipedia.org/wiki/SQL">SQL</a> for queries
      <ul>
        <li>Unfortunately, every RDBMS has its own dialect of SQL</li>
      </ul>
    </li>
    <li>There are also <a href="#g:nosql">NoSQL databases</a> like <a href="https://www.mongodb.com/">MongoDB</a> that don’t use tables</li>
  </ul>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/concept_map_overview.svg" alt="concept map: overview"></p>

</section>
<section>

  <h2 id="connect-to-database">☆ connect to database</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/connect_penguins.sh">src/connect_penguins.sh</a></p>
  

  <ul>
    <li>Not actually a query</li>
    <li>But we have to do it before we can do anything else</li>
  </ul>

</section>
<section>

  <h2 id="select-constant">1: select constant</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/select_1.sql">src/select_1.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/select_1.out">out/select_1.out</a></p>
  

  <ul>
    <li><code>select</code> is a keyword</li>
    <li>Normally used to select data from table…</li>
    <li>…but if all we want is a constant value, we don’t need to specify one</li>
    <li>Semi-colon terminator is required</li>
  </ul>

</section>
<section>

  <h2 id="select-all-values-from-table">2: select all values from table</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/select_star.sql">src/select_star.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span> <span>from</span> <span>little_penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/select_star.out">out/select_star.out</a></p>
  <div><pre><code>Adelie|Dream|37.2|18.1|178|3900|MALE
Adelie|Dream|37.6|19.3|181|3300|FEMALE
Gentoo|Biscoe|50|15.3|220|5550|MALE
Adelie|Torgersen|37.3|20.5|199|3775|MALE
Adelie|Biscoe|39.6|17.7|186|3500|FEMALE
Gentoo|Biscoe|47.7|15|216|4750|FEMALE
Adelie|Dream|36.5|18|182|3150|FEMALE
Gentoo|Biscoe|42|13.5|210|4150|FEMALE
Adelie|Torgersen|42.1|19.1|195|4000|MALE
Gentoo|Biscoe|54.3|15.7|231|5650|MALE
</code></pre></div>

  <ul>
    <li>An actual <a href="#g:query">query</a></li>
    <li>Use <code>*</code> to mean “all columns”</li>
    <li>Use <code>from <em>tablename</em></code> to specify table</li>
    <li>Output format is not particularly readable</li>
  </ul>

</section>
<section>

  <h2 id="administrative-commands">☆ administrative commands</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/admin_commands.sql">src/admin_commands.sql</a></p>
  <div><pre><code><span>.</span><span>headers</span> <span>on</span>
<span>.</span><span>mode</span> <span>markdown</span>
<span>select</span> <span>*</span> <span>from</span> <span>little_penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/admin_commands.out">out/admin_commands.out</a></p>
  <div><pre><code>| species |  island   | bill_length_mm | bill_depth_mm | flipper_length_mm | body_mass_g |  sex   |
|---------|-----------|----------------|---------------|-------------------|-------------|--------|
| Adelie  | Dream     | 37.2           | 18.1          | 178               | 3900        | MALE   |
| Adelie  | Dream     | 37.6           | 19.3          | 181               | 3300        | FEMALE |
| Gentoo  | Biscoe    | 50             | 15.3          | 220               | 5550        | MALE   |
| Adelie  | Torgersen | 37.3           | 20.5          | 199               | 3775        | MALE   |
| Adelie  | Biscoe    | 39.6           | 17.7          | 186               | 3500        | FEMALE |
| Gentoo  | Biscoe    | 47.7           | 15            | 216               | 4750        | FEMALE |
| Adelie  | Dream     | 36.5           | 18            | 182               | 3150        | FEMALE |
| Gentoo  | Biscoe    | 42             | 13.5          | 210               | 4150        | FEMALE |
| Adelie  | Torgersen | 42.1           | 19.1          | 195               | 4000        | MALE   |
| Gentoo  | Biscoe    | 54.3           | 15.7          | 231               | 5650        | MALE   |
</code></pre></div>

  <ul>
    <li>SQLite administrative commands start with <code>.</code> and <em>aren’t</em> part of the SQL standard
      <ul>
        <li>PostgreSQL’s special commands start with <code>\</code></li>
      </ul>
    </li>
    <li>Use <code>.help</code> for a complete list</li>
  </ul>

</section>
<section>

  <h2 id="specify-columns">3: specify columns</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/specify_columns.sql">src/specify_columns.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>island</span><span>,</span> <span>sex</span>
<span>from</span> <span>little_penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/specify_columns.out">out/specify_columns.out</a></p>
  <div><pre><code>| species |  island   |  sex   |
|---------|-----------|--------|
| Adelie  | Dream     | MALE   |
| Adelie  | Dream     | FEMALE |
| Gentoo  | Biscoe    | MALE   |
| Adelie  | Torgersen | MALE   |
| Adelie  | Biscoe    | FEMALE |
| Gentoo  | Biscoe    | FEMALE |
| Adelie  | Dream     | FEMALE |
| Gentoo  | Biscoe    | FEMALE |
| Adelie  | Torgersen | MALE   |
| Gentoo  | Biscoe    | MALE   |
</code></pre></div>

  <ul>
    <li>Specify column names separated by commas
      <ul>
        <li>In any order</li>
        <li>Duplicates allowed</li>
      </ul>
    </li>
    <li>Line breaks <strike>allowed</strike> encouraged for readability</li>
  </ul>

</section>
<section>

  <h2 id="sort">4: sort</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/sort.sql">src/sort.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>little_penguins</span>
<span>order</span> <span>by</span> <span>island</span> <span>asc</span><span>,</span> <span>sex</span> <span>desc</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/sort.out">out/sort.out</a></p>
  <div><pre><code>| species |  sex   |  island   |
|---------|--------|-----------|
| Gentoo  | MALE   | Biscoe    |
| Gentoo  | MALE   | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Gentoo  | FEMALE | Biscoe    |
| Gentoo  | FEMALE | Biscoe    |
| Adelie  | MALE   | Dream     |
| Adelie  | FEMALE | Dream     |
| Adelie  | FEMALE | Dream     |
| Adelie  | MALE   | Torgersen |
| Adelie  | MALE   | Torgersen |
</code></pre></div>

  <ul>
    <li><code>order by</code> must follow <code>from</code> (which must follow <code>select</code>)</li>
    <li><code>asc</code> is ascending, <code>desc</code> is descending
      <ul>
        <li>Default is ascending, but please specify</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="limit-output">5: limit output</h2>

  <ul>
    <li>Full dataset has 344 rows</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/limit.sql">src/limit.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>order</span> <span>by</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>limit</span> <span>10</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/limit.out">out/limit.out</a></p>
  <div><pre><code>| species |  sex   |  island   |
|---------|--------|-----------|
| Adelie  |        | Dream     |
| Adelie  |        | Torgersen |
| Adelie  |        | Torgersen |
| Adelie  |        | Torgersen |
| Adelie  |        | Torgersen |
| Adelie  |        | Torgersen |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
</code></pre></div>

  <ul>
    <li>Comments start with <code>--</code> and run to the end of the line</li>
    <li><code>limit <em>N</em></code> specifies maximum number of rows returned by query</li>
  </ul>

</section>
<section>

  <h2 id="page-output">6: page output</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/page.sql">src/page.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>order</span> <span>by</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>limit</span> <span>10</span> <span>offset</span> <span>3</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/page.out">out/page.out</a></p>
  <div><pre><code>| species |  sex   |  island   |
|---------|--------|-----------|
| Adelie  |        | Torgersen |
| Adelie  |        | Torgersen |
| Adelie  |        | Torgersen |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
| Adelie  | FEMALE | Biscoe    |
</code></pre></div>

  <ul>
    <li><code>offset <em>N</em></code> must follow <code>limit</code></li>
    <li>Specifies number of rows to skip from the start of the selection</li>
    <li>So this query skips the first 3 and shows the next 10</li>
  </ul>

</section>
<section>

  <h2 id="remove-duplicates">7: remove duplicates</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/distinct.sql">src/distinct.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/distinct.out">out/distinct.out</a></p>
  <div><pre><code>|  species  |  sex   |  island   |
|-----------|--------|-----------|
| Adelie    | MALE   | Torgersen |
| Adelie    | FEMALE | Torgersen |
| Adelie    |        | Torgersen |
| Adelie    | FEMALE | Biscoe    |
| Adelie    | MALE   | Biscoe    |
| Adelie    | FEMALE | Dream     |
| Adelie    | MALE   | Dream     |
| Adelie    |        | Dream     |
| Chinstrap | FEMALE | Dream     |
| Chinstrap | MALE   | Dream     |
| Gentoo    | FEMALE | Biscoe    |
| Gentoo    | MALE   | Biscoe    |
| Gentoo    |        | Biscoe    |
</code></pre></div>

  <ul>
    <li><code>distinct</code> keyword must appear right after <code>select</code>
      <ul>
        <li>SQL was supposed to read like English</li>
      </ul>
    </li>
    <li>Shows distinct combinations</li>
    <li>Blanks in <code>sex</code> column show missing data
      <ul>
        <li>We’ll talk about this in a bit</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="filter-results">8: filter results</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/filter.sql">src/filter.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>island</span> <span>=</span> <span>'Biscoe'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/filter.out">out/filter.out</a></p>
  <div><pre><code>| species |  sex   | island |
|---------|--------|--------|
| Adelie  | FEMALE | Biscoe |
| Adelie  | MALE   | Biscoe |
| Gentoo  | FEMALE | Biscoe |
| Gentoo  | MALE   | Biscoe |
| Gentoo  |        | Biscoe |
</code></pre></div>

  <ul>
    <li><code>where <em>condition</em></code> <a href="#g:filter">filters</a> the rows produced by selection</li>
    <li>Condition is evaluated independently for each row</li>
    <li>Only rows that pass the test appear in results</li>
    <li>Use single quotes for <code>'text data'</code> and double quotes for <code>"weird column names"</code>
      <ul>
        <li>SQLite will accept double-quoted text data</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="filter-with-more-complex-conditions">9: filter with more complex conditions</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/filter_and.sql">src/filter_and.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>island</span> <span>=</span> <span>'Biscoe'</span> <span>and</span> <span>sex</span> <span>!=</span> <span>'MALE'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/filter_and.out">out/filter_and.out</a></p>
  <div><pre><code>| species |  sex   | island |
|---------|--------|--------|
| Adelie  | FEMALE | Biscoe |
| Gentoo  | FEMALE | Biscoe |
</code></pre></div>

  <ul>
    <li><code>and</code>: both sub-conditions must be true</li>
    <li><code>or</code>: either or both part must be true</li>
    <li>Notice that the row for Gentoo penguins on Biscoe island with unknown (empty) sex didn’t pass the test
      <ul>
        <li>We’ll talk about this in a bit</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="do-calculations">10: do calculations</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/calculations.sql">src/calculations.sql</a></p>
  <div><pre><code><span>select</span>
    <span>flipper_length_mm</span> <span>/</span> <span>10</span><span>.</span><span>0</span><span>,</span>
    <span>body_mass_g</span> <span>/</span> <span>1000</span><span>.</span><span>0</span>
<span>from</span> <span>penguins</span>
<span>limit</span> <span>3</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/calculations.out">out/calculations.out</a></p>
  <div><pre><code>| flipper_length_mm / 10.0 | body_mass_g / 1000.0 |
|--------------------------|----------------------|
| 18.1                     | 3.75                 |
| 18.6                     | 3.8                  |
| 19.5                     | 3.25                 |
</code></pre></div>

  <ul>
    <li>Can do the usual kinds of arithmetic on individual values
      <ul>
        <li>Calculation done for each row independently</li>
      </ul>
    </li>
    <li>Column name shows the calculation done</li>
  </ul>

</section>
<section>

  <h2 id="rename-columns">11: rename columns</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/rename_columns.sql">src/rename_columns.sql</a></p>
  <div><pre><code><span>select</span>
    <span>flipper_length_mm</span> <span>/</span> <span>10</span><span>.</span><span>0</span> <span>as</span> <span>flipper_cm</span><span>,</span>
    <span>body_mass_g</span> <span>/</span> <span>1000</span><span>.</span><span>0</span> <span>as</span> <span>weight_kg</span><span>,</span>
    <span>island</span> <span>as</span> <span>where_found</span>
<span>from</span> <span>penguins</span>
<span>limit</span> <span>3</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/rename_columns.out">out/rename_columns.out</a></p>
  <div><pre><code>| flipper_cm | weight_kg | where_found |
|------------|-----------|-------------|
| 18.1       | 3.75      | Torgersen   |
| 18.6       | 3.8       | Torgersen   |
| 19.5       | 3.25      | Torgersen   |
</code></pre></div>

  <ul>
    <li>Use <code><em>expression</em> as <em>name</em></code> to rename</li>
    <li>Give result of calculation a meaningful name</li>
    <li>Can also rename columns without modifying</li>
  </ul>

</section>
<section>

  <h2 id="check-your-understanding">☆ check your understanding</h2>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/concept_map_select.svg" alt="concept map: selection"></p>

</section>
<section>

  <h2 id="calculate-with-missing-values">12: calculate with missing values</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/show_missing_values.sql">src/show_missing_values.sql</a></p>
  <div><pre><code><span>select</span>
    <span>flipper_length_mm</span> <span>/</span> <span>10</span><span>.</span><span>0</span> <span>as</span> <span>flipper_cm</span><span>,</span>
    <span>body_mass_g</span> <span>/</span> <span>1000</span><span>.</span><span>0</span> <span>as</span> <span>weight_kg</span><span>,</span>
    <span>island</span> <span>as</span> <span>where_found</span>
<span>from</span> <span>penguins</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/show_missing_values.out">out/show_missing_values.out</a></p>
  <div><pre><code>| flipper_cm | weight_kg | where_found |
|------------|-----------|-------------|
| 18.1       | 3.75      | Torgersen   |
| 18.6       | 3.8       | Torgersen   |
| 19.5       | 3.25      | Torgersen   |
|            |           | Torgersen   |
| 19.3       | 3.45      | Torgersen   |
</code></pre></div>

  <ul>
    <li>SQL uses a special value <a href="#g:null"><code>null</code></a> to representing missing data
      <ul>
        <li>Not 0 or empty string, but “I don’t know”</li>
      </ul>
    </li>
    <li>Flipper length and body weight not known for one of the first five penguins</li>
    <li>“I don’t know” divided by 10 or 1000 is “I don’t know”</li>
  </ul>

</section>
<section>

  <h2 id="null-equality">13: null equality</h2>

  <ul>
    <li>Repeated from above so it doesn’t count against our query limit</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/filter.sql">src/filter.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>island</span> <span>=</span> <span>'Biscoe'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/filter.out">out/filter.out</a></p>
  <div><pre><code>| species |  sex   | island |
|---------|--------|--------|
| Adelie  | FEMALE | Biscoe |
| Adelie  | MALE   | Biscoe |
| Gentoo  | FEMALE | Biscoe |
| Gentoo  | MALE   | Biscoe |
| Gentoo  |        | Biscoe |
</code></pre></div>

  <ul>
    <li>If we ask for female penguins the row with the missing sex drops out</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/null_equality.sql">src/null_equality.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>island</span> <span>=</span> <span>'Biscoe'</span> <span>and</span> <span>sex</span> <span>=</span> <span>'FEMALE'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/null_equality.out">out/null_equality.out</a></p>
  <div><pre><code>| species |  sex   | island |
|---------|--------|--------|
| Adelie  | FEMALE | Biscoe |
| Gentoo  | FEMALE | Biscoe |
</code></pre></div>

</section>
<section>

  <h2 id="null-inequality">14: null inequality</h2>

  <ul>
    <li>But if we ask for penguins that <em>aren’t</em> female it drops out as well</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/null_inequality.sql">src/null_inequality.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>island</span> <span>=</span> <span>'Biscoe'</span> <span>and</span> <span>sex</span> <span>!=</span> <span>'FEMALE'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/null_inequality.out">out/null_inequality.out</a></p>
  <div><pre><code>| species | sex  | island |
|---------|------|--------|
| Adelie  | MALE | Biscoe |
| Gentoo  | MALE | Biscoe |
</code></pre></div>

</section>
<section>

  <h2 id="ternary-logic">15: ternary logic</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/ternary_logic.sql">src/ternary_logic.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/ternary_logic.out">out/ternary_logic.out</a></p>
  <div><pre><code>| null = null |
|-------------|
|             |
</code></pre></div>

  <ul>
    <li>If we don’t know the left and right values, we don’t know if they’re equal or not</li>
    <li>So the result is <code>null</code></li>
    <li>Get the same answer for <code>null != null</code></li>
    <li><a href="#g:ternary_logic">Ternary logic</a></li>
  </ul>

  <table>
  <tbody><tr>
    <th colspan="4">equality</th>
  </tr>
  <tr>
    <th></th>
    <th>X</th>
    <th>Y</th>
    <th>null</th>
  </tr>
  <tr>
    <th>X</th>
    <td>true</td>
    <td>false</td>
    <td>null</td>
  </tr>
  <tr>
    <th>Y</th>
    <td>false</td>
    <td>true</td>
    <td>null</td>
  </tr>
  <tr>
    <th>null</th>
    <td>null</td>
    <td>null</td>
    <td>null</td>
  </tr>
</tbody></table>

</section>
<section>

  <h2 id="handle-null-safely">16: handle null safely</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/safe_null_equality.sql">src/safe_null_equality.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>sex</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>sex</span> <span>is</span> <span>null</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/safe_null_equality.out">out/safe_null_equality.out</a></p>
  <div><pre><code>| species | sex |  island   |
|---------|-----|-----------|
| Adelie  |     | Torgersen |
| Adelie  |     | Torgersen |
| Adelie  |     | Torgersen |
| Adelie  |     | Torgersen |
| Adelie  |     | Torgersen |
| Adelie  |     | Dream     |
| Gentoo  |     | Biscoe    |
| Gentoo  |     | Biscoe    |
| Gentoo  |     | Biscoe    |
| Gentoo  |     | Biscoe    |
| Gentoo  |     | Biscoe    |
</code></pre></div>

  <ul>
    <li>Use <code>is null</code> and <code>is not null</code> to handle null safely</li>
    <li>Other parts of SQL handle nulls specially</li>
  </ul>

</section>
<section>

  <h2 id="check-your-understanding-1">☆ check your understanding</h2>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/concept_map_null.svg" alt="concept map: null"></p>

</section>
<section>

  <h2 id="aggregate">17: aggregate</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/simple_sum.sql">src/simple_sum.sql</a></p>
  <div><pre><code><span>select</span> <span>sum</span><span>(</span><span>body_mass_g</span><span>)</span> <span>as</span> <span>total_mass</span>
<span>from</span> <span>penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/simple_sum.out">out/simple_sum.out</a></p>
  <div><pre><code>| total_mass |
|------------|
| 1437000    |
</code></pre></div>

  <ul>
    <li><a href="#g:aggregation">Aggregation</a> combines many values to produce one</li>
    <li><code>sum</code> is an <a href="#g:aggregation_func">aggregation function</a></li>
    <li>Combines corresponding values from multiple rows</li>
  </ul>

</section>
<section>

  <h2 id="common-aggregation-functions">18: common aggregation functions</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/common_aggregations.sql">src/common_aggregations.sql</a></p>
  <div><pre><code><span>select</span>
    <span>max</span><span>(</span><span>bill_length_mm</span><span>)</span> <span>as</span> <span>longest_bill</span><span>,</span>
    <span>min</span><span>(</span><span>flipper_length_mm</span><span>)</span> <span>as</span> <span>shortest_flipper</span><span>,</span>
    <span>avg</span><span>(</span><span>bill_length_mm</span><span>)</span> <span>/</span> <span>avg</span><span>(</span><span>bill_depth_mm</span><span>)</span> <span>as</span> <span>weird_ratio</span>
<span>from</span> <span>penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/common_aggregations.out">out/common_aggregations.out</a></p>
  <div><pre><code>| longest_bill | shortest_flipper |   weird_ratio    |
|--------------|------------------|------------------|
| 59.6         | 172              | 2.56087082530644 |
</code></pre></div>

  <ul>
    <li>This actually shouldn’t work:
can’t calculate maximum or average if any values are null</li>
    <li>SQL does the useful thing instead of the right one</li>
  </ul>

</section>
<section>

  <h2 id="counting">19: counting</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/count_behavior.sql">src/count_behavior.sql</a></p>
  <div><pre><code><span>select</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>count_star</span><span>,</span> <span>count</span><span>(</span><span>sex</span><span>)</span> <span>as</span> <span>count_specific</span>
<span>from</span> <span>penguins</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/count_behavior.out">out/count_behavior.out</a></p>
  <div><pre><code>| count_star | count_specific |
|------------|----------------|
| 344        | 333            |
</code></pre></div>

  <ul>
    <li><code>count(*)</code> counts rows</li>
    <li><code>count(<em>column</em>)</code> counts non-null entries in column</li>
  </ul>

</section>
<section>

  <h2 id="group">20: group</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/simple_group.sql">src/simple_group.sql</a></p>
  <div><pre><code><span>select</span>
    <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span> <span>as</span> <span>average_mass_g</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>sex</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/simple_group.out">out/simple_group.out</a></p>
  <div><pre><code>|  average_mass_g  |
|------------------|
| 4005.55555555556 |
| 3862.27272727273 |
| 4545.68452380952 |
</code></pre></div>

  <ul>
    <li>Put rows in <a href="#g:group">groups</a> based on distinct combinations of values in columns specified with <code>group by</code></li>
    <li>Then perform aggregation separately for each group</li>
    <li>But which is which?</li>
  </ul>

</section>
<section>

  <h2 id="behavior-of-unaggregated-columns">21: behavior of unaggregated columns</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/unaggregated_columns.sql">src/unaggregated_columns.sql</a></p>
  <div><pre><code><span>select</span>
    <span>sex</span><span>,</span>
    <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span> <span>as</span> <span>average_mass_g</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>sex</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/unaggregated_columns.out">out/unaggregated_columns.out</a></p>
  <div><pre><code>|  sex   |  average_mass_g  |
|--------|------------------|
|        | 4005.55555555556 |
| FEMALE | 3862.27272727273 |
| MALE   | 4545.68452380952 |
</code></pre></div>

  <ul>
    <li>All rows in each group have the same value for <code>sex</code>, so no need to aggregate</li>
  </ul>

</section>
<section>

  <h2 id="arbitrary-choice-in-aggregation">22: arbitrary choice in aggregation</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/arbitrary_in_aggregation.sql">src/arbitrary_in_aggregation.sql</a></p>
  <div><pre><code><span>select</span>
    <span>sex</span><span>,</span>
    <span>body_mass_g</span>                   
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>sex</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/arbitrary_in_aggregation.out">out/arbitrary_in_aggregation.out</a></p>
  <div><pre><code>|  sex   | body_mass_g |
|--------|-------------|
|        |             |
| FEMALE | 3800        |
| MALE   | 3750        |
</code></pre></div>

  <ul>
    <li>If we don’t specify how to aggregate a column, SQL can choose <em>any arbitrary value</em> from the group</li>
    <li>All penguins in each group have the same sex because we grouped by that, so we get the right answer</li>
    <li>The body mass values are in the data but unpredictable</li>
    <li>A common mistake</li>
  </ul>

</section>
<section>

  <h2 id="filter-aggregated-values">23: filter aggregated values</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/filter_aggregation.sql">src/filter_aggregation.sql</a></p>
  <div><pre><code><span>select</span>
    <span>sex</span><span>,</span>
    <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span> <span>as</span> <span>average_mass_g</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>sex</span>
<span>having</span> <span>average_mass_g</span> <span>&gt;</span> <span>4000</span><span>.</span><span>0</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/filter_aggregation.out">out/filter_aggregation.out</a></p>
  <div><pre><code>| sex  |  average_mass_g  |
|------|------------------|
|      | 4005.55555555556 |
| MALE | 4545.68452380952 |
</code></pre></div>

  <ul>
    <li>Using <code>having <em>condition</em></code> instead of <code>where <em>condition</em></code> for aggregates</li>
  </ul>

</section>
<section>

  <h2 id="readable-output">24: readable output</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/readable_aggregation.sql">src/readable_aggregation.sql</a></p>
  <div><pre><code><span>select</span>
    <span>sex</span><span>,</span>
    <span>round</span><span>(</span><span>avg</span><span>(</span><span>body_mass_g</span><span>),</span> <span>1</span><span>)</span> <span>as</span> <span>average_mass_g</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>sex</span>
<span>having</span> <span>average_mass_g</span> <span>&gt;</span> <span>4000</span><span>.</span><span>0</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/readable_aggregation.out">out/readable_aggregation.out</a></p>
  <div><pre><code>| sex  | average_mass_g |
|------|----------------|
|      | 4005.6         |
| MALE | 4545.7         |
</code></pre></div>

  <ul>
    <li>Use <code>round(<em>value</em>, <em>decimals</em>)</code> to round off a number</li>
  </ul>

</section>
<section>

  <h2 id="filter-aggregate-inputs">25: filter aggregate inputs</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/filter_aggregate_inputs.sql">src/filter_aggregate_inputs.sql</a></p>
  <div><pre><code><span>select</span>
    <span>sex</span><span>,</span>
    <span>round</span><span>(</span>
        <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span> <span>filter</span> <span>(</span><span>where</span> <span>body_mass_g</span> <span>&lt;</span> <span>4000</span><span>.</span><span>0</span><span>),</span>
        <span>1</span>
    <span>)</span> <span>as</span> <span>average_mass_g</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>sex</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/filter_aggregate_inputs.out">out/filter_aggregate_inputs.out</a></p>
  <div><pre><code>|  sex   | average_mass_g |
|--------|----------------|
|        | 3362.5         |
| FEMALE | 3417.3         |
| MALE   | 3752.5         |
</code></pre></div>

  <ul>
    <li><code>filter (where <em>condition</em>)</code> applies to <em>inputs</em></li>
  </ul>

</section>
<section>

  <h2 id="check-your-understanding-2">☆ check your understanding</h2>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/concept_map_aggregate.svg" alt="concept map: aggregation"></p>

</section>
<section>

  <h2 id="create-in-memory-database">☆ create in-memory database</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/in_memory_db.sh">src/in_memory_db.sh</a></p>
  

  <ul>
    <li>“Connect” to an <a href="#g:in_memory_db">in-memory database</a></li>
  </ul>

</section>
<section>

  <h2 id="create-tables">26: create tables</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/create_work_job.sql">src/create_work_job.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>billable</span> <span>real</span> <span>not</span> <span>null</span>
<span>);</span>
<span>create</span> <span>table</span> <span>work</span> <span>(</span>
    <span>person</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>job</span> <span>text</span> <span>not</span> <span>null</span>
<span>);</span>
</code></pre></div>

  <ul>
    <li><code>create table <em>name</em></code> followed by parenthesized list of columns</li>
    <li>Each column is a name, a data type, and optional extra information
      <ul>
        <li>E.g., <code>not null</code> prevents nulls from being added</li>
      </ul>
    </li>
    <li><code>.schema</code> is <em>not</em> standard SQL</li>
    <li>SQLite has added a few things
      <ul>
        <li><code>create if not exists</code></li>
        <li>upper-case keywords (SQL is case insensitive)</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="insert-data">27: insert data</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/populate_work_job.sql">src/populate_work_job.sql</a></p>
  <div><pre><code><span>insert</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'calibrate'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>),</span>
    <span>(</span><span>'clean'</span><span>,</span> <span>0</span><span>.</span><span>5</span><span>);</span>
<span>insert</span> <span>into</span> <span>work</span> <span>values</span>
    <span>(</span><span>'mik'</span><span>,</span> <span>'calibrate'</span><span>),</span>
    <span>(</span><span>'mik'</span><span>,</span> <span>'clean'</span><span>),</span>
    <span>(</span><span>'mik'</span><span>,</span> <span>'complain'</span><span>),</span>
    <span>(</span><span>'po'</span><span>,</span> <span>'clean'</span><span>),</span>
    <span>(</span><span>'po'</span><span>,</span> <span>'complain'</span><span>),</span>
    <span>(</span><span>'tay'</span><span>,</span> <span>'complain'</span><span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/insert_values.out">out/insert_values.out</a></p>
  <pre><code>|   name    | billable |
|-----------|----------|
| calibrate | 1.5      |
| clean     | 0.5      |

| person |    job    |
|--------|-----------|
| mik    | calibrate |
| mik    | clean     |
| mik    | complain  |
| po     | clean     |
| po     | complain  |
| tay    | complain  |
</code></pre>

</section>
<section>

  <h2 id="update-rows">28: update rows</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/update_work_job.sql">src/update_work_job.sql</a></p>
  <div><pre><code><span>update</span> <span>work</span>
<span>set</span> <span>person</span> <span>=</span> <span>"tae"</span>
<span>where</span> <span>person</span> <span>=</span> <span>"tay"</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/update_rows.out">out/update_rows.out</a></p>
  <pre><code>| person |    job    |
|--------|-----------|
| mik    | calibrate |
| mik    | clean     |
| mik    | complain  |
| po     | clean     |
| po     | complain  |
| tae    | complain  |
</code></pre>

  <ul>
    <li>(Almost) always specify row(w) to update using <code>where</code>
      <ul>
        <li>Would otherwise update all rows</li>
      </ul>
    </li>
    <li>Useful to give each row a <a href="#g:primary_key">primary key</a> that uniquely identifies it for this purpose
      <ul>
        <li>Will see other uses below</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="delete-rows">29: delete rows</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/delete_rows.sql">src/delete_rows.sql</a></p>
  <div><pre><code><span>delete</span> <span>from</span> <span>work</span>
<span>where</span> <span>person</span> <span>=</span> <span>"tae"</span><span>;</span>

<span>select</span> <span>*</span> <span>from</span> <span>work</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/delete_rows.out">out/delete_rows.out</a></p>
  <div><pre><code>| person |    job    |
|--------|-----------|
| mik    | calibrate |
| mik    | clean     |
| mik    | complain  |
| po     | clean     |
| po     | complain  |
</code></pre></div>

  <ul>
    <li>Again, (almost) always specify row(s) to delete using <code>where</code></li>
  </ul>

</section>
<section>

  <h2 id="backing-up">30: backing up</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/backing_up.sql">src/backing_up.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>backup</span> <span>(</span>
    <span>person</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>job</span> <span>text</span> <span>not</span> <span>null</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>backup</span>
<span>select</span> <span>person</span><span>,</span> <span>job</span>
<span>from</span> <span>work</span>
<span>where</span> <span>person</span> <span>=</span> <span>'tae'</span><span>;</span>

<span>delete</span> <span>from</span> <span>work</span>
<span>where</span> <span>person</span> <span>=</span> <span>'tae'</span><span>;</span>

<span>select</span> <span>*</span> <span>from</span> <span>backup</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/backing_up.out">out/backing_up.out</a></p>
  <div><pre><code>| person |   job    |
|--------|----------|
| tae    | complain |
</code></pre></div>

</section>
<section>

  <h2 id="check-your-understanding-3">☆ check your understanding</h2>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/concept_map_datamod.svg" alt="concept map: data definition and modification"></p>

</section>
<section>

  <h2 id="join-tables">31: join tables</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/cross_join.sql">src/cross_join.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span>
<span>from</span> <span>work</span> <span>cross</span> <span>join</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/cross_join.out">out/cross_join.out</a></p>
  <div><pre><code>| person |    job    |   name    | billable |
|--------|-----------|-----------|----------|
| mik    | calibrate | calibrate | 1.5      |
| mik    | calibrate | clean     | 0.5      |
| mik    | clean     | calibrate | 1.5      |
| mik    | clean     | clean     | 0.5      |
| mik    | complain  | calibrate | 1.5      |
| mik    | complain  | clean     | 0.5      |
| po     | clean     | calibrate | 1.5      |
| po     | clean     | clean     | 0.5      |
| po     | complain  | calibrate | 1.5      |
| po     | complain  | clean     | 0.5      |
| tay    | complain  | calibrate | 1.5      |
| tay    | complain  | clean     | 0.5      |
</code></pre></div>

  <ul>
    <li>A <a href="#g:join">join</a> combines information from two tables</li>
    <li><a href="#g:full_outer_join">full outer join</a> (also called <a href="#g:cross_join">cross join</a>) constructs their cross product
      <ul>
        <li>All combinations of rows from each</li>
      </ul>
    </li>
    <li>Result isn’t particularly useful: <code>job</code> and <code>name</code> don’t match</li>
  </ul>

</section>
<section>

  <h2 id="inner-join">32: inner join</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/inner_join.sql">src/inner_join.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span>
<span>from</span> <span>work</span> <span>inner</span> <span>join</span> <span>job</span>
<span>on</span> <span>work</span><span>.</span><span>job</span> <span>=</span> <span>job</span><span>.</span><span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/inner_join.out">out/inner_join.out</a></p>
  <div><pre><code>| person |    job    |   name    | billable |
|--------|-----------|-----------|----------|
| mik    | calibrate | calibrate | 1.5      |
| mik    | clean     | clean     | 0.5      |
| po     | clean     | clean     | 0.5      |
</code></pre></div>

  <ul>
    <li>Use <code><em>table</em>.<em>column</em></code> notation to specify columns
      <ul>
        <li>A column can have the same name as a table</li>
      </ul>
    </li>
    <li>Use <code>on <em>condition</em></code> to specify <a href="#g:join_condition">join condition</a></li>
    <li>Since <code>complain</code> doesn’t appear in <code>job.name</code>, none of those rows are kept</li>
  </ul>

</section>
<section>

  <h2 id="aggregate-joined-data">33: aggregate joined data</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/aggregate_join.sql">src/aggregate_join.sql</a></p>
  <div><pre><code><span>select</span>
    <span>work</span><span>.</span><span>person</span><span>,</span>
    <span>sum</span><span>(</span><span>job</span><span>.</span><span>billable</span><span>)</span> <span>as</span> <span>pay</span>
<span>from</span> <span>work</span> <span>inner</span> <span>join</span> <span>job</span>
<span>on</span> <span>work</span><span>.</span><span>job</span> <span>=</span> <span>job</span><span>.</span><span>name</span>
<span>group</span> <span>by</span> <span>work</span><span>.</span><span>person</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/aggregate_join.out">out/aggregate_join.out</a></p>
  <div><pre><code>| person | pay |
|--------|-----|
| mik    | 2.0 |
| po     | 0.5 |
</code></pre></div>

  <ul>
    <li>Combines ideas we’ve seen before</li>
    <li>But Tay is missing from the table</li>
  </ul>

</section>
<section>

  <h2 id="left-join">34: left join</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/left_join.sql">src/left_join.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span>
<span>from</span> <span>work</span> <span>left</span> <span>join</span> <span>job</span>
<span>on</span> <span>work</span><span>.</span><span>job</span> <span>=</span> <span>job</span><span>.</span><span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/left_join.out">out/left_join.out</a></p>
  <div><pre><code>| person |    job    |   name    | billable |
|--------|-----------|-----------|----------|
| mik    | calibrate | calibrate | 1.5      |
| mik    | clean     | clean     | 0.5      |
| mik    | complain  |           |          |
| po     | clean     | clean     | 0.5      |
| po     | complain  |           |          |
| tay    | complain  |           |          |
</code></pre></div>

  <ul>
    <li>A <a href="#g:left_outer_join">left outer join</a> keeps all rows from the left table</li>
    <li>Fills missing values from right table with null</li>
  </ul>

</section>
<section>

  <h2 id="aggregate-left-joins">35: aggregate left joins</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/aggregate_left_join.sql">src/aggregate_left_join.sql</a></p>
  <div><pre><code><span>select</span>
    <span>work</span><span>.</span><span>person</span><span>,</span>
    <span>sum</span><span>(</span><span>job</span><span>.</span><span>billable</span><span>)</span> <span>as</span> <span>pay</span>
<span>from</span> <span>work</span> <span>left</span> <span>join</span> <span>job</span>
<span>on</span> <span>work</span><span>.</span><span>job</span> <span>=</span> <span>job</span><span>.</span><span>name</span>
<span>group</span> <span>by</span> <span>work</span><span>.</span><span>person</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/aggregate_left_join.out">out/aggregate_left_join.out</a></p>
  <div><pre><code>| person | pay |
|--------|-----|
| mik    | 2.0 |
| po     | 0.5 |
| tay    |     |
</code></pre></div>

  <ul>
    <li>That’s better, but we’d like to see 0 rather than a blank</li>
  </ul>

</section>
<section>

  <h2 id="check-your-understanding-4">☆ check your understanding</h2>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/concept_map_join.svg" alt="concept map: join"></p>

</section>
<section>

  <h2 id="coalesce-values">36: coalesce values</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/coalesce.sql">src/coalesce.sql</a></p>
  <div><pre><code><span>select</span>
    <span>work</span><span>.</span><span>person</span><span>,</span>
    <span>coalesce</span><span>(</span><span>sum</span><span>(</span><span>job</span><span>.</span><span>billable</span><span>),</span> <span>0</span><span>.</span><span>0</span><span>)</span> <span>as</span> <span>pay</span>
<span>from</span> <span>work</span> <span>left</span> <span>join</span> <span>job</span>
<span>on</span> <span>work</span><span>.</span><span>job</span> <span>=</span> <span>job</span><span>.</span><span>name</span>
<span>group</span> <span>by</span> <span>work</span><span>.</span><span>person</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/coalesce.out">out/coalesce.out</a></p>
  <div><pre><code>| person | pay |
|--------|-----|
| mik    | 2.0 |
| po     | 0.5 |
| tay    | 0.0 |
</code></pre></div>

  <ul>
    <li><code>coalesce(<em>val1</em>, <em>val2</em>, …)</code> returns first non-null value</li>
  </ul>

</section>
<section>

  <h2 id="negate-incorrectly">37: negate incorrectly</h2>

  <ul>
    <li>Who doesn’t calibrate?</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/negate_incorrectly.sql">src/negate_incorrectly.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>person</span>
<span>from</span> <span>work</span>
<span>where</span> <span>job</span> <span>!=</span> <span>'calibrate'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/negate_incorrectly.out">out/negate_incorrectly.out</a></p>
  <div><pre><code>| person |
|--------|
| mik    |
| po     |
| tay    |
</code></pre></div>

  <ul>
    <li>But Mik <em>does</em> calibrate</li>
    <li>Problem is that there’s an entry for Mik cleaning</li>
    <li>And since <code>'clean' != 'calibrate'</code>, that row is included in the results</li>
    <li>We need a different approach</li>
  </ul>

</section>
<section>

  <h2 id="set-membership">38: set membership</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/set_membership.sql">src/set_membership.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span>
<span>from</span> <span>work</span>
<span>where</span> <span>person</span> <span>not</span> <span>in</span> <span>(</span><span>'mik'</span><span>,</span> <span>'tay'</span><span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/set_membership.out">out/set_membership.out</a></p>
  <div><pre><code>| person |   job    |
|--------|----------|
| po     | clean    |
| po     | complain |
</code></pre></div>

  <ul>
    <li><code>in <em>values</em></code> and <code>not in <em>values</em></code> do exactly what you expect</li>
  </ul>

</section>
<section>

  <h2 id="subqueries">39: subqueries</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/subquery_set.sql">src/subquery_set.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span> <span>person</span>
<span>from</span> <span>work</span>
<span>where</span> <span>person</span> <span>not</span> <span>in</span> <span>(</span>
    <span>select</span> <span>distinct</span> <span>person</span>
    <span>from</span> <span>work</span>
    <span>where</span> <span>job</span> <span>=</span> <span>'calibrate'</span>
<span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/subquery_set.out">out/subquery_set.out</a></p>
  <div><pre><code>| person |
|--------|
| po     |
| tay    |
</code></pre></div>

  <ul>
    <li>Use a <a href="#g:subquery">subquery</a> to select the people who <em>do</em> calibrate</li>
    <li>Then select all the people who aren’t in that set</li>
    <li>Initially feels odd, but subqueries are useful in other ways</li>
  </ul>

</section>
<section>

  <h2 id="m-to-n-relationships">☆ M to N relationships</h2>

  <ul>
    <li>Relationships between entities are usually characterized as:
      <ul>
        <li><a href="#g:1_to_1">1-to-1</a>:
fields in the same record</li>
        <li><a href="#g:1_to_many">1-to-many</a>:
the many have a <a href="#g:foreign_key">foreign key</a> referring to the one’s primary key</li>
        <li><a href="#g:many_to_many">many-to-many</a>:
don’t know how many keys to add to records (“maximum” never is)</li>
      </ul>
    </li>
    <li>Nearly-universal solution is a <a href="#g:join_table">join table</a>
      <ul>
        <li>Each record is a pair of foreign keys</li>
        <li>I.e., each record is the fact that records A and B are related</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="autoincrement-and-primary-key">40: autoincrement and primary key</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/autoincrement.sql">src/autoincrement.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>person</span> <span>(</span>
    <span>ident</span> <span>integer</span> <span>primary</span> <span>key</span> <span>autoincrement</span><span>,</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span>
<span>);</span>
<span>insert</span> <span>into</span> <span>person</span> <span>values</span>
    <span>(</span><span>null</span><span>,</span> <span>'mik'</span><span>),</span>
    <span>(</span><span>null</span><span>,</span> <span>'po'</span><span>),</span>
    <span>(</span><span>null</span><span>,</span> <span>'tay'</span><span>);</span>
<span>select</span> <span>*</span> <span>from</span> <span>person</span><span>;</span>
<span>insert</span> <span>into</span> <span>person</span> <span>values</span> <span>(</span><span>1</span><span>,</span> <span>"prevented"</span><span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/autoincrement.out">out/autoincrement.out</a></p>
  <div><pre><code>| ident | name |
|-------|------|
| 1     | mik  |
| 2     | po   |
| 3     | tay  |
Runtime error near line 12: UNIQUE constraint failed: person.ident (19)
</code></pre></div>

  <ul>
    <li>Database <a href="#g:autoincrement">autoincrements</a> <code>ident</code> each time a new record is added</li>
    <li>Use that field as the primary key
      <ul>
        <li>So that if Mik changes their name again,
we only have to change one fact in the database</li>
        <li>Downside: manual queries are harder to read (who is person 17?)</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="internal-tables">☆ internal tables</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/sequence_table.sql">src/sequence_table.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span> <span>from</span> <span>sqlite_sequence</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/sequence_table.out">out/sequence_table.out</a></p>
  <div><pre><code>|  name  | seq |
|--------|-----|
| person | 3   |
</code></pre></div>

  <ul>
    <li>Sequence numbers are <em>not</em> reset when rows are deleted</li>
  </ul>

</section>
<section>

  <h2 id="alter-tables">41: alter tables</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/alter_tables.sql">src/alter_tables.sql</a></p>
  <div><pre><code><span>alter</span> <span>table</span> <span>job</span>
<span>add</span> <span>ident</span> <span>integer</span> <span>not</span> <span>null</span> <span>default</span> <span>-</span><span>1</span><span>;</span>

<span>update</span> <span>job</span>
<span>set</span> <span>ident</span> <span>=</span> <span>1</span>
<span>where</span> <span>name</span> <span>=</span> <span>'calibrate'</span><span>;</span>

<span>update</span> <span>job</span>
<span>set</span> <span>ident</span> <span>=</span> <span>2</span>
<span>where</span> <span>name</span> <span>=</span> <span>'clean'</span><span>;</span>

<span>select</span> <span>*</span> <span>from</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/alter_tables.out">out/alter_tables.out</a></p>
  <div><pre><code>|   name    | billable | ident |
|-----------|----------|-------|
| calibrate | 1.5      | 1     |
| clean     | 0.5      | 2     |
</code></pre></div>

  <ul>
    <li>Add a column after the fact</li>
    <li>Since it can’t be null, we have to provide a default value
      <ul>
        <li>Really want to make it the primary key, but SQLite doesn’t allow that (easily) after the fact</li>
      </ul>
    </li>
    <li>Then use <code>update</code> to modify existing records
      <ul>
        <li>Can modify any number of records at once</li>
        <li>So be careful about <code>where</code> clause</li>
      </ul>
    </li>
    <li><a href="#g:data_migration">Data migration</a></li>
  </ul>

</section>
<section>

  <h2 id="create-new-tables-from-old">42: create new tables from old</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/insert_select.sql">src/insert_select.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>new_work</span> <span>(</span>
    <span>person_id</span> <span>integer</span> <span>not</span> <span>null</span><span>,</span>
    <span>job_id</span> <span>integer</span> <span>not</span> <span>null</span><span>,</span>
    <span>foreign</span> <span>key</span><span>(</span><span>person_id</span><span>)</span> <span>references</span> <span>person</span><span>(</span><span>ident</span><span>),</span>
    <span>foreign</span> <span>key</span><span>(</span><span>job_id</span><span>)</span> <span>references</span> <span>job</span><span>(</span><span>ident</span><span>)</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>new_work</span>
<span>select</span>
    <span>person</span><span>.</span><span>ident</span> <span>as</span> <span>person_id</span><span>,</span>
    <span>job</span><span>.</span><span>ident</span> <span>as</span> <span>job_id</span>
<span>from</span>
    <span>(</span><span>person</span> <span>join</span> <span>work</span> <span>on</span> <span>person</span><span>.</span><span>name</span> <span>=</span> <span>work</span><span>.</span><span>person</span><span>)</span>
    <span>join</span> <span>job</span> <span>on</span> <span>job</span><span>.</span><span>name</span> <span>=</span> <span>work</span><span>.</span><span>job</span><span>;</span>
<span>select</span> <span>*</span> <span>from</span> <span>new_work</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/insert_select.out">out/insert_select.out</a></p>
  <div><pre><code>| person_id | job_id |
|-----------|--------|
| 1         | 1      |
| 1         | 2      |
| 2         | 2      |
</code></pre></div>

  <ul>
    <li><code>new_work</code> is our join table</li>
    <li>Each column refers to a record in some other table</li>
  </ul>

</section>
<section>

  <h2 id="remove-tables">43: remove tables</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/drop_table.sql">src/drop_table.sql</a></p>
  <div><pre><code><span>drop</span> <span>table</span> <span>work</span><span>;</span>
<span>alter</span> <span>table</span> <span>new_work</span> <span>rename</span> <span>to</span> <span>work</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/drop_table.out">out/drop_table.out</a></p>
  <div><pre><code>CREATE TABLE job (
    ident integer primary key autoincrement,
    name text not null,
    billable real not null
);
CREATE TABLE sqlite_sequence(name,seq);
CREATE TABLE person (
    ident integer primary key autoincrement,
    name text not null
);
CREATE TABLE IF NOT EXISTS "work" (
    person_id integer not null,
    job_id integer not null,
    foreign key(person_id) references person(ident),
    foreign key(job_id) references job(ident)
);
</code></pre></div>

  <ul>
    <li>Remove the old table and rename the new one to take its place
      <ul>
        <li>Note <code>if exists</code></li>
      </ul>
    </li>
    <li>Be careful…</li>
  </ul>

</section>
<section>

  <h2 id="compare-individual-values-to-aggregates">44: compare individual values to aggregates</h2>

  <ul>
    <li>Go back to penguins</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/compare_individual_aggregate.sql">src/compare_individual_aggregate.sql</a></p>
  <div><pre><code><span>select</span> <span>body_mass_g</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>body_mass_g</span> <span>&gt;</span> <span>(</span>
    <span>select</span> <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span>
    <span>from</span> <span>penguins</span>
<span>)</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/compare_individual_aggregate.out">out/compare_individual_aggregate.out</a></p>
  <div><pre><code>| body_mass_g |
|-------------|
| 4675        |
| 4250        |
| 4400        |
| 4500        |
| 4650        |
</code></pre></div>

  <ul>
    <li>Get average body mass in subquery</li>
    <li>Compare each row against that</li>
    <li>Requires two scans of the data, but there’s no way to avoid that</li>
    <li>Null values aren’t included in the average or in the final results</li>
  </ul>

</section>
<section>

  <h2 id="compare-individual-values-to-aggregates-within-groups">45: compare individual values to aggregates within groups</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/compare_within_groups.sql">src/compare_within_groups.sql</a></p>
  <div><pre><code><span>select</span>
    <span>penguins</span><span>.</span><span>species</span><span>,</span>
    <span>penguins</span><span>.</span><span>body_mass_g</span><span>,</span>
    <span>round</span><span>(</span><span>averaged</span><span>.</span><span>avg_mass_g</span><span>,</span> <span>1</span><span>)</span> <span>as</span> <span>avg_mass_g</span>
<span>from</span> <span>penguins</span> <span>join</span> <span>(</span>
    <span>select</span> <span>species</span><span>,</span> <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span> <span>as</span> <span>avg_mass_g</span>
    <span>from</span> <span>penguins</span>
    <span>group</span> <span>by</span> <span>species</span>
<span>)</span> <span>as</span> <span>averaged</span>
<span>on</span> <span>penguins</span><span>.</span><span>species</span> <span>=</span> <span>averaged</span><span>.</span><span>species</span>
<span>where</span> <span>penguins</span><span>.</span><span>body_mass_g</span> <span>&gt;</span> <span>averaged</span><span>.</span><span>avg_mass_g</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/compare_within_groups.out">out/compare_within_groups.out</a></p>
  <div><pre><code>| species | body_mass_g | avg_mass_g |
|---------|-------------|------------|
| Adelie  | 3750        | 3700.7     |
| Adelie  | 3800        | 3700.7     |
| Adelie  | 4675        | 3700.7     |
| Adelie  | 4250        | 3700.7     |
| Adelie  | 3800        | 3700.7     |
</code></pre></div>

  <ul>
    <li>Subquery runs first to create temporary table <code>averaged</code> with average mass per species</li>
    <li>Join that with <code>penguins</code></li>
    <li>Filter to find penguins heavier than average within their species</li>
  </ul>

</section>
<section>

  <h2 id="common-table-expressions">46: common table expressions</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/common_table_expressions.sql">src/common_table_expressions.sql</a></p>
  <div><pre><code><span>with</span> <span>grouped</span> <span>as</span> <span>(</span>
    <span>select</span> <span>species</span><span>,</span> <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span> <span>as</span> <span>avg_mass_g</span>
    <span>from</span> <span>penguins</span>
    <span>group</span> <span>by</span> <span>species</span>
<span>)</span>
<span>select</span>
    <span>penguins</span><span>.</span><span>species</span><span>,</span>
    <span>penguins</span><span>.</span><span>body_mass_g</span><span>,</span>
    <span>round</span><span>(</span><span>grouped</span><span>.</span><span>avg_mass_g</span><span>,</span> <span>1</span><span>)</span> <span>as</span> <span>avg_mass_g</span>
<span>from</span> <span>penguins</span> <span>join</span> <span>grouped</span>
<span>where</span> <span>penguins</span><span>.</span><span>body_mass_g</span> <span>&gt;</span> <span>grouped</span><span>.</span><span>avg_mass_g</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/common_table_expressions.out">out/common_table_expressions.out</a></p>
  <div><pre><code>| species | body_mass_g | avg_mass_g |
|---------|-------------|------------|
| Adelie  | 3750        | 3700.7     |
| Adelie  | 3800        | 3700.7     |
| Adelie  | 4675        | 3700.7     |
| Adelie  | 4250        | 3700.7     |
| Adelie  | 3800        | 3700.7     |
</code></pre></div>

  <ul>
    <li>Use <a href="#g:cte">common table expression</a> (CTE) to make queries clearer
      <ul>
        <li>Nested subqueries quickly become difficult to understand</li>
      </ul>
    </li>
    <li>Database decides how to optimize</li>
  </ul>

</section>
<section>

  <h2 id="explain-query-plan">☆ explain query plan</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/explain_query_plan.sql">src/explain_query_plan.sql</a></p>
  <div><pre><code><span>explain</span> <span>query</span> <span>plan</span>
<span>select</span>
    <span>species</span><span>,</span>
    <span>avg</span><span>(</span><span>body_mass_g</span><span>)</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>species</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/explain_query_plan.out">out/explain_query_plan.out</a></p>
  <div><pre><code>QUERY PLAN
|--SCAN penguins
`--USE TEMP B-TREE FOR GROUP BY
</code></pre></div>

  <ul>
    <li>SQLite plans to scan every row of the table</li>
    <li>It will build a temporary B-tree data structure to group rows</li>
  </ul>

</section>
<section>

  <h2 id="enumerate-rows">47: enumerate rows</h2>

  <ul>
    <li>Every table has a special column called <code>rowid</code></li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/rowid.sql">src/rowid.sql</a></p>
  <div><pre><code><span>select</span> <span>rowid</span><span>,</span> <span>species</span><span>,</span> <span>island</span>
<span>from</span> <span>penguins</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/rowid.out">out/rowid.out</a></p>
  <div><pre><code>| rowid | species |  island   |
|-------|---------|-----------|
| 1     | Adelie  | Torgersen |
| 2     | Adelie  | Torgersen |
| 3     | Adelie  | Torgersen |
| 4     | Adelie  | Torgersen |
| 5     | Adelie  | Torgersen |
</code></pre></div>

  <ul>
    <li><code>rowid</code> is persistent within a session
      <ul>
        <li>I.e., if we delete the first 5 rows we now have row IDs 6…N</li>
      </ul>
    </li>
    <li><em>Do not rely on row ID</em>
      <ul>
        <li>In particular, do not use it as a key</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="if-else-function">48: if-else function</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/if_else.sql">src/if_else.sql</a></p>
  <div><pre><code><span>with</span> <span>sized_penguins</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>species</span><span>,</span>
        <span>iif</span><span>(</span>
            <span>body_mass_g</span> <span>&lt;</span> <span>3500</span><span>,</span>
            <span>'small'</span><span>,</span>
            <span>'large'</span>
        <span>)</span> <span>as</span> <span>size</span>
    <span>from</span> <span>penguins</span>
<span>)</span>
<span>select</span> <span>species</span><span>,</span> <span>size</span><span>,</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
<span>from</span> <span>sized_penguins</span>
<span>group</span> <span>by</span> <span>species</span><span>,</span> <span>size</span>
<span>order</span> <span>by</span> <span>species</span><span>,</span> <span>num</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/if_else.out">out/if_else.out</a></p>
  <div><pre><code>|  species  | size  | num |
|-----------|-------|-----|
| Adelie    | small | 54  |
| Adelie    | large | 98  |
| Chinstrap | small | 17  |
| Chinstrap | large | 51  |
| Gentoo    | large | 124 |
</code></pre></div>

  <ul>
    <li><code>iif(<em>condition</em>, <em>true_result</em>, <em>false_result</em>)</code>
      <ul>
        <li>Note: <code>iif</code> with two i’s</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="select-a-case">49: select a case</h2>

  <ul>
    <li>What if we want small, medium, and large?</li>
    <li>Can nest <code>iif</code>, but quickly becomes unreadable</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/case_when.sql">src/case_when.sql</a></p>
  <div><pre><code><span>with</span> <span>sized_penguins</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>species</span><span>,</span>
        <span>case</span>
            <span>when</span> <span>body_mass_g</span> <span>&lt;</span> <span>3500</span> <span>then</span> <span>'small'</span>
            <span>when</span> <span>body_mass_g</span> <span>&lt;</span> <span>5000</span> <span>then</span> <span>'medium'</span>
            <span>else</span> <span>'large'</span>
        <span>end</span> <span>as</span> <span>size</span>
    <span>from</span> <span>penguins</span>
<span>)</span>
<span>select</span> <span>species</span><span>,</span> <span>size</span><span>,</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
<span>from</span> <span>sized_penguins</span>
<span>group</span> <span>by</span> <span>species</span><span>,</span> <span>size</span>
<span>order</span> <span>by</span> <span>species</span><span>,</span> <span>num</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/case_when.out">out/case_when.out</a></p>
  <div><pre><code>|  species  |  size  | num |
|-----------|--------|-----|
| Adelie    | large  | 1   |
| Adelie    | small  | 54  |
| Adelie    | medium | 97  |
| Chinstrap | small  | 17  |
| Chinstrap | medium | 51  |
| Gentoo    | medium | 56  |
| Gentoo    | large  | 68  |
</code></pre></div>

  <ul>
    <li>Evaluate <code>when</code> options in order and take first</li>
    <li>Result of <code>case</code> is null if no condition is true</li>
    <li>Use <code>else</code> as fallback</li>
  </ul>

</section>
<section>

  <h2 id="check-range">50: check range</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/check_range.sql">src/check_range.sql</a></p>
  <div><pre><code><span>with</span> <span>sized_penguins</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>species</span><span>,</span>
        <span>case</span>
            <span>when</span> <span>body_mass_g</span> <span>between</span> <span>3500</span> <span>and</span> <span>5000</span> <span>then</span> <span>'normal'</span>
            <span>else</span> <span>'abnormal'</span>
        <span>end</span> <span>as</span> <span>size</span>
    <span>from</span> <span>penguins</span>
<span>)</span>
<span>select</span> <span>species</span><span>,</span> <span>size</span><span>,</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
<span>from</span> <span>sized_penguins</span>
<span>group</span> <span>by</span> <span>species</span><span>,</span> <span>size</span>
<span>order</span> <span>by</span> <span>species</span><span>,</span> <span>num</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/check_range.out">out/check_range.out</a></p>
  <div><pre><code>|  species  |   size   | num |
|-----------|----------|-----|
| Adelie    | abnormal | 55  |
| Adelie    | normal   | 97  |
| Chinstrap | abnormal | 17  |
| Chinstrap | normal   | 51  |
| Gentoo    | abnormal | 62  |
| Gentoo    | normal   | 62  |
</code></pre></div>

  <ul>
    <li><code>between</code> can make queries easier to read</li>
    <li>But be careful of the <code>and</code> in the middle</li>
  </ul>

</section>
<section>

  <h2 id="yet-another-database">☆ yet another database</h2>

  <ul>
    <li><a href="#g:er_diagram">Entity-relationship diagram</a> (ER diagram) shows relationships between tables</li>
    <li>Like everything to do with databases, there are lots of variations</li>
  </ul>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/assays_tables.svg" alt="assay database table diagram"></p>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/assays_er.svg" alt="assay ER diagram"></p>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/assay_staff.sql">src/assay_staff.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/assay_staff.out">out/assay_staff.out</a></p>
  <div><pre><code>| ident | personal |  family   | dept | age |
|-------|----------|-----------|------|-----|
| 1     | Kartik   | Gupta     |      | 46  |
| 2     | Divit    | Dhaliwal  | hist | 34  |
| 3     | Indrans  | Sridhar   | mb   | 47  |
| 4     | Pranay   | Khanna    | mb   | 51  |
| 5     | Riaan    | Dua       |      | 23  |
| 6     | Vedika   | Rout      | hist | 45  |
| 7     | Abram    | Chokshi   | gen  | 23  |
| 8     | Romil    | Kapoor    | hist | 38  |
| 9     | Ishaan   | Ramaswamy | mb   | 35  |
| 10    | Nitya    | Lal       | gen  | 52  |
</code></pre></div>

</section>
<section>

  <h2 id="pattern-matching">51: pattern matching</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/like_glob.sql">src/like_glob.sql</a></p>
  <div><pre><code><span>select</span> <span>personal</span><span>,</span> <span>family</span> <span>from</span> <span>staff</span>
<span>where</span> <span>personal</span> <span>like</span> <span>'%ya%'</span> <span>or</span> <span>family</span> <span>glob</span> <span>'*De*'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/like_glob.out">out/like_glob.out</a></p>
  <div><pre><code>| personal | family |
|----------|--------|
| Nitya    | Lal    |
</code></pre></div>

  <ul>
    <li><code>like</code> is the original SQL pattern matcher
      <ul>
        <li><code>%</code> matches zero or more characters at the start or end of a string</li>
        <li>Case insensitive by default</li>
      </ul>
    </li>
    <li><code>glob</code> supports Unix-style wildcards</li>
  </ul>

  <table>
    <thead>
      <tr>
        <th>name</th>
        <th>purpose</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><code>substr</code></td>
        <td>Get substring given starting point and length</td>
      </tr>
      <tr>
        <td><code>trim</code></td>
        <td>Remove characters from beginning and end of string</td>
      </tr>
      <tr>
        <td><code>ltrim</code></td>
        <td>Remove characters from beginning of string</td>
      </tr>
      <tr>
        <td><code>rtrim</code></td>
        <td>Remove characters from end of string</td>
      </tr>
      <tr>
        <td><code>length</code></td>
        <td>Length of string</td>
      </tr>
      <tr>
        <td><code>replace</code></td>
        <td>Replace occurrences of substring with another string</td>
      </tr>
      <tr>
        <td><code>upper</code></td>
        <td>Return upper-case version of string</td>
      </tr>
      <tr>
        <td><code>lower</code></td>
        <td>Return lower-case version of string</td>
      </tr>
      <tr>
        <td><code>instr</code></td>
        <td>Find location of first occurrence of substring (returns 0 if not found)</td>
      </tr>
    </tbody>
  </table>

</section>
<section>

  <h2 id="select-first-and-last-rows">52: select first and last rows</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/union_all.sql">src/union_all.sql</a></p>
  <div><pre><code><span>select</span> <span>*</span> <span>from</span> <span>(</span>
    <span>select</span> <span>*</span> <span>from</span> <span>(</span><span>select</span> <span>*</span> <span>from</span> <span>experiment</span> <span>order</span> <span>by</span> <span>started</span> <span>asc</span> <span>limit</span> <span>5</span><span>)</span>
    <span>union</span> <span>all</span>
    <span>select</span> <span>*</span> <span>from</span> <span>(</span><span>select</span> <span>*</span> <span>from</span> <span>experiment</span> <span>order</span> <span>by</span> <span>started</span> <span>desc</span> <span>limit</span> <span>5</span><span>)</span>
<span>)</span>
<span>order</span> <span>by</span> <span>started</span> <span>asc</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/union_all.out">out/union_all.out</a></p>
  <div><pre><code>| ident |    kind     |  started   |   ended    |
|-------|-------------|------------|------------|
| 17    | trial       | 2023-01-29 | 2023-01-30 |
| 35    | calibration | 2023-01-30 | 2023-01-30 |
| 36    | trial       | 2023-02-02 | 2023-02-03 |
| 25    | trial       | 2023-02-12 | 2023-02-14 |
| 2     | calibration | 2023-02-14 | 2023-02-14 |
| 40    | calibration | 2024-01-21 | 2024-01-21 |
| 12    | trial       | 2024-01-26 | 2024-01-28 |
| 44    | trial       | 2024-01-27 | 2024-01-29 |
| 34    | trial       | 2024-02-01 | 2024-02-02 |
| 14    | calibration | 2024-02-03 | 2024-02-03 |
</code></pre></div>

  <ul>
    <li><code>union all</code> combines records
      <ul>
        <li>Keeps duplicates: <code>union</code> on its own keeps unique records</li>
      </ul>
    </li>
    <li>Yes, it feels like the extra <code>select * from</code> should be unnecessary</li>
  </ul>

</section>
<section>

  <h2 id="intersection">53: intersection</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/intersect.sql">src/intersect.sql</a></p>
  <div><pre><code><span>select</span> <span>personal</span><span>,</span> <span>family</span><span>,</span> <span>dept</span><span>,</span> <span>age</span>
<span>from</span> <span>staff</span>
<span>where</span> <span>dept</span> <span>=</span> <span>'mb'</span>
<span>intersect</span>
    <span>select</span> <span>personal</span><span>,</span> <span>family</span><span>,</span> <span>dept</span><span>,</span> <span>age</span> <span>from</span> <span>staff</span>
    <span>where</span> <span>age</span> <span>&lt;</span> <span>50</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/intersect.out">out/intersect.out</a></p>
  <div><pre><code>| personal |  family   | dept | age |
|----------|-----------|------|-----|
| Indrans  | Sridhar   | mb   | 47  |
| Ishaan   | Ramaswamy | mb   | 35  |
</code></pre></div>

  <ul>
    <li>Tables being intersected must have same structure</li>
    <li>Intersection usually used when pulling values from different tables
      <ul>
        <li>In this case, would be clearer to use <code>where</code></li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="exclusion">54: exclusion</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/except.sql">src/except.sql</a></p>
  <div><pre><code><span>select</span> <span>personal</span><span>,</span> <span>family</span><span>,</span> <span>dept</span><span>,</span> <span>age</span>
<span>from</span> <span>staff</span>
<span>where</span> <span>dept</span> <span>=</span> <span>'mb'</span>
<span>except</span>
    <span>select</span> <span>personal</span><span>,</span> <span>family</span><span>,</span> <span>dept</span><span>,</span> <span>age</span> <span>from</span> <span>staff</span>
    <span>where</span> <span>age</span> <span>&lt;</span> <span>50</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/except.out">out/except.out</a></p>
  <div><pre><code>| personal | family | dept | age |
|----------|--------|------|-----|
| Pranay   | Khanna | mb   | 51  |
</code></pre></div>

  <ul>
    <li>Again, tables must have same structure
      <ul>
        <li>And this would be clearer with <code>where</code></li>
      </ul>
    </li>
    <li>SQL operates on sets, not tables, except where it doesn’t</li>
  </ul>

</section>
<section>

  <h2 id="random-numbers-and-why-not">55: random numbers and why not</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/random_numbers.sql">src/random_numbers.sql</a></p>
  <div><pre><code><span>with</span> <span>decorated</span> <span>as</span> <span>(</span>
    <span>select</span> <span>random</span><span>()</span> <span>as</span> <span>rand</span><span>,</span>
    <span>personal</span> <span>||</span> <span>' '</span> <span>||</span> <span>family</span> <span>as</span> <span>name</span>
    <span>from</span> <span>staff</span>
<span>)</span>
<span>select</span> <span>rand</span><span>,</span> <span>abs</span><span>(</span><span>rand</span><span>)</span> <span>%</span> <span>10</span> <span>as</span> <span>selector</span><span>,</span> <span>name</span>
<span>from</span> <span>decorated</span>
<span>where</span> <span>selector</span> <span>&lt;</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/random_numbers.out">out/random_numbers.out</a></p>
  <div><pre><code>|         rand         | selector |      name       |
|----------------------|----------|-----------------|
| 7176652035743196310  | 0        | Divit Dhaliwal  |
| -2243654635505630380 | 2        | Indrans Sridhar |
| -6940074802089166303 | 5        | Pranay Khanna   |
| 8882650891091088193  | 9        | Riaan Dua       |
| -45079732302991538   | 5        | Vedika Rout     |
| -8973877087806386134 | 2        | Abram Chokshi   |
| 3360598450426870356  | 9        | Romil Kapoor    |
</code></pre></div>

  <ul>
    <li>There is no way to seed SQLite’s random number generator</li>
    <li>Which means there is no way to reproduce one of its “random” sequences</li>
  </ul>

</section>
<section>

  <h2 id="creating-index">56: creating index</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/create_use_index.sql">src/create_use_index.sql</a></p>
  <div><pre><code><span>explain</span> <span>query</span> <span>plan</span>
<span>select</span> <span>filename</span>
<span>from</span> <span>plate</span>
<span>where</span> <span>filename</span> <span>like</span> <span>'%07%'</span><span>;</span>

<span>create</span> <span>index</span> <span>plate_file</span> <span>on</span> <span>plate</span><span>(</span><span>filename</span><span>);</span>

<span>explain</span> <span>query</span> <span>plan</span>
<span>select</span> <span>filename</span>
<span>from</span> <span>plate</span>
<span>where</span> <span>filename</span> <span>like</span> <span>'%07%'</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/create_use_index.out">out/create_use_index.out</a></p>
  <div><pre><code>QUERY PLAN
`--SCAN plate USING COVERING INDEX sqlite_autoindex_plate_1
QUERY PLAN
`--SCAN plate USING COVERING INDEX plate_file
</code></pre></div>

  <ul>
    <li>An <a href="#g:index">index</a> is an auxiliary data structure that enables faster access to records
      <ul>
        <li>Spend storage space to buy speed</li>
      </ul>
    </li>
    <li>Don’t have to mention it explicitly in queries
      <ul>
        <li>Database manager will use it automatically</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="generate-sequence">57: generate sequence</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/generate_sequence.sql">src/generate_sequence.sql</a></p>
  <div><pre><code><span>select</span> <span>value</span> <span>from</span> <span>generate_series</span><span>(</span><span>1</span><span>,</span> <span>5</span><span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/generate_sequence.out">out/generate_sequence.out</a></p>
  <div><pre><code>| value |
|-------|
| 1     |
| 2     |
| 3     |
| 4     |
| 5     |
</code></pre></div>

  <ul>
    <li>A (non-standard) <a href="#g:table_valued_func">table-valued function</a></li>
  </ul>

</section>
<section>

  <h2 id="generate-sequence-based-on-data">58: generate sequence based on data</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/data_range_sequence.sql">src/data_range_sequence.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>temp</span> <span>(</span>
    <span>num</span> <span>integer</span> <span>not</span> <span>null</span>
<span>);</span>
<span>insert</span> <span>into</span> <span>temp</span> <span>values</span> <span>(</span><span>1</span><span>),</span> <span>(</span><span>5</span><span>);</span>
<span>select</span> <span>value</span> <span>from</span> <span>generate_series</span> <span>(</span>
    <span>(</span><span>select</span> <span>min</span><span>(</span><span>num</span><span>)</span> <span>from</span> <span>temp</span><span>),</span>
    <span>(</span><span>select</span> <span>max</span><span>(</span><span>num</span><span>)</span> <span>from</span> <span>temp</span><span>)</span>
<span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/data_range_sequence.out">out/data_range_sequence.out</a></p>
  <div><pre><code>| value |
|-------|
| 1     |
| 2     |
| 3     |
| 4     |
| 5     |
</code></pre></div>

  <ul>
    <li>Must have the parentheses around the <code>min</code> and <code>max</code> selections to keep SQLite happy</li>
  </ul>

</section>
<section>

  <h2 id="generate-sequence-of-dates">59: generate sequence of dates</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/date_sequence.sql">src/date_sequence.sql</a></p>
  <div><pre><code><span>select</span>
    <span>date</span><span>((</span><span>select</span> <span>julianday</span><span>(</span><span>min</span><span>(</span><span>started</span><span>))</span> <span>from</span> <span>experiment</span><span>)</span> <span>+</span> <span>value</span><span>)</span> <span>as</span> <span>some_day</span>
<span>from</span> <span>(</span>
    <span>select</span> <span>value</span> <span>from</span> <span>generate_series</span><span>(</span>
        <span>(</span><span>select</span> <span>0</span><span>),</span>
        <span>(</span><span>select</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>-</span> <span>1</span> <span>from</span> <span>experiment</span><span>)</span>
    <span>)</span>
<span>)</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/date_sequence.out">out/date_sequence.out</a></p>
  <div><pre><code>|  some_day  |
|------------|
| 2023-01-29 |
| 2023-01-30 |
| 2023-01-31 |
| 2023-02-01 |
| 2023-02-02 |
</code></pre></div>

  <ul>
    <li>SQLite represents dates as YYYY-MM-DD strings
or as Julian days or as Unix milliseconds or…
      <ul>
        <li>Julian days is fractional number of days since November 24, 4714 BCE</li>
      </ul>
    </li>
    <li><code>julianday</code> and <code>date</code> convert back and forth</li>
  </ul>

</section>
<section>

  <h2 id="count-experiments-started-per-day-without-gaps">60: count experiments started per day without gaps</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/experiments_per_day.sql">src/experiments_per_day.sql</a></p>
  <div><pre><code><span>with</span>
<span>-- complete sequence of days with 0 as placeholder for number of experiments</span>
<span>all_days</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>date</span><span>((</span><span>select</span> <span>julianday</span><span>(</span><span>min</span><span>(</span><span>started</span><span>))</span> <span>from</span> <span>experiment</span><span>)</span> <span>+</span> <span>value</span><span>)</span> <span>as</span> <span>some_day</span><span>,</span>
        <span>0</span> <span>as</span> <span>zeroes</span>
    <span>from</span> <span>(</span>
        <span>select</span> <span>value</span> <span>from</span> <span>generate_series</span><span>(</span>
            <span>(</span><span>select</span> <span>0</span><span>),</span>
            <span>(</span><span>select</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>-</span> <span>1</span> <span>from</span> <span>experiment</span><span>)</span>
        <span>)</span>
    <span>)</span>
<span>),</span>
<span>-- sequence of actual days with actual number of experiments started</span>
<span>actual_days</span> <span>as</span> <span>(</span>
    <span>select</span> <span>started</span><span>,</span> <span>count</span><span>(</span><span>started</span><span>)</span> <span>as</span> <span>num_exp</span>
    <span>from</span> <span>experiment</span>
    <span>group</span> <span>by</span> <span>started</span>
<span>)</span>
<span>-- combined by joining on day and taking actual number (if available) or zero</span>
<span>select</span>
    <span>all_days</span><span>.</span><span>some_day</span> <span>as</span> <span>day</span><span>,</span>
    <span>coalesce</span><span>(</span><span>actual_days</span><span>.</span><span>num_exp</span><span>,</span> <span>all_days</span><span>.</span><span>zeroes</span><span>)</span> <span>as</span> <span>num_exp</span>
<span>from</span>
    <span>all_days</span> <span>left</span> <span>join</span> <span>actual_days</span> <span>on</span> <span>all_days</span><span>.</span><span>some_day</span> <span>=</span> <span>actual_days</span><span>.</span><span>started</span>
<span>limit</span> <span>5</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/experiments_per_day.out">out/experiments_per_day.out</a></p>
  <div><pre><code>|    day     | num_exp |
|------------|---------|
| 2023-01-29 | 1       |
| 2023-01-30 | 1       |
| 2023-01-31 | 0       |
| 2023-02-01 | 0       |
| 2023-02-02 | 1       |
</code></pre></div>

</section>
<section>

  <h2 id="self-join">61: self join</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/self_join.sql">src/self_join.sql</a></p>
  <div><pre><code><span>with</span> <span>person</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>ident</span><span>,</span>
        <span>personal</span> <span>||</span> <span>' '</span> <span>||</span> <span>family</span> <span>as</span> <span>name</span>
    <span>from</span> <span>staff</span>
<span>)</span>
<span>select</span> <span>left</span><span>.</span><span>name</span><span>,</span> <span>right</span><span>.</span><span>name</span>
<span>from</span> <span>person</span> <span>as</span> <span>left</span> <span>join</span> <span>person</span> <span>as</span> <span>right</span>
<span>limit</span> <span>10</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/self_join.out">out/self_join.out</a></p>
  <div><pre><code>|     name     |       name       |
|--------------|------------------|
| Kartik Gupta | Kartik Gupta     |
| Kartik Gupta | Divit Dhaliwal   |
| Kartik Gupta | Indrans Sridhar  |
| Kartik Gupta | Pranay Khanna    |
| Kartik Gupta | Riaan Dua        |
| Kartik Gupta | Vedika Rout      |
| Kartik Gupta | Abram Chokshi    |
| Kartik Gupta | Romil Kapoor     |
| Kartik Gupta | Ishaan Ramaswamy |
| Kartik Gupta | Nitya Lal        |
</code></pre></div>

  <ul>
    <li>Join a table to itself
      <ul>
        <li>Use <code>as</code> to create <a href="#g:alias">aliases</a> for copies of tables to distinguish them</li>
        <li>Nothing special about the names <code>left</code> and <code>right</code></li>
      </ul>
    </li>
    <li>Get all <math>n</math><sup>2</sup> pairs, including person with themself</li>
  </ul>

</section>
<section>

  <h2 id="generate-unique-pairs">62: generate unique pairs</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/unique_pairs.sql">src/unique_pairs.sql</a></p>
  <div><pre><code><span>with</span> <span>person</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>ident</span><span>,</span>
        <span>personal</span> <span>||</span> <span>' '</span> <span>||</span> <span>family</span> <span>as</span> <span>name</span>
    <span>from</span> <span>staff</span>
<span>)</span>
<span>select</span> <span>left</span><span>.</span><span>name</span><span>,</span> <span>right</span><span>.</span><span>name</span>
<span>from</span> <span>person</span> <span>as</span> <span>left</span> <span>join</span> <span>person</span> <span>as</span> <span>right</span>
<span>on</span> <span>left</span><span>.</span><span>ident</span> <span>&lt;</span> <span>right</span><span>.</span><span>ident</span>
<span>where</span> <span>left</span><span>.</span><span>ident</span> <span>&lt;=</span> <span>4</span> <span>and</span> <span>right</span><span>.</span><span>ident</span> <span>&lt;=</span> <span>4</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/unique_pairs.out">out/unique_pairs.out</a></p>
  <div><pre><code>|      name       |      name       |
|-----------------|-----------------|
| Kartik Gupta    | Divit Dhaliwal  |
| Kartik Gupta    | Indrans Sridhar |
| Kartik Gupta    | Pranay Khanna   |
| Divit Dhaliwal  | Indrans Sridhar |
| Divit Dhaliwal  | Pranay Khanna   |
| Indrans Sridhar | Pranay Khanna   |
</code></pre></div>

  <ul>
    <li><code>left.ident &lt; right.ident</code> ensures distinct pairs without duplicates</li>
    <li>Use <code>left.ident &lt;= 4 and right.ident &lt;= 4</code> to limit output</li>
    <li>Quick check: <math>n(n-1)/2</math> pairs</li>
  </ul>

</section>
<section>

  <h2 id="filter-pairs">63: filter pairs</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/filter_pairs.sql">src/filter_pairs.sql</a></p>
  <div><pre><code><span>with</span>
<span>person</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>ident</span><span>,</span>
        <span>personal</span> <span>||</span> <span>' '</span> <span>||</span> <span>family</span> <span>as</span> <span>name</span>
    <span>from</span> <span>staff</span>
<span>),</span>
<span>together</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>left</span><span>.</span><span>staff</span> <span>as</span> <span>left_staff</span><span>,</span>
        <span>right</span><span>.</span><span>staff</span> <span>as</span> <span>right_staff</span>
    <span>from</span> <span>performed</span> <span>as</span> <span>left</span> <span>join</span> <span>performed</span> <span>as</span> <span>right</span>
    <span>on</span> <span>left</span><span>.</span><span>experiment</span> <span>=</span> <span>right</span><span>.</span><span>experiment</span>
    <span>where</span> <span>left_staff</span> <span>&lt;</span> <span>right_staff</span>
<span>)</span>
<span>select</span>
    <span>left</span><span>.</span><span>name</span> <span>as</span> <span>person_1</span><span>,</span>
    <span>right</span><span>.</span><span>name</span> <span>as</span> <span>person_2</span>
<span>from</span> <span>person</span> <span>as</span> <span>left</span> <span>join</span> <span>person</span> <span>as</span> <span>right</span> <span>join</span> <span>together</span>
<span>on</span> <span>left</span><span>.</span><span>ident</span> <span>=</span> <span>left_staff</span> <span>and</span> <span>right</span><span>.</span><span>ident</span> <span>=</span> <span>right_staff</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/filter_pairs.out">out/filter_pairs.out</a></p>
  <div><pre><code>|    person_1     |     person_2     |
|-----------------|------------------|
| Kartik Gupta    | Vedika Rout      |
| Pranay Khanna   | Vedika Rout      |
| Indrans Sridhar | Romil Kapoor     |
| Abram Chokshi   | Ishaan Ramaswamy |
| Pranay Khanna   | Vedika Rout      |
| Kartik Gupta    | Abram Chokshi    |
| Abram Chokshi   | Romil Kapoor     |
| Kartik Gupta    | Divit Dhaliwal   |
| Divit Dhaliwal  | Abram Chokshi    |
| Pranay Khanna   | Ishaan Ramaswamy |
| Indrans Sridhar | Romil Kapoor     |
| Kartik Gupta    | Ishaan Ramaswamy |
| Kartik Gupta    | Nitya Lal        |
| Kartik Gupta    | Abram Chokshi    |
| Pranay Khanna   | Romil Kapoor     |
</code></pre></div>

</section>
<section>

  

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/correlated_subquery.sql">src/correlated_subquery.sql</a></p>
  <div><pre><code><span>select</span> <span>name</span><span>,</span> <span>building</span>
<span>from</span> <span>department</span>
<span>where</span> <span>exists</span> <span>(</span>
    <span>select</span> <span>1</span>
    <span>from</span> <span>staff</span>
    <span>where</span> <span>dept</span> <span>=</span> <span>department</span><span>.</span><span>ident</span>
<span>)</span>
<span>order</span> <span>by</span> <span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/correlated_subquery.out">out/correlated_subquery.out</a></p>
  <div><pre><code>|       name        |     building     |
|-------------------|------------------|
| Genetics          | Chesson          |
| Histology         | Fashet Extension |
| Molecular Biology | Chesson          |
</code></pre></div>

  <ul>
    <li>Nobody works in Endocrinology</li>
    <li><code>select 1</code> could equally be <code>select true</code> or any other value</li>
    <li>A <a href="#g:correlated_subquery">correlated subquery</a> depends on a value from the outer query
      <ul>
        <li>Equivalent to nested loop</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="nonexistence">65: nonexistence</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/nonexistence.sql">src/nonexistence.sql</a></p>
  <div><pre><code><span>select</span> <span>name</span><span>,</span> <span>building</span>
<span>from</span> <span>department</span>
<span>where</span> <span>not</span> <span>exists</span> <span>(</span>
    <span>select</span> <span>1</span>
    <span>from</span> <span>staff</span>
    <span>where</span> <span>dept</span> <span>=</span> <span>department</span><span>.</span><span>ident</span>
<span>)</span>
<span>order</span> <span>by</span> <span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/nonexistence.out">out/nonexistence.out</a></p>
  <div><pre><code>|     name      | building |
|---------------|----------|
| Endocrinology | TGVH     |
</code></pre></div>

</section>
<section>

  

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/avoid_correlated_subqueries.sql">src/avoid_correlated_subqueries.sql</a></p>
  <div><pre><code><span>select</span> <span>distinct</span>
    <span>department</span><span>.</span><span>name</span> <span>as</span> <span>name</span><span>,</span>
    <span>department</span><span>.</span><span>building</span> <span>as</span> <span>building</span>
<span>from</span> <span>department</span> <span>join</span> <span>staff</span>
<span>on</span> <span>department</span><span>.</span><span>ident</span> <span>=</span> <span>staff</span><span>.</span><span>dept</span>
<span>order</span> <span>by</span> <span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/avoid_correlated_subqueries.out">out/avoid_correlated_subqueries.out</a></p>
  <div><pre><code>|       name        |     building     |
|-------------------|------------------|
| Genetics          | Chesson          |
| Histology         | Fashet Extension |
| Molecular Biology | Chesson          |
</code></pre></div>

  <ul>
    <li>The join might or might not be faster than the correlated subquery</li>
    <li>Hard to find unstaffed departments without either <code>not exists</code> or <code>count</code> and a check for 0</li>
  </ul>

</section>
<section>

  <h2 id="lead-and-lag">66: lead and lag</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/lead_lag.sql">src/lead_lag.sql</a></p>
  <div><pre><code><span>with</span> <span>ym_num</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>strftime</span><span>(</span><span>'%Y-%m'</span><span>,</span> <span>started</span><span>)</span> <span>as</span> <span>ym</span><span>,</span>
        <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
    <span>from</span> <span>experiment</span>
    <span>group</span> <span>by</span> <span>ym</span>
<span>)</span>
<span>select</span>
    <span>ym</span><span>,</span>
    <span>lag</span><span>(</span><span>num</span><span>)</span> <span>over</span> <span>(</span><span>order</span> <span>by</span> <span>ym</span><span>)</span> <span>as</span> <span>prev_num</span><span>,</span>
    <span>num</span><span>,</span>
    <span>lead</span><span>(</span><span>num</span><span>)</span> <span>over</span> <span>(</span><span>order</span> <span>by</span> <span>ym</span><span>)</span> <span>as</span> <span>next_num</span>
<span>from</span> <span>ym_num</span>
<span>order</span> <span>by</span> <span>ym</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/lead_lag.out">out/lead_lag.out</a></p>
  <div><pre><code>|   ym    | prev_num | num | next_num |
|---------|----------|-----|----------|
| 2023-01 |          | 2   | 5        |
| 2023-02 | 2        | 5   | 5        |
| 2023-03 | 5        | 5   | 1        |
| 2023-04 | 5        | 1   | 6        |
| 2023-05 | 1        | 6   | 5        |
| 2023-06 | 6        | 5   | 3        |
| 2023-07 | 5        | 3   | 2        |
| 2023-08 | 3        | 2   | 4        |
| 2023-09 | 2        | 4   | 6        |
| 2023-10 | 4        | 6   | 4        |
| 2023-12 | 6        | 4   | 5        |
| 2024-01 | 4        | 5   | 2        |
| 2024-02 | 5        | 2   |          |
</code></pre></div>

  <ul>
    <li>Use <code>strftime</code> to extract year and month
      <ul>
        <li>Clumsy, but date/time handling is not SQLite’s strong point</li>
      </ul>
    </li>
    <li>Use <a href="#g:window_func">window functions</a> <code>lead</code> and <code>lag</code> to shift values
      <ul>
        <li>Unavailable values are null</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="window-functions">67: window functions</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/window_functions.sql">src/window_functions.sql</a></p>
  <div><pre><code><span>with</span> <span>ym_num</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>strftime</span><span>(</span><span>'%Y-%m'</span><span>,</span> <span>started</span><span>)</span> <span>as</span> <span>ym</span><span>,</span>
        <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
    <span>from</span> <span>experiment</span>
    <span>group</span> <span>by</span> <span>ym</span>
<span>)</span>
<span>select</span>
    <span>ym</span><span>,</span>
    <span>num</span><span>,</span>
    <span>sum</span><span>(</span><span>num</span><span>)</span> <span>over</span> <span>(</span><span>order</span> <span>by</span> <span>ym</span><span>)</span> <span>as</span> <span>num_done</span><span>,</span>
    <span>cume_dist</span><span>()</span> <span>over</span> <span>(</span><span>order</span> <span>by</span> <span>ym</span><span>)</span> <span>as</span> <span>progress</span>
<span>from</span> <span>ym_num</span>
<span>order</span> <span>by</span> <span>ym</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/window_functions.out">out/window_functions.out</a></p>
  <div><pre><code>|   ym    | num | num_done |      progress      |
|---------|-----|----------|--------------------|
| 2023-01 | 2   | 2        | 0.0769230769230769 |
| 2023-02 | 5   | 7        | 0.153846153846154  |
| 2023-03 | 5   | 12       | 0.230769230769231  |
| 2023-04 | 1   | 13       | 0.307692307692308  |
| 2023-05 | 6   | 19       | 0.384615384615385  |
| 2023-06 | 5   | 24       | 0.461538461538462  |
| 2023-07 | 3   | 27       | 0.538461538461538  |
| 2023-08 | 2   | 29       | 0.615384615384615  |
| 2023-09 | 4   | 33       | 0.692307692307692  |
| 2023-10 | 6   | 39       | 0.769230769230769  |
| 2023-12 | 4   | 43       | 0.846153846153846  |
| 2024-01 | 5   | 48       | 0.923076923076923  |
| 2024-02 | 2   | 50       | 1.0                |
</code></pre></div>

  <ul>
    <li><code>sum() over</code> does a running total</li>
    <li><code>cume_dist</code> is fraction <em>of rows seen so far</em></li>
  </ul>

</section>
<section>

  <h2 id="explain-another-query-plain">☆ explain another query plain</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/explain_window_function.sql">src/explain_window_function.sql</a></p>
  <div><pre><code><span>explain</span> <span>query</span> <span>plan</span>
<span>with</span> <span>ym_num</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>strftime</span><span>(</span><span>'%Y-%m'</span><span>,</span> <span>started</span><span>)</span> <span>as</span> <span>ym</span><span>,</span>
        <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
    <span>from</span> <span>experiment</span>
    <span>group</span> <span>by</span> <span>ym</span>
<span>)</span>
<span>select</span>
    <span>ym</span><span>,</span>
    <span>num</span><span>,</span>
    <span>sum</span><span>(</span><span>num</span><span>)</span> <span>over</span> <span>(</span><span>order</span> <span>by</span> <span>ym</span><span>)</span> <span>as</span> <span>num_done</span><span>,</span>
    <span>cume_dist</span><span>()</span> <span>over</span> <span>(</span><span>order</span> <span>by</span> <span>ym</span><span>)</span> <span>as</span> <span>progress</span>
<span>from</span> <span>ym_num</span>
<span>order</span> <span>by</span> <span>ym</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/explain_window_function.out">out/explain_window_function.out</a></p>
  <div><pre><code>QUERY PLAN
|--CO-ROUTINE (subquery-3)
|  |--CO-ROUTINE (subquery-4)
|  |  |--CO-ROUTINE ym_num
|  |  |  |--SCAN experiment
|  |  |  `--USE TEMP B-TREE FOR GROUP BY
|  |  |--SCAN ym_num
|  |  `--USE TEMP B-TREE FOR ORDER BY
|  `--SCAN (subquery-4)
`--SCAN (subquery-3)
</code></pre></div>

  <ul>
    <li>Becomes useful…eventually</li>
  </ul>

</section>
<section>

  <h2 id="partitioned-windows">68: partitioned windows</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/partition_window.sql">src/partition_window.sql</a></p>
  <div><pre><code><span>with</span> <span>y_m_num</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>strftime</span><span>(</span><span>'%Y'</span><span>,</span> <span>started</span><span>)</span> <span>as</span> <span>year</span><span>,</span>
        <span>strftime</span><span>(</span><span>'%m'</span><span>,</span> <span>started</span><span>)</span> <span>as</span> <span>month</span><span>,</span>
        <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
    <span>from</span> <span>experiment</span>
    <span>group</span> <span>by</span> <span>year</span><span>,</span> <span>month</span>
<span>)</span>
<span>select</span>
    <span>year</span><span>,</span>
    <span>month</span><span>,</span>
    <span>num</span><span>,</span>
    <span>sum</span><span>(</span><span>num</span><span>)</span> <span>over</span> <span>(</span><span>partition</span> <span>by</span> <span>year</span> <span>order</span> <span>by</span> <span>month</span><span>)</span> <span>as</span> <span>num_done</span>
<span>from</span> <span>y_m_num</span>
<span>order</span> <span>by</span> <span>year</span><span>,</span> <span>month</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/partition_window.out">out/partition_window.out</a></p>
  <div><pre><code>| year | month | num | num_done |
|------|-------|-----|----------|
| 2023 | 01    | 2   | 2        |
| 2023 | 02    | 5   | 7        |
| 2023 | 03    | 5   | 12       |
| 2023 | 04    | 1   | 13       |
| 2023 | 05    | 6   | 19       |
| 2023 | 06    | 5   | 24       |
| 2023 | 07    | 3   | 27       |
| 2023 | 08    | 2   | 29       |
| 2023 | 09    | 4   | 33       |
| 2023 | 10    | 6   | 39       |
| 2023 | 12    | 4   | 43       |
| 2024 | 01    | 5   | 5        |
| 2024 | 02    | 2   | 7        |
</code></pre></div>

  <ul>
    <li><code>partition by</code> creates groups</li>
    <li>So this counts experiments started since the beginning of each year</li>
  </ul>

</section>
<section>

  <h2 id="blobs">69: blobs</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/blob.sql">src/blob.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>images</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>content</span> <span>blob</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>images</span><span>(</span><span>name</span><span>,</span> <span>content</span><span>)</span> <span>values</span>
    <span>(</span><span>"biohazard"</span><span>,</span> <span>readfile</span><span>(</span><span>"img/biohazard.png"</span><span>)),</span>
    <span>(</span><span>"crush"</span><span>,</span> <span>readfile</span><span>(</span><span>"img/crush.png"</span><span>)),</span>
    <span>(</span><span>"fire"</span><span>,</span> <span>readfile</span><span>(</span><span>"img/fire.png"</span><span>)),</span>
    <span>(</span><span>"radioactive"</span><span>,</span> <span>readfile</span><span>(</span><span>"img/radioactive.png"</span><span>)),</span>
    <span>(</span><span>"tripping"</span><span>,</span> <span>readfile</span><span>(</span><span>"img/tripping.png"</span><span>));</span>

<span>select</span> <span>name</span><span>,</span> <span>length</span><span>(</span><span>content</span><span>)</span> <span>from</span> <span>images</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/blob.out">out/blob.out</a></p>
  <div><pre><code>|    name     | length(content) |
|-------------|-----------------|
| biohazard   | 19629           |
| crush       | 15967           |
| fire        | 18699           |
| radioactive | 16661           |
| tripping    | 17208           |
</code></pre></div>

  <ul>
    <li>A <a href="#g:blob">blob</a> is a binary large object
      <ul>
        <li>Bytes in, bytes out…</li>
      </ul>
    </li>
    <li>If you think that’s odd, check out <a href="https://fossil-scm.org/">Fossil</a></li>
  </ul>

</section>
<section>

  <h2 id="yet-another-database-1">☆ yet another database</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/lab_log_db.sh">src/lab_log_db.sh</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/lab_log_schema.sql">src/lab_log_schema.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/lab_log_schema.out">out/lab_log_schema.out</a></p>
  <div><pre><code>CREATE TABLE sqlite_sequence(name,seq);
CREATE TABLE person(
       ident            integer primary key autoincrement,
       details          text not null
);
CREATE TABLE machine(
       ident            integer primary key autoincrement,
       name             text not null,
       details          text not null
);
CREATE TABLE usage(
       ident            integer primary key autoincrement,
       log              text not null
);
</code></pre></div>

</section>
<section>

  <h2 id="store-json">70: store JSON</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/json_in_table.sql">src/json_in_table.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/json_in_table.out">out/json_in_table.out</a></p>
  <div><pre><code>| ident |      name      |                         details                         |
|-------|----------------|---------------------------------------------------------|
| 1     | WY401          | {"acquired": "2023-05-01"}                              |
| 2     | Inphormex      | {"acquired": "2021-07-15", "refurbished": "2023-10-22"} |
| 3     | AutoPlate 9000 | {"note": "needs software update"}                       |
</code></pre></div>

  <ul>
    <li>Store heterogeneous data as JSON-formatted text (with double-quoted strings)
      <ul>
        <li>Database parses it each time it is queried</li>
      </ul>
    </li>
    <li>Alternatively store as blob
      <ul>
        <li>Can’t just view it</li>
        <li>But more efficient</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="select-field-from-json">71: select field from JSON</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/json_field.sql">src/json_field.sql</a></p>
  <div><pre><code><span>select</span>
    <span>details</span><span>-&gt;</span><span>'$.acquired'</span> <span>as</span> <span>single_arrow</span><span>,</span>
    <span>details</span><span>-&gt;&gt;</span><span>'$.acquired'</span> <span>as</span> <span>double_arrow</span>
<span>from</span> <span>machine</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/json_field.out">out/json_field.out</a></p>
  <div><pre><code>| single_arrow | double_arrow |
|--------------|--------------|
| "2023-05-01" | 2023-05-01   |
| "2021-07-15" | 2021-07-15   |
|              |              |
</code></pre></div>

  <ul>
    <li>Single arrow <code>-&gt;</code> returns JSON representation result</li>
    <li>Double arrow <code>-&gt;&gt;</code> returns SQL text, integer, real, or null</li>
    <li>Left side is column</li>
    <li>Right side is <a href="#g:path_expression">path expression</a>
      <ul>
        <li>Start with <code>$</code> (meaning “root”)</li>
        <li>Fields separated by <code>.</code></li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="json-array-access">72: JSON array access</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/json_array.sql">src/json_array.sql</a></p>
  <div><pre><code><span>select</span>
    <span>ident</span><span>,</span>
    <span>json_array_length</span><span>(</span><span>log</span><span>-&gt;</span><span>'$'</span><span>)</span> <span>as</span> <span>length</span><span>,</span>
    <span>log</span><span>-&gt;</span><span>'$[0]'</span> <span>as</span> <span>first</span>
<span>from</span> <span>usage</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/json_array.out">out/json_array.out</a></p>
  <div><pre><code>| ident | length |                            first                             |
|-------|--------|--------------------------------------------------------------|
| 1     | 4      | {"machine":"Inphormex","person":["Gabrielle","Dub\u00e9"]}   |
| 2     | 5      | {"machine":"Inphormex","person":["Marianne","Richer"]}       |
| 3     | 2      | {"machine":"sterilizer","person":["Josette","Villeneuve"]}   |
| 4     | 1      | {"machine":"sterilizer","person":["Maude","Goulet"]}         |
| 5     | 2      | {"machine":"AutoPlate 9000","person":["Brigitte","Michaud"]} |
| 6     | 1      | {"machine":"sterilizer","person":["Marianne","Richer"]}      |
| 7     | 3      | {"machine":"WY401","person":["Maude","Goulet"]}              |
| 8     | 1      | {"machine":"AutoPlate 9000"}                                 |
</code></pre></div>

  <ul>
    <li>SQLite (and other database managers) has lots of JSON manipulation functions</li>
    <li><code>json_array_length</code> gives number of elements in selected array</li>
    <li>subscripts start with 0</li>
    <li>Characters outside 7-bit ASCII represented as Unicode escapes</li>
  </ul>

</section>
<section>

  <h2 id="unpack-json-array">73: unpack JSON array</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/json_unpack.sql">src/json_unpack.sql</a></p>
  <div><pre><code><span>select</span>
    <span>ident</span><span>,</span>
    <span>json_each</span><span>.</span><span>key</span> <span>as</span> <span>key</span><span>,</span>
    <span>json_each</span><span>.</span><span>value</span> <span>as</span> <span>value</span>
<span>from</span> <span>usage</span><span>,</span> <span>json_each</span><span>(</span><span>usage</span><span>.</span><span>log</span><span>)</span>
<span>limit</span> <span>10</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/json_unpack.out">out/json_unpack.out</a></p>
  <div><pre><code>| ident | key |                            value                             |
|-------|-----|--------------------------------------------------------------|
| 1     | 0   | {"machine":"Inphormex","person":["Gabrielle","Dub\u00e9"]}   |
| 1     | 1   | {"machine":"Inphormex","person":["Gabrielle","Dub\u00e9"]}   |
| 1     | 2   | {"machine":"WY401","person":["Gabrielle","Dub\u00e9"]}       |
| 1     | 3   | {"machine":"Inphormex","person":["Gabrielle","Dub\u00e9"]}   |
| 2     | 0   | {"machine":"Inphormex","person":["Marianne","Richer"]}       |
| 2     | 1   | {"machine":"AutoPlate 9000","person":["Marianne","Richer"]}  |
| 2     | 2   | {"machine":"sterilizer","person":["Marianne","Richer"]}      |
| 2     | 3   | {"machine":"AutoPlate 9000","person":["Monique","Marcotte"]} |
| 2     | 4   | {"machine":"sterilizer","person":["Marianne","Richer"]}      |
| 3     | 0   | {"machine":"sterilizer","person":["Josette","Villeneuve"]}   |
</code></pre></div>

  <ul>
    <li><code>json_each</code> is another table-valued function</li>
    <li>Use <code>json_each.<em>name</em></code> to get properties of unpacked array</li>
  </ul>

</section>
<section>

  <h2 id="last-element-of-array">74: last element of array</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/json_array_last.sql">src/json_array_last.sql</a></p>
  <div><pre><code><span>select</span>
    <span>ident</span><span>,</span>
    <span>log</span><span>-&gt;</span><span>'$[#-1].machine'</span> <span>as</span> <span>final</span>
<span>from</span> <span>usage</span>
<span>limit</span> <span>5</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/json_array_last.out">out/json_array_last.out</a></p>
  <div><pre><code>| ident |    final     |
|-------|--------------|
| 1     | "Inphormex"  |
| 2     | "sterilizer" |
| 3     | "Inphormex"  |
| 4     | "sterilizer" |
| 5     | "sterilizer" |
</code></pre></div>

</section>
<section>

  <h2 id="modify-json">75: modify JSON</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/json_modify.sql">src/json_modify.sql</a></p>
  <div><pre><code><span>select</span>
    <span>ident</span><span>,</span>
    <span>name</span><span>,</span>
    <span>json_set</span><span>(</span><span>details</span><span>,</span> <span>'$.sold'</span><span>,</span> <span>json_quote</span><span>(</span><span>'2024-01-25'</span><span>))</span> <span>as</span> <span>updated</span>
<span>from</span> <span>machine</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/json_modify.out">out/json_modify.out</a></p>
  <div><pre><code>| ident |      name      |                           updated                            |
|-------|----------------|--------------------------------------------------------------|
| 1     | WY401          | {"acquired":"2023-05-01","sold":"2024-01-25"}                |
| 2     | Inphormex      | {"acquired":"2021-07-15","refurbished":"2023-10-22","sold":" |
|       |                | 2024-01-25"}                                                 |
| 3     | AutoPlate 9000 | {"note":"needs software update","sold":"2024-01-25"}         |
</code></pre></div>

  <ul>
    <li>Updates the in-memory copy of the JSON, <em>not</em> the database record</li>
    <li>Please use <code>json_quote</code> rather than trying to format JSON with string operations</li>
  </ul>

</section>
<section>

  <h2 id="refresh-penguins">☆ refresh penguins</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/count_penguins.sql">src/count_penguins.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
<span>from</span> <span>penguins</span>
<span>group</span> <span>by</span> <span>species</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/count_penguins.out">out/count_penguins.out</a></p>
  <div><pre><code>|  species  | num |
|-----------|-----|
| Adelie    | 152 |
| Chinstrap | 68  |
| Gentoo    | 124 |
</code></pre></div>

  <ul>
    <li>We will restore full database after each example</li>
  </ul>

</section>
<section>

  <h2 id="tombstones">76: tombstones</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/make_active.sql">src/make_active.sql</a></p>
  <div><pre><code><span>alter</span> <span>table</span> <span>penguins</span>
<span>add</span> <span>active</span> <span>integer</span> <span>not</span> <span>null</span> <span>default</span> <span>1</span><span>;</span>

<span>update</span> <span>penguins</span>
<span>set</span> <span>active</span> <span>=</span> <span>iif</span><span>(</span><span>species</span> <span>=</span> <span>'Adelie'</span><span>,</span> <span>0</span><span>,</span> <span>1</span><span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/active_penguins.sql">src/active_penguins.sql</a></p>
  <div><pre><code><span>select</span> <span>species</span><span>,</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>active</span>
<span>group</span> <span>by</span> <span>species</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/active_penguins.out">out/active_penguins.out</a></p>
  <div><pre><code>|  species  | num |
|-----------|-----|
| Chinstrap | 68  |
| Gentoo    | 124 |
</code></pre></div>

  <ul>
    <li>Use a <a href="#g:tombstone">tombstone</a> to mark (in)active records</li>
    <li>Every query must now include it</li>
  </ul>

</section>
<section>

  <h2 id="views">77: views</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/views.sql">src/views.sql</a></p>
  <div><pre><code><span>create</span> <span>view</span> <span>if</span> <span>not</span> <span>exists</span>
<span>active_penguins</span> <span>(</span>
    <span>species</span><span>,</span>
    <span>island</span><span>,</span>
    <span>bill_length_mm</span><span>,</span>
    <span>bill_depth_mm</span><span>,</span>
    <span>flipper_length_mm</span><span>,</span>
    <span>body_mass_g</span><span>,</span>
    <span>sex</span>
<span>)</span> <span>as</span>
<span>select</span>
    <span>species</span><span>,</span>
    <span>island</span><span>,</span>
    <span>bill_length_mm</span><span>,</span>
    <span>bill_depth_mm</span><span>,</span>
    <span>flipper_length_mm</span><span>,</span>
    <span>body_mass_g</span><span>,</span>
    <span>sex</span>
<span>from</span> <span>penguins</span>
<span>where</span> <span>active</span><span>;</span>

<span>select</span> <span>species</span><span>,</span> <span>count</span><span>(</span><span>*</span><span>)</span> <span>as</span> <span>num</span>
<span>from</span> <span>active_penguins</span>
<span>group</span> <span>by</span> <span>species</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/views.out">out/views.out</a></p>
  <div><pre><code>|  species  | num |
|-----------|-----|
| Chinstrap | 68  |
| Gentoo    | 124 |
</code></pre></div>

  <ul>
    <li>A <a href="#g:view">view</a> is a saved query that other queries can invoke</li>
    <li>View is re-run each time it’s used</li>
    <li>Like a CTE, but:
      <ul>
        <li>Can be shared between queries</li>
        <li>Views came first</li>
      </ul>
    </li>
    <li>Some databases offer <a href="#g:materialized_view">materialized views</a>
      <ul>
        <li>Update-on-demand temporary tables</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="hours-reminder">☆ hours reminder</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/all_jobs.sql">src/all_jobs.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>billable</span> <span>real</span> <span>not</span> <span>null</span>
<span>);</span>
<span>insert</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'calibrate'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>),</span>
    <span>(</span><span>'clean'</span><span>,</span> <span>0</span><span>.</span><span>5</span><span>);</span>
<span>select</span> <span>*</span> <span>from</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/all_jobs.out">out/all_jobs.out</a></p>
  <div><pre><code>|   name    | billable |
|-----------|----------|
| calibrate | 1.5      |
| clean     | 0.5      |
</code></pre></div>

</section>
<section>

  <h2 id="add-check">78: add check</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/all_jobs_check.sql">src/all_jobs_check.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>billable</span> <span>real</span> <span>not</span> <span>null</span><span>,</span>
    <span>check</span> <span>(</span><span>billable</span> <span>&gt;</span> <span>0</span><span>.</span><span>0</span><span>)</span>
<span>);</span>
<span>insert</span> <span>into</span> <span>job</span> <span>values</span> <span>(</span><span>'calibrate'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>);</span>
<span>insert</span> <span>into</span> <span>job</span> <span>values</span> <span>(</span><span>'reset'</span><span>,</span> <span>-</span><span>0</span><span>.</span><span>5</span><span>);</span>
<span>select</span> <span>*</span> <span>from</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/all_jobs_check.out">out/all_jobs_check.out</a></p>
  <div><pre><code>Runtime error near line 9: CHECK constraint failed: billable &gt; 0.0 (19)
|   name    | billable |
|-----------|----------|
| calibrate | 1.5      |
</code></pre></div>

  <ul>
    <li><code>check</code> adds constraint to table
      <ul>
        <li>Must produce a Boolean result</li>
        <li>Run each time values added or modified</li>
      </ul>
    </li>
    <li>But changes made before the error have taken effect</li>
  </ul>

</section>
<section>

  <h2 id="acid">☆ ACID</h2>

  <ul>
    <li><a href="#g:atomic">Atomic</a>: change cannot be broken down into smaller ones (i.e., all or nothing)</li>
    <li><a href="#g:consistent">Consistent</a>: database goes from one consistent state to another</li>
    <li><a href="#g:isolated">Isolated</a>: looks like changes happened one after another</li>
    <li><a href="#g:durable">Durable</a>: if change takes place, it’s still there after a restart</li>
  </ul>

</section>
<section>

  <h2 id="transactions">79: transactions</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/transaction.sql">src/transaction.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>billable</span> <span>real</span> <span>not</span> <span>null</span><span>,</span>
    <span>check</span> <span>(</span><span>billable</span> <span>&gt;</span> <span>0</span><span>.</span><span>0</span><span>)</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>job</span> <span>values</span> <span>(</span><span>'calibrate'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>);</span>

<span>begin</span> <span>transaction</span><span>;</span>
<span>insert</span> <span>into</span> <span>job</span> <span>values</span> <span>(</span><span>'clean'</span><span>,</span> <span>0</span><span>.</span><span>5</span><span>);</span>
<span>rollback</span><span>;</span>

<span>select</span> <span>*</span> <span>from</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/transaction.out">out/transaction.out</a></p>
  <div><pre><code>|   name    | billable |
|-----------|----------|
| calibrate | 1.5      |
</code></pre></div>

  <ul>
    <li>Statements outside transaction execute and are committed immediately</li>
    <li>Statement(s) inside transaction don’t take effect until:
      <ul>
        <li><code>end transaction</code> (success)</li>
        <li><code>rollback</code> (undo)</li>
      </ul>
    </li>
    <li>Can have any number of statements inside a transaction</li>
    <li>But <em>cannot</em> nest transactions in SQLite
      <ul>
        <li>Other databases support this</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="rollback-in-constraint">80: rollback in constraint</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/rollback_constraint.sql">src/rollback_constraint.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>billable</span> <span>real</span> <span>not</span> <span>null</span><span>,</span>
    <span>check</span> <span>(</span><span>billable</span> <span>&gt;</span> <span>0</span><span>.</span><span>0</span><span>)</span> <span>on</span> <span>conflict</span> <span>rollback</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'calibrate'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>);</span>
<span>insert</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'clean'</span><span>,</span> <span>0</span><span>.</span><span>5</span><span>),</span>
    <span>(</span><span>'reset'</span><span>,</span> <span>-</span><span>0</span><span>.</span><span>5</span><span>);</span>

<span>select</span> <span>*</span> <span>from</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/rollback_constraint.out">out/rollback_constraint.out</a></p>
  <div><pre><code>Runtime error near line 11: CHECK constraint failed: billable &gt; 0.0 (19)
|   name    | billable |
|-----------|----------|
| calibrate | 1.5      |
</code></pre></div>

  <ul>
    <li>All of second <code>insert</code> rolled back as soon as error occurred</li>
    <li>But first <code>insert</code> took effect</li>
  </ul>

</section>
<section>

  <h2 id="rollback-in-statement">81: rollback in statement</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/rollback_statement.sql">src/rollback_statement.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>name</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>billable</span> <span>real</span> <span>not</span> <span>null</span><span>,</span>
    <span>check</span> <span>(</span><span>billable</span> <span>&gt;</span> <span>0</span><span>.</span><span>0</span><span>)</span>
<span>);</span>

<span>insert</span> <span>or</span> <span>rollback</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'calibrate'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>);</span>
<span>insert</span> <span>or</span> <span>rollback</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'clean'</span><span>,</span> <span>0</span><span>.</span><span>5</span><span>),</span>
    <span>(</span><span>'reset'</span><span>,</span> <span>-</span><span>0</span><span>.</span><span>5</span><span>);</span>

<span>select</span> <span>*</span> <span>from</span> <span>job</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/rollback_statement.out">out/rollback_statement.out</a></p>
  <div><pre><code>Runtime error near line 11: CHECK constraint failed: billable &gt; 0.0 (19)
|   name    | billable |
|-----------|----------|
| calibrate | 1.5      |
</code></pre></div>

  <ul>
    <li>Constraint is in table definition</li>
    <li>Action is in statement</li>
  </ul>

</section>
<section>

  <h2 id="upsert">82: upsert</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/upsert.sql">src/upsert.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>jobs_done</span> <span>(</span>
    <span>person</span> <span>text</span> <span>unique</span><span>,</span>
    <span>num</span> <span>integer</span> <span>default</span> <span>0</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>jobs_done</span> <span>values</span><span>(</span><span>"zia"</span><span>,</span> <span>1</span><span>);</span>
<span>.</span><span>print</span> <span>"after first"</span>
<span>select</span> <span>*</span> <span>from</span> <span>jobs_done</span><span>;</span>
<span>.</span><span>print</span>


<span>insert</span> <span>into</span> <span>jobs_done</span> <span>values</span><span>(</span><span>"zia"</span><span>,</span> <span>1</span><span>);</span>
<span>.</span><span>print</span> <span>"after failed"</span>
<span>select</span> <span>*</span> <span>from</span> <span>jobs_done</span><span>;</span>

<span>insert</span> <span>into</span> <span>jobs_done</span> <span>values</span><span>(</span><span>"zia"</span><span>,</span> <span>1</span><span>)</span>
    <span>on</span> <span>conflict</span><span>(</span><span>person</span><span>)</span> <span>do</span> <span>update</span> <span>set</span> <span>num</span> <span>=</span> <span>num</span> <span>+</span> <span>1</span><span>;</span>
<span>.</span><span>print</span> <span>"</span><span>\n</span><span>after upsert"</span>
<span>select</span> <span>*</span> <span>from</span> <span>jobs_done</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/upsert.out">out/upsert.out</a></p>
  <div><pre><code>after first
| person | num |
|--------|-----|
| zia    | 1   |

Runtime error near line 14: UNIQUE constraint failed: jobs_done.person (19)
after failed
| person | num |
|--------|-----|
| zia    | 1   |

after upsert
| person | num |
|--------|-----|
| zia    | 2   |
</code></pre></div>

  <ul>
    <li><a href="#g:upsert">upsert</a> stands for “update or insert”
      <ul>
        <li>Create if record doesn’t exist</li>
        <li>Update if it does</li>
      </ul>
    </li>
    <li>Not standard SQL but widely implemented</li>
    <li>Example also shows use of SQLite <code>.print</code> command</li>
  </ul>

</section>
<section>

  <h2 id="normalization">☆ normalization</h2>

  <ul>
    <li>
      <p>First <a href="#g:normal_form">normal form</a> (1NF):
every field of every record contains one indivisible value.</p>
    </li>
    <li>
      <p>Second normal form (2NF) and third normal form (3NF):
every value in a record that isn’t a key depends solely on the key,
not on other values.</p>
    </li>
    <li>
      <p><a href="#g:denormalization">Denormalization</a>: explicitly store values that could be calculated on the fly</p>
      <ul>
        <li>To simplify queries and/or make processing faster</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="create-trigger">83: create trigger</h2>

  <ul>
    <li>A <a href="#g:trigger">trigger</a> automatically runs before or after a specified operation</li>
    <li>Can have side effects (e.g., update some other table)</li>
    <li>And/or implement checks (e.g., make sure other records exist)</li>
    <li>Add processing overhead…</li>
    <li>…but data is either cheap or correct, never both</li>
    <li>Inside trigger, refer to old and new versions of record
as <code>old.<em>column</em></code> and <code>new.<em>column</em></code></li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/trigger_setup.sql">src/trigger_setup.sql</a></p>
  <div><pre><code><span>-- Track hours of lab work.</span>
<span>create</span> <span>table</span> <span>job</span> <span>(</span>
    <span>person</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>reported</span> <span>real</span> <span>not</span> <span>null</span> <span>check</span> <span>(</span><span>reported</span> <span>&gt;=</span> <span>0</span><span>.</span><span>0</span><span>)</span>
<span>);</span>

<span>-- Explicitly store per-person total rather than using sum().</span>
<span>create</span> <span>table</span> <span>total</span> <span>(</span>
    <span>person</span> <span>text</span> <span>unique</span> <span>not</span> <span>null</span><span>,</span>
    <span>hours</span> <span>real</span>
<span>);</span>

<span>-- Initialize totals.</span>
<span>insert</span> <span>into</span> <span>total</span> <span>values</span>
    <span>(</span><span>"gene"</span><span>,</span> <span>0</span><span>.</span><span>0</span><span>),</span>
    <span>(</span><span>"august"</span><span>,</span> <span>0</span><span>.</span><span>0</span><span>);</span>

<span>-- Define a trigger.</span>
<span>create</span> <span>trigger</span> <span>total_trigger</span>
<span>before</span> <span>insert</span> <span>on</span> <span>job</span>
<span>begin</span>
    <span>-- Check that the person exists.</span>
    <span>select</span> <span>case</span>
        <span>when</span> <span>not</span> <span>exists</span> <span>(</span><span>select</span> <span>1</span> <span>from</span> <span>total</span> <span>where</span> <span>person</span> <span>=</span> <span>new</span><span>.</span><span>person</span><span>)</span>
        <span>then</span> <span>raise</span><span>(</span><span>rollback</span><span>,</span> <span>'Unknown person '</span><span>)</span>
    <span>end</span><span>;</span>
    <span>-- Update their total hours (or fail if non-negative constraint violated).</span>
    <span>update</span> <span>total</span>
    <span>set</span> <span>hours</span> <span>=</span> <span>hours</span> <span>+</span> <span>new</span><span>.</span><span>reported</span>
    <span>where</span> <span>total</span><span>.</span><span>person</span> <span>=</span> <span>new</span><span>.</span><span>person</span><span>;</span>
<span>end</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/trigger_successful.sql">src/trigger_successful.sql</a></p>
  <div><pre><code><span>insert</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'gene'</span><span>,</span> <span>1</span><span>.</span><span>5</span><span>),</span>
    <span>(</span><span>'august'</span><span>,</span> <span>0</span><span>.</span><span>5</span><span>),</span>
    <span>(</span><span>'gene'</span><span>,</span> <span>1</span><span>.</span><span>0</span><span>)</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/trigger_successful.out">out/trigger_successful.out</a></p>
  <div><pre><code>| person | reported |
|--------|----------|
| gene   | 1.5      |
| august | 0.5      |
| gene   | 1.0      |

| person | hours |
|--------|-------|
| gene   | 2.5   |
| august | 0.5   |
</code></pre></div>

</section>
<section>

  <h2 id="trigger-firing">081: trigger firing</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/trigger_firing.sql">src/trigger_firing.sql</a></p>
  <div><pre><code><span>insert</span> <span>into</span> <span>job</span> <span>values</span>
    <span>(</span><span>'gene'</span><span>,</span> <span>1</span><span>.</span><span>0</span><span>),</span>
    <span>(</span><span>'august'</span><span>,</span> <span>-</span><span>1</span><span>.</span><span>0</span><span>)</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/trigger_firing.out">out/trigger_firing.out</a></p>
  <div><pre><code>Runtime error near line 6: CHECK constraint failed: reported &gt;= 0.0 (19)

| person | hours |
|--------|-------|
| gene   | 0.0   |
| august | 0.0   |
</code></pre></div>

</section>
<section>

  <h2 id="represent-graphs">☆ represent graphs</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/lineage_setup.sql">src/lineage_setup.sql</a></p>
  <div><pre><code><span>create</span> <span>table</span> <span>lineage</span> <span>(</span>
    <span>parent</span> <span>text</span> <span>not</span> <span>null</span><span>,</span>
    <span>child</span> <span>text</span> <span>not</span> <span>null</span>
<span>);</span>
<span>insert</span> <span>into</span> <span>lineage</span> <span>values</span>
    <span>(</span><span>'Arturo'</span><span>,</span> <span>'Clemente'</span><span>),</span>
    <span>(</span><span>'Darío'</span><span>,</span> <span>'Clemente'</span><span>),</span>
    <span>(</span><span>'Clemente'</span><span>,</span> <span>'Homero'</span><span>),</span>
    <span>(</span><span>'Clemente'</span><span>,</span> <span>'Ivonne'</span><span>),</span>
    <span>(</span><span>'Ivonne'</span><span>,</span> <span>'Lourdes'</span><span>),</span>
    <span>(</span><span>'Soledad'</span><span>,</span> <span>'Lourdes'</span><span>),</span>
    <span>(</span><span>'Lourdes'</span><span>,</span> <span>'Santiago'</span><span>);</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/represent_graph.sql">src/represent_graph.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/represent_graph.out">out/represent_graph.out</a></p>
  <div><pre><code>|  parent  |  child   |
|----------|----------|
| Arturo   | Clemente |
| Darío    | Clemente |
| Clemente | Homero   |
| Clemente | Ivonne   |
| Ivonne   | Lourdes  |
| Soledad  | Lourdes  |
| Lourdes  | Santiago |
</code></pre></div>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/lineage.svg" alt="lineage diagram"></p>

</section>
<section>

  <h2 id="recursive-query">84: recursive query</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/recursive_lineage.sql">src/recursive_lineage.sql</a></p>
  <div><pre><code><span>with</span> <span>recursive</span> <span>descendent</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>'Clemente'</span> <span>as</span> <span>person</span><span>,</span>
        <span>0</span> <span>as</span> <span>generations</span>
    <span>union</span> <span>all</span>
    <span>select</span>
        <span>lineage</span><span>.</span><span>child</span> <span>as</span> <span>person</span><span>,</span>
        <span>descendent</span><span>.</span><span>generations</span> <span>+</span> <span>1</span> <span>as</span> <span>generations</span>
    <span>from</span> <span>descendent</span> <span>join</span> <span>lineage</span>
    <span>on</span> <span>descendent</span><span>.</span><span>person</span> <span>=</span> <span>lineage</span><span>.</span><span>parent</span>
<span>)</span>
<span>select</span> <span>person</span><span>,</span> <span>generations</span> <span>from</span> <span>descendent</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/recursive_lineage.out">out/recursive_lineage.out</a></p>
  <div><pre><code>|  person  | generations |
|----------|-------------|
| Clemente | 0           |
| Homero   | 1           |
| Ivonne   | 1           |
| Lourdes  | 2           |
| Santiago | 3           |
</code></pre></div>

  <ul>
    <li>Use a <a href="#g:recursive_cte">recursive CTE</a> to create a temporary table (<code>descendent</code>)</li>
    <li><a href="#g:base_case">Base case</a> seeds this table</li>
    <li><a href="#g:recursive_case">Recursive case</a> relies on value(s) already in that table and external table(s)</li>
    <li><code>union all</code> to combine rows
      <ul>
        <li>Can use <code>union</code> but that has lower performance (must check uniqueness each time)</li>
      </ul>
    </li>
    <li>Stops when the recursive case yields an empty row set (nothing new to add)</li>
    <li>Then select the desired values from the CTE</li>
  </ul>

</section>
<section>

  

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/contact_person.sql">src/contact_person.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/contact_person.out">out/contact_person.out</a></p>
  <div><pre><code>| ident |         name          |
|-------|-----------------------|
| 1     | Juana Baeza           |
| 2     | Agustín Rodríquez     |
| 3     | Ariadna Caraballo     |
| 4     | Micaela Laboy         |
| 5     | Verónica Altamirano   |
| 6     | Reina Rivero          |
| 7     | Elias Merino          |
| 8     | Minerva Guerrero      |
| 9     | Mauro Balderas        |
| 10    | Pilar Alarcón         |
| 11    | Daniela Menéndez      |
| 12    | Marco Antonio Barrera |
| 13    | Cristal Soliz         |
| 14    | Bernardo Narváez      |
| 15    | Óscar Barrios         |
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/contact_contacts.sql">src/contact_contacts.sql</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/contact_contacts.out">out/contact_contacts.out</a></p>
  <div><pre><code>|       left        |         right         |
|-------------------|-----------------------|
| Agustín Rodríquez | Ariadna Caraballo     |
| Agustín Rodríquez | Verónica Altamirano   |
| Juana Baeza       | Verónica Altamirano   |
| Juana Baeza       | Micaela Laboy         |
| Pilar Alarcón     | Reina Rivero          |
| Cristal Soliz     | Marco Antonio Barrera |
| Cristal Soliz     | Daniela Menéndez      |
| Daniela Menéndez  | Marco Antonio Barrera |
</code></pre></div>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/contact_tracing.svg" alt="contact diagram"></p>

</section>
<section>

  

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/bidirectional.sql">src/bidirectional.sql</a></p>
  <div><pre><code><span>create</span> <span>temporary</span> <span>table</span> <span>bi_contact</span> <span>(</span>
    <span>left</span> <span>text</span><span>,</span>
    <span>right</span> <span>text</span>
<span>);</span>

<span>insert</span> <span>into</span> <span>bi_contact</span>
<span>select</span>
    <span>left</span><span>,</span> <span>right</span> <span>from</span> <span>contact</span>
    <span>union</span> <span>all</span>
    <span>select</span> <span>right</span><span>,</span> <span>left</span> <span>from</span> <span>contact</span>
<span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/bidirectional.out">out/bidirectional.out</a></p>
  <div><pre><code>| original_count |
|----------------|
| 8              |

| num_contact |
|-------------|
| 16          |
</code></pre></div>

  <ul>
    <li>Create a <a href="#g:temporary_table">temporary table</a> rather than using a long chain of CTEs
      <ul>
        <li>Only lasts as long as the session (not saved to disk)</li>
      </ul>
    </li>
    <li>Duplicate information rather than writing more complicated query</li>
  </ul>

</section>
<section>

  <h2 id="update-group-identifiers">86: update group identifiers</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/update_group_ids.sql">src/update_group_ids.sql</a></p>
  <div><pre><code><span>select</span>
    <span>left</span><span>.</span><span>name</span> <span>as</span> <span>left_name</span><span>,</span>
    <span>left</span><span>.</span><span>ident</span> <span>as</span> <span>left_ident</span><span>,</span>
    <span>right</span><span>.</span><span>name</span> <span>as</span> <span>right_name</span><span>,</span>
    <span>right</span><span>.</span><span>ident</span> <span>as</span> <span>right_ident</span><span>,</span>
    <span>min</span><span>(</span><span>left</span><span>.</span><span>ident</span><span>,</span> <span>right</span><span>.</span><span>ident</span><span>)</span> <span>as</span> <span>new_ident</span>
<span>from</span>
    <span>(</span><span>person</span> <span>as</span> <span>left</span> <span>join</span> <span>bi_contact</span> <span>on</span> <span>left</span><span>.</span><span>name</span> <span>=</span> <span>bi_contact</span><span>.</span><span>left</span><span>)</span>
    <span>join</span> <span>person</span> <span>as</span> <span>right</span> <span>on</span> <span>bi_contact</span><span>.</span><span>right</span> <span>=</span> <span>right</span><span>.</span><span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/update_group_ids.out">out/update_group_ids.out</a></p>
  <div><pre><code>|       left_name       | left_ident |      right_name       | right_ident | new_ident |
|-----------------------|------------|-----------------------|-------------|-----------|
| Juana Baeza           | 1          | Micaela Laboy         | 4           | 1         |
| Juana Baeza           | 1          | Verónica Altamirano   | 5           | 1         |
| Agustín Rodríquez     | 2          | Ariadna Caraballo     | 3           | 2         |
| Agustín Rodríquez     | 2          | Verónica Altamirano   | 5           | 2         |
| Ariadna Caraballo     | 3          | Agustín Rodríquez     | 2           | 2         |
| Micaela Laboy         | 4          | Juana Baeza           | 1           | 1         |
| Verónica Altamirano   | 5          | Agustín Rodríquez     | 2           | 2         |
| Verónica Altamirano   | 5          | Juana Baeza           | 1           | 1         |
| Reina Rivero          | 6          | Pilar Alarcón         | 10          | 6         |
| Pilar Alarcón         | 10         | Reina Rivero          | 6           | 6         |
| Daniela Menéndez      | 11         | Cristal Soliz         | 13          | 11        |
| Daniela Menéndez      | 11         | Marco Antonio Barrera | 12          | 11        |
| Marco Antonio Barrera | 12         | Cristal Soliz         | 13          | 12        |
| Marco Antonio Barrera | 12         | Daniela Menéndez      | 11          | 11        |
| Cristal Soliz         | 13         | Daniela Menéndez      | 11          | 11        |
| Cristal Soliz         | 13         | Marco Antonio Barrera | 12          | 12        |
</code></pre></div>

  <ul>
    <li><code>new_ident</code> is minimum of own identifier and identifiers one step away</li>
    <li>Doesn’t keep people with no contacts</li>
  </ul>

</section>
<section>

  <h2 id="recursive-labeling">87: recursive labeling</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/recursive_labeling.sql">src/recursive_labeling.sql</a></p>
  <div><pre><code><span>with</span> <span>recursive</span> <span>labeled</span> <span>as</span> <span>(</span>
    <span>select</span>
        <span>person</span><span>.</span><span>name</span> <span>as</span> <span>name</span><span>,</span>
	<span>person</span><span>.</span><span>ident</span> <span>as</span> <span>label</span>
    <span>from</span>
        <span>person</span>
    <span>union</span> <span>-- not 'union all'</span>
    <span>select</span>
        <span>person</span><span>.</span><span>name</span> <span>as</span> <span>name</span><span>,</span>
	<span>labeled</span><span>.</span><span>label</span> <span>as</span> <span>label</span>
    <span>from</span>
        <span>(</span><span>person</span> <span>join</span> <span>bi_contact</span> <span>on</span> <span>person</span><span>.</span><span>name</span> <span>=</span> <span>bi_contact</span><span>.</span><span>left</span><span>)</span>
	<span>join</span> <span>labeled</span> <span>on</span> <span>bi_contact</span><span>.</span><span>right</span> <span>=</span> <span>labeled</span><span>.</span><span>name</span>
    <span>where</span> <span>labeled</span><span>.</span><span>label</span> <span>&lt;</span> <span>person</span><span>.</span><span>ident</span>
<span>)</span>
<span>select</span> <span>name</span><span>,</span> <span>min</span><span>(</span><span>label</span><span>)</span> <span>as</span> <span>group_id</span>
<span>from</span> <span>labeled</span>
<span>group</span> <span>by</span> <span>name</span>
<span>order</span> <span>by</span> <span>label</span><span>,</span> <span>name</span><span>;</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/recursive_labeling.out">out/recursive_labeling.out</a></p>
  <div><pre><code>|         name          | group_id |
|-----------------------|----------|
| Agustín Rodríquez     | 1        |
| Ariadna Caraballo     | 1        |
| Juana Baeza           | 1        |
| Micaela Laboy         | 1        |
| Verónica Altamirano   | 1        |
| Pilar Alarcón         | 6        |
| Reina Rivero          | 6        |
| Elias Merino          | 7        |
| Minerva Guerrero      | 8        |
| Mauro Balderas        | 9        |
| Cristal Soliz         | 11       |
| Daniela Menéndez      | 11       |
| Marco Antonio Barrera | 11       |
| Bernardo Narváez      | 14       |
| Óscar Barrios         | 15       |
</code></pre></div>

  <ul>
    <li>Use <code>union</code> instead of <code>union all</code> to prevent <a href="#g:infinite_recursion">infinite recursion</a></li>
  </ul>

</section>
<section>

  <h2 id="query-from-python">88: query from Python</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/basic_python_query.py">src/basic_python_query.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>"db/penguins.db"</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>execute</span><span>(</span><span>"select count(*) from penguins;"</span><span>)</span>
<span>rows</span> <span>=</span> <span>cursor</span><span>.</span><span>fetchall</span><span>()</span>
<span>print</span><span>(</span><span>rows</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/basic_python_query.out">out/basic_python_query.out</a></p>
  

  <ul>
    <li><code>sqlite3</code> is part of Python’s standard library</li>
    <li>Create a connection to a database file</li>
    <li>Get a <a href="#g:cursor">cursor</a> by executing a query
      <ul>
        <li>More common to create cursor and use that to run queries</li>
      </ul>
    </li>
    <li>Fetch all rows at once as list of tuples</li>
  </ul>

</section>
<section>

  <h2 id="incremental-fetch">89: incremental fetch</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/incremental_fetch.py">src/incremental_fetch.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>"db/penguins.db"</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>cursor</span> <span>=</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select species, island from penguins limit 5;"</span><span>)</span>
<span>while</span> <span>row</span> <span>:</span><span>=</span> <span>cursor</span><span>.</span><span>fetchone</span><span>():</span>
    <span>print</span><span>(</span><span>row</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/incremental_fetch.out">out/incremental_fetch.out</a></p>
  <div><pre><code>('Adelie', 'Torgersen')
('Adelie', 'Torgersen')
('Adelie', 'Torgersen')
('Adelie', 'Torgersen')
('Adelie', 'Torgersen')
</code></pre></div>

  <ul>
    <li><code>cursor.fetchone</code> returns <code>None</code> when no more data</li>
    <li>There is also <code>fetchmany(N)</code> to fetch (up to) a certain number of rows</li>
  </ul>

</section>
<section>

  <h2 id="insert-delete-and-all-that">90: insert, delete, and all that</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/insert_delete.py">src/insert_delete.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>":memory:"</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"create table example(num integer);"</span><span>)</span>

<span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"insert into example values (10), (20);"</span><span>)</span>
<span>print</span><span>(</span><span>"after insertion"</span><span>,</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select * from example;"</span><span>).</span><span>fetchall</span><span>())</span>

<span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"delete from example where num &lt; 15;"</span><span>)</span>
<span>print</span><span>(</span><span>"after deletion"</span><span>,</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select * from example;"</span><span>).</span><span>fetchall</span><span>())</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/insert_delete.out">out/insert_delete.out</a></p>
  <div><pre><code>after insertion [(10,), (20,)]
after deletion [(20,)]
</code></pre></div>

  <ul>
    <li>Each <code>execute</code> is its own transaction</li>
  </ul>

</section>
<section>

  <h2 id="interpolate-values">91: interpolate values</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/interpolate.py">src/interpolate.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>":memory:"</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"create table example(num integer);"</span><span>)</span>

<span>cursor</span><span>.</span><span>executemany</span><span>(</span><span>"insert into example values (?);"</span><span>,</span> <span>[(</span><span>10</span><span>,),</span> <span>(</span><span>20</span><span>,)])</span>
<span>print</span><span>(</span><span>"after insertion"</span><span>,</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select * from example;"</span><span>).</span><span>fetchall</span><span>())</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/interpolate.out">out/interpolate.out</a></p>
  <div><pre><code>after insertion [(10,), (20,)]
</code></pre></div>

  <ul>
    <li>From <a href="https://xkcd.com/327/">XKCD</a></li>
  </ul>

  <p><img src="https://gvwilson.github.io/sql-tutorial/img/xkcd_327_exploits_of_a_mom.png" alt="XKCD Exploits of a Mom"></p>

</section>
<section>

  <h2 id="script-execution">92: script execution</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/script_execution.py">src/script_execution.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>SETUP</span> <span>=</span> <span>"""</span><span>\
</span><span>drop table if exists example;
create table example(num integer);
insert into example values (10), (20);
"""</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>":memory:"</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>cursor</span><span>.</span><span>executescript</span><span>(</span><span>SETUP</span><span>)</span>
<span>print</span><span>(</span><span>"after insertion"</span><span>,</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select * from example;"</span><span>).</span><span>fetchall</span><span>())</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/script_execution.out">out/script_execution.out</a></p>
  <div><pre><code>after insertion [(10,), (20,)]
</code></pre></div>

  <ul>
    <li>But what if something goes wrong?</li>
  </ul>

</section>
<section>

  <h2 id="sqlite-exceptions-in-python">93: SQLite exceptions in Python</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/exceptions.py">src/exceptions.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>SETUP</span> <span>=</span> <span>"""</span><span>\
</span><span>create table example(num integer check(num &gt; 0));
insert into example values (10);
insert into example values (-1);
insert into example values (20);
"""</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>":memory:"</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>try</span><span>:</span>
    <span>cursor</span><span>.</span><span>executescript</span><span>(</span><span>SETUP</span><span>)</span>
<span>except</span> <span>sqlite3</span><span>.</span><span>Error</span> <span>as</span> <span>exc</span><span>:</span>
    <span>print</span><span>(</span><span>f</span><span>"SQLite exception: </span><span>{</span><span>exc</span><span>}</span><span>"</span><span>)</span>
<span>print</span><span>(</span><span>"after execution"</span><span>,</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select * from example;"</span><span>).</span><span>fetchall</span><span>())</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/exceptions.out">out/exceptions.out</a></p>
  <div><pre><code>SQLite exception: CHECK constraint failed: num &gt; 0
after execution [(10,)]
</code></pre></div>

</section>
<section>

  <h2 id="python-in-sqlite">94: Python in SQLite</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/embedded_python.py">src/embedded_python.py</a></p>
  <div><pre><code><span>import</span> <span>sqlite3</span>

<span>SETUP</span> <span>=</span> <span>"""</span><span>\
</span><span>create table example(num integer);
insert into example values (-10), (10), (20), (30);
"""</span>


<span>def</span> <span>clip</span><span>(</span><span>value</span><span>):</span>
    <span>if</span> <span>value</span> <span>&lt;</span> <span>0</span><span>:</span>
        <span>return</span> <span>0</span>
    <span>if</span> <span>value</span> <span>&gt;</span> <span>20</span><span>:</span>
        <span>return</span> <span>20</span>
    <span>return</span> <span>value</span>


<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>":memory:"</span><span>)</span>
<span>connection</span><span>.</span><span>create_function</span><span>(</span><span>"clip"</span><span>,</span> <span>1</span><span>,</span> <span>clip</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>cursor</span><span>.</span><span>executescript</span><span>(</span><span>SETUP</span><span>)</span>
<span>for</span> <span>row</span> <span>in</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select num, clip(num) from example;"</span><span>).</span><span>fetchall</span><span>():</span>
    <span>print</span><span>(</span><span>row</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/embedded_python.out">out/embedded_python.out</a></p>
  <div><pre><code>(-10, 0)
(10, 10)
(20, 20)
(30, 20)
</code></pre></div>

  <ul>
    <li>SQLite calls back into Python to execute the function</li>
    <li>Other databases can run Python (and other languages) in the database server process</li>
    <li>Be careful</li>
  </ul>

</section>
<section>

  <h2 id="handle-dates-and-times">95: handle dates and times</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/dates_times.py">src/dates_times.py</a></p>
  <div><pre><code><span>from</span> <span>datetime</span> <span>import</span> <span>date</span>
<span>import</span> <span>sqlite3</span>


<span># Convert date to ISO-formatted string when writing to database
</span><span>def</span> <span>_adapt_date_iso</span><span>(</span><span>val</span><span>):</span>
    <span>return</span> <span>val</span><span>.</span><span>isoformat</span><span>()</span>


<span>sqlite3</span><span>.</span><span>register_adapter</span><span>(</span><span>date</span><span>,</span> <span>_adapt_date_iso</span><span>)</span>


<span># Convert ISO-formatted string to date when reading from database
</span><span>def</span> <span>_convert_date</span><span>(</span><span>val</span><span>):</span>
    <span>return</span> <span>date</span><span>.</span><span>fromisoformat</span><span>(</span><span>val</span><span>.</span><span>decode</span><span>())</span>


<span>sqlite3</span><span>.</span><span>register_converter</span><span>(</span><span>"date"</span><span>,</span> <span>_convert_date</span><span>)</span>

<span>SETUP</span> <span>=</span> <span>"""</span><span>\
</span><span>create table events(
    happened date not null,
    description text not null
);
"""</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>":memory:"</span><span>,</span> <span>detect_types</span><span>=</span><span>sqlite3</span><span>.</span><span>PARSE_DECLTYPES</span><span>)</span>
<span>cursor</span> <span>=</span> <span>connection</span><span>.</span><span>cursor</span><span>()</span>
<span>cursor</span><span>.</span><span>execute</span><span>(</span><span>SETUP</span><span>)</span>

<span>cursor</span><span>.</span><span>executemany</span><span>(</span>
    <span>"insert into events values (?, ?);"</span><span>,</span>
    <span>[(</span><span>date</span><span>(</span><span>2024</span><span>,</span> <span>1</span><span>,</span> <span>10</span><span>),</span> <span>"started tutorial"</span><span>),</span> <span>(</span><span>date</span><span>(</span><span>2024</span><span>,</span> <span>1</span><span>,</span> <span>29</span><span>),</span> <span>"finished tutorial"</span><span>)],</span>
<span>)</span>

<span>for</span> <span>row</span> <span>in</span> <span>cursor</span><span>.</span><span>execute</span><span>(</span><span>"select * from events;"</span><span>).</span><span>fetchall</span><span>():</span>
    <span>print</span><span>(</span><span>row</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/dates_times.out">out/dates_times.out</a></p>
  <div><pre><code>(datetime.date(2024, 1, 10), 'started tutorial')
(datetime.date(2024, 1, 29), 'finished tutorial')
</code></pre></div>

  <ul>
    <li><code>sqlite3.PARSE_DECLTYPES</code> tells <code>sqlite3</code> library to use converts based on declared column types</li>
    <li>Adapt on the way in, convert on the way out</li>
  </ul>

</section>
<section>

  <h2 id="sql-in-jupyter-notebooks">96: SQL in Jupyter notebooks</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/install_jupysql.sh">src/install_jupysql.sh</a></p>
  

  <ul>
    <li>And then inside the notebook:</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/load_ext.text">src/load_ext.text</a></p>
  

  <ul>
    <li>Loads extension</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/jupyter_connect.text">src/jupyter_connect.text</a></p>
  <div><pre><code>%sql sqlite:///data/penguins.db
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/jupyter_connect.out">out/jupyter_connect.out</a></p>
  <div><pre><code>Connecting to 'sqlite:///data/penguins.db'
</code></pre></div>

  <ul>
    <li>Connects to database
      <ul>
        <li><code>sqlite://</code> with two slashes is the protocol</li>
        <li><code>/data/penguins.db</code> (one leading slash) is a local path</li>
      </ul>
    </li>
    <li>Single percent sign <code>%sql</code> introduces one-line command</li>
    <li>Use double percent sign <code>%%sql</code> to indicate that the rest of the cell is SQL</li>
  </ul>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/jupyter_select.text">src/jupyter_select.text</a></p>
  <div><pre><code>%%sql
select species, count(*) as num
from penguins
group by species;
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/jupyter_select.out">out/jupyter_select.out</a></p>
  <div><pre><code>Running query in 'sqlite:///data/penguins.db'
</code></pre></div>

  <table>
  <thead>
    <tr>
      <th>species</th>
      <th>num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Adelie</td>
      <td>152</td>
    </tr>
    <tr>
      <td>Chinstrap</td>
      <td>68</td>
    </tr>
    <tr>
      <td>Gentoo</td>
      <td>124</td>
    </tr>
  </tbody>
</table>

</section>
<section>

  <h2 id="pandas-and-sql">97: Pandas and SQL</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/install_pandas.sh">src/install_pandas.sh</a></p>
  

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/select_pandas.py">src/select_pandas.py</a></p>
  <div><pre><code><span>import</span> <span>pandas</span> <span>as</span> <span>pd</span>
<span>import</span> <span>sqlite3</span>

<span>connection</span> <span>=</span> <span>sqlite3</span><span>.</span><span>connect</span><span>(</span><span>"db/penguins.db"</span><span>)</span>
<span>query</span> <span>=</span> <span>"select species, count(*) as num from penguins group by species;"</span>
<span>df</span> <span>=</span> <span>pd</span><span>.</span><span>read_sql</span><span>(</span><span>query</span><span>,</span> <span>connection</span><span>)</span>
<span>print</span><span>(</span><span>df</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/select_pandas.out">out/select_pandas.out</a></p>
  <div><pre><code>species  num
0     Adelie  152
1  Chinstrap   68
2     Gentoo  124
</code></pre></div>

  <ul>
    <li>Be careful about datatype conversion</li>
  </ul>

</section>
<section>

  <h2 id="polars-and-sql">98: Polars and SQL</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/install_polars.sh">src/install_polars.sh</a></p>
  <div><pre><code>pip <span>install </span>polars pyarrow adbc-driver-sqlite
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/select_polars.py">src/select_polars.py</a></p>
  <div><pre><code><span>import</span> <span>polars</span> <span>as</span> <span>pl</span>

<span>query</span> <span>=</span> <span>"select species, count(*) as num from penguins group by species;"</span>
<span>uri</span> <span>=</span> <span>"sqlite:///db/penguins.db"</span>
<span>df</span> <span>=</span> <span>pl</span><span>.</span><span>read_database_uri</span><span>(</span><span>query</span><span>,</span> <span>uri</span><span>,</span> <span>engine</span><span>=</span><span>"adbc"</span><span>)</span>
<span>print</span><span>(</span><span>df</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/select_polars.out">out/select_polars.out</a></p>
  <div><pre><code>shape: (3, 2)
┌───────────┬─────┐
│ species   ┆ num │
│ ---       ┆ --- │
│ str       ┆ i64 │
╞═══════════╪═════╡
│ Adelie    ┆ 152 │
│ Chinstrap ┆ 68  │
│ Gentoo    ┆ 124 │
└───────────┴─────┘
</code></pre></div>

  <ul>
    <li>The <a href="#g:uri">Uniform Resource Identifier</a> (URI) specifies the database</li>
    <li>The query is the query</li>
    <li>Use the ADBC engine instead of the default ConnectorX</li>
  </ul>

</section>
<section>

  <h2 id="object-relational-mapper">99: object-relational mapper</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/orm.py">src/orm.py</a></p>
  <div><pre><code><span>from</span> <span>sqlmodel</span> <span>import</span> <span>Field</span><span>,</span> <span>Session</span><span>,</span> <span>SQLModel</span><span>,</span> <span>create_engine</span><span>,</span> <span>select</span>


<span>class</span> <span>Department</span><span>(</span><span>SQLModel</span><span>,</span> <span>table</span><span>=</span><span>True</span><span>):</span>
    <span>ident</span><span>:</span> <span>str</span> <span>=</span> <span>Field</span><span>(</span><span>default</span><span>=</span><span>None</span><span>,</span> <span>primary_key</span><span>=</span><span>True</span><span>)</span>
    <span>name</span><span>:</span> <span>str</span>
    <span>building</span><span>:</span> <span>str</span>


<span>engine</span> <span>=</span> <span>create_engine</span><span>(</span><span>"sqlite:///db/assays.db"</span><span>)</span>
<span>with</span> <span>Session</span><span>(</span><span>engine</span><span>)</span> <span>as</span> <span>session</span><span>:</span>
    <span>statement</span> <span>=</span> <span>select</span><span>(</span><span>Department</span><span>)</span>
    <span>for</span> <span>result</span> <span>in</span> <span>session</span><span>.</span><span>exec</span><span>(</span><span>statement</span><span>).</span><span>all</span><span>():</span>
        <span>print</span><span>(</span><span>result</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/orm.out">out/orm.out</a></p>
  <div><pre><code>building='Chesson' name='Genetics' ident='gen'
building='Fashet Extension' name='Histology' ident='hist'
building='Chesson' name='Molecular Biology' ident='mb'
building='TGVH' name='Endocrinology' ident='end'
</code></pre></div>

  <ul>
    <li>An <a href="#g:orm">object-relational mapper</a> (ORM) translates table columns to object properties and vice versa</li>
    <li>SQLModel relies on Python type hints</li>
  </ul>

</section>
<section>

  <h2 id="relations-with-orm">100: relations with ORM</h2>

  <p><a href="https://gvwilson.github.io/sql-tutorial/src/orm_relation.py">src/orm_relation.py</a></p>
  <div><pre><code><span>class</span> <span>Staff</span><span>(</span><span>SQLModel</span><span>,</span> <span>table</span><span>=</span><span>True</span><span>):</span>
    <span>ident</span><span>:</span> <span>str</span> <span>=</span> <span>Field</span><span>(</span><span>default</span><span>=</span><span>None</span><span>,</span> <span>primary_key</span><span>=</span><span>True</span><span>)</span>
    <span>personal</span><span>:</span> <span>str</span>
    <span>family</span><span>:</span> <span>str</span>
    <span>dept</span><span>:</span> <span>Optional</span><span>[</span><span>str</span><span>]</span> <span>=</span> <span>Field</span><span>(</span><span>default</span><span>=</span><span>None</span><span>,</span> <span>foreign_key</span><span>=</span><span>"department.ident"</span><span>)</span>
    <span>age</span><span>:</span> <span>int</span>


<span>engine</span> <span>=</span> <span>create_engine</span><span>(</span><span>"sqlite:///db/assays.db"</span><span>)</span>
<span>SQLModel</span><span>.</span><span>metadata</span><span>.</span><span>create_all</span><span>(</span><span>engine</span><span>)</span>
<span>with</span> <span>Session</span><span>(</span><span>engine</span><span>)</span> <span>as</span> <span>session</span><span>:</span>
    <span>statement</span> <span>=</span> <span>select</span><span>(</span><span>Department</span><span>,</span> <span>Staff</span><span>).</span><span>where</span><span>(</span><span>Staff</span><span>.</span><span>dept</span> <span>==</span> <span>Department</span><span>.</span><span>ident</span><span>)</span>
    <span>for</span> <span>dept</span><span>,</span> <span>staff</span> <span>in</span> <span>session</span><span>.</span><span>exec</span><span>(</span><span>statement</span><span>):</span>
        <span>print</span><span>(</span><span>f</span><span>"</span><span>{</span><span>dept</span><span>.</span><span>name</span><span>}</span><span>: </span><span>{</span><span>staff</span><span>.</span><span>personal</span><span>}</span><span> </span><span>{</span><span>staff</span><span>.</span><span>family</span><span>}</span><span>"</span><span>)</span>
</code></pre></div>

  <p><a href="https://gvwilson.github.io/sql-tutorial/out/orm_relation.out">out/orm_relation.out</a></p>
  <div><pre><code>Histology: Divit Dhaliwal
Molecular Biology: Indrans Sridhar
Molecular Biology: Pranay Khanna
Histology: Vedika Rout
Genetics: Abram Chokshi
Histology: Romil Kapoor
Molecular Biology: Ishaan Ramaswamy
Genetics: Nitya Lal
</code></pre></div>

  <ul>
    <li>Make foreign keys explicit in class definitions</li>
    <li>SQLModel automatically does the join
      <ul>
        <li>The two staff with no department aren’t included in the result</li>
      </ul>
    </li>
  </ul>

</section>
<section>

  <h2 id="appendices">☆ Appendices</h2>

  <h2 id="terms">☆  Terms</h2>

  <dl>
  
  <dt id="g:1_to_1">1-to-1 relation</dt>
  <dd>A relationship between two tables in which each record from the first table matches exactly one record from the second and vice versa.
</dd>
  
  <dt id="g:1_to_many">1-to-many relation</dt>
  <dd>A relationship between two tables in which each record from the first table matches zero or more records from the second, but each record from the second table matches exactly one record from the first.
</dd>
  
  <dt id="g:aggregation">aggregation</dt>
  <dd>Combining several values to produce one.
</dd>
  
  <dt id="g:aggregation_func">aggregation function</dt>
  <dd>A function used to produce one value from many, such as maximum or addition.
</dd>
  
  <dt id="g:alias">alias</dt>
  <dd>An alternate name used temporarily for a table or column.
</dd>
  
  <dt id="g:atomic">atomic</dt>
  <dd>An operation that cannot be broken into smaller operations.
</dd>
  
  <dt id="g:autoincrement">autoincrement</dt>
  <dd>Automatically add one to a value.
</dd>
  
  <dt id="g:base_case">base case</dt>
  <dd>A starting point for recursion that does not depend on previous recursive calculations.
</dd>
  
  <dt id="g:blob">Binary Large Object (blob)</dt>
  <dd>Bytes that are handled as-is rather than being interpreted as numbers, text, or other data types.
</dd>
  
  <dt id="g:cross_join">cross join</dt>
  <dd>A join that creates the cross-product of rows from two tables.
</dd>
  
  <dt id="g:cte">common table expression (CTE)</dt>
  <dd>A temporary table created at the start of a query, usually to simplify writing the query.
</dd>
  
  <dt id="g:consistent">consistent</dt>
  <dd>A state in which all constraints are satisfied, e.g., all columns contain allowed values and all foreign keys refer to primary keys.
</dd>
  
  
  <dd>A subquery that depends on a value or values from the enclosing query, and which must therefore be executed once for each of those values.
</dd>
  
  <dt id="g:cursor">cursor</dt>
  <dd>A reference to the current location in the results of an ongoing query.
</dd>
  
  <dt id="g:data_migration">data migration</dt>
  <dd>To move data from one form to another, e.g., from one set of tables to a new set or from one DBMS to another.
</dd>
  
  <dt id="g:database">database</dt>
  <dd>A collection of data that can be searched and retrieved.
</dd>
  
  <dt id="g:dbms">database management system (DBMS)</dt>
  <dd>A program that manages a particular kind of database.
</dd>
  
  <dt id="g:denormalization">denormalization</dt>
  <dd>To deliberately introduce duplication or other violate normal forms, typically to improve query performance.
</dd>
  
  <dt id="g:durable">durable</dt>
  <dd>Guaranteed to survive shutdown and restart.
</dd>
  
  <dt id="g:er_diagram">entity-relationship diagram</dt>
  <dd>A graphical depiction of the relationships between tables in a database.
</dd>
  
  <dt id="g:filter">filter</dt>
  <dd>To select records based on whether they pass some Boolean test.
</dd>
  
  <dt id="g:foreign_key">foreign key</dt>
  <dd>A value in one table that identifies a primary key in another table.
</dd>
  
  <dt id="g:full_outer_join">full outer join</dt>
  <dd>See <a href="#g:cross_join">cross join</a>.
</dd>
  
  <dt id="g:group">group</dt>
  <dd>A set of records that share a common property, such as having the same value in a particular column.
</dd>
  
  <dt id="g:in_memory_db">in-memory database</dt>
  <dd>A database that is stored in memory rather than on disk.
</dd>
  
  <dt id="g:index">index</dt>
  <dd>An auxiliary data structure that enables faster access to records.
</dd>
  
  <dt id="g:infinite_recursion">infinite recursion</dt>
  <dd>See “infinite recursion”.
</dd>
  
  <dt id="g:isolated">isolated</dt>
  <dd>The appearance of having executed in an otherwise-idle system.
</dd>
  
  <dt id="g:join">join</dt>
  <dd>To combine records from two tables.
</dd>
  
  <dt id="g:join_condition">join condition</dt>
  <dd>The criteria used to decide which rows from each table in a join are combined.
</dd>
  
  <dt id="g:join_table">join table</dt>
  <dd>A table that exists solely to enable information from two tables to be connected.
</dd>
  
  <dt id="g:left_outer_join">left outer join</dt>
  <dd>A join that is guaranteed to keep all rows from the first (left) table. Columns from the right table are filled with actual values if available or with null otherwise.
</dd>
  
  <dt id="g:many_to_many">many-to-many relation</dt>
  <dd>A relationship between two tables in which each record from the first table may match zero or more records from the second and vice versa.
</dd>
  
  <dt id="g:materialized_view">materialized view</dt>
  <dd>A view that is stored on disk and updated on demand.
</dd>
  
  <dt id="g:normal_form">normal form</dt>
  <dd>One of several (loosely defined) rules for organizing data in tables.
</dd>
  
  <dt id="g:nosql">NoSQL database</dt>
  <dd>Any database that doesn’t use the relational model.
</dd>
  
  <dt id="g:null">null</dt>
  <dd>A special value representing “not known”.
</dd>
  
  <dt id="g:orm">object-relational mapper (ORM)</dt>
  <dd>A library that translates objects in a program into database queries and the results of those queries back into objects.
</dd>
  
  <dt id="g:path_expression">path expression</dt>
  <dd>An expression identifying an element or a set of elements in a JSON structure.
</dd>
  
  <dt id="g:primary_key">primary key</dt>
  <dd>A value or values in a database table that uniquely identifies each record in that table.
</dd>
  
  <dt id="g:query">query</dt>
  <dd>A command to perform some operation in a database (typically data retrieval).
</dd>
  
  <dt id="g:recursive_cte">recursive CTE</dt>
  <dd>A common table expression that refers to itself. Every recursive CTE must have a base case and a recursive case.
</dd>
  
  <dt id="g:recursive_case">recursive case</dt>
  <dd>The second or subsequent step in self-referential accumulation of data.
</dd>
  
  <dt id="g:rdbms">relational database management system (RDBMS)</dt>
  <dd>A database management system that stores data in tables with columns and rows.
</dd>
  
  <dt id="g:subquery">subquery</dt>
  <dd>A query used within another query.
</dd>
  
  <dt id="g:table_valued_func">table-valued function</dt>
  <dd>A function that returns multiple values rather than a single value.
</dd>
  
  <dt id="g:temporary_table">temporary table</dt>
  <dd>A table that is explicitly constructed in memory outside any particular query.
</dd>
  
  <dt id="g:ternary_logic">ternary logic</dt>
  <dd>A logic based on three values: true, false, and “don’t know” (represented as null).
</dd>
  
  <dt id="g:tombstone">tombstone</dt>
  <dd>A marker value added to a record to show that it is no longer active. Tombstones are used as an alternative to deleting data.
</dd>
  
  <dt id="g:trigger">trigger</dt>
  <dd>An action that runs automatically when something happens in a database, typically insertion or deletion.
</dd>
  
  <dt id="g:upsert">upsert</dt>
  <dd>To update a record if it exists or insert (create) a new record if it doesn’t.
</dd>
  
  <dt id="g:uri">Uniform Resource Identifier (URI)</dt>
  <dd>A string that identifies a resource (such as a web page or database) and the protocol used to access it.
</dd>
  
  <dt id="g:view">view</dt>
  <dd>A rearrangement of data in a database that is regenerated on demand.
</dd>
  
  <dt id="g:window_func">window function</dt>
  <dd>A function that combines data from adjacent rows in a database query’s result.
</dd>
  
</dl>

  <h2 id="acknowledgments">☆  Acknowledgments</h2>

  <p>This tutorial would not have been possible without:</p>

  <ul>
    <li><a href="http://andialbrecht.de/">Andi Albrecht</a>’s <a href="https://pypi.org/project/sqlparse/"><code>sqlparse</code></a> module</li>
    <li><a href="https://tapoueh.org/">Dimitri Fontaine</a>’s <a href="https://theartofpostgresql.com/"><em>The Art of PostgreSQL</em></a></li>
    <li>David Rozenshtein’s <em>The Essence of SQL</em> (now sadly out of print)</li>
  </ul>

  <p>I would also like to thank the following for spotting issues, making suggestions, or submitting changes:</p>

  <ul>
    <li>Sam Hames</li>
    <li>Robert Kern</li>
    <li>Roy Pardee</li>
    <li>Manos Pitsidianakis</li>
    <li>Daniel Possenriede</li>
    <li>Adam Rosien</li>
    <li>Thomas Sandmann</li>
    <li>Simon Willison</li>
  </ul>

</section>


    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Alaska Airlines flight 1282 NTSB preliminary report [pdf] (147 pts)]]></title>
            <link>https://www.ntsb.gov/investigations/Documents/DCA24MA063%20Preliminary%20report.pdf</link>
            <guid>39280756</guid>
            <pubDate>Tue, 06 Feb 2024 21:17:35 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.ntsb.gov/investigations/Documents/DCA24MA063%20Preliminary%20report.pdf">https://www.ntsb.gov/investigations/Documents/DCA24MA063%20Preliminary%20report.pdf</a>, See on <a href="https://news.ycombinator.com/item?id=39280756">Hacker News</a></p>
&lt;Not HTML&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[The world is awful. The world is much better. The world can be much better (310 pts)]]></title>
            <link>https://ourworldindata.org/much-better-awful-can-be-better</link>
            <guid>39278631</guid>
            <pubDate>Tue, 06 Feb 2024 18:46:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://ourworldindata.org/much-better-awful-can-be-better">https://ourworldindata.org/much-better-awful-can-be-better</a>, See on <a href="https://news.ycombinator.com/item?id=39278631">Hacker News</a></p>
<div id="readability-page-1" class="page"><article><header><h2>It is wrong to think these three statements contradict each other. We need to see that they are all true to see that a better world is possible.</h2></header><p>The world is awful. The world is much better. The world can be much better. All three statements are true at the same time.</p><p>Discussions about the state of the world too often focus on the first statement: The news highlights what is going wrong, rarely mentioning any positive development.</p><p>A pushback on this narrative takes it to the other extreme, which is equally damaging. Solely communicating the progress that the world has achieved becomes unhelpful, or even repugnant, when it glosses over the problems that are real today.</p><p>It’s hard to resist falling for only one of these perspectives. But to see that a better world is possible, we need to see that both are true at the same time: the world is awful, and the world is much better.</p><figure><picture><source srcset="https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20Venn_100.webp 100w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20Venn_350.webp 350w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20Venn_850.webp 850w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20Venn_1350.webp 1350w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20Venn_7245.webp 7245w" type="image/webp" sizes="(max-width: 960px) 95vw, (min-width: 960px) 853px"><img src="https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20Venn.png" alt="" loading="lazy"></picture></figure><p>To illustrate what I mean, I will use the example of one of humanity’s biggest tragedies: the death of its children. But the same is true for many of the world’s other problems. Humanity faces many problems where things have improved over time, which are still terrible, and for which we know that things can get better.<a href="#note-1"><sup>1</sup></a></p><div><div><h2 id="the-world-is-awful">The world is awful<a href="#the-world-is-awful"></a></h2><p>Globally, <a href="https://ourworldindata.org/grapher/youth-mortality-rate?tab=chart">4.4%</a> of children die before they are 15 years old. This is the data for 2021, the latest available year.</p><p>This means that 5.9 million children die every year – 16,000 children on any average day and 11 children every minute.<a href="#note-2"><sup>2</sup></a></p><p>Clearly, a world where thousands of tragedies happen every single day is awful.</p></div><div><figure><picture><source srcset="https://ourworldindata.org/images/published/The%20world%20is%20awful_100.webp 100w, https://ourworldindata.org/images/published/The%20world%20is%20awful_350.webp 350w, https://ourworldindata.org/images/published/The%20world%20is%20awful_850.webp 850w, https://ourworldindata.org/images/published/The%20world%20is%20awful_1350.webp 1350w, https://ourworldindata.org/images/published/The%20world%20is%20awful_7501.webp 7501w" type="image/webp" sizes="(max-width: 960px) 95vw, (min-width: 960px) 746px"><img src="https://ourworldindata.org/images/published/The%20world%20is%20awful.png" alt="" loading="lazy"></picture></figure></div></div><div><div><h2 id="the-world-is-much-better">The world is much better<a href="#the-world-is-much-better"></a></h2><p>History’s big lesson is that things change. But it is hard to imagine how dire living conditions once were, making it difficult to grasp just how much the world has changed.</p><p>Data can help to bring the scale of change to mind. Historians estimate that in the past, <a href="https://ourworldindata.org/child-mortality-in-the-past" target="_blank" rel="noopener noreferrer">around </a><em><a href="https://ourworldindata.org/child-mortality-in-the-past" target="_blank" rel="noopener noreferrer">half</a></em> <a href="https://ourworldindata.org/child-mortality-in-the-past" target="_blank" rel="noopener noreferrer">of all children died</a>. This was true no matter where in the world a child was born.<a href="#note-3"><sup>3</sup></a></p><p>It’s hard to imagine, but child mortality in the very worst-off places today is <em>much </em>better than anywhere in the past. Even in the world’s richest countries, the mortality of children was much higher very recently. In Niger, the country with the highest mortality today, about 14% of all children die.<a href="#note-4"><sup>4</sup></a> Just a few generations ago, the mortality rate was more than three times as high, even in the best-off places.<a href="#note-5"><sup>5</sup></a></p><p>What we learn from our history is that it is possible to change the world. Unfortunately, long-run data on how living conditions have changed is rarely studied in school and rarely reported in the media. As a result, many are <a href="https://ourworldindata.org/wrong-about-the-world" target="_blank" rel="noopener noreferrer">entirely unaware</a> of even the most fundamental positive developments in the world.</p><p>But this fact — that it is possible to change the world and achieve extraordinary progress for entire societies — is something that <em>everyone</em> should know.</p></div><div><figure><picture><source srcset="https://ourworldindata.org/images/published/The%20world%20is%20better_100.webp 100w, https://ourworldindata.org/images/published/The%20world%20is%20better_350.webp 350w, https://ourworldindata.org/images/published/The%20world%20is%20better_850.webp 850w, https://ourworldindata.org/images/published/The%20world%20is%20better_1350.webp 1350w, https://ourworldindata.org/images/published/The%20world%20is%20better_7501.webp 7501w" type="image/webp" sizes="(max-width: 960px) 95vw, (min-width: 960px) 746px"><img src="https://ourworldindata.org/images/published/The%20world%20is%20better.png" alt="" loading="lazy"></picture></figure></div></div><div><div><h2 id="the-world-can-be-much-better">The world can be much better<a href="#the-world-can-be-much-better"></a></h2><p>Progress over time shows that it was possible to change the world in the past, but do we know that it’s possible to continue this progress into the future? Or were we perhaps born at that unlucky moment in history at which progress has to come to a halt?</p><p>Studying the global data suggests that the answer is no.&nbsp;It is possible to make the world a better place.</p><p>One way to see this is to look at the places in the world with the best living conditions today. The best-off places show that extremely low child mortality is not just a possibility but already a reality.</p><p>The world region where children have the best chance of surviving childhood is the European Union. Of children born in the EU 99.53% survive childhood.<a href="#note-6"><sup>6</sup></a></p><p>To see how much better the world can be, we can ask what the world would look like if this became a reality <em>everywhere</em>. What if children around the world would be as well off as children in the EU? The answer is that <em>five million</em> fewer children would die every year.<a href="#note-7"><sup>7</sup></a></p><p>Of course, the child mortality rate in the EU is still too high, and there is no reason that progress should stop there. Cancers like leukemia and brain tumors kill hundreds of children, even in today’s richest countries. We should strive to find ways to prevent these tragic deaths.</p><p>However, the largest opportunities to prevent the pain and suffering of children are in the poorer countries. There, we know not only that things <em>can</em> be better but <em>how</em> to make them better.</p><p>You can use this research on how to make the world a better place to contribute to this progress yourself. I recommend relying on research published by the nonprofit organization <a href="https://www.givewell.org/" target="_blank" rel="noopener noreferrer">GiveWell.org</a>. GiveWell’s team spent years identifying the most cost-effective charities so that your donation can have the biggest positive impact on the lives of others. Several of the recommended charities focus on improving the health of children, giving you the opportunity to contribute to the progress against child mortality.</p><p><em>Millions</em> of child deaths are preventable. We know that it is possible to make the world a better place.</p></div><div><figure><picture><source srcset="https://ourworldindata.org/images/published/The%20world%20can%20be%20much%20better_100.webp 100w, https://ourworldindata.org/images/published/The%20world%20can%20be%20much%20better_350.webp 350w, https://ourworldindata.org/images/published/The%20world%20can%20be%20much%20better_850.webp 850w, https://ourworldindata.org/images/published/The%20world%20can%20be%20much%20better_1350.webp 1350w, https://ourworldindata.org/images/published/The%20world%20can%20be%20much%20better_7501.webp 7501w" type="image/webp" sizes="(max-width: 960px) 95vw, (min-width: 960px) 746px"><img src="https://ourworldindata.org/images/published/The%20world%20can%20be%20much%20better.png" alt="" loading="lazy"></picture></figure></div></div><hr><div><div><h2 id="the-world-is-awful-this-is-why-we-need-to-know-about-progress">The world is awful; this is why we need to know about progress<a href="#the-world-is-awful-this-is-why-we-need-to-know-about-progress"></a></h2><p>The news often focuses on how awful the world is. It is easier to scare people than to encourage them to achieve positive change, and there is always a large audience for bad news.</p><p>I agree that it is important that we know what is wrong with the world. But, given the scale of what we have achieved already and of what is possible in the future, I think it’s irresponsible to <em>only</em> report on what is wrong.</p><p>To see that the world has become a better place does not mean to deny that we are facing very serious problems. On the contrary, if we had achieved the best of all possible worlds, I would not be spending my days writing and researching about how we got here. It is because the world is still terrible that it is so important to see how the world became a better place.</p><p>With my work I hope to change our culture a little bit so that we take the possibility of progress more seriously.</p><p>This is a solvable problem: we have the data and the research to see the problems we are facing and the progress that is possible. The problem is that we are not using the data and research we have. The data is often stored in inaccessible databases, the research is buried under jargon in academic papers and often locked away behind paywalls. With <em>Our World in Data,</em> we want to change this.</p><p>If we want more people to dedicate their energy and money to making the world a better place, then we should make it much more widely known that <em>it is possible to make the world a better place</em>.</p><p>For this we have to remember that all three statements are true at the same time: the world is awful, the world is much better, and the world can be much better.</p></div><div><figure><picture><source srcset="https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20All%20three%20visualizations_100.webp 100w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20All%20three%20visualizations_350.webp 350w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20All%20three%20visualizations_850.webp 850w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20All%20three%20visualizations_1350.webp 1350w, https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20All%20three%20visualizations_10787.webp 10787w" type="image/webp" sizes="(max-width: 960px) 95vw, (min-width: 960px) 746px"><img src="https://ourworldindata.org/images/published/awful%20better%20can%20be%20better%20All%20three%20visualizations.png" alt="" loading="lazy"></picture></figure></div></div><hr><p>This is a revised and updated version published in February 2023. The last previous revision I had done in July 2022. The first version of this article was published in October 2018.</p><p><strong>Acknowledgments:</strong> I would like to thank Hannah Ritchie and Toby Ord for their feedback on this article.</p><hr><p><em>Continue reading on Our World in Data:</em></p><a href="https://ourworldindata.org/problems-and-progress" target="_blank" rel="noopener noreferrer"><div><picture><source srcset="https://ourworldindata.org/images/published/default-featured-image_100.webp 100w, https://ourworldindata.org/images/published/default-featured-image_350.webp 350w, https://ourworldindata.org/images/published/default-featured-image_850.webp 850w, https://ourworldindata.org/images/published/default-featured-image_1255.webp 1255w" type="image/webp" sizes="350px"><img src="https://ourworldindata.org/images/published/default-featured-image.png" alt="The wordmark for Our World In Data" loading="lazy"></picture></div><p><h3>Why do we need to know about progress if we are concerned about the world’s largest problems?</h3></p></a><div><h3 id="article-endnotes">Endnotes</h3><ol><li id="note-1"><p>In a number of fundamental aspects – obviously<a href="https://ourworldindata.org/obesity" target="_blank" rel="noopener noreferrer"> not all</a> – we achieved very substantial progress. These aspects include<a href="https://ourworldindata.org/global-rise-of-education" target="_blank" rel="noopener noreferrer"> education</a>,<a href="https://ourworldindata.org/democracy" target="_blank" rel="noopener noreferrer"> political freedom</a>,<a href="https://ourworldindata.org/homicides" target="_blank" rel="noopener noreferrer"> violence</a>,<a href="https://ourworldindata.org/extreme-poverty" target="_blank" rel="noopener noreferrer"> poverty</a>,<a href="https://ourworldindata.org/hunger-and-undernourishment" target="_blank" rel="noopener noreferrer"> nutrition</a>, and<a href="https://ourworldindata.org/ozone-layer" target="_blank" rel="noopener noreferrer"> some</a><a href="https://ourworldindata.org/natural-catastrophes" target="_blank" rel="noopener noreferrer"> aspects</a> of environmental change. See also<a href="https://ourworldindata.org/a-history-of-global-living-conditions-in-5-charts" target="_blank" rel="noopener noreferrer"> my short history of global living conditions</a>.</p></li><li id="note-2"><p>Except for the historical data, all data in this post is taken from IGME, the <em>UN Inter-agency Group for Child Mortality Estimation</em>. They publish their data here:<a href="https://childmortality.org/data/World" target="_blank" rel="noopener noreferrer"> childmortality.org/data/World</a></p><p>Their point estimate for the global number of deaths for children under 15 in 2021 is <a href="https://ourworldindata.org/grapher/number-of-youth-deaths?tab=table">5,862,574</a>.</p><p>This means on average there are 5,862,574 / 365.25 = 16,051 child deaths per day, 5,862,574 / (365.25 * 24) = 669 child deaths every hour, and 5,862,574 / (365.25 * 24 * 60) = 11.15&nbsp; child deaths every minute.</p></li><li id="note-3"><p>If we still suffered the poor health of our ancestors, more than 60 million children would die every year. How many children died at the time? We don’t know because data on the number of global births at the time is not available. For the 1950s and 1960s, we have estimates of both the number of births and the mortality rate, and the records show that around 20 million children died every year. See the data shown<a href="https://www.gatesnotes.com/Development/Max-Roser-three-facts-everyone-should-know" target="_blank" rel="noopener noreferrer"> here</a>.</p></li><li id="note-4"><p>See the world map on <a href="https://ourworldindata.org/grapher/youth-mortality-rate">the mortality of under-15-year-olds</a>.</p></li><li id="note-5"><p>See the data reported in <a href="https://ourworldindata.org/child-mortality-in-the-past" target="_blank" rel="noopener noreferrer">Mortality in the past – around half died as children</a>.</p></li><li id="note-6"><p>If we look at single countries, this difference becomes even more striking as in the countries with the best health, the child mortality rate is again almost twice as low as in the EU as a whole.</p><p>0.47% is calculated as the weighted average of the youth mortality rate of the following countries: Austria, Belgium, Bulgaria, Croatia, Cyprus, Czechia, Denmark, Estonia, Finland, France, Germany, Greece, Hungary, Ireland, Italy, Latvia, Lithuania, Luxembourg, Malta, Netherlands, Poland, Portugal, Romania, Slovakia, Slovenia, Spain, and Sweden. The data is also for 2021 and also from the same source (UN-IGME). The weights are assigned based on the number of children under the age of 15.</p><p>The countries with the lowest mortality rates today include San Marino, Norway, Japan, Finland, Singapore, Iceland, and Slovenia, where 99.7% of all children survive. <a href="https://ourworldindata.org/grapher/youth-mortality-rate?tab=table&amp;country=~OWID_WRL">This chart</a> shows the ranking. However, because several of these countries are small, I did not base this text on the data from any single country but on a large world region where millions of children are born every year.</p></li><li id="note-7"><p>The global number of child deaths, as reported above, is 5,862,574.</p><p>5,862,574 – 5,862,574 / (4.4 / 0.47) = 5,236,345 fewer children would die if the global mortality rate were 0.47% rather than 4.4%.</p></li></ol></div><div id="article-citation"><h3>Cite this work</h3><p>Our articles and data visualizations rely on work from many different people and organizations. When citing this article, please also cite the underlying data sources. This article can be cited as:</p><div><pre><code>Max Roser (2022) - “The world is awful. The world is much better. The world can be much better.” Published online at OurWorldInData.org. Retrieved from: 'https://ourworldindata.org/much-better-awful-can-be-better' [Online Resource]</code></pre></div><p>BibTeX citation</p><div><pre><code>@article{owid-much-better-awful-can-be-better,
    author = {Max Roser},
    title = {The world is awful. The world is much better. The world can be much better.},
    journal = {Our World in Data},
    year = {2022},
    note = {https://ourworldindata.org/much-better-awful-can-be-better}
}</code></pre></div></div><div id="article-licence"><p><img src="https://ourworldindata.org/owid-logo.svg" alt="Our World in Data logo"></p><h3>Reuse this work freely</h3><p>All visualizations, data, and code produced by Our World in Data are completely open access under the <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer">Creative Commons BY license</a>. You have the permission to use, distribute, and reproduce these in any medium, provided the source and authors are credited.</p><p>The data produced by third parties and made available by Our World in Data is subject to the license terms from the original third-party authors. We will always indicate the original source of the data in our documentation, so you should always check the license of any such third-party data before use and redistribution.</p><p>All of <a href="https://ourworldindata.org/faqs#how-can-i-embed-one-of-your-interactive-charts-in-my-website">our charts can be embedded</a> in any site.</p></div></article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Three million malware-infected smart toothbrushes used in Swiss DDoS attacks (230 pts)]]></title>
            <link>https://www.tomshardware.com/networking/three-million-malware-infected-smart-toothbrushes-used-in-swiss-ddos-attacks-botnet-causes-millions-of-euros-in-damages</link>
            <guid>39277990</guid>
            <pubDate>Tue, 06 Feb 2024 18:07:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.tomshardware.com/networking/three-million-malware-infected-smart-toothbrushes-used-in-swiss-ddos-attacks-botnet-causes-millions-of-euros-in-damages">https://www.tomshardware.com/networking/three-million-malware-infected-smart-toothbrushes-used-in-swiss-ddos-attacks-botnet-causes-millions-of-euros-in-damages</a>, See on <a href="https://news.ycombinator.com/item?id=39277990">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="article-body">
<p>According to a recent report published by the <a data-analytics-id="inline-link" href="https://www.aargauerzeitung.ch/wirtschaft/kriminalitaet-die-zahnbuersten-greifen-an-das-sind-die-aktuellen-cybergefahren-und-so-koennen-sie-sich-schuetzen-ld.2569480?reduced=true" data-url="https://www.aargauerzeitung.ch/wirtschaft/kriminalitaet-die-zahnbuersten-greifen-an-das-sind-die-aktuellen-cybergefahren-und-so-koennen-sie-sich-schuetzen-ld.2569480?reduced=true">Aargauer Zeitung</a> (h/t <a data-analytics-id="inline-link" href="https://www.golem.de/news/iot-hacker-missbrauchen-zahnbuersten-fuer-ddos-angriffe-2402-181921.html" data-url="https://www.golem.de/news/iot-hacker-missbrauchen-zahnbuersten-fuer-ddos-angriffe-2402-181921.html">Golem.de</a>), around three million smart toothbrushes have been infected by hackers and enslaved into botnets. The source report says this sizable army of connected dental cleansing tools was used in a DDoS attack on a Swiss company’s website. The firm’s site collapsed under the strain of the attack, reportedly resulting in the loss of millions of Euros of business.</p><p>In this particular case, the toothbrush botnet was thought to have been vulnerable due to its Java-based OS. No particular toothbrush brand was mentioned in the source report. Normally, the toothbrushes would have used their connectivity for tracking and improving user oral hygiene habits, but after a malware infection, these toothbrushes were press-ganged into a botnet.</p><p>Stefan Züger from the Swiss branch of the global cybersecurity firm <a data-analytics-id="inline-link" href="https://www.fortinet.com/" data-url="https://www.fortinet.com/">Fortinet</a> provided the publication with a few tips on what people could do to protect their own toothbrushes – or other connected gadgetry like <a data-analytics-id="inline-link" href="https://www.tomshardware.com/networking/routers/best-wi-fi-routers" data-before-rewrite-localise="https://www.tomshardware.com/networking/routers/best-wi-fi-routers">routers</a>, set-top boxes, surveillance cameras, doorbells, baby monitors, <a data-analytics-id="inline-link" href="https://www.tomshardware.com/networking/your-washing-machine-could-be-sending-37-gb-of-data-a-day" data-before-rewrite-localise="https://www.tomshardware.com/networking/your-washing-machine-could-be-sending-37-gb-of-data-a-day">washing machines</a>, and so on.</p><p>“Every device that is connected to the Internet is a potential target – or can be misused for an attack,” Züger told the Swiss newspaper. The <a data-analytics-id="inline-link" href="https://www.tomshardware.com/tag/security" data-auto-tag-linker="true" data-before-rewrite-localise="https://www.tomshardware.com/tag/security">security</a> expert also explained that every connected device was being continually probed for vulnerabilities by hackers, so there is a real arms race between device software/firmware makers and cyber criminals. Fortinet recently connected an ‘unprotected’ PC to the internet and found it took only 20 minutes before it became malware-ridden.</p><p>We don’t have the finer-grained details of the specific Swiss company targeted and suffered from the extremely costly DDoS attack. However, it is common for malicious actors to issue threats with monetary demands attached before <a data-analytics-id="inline-link" href="https://www.tomshardware.com/news/minecraft-ddos-attack-leaves-small-european-country-without-internet" data-before-rewrite-localise="https://www.tomshardware.com/news/minecraft-ddos-attack-leaves-small-european-country-without-internet">weaponizing their DDoS zombie army</a>. Perhaps the Swiss firm refused to pay up, or perhaps the malicious actors instigated this attack to show their muscle (teeth?) ahead of making any demands.</p><p>Though we don’t have the finer details of the DDoS story, it serves as yet another warning for device owners to do their best to keep their devices, <a data-analytics-id="inline-link" href="https://www.tomshardware.com/news/gigabyte-firmware-update-backdoor" data-before-rewrite-localise="https://www.tomshardware.com/news/gigabyte-firmware-update-backdoor">firmware</a>, and software updated; monitor their networks for suspicious activity; install and use security software; and follow <a data-analytics-id="inline-link" href="https://www.tomshardware.com/reviews/wireless-security-hack,2981-3.html" data-before-rewrite-localise="https://www.tomshardware.com/reviews/wireless-security-hack,2981-3.html">network security</a> best practices.</p>
</div><div data-hydrate="true" id="slice-container-newsletterForm-articleInbodyContent-h8f3FQZXjQeRipQ8gcVHsd"><section><p>Join the experts who read Tom's Hardware for the inside track on enthusiast PC tech news — and have for over 25 years. We'll send breaking news and in-depth reviews of CPUs, GPUs, AI, maker hardware and more straight to your inbox.</p></section></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA["Fake Chinese Income" Mortgages Fuel Toronto Real Estate Bubble: HSBC Bank Leaks (332 pts)]]></title>
            <link>https://www.thebureau.news/p/fake-chinese-income-mortgages-fuel</link>
            <guid>39277767</guid>
            <pubDate>Tue, 06 Feb 2024 17:52:31 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.thebureau.news/p/fake-chinese-income-mortgages-fuel">https://www.thebureau.news/p/fake-chinese-income-mortgages-fuel</a>, See on <a href="https://news.ycombinator.com/item?id=39277767">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png" width="1456" height="1198" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1198,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:4823278,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd4443b67-56db-421c-a762-7803b6868b4e_2178x1792.png 1456w" sizes="100vw" fetchpriority="high"></picture></div></a><figcaption>PHOTO ILLUSTRATION: THE BUREAU INVESTIGATES TORONTO METHOD MORTGAGE LEAKS.</figcaption></figure></div><p>The whistleblower, a Canadian business school graduate, was staggered by the suspicious home loans he discovered in 2022 when he joined a mortgage approval team in a small HSBC branch on the outskirts of Toronto.&nbsp;</p><p>He knew of suspicions surrounding Chinese capital in British Columbia real estate, but had never witnessed shady lending while working at an HSBC branch in Campbell River, a bucolic town on the coast of Vancouver Island.</p><p>When he arrived at HSBC’s bank in Aurora, an affluent suburb north of Toronto, he discovered explosive growth in home loans to Chinese diaspora buyers during the Covid-19 pandemic.</p><p>Chinese migrants living across Toronto were obtaining mortgages from HSBC while supposedly earning extravagant salaries from remote-work jobs in China. In one example, an Ontario casino worker that owned three homes also claimed to earn $345,000 in 2020 analyzing data remotely for a Beijing company.&nbsp;</p><p>Before joining HSBC Canada, the whistleblower had studied fake-income mortgage frauds for his Business Masters degree at Vancouver Island University. After arriving at Aurora in February 2022, while digging into the branch’s loan books and interrogating his colleagues, he made mind-blowing assessments.</p><p>Since 2015, the whistleblower concluded, more than 10 Toronto-area HSBC branches had issued at least $500-million in home loans to diaspora buyers claiming exaggerated incomes or non-existent jobs in China.&nbsp;</p><p>These foreign-income scams spiked during the pandemic, the whistleblower believed, because borrowers could somewhat plausibly claim to be working remotely in other countries while riding out Covid-19 in Canada.</p><p>While a small bank of Aurora’s size was expected to issue about $23-million in residential loans every year, this branch had shovelled out $88-million in mortgages in 2020, according to the whistleblower, and over $50-million in 2021.</p><p><span>The whistleblower, whom</span><em>The Bureau</em><span> is calling D.M., immigrated to Canada as an international student from India, making him a minority among mostly Chinese-Canadian co-workers at the Aurora branch.&nbsp;</span></p><p><span>As D.M. probed his colleagues, his belief gained conviction, that HSBC Canada and other Canadian banks including </span><a href="https://betterdwelling.com/cibc-kills-foreign-income-program-makes-buying-canadian-real-estate-harder/" rel="">CIBC</a><span> had systemic problems with highly questionable mortgages issued to diaspora buyers with unverified sources of wealth in China.</span></p><p>Losing sleep, in April 2022, D.M. sent an audacious email to senior bank executives: “I am going to reveal potential mortgage fraud at HSBC Bank Canada and possibly some employees benefited from the fraud, financially pocketing thousands of dollars, which I call the proceeds of crime.”</p><p><span>D.M.’s explosive four-page complaint triggered an internal investigation that led to some reforms at HSBC Canada according to internal emails obtained by </span><em>The Bureau.</em></p><p>But more than a year later, D.M. was so dissatisfied with the bank’s response that he risked sharing his story and numerous internal documents for an unprecedented journalistic investigation into Canada’s housing affordability crisis.</p><blockquote><p><span>“I found out a huge mortgage fraud showing borrowers with exaggerated income from one specific country, China, pretending to be working remotely,” D.M. informed </span><em>The Bureau</em><span> in June 2023. “I believe the housing prices in Toronto are linked to this, because this is about income verification in banks, which is supposed to moderate demand.”</span></p></blockquote><p><em>The Bureau</em><span> asked HSBC Canada to review emailed information for this story and provide an appropriate manager for an interview regarding D.M. 's records and allegations.</span></p><p>“I won’t have anyone to speak with you directly,” Sharon Wilks, Head of Communications, responded. “But for context: As a global bank, HSBC is at the forefront of efforts to identify, prevent and deter financial crime … We will not do business with individuals or entities we believe are engaged in illicit conduct.”</p><p>Wilks added that HSBC Canada “can and do regularly exit relationships with clients whose activities we deem too risky.”</p><p><em>The Bureau’s</em><span> seven-month investigation into D.M.’s allegations suggests HSBC Canada and other Canadian banks could have issued many billions of dollars in questionable mortgages to Chinese diaspora buyers, and a significant cause of Canada’s real estate bubble is hundreds of billions in illicit fund transfers from China into Canada, and bank lending that amplifies its impacts, especially in Toronto and Vancouver home prices.</span></p><p>“There are thousands of these cases, large scale,” D.M. said in an interview. “Hardworking Canadians are denied mortgages and these Chinese residents forge documents and get mortgages approved, heating up the already hot Ontario real estate markets.”</p><p>“These people don’t have steady jobs or income in Canada,” he alleged, “but what they are doing is scams to launder money, and get mortgages using fake documents.”</p><p><em>The Bureau’s </em><span>investigation included asking seven prominent Canadian experts to assess some of D.M.’s documents, allegations and conclusions.</span></p><p>This investigation suggests D.M. 's calculation is plausible, that the Aurora branch and other Toronto-area HSBC branches have issued at least $500-million in questionable Chinese income loans since 2015.</p><p>But D.M’s findings could also change the public’s understanding of housing affordability in Toronto and Vancouver, a politically explosive issue expected to frame Canada’s upcoming federal election.&nbsp;&nbsp;</p><p><span>This is because, according to the academics and criminologists that reviewed D.M.’s documents with</span><em> The Bureau, </em><span>his evidence fits into FINTRAC’s much broader examinations of suspicious real estate and banking transactions.</span></p><p>In 2023, the anti-money laundering watchdog published a ground-breaking study into 48,000 Chinese diaspora banking transactions.</p><p>FINTRAC found that during the Covid-19 pandemic, because Canadian casinos were closed, Chinese underground banking schemes evolved, flooding electronic fund transfers from Hong Kong into Canadian bank accounts that served like corridors for murky real estate transactions.&nbsp;</p><p><em>The Bureau’</em><span>s analysis also finds that what D.M. discovered in Toronto banks, finally sheds light on mysterious capital flows discovered by a prominent Canadian academic in 2015, in a study of Vancouver land titles and mortgages. </span></p><p>That examination of $525-million worth of real estate purchases in a six-month period found 66 percent of buyers in several affluent neighbourhoods were recent Chinese diaspora migrants, and most mortgages went to buyers with little or no income in Canada.</p><p><span>Similarly, what D.M. found in his probe of pandemic-era loans could be called the evolving “Toronto Method” of an underground banking system discovered first in Vancouver, and </span><a href="https://cullencommission.ca/files/reports/CullenCommission-FinalReport-Full.pdf" rel="">found to be</a><span> laundering a stunning $1.2-billion in cash from Mainland China through British Columbia government casinos in 2014.</span></p><p><span>This system of shadowy transfers was dubbed the </span><a href="https://globalnews.ca/news/4658157/fentanyl-vancouver-real-estate-billion-money-laundering-police-study/" rel="">“Vancouver Model”</a><span> by an Australian professor, and brings together transnational organized crime, affluent Chinese nationals seeking to export their wealth abroad, and Canadian casinos, banks and real estate, in transactions that evade policing because the pivotal cash exchanges are done off the books by professional money launderers serving the global Chinese diaspora.</span></p><p>According to FINTRAC’s 2023 study of 48,000 pandemic-era transactions, this evolving Vancouver Model network&nbsp;“simultaneously facilitates money laundering and the circumvention of Chinese currency controls”</p><p>“As a result of the temporary closures of Canadian casinos due to the COVID-19 pandemic, professional money launderers began to diversify their money laundering methods,” FINTRAC’s study says. </p><p>“During this time, FINTRAC observed a rise in money laundering typologies involving transferring large sums of funds to Canada from foreign money services businesses, often located in China, notably Hong Kong, and the laundering of the funds primarily through the real estate, securities, automotive and legal professions.”</p><p>These wire transfers from China were routed into bank accounts of “multiple, unrelated individuals in Canada,” that served as “money mules” in byzantine networks involving Canada-based real estate developers, real estate agents, mortgage brokers and banks.</p><p>These Chinese diaspora bank account owners often claimed they were students, homemakers, office managers, or unemployed, FINTRAC reported.</p><p>They sometimes used their accounts to send bank drafts to others in Canada for home purchases, or served as “straw buyers” for offshore investors.</p><p>“Mortgage payments are sourced from incoming funds from China,” FINTRAC’s alert said.</p><div><figure><a target="_blank" href="https://fintrac-canafe.canada.ca/intel/operation/ml-rec-eng" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png" width="1456" height="940" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:940,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:1047399,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:&quot;https://fintrac-canafe.canada.ca/intel/operation/ml-rec-eng&quot;,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F5b3c1365-9abb-4827-82d7-bb89048db9f4_2276x1470.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>FINTRAC’s 2023 Project Athena alert on Chinese money laundering schemes using Canadian banks and real estate.</figcaption></figure></div><p>FINTRAC’s study doesn’t say that Canadian banks knowingly issued fake-income mortgages to Chinese diaspora buyers in Toronto.&nbsp;</p><p>But in an interview, D.M. said banking staff are trained to guard against fraud, and the loan application packages he reviewed in Aurora beggared belief.</p><p>“The bank found out that one lady works in a casino part-time but got a $1.4 million mortgage showing over $300,000 annual income,” he said. “Plus she takes money as benefits from the government, for her two kids.”</p><p>In other examples, an HSBC mortgage client claimed to earn $700,000 annually for remote work in China, while simultaneously living in Canada and paying off a $10,000 student loan.&nbsp;</p><p>Another woman who owned homes in Aurora, Markham and Scarborough, worked part-time as a hairdresser while also claiming to earn $536,280 at a “Business Manager” job in Guangzhou.&nbsp;</p><p>“Canadian workers have been put out of the real estate market by people working as a hairdresser that own a couple homes,” D.M. said in an interview. </p><p>“How is that fair?”</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png" width="1456" height="773" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/ea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:773,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:4345438,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea7e29cf-ae2d-4037-a9bf-4be7956bcef3_2298x1220.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p><span>The most shocking case reviewed by </span><em>The Bureau</em><span>, shows that one woman that owns at least four Toronto properties opened her HSBC Aurora bank account in 2012, claiming to be a “Homemaker with no annual income.”&nbsp;</span></p><p>But her Toronto account soon received incredible amounts of wire transfers from HSBC China accounts, and paid out “high value cheques” to third parties for real estate purchases. </p><p>This case suggests “Toronto Method” shadow banking described in FINTRAC’s 2023 study has been seeping into Toronto real estate for about a decade.</p><p>And yet in 2020, this same woman applied for another HSBC Canada mortgage, claiming to earn $763,000 remotely from her job in China.</p><p>This evidence from the HSBC whistleblower complements the seminal investigations of Simon Fraser University academic Andy Yan, who examined sales from August 2014 to February 2015 in several communities on Vancouver’s westside. The average home price in Yan’s study was $3-million.</p><p><span>Looking back at his Vancouver findings in comparison to D.M.’s Toronto banking documents, Yan told </span><em>The Bureau</em><span> “I think this helps affirm some of my early work that I did, almost nine years ago.”</span></p><blockquote><p>“This goes to the core of our banking system,” he said, “and how are we verifying identities and how are we verifying incomes.”</p></blockquote><p>In Yan’s controversial study the vast majority of mortgages went to buyers listing their occupation as home-maker, followed by students, and managers. HSBC and CIBC were the dominant lenders. </p><p>Unlike the HSBC whistleblower, Yan had no access to internal banking data regarding the purported origin of funds behind these mortgages taken by Chinese diaspora buyers.&nbsp;</p><p><span>But in an interview, Yan said what he found most interesting back in 2015, was suspicions that Chinese migrants were often buying homes with </span><a href="https://www.ice.gov/partnerships-centers/bcsc/faq" rel="">bulk cash, </a><span>weren’t accurate. The truth was more </span><a href="https://globalnews.ca/news/4658158/fentanyl-kingpins-canada-big-circle-boys/" rel="">complex</a><span> and seems to be clarified by D.M.’s mortgage findings in Toronto.</span></p><p>“It's about that global flow of capital, and how it's multiplied by Canada’s mortgage and lending system,” Yan said. “Because you have to remember, one of the biggest conclusions about my study was that it wasn't bags of cash that were being used to purchase Vancouver homes outright. They were loans being used. So now, I’m thinking, this is where my study connects up to what you have discovered in Toronto.”</p><p>“The interesting story here,” Yan added,&nbsp;“is what happens in Toronto real estate may not repeat Vancouver, but it perhaps rhymes.”</p><p>Probably the most famous Chinese property owner from Yan’s 2015 study areas is Huawei executive Meng Wanzhou. In 2009 her family bought a home in Vancouver’s Dunbar neighborhood for $2.73 million, land titles show. In 1998, ten years before Vancouver Model transactions started to surge in Vancouver real estate, the home was sold for $370,000. The home is now valued at almost $6-million.</p><p><a href="https://summit.sfu.ca/item/37923" rel="">Ashleigh Gonzales</a><span>, a former RCMP data scientist who recently published a criminology thesis finding Chinese diaspora underground banking causes significantly more money laundering into Canada’s real estate than previously estimated, said that D.M.’s findings resemble her own Vancouver Model research.</span></p><p>“This whistleblower’s allegations of widespread mortgage fraud at HSBC Canada align with some of the first-hand accounts from staff of some Canadian financial institutions that I have come across in my research on money laundering in British Columbia,” Gonzales said. </p><p>Gonzales, who worked for RCMP’s anti-gang unit in British Columbia until 2023, says she found reports of mortgage fraud accelerated “during the uptick in the Canadian housing bubble after the Vancouver 2010 Olympics,” and continued to surge from 2015 to 2018.</p><p><span>With all this considered, and comparing data sources in this story with previous evidence confirmed in British Columbia’s </span><a href="https://cullencommission.ca/files/reports/CullenCommission-FinalReport-Full.pdf" rel="">Cullen Commission, </a><em>The Bureau </em><span>estimates that from 2014 to 2023, well over $200-Billion in Vancouver Model and Toronto Method funds could have poured through underground diaspora networks and Canadian financial institutions into Toronto and </span><a href="https://globalnews.ca/news/4658157/fentanyl-vancouver-real-estate-billion-money-laundering-police-study/" rel="">Vancouver’s real estate.</a></p><p><span>A federal official not authorized to comment publicly also examined D.M.’s banking leaks for </span><em>The Bureau,</em><span> and called this information “explosive.” </span></p><p>The official said money laundering is increasing in Canada, and D.M.’s belief that Chinese-income mortgage fraud has boosted home prices in Toronto is likely true, but also should apply for Vancouver and Montreal real estate prices. The official noted that other nations require tax agencies to verify incomes for mortgages, which isn’t the case in Canada.</p><p>“It matters for our next generation because of the impact on the housing market,” the official said.&nbsp;</p><p><span>Queen’s University professor Christian Leuprecht – editor of</span><em> Dirty Money</em><span>, a new academic text that probes how Ottawa’s weak regulation has “turned the Canadian federation into a destination of choice for global financial crime” – also reviewed some of D.M. 's leaks.</span></p><p>“It’s not a new problem, but you’re taking it to the next level,” Leuprecht said. </p><blockquote><p>“Why does this matter?&nbsp; Because organized crime isn’t just laundering their ill-gotten gains, like any good business person, when they buy real estate, they generate a down payment, then get a mortgage for the rest.&nbsp; Why buy one property when you can buy four?”</p></blockquote><p><em>The Bureau’s</em><span> review of HSBC Canada emails and D.M.’s text messages, shows he came to believe numerous employees at the Aurora branch had direct knowledge of faked Chinese income mortgages, and a veteran manager with oversight of more than 10 Greater Toronto branches knew about broad and questionable mortgage lending for Chinese diaspora clients.</span></p><p>Months after D.M. blew the whistle internally he exchanged texts with another employee, identifying colleagues that they believed had knowledge of diaspora mortgage scams. </p><p>The texts suggest D.M. believed HSBC Canada and other Canadian banks continued to hold vast amounts of suspicious foreign income mortgages, which could cause systemic loan quality risks if Toronto’s real estate prices decline.</p><p>“Do you know how many mortgage frauds we have in our books,” D.M. texted to his colleague. “It’s insane.”&nbsp;</p><p>“She told me,” the colleague replied, referring to an HSBC branch manager. </p><p>“She was like, if you do come, you gotta be prepared for the mortgage payout.”</p><p>“These people showed fake income and got mortgage,” D.M. continued. “Now interest rate is high, they can’t cope.”</p><p>“Other branches did the same thing too,” his co-worker replied. “I heard there’s a lot.”</p><p>“Absolutely,” D.M. texted. “All branches engaged in it.”</p><p>“This is like the unspoken secret,” his co-worker concluded. “I’m pretty sure other banks have it too. My Aunt have no income and got a mortgage for 700k. They just need a Covenanter from China.”</p><p>Generally, in mortgage contracts a covenanter takes responsibility for the loan if the primary borrower defaults.&nbsp;</p><p><span>Internal records reviewed by </span><em>The Bureau</em><span> confirm that on April 18, 2022, D.M. sent a lengthy complaint email to senior HSBC Canada executives, informing them of allegations he’d learned from his colleagues.&nbsp;</span></p><p>In it, he alleges that an Aurora manager had informed him of a complaint letter posted to the branch, that accused mortgage brokers and branch employees of colluding in scam mortgages emanating from Mainland China fraud networks.</p><p>Pointing to specific examples, D.M. claimed that another branch colleague had admitted processing numerous loan applications without meeting his clients, because a branch manager delivered her subordinates foreign income client applications so “they did not have to get sales themselves.”</p><p>&nbsp;“Surprisingly all these clients he would get will have foreign income most of the time very inflated like 400k or 670k a year,” D.M. wrote. “To me that’s suspicious, but he never questioned the branch manager because in Asian culture it’s disrespectful to question elders.”</p><p>D.M. also informs his bosses that one Aurora bank manager opened up to him, saying she believed allegations of mortgage fraud collusion involving some branch staff.</p><p>“She said yes, she knows specially in Mainland China there is a team who would even answer emails and phone calls verifying [Chinese income] but it’s a sophisticated and well organised scam,” D.M. 's email to HSBC Canada managers says.</p><p>His complaint explains that he continued to press an Aurora bank manager on her knowledge of fraud allegations.</p><p>“When I asked for such a serious issue if she raised a HSBC confidential [complaint] or not she evaded my question,” D.M. wrote. “Now we all love numbers, but I don't think the bank will like these kinds of numbers achieved through this way.”</p><p>Describing why he contacted HSBC Canada executives directly, the whistleblower’s complaint says he felt confused and isolated, but D.M. decided “local leadership if not participated, at least turned a blind eye,” to Chinese fake-income scams, forcing D.M. to “bring up a serious issue against people of superior positions.”</p><p>“I could not have stayed silent, in fact I could not sleep well thinking about it,” his April 2022 complaint says. “It reminds me to some extent what happened with the Home Capital Group.”</p><p>“The whole thing is wrong on so many grounds,” D.M. continued.</p><blockquote><p>“Now I know one more reason why Canadians and permanent residents are not getting into the housing market. It’s not only HSBC such things are happening across other Canadian banks as well.”</p></blockquote><p><span>In the</span><a href="https://www.osc.ca/sites/default/files/pdfs/proceedings/set_20170614_home-capital.pdf" rel=""> Home Capital case,</a><span> the Ontario Securities Commission fined the prominent Ontario-based subprime mortgage lender in 2017, alleging Home Capital failed to disclose several of its mortgage brokerages had major problems with faked-income mortgages.</span></p><p>D.M. concluded his four-page complaint to senior executives, writing: “I recommend all mortgage deals of this branch in the last 3 years at least if not longer with Foreign income be probed.”</p><p>“Bank statements can be verified directly with the foreign banks or use a reputable third party to verify,” he suggested. “When we find someone with Fake ID or trying to impersonate someone we call the cops. But these people, both staff nor clients who did fraud were reported.”</p><p>Hours later on April 18, 2022, an HSBC Canada executive emailed back: “I am going to refer this to our Fraud and Risk teams and they will investigate your concerns.”</p><p>The next day D.M. continued to hound HSBC Canada managers with emails to support his allegations, spotlighting the absurdity of massive Chinese remote incomes claimed by diaspora buyers.</p><p>He pointed to one woman with a $1.6-million HSBC Canada mortgage.</p><p>“The client claims to be in Canada but [is] a office supervisor in China. [In the] age of remote working in which country [does] a office supervisor makes 400k please tell me,” D.M. wrote.</p><p> “[W]hen I asked the co-worker she said her job is not to use the brain or be a police, when I asked do you think she makes that kind of money and how is she doing her job being in Canada to be an office supervisor in China[?]”</p><p>Pointing to another document,&nbsp;D.M. warned his managers about Ms. Chen, who claimed to make $721,000 annually as “project manager” for a Beijing telecommunications company, to secure a $1.89 million mortgage.&nbsp;</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png" width="1456" height="510" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/bcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:510,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:1928546,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbcc45270-172a-4e1a-a3f2-730bd8cb8e41_1782x624.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p>Again on May 4, 2022, D.M. emailed executives, suggesting internal records for an Aurora client named Ms. Jin had been altered soon after D.M. blew the whistle on fake Chinese income loans.</p><p>His email, which included Ms. Jin’s client profile, warned: “Something interesting happened yesterday, they added a China address to go with [the] story of working in China, please see below.”</p><p><span>The Aurora branch banking records disclosed to </span><em>The Bureau</em><span> show that Ms. Jin owns three homes in the blocks surrounding Pacific Mall in Markham.</span></p><p>“The client was onboarded on 24th March with Canada address only and Canadian tax residency,” D.M.’ s email continued.</p><p>“She claims to be working in China and have foreign income, so the story she is stuck in Canada due to Covid is very interesting. Suddenly yesterday she decided her address in China. Someone saw the discrepancies and the branch team decided to change it.”</p><p>“To me that's a red flag done to align with the story portrayed.”</p><p>Next, D.M. exposed Ms. Chen’s foreign income claim.</p><p>“She works for Food processing company, a logistics officer making 273k a year,” he wrote. “I don't know which logistics officer can work when physically in a different company and also who makes 273k working as a logistics officer.”</p><p>Citing another internal banking record, D.M.’s email pointed to Ms. Jin’s $273,000 income and said “it’s interesting how they did the verification.”</p><p>The email continues to explain that branch records showed Ms. Jin and her husband had a joint mortgage with a balance of $497,000 at CIBC. </p><p>But suddenly during Covid-19, Ms. Jin applied for a new mortgage for $1.2 million with HSBC Canada.</p><p>“When I see such things I can't stay quiet,” D.M.’s May 2022 email says. “[I] was assuming with the new rules things will stop, [but]&nbsp;declining the mortgage or retraining the staff is like treating the symptoms.”</p><p>He added that many suspicious Chinese income loans had been “flagged by our Fraud Team already.”</p><p>The whistleblower’s scathing assessment ends with the observation that D.M. didn’t believe “someone woke up and decided to scam the bank, but [worked with] a sophisticated network of agents who are training people what to say and answer.”</p><p>“The implications are broader and as a responsible bank and citizen we have to,” request investigations from the Canadian Revenue Agency or Ontario Provincial Police, D.M. asserted.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png" width="1456" height="982" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:982,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:3900114,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a768b85-da71-4092-94ee-6e2dc0b3a464_1800x1214.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>D.M., who asked not to be named because he could face reprisals, filed a four-page whistleblower complaint with HSBC Canada managers in April 2022.</figcaption></figure></div><p><em>The Bureau</em><span> asked</span><a href="https://summit.sfu.ca/item/37923" rel=""> Ashleigh Gonzales</a><span>, the former RCMP data scientist, to review some of D.M.’s documents and conclusions.</span></p><p>“From what I have reviewed, D.M.’s findings align with what appear to have been commonplace practices by some groups of staff complicit from the front line, middle office, and back office and sanctioned by management,” Gonzales wrote, adding “whether knowingly or not depends on the individual work cultures.”</p><p><em>The Bureau</em><span> also asked Stephen Punwasi to review D.M. 's leaked banking documentation.</span></p><p><span>Punwasi is a financial expert who founded </span><em>Better Dwelling,</em><span> a real estate analysis website with a large following of young professionals trying to understand </span><a href="https://betterdwelling.com/canadas-real-estate-bubble-is-batsht-crazy-compared-to-other-g7s/" rel="">why they’re excluded </a><span>from home ownership in Canadian cities.</span></p><p>He also provided analysis for British Columbia’s 2018 report into Vancouver Model money laundering in casinos, real estate and luxury vehicles.&nbsp;</p><p>What Punwasi explained to the report’s author, former RCMP executive Peter German, is that even though Vancouver Model money launderers don’t comprise a majority of buyers in Vancouver, their willingness to overbid on home sales causes ripples that sends prices skyrocketing, especially during times when political turmoil inside China triggers increased capital flight.</p><p>“In 2015 and 2016 Ontario saw this flood of money from China, just like British Columbia, and it was not just to do with immigration, it was due to President Xi’s political crack down on corruption,” Punwasi said. “I think we’ve seen that capital flight in Ontario and B.C. in two big cycles, also including 2020 and 2021.”</p><p><em>The Bureau</em><span> asked Punwasi if the banking records disclosed by D.M. help to explain Toronto’s real estate price surges.</span></p><p>“Absolutely,” he said, pointing to the case of Ms. Jin (who claimed a $273,000 remote-work income in China) and her three homes surrounding Markham’s Pacific Mall. </p><p>Property buyers that aren’t shopping for shelter, but for capital flight or money laundering vehicles, are what Punwasi terms the “marginal buyer.”</p><blockquote><p>&nbsp;“The marginal buyer is like an exuberant buyer on crack, so if they are motivated to move as much money as possible,” he said, “the larger the mortgage they can get, it helps them to overpay for homes, and that can cause the price to launch.”</p></blockquote><p>“So if you see a townhome in Toronto going for $2-million, you don’t know if it is mortgage money laundering or someone buying a place to live. You just have to compete with the going price.”</p><p>Punwasi says housing prices are a powerful political issue that will shape the next federal election. </p><p><span>But at the same time, young generations are confused by competing explanations on the causes of Canada’s housing affordability crisis, Punwasi believes, whether its lack of housing supply due to restrictive zoning bylaws, or increased demand due to recent immigration surges, or other factors that make Canada’s </span><a href="https://betterdwelling.com/cibc-kills-foreign-income-program-makes-buying-canadian-real-estate-harder/" rel="">housing bubble </a><span>an outlier in the Western world.</span></p><p>“There are so many conflicting narratives right now that people find it hard to believe the scale of impact that money laundering can have on Toronto real estate prices,” Punwasi said. “But no one has thought it through, that having criminals run our renting stock is a liability.”</p><p>Punwasi also believes that Prime Minister Justin Trudeau’s government has decreased scrutiny of money laundering in recent years.</p><p><span>He points to new data uncovered in a ministerial inquiry from Conservative MP Adam Chambers, who is a proponent of </span><a href="https://www.adamchambersmp.ca/bill-c-289" rel="">tougher money</a><span> laundering laws, which found sharp declines in Canadian Revenue Agency audits of FINTRAC leads.</span></p><blockquote><p><span>“The systemic corruption in housing has been snowballing,” Punwasi said, “to where it's turned into, maybe the banks don’t need to check where the </span><a href="https://betterdwelling.com/cibc-kills-foreign-income-program-makes-buying-canadian-real-estate-harder/" rel="">incomes</a><span> are coming from, and now whole generations can’t find stable shelter.”</span></p></blockquote><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png" width="1456" height="1103" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/c53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1103,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:237254,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc53837cb-1742-46ff-b773-3ecee1451e3a_1494x1132.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>Adam Chambers, a Toronto-area Conservative MP who unsuccessfully tabled a private members bill on stricter anti-money laundering laws, found CRA money laundering reviews are decreasing.</figcaption></figure></div><p><span>HSBC Canada emails reviewed by </span><em>The Bureau</em><span> show that while the bank appears to have responded to some of H.M. 's recommendations in 2022, troubling mortgage applications and problems with existing Chinese income loans continued.</span></p><p>A January 2023 email to an Aurora branch manager from HSBC Canada’s office in Montreal pointed to a client named Ms. B., who worked at an Ontario government casino, and owned homes across Toronto, in Richmond Hill, Newmarket and East York. </p><p>Documents show she obtained an HSBC Canada mortgage for $1.26 million in 2016, and that HSBC Canada staff&nbsp; “confirmed” in July 2021 that she was earning $345,000 with a remote work job in Beijing.&nbsp;</p><p>Despite her incredible claimed income, documents show, Ms. B. was having trouble paying at least one of her three mortgages.&nbsp;</p><p>An email from a “Senior Loss Mitigation” employee in Montreal to an Aurora branch employee says: “client is going through a tough time … her income is limited … I know she collect rent and she use it to pay her second mortgage. Please review the situation with the client to see if there is any special agreement available to her.”</p><p>But Aurora’s branch wrote back to the Montreal branch: “What we have told her is … if she really can’t pay, then she just have to put her house for sale … but she doesn’t want to do that.”</p><p><span>In an interview D.M. told </span><em>The Bureau</em><span> this case was typical.</span></p><p>“What they are doing is AirBnBing these properties,” he said. “But they can’t manage with higher interest rates.”</p><p>He said during mortgage application interviews at the Aurora branch he would often look across his desk and ask questions without letting clients know he was looking at their income claims from purported Chinese companies on his computer screen.&nbsp;</p><blockquote><p>“Most of these people don’t even know what type of company is in their job profile,” he said.</p></blockquote><p><span>And documents reviewed by </span><em>The Bureau</em><span> show that mortgage applications consistent with Fintrac’s 2023 Chinese money laundering report continued in Aurora.&nbsp;</span></p><p>In May 2023, D.M. emailed a senior HSBC Financial Crime Compliance investigator, writing “Just came across two profiles of clients and I have strong evidence these mortgages were also obtained with fake docs and fraudulently.”</p><p>When the investigator responded “I will take a look,” D.M. replied: “One had a CDA student loan of 10k and making 700k in China. Makes no sense, there are many other anomalies.”</p><p><span>In interviews,&nbsp;D.M. told </span><em>The Bureau</em><span> he waited “patiently for a year” after reporting his Chinese-income mortgage concerns to HSBC Canada managers, before concluding the bank’s response was insufficient.</span></p><p>“This has been going on for seven&nbsp;years and no one spoke up,” he said.&nbsp;“In my first meeting last year, they asked me a lot of questions, like why didn’t you use the normal channels? But I had no faith in the normal channels.”</p><p>“Many bank staff were obviously involved,” D.M. alleged. “It was not one or two employees turning the blind eye but the entire system, someone verifying those fake offer letters and pay stubs, or their bank statements from China.”</p><p>D.M. said his concerns also included HSBC Canada’s proposed sale to RBC, which was announced in 2022, about six months after D.M. 's April 2022 internal complaint. The sale was approved in December 2023 by Canada’s deputy Prime Minister Chrystia Freeland.</p><p>Christian Leuprecht, among other experts interviewed for this story, agreed that D.M.’s allegations of widespread Chinese-income frauds at HSBC Canada could raise questions about whether Freeland, Canada’s finance minister, had knowledge of mortgage lending investigations inside HSBC when she approved the sale.</p><p><span>Freeland directed RBC to “establish a new Global Banking Hub in Vancouver,” and “maintain Mandarin and Cantonese banking services at HSBC branch locations,” a Department of Finance </span><a href="https://www.canada.ca/en/department-finance/news/2023/12/government-of-canada-approves-sale-of-hsbc-bank-canada-to-the-royal-bank-of-canada-with-conditions.html" rel="">statement says.</a></p><p>Ultimately, D.M. says he chose to share his story with Canadian citizens partly because he felt pressured to erase evidence from his whistleblower complaint emails.</p><p>A June 2023 email from the bank’s personnel department says “we hereby demand that you immediately and permanently delete any and all HSBC information on any personal email accounts.”</p><p>“If you do not comply with these obligations,” the email warns, “HSBC also reserves the right to bring this matter to the attention of relevant law enforcement agencies.”</p><p>Another July 2023 email from senior management said: “I will reiterate how much we appreciate that you spoke up,” and confirmed that D.M.’s complaints to HSBC Canada resulted in “several enhancements to income verification procedures.”&nbsp;</p><p>The manager’s email continues, saying “as part of your escalation, you sent confidential information from the bank to your personal email account,” and asserts that D.M. had promised to delete the “confidential client information in your personal possession.”</p><p>“I could not sleep, and they were telling me delete, delete, delete,” D.M. recalled in an interview.</p><p><span>HSBC Canada did not respond to follow-up questions from </span><em>The Bureau</em><span> regarding D.M.’s specific allegations.</span></p><p>Now he is looking for accountability.</p><p>“There should be a thorough, retrospective audit of HSBC Bank mortgage deals and eventually all Canadian banks in Canada and stricter regulations when it comes to mortgage approval showing foreign income,” D.M. said, “because there are many skeletons in the cupboard.”</p><p><span>Garry Clement, a former RCMP anti-money laundering expert who also contributed to the Canadian academic text </span><em>Dirty Money, </em><span>reviewed some of D.M.’s Toronto Method documents, and commented “the best description of the bank’s actions, is willful blindness.”&nbsp;</span></p><blockquote><p>“This is one well-documented example of how banks are catering to Chinese citizens without following strict know your customer guidelines as they would for any Canadian,” Clement said.&nbsp; </p><p>“We must recognize that a lot of the loans occurred at a time when our political leaders catered to China with a naïve understanding.”</p></blockquote><p><span>Calvin Chrustie, a former RCMP transnational crime investigator </span><a href="https://nationalpost.com/news/canada/canada-a-safe-haven-for-transnational-crime-networks-and-their-dirty-money-u-s-report" rel="">whose recent  report</a><span> finds Canada’s weak regulations have made the nation a playground for underground banking linked to organized crime in China, Iran and Mexico, noted that in 2012, U.S. regulators hit HSBC with a $1.9 billion fine because of $881-million in suspicious transactions with Mexico’s Sinaloa cartel and Colombia’s Norte del Valle cartel.</span></p><p>“The bigger question in Canada now is why aren’t we looking at what is happening in the banks?” Chrustie said. “We haven’t looked at the complicit actions of financial institutions, while we rely on well-intended entities like FINTRAC, who like police are often restricted in what they can do, or say to the public.”</p><p><span>FINTRAC would not confirm or deny whether its recent fines on CIBC for failing to report suspicious</span><a href="https://fintrac-canafe.canada.ca/pen/amps/pen-2023-12-05-eng" rel=""> wire transactions</a><span> and a fine on RBC for failing to report suspicious transactions</span><a href="https://fintrac-canafe.canada.ca/pen/amps/pen-2023-12-05-eng" rel=""> related to frauds,</a><span> relate to FINTRAC’s 2023 report on Chinese shadow banking and pandemic-era bank account and real estate transactions. </span></p><p><span>FINTRAC also would not confirm whether a </span><em><a href="https://www.theglobeandmail.com/business/article-td-bank-fintrac-penalties-anti-money-laundering-controls/" rel="">Globe and Mail</a></em><a href="https://www.theglobeandmail.com/business/article-td-bank-fintrac-penalties-anti-money-laundering-controls/" rel=""> </a><span>report that TD Bank faces a money laundering compliance fine of more than $10-million is accurate, or relates to the Covid-19 shadow banking schemes.</span></p><p>Like the former RCMP experts interviewed for this story, Andy Yan says governments in Ottawa and British Columbia and Ontario are ultimately responsible for ushering mysterious wealth into Canada’s homes.</p><p>“It’s like, this isn’t entirely new, what you have found in Toronto,” Yan summed up. </p><blockquote><p>“When you have programs that are directly meant to domesticate foreign capital into local real estate markets, you start seeing these patterns or these incongruities between incomes and house values. And we have institutions that really are supposed to safeguard us in terms of transparency and accountability.”</p></blockquote><p>Meanwhile, a second property owned by Meng Wanzhou in Vancouver attests to the murkiness surrounding Chinese wealth, but also broader concerns of former RCMP experts interviewed for this story, on how and why Chinese state and non-state actors move funds globally.</p><p><span>In 2016 Meng, who held at least </span><a href="https://www.agpllp.ca/insights/the-many-passports-of-arrested-huawei-cfo-meng-wanzhou/" rel="">seven different</a><span> visas or passports, purchased a $15-million mansion with an </span><a href="https://www.straight.com/news/huaweis-meng-wanzhou-loved-vancouver-and-has-two-homes-worth-at-least-182-million" rel="">HSBC Canada </a><span>mortgage in Shaughnessy, a luxurious community just outside of Yan’s study areas. </span></p><p><span>Other mansions in Shaughnessy featured prominently in a confidential RCMP study of all homes sold for between $3-million and $30-million in 2016. That police intelligence study </span><a href="https://globalnews.ca/news/4658157/fentanyl-vancouver-real-estate-billion-money-laundering-police-study/" rel="">found Chinese transnational gangsters </a><span>and Vancouver Model suspects linked to over $1-Billion in property purchases in 2016.</span></p><p><span>Ironically — in the case that disrupted Canada’s warming relations with China under Justin Trudeau — Meng finally admitted to U.S. government </span><a href="https://www.justice.gov/opa/pr/huawei-cfo-wanzhou-meng-admits-misleading-global-financial-institution" rel="">financial fraud </a><span>charges that she misled HSBC about international transactions, and “Meng and her fellow Huawei employees engaged in a concerted effort to deceive global financial institutions, the U.S. government and the public about Huawei’s activities in Iran.” </span></p><p><em>sam@thebureau.news</em></p></div></article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Cannabis use linked to anxiety diagnoses, worsened anxiety disorders (138 pts)]]></title>
            <link>https://globalnews.ca/news/10275463/cannabis-anxiety-ontario-study/</link>
            <guid>39277299</guid>
            <pubDate>Tue, 06 Feb 2024 17:22:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://globalnews.ca/news/10275463/cannabis-anxiety-ontario-study/">https://globalnews.ca/news/10275463/cannabis-anxiety-ontario-study/</a>, See on <a href="https://news.ycombinator.com/item?id=39277299">Hacker News</a></p>
<div id="readability-page-1" class="page"><article aria-label="Article text">
					<p>Cannabis use may increase the risk of developing a new <a href="https://globalnews.ca/tag/anxiety">anxiety</a> disorder or worsen existing anxiety, a large&nbsp;Ontario&nbsp;study suggests.</p><img src="https://d21y75miwcfqoq.cloudfront.net/70c8fc80" alt="" referrerpolicy="no-referrer-when-downgrade">
<p>The study looked at health data of 12 million people between January 2008 and March 2019 and found that 27.5 per cent of people who visited an emergency room for cannabis use developed an anxiety disorder for the first time within three years.</p><p>Lead author Dr. Daniel Myran, an adjunct scientist at the research institute ICES, said that in comparison, 5.6 per cent of the general population sought help for anxiety in an ER or outpatient setting over three years.</p><p>Myran, who is also an investigator at the Bruyère Research Institute and a clinician investigator at The Ottawa Hospital, said cannabis users may end up in an ER for multiple reasons, including hallucinations, being very high and disoriented or for withdrawal symptoms.</p>		<div>							<p>Story continues below advertisement</p>
			
			
			

					
		</div>	<p>“They might have been having some kind of mental health concerns, were feeling quite depressed and also smoking cannabis very regularly. None of these people had an emergency room visit for anxiety when they first showed up,” he said.</p><p>The study did not include data on how much cannabis patients used or what is a safe amount, but Myran said it’s likely they were moderate to heavy users, consumed strong forms of the drug, or both.</p>	<div id="sophi_article_widget" aria-label="More on Money" data-sophi-feature="article-money">
						<p>More on Money</p>
						<ul>
							<li>
					<a href="https://globalnews.ca/news/10276098/boeing-faa-head-testimony/">FAA head says Boeing’s oversight system ‘is not working’					</a>
				</li>
								<li>
					<a href="https://globalnews.ca/news/10275722/auto-theft-summit-canada/">Poilievre wants X-rays to curb auto theft. Liberals say issue’s more complex					</a>
				</li>
								<li>
					<a href="https://globalnews.ca/news/10275487/canada-housing-benefit-top-up/">Ottawa to top up Canada Housing Benefit rent support by $99M: Freeland					</a>
				</li>
								<li>
					<a href="https://globalnews.ca/news/10273517/grocery-prices-canada-february/">Higher grocery bill? Here’s why some food prices may be rising in Canada					</a>
				</li>
							</ul>
		</div>
	<p>Researchers also found that 12.3 per cent of cannabis users with pre-existing anxiety but no record of hospitalization visited an emergency room or were admitted to hospital because their anxiety symptoms worsened.</p>		<div>
			<p><strong>
				Get the latest National news.
				
				Sent to your email, every day.
				
			</strong>
		</p></div>
		<p>The study published Monday in the Lancet’s open access journal eClinical Medicine says that while people of all ages who had a cannabis-related ER visit were at higher risk of developing new anxiety disorders, the risk was particularly great for males up to age 24.</p><p>While some people may self-medicate by using cannabis to relieve anxiety, there is no robust evidence to suggest it is effective for that purpose, Myran said.</p><p>“If you’re having problems with your cannabis use or problems with mental health, the first place to start would be a primary care provider to understand what’s going on. And I’m sympathetic and understand that there’s challenges with accessing primary care in many parts of the country,” he said.</p>		<div>							<p>Story continues below advertisement</p>
			
			
			

					
		</div>	<p>“The worrisome signal coming out of the data is that on average, there’s a very strong association between patterns of cannabis use that require care in the emergency room and<strong>&nbsp;</strong>developing anxiety disorders,” said Myran, adding psychosis and schizophrenia are some conditions that<strong>&nbsp;</strong>have been associated with heavy cannabis use.</p>	<section id="content-dynamic-trending-stories" aria-label="Dynamic trending stories section">
			<p><span>Trending Now</span>
	</p>
	
	</section>
	<p>The findings suggest a need for more conversations about potential links between cannabis use and mental health, especially for people who are vulnerable to worsening anxiety or developing it from heavy use, he said.</p><p>A Health Canada phone survey of 21,690 people aged 16 and over in 2022 found that nearly half of respondents had not noticed any education campaigns or public health messages about cannabis<strong>&nbsp;</strong>in the previous<strong>&nbsp;</strong>12 months.</p><p>About 35 per cent of people who reported using cannabis in the previous 30 days said they were high for one or two hours on a typical day. The highest use was among those aged 20 and 24.</p><p>Shea Wood, whose expertise includes cannabis and mental health as part of her work for the Canadian Centre on Substance Use and Addiction, said occasional cannabis use would have a minimal effect on most people when it comes to anxiety disorders.</p><p>“However, earlier use of cannabis has been linked to more psychological symptoms so it’s important for youth to delay their use of cannabis as long as possible,” she said in an email to The Canadian Press.</p>		<div>							<p>Story continues below advertisement</p>
			
			
			

					
		</div>	<p><em>Canadian Press health coverage receives support through a partnership with the Canadian Medical Association. CP is solely responsible for this content.</em></p>				</article><div>
	<p>
		© 2024 The Canadian Press	</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Runs on your OpenWrt box: AdGuard Home is network-wide blocking ads and tracking (200 pts)]]></title>
            <link>https://github.com/AdguardTeam/AdGuardHome</link>
            <guid>39276687</guid>
            <pubDate>Tue, 06 Feb 2024 16:48:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/AdguardTeam/AdGuardHome">https://github.com/AdguardTeam/AdGuardHome</a>, See on <a href="https://news.ycombinator.com/item?id=39276687">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
          <nav aria-label="Global">
            <ul>
                <li>
      
      <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Actions&quot;,&quot;label&quot;:&quot;ref_cta:Actions;&quot;}" href="https://github.com/features/actions">
      
      <div>
        <p>Actions</p><p>
        Automate any workflow
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Packages&quot;,&quot;label&quot;:&quot;ref_cta:Packages;&quot;}" href="https://github.com/features/packages">
      
      <div>
        <p>Packages</p><p>
        Host and manage packages
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Security&quot;,&quot;label&quot;:&quot;ref_cta:Security;&quot;}" href="https://github.com/features/security">
      
      <div>
        <p>Security</p><p>
        Find and fix vulnerabilities
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Codespaces&quot;,&quot;label&quot;:&quot;ref_cta:Codespaces;&quot;}" href="https://github.com/features/codespaces">
      
      <div>
        <p>Codespaces</p><p>
        Instant dev environments
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Copilot&quot;,&quot;label&quot;:&quot;ref_cta:Copilot;&quot;}" href="https://github.com/features/copilot">
      
      <div>
        <p>Copilot</p><p>
        Write better code with AI
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Code review&quot;,&quot;label&quot;:&quot;ref_cta:Code review;&quot;}" href="https://github.com/features/code-review">
      
      <div>
        <p>Code review</p><p>
        Manage code changes
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Issues&quot;,&quot;label&quot;:&quot;ref_cta:Issues;&quot;}" href="https://github.com/features/issues">
      
      <div>
        <p>Issues</p><p>
        Plan and track work
      </p></div>

    
</a></li>

                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Product&quot;,&quot;action&quot;:&quot;click to go to Discussions&quot;,&quot;label&quot;:&quot;ref_cta:Discussions;&quot;}" href="https://github.com/features/discussions">
      
      <div>
        <p>Discussions</p><p>
        Collaborate outside of code
      </p></div>

    
</a></li>

            </ul>
          </div>
</li>


                <li>
      
      
</li>


                <li>
      
      <div>
          <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to GitHub Sponsors&quot;,&quot;label&quot;:&quot;ref_cta:GitHub Sponsors;&quot;}" href="https://github.com/sponsors">
      
      <div>
        <p>GitHub Sponsors</p><p>
        Fund open source developers
      </p></div>

    
</a></li>

            </ul>
          </div>
          <div>
            <ul>
                <li>
  <a data-analytics-event="{&quot;category&quot;:&quot;Header dropdown (logged out), Open Source&quot;,&quot;action&quot;:&quot;click to go to The ReadME Project&quot;,&quot;label&quot;:&quot;ref_cta:The ReadME Project;&quot;}" href="https://github.com/readme">
      
      <div>
        <p>The ReadME Project</p><p>
        GitHub community articles
      </p></div>

    
</a></li>

            </ul>
          </div>
          
      </div>
</li>


                <li>
    <a data-analytics-event="{&quot;category&quot;:&quot;Header menu top item (logged out)&quot;,&quot;action&quot;:&quot;click to go to Pricing&quot;,&quot;label&quot;:&quot;ref_cta:Pricing;&quot;}" href="https://github.com/pricing">Pricing</a>
</li>

            </ul>
          </nav>

        <div>
                


<qbsearch-input data-scope="repo:AdguardTeam/AdGuardHome" data-custom-scopes-path="/search/custom_scopes" data-delete-custom-scopes-csrf="s_b4bS2H6hbYWSK1avBG7-3UC5Iq04iMPLR8S6xlDgYMv38iLjDECwgTmA6iEFWxNVnTh9VwUvOMudTVXm8Glw" data-max-custom-scopes="10" data-header-redesign-enabled="false" data-initial-value="" data-blackbird-suggestions-path="/search/suggestions" data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations" data-current-repository="AdguardTeam/AdGuardHome" data-current-org="AdguardTeam" data-current-owner="" data-logged-in="false" data-copilot-chat-enabled="false" data-blackbird-indexed-repo-csrf="<esi:include src=&quot;/_esi/rails_csrf_token_form_hidden?r=YvowfGnQjzYxY8nSgqFqbbp3JSQt4dMrtS62%2FjRj4Fz4VFlh%2BQdgEcJDmv2UGo2tAObgJjycaL6HOeew%2B5UXG3bxJmu8RzMloJMLWidm67tobsmKIhN5O0%2BUOkzeVRgnAt4sa3EqvQ%2Ft%2BMESCXbqfS3LHGXNchhDlJp2PAA54GKrYwI8v7IpPUYQCfCTEZz%2BVptWWO8VFAxXyR59JQB6AWauJVugH8feo62aOPjNFR8yuShtk7jjOhIXXCq1npVppnxdxG9PpfLIeLtL%2Fnq8VhGvr9U1JCX1vXB%2FD3KIQGizsqjBdj96jYF5CZE0hkqQhlDWxbU%2F1XtKcmqjdw1B%2F8HQDk1zZllD7eD60CUEzoKUERJ7xdTjox8ft96uXNNuuaG7%2FlKRUYJgHGyDd5m1nK7fe%2BC%2FfK8uJjfNp2sAlaLW%2Bx1D1GuLXKLFubm9Jk6Kt8K3ERvl8lGDAcF5HNa5%2FedmrUdPAD3RcEfPX4fVixGBhVm7SRZOj%2B%2BkRiO7cKSkHY%2FvJWKAtBosXiVeqQQX3iMu2IS6wg%3D%3D--0z7UjOQzeZZLsOjS--n%2By8f9iJemD8FwNlL9ixOA%3D%3D&quot; />">
  <div data-modal-dialog-overlay="" data-action="click:qbsearch-input#searchInputContainerClicked">
  <modal-dialog data-action="close:qbsearch-input#handleClose cancel:qbsearch-input#handleClose" data-target="qbsearch-input.searchSuggestionsDialog" role="dialog" id="search-suggestions-dialog" aria-modal="true" aria-labelledby="search-suggestions-dialog-header" data-view-component="true">
      <h2 id="search-suggestions-dialog-header">Search code, repositories, users, issues, pull requests...</h2>
    
</modal-dialog></div>
  
  <div>
    
<dialog-helper>
  <dialog data-target="qbsearch-input.feedbackDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="feedback-dialog" aria-modal="true" aria-disabled="true" aria-labelledby="feedback-dialog-title" aria-describedby="feedback-dialog-description" data-view-component="true">
    <div data-view-component="true">
    <p>
      <h2 id="feedback-dialog-title">
        Provide feedback
      </h2>
    </p>
    
  </div>
      <scrollable-region data-labelled-by="feedback-dialog-title">
        
      </scrollable-region>
      
</dialog></dialog-helper>

    <custom-scopes data-target="qbsearch-input.customScopesManager">
    
<dialog-helper>
  <dialog data-target="custom-scopes.customScopesModalDialog" data-action="close:qbsearch-input#handleDialogClose cancel:qbsearch-input#handleDialogClose" id="custom-scopes-dialog" aria-modal="true" aria-disabled="true" aria-labelledby="custom-scopes-dialog-title" aria-describedby="custom-scopes-dialog-description" data-view-component="true">
    <div data-view-component="true">
    <p>
      <h2 id="custom-scopes-dialog-title">
        Saved searches
      </h2>
        <h2 id="custom-scopes-dialog-description">Use saved searches to filter your results more quickly</h2>
    </p>
    
  </div>
      <scrollable-region data-labelled-by="custom-scopes-dialog-title">
        
      </scrollable-region>
      
</dialog></dialog-helper>
    </custom-scopes>
  </div>
</qbsearch-input>

            <p><a href="https://github.com/signup?ref_cta=Sign+up&amp;ref_loc=header+logged+out&amp;ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&amp;source=header-repo&amp;source_repo=AdguardTeam%2FAdGuardHome" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;site header menu&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;SIGN_UP&quot;,&quot;originating_url&quot;:&quot;https://github.com/AdguardTeam/AdGuardHome&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="7765858b4871e550ab1fc312cc575371e123b55e5a8cba7727a09842fe04dbd2" data-analytics-event="{&quot;category&quot;:&quot;Sign up&quot;,&quot;action&quot;:&quot;click to sign up for account&quot;,&quot;label&quot;:&quot;ref_page:/<user-name>/<repo-name>;ref_cta:Sign up;ref_loc:header logged out&quot;}">
              Sign up
            </a>
        </p></div>
      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The perverse policies that fuel wildfires (107 pts)]]></title>
            <link>https://www.newyorker.com/magazine/2024/02/05/the-perverse-policies-that-fuel-wildfires</link>
            <guid>39276452</guid>
            <pubDate>Tue, 06 Feb 2024 16:35:28 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.newyorker.com/magazine/2024/02/05/the-perverse-policies-that-fuel-wildfires">https://www.newyorker.com/magazine/2024/02/05/the-perverse-policies-that-fuel-wildfires</a>, See on <a href="https://news.ycombinator.com/item?id=39276452">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-journey-hook="client-content" data-testid="BodyWrapper"><figure data-testid="IframeEmbed"><div data-testid="IframeEmbedContainer"><p><span><p>Listen to this article.</p>
</span></p></div></figure><p>The provincial government of Alberta defines a “wildfire of note” as a blaze that could “pose a threat to public safety, communities or critical infrastructure.” Last year, Alberta’s first wildfire of note broke out unusually early, on April 30th, near the tiny town of Entwistle, about sixty-five miles west of Edmonton. A second wildfire of note was recorded that same day, in the town of Evansburg. Four days later, an astonishing seventy-two wildfires were burning, and three days after that the number had grown to a hundred and nine. Some thirty thousand people had to be evacuated, and Alberta’s premier declared a state of emergency. “It’s been an unusual year,” Christie Tucker, an official from the province’s wildfire information unit, observed at the end of the week.</p><p>The unusual soon became the unheard-of. Owing to a combination of low winter snowfall and abnormally high spring temperatures, many parts of Canada, including the Maritime Provinces, were just a cigarette butt away from incineration. On May 28th, with flames bearing down on Halifax, the capital of Nova Scotia, some eighteen thousand people were told to evacuate. “Basically, all hell is breaking loose,” a fire chief in Halifax, Rob Hebb, said. Meanwhile, the largest fire ever recorded in Nova Scotia—the Barrington Lake fire—was burning toward the city’s southwest.</p><p>The fires kept hopscotching across the country. Before the Barrington Lake fire had been contained, a new monster, the Donnie Creek fire, emerged in British Columbia. On June 18th, after scorching more than two thousand square miles, Donnie Creek became British Columbia’s largest recorded blaze. Saskatchewan saw dozens of wildfires, Quebec hundreds. Evacuation orders went out to the entire city of Yellowknife, the capital of the Northwest Territories. Many of the blazes created their own weather, in the form of thunderstorms spawned by rapidly rising hot air. The smoke from the fires drifted across much of the United States, prompting health alerts from Minneapolis to Washington, D.C. By late June, Canada had broken its previous annual record for acreage burned, set in 1995, and by mid-October nearly forty-six million acres—an area larger than Denmark—had been charred. This was almost triple the previous record and nine times the annual average.</p><p>“This summer across Canada has been absolutely astounding,” Lori Daniels, a professor in the department of forest and conservation sciences at the University of British Columbia, told the Canadian Broadcasting Corporation. “The word ‘unprecedented’ doesn’t do justice to the severity of the wildfires,” Yan Boulanger, a research scientist at Natural Resources Canada, said.</p><p>As bad as Canada’s 2023 wildfire season was—Europe, too, saw its largest wildfire on record, a blaze that consumed more than three hundred square miles in northeastern Greece—the conflagrations are predicted to keep growing. A paper that appeared last summer in the journal <em>Fire Ecology</em> warned that “increasing warming and drying trends” will make wildfires “more frequent and severe,” and a recent report from the Wildland Fire Mitigation and Management Commission, a body established by Congress, predicted a future “defined by wildfires that are increasingly extreme, vast in scale, and devastating.” Another recent <a href="https://fas.org/publication/next-generation-fire-and-vegetation-modeling-for-a-hot-and-dry-future/">report</a>, from the Federation of American Scientists, observed that the world is warming so fast that the models firefighters rely on to predict how blazes will behave have become obsolete. “Climate change is drying fuels and making forests more flammable,” the report said. “As a result, no matter how much money we spend on wildfire suppression, we will not be able to stop increasingly extreme wildfires.”</p><p>As the wildfires have multiplied, so, too, have books on the subject. Recent volumes range from the intimate (Manjula Martin’s “<a data-offer-url="https://www.amazon.com/Last-Fire-Season-Personal-Pyronatural/dp/0593317157/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Last-Fire-Season-Personal-Pyronatural/dp/0593317157/&quot;}" href="https://www.amazon.com/Last-Fire-Season-Personal-Pyronatural/dp/0593317157/" rel="noopener" target="_blank">The Last Fire Season: A Personal and Pyronatural History</a>”) to the sweeping (Edward Struzik’s “<a data-offer-url="https://www.amazon.com/Dark-Days-Noon-Future-Fire/dp/0228012090/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Dark-Days-Noon-Future-Fire/dp/0228012090/&quot;}" href="https://www.amazon.com/Dark-Days-Noon-Future-Fire/dp/0228012090/" rel="noopener" target="_blank">Dark Days at Noon: The Future of Fire</a>”) and the quick-turnaround (“<a data-offer-url="https://www.amazon.com/Summer-Canada-Burned-Wildfire-Shocked/dp/1778401872/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Summer-Canada-Burned-Wildfire-Shocked/dp/1778401872/&quot;}" href="https://www.amazon.com/Summer-Canada-Burned-Wildfire-Shocked/dp/1778401872/" rel="noopener" target="_blank">The Summer Canada Burned: The Wildfire Season That Shocked the World</a>,” compiled by Monica Zurowski). Fire, it might be said, is a hot topic.</p><p>M. R. O’Connor’s “<a data-offer-url="https://www.amazon.com/Ignition-Lighting-Fires-Burning-World/dp/164503738X/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Ignition-Lighting-Fires-Burning-World/dp/164503738X/&quot;}" href="https://www.amazon.com/Ignition-Lighting-Fires-Burning-World/dp/164503738X/" rel="noopener" target="_blank">Ignition: Lighting Fires in a Burning World</a>” (Bold Type) began, in the author’s telling, with a “gimmick.” Several years ago, O’Connor, a Brooklyn-based journalist, visited Florida’s Apalachicola National Forest with a local botanist. The two came upon a rare wildflower, <em>Gentiana catesbaei</em>, which, the botanist explained, thrives on recently torched ground. Many plants, O’Connor learned, have evolved to tolerate fire—these are known as pyrophytes—and some have come to depend on it to stimulate reproduction. Intrigued, she enrolled in Introduction to Fire Effects, an online course offered by the University of Idaho.</p><p>One thing leads to another, and pretty soon O’Connor finds herself travelling to central Nebraska to light it on fire. As part of a crew producing a “prescribed burn,” she’s handed a drip torch—basically, a fuel cannister attached to a long nozzle. Although she hasn’t had much training, she’s soon igniting the prairie. She describes the experience as “thrilling.” A professional fire-setter tells her, “You have the fire bug.”</p><p>In the course of starting more blazes—in upstate New York and California—O’Connor comes to see the wildfire problem less in terms of surfeit and more in terms of scarcity. Prior to human settlement, lightning-induced fires were, it seems, a regular occurrence in North America. These blazes acted as a kind of ecological reset; from the ashes of the incinerated forest (or grassland), pyrophytes blossomed. Later, Native Americans routinely burned the landscape—to foster the growth of useful plants, to clear space for farming, and to improve the conditions for hunting. In the sixteen-thirties, Thomas Morton, an English colonist who settled in Massachusetts, wrote that this practice produced a parklike landscape that was “very beautifull and commodious.” Two hundred years later, the artist George Catlin described the sight of Native Americans burning the prairie as “indescribably beautiful.” At night, Catlin wrote, the flames could be seen from many miles away, “creeping over the sides and tops of the bluffs, appearing to be sparkling and brilliant chains of liquid fire.” In addition to maintaining parklike conditions, these managed blazes prevented fuel from building up, and so staved off larger, potentially unmanageable conflagrations.</p><p>Once the U.S. government had pushed Native Americans onto reservations and seized their land, controlled burning ceased across much of the country. Then the U.S. Forest Service moved to eliminate wildfires entirely. Gifford Pinchot, who became the agency’s first director, in 1905, considered flames to be the enemy of the trees.</p><p>“Of all the foes that attack the woodlands of North America, no other is so terrible as fire,” he wrote. Toward the end of the summer of 1910—an unusually dry one in the American Northwest—gale-force winds whipped up hundreds of blazes in Idaho and western Montana. These coalesced to form one of the largest forest fires in U.S. history—an inferno that killed eighty-seven people, destroyed several whole towns, and consumed more than three million acres. Following what became known as the Big Blowup, the Forest Service doubled down on fire control. William Greeley, who became the head of the agency in 1920, wrote that the great fire had “burned into” him the conviction “that fire prevention is the No. 1 job of American foresters.”</p><p>In 1933, the Roosevelt Administration created the Civilian Conservation Corps, one of the earliest New Deal programs. The C.C.C. put millions of (mostly single) men to work on projects that included building fire lookouts, digging firebreaks, and fighting forest fires. In 1935, the leader of the Forest Service, Ferdinand Silcox, announced the “10 <em>A</em>.<em>M</em>. Policy.” All fires on Forest Service land were to be extinguished by the morning after the day they were reported. Other federal agencies, following the Forest Service’s lead, soon adopted similar policies. Though many blazes pushed past the 10 <em>A</em>.<em>M</em>. deadline, the policy remained in effect until the late nineteen-seventies.</p><p>Gradually, it became clear that fire suppression was wrecking many of the forests it was intended to save. (Among the trees whose seeds require fire to germinate are giant sequoias.) These days, O’Connor writes, the Forest Service likes to boast that it oversees the country’s biggest prescribed-fire program, which burns almost 1.5 million acres a year. But this isn’t nearly enough to make up for what’s become known as the “fire deficit.” According to some estimates, this deficit amounts to more than three million acres just in the mountains of New Mexico and Arizona, and according to others it amounts to more than ten million acres across Washington and Oregon. A wildlife biologist whom O’Connor meets in central Nebraska tells her that the controlled burns he’s organized in the past decade have charred about thirty thousand acres. But to preserve the prairie that remains, he estimates, nearly twice that area should be combusted every year. “I have a dream of road-to-road fires one day,” he tells her. “Our goal here is to dream big.”</p><p>At one point in her travels, O’Connor visits Yosemite National Park with Stephen&nbsp;J. Pyne, a professor emeritus at Arizona State University. Pyne might be described as the Gibbon of fire history; he has written some thirty books on the subject, including a nine-volume work, “<a data-offer-url="https://www.amazon.com/Florida-Fire-Survey-Last-Smoke/dp/0816532729/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Florida-Fire-Survey-Last-Smoke/dp/0816532729/&quot;}" href="https://www.amazon.com/Florida-Fire-Survey-Last-Smoke/dp/0816532729/" rel="noopener" target="_blank">To the Last Smoke</a>,” on the legacy of fire in different regions of the U.S. As O’Connor was interviewing Pyne for her book, Pyne was researching a book of his own, “<a data-offer-url="https://www.amazon.com/Pyrocene-Park-Journey-Yosemite-National/dp/0816549230/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Pyrocene-Park-Journey-Yosemite-National/dp/0816549230/&quot;}" href="https://www.amazon.com/Pyrocene-Park-Journey-Yosemite-National/dp/0816549230/" rel="noopener" target="_blank">Pyrocene Park: A Journey Into the Fire History of Yosemite National Park</a>” (University of Arizona).</p><p>Geologically speaking, we live in the Holocene, the epoch that began about twelve thousand years ago, at the close of the last ice age. But many geologists argue that the Holocene, too, has come to an end, and that we have entered a new epoch, widely referred to as the Anthropocene. Pyne believes that the new epoch would be better labelled the Pyrocene, a term of his own invention. “The Pyrocene began when a fire-wielding creature met a fire-receptive period in the Earth’s history and their interaction made anthropogenic fire an informing presence,” he writes in a previous book, “<a data-offer-url="https://www.amazon.com/Pyrocene-Created-Fire-What-Happens/dp/0520383583/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Pyrocene-Created-Fire-What-Happens/dp/0520383583/&quot;}" href="https://www.amazon.com/Pyrocene-Created-Fire-What-Happens/dp/0520383583/" rel="noopener" target="_blank">The Pyrocene: How We Created an Age of Fire, and What Happens Next.</a>”</p><figure><p><span><div data-attr-viewport-monitor=""><a data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.newyorker.com/cartoon/a28412&quot;}" href="https://www.newyorker.com/cartoon/a28412" rel="noopener" target="_blank"><picture></picture></a><p><span>“I’m looking for love, but I’ll settle for peanut butter.”</span></p><p><span>Cartoon by Victoria Roberts</span></p></div></span></p></figure><p>Pyne’s argument for the Pyrocene begins with fire itself, which he divides into three sorts. “First-fire” is the kind that requires no human intervention. This sort is as old as the hills, or even older: the earliest evidence of fire on Earth comes from fossilized charcoal dating to the Silurian period, when plants were just starting to creep onto dry land. Second-fire, in Pyne’s scheme, is the kind that humans set, or at least control. It’s not clear when, exactly, hominins learned how to manipulate fire, but the discovery may go back as far as 1.5 million years. Controlling fire was such a significant breakthrough that, Pyne argues, it altered the course of evolution. Cooking enabled our ancestors to devote less space to digestion and more to cognition, developments that, in turn, meant humans could no longer live without flames.</p></div><div data-journey-hook="client-content" data-testid="BodyWrapper"><p>First-fire and second-fire both rely on the same fuel source: living—or at least recently live—plants. For most of human history, this was the constraint on combustion. Then people figured out how to access ancient biomass in the form of coal, oil, and natural gas. The combustion of fossil fuels produced third-fire, which altered the atmosphere and, in the process, the climate. “Fire created the conditions for more fire,” Pyne writes.</p><p>Like O’Connor, Pyne proposes fighting more fire with fire. He advocates a return to the sort of “cultural burning” once practiced by Indigenous peoples not just in North America but in almost all parts of the world where the landscape is flammable. “If fire there will be—must be—then replace fires of chance with fires of choice,” Pyne urges. He praises the Australians, who are trying to revive cultural burning practices on Aboriginal lands. “The suppression of fire practices was part of colonizing the land; restoring fire is seen as a means to recover some of those losses,” he writes.</p><p>Toward the end of “Ignition,” O’Connor visits the Yurok Reservation, in Northern California, to participate in a prescribed burn. The exercise is a collaboration between tribal members and an assortment of outsiders eager to be part of what O’Connor calls the “good-fire revolution.”</p><p>“With all these megafires, they finally realize, ‘Oh, maybe we should ask these Indigenous peoples how to take care of the forest,’&nbsp;” Margo Robbins, a Yurok basket-maker and activist, tells her. “We took care of it for ten thousand years.” As it happens, one of the directors of the operation, Kelly Martin, is a wildland firefighter who spent a decade working in Yosemite. “Humans created this condition, and humans can step in to remediate it,” Martin says. “We have no time to waste.”</p><p>If the summer of 2023 was Canada’s worst wildfire season on record, its costliest remains 2016’s, when flames swept through Fort McMurray, a city in northern Alberta. The Fort McMurray fire forced roughly ninety thousand people to evacuate, destroyed more than two thousand homes, and caused billions of dollars’ worth of damage. In a chronicle of the event, “<a data-offer-url="https://www.amazon.com/Fire-Weather-Story-Hotter-World/dp/1524732850/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/Fire-Weather-Story-Hotter-World/dp/1524732850/&quot;}" href="https://www.amazon.com/Fire-Weather-Story-Hotter-World/dp/1524732850/" rel="noopener" target="_blank">Fire Weather: A True Story from a Hotter World</a>” (Knopf), John Vaillant proposes yet another name for our new epoch: the Petrocene. The Petrocene, he argues, began a century and a half ago with the discovery of oil, which put immense amounts of energy at the disposal of ordinary people.</p><p>“Behind the wheel of a Chevy Silverado, a one-hundred-pound woman can generate more than six hundred horsepower,” Vaillant, a Vancouver-based writer, observes. “Prior to the Petrocene Age, only a king or a pharaoh could have summoned such power, and its equivalent would have required hundreds of enslaved people and draft animals.”</p><p>The Fort McMurray fire is, in Vaillant’s telling, a cruelly appropriate Petrocene disaster. The city, nicknamed Fort McMoney, owes its existence to the Alberta tar sands, a vast deposit of low-quality oil that has to be either dug or steamed out of the ground. Pretty much everyone who lived in Fort McMurray at the time of the fire worked, either directly or indirectly, on getting this oil to refineries, so that it could be pumped into gas tanks and combusted. The resulting carbon dioxide—together with the CO<sub>2</sub> from burning billions of tons of coal and tens of billions of barrels of conventional oil—contributed to the hot, dry conditions that turned Fort McMurray into a tinderbox. The fire spread so fast that many residents barely made it out, along the city’s sole southbound highway. “Combustive energy had drawn people to Fort McMurray,” Vaillant writes, and combustive energy drove them “out again, en masse.”</p><p>Fort McMurray was carved out of Canada’s vast boreal forest, and its location, too, was key to the catastrophe. Many of the most destructive wildfires of recent years have jumped from forests or grasslands into communities situated in what’s become known as the “wildland-urban interface,” or <em>WUI</em> (pronounced “woo-ee”). As Vaillant puts it, the <em>WUI</em> “is a beautiful place to live, until it goes feral.”</p><p>According to Nick Mott and Justin Angle, the authors of “<a data-offer-url="https://www.amazon.com/This-Wildfire-Protect-Yourself-Community/dp/1639730796/" data-event-click="{&quot;element&quot;:&quot;ExternalLink&quot;,&quot;outgoingURL&quot;:&quot;https://www.amazon.com/This-Wildfire-Protect-Yourself-Community/dp/1639730796/&quot;}" href="https://www.amazon.com/This-Wildfire-Protect-Yourself-Community/dp/1639730796/" rel="noopener" target="_blank">This Is Wildfire: How to Protect Yourself, Your Home, and Your Community in the Age of Heat</a>” (Bloomsbury), construction in the <em>WUI</em> is yet another reason wildfires are becoming more dangerous. (The two put it on par with climate change and the history of fire suppression.) We’re putting up more homes than ever before, they write, in “areas ripe for fire.”</p><p>In the U.S., California is the state that has the most housing in the <em>WUI</em>—about five million units. Texas comes in second, with more than three million. And the figures keep climbing: between 1990 and 2020, the total number of homes in the zone increased by nearly fifty per cent in the U.S., to more than forty-four million.</p><p>“Why do we keep building so vigorously where people are most at risk of losing their homes and lives to wildfire?” Mott, a Montana-based journalist, and Angle, a professor at the University of Montana College of Business, ask. Part of the answer, they conclude, lies in the way the risk is spread around. When a serious wildfire threatens a community, the federal government often gets involved. In this way, it’s not just those who live in the <em>WUI</em> who bear the cost of trying to protect it; it’s also, Mott and Angle write, “<em>you</em>, the taxpayer.” A 2023 study they cite concludes that, in the fire-prone American West, this implicit subsidy can amount to more than twenty per cent of a home’s value. Meanwhile, local government officials, who are responsible for most zoning decisions, have little incentive to curb construction in the <em>WUI</em>. On the contrary, local governments depend on new development to bring in more property-tax revenue. “If I’m a county commissioner, why would I care if that house burns down?” Kimi Barrett, a policy analyst at Headwaters Economics, a nonprofit research group, tells the authors. “Because I’m not going to pay for it.”</p><p>Mott and Angle have all sorts of suggestions for individuals who want to reduce the odds that their homes will go up in smoke. They urge those who live in high-risk areas to replace wood-shingled roofs with metal ones, remove lower limbs from trees, and keep woodpiles at a distance. But, they acknowledge, these sorts of home-hardening projects do little to address the larger issue of development in the <em>WUI</em>, which, they say, has become a “cycle” that will be “hard to reverse.”</p><p>Canada’s 2016 wildfires, which included but were not limited to the Fort McMurray fire, released about a hundred and seventy million tons of carbon dioxide into the air. The following year, according to the European Union’s earth-observation program, carbon emissions from Canada’s wildfires rose to about four hundred million tons. In 2023, they came to an astonishing 1.7 billion tons.</p><p>These figures point to another hard-to-reverse cycle. When trees burn, they release the carbon they took up while growing. This carbon contributes to warming, which increases the likelihood of wildfires, which release more carbon, and so on. In the far north, this cycle is exacerbated by the soil, which is often loaded with dead plant material. Igniting such carbon-rich soil further adds to emissions.</p><p>More prescribed burning, more metal roofs, better zoning—these are all steps that could make a significant difference at a local level. But dealing with the wildfire crisis on a regional or a national scale would require addressing the CO<sub>2</sub> feedback loop, which is impossible for any region or nation to do on its own. Hence the predictions of a flame-filled future. As Pyne observes in one of his bleaker moments, “We have created a Pyrocene. Now we have to live in it.”&nbsp;♦</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Oceans May Have Already Seen 1.7°C of Warming (256 pts)]]></title>
            <link>https://eos.org/articles/oceans-may-have-already-seen-1-7c-of-warming</link>
            <guid>39275272</guid>
            <pubDate>Tue, 06 Feb 2024 15:29:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://eos.org/articles/oceans-may-have-already-seen-1-7c-of-warming">https://eos.org/articles/oceans-may-have-already-seen-1-7c-of-warming</a>, See on <a href="https://news.ycombinator.com/item?id=39275272">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-220108">
	<div>

		
		
<p>Sponges from the Caribbean retain a record of ocean temperatures stretching back hundreds of years. These newly revealed paleoclimate records suggest that sea surface temperatures (SSTs) began rising in response to industrial era fossil fuel burning around 1860.</p>

<p>That’s 80 years earlier than SST measurements became common and predates the global warming start date used by the Intergovernmental Panel on Climate Change (IPCC). On the basis of these new sponge records, scientists think that temperatures are currently 1.7°C warmer than preindustrial levels.</p>

<figure><blockquote><p>“We’re further advanced in the global warming scenario, and the amount of time we have to take action to prevent it is seriously diminished.”</p></blockquote></figure>

<p>The study’s researchers argue that the world has already surpassed the goal of the 2015 <a href="https://eos.org/tag/paris-agreement" target="_blank" rel="noreferrer noopener">Paris Agreement</a> to limit atmospheric warming to less than 1.5°C above preindustrial temperatures and that we could reach 2°C of warming before 2030.</p>

<p>“We’re further advanced in the global warming scenario, and the amount of time we have to take action to prevent it is seriously diminished,” said <a href="https://research-repository.uwa.edu.au/en/persons/malcolm-mcculloch" target="_blank" rel="noreferrer noopener">Malcolm McCulloch</a>, a marine and coral geochemist at the University of Western Australia in Crawley and lead author on the new study. “We’ve got to start doing serious mitigation and serious reductions in emissions.”</p>

<p>These results were <a href="https://www.nature.com/articles/s41558-023-01919-7" target="_blank" rel="noreferrer noopener">published</a>&nbsp;in <em>Nature Climate Change</em>.</p>


<h3><strong>Old Sponges Fill Gaps</strong></h3>

<p>The sclerosponges studied (<em>Ceratoporella nicholsoni</em>) are a group of long-lived sponges that live exclusively in the Caribbean at depths with little variation in light or temperature. Like tree rings, a sponge’s skeleton retains a record of its environmental conditions throughout its lifetime.</p>

<p>“These sponges are extremely slow growing,” explained <a href="https://www.indstate.edu/faculty-staff/amos-winter" target="_blank" rel="noreferrer noopener">Amos Winter</a>, a study coauthor and paleoceanographer at Indiana State University in Terre Haute. “A 10-centimeter sponge, which isn’t very large, can go back 400 years.”</p>

<p>That longevity is key to the new study’s analysis of modern-day global warming.</p>

<p>The <a href="https://eos.org/tag/ipcc" target="_blank" rel="noreferrer noopener">IPCC</a> compares modern temperatures with the average temperature between 1850 and 1900 to define today’s warming relative to a preindustrial world.</p>

<p>However, “it’s well recognized that human emissions began increasing significantly in the 1750s,” said <a href="https://duochanatharvard.github.io/" target="_blank" rel="noreferrer noopener">Duo Chan</a>, a climate scientist at the University of Southampton in the United Kingdom who was not involved with the new study.</p>
<div>
<figure><img decoding="async" width="780" height="509" src="https://i0.wp.com/eos.org/wp-content/uploads/2024/02/icoads-measurements.gif?resize=780%2C509&amp;ssl=1" alt="This animation shows a map of the world overlain with rainbow-colored points indicating the distribution of sea surface temperatures since 1860 in 20-year increments." data-recalc-dims="1"><figcaption>The global distribution of sea surface temperature measurements in the International Comprehensive Ocean-Atmosphere Data Set (ICOADS) since 1860. Warmer colors indicate more measurements at that location. Credit: McCulloch et al., 2024, <a href="https://doi.org/10.1038/s41558-023-01919-7" target="_blank" rel="noopener">https://doi.org/10.1038/s41558-023-01919-7</a>, <a href="https://creativecommons.org/licenses/by/4.0/legalcode.en" target="_blank" rel="noopener">CC BY 4.0</a>; animation by Kimberly M. S. Cartier</figcaption></figure></div>
<p>Ship-based measurements of SST go back only to around 1850. The records contain many inconsistencies and remain sparse until the mid-1900s, when modern instrumentation took over. Even then, there are <a href="https://eos.org/articles/crowdsourced-science-pulls-off-a-daring-wwii-data-rescue" target="_blank" rel="noreferrer noopener">notable data gaps</a> during such events as World War II. <a href="https://eos.org/tag/proxies" target="_blank" rel="noreferrer noopener">Paleoclimate proxies</a> such as those stored in sclerosponges can extend the record of SSTs back to truly preindustrial times and help fill gaps in shipboard measurements.</p>

<p>“The IPCC’s adoption of a later preindustrial reference period was a compromise, largely due to the lack of sufficient instrumental data for quantifying global temperatures before the 1850s,” Chan said.</p>

<p>These sclerosponge records can unravel the history of past sea surface temperatures, said <a href="https://thirumalai.geo.arizona.edu/" target="_blank" rel="noreferrer noopener">Kaustubh Thirumalai</a>, a paleoceanographer at the University of Arizona in Tucson who was not involved with this study. (Thirumalai is a science advisor for <em>Eos</em>.)</p>

<h3><strong>An 80-Year Head Start</strong></h3>

<p>With the help of local divers, the researchers collected six sclerosponges from 2007 to 2012 near Puerto Rico and St. Croix in the U.S. Virgin Islands. They used uranium-thorium radioisotope dating to construct a growth timeline for each sponge that goes back about 300 years.</p>

<p>Within each 2-year growth interval, they measured the ratio of strontium to calcium. Calcifying coral skeletons preferentially take in calcium over strontium as temperatures increase, so the ratio is a proxy for seawater temperature. They calibrated their sclerosponge temperature timeline against recent (1964–2012) instrumental measurements.</p>

<p><em>Ceratoporella nicholsoni</em> may be endemic to the Caribbean, but they can be used to understand globally averaged trends.</p>

<p>Scientists have found that <a href="https://doi.org/10.1038/s41586-018-0006-5" target="_blank" rel="noreferrer noopener">temperature trends in Caribbean waters</a> closely follow global mean SST trends. Sclerosponges live at depths within the <a href="https://en.wikipedia.org/wiki/Mixed_layer#Oceanic_mixed_layer" target="_blank" rel="noreferrer noopener">ocean mixed layer</a>, where temperatures are mostly the same from the surface to about 100 meters down. So the ambient seawater temperatures recorded by sclerosponges can be used to understand sea surface temperatures too.</p>

<p>The sclerosponges recorded some well-known global temperature anomalies, such as the cooling period after the <a href="https://eos.org/articles/centuries-old-archive-reveals-far-flung-impacts-of-major-eruptions" target="_blank" rel="noreferrer noopener">Tambora</a> eruption in 1815. Ocean temperatures were relatively steady from 1700 to 1790, followed by an era of volcanic cooling from 1790 to 1840 and then another steady but slightly warmer period from 1840 to the early 1860s. Researchers trace anthropogenic climate change to that period—about 80 years earlier than instrumental SST records show.</p>

<p>The sponges’ preindustrial starting line of about 1700 implies that Earth warmed by 1.7°C between then and about 2020, assuming that the land and ocean have warmed by the same amount. That’s about 0.5°C higher than IPCC estimates and suggests that the planet is on track to surpass 2°C of warming before 2030.</p>

<p>Thirumalai found the research to be “innovative and clever,” although he said the sclerosponge records might have too much uncertainty to sufficiently pinpoint events such as the 19th century volcanic cooling. Too, he wanted the researchers to have shown in more detail how temperature trends in the Caribbean were representative of global SST anomalies.</p>

<p>Nevertheless, he said, “it is always useful to generate new and independent paleotemperature records to help minimize uncertainties in our understanding of anthropogenic warming and the baseline of preindustrial conditions.”</p>

<h3><strong>Untangling the Cause of Warming</strong></h3>

<p>“Integrating these sclerosponge findings with corrected instrumental data could offer a more comprehensive view of historical SST evolution,” Chan said. However, he cautioned against immediately adopting the updated warming values.</p>

<p>The sclerosponge warming rates almost mirror modern instrumental records in a broad sense, but there are some differences, even when accounting for different starting lines, Chan said. Research is ongoing to correct some biases and errors in historic instrumental records, which might reconcile some of these differences.</p>

<figure><blockquote><p>“This distinction not only enhances our understanding of climate change but also has significant political implications, informing policy and target setting in the context of global warming.”</p></blockquote></figure>

<p>Too, when looking as far back as 1700, Earth’s climate might still have been rebounding from the <a href="https://www.britannica.com/science/Little-Ice-Age" target="_blank" rel="noreferrer noopener">Little Ice Age</a> (roughly 1300–1850). That might account for some of the warming during the early 19th century, Chan said, but definitely not all.</p>

<p>“It is essential to more accurately distinguish the anthropogenic component from other factors, particularly during the early industrial period,” Chan said. “This distinction not only enhances our understanding of climate change but also has significant political implications, informing policy and target setting in the context of global warming.”</p>

<p>McCulloch, Winter, and their colleagues urged IPCC scientists and climate modelers to consider this new preindustrial starting line. Whether it will be adopted is uncertain, but if the world has already surpassed 1.5°C of warming, the researchers argue that continued <a href="https://eos.org/tag/climate-action" target="_blank" rel="noreferrer noopener">climate action</a> is more important than ever.</p>

<p>—Kimberly M. S. Cartier (<a href="https://twitter.com/@AstroKimCartier" target="_blank" rel="noreferrer noopener">@AstroKimCartier</a>), Staff Writer</p>

<h5><strong>Citation:</strong>&nbsp;Cartier, K. M. S. (2024), Oceans may have already seen 1.7°C of warming,&nbsp;<em>Eos, 105, </em><a href="https://doi.org/10.1029/2024EO240059" target="_blank" rel="noreferrer noopener">https://doi.org/10.1029/2024EO240059</a>. Published on 5 February 2024.</h5>

<h6><strong>Text © 2024. The authors.&nbsp;<a href="https://creativecommons.org/licenses/by-nc-nd/3.0/us/" target="_blank" rel="noreferrer noopener">CC BY-NC-ND 3.0</a></strong><br><strong>Except where otherwise noted, images are subject to copyright. Any reuse without express permission from the copyright owner is prohibited.</strong></h6>

	</div><!-- .entry-content -->

	<!-- .entry-footer -->

	
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Bluesky and the at Protocol (161 pts)]]></title>
            <link>https://arxiv.org/abs/2402.03239</link>
            <guid>39275203</guid>
            <pubDate>Tue, 06 Feb 2024 15:25:33 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://arxiv.org/abs/2402.03239">https://arxiv.org/abs/2402.03239</a>, See on <a href="https://news.ycombinator.com/item?id=39275203">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content-inner">
    
    
                
    <p><a href="https://arxiv.org/pdf/2402.03239.pdf">Download PDF</a></p><blockquote>
            <span>Abstract:</span>Bluesky is a new social network built upon the AT Protocol, a decentralized foundation for public social media. It was launched in private beta in February 2023, and has grown to over 3 million registered users in the following year. In this paper we introduce the architecture of Bluesky and the AT Protocol, which is inspired by the web itself, but modernized to include streams of real-time updates and cryptographic authentication. We explain how the technical design of Bluesky is informed by our goals: to enable decentralization by having multiple interoperable providers for every part of the system; to make it easy for users to switch providers; to give users agency over the content they see; and to provide a simple user experience that does not burden users with complexity arising from the system's decentralized nature. The system's openness allows anybody to contribute to content moderation and community management, and we invite the research community to use Bluesky as a dataset and testing ground for new approaches in social media moderation.
    </blockquote>

    <!--CONTEXT-->
    
  </div><div>
      <h2>Submission history</h2><p> From: Martin Kleppmann [<a href="https://arxiv.org/show-email/f3ce74c0/2402.03239">view email</a>]      <br>    <strong>[v1]</strong>
        Mon, 5 Feb 2024 17:55:51 UTC (2,032 KB)<br>
</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Better Call GPT, Comparing Large Language Models Against Lawyers [pdf] (294 pts)]]></title>
            <link>https://arxiv.org/abs/2401.16212</link>
            <guid>39274918</guid>
            <pubDate>Tue, 06 Feb 2024 15:04:39 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://arxiv.org/abs/2401.16212">https://arxiv.org/abs/2401.16212</a>, See on <a href="https://news.ycombinator.com/item?id=39274918">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content-inner">
    
    
                
    <p><a href="https://arxiv.org/pdf/2401.16212.pdf">Download PDF</a>
    <a href="https://arxiv.org/html/2401.16212v1">HTML (experimental)</a></p><blockquote>
            <span>Abstract:</span>This paper presents a groundbreaking comparison between Large Language Models and traditional legal contract reviewers, Junior Lawyers and Legal Process Outsourcers. We dissect whether LLMs can outperform humans in accuracy, speed, and cost efficiency during contract review. Our empirical analysis benchmarks LLMs against a ground truth set by Senior Lawyers, uncovering that advanced models match or exceed human accuracy in determining legal issues. In speed, LLMs complete reviews in mere seconds, eclipsing the hours required by their human counterparts. Cost wise, LLMs operate at a fraction of the price, offering a staggering 99.97 percent reduction in cost over traditional methods. These results are not just statistics, they signal a seismic shift in legal practice. LLMs stand poised to disrupt the legal industry, enhancing accessibility and efficiency of legal services. Our research asserts that the era of LLM dominance in legal contract review is upon us, challenging the status quo and calling for a reimagined future of legal workflows.
    </blockquote>

    <!--CONTEXT-->
    
  </div><div>
      <h2>Submission history</h2><p> From: Rivindu Perera [<a href="https://arxiv.org/show-email/e9e4df27/2401.16212">view email</a>]      <br>    <strong>[v1]</strong>
        Wed, 24 Jan 2024 03:53:28 UTC (695 KB)<br>
</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Bluesky signups are now open to the public (279 pts)]]></title>
            <link>https://bsky.social/about/blog/02-06-2024-join-bluesky</link>
            <guid>39274882</guid>
            <pubDate>Tue, 06 Feb 2024 15:01:28 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://bsky.social/about/blog/02-06-2024-join-bluesky">https://bsky.social/about/blog/02-06-2024-join-bluesky</a>, See on <a href="https://news.ycombinator.com/item?id=39274882">Hacker News</a></p>
<div id="readability-page-1" class="page"><section><header><section><a href="https://bsky.social/about/blog">Blog</a><svg width="8" height="12" viewBox="0 0 8 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 10L6 6L2 2" stroke="#667999" stroke-width="2" stroke-linecap="square"></path></svg><span>Join Bluesky Today (Bye, Invites!)</span></section><div><p>Feb 6, 2024</p><p><span>by <!-- -->The Bluesky Team</span></p></div></header><div><p>Bluesky is building an open social network where anyone can contribute, while still providing an easy-to-use experience for users. For the past year, we used invite codes to help us manage growth while we built features like moderation tooling, custom feeds, and more. Now, we’re ready for anyone to join.</p>

<p>Join more than three million people discussing news, sharing art, and just posting.</p>
<h2>What is Bluesky?</h2>
<p>To mark the occasion, we teamed up with <a href="https://bsky.app/profile/davis.social">Davis Bickford</a>, an artist on the network, to share why we’re excited about Bluesky.</p>
<p><img src="https://bsky.social/about/welcome-to-bluesky-comic-davis-bickford/page-1.jpg" alt="A multi-panel comic. Two characters stand amidst a pile of rubble. One says, 'I think it's time to leave old social. This keeps happening. I have to start over again. I'm tired.' The two characters board a boat. Jay says, 'Don't worry! Better things are ahead at Bluesky!' They arrive to a beautiful, festive area that has buildings labeled News, Discover, Art, Science, and more." classname="w-full">
<img src="https://bsky.social/about/welcome-to-bluesky-comic-davis-bickford/page-2.jpg" alt="A multi-panel comic. Jay says, 'At Bluesky, you choose what you want to see instead of being held to the whims of a blackbox algorithm. There are already tens of thousands of feeds! Anyone can make or subscribe to feeds!' A troll appears. Jay says, 'And for things you don't want to see, you can stack additional layers of moderation as easily as following a new account.' Poof! Fences go up and the troll disappears. Jay continues to describe Bluesky's open network. 'With Bluesky, everything is connected. Dock at any port — you can explore the entire network. And wherever you go, your whole network comes with you.'" classname="w-full">
<img src="https://bsky.social/about/welcome-to-bluesky-comic-davis-bickford/page-3.jpg" alt="A multi-panel comic. One character says, 'At Bluesky, I can customize my own experience and if I move, everything comes with me?!' Jay smiles and says, 'Yes, it's the last social account you'll ever have to create!' The two run across a bridge towards a magical mountainside. They say, 'Come on, let's go explore!'" classname="w-full"></p>
<p>To learn more about Bluesky and how to get started, read our <a href="https://bsky.social/about/blog/5-19-2023-user-faq">user FAQ here</a>.</p>
<p>And if deep dives are more your style, we worked with <a href="https://bsky.app/profile/martin.kleppmann.com">Martin Kleppman</a>, author of <em>Designing Data-Intensive Applications</em> and technical advisor to Bluesky, to write <a href="https://bsky.social/about/bluesky-and-the-at-protocol-usable-decentralized-social-media-martin-kleppmann.pdf">a paper that goes into more detail</a> about the technical underpinnings of Bluesky.</p>
<h2>Looking Forward</h2>
<p>We’ve been working on more features that put you in control of your social media experience. Here’s what you can expect to see soon:</p>
<h3>Stackable Moderation Services</h3>
<p>Safety is core to social media. Bluesky moderates the app according to our community guidelines, and our vision for <a href="https://bsky.social/about/blog/4-13-2023-moderation">composable moderation</a> allows users to stack more moderation services together, such as subscribable moderation lists.</p>
<p>In the coming weeks, we’re excited to release the labeling services which will allow users to stack more options on top of their existing moderation preferences. This will allow other organizations and people to run their own moderation services that can account for industry-specific knowledge or specific cultural norms, among other preferences.</p>
<p>One potential use case for labeling is fact-checking. For example, a fact-checking organization can run a labeling service and mark posts as “partially false,” “misleading,” or other categories. Then, users who trust this organization can subscribe to their labels. As the user scrolls through posts in the app, any labels that the fact-checking organization publishes will be visible on the post itself. This helps in the effective distribution of the fact-check and keeps users better informed.</p>
<p>We’ll be sharing more in the coming weeks. In the meantime, if you’re interested in partnering with Bluesky and setting up a labeling service, contact us at <a href="mailto:partnerships@blueskyweb.xyz">partnerships@blueskyweb.xyz</a>.</p>
<h3>An Open Social Network</h3>
<p>When you log in to Bluesky, it might look and feel familiar — the user experience should be straightforward. But under the hood, we’ve designed the app in a way that puts control back in your hands. Here, your experience online isn’t controlled by a single company. Whether it's your timeline or content filters, on Bluesky, you can easily customize your social experience.</p>
<p>This month, we’ll be rolling out an experimental early version of “federation,” or the feature that makes the network so open and customizable. On Bluesky, you’ll have the freedom to choose (and the right to leave) instead of being held to the whims of private companies or black box algorithms. And wherever you go, your friends and relationships can go with you.</p>
<p>For developers: We’ve already federated the network among multiple servers internally, and later this month, you’ll be able to self-host a server that connects to the main production network. You’ll be part of the first batch of servers that federate with the network, so expect to experiment alongside us! We’ll share more information on how to join the production network with your own server soon. In the meantime, you can test out your server set up via our developer sandbox. <a href="https://www.docs.bsky.app/blog/federation-sandbox">Find instructions here</a>.</p></div></section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Mozilla Monitor Plus: automatically remove your personal info from data brokers (230 pts)]]></title>
            <link>https://blog.mozilla.org/en/mozilla/introducing-mozilla-monitor-plus-a-new-tool-to-automatically-remove-your-personal-information-from-data-broker-sites/</link>
            <guid>39274631</guid>
            <pubDate>Tue, 06 Feb 2024 14:37:19 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.mozilla.org/en/mozilla/introducing-mozilla-monitor-plus-a-new-tool-to-automatically-remove-your-personal-information-from-data-broker-sites/">https://blog.mozilla.org/en/mozilla/introducing-mozilla-monitor-plus-a-new-tool-to-automatically-remove-your-personal-information-from-data-broker-sites/</a>, See on <a href="https://news.ycombinator.com/item?id=39274631">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content">
  <main id="main">

    
<article id="post-74078">
  

  <div>
    
<p>Today,<a href="http://relay.firefox.com/"> </a><a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Mozilla Monitor</a> (previously called Firefox Monitor), a free service that notifies you when your email has been part of a breach, announced its new paid subscription service offering: automatic data removal and continuous monitoring of your exposed personal information.&nbsp;</p>



<figure><p>
<iframe title="Mozilla Monitor Plus | Product Walkthrough" width="640" height="360" src="https://www.youtube.com/embed/lT0u415in5Y?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
</p><figcaption><em>Introducing Mozilla Monitor Plus</em></figcaption></figure>



<p>There’s a growing interest among 42% of young adults – aged 18-24 – who want to learn more about the types of information that companies have about them, according to a <a href="https://blogs.cisco.com/security/generation-privacy">consumer privacy survey</a>. Yet, taking the steps to request changes or delete personal data can be a bit overwhelming. At Mozilla, we’re always looking for ways to <a href="https://www.mozilla.org/en-US/about/manifesto/">protect people’s privacy and give them greater control when they go online</a>. Enter <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Monitor Plus</a>.</p>



<p>“When we <a href="https://blog.mozilla.org/en/products/firefox/introducing-firefox-monitor-helping-people-take-control-after-a-data-breach/">launched</a> Monitor, our goal was to help people discover where their personal info may have been exposed. Now, with <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Monitor Plus</a>, we’ll help people take back their exposed data from data broker sites that are trying to sell it,” said Tony Amaral-Cinotto, Product Manager of <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Mozilla Monitor</a> at Mozilla. “Our long-standing commitment to put people’s needs first and our easy step-by-step process makes <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Monitor Plus</a> unique. Additionally, we combine breach alerts and data broker removal to offer an all-in-one protection tool and make it easier for people to feel and be safe online.”&nbsp;</p>



<h2>First step: Find out where your personal information has been exposed</h2>



<p>More than 10 million people have signed up with <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Mozilla Monitor</a> so they can be notified when their personal data has been involved in a data breach. Today, we are rolling out a new feature with a free one-time scan, where people can take the next step to see where their personal information has been exposed on sites selling it for profit. This could include information like your name, current and previous home addresses, and phone numbers. It could also go another layer deeper with information like family member names, criminal history, your kids’ school district, and even your hobbies.</p>



<p>To get your complimentary scan, you will need to provide your first and last name, the current city and state that you live in, your date of birth, and your email address. This information will be encrypted and follows <a href="https://www.mozilla.org/en-US/privacy/subscription-services/#">Mozilla’s privacy policy</a>, which always puts people first. This is the least amount of information we need to get the most accurate search results for you. From there, you can see where your personal info is exposed, either through a data breach or through broker sites. We also include high risk data breaches – exposures that may include social security numbers, credit card information, your bank account and pin numbers – that you’ve been exposed to and show how you can fix and resolve it.</p>



<figure><img decoding="async" src="https://lh7-us.googleusercontent.com/yCUt5bOi3hGj82IdNvhpBRn5JUvgHe12zyfOj0otRLhVSMxYZZlfaTbYz2d4Asli27Os6Pz-4SMFGa_QjoPjiY6fdxX95L-tBH-d0wU5xKxHnBQOo2vEK6PLECZzyQ1GQ8Jf4Za_YuKU85GjdCQ_SWg" alt="brief GIF showing the fields where you enter some personal data, then a screen showing &quot;scanning for exposure&quot;, then the dashboard where you can fix."><figcaption><em>Take the step to see where your personal info has been exposed</em></figcaption></figure>



<h2>Second step: Take back your personal information with <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Monitor Plus</a></h2>



<p>If you’re the type who wants to set it and forget it, because you know the work is happening behind the scenes, then we can automatically and continuously request to remove your personal information with an annual paid subscription of $8.99 per month ($107.88 a year). On your behalf, <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Mozilla Monitor</a> will start with data removal requests, then scan every month to make sure your personal information stays off data broker sites. <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Monitor Plus</a> will let you know once your personal information has been removed from more than 190+ data broker sites, twice the number of other competitors.&nbsp;</p>


<div>
<figure><img decoding="async" src="https://lh7-us.googleusercontent.com/FxkxHE3KjEx8E5mWL1TMfLUo0iQgKfB2gmk7qZpmUQq238_CUKjTYderXtlrkcrOGFqt3FhnRd8NxuDx-Zy50DO7-Bz6H8xg1mzKWZkhOyZe_wcbHgGyeCpSQnTyCSI2wFgkptpfnP4zz89xh-e7BJI" alt=""><figcaption><em>See the actual sites where your personal info has been exposed</em></figcaption></figure></div>

<div>
<figure><img decoding="async" src="https://lh7-us.googleusercontent.com/1XnRNUd8_tpwsfuriYyQD3ZcFf7XdhhGHukY_F0E1TqQv87tOmVHuHQgOdbcVGCZi1wpPfrrThcNPiQ_oGseKN_5aI0GQOUuLFZkPfvitg6bYacMF-pOG1X8_qr8zN5MZXQcecd0ehRhpF0pUvaUanE" alt=""><figcaption><em>Mark as fixed in the dashboard</em></figcaption></figure></div>


<p>At launch, the <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Monitor Plus</a> free scan and paid subscription service will be offered to people based in the United States.&nbsp;</p>



<h2>Privacy starts with a Mozilla Account</h2>



<p>Mozilla has built a reputation of creating and delivering products – <a href="https://www.mozilla.org/en-US/firefox/new/">Firefox</a> and <a href="https://www.mozilla.org/en-US/products/vpn/?entrypoint_experiment=vpn-pricing-position&amp;entrypoint_variation=1">Mozilla VPN</a> – that put people’s privacy needs first so you can count on <a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">Mozilla Monitor</a> as an ally in reclaiming your privacy. In order to get a free scan and sign up for the paid automated data removal, you’ll need to get a <a href="https://www.mozilla.org/en-US/firefox/accounts/">Mozilla Account </a>(previously known as a <a href="https://blog.mozilla.org/en/mozilla/firefox-accounts-transition-mozilla-accounts/">Firefox Account</a>). With a Mozilla Account, you’ll get security benefits such as two-factor authentication powered by Mozilla, as well as backed by Mozilla’s <a href="https://www.mozilla.org/en-US/about/legal/terms/services/">terms of service</a> and <a href="https://www.mozilla.org/en-US/privacy/mozilla-accounts/">privacy policy</a>. To learn about the benefits of having a Mozilla Account, <a href="https://blog.mozilla.org/en/products/firefox/firefox-tips/firefox-account-password-manager-bookmarks-credit-card-autofill/">click here</a>.</p>



<figure><p>
<iframe title="Take back your privacy with Mozilla Monitor Plus" width="640" height="360" src="https://www.youtube.com/embed/WOBGckoAgq8?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
</p></figure>







<a href="https://monitor.firefox.com/?utm_medium=mozilla-websites&amp;utm_source=blog.mozilla.org&amp;utm_campaign=monitor-plus-launch-us&amp;utm_content=introduction-us">
  <p><img width="200" height="200" src="https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/01/moz_monitor_mdn_ad_01_260x200-200x200.png" alt="" decoding="async" srcset="https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/01/moz_monitor_mdn_ad_01_260x200-200x200.png 200w, https://blog.mozilla.org/wp-content/blogs.dir/278/files/2024/01/moz_monitor_mdn_ad_01_260x200-150x150.png 150w" sizes="(max-width: 200px) 100vw, 200px">  </p>
  <div>
     <h3>Find out where your private info is exposed – and take it back</h3>      <p><span>Try a free scan today with Mozilla Monitor!</span>   </p></div>
</a>












  </div>

</article><!-- #post-74078 -->

  </main><!-- #main -->
  

<div id="related-articles">
    <h2>Related Articles</h2>
    
  </div>



</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Dean of Engineering at University of Nevada wrote a paper that’s bad (115 pts)]]></title>
            <link>https://statmodeling.stat.columbia.edu/2024/02/06/its-bezzle-time-the-dean-of-engineering-at-the-university-of-nevada-gets-paid-372127-a-year-and-wrote-a-paper-thats-so-bad-you-cant-believe-it-i-mean-really-you-have-to-take-a-look-at-t/</link>
            <guid>39274461</guid>
            <pubDate>Tue, 06 Feb 2024 14:23:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://statmodeling.stat.columbia.edu/2024/02/06/its-bezzle-time-the-dean-of-engineering-at-the-university-of-nevada-gets-paid-372127-a-year-and-wrote-a-paper-thats-so-bad-you-cant-believe-it-i-mean-really-you-have-to-take-a-look-at-t/">https://statmodeling.stat.columbia.edu/2024/02/06/its-bezzle-time-the-dean-of-engineering-at-the-university-of-nevada-gets-paid-372127-a-year-and-wrote-a-paper-thats-so-bad-you-cant-believe-it-i-mean-really-you-have-to-take-a-look-at-t/</a>, See on <a href="https://news.ycombinator.com/item?id=39274461">Hacker News</a></p>
Couldn't get https://statmodeling.stat.columbia.edu/2024/02/06/its-bezzle-time-the-dean-of-engineering-at-the-university-of-nevada-gets-paid-372127-a-year-and-wrote-a-paper-thats-so-bad-you-cant-believe-it-i-mean-really-you-have-to-take-a-look-at-t/: Error: timeout of 10000ms exceeded]]></description>
        </item>
        <item>
            <title><![CDATA[What Happened with the Web Monetization API? (171 pts)]]></title>
            <link>https://chriscoyier.net/2024/01/24/what-happened-with-the-web-monetization-api/</link>
            <guid>39274455</guid>
            <pubDate>Tue, 06 Feb 2024 14:23:24 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://chriscoyier.net/2024/01/24/what-happened-with-the-web-monetization-api/">https://chriscoyier.net/2024/01/24/what-happened-with-the-web-monetization-api/</a>, See on <a href="https://news.ycombinator.com/item?id=39274455">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
<p>I was <a href="https://css-tricks.com/more-people-dipping-toes-into-web-monetization/">pretty hot on it for a minute</a>. I wanted it to succeed and thought it had the bones to make it. Coil was the main startup trying to push it. They did the right thing by just making it work first, showing there is interest, then pushing to get it standardized. But <a href="https://www.coil.com/">Coil failed</a>. </p>
<blockquote>
<p>When we started Coil in 2018, Interledger was only an idea. Over the last five years we breathed life into the technology and sparked a vibrant ecosystem around it. Now it’s time to pass the torch to a neutral body in the form of the&nbsp;<a href="https://interledger.org/">Interledger&nbsp;Foundation</a>&nbsp;to steward the future development of Interledger.</p>
</blockquote>
<p>I don’t know much about Interledger. It seems alive-<em>ish</em>? They had a “Summit” recently and <a href="https://www.youtube.com/watch?v=qmjeQb79mwQ">I watched some of it</a> but it didn’t do much for my understanding.</p>
<p>Then recently I saw <a href="https://xoxo.zone/@sara/111774573812373512">a good thread</a> from <a href="https://sarafen.com/">Sara</a> including this:</p>
<figure><img fetchpriority="high" decoding="async" width="1024" height="768" data-attachment-id="11027" data-permalink="https://chriscoyier.net/2024/01/24/what-happened-with-the-web-monetization-api/958shots_so/" data-orig-file="https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?fit=1920%2C1440&amp;ssl=1" data-orig-size="1920,1440" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="958shots_so" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?fit=300%2C225&amp;ssl=1" data-large-file="https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?fit=1024%2C768&amp;ssl=1" src="https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?resize=1024%2C768&amp;ssl=1" alt="" srcset="https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?resize=1024%2C768&amp;ssl=1 1024w, https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?resize=300%2C225&amp;ssl=1 300w, https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?resize=768%2C576&amp;ssl=1 768w, https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?resize=1536%2C1152&amp;ssl=1 1536w, https://i0.wp.com/chriscoyier.net/wp-content/uploads/2024/01/958shots_so.png?w=1920&amp;ssl=1 1920w" sizes="(max-width: 1000px) 100vw, 1000px" data-recalc-dims="1"></figure>
<p>Sara started it by saying that she just wants to “click a little button and send money from me to the person/org/persons operating a website”. Totally! I’m obsessed with that use case. It needs to be built into the browsers and web standards such that it’s incredibly smooth and fast. I wanna send $1 to a website, it happens instantly and anonymously, and the developer can do things around this. Like unlock features! For instance, stop showing ads, offer more complete downloads, unlock tutorial courses, etc. Make it <em>easier</em> and <em>faster</em> than using a credit card.</p>
<p>It appears that the Web Monetization API is up to the task. I friggin’ love the example of how to use it as a developer:</p>
<pre aria-describedby="shcb-language-1" data-shcb-language-name="HTML, XML" data-shcb-language-slug="xml"><span><code><span>&lt;!doctype <span>html</span>&gt;</span>
<span>&lt;<span>html</span> <span>lang</span>=<span>"en"</span>&gt;</span>
  <span>&lt;<span>head</span>&gt;</span>
    <span>&lt;<span>meta</span> <span>charset</span>=<span>"utf-8"</span> /&gt;</span>
    <span>&lt;<span>title</span>&gt;</span>My Blog<span>&lt;/<span>title</span>&gt;</span>
    <span>&lt;<span>link</span>
      <span>rel</span>=<span>"monetization"</span>
      <span>href</span>=<span>"https://example.com/pay"</span>
      <span>onmonetization</span>=<span>"sayThanks(this)"</span>
    /&gt;</span>
    <span>&lt;<span>script</span>&gt;</span><span>
      <span><span>function</span> <span>sayThanks</span><span>(monetizedLink)</span> </span>{
        <span>// Do something here</span>
      }
    </span><span>&lt;/<span>script</span>&gt;</span>
  <span>&lt;/<span>head</span>&gt;</span>
  <span>&lt;<span>body</span>&gt;</span><span>&lt;/<span>body</span>&gt;</span>
<span>&lt;/<span>html</span>&gt;</span></code></span><small id="shcb-language-1"><span>Code language:</span> <span>HTML, XML</span> <span>(</span><span>xml</span><span>)</span></small></pre>
<p>And of course there are more APIs, like for checking how much a user contributed, if they have already contributed, etc. </p>
<p>Does it have legs anymore? I just have no idea. Sorry if the title of the post led you to believe I might have an answer. I’m just <em>looking</em> for the answer.</p>
<p>Again though, poking a button to send a website bucks through web standards is a great idea. </p>
<p>I’ll leave it with my favorite use case (removing ads) and what I’ve written before, in hopes that this part can be done right:</p>
<blockquote>
<p>Removing ads is the most basic and obvious use case, and I hope some people give that a healthy try. […] I’d want to clearly be able to control the dollar-level of when you get that perk, but more importantly, in order to really make good on the promise of not delivering ads, you need to know very quickly if any given user is supporting you at the required level or not. For example, you can’t wait 2600 milliseconds to decide whether ads need to be requested. Well, you can, but you’ll wreck your ad revenue. And you can’t simply request the ads and hide them when you find out, lest you are not really making good on a promise, as trackers’n’stuff will have already done their thing.</p>
</blockquote>
<h2>Update: The Answer</h2>

<p><a href="https://www.quirksmode.org/about/">PPK</a> is now DevRel for the Interledger Foundation, so apparently it’s heating up again. The news is that the API will hook up to an online “wallet” powered by <a href="https://fynbos.app/">fynbos</a>. I’ve never heard of it, but it looks like it connects to banks and credit cards, not crypto. It’s not that I’m some big stan for Big Banks, but crypto was (is) just so absolutely riddled with scams and crime that I just can’t anymore. Decoupling the Web Payments API and crypto is certainly the right move right now.</p>
 </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The Apple Vision Pro (148 pts)]]></title>
            <link>https://stratechery.com/2024/the-apple-vision-pro/</link>
            <guid>39274440</guid>
            <pubDate>Tue, 06 Feb 2024 14:22:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://stratechery.com/2024/the-apple-vision-pro/">https://stratechery.com/2024/the-apple-vision-pro/</a>, See on <a href="https://news.ycombinator.com/item?id=39274440">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-12278">
	<!-- .entry-header -->

	<div>
		
<p><strong>No wireless. Less space than a nomad. Lame.</strong><br>
— <em>CmdrTaco, <a href="https://slashdot.org/story/01/10/23/1816257/apple-releases-ipod">Slashdot</a></em></p>

<p>My one small comfort in the cold Wisconsin winters, walking up and down Bascom Hill in the snow at the University of Wisconsin-Madison, was listening to music on my Diamond Rio.</p>
<p><img loading="lazy" decoding="async" src="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-3.png?resize=450%2C600&amp;ssl=1" alt="The Diamond Rio" width="450" height="600" srcset="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-3.png?w=450&amp;ssl=1 450w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-3.png?resize=225%2C300&amp;ssl=1 225w" sizes="(max-width: 450px) 100vw, 450px" data-recalc-dims="1"></p>
<p>That Rio served me well all through college; Apple shipped the first iPod my senior year, but it was Mac only, and besides, my Rio was good enough. Sure, I could only fit 20 songs or so (of course I bought the proprietary expansion memory card), but if I wanted more I could just sync with my computer. I certainly wasn’t going to pay $2,000 or whatever it cost to get a Mac and an iPod to have “1,000 song in [my] pocket”.</p>
<p><img loading="lazy" decoding="async" src="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-6.png?resize=497%2C234&amp;ssl=1" alt="iPod. 1,000 Songs in your pocket." width="497" height="234" srcset="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-6.png?w=497&amp;ssl=1 497w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-6.png?resize=300%2C141&amp;ssl=1 300w" sizes="(max-width: 497px) 100vw, 497px" data-recalc-dims="1"></p>
<p>Two years after graduation I was in Taiwan and smitten with the recently released GarageBand, which led to my first Mac, and, not too long after, my first iPod. I can’t believe that I lived any other way!</p>
<p>I did, like the nerd that I am, experiment with using my iPod as a hard drive, but even with the addition of video capabilities and basic games it was exactly what it promised to be: the best possible way to listen to music on the go. That clarity was part of its allure: Apple had brilliantly paired the iPod with iTunes, offloading advanced playlist capabilities and library management to the computer, letting the iPod do what it did best.</p>
<p>It’s hard to imagine, now, but at the time the iPod era seemed to go from height to height, anchored by standalone Apple launch events for new models and iterations, complete with appearances from famous artists. In fact, though, it was only five-and-a-half years before the iPod gave way to the iPhone: yes, Apple still sold standalone music players for a few more years, but one’s pocket only had room for so many devices, and the iPhone was not just an iPod but also a cellular phone and Internet communicator (whatever that was):</p>
<p><img loading="lazy" decoding="async" src="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-4.png?resize=640%2C360&amp;ssl=1" alt="The iPhone's Capabilities" width="640" height="360" srcset="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-4.png?w=640&amp;ssl=1 640w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-4.png?resize=300%2C169&amp;ssl=1 300w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1"></p>
<p>This little trip down memory lane offers one way to understand Apple’s latest product launch: one way to think about the Vision Pro is that it is the iPod to the iPad’s Diamond Rio. One of the realities of the iPad is that, for most customers, it is a personal video player; for that particular use case the Apple Vision is superior in nearly every way. At the same time, the <a href="https://stratechery.com/2020/the-ipad-at-10-the-ipad-disappointment-ipads-missing-ecosystem/">tragedy of the iPad</a> is that outside of pen-based artistic use cases it is not particularly compelling as a <em>computer</em>. That, for now, is also the story of the Apple Vision Pro; the question is if there is an iPhone-esque <a href="https://stratechery.com/2013/obsoletive/">obsoletion opportunity</a> in its future.</p>
<h3>The Productivity Disappointment</h3>
<p>It is, admittedly, a bit early for me to be writing an Apple Vision Pro review: I only received it 36 hours ago, and my original plan was to use it for work on an upcoming trip, and only then give my thoughts. It quickly became apparent, though, that that would not be necessary, or desirable, for reasons I will lay out below. Plus, I wasn’t coming in blind: I tried the Vision Pro last year at WWDC, and was blown away. From the introduction of <a href="https://stratechery.com/2023/apple-vision/">Apple Vision</a>:</p>
<blockquote><p>It really is one of the best product names in Apple history: Vision is a description of a product, it is an aspiration for a use case, and it is a critique on the sort of society we are building, behind Apple’s leadership more than anyone else.</p>
<p>I am speaking, of course, about Apple’s new mixed reality headset that was <a href="https://www.youtube.com/watch?v=GYkq9Rgoj8E">announced at yesterday’s WWDC</a>, with a planned ship date of early 2024, and a price of $3,499. I had the good fortune of using an Apple Vision Pro in the context of a controlled demo — which is an important grain of salt, to be sure — and I found the experience extraordinary.</p>
<div>
<blockquote data-dnt="true">
<p lang="en" dir="ltr">It’s far better than I expected, and I had high expectations.</p>
<p>— Ben Thompson (@benthompson) <a href="https://twitter.com/benthompson/status/1665922508015673344?ref_src=twsrc%5Etfw">June 6, 2023</a></p></blockquote>
</div>
<p>The high expectations came from the fact that not only was this product being built by Apple, the undisputed best hardware maker in the world, but also because I am, unlike many, relatively optimistic about VR. What surprised me is that Apple exceeded my expectations on both counts: the hardware and experience were better than I thought possible, and the potential for Vision is larger than I anticipated. The societal impacts, though, are much more complicated.</p>
</blockquote>
<p>I’m glad I put that caveat about the “controlled demo” in there. What I realize now, after using the Vision Pro as I pleased, is that almost every part of the demo was focused on one particular app or immersive experience: you became, without realizing it, the sort of person who only ever looks at one app full screen on your computer at all times. When you want to use another app, switch to that app, which itself takes over the full screen.</p>
<p>This is, of course, how iOS was designed for the iPhone, and while iOS has been scaled up to iPadOS and visionOS, the former is a shining example of how difficult it is to take a one-app UI and make it multi-window. Apple has iterated on multi-window capacity on the iPad for years, and it is still so janky that I mostly only invoke it by accident.<sup id="rf1-12278"><a href="#fn1-12278" title="You can disable it completely, which I have done for many people in my life" rel="footnote">1</a></sup> Part of the problem is hardware: there just isn’t that much screen real estate, even on the largest iPad, and the limitation of only using touch controls means that the operating system has to rely on undiscoverable gestures.</p>
<p>visionOS suffers from a similar combination of shortcomings. First off, the user interface is exceptionally difficult to manage once you have multiple windows on the screen, particularly when windows are arranged on the z-axis (i.e. nearer or closer to you in 3-D space); one gets the sense that the usability of iOS-based operating systems are inversely correlated to their screen size. Second, while the eye tracking is an incredible feat of engineering, it is not nearly as precise as it needs to be for productive window management.</p>
<p>The biggest limitation, though, is hardware: the Vision Pro field of view is very narrow, in a way I didn’t fully appreciate while only using one app in that demo (Apple hasn’t reported the number, but it is noticeably narrower than the Quest 3’s 110°). This becomes immediately apparent when you have more than two or so apps open: if you want room for more, without encountering the z-axis issues I noted above, you better get ready to physically move your head or body (this is exacerbated by the fact that Vision Pro apps are very large, even if you have chosen the “small” preference; I would like them to be half the size they present as).</p>
<p>The net result is that the Vision Pro, at least in its current incarnation, does not come close to being the productivity tool I was so excited about last summer, when I wrote that I suspected the Vision Pro was “the future of the Mac”, and that’s even before getting to the limitations of Apple’s iOS-based operating system in terms of app capabilities and business models. That latter point, along with the limitations of eye-tracking as a default user-interface model, also makes me worry that new and better hardware won’t change this reality.</p>
<h3>Mac As the Future</h3>
<p>I did walk back my “future of the Mac” prediction <a href="https://stratechery.com/2023/quest-vs-vision-vision-and-the-mac-apple-acquires-mira/">in a follow-up</a> to that Article.</p>
<blockquote><p>
  I wrote in the productivity section of yesterday’s Article, “To put it even more strongly, the Vision Pro is, I suspect, the future of the Mac.” I’m kind of irritated at myself for not making one critical observation: the Vision Pro is the future of the Mac if Apple makes software choices that allow it to be.</p>
<p>  I’m mostly referring to the Mac’s dramatically larger degree of openness relative to other platforms like iPadOS: so many of the capabilities of a Mac are not because of its input method, but because applications and users have far fewer constraints on what they can do, and it will be difficult to replace the Mac if the same constraints that exist in iPadOS exist in visionOS.</p>
<p>  Frankly, I’m dubious Apple will allow that freedom, and I should have tempered my statement because of that. I do think that visionOS is much more compelling for productivity than the iPad is, thanks to the infinite canvas it enables, but if you have to jump through the same sort of hoops to get stuff done that you do with the iPad, well, that ability to project a Mac screen into the Vision Pro is going to be essential.
</p></blockquote>
<p>Unfortunately, I find this capability underwhelming: right now you can project one 4K screen into the Vision Pro, which is roughly equivalent to my 16″ MacBook Pro screen. You can augment that screen with Vision Pro apps, but I find the experience unworkable for two reasons: first, the field of view limitation means it is very difficult to even see, much less manage, multiple apps, particularly if the Mac projection is blown up to a useful size; and second, while you can use your keyboard and trackpad (but not mouse) for Vision Pro apps, the mismatch in expected interaction models creates a mental burden that is difficult to dispel. This could get better with time, but the experience was underwhelming enough that I’m not particularly motivated to find out.</p>
<p>At the end of the day, my calculation is thus: at my desk I have four monitors.<sup id="rf2-12278"><a href="#fn2-12278" title="Including my built-in display, which in this picture is 14″; the photo is old, but representative enough." rel="footnote">2</a></sup></p>
<p><img loading="lazy" decoding="async" src="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-2.png?resize=640%2C359&amp;ssl=1" alt="My 4-monitor desk setup" width="640" height="359" srcset="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-2.png?w=1280&amp;ssl=1 1280w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-2.png?resize=300%2C168&amp;ssl=1 300w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-2.png?resize=1024%2C574&amp;ssl=1 1024w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-2.png?resize=768%2C430&amp;ssl=1 768w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-2.png?resize=1125%2C630&amp;ssl=1 1125w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1"></p>
<p>This is drastically more powerful and capable than anything I could achieve on the Vision Pro; my dream would be to have a similar experience away from my desk, but the limited utility in practice doesn’t make it worth carrying around a Vision Pro when my computer has a perfectly fine screen to get work done (the one big exception would be something like an economy class airline seat, where it is not only difficult to open one’s computer, but also uncomfortable to know that your seat mate can look over your shoulder; more on this privacy aspect in a bit).</p>
<p>That noted, this capability might get better soon; in that Update I highlighted <a href="https://developer.apple.com/documentation/macos-release-notes/macos-14-release-notes">this detail in the macOS Sonoma release notes</a> about Apple’s new high-performance screen-sharing:</p>
<blockquote><p>
  A High Performance connection requires a network that supports at least 75Mbps for one 4K virtual display and at least 150Mbps for two 4K virtual displays. Low network latency is also required for responsiveness.
</p></blockquote>
<p>I have heard through the grapevine that Vision Pro users at Apple headquarters can project two Mac screens, which to me would make a massive difference in the Vision Pro’s utility: having two 4K displays for my Mac anywhere I go would absolutely make me more productive, and make it worth carrying the Vision Pro. Indeed, my question then would be, “Why do I have to carry my entire MacBook?”</p>
<p>This leads to one more curious discovery:</p>

<p>That’s not a lightning port: it has 12 pins instead of 8, which seems like overkill for simply conducting power. And, to be clear, that’s 12 pins per side, which is the same as a USB-C connector. Two of the pins in USB-C are reserved for a communications channel so two devices can negotiate the orientation of each end of a cable, making the other 22 pins all usable, and enabling protocols like DisplayPort or Thunderbolt. The latter has more than sufficient bandwidth to move compute to the end of that cable — could there be a battery alternative that is nothing more than a keyboard with a Mac built-in, enabling a truly portable computing experience that rivals my desktop setup?</p>
<p>This is hugely speculative, to be sure, but I suspect it is our best hope for Mac-like capabilities in a Vision Pro device: I just don’t think visionOS will ever be up to the job, no matter how much it evolves, because there are certain areas where Apple itself will not.</p>
<h3>An iPad Extraordinaire</h3>
<p>Here is the key thing to understand about all of the Vision Pro limitations I just articulated: they are not faults, but rather trade-offs, in the service of delivering a truly extraordinary entertainment experience.</p>
<p>Start with the hardware: contrary to most reviews, I didn’t find the Vision Pro uncomfortable, even with extended use. For me the Solo Knit band hugged the back of my head in a very pleasing way, such that I didn’t notice the weight of the device. What was striking to me was how frictionless it is to put the Vision Pro on, and you’re ready to go.</p>
<p>A big reason for this is the lack of controllers: while I was frustrated in “productivity mode” at the lack of direct manipulation that you get with, say, the Quest’s controllers, the ability to simply use my eyes<sup id="rf3-12278"><a href="#fn3-12278" title="My single favorite feature of Vision Pro is Optic ID: it works perfectly every time, without thought; you don’t need to perfectly place your (dry) finger like Touch ID, or hold your phone just so like Face ID. It’s completely seamless and very satisfying." rel="footnote">3</a></sup> and hands means that the distance from putting on the Vision Pro to watching a movie or TV show is surprisingly small. And, of course, a movie or TV show is a single app experience: here the trade-off for higher resolution screens at the cost of a narrower field of view is well worth it.</p>
<p>One challenge is the inability to use your phone. Now that may be, for some, an advantage (he says as he sheepishly admits to a phone-addled attention span): one of my favorite things about going to the theater is the fact that I’m much less tempted to even think about checking my notifications. That said, while passthrough is a technical marvel, and a massive differentiator over the Quest, you are still looking through a video screen, and that is never more apparent than when trying to read another screen: you can, if you squint, but it’s not particularly pleasant. There is already <a href="https://apps.apple.com/us/app/bezel-screen-broadcasting/id6476268685">an app in the App Store</a> that broadcasts your phone screen into the Vision Pro; here is a screenshot with me watching <a href="https://www.youtube.com/@SharpTechPodcast">the new Sharp Tech YouTube channel</a>:</p>
<p><a href="https://www.youtube.com/@SharpTechPodcast"><img loading="lazy" decoding="async" src="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-5.png?resize=640%2C360&amp;ssl=1" alt="Watching a YouTube video with my phone projected into the Vision Pro" width="640" height="360" srcset="https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-5.png?w=1280&amp;ssl=1 1280w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-5.png?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-5.png?resize=1024%2C576&amp;ssl=1 1024w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-5.png?resize=768%2C432&amp;ssl=1 768w, https://i0.wp.com/stratechery.com/wp-content/uploads/2024/02/apple-vision-pro-5.png?resize=1120%2C630&amp;ssl=1 1120w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1"></a></p>
<p>What I would like to see, though, is Apple drawing the iPhone screen in the Vision Pro onto the iPhone in your hand, which would make it much easier to interact with.</p>
<p>That aside, you’re really not going to think much about your phone once you are watching something: obviously the 3D experiences are incredible, and I can’t wait for sports to be filmed using Apple’s specialty cameras.<sup id="rf4-12278"><a href="#fn4-12278" title="I think this quote from NBA Commissioner Adam Silver <a href=&quot;https://www.sportico.com/business/media/2024/nba-apple-vision-pro-app-video-all-star-1234765290/&quot;>in Sportico</a> does miss the point, however:</p>
<blockquote><p>
  “This is in many ways better than sitting courtside,” Silver said Friday. “It can take you anywhere on the floor. It can give you the perspective of a player … This will, to me, be how people over time experience sports.”
</p></blockquote>
<p>Actually, no, I do want to sit courtside. It’s one of the most incredible experiences you can have as a fan. Moreover, you don’t even need any production: if I want the score, I can look up at the scoreboard; the announcer is the in-arena PA system. Don’t overthink this!" rel="footnote">4</a></sup> Even just having multiple games on at once, though, is a lot of fun, and movies are extremely immersive. My wife’s response summed up the experience perfectly: “Why would I ever go to a movie theater again?”</p>
<p>What is remarkable is that this stellar experience can be had anywhere: I might have to pick and choose between office and portable productivity, but there is no compromise when it comes to personal entertainment. The best device is the same device no matter where you are. This is what I mean when I say the Vision Pro is to the iPad as the iPod was to the Rio: the increase in fidelity and the overall experience is so vast as to constitute a step-change in functionality.</p>
<p>This is also where being private isn’t such a bad thing; there is a reason why Apple already has an ad about using the Vision Pro on an airplane:</p>

<p>This is a killer articulation of the fact that isolation is sometimes exactly what you need, even if it suffers from the tech industry affliction of assuming everyone flies regularly. Om Malik, in <a href="https://stratechery.com/2024/an-interview-with-om-malik-about-techs-history-and-future/#visionpro">a recent Stratechery Interview</a>, gave another compelling use case (and started me down the path of thinking about the iPod analogy):</p>
<blockquote><p>
  But the thing is you actually have to be mobile-native to actually appreciate something like this. So if you’ve grown up watching a 75-inch screen television, you probably would not really appreciate it as much. But if you are like me who’s been watching iPad for ten-plus years as my main video consumption device, this is the obvious next step. If you live in Asia, like you live in Taiwan, people don’t have big homes, they don’t have 85-inch screen televisions. Plus, you have six, seven, eight people living in the same house, they don’t get screen time to watch things so they watch everything on their phone. I think you see that behavior and you see this is going to be the iPod. The headphones, why is headphones selling all the time everywhere? It is because people want their moment of privacy and they want to be alone and they want to listen to their media in their way. I think that’s what Vision Pro excites me is it’s going to be a video consumption device.
</p></blockquote>
<p>This does resonate with me, both in theory and in practice: even while trying to figure out the productivity use case I relished the fact that those sitting near me couldn’t see me futzing about. To put it another way, isolation is just another word for privacy, and privacy is very nice to have.</p>
<p>There is, though, one problem with both of these examples: folks living in close proximity to others, or even flying in the back of a plane, may not have the wherewithal to spend $3,500 on a personal TV. Those that do are probably more likely to have a traditional home theater or fly in seats with a bit more privacy. That, though, is only a problem for now (and, I might note, a real opportunity for Meta’s significantly lower-priced Quest).</p>
<p>For me this will be my primary Vision Pro use case, if one exists. When I watch TV it is usually after my kids are asleep, and simply slipping the Vision Pro on on the couch and relaxing is very pleasant and more convenient that getting my AirPods and pairing them to the Apple TV connected to my very-much-not-a-home-theater TV. The couch use case also diminishes another big Vision Pro negative: the battery and its associated cord is very annoying and will, I suspect, lead to broken Vision Pros yanked down by a battery in someone’s pocket. This sort of moving around is also, I would note, much more common when you’re trying to be productive; the Vision Pro really isn’t built for that, quite literally. Maybe someday, but V1s have to make trade-offs, and Apple has, in every respect, optimized for the entertainment experience.</p>
<h3>The AR Vision</h3>
<p>My favorite Vision Pro review isn’t really a review at all: it’s Casey Neistat in, his ever entertaining way, reaching out to pull the future back to the present:</p>
<p><iframe loading="lazy" width="560" height="315" src="https://www.youtube-nocookie.com/embed/UvkgmyfMPks?si=rEkDtPFQv1z_LoV7" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe></p>
<p>I’ve focused till now on productivity (the use case I’m most excited about, which the Vision Pro does not deliver on) and entertainment (which the Vision Pro is clearly focused on, and excels at). However, Nilay Patel in his review at <a href="https://www.theverge.com/24054862/apple-vision-pro-review-vr-ar-headset-features-price">The Verge</a> reminded us that Apple CEO Tim Cook has never been a fan of virtual reality:</p>
<blockquote><p>
  See&nbsp;<em>this</em>&nbsp;thing — a passthrough VR headset with a silly external battery pack and a display that shows ghostly images of your eyes on the front — is not the big goal. The big goal is AR, or augmented reality. In particular, the big goal is&nbsp;<em>optical</em>&nbsp;AR, where light passes directly through unobtrusive glasses to your eyes, with digital information layered over the top of what you’re seeing. AR is a technology with the potential to literally change humanity, and Apple CEO Tim Cook has been talking about how isolating VR headsets are and how important he thinks AR will be for years now.</p>
<ul>
<li>Tim Cook,&nbsp;<a href="https://9to5mac.com/2016/10/02/tim-cook-talks-steve-jobs-need-for-encryption-at-utah-tech-tour-video/">2016</a>: “Few people are going to view that it’s acceptable to be enclosed in something.”</li>
<li>Tim Cook,&nbsp;<a href="https://www.independent.co.uk/life-style/gadgets-and-tech/features/apple-tim-cook-boss-brexit-uk-theresa-may-number-10-interview-ustwo-a7574086.html">2017</a>: “Unlike Virtual Reality which closes the world out, AR allows individuals to be present in the world.”</li>
<li>Tim Cook,&nbsp;<a href="https://www.bbc.com/news/technology-41590323">2017</a>: “I also like the fact that [AR] doesn’t isolate […] I’ve never been a fan of VR like that because I think it does the opposite.”</li>
<li>Tim Cook,&nbsp;<a href="https://www.siliconrepublic.com/machines/tim-cook-ar-war-ducks-healthtech">2020</a>: “I think [AR is] something that doesn’t isolate people. We can use it to enhance our discussion, not substitute it for human connection, which I’ve always deeply worried about in some of the other technologies.”</li>
</ul>
<p>  You get the idea.</p>
<p>  The problem is that the technology to build a true optical AR display that works well enough to replace an everyday computer just isn’t there yet. The Magic Leap 2 is an optical AR headset that’s&nbsp;<a href="https://www.theverge.com/2022/7/12/23205702/magic-leap-2-enterprise-release-price-shipping-date-mixed-reality-ar-headset">cheaper and smaller</a>&nbsp;than the Vision Pro, but it’s plagued by compromises in field of view and image quality that most people would never accept.</p>
<p>  So Apple’s settled for building a headset with real-time video passthrough — it is the defining tradeoff of the Vision Pro. It is a VR headset masquerading as an AR headset. And let me tell you: the video passthrough on the Vision Pro is&nbsp;<em>really good</em>. It works! It’s convincing. You put the headset on, the display comes on, and you’re right back where you were, only with a bunch of visionOS windows floating around.
</p></blockquote>
<p>As Patel notes, this is a tremendous engineering achievement; the problem, however, is that you are still watching video, not seeing the real world. Still, as Neistat and countless other show-offs on social media have demonstrated, you can very much function in the real world with the Vision Pro on, and I don’t think that’s an accident. VR is a destination device, like a TV or video game console or PC, while AR is an accompaniment device, like a phone. The latter is a larger market, simply because the number of opportunities to augment a user’s life are greater than the amount of time available in a zero sum battle for total attention, and it makes sense that to the extent Apple can build experiences beyond entertainment they are focused on building AR, even if for now it is simulated.</p>
<p>What is clear, though, is that Apple will need help: the biggest hole in not just the Vision Pro but also the Quest is software. I’ve already written about <a href="https://stratechery.com/2024/the-apple-vision-pros-missing-apps/">The Vision Pro’s Missing Apps</a>, but services like Netflix and YouTube are not what will create an AR future: for that developers need to take risks, which means they need to have the possibility of making money, and deep access to the hardware Apple (and Meta) has created. I do worry that our AR future is going to be so technically challenging that only the biggest companies can create the hardware necessary, even as they hold onto business models and developer limitations that prevent the emergence of high-risk high-investment yet platform-defining software applications.</p>
<h3>Guest Mode</h3>
<p>The other interesting aspect of those quotes Patel collected is that Cook’s emphasis on preserving the ability to interact with others really didn’t come across in last year’s Vision Pro announcement. I wrote in my Article:</p>
<blockquote><p>
  What was far more striking, though, was how the consumption of this video [of a father’s children] was presented in the keynote:</p>

<p>  Note the empty house: what happened to the kids? Indeed, Apple actually went back to this clip while summarizing the keynote, and the line “for reliving memories” struck me as incredibly sad:</p>

<p>  I’ll be honest: what this looked like to me was a divorced dad, alone at home with his Vision Pro, perhaps because his wife was irritated at the extent to which he got lost in his own virtual experience. That certainly puts a different spin on Apple’s proud declaration that the Vision Pro is “The Most Advanced Personal Electronics Device Ever”.</p>
<p>  <img loading="lazy" decoding="async" src="https://i0.wp.com/stratechery.com/wp-content/uploads/2023/06/vision-image-7.png?resize=640%2C377&amp;ssl=1" alt="The most personal electronics device ever" width="640" height="377" srcset="https://i0.wp.com/stratechery.com/wp-content/uploads/2023/06/vision-image-7.png?w=1280&amp;ssl=1 1280w, https://i0.wp.com/stratechery.com/wp-content/uploads/2023/06/vision-image-7.png?resize=300%2C176&amp;ssl=1 300w, https://i0.wp.com/stratechery.com/wp-content/uploads/2023/06/vision-image-7.png?resize=1024%2C602&amp;ssl=1 1024w, https://i0.wp.com/stratechery.com/wp-content/uploads/2023/06/vision-image-7.png?resize=768%2C452&amp;ssl=1 768w, https://i0.wp.com/stratechery.com/wp-content/uploads/2023/06/vision-image-7.png?resize=1071%2C630&amp;ssl=1 1071w" sizes="(max-width: 640px) 100vw, 640px" data-recalc-dims="1"></p>
<p>  Indeed, this, even more than the iPhone, is the true personal computer. Yes, there are affordances like mixed reality and EyeSight to interact with those around you, but at the end of the day the Vision Pro is a solitary experience.
</p></blockquote>
<p>It turns out that undersells it: the Vision Pro isn’t just experienced in isolation, it can only really be used by one person. Vision Pro, like all iOS-based devices, doesn’t support multiple user accounts (managed iPads, like in a school, are the exception). Apple, though, obviously wants people to be able to try the Vision Pro, so there is the option for a Guest User session. This is invoked through control center by the Vision Pro owner, who decides whether or not to allow access to their apps and data, and then has five minutes to remove their lenses (if necessary) and hand the Vision Pro to someone else.</p>
<p>This is already not great — you can’t, say, leave your Vision Pro at home or in a hotel room for a family member to use, because you’re not there to invoke a Guest User session — but it gets worse; from <a href="https://support.apple.com/en-us/117742">Apple’s support document</a>:</p>
<blockquote><p>
  When your guest puts on Apple Vision Pro, they might first be asked to press and hold the Digital Crown until the displays align and a green check mark appears. Then your guest will be asked to go through hand and eye setup so that Apple Vision Pro responds accurately to their input. When hand and eye setup are complete, your guest can begin using your Apple Vision Pro.</p>
<p>  When your guest is finished using Apple Vision Pro, they can simply take off the device to end the Guest User session. The next time you put on Apple Vision Pro, it returns automatically to your personal hand and eye settings.
</p></blockquote>
<p>This is very harsh in practice. For example, one friend lifted up the Vision Pro to rub their eyes; when they put the Vision Pro back on the Guest User session was wiped. I had to re-invoke a Guest User session (after re-inserting my lenses<sup id="rf5-12278"><a href="#fn5-12278" title="At this stage in my life, I much prefer wearing glasses (I can’t have LASIK surgery), so I need the Zeiss lens inserts; they are easy-to-use, but they do make the Vision Pro worse in my experience. First, eye-tracking worked much better without them, and second, bright scenes will induce reflections on the lenses that are very distracting. Moreover, if you stop using the lenses and switch to contacts, you have to re-do hand and eye calibration and re-setup Optic ID" rel="footnote">5</a></sup>), and then they had to run through the hand and eye calibration all over again. And then I had to do it again and again for the rest of my family.</p>
<p>What this means is that I felt like an absolute jerk. I spent $3500 on a device that only I can use, and it felt bad. I was selfish, even though I didn’t mean to be. It honestly put me in a bad mood, and made me regret my purchase (beyond, you know, the whole “this is my job” thing).</p>
<p>Again, I get that there are probably technical limitations to enabling persistent Guest User sessions. At the same time, it’s hard to not notice the incentives at play here: Apple makes money by selling devices, and it is very much in their interest that I solve this problem by buying more Vision Pros. That, though, may have been a reasonable expectation when it comes to a phone, even if it’s a bit shakier when it comes to an iPad. A $3,500 Vision Pro, though, goes too far in my opinion: Apple sells Macs for that much money, but they all support multiple users; there should be, at a minimum, the ability to enable a guest session for some set period of time, not just until they even temporarily remove the Vision Pro from their face.</p>
<p>In short, the Vision Pro might not have yet fully realized Cook’s goal of letting users be present in the real world; it’s unfortunate that it is currently so hostile at the prospect of having a shared experience with what is a remarkable device.</p>
<h3>Visions of the Future</h3>
<p>I’m generally annoyed by buy/don’t-buy recommendations from review sites: just tell me what the device is like, and I can make my own decision. That noted, one reason I did want to write this review is because I think the demo I had at WWDC — which, as I understand, is pretty close to the demo available at Apple Stores — was not ultimately representative of the use case I cared the most about for the reasons I laid out above.</p>
<p>Now, having used a Vision Pro of my own, I have to say that were I making a decision independent of my job, I would not buy a Vision Pro. I personally don’t watch that much TV or movies, and while I am a huge sports fan, there is not yet the sort of immersive content available that would make it worth it to me (but I’m hopeful!). Meanwhile, the productivity use cases simply didn’t materialize for me, although I am hopeful for the ability to project two monitors in a software update.</p>
<p>At the same time — and, to be sure, this applies to my job —&nbsp;I am happy to have one for what it says about the future. It is not just that the entertainment experience is extraordinary, but the fact that it is portable that is new (and not to beat a dead horse, is the exact sort of outcome I want for productivity). The AR possibilities hinted at by passthrough, meanwhile, are very compelling (I thought that <a href="https://www.wsj.com/video/series/joanna-stern-personal-technology/vision-pro-review-24-hours-in-apples-mixed-reality-headset/05CD2E77-897D-49A9-A87E-9B8A93E3E45F">Joanna Stern’s review</a> captured this well, particularly the cooking app).</p>
<p>I also, for what it’s worth, think that the Vision Pro is not the death knell for Meta’s VR efforts that so many think it is: the two visceral reactions I had to the Vision Pro were the “sitting down on the couch after a day at work and slipping it on” experience and the “wow it’s nice that my futzing around is private” experience; Meta, having made tradeoffs that favor a drastically lower price, is well-positioned to capture the latter, particularly for the use cases that Malik described. Make no mistake, video on the Vision Pro is better — resolution matters! — but it’s more than passable on the Quest, and better than a tablet or a phone. Controllers, meanwhile, make for a far better gaming experience, even if gaming as a whole is more of a destination activity than an augmented one.</p>
<p>What is most compelling about Meta, though, are <a href="https://stratechery.com/2024/meta-earnings-meta-ai-and-att-metas-new-playbook/">their investments in AI</a>. I believe that <a href="https://stratechery.com/2022/dall-e-the-metaverse-and-zero-marginal-content/">generative AI will be the key to unlocking the Metaverse</a>, and I suspect that Meta will achieve the capability necessary to deliver an infinite number of unique experiences before Apple will (if they even try). Meta, too, is focused on virtual connections as a matter of business (and <a href="https://stratechery.com/2021/enterprise-metaverses-horizon-workrooms-workrooms-facebook-problem/">I find their early efforts compelling</a>); I would expect the company to deliver a compelling “friend” experience in VR long before Apple (and I do, for the record, think their cartoonish approach to avatars is much better than Apple’s uncanny-valley-esque Personas).</p>
<p>In fact, I suspect there is room for both, and their respective market opportunities may follow the distinction I noted above between AR and VR: Apple has its eyes set on the real world, and Meta the virtual one; I just wish one of them would help me get my work done.</p>
<hr><ol><li id="fn1-12278"><p>You can disable it completely, which I have done for many people in my life&nbsp;<a href="#rf1-12278" title="Return to footnote 1.">↩</a></p></li><li id="fn2-12278"><p>Including my built-in display, which in this picture is 14″; the photo is old, but representative enough.&nbsp;<a href="#rf2-12278" title="Return to footnote 2.">↩</a></p></li><li id="fn3-12278"><p>My single favorite feature of Vision Pro is Optic ID: it works perfectly every time, without thought; you don’t need to perfectly place your (dry) finger like Touch ID, or hold your phone just so like Face ID. It’s completely seamless and very satisfying.&nbsp;<a href="#rf3-12278" title="Return to footnote 3.">↩</a></p></li><li id="fn4-12278"><p>I think this quote from NBA Commissioner Adam Silver <a href="https://www.sportico.com/business/media/2024/nba-apple-vision-pro-app-video-all-star-1234765290/">in Sportico</a> does miss the point, however:</p>
<blockquote><p>
  “This is in many ways better than sitting courtside,” Silver said Friday. “It can take you anywhere on the floor. It can give you the perspective of a player … This will, to me, be how people over time experience sports.”
</p></blockquote>
<p>Actually, no, I do want to sit courtside. It’s one of the most incredible experiences you can have as a fan. Moreover, you don’t even need any production: if I want the score, I can look up at the scoreboard; the announcer is the in-arena PA system. Don’t overthink this!&nbsp;<a href="#rf4-12278" title="Return to footnote 4.">↩</a></p></li><li id="fn5-12278"><p>At this stage in my life, I much prefer wearing glasses (I can’t have LASIK surgery), so I need the Zeiss lens inserts; they are easy-to-use, but they do make the Vision Pro worse in my experience. First, eye-tracking worked much better without them, and second, bright scenes will induce reflections on the lenses that are very distracting. Moreover, if you stop using the lenses and switch to contacts, you have to re-do hand and eye calibration and re-setup Optic ID&nbsp;<a href="#rf5-12278" title="Return to footnote 5.">↩</a></p></li></ol>
	</div><!-- .entry-content -->
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Prisoners in the US are part of a hidden workforce linked to popular food brands (195 pts)]]></title>
            <link>https://english.elpais.com/usa/2024-01-29/prisoners-in-the-us-are-part-of-a-hidden-workforce-linked-to-hundreds-of-popular-food-brands.html</link>
            <guid>39274128</guid>
            <pubDate>Tue, 06 Feb 2024 13:50:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://english.elpais.com/usa/2024-01-29/prisoners-in-the-us-are-part-of-a-hidden-workforce-linked-to-hundreds-of-popular-food-brands.html">https://english.elpais.com/usa/2024-01-29/prisoners-in-the-us-are-part-of-a-hidden-workforce-linked-to-hundreds-of-popular-food-brands.html</a>, See on <a href="https://news.ycombinator.com/item?id=39274128">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-dtm-region="articulo_cuerpo"><p>A hidden path to America’s dinner tables begins here, at an unlikely source – a former Southern slave plantation that is now the country’s largest maximum-security prison.</p><p>Unmarked trucks packed with prison-raised cattle roll out of the Louisiana State Penitentiary, where men are sentenced to hard labor and forced to work, for pennies an hour or sometimes nothing at all. After rumbling down a country road to an auction house, the cows are bought by a local rancher and then followed by The Associated Press another 600 miles to a Texas slaughterhouse that feeds into the supply chains of giants like McDonald’s, Walmart and Cargill.</p><p>Intricate, invisible webs, just like this one, link some of the world’s largest food companies and most popular brands to jobs performed by U.S. prisoners nationwide, according to a sweeping two-year AP investigation into<a href="https://english.elpais.com/international/2023-01-27/russia-plans-to-build-25-prisons-and-three-forced-labor-camps-in-occupied-areas-of-ukraine.html"> prison labor</a> that tied hundreds of millions of dollars’ worth of agricultural products to goods sold on the open market.</p><p>They are among America’s most <a href="https://english.elpais.com/usa/2023-08-15/advocates-sue-federal-government-for-failing-to-ban-imports-of-cocoa-harvested-by-children.html">vulnerable laborers</a>. If they refuse to work, some can jeopardize their chances of parole or face punishment like being sent to solitary confinement. They also are often excluded from protections guaranteed to almost all other full-time workers, even when they are seriously injured or killed on the job.</p><p>The goods these prisoners produce wind up in the supply chains of a dizzying array of products found in most American kitchens, from Frosted Flakes cereal and Ball Park hot dogs to Gold Medal flour, Coca-Cola and Riceland rice. They are on the shelves of virtually every supermarket in the country, including Kroger, Target, Aldi and Whole Foods. And some goods are exported, including to countries that have had products blocked from entering the U.S. for using forced or prison labor.</p><p>Many of the companies buying directly from prisons are violating their own policies against the use of such labor. But it’s completely legal, dating back largely to the need for labor to help rebuild the South’s shattered economy after the Civil War. Enshrined in the Constitution by the 13th Amendment, <a href="https://english.elpais.com/society/2023-01-03/the-dark-side-of-textiles-my-fingers-were-bleeding-but-they-forced-me-to-work.html">slavery</a> and involuntary servitude are banned – except as punishment for a crime.</p><p>That clause is currently being challenged on the federal level, and efforts to remove similar language from state constitutions are expected to reach the ballot in about a dozen states this year.</p><p>Some prisoners work on the same plantation soil where slaves harvested cotton, tobacco and sugarcane more than 150 years ago, with some present-day images looking eerily similar to the past. In Louisiana, which has one of the country’s highest incarceration rates, men working on the “farm line” still stoop over crops stretching far into the distance.</p><p>Willie Ingram picked everything from cotton to okra during his 51 years in the state penitentiary, better known as Angola.</p><p>During his time in the fields, he was overseen by armed guards on horseback and recalled seeing men, working with little or no water, passing out in triple-digit heat. Some days, he said, workers would throw their tools in the air to protest, despite knowing the potential consequences.</p><p>“They’d come, maybe four in the truck, shields over their face, billy clubs, and they’d beat you right there in the field. They beat you, handcuff you and beat you again,” said Ingram, who received a life sentence after pleading guilty to a crime he said he didn’t commit. He was told he would serve 10 ½ years and avoid a possible death penalty, but it wasn’t until 2021 that a sympathetic judge finally released him. He was 73.</p><p>The number of people behind bars in the United States started to soar in the 1970s just as Ingram entered the system, disproportionately hitting people of color. Now, with about 2 million people locked up, U.S. prison labor from all sectors has morphed into a multibillion-dollar empire, extending far beyond the classic images of prisoners stamping license plates, working on road crews or battling wildfires.</p><p>Though almost every state has some kind of farming program, agriculture represents only a small fraction of the overall prison workforce. Still, an analysis of data amassed by the AP from correctional facilities nationwide traced nearly $200 million worth of sales of farmed goods and livestock to businesses over the past six years – a conservative figure that does not include tens of millions more in sales to state and government entities. Much of the data provided was incomplete, though it was clear that the biggest revenues came from sprawling operations in the South and leasing out prisoners to companies.</p><p>Corrections officials and other proponents note that not all work is forced and that prison jobs save taxpayers money. For example, in some cases, the food produced is served in prison kitchens or donated to those in need outside. They also say workers are learning skills that can be used when they’re released and given a sense of purpose, which could help ward off repeat offenses. In some places, it allows prisoners to also shave time off their sentences. And the jobs provide a way to repay a debt to society, they say.</p><p>While most critics don’t believe all jobs should be eliminated, they say incarcerated people should be paid fairly, treated humanely and that all work should be voluntary. Some note that even when people get specialized training, like firefighting, their criminal records can make it almost impossible to get hired on the outside.</p><p>“They are largely uncompensated, they are being forced to work, and it’s unsafe. They also aren’t learning skills that will help them when they are released,” said law professor Andrea Armstrong, an expert on prison labor at Loyola University New Orleans. “It raises the question of why we are still forcing people to work in the fields.”</p><h3>A shadow workforce with few protections</h3><p>In addition to tapping a cheap, reliable workforce, companies sometimes get tax credits and other financial incentives. Incarcerated workers also typically aren’t covered by the most basic protections, including workers’ compensation and federal safety standards. In many cases, they cannot file official complaints about poor working conditions.</p><p>These prisoners often work in industries with severe labor shortages, doing some of the country’s dirtiest and most dangerous jobs.</p><p>The AP sifted through thousands of pages of documents and spoke to more than 80 current or formerly incarcerated people, including men and women convicted of crimes that ranged from murder to shoplifting, writing bad checks, theft or other illegal acts linked to drug use. Some were given long sentences for nonviolent offenses because they had previous convictions, while others were released after proving their innocence.</p><p>Reporters found people who were hurt or maimed on the job, and also interviewed women who were sexually harassed or abused, sometimes by their civilian supervisors or the correctional officers overseeing them. While it’s often nearly impossible for those involved in workplace accidents to sue, the AP examined dozens of cases that managed to make their way into the court system. Reporters also spoke to family members of prisoners who were killed.</p><p>One of those was Frank Dwayne Ellington, who was sentenced to life in prison with the possibility of parole after stealing a man’s wallet at gunpoint – a result of Alabama’s habitual offenders act. In 2017, Ellington, 33, was cleaning a machine near the chicken “kill line” in Ashland at Koch Foods – one of the country’s biggest poultry-processing companies – when its whirling teeth caught his arm and sucked him inside, crushing his skull. He died instantly.</p><p>During a yearslong legal battle, Koch Foods at first argued Ellington wasn’t technically an employee, and later said his family should be barred from filing for wrongful death because the company had paid his funeral expenses. The case eventually was settled under undisclosed terms. The Occupational Safety and Health Administration fined the company $19,500, saying workers had not been given proper training and that its machines had inadequate safety guards.</p><p>“It’s somebody’s child, it’s somebody’s dad, it’s somebody’s uncle, it’s somebody’s family,” said Ellington’s mother, Alishia Powell-Clark. “Yes, they did wrong, but they are paying for it.”</p><p>The AP found that U.S. prison labor is in the supply chains of goods being shipped all over the world via multinational companies, including to countries that have been slapped with import bans by Washington in recent years. For instance, the U.S. has blocked shipments of cotton coming from China, a top manufacturer of popular clothing brands, because it was produced by forced or prison labor. But crops harvested by U.S. prisoners have entered the supply chains of companies that export to China.</p><p>While prison labor seeps into the supply chains of some companies through third-party suppliers without them knowing, others buy direct. Mammoth commodity traders that are essential to feeding the globe like Cargill, Bunge, Louis Dreyfus, Archer Daniels Midland and Consolidated Grain and Barge – which together post annual revenues of more than $400 billion – have in recent years scooped up millions of dollars’ worth of soy, corn and wheat straight from prisons, which compete with local farmers.</p><p>The AP reached out for comment to the companies it identified as having connections to prison labor, but most did not respond.</p><p>Cargill acknowledged buying goods from prison farms in Tennessee, Arkansas and Ohio, saying they constituted only a small fraction of the company’s overall volume. It added that “we are now in the process of determining the appropriate remedial action.”</p><p>McDonald’s said it would investigate links to any such labor, while Archer Daniels Midland and General Mills, which produces Gold Medal flour, pointed to their policies in place restricting suppliers from using <a href="https://english.elpais.com/international/2023-10-24/forced-labor-concerns-prompt-us-lawmakers-to-demand-ban-on-seafood-from-two-chinese-provinces.html">forced labor</a>. Whole Foods responded flatly: “Whole Foods Market does not allow the use of prison labor in products sold at our stores.”</p><p>Bunge said it sold all facilities that were sourcing from correction departments in 2021, so they are “no longer part of Bunge’s footprint.”</p><p>Dairy Farmers of America, a cooperative that bills itself as the top supplier of raw milk worldwide, said that while it has been buying from correctional facilities, it now only has one “member dairy” at a prison, with most of that milk used inside.</p><p>To understand the business of prison labor and the complex movement of agricultural goods, the AP collected information from all 50 states, through public records requests and inquiries to corrections departments. Reporters also crisscrossed the country, following trucks transporting crops and livestock linked to prison work, and tailed transport vans from prisons and work-release sites heading to places such as poultry plants, egg farms and fast-food restaurants. A lack of transparency and, at times, baffling losses exposed in audits, added to the challenges of fully tracking the money.</p><p>Big-ticket items like row crops and livestock are sold on the open market, with profits fed back into agriculture programs. For instance, about a dozen state prison farms, including operations in Texas, Virginia, Kentucky and Montana, have sold more than $60 million worth of cattle since 2018.</p><p>As with other sales, the custody of cows can take a serpentine route. Because they often are sold online at auction houses or to stockyards, it can be almost impossible to determine where the beef eventually ends up.</p><p>Sometimes there’s only one way to know for sure. In Louisiana, an AP reporter watched as three long trailers loaded with more than 80 cattle left the state penitentiary. The cows raised by prisoners traveled for about an hour before being unloaded for sale at Dominique’s Livestock Market in Baton Rouge.</p><p>As they were shoved through a gate into a viewing pen, the auctioneer jokingly warned buyers “Watch out!” The cows, he said, had just broken out of prison.</p><p>Within minutes, the Angola lot was snapped up by a local livestock dealer, who then sold the cattle to a Texas beef processor that also buys cows directly from prisons in that state. Meat from the slaughterhouse winds up in the supply chains of some of the country’s biggest fast-food chains, supermarkets and meat exporters, including Burger King, Sam’s Club and Tyson Foods.</p><p>“It’s a real slap in the face, to hear where all those cattle are going,” said Jermaine Hudson, who served 22 years at Angola on a robbery conviction before he was exonerated.</p><p>He said it’s especially galling because the food served in prison tasted like slop. “Those were some of the most disrespectful meals,” Hudson said, “that I ever, in my life, had to endure.”</p><h3>The rise of prison labor</h3><p>Angola is imposing in its sheer scale. The so-called “Alcatraz of the South” is tucked far away, surrounded by crocodile-infested swamps in a bend of the Mississippi River. It spans 18,000 acres – an area bigger than the island of Manhattan – and has its own ZIP code.</p><p>The former 19th-century antebellum plantation once was owned by one of the largest slave traders in the U.S. Today, it houses some 3,800 men behind its razor-wire walls, about 65 percent of them Black. Within days of arrival, they typically head to the fields, sometimes using hoes and shovels or picking crops by hand. They initially work for free, but then can earn between 2 cents and 40 cents an hour.</p><p>Calvin Thomas, who spent more than 17 years at Angola, said anyone who refused to work, didn’t produce enough or just stepped outside the long straight rows knew there would be consequences.</p><p>“If he shoots the gun in the air because you done passed that line, that means you’re going to get locked up and you’re going to have to pay for that bullet that he shot,” said Thomas, adding that some days were so blistering hot the guards’ horses would collapse. “You can’t call it anything else,” he said. “<a href="https://english.elpais.com/usa/2023-09-22/the-emancipation-proclamation-the-first-step-towards-the-end-of-slavery-in-the-us.html">It’s just slavery.”</a></p><p>Louisiana corrections spokesman Ken Pastorick called that description “absurd.” He said the phrase “sentenced with hard labor” is a legal term referring to a prisoner with a felony conviction.</p><p>Pastorick said the department has transformed Angola from “the bloodiest prison in America” over the past several decades with “large-scale criminal justice reforms and reinvestment into the creation of rehabilitation, vocational and educational programs designed to help individuals better themselves and successfully return to communities.” He noted that pay rates are set by state statute.</p><p>Current and former prisoners in both Louisiana and Alabama have filed class-action lawsuits in the past four months saying they have been forced to provide cheap – or free – labor to those states and outside companies, a practice they also described as slavery.</p><p>Prisoners have been made to work since before emancipation, when slaves were at times imprisoned and then leased out by local authorities.</p><p>But after the Civil War, the 13th Amendment’s exception clause that allows for prison labor provided legal cover to round up thousands of mostly young Black men. Many were jailed for petty offenses like loitering and vagrancy. They then were leased out by states to plantations like Angola and some of the country’s biggest companies, including coal mines and railroads. They were routinely whipped for not meeting quotas while doing brutal and often deadly work.</p><p>The convict-leasing period, which officially ended in 1928, helped chart the path to America’s modern-day prison-industrial complex.</p><p>Incarceration was used not just for punishment or rehabilitation but for profit. A law passed a few years later made it illegal to knowingly transport or sell goods made by incarcerated workers across state lines, though an exception was made for agricultural products. Today, after years of efforts by lawmakers and businesses, corporations are setting up joint ventures with corrections agencies, enabling them to sell almost anything nationwide.</p><p>Civilian workers are guaranteed basic rights and protections by OSHA and laws like the Fair Labor Standards Act, but prisoners, who are often not legally considered employees, are denied many of those entitlements and cannot protest or form unions.</p><p>“They may be doing the exact same work as people who are not incarcerated, but they don’t have the training, they don’t have the experience, they don’t have the protective equipment,” said Jennifer Turner, lead author of a 2022 American Civil Liberties Union report on prison labor.</p><p>Almost all of the country’s state and federal adult prisons have some sort of work program, employing around 800,000 people, the report said. It noted the vast majority of those jobs are connected to tasks like maintaining prisons, laundry or kitchen work, which typically pay a few cents an hour if anything at all. And the few who land the highest-paying state industry jobs may earn only a dollar an hour.</p><p>Altogether, labor tied specifically to goods and services produced through state prison industries brought in more than $2 billion in 2021, the ACLU report said. That includes everything from making mattresses to solar panels, but does not account for work-release and other programs run through local jails, detention and immigration centers and even drug and alcohol rehabilitation facilities.</p><p>Some incarcerated workers with just a few months or years left on their sentences have been employed everywhere from popular restaurant chains like Burger King to major retail stores and meat-processing plants. Unlike work crews picking up litter in orange jumpsuits, they go largely unnoticed, often wearing the same uniforms as their civilian counterparts.</p><p>Outside jobs can be coveted because they typically pay more and some states deposit a small percentage earned into a savings account for prisoners’ eventual release. Though many companies pay minimum wage, some states garnish more than half their salaries for items such as room and board and court fees.</p><p>It’s a different story for those on prison farms. The biggest operations remain in the South and crops are still harvested on a number of former slave plantations, including in Arkansas, Texas and at Mississippi’s notorious Parchman Farm. Those states, along with Florida, Alabama, South Carolina and Georgia, pay nothing for most types of work.</p><p>Most big farms, including Angola, have largely mechanized many of their operations, using commercial-size tractors, trucks and combines for corn, soy, rice and other row crops. But prisoners in some places continue to do other work by hand, including clearing brush with swing blades.</p><p>“I was in a field with a hoe in my hand with maybe like a hundred other women. We were standing in a line very closely together, and we had to raise our hoes up at the exact same time and count ‘One, two, three, chop!’” said Faye Jacobs, who worked on prison farms in Arkansas.</p><p>Jacobs, who was released in 2018 after more than 26 years, said the only pay she received was two rolls of toilet paper a week, toothpaste and a few menstrual pads each month.</p><p>She recounted being made to carry rocks from one end of a field to the other and back again for hours, and said she also endured taunting from guards saying “Come on, hos, it’s hoe squad!” She said she later was sent back to the fields at another prison after women there complained of sexual harassment by staff inside the facility.</p><p>“We were like ‘Is this a punishment?’” she said. “‘We’re telling y’all that we’re being sexually harassed, and you come back and the first thing you want to do is just put us all on hoe squad.’”</p><p>David Farabough, who oversees the state’s 20,000 acres of prison farms, said Arkansas’ operations can help build character.</p><p>“A lot of these guys come from homes where they’ve never understood work and they’ve never understood the feeling at the end of the day for a job well-done,” he said. “We’re giving them purpose. … And then at the end of the day, they get the return by having better food in the kitchens.”</p><p>In addition to giant farms, at least 650 correctional facilities nationwide have prisoners doing jobs like landscaping, tending greenhouses and gardens, raising livestock, beekeeping and even fish farming, said Joshua Sbicca, director of the Prison Agriculture Lab at Colorado State University. He noted that corrections officials exert power by deciding who deserves trade-building jobs like welding, for example, and who works in the fields.</p><p>In several states, along with raising chickens, cows and hogs, corrections departments have their own processing plants, dairies and canneries. But many states also hire out prisoners to do that same work at big private companies.</p><p>The AP met women in Mississippi locked up at restitution centers, the equivalent of debtors’ prisons, to pay off court-mandated expenses. They worked at Popeyes Louisiana Kitchen and other fast-food chains and also have been hired out to individuals for work like lawn mowing or home repairs.</p><p>“There is nothing innovative or interesting about this system of forced labor as punishment for what in so many instances is an issue of poverty or substance abuse,” said Cliff Johnson, director of the MacArthur Justice Center at the University of Mississippi.</p><p>In Alabama, where prisoners are leased out by companies, AP reporters followed inmate transport vans to poultry plants run by Tyson Foods, which owns brands such as Hillshire Farms, Jimmy Dean and Sara Lee, along with a company that supplies beef, chicken and fish to McDonald’s. The vans also stopped at a chicken processor that’s part of a joint-venture with Cargill, which is America’s largest private company. It brought in a record $177 billion in revenue in fiscal year 2023 and supplies conglomerates like PepsiCo.</p><p>Though Tyson did not respond to questions about direct links to prison farms, it said that its work-release programs are voluntary and that incarcerated workers receive the same pay as their civilian colleagues.</p><p>Some people arrested in Alabama are put to work even before they’ve been convicted. An unusual work-release program accepts pre-trial defendants, allowing them to avoid jail while earning bond money. But with multiple fees deducted from their salaries, that can take time.</p><p>The AP went out on a work detail with a Florida chain gang wearing black-and-white striped uniforms and ankle shackles, created after Brevard County Sheriff Wayne Ivey took office in 2012. He said the unpaid work is voluntary and so popular that it has a waitlist.</p><p>“It’s a win-win,” he said. “The inmate that’s doing that is learning a skill set. … They are making time go by at a faster pace. The other side of the win-win is, it’s generally saving the taxpayers money.”</p><p>Ivey noted it’s one of the only remaining places in the country where a chain gang still operates. “I don’t feel like they should get paid,” he said. “They’re paying back their debt to society for violating the law.”</p><p>Elsewhere, several former prisoners spoke positively about their work experiences, even if they sometimes felt exploited.</p><p>“I didn’t really think about it until I got out, and I was like, ‘Wow, you know, I actually took something from there and applied it out here,’” said William “Buck” Saunders, adding he got certified to operate a forklift at his job stacking animal feed at Cargill while incarcerated in Arizona.</p><p>Companies that hire prisoners get a reliable, plentiful workforce even during unprecedented labor shortages stemming from immigration crackdowns and, more recently, the coronavirus pandemic.</p><p>In March 2020, though all other outside company jobs were halted, the Arizona corrections department announced about 140 women were being abruptly moved from their prison to a metal hangar-like warehouse on property owned by Hickman’s Family Farms, which pitches itself as the Southwest’s largest egg producer.</p><p>Hickman’s has employed prisoners for nearly 30 years and supplies many grocery stores, including Costco and Kroger, marketing brands such as Eggland’s Best and Land O’Lakes. It is the state corrections department’s largest labor contractor, bringing in nearly $35 million in revenue over the past six fiscal years.</p><p>“The only reason they had us out there was because they didn’t want to lose that contract because the prison makes so much money off of it,” said Brooke Counts, who lived at Hickman’s desert site, which operated for 14 months. She was serving a drug-related sentence and said she feared losing privileges or being transferred to a more secure prison yard if she refused to work.</p><p>Counts said she knew prisoners who were seriously hurt, including one woman who was impaled in the groin and required a helicopter flight to the hospital and another who lost part of a finger.</p><p>Hickman’s, which has faced a number of lawsuits stemming from inmate injuries, did not respond to emailed questions or phone messages seeking a response. Corrections department officials would not comment on why the women were moved off-site, saying it happened during a previous administration. But a statement at the time said the move was made to “ensure a stable food supply while also protecting public health and the health of those in our custody.”</p><p>Some women employed by Hickman’s earned less than $3 an hour after deductions, including 30 percent taken by the state for room and board, even though they were living in the makeshift dormitory.</p><p>“While we were out there, we were still paying the prison rent,” Counts said. “What for?”</p><h3>Following the money</h3><p>The business of prison labor is so vast and convoluted that tracing the money can be challenging. Some agricultural programs regularly go into the red, raising questions in state audits and prompting investigations into potential corruption, mismanagement or general inefficiency.</p><p>Nearly half the agricultural goods produced in Texas between 2014 and 2018 lost money, for example, and a similar report in Louisiana uncovered losses of around $3.8 million between fiscal years 2016 and 2018. A separate federal investigation into graft at the for-profit arm of Louisiana’s correctional department led to the jailing of two employees.</p><p>Correctional officials say steep farming expenditures and unpredictable variables like weather can eat into profits. And while some goods may do poorly, they note, others do well.</p><p>Prisons at times have generated revenue by tapping into niche markets or to their states’ signature foods.</p><p>During the six-year period the AP examined, surplus raw milk from a Wisconsin prison dairy went to BelGioioso Cheese, which makes Polly-O string cheese and other products that land in grocery stores nationwide like Whole Foods. A California prison provided almonds to Minturn Nut Company, a major producer and exporter. And until 2022, Colorado was raising water buffalo for milk that was sold to giant mozzarella cheesemaker Leprino Foods, which supplies major pizza companies like Domino’s, Pizza Hut and Papa John’s.</p><p>But for many states, it’s the work-release programs that have become the biggest cash generators, largely because of the low overhead. In Alabama, for instance, the state brought in more than $32 million in the past five fiscal years after garnishing 40 percent of prisoners’ wages.</p><p>In some states, work-release programs are run on the local level, with sheriffs frequently responsible for handling the books and awarding contracts. Even though the programs are widely praised – by the state, employers and often prisoners themselves – reports of abuse exist.</p><p>In Louisiana, where more than 1,200 companies hire prisoners through work release, sheriffs get anywhere from about $10 to $20 a day for each state prisoner they house in local jails to help ease overcrowding. And they can deduct more than half of the wages earned by those contracted out to companies – a huge revenue stream for small counties.</p><p>Jack Strain, a former longtime sheriff in the state’s St. Tammany Parish, pleaded guilty in 2021 in a scheme involving the privatization of a work-release program in which nearly $1.4 million was taken in and steered to Strain, close associates and family members. He was sentenced to 10 years in prison, which came on top of four consecutive life sentences for a broader sex scandal linked to that same program.</p><p>Incarcerated people also have been contracted to companies that partner with prisons. In Idaho, they’ve sorted and packed the state’s famous potatoes, which are exported and sold to companies nationwide. In Kansas, they’ve been employed at Russell Stover chocolates and Cal-Maine Foods, the country’s largest egg producer. Though the company has since stopped using them, in recent years they were hired in Arizona by Taylor Farms, which sells salad kits in many major grocery stores nationwide and supplies popular fast-food chains and restaurants like Chipotle Mexican Grill.</p><p>Some states would not provide the names of companies taking part in transitional prison work programs, citing security concerns. So AP reporters confirmed some prisoners’ private employers with officials running operations on the ground and also followed inmate transport vehicles as they zigzagged through cities and drove down country roads. The vans stopped everywhere from giant meat-processing plants to a chicken and daiquiri restaurant.</p><p>One pulled into the manicured grounds of a former slave plantation that has been transformed into a popular tourist site and hotel in St. Francisville, Louisiana, where visitors pose for wedding photos under old live oaks draped with Spanish moss.</p><p>As a reporter watched, a West Feliciana Parish van emblazoned with “Sheriff Transitional Work Program” pulled up. Two Black men hopped out and quickly walked through the restaurant’s back door. One said he was there to wash dishes before his boss called him back inside.</p><p>The Myrtles, as the antebellum home is known, sits just 20 miles away from where men toil in the fields of Angola.</p><p>“Slavery has not been abolished,” said Curtis Davis, who spent more than 25 years at the penitentiary and is now fighting to change state laws that allow for forced labor in prisons. “It is still operating in present tense,” he said. “Nothing has changed.”</p><p><a href="https://plus.elpais.com/newsletters/lnp/1/333/?lang=en"><i>Sign up</i></a><i> for our weekly newsletter to get more English-language news coverage from EL PAÍS USA Edition</i></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[NetBox.dev: the source of truth for everything on your network (193 pts)]]></title>
            <link>https://netbox.dev/</link>
            <guid>39274125</guid>
            <pubDate>Tue, 06 Feb 2024 13:49:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://netbox.dev/">https://netbox.dev/</a>, See on <a href="https://news.ycombinator.com/item?id=39274125">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

    <article>
        <div>

                    <article>
                        
                            <section><p>NetBox v3.7.2 is <a href="https://github.com/netbox-community/netbox/releases/tag/v3.7.2">now available</a>!</p>
<h3>Enhancements</h3>
<ul>
<li><a href="https://github.com/netbox-community/netbox/issues/13729">#13729</a> - Omit sensitive data source parameters from change log data</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14645">#14645</a> - Limit the number of assigned IP addresses displayed under interfaces list</li>
</ul>
<h3>Bug Fixes</h3>
<ul>
<li><a href="https://github.com/netbox-community/netbox/issues/14500">#14500</a> - Optimize calculation of available child prefixes &amp; ranges when viewing a prefix</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14511">#14511</a> - Fix GraphQL support for interfaces connected to provider networks</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14572">#14572</a> - Correct the number of jobs listed for individual report &amp; script modules</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14703">#14703</a> - Revert to the default layout when encountering a misconfigured dashboard</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14755">#14755</a> - Fix validation of choice values &amp; labels when creating a custom field choice set via the REST API</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14838">#14838</a> - Avoid corrupting JSON data when changing the action type while editing an event rule</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14839">#14839</a> - Fix form validation error when attempting to terminate a tunnel to a virtual machine interface</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14840">#14840</a> - Fix <code>NoReverseMatch</code> exception when rendering a custom field which references a user</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14847">#14847</a> - IKE policy mode may be set inly when IKEv1 is selected</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14851">#14851</a> - Automatically remove any associated bookmarks when deleting a user</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14879">#14879</a> - Include custom fields in REST API representation of data sources</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14885">#14885</a> - Add missing "group" field to VPN tunnel creation form</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14892">#14892</a> - Fix exception when running report/script via command line due to missing username</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14920">#14920</a> - Include button to display available status choices when bulk importing virtual device contexts</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14945">#14945</a> - Fix "select all" button for device type components</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14947">#14947</a> - Ensure that application &amp; removal of tags is always recorded in an object's change log</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14962">#14962</a> - Fix config context rendering for VMs assigned directly to a site (rather than via a cluster)</li>
<li><a href="https://github.com/netbox-community/netbox/issues/14999">#14999</a> - Fix "create &amp; add another" link for interface FHRP group assignment</li>
<li><a href="https://github.com/netbox-community/netbox/issues/15015">#15015</a> - Pre-populate assigned tenant when allocating next available IP address under prefix view</li>
<li><a href="https://github.com/netbox-community/netbox/issues/15020">#15020</a> - Automatically update all VMs when changing a cluster's assigned site</li>
<li><a href="https://github.com/netbox-community/netbox/issues/15025">#15025</a> - The <code>can_add()</code> template filter should accept a model (not an instance)</li>
</ul></section>
                        
                    </article>

                    

                    <h2>Older Posts</h2>
                    <p>
                    
                        
                            <a href="https://netbox.dev/blog/posts/netbox-v372-released/">NetBox v3.7.2 Released</a> - (Feb. 5, 2024)<br>
                        
                    
                        
                            <a href="https://netbox.dev/blog/posts/netbox-v371-released/">NetBox v3.7.1 Released</a> - (Jan. 17, 2024)<br>
                        
                    
                        
                            <a href="https://netbox.dev/blog/posts/netbox-v370-released/">NetBox v3.7.0 Released</a> - (Dec. 29, 2023)<br>
                        
                    
                        
                            <a href="https://netbox.dev/blog/posts/netbox-v369-released/">NetBox v3.6.9 Released</a> - (Dec. 28, 2023)<br>
                        
                    
                        
                            <a href="https://netbox.dev/blog/posts/netbox-v368-released/">NetBox v3.6.8 Released</a> - (Dec. 27, 2023)<br>
                        
                    
                    </p>

                </div>
    </article>

    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Write a Letter to Your Future Self (160 pts)]]></title>
            <link>https://www.futureme.org/</link>
            <guid>39274004</guid>
            <pubDate>Tue, 06 Feb 2024 13:34:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.futureme.org/">https://www.futureme.org/</a>, See on <a href="https://news.ycombinator.com/item?id=39274004">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="ideas_modal">
    <header>
      <p>Future Letter Ideas!</p>
      <a aria-label="close" onclick="$(&quot;#ideas_modal&quot;).removeClass(&quot;is-open&quot;); $(&quot;#letter_body&quot;).focus(); return false;"></a>
    </header>
    <section>
      <p>
        Hi there! Writing a letter to the future can be a powerful experience. And receiving a surprise letter from the past can be an even more powerful experience. Check out the testimonials <a target="_new" href="https://www.futureme.org/props">all of the people who agree!</a>.
      </p>
      <div><p>
        Here are some ideas for a future letter:
        </p><ol type="1">
          <li>To your next birthday (obviously!)</li>
          <li>To a date by which you predict we are "back to normal" and recovered from the Covid-19 pandemic. What did we learn?</li>
          <li>Uma data que você atingiu um objetivo importante (Se formou? Se casou? Aposentou!)</li>
          <li>Write a story in present tense about your life in 5 years ("You are sipping coffee in your new home...") and paint a picture of your future self's day.</li>
          <li>To yourself, when you will be your parents age.</li>
          <li>To your kids, when they will be your age. Or to the age when you think you will have kids.</li>
          <li>To your spouse/partner, on your 10th (20th? 50th?) anniversary (you must create an account first to write to someone else!)</li>
          <li>To the year 2030, when the IPCC says we must hit Greenhouse Gas Reduction goals to keep Global Warming below 1.5 degrees celsius.</li>
          <li>To yourself, while you're on your next vacation.</li>
          <li>...Or...while on vacation, to yourself when you've back "to the grind."</li>
        </ol><p>
        Do you have an idea for a letter topic? Share it with <a href="https://www.twitter.com/futureme">@futureme on Twitter!</a>
      </p></div>
    </section>
    
  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[PostgreSQL is enough (343 pts)]]></title>
            <link>https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb</link>
            <guid>39273954</guid>
            <pubDate>Tue, 06 Feb 2024 13:28:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb">https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb</a>, See on <a href="https://news.ycombinator.com/item?id=39273954">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
    
  

<div>
  <div>
      <p><a data-hovercard-type="user" data-hovercard-url="/users/cpursley/hovercard" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="https://gist.github.com/cpursley"><img src="https://avatars.githubusercontent.com/u/1223773?s=64&amp;v=4" width="32" height="32" alt="@cpursley"></a>
      </p>
      
    </div>

  <ul>



      <li>
          <a id="gist-star-button-count" href="https://gist.github.com/login?return_to=https%3A%2F%2Fgist.github.com%2Fcpursley%2Fc8fb81fe8a7e5df038158bdfe0f06dbb" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist star button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="f33ae6740decd55d0247778ab9d3c57c5e04bd18fd8ad90a7e91f4ec6b956b89" data-view-component="true">  <span>
      <span>
        
      </span>
    <span>Star</span>
      <span>
        <span title="132" data-view-component="true">132</span>
      </span>
  </span>
</a><tool-tip id="tooltip-3fb8c457-d86d-4885-9c5e-015af88ad9ea" for="gist-star-button-count" popover="manual" data-direction="n" data-type="description" data-view-component="true">You must be signed in to star a gist</tool-tip>

      </li>

        <li>
            <a id="gist-fork-button" href="https://gist.github.com/login?return_to=https%3A%2F%2Fgist.github.com%2Fcpursley%2Fc8fb81fe8a7e5df038158bdfe0f06dbb" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist fork button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="1c843e33ea868895c0cbfec380e36ebdb001a3774c1da8b3d3fe7726aba78288" data-view-component="true">  <span>
      <span>
        
      </span>
    <span>Fork</span>
      <span>
        <span title="10" data-view-component="true">10</span>
      </span>
  </span>
</a><tool-tip id="tooltip-6bfd51aa-75be-4839-8876-92564b76115c" for="gist-fork-button" popover="manual" data-direction="n" data-type="description" data-view-component="true">You must be signed in to fork a gist</tool-tip>

        </li>
  </ul>
</div>

  <div>
      <p><a id="gist-star-button-no-count" href="https://gist.github.com/login?return_to=https%3A%2F%2Fgist.github.com%2Fcpursley%2Fc8fb81fe8a7e5df038158bdfe0f06dbb" rel="nofollow" data-hydro-click="{&quot;event_type&quot;:&quot;authentication.click&quot;,&quot;payload&quot;:{&quot;location_in_page&quot;:&quot;gist star button&quot;,&quot;repository_id&quot;:null,&quot;auth_type&quot;:&quot;LOG_IN&quot;,&quot;originating_url&quot;:&quot;https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="f33ae6740decd55d0247778ab9d3c57c5e04bd18fd8ad90a7e91f4ec6b956b89" data-view-component="true">  <span>
      <span>
        
      </span>
    <span>Star</span>
  </span>
</a></p><tool-tip id="tooltip-152ea89a-c0b2-481d-b903-82cb101adb1a" for="gist-star-button-no-count" popover="manual" data-direction="n" data-type="description" data-view-component="true">You must be signed in to star a gist</tool-tip>

  </div>

<div data-multiple="">

    <div data-view-component="true">
  <action-menu data-menu-input="gist-share-url" data-select-variant="single" data-dynamic-label="" data-view-component="true">
  <focus-group direction="vertical" mnemonics="" retain="">
    


  </focus-group>
</action-menu>    <primer-text-field>
      <label for="gist-share-url">
        Clone this repository at &amp;lt;script src=&amp;quot;https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
</label>    
  
      
    
</primer-text-field>
  <clipboard-copy id="clipboard-button" aria-label="Copy" for="gist-share-url" data-hydro-click="{&quot;event_type&quot;:&quot;clone_or_download.click&quot;,&quot;payload&quot;:{&quot;feature_clicked&quot;:&quot;COPY_URL&quot;,&quot;git_repository_type&quot;:&quot;GIST&quot;,&quot;gist_id&quot;:124177998,&quot;originating_url&quot;:&quot;https://gist.github.com/cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb&quot;,&quot;user_id&quot;:null}}" data-hydro-click-hmac="2b6b58b37cb1b078fd6ed83fa3dd7895477f941ed3eaa75bf4c3d052bfb99e42" type="button" data-view-component="true">
    
    
</clipboard-copy>

</div>

      <tool-tip id="tooltip-c9dfa042-3ae4-4184-8f84-091f39db4e0d" for="icon-button-c42a207d-3b68-4762-b6f3-eab9d7f9b27d" popover="manual" data-direction="s" data-type="label" data-view-component="true">Save cpursley/c8fb81fe8a7e5df038158bdfe0f06dbb to your computer and use it in GitHub Desktop.</tool-tip>



    
  </div>


  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Command Line Interface Guidelines (293 pts)]]></title>
            <link>https://clig.dev/</link>
            <guid>39273932</guid>
            <pubDate>Tue, 06 Feb 2024 13:25:34 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://clig.dev/">https://clig.dev/</a>, See on <a href="https://news.ycombinator.com/item?id=39273932">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        
<p>An <a href="https://github.com/cli-guidelines/cli-guidelines">open-source</a> guide to help you write better command-line programs, taking traditional UNIX principles and updating them for the modern day.</p>

<p><strong>Aanand Prasad</strong><br>
Engineer at Squarespace, co-creator of Docker Compose.<br>
<a href="https://twitter.com/aanandprasad">@aanandprasad</a></p>
<p><strong>Ben Firshman</strong><br>
Co-creator <a href="https://replicate.ai/">Replicate</a>, co-creator of Docker Compose.<br>
<a href="https://twitter.com/bfirsh">@bfirsh</a></p>
<p><strong>Carl Tashian</strong><br>
Developer Advocate at <a href="https://smallstep.com/">Smallstep</a>, first engineer at Zipcar, co-founder Trove.<br>
<a href="https://tashian.com/">tashian.com</a> <a href="https://twitter.com/tashian">@tashian</a></p>
<p><strong>Eva Parish</strong><br>
Technical Writer at Squarespace, O’Reilly contributor.<br>
<a href="https://evaparish.com/">evaparish.com</a> <a href="https://twitter.com/evpari">@evpari</a></p>
<p>Design by <a href="https://mhurrell.co.uk/">Mark Hurrell</a>. Thanks to Andreas Jansson for early contributions, and Andrew Reitz, Ashley Williams, Brendan Falk, Chester Ramey, Dj Walker-Morgan, Jacob Maine, James Coglan, Michael Dwan, and Steve Klabnik for reviewing drafts.</p>

<p><a href="https://discord.gg/EbAW5rUCkE">Join us on Discord</a> if you want to discuss the guide or CLI design.</p>
<h2 id="foreword">Foreword</h2>
<p>In the 1980s, if you wanted a personal computer to do something for you, you needed to know what to type when confronted with <code>C:\&gt;</code> or <code>~$</code>.
Help came in the form of thick, spiral-bound manuals.
Error messages were opaque.
There was no Stack Overflow to save you.
But if you were lucky enough to have internet access, you could get help from Usenet—an early internet community filled with other people who were just as frustrated as you were.
They could either help you solve your problem, or at least provide some moral support and camaraderie.</p>
<p>Forty years later, computers have become so much more accessible to everyone, often at the expense of low-level end user control.
On many devices, there is no command-line access at all, in part because it goes against the corporate interests of walled gardens and app stores.</p>
<p>Most people today don’t know what the command line is, much less why they would want to bother with it.
As computing pioneer Alan Kay said in <a href="https://www.fastcompany.com/40435064/what-alan-kay-thinks-about-the-iphone-and-technology-now">a 2017 interview</a>, “Because people don’t understand what computing is about, they think they have it in the iPhone, and that illusion is as bad as the illusion that ‘Guitar Hero’ is the same as a real guitar.”</p>
<p>Kay’s “real guitar” isn’t the CLI—not exactly.
He was talking about ways of programming computers that offer the power of the CLI and that transcend writing software in text files.
There is a belief among Kay’s disciples that we need to break out of a text-based local maximum that we’ve been living in for decades.</p>
<p>It’s exciting to imagine a future where we program computers very differently.
Even today, spreadsheets are by far the most popular programming language, and the no-code movement is taking off quickly as it attempts to replace some of the intense demand for talented programmers.</p>
<p>Yet with its creaky, decades-old constraints and inexplicable quirks, the command line is still the most <em>versatile</em> corner of the computer.
It lets you pull back the curtain, see what’s really going on, and creatively interact with the machine at a level of sophistication and depth that GUIs cannot afford.
It’s available on almost any laptop, for anyone who wants to learn it.
It can be used interactively, or it can be automated.
And, it doesn’t change as fast as other parts of the system.
There is creative value in its stability.</p>
<p>So, while we still have it, we should try to maximize its utility and accessibility.</p>
<p>A lot has changed about how we program computers since those early days.
The command line of the past was <em>machine-first</em>: little more than a REPL on top of a scripting platform.
But as general-purpose interpreted languages have flourished, the role of the shell script has shrunk.
Today’s command line is <em>human-first</em>: a text-based UI that affords access to all kinds of tools, systems and platforms.
In the past, the editor was inside the terminal—today, the terminal is just as often a feature of the editor.
And there’s been a proliferation of <code>git</code>-like multi-tool commands.
Commands within commands, and high-level commands that perform entire workflows rather than atomic functions.</p>
<p>Inspired by traditional UNIX philosophy, driven by an interest in encouraging a more delightful and accessible CLI environment, and guided by our experiences as programmers, we decided it was time to revisit the best practices and design principles for building command-line programs.</p>
<p>Long live the command line!</p>
<h2 id="introduction">Introduction</h2>
<p>This document covers both high-level design philosophy, and concrete guidelines.
It’s heavier on the guidelines because our philosophy as practitioners is not to philosophize too much.
We believe in learning by example, so we’ve provided plenty of those.</p>
<p>This guide doesn’t cover full-screen terminal programs like emacs and vim.
Full-screen programs are niche projects—very few of us will ever be in the position to design one.</p>
<p>This guide is also agnostic about programming languages and tooling in general.</p>
<p>Who is this guide for?</p>
<ul>
<li>If you are creating a CLI program and you are looking for principles and concrete best practices for its UI design, this guide is for you.</li>
<li>If you are a professional “CLI UI designer,” that’s amazing—we’d love to learn from you.</li>
<li>If you’d like to avoid obvious missteps of the variety that go against 40 years of CLI design conventions, this guide is for you.</li>
<li>If you want to delight people with your program’s good design and helpful help, this guide is definitely for you.</li>
<li>If you are creating a GUI program, this guide is not for you—though you may learn some GUI anti-patterns if you decide to read it anyway.</li>
<li>If you are designing an immersive, full-screen CLI port of Minecraft, this guide isn’t for you.
(But we can’t wait to see it!)</li>
</ul>
<h2 id="philosophy">Philosophy</h2>
<p>These are what we consider to be the fundamental principles of good CLI design.</p>
<h3 id="human-first-design">Human-first design</h3>
<p>Traditionally, UNIX commands were written under the assumption they were going to be used primarily by other programs.
They had more in common with functions in a programming language than with graphical applications.</p>
<p>Today, even though many CLI programs are used primarily (or even exclusively) by humans, a lot of their interaction design still carries the baggage of the past.
It’s time to shed some of this baggage: if a command is going to be used primarily by humans, it should be designed for humans first.</p>
<h3 id="simple-parts-that-work-together">Simple parts that work&nbsp;together</h3>
<p>A core tenet of <a href="https://en.wikipedia.org/wiki/Unix_philosophy">the original UNIX philosophy</a> is the idea that small, simple programs with clean interfaces can be combined to build larger systems.
Rather than stuff more and more features into those programs, you make programs that are modular enough to be recombined as needed.</p>
<p>In the old days, pipes and shell scripts played a crucial role in the process of composing programs together.
Their role might have diminished with the rise of general-purpose interpreted languages, but they certainly haven’t gone away.
What’s more, large-scale automation—in the form of CI/CD, orchestration and configuration management—has flourished.
Making programs composable is just as important as ever.</p>
<p>Fortunately, the long-established conventions of the UNIX environment, designed for this exact purpose, still help us today.
Standard in/out/err, signals, exit codes and other mechanisms ensure that different programs click together nicely.
Plain, line-based text is easy to pipe between commands.
JSON, a much more recent invention, affords us more structure when we need it, and lets us more easily integrate command-line tools with the web.</p>
<p>Whatever software you’re building, you can be absolutely certain that people will use it in ways you didn’t anticipate.
Your software <em>will</em> become a part in a larger system—your only choice is over whether it will be a well-behaved part.</p>
<p>Most importantly, designing for composability does not need to be at odds with designing for humans first.
Much of the advice in this document is about how to achieve both.</p>
<h3 id="consistency-across-programs">Consistency across programs</h3>
<p>The terminal’s conventions are hardwired into our fingers.
We had to pay an upfront cost by learning about command line syntax, flags, environment variables and so on, but it pays off in long-term efficiency… as long as programs are consistent.</p>
<p>Where possible, a CLI should follow patterns that already exist.
That’s what makes CLIs intuitive and guessable; that’s what makes users efficient.</p>
<p>That being said, sometimes consistency conflicts with ease of use.
For example, many long-established UNIX commands don’t output much information by default, which can cause confusion or worry for people less familiar with the command line.</p>
<p>When following convention would compromise a program’s usability, it might be time to break with it—but such a decision should be made with care.</p>
<h3 id="saying-just-enough">Saying (just) enough</h3>
<p>The terminal is a world of pure information.
You could make an argument that information is the interface—and that, just like with any interface, there’s often too much or too little of it.</p>
<p>A command is saying too little when it hangs for several minutes and the user starts to wonder if it’s broken.
A command is saying too much when it dumps pages and pages of debugging output, drowning what’s truly important in an ocean of loose detritus.
The end result is the same: a lack of clarity, leaving the user confused and irritated.</p>
<p>It can be very difficult to get this balance right, but it’s absolutely crucial if software is to empower and serve its users.</p>
<h3 id="ease-of-discovery">Ease of discovery</h3>
<p>When it comes to making functionality discoverable, GUIs have the upper hand.
Everything you can do is laid out in front of you on the screen, so you can find what you need without having to learn anything, and perhaps even discover things you didn’t know were possible.</p>
<p>It is assumed that command-line interfaces are the opposite of this—that you have to remember how to do everything.
The original <a href="https://archive.org/details/applehumaninterf00appl">Macintosh Human Interface Guidelines</a>, published in 1987, recommend “See-and-point (instead of remember-and-type),” as if you could only choose one or the other.</p>
<p>These things needn’t be mutually exclusive.
The efficiency of using the command-line comes from remembering commands, but there’s no reason the commands can’t help you learn and remember.</p>
<p>Discoverable CLIs have comprehensive help texts, provide lots of examples, suggest what command to run next, suggest what to do when there is an error.
There are lots of ideas that can be stolen from GUIs to make CLIs easier to learn and use, even for power users.</p>
<p><em>Citation: The Design of Everyday Things (Don Norman), Macintosh Human Interface Guidelines</em></p>
<h3 id="conversation-as-the-norm">Conversation as the&nbsp;norm</h3>
<p>GUI design, particularly in its early days, made heavy use of <em>metaphor</em>: desktops, files, folders, recycle bins.
It made a lot of sense, because computers were still trying to bootstrap themselves into legitimacy.
The ease of implementation of metaphors was one of the huge advantages GUIs wielded over CLIs.
Ironically, though, the CLI has embodied an accidental metaphor all along: it’s a conversation.</p>
<p>Beyond the most utterly simple commands, running a program usually involves more than one invocation.
Usually, this is because it’s hard to get it right the first time: the user types a command, gets an error, changes the command, gets a different error, and so on, until it works.
This mode of learning through repeated failure is like a conversation the user is having with the program.</p>
<p>Trial-and-error isn’t the only type of conversational interaction, though.
There are others:</p>
<ul>
<li>Running one command to set up a tool and then learning what commands to run to actually start using it.</li>
<li>Running several commands to set up an operation, and then a final command to run it (e.g. multiple <code>git add</code>s, followed by a <code>git commit</code>).</li>
<li>Exploring a system—for example, doing a lot of <code>cd</code> and <code>ls</code> to get a sense of a directory structure, or <code>git log</code> and <code>git show</code> to explore the history of a file.</li>
<li>Doing a dry-run of a complex operation before running it for real.</li>
</ul>
<p>Acknowledging the conversational nature of command-line interaction means you can bring relevant techniques to bear on its design.
You can suggest possible corrections when user input is invalid, you can make the intermediate state clear when the user is going through a multi-step process, you can confirm for them that everything looks good before they do something scary.</p>
<p>The user is conversing with your software, whether you intended it or not.
At worst, it’s a hostile conversation which makes them feel stupid and resentful.
At best, it’s a pleasant exchange that speeds them on their way with newfound knowledge and a feeling of achievement.</p>
<p><em>Further reading: <a href="https://www.nngroup.com/articles/anti-mac-interface/">The Anti-Mac User Interface (Don Gentner and Jakob Nielsen)</a></em></p>
<h3 id="robustness-principle">Robustness</h3>
<p>Robustness is both an objective and a subjective property.
Software should <em>be</em> robust, of course: unexpected input should be handled gracefully, operations should be idempotent where possible, and so on.
But it should also <em>feel</em> robust.</p>
<p>You want your software to feel like it isn’t going to fall apart.
You want it to feel immediate and responsive, as if it were a big mechanical machine, not a flimsy plastic “soft switch.”</p>
<p>Subjective robustness requires attention to detail and thinking hard about what can go wrong.
It’s lots of little things: keeping the user informed about what’s happening, explaining what common errors mean, not printing scary-looking stack traces.</p>
<p>As a general rule, robustness can also come from keeping it simple.
Lots of special cases and complex code tend to make a program fragile.</p>
<h3 id="empathy">Empathy</h3>
<p>Command-line tools are a programmer’s creative toolkit, so they should be enjoyable to use.
This doesn’t mean turning them into a video game, or using lots of emoji (though there’s nothing inherently wrong with emoji 😉).
It means giving the user the feeling that you are on their side, that you want them to succeed, that you have thought carefully about their problems and how to solve them.</p>
<p>There’s no list of actions you can take that will ensure they feel this way, although we hope that following our advice will take you some of the way there.
Delighting the user means <em>exceeding their expectations</em> at every turn, and that starts with empathy.</p>
<h3 id="chaos">Chaos</h3>
<p>The world of the terminal is a mess.
Inconsistencies are everywhere, slowing us down and making us second-guess ourselves.</p>
<p>Yet it’s undeniable that this chaos has been a source of power.
The terminal, like the UNIX-descended computing environment in general, places very few constraints on what you can build.
In that space, all manner of invention has bloomed.</p>
<p>It’s ironic that this document implores you to follow existing patterns, right alongside advice that contradicts decades of command-line tradition.
We’re just as guilty of breaking the rules as anyone.</p>
<p>The time might come when you, too, have to break the rules.
Do so with intention and clarity of purpose.</p>
<blockquote>
<p>“Abandon a standard when it is demonstrably harmful to productivity or user satisfaction.” — Jef Raskin, <a href="https://en.wikipedia.org/wiki/The_Humane_Interface">The Humane Interface</a></p>
</blockquote>
<h2 id="guidelines">Guidelines</h2>
<p>This is a collection of specific things you can do to make your command-line program better.</p>
<p>The first section contains the essential things you need to follow.
Get these wrong, and your program will be either hard to use or a bad CLI citizen.</p>
<p>The rest are nice-to-haves.
If you have the time and energy to add these things, your program will be a lot better than the average program.</p>
<p>The idea is that, if you don’t want to think too hard about the design of your program, you don’t have to: just follow these rules and your program will probably be good.
On the other hand, if you’ve thought about it and determined that a rule is wrong for your program, that’s fine.
(There’s no central authority that will reject your program for not following arbitrary rules.)</p>
<p>Also—these rules aren’t written in stone.
If you disagree with a general rule for good reason, we hope you’ll <a href="https://github.com/cli-guidelines/cli-guidelines">propose a change</a>.</p>
<h3 id="the-basics">The Basics</h3>
<p>There are a few basic rules you need to follow.
Get these wrong, and your program will be either very hard to use, or flat-out broken.</p>
<p><strong>Use a command-line argument parsing library where you can.</strong>
Either your language’s built-in one, or a good third-party one.
They will normally handle arguments, flag parsing, help text, and even spelling suggestions in a sensible way.</p>
<p>Here are some that we like:</p>
<ul>
<li>Multi-platform: <a href="http://docopt.org/">docopt</a></li>
<li>Bash: <a href="https://argbash.io/">argbash</a></li>
<li>Go: <a href="https://github.com/spf13/cobra">Cobra</a>, <a href="https://github.com/urfave/cli">cli</a></li>
<li>Haskell: <a href="https://hackage.haskell.org/package/optparse-applicative">optparse-applicative</a></li>
<li>Java: <a href="https://picocli.info/">picocli</a></li>
<li>Node: <a href="https://oclif.io/">oclif</a></li>
<li>Deno: <a href="https://deno.land/std/flags">flags</a></li>
<li>Perl: <a href="https://metacpan.org/pod/Getopt::Long">Getopt::Long</a></li>
<li>PHP: <a href="https://github.com/symfony/console">console</a>, <a href="https://climate.thephpleague.com/">CLImate</a></li>
<li>Python: <a href="https://docs.python.org/3/library/argparse.html">Argparse</a>, <a href="https://click.palletsprojects.com/">Click</a>, <a href="https://github.com/tiangolo/typer">Typer</a></li>
<li>Ruby: <a href="https://ttytoolkit.org/">TTY</a></li>
<li>Rust: <a href="https://clap.rs/">clap</a>, <a href="https://github.com/TeXitoi/structopt">structopt</a></li>
<li>Swift: <a href="https://github.com/apple/swift-argument-parser">swift-argument-parser</a></li>
</ul>
<p><strong>Return zero exit code on success, non-zero on failure.</strong>
Exit codes are how scripts determine whether a program succeeded or failed, so you should report this correctly.
Map the non-zero exit codes to the most important failure modes.</p>
<p><strong>Send output to <code>stdout</code>.</strong>
The primary output for your command should go to <code>stdout</code>.
Anything that is machine readable should also go to <code>stdout</code>—this is where piping sends things by default.</p>
<p><strong>Send messaging to <code>stderr</code>.</strong>
Log messages, errors, and so on should all be sent to <code>stderr</code>.
This means that when commands are piped together, these messages are displayed to the user and not fed into the next command.</p>
<h3 id="help">Help</h3>
<p><strong>Display help text when passed no options, the <code>-h</code> flag, or the <code>--help</code> flag.</strong></p>
<p><strong>Display a concise help text by default.</strong>
If you can, display help by default when <code>myapp</code> or <code>myapp subcommand</code> is run.
Unless your program is very simple and does something obvious by default (e.g. <code>ls</code>), or your program reads input interactively (e.g. <code>cat</code>).</p>
<p>The concise help text should only include:</p>
<ul>
<li>A description of what your program does.</li>
<li>One or two example invocations.</li>
<li>Descriptions of flags, unless there are lots of them.</li>
<li>An instruction to pass the <code>--help</code> flag for more information.</li>
</ul>
<p><code>jq</code> does this well.
When you type <code>jq</code>, it displays an introductory description and an example, then prompts you to pass <code>jq --help</code> for the full listing of flags:</p>
<pre><code>$ jq
jq - commandline JSON processor [version 1.6]

Usage:    jq [options] &lt;jq filter&gt; [file...]
    jq [options] --args &lt;jq filter&gt; [strings...]
    jq [options] --jsonargs &lt;jq filter&gt; [JSON_TEXTS...]

jq is a tool for processing JSON inputs, applying the given filter to
its JSON text inputs and producing the filter's results as JSON on
standard output.

The simplest filter is ., which copies jq's input to its output
unmodified (except for formatting, but note that IEEE754 is used
for number representation internally, with all that that implies).

For more advanced filters see the jq(1) manpage ("man jq")
and/or https://stedolan.github.io/jq

Example:

    $ echo '{"foo": 0}' | jq .
    {
        "foo": 0
    }

For a listing of options, use jq --help.
</code></pre><p><strong>Show full help when <code>-h</code> and <code>--help</code> is passed.</strong>
All of these should show help:</p>
<pre><code>$ myapp
$ myapp --help
$ myapp -h
</code></pre><p>Ignore any other flags and arguments that are passed—you should be able to add <code>-h</code> to the end of anything and it should show help.
Don’t overload <code>-h</code>.</p>
<p>If your program is <code>git</code>-like, the following should also offer help:</p>
<pre><code>$ myapp help
$ myapp help subcommand
$ myapp subcommand --help
$ myapp subcommand -h
</code></pre><p><strong>Provide a support path for feedback and issues.</strong>
A website or GitHub link in the top-level help text is common.</p>
<p><strong>In help text, link to the web version of the documentation.</strong>
If you have a specific page or anchor for a subcommand, link directly to that.
This is particularly useful if there is more detailed documentation on the web, or further reading that might explain the behavior of something.</p>
<p><strong>Lead with examples.</strong>
Users tend to use examples over other forms of documentation, so show them first in the help page, particularly the common complex uses.
If it helps explain what it’s doing and it isn’t too long, show the actual output too.</p>
<p>You can tell a story with a series of examples, building your way toward complex uses.</p>
<!-- TK example? -->
<p><strong>If you’ve got loads of examples, put them somewhere else,</strong> in a cheat sheet command or a web page.
It’s useful to have exhaustive, advanced examples, but you don’t want to make your help text really long.</p>
<p>For more complex use cases, e.g. when integrating with another tool, it might be appropriate to write a fully-fledged tutorial.</p>
<p><strong>Display the most common flags and commands at the start of the help text.</strong>
It’s fine to have lots of flags, but if you’ve got some really common ones, display them first.
For example, the Git command displays the commands for getting started and the most commonly used subcommands first:</p>
<pre><code>$ git
usage: git [--version] [--help] [-C &lt;path&gt;] [-c &lt;name&gt;=&lt;value&gt;]
           [--exec-path[=&lt;path&gt;]] [--html-path] [--man-path] [--info-path]
           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]
           [--git-dir=&lt;path&gt;] [--work-tree=&lt;path&gt;] [--namespace=&lt;name&gt;]
           &lt;command&gt; [&lt;args&gt;]

These are common Git commands used in various situations:

start a working area (see also: git help tutorial)
   clone      Clone a repository into a new directory
   init       Create an empty Git repository or reinitialize an existing one

work on the current change (see also: git help everyday)
   add        Add file contents to the index
   mv         Move or rename a file, a directory, or a symlink
   reset      Reset current HEAD to the specified state
   rm         Remove files from the working tree and from the index

examine the history and state (see also: git help revisions)
   bisect     Use binary search to find the commit that introduced a bug
   grep       Print lines matching a pattern
   log        Show commit logs
   show       Show various types of objects
   status     Show the working tree status
…
</code></pre><p><strong>Use formatting in your help text.</strong>
Bold headings make it much easier to scan.
But, try to do it in a terminal-independent way so that your users aren’t staring down a wall of escape characters.</p>
<pre><code>
<strong>$ heroku apps --help</strong>
list your apps

<strong>USAGE</strong>
  $ heroku apps

<strong>OPTIONS</strong>
  -A, --all          include apps in all teams
  -p, --personal     list apps in personal account when a default team is set
  -s, --space=space  filter by space
  -t, --team=team    team to use
  --json             output in json format

<strong>EXAMPLES</strong>
  $ heroku apps
  === My Apps
  example
  example2

  === Collaborated Apps
  theirapp   other@owner.name

<strong>COMMANDS</strong>
  apps:create     creates a new app
  apps:destroy    permanently destroy an app
  apps:errors     view app errors
  apps:favorites  list favorited apps
  apps:info       show detailed app information
  apps:join       add yourself to a team app
  apps:leave      remove yourself from a team app
  apps:lock       prevent team members from joining an app
  apps:open       open the app in a web browser
  apps:rename     rename an app
  apps:stacks     show the list of available stacks
  apps:transfer   transfer applications to another user or team
  apps:unlock     unlock an app so any team member can join
</code>
</pre>
<p>Note: When <code>heroku apps --help</code> is piped through a pager, the command emits no escape characters.</p>
<p><strong>If the user did something wrong and you can guess what they meant, suggest it.</strong>
For example, <code>brew update jq</code> tells you that you should run <code>brew upgrade jq</code>.</p>
<p>You can ask if they want to run the suggested command, but don’t force it on them.
For example:</p>
<pre><code>$ heroku pss
 ›   Warning: pss is not a heroku command.
Did you mean ps? [y/n]:
</code></pre><p>Rather than suggesting the corrected syntax, you might be tempted to just run it for them, as if they’d typed it right in the first place.
Sometimes this is the right thing to do, but not always.</p>
<p>Firstly, invalid input doesn’t necessarily imply a simple typo—it can often mean the user has made a logical mistake, or misused a shell variable.
Assuming what they meant can be dangerous, especially if the resulting action modifies state.</p>
<p>Secondly, be aware that if you change what the user typed, they won’t learn the correct syntax.
In effect, you’re ruling that the way they typed it is valid and correct, and you’re committing to supporting that indefinitely.
Be intentional in making that decision, and document both syntaxes.</p>
<p><em>Further reading: <a href="http://www.catb.org/~esr/jargon/html/D/DWIM.html">“Do What I Mean”</a></em></p>
<p><strong>If your command is expecting to have something piped to it and <code>stdin</code> is an interactive terminal, display help immediately and quit.</strong>
This means it doesn’t just hang, like <code>cat</code>.
Alternatively, you could print a log message to <code>stderr</code>.</p>
<h3 id="documentation">Documentation</h3>
<p>The purpose of <a href="#help">help text</a> is to give a brief, immediate sense of what your tool is, what options are available, and how to perform the most common tasks.
Documentation, on the other hand, is where you go into full detail.
It’s where people go to understand what your tool is for, what it <em>isn’t</em> for, how it works and how to do everything they might need to do.</p>
<p><strong>Provide web-based documentation.</strong>
People need to be able to search online for your tool’s documentation, and to link other people to specific parts.
The web is the most inclusive documentation format available.</p>
<p><strong>Provide terminal-based documentation.</strong>
Documentation in the terminal has several nice properties: it’s fast to access, it stays in sync with the specific installed version of the tool, and it works without an internet connection.</p>
<p><strong>Consider providing man pages.</strong>
<a href="https://en.wikipedia.org/wiki/Man_page">man pages</a>, Unix’s original system of documentation, are still in use today, and many users will reflexively check <code>man mycmd</code> as a first step when trying to learn about your tool.
To make them easier to generate, you can use a tool like <a href="http://rtomayko.github.io/ronn/ronn.1.html">ronn</a> (which can also generate your web docs).</p>
<p>However, not everyone knows about <code>man</code>, and it doesn’t run on all platforms, so you should also make sure your terminal docs are accessible via your tool itself.
For example, <code>git</code> and <code>npm</code> make their man pages accessible via the <code>help</code> subcommand, so <code>npm help ls</code> is equivalent to <code>man npm-ls</code>.</p>
<pre><code>NPM-LS(1)                                                            NPM-LS(1)

NAME
       npm-ls - List installed packages

SYNOPSIS
         npm ls [[&lt;@scope&gt;/]&lt;pkg&gt; ...]

         aliases: list, la, ll

DESCRIPTION
       This command will print to stdout all the versions of packages that are
       installed, as well as their dependencies, in a tree-structure.

       ...
</code></pre><h3 id="output">Output</h3>
<p><strong>Human-readable output is paramount.</strong>
Humans come first, machines second.
The most simple and straightforward heuristic for whether a particular output stream (<code>stdout</code> or <code>stderr</code>) is being read by a human is <em>whether or not it’s a TTY</em>.
Whatever language you’re using, it will have a utility or library for doing this (e.g. <a href="https://stackoverflow.com/questions/858623/how-to-recognize-whether-a-script-is-running-on-a-tty">Python</a>, <a href="https://nodejs.org/api/process.html#process_a_note_on_process_i_o">Node</a>, <a href="https://github.com/mattn/go-isatty">Go</a>).</p>
<p><em>Further reading on <a href="https://unix.stackexchange.com/a/4132">what a TTY is</a>.</em></p>
<p><strong>Have machine-readable output where it does not impact usability.</strong>
Streams of text is the universal interface in UNIX.
Programs typically output lines of text, and programs typically expect lines of text as input,
therefore you can compose multiple programs together.
This is normally done to make it possible to write scripts,
but it can also help the usability for humans using programs.
For example, a user should be able to pipe output to <code>grep</code> and it should do what they expect.</p>
<blockquote>
<p>“Expect the output of every program to become the input to another, as yet unknown, program.”
— <a href="https://homepage.cs.uri.edu/~thenry/resources/unix_art/ch01s06.html">Doug McIlroy</a></p>
</blockquote>
<p><strong>If human-readable output breaks machine-readable output, use <code>--plain</code> to display output in plain, tabular text format for integration with tools like <code>grep</code> or <code>awk</code>.</strong>
In some cases, you might need to output information in a different way to make it human-readable.</p>
<!-- (TK example with and without --plain) -->
<p>For example, if you are displaying a line-based table, you might choose to split a cell into multiple lines, fitting in more information while keeping it within the width of the screen.
This breaks the expected behavior of there being one piece of data per line, so you should provide a <code>--plain</code> flag for scripts, which disables all such manipulation and outputs one record per line.</p>
<p><strong>Display output as formatted JSON if <code>--json</code> is passed.</strong>
JSON allows for more structure than plain text, so it makes it much easier to output and handle complex data structures.
<a href="https://stedolan.github.io/jq/"><code>jq</code></a> is a common tool for working with JSON on the command-line, and there is now a <a href="https://ilya-sher.org/2018/04/10/list-of-json-tools-for-command-line/">whole ecosystem of tools</a> that output and manipulate JSON.</p>
<p>It is also widely used on the web, so by using JSON as the input and output of programs, you can pipe directly to and from web services using <code>curl</code>.</p>
<p><strong>Display output on success, but keep it brief.</strong>
Traditionally, when nothing is wrong, UNIX commands display no output to the user.
This makes sense when they’re being used in scripts, but can make commands appear to be hanging or broken when used by humans.
For example, <code>cp</code> will not print anything, even if it takes a long time.</p>
<p>It’s rare that printing nothing at all is the best default behavior, but it’s usually best to err on the side of less.</p>
<p>For instances where you do want no output (for example, when used in shell scripts), to avoid clumsy redirection of <code>stderr</code> to <code>/dev/null</code>, you can provide a <code>-q</code> option to suppress all non-essential output.</p>
<p><strong>If you change state, tell the user.</strong>
When a command changes the state of a system, it’s especially valuable to explain what has just happened, so the user can model the state of the system in their head—particularly if the result doesn’t directly map to what the user requested.</p>
<p>For example, <code>git push</code> tells you exactly what it is doing, and what the new state of the remote branch is:</p>
<pre><code>$ git push
Enumerating objects: 18, done.
Counting objects: 100% (18/18), done.
Delta compression using up to 8 threads
Compressing objects: 100% (10/10), done.
Writing objects: 100% (10/10), 2.09 KiB | 2.09 MiB/s, done.
Total 10 (delta 8), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (8/8), completed with 8 local objects.
To github.com:replicate/replicate.git
 + 6c22c90...a2a5217 bfirsh/fix-delete -&gt; bfirsh/fix-delete
</code></pre><p><strong>Make it easy to see the current state of the system.</strong>
If your program does a lot of complex state changes and it is not immediately visible in the filesystem, make sure you make this easy to view.</p>
<p>For example, <code>git status</code> tells you as much information as possible about the current state of your Git repository, and some hints at how to modify the state:</p>
<pre><code>$ git status
On branch bfirsh/fix-delete
Your branch is up to date with 'origin/bfirsh/fix-delete'.

Changes not staged for commit:
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git restore &lt;file&gt;..." to discard changes in working directory)
	modified:   cli/pkg/cli/rm.go

no changes added to commit (use "git add" and/or "git commit -a")
</code></pre><p><strong>Suggest commands the user should run.</strong>
When several commands form a workflow, suggesting to the user commands they can run next helps them learn how to use your program and discover new functionality.
For example, in the <code>git status</code> output above, it suggests commands you can run to modify the state you are viewing.</p>
<p><strong>Actions crossing the boundary of the program’s internal world should usually be explicit.</strong>
This includes things like:</p>
<ul>
<li>Reading or writing files that the user didn’t explicitly pass as arguments (unless those files are storing internal program state, such as a cache).</li>
<li>Talking to a remote server, e.g. to download a file.</li>
</ul>
<p><strong>Increase information density—with ASCII art!</strong>
For example, <code>ls</code> shows permissions in a scannable way.
When you first see it, you can ignore most of the information.
Then, as you learn how it works, you pick out more patterns over time.</p>
<pre><code>-rw-r--r-- 1 root root     68 Aug 22 23:20 resolv.conf
lrwxrwxrwx 1 root root     13 Mar 14 20:24 rmt -&gt; /usr/sbin/rmt
drwxr-xr-x 4 root root   4.0K Jul 20 14:51 security
drwxr-xr-x 2 root root   4.0K Jul 20 14:53 selinux
-rw-r----- 1 root shadow  501 Jul 20 14:44 shadow
-rw-r--r-- 1 root root    116 Jul 20 14:43 shells
drwxr-xr-x 2 root root   4.0K Jul 20 14:57 skel
-rw-r--r-- 1 root root      0 Jul 20 14:43 subgid
-rw-r--r-- 1 root root      0 Jul 20 14:43 subuid
</code></pre><p><strong>Use color with intention.</strong>
For example, you might want to highlight some text so the user notices it, or use red to indicate an error.
Don’t overuse it—if everything is a different color, then the color means nothing and only makes it harder to read.</p>
<p><strong>Disable color if your program is not in a terminal or the user requested it.</strong>
These things should disable colors:</p>
<ul>
<li><code>stdout</code> or <code>stderr</code> is not an interactive terminal (a TTY).
It’s best to individually check—if you’re piping <code>stdout</code> to another program, it’s still useful to get colors on <code>stderr</code>.</li>
<li>The <code>NO_COLOR</code> environment variable is set.</li>
<li>The <code>TERM</code> environment variable has the value <code>dumb</code>.</li>
<li>The user passes the option <code>--no-color</code>.</li>
<li>You may also want to add a <code>MYAPP_NO_COLOR</code> environment variable in case users want to disable color specifically for your program.</li>
</ul>
<p><em>Further reading: <a href="https://no-color.org/">no-color.org</a>, <a href="https://medium.com/@jdxcode/12-factor-cli-apps-dd3c227a0e46">12 Factor CLI Apps</a></em></p>
<p><strong>If <code>stdout</code> is not an interactive terminal, don’t display any animations.</strong>
This will stop progress bars turning into Christmas trees in CI log output.</p>
<p><strong>Use symbols and emoji where it makes things clearer.</strong>
Pictures can be better than words if you need to make several things distinct, catch the user’s attention, or just add a bit of character.
Be careful, though—it can be easy to overdo it and make your program look cluttered or feel like a toy.</p>
<p>For example, <a href="https://github.com/FiloSottile/yubikey-agent">yubikey-agent</a> uses emoji to add structure to the output so it isn’t just a wall of text, and a ❌ to draw your attention to an important piece of information:</p>
<pre><code data-lang="shell-session">$ yubikey-agent -setup
🔐 The PIN is up to 8 numbers, letters, or symbols. Not just numbers!
❌ The key will be lost if the PIN and PUK are locked after 3 incorrect tries.

Choose a new PIN/PUK: 
Repeat the PIN/PUK: 

🧪 Retriculating splines …

✅ Done! This YubiKey is secured and ready to go.
🤏 When the YubiKey blinks, touch it to authorize the login.

🔑 Here's your new shiny SSH public key:
ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCEJ/
UwlHnUFXgENO3ifPZd8zoSKMxESxxot4tMgvfXjmRp5G3BGrAnonncE7Aj11pn3SSYgEcrrn2sMyLGpVS0=

💭 Remember: everything breaks, have a backup plan for when this YubiKey does.
</code></pre><p><strong>By default, don’t output information that’s only understandable by the creators of the software.</strong>
If a piece of output serves only to help you (the developer) understand what your software is doing, it almost certainly shouldn’t be displayed to normal users by default—only in verbose mode.</p>
<p>Invite usability feedback from outsiders and people who are new to your project.
They’ll help you see important issues that you are too close to the code to notice.</p>
<p><strong>Don’t treat <code>stderr</code> like a log file, at least not by default.</strong>
Don’t print log level labels (<code>ERR</code>, <code>WARN</code>, etc.) or extraneous contextual information, unless in verbose mode.</p>
<p><strong>Use a pager (e.g. <code>less</code>) if you are outputting a lot of text.</strong>
For example, <code>git diff</code> does this by default.
Using a pager can be error-prone, so be careful with your implementation such that you don’t make the experience worse for the user.
You shouldn’t use a pager if <code>stdin</code> or <code>stdout</code> is not an interactive terminal.</p>
<p>A good sensible set of options to use for <code>less</code> is <code>less -FIRX</code>.
This does not page if the content fills one screen, ignores case when you search, enables color and formatting, and leaves the contents on the screen when <code>less</code> quits.</p>
<p>There might be libraries in your language that are more robust than piping to <code>less</code>.
For example, <a href="https://github.com/prompt-toolkit/pypager">pypager</a> in Python.</p>
<h3 id="errors">Errors</h3>
<p>One of the most common reasons to consult documentation is to fix errors.
If you can make errors into documentation, then this will save the user loads of time.</p>
<p><strong>Catch errors and <a href="https://www.nngroup.com/articles/error-message-guidelines/">rewrite them for humans</a>.</strong>
If you’re expecting an error to happen, catch it and rewrite the error message to be useful.
Think of it like a conversation, where the user has done something wrong and the program is guiding them in the right direction.
Example: “Can’t write to file.txt. You might need to make it writable by running ‘chmod +w file.txt’.”</p>
<p><strong>Signal-to-noise ratio is crucial.</strong>
The more irrelevant output you produce, the longer it’s going to take the user to figure out what they did wrong.
If your program produces multiple errors of the same type, consider grouping them under a single explanatory header instead of printing many similar-looking lines.</p>
<p><strong>Consider where the user will look first.</strong>
Put the most important information at the end of the output.
The eye will be drawn to red text, so use it intentionally and sparingly.</p>
<p><strong>If there is an unexpected or unexplainable error, provide debug and traceback information, and instructions on how to submit a bug.</strong>
That said, don’t forget about the signal-to-noise ratio: you don’t want to overwhelm the user with information they don’t understand.
Consider writing the debug log to a file instead of printing it to the terminal.</p>
<p><strong>Make it effortless to submit bug reports.</strong>
One nice thing you can do is provide a URL and have it pre-populate as much information as possible.</p>
<h3 id="arguments-and-flags">Arguments and flags</h3>
<p>A note on terminology:</p>
<ul>
<li><em>Arguments</em>, or <em>args</em>, are positional parameters to a command.
For example, the file paths you provide to <code>cp</code> are args.
The order of args is often important: <code>cp foo bar</code> means something different from <code>cp bar foo</code>.</li>
<li><em>Flags</em> are named parameters, denoted with either a hyphen and a single-letter name (<code>-r</code>) or a double hyphen and a multiple-letter name (<code>--recursive</code>).
They may or may not also include a user-specified value (<code>--file foo.txt</code>, or <code>--file=foo.txt</code>).
The order of flags, generally speaking, does not affect program semantics.</li>
</ul>
<p><strong>Prefer flags to args.</strong>
It’s a bit more typing, but it makes it much clearer what is going on.
It also makes it easier to make changes to how you accept input in the future.
Sometimes when using args, it’s impossible to add new input without breaking existing behavior or creating ambiguity.</p>
<p><em>Citation: <a href="https://medium.com/@jdxcode/12-factor-cli-apps-dd3c227a0e46">12 Factor CLI Apps</a>.</em></p>
<p><strong>Have full-length versions of all flags.</strong>
For example, have both <code>-h</code> and <code>--help</code>.
Having the full version is useful in scripts where you want to be verbose and descriptive, and you don’t have to look up the meaning of flags everywhere.</p>
<p><em>Citation: <a href="https://www.gnu.org/prep/standards/html_node/Command_002dLine-Interfaces.html">GNU Coding Standards</a>.</em></p>
<p><strong>Only use one-letter flags for commonly used flags,</strong> particularly at the top-level when using subcommands.
That way you don’t “pollute” your namespace of short flags, forcing you to use convoluted letters and cases for flags you add in the future.</p>
<p><strong>Multiple arguments are fine for simple actions against multiple files.</strong>
For example, <code>rm file1.txt file2.txt file3.txt</code>.
This also makes it work with globbing: <code>rm *.txt</code>.</p>
<p><strong>If you’ve got two or more arguments for different things, you’re probably doing something wrong.</strong>
The exception is a common, primary action, where the brevity is worth memorizing.
For example, <code>cp &lt;source&gt; &lt;destination&gt;</code>.</p>
<p><em>Citation: <a href="https://medium.com/@jdxcode/12-factor-cli-apps-dd3c227a0e46">12 Factor CLI Apps</a>.</em></p>
<p><strong>Use standard names for flags, if there is a standard.</strong>
If another commonly used command uses a flag name, it’s best to follow that existing pattern.
That way, a user doesn’t have to remember two different options (and which command it applies to), and users can even guess an option without having to look at the help text.</p>
<p>Here’s a list of commonly used options:</p>
<ul>
<li><code>-a</code>, <code>--all</code>: All.
For example, <code>ps</code>, <code>fetchmail</code>.</li>
<li><code>-d</code>, <code>--debug</code>: Show debugging output.</li>
<li><code>-f</code>, <code>--force</code>: Force.
For example, <code>rm -f</code> will force the removal of files, even if it thinks it does not have permission to do it.
This is also useful for commands which are doing something destructive that usually require user confirmation, but you want to force it to do that destructive action in a script.</li>
<li><code>--json</code>: Display JSON output.
See the <a href="#output">output</a> section.</li>
<li><code>-h</code>, <code>--help</code>: Help.
This should only mean help.
See the <a href="#help">help</a> section.</li>
<li><code>--no-input</code>: See the <a href="#interactivity">interactivity</a> section.</li>
<li><code>-o</code>, <code>--output</code>: Output file.
For example, <code>sort</code>, <code>gcc</code>.</li>
<li><code>-p</code>, <code>--port</code>: Port.
For example, <code>psql</code>, <code>ssh</code>.</li>
<li><code>-q</code>, <code>--quiet</code>: Quiet.
Display less output.
This is particularly useful when displaying output for humans that you might want to hide when running in a script.</li>
<li><code>-u</code>, <code>--user</code>: User.
For example, <code>ps</code>, <code>ssh</code>.</li>
<li><code>--version</code>: Version.</li>
<li><code>-v</code>: This can often mean either verbose or version.
You might want to use <code>-d</code> for verbose and this for version, or for nothing to avoid confusion.</li>
</ul>
<p><strong>Make the default the right thing for most users.</strong>
Making things configurable is good, but most users are not going to find the right flag and remember to use it all the time (or alias it).
If it’s not the default, you’re making the experience worse for most of your users.</p>
<p>For example, <code>ls</code> has terse default output to optimize for scripts and other historical reasons, but if it were designed today, it would probably default to <code>ls -lhF</code>.</p>
<p><strong>Prompt for user input.</strong>
If a user doesn’t pass an argument or flag, prompt for it.
(See also: <a href="#interactivity">Interactivity</a>)</p>
<p><strong>Never <em>require</em> a prompt.</strong>
Always provide a way of passing input with flags or arguments.
If <code>stdin</code> is not an interactive terminal, skip prompting and just require those flags/args.</p>
<p><strong>Confirm before doing anything dangerous.</strong>
A common convention is to prompt for the user to type <code>y</code> or <code>yes</code> if running interactively, or requiring them to pass <code>-f</code> or <code>--force</code> otherwise.</p>
<p>“Dangerous” is a subjective term, and there are differing levels of danger:</p>
<ul>
<li><strong>Mild:</strong> A small, local change such as deleting a file.
You might want to prompt for confirmation, you might not.
For example, if the user is explicitly running a command called something like “delete,” you probably don’t need to ask.</li>
<li><strong>Moderate:</strong> A bigger local change like deleting a directory, a remote change like deleting a resource of some kind, or a complex bulk modification that can’t be easily undone.
You usually want to prompt for confirmation here.
Consider giving the user a way to “dry run” the operation so they can see what’ll happen before they commit to it.</li>
<li><strong>Severe:</strong> Deleting something complex, like an entire remote application or server.
You don’t just want to prompt for confirmation here—you want to make it hard to confirm by accident.
Consider asking them to type something non-trivial such as the name of the thing they’re deleting.
Let them alternatively pass a flag such as <code>--confirm="name-of-thing"</code>, so it’s still scriptable.</li>
</ul>
<p>Consider whether there are non-obvious ways to accidentally destroy things.
For example, imagine a situation where changing a number in a configuration file from 10 to 1 means that 9 things will be implicitly deleted—this should be considered a severe risk, and should be difficult to do by accident.</p>
<p><strong>If input or output is a file, support <code>-</code> to read from <code>stdin</code> or write to <code>stdout</code>.</strong>
This lets the output of another command be the input of your command and vice versa, without using a temporary file.
For example, <code>tar</code> can extract files from <code>stdin</code>:</p>
<pre><code>$ curl https://example.com/something.tar.gz | tar xvf -
</code></pre><p><strong>If a flag can accept an optional value, allow a special word like “none.”</strong>
For example, <code>ssh -F</code> takes an optional filename of an alternative <code>ssh_config</code> file, and <code>ssh -F none</code> runs SSH with no config file. Don’t just use a blank value—this can make it ambiguous whether arguments are flag values or arguments.</p>
<p><strong>If possible, make arguments, flags and subcommands order-independent.</strong>
A lot of CLIs, especially those with subcommands, have unspoken rules on where you can put various arguments.
For example a command might have a <code>--foo</code> flag that only works if you put it before the subcommand:</p>
<pre><code>mycmd --foo=1 subcmd
works

$ mycmd subcmd --foo=1
unknown flag: --foo
</code></pre><p>This can be very confusing for the user—especially given that one of the most common things users do when trying to get a command to work is to hit the up arrow to get the last invocation, stick another option on the end, and run it again.
If possible, try to make both forms equivalent, although you might run up against the limitations of your argument parser.</p>
<p><strong>Do not read secrets directly from flags.</strong>
When a command accepts a secret, eg. via a <code>--password</code> argument,
the argument value will leak the secret into <code>ps</code> output and potentially shell history.
And, this sort of flag encourages the use of insecure environment variables for secrets.</p>
<p>Consider accepting sensitive data only via files, e.g. with a <code>--password-file</code> argument, or via <code>stdin</code>.
A <code>--password-file</code> argument allows a secret to be passed in discreetly, in a wide variety of contexts.</p>
<p>(It’s possible to pass a file’s contents into an argument in Bash by using <code>--password $(&lt; password.txt)</code>.
This approach has the same security issue of leaking the file’s contents into the output of <code>ps</code>.
It’s best avoided.)</p>
<h3 id="interactivity">Interactivity</h3>
<p><strong>Only use prompts or interactive elements if <code>stdin</code> is an interactive terminal (a TTY).</strong>
This is a pretty reliable way to tell whether you’re piping data into a command or whether it’s being run in a script, in which case a prompt won’t work and you should throw an error telling the user what flag to pass.</p>
<p><strong>If <code>--no-input</code> is passed, don’t prompt or do anything interactive.</strong>
This allows users an explicit way to disable all prompts in commands.
If the command requires input, fail and tell the user how to pass the information as a flag.</p>
<p><strong>If you’re prompting for a password, don’t print it as the user types.</strong>
This is done by turning off echo in the terminal.
Your language should have helpers for this.</p>
<p><strong>Let the user escape.</strong>
Make it clear how to get out.
(Don’t do what vim does.)
If your program hangs on network I/O etc, always make Ctrl-C still work.
If it’s a wrapper around program execution where Ctrl-C can’t quit (SSH, tmux, telnet, etc), make it clear how to do that.
For example, SSH allows escape sequences with the <code>~</code> escape character.</p>
<h3 id="subcommands">Subcommands</h3>
<p>If you’ve got a tool that’s sufficiently complex, you can reduce its complexity by making a set of subcommands.
If you have several tools that are very closely related, you can make them easier to use and discover by combining them into a single command (for example, RCS vs. Git).</p>
<p>They’re useful for sharing stuff—global flags, help text, configuration, storage mechanisms.</p>
<p><strong>Be consistent across subcommands.</strong>
Use the same flag names for the same things, have similar output formatting, etc.</p>
<p><strong>Use consistent names for multiple levels of subcommand.</strong>
If a complex piece of software has lots of objects and operations that can be performed on those objects, it is a common pattern to use two levels of subcommand for this, where one is a noun and one is a verb.
For example, <code>docker container create</code>.
Be consistent with the verbs you use across different types of objects.</p>
<p>Either <code>noun verb</code> or <code>verb noun</code> ordering works, but <code>noun verb</code> seems to be more common.</p>
<p><em>Further reading: <a href="https://uxdesign.cc/user-experience-clis-and-breaking-the-world-baed8709244f">User experience, CLIs, and breaking the world, by John Starich</a>.</em></p>
<p><strong>Don’t have ambiguous or similarly-named commands.</strong>
For example, having two subcommands called “update” and “upgrade” is quite confusing.
You might want to use different words, or disambiguate with extra words.</p>
<h3 id="robustness-guidelines">Robustness</h3>
<p><strong>Validate user input.</strong>
Everywhere your program accepts data from the user, it will eventually be given bad data.
Check early and bail out before anything bad happens, and <a href="#errors">make the errors understandable</a>.</p>
<p><strong>Responsive is more important than fast.</strong>
Print something to the user in &lt;100ms.
If you’re making a network request, print something before you do it so it doesn’t hang and look broken.</p>
<p><strong>Show progress if something takes a long time.</strong>
If your program displays no output for a while, it will look broken.
A good spinner or progress indicator can make a program appear to be faster than it is.</p>
<p>Ubuntu 20.04 has a nice progress bar that sticks to the bottom of the terminal.</p>
<!-- (TK reproduce this as a code block or animated SVG) -->
<p>If the progress bar gets stuck in one place for a long time, the user won’t know if stuff is still happening or if the program’s crashed.
It’s good to show estimated time remaining, or even just have an animated component, to reassure them that you’re still working on it.</p>
<p>There are many good libraries for generating progress bars.
For example, <a href="https://github.com/tqdm/tqdm">tqdm</a> for Python, <a href="https://github.com/schollz/progressbar">schollz/progressbar</a> for Go, and <a href="https://github.com/visionmedia/node-progress">node-progress</a> for Node.js.</p>
<p><strong>Do stuff in parallel where you can, but be thoughtful about it.</strong>
It’s already difficult to report progress in the shell; doing it for parallel processes is ten times harder.
Make sure it’s robust, and that the output isn’t confusingly interleaved.
If you can use a library, do so—this is code you don’t want to write yourself.
Libraries like <a href="https://github.com/tqdm/tqdm">tqdm</a> for Python and <a href="https://github.com/schollz/progressbar">schollz/progressbar</a> for Go support multiple progress bars natively.</p>
<p>The upside is that it can be a huge usability gain.
For example, <code>docker pull</code>’s multiple progress bars offer crucial insight into what’s going on.</p>
<pre><code>$ docker image pull ruby
Using default tag: latest
latest: Pulling from library/ruby
6c33745f49b4: Pull complete 
ef072fc32a84: Extracting [================================================&gt;  ]  7.569MB/7.812MB
c0afb8e68e0b: Download complete 
d599c07d28e6: Download complete 
f2ecc74db11a: Downloading [=======================&gt;                           ]  89.11MB/192.3MB
3568445c8bf2: Download complete 
b0efebc74f25: Downloading [===========================================&gt;       ]  19.88MB/22.88MB
9cb1ba6838a0: Download complete 
</code></pre><p>One thing to be aware of: hiding logs behind progress bars when things go <em>well</em> makes it much easier for the user to understand what’s going on, but if there is an error, make sure you print out the logs.
Otherwise, it will be very hard to debug.</p>
<p><strong>Make things time out.</strong>
Allow network timeouts to be configured, and have a reasonable default so it doesn’t hang forever.</p>
<p><strong>Make it recoverable.</strong>
If the program fails for some transient reason (e.g. the internet connection went down), you should be able to hit <code>&lt;up&gt;</code> and <code>&lt;enter&gt;</code> and it should pick up from where it left off.</p>
<p><strong>Make it crash-only.</strong>
This is the next step up from idempotence.
If you can avoid needing to do any cleanup after operations, or you can defer that cleanup to the next run, your program can exit immediately on failure or interruption.
This makes it both more robust and more responsive.</p>
<p><em>Citation: <a href="https://lwn.net/Articles/191059/">Crash-only software: More than meets the eye</a>.</em></p>
<p><strong>People are going to misuse your program.</strong>
Be prepared for that.
They will wrap it in scripts, use it on bad internet connections, run many instances of it at once, and use it in environments you haven’t tested in, with quirks you didn’t anticipate.
(Did you know macOS filesystems are case-insensitive but also case-preserving?)</p>
<h3 id="future-proofing">Future-proofing</h3>
<p>In software of any kind, it’s crucial that interfaces don’t change without a lengthy and well-documented deprecation process.
Subcommands, arguments, flags, configuration files, environment variables: these are all interfaces, and you’re committing to keeping them working.
(<a href="https://semver.org/">Semantic versioning</a> can only excuse so much change; if you’re putting out a major version bump every month, it’s meaningless.)</p>
<p><strong>Keep changes additive where you can.</strong>
Rather than modify the behavior of a flag in a backwards-incompatible way, maybe you can add a new flag—as long as it doesn’t bloat the interface too much.
(See also: <a href="#arguments-and-flags">Prefer flags to args</a>.)</p>
<p><strong>Warn before you make a non-additive change.</strong>
Eventually, you’ll find that you can’t avoid breaking an interface.
Before you do, forewarn your users in the program itself: when they pass the flag you’re looking to deprecate, tell them it’s going to change soon.
Make sure there’s a way they can modify their usage today to make it future-proof, and tell them how to do it.</p>
<p>If possible, you should detect when they’ve changed their usage and not show the warning any more: now they won’t notice a thing when you finally roll out the change.</p>
<p><strong>Changing output for humans is usually OK.</strong>
The only way to make an interface easy to use is to iterate on it, and if the output is considered an interface, then you can’t iterate on it.
Encourage your users to use <code>--plain</code> or <code>--json</code> in scripts to keep output stable (see <a href="#output">Output</a>).</p>
<p><strong>Don’t have a catch-all subcommand.</strong>
If you have a subcommand that’s likely to be the most-used one, you might be tempted to let people omit it entirely for brevity’s sake.
For example, say you have a <code>run</code> command that wraps an arbitrary shell command:</p>
<pre><code>$ mycmd run echo "hello world"
</code></pre>
<p>You could make it so that if the first argument to <code>mycmd</code> isn’t the name of an existing subcommand, you assume the user means <code>run</code>, so they can just type this:</p>
<pre><code>$ mycmd echo "hello world"
</code></pre>
<p>This has a serious drawback, though: now you can never add a subcommand named <code>echo</code>—or <em>anything at all</em>—without risking breaking existing usages.
If there’s a script out there that uses <code>mycmd echo</code>, it will do something entirely different after that user upgrades to the new version of your tool.</p>
<p><strong>Don’t allow arbitrary abbreviations of subcommands.</strong>
For example, say your command has an <code>install</code> subcommand.
When you added it, you wanted to save users some typing, so you allowed them to type any non-ambiguous prefix, like <code>mycmd ins</code>, or even just <code>mycmd i</code>, and have it be an alias for <code>mycmd install</code>.
Now you’re stuck: you can’t add any more commands beginning with <code>i</code>, because there are scripts out there that assume <code>i</code> means <code>install</code>.</p>
<p>There’s nothing wrong with aliases—saving on typing is good—but they should be explicit and remain stable.</p>
<p><strong>Don’t create a “time bomb.”</strong>
Imagine it’s 20 years from now.
Will your command still run the same as it does today, or will it stop working because some external dependency on the internet has changed or is no longer maintained?
The server most likely to not exist in 20 years is the one that you are maintaining right now.
(But don’t build in a blocking call to Google Analytics either.)</p>
<h3 id="signals">Signals and control characters</h3>
<p><strong>If a user hits Ctrl-C (the INT signal), exit as soon as possible.</strong>
Say something immediately, before you start clean-up.
Add a timeout to any clean-up code so it can’t hang forever.</p>
<p><strong>If a user hits Ctrl-C during clean-up operations that might take a long time, skip them.</strong>
Tell the user what will happen when they hit Ctrl-C again, in case it is a destructive action.</p>
<p>For example, when quitting Docker Compose, you can hit Ctrl-C a second time to force your containers to stop immediately instead of shutting them down gracefully.</p>
<pre><code>$  docker-compose up
…
^CGracefully stopping... (press Ctrl+C again to force)
</code></pre><p>Your program should expect to be started in a situation where clean-up has not been run.
(See <a href="https://lwn.net/Articles/191059/">Crash-only software: More than meets the eye</a>.)</p>
<h3 id="configuration">Configuration</h3>
<p>Command-line tools have lots of different types of configuration, and lots of different ways to supply it (flags, environment variables, project-level config files).
The best way to supply each piece of configuration depends on a few factors, chief among them <em>specificity</em>, <em>stability</em> and <em>complexity</em>.</p>
<p>Configuration generally falls into a few categories:</p>
<ol>
<li>
<p>Likely to vary from one invocation of the command to the next.</p>
<p>Examples:</p>
<ul>
<li>Setting the level of debugging output</li>
<li>Enabling a safe mode or dry run of a program</li>
</ul>
<p>Recommendation: <strong>Use <a href="#arguments-and-flags">flags</a>.</strong>
<a href="#environment-variables">Environment variables</a> may or may not be useful as well.</p>
</li>
<li>
<p>Generally stable from one invocation to the next, but not always.
Might vary between projects.
Definitely varies between different users working on the same project.</p>
<p>This type of configuration is often specific to an individual computer.</p>
<p>Examples:</p>
<ul>
<li>Providing a non-default path to items needed for a program to start</li>
<li>Specifying how or whether color should appear in output</li>
<li>Specifying an HTTP proxy server to route all requests through</li>
</ul>
<p>Recommendation: <strong>Use <a href="#arguments-and-flags">flags</a> and probably <a href="#environment-variables">environment variables</a> too.</strong>
Users may want to set the variables in their shell profile so they apply globally, or in <code>.env</code> for a particular project.</p>
<p>If this configuration is sufficiently complex, it may warrant a configuration file of its own, but environment variables are usually good enough.</p>
</li>
<li>
<p>Stable within a project, for all users.</p>
<p>This is the type of configuration that belongs in version control.
Files like <code>Makefile</code>, <code>package.json</code> and <code>docker-compose.yml</code> are all examples of this.</p>
<p>Recommendation: <strong>Use a command-specific, version-controlled file.</strong></p>
</li>
</ol>
<p><strong>Follow the XDG-spec.</strong>
In 2010 the X Desktop Group, now <a href="https://freedesktop.org/">freedesktop.org</a>, developed a specification for the location of base directories where config files may be located.
One goal was to limit the proliferation of dotfiles in a user’s home directory by supporting a general-purpose <code>~/.config</code> folder.
The XDG Base Directory Specification (<a href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">full spec</a>, <a href="https://wiki.archlinux.org/index.php/XDG_Base_Directory#Specification">summary</a>) is supported by yarn, fish, wireshark, emacs, neovim, tmux, and many other projects you know and love.</p>
<p><strong>If you automatically modify configuration that is not your program’s, ask the user for consent and tell them exactly what you’re doing.</strong>
Prefer creating a new config file (e.g. <code>/etc/cron.d/myapp</code>) rather than appending to an existing config file (e.g. <code>/etc/crontab</code>).
If you have to append or modify to a system-wide config file, use a dated comment in that file to delineate your additions.</p>
<p><strong>Apply configuration parameters in order of precedence.</strong>
Here is the precedence for config parameters, from highest to lowest:</p>
<ul>
<li>Flags</li>
<li>The running shell’s environment variables</li>
<li>Project-level configuration (eg. <code>.env</code>)</li>
<li>User-level configuration</li>
<li>System wide configuration</li>
</ul>
<h3 id="environment-variables">Environment variables</h3>
<p><strong>Environment variables are for behavior that <em>varies with the context</em> in which a command is run.</strong>
The “environment” of an environment variable is the terminal session—the context in which the command is running.
So, an env var might change each time a command runs, or between terminal sessions on one machine, or between instantiations of one project across several machines.</p>
<p>Environment variables may duplicate the functionality of flags or configuration parameters, or they may be distinct from those things.
See <a href="#configuration">Configuration</a> for a breakdown of common types of configuration and recommendations on when environment variables are most appropriate.</p>
<p><strong>For maximum portability, environment variable names must only contain uppercase letters, numbers, and underscores (and mustn’t start with a number).</strong>
Which means <code>O_O</code> and <code>OWO</code> are the only emoticons that are also valid environment variable names.</p>
<p><strong>Aim for single-line environment variable values.</strong>
While multi-line values are possible, they create usability issues with the <code>env</code> command.</p>
<p><strong>Avoid commandeering widely used names.</strong>
Here’s a <a href="https://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap08.html">list of POSIX standard env vars</a>.</p>
<p><strong>Check general-purpose environment variables for configuration values when possible:</strong></p>
<ul>
<li><code>NO_COLOR</code>, to disable color (see <a href="#output">Output</a>)</li>
<li><code>DEBUG</code>, to enable more verbose output</li>
<li><code>EDITOR</code>, if you need to prompt the user to edit a file or input more than a single line</li>
<li><code>HTTP_PROXY</code>, <code>HTTPS_PROXY</code>, <code>ALL_PROXY</code> and <code>NO_PROXY</code>, if you’re going to perform network operations
(The HTTP library you’re using might already check for these.)</li>
<li><code>SHELL</code>, if you need to open up an interactive session of the user’s preferred shell
(If you need to execute a shell script, use a specific interpreter like <code>/bin/sh</code>)</li>
<li><code>TERM</code>, <code>TERMINFO</code> and <code>TERMCAP</code>, if you’re going to use terminal-specific escape sequences</li>
<li><code>TMPDIR</code>, if you’re going to create temporary files</li>
<li><code>HOME</code>, for locating configuration files</li>
<li><code>PAGER</code>, if you want to automatically page output</li>
<li><code>LINES</code> and <code>COLUMNS</code>, for output that’s dependent on screen size (e.g. tables)</li>
</ul>
<p><strong>Read environment variables from <code>.env</code> where appropriate.</strong>
If a command defines environment variables that are unlikely to change as long as the user is working in a particular directory,
then it should also read them from a local <code>.env</code> file so users can configure it differently for different projects without having to specify them every time.
Many languages have libraries for reading <code>.env</code> files (<a href="https://crates.io/crates/dotenv">Rust</a>, <a href="https://www.npmjs.com/package/dotenv">Node</a>, <a href="https://github.com/bkeepers/dotenv">Ruby</a>).</p>
<p><strong>Don’t use <code>.env</code> as a substitute for a proper <a href="#configuration">configuration file</a>.</strong>
<code>.env</code> files have a lot of limitations:</p>
<ul>
<li>A <code>.env</code> file is not commonly stored in source control</li>
<li>(Therefore, any configuration stored in it has no history)</li>
<li>It has only one data type: string</li>
<li>It lends itself to being poorly organized</li>
<li>It makes encoding issues easy to introduce</li>
<li>It often contains sensitive credentials &amp; key material that would be better stored more securely</li>
</ul>
<p>If it seems like these limitations will hamper usability or security, then a dedicated config file might be more appropriate.</p>
<p><strong>Do not read secrets from environment variables.</strong>
While environment variables may be convenient for storing secrets, they have proven too prone to leakage:</p>
<ul>
<li>Exported environment variables are sent to every process, and from there can easily leak into logs or be exfiltrated</li>
<li>Shell substitutions like <code>curl -H "Authorization: Bearer $BEARER_TOKEN"</code> will leak into globally-readable process state.
(cURL offers the <code>-H @filename</code> alternative for reading sensitive headers from a file.)</li>
<li>Docker container environment variables can be viewed by anyone with Docker daemon access via <code>docker inspect</code></li>
<li>Environment variables in systemd units are globally readable via <code>systemctl show</code></li>
</ul>
<p>Secrets should only be accepted via credential files, pipes, <code>AF_UNIX</code> sockets, secret management services, or another IPC mechanism.</p>
<h3 id="naming">Naming</h3>
<p>The name of your program is particularly important on the CLI: your users will be typing it all the time, and it needs to be easy to remember and type.</p>
<p><strong>Make it a simple, memorable word.</strong>
But not too generic, or you’ll step on the toes of other commands and confuse users.
For example, both ImageMagick and Windows used the command <code>convert</code>.</p>
<p><strong>Use only lowercase letters, and dashes if you really need to.</strong>
<code>curl</code> is a good name, <code>DownloadURL</code> is not.</p>
<p><strong>Keep it short.</strong>
Users will be typing it all the time.
Don’t make it <em>too</em> short: the very shortest commands are best reserved for the common utilities used all the time, such as <code>cd</code>, <code>ls</code>, <code>ps</code>.</p>
<p><strong>Make it easy to type.</strong>
Some words flow across the QWERTY keyboard much more easily than others, and it’s not just about brevity.
<code>plum</code> may be short but it’s an awkward, angular dance.
<code>apple</code> trips you up with the double letter.
<code>orange</code> is longer than both, but flows much better.</p>
<p><em>Further reading: <a href="https://smallstep.com/blog/the-poetics-of-cli-command-names/">The Poetics of CLI Command Names</a></em></p>
<h3 id="distribution">Distribution</h3>
<p><strong>If possible, distribute as a single binary.</strong>
If your language doesn’t compile to binary executables as standard, see if it has something like <a href="https://www.pyinstaller.org/">PyInstaller</a>.
If you really can’t distribute as a single binary, use the platform’s native package installer so you aren’t scattering things on disk that can’t easily be removed.
Tread lightly on the user’s computer.</p>
<p>If you’re making a language-specific tool, such as a code linter, then this rule doesn’t apply—it’s safe to assume the user has an interpreter for that language installed on their computer.</p>
<p><strong>Make it easy to uninstall.</strong>
If it needs instructions, put them at the bottom of the install instructions—one of the most common times people want to uninstall software is right after installing it.</p>
<h3 id="analytics">Analytics</h3>
<p>Usage metrics can be helpful to understand how users are using your program, how to make it better, and where to focus effort.
But, unlike websites, users of the command-line expect to be in control of their environment, and it is surprising when programs do things in the background without telling them.</p>
<p><strong>Do not phone home usage or crash data without consent.</strong>
Users will find out, and they will be angry.
Be very explicit about what you collect, why you collect it, how anonymous it is and how you go about anonymizing it, and how long you retain it for.</p>
<p>Ideally, ask users whether they want to contribute data (“opt-in”).
If you choose to do it by default (“opt-out”), then clearly tell users about it on your website or first run, and make it easy to disable.</p>
<p>Examples of projects that collect usage statistics:</p>
<ul>
<li>Angular.js <a href="https://angular.io/analytics">collects detailed analytics using Google Analytics</a>, in the name of feature prioritization.
You have to explicitly opt in.
You can change the tracking ID to point to your own Google Analytics property if you want to track Angular usage inside your organization.</li>
<li>Homebrew sends metrics to Google Analytics and has <a href="https://docs.brew.sh/Analytics">a nice FAQ</a> detailing their practices.</li>
<li>Next.js <a href="https://nextjs.org/telemetry">collects anonymized usage statistics</a> and is enabled by default.</li>
</ul>
<p><strong>Consider alternatives to collecting analytics.</strong></p>
<ul>
<li>Instrument your web docs.
If you want to know how people are using your CLI tool, make a set of docs around the use cases you’d like to understand best, and see how they perform over time.
Look at what people search for within your docs.</li>
<li>Instrument your downloads.
This can be a rough metric to understand usage and what operating systems your users are running.</li>
<li>Talk to your users.
Reach out and ask people how they’re using your tool.
Encourage feedback and feature requests in your docs and repos, and try to draw out more context from those who submit feedback.</li>
</ul>
<p><em>Further reading: <a href="https://opensource.guide/metrics/">Open Source Metrics</a></em></p>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/The_Unix_Programming_Environment">The Unix Programming Environment</a>, Brian W. Kernighan and Rob Pike</li>
<li><a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html">POSIX Utility Conventions</a></li>
<li><a href="https://www.gnu.org/prep/standards/html_node/Program-Behavior.html">Program Behavior for All Programs</a>, GNU Coding Standards</li>
<li><a href="https://medium.com/@jdxcode/12-factor-cli-apps-dd3c227a0e46">12 Factor CLI Apps</a>, Jeff Dickey</li>
<li><a href="https://devcenter.heroku.com/articles/cli-style-guide">CLI Style Guide</a>, Heroku</li>
</ul>

    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[We might want to regularly keep track of how important each server is (182 pts)]]></title>
            <link>https://utcc.utoronto.ca/~cks/space/blog/sysadmin/TrackingMachineImportance</link>
            <guid>39272952</guid>
            <pubDate>Tue, 06 Feb 2024 10:51:37 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/TrackingMachineImportance">https://utcc.utoronto.ca/~cks/space/blog/sysadmin/TrackingMachineImportance</a>, See on <a href="https://news.ycombinator.com/item?id=39272952">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><h2>We might want to regularly keep track of how important each server is</h2>

	<p><small>February  5, 2024</small></p>
</div><div><p>Today <a href="https://mastodon.social/@cks/111881322231361439">we had a significant machine room air conditioning failure
in our main machine room</a>,
one that certainly couldn't be fixed on the spot ('glycol all over
the roof' is not a phrase you really want to hear about your AC's
chiller). To keep the machine room's temperature down, we had to
power off as many machines as possible without too badly affecting
the services we offer to people here, <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/OurDifferentSysadminEnvironment">which are rather varied</a>. Some choices were obvious; all
of <a href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/SlurmHowWeUseIt">our SLURM nodes</a> that were in the main machine
room got turned off right away. But others weren't things we
necessarily remembered right away or we weren't clear if they were
safe to turn off and what effects it would have. In the end we took
several rounds of turning servers off, looking at what was left,
spotting remaining machines, and turning more things off, and we're
probably not done yet.</p>

<p>(We have secondary machine room space and we're probably going to
have to evacuate servers into it, too.)</p>

<p>One thing we could do to avoid this flailing in the future is to
explicitly (try to) keep track of which machines are important and
which ones aren't, to pre-plan which machines we could shut down
if we had a limited amount of cooling or power. If we documented
this, we could avoid having to wrack our brains at the last minute
and worry about dependencies or uses that we'd forgotten. Of course
documentation isn't free; there's an ongoing amount of work to write
it and keep it up to date. But possibly we could do this work as
part of deploying machines or changing their configurations.</p>

<p>(This would also help identify machines that we didn't need any
more but hadn't gotten around to taking out of service, which we
found a couple of in this iteration.)</p>

<p>Writing all of this just in case of further AC failures is probably
not all that great a choice of where to spend our time. But writing
down this sort of thing can often help to clarify how your environment
is connected together in general, including things like what will
probably break or have problems if a specific machine (or service)
is out, and perhaps which people depend on what service. This can
be valuable information in general. The machine room archaeology
of 'what is this machine, why is it on, and who is using it' can
be fun occasionally, but you probably don't want to do it regularly.</p>

<p>(Will we actually do this? I suspect not. When we deploy and start
using a machine its purpose and so on feel obvious, because we have
all of the context.)</p>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Will Satellite Megaconstellations Weaken Earth's Magnetic Field? (115 pts)]]></title>
            <link>https://spaceweatherarchive.com/2024/02/01/will-satellite-megaconstellations-weaken-earths-magnetic-field/</link>
            <guid>39272884</guid>
            <pubDate>Tue, 06 Feb 2024 10:40:05 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://spaceweatherarchive.com/2024/02/01/will-satellite-megaconstellations-weaken-earths-magnetic-field/">https://spaceweatherarchive.com/2024/02/01/will-satellite-megaconstellations-weaken-earths-magnetic-field/</a>, See on <a href="https://news.ycombinator.com/item?id=39272884">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="page">
		<main id="main" role="main">

					
			
<article id="post-6655">
	<!-- .entry-header -->

	<div>
		
<div><p><strong>Feb. 1, 2024:</strong> Something unprecedented is happening in Earth orbit. In only a few short years, the satellite population has skyrocketed, more than doubling since 2020. In the past year alone, more satellites have been launched than during the first thirty years of the Space Age. Much of this activity is driven by SpaceX and its growing mega-constellation of Starlink internet satellites.</p><p>Environmentalists have raised many concerns about Starlink including <a href="https://cps.iau.org/">light-pollution</a> of the night sky, a potentially hazardous <a href="https://www.nytimes.com/interactive/2023/11/08/magazine/space-traffic-jam.html">traffic jam</a> in low-Earth orbit, and even <a href="https://www.space.com/starlink-satellite-reentry-ozone-depletion-atmosphere">ozone depletion</a>. Copycat mega-constellations by other companies and countries will only multiply these concerns.</p><p>Now there’s a new reason to worry. According to <a href="https://arxiv.org/abs/2312.09329">a new study</a> by Sierra Solter, megaconstellations could alter and weaken Earth’s magnetic field.</p></div>


<div>
<figure><img data-attachment-id="6658" data-permalink="https://spaceweatherarchive.com/2024/02/01/will-satellite-megaconstellations-weaken-earths-magnetic-field/figure1_crop/" data-orig-file="https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg" data-orig-size="560,399" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="figure1_crop" data-image-description="" data-image-caption="" data-medium-file="https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg?w=300" data-large-file="https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg?w=560" width="560" height="399" src="https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg?w=560" alt="" srcset="https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg 560w, https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg?w=150 150w, https://spaceweatherarchive.files.wordpress.com/2024/02/figure1_crop.jpg?w=300 300w" sizes="(max-width: 560px) 100vw, 560px"></figure></div>


<div><p>Solter is a graduate student at the University of Iceland, working on her PhD in plasma physics. She recently realized something overlooked by many senior colleagues: “More than 500,000 satellites are expected in decades ahead, primarily to build internet megaconstellations. Every satellite that goes up will eventually come down, disintegrating in Earth’s atmosphere. This will create a massive layer of conducting, electrically charged particles around our planet.”</p><p>To understand the scale of the problem, consider the following: If you gathered up every charged particle in Earth’s Van Allen Belts, their combined mass would be only <a href="https://spacemath.gsfc.nasa.gov/weekly/5Page46.pdf">0.00018 kg</a>. Other components of the magnetosphere such as the ring current and plasmasphere are even less massive. For comparison, “the mass of a second generation Starlink satellite is 1250 kilograms, all of which will become conductive debris when the satellite is eventually de-orbited,” says Solter.</p><p>Metal debris from a single deorbited Starlink satellite is <strong>7 million times</strong> more massive than the Van Allen Belts. An entire megaconstellation is <strong>billions of times</strong> more massive. These ratios point to a big problem.</p></div>



<p>“The space industry is adding enormous amounts of material to the magnetosphere in comparison to  natural levels of particulate matter,” says Solter. “Due to the conductive nature of the satellite debris, this may perturb or change things.”</p>



<p>There is already evidence of this process in action. <a href="https://www.pnas.org/doi/10.1073/pnas.2313374120">A 2023 study</a> by researchers using a high-altitude NASA aircraft found that 10% of aerosols in the stratosphere contain aluminum and other metals from disintegrating satellites and rocket stages. These particles are drifting down from “the ablation zone” 70 to 80 km above Earth’s surface where meteors and satellites burn up.</p>



<p>Solter decided to look for changes in the electrical properties of the ablation zone–and she found something. A NASA model of the upper atmosphere shows a sharp increase in the “Debye Length” just where satellites break apart when they deorbit:</p>



<figure><img data-attachment-id="6657" data-permalink="https://spaceweatherarchive.com/2024/02/01/will-satellite-megaconstellations-weaken-earths-magnetic-field/debyelength_crop/" data-orig-file="https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg" data-orig-size="573,432" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="debyelength_crop" data-image-description="" data-image-caption="" data-medium-file="https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg?w=300" data-large-file="https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg?w=573" width="573" height="432" src="https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg?w=573" alt="" srcset="https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg 573w, https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg?w=150 150w, https://spaceweatherarchive.files.wordpress.com/2024/02/debyelength_crop.jpg?w=300 300w" sizes="(max-width: 573px) 100vw, 573px"></figure>



<p>“Debye Length” is a number that tells researchers how far an unbalanced electrical charge can be felt in conducting plasmas. The fact that it changes abruptly in the same place satellites disintegrate may be significant.</p>



<p>Extrapolating into the future, Solter worries that satellite debris could weaken Earth’s magnetic field–the same magnetic field that protects us from cosmic rays and solar storms.</p>



<p>“It’s a textbook undergraduate physics problem,” she explains. “Suppose you put a conductive shell (satellite debris) around a spherical magnet (Earth). Outside the shell, the magnetic field goes to zero due to shielding effects. This is a highly simplified comparison, of course, but we might actually be doing this to our planet.”&nbsp;&nbsp;</p>



<p>Solter’s preliminary study appears to show that the space industry is indeed perturbing the environment.&nbsp; “It is very concerning,” she concludes. “We absolutely cannot dump endless amounts of conductive dust into the magnetosphere and not expect some kind of impact. Multidisciplinary studies of this pollution are urgently needed.”</p>



<p>For more information, you can read Solter’s original research <a href="https://arxiv.org/pdf/2312.09329.pdf">here</a>.</p>
			</div><!-- .entry-content -->

	<!-- .entry-meta -->
</article><!-- #post-## -->

				<!-- .navigation -->
	
			
<!-- #comments -->

		
		</main><!-- #main -->
	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Destruction of nuclear bombs using ultra-high energy neutrino beam (2003) [pdf] (128 pts)]]></title>
            <link>https://arxiv.org/pdf/hep-ph/0305062.pdf</link>
            <guid>39271472</guid>
            <pubDate>Tue, 06 Feb 2024 06:42:55 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://arxiv.org/pdf/hep-ph/0305062.pdf">https://arxiv.org/pdf/hep-ph/0305062.pdf</a>, See on <a href="https://news.ycombinator.com/item?id=39271472">Hacker News</a></p>
&lt;Not HTML&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[OKRs Are Bullshit (268 pts)]]></title>
            <link>https://blog.appliedcomputing.io/p/okrs-are-bullshit</link>
            <guid>39271083</guid>
            <pubDate>Tue, 06 Feb 2024 05:25:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.appliedcomputing.io/p/okrs-are-bullshit">https://blog.appliedcomputing.io/p/okrs-are-bullshit</a>, See on <a href="https://news.ycombinator.com/item?id=39271083">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg" width="735" height="500" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/bef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:500,&quot;width&quot;:735,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:72261,&quot;alt&quot;:&quot;Buzz and Woody meme; Buzz says \&quot;OKRs!  OKRs are everywhere!\&quot; and Woody looks terrified&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/jpeg&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null}" alt="Buzz and Woody meme; Buzz says &quot;OKRs!  OKRs are everywhere!&quot; and Woody looks terrified" title="Buzz and Woody meme; Buzz says &quot;OKRs!  OKRs are everywhere!&quot; and Woody looks terrified" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbef1a329-3d3f-46fb-9d49-48ce38035415_735x500.jpeg 1456w" sizes="100vw" fetchpriority="high"></picture></div></a></figure></div><p><span>It's a new year, time for a new rant</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-1-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-1-141320305" target="_self" rel="">1</a></span><span>! And yes, before you ask, the post title is deliberately provocative. You might say this is my ploy to get more paid subscribers, because only paid subscribers can leave comments and I expect that the title alone will make many of you want to comment. 😝</span></p><p><span>Anyways, I expect that many of my readers just finished up their quarterly (and/or yearly) planning cycle, so I thought this would be a good time to remind you all that the process we've all settled on in the tech industry is nonsense: I am, of course, referring to the </span><a href="https://en.wikipedia.org/wiki/Objectives_and_key_results" rel="">Objectives and Key Results</a><span> framework. So let's talk about OKRs, what they are and where they come from, and why they're a terrible idea</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-2-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-2-141320305" target="_self" rel="">2</a></span><span>.</span></p><p>The OKR framework was originally developed by Google back in—</p><p>Wait a minute, I just read the Wikipedia article I linked in the previous section, and it turns out I'm starting this off not only by being rude, but also spreading misinformation! How could I. Let's try this again.</p><p><span>OKRs were introduced by Andrew Grove at Intel, all the way back in the 1970s! He wrote about them in a book on management in 1983, and later they were introduced at Google, I guess sometime in the early 2000s. And while Google didn't </span><em>invent</em><span> the concept of OKRs, Google certainly helped popularize them</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-3-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-3-141320305" target="_self" rel="">3</a></span><span>. Now it doesn't matter where you go, every company has OKRs. The term has become like "Kleenex"—it's used ubiquitously to mean "planning", regardless of how similar or not the planning process actually is to the original OKR framework</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-4-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-4-141320305" target="_self" rel="">4</a></span><span>.</span></p><p><span>So with the backstory out of the way, what </span><em>are</em><span> OKRs? In short, they're a way of goal-setting and then measuring your progress towards the goals. The "Objective" is your goal, and the "Key Results" are the things you need to accomplish to know whether you've hit your goal. Of course because we want to be data-driven organizations, the key results need to be measurable and metrics-based.</span></p><p>Typically, OKRs are supposed to be cascading. In other words, the CEO (or whoever's in charge) sets some OKRs for the organization as a whole, and then the individual business units set OKRs that support the global OKRs, and then each team sets OKRs that support the business unit's, and (potentially) each team member sets their own personal OKRs. At each level, you should have between one and three objectives, which are short statements about "what" you want to accomplish in the next quarter, or year, or whatever, and each objective should have between one and three key results which indicate the success or failure of the objective.</p><p><span>In addition to the core framework, there are a few guiding principles that organizations should use when setting OKRs. Most (in)famously, you should set your OKRs so you only achieve 70% of them. If you're consistently hitting 100% on your goals, that means you're not being ambitious enough. Secondly, you should avoid "binary" OKRs, that is, OKRs whose only metric is "I did the thing" or "I didn't do the thing". Thirdly, OKRs aren't supposed to encompass all of your organization's activities: normal, day-to-day maintenance work, on-call support, etc. are "extra" things that don't get captured by your OKRs</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-5-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-5-141320305" target="_self" rel="">5</a></span><span>. And lastly, the only way to learn OKRs is by doing OKRs.</span></p><p><span>Now, some of you are all prepared to whip out your credit cards and subscribe so you that you can angrily tell me that I've got it all wrong and that I don't understand the framework at all. That's fine—I'm happy to have you as a subscriber, but I think gets at my fundamental complaint about the OKR framework: if the "only way to learn OKRs is by doing OKRs", then by definition everybody is gonna do OKRs differently, which means that in practice the framework becomes whatever you want it to become. But then, when anybody comes out with </span><em>any</em><span> criticism of the OKR process, the response is always, in classic "</span><a href="https://en.wikipedia.org/wiki/No_true_Scotsman" rel="">no true Scotsman</a><span>" style, "well, you're just not doing OKRs correctly." But I guess my question is: if nobody in the industry does OKRs "correctly", why are we still trying to do them at all?</span></p><p><span>Now look: I'm not arguing that we shouldn't have goals. I'm not arguing that we shouldn't make plans and try to hold ourselves accountable to those plans. We absolutely should! Engineers like to rage against process, bureaucracy, and friction, but I'll be the first to tell you that—especially in larger organizations—</span><em>some</em><span> process is important. My only point in this article is to hopefully convince you that OKRs ain't it.</span></p><p>So let's talk about the problems with OKRs. I want to preface this section by saying that my background is an infra engineer, and a lot of the points I make come from that perspective. But I've heard enough similar complaints from product people that I think my objections are valid in that setting as well.</p><p><span>First of all, let's start with the frankly ridiculous claim that you should target 70% completion for your OKRs. Setting aside the fact that this is very nebulous (should you complete 70% of your goals to 100%? Or should you complete 100% of your goals at 70%?) consider that much of the work we do doesn't actually have any value unless you do it </span><em>all the way</em><span>. Now maybe if your key result was "increase clickthrough rate by 100%" and you only increased it by 70%, you could argue that is still pretty good. But if your key result is "migrate 100% of users to the new system" and you only migrate 70%, guess what? Now you're stuck maintaining two systems in perpetuity. Fortunately, I haven't heard people espouse this tenet as much lately—I think people are realizing that it incentivizes the wrong things.</span></p><p><span>But this leads us straight into the second problem with OKRs: actually measuring things. Some people might argue that the migration example I used above is actually bad because it's a binary OKR—either you migrated or you didn't. This leads to all kinds of contortions to develop a metric that still says "I migrated the thing" but isn't binary. Maybe you interview your customers and you want 100% of them to be happy on the new thing, but you'll count it as a success if only 70% of them are happy. Or maybe you measure the number of outages caused by the new thing, and your goal is "zero outages"</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-6-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-6-141320305" target="_self" rel="">6</a></span><span>.</span></p><p><span>However, there are additional problems here: one is that you just invented a bunch of extra work for yourself, because chances are whatever metric you concocted to measure your migration success didn't exist before: so you have to go build some tooling to collect the metric before you can even start working on the actual thing you care about—tooling and metrics that will probably languish and be forgotten about in a quarter or two after priorities change. Another is that often, the metrics you invent have no relation to the work you're doing—the happiness (or not) of your users probably has between five and zero percent to do with how good a job you did on the migration, and is 90% related to whether or not the new system was well-designed by somebody else who probably isn't even at the company anymore. A third is that some of these metrics are really hard to reason about. For example, in the "number of outages" metric, your target value is 0, which means that if you have </span><em>any outages at all</em><span> your score for that key result is undefined. You have to divide the number of outages you had by zero to get your percentage. Congratulations! Your metric value is whatever you want it to be!</span></p><p><span>I think the biggest problem with OKR's laser focus on measurement, though, is that </span><em>not everything should be measured</em><span>, even if you can! Being "data-driven" is a huge buzzword in the industry. We want to improve, we want to see how much we improved by, and then we want to tell the world how much we improved by so our stock price goes up. But there's a tremendous amount of work that shouldn't or can't be measured, or is very easy to misinterpret even if you </span><em>can</em><span> measure it. I think this article by Richard Marmorstein sums it up really nicely: </span><a href="https://twitchard.github.io/posts/2022-08-26-metrics-schmetrics.html" rel="">be good-argument driven, not data-driven</a><span>. Being data-driven requires a) that you have the metrics, b) that you know enough statistics to interpret the metrics correctly, and c) that you don't care about anything that can't be measured.</span></p><p>The last complaint I have about OKRs comes from their cascading nature. As an industry, we mostly rejected waterfall-style development a long time ago, and then promptly introduced a planning framework that encourages waterfall-style development. There's no room in the OKR framework for research or experimentation (because how do you measure research?), so you have to know what you want to do in excruciating detail at the point when you write down your OKR, because otherwise something might come up that prevents you from completing (or even getting 70%) on your OKR. But raise your hand if you've ever written down all your OKRs and then two months into the cycle, something comes up that obsoletes all of your goals.</p><p><span>"But wait, you're just doing it wrong!" I can hear you exclaim from here. "You're supposed to be agile! OKRs can change! You should react to new information!" Right, yep, I've heard that one before. But I can guarantee you that come performance review time, the people who decide whether you're being successful or not as an engineer are going to grade you on your original goals for the year, and if you have to change them it's going to be viewed as a failure. I mean, maybe this doesn't happen </span><em>everywhere</em><span>, but it will require a significant amount of cultural backpressure to prevent this outcome. So maybe just let's use a planning process that actually has room for change built in, instead of trying to shoehorn in one that just doesn't work.</span></p><p>You know what I didn't talk about at all in this blog post? Spreadsheets. Nowhere in the OKR framework does it say that you should list all your objectives and key results in a spreadsheet, and then check in on the metrics every month by updating some values in the spreadsheet. Nobody ever said that you should have a JIRA epic for your objectives, and then track all your tickets by which OKR they belong to. Nobody ever said anything about "internal OKRs" versus "external OKRs" or roadmaps or planning meetings or… the list goes on.</p><p><span>And yet, my prediction is that every single manager in existence, as soon as they hear “OKR” will immediately think "spreadsheet"</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-7-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-7-141320305" target="_self" rel="">7</a></span><span>. And I think that's a problem too. See, as an industry, we've conflated "OKRs" with "planning", when I don't think they should be conflated at all. Even if you brush aside all the problems I pointed out with OKRs in the previous section, and go back to the original (or at least, "original" as "made popular by Google") definition, the purpose of OKRs is to be aspirational. That's where the whole 70% thing comes from in the first place. We want to set hard goals that will inspire people to do their best work, and then recognize that the goals were hard and not penalize people for failing to meet them 100% of the way.</span></p><p><span>And honestly? When taken through that lens, I love OKRs</span><span><a data-component-name="FootnoteAnchorToDOM" id="footnote-anchor-8-141320305" href="https://blog.appliedcomputing.io/p/okrs-are-bullshit#footnote-8-141320305" target="_self" rel="">8</a></span><span>! We </span><em>should</em><span> be trying to do hard things, and we shouldn't be punishing folks when they fail at them. And, also: we </span><em>should</em><span> have a plan, and we should understand the work that we're going to be doing over the next few weeks-to-months, and </span><em>maybe</em><span> we need a spreadsheet or something to help manage that plan. But please, for the love of god, let's stop trying to shove metrics into our goal-setting framework, let's stop shoving our goal-setting framework into our quarterly planning process, and let's stop spending months on end planning only to have the whole thing upended two days into the cycle.</span></p><p>Anyways, that's all I've got for now. I promise next week I'll be less inflammatory.</p><p>Thanks for reading,</p><p>~drmorr</p></div></article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Vision 1993 (103 pts)]]></title>
            <link>https://www.tbray.org/ongoing/When/202x/2024/02/02/Vision-1993</link>
            <guid>39270681</guid>
            <pubDate>Tue, 06 Feb 2024 04:09:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.tbray.org/ongoing/When/202x/2024/02/02/Vision-1993">https://www.tbray.org/ongoing/When/202x/2024/02/02/Vision-1993</a>, See on <a href="https://news.ycombinator.com/item?id=39270681">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="centercontent">
<p itemprop="description">I’ve plowed through the first wave of AVP (Apple Vision Pro) reviews, and it seems pretty obvious that, at the current price
    and form factor, it’s not gonna be a best-seller.  But I remain a strong believer in Augmented Reality (the AVP is
    VR not AR, for the moment). As I was diving into the reviews, a little voice in the back of my head kept saying “I once read about
    what this is trying to be.”</p>

<p><img alt="William Gibson’s Virtual Light" title="William Gibson’s Virtual Light" src="https://www.tbray.org/ongoing/When/202x/2024/02/02/original.png"></p><p>What I was remembering was
    <a href="https://en.wikipedia.org/wiki/Virtual_Light">Virtual Light</a>, a 1993 novel by William Gibson, allegedly set in
    2006. It paints a clear picture of a future that includes AVP’s descendants. So I re-read it. Maybe looking back is the way to
    look forward.</p>

<p id="p-1"><span>But first…</span> · 
I wanted to say: It’s a terrific book! If you haven’t read you might really like it. I hadn’t in years and I sure
    enjoyed the re-read. The people in it are charming, and it’s built around a fabulous physical artifact that drives the plot. No, I
    don’t mean AR goggles, I mean San Francisco’s Bay Bridge, which in <cite>Virtual Light</cite> and
    <a href="https://en.wikipedia.org/wiki/Bridge_trilogy">two subsequent novels</a>, has
    been wrecked by an earthquake and become a huge countercultural shantytown, one of the coolest venues Gibson has ever
    invented, and that’s a strong statement. Also, protagonists Chevette and Rydell are two of his best characters; another
    strong statement.</p>

<p><img alt="William Gibson’s Virtual Light" title="William Gibson’s Virtual Light" src="https://www.tbray.org/ongoing/When/202x/2024/02/02/pink-face.png"></p><p>Anyhow, I don’t think it’s much of a spoiler to say that the AR devices I’m writing about, despite being what the title
    refers to, are peripheral to the plot. It turns out that one such device contains information that’s secret enough to attract
    hired killers, skip tracers, and crooked Homicide cops to recover it when it gets stolen; plenty of plot fuel right there.</p>

<p id="p-2"><span>Quoting</span> · 
Here are a few out-takes from the book describing the titular technology.</p>

<p>Quote:</p>

<blockquote>
<p>Nothing in it but a pair of sunglasses, expensive-looking but so dark she hadn’t even been able to see through them last
      night.</p>

</blockquote>
<p>Quote:</p>

<blockquote>
<p>…she took that case out.</p>

<p>You couldn’t tell what it was made of, and that meant expensive. Something dark gray, like the lead in a pencil, thin as the
      shell of one of those eggs, but you could probably drive a truck over it… She’d figured out how you opened it the night
      before: finger here, thumb there. It opened. No catch or anything, no spring… Inside was like black suede, but it gave like
      foam under your finger.</p>

<p>Those glasses, nested there. Big and black. Like that Orbison in the poster… She pulled them from the black suede… They
      bothered her …&nbsp;they weighed too much. Way too heavy for what they were, even with the big earpieces. The frames looked as
      though they’d been carved from slabs of graphite.</p>

<p>She put them on. Black. Solid black.</p>

<p>“Katharine Hepburn.” Skinner said.</p>

</blockquote>
<p>Quote:</p>

<blockquote><p>Warbaby wore a black Stetson set dead level on his head, the brim turned up all the way around, and glasses with
    heavy black frames. Clear lenses, windowpane plain.</p>
</blockquote>
<p>Quote:</p>

<blockquote><p>“You date you some architects, some brain-surgeons, you’d know what those are… Those <em>VL</em> glasses. Virtual
    light.”</p>

<p>“They expensive, Sammy Sal?”</p>

<p>“Shit, yes. ’Bout as much as a Japanese car… Got these little EMP-drivers around the lenses, work your optic nerves
    direct. Friend of mine, he’d bring a pair home from the office where he worked. Landscape architects. Put ’em on, you go out
    walking, everything looks normal, but every plant you see, every tree, there’s this little label hanging there, what its name
    is. Latin under that…”</p>
</blockquote>
<p>Quote (at a crime scene with Warbaby and Freddie):</p>

<blockquote><p>Rydell noticed the weight as he slid them on. Pitch black. Then there was a stutter of soft fuzzy ball-lightning,
    like what you saw when you rubbed your eyes in the dark, and he was looking at Warbaby. Just behind Warbaby, hung on some
    invisible wall, were words, numbers, bright yellow. They came into focus as he looked at them, somehow losing Warbaby, and he
    saw that they were forensic stats.</p>

<p>“Or,” Freddie said, “you can just be here <em>now</em> —”</p>

<p>And the bed was back, sodden with blood, the man’s soft, heavy corpse splayed out like a frog. That thing beneath his chin,
    blue-black, bulbous.</p>

<p>Rydell’s stomach heaved, bile rose in his throat, and then a naked woman rolled up from another bed, in a different room, her
    hair like silver in some impossible moonlight—</p>

<p>Rydell yanked the glasses off…</p>
</blockquote>
<p>Quote:</p>

<blockquote><p>“Here. Check it out.” He put them on her.</p>

<p>She was facing the city when he did it. Financial district… “Fuck a <em>duck</em>,” she said, those towers blooming there,
    buildings bigger than anything, a stone regular grid of them, marching in from the hills. Each one maybe four blocks at the
    base, rising straight and featureless to spreading screens likke the colander she used to steam vegetables. Then Chinese writing
    filled the sky.</p>

</blockquote>
<p id="p-3"><span>Hmmm…</span> · 
What does Gibson’s 30-year-old vision teach us?</p>

<ul>
<li><p>The devices are still heavier than you’d like, but light enough to wear all the time out in the real world.</p>
</li>
<li><p>Still expensive.</p>
</li>
<li><p>They look super-cool.</p>
</li>
<li><p>They are transparent while in use.</p>
</li>
<li><p>You can use them to show pictures or share information the way you would today by handing over a phone or
      tablet.</p>
</li>
<li><p>How you get information <em>into</em> them was as un-solved in 1993 as it is today.</p>
</li>
<li><p>But the real core value is the “A” in “AR”<span> —</span> <em>augmenting</em> an aspect of the real
      world that you’re looking at. Even if only by hanging text labels on it.</p>
</li>
</ul>
<p>For me, that last point is at the center of everything. I want to be in a park at night and see fiery snakes climbing all the
    trees. I want to walk into a big-box store and have a huge glowing balloon appear over the Baking Supplies. I want floating
    labels to attach to all the different parts of the machine I’m trying to fix.</p>

<p>Watching TV, by yourself, on a huge screen, is not the future. Augmenting reality is.</p>

<p>The AVP? Some of its tech constitutes
    necessary but far from sufficient steps on the way from here to that 1993 vision.</p>

<hr>


<hr>

</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[LineageOS is currently installed on 1.5M Android devices (213 pts)]]></title>
            <link>https://9to5google.com/2023/11/20/lineageos-number-of-devices/</link>
            <guid>39270215</guid>
            <pubDate>Tue, 06 Feb 2024 02:54:19 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://9to5google.com/2023/11/20/lineageos-number-of-devices/">https://9to5google.com/2023/11/20/lineageos-number-of-devices/</a>, See on <a href="https://news.ycombinator.com/item?id=39270215">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
					
<figure>
			<img src="https://9to5google.com/wp-content/uploads/sites/4/2023/03/Lineage-OS-20-setup.jpg?quality=82&amp;strip=all&amp;w=1250" srcset="https://i0.wp.com/9to5google.com/wp-content/uploads/sites/4/2023/03/Lineage-OS-20-setup.jpg?w=320&amp;quality=82&amp;strip=all&amp;ssl=1 320w, https://i0.wp.com/9to5google.com/wp-content/uploads/sites/4/2023/03/Lineage-OS-20-setup.jpg?w=640&amp;quality=82&amp;strip=all&amp;ssl=1 640w, https://i0.wp.com/9to5google.com/wp-content/uploads/sites/4/2023/03/Lineage-OS-20-setup.jpg?w=1024&amp;quality=82&amp;strip=all&amp;ssl=1 1024w, https://i0.wp.com/9to5google.com/wp-content/uploads/sites/4/2023/03/Lineage-OS-20-setup.jpg?w=1500&amp;quality=82&amp;strip=all&amp;ssl=1 1500w" width="1250" height="625" alt="" fetchpriority="high">
	
	</figure>

<p>The custom ROM scene for Android devices isn’t nearly what it once was, but down to today, 1.5 million devices are currently running on LineageOS.</p>



<p>LineageOS is the project that took up the work of the once-great CyanogenMod, with the custom ROM having debuted its first builds back in 2016 and still running down to today. LineageOS is available on a <a href="https://wiki.lineageos.org/devices/">variety of different devices</a> from different Android brands, including Google, Fairphone, Samsung, OnePlus, Xiaomi, and more. It even keeps some long-gone brands going, like Essential and LG.</p>



<p>But how popular is LineageOS <em>really</em>?</p>



<p>That’s a question we have an answer to, thanks to a recent podcast episode.</p>



<p>David Imel of MKBHD’s WVFRM podcast sat down with members of the LineageOS team recently in a special episode, which went over the history of custom ROMs on Android. The episode is a great watch/listen, but <a href="https://youtu.be/TDOMekBPR4U?t=5107">one stat</a> in particular that caught our attention was that LineageOS is currently installed on around 1.5 million devices. There’s no word on how active those devices are, what they consist of, or how many different users that entails, but it’s the first look we’ve had in a while into how popular LineageOS actually is in a world where ROMs just aren’t as popular or necessary as they once were.</p>



<p>You can tune into <a href="https://youtu.be/TDOMekBPR4U">the full episode</a> below. </p>



<figure><p>
<iframe id="post-youtube-video-1" title="CyanogenMod and the Death of the Android ROM" width="500" height="281" data-src="https://www.youtube.com/embed/TDOMekBPR4U?feature=oembed&amp;rel=0&amp;enablejsapi=1" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>
</p></figure>



<h2 id="h-more-on-android">More on Android:</h2>



<ul>
<li><a href="https://9to5google.com/2023/07/27/pixel-tablet-lineageos-20/">Google Pixel Tablet gets support for LineageOS</a></li>



<li><a href="https://9to5google.com/2023/11/19/android-iphone-bullying-rcs/">Will RCS be enough to end the Android vs iPhone peer pressure and bullying?</a></li>



<li><a href="https://9to5google.com/2023/11/17/link-to-windows-oneplus-oppo-realme/">Link to Windows on PC now compatible with OnePlus, Oppo, and Realme phones</a></li>
</ul>
	<p>
		<a target="_blank" rel="nofollow" href="https://news.google.com/publications/CAAqBwgKMMqA-Qow-c_gAg?hl=en-US&amp;gl=US&amp;ceid=US:en">
			<em>Add 9to5Google to your Google News feed.</em>&nbsp;
					</a>
	</p>
	<div><p><em>FTC: We use income earning auto affiliate links.</em> <a href="https://9to5mac.com/about/#affiliate">More.</a></p><p><a href="https://bit.ly/3SWmaVQ"><img src="https://9to5google.com/wp-content/uploads/sites/4/2023/11/ROBOROCK-BF-BANNER-on-all-3-sites-Nov-20-26-750x150-1.jpg?quality=82&amp;strip=all" alt="" width="750" height="150"></a></p></div>				</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Mozilla's Abandoned Web Engine 'Servo' Project Is Getting a Well-Deserved Reboot (280 pts)]]></title>
            <link>https://news.itsfoss.com/servo-rust-web-engine/</link>
            <guid>39269949</guid>
            <pubDate>Tue, 06 Feb 2024 02:14:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://news.itsfoss.com/servo-rust-web-engine/">https://news.itsfoss.com/servo-rust-web-engine/</a>, See on <a href="https://news.ycombinator.com/item?id=39269949">Hacker News</a></p>
<div id="readability-page-1" class="page"><article>
    <div>



      <p>The developers of Servo are starting 2024 by going all in. </p><p>Spotted by <a href="https://mstdn.io/@codewiz/111868362077005163?ref=news.itsfoss.com" rel="noreferrer">Bernie Innocenti</a> when he was visiting <a href="https://fosdem.org/2024/?ref=news.itsfoss.com" rel="noreferrer">FOSDEM 2024</a>, the Servo Project team were there showing off the work done so far.</p><figure><img src="https://news.itsfoss.com/content/images/2024/02/Servo_a-1.jpg" alt="a photo showing a servo project member presenting servo's journey so far" loading="lazy" width="2000" height="1278" srcset="https://news.itsfoss.com/content/images/size/w600/2024/02/Servo_a-1.jpg 600w, https://news.itsfoss.com/content/images/size/w1000/2024/02/Servo_a-1.jpg 1000w, https://news.itsfoss.com/content/images/size/w1600/2024/02/Servo_a-1.jpg 1600w, https://news.itsfoss.com/content/images/size/w2400/2024/02/Servo_a-1.jpg 2400w" sizes="(min-width: 720px) 720px"><figcaption><span>Pic Credits: </span><a href="https://mstdn.io/@codewiz/111868362077005163?ref=news.itsfoss.com" rel="noreferrer"><span>Bernie Innocenti</span></a></figcaption></figure><p>That got me wondering; <strong>What's the progress with Servo nowadays?</strong> 🤔</p><p>If you were not familiar, <a href="https://servo.org/?ref=news.itsfoss.com" rel="noreferrer">Servo</a> is <strong>an experimental browser engine</strong> that leverages the power of Rust to provide a memory-safe and modular experience that is highly adaptable.</p><p>After Mozilla created Servo back in 2012 as a research project, it saw its share of ups and downs over the years, with it <a href="https://news.itsfoss.com/mozilla-servo-web-engine/" rel="noreferrer">making a comeback</a> in 2023; thanks to a fresh approach by the developers on how Servo should move forward.</p><p>Even though there are plenty of <a href="https://itsfoss.com/open-source-browsers-linux/?ref=news.itsfoss.com" rel="noreferrer">open source Chrome alternatives</a>; With this, there's a chance that we will get some really cool options based on Servo that just might give Blink and Gecko a run for the money! 😃</p><p>Let's see how The Servo Project has fared so far, and what's in store for it in 2024.</p><div><p>📋</p><p><a href="https://en.wikipedia.org/wiki/Blink_(browser_engine)?ref=news.itsfoss.com" rel="noreferrer">Blink</a> is used by Chromium, and other browsers based on it, whereas <a href="https://en.wikipedia.org/wiki/Gecko_(software)?ref=news.itsfoss.com" rel="noreferrer">Gecko</a> is used by Firefox and a few others.</p></div><h2 id="servo-what-to-expect">Servo: What to Expect?</h2><figure><iframe width="200" height="113" src="https://www.youtube.com/embed/9lkIX5ryZZ4?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" title="Servo Web Rendering Engine Reboot - Manuel Rego, Igalia"></iframe></figure><p>Just a few months back, in September 2023, after The Servo Project <a href="https://www.igalia.com/2023/09/07/The-Servo-project-is-joining-Linux-Foundation-Europe.html?ref=news.itsfoss.com" rel="noreferrer">officially joined</a> Linux Foundation Europe, the existing contributors from <a href="https://www.igalia.com/?ref=news.itsfoss.com" rel="noreferrer">Igalia</a> stepped up their game by taking over the project maintenance.</p><p>To complement that, at Open Source Summit Europe last year, <a href="https://twitter.com/regocas?ref=news.itsfoss.com" rel="noreferrer">Manuel Rego</a> from Igalia shared some really <a href="https://www.youtube.com/watch?v=9lkIX5ryZZ4&amp;ref=news.itsfoss.com" rel="noreferrer">useful insights</a> when he presented.</p><p>He showcased stuff like the <strong>WebGL support</strong>, <strong>cross-platform support</strong> including <strong>mobile support</strong> for Android and Linux, among other things. </p><p>They have experimented with Servo for embedded applications use-cases (like running it on Raspberry Pi), and have plans to make advances on it. As far as I can see, it looks like, Servo is faster for Raspberry Pi compared to Chromium 🤩</p><figure><iframe width="200" height="113" src="https://www.youtube.com/embed/oDqDrvxLxyI?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="" title="Servo On Raspberry Pi"></iframe></figure><p>You can explore more such demos on <a href="https://demo.servo.org/?ref=news.itsfoss.com" rel="noreferrer">Servo's demo webpage</a>.</p><p>Not to forget, a new layout engine is also in the works, where new features and compatibility arrangements are being made within its development.</p><p><strong>Did you know that even though Mozilla dropped the experimental project, Firefox still utilizes some servo components in the browser? </strong>😉</p><p>Naturally, that makes us wonder if the newer Servo layout engine (or any other component) might make it into the Firefox (<em>never say never!</em>).</p><p>Back then, Servo was still considered experimental, and in 2024, I hope that progresses a bit further.</p><p>Seeing this is an independent project, <strong>the progress so far looks very promising</strong>, the official website <a href="https://servo.org/about/?ref=news.itsfoss.com" rel="noreferrer">now lists</a> an updated roadmap for 2024 that pretty much has the same things for all of 2024.</p><figure><img src="https://news.itsfoss.com/content/images/2024/02/Servo_b.png" alt="a screenshot of the 2024 roadmap for servo" loading="lazy" width="2000" height="449" srcset="https://news.itsfoss.com/content/images/size/w600/2024/02/Servo_b.png 600w, https://news.itsfoss.com/content/images/size/w1000/2024/02/Servo_b.png 1000w, https://news.itsfoss.com/content/images/size/w1600/2024/02/Servo_b.png 1600w, https://news.itsfoss.com/content/images/size/w2400/2024/02/Servo_b.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>There's <strong>project maintenance and outreach</strong> that will include the usual project maintenance tasks alongside community management, then there's the <strong>implementation of CSS support</strong> which will see work being done on providing basic CSS features for the Servo layout engine.</p><p>With <strong>embedding API definition</strong>, the Servo team will finish work on defining the Servo webview API in collaboration with <a href="https://tauri.app/?ref=news.itsfoss.com" rel="noreferrer">Tauri</a> while also implementing new features and requirements for the API.</p><p>And, finally, we have <strong>Initial Android support</strong>, that will see Servo being made to build on modern Android versions, with the developers publishing nightly APKs on the official website some time in the future.</p><p>For staying in sync with the Servo roadmap, you can follow the <a href="https://github.com/servo/servo/wiki/Roadmap?ref=news.itsfoss.com" rel="noreferrer">official roadmap</a>, and for more details regarding this project, you may head over to its <a href="https://github.com/servo/servo?ref=news.itsfoss.com" rel="noreferrer">GitHub repo</a> or its official <a href="https://servo.zulipchat.com/?ref=news.itsfoss.com" rel="noreferrer">Zulip chat</a>.</p><p><em>💬 What do you think of Servo? Will it rise to become a strong contender to the likes of Blink and Gecko?</em></p>

      <interaction data-token="63fb391e4c763100127fc03a" data-context="true" data-tags="" data-fallback="true"></interaction>

      <hr>
      
      <h2 id="more-from-its-foss">More from It's FOSS...</h2>
      <ul>
          <li>Learn Bash scripting for FREE with this <a href="https://itsfoss.com/bash-scripting-tutorial/">Bash Tutorial series</a>.</li>
          <li>Join our <a href="https://itsfoss.community/">community forum</a>.</li>
          <li>📩 Stay updated with the latest on Linux and Open Source. Get our <a href="https://itsfoss.com/newsletter/">weekly Newsletter</a>.</li>
      </ul>
      
    </div>


        

    
    

    

  </article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[New viruslike entities found in human gut microbes (144 pts)]]></title>
            <link>https://www.science.org/content/article/it-s-insane-new-viruslike-entities-found-human-gut-microbes</link>
            <guid>39269497</guid>
            <pubDate>Tue, 06 Feb 2024 01:10:41 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.science.org/content/article/it-s-insane-new-viruslike-entities-found-human-gut-microbes">https://www.science.org/content/article/it-s-insane-new-viruslike-entities-found-human-gut-microbes</a>, See on <a href="https://news.ycombinator.com/item?id=39269497">Hacker News</a></p>
Couldn't get https://www.science.org/content/article/it-s-insane-new-viruslike-entities-found-human-gut-microbes: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Companies embracing SMS for account logins should be blamed for SIM-swap attacks (416 pts)]]></title>
            <link>https://keydiscussions.com/2024/02/05/sim-swap-attacks-can-be-blamed-on-companies-embracing-sms-based-password-resets/</link>
            <guid>39269327</guid>
            <pubDate>Tue, 06 Feb 2024 00:48:37 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://keydiscussions.com/2024/02/05/sim-swap-attacks-can-be-blamed-on-companies-embracing-sms-based-password-resets/">https://keydiscussions.com/2024/02/05/sim-swap-attacks-can-be-blamed-on-companies-embracing-sms-based-password-resets/</a>, See on <a href="https://news.ycombinator.com/item?id=39269327">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-823">
	<!-- .entry-header -->

	<div>
		
<p>SIM-swap attacks continue year after year because companies (that know better) <em>leaned into</em> the awful idea of using SMS for password resets and account logins. These companies include Apple, Dropbox, PayPal, Block, Google, and many others.</p>



<p>What is a SIM-swap attack? It’s where a bad guy asks a carrier to port your cell-phone number to their phone. (Carriers are required to port your number easily because of <a href="https://en.wikipedia.org/wiki/Local_number_portability#:~:text=In%20the%20United%20States%2C%2047,Federal%20Communications%20Commission%20(FCC).">pro-competition laws in the US</a>.) Then, the crook triggers and receives account login info via SMSes from companies and proceeds to steal money and sensitive info from the victim. It happens all the time… Here are just <a href="https://techmeme.com/search/query?q=sim&amp;wm=false">a few of the higher profile instances</a>:</p>



<figure><img fetchpriority="high" decoding="async" width="988" height="1024" src="https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-988x1024.png" alt="" srcset="https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-988x1024.png 988w, https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-289x300.png 289w, https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-768x796.png 768w, https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-1482x1536.png 1482w, https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-1976x2048.png 1976w, https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-982x1018.png 982w, https://keydiscussions.com/wp-content/uploads/2024/02/smsswap-386x400.png 386w" sizes="(max-width: 988px) 100vw, 988px"></figure>



<p>Is there a way to stop SIM swap attacks? Yes, it’s simple: Companies SHOULD NOT LET CUSTOMERS LOG IN via SMS, or allow password resetting via SMS. If SMS 2FA is offered, it should <strong><em>only</em> be</strong> if they provide more secure options like Authy or Google Authenticator (and SMS should not serve as a fallback for account recovery).</p>



<p>For many years, people in the industry have invariably said something like: “Well… offering SMS-based authentication is better *overall* for customer security, because of its <em>convenience</em> (despite its shortcomings) vs other methods” (such as the far-more secure-able use of email for verification).  To that I say: “who are *YOU* to deprive your customers of security?” Defending against targeted attacks must be an integral part of any company’s defense posture. It’s so arrogant to say otherwise, and it boils my blood, it really does. Offering SMS-based logins is a bad idea, and it never had a chance of being a good one. </p>



<p>Sending an SMS to a customer is like sending a postcard through the mail. It’s plaintext (not encrypted), and anyone can open your mailbox and intercept/read it (which is what happens in a SIM-swap attack). The protocol was never designed to be secure.</p>



<p>Is SMS the best option for password resets? NO! Reseting passwords via an email is far more secure. Is SMS a good 2FA option? No! Apps like Authy or using email is better. Is logging your customer in via SMS ever acceptable? No! [After reading Hacker News comments, let me be clear – I’m not <em>just</em> talking about SMS 2FA, in fact I’m primarily talking about the ubiquitous state of SMS-based password reseting, user onboarding, and account recovery. All are varying degrees of weak. SMS-based 2FA is, when offered as an option alongside stronger 2FA, the least bad of the weak-security scenarios but is not the focus of the post.]</p>



<p>Much of the ire relating to SIM-swap attacks has, understandably, been directed at carriers. Indeed, carriers do a terrible job of securing customers’ phone numbers, and <a href="https://www.techmeme.com/190723/p15#a190723p15">may be liable for that shortcoming</a>. But here’s the thing: carriers’ security <em>has always</em> been bad, it has even been legislated into being bad, and other companies have still <strong>chosen</strong> to build mission-critical systems on top of that weak link.</p>



<p>Despite it being commonplace, it is important to remember that baking SMS into authentication flows was an awful, shortsighted <strong><em>choice</em></strong> made by companies. Despite offering poor security, SMS offers a nearly frictionless way to sign up new customers (think of Uber’s onboarding) and handle password resets, and companies felt they had to match competitors’ adoption of this technique. They dug the hole, pushed us in, and now they must get us out.</p>



<p>Companies adopt the naive outlook that, somehow, crooks won’t try hard enough to SIM swap individuals. Clearly the criminals will – even to the point of <a href="https://www.techmeme.com/240130/p39#a240130p39">pretending to be customers at physical store locations</a>. It’s time for them to call it on this experiment. It failed.</p>



<p>And I’m sorry, but after nearly a decade, we can call it: efforts to strengthen telephony protocols like SHAKEN/STIR, will never happen. If the willpower had existed in the industry, it would have happened 5 years ago. Promises of protocol upgrades never were (and certainly are not now) a satisfactory excuse to continue to send password reset codes over SMS. Nor would a stronger protocol even stop SIM swap attacks. People are being harmed day-in and day-out, while the industry equivocates. </p>



<p>While SIM-swapping attacks are prevalent and headline-grabbing, SMSes are also vulnerable to man-in-the-middle attacks. These are likely carried out frequently by nation states. The fact that nation states can abuse SMS verification may even explain some of the overall inertia in allowing a broken system to remain.</p>



<p>If I sound heated, it’s because I’ve been banging this drum for over 7 years. Others <a href="https://www.forbes.com/sites/zakdoffman/2020/10/11/apple-iphone-imessage-and-android-messages-sms-passcode-security-update/">have written</a> about it years ago, and yet SIM-swap attacks continue unabated. I’m frustrated because many of these companies talk a big game about putting their customers’ safety and security first. I’m mad because, with all the intractable problems facing tech nowadays like deepfakes (including audio deepfakes that <a href="https://keydiscussions.com/2021/12/07/despite-the-prevalence-of-deepfake-audio-tech-banks-and-isps-rush-ahead-with-voice-print-authentication-%f0%9f%92%80/">I wrote about here</a>) and disinformation, this is one that <em>can actually be solved</em>, and yet nothing (concrete) is being done. We need a win, and here’s one for the taking!</p>



<p>To repeat: If some random person convinces T-Mobile, AT&amp;T, Verizon, etc to port my number, MY DIGITAL SAFETY SHOULD NOT BE PORTED AS WELL.</p>



<h2>How companies embraced this broken tech</h2>



<p><strong>Apple</strong>:</p>



<p>Apple helped seal SMS’ role in password resets and account logins via its keyboard feature it announced in 2018: <a href="https://support.apple.com/guide/iphone/automatically-fill-in-sms-passcodes-iphc89a3a3af/ios">Automatically fill in SMS passcodes on iPhone</a> . It also allows scenarios where SMS <a href="https://twitter.com/SpencerDailey/status/855190987370618881">can be used</a> to reset your Apple account. </p>



<p><strong>Google</strong>:</p>



<p>In 2019, Google followed Apple’s bad idea with the same thing for Android, <a href="https://www.xda-developers.com/google-play-services-sms-code-auto-fill/">SMS autofill</a> for one time codes.</p>



<p><strong>Cloud providers like Twilio/Amazon/Microsoft/Google etc</strong>:</p>



<p>There is a large industrial complex behind SMS codes. Many companies have profit incentives to continue offering SMS one time codes to customers.   <a href="https://azure.microsoft.com/en-us/updates/generally-available-azure-communication-services-short-code-functionality-for-sms/">Azure</a>, <a href="https://docs.aws.amazon.com/pinpoint/latest/developerguide/send-validate-otp.html">AWS</a>, <a href="https://www.twilio.com/en-us/pricing">Twilio</a>, <a href="https://www.google.com/search?q=google+cloud+sms+codes&amp;rlz=1C5CHFA_enUS975US978&amp;oq=google+cloud+sms+codes&amp;gs_lcrp=EgZjaHJvbWUyBggAEEUYOTIGCAEQRRhA0gEINTY2M2owajSoAgCwAgA&amp;sourceid=chrome&amp;ie=UTF-8">Google</a>, etc. Selling these services is unethical.  It’s a fundamentally broken technology, sold as a secure solution.<br></p>



<p><strong>Money management services</strong></p>



<p>Unbelievably, SMS reset/account login functionality is completely ubiquitous even when it comes to your money: <a href="https://www.wellsfargo.com/privacy-security/advanced-access/">Wells Fargo</a>, <a href="https://www.reddit.com/r/Scams/comments/f0cuyq/cash_app_texting_me_with_signin_code_out_of_the/">Cash App (Block)</a>, <a href="https://robinhood.com/us/en/support/articles/verifying-its-you/">Robinhood</a>, <a href="https://www.schwab.com/legal/deviceid">Schwab</a>, <a href="https://www.paypal.com/us/cshelp/article/what-can-i-do-if-ive-changed-my-mobile-number-and-cant-log-in-help678">Paypal</a>, etc etc. Again, these are SMS options offered as a way of “verifying that it’s you”, something that SIM-swapping crooks love to hear. Also, never <a href="https://www.paypal.com/us/cshelp/article/what-can-i-do-if-ive-changed-my-mobile-number-and-cant-log-in-help678">carelessly change</a> your phone number, you’ll be locked out of your PayPal!</p>



<p><strong>Basically every</strong> other company at this point:</p>



<p>From food ordering services to <a href="https://www.techmeme.com/240122/p18#a240122p18">social <strong>networks</strong></a> and even data storage firms like <a href="https://help.dropbox.com/account-access/enable-two-step-verification"><strong>Dropbox</strong></a> — SMS is unfortunately, by default, a way to reset your account. If there’s even a way to turn it off, it’s incumbent upon <em>you the user</em>, to go in and opt out –service by service– and disable the crappy tech. Many services don’t offer an opt out.</p>



<h2>Customers think they like SMS reset options</h2>



<p>Customers don’t understand the broken nature of SMS resets. It’s not their job to. They appreciate that it’s more convenient than resets via email (an actually-secure option) or log in codes via 2FA apps like authenticator. iPhone’s SMS autofill is oftentimes (dubiously) <a href="https://journa.host/deck/@spencerdailey/111585692105278478">heralded</a> as the best thing in iOS. The issue is: it’s not the customer’s job to understand whether systems are secure, it’s tech companies’. </p>



<p>And tech companies have failed, leaving all of their customers exposed in the process. </p>



<p>Hopefully a combination of lawsuits and legislation will eventually change the status quo. In the meantime, <strong>companies need to be brave</strong> and call the situation for what it is: a complete shit show. And then roll back their support of SMS verification services.</p>



<h2><strong>A few more things:</strong> </h2>



<p><strong>Robust Identity services are more important than ever in the age of deepfakes.</strong></p>



<p>Moving away from telephone-number-based identity services is a major and necessary step in realizing robust means of customer identification, which is even more important these days. The era of old school KYC (Know Your Customer) enforcement is over, <a href="https://www.404media.co/inside-the-underground-site-where-ai-neural-networks-churns-out-fake-ids-onlyfake/">with fake ID AI services going mainstream</a>. We should move away from unencrypted, SIM-swap-prone verification identity services like SMS.</p>



<p><strong>Many ransomware attacks are downstream of SIM-swap attacks</strong></p>



<p>Another seemingly intractable problem facing IT around the world is <a href="https://www.theverge.com/2024/2/5/24059486/ransomware-victims-palo-alto-networks-unit-42">ransomware</a>. SIM-swapping attacks represent a significant vector for compromising a company’s network. Again, rolling back support for SMS logins could take a bite out of the ransomware scourge.</p>



<p><strong>One <a href="https://news.ycombinator.com/item?id=39269643">HN commenter mentioned</a> the <a href="https://www.sfrpay.fr/Nos-solutions/Mobile-ID/SIM-Verify">“SIM Verify” initiative in the EU</a>, </strong>where companies relying on SMS can at least check to see if a SIM had recently been ported. That’s something, and we’ll see if it goes anywhere, but if the SHAKEN/STIR rollout has taught me anything, changes like this may happen in a decade not a year.</p>



<p><strong>Finally, a dedicated home to this question</strong></p>



<p>I <a href="https://www.metafruit.com/smssecurity/">created a site at a permanent URL</a> that bluntly answers the question “Is using SMS for logins a good idea?”, for sharing with people in the industry.</p>








			</div><!-- .entry-content -->

	<!-- .entry-footer -->
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[I worked 80 hour weeks to deliver a platform for a hedge fund,then they fired me (166 pts)]]></title>
            <link>https://www.efinancialcareers.com/news/i-worked-80-hour-weeks-to-deliver-a-platform-for-a-hedge-fund-then-they-fired-me</link>
            <guid>39269284</guid>
            <pubDate>Tue, 06 Feb 2024 00:42:31 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.efinancialcareers.com/news/i-worked-80-hour-weeks-to-deliver-a-platform-for-a-hedge-fund-then-they-fired-me">https://www.efinancialcareers.com/news/i-worked-80-hour-weeks-to-deliver-a-platform-for-a-hedge-fund-then-they-fired-me</a>, See on <a href="https://news.ycombinator.com/item?id=39269284">Hacker News</a></p>
<div id="readability-page-1" class="page"><div _ngcontent-ng-c2603034510="" id="articleDetail" ngskiphydration=""><p>I built a systematic trading platform for a <a target="_blank" rel="noopener noreferrer" href="https://www.efinancialcareers.com/news/finance/how-to-get-a-hedge-fund-job">hedge fund</a>. I delivered an excellent platform ahead of time, but then they fired me, and now I can’t find a new job in what's a very difficult employment market.</p><p><a target="_blank" rel="noopener noreferrer" href="https://www.efinancialcareers.com/myefc/preferences/subscribe?newsletter=network_newsletter">Get Morning Coffee&nbsp;</a><span>☕</span><a target="_blank" rel="noopener noreferrer" href="https://www.efinancialcareers.com/myefc/preferences/subscribe?newsletter=network_newsletter">&nbsp;in your inbox. Sign up here.</a><o:p></o:p></p><p>I shouldn’t even be looking for a job right now. I’m only on the market because I became surplus to requirements. Effectively, I was “fired” for being too effective in my previous role.<o:p></o:p></p><p>I joined the startup hedge fund last year. In the short period while I worked there, I built an order management system which allowed the firm to make its first eve trades. A typical week for me included working between 70 and 80 hours a week. I worked almost every weekend, and almost every day for the entire time, without a single day of holiday.<o:p></o:p></p><p>I did this for two reasons. Firstly, I was told repeatedly that the faster the firm was able to start trading, the faster I would start earning bonuses from the firm's PnL, assuming that the strategies indeed were profitable. (It is my understanding that they are highly profitable.)<o:p></o:p></p><p>Secondly, I loved my job. Every day, I got to build really cool stuff, all while learning a new language which was unfamiliar to me – <a target="_blank" rel="noopener noreferrer" href="https://www.efinancialcareers.com/news/2023/03/rust-jobs-in-finance">Rust. </a>Every day, I was learning more about <a target="_blank" rel="noopener noreferrer" href="https://www.efinancialcareers.com/news/2020/09/rust-vs-c-hedge-fund-jobs">Rust,</a> Kafka, and the range of other technologies which we were leveraging. It was pretty great.<o:p></o:p></p><p>After months of hard work, the system finally went into production, and trades started flowing around the system. Two days later I was let go. I arrived in the office the morning after 48 hours of profit making, and was called into a private office. I was told it was “with regret” that my contract would be terminated that day, and that the “substantial bonus” which would be paid to me was “thanks” for the critical role I played in starting the company.<o:p></o:p><o:p></o:p></p><p>While I in no way regret working for the fund, as I gained a fast amount of experience in a relatively short period of time, I do regret not being more tactical with my work. I could have simply worked 40 hours a week. Had I done so, it is likely I would still be employed, still building the platform today.<o:p></o:p></p><p>Since the day I left, I have been relentlessly job searching. But so far I have found nothing. I was told in an interview for a <a target="_blank" rel="noopener noreferrer" href="https://www.efinancialcareers.com/jobs/quantitative-analyst">junior quant</a> position that it was “a bit of a red flag” that I worked somewhere for such a short period of time.&nbsp;<o:p></o:p></p><p>So is that it? I know the job market is tough right now, but have I snookered myself and made myself unemployable for working too effectively during my last role?&nbsp;<o:p></o:p></p><p>I think I have applied to every hedge fund and investment bank in London. My applications either received an automatic rejection, or simply no response in the majority of cases. In the handful of cases where I have been offered an interview, most have been initial conversations, followed by radio silence – not even a rejection email.<o:p></o:p></p><p>It seems that during such a dire economy, the dream of a junior quant role is out of reach, for now. Any advice would be greatly appreciated.&nbsp;</p><p><i>Milan Gill is a pseudonym&nbsp;</i></p><p>&nbsp;<i><strong>Have a confidential story, tip, or comment you’d like to share?&nbsp;Contact: +44&nbsp;7537 182250 (SMS, Whatsapp or voicemail).&nbsp;Telegram: @SarahButcher.&nbsp;</strong></i><a rel="noreferrer noopener" target="_blank" title="https://www.efinancialcareers.co.uk/about/editor-tips"><i><strong>Click here to fill in our anonymous form</strong></i></a><i><strong>, or email editortips@efinancialcareers.com. Signal also available.</strong></i></p><p><i>Bear with us if you leave a comment at the bottom of this article: all our comments are moderated by human beings. Sometimes these humans might be asleep, or away from their desks, so it may take a while for your comment to appear. Eventually it will – unless it’s offensive or libelous (in which case it won’t.)</i><span>.</span><o:p></o:p></p></div></div>]]></description>
        </item>
    </channel>
</rss>