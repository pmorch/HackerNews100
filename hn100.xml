<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Thu, 04 Apr 2024 19:00:08 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[HTTP/2 Continuation Flood: Technical Details (135 pts)]]></title>
            <link>https://nowotarski.info/http2-continuation-flood-technical-details/</link>
            <guid>39930919</guid>
            <pubDate>Thu, 04 Apr 2024 14:32:50 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://nowotarski.info/http2-continuation-flood-technical-details/">https://nowotarski.info/http2-continuation-flood-technical-details/</a>, See on <a href="https://news.ycombinator.com/item?id=39930919">Hacker News</a></p>
<div id="readability-page-1" class="page"><p><strong>tl;dr:</strong>
			Deep technical analysis of the <code>CONTINUATION</code> Flood: a class of vulnerabilities within numerous HTTP/2 protocol implementations. In many cases, it poses a more severe threat compared to the Rapid Reset: a single machine (and in certain instances, a mere single TCP connection or a handful of frames) has the potential to disrupt server availability, with consequences ranging from server crashes to substantial performance degradation. Remarkably, requests that constitute an attack are not visible in HTTP access logs. <strong>A simplified security advisory and list of affected projects can be found in: <a href="https://nowotarski.info/http2-continuation-flood/">HTTP/2 <code>CONTINUATION</code> Flood</a>.</strong>
		</p><section>
			<h2 id="preface">Preface</h2>
<p>In October 2023 I learnt about HTTP/2 Rapid Reset attack, dubbed <a href="https://cloud.google.com/blog/products/identity-security/google-cloud-mitigated-largest-ddos-attack-peaking-above-398-million-rps">“the largest DDoS attack to date”</a>. I didn’t have deep knowledge of HTTP/2 back then. I knew it’s basics like frames or HPACK but I was focusing more on <a href="https://nowotarski.info/http-chunk-extensions/">HTTP/1.1 protocol</a> and <a href="https://nowotarski.info/golang-textproto-reader/">programming languages</a> vulnerabilities. I decided to dedicate time to exploring HTTP/2 from a security analysis perspective after concluding my then-current research.</p>
<h2 id="a-quick-intro-to-http2">A quick intro to HTTP/2</h2>
<p>The main difference between HTTP/1.1 and HTTP/2 is that the later is a binary protocol and client and server exchange <em>frames</em> instead of text lines. There are many frame types, including some control frames that does not transmit data but rather allow configuration of an HTTP/2 session (like <code>SETTINGS</code> or <code>WINDOW_UPDATE</code>). To make this vulnerability easy to understand I need to present two frames: <code>HEADERS</code> frame and <code>CONTINUATION</code> frame. For those who would like to catch up, the best way to learn it is by reading <a href="https://datatracker.ietf.org/doc/html/rfc9204">RFC9204</a>.</p>

<p><img src="https://nowotarski.info/continuation_frames_light.svg">

</p>

<p><img src="https://nowotarski.info/continuation_frames_dark.svg">

</p>

<p><code>HEADERS</code> frames allow sending HTTP headers of, both, request and response. The headers are stored in field block fragment and are encoded using <code>HPACK</code>, encoding algorithm that allows compression of header data. It is using static and dynamic tables of commonly used headers and Huffman encoding for the rest of headers. As other frames, this one can have some flags set, along them:</p>
<ul>
<li><code>END_HEADERS</code>: when set, tells the counterparty that this frame contains all the headers they wanted to send,</li>
<li><code>END_STREAM</code>: when set, tells the counterparty that there will be no request/response body.</li>
</ul>
<p>The frames also have a maximum size, configured at the beginning of communication. If a received frame exceeds the allowed size the connection is dropped with a protocol error. So what happens if a single <code>HEADER</code> frame is not enough to store all the headers? It sends the frame with <code>END_HEADERS</code> flag unset and continues the stream of headers using <code>CONTINUATION</code> frame.</p>
<h2 id="continuation-frame"><code>CONTINUATION</code> frame</h2>
<p><code>CONTINUATION</code> frames are very similar to <code>HEADER</code> frames but they have just one flag: <code>END_HEADERS</code> which has the same function: when set the counterparty knows that more headers are coming in the following <code>CONTINUATION</code> frames.</p>
<p>To sum it up, if headers exceed a single frame allowed size they are split in a frame stream:</p>
<ul>
<li><code>HEADERS</code> (no <code>END_HEADERS</code> flag),</li>
<li><code>CONTINUATION</code> (no flags),</li>
<li><code>CONTINUATION</code> (no flags),</li>
<li>…</li>
<li><code>CONTINUATION</code> (<code>END_HEADERS</code> <strong>set</strong>),</li>
</ul>

<p><img src="https://nowotarski.info/continuation_good_light.svg">

</p>

<p><img src="https://nowotarski.info/continuation_good_dark.svg">

</p>
<p>After the last frame, either <code>DATA</code> frame is sent (contains request data) or HTTP/2 stream ends.</p>
<h2 id="continuation-flood-vulnerability"><code>CONTINUATION</code> Flood Vulnerability</h2>
<p>What if a client starts a new HTTP/2 stream and sends <code>HEADERS</code> and <code>CONTINUATION</code> frames but <code>END_HEADERS</code> flag is <strong>never</strong> set? This would create an infinite stream of headers that HTTP/2 server would need to parse and store in memory.</p>

<p><img src="https://nowotarski.info/continuation_bad_light.svg">

</p>

<p><img src="https://nowotarski.info/continuation_bad_dark.svg">

</p>
<p>In HTTP/1.1 world, servers are protected from infinite headers by two mechanisms:</p>
<ul>
<li>Header size limit: if headers list exceed the allowed size, the connection is dropped.</li>
<li>Request / headers timeouts: if the request/headers are not sent in timely manner, the connection is dropped.</li>
</ul>
<p>In the last couple of months I checked dozens of implementations and, somehow, these protections were not implemented (or implemented incorrectly) even in major HTTP/2 servers, most notably: Apache httpd, Envoy and many HTTP/2 packages or codecs. I can divide outcomes of the bugs related to this vulnerability in the following categories:</p>
<ul>
<li>CPU exhaustion. Reading the extra headers cause increased CPU usage, it results in slowness responding to other requests but in many cases it was just a matter of number of active HTTP/2 connections that are required to completely block the server from responding.</li>
<li>Out Of Memory crash using multiple connections. Headers from <code>CONTINUATION</code> frames are stored in memory but there is a headers list size limit. At the same time there is no headers timeout. This means that an attacker can send headers up to the limit and just wait. Each connection occupies memory indefinietly.</li>
<li>Out Of Memory crash using a <strong>single</strong> connection. Some implementations simply kept reading headers into memory until memory was full which forced the OS to kill the process.</li>
<li>Crash after a <strong>few frames sent</strong>. This is a special, most severe category. Just a few frames are required to crash the server because of implementation bugs when a connection is disconnected mid-<code>CONTINUATION</code> stream.</li>
</ul>
<p>No <code>END_HEADERS</code> flag means that a request is not properly closed. Requests of malicious client would not be saved to access log making this attack hard to debug: in many cases analyzing raw traffic bytes would be necessary to understand the nature of this vulnerability.</p>
<p>In next sections I will demonstrate cases above using real vulnerabilities found in production code.</p>
<h2 id="cpu-exhaustion-golang-case">CPU exhaustion: Golang case</h2>
<p>Golang was an example of the CPU exhaustion caused by <code>CONTINUATION</code> Flood. As many other implementations, Golang devs built an abstraction class called <code>http2MetaHeadersFrame</code> which encapsulates one <code>HEADERS</code> frame and zero or more <code>CONTINUATION</code> frames, and their HPACK decoder. Headers data is processed within a single call to <code>readMetaFrame</code> (<code>h2_bundle.go</code> from Go 1.21.3).</p>
<p>The HPACK decoder in Golang has multiple params and modes. One of them is <code>SetEmitEnabled</code> which enables or disables emitting of decoded headers. This is done to stop headers emission in case of errors or when the header size limit is reached.</p>
<div><pre tabindex="0"><code data-lang="go"><span><span>2926</span><span><span>func</span> <span>(</span><span>fr</span> <span>*</span><span>http2Framer</span><span>)</span> <span>readMetaFrame</span><span>(</span><span>hf</span> <span>*</span><span>http2HeadersFrame</span><span>)</span> <span>(</span><span>*</span><span>http2MetaHeadersFrame</span><span>,</span> <span>error</span><span>)</span> <span>{</span>
</span></span><span><span>2927</span><span>	<span>if</span> <span>fr</span><span>.</span><span>AllowIllegalReads</span> <span>{</span>
</span></span><span><span>2928</span><span>		<span>return</span> <span>nil</span><span>,</span> <span>errors</span><span>.</span><span>New</span><span>(</span><span>"illegal use of AllowIllegalReads with ReadMetaHeaders"</span><span>)</span>
</span></span><span><span>2929</span><span>	<span>}</span>
</span></span><span><span>2930</span><span>	<span>mh</span> <span>:=</span> <span>&amp;</span><span>http2MetaHeadersFrame</span><span>{</span>
</span></span><span><span>2931</span><span>		<span>http2HeadersFrame</span><span>:</span> <span>hf</span><span>,</span>
</span></span><span><span>2932</span><span>	<span>}</span>
</span></span><span><span>2933</span><span>	<span>var</span> <span>remainSize</span> <span>=</span> <span>fr</span><span>.</span><span>maxHeaderListSize</span><span>()</span>
</span></span><span><span>2934</span><span>	<span>var</span> <span>sawRegular</span> <span>bool</span>
</span></span><span><span>2935</span><span>
</span></span><span><span>2936</span><span>	<span>var</span> <span>invalid</span> <span>error</span> <span>// pseudo header field errors
</span></span></span><span><span>2937</span><span><span></span>	<span>hdec</span> <span>:=</span> <span>fr</span><span>.</span><span>ReadMetaHeaders</span>
</span></span><span><span>2938</span><span>	<span>hdec</span><span>.</span><span>SetEmitEnabled</span><span>(</span><span>true</span><span>)</span>
</span></span><span><span>2939</span><span>	<span>hdec</span><span>.</span><span>SetMaxStringLength</span><span>(</span><span>fr</span><span>.</span><span>maxHeaderStringLen</span><span>())</span></span></span></code></pre></div>
<p>Indeed, in the <code>SetEmitFunc</code> callback function there’s a logic that checks if the allowed size (<code>maxHeaderListSize</code>) has been reached and in this case <code>SetEmitEnabled(false)</code> is called.</p>
<div><pre tabindex="0"><code data-lang="go"><span><span>2940</span><span>	<span>hdec</span><span>.</span><span>SetEmitFunc</span><span>(</span><span>func</span><span>(</span><span>hf</span> <span>hpack</span><span>.</span><span>HeaderField</span><span>)</span> <span>{</span>
</span></span><span><span>2941</span><span>		<span>if</span> <span>http2VerboseLogs</span> <span>&amp;&amp;</span> <span>fr</span><span>.</span><span>logReads</span> <span>{</span>
</span></span><span><span>2942</span><span>			<span>fr</span><span>.</span><span>debugReadLoggerf</span><span>(</span><span>"http2: decoded hpack field %+v"</span><span>,</span> <span>hf</span><span>)</span>
</span></span><span><span>2943</span><span>		<span>}</span>
</span></span><span><span>2944</span><span>		<span>if</span> <span>!</span><span>httpguts</span><span>.</span><span>ValidHeaderFieldValue</span><span>(</span><span>hf</span><span>.</span><span>Value</span><span>)</span> <span>{</span>
</span></span><span><span>2945</span><span>			<span>// Don't include the value in the error, because it may be sensitive.
</span></span></span><span><span>2946</span><span><span></span>			<span>invalid</span> <span>=</span> <span>http2headerFieldValueError</span><span>(</span><span>hf</span><span>.</span><span>Name</span><span>)</span>
</span></span><span><span>2947</span><span>		<span>}</span>
</span></span><span><span>2948</span><span>		<span>isPseudo</span> <span>:=</span> <span>strings</span><span>.</span><span>HasPrefix</span><span>(</span><span>hf</span><span>.</span><span>Name</span><span>,</span> <span>":"</span><span>)</span>
</span></span><span><span>2949</span><span>		<span>if</span> <span>isPseudo</span> <span>{</span>
</span></span><span><span>2950</span><span>			<span>if</span> <span>sawRegular</span> <span>{</span>
</span></span><span><span>2951</span><span>				<span>invalid</span> <span>=</span> <span>http2errPseudoAfterRegular</span>
</span></span><span><span>2952</span><span>			<span>}</span>
</span></span><span><span>2953</span><span>		<span>}</span> <span>else</span> <span>{</span>
</span></span><span><span>2954</span><span>			<span>sawRegular</span> <span>=</span> <span>true</span>
</span></span><span><span>2955</span><span>			<span>if</span> <span>!</span><span>http2validWireHeaderFieldName</span><span>(</span><span>hf</span><span>.</span><span>Name</span><span>)</span> <span>{</span>
</span></span><span><span>2956</span><span>				<span>invalid</span> <span>=</span> <span>http2headerFieldNameError</span><span>(</span><span>hf</span><span>.</span><span>Name</span><span>)</span>
</span></span><span><span>2957</span><span>			<span>}</span>
</span></span><span><span>2958</span><span>		<span>}</span>
</span></span><span><span>2959</span><span>
</span></span><span><span>2960</span><span>		<span>if</span> <span>invalid</span> <span>!=</span> <span>nil</span> <span>{</span>
</span></span><span><span>2961</span><span>			<span>hdec</span><span>.</span><span>SetEmitEnabled</span><span>(</span><span>false</span><span>)</span>
</span></span><span><span>2962</span><span>			<span>return</span>
</span></span><span><span>2963</span><span>		<span>}</span>
</span></span><span><span>2964</span><span>
</span></span><span><span>2965</span><span>		<span>size</span> <span>:=</span> <span>hf</span><span>.</span><span>Size</span><span>()</span>
</span></span><span><span>2966</span><span>		<span>if</span> <span>size</span> <span>&gt;</span> <span>remainSize</span> <span>{</span>
</span></span><span><span>2967</span><span>			<span>hdec</span><span>.</span><span>SetEmitEnabled</span><span>(</span><span>false</span><span>)</span>
</span></span><span><span>2968</span><span>			<span>mh</span><span>.</span><span>Truncated</span> <span>=</span> <span>true</span>
</span></span><span><span>2969</span><span>			<span>return</span>
</span></span><span><span>2970</span><span>		<span>}</span>
</span></span><span><span>2971</span><span>		<span>remainSize</span> <span>-=</span> <span>size</span>
</span></span><span><span>2972</span><span>
</span></span><span><span>2973</span><span>		<span>mh</span><span>.</span><span>Fields</span> <span>=</span> <span>append</span><span>(</span><span>mh</span><span>.</span><span>Fields</span><span>,</span> <span>hf</span><span>)</span>
</span></span><span><span>2974</span><span>	<span>})</span>
</span></span><span><span>2975</span><span>	<span>// Lose reference to MetaHeadersFrame:
</span></span></span><span><span>2976</span><span><span></span>	<span>defer</span> <span>hdec</span><span>.</span><span>SetEmitFunc</span><span>(</span><span>func</span><span>(</span><span>hf</span> <span>hpack</span><span>.</span><span>HeaderField</span><span>)</span> <span>{})</span>
</span></span><span><span>2977</span><span>     
</span></span></code></pre></div>
<p>The following part of this function is responsible for actually feeding the HPACK decoder and it does so until <code>HeadersEnded()</code> returns <code>true</code> which happens only when <code>END_HEADERS</code> flag is set.</p>
<div><pre tabindex="0"><code data-lang="go"><span><span>2978</span><span>	<span>var</span> <span>hc</span> <span>http2headersOrContinuation</span> <span>=</span> <span>hf</span>
</span></span><span><span>2979</span><span>	<span>for</span> <span>{</span>
</span></span><span><span>2980</span><span>		<span>frag</span> <span>:=</span> <span>hc</span><span>.</span><span>HeaderBlockFragment</span><span>()</span>
</span></span><span><span>2981</span><span>		<span>if</span> <span>_</span><span>,</span> <span>err</span> <span>:=</span> <span>hdec</span><span>.</span><span>Write</span><span>(</span><span>frag</span><span>);</span> <span>err</span> <span>!=</span> <span>nil</span> <span>{</span>
</span></span><span><span>2982</span><span>			<span>return</span> <span>nil</span><span>,</span> <span>http2ConnectionError</span><span>(</span><span>http2ErrCodeCompression</span><span>)</span>
</span></span><span><span>2983</span><span>		<span>}</span>
</span></span><span><span>2984</span><span>
</span></span><span><span>2985</span><span>		<span>if</span> <span>hc</span><span>.</span><span>HeadersEnded</span><span>()</span> <span>{</span>
</span></span><span><span>2986</span><span>			<span>break</span>
</span></span><span><span>2987</span><span>		<span>}</span>
</span></span><span><span>2988</span><span>		<span>if</span> <span>f</span><span>,</span> <span>err</span> <span>:=</span> <span>fr</span><span>.</span><span>ReadFrame</span><span>();</span> <span>err</span> <span>!=</span> <span>nil</span> <span>{</span>
</span></span><span><span>2989</span><span>			<span>return</span> <span>nil</span><span>,</span> <span>err</span>
</span></span><span><span>2990</span><span>		<span>}</span> <span>else</span> <span>{</span>
</span></span><span><span>2991</span><span>			<span>hc</span> <span>=</span> <span>f</span><span>.(</span><span>*</span><span>http2ContinuationFrame</span><span>)</span> <span>// guaranteed by checkFrameOrder
</span></span></span><span><span>2992</span><span><span></span>		<span>}</span>
</span></span><span><span>2993</span><span>	<span>}</span>
</span></span><span><span>2994</span><span><span>// &lt;rest of this function irrelevant&gt;
</span></span></span></code></pre></div>
<p>The vulnerability may not be clear at the first sight: the decoder is properly configured to stop emitting headers once limit is reached. However, it will still decode headers written to it, just without emiting them. Given that the <em>feeding loop</em> above can only be stopped by <code>END_HEADERS</code> flag or an error from <code>ReadFrame</code> an attacker fully controls how long the HPACK decoder will receive new bytes. With no <code>END_HEADERS</code>, this function will never return and HPACK will keep decoding headers as long as the attacker sends them.</p>
<h2 id="out-of-memory---http-2-ruby-gem-case--">Out of Memory<!-- raw HTML omitted --></h2>
<p>Out of Memory are probably the most boring yet severe cases. There is nothing special about it: no strange logic, no interesting race condition and so on. The implementations that allow OOM simply did not limit the size of headers list built using <code>CONTINUATION</code> frames. Implementations without header timeout required just a single HTTP/2 connection to crash the server.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p>In implementations with idle timeout it was often possible to send multiple HTTP/2 connections that occupied portions of RAM very close to the allowed per-connection limit and then sending the last <code>CONTINUATION</code> frame byte-by-byte every few seconds to keep the connection alive.</p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h2 id="reachable-assertion-crash-nodejs-special-case">Reachable Assertion crash: Node.js (special) case</h2>
<p>The last case I’d like to present is a <a href="https://cwe.mitre.org/data/definitions/617.html">Reachable Assertion</a> connected to <code>CONTINUATION</code> frames in Node.js. While it properly handles the infinite stream of <code>CONTINUATION</code> frames there was a data race bug occuring when connection was disconnected during the headers stream.</p>
<p>When I was running the exploit code I noticed that sometimes Node.js crashed with the following stack:</p>
<pre tabindex="0"><code>  #  node[3253]: virtual node::http2::Http2Session::~Http2Session() at ../src/node_http2.cc:534
  #  Assertion failed: (current_nghttp2_memory_) == (0)

----- Native stack trace -----

 1: 0xca5430 node::Abort() [node]
 2: 0xca54b0 node::errors::SetPrepareStackTraceCallback(v8::FunctionCallbackInfo&lt;v8::Value&gt; const&amp;) [node]
 3: 0xce7156 node::http2::Http2Session::~Http2Session() [node]
 4: 0xce7192 node::http2::Http2Session::~Http2Session() [node]
 5: 0x106f01d v8::internal::GlobalHandles::InvokeFirstPassWeakCallbacks() [node]
 6: 0x10f3215 v8::internal::Heap::PerformGarbageCollection(v8::internal::GarbageCollector, v8::internal::GarbageCollectionReason, char const*) [node]
 7: 0x10f3d7c v8::internal::Heap::CollectGarbage(v8::internal::AllocationSpace, v8::internal::GarbageCollectionReason, v8::GCCallbackFlags) [node]
 8: 0x10ca081 v8::internal::HeapAllocator::AllocateRawWithLightRetrySlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [node]
 9: 0x10cb215 v8::internal::HeapAllocator::AllocateRawWithRetryOrFailSlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [node]
10: 0x10a8866 v8::internal::Factory::NewFillerObject(int, v8::internal::AllocationAlignment, v8::internal::AllocationType, v8::internal::AllocationOrigin) [node]
11: 0x15035f6 v8::internal::Runtime_AllocateInYoungGeneration(int, unsigned long*, v8::internal::Isolate*) [node]
12: 0x7f41df699ef6 
Aborted (core dumped)
</code></pre><p>After several retries I correlated this crash to the exact moment when my HTTP/2 client disconnects from the Node.js server. This made sense because the <code>assert()</code> call was inside the <code>Http2Session</code> destructor. Let’s take a look at the code (Node.js v21.5.0):</p>
<div><pre tabindex="0"><code data-lang="cpp"><span><span>528</span><span><span>Http2Session</span><span>::~</span><span>Http2Session</span><span>()</span> <span>{</span>
</span></span><span><span>529</span><span>  <span>CHECK</span><span>(</span><span>!</span><span>is_in_scope</span><span>());</span>
</span></span><span><span>530</span><span>  <span>Debug</span><span>(</span><span>this</span><span>,</span> <span>"freeing nghttp2 session"</span><span>);</span>
</span></span><span><span>531</span><span>  <span>// Explicitly reset session_ so the subsequent
</span></span></span><span><span>532</span><span><span></span>  <span>// current_nghttp2_memory_ check passes.
</span></span></span><span><span>533</span><span><span></span>  <span>session_</span><span>.</span><span>reset</span><span>();</span>
</span></span><span><span>534</span><span>  <span>CHECK_EQ</span><span>(</span><span>current_nghttp2_memory_</span><span>,</span> <span>0</span><span>);</span>
</span></span><span><span>535</span><span><span>}</span></span></span></code></pre></div>
<p>Node.js is embedding <a href="https://nghttp2.org/">nghttp2</a> library for HTTP/2 connections handling. <code>current_nghttp2_memory_</code> is used to track memory allocated by nghttp2 internals and the assertion in the destructor simply ensures that all nghttp2 artifacts are properly removed from memory which happens in <code>reset</code> method (line 533). The value is updated: increased and decreased in several places in the code, often in a nghttp2 callback functions.</p>
<p>There was no other option than to check nghttp2 internals and see who is to blame: Node.js by incorrectly calculating the memory usage, or nghttp2 by giving invalid data used in calculations. After quite a long investigation I couldn’t find anything wrong with calculations which pointed to a possibility of a race condition: <code>current_nghttp2_memory_</code> value was updated elsewhere, at the same time when <code>~Http2Session</code> was being executed.</p>
<p>I found an instance of this case: <code>reset()</code> and nghttp2 callback when <code>CONTINUATION</code> frame is parsed are executed together. When <code>CONTINUATION</code> frame arrives the following chain on events occur when state machine is in <a href="https://github.com/nghttp2/nghttp2/blob/48168eacdb7815375747cd01b886d65a5c4e0931/lib/nghttp2_session.c#L6892"><code>NGHTTP2_IB_EXPECT_CONTINUATION</code> state</a>:</p>
<ul>
<li>we go the happy path so state is changed to <code>NGHTTP2_IB_READ_HEADER_BLOCK</code>, from there it calls:</li>
<li><code>session_after_header_block_received</code> which calls:</li>
<li><code>session_call_on_frame_received</code> which calls:</li>
<li><code>on_frame_recv_callback</code>.</li>
</ul>
<p>The last one calls <code>OnFrameReceive</code> callback in Node.js and later: <code>HandleHeadersFrame</code> which does some memory counter update:
</p><div><pre tabindex="0"><code data-lang="cpp"><span><span>1454</span><span>  <span>DecrementCurrentSessionMemory</span><span>(</span><span>stream</span><span>-&gt;</span><span>current_headers_length_</span><span>);</span>
</span></span><span><span>1455</span><span>  <span>stream</span><span>-&gt;</span><span>current_headers_length_</span> <span>=</span> <span>0</span><span>;</span></span></span></code></pre></div>
<div><pre tabindex="0"><code data-lang="cpp"><span><span>746</span><span>  <span>void</span> <span>DecrementCurrentSessionMemory</span><span>(</span><span>uint64_t</span> <span>amount</span><span>)</span> <span>{</span>
</span></span><span><span>747</span><span>    <span>DCHECK_LE</span><span>(</span><span>amount</span><span>,</span> <span>current_session_memory_</span><span>);</span>
</span></span><span><span>748</span><span>    <span>current_session_memory_</span> <span>-=</span> <span>amount</span><span>;</span>
</span></span><span><span>749</span><span>  <span>}</span></span></span></code></pre></div>
<p>Now, when <code>HandleHeadersFrame</code> and <code>Http2Session::~Http2Session()</code> are executed at the same time it’s possible that they will update the <code>current_session_memory_</code> variable at the same time:</p>
<p><code>Http2Session::~Http2Session()</code>
</p><div><pre tabindex="0"><code data-lang="cpp"><span><span>529</span><span><span>CHECK</span><span>(</span><span>!</span><span>is_in_scope</span><span>());</span>
</span></span><span><span>530</span><span><span>Debug</span><span>(</span><span>this</span><span>,</span> <span>"freeing nghttp2 session"</span><span>);</span>
</span></span><span><span>531</span><span><span>// Explicitly reset session_ so the subsequent
</span></span></span><span><span>532</span><span><span>// current_nghttp2_memory_ check passes.
</span></span></span><span><span>533</span><span><span></span><span>session_</span><span>.</span><span>reset</span><span>();</span></span></span></code></pre></div>
<code>DecrementCurrentSessionMemory</code>:
<div><pre tabindex="0"><code data-lang="cpp"><span><span>747</span><span><span>DCHECK_LE</span><span>(</span><span>amount</span><span>,</span> <span>current_session_memory_</span><span>);</span>
</span></span><span><span>748</span><span><span>current_session_memory_</span> <span>-=</span> <span>amount</span><span>;</span></span></span></code></pre></div>
<code>Http2Session::~Http2Session()</code>
<div><pre tabindex="0"><code data-lang="cpp"><span><span>534</span><span><span>CHECK_EQ</span><span>(</span><span>current_nghttp2_memory_</span><span>,</span> <span>0</span><span>);</span></span></span></code></pre></div>
<p>This is why <code>CHECK_EQ</code> fails as <code>current_nghttp2_memory_</code> value is negative.</p>
<h2 id="comparison-to-previous-http2-vulnerabilities">Comparison to previous HTTP/2 vulnerabilities</h2>
<p>There were a couple of HTTP/2 vulnerabilities in the past. In 2019, a batch of them was reported by Netflix and Google. They are listed in CERT/CC Vulnerability Note <a href="https://kb.cert.org/vuls/id/605641/">VU#605641</a> and the most similar are:</p>
<blockquote>
<p>CVE-2019-9516, also known as 0-Length Headers Leak</p>
<p>The attacker sends a stream of headers with a 0-length header name and 0-length header value, optionally Huffman encoded into 1-byte or greater headers. Some implementations allocate memory for these headers and keep the allocation alive until the session dies. This can consume excess memory, potentially leading to a denial of service.</p>
</blockquote>
<p><code>CONTINUATION</code> Flood is different than CVE-2019-9516 because rather than sending empty headers, an attacker sends many random headers up to the frame size limit configured by the server.</p>
<blockquote>
<p>CVE-2019-9518, also known as Empty Frame Flooding</p>
<p>The attacker sends a stream of frames with an empty payload and without the end-of-stream flag. These frames can be DATA, HEADERS, CONTINUATION and/or PUSH_PROMISE. The peer spends time processing each frame disproportionate to attack bandwidth. This can consume excess CPU, potentially leading to a denial of service.</p>
</blockquote>
<p>CVE-2019-9518 is about sending empty frames. The <code>CONTINUATION</code> Flood consists of the largest possible frames that occupy memory and consume CPU cycles while being decoded.</p>
<p>In October 2023 the details of “Rapid Reset”, a zero day in HTTP/2 protocol, were published and the vulnerability was immedietly dubbed <a href="https://cloud.google.com/blog/products/identity-security/google-cloud-mitigated-largest-ddos-attack-peaking-above-398-million-rps">“the largest DDoS attack to date”</a>. The details of this attack are explained in Cloudflare’s <a href="https://blog.cloudflare.com/technical-breakdown-http2-rapid-reset-ddos-attack">article</a>, and while the severity of this vulnerability is different across many implementations, I think it’s important to list main points explaining why the new vulnerability seems to be more severe:</p>
<ul>
<li>Rapid Reset used a combination of <code>HEADERS</code> (with <code>END_STREAM</code> and <code>END_HEADERS</code> flags set) and <code>RST_STREAM</code> frames which means that standard mitigations like rate limiting could at least limit the damage. Also, the server admin would see a lot of inbound server requests and be alerted. <strong>During <code>CONTINUATION</code> Flood attack not a single request is made (no <code>END_HEADERS</code> flag)! Admins do not see any requests in the logs!</strong></li>
<li>In many implementations <strong>just one</strong> TCP connection was enough to crash the server (and in some cases with a very small amount of data sent) during the <code>CONTINUATION</code> Flood attack. On contrary, Rapid Reset was used in DDoS attacks (in most cases using a botnet was required for an attack to be successful).</li>
</ul>

<p>According to <a href="https://radar.cloudflare.com/adoption-and-usage">Cloudflare Radar</a> the HTTP/2 traffic accounts for around 60% of all human HTTP traffic (data excluding bots):</p>
<p><img src="https://nowotarski.info/cf_radar_http2.png" alt="HTTP/2 distribution stats"></p>
<p>Given that Cloudflare Radar estimates HTTP traffic data above 70% of all internet transfer and significance of affected projects I believe that we can assume that large part of internet was affected by an easy-to-exploit vulnerability: in many cases just a single TCP connection was enough to crash the server. Don’t forget that HTTP runs not only websites but significant portion of APIs (RESTful APIs). Availability issues with important business and government APIs and websites could incur losses of millions of dollar. Or cause chaos, for example: Poland, the main supplier of heavy weapons to Ukraine which also operates the most important military hub near Ukraine border, <a href="https://www.euronews.com/2024/03/06/poland-experiences-increase-in-ddos-attacks-from-russia">experiences increase in DDoS attacks</a> originating from Russia.</p>
<p><img src="https://nowotarski.info/cf_radar_traffic.png" alt="HTTP/2 in total traffic"></p>
<p>Had it been exploited in the wild, this would have been very hard to debug without proper HTTP/2 knowledge by the server administrators. This is due to the fact that none of malicious HTTP requests connected to this vulnerability is properly closed. The requests would not be visible in the server access logs and due to lack of advanced frame analytics in most of HTTP/2 servers this would have to be handled by manual, tedious raw connection data analysis.</p>
<p><strong>This vulnerability class posed a significant risk to the internet safety!</strong> Because of this I am glad that <a href="https://www.kb.cert.org/vuls/">CERT/CC</a> decided to open a Vulnerability Coordination case to track this issue after I reported it in January 2024. Working on a responsible disclosure of this vulnerability with technology giants and open source projects was a great experience. It would be impossible to check so many implementations by a single resesearcher so Vulnerability Coordination is irreplaceable tool for handling issues that affect multiple vendors. Other than opening the case, CERT/CC decided to publish a <a href="https://kb.cert.org/vuls/id/421644">Vulnerability Note</a> about this issue, which is quite rare: only a few notes are published each year. Thank you to Christopher Cullen for handling the issue on CERT/CC side.</p>

		</section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[The V8 Sandbox (151 pts)]]></title>
            <link>https://v8.dev/blog/sandbox</link>
            <guid>39930809</guid>
            <pubDate>Thu, 04 Apr 2024 14:24:53 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://v8.dev/blog/sandbox">https://v8.dev/blog/sandbox</a>, See on <a href="https://news.ycombinator.com/item?id=39930809">Hacker News</a></p>
<div id="readability-page-1" class="page"><div itemprop="articleBody"><p>After almost three years since the <a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit?usp=sharing">initial design document</a> and <a href="https://github.com/search?q=repo%3Av8%2Fv8+%5Bsandbox%5D&amp;type=commits&amp;s=committer-date&amp;o=desc">hundreds of CLs</a> in the meantime, the V8 Sandbox — a lightweight, in-process sandbox for V8 — has now progressed to the point where it is no longer considered an experimental security feature. Starting today, the <a href="https://g.co/chrome/vrp/#v8-sandbox-bypass-rewards">V8 Sandbox is included in Chrome's Vulnerability Reward Program</a> (VRP). While there are still a number of issues to resolve before it becomes a strong security boundary, the VRP inclusion is an important step in that direction. Chrome 123 could therefore be considered to be a sort of "beta" release for the sandbox. This blog post uses this opportunity to discuss the motivation behind the sandbox, show how it prevents memory corruption in V8 from spreading within the host process, and ultimately explain why it is a necessary step towards memory safety.</p><h2 id="motivation" tabindex="-1">Motivation <a href="#motivation">#</a></h2><p>Memory safety remains a relevant problem: all Chrome exploits <a href="https://docs.google.com/spreadsheets/d/1lkNJ0uQwbeC1ZTRrxdtuPLCIl7mlUreoKfSIgajnSyY/edit?usp=sharing">caught in the wild in the last three years</a> (2021 – 2023) started out with a memory corruption vulnerability in a Chrome renderer process that was exploited for remote code execution (RCE). Of these, 60% were vulnerabilities in V8. However, there is a catch: V8 vulnerabilities are rarely "classic" memory corruption bugs (use-after-frees, out-of-bounds accesses, etc.) but instead subtle logic issues which can in turn be exploited to corrupt memory. As such, existing memory safety solutions are, for the most part, not applicable to V8. In particular, neither <a href="https://www.cisa.gov/resources-tools/resources/case-memory-safe-roadmaps">switching to a memory safe language</a>, such as Rust, nor using current or future hardware memory safety features, such as <a href="https://newsroom.arm.com/memory-safety-arm-memory-tagging-extension">memory tagging</a>, can help with the security challenges faced by V8 today.</p><p>To understand why, consider a highly simplified, hypothetical JavaScript engine vulnerability: the implementation of <code>JSArray::fizzbuzz()</code>, which replaces values in the array that are divisible by 3 with "fizz", divisible by 5 with "buzz", and divisible by both 3 and 5 with "fizzbuzz". Below is an implementation of that function in C++. <code>JSArray::buffer_</code> can be thought of as a <code>JSValue*</code>, that is, a pointer to an array of JavaScript values, and <code>JSArray::length_</code> contains the current size of that buffer.</p><pre><code> <span>1.</span> <span>for</span> <span>(</span><span>int</span> index <span>=</span> <span>0</span><span>;</span> index <span>&lt;</span> length_<span>;</span> index<span>++</span><span>)</span> <span>{</span><br> <span>2.</span>     JSValue js_value <span>=</span> buffer_<span>[</span>index<span>]</span><span>;</span><br> <span>3.</span>     <span>int</span> value <span>=</span> <span>ToNumber</span><span>(</span>js_value<span>)</span><span>.</span><span>int_value</span><span>(</span><span>)</span><span>;</span><br> <span>4.</span>     <span>if</span> <span>(</span>value <span>%</span> <span>15</span> <span>==</span> <span>0</span><span>)</span><br> <span>5.</span>         buffer_<span>[</span>index<span>]</span> <span>=</span> <span>JSString</span><span>(</span><span>"fizzbuzz"</span><span>)</span><span>;</span><br> <span>6.</span>     <span>else</span> <span>if</span> <span>(</span>value <span>%</span> <span>5</span> <span>==</span> <span>0</span><span>)</span><br> <span>7.</span>         buffer_<span>[</span>index<span>]</span> <span>=</span> <span>JSString</span><span>(</span><span>"buzz"</span><span>)</span><span>;</span><br> <span>8.</span>     <span>else</span> <span>if</span> <span>(</span>value <span>%</span> <span>3</span> <span>==</span> <span>0</span><span>)</span><br> <span>9.</span>         buffer_<span>[</span>index<span>]</span> <span>=</span> <span>JSString</span><span>(</span><span>"fizz"</span><span>)</span><span>;</span><br><span>10.</span> <span>}</span></code></pre><p>Seems simple enough? However, there's a somewhat subtle bug here: the <code>ToNumber</code> conversion in line 3 can have side effects as it may invoke user-defined JavaScript callbacks. Such a callback could then shrink the array, thereby causing an out-of-bounds write afterwards. The following JavaScript code would likely cause memory corruption:</p><pre><code><span>let</span> array <span>=</span> <span>new</span> <span>Array</span><span>(</span><span>100</span><span>)</span><span>;</span><br><span>let</span> evil <span>=</span> <span>{</span> <span>[</span>Symbol<span>.</span>toPrimitive<span>]</span><span>(</span><span>)</span> <span>{</span> array<span>.</span>length <span>=</span> <span>1</span><span>;</span> <span>return</span> <span>15</span><span>;</span> <span>}</span> <span>}</span><span>;</span><br>array<span>.</span><span>push</span><span>(</span>evil<span>)</span><span>;</span><br><span>// At index 100, the @@toPrimitive callback of |evil| is invoked in</span><br><span>// line 3 above, shrinking the array to length 1 and reallocating its</span><br><span>// backing buffer. The subsequent write (line 5) goes out-of-bounds.</span><br>array<span>.</span><span>fizzbuzz</span><span>(</span><span>)</span><span>;</span></code></pre><p>Note that this vulnerability could occur both in hand-written runtime code (as in the example above) or in machine code generated at runtime by an optimizing just-in-time (JIT) compiler (if the function was implemented in JavaScript instead). In the former case, the programmer would conclude that an explicit bounds-check for the store operations is not necessary as that index has just been accessed. In the latter case, it would be the compiler drawing the same incorrect conclusion during one of its optimization passes (for example <a href="https://en.wikipedia.org/wiki/Partial-redundancy_elimination">redundancy elimination</a> or <a href="https://en.wikipedia.org/wiki/Bounds-checking_elimination">bounds-check elimination)</a> because it doesn't model the side effects of <code>ToNumber()</code> correctly.</p><p>While this is an artificially simple bug (this specific bug pattern has become mostly extinct by now due to improvements in fuzzers, developer awareness, and researcher attention), it is still useful to understand why vulnerabilities in modern JavaScript engines are difficult to mitigate in a generic way. Consider the approach of using a memory safe language such as Rust, where it is the compiler's responsibility to guarantee memory safety. In the above example, a memory safe language would likely prevent this bug in the hand-written runtime code used by the interpreter. However, it would <em>not</em> prevent the bug in any just-in-time compiler as the bug there would be a logic issue, not a "classic" memory corruption vulnerability. Only the code generated by the compiler would actually cause any memory corruption. Fundamentally, the issue is that <em>memory safety cannot be guaranteed by the compiler if a compiler is directly part of the attack surface</em>.</p><p>Similarly, disabling the JIT compilers would also only be a partial solution: historically, roughly half of the bugs discovered and exploited in V8 affected one of its compilers while the rest were in other components such as runtime functions, the interpreter, the garbage collector, or the parser. Using a memory-safe language for these components and removing JIT compilers could work, but would significantly reduce the engine's performance (ranging, depending on the type of workload, from 1.5–10× or more for computationally intensive tasks).</p><p>Now consider instead popular hardware security mechanisms, in particular <a href="https://googleprojectzero.blogspot.com/2023/08/mte-as-implemented-part-1.html">memory tagging</a>. There are a number of reasons why memory tagging would similarly not be an effective solution. For example, CPU side channels, which can <a href="https://security.googleblog.com/2021/03/a-spectre-proof-of-concept-for-spectre.html">easily be exploited from JavaScript</a>, could be abused to leak tag values, thereby allowing an attacker to bypass the mitigation. Furthermore, due to <a href="https://v8.dev/blog/pointer-compression">pointer compression</a>, there is currently no space for the tag bits in V8's pointers. As such, the entire heap region would have to be tagged with the same tag, making it impossible to detect inter-object corruption. As such, while memory tagging <a href="https://googleprojectzero.blogspot.com/2023/08/mte-as-implemented-part-2-mitigation.html">can be very effective on certain attack surfaces</a>, it is unlikely to represent much of a hurdle for attackers in the case of JavaScript engines.</p><p>In summary, modern JavaScript engines tend to contain complex, 2nd-order logic bugs which provide powerful exploitation primitives. These cannot be effectively protected by the same techniques used for typical memory-corruption vulnerabilities. However, nearly all vulnerabilities found and exploited in V8 today have one thing in common: the eventual memory corruption necessarily happens inside the V8 heap because the compiler and runtime (almost) exclusively operate on V8 <code>HeapObject</code> instances. This is where the sandbox comes into play.</p><h2 id="the-v8-(heap)-sandbox" tabindex="-1">The V8 (Heap) Sandbox <a href="#the-v8-(heap)-sandbox">#</a></h2><p>The basic idea behind the sandbox is to isolate V8's (heap) memory such that any memory corruption there cannot "spread" to other parts of the process' memory.</p><p>As a motivating example for the sandbox design, consider the <a href="https://en.wikipedia.org/wiki/User_space_and_kernel_space">separation of user- and kernel space</a> in modern operating systems. Historically, all applications and the operating system's kernel would share the same (physical) memory address space. As such, any memory error in a user application could bring down the whole system by, for example, corrupting kernel memory. On the other hand, in a modern operating system, each userland application has its own dedicated (virtual) address space. As such, any memory error is limited to the application itself, and the rest of the system is protected. In other words, a faulty application can crash itself but not affect the rest of the system. Similarly, the V8 Sandbox attempts to isolate the untrusted JavaScript/WebAssembly code executed by V8 such that a bug in V8 does not affect the rest of the hosting process.</p><p>In principle, <a href="https://docs.google.com/document/d/12MsaG6BYRB-jQWNkZiuM3bY8X2B2cAsCMLLdgErvK4c/edit?usp=sharing">the sandbox could be implemented with hardware support</a>: similar to the userland-kernel split, V8 would execute some mode-switching instruction when entering or leaving sandboxed code, which would cause the CPU to be unable to access out-of-sandbox memory. In practice, no suitable hardware feature is available today, and the current sandbox is therefore implemented purely in software.</p><p>The basic idea behind the <a href="https://docs.google.com/document/d/1FM4fQmIhEqPG8uGp5o9A-mnPB5BOeScZYpkHjo0KKA8/edit?usp=sharing">software-based sandbox</a> is to replace all data types that can access out-of-sandbox memory with "sandbox-compatible" alternatives. In particular, all pointers (both to objects on the V8 heap or elsewhere in memory) and 64-bit sizes must be removed as an attacker could corrupt them to subsequently access other memory in the process. This implies that memory regions such as the stack cannot be inside the sandbox as they must contain pointers (for example return addresses) due to hardware and OS constraints. As such, with the software-based sandbox, only the V8 heap is inside the sandbox, and the overall construction is therefore not unlike the <a href="https://webassembly.org/docs/security/">sandboxing model used by WebAssembly</a>.</p><p>To understand how this works in practice, it is useful to look at the steps an exploit has to perform after corrupting memory. The goal of an RCE exploit would typically be to perform a privilege escalation attack, for example by executing shellcode or performing a return-oriented programming (ROP)-style attack. For either of these, the exploit will first want the ability to read and write arbitrary memory in the process, for example to then corrupt a function pointer or place a ROP-payload somewhere in memory and pivot to it. Given a bug that corrupts memory on the V8 heap, an attacker would therefore look for an object such as the following:</p><pre><code><span>class</span> <span>JSArrayBuffer</span><span>:</span> <span><span>public</span> <span>JSObject</span></span> <span>{</span><br>  <span>private</span><span>:</span><br>    byte<span>*</span> buffer_<span>;</span><br>    size_t size_<span>;</span><br><span>}</span><span>;</span></code></pre><p>Given this, the attacker would then either corrupt the buffer pointer or the size value to construct an arbitrary read/write primitive. This is the step that the sandbox aims to prevent. In particular, with the sandbox enabled, and assuming that the referenced buffer is located inside the sandbox, the above object would now become:</p><pre><code><span>class</span> <span>JSArrayBuffer</span><span>:</span> <span><span>public</span> <span>JSObject</span></span> <span>{</span><br>  <span>private</span><span>:</span><br>    sandbox_ptr_t buffer_<span>;</span><br>    sandbox_size_t size_<span>;</span><br><span>}</span><span>;</span></code></pre><p>Where <code>sandbox_ptr_t</code> is a 40-bit offset (in the case of a 1TB sandbox) from the base of the sandbox. Similarly, <code>sandbox_size_t</code> is a "sandbox-compatible" size, <a href="https://source.chromium.org/chromium/chromium/src/+/main:v8/include/v8-internal.h;l=231;drc=5bdda7d5edcac16b698026b78c0eec6d179d3573">currently limited to 32GB</a>.<br>Alternatively, if the referenced buffer was located outside of the sandbox, the object would instead become:</p><pre><code><span>class</span> <span>JSArrayBuffer</span><span>:</span> <span><span>public</span> <span>JSObject</span></span> <span>{</span><br>  <span>private</span><span>:</span><br>    external_ptr_t buffer_<span>;</span><br><span>}</span><span>;</span></code></pre><p>Here, an <code>external_ptr_t</code> references the buffer (and its size) through a pointer table indirection (not unlike the <a href="https://en.wikipedia.org/wiki/File_descriptor">file descriptor table of a unix kernel</a> or a <a href="https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/Table">WebAssembly.Table</a>) which provides memory safety guarantees.</p><p>In both cases, an attacker would find themselves unable to "reach out" of the sandbox into other parts of the address space. Instead, they would first need an additional vulnerability: a V8 Sandbox bypass. The following image summarizes the high-level design, and the interested reader can find more technical details about the sandbox in the design documents linked from <a href="https://chromium.googlesource.com/v8/v8.git/+/refs/heads/main/src/sandbox/README.md"><code>src/sandbox/README.md</code></a>.</p><figure><img alt="" height="458" loading="lazy" src="https://v8.dev/_img/sandbox/sandbox.svg" width="567"><figcaption>A high-level diagram of the sandbox design</figcaption></figure><p>Solely converting pointers and sizes to a different representation is not quite sufficient in an application as complex as V8 and there are <a href="https://issues.chromium.org/hotlists/4802478">a number of other issues</a> that need to be fixed. For example, with the introduction of the sandbox, code such as the following suddenly becomes problematic:</p><pre><code>std<span>::</span>vector<span>&lt;</span>std<span>::</span>string<span>&gt;</span> <span>JSObject</span><span>::</span><span>GetPropertyNames</span><span>(</span><span>)</span> <span>{</span><br>    <span>int</span> num_properties <span>=</span> <span>TotalNumberOfProperties</span><span>(</span><span>)</span><span>;</span><br>    std<span>::</span>vector<span>&lt;</span>std<span>::</span>string<span>&gt;</span> <span>properties</span><span>(</span>num_properties<span>)</span><span>;</span><p>    <span>for</span> <span>(</span><span>int</span> i <span>=</span> <span>0</span><span>;</span> i <span>&lt;</span> <span>NumberOfInObjectProperties</span><span>(</span><span>)</span><span>;</span> i<span>++</span><span>)</span> <span>{</span><br>        properties<span>[</span>i<span>]</span> <span>=</span> <span>GetNameOfInObjectProperty</span><span>(</span>i<span>)</span><span>;</span><br>    <span>}</span></p><p>    <span>// Deal with the other types of properties</span><br>    <span>// ...</span></p></code></pre><p>This code makes the (reasonable) assumption that the number of properties stored directly in a JSObject must be less than the total number of properties of that object. However, assuming these numbers are simply stored as integers somewhere in the JSObject, an attacker could corrupt one of them to break this invariant. Subsequently, the access into the (out-of-sandbox) <code>std::vector</code> would go out of bounds. Adding an explicit bounds check, for example with an <a href="https://chromium.googlesource.com/v8/v8.git/+/0deeaf5f593b98d6a6a2bb64e3f71d39314c727c"><code>SBXCHECK</code></a>, would fix this.</p><p>Encouragingly, nearly all "sandbox violations" discovered so far are like this: trivial (1st order) memory corruption bugs such as use-after-frees or out-of-bounds accesses due to lack of a bounds check. Contrary to the 2nd order vulnerabilities typically found in V8, these sandbox bugs could actually be prevented or mitigated by the approaches discussed earlier. In fact, the particular bug above would already be mitigated today due to <a href="http://issues.chromium.org/issues/40228527">Chrome's libc++ hardening</a>. As such, the hope is that in the long run, the sandbox becomes a <strong>more defensible security boundary</strong> than V8 itself. While the currently available data set of sandbox bugs is very limited, the VRP integration launching today will hopefully help produce a clearer picture of the type of vulnerabilities encountered on the sandbox attack surface.</p><h2 id="performance" tabindex="-1">Performance <a href="#performance">#</a></h2><p>One major advantage of this approach is that it is fundamentally cheap: the overhead caused by the sandbox comes mostly from the pointer table indirection for external objects (costing roughly one additional memory load) and to a lesser extent from the use of offsets instead of raw pointers (costing mostly just a shift+add operation, which is very cheap). The current overhead of the sandbox is therefore only around 1% or less on typical workloads (measured using the <a href="https://browserbench.org/Speedometer3.0/">Speedometer</a> and <a href="https://browserbench.org/JetStream/">JetStream</a> benchmark suites). This allows the V8 Sandbox to be enabled by default on compatible platforms.</p><h2 id="testing" tabindex="-1">Testing <a href="#testing">#</a></h2><p>A desirable feature for any security boundary is testability: the ability to manually and automatically test that the promised security guarantees actually hold in practice. This requires a clear attacker model, a way to "emulate" an attacker, and ideally a way of automatically determining when the security boundary has failed. The V8 Sandbox fulfills all of these requirements:</p><ol><li><strong>A clear attacker model:</strong> it is assumed that an attacker can read and write arbitrarily inside the V8 Sandbox. The goal is to prevent memory corruption outside of the sandbox.</li><li><strong>A way to emulate an attacker:</strong> V8 provides a "memory corruption API" when built with the <code>v8_enable_memory_corruption_api = true</code> flag. This emulates the primitives obtained from typical V8 vulnerabilities and in particular provides full read- and write access inside the sandbox.</li><li><strong>A way to detect "sandbox violations":</strong> V8 provides a "sandbox testing" mode (enabled via either <code>--sandbox-testing</code> or <code>--sandbox-fuzzing</code>) which installs a <a href="https://source.chromium.org/chromium/chromium/src/+/main:v8/src/sandbox/testing.cc;l=425;drc=97b7d0066254778f766214d247b65d01f8a81ebb">signal handler</a> that determines if a signal such as <code>SIGSEGV</code> represents a violation of the sandbox's security guarantees.</li></ol><p>Ultimately, this allows the sandbox to be integrated into Chrome's VRP program and be fuzzed by specialized fuzzers.</p><h2 id="usage" tabindex="-1">Usage <a href="#usage">#</a></h2><p>The V8 Sandbox must be enabled/disabled at build time using the <code>v8_enable_sandbox</code> build flag. It is (for technical reasons) not possible to enable/disable the sandbox at runtime. The V8 Sandbox requires a 64-bit system as it needs to reserve a large amount of virtual address space, currently one terabyte.</p><p>The V8 Sandbox has already been enabled by default on 64-bit (specifically x64 and arm64) versions of Chrome on Android, ChromeOS, Linux, macOS, and Windows for roughly the last two years. Even though the sandbox was (and still is) not feature complete, this was mainly done to ensure that it does not cause stability issues and to collect real-world performance statistics. Consequently, recent V8 exploits already had to work their way past the sandbox, providing helpful early feedback on its security properties.</p><h2 id="conclusion" tabindex="-1">Conclusion <a href="#conclusion">#</a></h2><p>The V8 Sandbox is a new security mechanism designed to prevent memory corruption in V8 from impacting other memory in the process. The sandbox is motivated by the fact that current memory safety technologies are largely inapplicable to optimizing JavaScript engines. While these technologies fail to prevent memory corruption in V8 itself, they can in fact protect the V8 Sandbox attack surface. The sandbox is therefore a necessary step towards memory safety.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[AI-generated sad girl with piano performs the text of the MIT License (352 pts)]]></title>
            <link>https://twitter.com/goodside/status/1775713487529922702</link>
            <guid>39930463</guid>
            <pubDate>Thu, 04 Apr 2024 13:57:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://twitter.com/goodside/status/1775713487529922702">https://twitter.com/goodside/status/1775713487529922702</a>, See on <a href="https://news.ycombinator.com/item?id=39930463">Hacker News</a></p>
Couldn't get https://twitter.com/goodside/status/1775713487529922702: Error: Request failed with status code 400]]></description>
        </item>
        <item>
            <title><![CDATA[Homemade 6 GHz pulse compression radar (129 pts)]]></title>
            <link>https://hforsten.com/homemade-6-ghz-pulse-compression-radar.html</link>
            <guid>39930195</guid>
            <pubDate>Thu, 04 Apr 2024 13:32:03 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://hforsten.com/homemade-6-ghz-pulse-compression-radar.html">https://hforsten.com/homemade-6-ghz-pulse-compression-radar.html</a>, See on <a href="https://news.ycombinator.com/item?id=39930195">Hacker News</a></p>
<div id="readability-page-1" class="page"><section id="content">
        <article>
            
            <div>
                
                <h2 id="introduction">Introduction</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/fmcw_vs_pulsed_radar.svg" width="70%/"></p><p>FMCW and pulse radar architectures.</p>
</div>

<p>I have <a href="https://hforsten.com/third-version-of-homemade-6-ghz-fmcw-radar.html">previously made several FMCW radars</a> that
have worked well. FMCW (Frequency Modulated Continuous Wave) radar is quite easy
and cheap to make. It uses separate transmit and receive antennas, which avoids
the need for switching between receiving and transmitting. It mixes the received
signal with the transmitted signal, resulting in a low output frequency, making it
possible to use low-speed analog-to-digital converter (ADC). However, big,
serious radars typically aren't FMCW radars, instead they are pulse radars.
Switching one antenna between transmit and receive modes allows them to use just
one antenna. When an antenna diameter is measured in meters it matters a lot how
many are needed. Pulse radar can use large transmit power without worrying about
saturating the receiver, which is a big issue with FMCW radar. Pulse radar is
also better for measuring velocity of fast-moving targets as it can transmit
pulses more frequently, resulting in larger maximum unambiguous Doppler shift
it can measure.</p>
<p>For these reasons, FMCW radars are usually used in short range applications such as
automotive radars and aircraft altimeters, while pulse radars are used mainly
for long-range applications such as weather radars, aircraft detection, and
synthetic aperture radar imaging from aircraft or satellite.</p>
<p>Pulse radar is much more difficult to design than FMCW radar. To share one
antenna, very fast switching between transmit and receive is needed. Radar pulses
travel at the speed of light, and for example, if switching from transmit to
receive takes 1 microsecond, all the reflections from targets in 150-meter
distance would be missed during the switching time. Sharing one antenna
causes the radar to have a minimum detection distance, which can be hundreds of
meters which makes it unsuitable for short-range operation.</p>
<p>Another difficulty is that pulse radar requires much faster ADC to capture the
received pulses. FMCW radar mixes transmitted and received waveforms which
results in a low-frequency sine wave for each target at the mixer output, for
short-range operation, it's possible to use ADC sampling frequency of 1 MHz or
even less while using hundreds of MHz of RF bandwidth. Pulse radar requires
much faster ADC, typically fast enough to sample the whole RF bandwidth of the
transmitted pulse. The range resolution of the radar is determined by the RF
bandwidth, and for useful range resolution ADC sampling rate should be hundreds
of MHz or even over 1 GHz. This fast ADCs are very expensive and require
expensive digital electronics to handle all the data.</p>
<p>This article is about my experiences building a modern pulse radar utilizing
fast digital signal processing cheaply.</p>

<p>There are many kinds of pulse radars, and the one I want to make is a pulse
compression radar that supports arbitrary waveforms. Generating only linear
frequency sweeps could be simpler and sufficient for many practical
applications, but it wouldn't be as interesting.</p>
<p>The requirement for arbitrary waveform means that there needs to be
a digital-to-analog converter (DAC) with large enough sampling rate to generate
the transmitted waveform. The receiver also needs an ADC with large enough sample
rate to sample the whole RF bandwidth.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/pulsed_rf_block.svg" width="60%/"></p><p>Radar RF side block diagram.</p>
</div>

<p>Above is the block diagram of the radar. The architecture is very similar to
software-defined radio (SDR) and it could be used as a radio too. The radar has
two time-multiplexed receiver antennas with transmitter being shared with one of
them. I added the second receiver channel mainly because it was very cheap, it
only requires additional switch, LNA and SMA connector. The second receiver
channel makes it possible to use the radar also in FMCW mode.</p>
<p>In a proper radar system some filtering would be useful at both transmitter and
receiver, but I left it out here to save money.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/zero_and_nonzero_if_transmitter.svg" width="90%/"></p><p>Superheterodyne and zero-IF (direct conversion)
    transmitters. Superheterodyne mixing to IF frequency is done digitally.</p>
</div>

<p>TX and RX are zero-IF architecture. This is not ideal from a performance point
of view but it's the cheapest option. The output of all mixers contains not only
the desired frequency-shifted signal but also local oscillator (LO) leakage and
image signals, which is the same signal as the desired one but mixed at the
opposite side of the LO frequency. If DAC generated the signal at offset
frequency it would be possible to filter out the unwanted frequencies at the
mixer output with a bandpass filter, but with zero-IF transmitter these unwanted
frequencies overlap the signal, making it impossible to filter them out with
a fixed filter.</p>
<p>Similarly, these same nonidealities are also present at the receiver. These
nonidealities cause distortion of the received waveform, leading to increased
range sidelobes for each target.</p>
<p>While superheterodyne architecture would provide better performance,
implementing it would require more hardware and my goal is to make a working
system with minimal budget. With zero-IF architecture many of the nonidealities
can be compensated sufficiently digitally. Predistorting the DAC output signal
can compensate for the mixer nonidealities, resulting in a clean output signal.
Receiver output signal can also similarly be modified digitally to remove many
of the nonidealities if they can be characterized to sufficient precision.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xcomplex_signal.png.pagespeed.ic.NrNjZNiZ8Y.png" width="60%/"></p><p>Complex linear frequency sweep signal in time
    domain and instantenous frequency.</p>
</div>

<p>The DAC outputs a <a href="http://whiteboard.ping.se/SDR/IQ">complex IQ signal</a> that is
modulated by the IQ mixer to the LO frequency and transmitted by the antenna,
transmit/receive switch is then switched to receive and reflected signal is
sampled by the receiver. Each target reflects some of the transmitted signal and
the reflected signal is a sum of the signals from each target.</p>
<p>Complex IQ format allows representing both positive and negative frequencies at
the baseband. At the transmitter IQ modulator the I and Q signals are mixed
against LO and 90 degree phase shifted LO and summed. The result is
that positive baseband frequencies are shifted above the LO frequency and
negative frequencies at baseband below the LO frequency.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/pulse_compression.svg" width="60%/"></p><p>Pulse compression of the received signal. By
    correlating with the reference signal the power from pulse is
    concentrated.</p>
</div>

<p>To get the target locations convolution is calculated against the transmitted
signal. At the time instance where there was a target the received
and transmitted signals correlate and convolution results is large, when there
isn't a signal there isn't a correlation and convolution result is small. In
practice the convolution is calculated using fast Fourier transform (FFT) as
that is faster in practice than calculating the convolution in time domain.</p>
<p>In the above plot sidelobes can be seen around the two targets in the result.
These result from the convolution output not being completely zero when the
waveform isn't aligned. Multiplying the reference pulse by a windowing function
can be used to control the sidelobes of the convolution output. Windowing
function can also be applied to the transmitted pulse to further decrease the
sidelobes. Drawback of windowing is that it widens the mainlobe and results in
slightly worse range resolution. How much sidelobes are traded for resolution
can be controlled by the used windowing function.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/radar_processing.svg" width="80%/"></p><p>Range-Doppler processing. Only the amplitude of
    the pulse is plotted in graph. Phase of the signal is important for Doppler
    FFT.</p>
</div>

<p>Besides the distance to the target, radar can also measure velocity of the
target from how phase of the received signal changes during many measurements.
By sending a burst of pulses and calculating FFT over the number of pulses
dimension, the targets are separated both in velocity and range in the resulting
range-Doppler map.</p>
<p>Velocity could be also measured from change of distance, but the beauty of using
phase shift of the received signal is that velocity can be obtained from the
same measurement as the distance, multiple objects at the same range but with
different velocities can be separated, and the measurement accuracy is much
better. Detecting multiple objects at the same range with different velocity
is important for separating moving objects from stationary objects such as
ground, trees, and buildings that can have a large reflected signal that would
otherwise mask a small moving object.</p>
<p>Measuring angle of the target would also be possible with multiple antennas, but
in this case with one antenna there isn't angle information.</p>
<h2 id="adc-and-dac">ADC and DAC</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xadcs.png.pagespeed.ic.hvJUWZ1TvY.png" width="60%/"></p><p>2 channel LVDS interface ADCs with &gt;10 bits, sample rate vs price from Digikey.</p>
</div>

<p>ADC sample rate is one of the most important parameters for the system as it
determines the maximum RF bandwidth that the system can receive. ADC sample rate
should be as fast as is affordable. In general, it's much easier to make the RF
side and DAC to have greater bandwidth than ADC, and it's ADC bandwidth that
limits the system.</p>
<p>The requirement for ADC is having at least two channels, this is required for
IQ sampling, and LVDS output interface. Two one-channel ADCs could also be used
but it's disadvantageous from PCB area and routing perspective. The fastest ADCs
usually have JESD204B digital interface, the problem with it that it requires
high-end FPGA with high-speed serial transceivers and those are in general too
expensive for my budget. LVDS is the highest speed interface that can be
connected to regular FPGA I/O pins.</p>
<p>In the above plot are all 2 channel ADC with LVDS interface and at least 10
bits. The best sample rate for price is
<a href="https://www.ti.com/product/ADS4229">ADS4229</a> with 250 MHz sample rate for 58
EUR / piece in single quantity. Even higher ADC sample rate would be very
desirable, but any higher sample rate than this would get much more expensive.
There is one two channel 8-bit ADC with 500 MHz sample rate for 73 EUR
/ piece, but it has 20 dB lower SNR than the 12-bit ADC and doubling the sample
rate would only give back 3 dB SNR. Low bit ADC would decrease the dynamic range
of the receiver making it more prone to saturation, and it would require more
gain before the ADC, so I decided against using it despite the higher sample rate.</p>
<p>Suitable DACs are easier to find, and I chose to use
<a href="https://www.ti.com/product/DAC3174">DAC3174</a> two-channel 14-bit 500 MHz DAC
costing 33 EUR / piece. While the system bandwidth is limited by the ADC, it's
useful to have more than enough bandwidth on the DAC to make filtering easier.</p>
<h3 id="adc-filter">ADC filter</h3>
<p>ADC requires anti-aliasing filter before it to limit the signal frequency to
below half of sample rate (<a href="https://en.wikipedia.org/wiki/Nyquist_rate">Nyquist rate</a>) to avoid aliasing. To get the largest usable bandwidth
the cutoff frequency of the anti-aliasing low-pass filters should be as close as
possible to the Nyquist rate, but this makes implementation of the filter
difficult as it needs to have very sharp cutoff.</p>
<p>Filter should also have equal amplitude and group delay on the passband.
Amplitude requirement is easy to understand, we don't want to have different
frequencies attenuated different amounts. Group delay measures how much
different frequencies are delayed by the filter. If the group delay difference
is too large for different frequencies, the received pulse is distorted by the
filter decreasing its correlation to the reference pulse. In practice, this
shows up as higher sidelobes.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xadc_lowpass_sim.png.pagespeed.ic.6PdegRt1M2.png" width="80%/"></p><p>ADC lowpass simulation setup.</p>
</div>

<p>Source impedance of the IQ demodulator is 50 ohms differential. ADC input is also
differential, and its impedance varies with frequency having high impedance at
lower frequencies, but at higher frequencies the input capacitance is
significant. ADC datasheet provides a model for the ADC input which I added to
the simulation setup. It suggests adding a resistor at the input that sets
the input impedance, series resistors to limit ringing due to bond wires and
additional resistor and capacitor across inputs to filter sampling glitches.
While adding a 50 ohm resistor across the ADC input would be good for filter
design perspective it attenuates the signal too much as there already isn't
enough gain in the receiver and the IQ demodulator linearity decreases with low
output impedance. I added instead 200 ohm resistor to minimize the signal
attenuation. This makes the filter design challenging, as the high
load impedance requires using small capacitors and large inductors. Higher
impedance also increases the effect of sampling glitches, which are caused by
ADC input sampling capacitors rapidly sampling the input signal. Adding IF
amplifier would have made the filter design easier.</p>
<p>100 nF series capacitors decouple the DC levels of IQ demodulator and ADC.
While it would be good to have DC coupled signals, the DC levels of IQ
demodulator and ADC are different and any significantly different DC levels
would limit the maximum AC signal range.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/adc_lowpass_f.svg" width="70%/"></p><p>Simulated frequency response of the ADC lowpass
    filter. Nyquist frequency marked with vertical line.</p>
</div>

<p>The cutoff frequency of the filter is set at 100 MHz and there should be -20 dB
attenuation at the Nyquist frequency of 125 MHz. Up to about 60 MHz both
magnitude and group delay are very good, above that it could be better but its
hard to improve with these constraints. There is some variation in the passband
magnitude that would have been smaller with 50 ohm impedance. Group delay is
relatively good at medium frequencies, at very low frequencies AC coupling
capacitor causes the delay to shoot up and near the cutoff frequency there is
a peak in the delay. The filter response can be compensated digitally if its
a problem.</p>
<h3 id="dac-anti-alias-filter">DAC anti-alias filter</h3>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/dac_lowpass_f.svg" width="70%/"></p><p>Simulated frequency response of the DAC lowpass
    filter. Nyquist frequency marked with vertical line.</p>
</div>

<p>Digital-to-analog converter is also a sampled system, and it has unwanted aliases
at the output that need to be filtered out. The sample rate of DAC is 500 MHz
which compared to required signal bandwidth of 100 MHz makes the filter design
much easier. The alias frequencies are in the range 400 to 500 MHz for 0 to 100
MHz signal.</p>
<p>The filter is designed to have flat magnitude and group delay below 100 MHz and
in the simulator both look very good. Cutoff frequency is just above 100 MHz so
that the peak in group delay is above 100 MHz. The aliases are much further away
in frequency than with the ADC, and they are attenuated at least 65 dB more than
the signal. This amount of attenuation is more than enough for the DAC aliases
to not cause any issues, but it does mean that they are visible at the RF
output.  If the signal power is 30 dBm, then the image signal is about -35 dBm.
For proper radar the attenuation likely should be higher to avoid radiating
power at other than the allocated frequency band.</p>
<h2 id="fpga">FPGA</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xzynq-mp-core-dual.png.pagespeed.ic.n5a6bvGZR3.png" width="40%/"></p><p>Xilinx Zynq FPGA block diagram. The chip has
    two-core ARM CPU and programmable logic with fast interconnect between them.</p>
</div>

<p>Using just a microcontroller isn't possible for this application. FPGA is
required for accurate timing of pulse generation and for managing the ADC and
DAC data. Accurate timing of pulse generation is critical for proper operation.
Switching between transmit and receive needs to be done quickly and accurately,
any timing error in pulse triggering or in the receiver will be visible as large
distance error.</p>
<p>Pricing of the FPGAs is very bizarre. Looking at Digikey or other resellers many
of the suitable parts have prices starting in hundreds of dollars and
better ones can cost several thousand. However, the exact same parts can be
found for fraction of price from China. For some reason, Zynq 7020 is one of the
cheapest Zynq FPGAs in China available at $17, while the exact same part from
Digikey costs $173.</p>
<p>Zynq 7020 has dual-core ARM-A9 CPU and typical FPGA programmable logic in the
same package. Having also a CPU core is useful as it can handle communication to
PC. It can also run Linux and I added SD-card for Linux file system if I want to
use it, but initially software is running without any operating system.</p>
<h2 id="digital-design">Digital design</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/pulsed_digital_block.svg" width="60%/"></p><p>Block diagram of digital interfaces.</p>
</div>

<p>With fast ADC and DAC moving a lot of data, it's important to consider whether the
system can keep up. In the above block diagram, digital interfaces between
important blocks have been drawn. The FPGA SoC consists of two parts: processing
system (PS), which is dual-core ARM A9 CPU, and programmable logic (PL), which is
programmable FPGA fabric. They are connected to each other through with four 
64-bit <a href="https://en.wikipedia.org/wiki/Advanced_eXtensible_Interface">AXI</a> buses.
Their clock frequency is configurable and, in this case, it's set to 130 MHz
which is near the upper limit that it can work. One AXI bus is reserved for ADC
Direct Memory Access (DMA) and other for DAC DMA, there's also a third, lower
speed AXI bus (not drawn in the diagram) for configuring the registers in the
programmable logic.</p>
<p>A fast connection to the PC is needed to quickly transfer captured ADC samples.
Initially, the digital processing will be done on PC, but it should be
possible to do it on FPGA too for some applications. If the interface to PC is
much slower than the ADC data generation rate, it limits how often the radar can be
triggered. For target tracking, this means slower update rate of target
positions.</p>
<p>1 Gbps Ethernet is the fastest interface to PC that can be easily connected to
this FPGA chip. USB 3 is another possible choice, offering 5 Gbps speed with
easy connection to PC, but it would require an external USB 3 transceiver chip
and more effort to make it work.</p>
<p>The system has a single DDR3 DRAM chip that is connected to the PS side of the FPGA.
While the memory chip could be clocked faster, the memory interface speed is
limited by the FPGA memory controller to 1066 MHz. Memory bus width is 16-bits. 
The memory controller supports up to 32-bits, but it would require adding a second
DDR3 chip and the higher bandwidth is not necessary in this system.</p>
<p>ADC samples are received by the PL side, which has a small FIFO buffer and DMA
controller transfer them to DRAM through the PL side. DAC also has its own DMA
channel, but DMA uses only one AXI bus limiting it to 8.3 Gbps, which is less
than what the DAC needs. It's also important to note that DDR3 bandwidth is less
than the sum of the DAC and ADC bandwidths, making streaming DAC samples from
DRAM while storing ADC samples at the same time impossible. For this reason,
there is a small 1 MB memory on the PL side that stores DAC samples. Pulse samples
are transferred from PC to DRAM through Ethernet, then DMA transfers them to the
small memory on the PL where they are transferred to the DAC every pulse.</p>
<p>A small DAC memory limits the pulse length to 130 µs, but it's plenty for pulse
radar. A 130 µs pulse corresponds to 20 km minimum detection distance, and
typical pulse length is about 1 µs. The pulse could also be generated on PL,
eliminating the need for memory, but lookup table implementation makes it easier
to change pulse parameters such as windowing function, pre-distortion, and test
different types of pulse waveforms.</p>
<h2 id="rf-design">RF design</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xpulsed_pcb_3d_rf.jpg.pagespeed.ic.H6GSk5i7Xa.jpg" width="60%/"></p><p>RF parts take only a small portion of
    the PCB area. It's also a small amount of required work on the project
    although it seems like it should be the important part.</p>
</div>

<p>With the digital parts out of the way it's time to look at the RF side.
Designing the RF parts is relatively straight forward. Similar to my previous
radars, the operating frequency will be around 6 GHz. This is the highest
frequency with many off-the-shelf cheap components due to many consumer
applications.</p>
<p>RF part consists of: IQ modulator, IQ demodulator, PLL for generating the LO
frequency, power amplifier, low noise amplifiers and switches.</p>
<p>IQ modulator should have low LO leakage, high image rejection, enough output
power to drive PA without needing another amplifier, and baseband voltage level
compatible with the DAC output voltage range. There aren't that many
possible commercial chip alternatives and most of them are very similar in
performance. Same applies also to the IQ demodulator.</p>
<p>Choosing a power amplifier was more difficult. While big, expensive radars often
have transmit power measured in kW or even MW, but that's unrealistic in this
case.  I would like to have at least 1 W peak RF power but there are
surprisingly few choices at 6 GHz band despite WLAN applications
that require power amplifiers. The best suitable amplifier I found was <a href="https://www.skyworksinc.com/Products/Amplifiers/SE5004L">Skyworks
SE5004L</a>, which has
2 W typical output 1 dB compression point and high gain of 32 dB, but its
documentation is severely lacking. There isn't any graph of gain vs frequency
and it requires some external components, but there aren't any values for them in
the datasheet. The solution for external components is found in the SE5004L-EK1
evaluation kit documentation, which has the schematic of the evaluation board of
this chip. It's also out of stock at the moment at common resellers although
it's available at some Chinese resellers. In the end I did decide to go with it
because there aren't many other cheap alternatives with enough output power.</p>
<p>Switching speed of the T/R switch is very important, and it should have high
enough power handling capability to handle the 1 W power amplifier output
without blowing up or distorting the signal. Especially the fast switching speed
is a though requirement that rules out many options. I ended up choosing
<a href="https://cdn.macom.com/datasheets/MASW-007588.pdf">MASW-007588</a> switch that has
55 ns switching speed and 37 dBm 1 dB compression point. While 55 nanoseconds is fast,
in that time light travels 16.5 meters. There are better switches specifically
made for this kind of applications, but they are too expensive for my budget.</p>
<p>Another option would be to use circulator instead of switch. This is
common for higher power radars as circulators can handle hundreds of Watts of
power, and there is no switching speed. There are some circulators for this
frequency, but big issue with them is that they are very large and much more
expensive than simple switch.</p>
<p>The receiver should have enough amplification that the RF noise floor is above
the ADC quantization noise floor. The RF noise floor spectrum at the ADC input
can be calculated as <span>\(kT\)</span>, where <span>\(k\)</span> is the Boltzmann constant and <span>\(T\)</span> is
temperature in Kelvin. This results in power density of about -174 dBm/Hz at
room temperature.</p>
<p>LNA amplifies the thermal noise and adds some noise to it which is determined by
LNA's noise figure. Switches and PCB lines have some losses. IQ demodulator's
voltage conversion gain can be used to calculate the output voltage density at
the ADC input.</p>
<p>ADC noise floor can be calculated from SNR specification, 69.4 dBFs (decibels
relative to full scale) in this case, sample rate 250 MHz, and maximum input
voltage 2 V peak-to-peak (0.707 Vrms). Noise is then 69.4 dB below 0.707 Vrms
maximum input voltage for each sample, and there are 250 million samples in one
second which equals bandwidth of one Hertz. This gives the ADC noise floor
density of -156 dBV/Hz.</p>
<p>Calculating the RF noise floor at the ADC input after considering the whole
signal chain from starting from LNA gives noise floor of about -155 dBV/Hz. This
is barely not enough gain. RF noise floor should be much higher than the ADC
noise floor, typically about 10 dB, so that the ADC quantization noise doesn't
increase the noise of the whole receiver. An ADC driver amplifier could easily have
enough gain, but low-frequency amplifiers with high enough bandwidth are
surprisingly expensive. In the end, I just decided to have few dB higher noise
floor.</p>
<h2 id="maximum-detection-range">Maximum detection range</h2>
<p>The maximum detection range of the radar can be calculated as following:</p>
<p>The transmitter transmits a pulse of length <span>\(t_s\)</span> with average power of <span>\(P_t\)</span>,
which is radiated by the transmitter antenna with gain <span>\(G\)</span>.
The power density (<span>\(W/m^2\)</span>) at distance <span>\(r\)</span> can be written using <a href="https://en.wikipedia.org/wiki/Friis_transmission_equation">Friis'
equation</a> as <span>\(P_t G
/ (4 \pi r^2)\)</span>. This power is reflected by a target with a radar cross-section of
<span>\(\sigma\)</span> and some of it is reflected back to the radar. The received power depends
on the effective area of the receiving antenna: <span>\(P_r = P_t G A_e / ((4\pi
r^2)^2)\)</span>. <span>\(A_e\)</span> can be written in terms of the antenna gain as <span>\(A_e = \lambda^2
G / 4 \pi\)</span>, where <span>\(\lambda\)</span> is the wavelength of the RF signal. The equation for
the received power at the receiver input can be written as:</p>
<p>$$P_r = \frac{P_t G^2 \lambda^2 \sigma}{(4\pi)^3 r^4}$$</p>
<p>This is the received power from one pulse. To increase the received power, multiple
received pulses can be coherently summed. It's important that the summation is
coherent so that the phases of the received pulses are aligned. In practice,
instead of summing, an FFT is used so that power from moving targets can be
coherently summed and separated from each other.</p>
<p>To get the maximum detection range, we need to find the minimum
detectable received power. The detection performance is limited by the noise of
the receiver. Thermal noise density (W/Hz) of the receiver is <span>\(kT\)</span>, where <span>\(k\)</span> is
the <a href="https://en.wikipedia.org/wiki/Johnson%E2%80%93Nyquist_noise#Derivation">Boltzmann constant</a> and
<span>\(T\)</span> is the receiver temperature in Kelvin. The receiver amplifies this thermal
noise and adds its own noise to it. The noise factor, <span>\(F\)</span>, of the receiver is
how much higher the noise floor of the output is compared to theoretical thermal
noise floor if there wouldn't be any added noise. This can be calculated from
the receiver gain, RF amplifier's noise figure and ADC's noise floor.</p>
<p>To get the noise floor, we need to multiply the thermal noise density <span>\(kT\)</span> by the
receiver noise factor <span>\(F\)</span> and the receiver's noise bandwidth <span>\(B\)</span>. The correct
noise bandwidth to use is the minimum bandwidth after all the signal processing
which noise can't be separated from the signal. For example, by taking the Fourier
transform of the input signal, we can discard all the frequency bins that are
beyond where our signal is, and noise at those discarded frequencies won't
affect the detection capabilities of the receiver. Pulse compression ideally
collects all of the power of a pulse within a bandwidth of <span>\(1/t_s\)</span> for a linear
frequency sweep. However, in practice, FFT windowing functions and any mismatch
between reference and received pulses will decrease this slightly.</p>
<p>The minimum detectable signal should be higher than the noise floor by some
margin. The threshold value for detections can be chosen freely, but there is
a trade-off: if we accept detections that are only just above the noise floor,
occasionally some of them may be false detections resulting from noise
just happening to be above the detection threshold. The probability of false alarm
depends on the method used to estimate the signal-to-noise ratio of the
detection. For an ideal detector, the false alarm probability can be calculated
based on the probability that normally distributed noise is above the detection
threshold. Common threshold value is usually around 13 to 15 dB.</p>
<p>At the maximum detection distance the received power is equal to minimum
detectable signal:</p>
<p>$$\frac{n P_t G^2 \lambda^2 \sigma}{(4\pi)^3 r^4} = \frac{kTFS}{t_s}$$</p>
<p>,where <span>\(n\)</span> is the number of pulses, and <span>\(S\)</span> is the detection threshold compared
to the noise floor. Solving for <span>\(r\)</span> gives the maximum detection range:</p>
<p>$$r_{\text{max}} = \sqrt[4]{\frac{n t_s P_t G^2 \lambda^2 \sigma}{(4\pi)^3 kTFS}}$$</p>
<table>
<tbody><tr>
<th>Variable</th>
<th>Explanation</th>
<th>Value</th>
</tr>
<tr>
<td><span>\(P_t\)</span></td>
<td>Transmitted power</td>
<td>30 dBm</td>
</tr>
<tr>
<td><span>\(G\)</span></td>
<td>Gain of antennas</td>
<td>14 dBi</td>
</tr>
<tr>
<td><span>\(\lambda\)</span></td>
<td>Wavelength</td>
<td>5.2 cm</td>
</tr>
<tr>
<td><span>\(\sigma\)</span></td>
<td>Target radar cross-section</td>
<td>1 m²</td>
</tr>
<tr>
<td><span>\(T\)</span></td>
<td>Receiver temperature</td>
<td>290 K</td>
</tr>
<tr>
<td><span>\(t_s\)</span></td>
<td>Pulse length</td>
<td>1 µs</td>
</tr>
<tr>
<td><span>\(n\)</span></td>
<td>Number of pulses in burst</td>
<td>1024</td>
</tr>
<tr>
<td><span>\(F\)</span></td>
<td>Receiver noise figure</td>
<td>5 dB</td>
</tr>
<tr>
<td><span>\(S\)</span></td>
<td>Detection threshold</td>
<td>15 dB</td>
</tr>
</tbody></table>

<p>In the above table are estimations of the radar system parameters. Plugging
these values in the equation gives a maximum detection distance for target with
1 <span>\(m^2\)</span> radar cross-section of 1200 meters. This might be slightly
optimistic, as there are losses in the cables to antennas, loss from antenna
efficiency, losses from mismatch, and atmosphere attenuation. However, the
maximum detection distance should still be about 1 km. At this maximum distance
the average received power from a target is equal to the minimum detection
threshold. Therefore, on average, a target at this distance is detected 50% of
the time. Due to normally distributed noise, there is a chance that a target at
shorter distance is not detected, and a target at longer distance could be
detected. However, because of the fourth power dependence of the received power,
the probability of detection drops quickly at larger distances.</p>
<h2 id="pcb-design">PCB design</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/pcb_block.svg" width="50%/"></p><p>Simplified PCB block diagram. PLL generates 6 GHz
    RF local oscillator and clock generator generates clocks for ADC, DAC and
    FPGA.</p>
</div>

<p>Practical implementation of the system requires designing a printed circuit
board (PCB) that integrates all the components. The system has both RF and
high-speed digital circuits that require careful PCB routing to make sure that
they function correctly.</p>
<p>The PCB has six layers, and I don't think the FPGA can be routed with any less 
layers. The material is standard FR-4, which isn't ideal for RF routing since it's
quite lossy, but it isn't a big issue in this case since the RF trace length is
kept very short.</p>
<h2 id="ddr3-routing">DDR3 routing</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xddr3_routing.png.pagespeed.ic.8S306Gkquc.png" width="60%/"></p><p>DDR3 routing implementation. Source: <a href="https://docs.xilinx.com/v/u/en-US/ug933-Zynq-7000-PCB">UG933</a></p>
</div>

<p>DDR3 DRAM memory connected to the PS side of the FPGA runs at 533 MHz clock
frequency with two transfer per clock cycle. The memory uses the DDR3L standard,
which is a low-voltage version of the DDR3 standard with a 1.35 V operating
voltage instead of the normal DDR3 1.5 V supply voltage. While this isn't very
fast by the modern standards, it still requires some care with the routing.
Memory traces should be length matched, have correct characteristic impedance,
and be terminated properly to minimize reflections.</p>
<p>The nominal characteristic impedance of DDR3 traces is 40 ohms. A shared address
bus is fly-by routed to all memory chips and terminated with a 40 ohm resistor
to VTT supply, which is at half of the memory supply voltage. Each memory chip
has its own data traces with on-chip termination. There are also few control
lines that are routed to all memory chips. With only one memory chip on the PCB,
the routing is much simpler.</p>
<p>The memory bus can be simulated with circuit simulators before being
manufactured. Professional programs have ways to do finite element simulation of
the PCB, but this is quite difficult with open source software. FPGA and memory
chip driver and receiver electrical models are provided as
<a href="https://en.wikipedia.org/wiki/Input/output_Buffer_Information_Specification">IBIS</a>
files. I used <a href="https://www.kicad.org/">KiCad</a> to design the PCB and it's
supposed to include IBIS support but it was unclear how to use it. I ended up
using
<a href="http://www.spisim.com/products/free-apps/spisim_ibis-a-free-web-app-for-simulating-ibis-using-free-simulators/">SPISim_IBIS</a>
web app to convert the IBIS models to SPICE netlists and simulate them with <a href="https://ngspice.sourceforge.io/">ngspice</a>.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ddr3_spice.svg" width="40%/"></p><p>DDR3 memory routing simulation of a single trace.</p>
</div>

<p>I was interested in simulating if address bus termination resistors can be left
out in this case where there is only one memory chip, and it's mounted close to
the FPGA. I have seen this done on at least one FPGA development board, and it
would save some PCB space if termination resistors could be left out.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ddr3_term_40.svg" width="50%/"></p><p>DDR3 databus with 40 ohm line and termination.</p>
</div>

<p>Normally, an eye diagram is used to analyze the timing margin of the memory bus.
However, it's not easy to simulate it with ngspice, so I just added a pulse
source and did a transient simulation plotting the voltage at the memory chip
input. With 120 ps line delay, 40 ohm line impedance, and termination resistance
the memory chip input voltage looks fine. High and low thresholds are 0.81 and
0.54 V according to the memory chip datasheet, and the signal looks very good in
the simulator.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ddr3_no_term.svg" width="50%/"></p><p>DDR3 databus without termination resistors.</p>
</div>

<p>Without termination resistors, the voltage looks fine from the threshold level
point of view. However, there is significant under and overshoot. Supply
voltages are 0 V and 1.35 V, and the memory chip input voltage overshoots by about
0.7 V, which is enough to forward bias the ESD (Electrostatic discharge)
protection diodes of the memory chip. This might be fine in practice, but memory
chip datasheet says that the overshoot should be limited to maximum of 0.4 V.
For this reason, I added the address line termination resistors.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ddr3_term_60.svg" width="50%/"></p><p>DDR3 databus with 60 ohm line and 50 ohm
    termination resistors.</p>
</div>

<p>While removing the termination resistors violates the datasheet guarantees, it's
possible in this case to use 60 ohm line impedance and 50 ohm termination
resistors with minimal difference in the signal integrity. The benefit of using
higher line impedance is that it results in narrower line on PCB allowing for
denser layout. A 40 ohm trace is 0.24 mm wide, while 60 ohm trace is 0.10 mm wide.
Using narrower trace also allows having more distance between different traces,
which decreases cross-talk between traces. 50 ohm termination resistor is
close enough to the trace impedance, and since 50 ohms resistors are needed on
other places on the PCB, using 50 ohm resistor allows removing one resistor
value from the bill of materials, making the assembly slightly cheaper.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xddr3_traces.png.pagespeed.ic.Uo21Wc53GD.png" width="80%/"></p><p>DDR3 routing. FPGA on the right and DDR3 chip and
    the termination resistors on the left. Top left is the top layer and bottom
    right is the bottom one advancing horizontally.</p>
</div>

<p>Above is the final DDR3 routing on all the PCB layers. Layers 2 and 6 are
ground, 5 is supply voltage, and others are reserved for signals. Two grounds are
needed for correct impedances on the top, middle, and bottom traces of the PCB.
With only one ground plane, the distance from the signal to ground would be too
large on either the top or bottom layer. Data bus traces are swapped within the byte
boundary to make the routing easier. The traces are length-matched with squiggly
lines, and some traces are manually drawn on the ground and supply layers to
decrease the size of slots in the planes due to vias. The trace matching
requirement is ±10 ps according to the Zynq PCB design guide, which is
approximately ±2mm in trace length. However, considering the faster memory chip
and having only one memory chip, the actual margin should be much greater. There
is also some delay difference inside the FPGA package which should be considered
in the length matching.</p>
<h2 id="transmission-line-termination">Transmission line termination</h2>
<p>The T/R switch needs to be switched as fast as possible to minimize dead time
between transmit and receive, and the same applies for the IQ modulator enable pin.
The FPGA I/O pin driver strength can be controlled, and with the highest drive
strength it has a rise time of about 400 ps at the switch input in simulator.
However, few centimeters of PCB trace between the FPGA and switch input functions as
a transmission line, which has significant effect at these frequencies.</p>
<p>The switch input pin is not matched to 50 ohms, and a typical CMOS input has
high input impedance. This causes reflections, which severely distorts the
switching waveform.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/switch_termination_sch.svg" width="50%/"></p><p>Termination of switch input with capacitor and
    resistor.</p>
</div>

<p>To minimize reflections, the transmission line should be terminated to the
characteristic impedance of the transmission line, which is 50 ohms in this
case. Placing a 50 ohm resistor to ground near the switch input pin would
work, but it would sink DC current and cause the DC voltage to drop. Termination
to supply voltage has a similar issue except that now voltage can't reach 0 V.</p>
<p>Termination with a 50 ohm resistor in series with a small capacitor solves the DC
level issue. Capacitor value should be tuned so that high-frequency reflections
are absorbed without affecting the low frequencies too much.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/switch_termination.svg" width="80%/"></p><p>Simulation of switch voltage with and without
    termination.</p>
</div>

<p>Above is the simulated voltage at the switch input. Transmission line length was
300 ps, and termination capacitor was set to 12 pF. Without termination there is
significant over and undershoot, and a risk that the voltage drops below the
threshold voltage slowing the switching. With the termination, the waveform is much
cleaner.</p>
<h2 id="power-supply">Power supply</h2>
<p>Analog electronic components are sensitive to supply voltage noise. This is
especially important for RF receiver with input signal at the level of the
thermal noise floor.</p>
<p>Switching regulators have good efficiency, often around 90%, but their output has
switching noise that is significantly higher than the thermal noise floor. If
this noise isn't filtered properly, it will couple into the received and
transmitted waveforms and cause interference at the receiver. A linear regulator,
often called low-dropout regulator (LDO) for historical reasons, functions as 
a variable resistor, dissipating enough power to ensure that the output voltage
is at the correct level. The output noise is much lower, but if the voltage drop is
too large the efficiency is terrible.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xldo_psrr.png.pagespeed.ic.-BDKH1ixK2.png" width="50%/"></p><p>Power supply rejection rate (PSRR) of TPS7A7001 LDO.</p>
</div>

<p>To have both good efficiency and low noise, it's common to have a switching
regulator followed by an LDO to filter the switching noise. However, this
isn't enough filtering in this case. LDO filters well very low
frequencies, but it's filtering capability drops at the higher frequencies.
Above is the power supply rejection ratio (PSRR) of the LDO I'm using. For
example, with a 1 mV amplitude, 2.5 MHz signal at the LDO input is attenuated by
about 15 dB, resulting in about 200 µV amplitude signal at the output.</p>
<p>The requirement for minimum power supply filtering can be obtained with few
assumptions about the coupling of the noise. The smallest signal level is at the
input of the receiver LNA. The thermal noise floor is -174 dBm/Hz at room
temperature. With a 10 ms measurement time, the bandwidth is 100 Hz. This
results in a maximum of -154 dBm power at the LNA input. At 50 ohm impedance,
this corresponds to 5 nV RMS voltage. If the LNA supply voltage is modulated by
noise, it affects the gain of the amplifier, and the supply voltage noise is
mixed to the RF signal. In practice, the allowed noise amplitude can be
larger since there is usually some power supply rejection at the LNA for
low-frequency supply voltage noise to the output RF frequency, but it's usually
not specified in the datasheet. With a 10 mV worst-case switching noise amplitude,
the required attenuation is 120 dB to reach the noise floor. LDO can be assumed
to filter about 10 dB, and we can assume another 10 dB power supply rejection
from the RF components, which sets the power supply filtering requirement to 100
dB.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xferrite_sim_sch.png.pagespeed.ic.-COknQZHMw.png" width="60%/"></p><p>Two-stage ferrite bead filter schematic. Capacitor
    parasitics drawn individually.</p>
</div>

<p>The required power supply filter can be designed with ferrite beads. They are
inductors that are lossy at high frequencies. A capacitor is needed after the
ferrite bead to complete the low-pass filter. The series resistance and
inductance of the capacitor are crucial at these frequencies, and they are
included in the schematic, assuming an SMD ceramic capacitor.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ferrite_sim_f.svg" width="60%/"></p><p>Ferrite bead filter frequency response.</p>
</div>

<p>The above filter achieves 100 dB attenuation at 1 MHz. The switching frequency is
2.5 MHz, and this filter works well at that frequency. However, it has a resonance at 30
kHz, which increases the noise at the output at that frequency. This is caused by
the ferrite bead behaving like an low-loss inductor at low frequencies which resonates
with the capacitor due to a lack of resistance that would dampen the resonance. It
can be fixed in two ways: adding resistance in series with the capacitor or
increasing the capacitance. Resistance could be also added in series with the
ferrite bead, but this is possible only if the DC current is small.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ferrite_sim2_f.svg" width="60%/"></p><p>Ferrite bead filter frequency response with 20 µF
    first capacitor and 200 µF second capacitor.</p>
</div>

<p>With larger capacitors, the resonance is much smaller, and the attenuation
increases slightly.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/ferrite_istep.svg" width="60%/"></p><p>Time domain response to 1 A current step. One
    ferrite bead with 200 µF capacitance. The response is underdamped and
    increasing capacitor ESR would decrease the oscillation.</p>
</div>

<p>An important limitation of the ferrite bead filter is its time domain response. If
the output current changes quickly, the inductance of the ferrite bead tries to
keep the current through it constant, which means that the output capacitor needs
to supply the high-frequency current. If the output capacitor is small, it can't
supply the current, and the output voltage drops. If there isn't enough
resistance either in series with the ferrite bead or in series with the
capacitor, the output voltage oscillates before settling. Especially the power
amplifier that has high current draw needs a lot of capacitance to ensure that
the supply voltage doesn't drop as it's switched on.</p>
<p>The time domain response can be improved by placing the ferrite bead before the
LDO. The LDO is then able to keep the output voltage constant while the input
voltage dips, but it needs to be ensured that the voltage after the ferrite bead
doesn't dip too low so that the LDO stays in regulation. I placed one ferrite
bead before the LDO and a second one before each analog component. The first one
filters the switching noise, and the second ferrite bead adds additional
filtering for each IC. Besides filtering the switching noise, the second ferrite
bead for each IC also improves the isolation between components, which is
desired between transmitter and receiver. Having a ferrite bead close to each
component also reduces the length of the trace that can work as an antenna to
pick up radiated noise.</p>
<p>In total, the PCB has nine different supply voltages. There are six
supplies for FPGA and digital electronics: 1.0 V for FPGA core supply, 1.8 V,
2.5 V, and 3.3 V for various digital chips, 1.35 V and 0.675 V for DDR3 RAM. The
noise on these rails isn't too important for the system performance. Analog
electronics have low-noise 1.8 V, 3.3 V, and 5.0 V rails with linear regulators
and ferrite bead filtering.</p>
<h2 id="adc-and-dac-routing">ADC and DAC routing</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xadc_traces.jpg.pagespeed.ic._1IbwNL9yU.jpg" width="40%/"></p><p>ADC data trace routing to FPGA. ADC footprint on
    the right side, FPGA out of view on the left side.</p>
</div>

<p>The ADC connects to the FPGA with a 12-bit wide LVDS bus. The ADC also generates a clock
signal that is center-aligned to the data. The sampling rate of the ADC is 250
MHz, and there are two channels with one channel's data on the rising edge and the other on
the falling edge of the clock. This data rate is too fast for the FPGA to capture
statically, requiring dynamic capture that uses adjustable delay lines to
correct for the signal delay programmatically. These delay lines also make the
length-matching requirement for the PCB routing quite loose.</p>
<p>The DAC also has an LVDS interface but it operates at 500 MHz with 14-bits. This
FPGA doesn't have adjustable output delay lines, so the line lengths must be
length-matched to make sure that the DAC can capture the data. The DAC datasheet
provides setup and hold times for the interface, and plugging these values into
the FPGA synthesizer tool indicates that the timing can be met with ±25 ps trace
delay, which corresponds to about ±4 mm difference in the data trace lengths
compared to the clock trace. Even higher delay might work, but it's good practice
to match the interface as well as possible, especially since it can't be
adjusted in software like the ADC interface.</p>
<p>On the FPGA side, it's important to set the supply voltages for the banks with
LVDS to 2.5 V with this FPGA part. For the receiver, only this voltage works
correctly with internal 100 ohm termination. Using internal 100 ohm
termination instead of external 100 ohm resistors on each data line makes the
routing easier and saves PCB space. The DAC LVDS transmitter also needs a 2.5
V supply voltage for both common mode and differential voltages to be compatible
with what the DAC expects.</p>
<h2 id="1-gbps-ethernet">1 Gbps Ethernet</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xrtl8211f_sch.png.pagespeed.ic.hOLL5u2KWP.png" width="50%/"></p><p>Ethernet chip schematic connections. The chip
    requires several configuration resistors.</p>
</div>

<p>The Ethernet interface needs an external PHY chip that is between the Ethernet
connector and the FPGA. The cheapest one I could find was Realtek RTL8211F,
which can be found for $1 in single quantities from China. While the RTL8211E version of
the chip is found on many FPGA development boards, the F version is much more
uncommon. The challenge with this chip is that officially the datasheet is
provided only under NDA. However, it is available from the Chinese resellers
with big "Confidential" and "Not for public release" labels. However, the
datasheet isn't quite clear on how it should be connected, and there aren't any
example schematics in it. Searching this chip on Google, I did find few
schematics of boards using it, which gave me some confidence that I can wire it
correctly. See the above schematic on how it should be wired for FPGA if you are
also looking to use it.</p>
<p>Important note about the Zynq FPGA is that the Ethernet interface doesn't meet
the RGMII interface (FPGA to Ethernet chip interface) specifications when used
with 3.3 V supply voltage. Because of this, I had to set the FPGA PS side supply
voltage to 1.8 V, which requires adding level shifters for SD card and UART that
are powered from the same voltage.</p>
<h2 id="jtag-and-debug-uart">JTAG and debug UART</h2>
<p>FPGA is programmed and debugged with JTAG connection. On development boards
there is usually a connector and external JTAG debugger is used to connect to
the development board. The official JTAG debugger is quite expensive with $270 list
price and I don't want to pay for one.</p>
<p>FTDI makes FT2232H chip that can convert from USB to JTAG and UART. This can be
used to implement the JTAG interface cheaper. There used to be a drawback that
it wasn't supported by the Xilinx official tools which made debugging the design
much harder, but now it's <a href="https://docs.xilinx.com/r/en-US/ug908-vivado-programming-debugging/Programming-FTDI-Devices-for-Vivado-Hardware-Manager-Support">officially
supported</a>
if the EEPROM memory is programmed with tool provided by Xilinx.</p>
<p>FT2232H also has UART output that is useful for debugging the ARM processor
code. Calling printf in the processor code prints characters to the debug UART.</p>
<h2 id="clock-generator">Clock generator</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/block_clock.svg" width="50%/"></p><p>Simplified block diagram of clock signals.</p>
</div>

<p>Accurate timing of the whole system is very important. Several clock signals are
unavoidable since the ADC runs on 250 MHz, the DAC runs at 500 MHz, and the FPGA
requires even lower clock frequency. The FPGA does have several phase-locked
loops that can be used to generate clocks, but accuracy of their output isn't
good enough. For a 100 MHz clock the tools predict a peak-to-peak jitter of 130
ps, while the clock generator chip has about 4 ps peak-to-peak jitter. ADC and
DAC require very clean clocks with minimal jitter, and any timing error on the
sampling clock <a href="https://www.analog.com/en/resources/analog-dialogue/articles/the-easy-steps-to-calculate-sampling-clock-jitter-for-isolated-precision-high-speed-daqs.html">reduces the signal-to-noise
ratio</a>.</p>
<p>Everything involved in the radar signal generation or processing should run on
synchronized clock signals. For example, if the ADC and DAC would run with
completely unrelated clocks, the pulses wouldn't stay synchronized in phase as
the clocks would slightly drift. Phase drift would make coherent summing of
multiple pulses impossible and seriously harm the performance of the radar.</p>
<p>There are two unrelated clocks on the PCB. PS side of the FPGA has its own 33
MHz crystal and it generates clocks for DDR3, CPU, and peripherals from
it. 133 MHz bus clock is also generated from it, which is passed to the programmable
logic side of the FPGA. The PL side uses an external clock generator chip
<a href="https://www.ti.com/product/CDCM6208">CDCM6208</a> to generate several 250 MHz and
500 MHz clocks from a single 25 MHz crystal. These clocks are all phase
synchronized to each other. The PS side's own independent clock
is that on power up the clock generator has not been programmed yet. The PS side
has its own independent clock, which is needed for programming the clock
generator. The independent clock domains of PS and PL don't cause issues
with proper clock domain crossings.</p>
<p>The ADC outputs a 250 MHz clock with the data to the FPGA, which is
internally divided by two and used to clock the pulse timing logic. This
makes the FPGA logic also synchronized to the clock generator. Frequency
division is required because 250 MHz clock is too fast for the FPGA logic. The
clock division makes that for each 125 MHz clock cycle, two ADC samples are received
from both channels for total of 48 bits of data. There is a FIFO for clock
domain crossing to the PS side's 133 MHz, and DMA transfers the samples through
a 64-bit AXI bus to the DDR3 memory. 133 MHz is used because it needs to be faster
than the 125 MHz input clock and this clock needs to be generated by PS so it
can't be the PL 125 MHz clock.</p>
<p>The FPGA needs to output a 500 MHz clock with the data to the DAC, and for this
purpose, a 500 MHz signal is routed to the FPGA. The FPGA has internal clock
generators, but they are not used for this purpose because their jitter is too
high. 500 MHz is too high frequency to route on the global clock network of the
FPGA, but it's possible to route it on the I/O clock network that is only routed
to the I/O buffers. That means no logic can be clocked at 500 MHz, but the chip
has <a href="https://en.wikipedia.org/wiki/SerDes">serdes</a> that can be clocked from the
I/O clock at each pin, which can take four bits at the rising edge of the
250 MHz clock and output them at both rising and falling edges of the 500 MHz
I/O clock.</p>
<h2 id="manufacturing">Manufacturing</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xhalf_populated_pcb.jpg.pagespeed.ic.kjqQjto-SF.jpg" width="60%/"></p><p>Half populated PCB received from the PCB
    manufactuer.</p>
</div>

<p>I ordered the PCB from a Chinese manufacturer, including assembly. They sent me
two assembled pieces and three empty PCBs. Some uncommon components were
not available for assembly, and I had to order those separately and solder them
myself. These included all the most expensive components such as ADC, DAC and
PLL. Luckily, the FPGA was available for assembly, which saved me the trouble of
soldering the large 484-pin BGA package myself.</p>
<p>Quality of the PCB looks good, especially considering the price, which is only
a fraction of what it would have costed me locally. However, only one of the two
assembled PCBs worked out of the box because of soldering issue with one of
them.</p>
<p>The suspiciously cheap $15 FPGA had equally suspiciously date and lot codes
covered (white rectangles on the FPGA chip in the picture above). I have
a development board of the same series chip with markings intact, so it definitely
shouldn't look like this. It did end up working, but I wonder what the
origin of these chips is.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xpopulated_pcb.jpg.pagespeed.ic.OEzy9PYotA.jpg" width="60%/"></p><p>Fully populated PCB.</p>
</div>

<p>I soldered the rest of the components myself using solder paste and hot air
tool. It would be difficult to solder the QFN packages without hot air tool on
already populated board.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xpcb_backside.jpg.pagespeed.ic.0WuPYIpzZa.jpg" width="60%/"></p><p>Backside of the PCB.</p>
</div>

<p>Two-sided assembly would have costed extra, so all the components are placed
only on the top side. There are some places for additional decoupling capacitors
on the bottom side just in case, but those were not needed.</p>
<h2 id="jtag-programmer">JTAG programmer</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xhardware_manager.png.pagespeed.ic.XuPOnYZ6qV.png" width="40%/"></p><p>Vivado hardware manager. ARM processor, Zynq 7020
    FPGA connected to FTDI chip connected to localhost.</p>
</div>

<p>The first step to bring up the board is to program the FT2232H chip, 
which functions as JTAG programmer and serial port. Xilinx has
<a href="https://docs.xilinx.com/r/en-US/ug908-vivado-programming-debugging/JTAG-Cables-and-Devices-Supported-by-hw_server">program_ftdi</a>
tool that can program its EEPROM so that Xilinx tools recognize it. I first had
problems with the tool not recognizing the device. It failed to find the ftdi
device, even though I could see it in the Linux system log. After installing some
ftdi libraries and making sure that the official ftdi tools were able to read
the EEPROM, I was able to successfully program the EEPROM with the program_ftdi tool.</p>
<p>Checking the Xilinx Vivado hardware manager, it's now able to find the Zynq 7020
FPGA. Programming and debugging the FPGA now works with the Xilinx tools.</p>
<h2 id="fpga-programming">FPGA programming</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/fpga_block.svg" width="70%/"></p><p>FPGA programmable logic block diagram.</p>
</div>

<p>FPGA software consists of ADC and DAC LVDS interfaces, pulse timing that
enables and disables switches, PA, LNAs and other components at the right time,
AXI registers that enable the PS to configure the programmable logic, two DMA
channels for ADC and DAC samples, and SPI interfaces for ADC, DAC, PLL, and clock
generator.</p>
<p>Most of the signal processing is done on the PC, and the FPGA mainly passes the
data around. However, it would be a good idea to have digital filtering and
decimation for the received samples on the FPGA. When the transmitted pulse
bandwidth isn't very large, for example when it isn't centered at zero
frequency, it's possible to do mixing digitally, filter the samples, and reduce
the sample rate. This would enable reducing the amount of data that needs to be
sent to PC and increase the frame rate of the radar.</p>


<p>LVDS receiver is based on Xilinx appnote
<a href="https://docs.xilinx.com/v/u/en-US/xapp1017-lvds-ddr-deserial">xapp1017</a>. It
connects two delay lines and flip-flops to each LVDS lane with delay difference
set so that they sample the signal with 1/2 bit delay. State machine changes the
delays so that the master flip-flop samples at the center of the data eye. The
dynamically adjusted delay is able to compensate for PCB routing and FPGA
internal delay differences.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xradar_timer.png.pagespeed.ic.C5e_Spo20o.png" width="60%/"></p><p>Part of the radar pulse timing circuit VHDL code.</p>
</div>

<p>The pulse timing circuit is just a counter with equality comparisons for each
possible event that can be programmed with AXI registers. The timing circuit is
triggered from the PS side of the FPGA, starting the counter that triggers
every subsystem on the FPGA and every external chip at the exact correct clock
cycle. It also has a loop functionality that can trigger the pulse multiple times
with precise repetition interval to support sending a burst of pulses.</p>
<p>Accurate timing of the burst is essential for accurate target velocity
measurement. Any timing inaccuracy between ADC and DAC transfers to inaccuracy
in the measured distance. A single 125 MHz clock cycle timing error in ADC or
DAC triggering translates to a 1.2 m error in the measured distance.</p>
<h2 id="receiver-noise">Receiver noise</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xpulsed_sma_match.jpg.pagespeed.ic.vNpaBvL6Lb.jpg" width="60%/"></p><p>Testing the radar without antennas.</p>
</div>

<p>For bench top testing I put matched loads at the antenna connectors, disabled
transmitter and recorded the ADC output. Ideally the recorded signal would be
noise and any signals visible are unwanted interference.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xadcfft_5p8ghz.png.pagespeed.ic.Zy_Jg08ndz.png" width="60%/"></p><p>ADC output spectrum without signal, 5.80 GHz LO.</p>
</div>

<p>The length of the recording is 33 ms which is 8 million samples. The noise floor
average is -139 dBFs which is about what it should be. However, there are several
interference signals visible, the biggest are multiples of 25 MHz. Their
amplitude is about -100 dBFs which corresponds to about 15 µV RMS at ADC input,
so they aren't very large. DC offset of the ADC is also visible as very large
peak at zero frequency.</p>
<p>The source of the interferences is fractional spurs caused by the PLL. They can
be changed by changing the PLL output frequency, PLL settings and LO input
reference frequency.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xadcfft_5p75ghz.png.pagespeed.ic.3ijU_03clr.png" width="60%/"></p><p>ADC output spectrum without signal, 5.75 GHz LO.</p>
</div>

<p>The spurs are minimized when PLL output frequency is integer multiple of the PLL
reference clock. PLL reference clock is 250 MHz, but this is too high speed to
run the PLL phase detector, and it is divided by two by the PLL reference input
divider. With 125 MHz PLL reference clock setting the output frequency to 5.75
GHz makes it integer multiple and almost completely gets rid of the spurs. 5.875
is another close multiple that works well also with RF electronic side. There is
still a spur at -125 MHz, but this is expected as it is the phase detector
frequency.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xadc_lowfrequencies.png.pagespeed.ic.oD1ts6kea2.png" width="60%/"></p><p>ADC output spectrum low frequencies.</p>
</div>

<p>Noise floor of the ADC is higher at low frequencies due to 1/f noise of the ADC.
Switching frequency of the DC/DC converters is 2.5 MHz and it's not visible at
the output spectrum plot, which means that the supply filtering works as
designed.</p>
<h2 id="transmit-power">Transmit power</h2>
<p>The power amplifier I'm using has an integrated power detector. I set the DAC output
voltage to 85% of maximum amplitude, which is about the maximum amplitude it can
go while leaving some room for DC offset for LO leakage cancellation digital
predistortion. This should result in around +3 dBm output power from the IQ
modulator, and with 32 dB power amplifier gain it should be enough to drive the
PA into compression.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xpdet_voltage.png.pagespeed.ic.4ct9lOLseC.png" width="60%/"></p><p>PA power detector voltage measured on
    oscilloscope.</p>
</div>

<p>The power detector pin waveform looks correct when measured on oscilloscope. It
has a series of 2 µs long pulses, which was the pulse width. Peak voltage is
1.72 V and about 0.32 V when not transmitting.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xpdet_datasheet_extrapolated.png.pagespeed.ic.dyowdfo04H.png" width="60%/"></p><p>Power detector pin voltage vs output power from
    the datasheet.</p>
</div>

<p>Datasheet has a plot of expected power detector pin voltage vs output power at
different frequencies, but the plot doesn't go as high as I measured.
Questionable linear extrapolation gives around 33 dBm output power which is two
Watts. -1 dB compression point of the PA is specified to be 34 dBm typical, and
it looks like it's in compression as expected.</p>
<h2 id="calibration">Calibration</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/tx_waveform.svg" width="70%/"></p><p>Transmitted waveform.</p>
</div>

<p>With matched loads at the antenna connectors I recorded the leakage transmitter
signal through the T/R switch. The transmitted waveform is a 100 MHz bandwidth
1 µs long linear frequency sweep with 0.1 of the maximum DAC amplitude.</p>
<p>The baseband frequency sweep signal can be written:</p>
<p>$$ f(t) = \exp\left(j2\pi\left(\frac{B}{2t_s}t\right)t\right) $$</p>
<p>,where <span>\(B\)</span> is bandwidth, <span>\(t_s\)</span> is the sweep length, <span>\(t\)</span> is time, and <span>\(j = \sqrt{-1}\)</span>.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xno_lo_cal_time.png.pagespeed.ic.GmxpFMJQxY.png" width="70%/"></p><p>Received frequency sweep without any correction. 128 overlapping waveforms.</p>
</div>

<p>The receiver was set to record 1 µs before and 2 µs after the transmitted
signal. 128 waveforms were transmitted with very good repeatability with all of
them plotted on top of each other on the graph. Ideally the received signal
would be attenuated, delayed and phase shifted copy of the transmitted signal,
but there is a clear difference between transmitted and received waveforms.</p>
<p>The non-idealities identifiable from the time-domain data are:</p>
<ul>
<li>Non-zero DC level before the pulse. This is caused by the DC offset of the
  ADC.</li>
<li>Spike before 1 µs caused by the transmitter being switched on.</li>
<li>Pulse has DC offset caused by the LO leakage from the transmitter, I signal
  has higher DC level than Q signal.</li>
<li>Higher baseband frequencies are attenuated more causing a slight drop at the edges of the
  pulse envelope.</li>
<li>Non-zero DC level after the pulse. Caused both by the ADC DC offset and ADC
  filter high-pass behaviour.</li>
</ul>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xno_lo_cal_compress.png.pagespeed.ic.hmu1KjJmUr.png" width="70%/"></p><p>Compressed leakage signal.</p>
</div>

<p>Above is the plot of the pulse compression output of the non-calibrated pulse
with -50 dB <a href="https://www.mathworks.com/help/signal/ref/taylorwin.html">Taylor
window</a> applied to the
reference pulse normalized to the peak level. The sidelobe level is -21 dBc,
which is far above the ideal level.</p>
<p>The biggest error is caused by the LO leakage from the transmitter. LO leakage
from the transmitter is mixed down to DC at the receiver because they share the
same LO signal. Since DC level of the balanced linear frequency
sweep is non-zero, convolution with the reference sweep gives non-zero result
wherever there is a non-zero LO leakage that causes the flat correlation output
from 0.5 µs to 1.5 µs.</p>
<p>To improve the sidelobe level LO leakage needs to be compensated. It can be done
by adjusting the transmitter waveform so that it has LO signal in opposite phase
that cancels the leakage signal. However, before LO leakage compensation ADC DC
offset should be compensated since received is used to measure the LO leakage
and DC offset of the ADC interferes with it.</p>
<p>DC offset of the ADC is compensated by only triggering the receiver with
transmitter disabled. The only signal at the ADC is thermal noise and DC offset.
DC level can be measured and subtracted from all subsequent measurements.</p>
<p>With ADC DC offset compensated the LO leakage can be measured by triggering the
sweep and outputting only zeros from DAC. Ideally there shouldn't be anything
transmitted, but due to LO leakage there is signal transmitted at LO frequency
which mixes down to DC at the receiver. DC level of the transmitted signal is
adjusted such that the ADC input is zero which results in zero LO leakage.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xcompressed_lo_cal.png.pagespeed.ic.1dvJCsXyW3.png" width="70%/"></p><p>Compressed leakage signal after LO leakage
    compensation.</p>
</div>

<p>With LO leakage compensation the impulse response looks much nicer. Sidelobe
level is -36 dB which is few dB above the ideal -42 dB. There is also a very
long -60 dB straight line after the sweep that is caused by the high pass
behaviour of the AC coupling capacitors between IQ demodulator and ADC.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xtime_lo_cal.png.pagespeed.ic.GTCk2lpRoB.png" width="70%/"></p><p>Time domain leakage signal with LO compensations. DC level after the pulse is very slightly above zero on I channel.</p>
</div>

<p>The reason for the long flat part is that there is a non-zero DC level after the
sweep. Baseband frequency sweep has non-zero DC component and when it passes
through the high-pass filter it changes the output DC level. Convolution result
of frequency sweep with a constant results in non-zero output.</p>
<p>The issue could be reduced by decreasing the high-pass filter cutoff frequency.
The AC coupling capacitor is only 100 nF which puts the high-pass cutoff
frequency at about 10 kHz. DC offset caused by the high-pass could be also
<a href="https://ieeexplore.ieee.org/document/6755581">compensated digitally</a>.</p>
<p>The decrease in amplitude as frequency increases is quite clear here. <a href="https://www.analog.com/en/resources/technical-articles/equalizing-techniques-flatten-dac-frequency-response.html">DAC sinc
response</a>
is compensated digitally, so that isn't the cause for the amplitude drop. The ADC
filter was supposed to be quite flat in amplitude, but during manufacturing
I had to substitute a different inductor than what I initially chose to use. The
substitute inductor has higher series resistance and amplitude isn't as flat.
I do have the correct inductors, but I haven't replaced them yet.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xsweep_offset_time.png.pagespeed.ic.95Md8_RH1i.png" width="70%/"></p><p>50 MHz frequency sweep with 25 MHz offset.</p>
</div>

<p>Other solution for the DC offset issue is modulating the frequency sweep so that
sweep doesn't include zero frequency, essentially using non-zero IF. Above is
time domain plot of received 50 MHz sweep with 25 MHz offset. Frequency sweeps
from 0 Hz to 50 MHz compared to -50 MHz to +50 MHz before.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xsweep_offset_compressed.png.pagespeed.ic.SMjGK90RHs.png" width="70%/"></p><p>Compressed sweep with offset.</p>
</div>

<p>Calculating the pulse compression of the offset sweep gives much cleaner result.
The DC offset issue caused by the high-pass filter is completely removed.
Sidelobe level is still 2 dB higher than ideal but this is already quite nice
looking impulse response. Ideal sidelobes are higher than with 100 MHz sweep
because time-bandwidth product is lower and mainlobe is also widened because of
the lower bandwidth. The disadvantage of the modulated sweep is that maximum usable
bandwidth of the sweep is half of what can be used with a zero centered sweep.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xtx_tukey_0p1.png.pagespeed.ic.fNhPzzPCfv.png" width="70%/"></p><p>Transmitted signal with Tukey window with α=0.1.</p>
</div>

<p>Sidelobes caused by low time-bandwidth product of the pulse can be reduced with
transmitted pulse windowing. Window function reduces the effective bandwidth of
the transmitted waveform, so it increases the mainlobe width and reduces the
range resolution. Transmitter side windowing also decreases the average energy
per pulse as the waveform is tapered off at the start and end of the pulse which
decreases signal-to-noise ratio. One good windowing function for transmitter
side is <a href="https://en.wikipedia.org/wiki/Window_function#Tukey_window">Tukey
window</a>. It just
slightly tapers beginning and end of the waveform with middle being at the
maximum amplitude. Tukey window has a parameter α that can be used to control
how much it windows, with α=0 being equal to no windowing. With α=0.1 the pulse
energy, and the receiver SNR, is decreased by 0.8 dB.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xrx_tukey_0p1.png.pagespeed.ic.HpMUH5tR7n.png" width="70%/"></p><p>Pulse compressed 50 MHz bandwidth pulse with 25 MHz offset frequency, 
    α=0.1 TX Tukey window, and -50 dB RX Taylor window.</p>
</div>

<p>Compared to the same pulse without TX window adding Tukey window to the
transmitter greatly decreases the far-away sidelobes. At 500 ns offset the
sidelobe level has decreased by about 20 dB. The measured sidelobe level is
slightly higher than what it should be ideally.</p>
<p>Receiver and transmitter IQ imbalance isn't yet calibrated and there is some
frequency dependent distortion from the ADC and DAC filters. However, the
current level is good enough for now.</p>
<h2 id="tx-noise-leakage">TX noise leakage</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/tx_leakage.svg" width="60%/"></p><p>If PA is not disabled during the reception noise
    from PA output leaks into receiver increasing the receiver noise floor.</p>
</div>

<p>When switching to reception T/R switch is switched from transmitter to receiver.
If PA is kept enabled due to its high gain it has high enough output noise that
even when with attenuation from the switch isolation it's still larger than
the thermal noise floor of the LNA.</p>
<p>T/R switch can be switched in about 50 nanoseconds but enabling and disabling
PA is much slower, it takes about 10 µs. Unfortunately this long PA
switching time means that when using a single antenna the receiver noise is
higher due to leaked PA noise.</p>
<p>If the input to PA is thermal noise of 50 ohm resistor (-174 dBm/Hz) it's
amplified by PAs gain of 32 dB and it adds its own noise to it too. Usually 
amplifiers noise figure would be reported in the datasheet but this PA doesn't
have it listed. PA noise figure can be rather high, 5 - 10 dB wouldn't be too
unusual, as they usually aren't optimized to be particularly low noise. With
these figures the noise floor at the PA output is about -135 dBm/Hz. T/R switch
has limited isolation, exact value for leakage between these ports isn't
reported in the datasheet, but 26 dB is the reported typical isolation to the
antenna port and isolation between the input ports is usually little better.
This means that PA noise at the LNA input is about -165 dBm/Hz which is larger
than the thermal noise floor of -174 dBm/Hz and the PA noise limits the receiver
performance if it's not switched off.</p>
<p>Noise figure of the receiver is about 5 dB, so the measured noise floor with
receiver connected to T/R switch should be about 5 dB higher, instead of
calculated 10 dB with noiseless receiver. Actually measuring the ADC noise floor
with PA on, when the receiver is connected to T/R switch the noise floor is 2.1 dB
higher than when it's connected to the other port. It matches well with the
theory considering the big uncertainties in all of the values.</p>
<p>When using two antennas the second receiver switch can be switched to RX2 and
the LNA on the RX1 can be switched off which improves the isolation sufficiently
that PA leakage doesn't affect the receiver noise.</p>
<h2 id="target-detection">Target detection</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xdetection.png.pagespeed.ic.rYmsfDjMg2.png" width="90%/"></p><p>Detecting target from range-Doppler map with CFAR. Range-Doppler map (left), CFAR output (middle), sidelobes filtered out (right). Range on x-axis and Doppler velocity on y-axis.</p>
</div>

<p>To get from ADC samples to target detections some more software is required. In
general the transmitted signal is a burst of pulses and the first step is to
pulse compress each received pulse. After pulse compression the next step is to
take FFT over the number of pulses dimension. This sums the power from the
different pulses according to velocity of the target. This is called
range-Doppler processing and its output is a 2D image with range on one axis and
Doppler velocity on the other. Amplitude of each pixel corresponds to
the amount of power received at that distance and velocity.</p>
<p>After range-Doppler processing the output is a 2D array of the received power
for each range-Doppler bin. To get to target detections we need to identify the
bins where there is a target. We also want to separate interesting
targets such as moving vehicles from non-interesting targets (clutter) such as
sidelobes, trees, ground, and other stationary targets.</p>
<p>The targets in the range-Doppler map could be identified by the amplitude. If
a bin's amplitude is high enough above the noise floor then it likely
corresponds to a real target and is not just noise. The detection threshold, 
how much a target needs to be above the noise floor, needs to be chosen to
balance false alarm rate and missed detections. In general the noise floor power
isn't constant in the range-Doppler map. It can vary as function of time, there
can be sidelobes from other nearby targets and clutter, for example ground
reflections, can also be considered noise since we don't want to detect each
patch of ground as a target. Instead of setting a fixed noise floor it's
estimated by averaging nearby bins. For each pixel in the radar map, noise floor
is calculated by averaging nearby bins and if amplitude of the bin being tested
is larger than threshold times the calculated noise floor then we mark detected
target at that location. This is called CFAR (Constant False Alarm Rate)
algorithm.</p>
<p>For high amplitude targets there are going to be false detections from
sidelobes. After the targets are detected we check if they correspond to
a sidelobe of a larger target and unmark it. This is simply done by checking if
there is a much larger target in same row or column. Target is also required to
have larger amplitude than adjacent bins, this causes only the peak location of
each compressed pulse to be detected.</p>
<p>We now have a list of ranges and velocities for detected targets at the accuracy
of the radar resolution. Range and velocity measurement accuracy can be improved
by interpolating the peak location.</p>
<h2 id="target-tracking">Target tracking</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/kalman.svg" width="50%/"></p><p>Kalman filter for radar target tracking. Kalman
    filter predicts the next position of the target from the previous
    measurements including the uncertainty.</p>
</div>

<p>After the detection pipeline we have a list of detections, some of which can be
false detections. To be able to track objects in time, detections need to be
associated with targets. Kalman filter is used to track each target's position
and velocity including uncertainty, and it provides a way to assign each
detection to specific target by considering probabilities that detection is from
that target.</p>
<p>Tracking uses <a href="https://stonesoup.readthedocs.io/en/latest/index.html">Stonesoup Python
library</a>, which is
a library for general object tracking. Specifically radar tracking is heavily
based on the <a href="https://stonesoup.readthedocs.io/en/latest/auto_tutorials/10_Simulation_%26_Tracking_Components.html#sphx-glr-auto-tutorials-10-simulation-tracking-components-py">StoneSoup
tutorial</a>.
StoneSoup tutorial explains the tracking well, so I won't repeat it too much
here.</p>
<p>The biggest change from the example is that example is for tracking object in 2D
with measurement providing it's 2D position but not velocity. Radar measures
distance and velocity of each target, but there is no angle information so only
1D tracking is possible.</p>
<p>Transition model for the target is set as <a href="https://stonesoup.readthedocs.io/en/latest/stonesoup.models.transition.html#stonesoup.models.transition.linear.ConstantAcceleration">constant
acceleration</a>.
Kalman filter estimates acceleration from the measurements and the next
prediction for the target position is made assuming that acceleration is
constant.</p>
<h2 id="radar-measurements">Radar measurements</h2>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xhorn_rust.jpg.pagespeed.ic.PA4n8JabkQ.jpg" width="50%/"></p><p>Horn antennas. The rust can't be good for efficiency.</p>
</div>

<p>I tested the radar by setting the radar on a side of a road and measuring
traffic passing by. Pulse length is 2 µs, the bandwidth is 150 MHz, the number of pulses
is 1024, RX length is 5 µs with 7 µs delay before the next pulse. I used two
antennas with separate TX and RX antenna. Antennas are <a href="https://hforsten.com/horn-antenna-for-radar.html">horn antennas that
I made myself</a>.</p>
<p>150 MHz bandwidth corresponds to 1 meter distance resolution. It's important to
note that resolution is not the same as accuracy. Resolution is how close two
point targets can be to be separated in the measurement. One target can be measured
with better accuracy than resolution with accuracy depending on signal-to-noise
ratio.</p>
<p>12 µs time between pulses equals 83 kHz pulse repetition frequency. The pulse
interval determines the maximum unambiguous target velocity. Velocity
measurement is based on measuring phase change between pulses, and if target
moves at high enough speed that it moves several wavelengths between pulses,
there is no way for radar to know what that multiple is, causing the measured
velocity to be ambiguous.</p>
<p>If the target moves half a wavelength between pulses, it causes a full wavelength distance change since the radar pulse goes from the radar to the target and back. At this speed, the phase
increases by a full wavelength at each measurement, which looks identical to if the
target was stationary. If we don't have information on which direction the
target is moving, we also need to consider that a signal increasing 90 degrees in
phase every measurement looks identical to a signal that decreases by 270 degrees
every measurement. The unambiguous velocity measurement range must be divided by
two for negative and positive velocities, resulting in velocity measurement range:</p>
<p>$$v_\text{max} = \frac{\lambda}{4 t_d}$$</p>
<p>,where <span>\(\lambda\)</span> is RF wavelength and <span>\(t_d\)</span> is pulse repetition interval.</p>
<p>With 5.8 GHz RF frequency and 12 µs pulse repetition interval, the unambiguous
velocity measurement range is from -1077 m/s to +1077 m/s. This is over three
times the speed of sound, and there won't be any issues with velocity ambiguities
when measuring cars.</p>
<p>The Doppler velocity resolution is the unambiguous velocity measurement range divided
by the number of pulses, which is 2155 m/s / 1024 = 2.1 m/s in this case. This is the
minimum velocity difference that two targets at the same range need to have to be
detected as two separate targets. As with the distance accuracy, the velocity
measurement accuracy for a single target is better than velocity resolution and
improves with signal-to-noise ratio.</p>
<p id="centered">
<video width="80%" controls="" loop="" muted="">
<source src="https://hforsten.com/video/pulsed/pulsed_tie2_6.webm" type="video/webm">
Your browser does not support the video tag.
</video>
</p>

<p>Above is cellphone video synced with a radar range-Doppler map. CFAR
detections are plotted as red plus symbols on the range-Doppler map and 
listed in the order of decreasing SNR on the top right. On the radar image,
Y-axis is the Doppler velocity in m/s with negative values towards the radar,
X-axis is the distance in meters. The large line at the zero Doppler velocity is
reflections from stationary targets.</p>
<p>On the list in the upper right, "frame" is the number of the sweep burst in the
radar measurement file, "t" is the time from the first frame, and "detections" is
the number of CFAR detections. Detections with a velocity less than 0.1 m/s are
filtered out to avoid marking every stationary object as a detection.</p>
<p>Comparing the camera footage to the radar measurements it's easy to correlate
the radar detections to cars in the camera footage for close targets. There is
some shadowing as cars on the foreground block the view of farther away objects,
but the radar is able to detect objects not well visible in the camera footage
quite well. The radar can detect cars up to about 400 m, limited by the
line of sight. Beyond that the road turns and the view is blocked.</p>
<p>The effect of the DC offset is also visible as very large sidelobes in the range
direction. These sidelobes decrease the ability to detect smaller objects near
larger ones. Especially towards the end the farthest away car is not always
detected by the CFAR as its amplitude isn't sufficiently larger than the
sidelobes overlapping it.</p>
<p id="centered">
<video width="80%" controls="" loop="" muted="">
<source src="https://hforsten.com/video/pulsed/pulsed_tie2_6_tracker.webm" type="video/webm">
Your browser does not support the video tag.
</video>
</p>

<p>Above is the same measurement, but now with Kalman tracker. The tracker assigns
CFAR detections to targets with unique IDs. It's able to track multiple
targets, but shadowing and sidelobes cause it to not get enough detections
from further away blocked targets, and it loses track of them. The uncertainty
in their position increases so much that the track deletion threshold is
reached. When they become visible again, a new ID is assigned for them. The tracking
software could be improved to reduce this problem, but this is just a testing of
the radar and I don't want to spend too much time tuning it for this application.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xtie2_6_signal.png.pagespeed.ic.uYF2kDH1pH.png" width="60%/"></p><p>Received signal. 1024 overlapping pulses.
    Amplitude is normalized to full-scale.</p>
</div>

<p>Above is the received signal of all 1024 pulses from one measurement plotted on
the same graph. They overlap very well. There is a small change in the phase
during the measurement for moving objects, which is enough to separate the moving
objects from stationary ones. There is a large return from leakage and nearby
objects at the start, and the received signal from longer time delays that
correspond to farther away targets are much weaker.</p>
<h2 id="low-if-pulse">Low-IF pulse</h2>
<p id="centered">
<video width="80%" controls="" loop="" muted="">
<source src="https://hforsten.com/video/pulsed/pulsed_tie4_1.webm" type="video/webm">
Your browser does not support the video tag.
</video>
</p>

<p>While using a large bandwidth sweep centered at DC works, sidelobes
caused by the high-pass filter are visible in the results. For second test, I set
the RF bandwidth to 75 MHz with 38 MHz modulation frequency so that the
frequency sweeps from 0.5 MHz to 75.5 MHz. Other parameters were kept the same.</p>
<p>This time, as expected, the very wide sidelobes caused by the DC offset aren't
visible. Range resolution is only half of what is was previously, but it doesn't really
cause any issues with tracking of the cars. They are large enough that even with
a 2 meter range resolution, there isn't any issues with separating them.</p>
<p>The frame rate is about only half of what is was before. The amount of data should
be the same, and I'm not really sure why it's so much slower this time?</p>
<p>At the beginning, a second reflection of the passing car is visible at double the
distance and velocity. The radar signal reflects from car, to a sign that is
right next to me, back to car, and then is received by the radar. It's much
weaker in amplitude and its spread out which causes it to not be detected as
a target by CFAR.</p>
<p>In this measurement, there's a cyclist coming towards the radar which is not
detected as a target. The reason for it is that the cyclist's speed isn't large
enough to separate it well enough from the stationary targets. When CFAR target
detection is calculated, all of the nearby stationary targets are included in
the noise floor calculation for low-speed targets. The large noise floor causes
that the small radar cross section of the cyclist isn't sufficiently above the
noise floor to be detected.</p>
<p>For this application, a higher RF frequency would be beneficial. Doubling the RF
frequency would double the Doppler velocity bin separation and decrease the
maximum unambiguous Doppler velocity by two. Common police radar speed guns
operate at around 10 to 35 GHz, although nowadays
<a href="https://en.wikipedia.org/wiki/Lidar">lidar</a>, which operates near visible light,
is starting to be more common for traffic monitoring.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xdetections_snr.png.pagespeed.ic.G2u4VXfwy_.png" width="60%/"></p><p>SNR of detected objects as calculated by CFAR vs distance.</p>
</div>

<p>SNR of the radar detections is quite good at this range. The maximum SNR at 450
m distance is around 35 dB, while just farther away at 550 m there are no
detections. This is because of line of sight, there is no clear path beyond 450
m. Radar SNR should decrease as fourth power of distance, which corresponds to
12 dB drop when the distance is doubled. The radar should be able to detect
traffic at even longer distances if there is a clear line of sight.</p>
<p>From this measurement, it isn't clear if the radar link budget is as good as
designed, since the radar cross-section of the targets isn't known. Even
a typical car cross section can vary a lot depending on the model and the look
angle. The radar link budget could be verified by measuring a target with a known
radar cross section, typically a corner reflector. However, I don't have
a corner reflector. It wouldn't be too difficult to make one with few triangular
pieces of PCB, and it just would require some effort.</p>
<div id="centered">
    <p><img src="https://hforsten.com/img/pulsed/xfull_rd.png.pagespeed.ic.jOewLOVpzR.png" width="60%/"></p><p>Full range-doppler map.</p>
</div>

<p>The unzoomed range-Doppler map shows how small the view on the videos is on the
Doppler axis. The maximum unambiguous velocity is over 1000 m/s. On the range
direction, negative distances correspond to pulses that arrive before the start
of the transmitted pulse. There shouldn't be any signal there except for
sidelobes from targets at positive distances. The noise floor drops at the edges
of the range direction because of zero padding in pulse compression.</p>
<h2 id="single-antenna">Single antenna</h2>
<p>The previous measurements were made with two antennas, one transmitting and the
other receiving. In the next measurement, I have only one antenna that is switched
between transmit and receive modes. The pulse was set to the same parameters as the
low-IF measurement, except for pulse length, which was decreased from 2 µs to
1 µs to improve detection of close objects.</p>
<p>With one antenna, receiver can only be switched on at the earliest just after
the end of the transmission. 1 µs at the speed of light is equal to 300 meters, but
radar signal needs to travel to the target and back, so minimum distance to
receive the full pulse is 150 meters. However, while it isn't possible to
receive the full pulse from shorter distances, it's possible to receive
a partial pulse. Pulse compression with only a partial pulse reduces distance
resolution and SNR, but it should allow detecting targets at much lower
distances.</p>
<p id="centered">
<video width="80%" controls="" loop="" muted="">
<source src="https://hforsten.com/video/pulsed/pulsed_tie4_5_ch0.webm" type="video/webm">
Your browser does not support the video tag.
</video>
</p>

<p>Targets below 150 m distance can be detected but the range resolution worsen
quickly to unusable levels. Minimum range that radar can detect targets with
these settings is about 40 m. In this plot marker is drawn on the tracker
predicted location instead of CFAR detections as before.</p>
<p>The tracker parameters were tuned a little bit for this measurement and the
tracking performance is better than in the earlier measurements.</p>
<h2 id="conclusion">Conclusion</h2>
<div id="centered">
    <p><a href="https://hforsten.com/img/pulsed/pulsed_schematic.pdf" target="_blank">
    <img src="https://hforsten.com/img/pulsed/xpulsed_sch.png.pagespeed.ic.DBXb2WYMdR.png" width="50%"></a></p><p>Schematic of the radar.</p>
</div>

<p><a href="https://hforsten.com/img/pulsed/pulsed_schematic.pdf">Schematic</a> of the radar is 
available. It should be useful for also as a software-defined radio with some
modifications or reference for other applications that require FPGA. Firmware
and software isn't available at the moment, since I'm not sure if I should make
those public.</p>
<p>Cost was 330 USD for PCB manufacturing and assembly of two PCBs and additional
225 EUR (240 USD) for components from Digikey that I soldered myself. This is
including 24% VAT and shipping costs. There aren't any similar commercial pulse
compression radars in the same price range and even software defined radios with
similar RF bandwidth are much more expensive.</p>
<p>The designed radar is fundamentally similar to modern large radars. It utilizes
digital signal processing, supports arbitrary waveforms and has very large
maximum unambiguous target Doppler velocity due to high pulse repetition
frequency. Only the maximum range is shorter than large radars due to low output
power and small antenna.</p>

            </div>
            <!-- /.entry-content -->
        </article>
    </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[US Government funds pilot project for heated sand energy storage (128 pts)]]></title>
            <link>https://www.pv-magazine.com/2024/04/04/us-government-funds-pilot-project-for-heated-sand-energy-storage/</link>
            <guid>39929842</guid>
            <pubDate>Thu, 04 Apr 2024 12:59:26 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.pv-magazine.com/2024/04/04/us-government-funds-pilot-project-for-heated-sand-energy-storage/">https://www.pv-magazine.com/2024/04/04/us-government-funds-pilot-project-for-heated-sand-energy-storage/</a>, See on <a href="https://news.ycombinator.com/item?id=39929842">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="content" role="main"><div><p>The US Department of Energy is funding a pilot project to demonstrate the commercial viability of storing energy in heated sand, which is capable of producing 135 MW of power for five days.</p> <p><time datetime="2024-04-04T08:45:33+02:00" itemprop="datePublished" title="Thursday, April 4, 2024, 8:45 am">April 4, 2024</time> </p></div><!-- .entry-byline --><p><img width="1200" height="749" src="https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-1200x749.png" alt="" decoding="async" fetchpriority="high" srcset="https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-1200x749.png 1200w, https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-600x374.png 600w, https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-768x479.png 768w, https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-1536x958.png 1536w, https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15.png 1850w" sizes="(max-width: 1200px) 100vw, 1200px" data-attachment-id="250795" data-permalink="https://www.pv-magazine.com/2024/04/04/us-government-funds-pilot-project-for-heated-sand-energy-storage/screenshot-2024-04-04-at-08-21-15/" data-orig-file="https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15.png" data-orig-size="1850,1154" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screenshot 2024-04-04 at 08.21.15" data-image-description="" data-image-caption="" data-medium-file="https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-600x374.png" data-large-file="https://www.pv-magazine.com/wp-content/uploads/2024/04/Screenshot-2024-04-04-at-08.21.15-1200x749.png"></p><p><i> Image: Joe DelNero, National Renewable Energy Laboratory </i></p><div><p><strong>From <a href="https://pv-magazine-usa.com/2024/04/02/doe-funds-heated-sand-energy-storage-project-pilot/" target="_blank" rel="noopener">pv magazine USA</a></strong></p><p>The NREL team’s computer modeling has shown that a commercial-scale system would retain more than 95% of its heat for at least five days, the national laboratory said in a press release.</p><p>The US Department of Energy will provide $4 million to fund a pilot demonstration project sized with a 100 kW discharge capacity and a 10-hour duration, with groundbreaking set for next year at NREL’s Flatiron campus outside Boulder, Colorado. The pilot project is intended to show the technology’s commercial potential.</p><p>At commercial scale, when the sand is fully heated and stored in five silos, the technology could produce 135 MW of power for five days,<b><i>&nbsp;</i></b>according to an&nbsp;<a href="https://www.nrel.gov/docs/fy23osti/84728.pdf" target="_blank" rel="noopener noreferrer" data-auth="NotApplicable" data-linkindex="1">NREL report</a>.</p><div id="mid-article-bibblio" data-action="Internal" data-title="Popular content" data-catalogue="Articles" data-location="Mid Single Article"><h3>Popular content</h3></div><p>A targeted levelized cost of storage of 5¢/kWh could be achieved under a variety of scenarios, the report said.</p><p>NREL said a technology-to-market transition plan has been developed for the TES system, but was not included in the publicly available report “due to the business sensitivity of NREL and partners.”</p><p>Babcock &amp; Wilcox, one of five project team members supporting NREL’s research, <a href="https://www.babcock.com/home/about/corporate/news/babcock-wilcox-nrel-sign-exclusive-ip-option-agreement-for-advanced-renewable-energy-storage" target="_blank" rel="noopener noreferrer" data-auth="NotApplicable" data-linkindex="2">said</a> in 2021 that it had signed an agreement with NREL, which gave it “field-limited exclusive rights” to negotiate a licensing agreement that would allow it to market the technology.</p><p>Several other energy storage technologies have storage durations longer than the typical four-hour limit for battery storage. For example, Hydrostor is <a href="https://pv-magazine-usa.com/2023/01/13/500-mw-compressed-air-energy-storage-project-in-california-secures-offtaker/" target="_blank" rel="noopener noreferrer" data-auth="NotApplicable" data-linkindex="3">developing</a>&nbsp;a 500 MW/4,000 MWh compressed air energy&nbsp;storage project in California. A pumped storage project&nbsp;<a href="https://pv-magazine-usa.com/2019/07/10/massive-montana-pumped-hydro-project-gets-danish-investment/" target="_blank" rel="noopener noreferrer" data-auth="NotApplicable" data-linkindex="4">under development</a>&nbsp;in Montana would have a capacity of 400 MW and an estimated annual energy generation of 1,300 GWh. And flow batteries have a global market&nbsp;<a href="https://www.pv-magazine-india.com/2023/09/05/global-flow-battery-market-to-grow-at-22-8-annually/" target="_blank" rel="noopener noreferrer" data-auth="NotApplicable" data-linkindex="5">estimated</a>&nbsp;by a research firm at $289 million in 2023.</p><p>For seasonal energy storage, hydrogen storage in salt caverns is an option. A&nbsp;<a href="https://www.pv-magazine.com/2022/08/04/worlds-largest-underground-hydrogen-storage-project/" target="_blank" rel="noopener noreferrer" data-auth="NotApplicable" data-linkindex="6">project in Utah</a> is expected to have a storage capacity of 150 GWh matched with an 840 MW hydrogen-capable gas turbine combined cycle power plant.</p><p>This content is protected by copyright and may not be reused. If you want to cooperate with us and would like to reuse some of our content, please contact: <a href="https://www.pv-magazine.com/cdn-cgi/l/email-protection#af898cd7999a94898cd7999b94898cd7999694898cd7989b94898cd799c994898cd7989d94898cd7989c94898cd79b9f94898cd7989f94898cd7989994898cd79dcb94898cd799cb94898cd7999e94898cd7999894898cd7999e94898cd798ce94898cd7999694898cd799ca94898cd7999a94898cd79dca94898cd7999c94898cd799c994898cd799cb94">editors@pv-magazine.com</a>.</p></div><!-- .entry-content --></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Washington's Lottery forced to pull site after creating AI porn of lotto user (188 pts)]]></title>
            <link>https://mynorthwest.com/3956403/rantz-washingtons-lottery-ai-porn-user/</link>
            <guid>39929416</guid>
            <pubDate>Thu, 04 Apr 2024 12:15:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://mynorthwest.com/3956403/rantz-washingtons-lottery-ai-porn-user/">https://mynorthwest.com/3956403/rantz-washingtons-lottery-ai-porn-user/</a>, See on <a href="https://news.ycombinator.com/item?id=39929416">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

                        <p>A new Washington’s Lottery AI mobile site turned a user’s photo into softcore pornography, forcing them to take the website down “out of an abundance of caution.”</p>
<p>When Megan, a 50-year-old mother based in Tumwater, visited the new AI-powered mobile site from <a href="https://www.walottery.com/" target="_blank" rel="noopener">Washington’s Lottery</a> on March 30, she thought she was in for some frivolous fun. <a href="https://testdriveawin.com/" target="_blank" rel="noopener">Test Drive A Win</a> allows users to digitally throw a dart at a dartboard featuring dream vacations you can pay for with the money you win in the lottery. Depending on where the dart lands, you can either upload a headshot or take one on your phone to upload, and the AI superimposes your image into the vacation spot.</p>
<p>Megan landed on a “swim with the sharks” dream vacation option. She was shocked at one of the AI photos Washington’s Lottery spit out. It was softcore porn.</p>
<p><strong>KTTH podcasts:</strong> <a href="https://mynorthwest.com/category/podcast_results/?i=1676&amp;n=The+Jason+Rantz+Show&amp;site=ktth">Subscribe to the Jason Rantz Show</a></p>
<h2>How did the the Washington’s Lottery site push out porn?</h2>
<p>Megan says she used the in-site option to take a photo of her face to upload. The photo that was created shows a smiling AI version of Megan, but almost completely nude.</p>
<p>In the image, Megan is sitting on a bed, with a bathing suit bottom on, but no top. Her bare breasts are exposed. The background of the image appears to show the bedroom in an aquarium, with fish swimming around her. There is a Washington’s Lottery logo in the bottom right corner.</p>
<p>“Our tax dollars are paying for that! I was completely shocked. It’s disturbing to say the least,” Megan explained to the Jason Rantz Show on KTTH.</p>
<p>Megan feared that the image could potentially get out and that it would happen to another website visitor. She told a friend, who happens to know someone at Washington’s Lottery, what happened.</p>
<p>“I also think whoever was responsible for it should be fired,” she added.</p>
<p><strong>Watch: </strong><a href="https://mynorthwest.com/youtube_videos/video-double-shot-how-does-the-internet-work/" target="_blank" rel="noopener">The Double Shot with Jason Rantz and Jake Skorheim — How does the internet work?</a></p>
<h3>Washington’s Lottery pulled the site offline</h3>
<p>It’s unclear how or why AI created this particular image, given the rules governing the content. The Jason Rantz Show on KTTH could not, of course, authenticate the image. However, a spokesperson for Washington’s Lottery confirmed they received a report that the image was created by the AI system.</p>
<p>Approximately three hours after an inquiry by the Jason Rantz Show on KTTH, Washington’s Lottery pulled the site offline. They also provided a statement.</p>
<p>“We were made aware that a single user of the AI platform was purportedly provided an image that did not adhere to the built-in parameters set by the developers. Prior to launch, we agreed to a comprehensive set of rules to govern image creation, including that people in images be fully clothed. We have not seen the image that the AI provided to this user, but out of an abundance of caution we took the website down,” the spokesperson confirmed to the Jason Rantz Show on KTTH.</p>
<p>The spokesperson did not confirm when they first heard of the issue. He also did not explain why Washington’s Lottery waited until after my inquiry before turning the site offline.</p>
<p>Megan is pleased the site has been removed. She says she hopes any back-end settings that need to be adjusted are, in fact, adjusted.</p>
<h3>UPDATE: 4/2/24, 7:38 p.m.</h3>
<p>A spokesman for Washington’s Lottery sent the following statement to the Jason Rantz Show on KTTH Tuesday night:</p>
<blockquote><p>We heard about this earlier this week. As soon as we did, we had the developers check all the parameters for the platform and were comfortable with the settings, but after further internal discussions today, we chose to take down the site out of an abundance of caution, as we don’t want something like this purported event to happen again.</p>
</blockquote>
<p><em>Listen to The Jason Rantz Show on weekday afternoons from 3-6 p.m. on KTTH 770 AM (HD Radio 97.3 FM HD-Channel 3). Subscribe to the&nbsp;<a href="https://mynorthwest.com/category/podcast_results/?i=1676&amp;n=The+Jason+Rantz+Show&amp;site=ktth">podcast here</a>. Follow Jason on&nbsp;<a href="https://twitter.com/jasonrantz" target="_blank" rel="noopener">X, formerly known as Twitter</a>,&nbsp;<a href="https://www.instagram.com/jasonrantz/" target="_blank" rel="noopener">Instagram</a>&nbsp;and&nbsp;<a href="https://www.facebook.com/JasonRantzShow/" target="_blank" rel="noopener">Facebook</a>.</em></p>
<p><a href="https://twitter.com/https://twitter.com/jasonrantz" data-show-count="false">Follow @https://twitter.com/jasonrantz</a></p>                        
                        
                        
    


                        
                        
                        
                    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[US court blocks EPA order to eliminate PFAS in plastic containers (152 pts)]]></title>
            <link>https://www.thenewlede.org/2024/03/us-court-blocks-epa-order-to-eliminate-pfas-in-plastic-containers/</link>
            <guid>39929310</guid>
            <pubDate>Thu, 04 Apr 2024 12:05:22 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.thenewlede.org/2024/03/us-court-blocks-epa-order-to-eliminate-pfas-in-plastic-containers/">https://www.thenewlede.org/2024/03/us-court-blocks-epa-order-to-eliminate-pfas-in-plastic-containers/</a>, See on <a href="https://news.ycombinator.com/item?id=39929310">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

        				<p>A US appeals court has vacated an action by the US Environmental Protection Agency (EPA) &nbsp;ordering a company to stop producing plastic containers that leach toxic per- and polyfluoroalkyl substances (PFAS) into pesticides, household cleaners, condiments, and many other products.</p>
<p>The 5<sup>th</sup> US Circuit Court of Appeals on March 21 <a href="https://peer.org/wp-content/uploads/2024/03/3_22_24-Fifth-Circuit-Opinion.pdf" target="_blank" rel="noopener">ruled</a> that the EPA exceeded its statutory authority when it <a href="https://www.epa.gov/reviewing-new-chemicals-under-toxic-substances-control-act-tsca/epa-orders-issued-inhance" target="_blank" rel="noopener">issued orders</a> to Texas-based Inhance in December prohibiting the company from manufacturing or processing PFAS through its fluorination process for containers.</p>
<p>The EPA move came after the agency determined that types of PFAS created during the fluorination process “are highly toxic and present unreasonable risks that cannot be prevented other than through prohibition of manufacture.”</p>
<p>The agency issued the orders under the Toxic Substances Control Act (TSCA), which authorizes the EPA to regulate and screen chemicals produced or imported into the US.</p>
<p>But Inhance challenged the EPA’s action, arguing that the EPA improperly sought to take action against the company under a section of TSCA dealing with new uses of chemicals, and that Inhance’s process did not constitute a new use.</p>
<p>The court agreed that the fluorination technique Inhance uses to prevent liquids from leaking out of its plastic containers – a process that creates PFAS chemicals – does not count as a significant new use since Inhance has been using this process since 1983.</p>
<p>The EPA’s interpretation of the law “distorts TSCA’s framework and defies common sense,” the court opinion states. The agency could pursue action against Inhance under a different section of TSCA, but would be required to conduct a cost-benefit analysis of the action, the court stated.</p>
<p>When asked for comment, the EPA said it is reviewing the court’s decision.</p>
<p>Inhance in a <a href="https://www.inhancetechnologies.com/news/fifth-circuit-unanimously-rules-in-favor-of-inhance-technologies" target="_blank" rel="noopener">statement</a> called the court’s decision a “decisive victory” and said that it would avert disruption to “downstream industries” and related supply chain impacts.</p>
<p>The company’s continued use of its PFAS-producing fluorination technique for high-density polyethylene (HDPE) containers is “unconscionable” given that there are safe alternatives, said Kyla Bennett, director of science policy for the watchdog group Public Employees for Environmental Responsibility (PEER).</p>
<p>“I suspect there will be liability lawsuits coming,” she said. “When you have this much PFAS – especially PFOA [perfluorooctanoic acid] – leaching into products, someone is going to sue.”</p>
<p>In February, PEER and the Center for Environmental Health (CEH) <a href="https://www.thenewlede.org/2024/02/epa-is-illegally-concealing-data-about-pfas-in-millions-of-plastic-containers-lawsuit-alleges/" target="_blank" rel="noopener">filed a lawsuit against the EPA</a> claiming that the agency violated TSCA by refusing to provide health and safety data about PFAS chemicals in Inhance’s plastic containers, with the EPA citing “confidential business information.”</p>
<p>There are thousands of PFAS chemicals, which do not break down naturally and contaminate waterways across the US and most Americans’ blood. Studies in both laboratory animals and humans suggest that exposure to some PFAS chemicals can <a href="https://www.epa.gov/superfund/proposed-designation-perfluorooctanoic-acid-pfoa-and-perfluorooctanesulfonic-acid-pfos" target="_blank" rel="noopener">harm various organs and systems in the human body</a>, including the heart, liver, kidneys, and immune system, according to the EPA.</p>
<p>Previous research has demonstrated that PFAS can leach from containers, including a 2023&nbsp;<a href="https://beyondpesticides.org/dailynewsblog/2023/03/pfas-leaches-into-ketchup-mayo-other-common-foods-elevating-health-hazards/" target="_blank" rel="noopener">study</a>&nbsp;by Notre Dame University, which found PFAS in ketchup and mayonnaise, and a 2022 <a href="https://www.thenewlede.org/2022/09/epa-confirms-pfas-leach-from-shipping-containers-into-food-other-products/" target="_blank" rel="noopener">study</a> by the EPA that found eight PFAS chemicals leaching from the walls of shipping containers into their liquid contents.</p>
<p>The mosquito control company Clarke Mosquito has switched to using containers with a non-fluorinated barrier protection for its pesticide. The EPA <a href="https://www.thenewlede.org/wp-content/uploads/2024/03/EPA-Clarke-letter.pdf" target="_blank" rel="noopener">reviewed the move</a> in 2021 and determined that the company chose acceptable substitutes.</p>
<p>(Featured image&nbsp;<a href="https://unsplash.com/@kellysikkema?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank" rel="noopener">Kelly Sikkema</a> on <a href="https://unsplash.com/photos/woman-in-black-long-sleeve-shirt-holding-white-and-yellow-plastic-bottle-DJcVOQUZxF0?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" target="_blank" rel="noopener">Unsplash</a>.)</p>
<!--themify_builder_content-->

<!--/themify_builder_content-->

	    
	</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[HNInternal: Ask HN: Happy 404 Day. Whats your favorite 404 error page? (145 pts)]]></title>
            <link>https://news.ycombinator.com/item?id=39928950</link>
            <guid>39928950</guid>
            <pubDate>Thu, 04 Apr 2024 11:27:43 GMT</pubDate>
            <description><![CDATA[<p>See on <a href="https://news.ycombinator.com/item?id=39928950">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
            <tbody><tr id="39932987"><td></td></tr>
            <tr id="39930283"><td></td></tr>
                <tr id="39932794"><td></td></tr>
            <tr id="39930381"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39930381" href="https://news.ycombinator.com/vote?id=39930381&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>What is interesting, until you called it out I did not look past the beginning and I wondered... why is this impressive?<p>It just kinda blends in like many other sites have a site map on the 404.</p><p>That is well done, simple but a good fun if you look at it for more than a couple seconds.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39931423"><td></td></tr>
            <tr id="39931366"><td></td></tr>
            <tr id="39930440"><td></td></tr>
            <tr id="39931539"><td></td></tr>
                  <tr id="39932327"><td></td></tr>
            <tr id="39932955"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39932955" href="https://news.ycombinator.com/vote?id=39932955&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>I'm going to ask a stupid question at my own peril.. please go easy on me<p>Does serving a 404 page still allow the response of 404 as the response code? or is it technically a 200 since it is serving the custom 404 page successfully?
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39931922"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39931922" href="https://news.ycombinator.com/vote?id=39931922&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span><a href="https://www.thesistersofmercy.com/error404page.html" rel="nofollow">https://www.thesistersofmercy.com/error404page.html</a> (written by Andrew Eldritch himself, like the whole site!)<p>Also:</p><pre><code>  Once upon a midnight dreary, while I pron surfed, weak and weary, 
  Over many a strange and spurious site of 'hot xxx galore',
  While I clicked my fav'rite bookmark, suddenly there came a warning,
  And my heart was filled with mourning, mourning for my dear amour.
  "’Tis not possible!", I muttered, "give me back my free hardcore!"
  
  Quoth the server, 404</code></pre></span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39932829"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39932829" href="https://news.ycombinator.com/vote?id=39932829&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>404 pages should have a different favicon so that when opening multiple tabs in the background you will notice something different.
Here's mine with a little easter egg when hovering over the numbers: <a href="https://ss64.com/404" rel="nofollow">https://ss64.com/404</a></span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39931462"><td></td></tr>
            <tr id="39932300"><td></td></tr>
            <tr id="39932925"><td></td></tr>
            <tr id="39932425"><td></td></tr>
            <tr id="39932756"><td></td></tr>
            <tr id="39932476"><td></td></tr>
                <tr id="39932545"><td></td></tr>
                  <tr id="39932713"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39932713" href="https://news.ycombinator.com/vote?id=39932713&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>Bravoboard's 404 Page - <a href="https://www.bravoboard.xyz/404" rel="nofollow">https://www.bravoboard.xyz/404</a><p>Bravoboard's 404 page is truly unique and innovative! It features an interactive message board where visitors can see posts and messages left by others, inviting them to join in and leave a message themselves. This creative approach to a typically mundane page highlights Bravoboard's core capabilities in a fun and engaging way. Bravo to Bravoboard for such a clever idea!
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39930230"><td></td></tr>
                <tr id="39930247"><td></td></tr>
                  <tr id="39931743"><td></td></tr>
                <tr id="39932255"><td></td></tr>
                <tr id="39932366"><td><table>  <tbody><tr>    <td indent="2"><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td>
      <center><a id="up_39932366" href="https://news.ycombinator.com/vote?id=39932366&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>None yet :fingers crossed:.<p>Actually, in some ways getting a cease and desist from Lucasfilms would be a sign we'd arrived :) .
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                        <tr id="39931476"><td></td></tr>
            <tr id="39932612"><td></td></tr>
            <tr id="39930465"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39930465" href="https://news.ycombinator.com/vote?id=39930465&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>My favorite and most creative 404 page I saw is for ROOT CERN software *<p><a href="https://root.cern/404/" rel="nofollow">https://root.cern/404/</a></p><p>It is the error you wish was true in your life.</p><p>* Used as C++ interpreter with devilish syntax to help physicists do data analysis.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39930202"><td></td></tr>
                <tr id="39931859"><td></td></tr>
            <tr id="39931488"><td></td></tr>
                  <tr id="39930046"><td></td></tr>
                <tr id="39930093"><td></td></tr>
                  <tr id="39930947"><td></td></tr>
                <tr id="39932041"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39932041" href="https://news.ycombinator.com/vote?id=39932041&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>One time I lost something important at work. I asked a co-worker about it and she suggested we do the St. Anthony prayer, so more-or-less to humor her and to take my mind off the worry I went along.<p>The important thing was found later that day, in a very unlikely place.</p><p>YMMV.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                  <tr id="39929522"><td></td></tr>
                <tr id="39930344"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39930344" href="https://news.ycombinator.com/vote?id=39930344&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>Don't let the music start playing (after 5 seconds) because soon after that you will be hooked</span></p></div></td></tr>
        </tbody></table></td></tr>
                  <tr id="39930436"><td></td></tr>
                <tr id="39931965"><td></td></tr>
            <tr id="39932077"><td></td></tr>
                  <tr id="39930484"><td></td></tr>
                <tr id="39930627"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39930627" href="https://news.ycombinator.com/vote?id=39930627&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>Wow, it's even responsive!<p>(My browser window is one half of a 4K monitor, so the Spectrum screen is shown in "portrait mode")
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                  <tr id="39931915"><td></td></tr>
            <tr id="39930806"><td></td></tr>
                      <tr id="39931360"><td></td></tr>
            <tr id="39931897"><td></td></tr>
            <tr id="39930456"><td></td></tr>
            <tr id="39931632"><td></td></tr>
            <tr id="39931338"><td></td></tr>
                <tr id="39932619"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39932619" href="https://news.ycombinator.com/vote?id=39932619&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>There was a separate one for Businessweek with an endless Droste-effect of a lady reading a Businessweek issue, headlined "When will Bloomberg get its sh#t together?"<p>I wish I were a fly on the wall when the decision was made to get rid of those 404 pages.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39932458"><td></td></tr>
            <tr id="39931543"><td></td></tr>
                  <tr id="39930650"><td></td></tr>
            <tr id="39932205"><td></td></tr>
            <tr id="39931862"><td></td></tr>
            <tr id="39929547"><td></td></tr>
                <tr id="39930274"><td></td></tr>
                <tr id="39930623"><td></td></tr>
                  <tr id="39930107"><td></td></tr>
            <tr id="39930329"><td></td></tr>
                <tr id="39932348"><td><table>  <tbody><tr>    <td indent="2"><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td>
      <center><a id="up_39932348" href="https://news.ycombinator.com/vote?id=39932348&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>Well, given what the site is doing I don't think they could really return all those status codes for the various pages and still show the images in all browsers. I think httpbin.org may be closer to what you're looking for<p>Also, I've been on the Internet long enough to know that there are unquestionably other sites misusing status codes, made worse by our graphql friend cheerfully packaging server errors in 200 responses
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39932486"><td></td></tr>
                        <tr id="39932159"><td></td></tr>
            <tr id="39930023"><td></td></tr>
                <tr id="39930165"><td></td></tr>
                <tr id="39930298"><td><table>  <tbody><tr>    <td indent="2"><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td>
      <center><a id="up_39930298" href="https://news.ycombinator.com/vote?id=39930298&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>Parallax effect Github 404 was the best. I even had a coffee mug of the design they officially sold (with the text to the effect of 'This isn't the drink you're looking for') but someone took it and they no longer sell them, which was very disappointing.</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39930577"><td><table>  <tbody><tr>    <td indent="2"><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td>
      <center><a id="up_39930577" href="https://news.ycombinator.com/vote?id=39930577&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>Wow, yeah. I hadn't seen a GitHub 404 page in a while (new job, don't code much anymore) and my first thought on seeing it was that the 404 page was broken. That would have been an odd recursion.</span></p></div></td></tr>
        </tbody></table></td></tr>
                        <tr id="39929970"><td></td></tr>
            <tr id="39930458"><td></td></tr>
                <tr id="39931902"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39931902" href="https://news.ycombinator.com/vote?id=39931902&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>Huh, the Sisters are into IF and Frotz. I would have expected point &amp; clicks instead, must be hard to type under only UV light.</span></p></div></td></tr>
        </tbody></table></td></tr>
                  <tr id="39930420"><td></td></tr>
                <tr id="39931563"><td></td></tr>
                  <tr id="39930111"><td></td></tr>
                      <tr id="39930416"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39930416" href="https://news.ycombinator.com/vote?id=39930416&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><p><span>"maybe go try some wasabi pea dust ice cream."<p>I can't recreate the error now, but going to www.moosejaw.com in the EU used to give me the error "we can't offer products in EU... We're working on it. but until then, maybe go try some wasabi pea dust ice cream." I have a screenshot, thank god.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39931552"><td></td></tr>
            <tr id="39930467"><td></td></tr>
            <tr id="39930663"><td></td></tr>
            <tr id="39930374"><td></td></tr>
            <tr id="39931490"><td></td></tr>
            <tr id="39932299"><td></td></tr>
                <tr id="39932935"><td></td></tr>
                  <tr id="39930539"><td></td></tr>
            <tr id="39930397"><td></td></tr>
            <tr id="39931209"><td></td></tr>
                <tr id="39932522"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39932522" href="https://news.ycombinator.com/vote?id=39932522&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>They really should have saved that for their 500 page, since of the "terribly wrong" outcomes, 404 is pretty mild</span></p></div></td></tr>
        </tbody></table></td></tr>
                  <tr id="39929499"><td></td></tr>
                <tr id="39930322"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39930322" href="https://news.ycombinator.com/vote?id=39930322&amp;how=up&amp;goto=item%3Fid%3D39928950"></a></center>    </td><td><br><div>
                  <p><span>The text at the top is rather standard boilerplate 'page not found' verbiage, but the justifications according to the different economic theories listed afterwards is the hidden gem of this page!</span></p></div></td></tr>
        </tbody></table></td></tr>
                  <tr id="39930214"><td></td></tr>
            <tr id="39931647"><td></td></tr>
            <tr id="39931606"><td></td></tr>
            <tr id="39930611"><td></td></tr>
            </tbody></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How Hertz’s bet on Teslas went sideways (122 pts)]]></title>
            <link>https://www.bloomberg.com/news/features/2024-04-03/hertz-htz-selling-electric-cars-ends-its-failed-tesla-bet</link>
            <guid>39928913</guid>
            <pubDate>Thu, 04 Apr 2024 11:23:09 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bloomberg.com/news/features/2024-04-03/hertz-htz-selling-electric-cars-ends-its-failed-tesla-bet">https://www.bloomberg.com/news/features/2024-04-03/hertz-htz-selling-electric-cars-ends-its-failed-tesla-bet</a>, See on <a href="https://news.ycombinator.com/item?id=39928913">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
    <section>
        <h3>Why did this happen?</h3>
        <p>Please make sure your browser supports JavaScript and cookies and that you are not
            blocking them from loading.
            For more information you can review our <a href="https://www.bloomberg.com/notices/tos">Terms of
                Service</a> and <a href="https://www.bloomberg.com/notices/tos">Cookie Policy</a>.</p>
    </section>
    <section>
        <h3>Need Help?</h3>
        <p>For inquiries related to this message please <a href="https://www.bloomberg.com/feedback">contact
            our support team</a> and provide the reference ID below.</p>
        <p>Block reference ID:</p>
    </section>
</section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[A podcast about the xz backdoor with the guy who found it (125 pts)]]></title>
            <link>https://risky.biz/RB743/</link>
            <guid>39928867</guid>
            <pubDate>Thu, 04 Apr 2024 11:17:25 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://risky.biz/RB743/">https://risky.biz/RB743/</a>, See on <a href="https://news.ycombinator.com/item?id=39928867">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
    
    <p>On this week’s show Patrick and Adam discuss the week’s security news, including:</p>

<ul>
  <li>The SSH backdoor that dreams (or nightmares) are made of</li>
  <li>Microsoft gets a solid spanking from the CSRB</li>
  <li>Ukraine uses an old Russian WinRAR bug to hack Russia</li>
  <li>Push-notifications and social-engineering combined-arms vs Apple</li>
  <li>And much, much more.</li>
</ul>

<p>We have a special guest in this week’s show, Andres Freund, the Postgres developer who discovered the backdoor in the xz Linux compression library.</p>

<p>This week’s show is brought to you by Island, a company that makes a security-focussed enterprise browser. Island’s Bradon Rogers is this week’s sponsor guest and he’ll be joining us to talk about how people are swapping out their Virtual Desktop Infrastructure for enterprise-focussed browsers like theirs.</p>

    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Anatomy of a credit card rewards program (602 pts)]]></title>
            <link>https://www.bitsaboutmoney.com/archive/anatomy-of-credit-card-rewards-programs/</link>
            <guid>39928604</guid>
            <pubDate>Thu, 04 Apr 2024 10:35:17 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bitsaboutmoney.com/archive/anatomy-of-credit-card-rewards-programs/">https://www.bitsaboutmoney.com/archive/anatomy-of-credit-card-rewards-programs/</a>, See on <a href="https://news.ycombinator.com/item?id=39928604">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        <p>There are only a few opportunities to make a living by getting good at creating tables to facilitate high-frequency math that end-users will find entertaining but will have predictable statistical properties at scale.</p><p>One of them is designing roleplaying games. Seems like an interesting topic but someone else will have to write about it. In this column, the dragon sleeps on a hoard of interchange revenue, you slay him to get credit cards rewards points, and the card issuer running the game merrily chuckles at players’ misperception that they are dragons. No, silly, they’re much realer and much richer.</p><p>A disclaimer off the top: I used to work at, and am still an advisor of, Stripe. A major portion of the Stripe economic model is charging businesses money to take payments on credit cards. Stripe’s two largest costs are paying smart people and paying interchange, and of the two, one would feel a lot better to cut.&nbsp;</p><p>Another disclaimer: Due to long-standing practice, I am (homeopathically) exposed to the common equity of financial services companies that my family uses, so that I can call up Investor Relations if I ever need to escalate a routine banking issue. My family’s main U.S. bank happens to be Chase, which is mentioned below.</p><p>Almost everybody writing about credit cards on the Internet receives some sort of spiff if you sign up after clicking through tagged links in their material. That is not my business model (people <a href="https://www.bitsaboutmoney.com/memberships/">pay me to write</a> about financial infrastructure), but is probably one you want to be cognizant of every time you read about credit cards online.</p><p>As we have <a href="https://www.bitsaboutmoney.com/archive/how-credit-cards-make-money/">discussed previously</a>, credit cards have multiple different ways of earning money, but the most important one to this discussion is interchange. It is a fee, ultimately paid by the card-accepting business, which gets sliced up between various parties in the credit card ecosystem to incentivize them to put their logos in the wallets and on the phones of well-heeled customers and increase the amount they spend and the frequency with which they spend it. (In industry, we sometimes distinguish interchange—which mostly goes to the issuing bank—and scheme fees—which mostly go to the credit card brand itself—but as interchange is much larger, let’s just call them both interchange for simplicity.)</p><p>Interchange is generally a percentage fee based on the final transaction size plus optionally a per-transaction fee. You can just <a href="https://usa.visa.com/content/dam/VCOM/download/merchants/visa-usa-interchange-reimbursement-fees.pdf">look up</a> the <a href="https://www.mastercard.us/content/dam/public/mastercardcom/na/us/en/documents/merchant-rates-2023-2024.pdf">rates</a>, but I strongly recommend you don’t, as you will be reduced to gibbering madness. (It took many smart people many years of work before Stripe could deterministically predict almost all interchange it was charged in advance of actually getting billed for it.)</p><p>To highlight something which is routinely surprising for non-specialists: interchange fees are not constant and fixed. They are set based on quite a few factors (<em>gibbering madness intensifies</em>) but, most prominently, based on the rank of card product you use. The more a card product is pitched to socioeconomically well-off people, the more expensive interchange is. Credit card issuers <em>explicitly and directly</em> charge the rest of the economy for the work involved in recruiting the most desirable customers.</p><p>The basic intuition underlying rewards cards as a product is that highly desirable customers have options in how they spend their money. You can directly influence them to use your rails by making those rails more lucrative, more fun, or both for the customer. And so card issuers (and the networks) compete with each other for so-called “share of wallet” by bidding with interchange.</p><p>This is not quite as sophisticated as the system of dueling robots which bids for your attention every time you open a page on the Internet with an ad on it. The bids are generally speaking pretty static and made years in advance, at or before the time a user signs up for a card product, with relatively minor adjustments made over time. Program managers at card issuers are extremely, extremely sensitive to upsetting the apple cart and churning loyal users, and so they attempt to avoid doing this except when circumstances make it unavoidable.</p><h2 id="why-isn%E2%80%99t-every-card-a-rewards-card">Why isn’t every card a rewards card?</h2><p>Different regions have ended up with different equilibria in the rewards game. In the United States, card acceptance is expensive and the rewards economy is <em>robust</em>. In Japan, card acceptance is expensive and the rewards economy is fairly muted due to—ahem—effective collusion by issuers. In Europe, card acceptance is cheap by regulatory fiat and so rewards are far less common (or commonly lucrative) than in the U.S.</p><p>Similarly, debit card rewards used to be fairly common in the United States until the Dodd-Frank Act <a href="https://www.bitsaboutmoney.com/archive/debit-cards-are-hidden-financial-infrastructure/">capped debit card interchange</a> (with a very important carveout for small banks in the Durbin amendment). When interchange is regulated, the size of the pie isn’t large enough to give the end-user of the card a tasty slice, and so they get nothing.</p><p>But we can see that, even scoping to credit cards in the United States, not every card is a rewards card. What explains why CapitalOne, for example, offers rewards for its Quicksilver card but not the Platinum Mastercard? Is <a href="https://dictionary.cambridge.org/us/dictionary/english/quicksilver">mercury</a> attempting to burnish its image after that horrible toxicity thing?</p><figure><img src="https://lh7-us.googleusercontent.com/kjmVEJNeGC6Ndngtsm1xQVAhBv2NIrlRxdYO54jeQMZE_kCZBJLxHhZsVWj8V_V6ZBtiHz4E2c9mDKOANWjEbUobYcJsKsy8NNAR2hwxmtIf6QTU7ZCLljy8ZCyAAFAUjsCeAZqUXXIXPI8QTTpOnzU" alt="" loading="lazy" width="1600" height="574"><figcaption><span>Three of Capital One's many offerings.</span></figcaption></figure><p>Partly, this is that different users have different jobs-to-be-done for credit cards. (Many users of credit cards, potentially including some readers of this column, believe that they are the typical users of credit cards. No users of credit cards are typical.)</p><p>Credit cards are both a payment instrument and an access point for a revolving credit line. That they are an expensive way to borrow money is one of the first things said in any personal finance text. They are also one of the most accessible ways to borrow money, and that is their primary value proposition for many users, typically ones lower on the socioeconomic ladder. These users spend relatively little in a month compared to their revolving balance, which they continuously pay interest on. It trivially follows that most money on their accounts is earned via net interest margin and not from interchange.</p><p>To the extent these users notice numerically defined features of their credit cards, which is somewhat dubious, it is the headline APR (cost of credit) and their credit limits. “Starter” cards and other products aimed at this user group typically have no rewards; they instead use interchange income to “bid down” the headline APR. Interchange functions as a subsidization of the cost of credit throughout the economy by businesses which want to sell things to people who would use credit to buy things. The limit case of this is Buy Now, Pay Later, where the cost of credit is <a href="https://www.bitsaboutmoney.com/archive/buy-now-pay-later/">subsidized straight to free</a>.</p><p>The heaviest credit card <em>spenders</em>, and this fact is both uncontroversial and flies in the face of what many personal finance columnists believe, are wealthy and sophisticated. They use credit cards primarily as payment instruments. Issuers compete aggressively for their business, which is quite lucrative. This is not because they pay much in interest, because while they have higher headline APRs they only rarely revolve balances. It is because “clipping the ticket” via interchange on a high volume of transactions is an excellent business to be in.</p><p>How dramatic is this? Allow me to reproduce a graph from <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2330942">Regulating Consumer Financial Products: Evidence from Credit Cards</a>. (This paper is something of the Rosetta stone for credit card issuance as a field, both in that it is a single source for understanding a huge range of human endeavor and in that it stands in for a very large literature that nobody else reaches for to be the first citation when the Rosetta Stone already exists. If you see an unlabeled graph on Twitter about credit cards, it was probably lifted from this paper.)<br></p><figure><img src="https://lh7-us.googleusercontent.com/qS9_ADww9fJP_bRDLuovsaHR-yhqnHLSBlE_a2o9hri4Mc-LUX0gjHhRVabD7dAimzd7JUQGYey-GsaQghWATfLlJGDROmOAJyvFAIF_J37Qylgs0U6e2sCk6JHTWy46lsNSsFn4DaQpSdraD8H1Pjg" alt="" loading="lazy" width="626" height="488"><figcaption><span>Interchange income net of rewards expenses heavily favors high FICO users.</span></figcaption></figure><p>As you can see, as a percentage of Average Daily Balance (ADB), even after rewards expense, interchange gets very sharply more lucrative at the top of the credit score distribution (740+, which is roughly 10% of accounts). The difference is <em>actually larger than you see here</em>, since credit lines and ADB also increase with credit score, for predictable reasons. (Rich people consume more than poor people on an absolute basis, film at eleven.)</p><h2 id="the-complexity-spectrum-of-rewards-products">The complexity spectrum of rewards products</h2><p>The simplest reward products are straight “cashback”. The issuer totals up all of one’s net purchases (all purchases less refunds) in a statement period. It then credits the user with a particular percentage of that for each statement. Either automatically or periodically at the user’s request, it transforms some of that notional banked credit into a statement credit, decreasing the amount the user needs to pay to cover their purchases in the current month.</p><p>This is as simple as it gets and we’re already necessarily handwaving away libraries worth of complexity. (For example, calculation of net purchases needs to be fairly robust against adversarial collaboration of users and merchants or the issuer gets turned into a money pump within a matter of days and will not likely be able to detect or reverse this condition for at least several weeks. This has happened many, many times. Credit card issuers, when they screw this up, lose millions of dollars and dry their tears on money.)</p><p>Anyhow, in the mists of history, that percentage started flat; typically, 1%. The math supporting this is typically fairly simple: take in 140bps as revenue, pay the user 100 bps as effectively a cost of customer acquisition, keep some portion of 40 bps as one’s margin.</p><p>In nations other than ones with effective cartel-like behavior by issuers, this equilibrium was not stable, because competing issuers would bid e.g. 1.25% cash back on the same underlying economics and compete for share of wallet. This happened extremely robustly, for decades.</p><p>One iteration of this game was cash back “categories”. Particularly post-Internet, certain cohorts of customers were most interested in the headline cashback percentage rate. Issuers began to design products which were more complicated, such as “1% cash back in principle, however, 1.5% cash back at gas stations.”</p><h2 id="a-fun-rabbit-hole-about-credit-card-acceptance">A fun rabbit hole about credit card acceptance</h2><p>A huge percentage of all credit cards are “co-branded”; they are issued by a financial institution but bear the name of some other institution which inspires a lot of loyalty. A teeny, tiny percentage of co-branded cards name e.g. tertiary educational institutions. Most name a business that a customer has an intense, ongoing relationship with: Costco, their airline of choice, etc.</p><p>Co-branded cards are <em>extremely</em> big business. One subtlety about them: a co-branded card will often have a special rewards tier for the business named on the card. This is partially that business choosing, as a marketing expense, to split some of their core margin with their most loyal customers (<em>overwhelmingly</em> the target audience for the co-branded card). But, surprisingly to many non-specialists, that is not the sole source of margin to reward cardholders with.</p><p>This is because, at the scale of the largest businesses in the world, financial services are cross-sold and structurally interconnected. There is one team in a bank (it happens to be Chase, for what it is worth) attempting to capture Starbuck’s card processing business. There is another team that wants to convince Starbucks to co-brand Chase card products. These two teams <em>can talk to each other</em> prior to making proposals to Starbucks.</p><p>And so, without knowing anything about the payments industry, you can speculate with a very high degree of confidence that Starbucks has received a complicated spreadsheet saying what Chase will charge it for every conceivable type of credit and debit card that wants a latte. A prominent negotiated line on that spreadsheet includes, effectively, a major discount for “on us” transactions: when Chase’s left hand needs to move money from Chase’s right hand because someone wants to pay Starbucks money for their Starbucks using their Starbucks-branded money. (This is easy to conflate with, and is separate from, Starbucks’ extremely impressive stored-value product. <em>That</em> probably mostly <a href="https://www.nerdwallet.com/article/credit-cards/chase-to-sunset-starbucks-credit-card-convert-users-to-freedom-cards">cannibalized</a> their credit product, which… alright, we have to stop the levels of digression somewhere or we’ll be here all day.)</p><p>Because “on us” is structurally cheaper (the transaction literally travels over fewer rails and therefore there are fewer “mouths to feed”) and because it is incentive compatible for all parties to subsidize these transactions, as a card program designer, you have a relatively easy time being generous with regards to this particular cell of your spreadsheet.</p><h2 id="back-to-more-complicated-cases">Back to more complicated cases</h2><p>So imagine you’re the card program designer for a card that, like most cards, does not have a particular named business happily subsidizing your users. You desire to quote a headline cashback number much higher than 1%. But you’d still like to keep some margin from interchange. What could you do?</p><p>One is you make the headline number larger but contingent on something. Say, for example, the card rebates 1.5%, but only for… bookstores. Any bookstore. For all other transactions, it is 1%.</p><p>The thing you would love with this offering is to preferentially attract people who are <em>very emotionally invested in being readers</em> and who spends <em>very little of her on-this-card wallet on books</em>. The emotional investment in the story the card offers brings the customer in; the <em>blended</em> cost to acquire the customer is closer to 1% industry standard and not to the 1.5% headline number.</p><p>Money is fungible, money is fungible, money is fungible, but many people don’t actually orient their lives as if this were true, and so the financial industry meets them where they are and then charges them for the privilege. This user values a dollar more when it is a books-dollar than when it is a food-dollar. You, a credit card program manager, can math out a way to get her as many books-dollars as she is interested in. (This is similar, in spirit, to how Bryrne Hobart <a href="https://marker.medium.com/why-the-survival-of-the-airlines-depends-on-frequent-flyer-programs-2509bd3f25d0">describes</a> airline frequent flyer programs as working. One key difference that credit card program managers have to understand: a source of advantage for frequent flyer miles as a pseudocurrency is that they can turn very-low-marginal-cost inputs, unsold seats, into very-high-perceived-marginal-benefit outputs, “free vacations”. Books-dollars may very well be worth more than a dollar to our target user here, but books-dollars are very difficult to manufacture in quantity for less than about 98ish cents.)</p><p>In principle, you could even offer <em>more</em> than your direct interchange revenue as the headline number, if you were very, very sure that your typical user would not preferentially use your card only to buy books and use a competitor’s card to buy groceries, gasoline, medicine, and similar.&nbsp;</p><p>Now, unfortunately, remember what we said about typical credit card users? That’s <em>right</em>. They don’t exist. Very many of your users will do what you want them to, and use the card in a perfectly-acceptable-but-not-exactly-optimal fashion, and you will have a blended cost very near 1% for them. And very many of your users will do exactly what you most don’t want, and use the card <em>only</em> to buy books.</p><p>This is… far less incentive compatible for you, particularly if you decided that the business of manufacturing books-dollars was so lucrative that you could rebate more than the direct interchange revenue given mix effects. These users will have blended costs very close to your headline number, not to your modeled blended costs.</p><p>These users will even band into tribes, find each other on the Internet, and <a href="https://www.reddit.com/r/churning/">swap tips</a> for exploiting poor, defenseless credit card program managers like yourself. The tribal elders will eventually run businesses, with names like <a href="https://thepointsguy.com/">The Points Guy</a>, which eventually get quietly acquired by very sophisticated private equity firms. Those PE firms are betting that you continue paying generous per-signup affiliate commissions to Internet properties which send you new card users. You bet you will also paying tens of millions of dollars annually to Frequently Adversely Selected New Accounts Dot Com. And Redditors bet they will continue chortling that they have pulled one over on you, because haha, you’re not nearly as good as they are at fourth grade math or keeping spreadsheets.</p><p>The biggest difference between you and a Redditor is not ability to do fourth grade math or ability to do spreadsheets. Redditors are frequently <em>sophisticated</em> with their spreadsheets; many of them could clearly earn three orders of magnitude more from the financial industry if they stopped thinking that the right way to monetize spreadsheet skill was in gaming credit card signup bonuses.</p><p>The biggest difference is that you’re optimizing <em>over portfolios, over time</em> and Redditors are largely playing in single player mode (and frequently over short horizons). You only care about single or dual player mode to the extent that you avoid obviously degenerate offerings where adverse selecting single players quickly dominate your entire book of business. Which is <em>very much a risk</em>, which is why the bank has smart people like you keeping spreadsheets.</p><p>The Redditors think failure modes for the bank sound like <a href="https://www.huffpost.com/entry/david-philipps-pudding-guy-travel-deals_n_577c9397e4b0a629c1ab35a7">pudding guy</a>. Pudding guy, was, of course, one of the highest-ROI ad buys in the history of capitalism.</p><h2 id="further-refinements-in-cat-and-mouse-games">Further refinements in cat and mouse games</h2><p>But, just like lotteries have to keep reskinning the random number generators or the games get stale and ticket sales go down, credit card program managers have to periodically shake things up for something to cut through their adversaries’ built-in distribution networks and massive, massive marketing budgets.</p><p>One innovation, now 20+ years old, was a <em>rotating</em> favored category for cash-back. So instead of being 1.5% for bookstores 1% all else, it would be 1.5% for groceries in Q1, for gas in Q2, etc etc.</p><p>The theory behind this was pretty simple: many customers attracted by the headline number could be brought in the door by it but would be fairly inattentive after a card was their new “top of wallet” (the default card for spending). Over time, a combination of inattentiveness, changing willingness to spend time playing the game, and rewards caps would bring the portfolio’s cost of rewards close to the baseline and not to the headline reward number.</p><p>If for some reason playing this game interests you, one prominent product is called the Chase Freedom card. It should not be an attractive product for you, given plausible assumptions about the readership of this column, but it is an attractive <em>enough</em> product that probably millions of Americans use it.</p><h2 id="giving-the-customer-more-choices-more-frequently">Giving the customer more choices more frequently</h2><p>If you were hypothetically to have spent the last few years dining with relatively well-off people in SFBA, when it came time to pay for dinner you’d see two credit card products with a combined 90%+ share: Chase Sapphire Reserve (CSR) and an interchangeable American Express card. This, ahem, includes many diners who are professionally connected to upstart payment methods.</p><p>American Express, for a very long time, had an almost mortal lock on the top end of the credit card market. Chase attempted to disrupt that in 2016 by <em>very overtly</em> attempting to buy away their core customer. You can read lots in other places about the original promotion, generally tsk-tsking about how absurdly lucrative it was for customers and how it caused Chase to have a (temporary) loss associated with their cards business. Personally, I think it was one of the most interesting strategic moves in the last 20 years of retail banking, but a full essay on that would require some other-than-public knowledge as to the size of the tsunami that happened after it.</p><p>One thing that is public but not well appreciated: Chase didn’t just <em>decide</em> to create an extremely lucrative-for-the-customer offering out of the goodness of their hearts and out of their own P&amp;L. No, they <em>pitched Visa on this idea</em>. For too long, Visa, you have watched your competitor American Express outcompete every issuer in the Visa system for the best wallets in the world. They can do that because they can afford to, because American Express charges systematically higher interchange rates than Visa does even at its topmost tier. Visa, you should <em>create a new tier </em>where your not-exactly-chosen champions can try to spend those interchange dollars to give American Express a run for their money.</p><p>And, lo, Visa <em>did</em> create a new tier. You can expose yourself to gibbering madness if you want to know what the name for it is. But Chase got Visa to authorize Chase charging almost the entire economy more for credit card acceptance with the specific goal of outcompeting American Express for the most lucrative highest-monthly-spend virtually-never-revolve-a-balance credit card users.</p><p>That was <em>part</em> of what made the numbers work.</p><p>Another part is that the CSR offers a fairly complicated rewards scheme, with a lot of opportunities for people to pick things which feel great but are not optimal. For example, Chase will let you cash out CSR points on a 1:1 basis at either Amazon or Apple, integrated directly into the checkout flows. Those <em>feel great</em>.&nbsp;</p><figure><img src="https://lh7-us.googleusercontent.com/riPQOFhy7wsVEZKEXS-UpuK1fy3wAavV5l0PQKeo7Jq0gr7rBvL-ILrpQNRAonyXBBTi9fCTN_QMGOOzBeP8TMr0J9Dug9mKN59V9qmndT627LMxumoFQQ7TQFoIAtKz8goBElpBM8f-hkuh_p7oTvk" alt="" loading="lazy" width="1206" height="846"><figcaption><span>This image has been edited to remove private information and to highlight, in red, the offering.</span></figcaption></figure><p>People <em>love</em> Amazon and Apple and they love free Amazon and free Apple even more. This is true even among a portion of very sophisticated, wealthy, numerate CSR users, who love this idea so much they click a button designed for suckers.</p><p>Why is that a sucker’s checkout button? Because CSR also includes a feature called Pay Yourself Back which in the past prominently, and today a bit… less prominently, lets you cash out rewards at better than 1:1. You get a 25% bonus if you Pay Yourself Back by nominating past transactions at grocery stores: 10,000 points gets you $125 in statement credits if you are willing to do a trivial amount of clicking to show Chase $125+ in spend at grocery stores.</p><p>Stating the obvious: Chase knows what a computer is and does not require you to actually identify your purchases at grocery stores. This is a product decision to both a) force you to use your card at grocery stores and b) force yourself to say “Chase is getting me free groceries! How nice of them!” on a transaction-by-transaction level once a month to use your card optimally.</p><p>There are many, many other sucker buttons.</p><p>But, because the card is fundamentally targeted at rich, sophisticated people, Chase really does pay out a shedload of rewards. The 3% headline rate for travel and dining plus the 25% Pay Yourself Back kicker means there is a sustained and trivial pathway to get 375 bps out, which is one of the very, very, very few places in the industry where there is a sustained, trivial, uncapped way to get out more than the direct cost of interchange.</p><p>Why does this persist? Partly it is due to the standard credit card portfolio strategy: every time someone uses a CSR on Amazon (and not e.g. the Amazon rewards card, also from Chase) or uses CSR points to buy <a href="https://www.apple.com/">high-margin white plastic</a>, Chase’s contribution margin for the portfolio goes up, and at scale <em>quite a large percentage </em>of customers do this.</p><p>Partly it is due to Chase thinking that they’ll just <em>be so good</em> for their target customer that their target customer <em>will not bother playing the game optimally. </em>That would require the customer carefully maintaining a portfolio of credit relationships and having seven cards saved on their iPhone and not, simply, the CSR.</p><p>Partly it is due to the really interesting strategic reasons for having CSR available: to a much larger degree than American Express, Chase is a diversified financial services empire. The CSR was effectively designed as a wedge product to get something Chase branded into the hands of affluent up-and-coming young urban professionals, with the goal of eventually getting them to not move just their wallet but their entire financial existence (and potentially their current-or-future <em>entities’</em> financial existences) onto Chase.</p><p>The Sapphire mini-brand was so loved that they reused it for a bog-standard premium checking account. (It was named the Chase Sapphire Premium Checking Account, in a decision which probably consumed several tens of millions of dollars of professional effort, and I mean that absolutely descriptively and not as a criticism. I was not in <em>that</em> meeting… but I’ve been in that <em>kind</em> of meeting. Those that have been in it know that it is not in any way a single-meeting single-decisionmaker sort of call.)</p><h2 id="more-directions-to-go-in">More directions to go in</h2><p>The blessing and curse of essays is that they have to end somewhere, and then pick up anew somewhere else. Hopefully the above gives you a bit more context on what is in your wallet.</p><div><p>In the future, we'll likely discuss the complicated iterated game played by the credit card networks and the rest of society regarding interchange rates, how there are high-interchange-high-reward equilibria and low-interchange-low-reward equilibria, the recent settlement where the networks agreed to temporarily decrease interchange, and other topics. </p></div>

        

        <div>
          <h2>Want more essays in your inbox?</h2>
          <p>I write about the intersection of tech and finance, approximately biweekly. It's free.</p>
                  </div>

      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Kobold letters: Why HTML emails are a risk to your organization (252 pts)]]></title>
            <link>https://lutrasecurity.com/en/articles/kobold-letters/</link>
            <guid>39928558</guid>
            <pubDate>Thu, 04 Apr 2024 10:27:19 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://lutrasecurity.com/en/articles/kobold-letters/">https://lutrasecurity.com/en/articles/kobold-letters/</a>, See on <a href="https://news.ycombinator.com/item?id=39928558">Hacker News</a></p>
<div id="readability-page-1" class="page"><article><p>Anyone who has had to deal with HTML emails on a technical level has probably reached the point where they wanted to quit their job or just set fire to all the mail clients due to their inconsistent implementations. But HTML emails are not just a source of frustration, they can also be a serious security risk.</p><p>Imagine you receive an email forwarded by your manager asking you to wire a large sum of money to a bank account. Of course, you have heard of CEO fraud, so you double-check that the email really comes from your manager. It does, and it may even be cryptographically signed – if you do that in your company. However, you are still not convinced, so you call your manager to ensure that the email is legit. He confirms, so you transfer the money.</p><p>Yet this would be the end of the article if this wasn’t a <em>scam</em>. So what went wrong?</p><h2 id="kobold-letters">Kobold letters</h2><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold_letter.png" alt="Kobold holding a letter by oira.art"><p>The email your manager received and forwarded to you was something completely innocent, such as a potential customer asking a few questions. All that email was supposed to achieve was being forwarded to you. However, the moment the email appeared in your inbox, it changed. The innocent pretext disappeared and the real phishing email became visible. A phishing email you <em>had</em> to trust because you knew the sender and they even confirmed that they had forwarded it to you.</p><p>This attack is possible because most email clients allow CSS to be used to style HTML emails. When an email is forwarded, the position of the original email in the DOM usually changes, allowing for CSS rules to be selectively applied only when an email has been forwarded.</p><p>An attacker can use this to include elements in the email that appear or disappear depending on the context in which the email is viewed. Because they are usually invisible, only appear in certain circumstances, and can be used for all sorts of mischief, I’ll refer to these elements as <em>kobold letters</em>, after the elusive sprites of mythology.</p><p>This affects all types of email clients and webmailers that support HTML email. So pretty much all of them. For the moment, however, I’ll focus on selected clients to demonstrate the problem, and leave it to others (or future me) to extend the principle to other clients.</p><h2 id="thunderbird">Thunderbird</h2><hr><p>This issue was reported to Mozilla on 05.03.2024.<br>The planned release date and a draft of the following section were communicated to Mozilla on 20.03.2024.<br>Possible mitigations have been discussed but will not be implemented until a later date.</p><hr><p>Exploiting this in Thunderbird is fairly straightforward. Thunderbird wraps emails in <code>&lt;div class="moz-text-html" lang="x-unicode"&gt;&lt;/div&gt;</code> and leaves them otherwise unchanged, making it a good example to demonstrate the principle. When forwarding an email, the quoted email will be enclosed in another <code>&lt;div&gt;&lt;/div&gt;</code>, moving it down one level in the DOM.</p><p>Taking this into account leads to the following proof of concept:</p><div><pre tabindex="0"><code data-lang="html"><span><span><span>&lt;!DOCTYPE html&gt;</span>
</span></span><span><span>&lt;<span>html</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;<span>head</span>&gt;
</span></span><span><span>    &lt;<span>style</span>&gt;
</span></span><span><span>        .<span>kobold-letter</span> {
</span></span><span><span>            <span>display</span>: <span>none</span>;
</span></span><span><span>        }
</span></span><span><span>
</span></span><span><span>        .<span>moz-text-html</span><span>&gt;</span><span>div</span><span>&gt;</span>.<span>kobold-letter</span> {
</span></span><span><span>            <span>display</span>: <span>block</span> <span>!important</span>;
</span></span><span><span>        }
</span></span><span><span>    &lt;/<span>style</span>&gt;
</span></span><span><span>&lt;/<span>head</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;<span>body</span>&gt;
</span></span><span><span>    &lt;<span>p</span>&gt;This text is always visible.&lt;/<span>p</span>&gt;
</span></span><span><span>    &lt;<span>p</span> <span>class</span><span>=</span><span>"kobold-letter"</span>&gt;This text will only appear after forwarding.&lt;/<span>p</span>&gt;
</span></span><span><span>&lt;/<span>body</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;/<span>html</span>&gt;
</span></span></code></pre></div><p>The email contains two paragraphs, one that has no styling and should always be visible, and one that is hidden with <code>display: none;</code>. This is how it looks when the email is displayed in Thunderbird:</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold-moz-1.png" alt="A simple email containing the sentence &quot;This text is always visible.&quot;"><figcaption><h4>This email may look harmless...</h4></figcaption></figure><p>As expected, only the paragraph “<em>This text is always visible.</em>” is shown. However, when we forward the email, the second paragraph becomes suddenly visible. Albeit only to the new recipient – the original recipient who forwarded the email remains unaware.</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold-moz-2.png" alt="The sentence &quot;This text will only appear after forwarding.&quot; is now visible."><figcaption><h4>...until it has been forwarded.</h4></figcaption></figure><p>Because we know exactly where each element will be in the DOM relative to <code>.moz-text-html</code>, and because we control the CSS, we can easily hide and show any part of the email, changing the content completely. If we style the kobold letter as an overlay, we can not only affect the forwarded email, but also (for example) replace any comments your manager might have had on the original mail, opening up even more opportunities for phishing.</p><h2 id="outlook-on-the-web">Outlook on the web</h2><hr><p>This issue was reported to Microsoft on 05.03.2024.<br>The planned release date and a draft of the following section were communicated to Microsoft on 20.03.2024.<br>The report was marked as closed by Microsoft on 26.03.204 after deciding not to take any immediate action.</p><hr><p>In <em>Outlook on the web</em> (OWA) the situation is slightly more complicated, as it is a webmailer. Emails are contained in <code>&lt;div class="rps_78fa"&gt;&lt;/div&gt;</code>, but the exact class name will change. To prevent the CSS of emails to affect the style of the webmailer, Outlook modifies the email by prefixing all ids and classes with <code>x_</code> and adjust the CSS accordingly.</p><p>Considering all this, we get the following proof of concept:</p><div><pre tabindex="0"><code data-lang="html"><span><span><span>&lt;!DOCTYPE html&gt;</span>
</span></span><span><span>&lt;<span>html</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;<span>head</span>&gt;
</span></span><span><span>    &lt;<span>style</span>&gt;
</span></span><span><span>        .<span>kobold-letter</span> {
</span></span><span><span>            <span>display</span>: <span>none</span>;
</span></span><span><span>        }
</span></span><span><span>
</span></span><span><span>        <span>body</span><span>&gt;</span><span>div</span><span>&gt;</span>.<span>kobold-letter</span> {
</span></span><span><span>            <span>display</span>: <span>block</span> <span>!important</span>;
</span></span><span><span>        }
</span></span><span><span>    &lt;/<span>style</span>&gt;
</span></span><span><span>&lt;/<span>head</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;<span>body</span>&gt;
</span></span><span><span>    &lt;<span>p</span>&gt;This text is always visible.&lt;/<span>p</span>&gt;
</span></span><span><span>    &lt;<span>p</span> <span>class</span><span>=</span><span>"kobold-letter"</span>&gt;This text will only appear after forwarding.&lt;/<span>p</span>&gt;
</span></span><span><span>&lt;/<span>body</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;/<span>html</span>&gt;
</span></span></code></pre></div><p>When the email is displayed by OWA, the CSS will look like this:</p><div><pre tabindex="0"><code data-lang="html"><span><span>&lt;<span>style</span>&gt;
</span></span><span><span><span>&lt;!</span><span>--</span>
</span></span><span><span>.<span>rps_78fa</span> .<span>x_kobold-letter</span>
</span></span><span><span>	{<span>display</span>:<span>none</span>}
</span></span><span><span>.<span>rps_78fa</span> <span>&gt;</span> <span>div</span> <span>&gt;</span> <span>div</span> <span>&gt;</span> .<span>x_kobold-letter</span>
</span></span><span><span>	{<span>display</span>:<span>block</span><span>!important</span>}
</span></span><span><span><span>--</span><span>&gt;</span>
</span></span><span><span>&lt;/<span>style</span>&gt;
</span></span></code></pre></div><p>The email will be displayed as expected:</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold-owa-1.png" alt="A simple email containing the sentence &quot;This text is always visible.&quot;"><figcaption><h4>This email could ask for a harmless favour...</h4></figcaption></figure><p>After forwarding, the kobold letter will be enclosed by another <code>&lt;div&gt;</code> and the CSS will be updated again:</p><div><pre tabindex="0"><code data-lang="html"><span><span>&lt;<span>style</span>&gt;
</span></span><span><span><span>&lt;!</span><span>--</span>
</span></span><span><span>.<span>rps_78fa</span> .<span>x_x_kobold-letter</span>
</span></span><span><span>	{<span>display</span>:<span>none</span>}
</span></span><span><span>.<span>rps_78fa</span> <span>div</span> <span>&gt;</span> <span>div</span> <span>&gt;</span> .<span>x_x_kobold-letter</span>
</span></span><span><span>	{<span>display</span>:<span>block</span><span>!important</span>}
</span></span><span><span><span>--</span><span>&gt;</span>
</span></span><span><span>&lt;/<span>style</span>&gt;
</span></span></code></pre></div><p>Note that in the second rule, the <code>&gt;</code> between <code>.rps_78fa</code> and <code>div</code> has been dropped. This must be taken into account when creating more complicated selectors. Our proof of concept works as intended:</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold-owa-2.png" alt="The sentence &quot;This text will only appear after forwarding.&quot; is now visible."><figcaption><h4>...or all your money.</h4></figcaption></figure><p>The adjustments that OWA applies to the email do not interfere with the attack, but need to be considered when crafting a kobold letter. As we don’t have an easily recognizable anchor point, this can become a nuisance when trying to create a kobold letter that works for multiple clients at the same time.</p><h2 id="gmail">Gmail</h2><hr><p>This issue was reported to Google on 05.03.2024.<br>The planned release date and a draft of the following section were communicated to Google on 20.03.2024.</p><hr><p>So far, we could define kobold letters as elements that use CSS selectors to be shown or hidden depending on the context in which the email is displayed. By this definition, Gmail is technically not vulnerable to kobold letters because it strips all styling from the email when forwarding it.</p><p>This allows for an even simpler – albeit more limited – attack: It is now sufficient to hide the kobold letter with CSS, and it will automatically appear when forwarded. However, this does not allow the opposite behaviour, where the kobold letter is visible in the original email and invisible in the forwarded email.</p><div><pre tabindex="0"><code data-lang="html"><span><span><span>&lt;!DOCTYPE html&gt;</span>
</span></span><span><span>&lt;<span>html</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;<span>head</span>&gt;
</span></span><span><span>    &lt;<span>style</span>&gt;
</span></span><span><span>        .<span>kobold-letter</span> {
</span></span><span><span>            <span>display</span>: <span>none</span>;
</span></span><span><span>        }
</span></span><span><span>    &lt;/<span>style</span>&gt;
</span></span><span><span>&lt;/<span>head</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;<span>body</span>&gt;
</span></span><span><span>    &lt;<span>p</span>&gt;This text is always visible.&lt;/<span>p</span>&gt;
</span></span><span><span>    &lt;<span>p</span> <span>class</span><span>=</span><span>"kobold-letter"</span>&gt;This text will only appear after forwarding.&lt;/<span>p</span>&gt;
</span></span><span><span>&lt;/<span>body</span>&gt;
</span></span><span><span>
</span></span><span><span>&lt;/<span>html</span>&gt;
</span></span></code></pre></div><p>This is aided by the fact that when the email is forwarded, the CSS is not removed until after it has been sent:</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold-gmail-1.png" alt="A simple email containing the sentence &quot;This text is always visible.&quot;"><figcaption><h4>Even while commenting on the forwarded message, the illusion is maintained...</h4></figcaption></figure><p>While the second paragraph was clearly not visible in the editor, it is in the resulting email:</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/kobold-gmail-2.png" alt="The sentence &quot;This text will only appear after forwarding.&quot; is now visible."><figcaption><h4>...but in the end it will betray you.</h4></figcaption></figure><p>While it is difficult to fix kobold letters in general without breaking too much, Google could mitigate the problem by removing the CSS already in the editor. This would at least allow the sender to detect the attack before forwarding the email.</p><h2 id="prior-work">Prior work</h2><p>The fact that this is possible in one way or another is neither surprising nor new. Therefore similar issues have been reported in the past:</p><ul><li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1796180" target="_blank" rel="noopener noreferrer">Thunderbird - Modification of replied mail content without knowledge of replier of the mail using CSS</a></li><li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1836276" target="_blank" rel="noopener noreferrer">Treat OpenPGP/SMIME email messages with certain CSS elements as unsigned</a></li><li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1731198" target="_blank" rel="noopener noreferrer">Composition should use inline styling so that styles from quotes don’t leak into the message</a></li></ul><p>The novelty of kobold letters lies in the focus on a specific attack scenario, while looking at multiple email clients. This hopefully will help raise awareness of the risks associated with HTML emails and contribute to the discussion of what trade-offs are acceptable to mitigate these risks.</p><h2 id="outlook-not-the-software">Outlook (not the software)</h2><p>Users can mitigate kobold letters by disabling HTML email altogether or viewing it in a restricted mode (e.g. “plain HTML” in Thunderbird). For email clients, it is more difficult to implement a mitigation, as preventing the use of <code>&lt;style&gt;</code><sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup> would fix this, but would also break a lot of existing solutions in the email ecosystem. An implementation like the one Google already uses for Gmail could be a compromise that allows for stylized corporate newsletters while limiting the risks of HTML email.</p><p>Unfortunately, for the foreseeable future, it is sadly not realistic to expect email clients to implement robust mitigation. This means that it is up to the users to be aware of the dangers of HTML emails and to take the necessary precautions.</p><figure><img src="https://lutrasecurity.com/en/articles/kobold-letters/This-is-fine.jpg" alt="This is fine meme"><figcaption><h4>But I guess this is fine.</h4></figcaption></figure></article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Browse Self-Hosted Software (131 pts)]]></title>
            <link>https://selfh.st/apps/</link>
            <guid>39928445</guid>
            <pubDate>Thu, 04 Apr 2024 10:05:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://selfh.st/apps/">https://selfh.st/apps/</a>, See on <a href="https://news.ycombinator.com/item?id=39928445">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>

<h2>Browse <span>Self-Hosted</span> Software</h2>

<div><p>Use the filters below to find projects by<b><strong> tag</strong></b> or <b><strong>hosted counterpart</strong></b>. Information and frequently asked questions about this list can be found <a href="https://selfh.st/apps-about/" rel="noreferrer"><b><strong>here</strong></b></a>.</p></div>

<div>
<p><label for="tagFilter">Tags</label>

</p>
<p><label for="alternativeFilter">Alternatives</label>

</p>
<p><label for="sortOptions">Sort</label>

</p>
<p><label for="searchBox">Search</label>

</p>
</div>








</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[German state moving 30k PCs to LibreOffice (487 pts)]]></title>
            <link>https://blog.documentfoundation.org/blog/2024/04/04/german-state-moving-30000-pcs-to-libreoffice/</link>
            <guid>39928173</guid>
            <pubDate>Thu, 04 Apr 2024 09:19:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.documentfoundation.org/blog/2024/04/04/german-state-moving-30000-pcs-to-libreoffice/">https://blog.documentfoundation.org/blog/2024/04/04/german-state-moving-30000-pcs-to-libreoffice/</a>, See on <a href="https://news.ycombinator.com/item?id=39928173">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="page">
		<article>
			<div id="content_box">
							
														<header>
								
								
							</header><!--.headline_area-->
							<div>
								<p><img decoding="async" src="https://blog.documentfoundation.org/wp-content/uploads/2024/04/german_state_schleswig_holstein_moves_to_libreoffice.png" width="600" alt="German state moving 30,000 PCs to LibreOffice"></p>
<p>Following a successful pilot project, the northern German federal state of <a href="https://en.wikipedia.org/wiki/Schleswig-Holstein">Schleswig-Holstein</a> has decided to move from Microsoft Windows and Microsoft Office to Linux and LibreOffice (and other <a href="https://en.wikipedia.org/wiki/Free_and_open-source_software">free and open source software</a>) on the 30,000 PCs used in the local government. As reported on the homepage of the Minister-President:</p>
<blockquote><p>Independent, sustainable, secure: Schleswig-Holstein will be a digital pioneer region and the first German state to introduce a digitally sovereign IT workplace in its state administration. With a cabinet decision to introduce the open-source software LibreOffice as the standard office solution across the board, the government has given the go-ahead for the first step towards complete digital sovereignty in the state, with further steps to follow.</p></blockquote>
<p>The term <strong>digital sovereignty</strong> is very important here. If a public administration uses proprietary, closed software that can’t be studied or modified, it is very difficult to know what happens to users’ data:</p>
<blockquote><p>We have no influence on the operating processes of such [proprietary] solutions and the handling of data, including a possible outflow of data to third countries. As a state, we have a great responsibility towards our citizens and companies to ensure that their data is kept safe with us and we must ensure that we are always in control of the IT solutions we use and that we can act independently as a state.</p></blockquote>
<p>This follows on from the finding by the European Data Protection Supervisor (EDPS) that the <a hrefe="https://blog.documentfoundation.org/blog/2024/03/29/use-of-microsoft-365-breaches-data-protection-law-in-eu/">European Commission’s use of Microsoft 365 breaches data protection law</a>.</p>
<p>In addition, there is this question: <strong>Why should local governments use taxpayers’ money to buy proprietary, closed software from a single vendor?</strong> With LibreOffice and free software, administrations have much more choice <a href="https://www.documentfoundation.org/certified-developers/">where to get the software and support</a>, and can fund local developers to make improvements. In addition, local governments can maintain full control of the software, study its source code, make changes they require and deploy it entirely on their own infrastructure. <a href="https://publiccode.eu/en/">Learn more about “Public Money, Public Code”.</a></p>
<p>So we welcome the decision in Schleswig-Holstein to move its IT administration to free and open source software, for all the benefits it brings, both for the local government and the almost three million citizens of the state.</p>
<h3><a href="https://www.schleswig-holstein.de/DE/landesregierung/ministerien-behoerden/I/Presse/PI/2024/CdS/240403_cds_it-arbeitsplatz.html">Full statement from the Minister-President here (in German)</a></h3>
																							</div>
						</div>
		</article>
			</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Keeping your data from Apple is harder than expected (239 pts)]]></title>
            <link>https://www.aalto.fi/en/news/keeping-your-data-from-apple-is-harder-than-expected</link>
            <guid>39927657</guid>
            <pubDate>Thu, 04 Apr 2024 07:53:17 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.aalto.fi/en/news/keeping-your-data-from-apple-is-harder-than-expected">https://www.aalto.fi/en/news/keeping-your-data-from-apple-is-harder-than-expected</a>, See on <a href="https://news.ycombinator.com/item?id=39927657">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><h2><strong>Participants weren’t able to stop data sharing in any of the apps</strong></h2>
<p dir="ltr">In practice, protecting privacy on an Apple device requires persistent and expert clicking on each app individually. Apple's help falls short.</p>
<p dir="ltr">‘The online instructions for restricting data access are very complex and confusing, and the steps required are scattered in different places. There’s no clear direction on whether to go to the app settings, the central settings – or even both,’ says&nbsp;<strong>Amel Bourdoucen</strong>, a doctoral researcher at Aalto.</p>
<p dir="ltr">In addition, the instructions didn’t list all the necessary steps or explain how collected data is processed.</p>
<p dir="ltr">The researchers also demonstrated these problems experimentally. They interviewed users and asked them to try changing the settings.&nbsp;</p>
<p dir="ltr">‘It turned out that the participants weren’t able to prevent any of the apps from sharing their data with other applications or the service provider,’ Bourdoucen says.&nbsp;</p>
<p dir="ltr">Finding and adjusting privacy settings also took a lot of time. ‘When making adjustments, users don't get feedback on whether they’ve succeeded. They then get lost along the way, go backwards in the process and scroll randomly, not knowing if they've done enough,’ Bourdoucen says.</p>
<p dir="ltr">In the end, Bourdoucen explains, the participants were able to take one or two steps in the right direction, but none succeeded in following the whole procedure to protect their privacy.</p>
<h2><strong>Running out of options</strong></h2>
<p dir="ltr">If preventing data sharing is difficult, what does Apple do with all that data?&nbsp;</p>
<p dir="ltr">It’s not possible to be sure based on public documents, but Lindqvist says it’s possible to conclude that the data will be used to train the artificial intelligence system behind Siri and to provide personalised user experiences, among other things.&nbsp;</p>
<p dir="ltr">Many users are used to seamless multi-device interaction, which makes it difficult to move back to a time of more limited data sharing. However, Apple could inform users much more clearly than it does today, says Lindqvist. The study lists a number of detailed suggestions to clarify privacy settings and improve guidelines.</p>
<p dir="ltr">For individual apps, Lindqvist says that the problem can be solved to some extent by opting for a third-party service. For example, some participants in the study had switched from Safari to Firefox.</p>
<p dir="ltr">Lindqvist can’t comment directly on how Google's Android works in similar respects, as no one has yet done a similar mapping of its apps. But past research on third-party apps does not suggest that Google is any more privacy-conscious than Apple.</p>
<p dir="ltr">So what can be learned from all this – are users ultimately facing an almost impossible task?</p>
<p dir="ltr">‘Unfortunately, that's one lesson,’ says Lindqvist.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Dark Star at 50: How a micro-budget student film changed sci-fi forever (160 pts)]]></title>
            <link>https://www.bbc.com/culture/article/20240403-dark-star-at-50-how-a-micro-budget-student-film-changed-sci-fi-forever</link>
            <guid>39927246</guid>
            <pubDate>Thu, 04 Apr 2024 06:40:47 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bbc.com/culture/article/20240403-dark-star-at-50-how-a-micro-budget-student-film-changed-sci-fi-forever">https://www.bbc.com/culture/article/20240403-dark-star-at-50-how-a-micro-budget-student-film-changed-sci-fi-forever</a>, See on <a href="https://news.ycombinator.com/item?id=39927246">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Online Encyclopedia of Integer Sequences (197 pts)]]></title>
            <link>https://oeis.org/</link>
            <guid>39925787</guid>
            <pubDate>Thu, 04 Apr 2024 02:09:01 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://oeis.org/">https://oeis.org/</a>, See on <a href="https://news.ycombinator.com/item?id=39925787">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
        

<center>


<br>

<span dir="LTR">
<form name="f" action="/search" method="GET">
  Enter a sequence, word, or sequence number:
  <p>
  

  &nbsp;
  <a href="https://oeis.org/hints.html">Hints</a> &nbsp;
  <a href="https://oeis.org/Seis.html">Welcome</a> &nbsp;
  <a href="https://www.youtube.com/watch?v=vKPRRUWbWAQ">Video</a> 
</p></form>
</span>

<p><span dir="LTR">For more information about the Encyclopedia, see the <a href="https://oeis.org/Seis.html">Welcome</a> page.</span></p>

<p>
<span size="-1">
  <a href="https://oeis.org/translate.html"><span color="red">Languages:</span></a> &nbsp; 
  
  <a href="https://oeis.org/?language=english" title="English">English</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=albanian" title="Albanian">Shqip</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=arabic" title="Arabic">العربية</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=bengali" title="Bengali">Bangla</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=bulgarian" title="Bulgarian">Български</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=catalan" title="Catalan">Català</a> &nbsp;&nbsp;
  中文 (<a href="https://oeis.org/?language=chinese" title="Chinese (traditional)">正體字</a>,
<a href="https://oeis.org/?language=chineseS" title="Chinese (simplified 1)">简化字 (1)</a>,
      <a href="https://oeis.org/?language=chineseT" title="Chinese (simplified 2)">简化字 (2)</a>)<br>
  
  <a href="https://oeis.org/?language=croatian" title="Croatian">Hrvatski</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=czech" title="Czech">Čeština</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=danish" title="Danish">Dansk</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=dutch" title="Dutch">Nederlands</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=esperanto" title="Esperanto">Esperanto</a>  &nbsp;&nbsp;
  <a href="https://oeis.org/?language=estonian" title="Estonian">Eesti</a>  &nbsp;&nbsp;
  
  <a href="https://oeis.org/?language=farsi" title="Farsi">فارسی</a>  &nbsp;&nbsp;
  <a href="https://oeis.org/?language=finnish" title="Finnish">Suomi</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=french" title="French">Français</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=german" title="German">Deutsch</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=greek" title="Greek">Ελληνικά</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=gujarati" title="Gujarati">ગુજરાતી</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=hebrew" title="Hebrew">עברית</a> <br>

  <a href="https://oeis.org/?language=hindi" title="Hindi">हिंदी</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=hungarian" title="Hungarian">Magyar</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=igbo" title="Igbo">Igbo</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=indonesian" title="Indonesian">Bahasa Indonesia</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=italian" title="Italian">Italiano</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=japanese" title="Japanese">日本語</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=kannada" title="Kannada">ಕನ್ನಡ</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=korean" title="Korean">한국어</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=lithuanian" title="Lithuanian">Lietuvių</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=marathi" title="Marathi">मराठी</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=norwegianB" title="Norwegian (Bokmål)">Bokmål</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=norwegianN" title="Norwegian (Nynorsk)">Nynorsk</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=polish" title="Polish">Polski</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=portuguese" title="Portuguese">Português</a> &nbsp;&nbsp;<br>

  <a href="https://oeis.org/?language=romanian" title="Romanian">Română</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=russian" title="Russian">Русский</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=serbian" title="Serbian">Српски</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=slovenian" title="Slovenian">Slovenščina</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=spanish" title="Spanish">Español</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=swedish" title="Swedish">Svenska</a> &nbsp;&nbsp;
  
  <a href="https://oeis.org/?language=tagalog" title="Tagalog">Tagalog</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=thai" title="Thai">ภาษาไทย</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=turkish" title="Turkish">Türkçe</a>  &nbsp;&nbsp;
  <a href="https://oeis.org/?language=ukrainian" title="Ukrainian">Українська</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=urdu" title="Urdu">اردو</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=vietnamese" title="Vietnamese">Tiếng Việt</a> &nbsp;&nbsp;
  <a href="https://oeis.org/?language=welsh" title="Welsh">Cymraeg</a> 
</span>
</p></center>


      </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[HNInternal: Ask HN: Has Anyone Trained a personal LLM using their personal notes? (128 pts)]]></title>
            <link>https://news.ycombinator.com/item?id=39925316</link>
            <guid>39925316</guid>
            <pubDate>Thu, 04 Apr 2024 01:00:06 GMT</pubDate>
            <description><![CDATA[<p>See on <a href="https://news.ycombinator.com/item?id=39925316">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
            <tbody><tr id="39927817"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39927817" href="https://news.ycombinator.com/vote?id=39927817&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>I've been disciplined (perhaps obsessive at times) with keeping a daily diary for many years and I was interested in being able to query my diary locally via AI. I found a solution that works surprisingly well using GPT4ALL.<p>I found GPT4ALL (<a href="https://gpt4all.io/" rel="nofollow">https://gpt4all.io</a>) to have a nice-enough GUI, and it runs reasonably quickly on my M1 MacBook Air with 8Gb of ram, and it can be setup to be a completely local solution - not sending your data to the Goliaths.</p><p>GPT4ALL has an option to access local documents, via the Sbert text embedding model (RAG).</p><p>My specific results have been as follows; using the Nous Hermes 2 Mistral DPO and Sbert - I indexed 153 days of my daily writing (most days I write between 2 and 3 thousand words).</p><p>Asking a simple question like "what are the challenges faced by the author?" provides remarkable, almost spooky results (which I won't share here) - which in my opinion are spot-on regarding my own challenges over that the period - and Sbert provides references to which documents it used to generate the answer. Options are available to reference an arbitrary number of documents, however the default is 10. Ideally I'd like to have it reference all 153 documents in the query - I'm not sure if it's a ram or a token issue, however increasing the value of documents referenced has resulted in machine lock-ups.</p><p>Anyhow - that's my experience - hope it's helpful to someone.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39928137"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39928137" href="https://news.ycombinator.com/vote?id=39928137&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>This might seem impressive because of the subjectiveness. I also imagine, you arent mentioning the times it was completely incorrect because you used a negative in the sentence.<p>This is regular embeddings + LLM.</p><p>At the end of the day, you are basically just adding a preprompt to a search. Not to mention, the Mistral models are barely useful for logic.</p><p>I'm not really sure what you are getting out of it. I'm wondering if you are reading some mostly generic Mistral output with a few words from your pre-prompt/embedding.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39928081"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39928081" href="https://news.ycombinator.com/vote?id=39928081&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>Is the diary digital?
I prefer writing on paper, and I'd like to try this. Wonder if there's any decent OCR app that'll help me do it.</span></p></div></td></tr>
        </tbody></table></td></tr>
                  <tr id="39926395"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926395" href="https://news.ycombinator.com/vote?id=39926395&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>Maybe not exactly what you’re asking, but I started doing talk therapy last year. It’s done virtually and I record the session with OBS. As soon as the recording finishes, the following happens:<p>- The audio is preprocessed (chunked) and sent to Whisper to generate a transcript</p><p>- The transcript is sent to GPT-4 to generate a summary, action items, concepts introduced with additional information</p><p>- The next meeting’s date/time is added to my calendar</p><p>- A chatbot is created that allows me to chat with each session, including playing the role as the therapist and continuing the conversation (with the entire context of what I actually talked about)</p><p>It’s been exceedingly helpful to be able to review all my therapy sessions this way.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39926464"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926464" href="https://news.ycombinator.com/vote?id=39926464&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I'm sincerely happy you're finding value in this and it's a very impressive workflow. The idea of sending my therapy sessions to OpenAI sounds terrifying though.</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39926419"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926419" href="https://news.ycombinator.com/vote?id=39926419&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I hope you're the patient in this scenario, otherwise this is an egregious HIPAA violation.</span></p></div></td></tr>
        </tbody></table></td></tr>
                <tr id="39927076"><td><table>  <tbody><tr>    <td indent="2"><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td>
      <center><a id="up_39927076" href="https://news.ycombinator.com/vote?id=39927076&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>Might still be a violation if they're the patient? Unless therapist and their employer's consent is given and ofc dependent on the relevant jurisdictions (IANAL).</span></p></div></td></tr>
        </tbody></table></td></tr>
                <tr id="39928354"><td></td></tr>
                        <tr id="39926565"><td></td></tr>
            <tr id="39926521"><td></td></tr>
            <tr id="39926532"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926532" href="https://news.ycombinator.com/vote?id=39926532&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I’d love to replicate your workflow. Any luck with speaker diarization using whisper? I’ve tried WhisperX several but it didn’t work.</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39926554"><td></td></tr>
                <tr id="39926609"><td><table>  <tbody><tr>    <td indent="2"><img src="https://news.ycombinator.com/s.gif" height="1" width="80"></td><td>
      <center><a id="up_39926609" href="https://news.ycombinator.com/vote?id=39926609&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I read this as the OP being the patient, not the doctor. Pretty sure a patient is free to violate this confidentiality</span></p></div></td></tr>
        </tbody></table></td></tr>
                <tr id="39926643"><td><table>  <tbody><tr>    <td indent="3"><img src="https://news.ycombinator.com/s.gif" height="1" width="120"></td><td>
      <center><a id="up_39926643" href="https://news.ycombinator.com/vote?id=39926643&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>Parent was probably referring to OpenAI having access to therapy notes, once GP sent them, and no legal responsibility to keep them private.</span></p></div></td></tr>
        </tbody></table></td></tr>
                <tr id="39926775"><td><table>  <tbody><tr>    <td indent="4"><img src="https://news.ycombinator.com/s.gif" height="1" width="160"></td><td>
      <center><a id="up_39926775" href="https://news.ycombinator.com/vote?id=39926775&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>I'm sure OP knows this, thought about the risk, guessed the probabilities, assessed the nature of her therapy sessions, and decided the system she was building is worth the risk of her therapy content being available with an intuitive chat interface.<p>Not every therapy session is embarrassing, incriminating, or particularly interesting to anyone but you.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39926870"><td><table>  <tbody><tr>    <td indent="5"><img src="https://news.ycombinator.com/s.gif" height="1" width="200"></td><td>
      <center><a id="up_39926870" href="https://news.ycombinator.com/vote?id=39926870&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>Off topic,but where did that gendering come from in your response? I am generally indifferent to personal pronouns but somehow this came across as particularly jarring as I guess it felt like a projection of  misogynistic views of female weakness/need for therapy/emotionalness/etc.  They/their might have been more appropriate here.</span></p></div></td></tr>
        </tbody></table></td></tr>
                <tr id="39927245"><td><table>  <tbody><tr>    <td indent="6"><img src="https://news.ycombinator.com/s.gif" height="1" width="240"></td><td>
      <center><a id="up_39927245" href="https://news.ycombinator.com/vote?id=39927245&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>English is not my first language, so I beg for your forgiveness that I didn't use the they/them. In my language, there is no gendered pronouns, so it's hard for me to guess what's the correct way.<p>When I use he/him, people tell me I assume everyone on HN and tech is a male.</p><p>When I use she/her, you come and label me as misogynistic, too.</p><p>At one point I just give up. Or you know, you could also assume positive intent and not label someone misogynistic based on a comment where gender was not at all important to the discussion.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39927400"><td></td></tr>
                <tr id="39927771"><td></td></tr>
                <tr id="39928022"><td><table>  <tbody><tr>    <td indent="9"><img src="https://news.ycombinator.com/s.gif" height="1" width="360"></td><td>
      <center><a id="up_39928022" href="https://news.ycombinator.com/vote?id=39928022&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>I used OP, though, I didn't want to use "OP" every time I am referencing this person, I thought it would sound strange OP OP OP...<p>Anyway, I'm glad this thread turned into a "how you can avoid being called a misogynist in throwaway comment on HN". I guess from now on, I filter through my comments through Gemini to make sure my English is immaculate and that native English speakers don't castigate me for a small mistake.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                                                                  <tr id="39926174"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926174" href="https://news.ycombinator.com/vote?id=39926174&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>Played around with fine tuning, but ended up just experimenting with RAG.<p>One thing I haven’t worked out yet is the agent reliably understanding if it should do a “point retrieval query” or an “aggregation query.”</p><p>Point query: embed and do vector lookup with some max N and distance threshold. For example:
“Who prepared my 2023 taxes?”</p><p>Aggregation query: select a larger collection of documents (1k+) that possibly don’t fit in the context window and reason over the collection. “Summarize all of the correspondence I’ve had with tax preparation agencies over the past 10 years”</p><p>The latter may be solved with just a larger max N and larger context window.</p><p>Almost like it’s a search lookup vs. a map reduce.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39926735"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926735" href="https://news.ycombinator.com/vote?id=39926735&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>Interesting, been waiting for some free time to do this myself.<p>Mind sharing how you set up your RAG pipeline and which (presumabely FOSS) components you incorporated?
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                  <tr id="39926214"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926214" href="https://news.ycombinator.com/vote?id=39926214&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>I want this for my photos.<p>I'm not a good photographer, but I have taken tens of thousands of photos of my family. I would love to provide a prompt for a specific day and persons and have it create a photo that I never was able to take. I don't mind that it's not "real" because I find photography to be philosophically unreal as it is. I want it to look good, and inspire my mind to recreate the day however it can imagine.</p><p>And I want to do it locally, without giving away my family's data and identity.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39926814"><td></td></tr>
            <tr id="39926945"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926945" href="https://news.ycombinator.com/vote?id=39926945&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>interesting idea.<p>completely unrelated i just read a scifi story where a technology was developed that could revive dead bodies for a short while in order to pose for family photos that they hadn't created before the person passed away.</p><p><a href="https://clarkesworldmagazine.com/liu_03_23/" rel="nofollow">https://clarkesworldmagazine.com/liu_03_23/</a></p><p>obviously going way overboard for something AI can do today, but probably the author wrote the story before that.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                            <tr id="39926342"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926342" href="https://news.ycombinator.com/vote?id=39926342&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>I’ve tried several different systems, nothing really stands out.<p>That being said, I’m trying to document as much as my life in anticipation of such programs existing in the near future. I’m not going overboard, but for example, I wouldn’t really keep a personal diary, but now I try to jot down something every day, write down my thought processes on things, what actions were done and why.</p><p>I’m looking forward to a day where I have an AI assistant (locally hosted and under my control of course) who can help me with decision-making based on my previous actions.  Would be neat to compare/contrast how I do things now, compared to the future me.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39926635"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926635" href="https://news.ycombinator.com/vote?id=39926635&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>Going to wait for longer context local models. Fine tuning/training is lossy compression of your notes into the model weights -- there isn't much value in a vaguely-remembered copy of some of my notes. This is why other comments are pointing you towards Retrieval Augmented Generation instead, where the relevant notes are losslessly added to the prompt.</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39926473"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926473" href="https://news.ycombinator.com/vote?id=39926473&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I started fine-tuning GPT-3.5 on a decently large corpus of my text messages and emails, and it pretty much generated schizophrenic output. I don’t think I did a very good job of curating the text that ended up fine-tuning, and I want to try again.</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39927982"><td></td></tr>
            <tr id="39926486"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926486" href="https://news.ycombinator.com/vote?id=39926486&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>It sounds like you want RAG instead of training or even fine tuning a model.<p>Have you looked into the OpenAI APIs?  They make it relatively easy to do assuming you have some limited programming knowledge.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                <tr id="39926774"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926774" href="https://news.ycombinator.com/vote?id=39926774&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I have recently <i>briefly</i> looked into Assistants API (if that's what you're referring to) but it seems relatively if I'm not mistaken.</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39926506"><td></td></tr>
                  <tr id="39927219"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39927219" href="https://news.ycombinator.com/vote?id=39927219&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>Has anyone seen or used something that can train on a complete imessage history?<p>Presumably, I have more than enough messages from me along with responses from others to chat with a version of myself that bears an incredible likeness to how I speak and think.  In some cases, I'd expect to be able to chat with an LLM of a given contact to see how they'd respond to various questions as well.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39926651"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926651" href="https://news.ycombinator.com/vote?id=39926651&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>Not on my notes, but I have used GPT4All to chat with the documents of dapr. 
I downloaded the md files from the docs GitHub repo and loaded the directory in GPT4All.<p>It is not "training" a model but works pretty great.
              </p></span></p></td></tr>
        </tbody></table></td></tr>
            <tr id="39926557"><td></td></tr>
            <tr id="39926678"><td></td></tr>
            <tr id="39927514"><td></td></tr>
            <tr id="39926369"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926369" href="https://news.ycombinator.com/vote?id=39926369&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>Somewhat related, for those of us who don’t take extensive notes: are there nicely packaged plugins for RAG in email, especially for eg Outlook or Apple Mail?</span></p></div></td></tr>
        </tbody></table></td></tr>
            <tr id="39927672"><td></td></tr>
            <tr id="39926379"><td></td></tr>
            <tr id="39926236"><td><table>  <tbody><tr>    <td indent="0"><img src="https://news.ycombinator.com/s.gif" height="1" width="0"></td><td>
      <center><a id="up_39926236" href="https://news.ycombinator.com/vote?id=39926236&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I have a large org-roam note system. I would like to create a pipeline where I can ask natural language questions, and it will build SQLite quries to efficiently crawl through the database and find what I want. I haven't gotten around to it though.</span></p></div></td></tr>
        </tbody></table></td></tr>
                <tr id="39926889"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39926889" href="https://news.ycombinator.com/vote?id=39926889&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><p><span>Not exactly what you're looking for but I a few months ago I spent a day building a llama-index pipeline against my markdown notes with a really privative note crawling implementation, and had surprisingly good results for question answering.<p>I don't use an org-roam note system but I've been working on a similar and highly opinionated note system that I'm always making tools for. And I'm always interested in seeing people's ideal note systems.</p><p>my crude WIP Obsidian / Markdown note RAG tool: <a href="https://github.com/bs7280/markdown-embeddings-search">https://github.com/bs7280/markdown-embeddings-search</a>
              </p></span></p></td></tr>
        </tbody></table></td></tr>
                  <tr id="39925549"><td></td></tr>
                <tr id="39928393"><td><table>  <tbody><tr>    <td indent="1"><img src="https://news.ycombinator.com/s.gif" height="1" width="40"></td><td>
      <center><a id="up_39928393" href="https://news.ycombinator.com/vote?id=39928393&amp;how=up&amp;goto=item%3Fid%3D39925316"></a></center>    </td><td><br><div>
                  <p><span>I used Private GPT with our internal markdown based developers portal, the results are OK-ish but are closer to a fancy search then to a chat.</span></p></div></td></tr>
        </tbody></table></td></tr>
                  <tr id="39925991"><td></td></tr>
            </tbody></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[A disk so full, it couldn't be restored (354 pts)]]></title>
            <link>https://sixcolors.com/post/2024/03/a-disk-so-full-it-couldnt-be-restored/</link>
            <guid>39925186</guid>
            <pubDate>Thu, 04 Apr 2024 00:41:14 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://sixcolors.com/post/2024/03/a-disk-so-full-it-couldnt-be-restored/">https://sixcolors.com/post/2024/03/a-disk-so-full-it-couldnt-be-restored/</a>, See on <a href="https://news.ycombinator.com/item?id=39925186">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>



					



<figure><img decoding="async" src="https://i0.wp.com/sixcolors.com/wp-content/uploads/2024/03/disk-full-warning-macos-6c.png?ssl=1" alt="Disk full alert." data-image-w="" data-image-h="" data-recalc-dims="1"><figcaption></figcaption></figure>
<p>My younger child’s MacBook Pro was unsalvageably full. Only a complete wipe would suffice—and then Time Machine failed us.</p>
<p>I love my children, but they do sometimes forget what I do for a living: answer questions and write books about the most troubling problems people have with their Macs, iPhones, and iPads. But when something goes truly wrong, they suddenly remember, “Hey, Dad might know how to fix it!”</p>
<p>So it happened that my younger asked for my help when their M2 MacBook Pro’s storage filled  up while they were downloading a (legitimate, purchased) game using Steam. No problem! I could just empty the trash. Nope, they tried that. Well, what about finding some caches and…nope. I could just go into the Terminal and…ok, that didn’t work either.</p>
<p>Turned out, my kid had managed a neat trick, though they were not alone: they had filled macOS’s startup volume storage so full that the operating system was incapable of deleting files in any fashion. Instead of halting the massive Steam download when the drive became disastrously full, macOS  continued to write files until there was just 41K free on the drive.</p>
<p>I don’t know quite what happened. They didn’t realize their terabyte SSD was quite so filled, as they keep most of their useful files in the cloud. It was likely…er, perfectly legitimate video files. Yeah, I’m sure there was <em>no problem</em> with the copyright there. But they weren’t concerned about retaining them. They just wanted their computer to work again!</p>
<p>I have a theory about what happened. Due to our gigabit Internet connection and the size of the Steam file, macOS outstripped its ability to throttle filling storage because it was also <a href="https://support.apple.com/en-us/102154.">making a local Time Machine snapshot</a>. The Steam file appeared monolithic to me—one giant file—but clearly not to Time Machine. macOS keeps these snapshots to provide local backups for the last 24 hours even while it’s copying files to an external or networked Time Machine destination. I don’t think macOS tracks these snapshots well, and I suspect a collision of live files on disk with the specially created snapshots.</p>
<p>I went through a succession of file deletion attempts, relying on my own knowledge and searching for similar situations in online forums:</p>
<ul>
<li><strong>Empty Trash:</strong> Emptying the Trash via the Finder a big “no” (File &gt; Empty Trash). “The operation can’t be completed because the disk is full.” Yes, macOS, I’m already aware of this.</li>
<li><strong>Terminal:</strong> While Terminal would launch, using the standard Unix <code>rm</code> command resulted in a similar error: “No space left on device.” All <code>rm</code> alternatives, like using the <code>find</code> command to search for very large unneeded files and adding the <code>-exec</code> option to run the <code>rm</code> command, failed too. Terminal was a bust.</li>
<li><strong>Disk Utility:</strong> Disk Utility shows Time Machine snapshots on APFS startup volumes, and you can typically select and delete these snapshots, which occupy only the amount of storage space required to contain the differences from the previous snapshot. That failed with a “no space left” error as well.</li>
</ul>
<p>It was time to restart to see if it would clear caches. Unfortunately, restarting left the Mac unable to start up at all. No matter what I tried, it would reach about halfway through the progress bar before failing.</p>
<p>I shifted to recoveryOS, Apple’s somewhat new name for the special disk partition in macOS that lets you run operations on the main startup volume while it’s not mounted, including Disk Utility repairs and reinstallation. From there, I hit the wall as well, as Terminal commands continued to fail with the same error.</p>
<p>I restarted again to access the Apple silicon <a href="https://support.apple.com/guide/mac-help/transfer-files-a-mac-apple-silicon-mchlb37e8ca7/mac">Share Disk</a> option to mount my kid’s drive on one of my Macs, hoping that over Samba (the disk-sharing protocol), I’d be able to force a deletion. No dice.</p>
<p>At this point, I shifted to stronger medicine. I had a series of Time Machine backups of their drive, including one from the previous evening, and they weren’t terribly concerned about losing data, as they have most things they care about in some kind of cloud storage. Here’s where things went pear-shaped in an entirely different direction.</p>
<p>First, I erased the drive and used macOS Recovery to reinstall Ventura, the native system with which the MacBook Pro had shipped. I then used Migration Assistant at macOS startup to access the networked Time Machine backup. In choosing what files to restore, I unchecked a number to ensure there would be plenty of storage. My kid had a lot of things they could delete, too, they said, and I could give them the Time Machine backup as a mountable drive if they needed access to files that weren’t restored later.</p>
<p>Halfway through, Ventura stalled and wouldn’t resume. I decided to upgrade to Sonoma, the version of macOS that was running at the time the Mac filled its drive. That worked fine—but the upgrade took the Mac to version 14.4, and my kid had had 14.3.1 installed. When I attempted to restore directly at startup, I was told the version different wouldn’t allow it. Now what?</p>
<p>I completed a basic Sonoma user account setup and then ran Migration Assistant. It found the networked Mac on which I manage Time Machine backups and recognized it. However, it refused to mount my child’s backup volume. No matter what I did, “Mount failed” appeared. Digging around in forums, I found that Sonoma has broken the SMB/Samba-based networking mount procedure for Time Machine restores, and no one had found a solution. This appears to still be the case in 14.4.</p>
<figure><img decoding="async" src="https://i0.wp.com/sixcolors.com/wp-content/uploads/2024/03/disk-snapshots-alyx-6c.png?ssl=1" alt="" data-image-w="" data-image-h="" data-recalc-dims="1"><figcaption>Retrieving a backup image for restoration.</figcaption></figure>
<p>Because my younger only needed their apps and certain files, we both gave up at that point. I copied their Time Machine backup onto an external 1 TB SSD through this straightforward method:</p>
<ol>
<li>On my Mac, which handles networked backups, I double-clicked the disk image for their computer and then entered their Time Machine volume password. (I always set a networked password for Time Machine volumes.)</li>
<li>I found the disk icon with the latest timestamp and copied this to an empty 1 TB drive.</li>
<li>Ejecting it from my Mac, I connected it to their stub account on their MacBook Pro and copied over the necessary files, including the contents of most of their home directory folders, excluding some large downloads and unneeded (ahem) video files.</li>
</ol>
<p>I gave them the drive so that they could restore anything else they needed if it were missing, and we’ll probably keep it on hand for a while to make sure nothing is missing.</p>
<p>This put them back in business, but I missed two tricks that I could have tried to make things easier:</p>
<ul>
<li>I could have unmounted the Time Machine backup drive from my computer I use for other computers on the network. (I have a separate drive I use for local Time Machine backups from that computer’s startup volume.) Then I could have connected that directly to my kid’s computer and it likely would have become available as a Migration Assistant starting point.</li>
<li>Failing that, I could have copied the virtual disk from the Time Machine disk image I mounted on my Mac of their backup so that the external 1 TB drive I was transferring “looked” like a Mac source volume. I’m not sure if this would have worked, but I didn’t try it. Then, I could have potentially restored directly from it using Migration Assistant.</li>
</ul>
<p>I’m sorry I didn’t try the above, but I had already invested a cumulative couple of hours of my time and over a day of effort while my kid was unconcerned about a perfect directory-to-directory recovery.</p>
<p>I hate to think what people without decades of Mac experience do when confronted with systemic, cascading failures like this when I felt helpless despite what I thought I knew and all the answers I searched for and found on forums.</p>
<p>[<em>If you liked this story, consider <a href="https://www.kickstarter.com/projects/glennf/how-comics-were-made">backing Glenn’s latest Kickstarter project</a>, How Comics Were Made: a Visual History of Printing Cartoons.</em>]</p>

<p>[<em><strong><a href="https://glennf.com/">Glenn Fleishman</a></strong> is a Macworld contributor, Jeopardy champion, and serial Kickstarterer. He's currently working on the book <a href="https://howcomicsweremade.ink/">How Comics Were Made</a>.</em>]</p>



	<p><strong>If you appreciate articles like this one, support us by <a href="https://sixcolors.com/subscribe/">becoming a Six Colors subscriber</a>. Subscribers get access to an exclusive podcast, members-only stories, and a special community.</strong></p>

				</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Uv saves Home Assistant 215 compute hours per month (138 pts)]]></title>
            <link>https://developers.home-assistant.io/blog/2024/04/03/build-images-with-uv/</link>
            <guid>39924985</guid>
            <pubDate>Thu, 04 Apr 2024 00:10:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://developers.home-assistant.io/blog/2024/04/03/build-images-with-uv/">https://developers.home-assistant.io/blog/2024/04/03/build-images-with-uv/</a>, See on <a href="https://news.ycombinator.com/item?id=39924985">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="__blog-post-container" itemprop="articleBody"><p>By replacing <code>pip</code> with <code>uv</code> in our production images, our build pipeline (and therefore releasing a new version) is a lot faster.
<code>Uv</code> is an extremely fast Python package installer and resolver written in Rust. It is developed by <a href="https://astral.sh/" target="_blank" rel="noopener noreferrer">Astral</a> and it's open source. Check it out on <a href="https://github.com/astral-sh/uv" target="_blank" rel="noopener noreferrer">GitHub</a>.</p><p>In the following table, you can see that we can save around 5 hours of execution time on each build.</p><table><thead><tr><th>Arch</th><th>Pip</th><th>UV</th><th>Savings</th></tr></thead><tbody><tr><td>aarch64</td><td>1h 24m 53s</td><td>5m 18s</td><td>~1h 20m</td></tr><tr><td>armhf</td><td>1h 52m 20s</td><td>6m 2s</td><td>~1h 46m</td></tr><tr><td>armv7</td><td>1h 26m 43s</td><td>5m 28s</td><td>~1h 21m</td></tr><tr><td>amd64</td><td>22m 10s</td><td>3m 20s</td><td>~19m</td></tr><tr><td>i386</td><td>17m 37s</td><td>3m 11s</td><td>~14m</td></tr></tbody></table><p>On average, we run the build pipeline 43 times as we create</p><ul><li>31 nightlies (one nightly per day)</li><li>7 beta releases</li><li>5 stable releases (including patch ones)</li></ul><p>In total, we save around 215 hours per month.
With this massive improvement, we can now ship hotfixes even faster, as the pipeline to ship a new version now takes around 20 minutes instead of 2.5 hours.</p><p>The 215 monthly saved execution hours can be used by other jobs and make the CI experience for all developers and our community better.
By replacing <code>pip</code> with <code>uv</code>, we improve our sustainability by using fewer resources to build our images.</p><p><strong>A big thank you to Astral for developing this amazing tool.</strong>
Please check out their <a href="https://astral.sh/" target="_blank" rel="noopener noreferrer">website</a> and products as they offer, for example, a "lightning" fast linter/formatter for Python too.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Henry Darger (132 pts)]]></title>
            <link>https://www.moma.org/artists/28600</link>
            <guid>39924574</guid>
            <pubDate>Wed, 03 Apr 2024 23:16:27 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.moma.org/artists/28600">https://www.moma.org/artists/28600</a>, See on <a href="https://news.ycombinator.com/item?id=39924574">Hacker News</a></p>
Couldn't get https://www.moma.org/artists/28600: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Strudel: A live coding platform to write dynamic music pieces in the browser (148 pts)]]></title>
            <link>https://strudel.cc</link>
            <guid>39924210</guid>
            <pubDate>Wed, 03 Apr 2024 22:38:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://strudel.cc">https://strudel.cc</a>, See on <a href="https://news.ycombinator.com/item?id=39924210">Hacker News</a></p>
<div id="readability-page-1" class="page"> <astro-island uid="ZygXRk" component-url="/_astro/Repl.BcaLju3D.js" component-export="Repl" renderer-url="/_astro/client.Du4-pqmH.js" props="{}" ssr="" client="only" opts="{&quot;name&quot;:&quot;Repl&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island> <a rel="me" href="https://social.toplap.org/@strudel" target="_blank">mastodon</a> </div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: I've built a locally running Perplexity clone (598 pts)]]></title>
            <link>https://github.com/nilsherzig/LLocalSearch</link>
            <guid>39923404</guid>
            <pubDate>Wed, 03 Apr 2024 21:27:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/nilsherzig/LLocalSearch">https://github.com/nilsherzig/LLocalSearch</a>, See on <a href="https://news.ycombinator.com/item?id=39923404">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">LLocalSearch</h2><a id="user-content-llocalsearch" aria-label="Permalink: LLocalSearch" href="#llocalsearch"></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">What it is</h2><a id="user-content-what-it-is" aria-label="Permalink: What it is" href="#what-it-is"></a></p>
<p dir="auto">This is a completely locally running search engine using LLM Agents. The user can ask a question and the system will use a chain of LLMs to find the answer. The user can see the progress of the agents and the final answer. No OpenAI or Google API keys are needed.</p>
<p dir="auto">Now with follow-up questions:</p>
<details open="">
  <summary>
    
    <span aria-label="Video description demo.mp4">demo.mp4</span>
    <span></span>
  </summary>

  <video src="https://private-user-images.githubusercontent.com/72463901/319350323-8323be25-de2a-4ddf-853b-4a01557b5599.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTIxOTI3MDUsIm5iZiI6MTcxMjE5MjQwNSwicGF0aCI6Ii83MjQ2MzkwMS8zMTkzNTAzMjMtODMyM2JlMjUtZGUyYS00ZGRmLTg1M2ItNGEwMTU1N2I1NTk5Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDA0VDAxMDAwNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU3NmRjYTc3MTRlZjk0Mzc5ZTk5MTEzODdkYjMzOThiYWEyMGUxYWUxZjZmNmI5NTQ3OGVlYzRiMzY2MGYxZGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Ew8NPFLHelNcrGGZaTEYebj1XcI0fnTZWStUoMwvtKo" data-canonical-src="https://private-user-images.githubusercontent.com/72463901/319350323-8323be25-de2a-4ddf-853b-4a01557b5599.mp4?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTIxOTI3MDUsIm5iZiI6MTcxMjE5MjQwNSwicGF0aCI6Ii83MjQ2MzkwMS8zMTkzNTAzMjMtODMyM2JlMjUtZGUyYS00ZGRmLTg1M2ItNGEwMTU1N2I1NTk5Lm1wND9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDA0VDAxMDAwNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU3NmRjYTc3MTRlZjk0Mzc5ZTk5MTEzODdkYjMzOThiYWEyMGUxYWUxZjZmNmI5NTQ3OGVlYzRiMzY2MGYxZGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Ew8NPFLHelNcrGGZaTEYebj1XcI0fnTZWStUoMwvtKo" controls="controls" muted="muted">

  </video>
</details>

<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://private-user-images.githubusercontent.com/72463901/319160147-9f6497aa-8047-4d11-9a12-66aff65d3faa.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTIxOTI3MDUsIm5iZiI6MTcxMjE5MjQwNSwicGF0aCI6Ii83MjQ2MzkwMS8zMTkxNjAxNDctOWY2NDk3YWEtODA0Ny00ZDExLTlhMTItNjZhZmY2NWQzZmFhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDA0VDAxMDAwNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWMzMjE2OTI2OGRkOTU5MzI1NWQyNmZjZTVhNDgxZjc2YTgxODY1YmQ0OTZhM2IxYWY5YjIwMDY3NTMxN2ZmNGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.ewh2WuFVEUhqvOaNeFhm-ORHOzNTRUKK4sgTRbruO7o"><img src="https://private-user-images.githubusercontent.com/72463901/319160147-9f6497aa-8047-4d11-9a12-66aff65d3faa.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTIxOTI3MDUsIm5iZiI6MTcxMjE5MjQwNSwicGF0aCI6Ii83MjQ2MzkwMS8zMTkxNjAxNDctOWY2NDk3YWEtODA0Ny00ZDExLTlhMTItNjZhZmY2NWQzZmFhLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MDQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDA0VDAxMDAwNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWMzMjE2OTI2OGRkOTU5MzI1NWQyNmZjZTVhNDgxZjc2YTgxODY1YmQ0OTZhM2IxYWY5YjIwMDY3NTMxN2ZmNGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.ewh2WuFVEUhqvOaNeFhm-ORHOzNTRUKK4sgTRbruO7o" alt="image"></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"></a></p>
<ul dir="auto">
<li>🕵️ Completely local (no need for API keys)</li>
<li>💸 Runs on "low end" LLM Hardware (demo video uses a 7b model)</li>
<li>🤓 Progress logs, allowing for a better understanding of the search process</li>
<li>🤔 Follow-up questions</li>
<li>📱 Mobile friendly interface</li>
<li>🚀 Fast and easy to deploy with Docker Compose</li>
<li>🌐 Web interface, allowing for easy access from any device</li>
<li>💮 Handcrafted UI with light and dark mode</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Status</h2><a id="user-content-status" aria-label="Permalink: Status" href="#status"></a></p>
<p dir="auto">This project is still in its very early days. Expect some bugs.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">How it works</h2><a id="user-content-how-it-works" aria-label="Permalink: How it works" href="#how-it-works"></a></p>
<p dir="auto">Please read <a href="https://github.com/nilsherzig/LLocalSearch/issues/17" data-hovercard-type="issue" data-hovercard-url="/nilsherzig/LLocalSearch/issues/17/hovercard">infra</a> to get the most up-to-date idea.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Self-hosting &amp; Development</h2><a id="user-content-self-hosting--development" aria-label="Permalink: Self-hosting &amp; Development" href="#self-hosting--development"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Requirements</h3><a id="user-content-requirements" aria-label="Permalink: Requirements" href="#requirements"></a></p>
<ul dir="auto">
<li>A running <a href="https://ollama.com/" rel="nofollow">Ollama</a> server, reachable from the container
<ul dir="auto">
<li>GPU is not needed, but recommended</li>
</ul>
</li>
<li>Docker Compose</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">Run the latest release</h3><a id="user-content-run-the-latest-release" aria-label="Permalink: Run the latest release" href="#run-the-latest-release"></a></p>
<p dir="auto">Recommended, if you don't intend to develop on this project.</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/nilsherzig/LLocalSearch.git
cd ./LLocalSearch
# 🔴 check the env vars inside the compose file and add your ollama servers host:port
docker-compose up "><pre>git clone https://github.com/nilsherzig/LLocalSearch.git
<span>cd</span> ./LLocalSearch
<span><span>#</span> 🔴 check the env vars inside the compose file and add your ollama servers host:port</span>
docker-compose up </pre></div>
<p dir="auto">🎉 You should now be able to open the web interface on <a href="http://localhost:3000/" rel="nofollow">http://localhost:3000</a>. Nothing else is exposed by default.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Run the current git version</h3><a id="user-content-run-the-current-git-version" aria-label="Permalink: Run the current git version" href="#run-the-current-git-version"></a></p>
<p dir="auto">Newer features, but potentially less stable.</p>
<div dir="auto" data-snippet-clipboard-copy-content="git clone https://github.com/nilsherzig/LLocalsearch.git
# 1. make sure to check the env vars inside the `docker-compose.dev.yaml`.
# 2. Make sure you've really checked the dev compose file not the normal one.

# 3. build the containers and start the services
make dev 
# Both front and backend will hot reload on code changes. "><pre>git clone https://github.com/nilsherzig/LLocalsearch.git
<span><span>#</span> 1. make sure to check the env vars inside the `docker-compose.dev.yaml`.</span>
<span><span>#</span> 2. Make sure you've really checked the dev compose file not the normal one.</span>

<span><span>#</span> 3. build the containers and start the services</span>
make dev 
<span><span>#</span> Both front and backend will hot reload on code changes. </span></pre></div>
<p dir="auto">If you don't have <code>make</code> installed, you can run the commands inside the Makefile manually.</p>
<p dir="auto">Now you should be able to access the frontend on <a href="http://localhost:3000/" rel="nofollow">http://localhost:3000</a>.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Logik: Open-source FPGA toolchain by Zero ASIC (107 pts)]]></title>
            <link>https://github.com/zeroasiccorp/logik</link>
            <guid>39922631</guid>
            <pubDate>Wed, 03 Apr 2024 20:25:58 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/zeroasiccorp/logik">https://github.com/zeroasiccorp/logik</a>, See on <a href="https://news.ycombinator.com/item?id=39922631">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/zeroasiccorp/logik/main/images/logik_logo_with_text.png"><img src="https://raw.githubusercontent.com/zeroasiccorp/logik/main/images/logik_logo_with_text.png" alt="Logik"></a></p>
<p dir="auto"><a href="https://github.com/zeroasiccorp/logik/actions/workflows/regression.yml"><img src="https://github.com/zeroasiccorp/logik/actions/workflows/regression.yml/badge.svg" alt="Regression"></a>
<a href="https://github.com/zeroasiccorp/logik/actions/workflows/lint.yml"><img src="https://github.com/zeroasiccorp/logik/actions/workflows/lint.yml/badge.svg" alt="Lint"></a></p>
<hr>
<p dir="auto">Logik is an open source FPGA toolchain that fully automates converting RTL to bits, including synthesis, placement, routing, bitstream generation, and analysis. Users enter design sources, constraints, and compile options through a simple <a href="https://github.com/siliconcompiler/siliconcompiler/">SiliconCompiler</a> Python API. Once setup is complete, automated compilation can be initiated with a single line run command.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer nofollow" href="https://raw.githubusercontent.com/zeroasiccorp/logik/main/images/logik_flow.svg"><img src="https://raw.githubusercontent.com/zeroasiccorp/logik/main/images/logik_flow.svg" alt="logik_flow"></a></p>
<p dir="auto">Logik supports most of the features you would expect in a commercial proprietary FPGA tool chain.</p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Design languages</td>
<td>Verilog, SystemVerilog, VHDL</td>
</tr>
<tr>
<td>ALU synthesis</td>
<td>Supported</td>
</tr>
<tr>
<td>RAM synthesis</td>
<td>Supported</td>
</tr>
<tr>
<td>Timing constraints (SDC)</td>
<td>Supported</td>
</tr>
<tr>
<td>Pin Constraints (PCF)</td>
<td>Supported</td>
</tr>
<tr>
<td>Bitstream generation</td>
<td>Supported</td>
</tr>
<tr>
<td>IP management</td>
<td>Supported</td>
</tr>
<tr>
<td>Remote compilation</td>
<td>Supported</td>
</tr>
<tr>
<td>Multi-clock designs</td>
<td>In progress</td>
</tr>
<tr>
<td>FPGA devices</td>
<td>ZA</td>
</tr>
</tbody>
</table>
<p dir="auto"><h2 tabindex="-1" dir="auto">Getting Started</h2><a id="user-content-getting-started" aria-label="Permalink: Getting Started" href="#getting-started"></a></p>
<p dir="auto">The Logik project is available through PyPi and can be installed using pip. If you want to run locally on your machine, you will need to <a href="#installation">install all of the pre-requisites</a> or launch the <a href="#running-docker">Logik Docker image</a>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="python -m pip install --upgrade logik"><pre>python -m pip install --upgrade logik</pre></div>
<p dir="auto">The following example illustrate some essential Logik features. For complete documentation of all options available, see the <a href="https://github.com/siliconcompiler/siliconcompiler/blob/main/README.md">SiliconCompiler project</a>.</p>
<div dir="auto" data-snippet-clipboard-copy-content="from siliconcompiler import Chip
from logik.targets import logik_target

def hello_adder():

    # Create compilation object
    chip = Chip('adder')

    # Specify design sources
    chip.input('adder.v')

    # Specify pin constraints
    chip.input('adder.pcf')

    # Compiler options
    chip.set('option', 'quiet', True)
    chip.set('option', 'remote', True)

    # Select target fpga
    chip.set('fpga', 'partname', 'logik_demo')

    # Load target settings
    chip.load_target(logik_target)

    # Run compiler
    chip.run()

    # Display compiler results
    chip.summary()

if __name__ == &quot;__main__&quot;:
    hello_adder()"><pre><span>from</span> <span>siliconcompiler</span> <span>import</span> <span>Chip</span>
<span>from</span> <span>logik</span>.<span>targets</span> <span>import</span> <span>logik_target</span>

<span>def</span> <span>hello_adder</span>():

    <span># Create compilation object</span>
    <span>chip</span> <span>=</span> <span>Chip</span>(<span>'adder'</span>)

    <span># Specify design sources</span>
    <span>chip</span>.<span>input</span>(<span>'adder.v'</span>)

    <span># Specify pin constraints</span>
    <span>chip</span>.<span>input</span>(<span>'adder.pcf'</span>)

    <span># Compiler options</span>
    <span>chip</span>.<span>set</span>(<span>'option'</span>, <span>'quiet'</span>, <span>True</span>)
    <span>chip</span>.<span>set</span>(<span>'option'</span>, <span>'remote'</span>, <span>True</span>)

    <span># Select target fpga</span>
    <span>chip</span>.<span>set</span>(<span>'fpga'</span>, <span>'partname'</span>, <span>'logik_demo'</span>)

    <span># Load target settings</span>
    <span>chip</span>.<span>load_target</span>(<span>logik_target</span>)

    <span># Run compiler</span>
    <span>chip</span>.<span>run</span>()

    <span># Display compiler results</span>
    <span>chip</span>.<span>summary</span>()

<span>if</span> <span>__name__</span> <span>==</span> <span>"__main__"</span>:
    <span>hello_adder</span>()</pre></div>
<p dir="auto">This code can be run with <code>./adder.py -remote</code> in the <a href="https://github.com/zeroasiccorp/logik/blob/main/examples/adder">examples/adder</a> directory, resulting in an FPGA bitstream at <code>build/adder/job0/convert_bitstream/0/outputs/adder.bin</code>.</p>
<p dir="auto">To test out the generated bitstream, you can upload it to an emulated FPGA device running in the Zero ASIC <a href="https://www.zeroasic.com/emulation?demo=fpga" rel="nofollow">Digital Twin Platform</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">More Examples</h2><a id="user-content-more-examples" aria-label="Permalink: More Examples" href="#more-examples"></a></p>
<ul dir="auto">
<li><a href="https://github.com/zeroasiccorp/logik/blob/main/examples/umi_hello">UMI "Hello World"</a></li>
<li><a href="https://github.com/zeroasiccorp/logik/blob/main/examples/umi_fir_filter">UMI FIR Filter</a></li>
<li><a href="https://github.com/zeroasiccorp/logik/blob/main/examples/ebrick_demo_fpga">EBRICK demo</a></li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Documentation</h2><a id="user-content-documentation" aria-label="Permalink: Documentation" href="#documentation"></a></p>
<ul dir="auto">
<li><a href="https://logik.readthedocs.io/en/latest/" rel="nofollow">Logik Documentation</a></li>
<li><a href="https://docs.siliconcompiler.com/en/stable/" rel="nofollow">SiliconCompiler Documentation</a></li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Installation</h2><a id="user-content-installation" aria-label="Permalink: Installation" href="#installation"></a></p>
<p dir="auto">Logik is available as wheel packages on PyPI for macOS, Windows and Linux platforms. For a Python 3.8-3.12 environment, just use pip to install.</p>
<div dir="auto" data-snippet-clipboard-copy-content="python -m pip install --upgrade logik"><pre>python -m pip install --upgrade logik</pre></div>
<p dir="auto">Running natively on your local machine will require installing a number of prerequisites:</p>
<ul dir="auto">
<li><a href="https://github.com/siliconcompiler/siliconcompiler">Silicon Compiler</a>: Hardware compiler framework</li>
<li><a href="https://github.com/YosysHQ/yosys">Yosys</a>: Logic synthesis</li>
<li><a href="https://github.com/verilog-to-routing/vtr-verilog-to-routing">VPR</a>: FPGA place and route</li>
<li><a href="https://ghdl.github.io/ghdl/" rel="nofollow">GHDL</a>: VHDL parser</li>
<li><a href="https://github.com/chipsalliance/Surelog">Surelog</a>: SystemVerilog parser</li>
<li><a href="https://github.com/chipsalliance/fasm">FASM</a>: FPGA assembly parser and generator</li>
</ul>
<p dir="auto">Automated Ubuntu based install scripts are included for convenience within the SiliconCompiler project. Detailed instructions for installing all tools can be found in the <a href="https://docs.siliconcompiler.com/en/stable/user_guide/installation.html#external-tools" rel="nofollow">SiliconCompiler Installation Guide</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Running Docker</h2><a id="user-content-running-docker" aria-label="Permalink: Running Docker" href="#running-docker"></a></p>
<p dir="auto">A <a href="https://github.com/siliconcompiler/siliconcompiler/pkgs/container/sc_runner">Docker image</a> is provided for users who wish to avoid the installation of the pre-requisite tools. The following command starts a new container from that image and maps the local directory <code>sc_work</code> to the path <code>/sc_work</code> in the container.</p>
<div dir="auto" data-snippet-clipboard-copy-content="docker run -it -v &quot;${PWD}/sc_work:/sc_work&quot; ghcr.io/siliconcompiler/sc_runner:latest"><pre>docker run -it -v <span><span>"</span><span>${PWD}</span>/sc_work:/sc_work<span>"</span></span> ghcr.io/siliconcompiler/sc_runner:latest</pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto"><a href="https://github.com/zeroasiccorp/logik/blob/main/LICENSE">MIT</a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Issues / Bugs</h2><a id="user-content-issues--bugs" aria-label="Permalink: Issues / Bugs" href="#issues--bugs"></a></p>
<p dir="auto">We use <a href="https://github.com/zeroasiccorp/logik/issues">GitHub Issues</a> for tracking requests and bugs.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Terraform makes carbon neutral natural gas (370 pts)]]></title>
            <link>https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/</link>
            <guid>39922006</guid>
            <pubDate>Wed, 03 Apr 2024 19:35:00 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/">https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/</a>, See on <a href="https://news.ycombinator.com/item?id=39922006">Hacker News</a></p>
<div id="readability-page-1" class="page"><article id="post-224">
	<!-- .entry-header -->

	<div>
		
<p>We did it! After two years of hard work we hold in our hands hard proof that the incredible team at Terraform can make synthetic natural gas from sunlight and air, as <a href="https://techcrunch.com/2024/04/01/terraform-industries-converted-electricity-and-air-into-synthetic-natural-gas/">reported in TechCrunch</a>.</p>



<figure><img data-attachment-id="227" data-permalink="https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/image-1-4/" data-orig-file="https://terraformindustries.files.wordpress.com/2024/03/image-1.png" data-orig-size="1243,829" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-1" data-image-description="" data-image-caption="" data-medium-file="https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=300" data-large-file="https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=720" width="1024" height="682" src="https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=1024" alt="" srcset="https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=1024 1024w, https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=150 150w, https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=300 300w, https://terraformindustries.files.wordpress.com/2024/03/image-1.png?w=768 768w, https://terraformindustries.files.wordpress.com/2024/03/image-1.png 1243w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Last Wednesday March 27, 2024, we commissioned our integrated power-to-gas demonstrator. The system converts electricity and air into affordable fossil-free natural gas using proprietary subsystems, developed in-house, for hydrogen electrolysis, direct air capture, and methanation. This marks a major milestone in the technical and commercial development of our technology and another step on the path to our positive vision for the future where everyone has access to plentiful cheap, reliable energy, harvested from renewable carbon and power, with lower ecological and climate impact.</p>



<figure><img data-attachment-id="235" data-permalink="https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/image-5-3/" data-orig-file="https://terraformindustries.files.wordpress.com/2024/03/image-5.png" data-orig-size="1732,1065" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-5" data-image-description="" data-image-caption="" data-medium-file="https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=300" data-large-file="https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=720" width="1024" height="629" src="https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=1024" alt="" srcset="https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=1024 1024w, https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=150 150w, https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=300 300w, https://terraformindustries.files.wordpress.com/2024/03/image-5.png?w=768 768w, https://terraformindustries.files.wordpress.com/2024/03/image-5.png 1732w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Our core innovation is the utilization of proven and well-understood industrial processes implemented within innovatively simple and cost-effective proprietary technology systems adapted to the daily variations of renewable power for producing cheap sustainable natural gas from sunlight and air. These design and process innovations are responsible for driving production costs down for both their green hydrogen and atmospheric CO2 capture to levels previously thought unattainable. Combining super-cheap solar power with low-cost green hydrogen and CO2 capture are the key to producing commodity-grade electro-fuel alternatives at competitive commodity prices.</p>



<p>Our elite team of engineers have made significant progress towards our <a href="https://terraformindustries.wordpress.com/2022/07/24/terraform-industries-whitepaper/">stated goals</a> of <a href="https://terraformindustries.wordpress.com/2023/08/16/how-to-produce-green-hydrogen-for-1-kg/">radically cheaper green hydrogen</a> and direct air capture CO2. We follow a simple playbook. Adapt a known industrial process to ultra-cheap solar power by a) radically reducing capex to compensate for lowered utilization and b) developing processes that are robust to variations in power due to weather, as well as diurnal and seasonal power shifts. </p>



<p>First, our innovative electrolyzer converts cheap solar power into hydrogen with current production costs at less than $2.50 per kg of H2. How? To first order, our electrolyzer capex costs &lt;$100/kW, and we’re currently baselining solar PV DC electricity at $20/MWh. There is no hand waving about economies of scale or subsidies here, though we are eligible for the full IRA 45V green hydrogen tax credit, worth $3/kg-H2.</p>



<figure><img data-attachment-id="231" data-permalink="https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/image-3-3/" data-orig-file="https://terraformindustries.files.wordpress.com/2024/03/image-3.png" data-orig-size="1243,833" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-3" data-image-description="" data-image-caption="" data-medium-file="https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=300" data-large-file="https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=720" width="1024" height="686" src="https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=1024" alt="" srcset="https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=1024 1024w, https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=150 150w, https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=300 300w, https://terraformindustries.files.wordpress.com/2024/03/image-3.png?w=768 768w, https://terraformindustries.files.wordpress.com/2024/03/image-3.png 1243w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Second, the proprietary direct air capture (DAC) system concentrates CO2 in the atmosphere today for less than $250 per ton. How? Our DAC capex costs &lt;$600/T-year-CO2. Like the electrolyzer, this represents a substantial improvement on the state of the art. </p>



<figure><img data-attachment-id="230" data-permalink="https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/image-2-5/" data-orig-file="https://terraformindustries.files.wordpress.com/2024/03/image-2.png" data-orig-size="1243,1131" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-2" data-image-description="" data-image-caption="" data-medium-file="https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=300" data-large-file="https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=720" loading="lazy" width="1024" height="931" src="https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=1024" alt="" srcset="https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=1024 1024w, https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=150 150w, https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=300 300w, https://terraformindustries.files.wordpress.com/2024/03/image-2.png?w=768 768w, https://terraformindustries.files.wordpress.com/2024/03/image-2.png 1243w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>Finally, our in-house multistage Sabatier chemical reactor ingests hydrogen and CO2, producing pipeline grade natural gas, which is &gt;97% methane (CH4). Our reactor uses no rare or expensive catalysts nor cherry-picked data – it handily operates for hours in steady state. </p>



<figure><img data-attachment-id="232" data-permalink="https://terraformindustries.wordpress.com/2024/04/01/terraform-makes-carbon-neutral-natural-gas/image-4-3/" data-orig-file="https://terraformindustries.files.wordpress.com/2024/03/image-4.png" data-orig-size="1243,831" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="image-4" data-image-description="" data-image-caption="" data-medium-file="https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=300" data-large-file="https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=720" loading="lazy" width="1024" height="684" src="https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=1024" alt="" srcset="https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=1024 1024w, https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=150 150w, https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=300 300w, https://terraformindustries.files.wordpress.com/2024/03/image-4.png?w=768 768w, https://terraformindustries.files.wordpress.com/2024/03/image-4.png 1243w" sizes="(max-width: 1024px) 100vw, 1024px"></figure>



<p>The <a href="https://terraformindustries.wordpress.com/2023/06/26/the-terraformer-mark-one/">Terraformer combines these three subsystems into one modular chemical plant</a>, skid-mounted for deployment alongside a solar PV array.</p>



<p><img src="https://lh7-us.googleusercontent.com/02lIRpIYWSiyqD9_Y0Qmp6NCgH4EON-JADudHwRvHC3GCnWb6shToLkUM74ahZHA0uKRkbXsRL_IqxsNIZ8HCmYoHOBBFf-LF-6cmE19bd1mP_6rjqGJThH9jDt6O1LochHxs1arX3zYrgxyOqBQzLQ" width="624" height="391"></p>



<p>It is particularly cool to develop and build all three of our sub-systems in our castle in Burbank, CA, right across from the long-time home of the fabled <a href="https://en.wikipedia.org/wiki/Skunk_Works">Lockheed Skunk Works</a>. In-house production &amp; manufacturing enables faster iteration, lowered supply chain risk, and the successful demonstration of the complete techno-economic model for producing cost-effective fossil-free natural gas.</p>



<p>While I generally prefer understatement, it is hard to overstate the significance of this achievement, which has been two years in the making. Humanity today depends on traditional oil and gas to provide them with a cheap and easily transportable source of energy-dense hydrocarbons, to the tune of 100 million barrels per day, which unfortunately also generates ~50 gigatons per year of CO2 emissions. </p>



<p>The Terraformer unlocks an industrial-scale source of renewable hydrocarbons that breaks our dependence on fossil fuels and lays the foundation for another century of spectacular growth, broad-based wealth creation, and global environmental restoration.</p>



<p>What’s next? We’re taking reservations for our first production Terraformers, and ramping production to meet demand. </p>
			</div><!-- .entry-content -->

	<!-- .entry-footer -->
</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[MOnSter 6502: a working transistor-scale replica of the classic MOS 6502 (208 pts)]]></title>
            <link>https://monster6502.com/</link>
            <guid>39921964</guid>
            <pubDate>Wed, 03 Apr 2024 19:31:38 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://monster6502.com/">https://monster6502.com/</a>, See on <a href="https://news.ycombinator.com/item?id=39921964">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="wrapper">
	
<center>
<!--
<a href="https://monster6502.com/"><img 
src="https://cdn.evilmadscientist.com/sites/6502/images/A1_1.jpg" width="900" height="600"
alt="MOnSter 6502 (First prototype)" 
title="MOnSter 6502 (First prototype)" /></a>
-->


<a href="https://monster6502.com/"><img src="https://cdn.evilmadscientist.com/sites/6502/images/B1_1800x1350.jpg" width="900" height="675" alt="MOnSter 6502 in enclosure" title="MOnSter 6502 in enclosure"></a>



</center>
<p>
A <i>dis-integrated</i> circuit project to make a complete, working transistor-scale replica of the classic <a href="https://en.wikipedia.org/wiki/MOS_Technology_6502">MOS 6502</a> microprocessor. 

</p><h2 id="video">Video</h2>
<center>
<iframe src="https://player.vimeo.com/video/217483777" width="900" height="506" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
</center>



<h2>FAQ</h2>

<h4>Sixty-Five-Oh-What?</h4><p>

The 6502 is the famous processor found at the core of such influential computer systems as the Apple ][, the Commodore PET, the Atari 400 and 800 home video game consoles, the BBC Micro, and the Tamagotchi digital pet. Slight variations of it were found in the Commodore 64, the Atari 2600, and the original Nintendo Entertainment System.


</p><center>
<img src="https://cdn.evilmadscientist.com/sites/6502/images/A1_3.jpg" width="900" height="675" alt="MOnSter 6502 (with friends)" title="MOnSter 6502 (with friends)">
</center>


<h4>What's with the name and capitalization?</h4><p>

MOnSter 6502 is a play on the original manufacturer and device name (MOS 6502) as well as acknowledging its large size.


</p><h4>How big is it?</h4><p>
It's a four layer circuit board, 12 × 15 inches, 0.1 inches thick, with surface mount components on both sides.


</p><h4>How many components are there on the board?</h4><p>

In total, there are 4769 components on the board. There are 3218 transistors and 1019 resistors that comprise the "functional" part of the 6502. 
In addition to these, there are also LEDs sprinkled throughout that indicate the values of various control lines, registers, and status bits, as well as additional transistors and resistors (not counted in those "functional" totals) that are necessary to drive those LEDs.
</p><p>

As of the second revision of the board, the design statistics are as follows:
</p><ul>
<li>Components that correspond 1:1 with transistors in the original 6502:
<ul>
<li>Total active transistors: 4237</li>
<ul><li>3218 enhancement mode n-channel MOSFETs
<ul><li>2588 discrete</li>
<li>630 located on 164 quad transistor array chips (26 of these 656 transistors are not used)</li>
</ul></li>
<li>1019 resistors (the original 6502 used depletion mode MOSFETs in place of resistors)</li>
</ul></ul></li>

<li>998 Additional parts present only in the MOnSter 6502:
<ul>
<li>313 LEDs (The first revision board, shown in the video, has only 167 LEDs)</li>
<li>270 extra MOSFETs for driving the LEDs</li>
<li>20 filter capacitors</li>
<li>32 bus capacitors</li>
<li>2 zero-ohm jumpers for net tie reasons</li>
<li>8 current limit resistors</li>
<li>314 resistors for the LEDs</li>
<li>36 diodes for ESD protection</li>
<li>2 jacks for 5 V power: main and alternate location</li>
<li>1 rectangular connector for the 40-pin "ICR" ribbon cable</li>

</ul></li>
<li>Total parts: 4769</li>
</ul>


<h4>Are you nuts?</h4><p>
Probably. 

</p><center>
<img src="https://cdn.evilmadscientist.com/sites/6502/images/A1_4.jpg" width="900" height="506.5" alt="MOnSter 6502 (close-up)" title="MOnSter 6502 (close-up)">
</center>


<h4>What is the current status of the project?</h4><p>

Headed towards a full public launch; delayed a bit by COVID.

</p><p>
The first full-scale prototype was publicly demonstrated at the <a href="http://makerfaire.com/maker/entry/55149/">2016 Bay Area Maker Faire</a>. We brought it up to the stages of successfully running various programs in assembly,  <a href="https://twitter.com/TubeTimeUS/status/739639901826605056">BASIC</a>, and <a href="https://twitter.com/TubeTimeUS/status/828098079962210304">Forth</a>. Our second prototype, a year later, fixed a few issues that we encountered when bringing up the first version (removing all of the patch wires) but also added over 100 additional LEDs, including one for every instruction decode line on the 6502's decode ROM.

</p><p>
Since the 6502 is just a microprocessor (CPU), about half of our work on the project (and most of our work since the first prototype) has actually been building up the capabilities around this processor — adding interfaces for a keyboard, <a href="https://twitter.com/TubeTimeUS/status/771131509784719361">monitor</a>, and programming — so that you can actually use it. In the process of doing so, we have built up a single-board computer (a tiny motherboard) that uses the 6502 as its CPU, such that you can either use a socketed (vintage) 6502 IC, or the MOnSter 6502 through a cable. 
</p><p>
More, we have been working towards a public launch, currently planned for mid-2023, building the MOnSter into <a href="https://www.evilmadscientist.com/2019/monster-in-a-box/">a shadowbox 
enclosure</a> complete with a tiny hidden "motherboard" that the CPU sits in, so that it can run demonstration programs even without being plugged into a separate computer.


</p><h4>Does it run at the full speed of an original 6502 chip?</h4><p>
No; it's relatively slow. The MOnSter 6502 runs at about 1/20th the speed of the original, thanks to the much larger capacitance of the design. The maximum reliable clock rate is around 50 kHz. The primary limit to the clock speed is the gate capacitance of the MOSFETs that we are using, which is much larger than the capacitance of the MOSFETs on an original 6502 die.


</p><h4>Can you hook it up inside an Apple ][ and run Oregon Trail?</h4><p>
No, not directly. It's neat to think of plugging the MOnSter 6502's <del>in-circuit emulator (ICE)</del> in-circuit replica (ICR) cable directly into a socket inside an Apple ][, but that wouldn't actually work. The Apple ][ design relies on a number of clever tricks that derive timing for video generation and peripheral control from the main clock signal — all of which will fail if you need to run at a slower speed.
</p><p>
There are some ways to get around limitations like these. For example, the <a href="http://www.brielcomputers.com/wordpress/?cat=17">Replica I</a> computer (an Apple I clone) uses a Parallax Propeller chip to emulate a system clock and some of the timing-dependent external processing. The <a href="http://www.8bitforce.com/projects/retroshield/">RetroShield</a> 6502 is another example of a software-implemented Apple I compatible that can use a hardware 6502 processor. We are most excited about the new <a href="http://apple1.smartykit.org/">SmartyKit Apple I replica</a>, which is specifically designed to run at a slower clock speed. You should also be able to put a slower clock into <a href="https://eater.net/6502">Ben Eater's 6502 computer</a> in order to "plug in" the MOnSter.


</p><h4>So what can it do?</h4><p>
It can act as an in-circuit hardware emulator for a 6502 integrated circuit, in any circuit that can run at a relatively low clock rate. We're currently running it on a custom 6502 development board (the single-board computer that we mentioned earlier) and doing things like running running BASIC, much as you would on an Apple ][. We have also plugged it into the CPU sockets of a few people's homebrew 6502 computers (including the <a href="http://commodorez.com/cactus.html">Cactus</a> and <a href="http://www.8bitforce.com/projects/retroshield/">RetroShield 6502</a>) that could run at variable clock speed. We are interested in finding other applications where it could be substituted for an original 6502.


</p><h4>How long did it take?</h4><p>
This has been a ~8 year project, thus far. The primary design work was done over six months, from <a href="https://twitter.com/TubeTimeUS/status/617108015091548160">July 3</a> to <a href="https://twitter.com/TubeTimeUS/status/671934447168557056">December 1</a>, 2015. There have been several stages of reviews and revisions since then, and a few generations of the "motherboards" that we have run the MOnSter in.



</p><h4>Is it truly a "discrete 6502?"</h4><p>
Not in the strictest sense. However, it really depends upon how picky you would like to be. 
</p><p>
The MOnSter 6502 uses the original dynamic <a href="https://en.wikipedia.org/wiki/NMOS_logic">NMOS logic</a> design, implemented at the individual transistor level. 
</p><p>
Dynamic NMOS requires a large number of "transmission gate" transistors that are used to switch currents. For various technical reasons, only a 4-terminal MOSFET can make an effective NMOS transmission gate. Unfortunately, individually packaged 4-terminal MOSFETs are no longer commercially available. However, they do still make arrays of 2 or 4 MOSFETs on a single chip with a separate substrate pin. We used the 4-pack version — These are the quad transistor array chips that we mentioned earlier. 
</p><p>
Because these transistors do share a pin, there are (strictly speaking) integrated circuits in the MOnSter 6502. However, one might credibly argue that it is a discrete transistor design since there are not (for example) any logic gate chips in the circuit.


</p><h4>What are those little gold squares around the border?</h4><p>

The 40 square pads around the edge of the circuit board correspond to the 40 pins of the original 6502 integrated circuit. They're also designed to look like the wire-bond contact pads on an IC die — where the IC would be physically connected inside (for example) a 40-pin DIP package. These pads are functional contact points on the MOnSter 6502; you can hook up to them with alligator clips to probe or communicate with any pin.


</p><h4>How much power does it draw?</h4><p>

It draws up to roughly 2 A at 5 V, or 10 W total. The LEDs are a significant part of the power consumption.


</p><p>

<a href="https://monster6502.com/"><img src="https://cdn.evilmadscientist.com/sites/6502/images/B2_1800x1090.jpg" width="900" height="545" alt="MOnSter 6502 in enclosure" title="MOnSter 6502 in enclosure"></a>

</p>

<h4>Can I see it in person?</h4><p>

Due to the ongoing pandemic we haven't been taking the MOnSter to shows lately, but you can come visit us <i>by appointment</i> at Evil Mad Scientist Laboratories in Sunnyvale California for a demonstration. Please <a href="https://shop.evilmadscientist.com/contact">use our contact form</a> to ask about available demonstration times.

</p><h4>How big is the MOnSter 6502 compared to the original 6502 die?</h4><p>
The original device was <a href="https://en.wikipedia.org/wiki/MOS_Technology_6502#Technical_description">153 × 168 mils (3.9 × 4.3 mm) or an area of 16.6 square mm</a>. Given that ours is 12 × 15 inches, that makes it about 7000 times actual size. 

</p><h4>How big would the MOnSter 6502 be if it were made with through-hole parts instead of surface mount parts?</h4><p>
About 19 square feet (1.7 square meters).


</p><h4>How big would a <a href="https://en.wikipedia.org/wiki/Motorola_68000">68000 microprocessor</a> be at the scale of the MOnSter 6502?</h4><p>
Also about 19 square feet (1.7 square meters).

</p><h4>Are you going to make a 68000 next?</h4><p>
No.


</p><h4>How big would a modern CPU be at this scale?</h4><p>
The <a href="https://en.wikipedia.org/wiki/Apple_A8X">Apple A8X</a>, found in the iPad Air 2, contains about 3 billion transistors. (This is comparable to the number of transistors in modern desktop computer CPUs as well.) At the scale of the MOnSter 6502, that would take about 885,000 square feet (over 20 acres or 8 hectares) — an area about 940 ft (286 m) square.


</p><h4>Are you going to make a dis-integrated modern CPU next?</h4><p>
No.

</p><h4>Are you going to make one out of vacuum tubes next?</h4><p>
No. 

</p><h4>Are you going to make one out of relays next?</h4><p>
No. (Aren't we already doing enough to fight Moore's law?)


</p><h4>Can I buy one?</h4><p>
Hopefully in the near future! We are working towards a public launch, currently planned for Mid 2023; please <a href="http://eepurl.com/b1EhyX">Sign up for our mailing list</a> if you would like to receive updates as we get further along.



</p><h4>Is it expensive?</h4><p>
It is definitely not cheap to make one of these. We are currently estimating the cost at between $2k - $4k.
While the circuit board itself is large and a little bit expensive, the cost is actually dominated by the
component and assembly costs of an extremely large number of tiny components, most of which are individually
not that expensive. Add to that the setup and test costs of building complex things like these in small batches,
and you can immediately see how it adds up.


</p><h4>Is there going to be a soldering kit version of this?</h4><p>
No. (But on the other hand, "Anything is a soldering kit if you're brave enough!")

</p><h2>Credits</h2><p>
The MOnSter 6502 is a continuing work in progress, designed by <a href="http://tubetime.us/">Eric Schlaepfer</a>, in collaboration with <a href="https://www.evilmadscientist.com/">Evil Mad Scientist Laboratories</a>. Together, we're the folks that brought you the "<a href="https://shop.evilmadscientist.com/tinykitlist/652">Three Fives</a>" discrete 555 timer, the <a href="https://shop.evilmadscientist.com/tinykitlist/762">XL741</a> discrete 741 op-amp, and the book <a href="https://opencircuitsbook.com/">Open Circuits</a>.
</p><p>
Special thanks to <a href="http://www.righto.com/">Ken Shirriff</a>, <a href="http://visual6502.org/">visual6502.org</a>, Chuck Peddle, and <a href="http://www.bunniestudios.com/">Bunnie Huang</a>.


</p><h2>Stay up to date!</h2><p>
Please <a href="http://eepurl.com/b1EhyX">join our mailing list</a> for occasional future updates.
</p></div></div>]]></description>
        </item>
    </channel>
</rss>