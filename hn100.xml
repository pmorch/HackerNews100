(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
(ignoring known css parsing error)
<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Tue, 05 Nov 2024 22:30:02 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Fisker EVs Hired an IT Spy Who Funneled Millions to N. Korea's Missile Program (115 pts)]]></title>
            <link>https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi</link>
            <guid>42054791</guid>
            <pubDate>Tue, 05 Nov 2024 20:16:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi">https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi</a>, See on <a href="https://news.ycombinator.com/item?id=42054791">Hacker News</a></p>
<div id="readability-page-1" class="page"><p>
    <strong><span>Follow us today...</span></strong>
    <a href="https://www.facebook.com/sharer.php?u=https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi" target="_blank">
      <img src="https://www.torquenews.com/profiles/torquenews/facebook.png" loading="lazy" width="64" height="64" alt="Facebook icon">
    </a>&nbsp;
    <a href="https://x.com/share?text=Fisker+EVs+Hired+An+IT+Spy+Who+Funneled+Millions+To+North+Korea%E2%80%99s+Missile+Program%2C+CEO+Henrik+Fisker%2C+Says+%E2%80%9CThe+Case+Is+With+the+FBI%E2%80%9D%20-%C2%A0via%C2%A0@torquenewsauto&amp;url=https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi">
      <img src="https://www.torquenews.com/profiles/torquenews/x.png" loading="lazy" width="64" height="64" alt="X icon">
    </a>&nbsp;
    <a href="https://t.me/teslaev" target="_blank" title="Join us on Telegram!">
      <img src="https://www.torquenews.com/profiles/torquenews/telegram.png" loading="lazy" width="64" height="64" alt="Telegram icon">
    </a>&nbsp;
    <a href="https://www.reddit.com/submit?url=https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi&amp;title=Fisker+EVs+Hired+An+IT+Spy+Who+Funneled+Millions+To+North+Korea%E2%80%99s+Missile+Program%2C+CEO+Henrik+Fisker%2C+Says+%E2%80%9CThe+Case+Is+With+the+FBI%E2%80%9D" target="_blank" title="Join us on Reddit!">
      <img src="https://www.torquenews.com/profiles/torquenews/reddit.png" loading="lazy" width="64" height="64" alt="Reddit icon">
    </a>
  </p><div><p>Welcome to the shocking world of automotive espionage.&nbsp;</p>
<p>It appears North Korea is targeting U.S. automakers. A report from <a href="https://www.autonews.com/manufacturing/an-fisker-hired-north-korean-spy/" target="_blank">Automotive News</a> (by subscription) reveals that <a href="https://www.torquenews.com/fisker" target="_blank">Fisker Inc.</a>, the <a href="https://www.fiskerinc.com/" target="_blank">Ocean SUV electric car</a> manufacturer located in Manhattan Beach, California, hired an IT worker who was a spy for the North Korean government to steal money for its missile program.&nbsp;</p>
<blockquote><p>
AN says, "A remote information technology employee hired by&nbsp;Fisker Inc.&nbsp;turned out to be a spy for the North Korean government."
</p></blockquote>
<p>North Korea targeted Fisker and other automakers.</p>
<p>The report from the Danish magazine The Engineer said Fisker was among numerous U.S. automobile companies targeted by a money laundering scheme that funneled more than a staggering $6 million to North Korea's ballistic missile program.</p>
<blockquote><p>
AN says, "The story, based on documents filed by the U.S. Department of Justice, says Fisker hired a remote IT worker named Kou Thao in October 2021. But Thao's purported address in Arizona belonged to a woman named Christina Chapman, who set up laptop computers that the North Koreans accessed through Russia and China."
</p></blockquote>
<p>Fisker filed for bankruptcy shortly after firing the spy.&nbsp;</p>
<p>Fisker terminated Thao in September 2023 after the Justice Department notified the electric vehicle maker that it was being scammed. The financial strain caused by the espionage activities could have led to <a href="https://www.reuters.com/business/autos-transportation/ev-startup-fisker-files-bankruptcy-2024-06-18/" target="_blank">Fisker&nbsp;filing for bankruptcy</a>&nbsp;nine months later, in June 2024.</p>
<p>The report says Fisker wasn't the only automaker targeted by the spy. The Justice Department's April indictment of Chapman identifies one of her co-conspirators as "Frank C.," a contractor who worked for "a Fortune 500 iconic American automotive manufacturer located in Detroit, Michigan," starting in April 2022.&nbsp;</p>
<p>The Justice Department document doesn't name the company. Two American Fortune 500 automakers are in Detroit, Michigan: General Motors and Ford Motor Company.&nbsp;</p>
<p>The <a href="https://www.wsj.com/tech/north-korean-spies-are-infiltrating-u-s-companies-through-it-jobs-e45a1be8" target="_blank">Wall Street Journal</a> (by subscription) report says that North Korean spies are infiltrating U.S. companies through IT jobs, and companies unknowingly hire North Koreans for hundreds of low-level jobs, "giving Pyongyang access to cash and IP."</p>
<p>The FBI is aware of the problem.</p>
<p>The FBI warned companies about North Korea's highly tailored, difficult-to-detect social engineering campaigns against employees of decentralized finance ("DeFi"), cryptocurrency, and similar businesses to deploy malware and steal company cryptocurrency.</p>
<p>The FBI issued this public service announcement on September 3, 2024.</p>
<p><em>The Democratic People's Republic of Korea ("DPRK" aka North Korea) is conducting highly tailored, difficult-to-detect social engineering campaigns against employees of decentralized finance ("DeFi"), cryptocurrency, and similar businesses to deploy malware and steal company cryptocurrency.</em></p>
<p><em>North Korean social engineering schemes are not just complex, but also elaborate, often compromising victims with sophisticated technical acumen. Given the scale and persistence of this malicious activity, even those well-versed in cybersecurity practices can be vulnerable to North Korea's determination to compromise networks connected to cryptocurrency assets.</em></p>
<p><em>North Korean malicious cyber actors researched various targets connected to cryptocurrency exchange-traded funds (ETFs) over the last several months. This research included pre-operational preparations suggesting North Korean actors may attempt malicious cyber activities against companies associated with cryptocurrency ETFs or other cryptocurrency-related financial products.</em></p>
<p><em>For companies active in or associated with the cryptocurrency sector, the FBI emphasizes North Korea employs sophisticated tactics to steal cryptocurrency funds. It is a persistent threat to organizations with access to large quantities of cryptocurrency-related assets or products.</em></p>
<p>Regarding it being a target of a North Korean spy, CEO Henrik Fisker told The Engineer that the case "is with the FBI" and declined to comment further.</p>
<p>I am&nbsp;<a href="https://www.torquenews.com/users/denis-flierl" target="_blank">Denis Flierl</a>, a Senior Torque News Writer since 2012. I’ve invested over 13 years in the automotive industry in a consulting role, working with every major car brand. I am an experienced Rocky Mountain Automotive Press member. You'll find my expert Subaru analysis <a href="https://www.torquenews.com/subaru" target="_blank">here</a>. Follow me on my X&nbsp;<a href="https://twitter.com/SubaruReport" target="_blank"><strong>SubaruReport</strong></a><strong>,&nbsp;</strong><a href="https://twitter.com/AllSubaru" target="_blank"><strong>All&nbsp;Subaru</strong></a><strong>, </strong><a href="https://twitter.com/WRX_STI_News" target="_blank"><strong>WRXSTI</strong></a>, <a href="https://twitter.com/DenisFlierl" target="_blank"><strong>@DenisFlierl</strong></a>,&nbsp;<a href="https://www.facebook.com/SubaruReport" target="_blank">Facebook</a>, and&nbsp;<a href="https://www.instagram.com/subaru.report/" target="_blank">Instagram</a>.</p>
<p>Photo credit: Denis Flierl via Fisker Inc.</p>
</div><p>
    <strong><span>Follow us today...</span></strong>
    <a href="https://www.facebook.com/sharer.php?u=https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi" target="_blank">
      <img src="https://www.torquenews.com/profiles/torquenews/facebook.png" loading="lazy" width="64" height="64" alt="Facebook icon">
    </a>&nbsp;
    <a href="https://x.com/share?text=Fisker+EVs+Hired+An+IT+Spy+Who+Funneled+Millions+To+North+Korea%E2%80%99s+Missile+Program%2C+CEO+Henrik+Fisker%2C+Says+%E2%80%9CThe+Case+Is+With+the+FBI%E2%80%9D%20-%C2%A0via%C2%A0@torquenewsauto&amp;url=https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi">
      <img src="https://www.torquenews.com/profiles/torquenews/x.png" loading="lazy" width="64" height="64" alt="X icon">
    </a>&nbsp;
    <a href="https://t.me/teslaev" target="_blank" title="Join us on Telegram!">
      <img src="https://www.torquenews.com/profiles/torquenews/telegram.png" loading="lazy" width="64" height="64" alt="Telegram icon">
    </a>&nbsp;
    <a href="https://www.reddit.com/submit?url=https://www.torquenews.com/1084/fisker-evs-hired-it-spy-who-funneled-millions-north-koreas-missile-program-case-fbi&amp;title=Fisker+EVs+Hired+An+IT+Spy+Who+Funneled+Millions+To+North+Korea%E2%80%99s+Missile+Program%2C+CEO+Henrik+Fisker%2C+Says+%E2%80%9CThe+Case+Is+With+the+FBI%E2%80%9D" target="_blank" title="Join us on Reddit!">
      <img src="https://www.torquenews.com/profiles/torquenews/reddit.png" loading="lazy" width="64" height="64" alt="Reddit icon">
    </a>
  </p></div>]]></description>
        </item>
        <item>
            <title><![CDATA[First time ever, AMD outsells Intel in the datacenter space (150 pts)]]></title>
            <link>https://www.tomshardware.com/pc-components/cpus/for-the-first-time-ever-amd-outsells-intel-in-the-datacenter-space</link>
            <guid>42054449</guid>
            <pubDate>Tue, 05 Nov 2024 19:27:15 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.tomshardware.com/pc-components/cpus/for-the-first-time-ever-amd-outsells-intel-in-the-datacenter-space">https://www.tomshardware.com/pc-components/cpus/for-the-first-time-ever-amd-outsells-intel-in-the-datacenter-space</a>, See on <a href="https://news.ycombinator.com/item?id=42054449">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="article-body">
<p>For well more than two decades, Intel has been the undisputed leader in the market for datacenter CPUs. Intel's Xeon processors powered the vast majority of servers, whereas AMD's processors commanded a single-digit market share just some seven or eight years ago. However, the situation has changed drastically. While Intel's Xeon CPUs still power the majority of servers, the most expensive machines now use AMD's EPYC processors. This is why AMD's datacenter business unit now outsells Intel's datacenter and AI business group, as observed by&nbsp;<a data-analytics-id="inline-link" href="https://x.com/SKundojjala/status/1853041284157682063" data-url="https://x.com/SKundojjala/status/1853041284157682063" target="_blank" referrerpolicy="no-referrer-when-downgrade" data-hl-processed="none">SemiAnalysis</a>.</p><p>Indeed, AMD's datacenter segment revenue reached&nbsp;<a data-analytics-id="inline-link" href="https://www.tomshardware.com/pc-components/cpus/amd-rakes-in-cash-with-best-quarterly-revenue-ever-amid-datacenter-business-rise-but-gaming-business-craters" data-before-rewrite-localise="https://www.tomshardware.com/pc-components/cpus/amd-rakes-in-cash-with-best-quarterly-revenue-ever-amid-datacenter-business-rise-but-gaming-business-craters">$3.549 billion</a>&nbsp;in the third quarter, whereas Intel's datacenter and AI group's earnings were&nbsp;<a data-analytics-id="inline-link" href="https://www.tomshardware.com/pc-components/cpus/intel-lost-usd16-6-billion-in-q3-reports-usd13-3-billion-in-revenue" data-before-rewrite-localise="https://www.tomshardware.com/pc-components/cpus/intel-lost-usd16-6-billion-in-q3-reports-usd13-3-billion-in-revenue">$3.3 billion</a>&nbsp;in Q3 2024. Just two years ago, Intel's DCAI group earned $5 billion - $6 billion per quarter. But as AMD's EPYC processors have gained competitive advantages over Intel's Xeon CPUs, Intel has had to sell its server chips at significant discounts, which has reduced the company's revenue and profit margins.</p><p>It is noteworthy that Intel's flagship&nbsp;<a data-analytics-id="inline-link" href="https://www.tomshardware.com/pc-components/cpus/intels-latest-flagship-128-core-xeon-cpu-costs-usd17-800-granite-rapids-sets-a-new-high-watermark" data-before-rewrite-localise="https://www.tomshardware.com/pc-components/cpus/intels-latest-flagship-128-core-xeon-cpu-costs-usd17-800-granite-rapids-sets-a-new-high-watermark">128-core Xeon 6980P 'Granite Rapids' processor costs $17,800</a>, making it the company's most expensive standard CPU ever. By contrast, AMD's most expensive 96-core EPYC 6979P processor costs $11,805. If demand for Intel's Xeon 6900-series processors remains high and the company can supply these CPUs in decent volumes, then Intel's datacenter revenue will likely get back on track and surpass AMD's datacenter sales. However, Intel still has to ramp up production of its Granite Rapids products.&nbsp;</p><p>While both Intel and AMD now earn around $3-3.5 billion per quarter selling datacenter CPUs, Nvidia earns much more from its datacenter GPUs and networking chips, which are required to make AI processors work in concert in datacenters. In fact, sales of Nvidia's networking products totaled&nbsp;<a data-analytics-id="inline-link" href="https://s201.q4cdn.com/141608511/files/doc_financials/2025/Q225/Q2FY25-CFO-Commentary.pdf" data-url="https://s201.q4cdn.com/141608511/files/doc_financials/2025/Q225/Q2FY25-CFO-Commentary.pdf" target="_blank" referrerpolicy="no-referrer-when-downgrade" data-hl-processed="none">$3.668 billion</a>&nbsp;in the company's second quarter of fiscal 2025. Meanwhile, compute GPU sales reached $22.604 billion in Q2 FY2025, which far surpasses the combined sales of Intel and AMD datacenter hardware. Altogether, Nvidia sold nearly $42 billion worth of AI and HPC GPUs in the first half of this year, and it is likely that the company will sell even more datacenter processors in the second half.</p><div data-hydrate="true" id="slice-container-newsletterForm-articleInbodyContent-gRFTK4rNSThvy54UVmstUM"><section><p>Get Tom's Hardware's best news and in-depth reviews, straight to your inbox.</p></section></div>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Hacking 700M Electronic Arts Accounts (490 pts)]]></title>
            <link>https://battleda.sh/blog/ea-account-takeover</link>
            <guid>42052143</guid>
            <pubDate>Tue, 05 Nov 2024 15:18:34 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://battleda.sh/blog/ea-account-takeover">https://battleda.sh/blog/ea-account-takeover</a>, See on <a href="https://news.ycombinator.com/item?id=42052143">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[New documentary reveals that 21,000 laborers have died working Saudi Vision 2030 (241 pts)]]></title>
            <link>https://www.archpaper.com/2024/10/documentary-reveals-21000-workers-killed-saudi-vision-2030-neom/</link>
            <guid>42052105</guid>
            <pubDate>Tue, 05 Nov 2024 15:14:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.archpaper.com/2024/10/documentary-reveals-21000-workers-killed-saudi-vision-2030-neom/">https://www.archpaper.com/2024/10/documentary-reveals-21000-workers-killed-saudi-vision-2030-neom/</a>, See on <a href="https://news.ycombinator.com/item?id=42052105">Hacker News</a></p>
Couldn't get https://www.archpaper.com/2024/10/documentary-reveals-21000-workers-killed-saudi-vision-2030-neom/: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Hacker Fab (260 pts)]]></title>
            <link>https://docs.hackerfab.org/hacker-fab-space</link>
            <guid>42051968</guid>
            <pubDate>Tue, 05 Nov 2024 14:59:15 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://docs.hackerfab.org/hacker-fab-space">https://docs.hackerfab.org/hacker-fab-space</a>, See on <a href="https://news.ycombinator.com/item?id=42051968">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><!--$?--><template id="B:0"></template><!--/$--><p>Last updated <time data-visual-test="transparent" datetime="2024-11-05T18:11:11.169Z" title="11/5/2024, 6:11:11 PM">0 minutes ago</time></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Netflix Europe offices raided in tax fraud probe (308 pts)]]></title>
            <link>https://www.bbc.co.uk/news/articles/cwy1vze09wwo</link>
            <guid>42051643</guid>
            <pubDate>Tue, 05 Nov 2024 14:20:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bbc.co.uk/news/articles/cwy1vze09wwo">https://www.bbc.co.uk/news/articles/cwy1vze09wwo</a>, See on <a href="https://news.ycombinator.com/item?id=42051643">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-component="text-block"><p><b>Offices of streaming giant Netflix in Paris and Amsterdam have been raided by the French and Dutch authorities as part of an investigation into tax fraud, French judicial sources say.</b></p><p>Officials from the two countries have been co-operating on the case since the investigation was opened in November 2022.</p><p>Netflix has not as yet made any specific comment on the raids, but insists it complies with tax laws wherever it operates.</p><p>The Amsterdam office is the headquarters of the company's operations in Europe, the Middle East and Africa.</p></div><div data-component="text-block"><p>The French investigation is being carried out by the National Financial Prosecutor's office (PNF), a special unit used for investigations into high-profile white-collar crime.</p><p>It relates to suspicions of "covering up serious tax fraud and off-the-books work", according to the PNF.</p><p>The company is also under investigation for tax filings for 2019, 2020 and 2021.</p><p>The French sources said authorities in the Netherlands were conducting simultaneous searches, and that co-operation between the two countries had been going on for "many months".</p><p>Last year, French media outlet La Lettre reported that until 2021, Netflix in France minimised its tax payments by declaring its turnover generated in France to the Netherlands.</p><p>After it abandoned this arrangement, La Lettre said, its annual declared turnover in France  jumped from €47.1m ($51.3m; £39.6m) in 2020 to €1.2bn in 2021.</p><p>However, the outlet says investigators are trying to determine whether Netflix continued to attempt to minimise its profits after 2021.</p><p>Netflix arrived in France more than 10 years ago, opening its Paris office in 2020. It has some 10 million subscribers in the country, according to AFP news agency.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Failure Analysis of the Arecibo 305 Meter Telescope Collapse (166 pts)]]></title>
            <link>https://nap.nationalacademies.org/read/26982/chapter/1</link>
            <guid>42051368</guid>
            <pubDate>Tue, 05 Nov 2024 13:37:42 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://nap.nationalacademies.org/read/26982/chapter/1">https://nap.nationalacademies.org/read/26982/chapter/1</a>, See on <a href="https://news.ycombinator.com/item?id=42051368">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="openbook-ocr">
          <p>Below is the uncorrected machine-read text of this chapter, intended to provide our own search engines and external engines with highly rich, chapter-representative searchable text of each book. Because it is UNCORRECTED material, please consider the following text as a useful but insufficient proxy for the authoritative book pages.</p>
                      <p>Failure Analysis of the
Arecibo Observatory 305-Meter
Telescope Collapse




Committee on Analysis of Causes of Failure
and Collapse of the 305-Meter Telescope at
the Arecibo Observatory

Board on Infrastructure and the Constructed
Environment

Division on Engineering and Physical Sciences




                                                 Consensus Study Report
            PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>NATIONAL ACADEMIES PRESS 500 Fifth Street, NW Washington, DC 20001

This activity was supported by Grant CMMI- 2135084 from the National Science Foundation to the National
Academy of Sciences. Any opinions, findings, conclusions, or recommendations expressed in this publication do
not necessarily reflect the views of any organization or agency that provided support for the project.

International Standard Book Number-13: 978-0-309-XXXXX-X
International Standard Book Number-10: 0-309-XXXXX-X
Digital Object Identifier: https://doi.org/10.17226/26982

Cover: Photo courtesy of the Arecibo Observatory, a facility of the National Science Foundation.

This publication is available from the National Academies Press, 500 Fifth Street, NW, Keck 360, Washington,
DC 20001; (800) 624-6242 or (202) 334-3313; http://www.nap.edu.

Copyright 2024 by the National Academy of Sciences. National Academies of Sciences, Engineering, and
Medicine and National Academies Press and the graphical logos for each are all trademarks of the National
Academy of Sciences. All rights reserved.

Printed in the United States of America.

Suggested citation: National Academies of Sciences, Engineering, and Medicine. 2024. Failure Analysis of the
Arecibo Observatory 305-Meter Telescope Collapse. Washington, DC: The National Academies Press. https://
doi.org/10.17226/26982.




      PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>The National Academy of Sciences was established in 1863 by an Act of Congress, signed by President
Lincoln, as a private, nongovernmental institution to advise the nation on issues related to science and
technology. Members are elected by their peers for outstanding contributions to research. Dr. Marcia McNutt is
president.

The National Academy of Engineering was established in 1964 under the charter of the National Academy
of Sciences to bring the practices of engineering to advising the nation. Members are elected by their peers for
extraordinary contributions to engineering. Dr. John L. Anderson is president.

The National Academy of Medicine (formerly the Institute of Medicine) was established in 1970 under the
charter of the National Academy of Sciences to advise the nation on medical and health issues. Members are
elected by their peers for distinguished contributions to medicine and health. Dr. Victor J. Dzau is president.

The three Academies work together as the National Academies of Sciences, Engineering, and Medicine
to provide independent, objective analysis and advice to the nation and conduct other activities to solve complex
problems and inform public policy decisions. The National Academies also encourage education and research,
recognize outstanding contributions to knowledge, and increase public understanding in matters of science,
engineering, and medicine.

Learn more about the National Academies of Sciences, Engineering, and Medicine at
www.nationalacademies.org.




      PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>Consensus Study Reports published by the National Academies of Sciences, Engineering, and
Medicine document the evidence-based consensus on the studyâs statement of task by an authoring committee of
experts. Reports typically include findings, conclusions, and recommendations based on information gathered by
the committee and the committeeâs deliberations. Each report has been subjected to a rigorous and independent
peer-review process and it represents the position of the National Academies on the statement of task.

Proceedings published by the National Academies of Sciences, Engineering, and Medicine chronicle the
presentations and discussions at a workshop, symposium, or other event convened by the National Academies.
The statements and opinions contained in proceedings are those of the participants and are not endorsed by
other participants, the planning committee, or the National Academies.

Rapid Expert Consultations published by the National Academies of Sciences, Engineering, and Medicine are
authored by subject-matter experts on narrowly focused topics that can be supported by a body of evidence. The
discussions contained in rapid expert consultations are considered those of the authors and do not contain policy
recommendations. Rapid expert consultations are reviewed by the institution before release.

For information about other products and activities of the National Academies, please visit
www.nationalacademies.org/about/whatwedo.




      PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>               COMMITTEE ON ANALYSIS OF CAUSES OF FAILURE AND COLLAPSE OF
                  THE 305-METER TELESCOPE AT THE ARECIBO OBSERVATORY


ROGER L. McCARTHY (NAE), McCarthy Engineering, Chair
RAMÃN L. CARRASQUILLO,1 Carrasquillo Associates
DIANNE CHONG (NAE), Boeing Engineering, Operations &amp; Technology (retired)
ROBERT B. GILBERT (NAE), The University of Texas at Austin
W. ALLEN MARR, JR. (NAE), Geocomp, Inc.
JOHN R. SCULLY, University of Virginia
SAWTEEN SEE, See Robertson Structural Engineers
HABIB TABATABAI, University of WisconsinâMilwaukee


Study Staff
CAMERON OSKVIG, Board Director, Study Director
JAYDA WADE, Research Associate (until July 31, 2023)
JOSEPH PALMER, SR., Program Assistant
RADAKA LIGHTFOOT, Financial Business Partner (until March 20, 2023)
DONAVAN THOMAS, Financial Business Partner (from March 20, 2023)




 1 Deceased   on February 2, 2024.

                                                v



      PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>           BOARD ON INFRASTRUCTURE AND THE CONSTRUCTED ENVIRONMENT


JESUS M. DE LA GARZA, Clemson University, Chair
BURCU AKINCI, Carnegie Mellon University
STEPHEN AYERS, Ayers Group
BURCIN BECERIK-GERBER, University of Southern California
LEAH BROOKS, The George Washington University
MIKHAIL V. CHESTER, Arizona State University
JAMES (JACK) DEMPSEY, Asset Management Partnership, LLC
LEONARDO DUENAS-OSORIO, Rice University
DEVIN K. HARRIS, University of Virginia
DAVID J. HAUN, Haun Consulting, Inc.
CHRISTOPHER J. MOSSEY, Fermi National Accelerator Laboratory
ANDREW PERSILY, National Institute of Standards and Technology
ROBERT B. RAINES, Atkins Nuclear Secured
JAMES RISPOLI, North Carolina State University
DOROTHY ROBYN, Boston University
SHOSHANNA D. SAXE, University of Toronto


Staff
CAMERON OSKVIG, Board Director
JAMES MYSKA, Senior Program Officer
BRITTANY SEGUNDO, Program Officer
JOSEPH PALMER, SR., Senior Program Assistant
DONAVAN THOMAS, Finance Business Partner




                                               vi



        PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>                                                   Dedication




     This report is dedicated to committee member Dr. RamÃ³n L. Carrasquillo, who unexpectedly passed away
before this reportâs release. His pragmatic and insightful contributions strengthened the report. In addition to his
extensive engineering and materials science expertise, his deep connection to Puerto Rico helped the commit-
tee develop a nuanced understanding of the community and culture surrounding the Arecibo Observatory. He is
remembered by the committee as a thoughtful, warm, and generous colleague.




NOTE: Image courtesy of Carrasquillo Associates.


                                                        vii



       PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>                                               Reviewers




     This Consensus Study Report was reviewed in draft form by individuals chosen for their diverse perspec-
tives and technical expertise. The purpose of this independent review is to provide candid and critical comments
that will assist the National Academies of Sciences, Engineering, and Medicine in making each published report
as sound as possible and to ensure that it meets the institutional standards for quality, objectivity, evidence, and
responsiveness to the study charge. The review comments and draft manuscript remain confidential to protect the
integrity of the deliberative process.
     We thank the following individuals for their review of this report:

    DONALD CAMPBELL, Cornell University
    GREGORY G. DEIERLEIN (NAE), Stanford University
    LENNARD FISK (NAS), University of Michigan
    DAVID GOODYEAR (NAE), Independent Consultant
    MARTHA HAYNES (NAS), Cornell University
    LT. COL. (RET.) CLARENCE (BART) KEMPER, Kemper Engineering Services, LLC
    MATTHYS LEVY (NAE), Thornton Tomasetti
    MOHAMMAD MODARRES, University of Maryland
    JANINE PARDEE, Independent Consultant
    RANDALL POSTON (NAE), Pivot Engineers

     Although the reviewers listed above provided many constructive comments and suggestions, they were not
asked to endorse the conclusions or recommendations of this report nor did they see the final draft before its
release. The review of this report was overseen by WILLIAM F. BAKER, Skidmore Owings and Merrill, LLP,
and STEVE BATTEL (NAE), Battel Engineering. They were responsible for making certain that an independent
examination of this report was carried out in accordance with the standards of the National Academies and that all
review comments were carefully considered. Responsibility for the final content rests entirely with the authoring
committee and the National Academies.




                                                         ix



      PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>                                            Contents




PREFACE                                                                      xiii

SUMMARY                                                                        1

1   INTRODUCTION                                                               7
    History of the Arecibo Telescope, 7
    Arecibo Telescope Cable System, 12
    Statement of Task, 16

2   THE COLLAPSE: WHAT HAPPENED                                               18
    Arecibo Telescope Failure Sequence, 18
    Hurricane Maria Hits Arecibo Telescope, 18
    Post-Maria Arecibo Telescope Inspections, 22
    The Hurricane Maria Aftermath, 26
    Bureaucratic Delays in Funding Arecibo Telescope Hurricane Repairs, 28
    Sequence of Cable Failure Events, 30

3   ANALYSIS                                                                  35
    Cable Socket Zinc Creep Failure, 35
    Cable End Sockets, 48
    Wire Breaks, 49
    Earthquake, 55
    Wind Speed Consideration in the Arecibo Telescopeâs Design, 56
    Governing Cable Design Standards, 56
    Arecibo Telescope Cable Load, 58
    Risk Considerations, 61
    Structural Robustness, 63
    Monitoring, 65



                                                    xi



     PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>xii                                                                            CONTENTS



4     ARECIBO TELESCOPEâS MANAGEMENT AND OVERSIGHT                                   70

5     OTHER LESSONS LEARNED                                                          74
      State of Knowledge, 74
      Continued Research, 75

BIBLIOGRAPHY                                                                         76

APPENDIXES

A     Committee Member Biographical Information                                      81
B     Information-Gathering Activities                                               84
C     Arecibo Telescope Cable Failure Mechanisms Considered by the Committee         86
D     Arecibo Telescope Design Issues Considered by the Committee                    94
E     Acronyms and Abbreviations                                                     96




       PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>                                                  Preface




     It has been my privilege to chair this committee of distinguished subject-matter experts in its investigation
and final probable cause determination of one of the most publicized and baffling failures of the modern era. It
became clear shortly after the Arecibo Telescopeâs collapse that the zinc used to anchor the steel supporting cable
wires into their sockets had allowed the failed cables to slip out of their sockets, known as spelter sockets. The
sockets slowly lost their grip on a critical number of the cable wires via slow zinc âcreep,â a process where the
zinc deformed slowly at a load below half the socketâs nominal strength. Although the committee agrees with
the conclusions from other forensic reports regarding zinc creep at the connection being the failure mechanism,
the baffling question was, âWhy was there excessive zinc creep at such loading?â Such a failure had never been
reported previously in over a century of widespread zinc spelter socket successful use.
     Fortunately, the committee had the benefit of the detailed analysis and well-documented reports from NASA;
Wiss, Janney, Elstner Associates, Inc.; and Thornton Tomasetti, Inc., without which it could not have completed its
task. Building on their work, the committee presents a clear and plausible explanation of why the telescopeâs sockets
failed when no such sockets have ever been reported to have failed before. Unfortunately, there was not enough
data available to prove our explanation. It is simply the most plausible hypothesis based on the data we do have.
     Without the depth and breadth of expertise on the committee, its task would remain uncompleted. I think I
speak for everyone on the committee when I say that none of us could have done this alone. I want to thank my
colleagues for their unwavering dedication to the task. Their professionalism and competence made my job an
enjoyable one.

                                                                                     Roger L. McCarthy, Chair
                                                        Committee on Analysis of Causes of Failure and Collapse
                                                          of the 305-Meter Telescope at the Arecibo Observatory




                                                        xiii



      PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                      <p>PREPUBLICATION COPYâSUBJECT TO FURTHER EDITORIAL CORRECTION
</p>
                  </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: rallyup – Lightweight Wake-on-LAN Scheduler (109 pts)]]></title>
            <link>https://github.com/darwindarak/rallyup</link>
            <guid>42050862</guid>
            <pubDate>Tue, 05 Nov 2024 12:04:14 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/darwindarak/rallyup">https://github.com/darwindarak/rallyup</a>, See on <a href="https://news.ycombinator.com/item?id=42050862">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto"><code>rallyup</code></h2><a id="user-content-rallyup" aria-label="Permalink: rallyup" href="#rallyup"></a></p>
<p dir="auto"><code>rallyup</code> is a lightweight Wake-On-LAN (WOL) scheduler and dependency manager designed for small businesses and homelabs. It ensures that infrastructure services like firewalls, storage, and hypervisors are brought online in the correct order, particularly after events like power outages.</p>
<p dir="auto">A typical setup involves configuring most of the infrastructure for WOL but not for Wake-On-Power, and setting <code>rallyup</code> to run on startup on a low-power device like a Raspberry Pi. When you need to bring the entire environment online, simply power on the device running <code>rallyup</code>, and the rest of the infrastructure will automatically follow in the correct order.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/darwindarak/rallyup/actions/workflows/tests.yml/badge.svg"><img src="https://github.com/darwindarak/rallyup/actions/workflows/tests.yml/badge.svg" alt="Tests"></a>
<a href="https://crates.io/crates/rallyup" rel="nofollow"><img src="https://camo.githubusercontent.com/d06930b3b5f4b41abbd2ec7ab3bc8e39ba0efc33a314dd6961304cfc0d37d75c/68747470733a2f2f696d672e736869656c64732e696f2f6372617465732f762f72616c6c7975702e737667" alt="Crates.io" data-canonical-src="https://img.shields.io/crates/v/rallyup.svg"></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Features</h2><a id="user-content-features" aria-label="Permalink: Features" href="#features"></a></p>
<ul>
<li> <em>VLAN Support</em>: Send WOL packets to devices across different VLANs.</li>
<li> <em>YAML Configuration</em>: Easily define server boot sequences, dependencies, and status checks.</li>
<li> <em>Service Status Checks</em>: Verify that a service is up using built-in status checks (HTTP health checks, NFS, SMB, custom shell commands).
<ul>
<li> HTTP</li>
<li> Open port</li>
<li> Shell</li>
<li> NFS (might just use open port check)</li>
<li> SMB (might just use open port check)</li>
</ul>
</li>
<li> <em>Plugin-Friendly</em>: Users can write their own custom status check plugins.</li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Usage</h2><a id="user-content-usage" aria-label="Permalink: Usage" href="#usage"></a></p>

<p dir="auto"><h2 tabindex="-1" dir="auto">Configuration</h2><a id="user-content-configuration" aria-label="Permalink: Configuration" href="#configuration"></a></p>
<p dir="auto">The dependencies between servers, along with the methods for validating that they are online, are defined in a YAML configuration file.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Servers Configuration</h2><a id="user-content-servers-configuration" aria-label="Permalink: Servers Configuration" href="#servers-configuration"></a></p>
<p dir="auto"><strong>Fields</strong>:</p>
<ul dir="auto">
<li><strong>name</strong>: The name of the server, used for identification when defining dependencies between servers</li>
<li><strong>mac</strong>: The MAC address of the server we want to wake up</li>
<li><strong>interface</strong>: The network interface to use when sending the WOL packet</li>
<li><strong>vlan</strong>: The VLAN ID (optional) that the server is on</li>
<li><strong>depends</strong>: A list of other server names that this server depends on</li>
<li><strong>check</strong>: A list of health checks that must pass before this server is considered fully online</li>
</ul>
<p dir="auto"><strong>Example</strong>:</p>
<div dir="auto" data-snippet-clipboard-copy-content="- name: &quot;firewall&quot;
  mac: &quot;00:11:22:33:44:55&quot;
  interface: &quot;eth0&quot;
  vlan: 100
  depends:
    - &quot;storage&quot;
  check: [... see below]"><pre>- <span>name</span>: <span><span>"</span>firewall<span>"</span></span>
  <span>mac</span>: <span><span>"</span>00:11:22:33:44:55<span>"</span></span>
  <span>interface</span>: <span><span>"</span>eth0<span>"</span></span>
  <span>vlan</span>: <span>100</span>
  <span>depends</span>:
    - <span><span>"</span>storage<span>"</span></span>
  <span>check</span>: <span>[... see below]</span></pre></div>
<ul dir="auto">
<li></li>
</ul>
<p dir="auto"><h2 tabindex="-1" dir="auto">Health Check Configurations</h2><a id="user-content-health-check-configurations" aria-label="Permalink: Health Check Configurations" href="#health-check-configurations"></a></p>
<p dir="auto">Each server can have multiple health checks to ensure the server is fully online before the next device starts up.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Common Fields</h3><a id="user-content-common-fields" aria-label="Permalink: Common Fields" href="#common-fields"></a></p>
<ul dir="auto">
<li><strong>retry</strong>: The interval, defined in human readable string (e.g. 1s, 1 minute, etc.) to wait between retrying this health check</li>
<li><strong>timeout</strong>: The timeout interval after which the check, and subsequently the entire boot sequence, will fail</li>
</ul>
<p dir="auto"><h3 tabindex="-1" dir="auto">Built-in Health Checks</h3><a id="user-content-built-in-health-checks" aria-label="Permalink: Built-in Health Checks" href="#built-in-health-checks"></a></p>
<p dir="auto"><h4 tabindex="-1" dir="auto">HTTP Health Checks</h4><a id="user-content-http-health-checks" aria-label="Permalink: HTTP Health Checks" href="#http-health-checks"></a></p>
<p dir="auto">The HTTP health check verifies whether a specified endpoint responds as expected.</p>
<p dir="auto"><strong>Fields</strong></p>
<ul dir="auto">
<li><strong>type</strong>: should be <code>http</code> for an HTTP health check.</li>
<li><strong>url</strong>:  The URL to perform the HTTP health check against</li>
<li><strong>status</strong>: Expected HTTP status code</li>
<li><strong>regex</strong>: Regex to match in the response body</li>
</ul>
<blockquote>
<p dir="auto">Note: You must provide either <code>status</code> or <code>regex</code>, or both.</p>
</blockquote>
<p dir="auto"><strong>Example</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="- type: http
  url: &quot;http://192.168.1.1/health&quot;
  status: 200
  retry: 5s
  timeout: 30s"><pre>- <span>type</span>: <span>http</span>
  <span>url</span>: <span><span>"</span>http://192.168.1.1/health<span>"</span></span>
  <span>status</span>: <span>200</span>
  <span>retry</span>: <span>5s</span>
  <span>timeout</span>: <span>30s</span></pre></div>
<p dir="auto"><h4 tabindex="-1" dir="auto">Port Health Check</h4><a id="user-content-port-health-check" aria-label="Permalink: Port Health Check" href="#port-health-check"></a></p>
<p dir="auto">The port health check verifies whether a specified TCP port on a server is open and accessible.
This is really a stand-in for verifying NFS and SMB ports until I can figure out how to check if those services are online.</p>
<p dir="auto"><strong>Fields</strong></p>
<ul dir="auto">
<li><strong>type</strong>: should be <code>port</code> for a port health check</li>
<li><strong>ip</strong>: the IP address to check</li>
<li><strong>port</strong>: the port number to check</li>
</ul>
<p dir="auto"><strong>Example</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="- type: port
  ip: &quot;192.168.1.1&quot;
  port: 22
  retry: &quot;10s&quot;
  timeout: &quot;1m&quot;"><pre>- <span>type</span>: <span>port</span>
  <span>ip</span>: <span><span>"</span>192.168.1.1<span>"</span></span>
  <span>port</span>: <span>22</span>
  <span>retry</span>: <span><span>"</span>10s<span>"</span></span>
  <span>timeout</span>: <span><span>"</span>1m<span>"</span></span></pre></div>
<p dir="auto"><h4 tabindex="-1" dir="auto">Shell Health Checks</h4><a id="user-content-shell-health-checks" aria-label="Permalink: Shell Health Checks" href="#shell-health-checks"></a></p>
<p dir="auto">The shell health check executes a shell command checks the result.
This is to provide the option of user-defined health checks.</p>
<p dir="auto"><strong>Fields</strong></p>
<ul dir="auto">
<li><strong>type</strong>: should be <code>shell</code> for a shell health check.</li>
<li><strong>command</strong>:  he shell command to execute</li>
<li><strong>status</strong>: Expected exit code</li>
<li><strong>regex</strong>: Regex to match in the standard output</li>
</ul>
<blockquote>
<p dir="auto">Note: You must provide either <code>status</code> or <code>regex</code>, or both.</p>
</blockquote>
<p dir="auto"><strong>Example</strong></p>
<div dir="auto" data-snippet-clipboard-copy-content="- type: shell
  command: ping -c 1 192.168.1.1
  status: 0
  retry: 5s
  timeout: 20s"><pre>- <span>type</span>: <span>shell</span>
  <span>command</span>: <span>ping -c 1 192.168.1.1</span>
  <span>status</span>: <span>0</span>
  <span>retry</span>: <span>5s</span>
  <span>timeout</span>: <span>20s</span></pre></div>
<p dir="auto"><h3 tabindex="-1" dir="auto">Full Example</h3><a id="user-content-full-example" aria-label="Permalink: Full Example" href="#full-example"></a></p>
<blockquote>
<p dir="auto">TODO:</p>
<ul>
<li> Need to test in the lab and post the actual sample</li>
</ul>
</blockquote>
<div dir="auto" data-snippet-clipboard-copy-content="- name: &quot;Firewall&quot;
  mac: &quot;00:1A:2B:3C:4D:5E&quot;
  interface: eth0
  vlan: 10
  depends: []
  check:
    - type: http
      url: &quot;http://192.168.1.1/health&quot;
      status: 200
      regex: 'ok'

- name: &quot;Storage Server 1&quot;
  mac: &quot;00:1A:2B:3C:4D:5F&quot;
  interface: eth0
  vlan: 100
  depends:
    - &quot;Firewall&quot;
  check:
    - type: port
      ip: 192.168.100.101
      port: 2049
      timeout: 5 minutes

- name: &quot;Storage Server 2&quot;
  mac: &quot;00:1A:2B:3C:4D:5G&quot;
  vlan: 100
  depends:
    - &quot;Firewall&quot;
  check:
    - type: port
      ip: 192.168.100.102
      port: 445
      retry: 5s

- name: &quot;VM Host&quot;
  mac: &quot;00:1A:2B:3C:4D:60&quot;
  vlan: 200
  depends:
    - &quot;Storage Server 1&quot;
    - &quot;Storage Server 2&quot;
  check:
    - type: command
      command: &quot;ping -c 192.168.200.10&quot;
      status: 0"><pre>- <span>name</span>: <span><span>"</span>Firewall<span>"</span></span>
  <span>mac</span>: <span><span>"</span>00:1A:2B:3C:4D:5E<span>"</span></span>
  <span>interface</span>: <span>eth0</span>
  <span>vlan</span>: <span>10</span>
  <span>depends</span>: <span>[]</span>
  <span>check</span>:
    - <span>type</span>: <span>http</span>
      <span>url</span>: <span><span>"</span>http://192.168.1.1/health<span>"</span></span>
      <span>status</span>: <span>200</span>
      <span>regex</span>: <span><span>'</span>ok<span>'</span></span>

- <span>name</span>: <span><span>"</span>Storage Server 1<span>"</span></span>
  <span>mac</span>: <span><span>"</span>00:1A:2B:3C:4D:5F<span>"</span></span>
  <span>interface</span>: <span>eth0</span>
  <span>vlan</span>: <span>100</span>
  <span>depends</span>:
    - <span><span>"</span>Firewall<span>"</span></span>
  <span>check</span>:
    - <span>type</span>: <span>port</span>
      <span>ip</span>: <span>192.168.100.101</span>
      <span>port</span>: <span>2049</span>
      <span>timeout</span>: <span>5 minutes</span>

- <span>name</span>: <span><span>"</span>Storage Server 2<span>"</span></span>
  <span>mac</span>: <span><span>"</span>00:1A:2B:3C:4D:5G<span>"</span></span>
  <span>vlan</span>: <span>100</span>
  <span>depends</span>:
    - <span><span>"</span>Firewall<span>"</span></span>
  <span>check</span>:
    - <span>type</span>: <span>port</span>
      <span>ip</span>: <span>192.168.100.102</span>
      <span>port</span>: <span>445</span>
      <span>retry</span>: <span>5s</span>

- <span>name</span>: <span><span>"</span>VM Host<span>"</span></span>
  <span>mac</span>: <span><span>"</span>00:1A:2B:3C:4D:60<span>"</span></span>
  <span>vlan</span>: <span>200</span>
  <span>depends</span>:
    - <span><span>"</span>Storage Server 1<span>"</span></span>
    - <span><span>"</span>Storage Server 2<span>"</span></span>
  <span>check</span>:
    - <span>type</span>: <span>command</span>
      <span>command</span>: <span><span>"</span>ping -c 192.168.200.10<span>"</span></span>
      <span>status</span>: <span>0</span></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">License</h2><a id="user-content-license" aria-label="Permalink: License" href="#license"></a></p>
<p dir="auto">This project is licensed under either of the following licenses, at your option:</p>
<ul dir="auto">
<li><a href="https://github.com/darwindarak/rallyup/blob/master/LICENSE-MIT">MIT License</a></li>
<li><a href="https://github.com/darwindarak/rallyup/blob/master/LICENSE-APACHE">Apache License 2.0</a></li>
</ul>
<p dir="auto">You may choose to use this project under the terms of either license.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Show HN: IMDb SQL Best Movie Finder (122 pts)]]></title>
            <link>https://www.imdb-sql.com/</link>
            <guid>42049936</guid>
            <pubDate>Tue, 05 Nov 2024 09:16:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.imdb-sql.com/">https://www.imdb-sql.com/</a>, See on <a href="https://news.ycombinator.com/item?id=42049936">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Study Reveals Blood Sugar Control is a Key Factor in Slowing Brain Aging (138 pts)]]></title>
            <link>https://www.bgu.ac.il/en/news-and-articles/blood-sugar-control-is-key-factor-in-slowing-brain-aging/</link>
            <guid>42049418</guid>
            <pubDate>Tue, 05 Nov 2024 07:38:17 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.bgu.ac.il/en/news-and-articles/blood-sugar-control-is-key-factor-in-slowing-brain-aging/">https://www.bgu.ac.il/en/news-and-articles/blood-sugar-control-is-key-factor-in-slowing-brain-aging/</a>, See on <a href="https://news.ycombinator.com/item?id=42049418">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>Age-related brain atrophy, the gradual loss of neurons and shrinkage of brain tissue, is a natural part of aging, which can lead to cognitive decline and other neurological issues. While so far aging cannot be prevented, recent research from an 18-month dietary intervention offers hope that lifestyle and dietary changes can slow brain aging. A new international study, led by Ben-Gurion University of the Negev as part of the DIRECT PLUS Brain MRI trial, has brought to light how blood sugar control can significantly impact brain health.</p><p>Brain age, as evaluated by MRI measurements of the hippocampus and lateral ventricles, reflects the biological aging of the brain, which can differ from a person's chronological age. Chronological age is the number of years lived, while brain age indicates the brain's actual health. Typically, as we age, the hippocampus shrinks and the lateral ventricles expand, serving as markers of brain aging. Some individuals have a brain age younger or older than their chronological age. A younger brain age suggests better cognitive health, while an older brain age may indicate accelerated aging and increased risk of cognitive decline.</p><p>The study, which was published recently in <a rel="noopener" href="https://www.sciencedirect.com/science/article/abs/pii/S0002916524007457" target="_blank"><em>The American Journal of Clinical Nutrition 2024</em></a>, was conducted by an international team of brain and nutrition experts, including researchers from Ben-Gurion University, Harvard University, Leipzig University, and more. The research was primarily carried out by PhD student Dafna Pachter and overseen by Prof. Iris Shai, along with several international collaborators.</p><p>A previous study published two years ago (<a rel="noopener" href="https://pubmed.ncbi.nlm.nih.gov/35021194/" target="_blank"><em>American Journal of Clinical Nutrition 2022 </em></a><em>)</em>, reported that Mediterranean (MED) and green-MED diets significantly attenuated age-related brain atrophy by ∼50% within 18 months.</p><p>In the current study, the researchers aimed to understand the mechanism by which the slowing of brain atrophy occurs.</p><p>The study found that a decline in HbA1c, and key markers of long-term blood sugar levels, are associated with significant positive changes in specific brain regions commonly affected by age-related atrophy. Brain MRI results showed that lower HbA1c levels corresponded to greater deviations in the thalamus, caudate nucleus, and cerebellum – areas crucial for cognitive function, motor control, and sensory processing. The study suggests that improved blood sugar control could be one of the most important factors in slowing down age-related brain changes.</p><p><strong>The Green Mediterranean Diet Shows Promise</strong></p><p>Earlier research has highlighted the benefits of the Green Mediterranean (Green-Med) diet, including better blood sugar control. The Green-Med diet is rich in polyphenols from plant-based sources like Mankai (a high-protein aquatic plant) and green tea, while being low in red and processed meats. The current study further strengthens this connection by suggesting that the Green-Med diet may not only support metabolic health but also exert protective effects on brain structure and function.</p><p><strong>DIRECT PLUS Trial – One of the Largest Brain MRI intervention Studies in the World</strong></p><p>The DIRECT PLUS trial, one of the longest and largest brain MRI studies conducted to date, involved approximately 300 participants who were divided into three dietary groups. Whole-brain MRI measurements were taken before and after the 18-month trial to track changes in brain health. The researchers used Hippocampal Occupancy (HOC), as a proxy for brain age which predicts future risk of dementia. HOC typically decreases with age. Interestingly, some participants exhibited a brain age either younger or older than their chronological age.</p><p>Using NeuroQuant, an FDA-authorized fully automated tool, the research team quantified and segmented the brain MRI-derived data. The study aimed to examine whether improved glycemic control and specific dietary components could slow down brain aging. The results indicated that participants who managed to improve their blood sugar levels and achieve normal glucose status experienced a more pronounced attenuation of brain aging. Notably, those who consumed higher amounts of green tea and Mankai duckweed shakes demonstrated the most significant improvements in both blood sugar levels and brain health.</p><figure><img src="https://www.bgu.ac.il/media/raeewflp/iris_shai_ip.jpg" alt="" data-caption="Prof. Iris Shai | Photo: Dani Machlis"><figcaption>Prof. Iris Shai | Photo: Dani Machlis</figcaption></figure><p><strong>Glycemic Control and Polyphenols: The Key to a</strong><strong> Younger Brain Age?</strong></p><p>The study’s lead researcher, Prof. Iris Shai, from Ben-Gurion University, an adjunct professor at Harvard University, and an Honorary Professor at Leipzig University, explains, “Maintaining low blood sugar levels, even within the normal range, shows promise for preserving a younger brain, especially when combined with a healthy diet and regular physical activity. Specifically, polyphenols found in plant-based foods may cross the blood-brain barrier and help reduce brain inflammation, which is crucial for memory”.</p><figure><img src="https://www.bgu.ac.il/media/jkiddbja/dafna-pachter-ip.jpg" alt="" data-caption="Dafna Pachter | Photo: Courtesy"><figcaption>Dafna Pachter | Photo: Courtesy</figcaption></figure><p>Dafna Pachter, a PhD student and the first author of the paper, adds, "This trial offers a safe approach to potentially slow down our brain aging—by adopting the components of a green-Mediterranean diet."</p><p><strong>A Pathway to Reducing Age-Related Cognitive Decline</strong></p><p>This study is one of the first large-scale trials to directly link dietary changes, particularly those associated with the Green-Med diet, to improved glycemic control and slower brain aging. While further research is needed to fully understand the mechanisms at play, these results suggest a potential avenue for reducing the risk of age-related cognitive decline through relatively simple dietary adjustments.</p><p>The DIRECT PLUS trial was funded by grants from the German Research Foundation (DFG), Israel Ministry of Health, Israel Ministry of Science and Technology, and the California Walnuts Commission. None of the funding providers were involved in any stage of the design, conduct, or analysis of the study, nor did they have access to the study results before publication.</p><p>The researchers: Dafna&nbsp;Pachter,&nbsp;Alon&nbsp;Kaplan,&nbsp;Gal&nbsp;Tsaban,&nbsp;Hila&nbsp;Zelicha,&nbsp;Anat Yaskolka&nbsp;Meir,&nbsp;Ehud&nbsp;Rinott,&nbsp;Gidon&nbsp;Levakov,&nbsp;Moti&nbsp;Salti,&nbsp;Yoram&nbsp;Yovell,&nbsp;Sebastian&nbsp;Huhn,&nbsp;Frauke&nbsp;Beyer,&nbsp;Veronica&nbsp;Witte,&nbsp;Peter&nbsp;Kovacs,&nbsp;Martin&nbsp;von Bergen,&nbsp;Uta&nbsp;Ceglarek,&nbsp;Matthias&nbsp;Blüher,&nbsp;Michael&nbsp;Stumvoll,&nbsp;Frank B.&nbsp;Hu,&nbsp;Meir J.&nbsp;Stampfer,&nbsp;Alon&nbsp;Friedman,&nbsp;Ilan&nbsp;Shelef,&nbsp;Galia&nbsp;Avidan,&nbsp;and Iris&nbsp;Shai.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Programmer in Berlin: Culture (110 pts)]]></title>
            <link>https://wickedchicken.github.io/post/programmer-in-berlin-culture/</link>
            <guid>42049180</guid>
            <pubDate>Tue, 05 Nov 2024 06:52:12 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://wickedchicken.github.io/post/programmer-in-berlin-culture/">https://wickedchicken.github.io/post/programmer-in-berlin-culture/</a>, See on <a href="https://news.ycombinator.com/item?id=42049180">Hacker News</a></p>
<div id="readability-page-1" class="page"><article>
    
    <div> <p>This is part 4 of a <a href="https://wickedchicken.github.io/post/programmer-in-berlin/">5-part series</a> detailing what I wish I had known as an
American programmer moving to Berlin. This page details cultural differences and things I wasn’t aware of until I stumbled on them.</p>
<h2 id="politics">Politics</h2>
<p>One thing about Germany, and Europe in general, is that it’s relatively left-wing when
compared to the US. This is a
place where universal healthcare is so commonly accepted that no party – not even the
super-racist party! – is talking about removing it. The aforementioned super-racist
party has effectively the same political platform as the mainstream
Republican party in the US (minus the healthcare thing). Politics in Europe certainly has
its own problems, but at least in Germany there is a flourishing multi-party system that
allows for people to have some kind of choice when voting. There is even a fun website
called the “<a href="https://www.wahl-o-mat.de/"><em>Wahl-o-Mat</em></a>” (“Vote-o-Matic”) that tells you which party to vote
for after
answering a series of questions. There’s also none of the Electoral College
silliness, which I won’t get into here.</p>
<p>I think one weird aspect of living in Europe, or at least Germany, is that all the stuff
that US politicians told me were “too expensive” apparently aren’t!</p>
<ul>
<li>
<p>Gas prices are double or even triple what they are in the US. It’s ok, the economy isn’t
collapsing.</p>
</li>
<li>
<p>Universal healthcare with an individual mandate apparently works. It’s ok, the economy
isn’t collapsing.</p>
</li>
<li>
<p>The trains, despite all the ineptness of Deutsche Bahn, are generally pretty good! For
many short-haul flights, such as Berlin to Munich, it’s actually quicker to go by
train than fly. It’s ok, the economy isn’t collapsing.</p>
</li>
<li>
<p>In Germany you get significant paid maternity and paternity leave<sup id="fnref:1"><a href="#fn:1" role="doc-noteref">1</a></sup>.
It’s ok, the economy isn’t collapsing.</p>
</li>
</ul>
<p>Similarly, some cultural things that are deemed a “slippery slope” in
the US aren’t:</p>
<ul>
<li>
<p>Promoting Nazism is banned. It’s not a slippery slope, and the country hasn’t devolved into
authoritarian groupthink. You just can’t publicly support Nazism.</p>
</li>
<li>
<p>There is no right to firearms in the way there is in the US. You don’t really have
school shootings out here, and society seems to be ok? Nobody seems to want to band
together to make a militia. Nobody in Germany is like, “we need more guns to prevent
government overreach.”</p>
</li>
</ul>
<p>I’m not saying it’s perfect, and there’s plenty of criticism to be given to German
politicians and the EU as a whole, but I personally think it’s a more fair way of
governance.</p>
<h2 id="the-eu">The EU</h2>
<p>What is ironic about the general left-leaningness of Europe is that the EU’s structure
is similar to
what the “states rights!” people want – a coalition of states with relatively strong
political power and identities, working inside a relatively weak federal framework to
handle cooperation and disagreement. There is no EU military and only partially-dominant
EU money, but there is a
common justice framework, freedom of movement and a single market. To my limited
understanding, the EU is like if the US had no federal military but every state had its
own strong military, and Oklahoma spoke a different language and had different money than
everyone else<sup id="fnref:2"><a href="#fn:2" role="doc-noteref">2</a></sup>.</p>
<p>I am not qualified to give a good assessment of the EU as a political organization, other
than I am very glad they gave me a visa and I wish they would streamline visa application
and acceptance for more people. What I can comment on, however, is my impressions of
Europeans’ relationship with the EU itself.</p>
<p>I would say that most Americans identify as “American” in some way, while most Europeans
identify with a country inside the EU. A friend once commented that they didn’t “feel
European” (as opposed to the country they were from) and didn’t know what “typical
European stuff” would be (top on the list, as enumerated by Americans: cheese, bread, and
trains). I think this speaks to a relationship with the EU somewhere between how Americans
view the US government and how the Americans view the UN. Nobody says “I’m from the UN” or
“I’m from one of the United Nations” when asked where they’re from, and Americans view the
UN as an organization to be navigated and negotiated with as opposed to something they are
inherently
part of. The EU certainly has more influence over Europeans’ daily lives than the UN does,
but it’s not part of the daily conversation as much as the US government is to Americans.</p>
<p>Digging into that relationship a bit deeper, there is also a bit more skepticism of the EU
than I expected when moving here. Brexit made this pretty clear from the right-wing side,
but some on the left view the EU as some kind of banker’s club where Germany and France
get to tell smaller countries what to do. You can see this in the “<a href="https://en.wiktionary.org/wiki/Lexit">Lexit</a>” (crowd,
people
who wanted the UK to leave the EU so it could enact more socialist policies without being
hindered by the EU’s neoliberal slant. Another example is the
<a href="https://en.wikipedia.org/wiki/Greek_government-debt_crisis#Germany's_role_in_Greece">animosity countries had toward Germany after the eurozone crisis</a> – their
bailouts came attached with harsh
austerity requirements that were criticized as exploitative.</p>
<p>I personally think the EU is cool and wish it would remain a strong uniting force, but I
also can see how its incredible bureaucracy could be streamlined.</p>
<h2 id="crime">Crime</h2>
<p>I can’t speak to general crime rates, but in general Europe <em>feels</em> safer. The relative
lack of guns is refreshing, and (at least in Berlin) the crime centers around break-ins
and bike theft. I recall being in Copenhagen once, before I moved to Europe, and seeing a
woman walking by herself at 3 am. My first thought was concern for her safety, followed by
incredible shame in myself and my country – why did I think this was dangerous in the
first place? Of course, bad things happen all the time and I don’t want to claim Europe is
some kind of crime-free paradise, but it is striking how different it is compared to the
US.</p>
<h2 id="units">Units</h2>
<p>One small adjustment will be getting used to the metric system for everything. I recommend
not trying to do any conversions in your head and just see/feel the units themselves, but
occasionally having a reference point is useful.</p>
<p>Temperature: 0°C is water’s freezing point, 100°C is its boiling point. 37°C is a nominal
human body temperature. 16°C is light sweater weather, 20-22°C is a nice indoor
temperature depending on your preference, anything over 25°C is unpleasantly warm.</p>
<p>Weight: An average supermarket pineapple weighs roughly 1 kilogram! If you take away only
one fact from this article, let it be this one.</p>
<p>Distance: Meters are just yards, so that’s really easy. <em>Centimeters</em>, on the other hand,
are quite hard and I still don’t have a good feel for them. A kitchen planner once
laughed at me when I tried to mark 10 centimeters with my fingers. It’s a little
more than the
width of a credit card I guess? Around 4 inches? I also don’t have a good feel for
kilometers and can’t give many tips, sorry. A nice thing about miles is that people
roughly drive 60 miles per
hour over long distances, meaning a distance in miles roughly corresponds to how many minutes it will take to
drive there. Luckily people roughly drive 100km/h over long distances, meaning you can divide any distance
in kilometers by 100 and that’s roughly the number of hours it’ll take to drive there.</p>
<p>Volume: A cup is roughly 240mL, or 1/4L if you’re in a pinch. A gallon is roughly 4
liters. A liter is about half of a two-liter bottle<sup id="fnref:3"><a href="#fn:3" role="doc-noteref">3</a></sup>, or roughly one quart.</p>
<p>A fun fact: one mL of water weighs one gram, which means one liter weighs one
kilogram. Pretty cool!</p>
<h2 id="washing">Washing</h2>
<p>Washing machines in Europe electrically heat their water, which means there is far more
precise temperature control than water taken from the building’s hot water supply. Instead
of “cold,” “warm” and “hot” you have 30°C, 40°C, and 60°C. Luckily clothing sold in Europe
tells you what temperature to wash it at on the tag.</p>
<p>Dryers are relatively uncommon in Germany, and most people hang their wash on a line to dry.
You can do this inside or outside, if the weather allows. Since fully soaked clothes would
take forever to dry, most people have front-loading washers which spin the water out
at the end of a cycle. The higher the RPM, the more water is taken out, but higher RPMs
also add more wear to your clothes. At 1400rpm, cotton and synthetic clothes usually dry
overnight, if not sooner. At 800rpm, it can take a day for things to dry.</p>
<p>I first got annoyed that dryers weren’t common, but I quickly adjusted and stopped caring.
Dryers use immense energy and wear down your clothes, and the added convenience isn’t
worth it unless you’re washing a LOT of clothes (which explains why it’s mostly families
who buy dryers). If you do get a dryer, get a heat pump dryer – they use roughly a third
of the energy of the standard dryers you find in the US (but you do have to empty the
water out afterward).</p>
<p>I disagree with this <a href="https://slate.com/culture/2011/04/on-the-superiority-of-american-domestic-appliances.html">Slate article</a>’s general premise and feel that
European appliances are generally of equal or better quality, but definitely appreciate the
hatred of inscrutable symbols on the appliances here. Devices from Bosch-Siemens are
especially bad in this regard:
I have a washing machine
that has <em>Pflegeleicht</em> (“easy care” or “permanent press”) and <em>Pflegeleicht Plus</em> modes.
The
manual has no explanation of what <em>Pflegeleicht Plus</em> means<sup id="fnref:4"><a href="#fn:4" role="doc-noteref">4</a></sup>, and I
only found out via a
Youtube comment on a video showing it in operation<sup id="fnref:5"><a href="#fn:5" role="doc-noteref">5</a></sup>. On the other
hand, the manual for my dryer has an entire section telling me what clothes I should dry
on low heat, but doesn’t tell me how to actually do that – I’ve been assuming this entire
time that it’s also <em>Pflegeleicht</em>, but that’s never actually explained. Sometimes you’ll
have a symbol pop up on the display that doesn’t appear in the manual at all, and you have
to scour the internet to figure it out what it means.</p>
<h2 id="weather">Weather</h2>
<p>People in Berlin like to complain about the perpetual gray weather and they’re completely
right. Seasonal affective disorder is very real, and it might be a good idea to look into
Vitamin D and light therapy lamps. One note: a lot of people buy cool-colored light bulbs
or a SAD lamp and use it like a regular light. To get the real effects of these
lamps, you need to get a real one and use it very close to your face for a long time! I
went with the complete nerd option: <a href="https://myluminette.com/">Luminette</a> lamp glasses, which I use
right as I wake up. You look like a <em>total idiot</em> wearing them, but I like them a
lot. I don’t have much beyond anecdotal evidence to show that they work, but it’s worth
looking at the instructions of any SAD lamp you might buy to see if you can follow its
recommended regiment. As an added bonus, they’re good for late sleepers who need to wake
up early and can help you
adjust to new time zones. There are other companies that make similar devices if you’re
interested. Take winters in Berlin seriously!</p>
<p>The real solution is to book a trip to Spain in February, but that isn’t an option for
everyone.</p>
<h2 id="avoiding-the-expat-bubble">Avoiding the “expat bubble”</h2>
<p>Moving to a different country raises a lot of questions about integration, maintaining
your identity, and what community you decide to cultivate. One thing that can be difficult
is keeping ties to your previous community without locking yourself into it. Delving into
the language is one way to prevent this. I think it’s also worthwhile to try and rely on
“expat services” sparingly. They’re great when starting out, but over time they reinforce
the lock-in you’ll have. Language goes a long way here, but it can also help to expand
your social network to people from the country you’re in.</p>
<p>Something you may also want to be aware of is what I call the  “expat tax,” where
companies specialize
in providing English-speaking services or advice but charge more for the service. It can
be hard to discern if you’re getting specialized advice tailored to your needs, or getting
fleeced. Most of the time it’s not a big deal, but occasionally it can end up being
quite costly. I know of a mortgage broker specializing in English-speaking clients who, at
least in one case, gave a worse deal than a German-speaking mortgage broker. Admittedly,
several factors could have caused that, but a slightly worse deal on a mortgage can add
up to a big amount in the long run. Don’t feel too bad if you rely on such services, or
expat groups or whatever – I’m just saying that accepting a reasonable amount of
discomfort at the beginning can yield benefits in the long run.</p>
<p>It’s also worth getting involved on a civic level where possible. Reading local news can
help as is watching/reading <em>Tagesschau</em>, the publicly funded German news organization.
I find it also helps to go on
tours and learn about the history of the place you’re in, not just because it’s
interesting but also to help better relate to the people around you.</p>
<h2 id="customer-service">Customer service</h2>
<p>A lot of people moving to Germany (and especially Berlin) experience shock when
interacting with the famous German concept of customer service. While usually written off
as “rude,” I think there’s a deeper cultural norm powering this. An <a href="https://text.npr.org/482443233">NPR story</a> on opening
the first McDonald’s in Russia sheds light on what is going on here:</p>
<blockquote>
<p>SPIEGEL: At that time in Russia, the relationship between customers and service providers
like cashiers or waiters was basically the opposite of the relationship set up in America.</p>
<p>CHEKALIN: Waiters were kind of above us. They were not serving us. We were kind of, like,
bothering them.</p>
<p>SPIEGEL: In Russia, the role of the customer was to please the waiter, not the other way
around. To understand this, you need to remember that in the ’60s, ’70s and ’80s, Russia
was a state-run economy plagued by severe shortages. There were shortages of bread, of
meat, toilet paper. And so anyone who had access to stuff - to goods or food - had a
tremendous amount of power.</p>
</blockquote>
<p>Ultimately, customer service in Germany (especially eastern Germany) follows the rule that
<em>the person doesn’t really have to help you</em> and <em>you are being served at their behest.</em>
I’m not saying that this is pleasant or right, but it does explain a lot of what’s going
on. It also explains why “is there a manager I can talk to” isn’t really a move you can
pull. In the States it’s usually a dick move anyway but people do it assuming that the
customer service person will be afraid of repercussions. In Germany it doesn’t work very
well because there are few repercussions, and you aren’t respecting their authority.</p>
<p>A side-effect of a highly bureaucratic society is that exceptions can be extensively
documented and handled if the bureaucrat wants to do so. This means that front-line
customer service people often have the ability to break through the system a bit, assuming
they want to and that they know they can do it. It sucks that there is a lot of personal
discretion involved, but sometimes repeatedly mentioning or reminding someone that they
have the power to document an exception can go a long way.</p>
<h2 id="tipping">Tipping</h2>
<p>There are probably huge articles online explaining how to handle the much more relaxed
tipping rules in Germany. The nice thing to note is that there is no
<a href="https://en.wikipedia.org/wiki/Tipped_wage">tipped wage</a> system like in the US and waitstaff must be paid at least
minimum wage regardless of tips. This means they’re not as dependent on tips to get by,
and conversely tipping isn’t as compulsory as it is in the States. The card payment
terminals which always prompt for a tip are a very recent introduction and make everyone
uncomfortable.</p>
<h2 id="whatsapp">WhatsApp</h2>
<p>Nearly everyone in Europe uses WhatsApp, to the point that you might be lightly socially
ostracized if you don’t. Telekom, which <em>runs its own SMS communication network</em>,
allows you to contact their support via WhatsApp because it is so dominant. This has been
a great boon to Facebook and its group of aggressive PMs who want to make sure all your
contact data is harvested.</p>
<p>When I first moved here, you could use WhatsApp without giving access to your contact
list: you could type in a number and directly chat with a person. Then an update came and
the app refused to run unless you gave access. After a while it worked again
without having to give access (I conspiratorially think that Apple
forced them via app store policy), but a strange bug would occur: you could type
in a number directly and try to text them, but they “weren’t on WhatsApp.” Give the app
full access to all your contacts, and suddenly you could text that person. “Weird.”</p>
<p>I am perennially pissed off about this and I hope everyone involved feels bad about
themselves.</p>
<p>Update: <a href="https://www.nytimes.com/2024/10/02/technology/apple-social-apps-contacts-change.html?unlocked_article_code=1.UE4.fNpw.42cXdoBmoRc-&amp;smid=url-share">hahahahahahahahaha</a>.</p>
<h2 id="buying-stuff-on-sundays">Buying stuff on Sundays</h2>
<p>One thing you might get frustrated about is the lack of supermarkets that are open on
Sundays. This is a cultural thing that is supposedly not based on religion, but come on,
of course it is. There are a few gray areas: in Berlin there are some corner stores which are
open on Sundays and
some which aren’t. I’ve heard there is an informal agreement between corner stores who want to
stay open, and they simply don’t report each other so the compliance office doesn’t
investigate. In any case, there are some businesses which are allowed to legally operate on Sundays:
supermarkets can stay open as long as they’re in a train station and are targeted towards
travelers, and florists can sell cut flowers but not flowers in a pot. For everything else,
you have to hope your local corner store bends the rules a bit.</p>
<p>I don’t have any specific guidelines on how to get used to it, other than to adopt the
northern European tradition of <em>preparing for winter</em>. In the old days, you had to make
sure you stored enough potatoes in your cellar to last the winter, otherwise your family
would starve. Germans have somehow kept this mentality into modern times, and you can
sense the panic when someone realizes they don’t have enough groceries to last into
Sunday. Plan ahead, make sure you always have enough potatoes on hand, and be thankful for
what I can imagine is the only advantage of this system: extremely quiet Sunday streets.</p>
<h2 id="smoking">Smoking</h2>
<p>One thing I found unusual was how many people regularly smoked in Europe. Due to a variety
of factors, smoking dropped precipitously in my generation in the US (only to have vaping
take hold in the subsequent generation). This didn’t seem to translate over to here, and
people of all ages smoke in a variety of contexts. I don’t think I’ll forget the time
where I was eating lunch at the office and a coworker was having a conversation with
me, maintaining eye contact, while simultaneously rolling a cigarette. You don’t see that
often in the US!</p>
<p>Supposedly smoking has been legislated out of most public spaces in most of Germany, but
the Berlin nightlife industry fought hard against the regulations when they were being
crafted. Many bars in Berlin are smoking bars, and some restaurants even have a designated
smoking section walled off from the rest of the tables. I guess that’s one of the few
downsides of universal healthcare.</p>
<h2 id="testde--verbraucherzentrale">test.de / Verbraucherzentrale</h2>
<p>If you’re looking for a Consumer Reports or Wirecutter-like site in Germany, I can
recommend <a href="https://www.test.de/">test.de</a> or the
<a href="https://www.verbraucherzentrale.de/"><em>Verbraucherzentrale</em> (“consumer center”)</a>. In addition to product
reviews, they also
have good explanations and overviews of common insurances, guides for planning major life
events, etc. You do, however, have to have a decent German reading level to take advantage
of it.</p>
<h2 id="writing-letters--buying-a-printer">Writing letters / Buying a printer</h2>
<p>This is slowly changing, but Germany is absolutely a paper-based society. Until very
recently, the only guaranteed easy way to cancel subscriptions (gym memberships,
newspapers,
etc) was to mail a letter to terminate the contract. While you might be able to get away
with printing stuff at work or at a local copy shop, it can often be worth it to get a
home printer. I have a cheap black and white laser printer which has performed beautifully
and hasn’t needed a lot of toner. You might also want to look into getting a scanner to
scan and send copies of signed documents, although there are many apps that use your
phone’s camera to do this. It will make your life way easier if you can scan multiple
pages and combine them into a single PDF, reducing image quality to an acceptable file
size along the way. The iOS Files app and MacOS Finder/Preview can do this natively, but
the process can be annoying and can result in extremely high-resolution files that may be
difficult to transfer. Adobe has a scanning app that requires you to upload to their
cloud-based service. Microsoft Lens seems to be a good sweet spot: local storage, can
easily make PDFs of a normal size, and free.</p>
<h3 id="printing-envelopes">Printing Envelopes</h3>
<p>It’s not immediately obvious, but most printers have variable-width paper trays and will
happily print on DL envelopes (<em>DIN-Lang</em>, the standard envelope size for folded A4
paper). This is
great for people with bad handwriting, but it
is also super nice when combined with prepaid postage.</p>
<p>Google Docs doesn’t have envelope sizes natively, but you can install extensions to do
this. I’ve been using Apple Pages to make letters. The key is to select “Envelope,” and
make sure that the page size is set to ‘Envelope DL’. I’m sure Microsoft Word has a
similar thing.</p>
<p>If you’ve bought postage online, just drop it into the word processor and print the
address, return address, and postage all in one go.</p>
<p>I always kept loading the envelopes into the printer the wrong way, so I ended up
writing a little reminder on a label and sticking it near the printer tray so I
wouldn’t mess up again.</p>
<h2 id="subscriptions">Subscriptions</h2>
<p>Germany really locks you into yearlong subscriptions, so watch out. Gym memberships, cell
phone contracts, newspaper subscriptions, etc often have a minimum subscription amount
(usually a year or two years) and make it difficult to cancel. The government has passed
a law to require
simple cancellation online, but if that doesn’t work you’re often best off writing a
letter stating you’d like to cancel. There are many templates for this you can find
on the internet, but note that if you cancel in the middle of the initial period you’ll
likely have to pay until the period ends. Thankfully the law has now changed and you
should be able to cancel on a monthly basis after the initial period.</p>
<h2 id="dating">Dating</h2>
<p>In general, dating works similar to how it does in the US, with a few exceptions. One is
that dating apps can have a different connotation than what you’re used to. Tinder in the
US morphed from a hook-up app to a general dating service, but Germany was behind a few
years on that. For years I avoided Bumble as “a thing only Americans used,” only to
discover
that a much broader section of the Berlin population used it. Just be open to differences
from what you’re used to.</p>
<p>One thing that is a bit weird is everyone having profiles in English. I’ve heard of
stories where two Germans with English profiles figure out they’re German and switch
mid-chat. I think this mainly speaks to Berlin having a lot of non-German speakers (and
certainly a lot of non-German speaking tourists), so English is sometimes easier to start
off with. All I’m saying is don’t worry too much about your own profile being in English,
and don’t read too much into it if someone texts you in English.</p>
<p>Pro-tip: mention your test.de subscription in your profile and watch the matches come in
like crazy.</p>
<h2 id="following-the-rules">Following “The Rules”</h2>
<p>A particularly cheesy joke I once heard goes “do you know why crime is so low in Germany?
Because it’s illegal.” The extent to which rules and signs are just <em>followed</em> here can be
startling to someone accustomed to a more relaxed culture. It’s like the concept of a
“victimless crime” doesn’t exist here: even if you jaywalk at night when there are no cars
in sight, you’re still breaking the rules and that is, in itself, an offense. There are
two effects here.</p>
<p>One is that everyone trusts that everyone else follows the rules. When I was learning to
drive here, my driving instructor chastised me for looking left too much when turning
right at a T intersection. I was worried about people coming from the left who couldn’t
see me or wouldn’t let me turn. My teacher’s response: due to the “right before left”
rule (explained later in the “Driving” section), they would have to stop for me and I
should just trust that. Apparently it’s not
enough to follow the rules, you’re also expected to trust that everyone else is as well.</p>
<p>Two is that “the rules” can take precedence over communication and relationships. Noise
complaints from neighbors are a good example here. If I hear someone making a lot of noise
in an apartment, I use that as a starting point for a conversation with them. Maybe they
didn’t know the noise carried that much, or maybe we can work out an agreement where most
of the noise can happen when I’m not home. Unfortunately, what often happens is some
variant of “is it before 7pm? Then I’m allowed to do whatever I want!” It’s also limiting
for the people who are used to that environment – maybe something is against the rules,
but the neighbors don’t care. Instead of asking, they simply state that it’s against the
rules and automatically assume rejection – again, there is no “victimless crime.”</p>
<p>This is usually one of the more negative aspects of German culture that people cite, and
I can’t say I disagree. I don’t have much advice on how to navigate it except to notice
what gets people really freaked out and try to avoid those offenses. These usually
fall under:</p>
<ul>
<li>Noise during designated quiet hours</li>
<li>Improperly disposing of trash (including not folding boxes in the recycling bin)</li>
<li>Blocking cars (blocking pedestrians or bicycles doesn’t receive the same outrage)</li>
<li>Not lining up properly (I also get mad at this)</li>
<li>Not staying far enough to the right in a bike lane, even if it’s really narrow and no normal person would want to pass you.</li>
</ul>
<h2 id="real-shit-they-dont-want-you-to-know-about">Real shit “they” don’t want you to know about</h2>
<h3 id="worker-rep-on-the-board-_betriebsrat_">Worker rep on the board (<em>Betriebsrat</em>)</h3>
<p>A <a href="https://de.wikipedia.org/wiki/Betriebsrat"><em>Betriebsrat</em></a> is an elected “works council” made up of employees that must be consulted by
management on certain issues. Once a company gets large enough it must accommodate a works
council by law, so some see it as a way toward organized labor in a company.
A <em>Betriebsrat</em> doesn’t have the same power as a union, so it’s worth looking into what they
can and can’t do.</p>
<h3 id="_bildungsurlaub_"><em>Bildungsurlaub</em></h3>
<p>In most German states, you have the right to a “<em>Bildungsurlaub</em>.” This is paid vacation
you’re
allowed to take in conjunction with some kind of job or political training. It differs by
state, but in Berlin you get 5 working days each year which can also roll over,
allowing you take 10 days every two years.</p>
<p>You do have to pay for the class itself and any transportation or lodging.
There are almost always German classes available for this, and you’re
allowed to go anywhere there is a course available. I know a German who went to Vancouver
for two weeks to improve his English, and several of my English-speaking colleagues have
spent time in different parts of Germany improving their German. Of course, there’s
nothing preventing you from taking a German class in your city of residence, but sometimes
it’s nice to have a change of scenery.</p>
<h3 id="properly-opening-a-ritter-sport">Properly opening a Ritter Sport</h3>
<p>I opened Ritter Sports for years without knowing that you’re supposed to open them by
<a href="https://www.youtube.com/watch?v=0SaFuKPX03U">“snapping” them at the seam</a>. This opens them in a way such that the seam can be
resealed, to save the rest for later.</p>
<h2 id="transport">Transport</h2>
<h3 id="public-transit">Public Transit</h3>
<p>Of all the lifestyle upgrades I can think of, universal healthcare and pervasive public
transit are the two huge benefits of moving to Europe. Sure, there are plenty of cars
on the streets, but it’s far easier to take a bus, tram, subway, or commuter rail to your
destination than it is in virtually all of the US. It’s not perfect, but in general the
BVG (the Berlin public transit operator) will generally get you to where you need to go,
at a relatively quick pace. Not all areas of the city have a good connection, though.</p>
<p>However be careful about the ticket system: you have to buy your ticket <em>before</em> you get
on the train. Plainclothes ticket checkers (who are not fondly looked upon)
will spring into action once the doors close, and I’ve known people who have gotten fines
for not buying their tickets quick enough. If this happens, make sure to ask for a receipt
– ticket checkers have been known to scare tourists into paying cash on the spot and
pocketing the money.</p>
<p>Some, but not all, employers offer a discounted monthly transit ticket called a
<em>Jobticket</em> which is probably
worth it if offered. See the <em>Deutschlandticket</em> section for more details.</p>
<p>Google and Apple maps generally have decent transit directions. The BVG and VBB (the
transit operator for the greater Berlin and Brandenburg area) apps also have pretty good
routing. Transit and Citymapper are useful here, but aren’t often used.</p>
<p>One peculiar annoyance of the transit system here is that it can often be difficult to
know what station you’re at. The S-Bahn is particularly egregious here, as the signage
inside the train is often broken and the signage at stations is unlit and very difficult
to see (even more so at night, when the glare on
the windows makes it impossible to look outside). The newer S-Bahn trains make it even
worse – when the doors are about to close and the beeping starts, the screens in the
train switch to
what train it is instead of the current station. This makes it impossible to know where
you are without looking outside. For people like me who read articles on the train and
only react
to the beeps, it can be very stressful to look up and not know if you’ve missed your
stop or not. Oftentimes, the quickest way to tell which S-Bahn stop you’re at is to pull
out your phone and see where you are on Maps.</p>
<h3 id="bicycle">Bicycle</h3>
<p>Berlin’s cycling infrastructure is getting better over time<sup id="fnref:6"><a href="#fn:6" role="doc-noteref">6</a></sup>. In addition
to all the pop-up
bike lanes that appeared during the pandemic (which are being converted to permanent bike
lanes over time), the city is building a bike autobahn (bikeobahn?) to connect major parts
of the city. Cycling in Berlin is semi-accepted. It’s not as nice as Amsterdam or
Copenhagen, but it’s not as bad as anywhere in the US.</p>
<p>Certain areas of the city have relatively good infrastructure (Prenzlauer Berg, in
particular), while others don’t (Neukölln, Potsdamer Platz). When the infrastructure isn’t
good, cyclists are often crammed in with aggressive cars and the result isn’t pretty. I
don’t have good advice here other than to avoid the areas where possible. When it’s not
possible, I urge you to heed the words of a bike shop owner when I asked him how to turn
left on one of Berlin’s major thoroughfares: “do you want to assert your rights or do you
want to stay alive?” Getting a ticket for riding on the sidewalk (slowly, don’t be a jerk
and blow past pedestrians) isn’t so bad compared to dying, nor is it worth it to rush or
bend traffic laws on the road.</p>
<p>Speaking of traffic laws, you may want to read up on the <em>rechts vor links</em>
(“right before left”) rule which described in the driving section. It will
help explain why cars act strangely at 4-way intersections.</p>
<p>Regardless of how well built the cycling infrastructure in your neighborhood is, you will
always
encounter cycling’s second natural enemy behind cars: cobblestones (<em>Kopfsteinpflaster</em>).
These are purpose-built to ruin your day as a cyclist<sup id="fnref:7"><a href="#fn:7" role="doc-noteref">7</a></sup>. In addition to causing
extreme vibration while riding, enough to kick you off your bike if you’re going at anything
resembling a normal speed,
they can be spaced just wide enough to catch your wheel and send you flying. I’d like to
give a special shoutout to the bike lanes which are interrupted by driveways that use
cobblestones <em>just for the bike lane</em> – a special treat for everyone who wants to get
flipped off of their bike. For some reason they seem to be specially chosen and laid to
maximize the chances of catching your wheel.</p>
<p>You can fight cobblestones with a two-pronged approach: avoidance and acceptance. To avoid
them, I recommend the Beeline app. You should probably buy a <a href="https://beeline.co/">Beeline</a> anyway
since it’s a
great device, but I think you can use the app without purchasing the device and it works
as a great cycling navigation aid throughout Berlin. While it doesn’t know about
cobblestones specifically, it does let users rate streets and the routing takes that into
account. For those who want more detailed information, the “Berlin by Bike” website and
app use exact street data to minimize cobblestones as much as possible. Unfortunately I
find both interfaces effectively unusable, so I never end up using these. Google Maps can
route for cyclists but it has no concept of cobblestones and minimal understanding of
bike lanes, so it <a href="https://www.golem.de/news/fahrradtour-als-google-maps-mich-mehrfach-fast-umgebracht-haette-2209-168001.html">often puts cyclists in unpleasant or outright dangerous situations</a>. To
accept cobblestones, you can get a bike with wide tires or underinflate your tires to
absorb the impact (but not too much, or you’ll get a pinch flat). Getting springy grip
tape or wearing cycling gloves can help your wrists too.</p>
<p>Bike theft is definitely a concern around here, but not as much as I recall in SF. I
always followed the advice to bring two U-locks, one for the front wheel and one for the
back wheel/frame. Virtually nobody here seems to do that, and the foldy “D-locks” are
quite common around here. While practical, they offer less security. I’d say the general
consensus is to have a less valuable bike + less effective locking instead of valuable
bike + more effective locking. Another thing to be aware of: some of the bike racks are
too wide or too weirdly designed to be able to lock your rear wheel and frame together
with one U-lock. It might be worthwhile to invest in locking wheel skewers instead of
quick releases so you can care a little less when only one lock fits.</p>
<p>For some reason, despite Berlin’s reputation as a laid-back city (nobody is really in a
rush here), everyone is super aggressive in cars and on bikes. In addition, you also have
people who buzz past you at
especially dangerous times (intersections when the light just turns green, right when a
huge truck is passing centimeters away instead of just waiting a few seconds, the insanely
narrow bike “lane” on the bridge at Warschauer Straße), and otherwise general weird
behavior.</p>
<p>I don’t want to seem too negative here: cycling in Berlin is a great way to get around,
it’s free once you buy the bike and is great for your health. In addition to daily travel,
cycling out to Brandenburg for a long weekend can be a great experience. In summer, it’s
very popular to bike out to one of Berlin or Brandenburg’s many lakes and chill out for
the day. <a href="https://www.komoot.com/">Komoot</a> is a nice way to plan out one of these trips if you don’t know
anyone who knows the way. Enjoy it!</p>
<p>Finally, while you may not be able to vote, you can help your city become a more
bike-friendly place. I’d recommend joining your local ADFC chapter (that would be
<a href="https://berlin.adfc.de/">ADFC-Berlin</a> for the Berliners), who petition for better bike lanes, better
protection of
cyclists, and overall encourage a more bike-friendly city. In Berlin they also organize
the ADFC <em>Sternfahrt</em> (“rally”), for those who want a tamer Critical Mass experience.</p>
<h3 id="regional-and-long-distance-trains">Regional and Long-distance Trains</h3>
<p>Germans love to complain about the Deutsche Bahn, and there’s plenty to complain about –
the general opinion is that it’s a corrupt organization that was affected by the same
privatization spree that created the Deutsche Post. Recent
<a href="https://www.zugfinder.net/en/stationboard-Berlin">dismal on-time performance</a> has
not helped this impression, and trying to understand exactly <em>why</em> DB has such structural
problems is a hobby in and of itself.</p>
<p>However, overall <em>there are trains</em> and <em>the trains actually run</em>. You can reasonably
traverse the country by train, and if you don’t mind paying a bit extra for a high-speed
train you can get from any big city to another in maybe 7 hours tops.</p>
<p>Deutsche Bahn has some confusing pricing for the uninitiated, so I’ll try to explain it
below.</p>
<h4 id="second-class-_flexpreis_">Second-class <em>Flexpreis</em></h4>
<p>The basic ticket is the second-class <em>Flexpreis</em> (“flexible-ticket price”) ticket. This kind
of ticket works like a
public-transit ticket: just like a subway or bus ticket, with a <em>Flexpreis</em> ticket you can
take any train that day to your destination. Also like a subway or bus ticket, there is no
seat reservation: it’s a free-for-all and you may get lucky or not depending on demand.
This also means that DB can’t fundamentally do capacity control for second class. They
try to predict demand and tell you on the website, but there’s nothing stopping 200 people
showing up to ride the same train and filling up all possible space in the car.</p>
<p>The flexibility makes this kind of ticket most useful for commuters who don’t know the
exact time they’ll take a train and don’t mind if they don’t get a seat, since it won’t be
that long of a ride anyway. Reserved seats can be purchased afterward if you settle on a
particular train and think it might be busy.</p>
<h4 id="second-class-_sparpreis_">Second-class <em>Sparpreis</em></h4>
<p>The second-class <em>Sparpreis</em> (“savings price”) ticket is exactly like the <em>Flexpreis</em> ticket
except you have to pick a specific train to ride on. This changes the ticket from a
public-transit style ticket (“take any train going that direction”) to something more like
flying: you have a specific train to catch and can’t substitute it with another one. The
upside is that <em>Sparpreis</em> tickets are usually much cheaper, depending on how busy the train
is and how far out in advance you buy it. A funny consequence of this pricing model is
that the <em>Sparpreis</em> starts cheap and rises to eventually match the cost of the_Flexpreis_
ticket – at which point you can just buy a <em>Flexpreis</em> ticket, since that lets you ride on
any train that day anyway.</p>
<p>Like <em>Flexpreis</em> tickets, second-class <em>Sparpreis</em> tickets also do not come with a seat
reservation. Unlike <em>Flexpreis</em> tickets, most people buying <em>Sparpreis</em> tickets are buying for
some kind of long-distance vacation or business trip. For some routes and times of day
it’s not worth reserving a seat since it will almost certainly be empty, but if you’re
wrong you’ll be standing in the aisle for 5 hours straight. Another annoyance is that the
seat you pick may be reserved for part of your journey, meaning you’ll have to shuffle
around and find another one. Finally, there are the “<em>ggf. freigeben</em>” seats.
<em>Ggf. freigeben</em> (German for “lol, you thought this would be easy?”) means that the
seat may or may not be reserved, and they don’t know due to technical reasons. If you sit
there, you’ll have to wait the entire ride to see if someone actually did reserve it or not.</p>
<p>After getting burned a few times, I’ve just committed to paying the extra few Euro to
always get a reserved seat. If you plan to save the cash, just be prepared to stand in the
aisle/vestibule or shift seats a lot.</p>
<h4 id="first-class">First-class</h4>
<p>First-class on a DB train isn’t like first-class on a plane: you get slightly more
legroom, and occasionally someone will take your food or drink
order so you don’t have to go to the dining car yourself. It used to be a better deal on
emptier trains since you used to get a free seat reservation included, which often made
a first-class ticket only a few more Euro than a second-class ticket with seat
reservation. Sadly seat reservations
<a href="https://web.archive.org/web/20230613062354/https://www.bahn.de/info/kleiner-fahrplanwechsel-juni-23">are no longer included with first-class tickets anymore</a>.</p>
<h4 id="bahncard">BahnCard</h4>
<p>If you plan to do any regular traveling with DB, I highly recommend getting a BahnCard. A BahnCard
25 can rapidly pay for itself after a few trips. These are prepaid discount cards that
come in six major flavors:</p>
<ul>
<li>First- and second- class BahnCard 25</li>
<li>First- and second- class BahnCard 50</li>
<li>First- and second- class BahnCard 100</li>
</ul>
<p>The BahnCard 25 is what applies to most people – you get 25% off of the various kinds of
<em>Sparpreise</em>, sometimes including train travel outside of Germany. The first-class BahnCard
also gives you the 25% benefit on second-class tickets, but not the other way around, so
it only makes sense to have one and not both.</p>
<p>The BahnCard 50 makes the most sense for commuters who need the flexibility of a <em>Flexpreis</em>
ticket, it gives you 50% off of <em>Flexpreise</em> as well as 25% off of <em>Sparpreise</em>.</p>
<p>The BahnCard 100 is for high-rollers. It lets you ride <em>any</em> train on the system, although
you only get a certain number of free seat reservations to go along with it. I only know
of people who get BahnCard 100s through their work, similar to having a company car.</p>
<h4 id="49-euro-ticket--_deutschlandticket_">49 Euro Ticket / <em>Deutschlandticket</em></h4>
<p>This is a relatively new offering that was originally introduced in 2022 during the
outbreak of the Russian invasion of Ukraine to reduce German’s reliance on fossil fuels.
Its success led to the current version with a higher price but more sustainable funding
from the government. The <em>Deutschlandticket</em> allows you to ride any regional, non-high-speed
train, as well as public transit in any city, in all of Germany for €49 a month. This
means you can ride from your apartment to the train station in Berlin using Berlin public
transit, a regional train from Berlin to Hamburg, and Hamburg public transit to your
hotel, all on the same ticket, which costs €49 a month. This is not only a great deal, but
an impressive achievement that they managed to unify the transit networks of every city in Germany. As you
can imagine, many people now opt for the <em>Deutschlandticket</em> instead of single-city subscriptions. You buy it through your local transit
agency, and there are even <em>Jobticket</em> variants you get through your employer that cost a little less.</p>
<p>A small caveat: the <em>Deutschlandticket</em> counts as a second-class ticket on regional trains,
and can’t be combined with a first-class “upgrade” ticket. If you want to ride first-class
on a regional train, you need to pay the full price. Additionally, there are no refunds if
a train gets canceled or delayed. If you are planning on using the <em>Deutschlandticket</em> to
catch a <em>Sparpreis</em> express train somewhere else, it’s probably better to buy a ticket for the whole
journey so you can be rerouted or reimbursed if something goes wrong.</p>
<h4 id="booking">Booking</h4>
<p>Booking trains within Germany is pretty easy – just go to the DB website. Booking trains
to neighboring countries through DB is also generally pretty good. Unfortunately, there is
no unified European train search and booking system, and the accuracy and bookability of
train search falls off steeply as you go further away from Germany. <a href="https://www.omio.com/">Omio</a> provides a
Europe-wide train search in theory, but it’s not as good as Google Flights, Kayak, etc.
Seems like a great opportunity for a scrappy startup to build something!</p>
<p>Sometimes you might get cheaper prices or different conditions if you book trips through
the Austrian rail line (<em>ÖBB</em>) instead of DB.</p>
<p>For longer-distance trips, <a href="https://www.rome2rio.com/">Rome2Rio</a> can provide some good connections that you might not
otherwise think about. There is also <a href="https://www.blablacar.com/">BlaBlaCar</a> which helps you organize long-distance
carpools, but I haven’t used it.</p>
<h3 id="driving">Driving</h3>
<p>I recently got my German driver’s license after converting it from a California one.
Unfortunately California doesn’t offer an exchange with Germany, so I had to go through
almost the whole driving school process here. Exchanging my license meant I needed fewer
required driving hours, didn’t have to do any “special” driving hours (like night driving
or Autobahn driving), and it meant that I could skip any theory classes as long as I
tested ok. Note that the exchanged license only has to be valid when you make the initial
application – if your license expires between the application and when you pass your
exams, everything should still be ok as long as the application itself is valid. If you’re
thinking about exchanging your license, do it while you still can.</p>
<p>An exchanged California license, assuming you don’t need too many practice driving hours,
will cost you roughly €1500 - €2000. That’s the school fees, the fees to use their
“learning platform” (an app to go through all the theoretical exam questions), some
administrative fees they charge whenever they talk to the license office or sign you up for a test,
and the practice driving hours. To help you estimate, I needed about 11 practice hours
in total, at a rate of about €80/hr. The schools aggressively hide their fees online, but
usually if you ask or sign up they have a published fee sheet somewhere.</p>
<p>I went to the license office to directly apply for the exchange, but I think that was really
the wrong order. I had to supply a driving school and test location, so I think the proper
order would have been to sign up with a driving school first. From what I understand, most
if not all schools will handle all the license office paperwork themselves (with an implied fee, of
course).</p>
<p>I had to take the theoretical and practical exam, as if I had never driven before. The
practical was relatively straightforward, but I recommend reading up on Reddit to avoid
common pitfalls. I found practicing for the theoretical exam way harder. The wording of
all the questions is quite tricky, so even if your German is passable it might be better
to take the exam in English, even though the translations aren’t great.</p>
<p>Finally, there are two things I’d want to stress when learning to drive: right-before-left
and where the speed limit signs are.</p>
<h4 id="right-before-left">Right before left</h4>
<p>This is a rule that, as far as I can tell, only exists in Germany and the Netherlands. In the US, there is the
concept of a 4-way stop sign at an intersection. Germany doesn’t have that. At a 4-way
intersection without a traffic light, the <em>rechts vor links</em> (“right before left”) rule applies: you have to
yield to everyone to the right of you. Before you go “oh yeah, that makes sense” I almost
assure you that you don’t understand it. There is no cycling of cars as people take turns,
literally everyone to the right of you goes ahead while you wait, and only when the right
is clear do you go (the people left of you are waiting on you). Imagine that every
intersection had a default sign that said “yield to all cars on the right.”</p>
<p>This rule applies basically everywhere there aren’t traffic signs, not just at 4-way
stops. If there is a road to the
right of you, you have to slow down to see if anyone is coming and yield if anyone is
there. The only exceptions are if it’s a “road with a curb” (meaning a driveway), a
lesser class of road (a dirt road when you’re on a paved one), or if you have a street
sign telling you have right of way or are on a “priority road” (the most common being a
yellow diamond inside a white diamond). This means that in a parking lot, if someone is
arriving to the right of you, you have to yield.</p>
<p>It’s complicated enough driving through the city trying to figure out if the road to the
right of you is a real road or a driveway, but there’s another curveball thrown into the
mix: the sign that tells you that the priority road curves right or left. Usually in these
scenarios I stop my car and write a Prolog program to solve the logic puzzle of
what to do, especially if you want to turn left into oncoming traffic. One nice
shortcut: if you’re on a priority road that curves left, you always have right-of-way no
matter what you’re doing.</p>
<h4 id="where-the-speed-limit-signs-are">Where the speed limit signs are</h4>
<p>This seems trivial, but I found it very frustrating while driving around town. In Germany,
the speed limit signs are posted directly <em>at</em> the intersection, and not after.
Additionally, there is a default speed limit if you <em>don’t</em> see any sign (50km/h within
cities, 100km/h outside). Since I’m usually looking at pedestrians and other cars when
turning at an intersection, I kept missing traffic signs when I was first learning to
drive here. While you’re walking on the street (meaning, in a non-stressful situation),
keep an eye out for them to see where they should be.</p>
<p>Be sure to note the change in default speed limit I mentioned above. Make a mental note
that <em>every</em> time you see a “welcome to X city” sign, you slow down to 50km/h.</p>
<p>Finally, speed limit signs on some roads can be on the <em>left</em> side of the road as well
as on the right – these can be more difficult to see on wider streets, so try to
keep an eye out for them.</p>
<h2 id="medical">Medical</h2>
<p>The medical system in Germany is good, regardless of whether you have public or private
health insurance. In general it helps to know German to navigate the system, but a few
tips can make it a bit easier.</p>
<h3 id="emergencies">Emergencies</h3>
<p>If you have a medical emergency, dial 112 and get an ambulance – make sure to state the
street address first, so if the call gets cut off they still know where to go. The number
to call the police in emergencies is 110. I struggled for a while to remember which was
which – 110 or 112 – until I saw a cheesy poster for a fire brigade’s recreational
rowing team: “We give 112 percent!” It took me a second, like “oh god, 110% isn’t good
enough?” followed by “oohhhhhh.”</p>
<h3 id="getting-an-appointment">Getting an appointment</h3>
<p>With public insurance, it can be hard to find an appointment for your doctor. Some of them
only make appointments by phone, but a growing number schedule patients online via
companies like Doctolib,
Jameda, or Samedi. For specialists it may not be a big deal, but I really recommend
finding a <em>Hausarzt</em> (“primary care physician”) that reliably schedules appointments
online. Some health insurances
offer appointment-making services (Techniker Krankenkassse, for example, has an English
language appointment
hotline), but I don’t have much experience with that.</p>
<p>One bright spot is that you often don’t have to make an appointment to refill a
prescription – usually you can call the doctor’s office, ask for a refill, and you can
pick the prescription up when convenient. Sometimes they’ll even mail it to you!</p>
<h3 id="krankschriebung">Krankschriebung</h3>
<p>With most non-freelancer jobs, if you get sick you’re allowed to take off work for a few
days, but on the third day you’re required to go to a <em>Hausarzt</em> and get
<em>krankgeschrieben</em> (“written off sick”). That process
itself is kind of annoying – most practices won’t give them out over the phone, so you
usually have to go in person while having a cold, just to get a piece of paper saying you
have a cold. At least it’s better than being forced to work while sick. There is
no concept of a fixed amount of “sick days” here and Germans are appalled at the concept.</p>
<h3 id="_überweisungen_"><em>Überweisungen</em></h3>
<p>In the German healthcare system, the <em>Hausarzt</em> is the
gatekeeper for basically all your medical needs. Unless it’s an emergency, you usually
have to see the <em>Hausarzt</em> first before seeing any kind of specialist. The magical
document you need to see a specialist is the <em>Überweisung</em> (“referral”). This is why I
recommended in the previous section that you should really try to find a <em>Hausarzt</em> that’s
easy to book appointments with.</p>
<p>The setup can get a little frustrating at times, since you’re just making an appointment
to get permission to make a different appointment with someone else. It’s also a little
weird because, in theory, you can go to any <em>Hausarzt</em> to do this, not just your main one
(although you may get funny looks if you show up to a new practice with an unusual
request).</p>
<h3 id="rezepte">Rezepte</h3>
<p>A more familiar concept is that most medicine requires a <em>Rezept</em> (“prescription”)
from a doctor in order to pick it up at an <em>Apotheke</em> (“pharmacy”). Despite all the talk of
digitized patient records and “<em>E-Rezepte</em>,” Germany is still a very paper-based society
and you’re likely going to have to bring a stupid piece of paper with you every time you
need to pick up medication. Occasionally you can ask the doctor’s office to send it
directly to the <em>Apotheke</em> if it’s one nearby or you have their fax number handy.</p>
<h3 id="apotheke--over-the-counter">Apotheke / Over the counter</h3>
<p>What’s weird about the <em>Apotheken</em> is that they’re weird amalgams of prescription
medication depots, advisors for over-the-counter medication, and beauty product stores.
You can’t just <em>buy</em> NyQuil here, you have to go up to a person, do a little song and
dance, and hope that you’ve convinced them enough that you get the product that you want.
This goes a little smoother when you <em>don’t</em> know what product you want, as the
pharmacists are usually pretty well trained to help you find what you need. A word of
caution, however – Germans are very medication-averse, so don’t be surprised to get
“herbal” treatments when you expected the real stuff. Sometimes you can explicitly ask for
a medically proven active ingredient, but sometimes you may walk away empty-handed.</p>
<p>I am still astonished that homeopathic “treatments” are not only offered in pharmacies
here, but sometimes <em>actively recommended</em> by pharmacists and doctors! It may sound
like a perverse application of <a href="https://en.wikipedia.org/wiki/Godwin%27s_law">Godwin’s law</a>, but you can literally
<a href="https://quackwatch.org/hx/nazis/">blame the Nazis</a> for this one.</p>
<h3 id="mental-health">Mental Health</h3>
<p>One big failure in the German health system is how mental health is handled. Finding a
German-speaking therapist or psychiatrist is difficult enough, let alone an
English-speaking one.
Supposedly the problem is that the calculation for the number of practitioners
approved in an area by statutory insurance was set in the 90s and was never updated.
If you have statutory insurance and don’t want to wait a year to see a practitioner
(this is not an exaggeration), you’ll often have to just pay the full price out-of-pocket.</p>
<p>Private insurance has a much better track record in this regard, but that means mental
health services are in some ways reserved for the rich.</p>
<p>There is a process to get statutory
insurance to reimburse you for a private practitioner if you can prove that everybody in
your area is full. It’s a complicated process, but some practitioners might be able to
help you navigate it. You will have to pay out-of-pocket to get started, though.</p>
<p><em>The Berliner</em> has a good <a href="https://www.the-berliner.com/berlin/how-to-get-therapy-in-berlin-germany-mental-health/">overview of the whole situation</a> and how to
deal with it.</p>
<h2 id="food">Food</h2>
<p>The food system in Europe is in some ways pretty awesome, and in other ways quite
limiting.</p>
<h3 id="bread">Bread</h3>
<p>European bread is on another level. For my entire life, “bread” lasted for weeks in the
cupboard. It turns out, that’s what makes Wonderbread <em>wonder</em> bread – it has
preservatives in it to make it last far longer. Normal bread only keeps for a few days!</p>
<p>The demand for fresh bread has created a whole supply chain and distribution network
for fresh baked goods that easily outclasses that in the US. Gas stations and train
stations don’t have shrink-wrapped cheese danishes with year-long shelf lives. They have
pastries baked daily, and often freshly made little sandwiches with meat and cheese.
Cities themselves are dotted with bakeries, and often you’ll be within walking distance
of several of them.</p>
<p>That’s not to say that there are variations in quality – you can definitely taste the
difference between an industrially baked croissant and one made locally at the bakery
itself – but the average quality is much higher and the variance much lower.</p>
<p>What you gain in quality you pay for in choice – often you’ll only find the same
variation of the same few pastries or bread types. You’ll occasionally find a fun thing,
but a step into an American supermarket will remind you of the shocking emphasis they have
on having 10 different brands of peanut butter.</p>
<h3 id="cheese--dairy">Cheese / Dairy</h3>
<p>Like bread, cheese is one of Europe’s core competencies. The average supermarket will have
an intimidating cheese selection, both from pasteurized and unpasteurized milks of
various mammals.</p>
<p>If you’re a cheese eater it’s definitely worth trying out some random ones, being open to
the fact that some of them taste or smell downright terrible. I can’t stomach camembert or
brunost but there are a lot of good cheeses I’ve discovered while I’ve been here. Note
that unpasteurized cheese can come with some health risks, but if you’re not
immunocompromised or pregnant it’s usually ok.</p>
<p>What may be a bit unsettling is seeing unrefrigerated milk and eggs. Eggs are not
washed in Europe like they are in the States, which leaves on a protective coating that
lets them last at room temperature much longer. Refrigerating them just extends this
longer, and a close read of the label will show two expiration dates depending on if
they’re refrigerated or not. Similarly, ultrapasteurized milk is milk that stays good for
months at room temperature, but needs to be refrigerated once open.</p>
<h3 id="meat">Meat</h3>
<p>Meat in Europe is generally handled similarly to meat in the US, with a big exception:
pork is better handled here, and (with proper preparation) can be eaten undercooked or
even raw. I’ve eaten <em>Mett</em> (“pork tartare”) and lived to tell the tale, but it took some courage to do it.
It’s common to have cured but not cooked bacon for breakfast. Everyone keeps saying it’s
safe, but it takes a lot to undo an entire lifetime of avoiding uncooked pork.</p>
<h3 id="coffee">Coffee</h3>
<p>Coffee, as in the States, serves a dual purpose as “concentration fuel” and gourmet
experience. However, the latter is emphasized far more than the former. This means that
filter coffee from a carafe is readily available at gas stations and other places where
you’re just trying to get from point A to B, but quite rare to get at a restaurant.
Sometimes you’ll get lucky and a <em>Milchkaffee</em> (“milk coffee”) will be filter coffee with cream, but often
the only way to get anything approaching filter coffee is to admit defeat and order an
americano. I’ve adapted by ordering cappuccinos all the time.</p>
<p>The concept of unlimited filter coffee is foreign here, to the point that when a (sadly
now closed) American diner in Berlin offered it, it was a point of conversation for both
Americans and non-Americans alike. Living abroad means excitedly saying things like “they
had the coffee carafes, like from Denny’s, and the waiter just walks around filling up
your mug!”</p>
<h3 id="alcohol">Alcohol</h3>
<p>Yes, you really can drink beer on the street! The European attitude toward alcohol is far
more relaxed, and in my opinion more healthy. Because it’s everywhere and not strictly
controlled and locked down, people binge drink less. That’s not to say that people don’t
binge drink (how else could you explain the existence of Schlager music?) but it’s far
more acceptable to socially drink in small quantities. I think the stronger public transit
options and weaker Puritan influences drive the shocking (to Americans) attitude toward alcohol here.</p>
<p>Fun fact: the drinking age is 21 in the US because the National Highway Board found
that drunk driving accidents fall off sharply after 21 years of age, and <a href="https://en.wikipedia.org/wiki/National_Minimum_Drinking_Age_Act">therefore states
don’t get federal highway funding</a> if their legal drinking age is under 21. Sucks if you don’t drive, I guess.</p>
<h4 id="wine">Wine</h4>
<p>I’m not a knowledgeable wine drinker, but wine is both cheaper and of higher quality in
Europe than what I’ve seen in the US. Enjoy!</p>
<h2 id="navigation">Navigation</h2>
<p>From here you can go on to the <a href="https://wickedchicken.github.io/post/programmer-in-berlin-language/">language</a> section or back to the
<a href="https://wickedchicken.github.io/post/programmer-in-berlin-finances/">finances</a> section.</p>

 </div>
    


  
  



</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Nvidia and its partners built a system to bypass U.S. export restrictions (318 pts)]]></title>
            <link>https://twitter.com/kakashiii111/status/1853433531260649532</link>
            <guid>42048065</guid>
            <pubDate>Tue, 05 Nov 2024 02:20:46 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://twitter.com/kakashiii111/status/1853433531260649532">https://twitter.com/kakashiii111/status/1853433531260649532</a>, See on <a href="https://news.ycombinator.com/item?id=42048065">Hacker News</a></p>
&lt;Unparsable&gt;]]></description>
        </item>
        <item>
            <title><![CDATA[Meta Permits Its A.I. Models to Be Used for U.S. Military Purposes (107 pts)]]></title>
            <link>https://www.nytimes.com/2024/11/04/technology/meta-ai-military.html</link>
            <guid>42048009</guid>
            <pubDate>Tue, 05 Nov 2024 02:06:35 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nytimes.com/2024/11/04/technology/meta-ai-military.html">https://www.nytimes.com/2024/11/04/technology/meta-ai-military.html</a>, See on <a href="https://news.ycombinator.com/item?id=42048009">Hacker News</a></p>
Couldn't get https://www.nytimes.com/2024/11/04/technology/meta-ai-military.html: Error: Request failed with status code 403]]></description>
        </item>
        <item>
            <title><![CDATA[Pagination widows, or, why I'm embarrassed about my eBook (2023) (207 pts)]]></title>
            <link>https://clagnut.com/blog/2426</link>
            <guid>42047677</guid>
            <pubDate>Tue, 05 Nov 2024 00:58:11 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://clagnut.com/blog/2426">https://clagnut.com/blog/2426</a>, See on <a href="https://news.ycombinator.com/item?id=42047677">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
<p>The physical copies of <a href="https://book.webtypography.net/">my book on Web Typography</a> sold out quickly. I self-published, and print runs are expensive when you’re funding them yourself, so numbers were limited. However it was always my plan to publish an ebook at the same time, and that has out-sold the hard copy by an order of magnitude.</p>

<p>I set myself some pretty stiff criteria for the ebook – it needed to replicate the design of print edition as far as possible, adapting to the medium when required. To this day I’m proud of the result. I completely hand-coded the <a href="https://www.w3.org/TR/epub-33/">ePub</a> (meaning it’s mostly <abbr>HTML</abbr> and <abbr>CSS</abbr> under the hood), and I believe the effort paid off. If you’ll forgive the rather un-British boasting, I still think it’s one of the more advanced ebooks out there: with embedded fonts, <abbr>SVG</abbr> images, alt text, bold typographic heirarchy, Javascript-driven syntax highlighting and what I hope is a nuanced, highly readable overall design. Not bad for an ebook anyway, although I’ll grant you the bar is not set high (notable exceptions include <a href="https://abookapart.com/">A Book Apart</a> publications).</p>

<p>All hubris aside, I am still frequently embarrassed by how the ebook renders, particularly in Apple Books. Like a well structured webpage, my book uses a lot of headings and subheadings – I wrote it to be referenced as much as to be read, so this helps the scanability of the text. However Apple Books, and other WebKit, Gecko, or old Blink-powered ebook readers will happily do this to headings:</p>

<figure><img loading="lazy" src="https://clagnut.com/images/2426/ebook-widows.png" alt="Screen shot of Apple Books rendering an ePub"></figure>

<p>Notice the orphaned heading “Lean on six centuries of typesetting&nbsp;experience” with its following paragraph out of sight on the next page. This is a typographic no-no, and has been for – um – six centuries. Far better for the reader to have the heading attached to its paragraph on the next page, even if that means leaving some redundant whitespace in its place.</p>

<p>Since 1997(!) and the early drafts of <a href="https://www.w3.org/TR/WD-CSS2-971104/page.html#h-12.2">CSS2</a>, there has been an easy way to tell browsers not insert a page break directly after, or in the middle of, a heading:</p>

<figure><div data-element="code-block"><pre><code>h2 {
    page-break-after: avoid;
    page-break-inside: avoid;
}
</code></pre></div></figure>



<figure><div data-element="code-block"><pre><code>h2 {
    break-after: avoid;
    break-inside: avoid;
}
</code></pre></div></figure>

<p>However 26 years later, <code>break-after:avoid</code> is still not supported by either Safari or Firefox, and was only <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=223068#c54">introduced to Chrome 108</a> in December 2022. I’ve put together a <a href="https://codepen.io/clagnut/pen/MWZRBaM">test for support of <code>break-after</code> and <code>break-inside</code></a> in multi-column layout. Have a play with it in Chrome – try removing <code>break-inside:avoid</code> and then <code>break-after:avoid</code> from the <code>h2</code> rule in the <abbr>CSS</abbr> and you should see how the subheadings end up at the bottom of a column, or worse still, split over two columns.</p>

<p>Browser support for <abbr>CSS</abbr> properties tends to follow demand from web developers. Unlike in 1997 – or indeed 2017 – there is now an annual Interop arrangement between browser rendering engine makers in which they agree a common list of priorities for <abbr>CSS</abbr> and other web technologies. Interop 2024 has just closed for new proposals. Unfortunately I didn’t manage to submit a request in time for breaking controls to be universally implemented. Thankfully Scott Kellum of <a href="https://typetura.com/">Typetura</a> did put in a <a href="https://github.com/orgs/web-platform-tests/projects/3/views/1?pane=issue&amp;itemId=40510069">proposal for advanced multi-column layouts</a> to be improved, and this included support for <code>break-</code> properties. Sadly there’s little to no clamour for it from other developers – the blog post you’re reading probably doubles the published demand, and that’s just for within columns.</p>

<p><ins><strong>Update:</strong> Annoyingly the proposal <a href="https://github.com/web-platform-tests/interop/issues/520#issuecomment-1921897115">was not selected</a> for Interop 2024.  I'll just have to keep prodding the bug reports and keep my fingers crossed they are fixed soon – <strong>these bugs are older than some of my colleagues!</strong></ins></p>

<p>Paged media is very much a forgotten aspect, and it’s probably true that web pages are rarely printed in the grand scheme of things, however ebooks are definitely a popular form of paged media and deserve attention. I’d certainly like to read ebooks without failed typographic fundamentals.</p></section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Low-poly image generation using evolutionary algorithms in Ruby (2023) (101 pts)]]></title>
            <link>https://thomascountz.com/2023/07/30/low-poly-image-generation</link>
            <guid>42047320</guid>
            <pubDate>Mon, 04 Nov 2024 23:50:49 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://thomascountz.com/2023/07/30/low-poly-image-generation">https://thomascountz.com/2023/07/30/low-poly-image-generation</a>, See on <a href="https://news.ycombinator.com/item?id=42047320">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
  

  <p>Inspired by biological systems, evolutionary algorithms model the patterns of multi-generational evolution in order to unearth unique ideas. They work by generating a vast number of potential solutions to a particular problem and then pitting them against each other in a process akin natural selection: only the fittest survive. In this way, evolutionary algorithms are able to navigate large ambiguous search spaces in order to find solutions to problems that may be difficult or inefficient to solve using other methods.</p>

<p>These algorithms are used for a wide variety of tasks: from optimizing neural network parameters, evolving mechanical structures, simulating protein folding, and even generating art!</p>

<p>Today, we will use one such algorithm to create a low-poly version of the Ruby logo, using Ruby<sup id="fnref:why_ruby" role="doc-noteref"><a href="#fn:why_ruby" rel="footnote">1</a></sup>.</p>



<div>
  <div>
    <p><span>Generation:</span>
      <span>0000</span>
    </p>
    <p><span>Max Fitness:</span>
      <span>0078.1640</span>
    </p>
    <p><span>Time (seconds):</span>
      <span>0001.03</span>
    </p>
  </div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/out/gen-0000.png">
  </p>
  </div>



<p>In this post, we’re going to be using the <a href="https://github.com/thomascountz/petri_dish">petri_dish_lab</a> gem for the task of <em>image reconstruction</em>. Image reconstruction is a great example to use because we’ll be able to visualize the evolutionary process working over time.</p>

<p>We’ll begin by going over what an evolutionary algorithm is and how it works. Then, we’ll take a look at the Petri Dish framework and how we can use it to implement an evolutionary algorithm. Next, we’ll define the objective of our image reconstruction problem and how we can represent it in code. Then, we’ll define the genetic operators that we’ll use to evolve the population. Finally, we’ll put it all together and see the results!</p>

<blockquote>
  <p>🧑‍💻 <a href="https://github.com/thomascountz/petri_dish"><strong>Code Here</strong></a><br>
The complete code for this blog post can be found as an example in the <a href="https://github.com/Thomascountz/petri_dish/tree/main/examples/low_poly_reconstruction"><code>examples/low_poly_image_reconstruction</code></a> directory of the <a href="https://github.com/thomascountz/petri_dish">Petri Dish</a> repository.</p>
</blockquote>

<blockquote>
  <p>🔷 <strong>What is a Low-Poly Image?</strong><br>
A Low-poly image is a type of 2-D image that’s created by a series of variously sized polygons. Usually, each polygon shares at least one edge with another, and they do not overlap. By using different colors and varying the total polygon count, the result is a low-resolution version of an image.</p>
</blockquote>



<h2 id="table-of-contents-">Table of Contents <!-- omit in toc --></h2>

<ul>
  <li><a href="#evolutionary-algorithm-overview">Evolutionary Algorithm Overview</a>
    <ul>
      <li><a href="#the-petri-dish-framework">The Petri Dish Framework</a></li>
    </ul>
  </li>
  <li><a href="#understanding-the-objective">Understanding the Objective</a></li>
  <li><a href="#member-representation">Member Representation</a>
    <ul>
      <li><a href="#input-target-image">Input <em>Target</em> Image</a></li>
      <li><a href="#member-genes">Member Genes</a></li>
      <li><a href="#reconstructed-output-image"><em>Reconstructed</em> Output Image</a></li>
    </ul>
  </li>
  <li><a href="#population-initialization">Population Initialization</a></li>
  <li><a href="#fitness-function">Fitness Function</a></li>
  <li><a href="#genetic-operators">Genetic Operators</a>
    <ul>
      <li><a href="#parent-selection-function">Parent Selection Function</a></li>
      <li><a href="#crossover-function">Crossover Function</a></li>
      <li><a href="#mutation-function">Mutation Function</a></li>
      <li><a href="#replacement">Replacement</a></li>
      <li><a href="#end-condition">End Condition</a></li>
    </ul>
  </li>
  <li><a href="#putting-it-together">Putting it Together</a>
    <ul>
      <li><a href="#final-configuration">Final Configuration</a></li>
    </ul>
  </li>
  <li><a href="#results">Results</a>
    <ul>
      <li><a href="#subjective-analysis">Subjective Analysis</a></li>
      <li><a href="#data-analysis-and-interpretation">Data Analysis and Interpretation</a>
        <ul>
          <li><a href="#log-data">Log Data</a></li>
          <li><a href="#image-data">Image Data</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#conclusion">Conclusion</a></li>
  <li><a href="#footnotes">Footnotes</a></li>
</ul>



<h2 id="evolutionary-algorithm-overview">Evolutionary Algorithm Overview</h2>

<p>Evolutionary algorithms are optimization algorithms that “search” through an expansive space of potential solutions. The goal of a search algorithm is to find a solution that satisfies some criteria, or <em>objective</em>. Evolutionary algorithms are particularly good in cases where we want a solution that is “good enough,” rather than an absolute optimum. In our case, we want to find a set of polygon vertices and grayscale values that, when combined, approximate a given image. For this usecase, there’s no one “best” solution, so evolutionary algorithms are a good fit.</p>

<p>The image reconstruction process begins by creating a bunch of images with random polygons. We’re going to use triangles, but we could technically use any shape, and we’ll stick to grayscale colors in order to make the problem a bit simpler. This collection of images is called the <em>population</em>, and each image is called a <em>member</em> of the population.</p>

<p>Once we have a bunch of random guesses, we compare each member to the target image, pixel-by-pixel, to determine their likeness to the target. This <em>measure of likeness</em> is what we refer to as their <em>fitness</em>, and will be determined by how close each pixel is to the correct grayscale value.</p>

<p>Based on their fitness, <em>parent</em> members are then chosen and combined to create a new <em>child</em> member in a process called <em>crossover</em>. The way we select and crossover parent members is by using <em>selection</em> and <em>crossover</em> functions, and we cover these function (along with <em>mutation</em> functions, which mirror the biological process of genetic mutation by injecting random changes into the child member) later. Together, these functions are called the <em>genetic operators</em>. The exact implementation of these operators is perhaps the most important part of developing an evolutionary algorithm, and we’ll spend a lot of time on them later. If you’re familiar with machine learning, you can think of the genetic operators as <em>hyperparameters</em>.</p>

<p>And, just like in biological systems, the process of parent selection, child creation, and mutation repeats and repeats until we have enough new members to fill a new <em>population</em>. If any of the new members meet our objective, we’re done! Otherwise, we’ll repeat this entire process, known as a <em>generation</em>, until we find a member that meets the objective, or we otherwise get close enough.</p>

<p>An evolutionary algorithm configured in this way is called a <em>genetic algorithm</em>. There are other types of evolutionary algorithms, but they all share a similar recursive structure, shown here in Ruby-esque code:</p>

<div><pre><code><span>def</span> <span>run</span><span>(</span><span>population</span> <span>=</span> <span>[])</span>
  <span># If population is empty or not provided, create a new population</span>
  <span>population</span> <span>=</span> <span>Array</span><span>.</span><span>new</span><span>(</span><span>POPULATION_SIZE</span><span>)</span> <span>{</span> <span>create_random_member</span> <span>}</span> <span>if</span> <span>population</span><span>.</span><span>empty?</span>

  <span># Try to find a member of the population that meets the objective</span>
  <span>best_member</span> <span>=</span> <span>population</span><span>.</span><span>find</span> <span>{</span> <span>|</span><span>member</span><span>|</span> <span>objective_met?</span><span>(</span><span>member</span><span>)</span> <span>}</span>

  <span># If a member meeting the objective is found, return it</span>
  <span>return</span> <span>best_member</span> <span>if</span> <span>best_member</span>

  <span># Otherwise, create a new generation and recursively search again</span>
  <span>new_population</span> <span>=</span> <span>Array</span><span>.</span><span>new</span><span>(</span><span>POPULATION_SIZE</span><span>)</span> <span>do</span>
    <span>parents</span> <span>=</span> <span>select_parents</span><span>(</span><span>population</span><span>)</span>
    <span>child</span> <span>=</span> <span>crossover</span><span>(</span><span>parents</span><span>)</span>
    <span>mutate</span><span>(</span><span>child</span><span>)</span>
  <span>end</span>

  <span>run</span><span>(</span><span>new_population</span><span>)</span>
<span>end</span>
</code></pre></div>

<blockquote>
  <p>🔄 <strong>Tail Call Recursion</strong><br>
Notice that the <code>run</code> method above is recursive. Recursion isn’t always the most efficient way to implement an algorithm because each recursive call in Ruby creates a new stack frame, which is a chunk of memory that stores the state of the method. Depending on how many generations we need our algorithm to run, this could cause an <code>SystemStackError (stack level too deep)</code> error. However, when a recursive call is the last thing that happens in a method (a method returns a call to itself), we can avoid allocating new stack frames by using a technique called <em>tail call optimization</em>. In Ruby, this is not enabled by default, but we can enable it using the following compiler options:</p>
  <div><pre><code><span>RubyVM</span><span>::</span><span>InstructionSequence</span><span>.</span><span>compile_option</span> <span>=</span> <span>{</span>
  <span>tailcall_optimization: </span><span>true</span><span>,</span>
  <span>trace_instruction: </span><span>false</span>
<span>}</span>
</code></pre></div>
  <p>This prevents the stack from growing indefinitely by reusing the same stack frame for each recursive call, rather than creating a new one.<sup id="fnref:ruby_tail_call_optimization" role="doc-noteref"><a href="#fn:ruby_tail_call_optimization" rel="footnote">2</a></sup></p>
</blockquote>

<h2 id="the-petri-dish-framework">The Petri Dish Framework</h2>

<p>The <a href="https://github.com/thomascountz/petri_dish">Petri Dish</a> framework is a Ruby gem that implements the evolutionary algorithm structure for us in the <code>PetriDish::World.run</code> method. We need to supply the members of the population, how to evaluate their fitness, the genetic operators, and when to stop. These specifics of an evolutionary algorithm are highly dependent on the problem we’re trying to solve, but the underlying structure is always the same.</p>

<p>Here’s what a stripped down version of what the <code>PetriDish::World.run</code> method looks like. See if you can spot the similarities to the pseudocode above:</p>

<div><pre><code><span>module</span> <span>PetriDish</span>
  <span>class</span> <span>World</span>
    <span>class</span> <span>&lt;&lt;</span> <span>self</span>
      <span>attr_accessor</span> <span>:metadata</span>
      <span>attr_reader</span> <span>:configuration</span><span>,</span> <span>:end_condition_reached</span>

      <span>def</span> <span>run</span><span>(</span>
        <span>members</span><span>:,</span>
        <span>configuration: </span><span>Configuration</span><span>.</span><span>new</span><span>,</span>
        <span>metadata: </span><span>Metadata</span><span>.</span><span>new</span>
      <span>)</span>
        <span>end_condition_reached</span> <span>=</span> <span>false</span>
        <span>max_generation_reached</span> <span>=</span> <span>false</span>

        <span>max_generation_reached</span> <span>=</span> <span>metadata</span><span>.</span><span>generation_count</span> <span>&gt;=</span> <span>configuration</span><span>.</span><span>max_generations</span>

        <span>new_members</span> <span>=</span> <span>(</span><span>configuration</span><span>.</span><span>population_size</span><span>).</span><span>times</span><span>.</span><span>map</span> <span>do</span>
          <span>parents</span> <span>=</span> <span>configuration</span><span>.</span><span>parents_selection_function</span><span>.</span><span>call</span><span>(</span><span>members</span><span>)</span>
          <span>child_member</span> <span>=</span> <span>configuration</span><span>.</span><span>crossover_function</span><span>.</span><span>call</span><span>(</span><span>parents</span><span>)</span>
          <span>configuration</span><span>.</span><span>mutation_function</span><span>.</span><span>call</span><span>(</span><span>child_member</span><span>).</span><span>tap</span> <span>do</span> <span>|</span><span>mutated_child</span><span>|</span>
            <span>end_condition_reached</span> <span>=</span> <span>configuration</span><span>.</span><span>end_condition_function</span><span>.</span><span>call</span><span>(</span><span>mutated_child</span><span>)</span>
          <span>end</span>
        <span>end</span>

        <span>metadata</span><span>.</span><span>increment_generation</span>

        <span>unless</span> <span>end_condition_reached</span> <span>||</span> <span>max_generation_reached</span>
          <span>run</span><span>(</span><span>members: </span><span>new_members</span><span>,</span> <span>configuration: </span><span>configuration</span><span>,</span> <span>metadata: </span><span>metadata</span><span>)</span>
        <span>end</span>
      <span>end</span>
    <span>end</span>
  <span>end</span>
<span>end</span>
</code></pre></div>

<p>The <code>PetriDish::World.run</code> method accepts a <code>members</code> Array, which contains the evolving population; a <code>configuration</code> object, which holds the user-defined genetic operators and other configuration options; and an internally used <code>metadata</code> object, which holds information about the current state of the algorithm, like the current generation number.</p>

<p>The Petri Dish framework exposes the <a href="https://github.com/Thomascountz/petri_dish/blob/133be9efea42e7e3f62e01cd92a77ba03425afa4/lib/petri_dish/configuration.rb#L18-L22"><code>PetriDish::Configuration#configure</code></a> method which takes a block of configuration options.</p>

<p>The core configuration options that we’re interested in for this post are:</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>fitness_function</code></td>
      <td>A function used to calculate the fitness of an individual</td>
    </tr>
    <tr>
      <td><code>parents_selection_function</code></td>
      <td>A function used to select parents for crossover</td>
    </tr>
    <tr>
      <td><code>crossover_function</code></td>
      <td>A function used to perform crossover between two parents</td>
    </tr>
    <tr>
      <td><code>mutation_function</code></td>
      <td>A function used to mutate the genes of an individual</td>
    </tr>
    <tr>
      <td><code>mutation_rate</code></td>
      <td>The chance that a gene will change during mutation</td>
    </tr>
    <tr>
      <td><code>max_generations</code></td>
      <td>The maximum number of generations to run the evolution for</td>
    </tr>
    <tr>
      <td><code>end_condition_function</code></td>
      <td>A function that determines whether the evolution process should stop premature of <code>max_generations</code></td>
    </tr>
  </tbody>
</table>

<p>We’ll take a look at each of these functions in detail later, but for now, let’s take a step back and define the objective of our problem.</p>

<h2 id="understanding-the-objective">Understanding the Objective</h2>

<p>As mentioned earlier, evolutionary algorithms work best when we define a criteria to aim towards, versus a discrete target. In our case, we are trying to replicate a given grayscale image using triangles. If we break this down in terms of drawing polygons, we want to <strong>find a set of triangles that, when drawn together, approximate the given image</strong>. That is our <em>objective</em>.</p>

<p>We’ll define the triangles by their three vertices. <strong>Each vertex can be encoded as an <code>(x,y)</code> coordinate and a grayscale value.</strong> These are our <em>decision variables</em>.</p>

<p>A series of these three-vertices-and-a-grayscale-value groupings is all the information we need create a low-poly image. We’ll call these groupings “points” and an Array of them will represent each members’ <em>genes</em>. Each member of the population will have a distinct set of these points and the algorithm will optimize for a member whose points, or genes, are more <em>fit</em>.</p>

<blockquote>
  <p>☝️ <strong>Why Points instead of Triangles?</strong><br>
As we’ll see later, we’ll be using what’s called <a href="https://en.wikipedia.org/wiki/Delaunay_triangulation"><em>Delaunay triangulation</em></a> to create triangles from a member’s points/genes, rather than define triangles directly. Delaunay Triangulation is a technique that takes a set of points and uses them as vertices to creates a set of non-overlapping triangles. This is a creative decision as much as it is a technical one. I began by evolving triangles directly, but found that I didn’t like the results as much as when I evolved points.</p>
</blockquote>

<p>Lastly, we need to define our <em>constraints</em>, or the boundaries of the search space. In our case (mostly due to the arbitrary limit of my laptop’s processing power), <strong>we will limit the height and width of the image to 100x100 pixels and the color space to 8-bit grayscale</strong>. Independently, <strong>we will also limit each members’ genes to be 100 points</strong>.</p>

<blockquote>
  <p>🗺️ <strong>Quantifying the Search Space</strong><br>
With each point each having an <code>(x,y)</code> coordinate range of <code>(0..100, 0..100)</code> and a grayscale value range of <code>0..255</code>, each point can be in one of <code>101 * 101 * 256 = 2,626,816</code> possible states (roughly speaking). And, since each member has 100 of these as its genes, this leads to a search space of <code>(101 * 101 * 256)**100</code> dimensions, which is an enormously large, but in practice, quite small for an evolutionary algorithm.</p>
</blockquote>

<p>Now that we’ve taken a look at the objective, decision variables, and constraints at a high level, let’s take a look at how we can represent them in code.</p>

<p>To recap:</p>
<ul>
  <li><strong>Objective</strong>: Find a set of non-overlapping triangles that approximate the given image</li>
  <li><strong>Decision Variables</strong>: Each vertex can be encoded as an <code>(x,y)</code> coordinate and a grayscale value</li>
  <li><strong>Constraints</strong>: 100x100 pixel image, 8-bit grayscale, 100 points</li>
</ul>

<h2 id="member-representation">Member Representation</h2>

<p>Evolutionary algorithms are generic in the sense that they can be applied to a wide variety of problems. Therefore, just as we would for a neural network, we must engineer, or encode, our problem into a format that can be understood by the algorithm’s architecture.</p>

<p>We need to encode:</p>
<ol>
  <li><a href="#input-target-image">The input <em>target</em> image</a>,</li>
  <li><a href="#member-genes">The <em>genes</em> of each member of the population</a>, and</li>
  <li><a href="#reconstructed-output-image">The <em>reconstructed</em> output image</a>.</li>
</ol>

<h2 id="input-target-image">Input <em>Target</em> Image</h2>

<p>For both the input and output images, we’ll use the <a href="https://github.com/rmagick/rmagick"><code>Magick</code></a> gem which provides a Ruby interface to the <a href="https://imagemagick.org/">ImageMagick</a> image processing library.</p>

<p>Starting with an input image path, we can read the image into memory, center crop it to a 100x100 pixel square, and then convert it to grayscale. We’ll save the image to a file for later comparison.</p>

<div><pre><code><span>require</span> <span>'rmagick'</span>

<span>def</span> <span>import_target_image</span><span>(</span><span>input_path</span><span>,</span> <span>output_path</span><span>)</span>
  <span>image</span> <span>=</span> <span>Magick</span><span>::</span><span>Image</span><span>.</span><span>read</span><span>(</span><span>input_path</span><span>).</span><span>first</span>

  <span># Calculate crop size and coordinates for center crop</span>
  <span>crop_size</span> <span>=</span> <span>[</span><span>image</span><span>.</span><span>columns</span><span>,</span> <span>image</span><span>.</span><span>rows</span><span>].</span><span>min</span>
  <span>crop_x</span> <span>=</span> <span>(</span><span>image</span><span>.</span><span>columns</span> <span>-</span> <span>crop_size</span><span>)</span> <span>/</span> <span>2</span>
  <span>crop_y</span> <span>=</span> <span>(</span><span>image</span><span>.</span><span>rows</span> <span>-</span> <span>crop_size</span><span>)</span> <span>/</span> <span>2</span>

  <span>image</span>
    <span>.</span><span>crop</span><span>(</span><span>crop_x</span><span>,</span> <span>crop_y</span><span>,</span> <span>crop_size</span><span>,</span> <span>crop_size</span><span>)</span>
    <span>.</span><span>resize</span><span>(</span><span>IMAGE_HEIGHT_PX</span><span>,</span> <span>IMAGE_WIDTH_PX</span><span>)</span>
    <span>.</span><span>quantize</span><span>(</span><span>256</span><span>,</span> <span>Magick</span><span>::</span><span>GRAYColorspace</span><span>)</span>
    <span>.</span><span>write</span><span>(</span><span>output_path</span><span>)</span>

  <span>image</span>
<span>end</span>
</code></pre></div>

<p>Let’s import the Ruby logo and see what it looks like:</p>

<div><pre><code><span>IMAGE_WIDTH_PX</span> <span>=</span> <span>100</span>
<span>IMAGE_HEIGHT_PX</span> <span>=</span> <span>100</span>

<span>target_image</span> <span>=</span> <span>import_target_image</span><span>(</span><span>"ruby_logo.png"</span><span>,</span> <span>"ruby_logo_grayscale.png"</span><span>)</span>
</code></pre></div>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/ruby_logo_grayscale.png"></p><figcaption>100x100 pixel grayscale version of the Ruby logo: our target image.</figcaption>
</div>

<p>Using the <code>Magick::Image</code> class to represent our target image is arbitrary, but the <code>rmagick</code> library provides a convenient interface for reading, writing, and importantly, comparing images pixel-by-pixel. (We’ll use this later to calculate the fitness of each member).</p>

<h2 id="member-genes">Member Genes</h2>

<p>When defining of our objective, we identified that the genes of each member can be represented as an Array of 100 points, each with an <code>(x,y)</code> coordinate and a grayscale value that defines the vertices of triangles. We can encode this using a <code>Point</code> Struct with <code>x</code>, <code>y</code>, and <code>grayscale</code> attributes.</p>

<div><pre><code><span>Point</span> <span>=</span> <span>Struct</span><span>.</span><span>new</span><span>(</span><span>:x</span><span>,</span> <span>:y</span><span>,</span> <span>:grayscale</span><span>)</span>
</code></pre></div>

<blockquote>
  <p>📐 <strong>Why a Struct?</strong><br>
A <code>Struct</code> is a simple way to define a class with attributes. It’s a good choice here because we do not need to define any behavior on <code>Point</code>-s; it is a data-only object. Based on my benchmarks<sup id="fnref:struct_benchmarks" role="doc-noteref"><a href="#fn:struct_benchmarks" rel="footnote">3</a></sup>, a hash would be more performant, through it’s less flexible and less explicit. A class or Ruby 3.2 <a href="https://docs.ruby-lang.org/en/3.2/Data.html"><code>Data</code></a> object offer no additional benefits.</p>
</blockquote>

<!-- TODO: Add benchmarks -->

<blockquote>
  <p>🌈 <strong>Why does a Point have color?</strong><br>
Notice here that a the <code>grayscale</code> attribute is defined on the <code>Point</code> Struct and not on some representation of a triangle. We’ll need a grayscale value to fill each triangle, but a triangle will be made up of three <code>Point</code>-s. So, which of the three <code>Point</code>-s’ <code>grayscale</code> attribute do we use? We will average them. This is because, as we will see, we aren’t sure which three <code>Point</code>-s will be used together as the vertices of any particular triangle. Therefore, for any given triangle, we’ll average the <code>grayscale</code> values of its three <code>Point</code>-s together to determine the fill color. This is only one approach to this problem.</p>
</blockquote>

<p>Now that we have a <code>Point</code>, we can create an Array of them to form a member’s genes.</p>

<p>The Petri Dish framework provides a <code>PetriDish::Member</code> class, which acts as an interface to the library. The <code>PetriDish::Member</code> class holds onto the <code>genes</code> Array, which is then directly exposed via the <code>PetriDish::Member#genes</code> method.</p>

<p>Here is the entire definition of the <code>PetriDish::Member</code> class:</p>

<div><pre><code><span>module</span> <span>PetriDish</span>
  <span>class</span> <span>Member</span>
    <span>attr_reader</span> <span>:genes</span>

    <span>def</span> <span>initialize</span><span>(</span><span>genes</span><span>:,</span> <span>fitness_function</span><span>:)</span>
      <span>@fitness_function</span> <span>=</span> <span>fitness_function</span>
      <span>@genes</span> <span>=</span> <span>genes</span>
    <span>end</span>

    <span>def</span> <span>fitness</span>
      <span>@fitness</span> <span>||=</span> <span>@fitness_function</span><span>.</span><span>call</span><span>(</span><span>self</span><span>)</span>
    <span>end</span>
  <span>end</span>
<span>end</span>
</code></pre></div>

<p>The initializer also accepts a <code>fitness_function</code> which is used to evaluate the fitness of a member. (We’ll define the fitness function later, but for now, it only needs to respond to <code>#call</code> and take a <code>PetriDish::Member</code> as its only argument).</p>

<p>To create a <code>PetriDish::Member</code> with an Array of 100 random <code>Point</code>-s as its genes, we do the following:</p>

<div><pre><code><span>GRAYSCALE_RANGE</span> <span>=</span> <span>0</span><span>..</span><span>255</span>

<span>def</span> <span>random_member</span>
  <span>genes</span> <span>=</span> <span>Array</span><span>.</span><span>new</span><span>(</span><span>100</span><span>)</span> <span>do</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>rand</span><span>(</span><span>0</span><span>..</span><span>IMAGE_WIDTH_PX</span><span>),</span> <span>rand</span><span>(</span><span>0</span><span>..</span><span>IMAGE_HEIGHT_PX</span><span>),</span> <span>rand</span><span>(</span><span>GRAYSCALE_RANGE</span><span>))</span>
  <span>end</span>

  <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span><span>genes: </span><span>genes</span><span>,</span> <span>fitness_function: </span><span>-&gt;</span><span>(</span><span>_member</span><span>)</span> <span>{</span> <span>})</span>
<span>end</span>

<span>puts</span> <span>random_member</span><span>.</span><span>genes</span><span>.</span><span>sample</span><span>(</span><span>3</span><span>)</span>
<span>#&lt;struct Point x=57, y=21, grayscale=235&gt;</span>
<span>#&lt;struct Point x=16, y=49, grayscale=64&gt;</span>
<span>#&lt;struct Point x=68, y=6, grayscale=210&gt;</span>
</code></pre></div>

<h2 id="reconstructed-output-image"><em>Reconstructed</em> Output Image</h2>

<p>To turn a <code>PetriDish::Member</code> into a low-poly image, we’ll create triangles using its <code>#genes</code> in a process called <a href="https://en.wikipedia.org/wiki/Delaunay_triangulation"><em>Delaunay triangulation</em></a>. This technique takes a set of points and creates a set of triangles such that no point is inside the circumcircle of any triangle, i.e. no triangle overlaps another. The&nbsp;<a href="https://github.com/hendrixfan/delaunator-ruby/tree/master"><code>delaunator</code></a>&nbsp;gem is a Ruby library that performs Delaunay triangulation, and we’ll use it here instead of implementing it ourselves.</p>

<p>Let’s define a function called <code>member_to_image</code> that takes a <code>PetriDish::Member</code> and returns an <code>Magick::Image</code> object based on the member’s genes (while also grossly violating the single-responsibility principle).</p>

<ol>
  <li>We begin by initializing a new <code>Magick::Image</code> object, which is the same object type as our input image.</li>
  <li>We then perform the Delaunay triangulation using the <code>Delaunator.triangulate</code> method and passing in the <code>x</code> and <code>y</code> values from the <code>Point</code>-s returned from the <code>PetriDish::Member#genes</code> method.</li>
  <li>To determine the grayscale fill value, we use the <code>grayscale</code> value from <code>PetriDish::Member#genes</code>, and average them, as we discussed earlier.</li>
  <li>Finally, we draw each triangle onto the image using the <code>Magick::Draw#polygon</code> method.</li>
</ol>

<div><pre><code><span>require</span> <span>'petri_dish'</span>
<span>require</span> <span>'delaunator'</span>

<span>def</span> <span>member_to_image</span><span>(</span><span>member</span><span>)</span>
  <span># Create a new image with a white background</span>
  <span>image</span> <span>=</span> <span>Magick</span><span>::</span><span>Image</span><span>.</span><span>new</span><span>(</span><span>IMAGE_WIDTH_PX</span><span>,</span> <span>IMAGE_HEIGHT_PX</span><span>)</span> <span>{</span> <span>|</span><span>options</span><span>|</span> <span>options</span><span>.</span><span>background_color</span> <span>=</span> <span>"white"</span> <span>}</span>

  <span># Create a new draw object to draw onto the image</span>
  <span>draw</span> <span>=</span> <span>Magick</span><span>::</span><span>Draw</span><span>.</span><span>new</span>

  <span># Perform Delaunay triangulation on the points</span>
  <span>#</span>
  <span># Delaunator.triangulate accepts a nested array of [[x1, y1], [xN, yN]]</span>
  <span># coordinates and returns an array of triangle vertex indices where each</span>
  <span># group of three numbers forms a triangle</span>
  <span>triangles</span> <span>=</span> <span>Delaunator</span><span>.</span><span>triangulate</span><span>(</span><span>member</span><span>.</span><span>genes</span><span>.</span><span>map</span> <span>{</span> <span>|</span><span>point</span><span>|</span> <span>[</span><span>point</span><span>.</span><span>x</span><span>,</span> <span>point</span><span>.</span><span>y</span><span>]</span> <span>})</span>

  <span>triangles</span><span>.</span><span>each_slice</span><span>(</span><span>3</span><span>)</span> <span>do</span> <span>|</span><span>i</span><span>,</span> <span>j</span><span>,</span> <span>k</span><span>|</span>
    <span># Get the vertices of the triangle</span>
    <span>triangle_points</span> <span>=</span> <span>member</span><span>.</span><span>genes</span><span>.</span><span>values_at</span><span>(</span><span>i</span><span>,</span> <span>j</span><span>,</span> <span>k</span><span>)</span>

    <span># Use the average color from all three points as the fill color</span>
    <span>color</span> <span>=</span> <span>triangle_points</span><span>.</span><span>map</span><span>(</span><span>&amp;</span><span>:grayscale</span><span>).</span><span>sum</span> <span>/</span> <span>3</span>

    <span># The `Magick::Draw#fill` method accepts a string representing a color in the form "rgb(r, g, b)"</span>
    <span>draw</span><span>.</span><span>fill</span><span>(</span><span>"rgb(</span><span>#{</span><span>color</span><span>}</span><span>, </span><span>#{</span><span>color</span><span>}</span><span>, </span><span>#{</span><span>color</span><span>}</span><span>)"</span><span>)</span>

    <span># Magick::Image#draw takes an array of vertices in the form [x1, y1,..., xN, yN]</span>
    <span>vertices</span> <span>=</span> <span>triangle_points</span><span>.</span><span>map</span> <span>{</span> <span>|</span><span>point</span><span>|</span> <span>[</span><span>point</span><span>.</span><span>x</span><span>,</span> <span>point</span><span>.</span><span>y</span><span>]</span> <span>}</span>
    <span>draw</span><span>.</span><span>polygon</span><span>(</span><span>*</span><span>vertices</span><span>.</span><span>flatten</span><span>)</span>
  <span>end</span>

  <span>draw</span><span>.</span><span>draw</span><span>(</span><span>image</span><span>)</span>
  <span>image</span>
<span>end</span>
</code></pre></div>

<p>Let’s see what the result looks like if we run it a few times:</p>

<div><pre><code><span>5</span><span>.</span><span>times</span> <span>do</span> <span>|</span><span>i</span><span>|</span>
  <span>member_to_image</span><span>(</span><span>random_member</span><span>).</span><span>write</span><span>(</span><span>"member</span><span>#{</span><span>i</span><span>}</span><span>.png"</span><span>)</span>
<span>end</span>
</code></pre></div>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/random_members.png"></p><figcaption>Five random members of the population.</figcaption>
</div>

<p>Here, we can see the Delaunay triangulation in action. Each member has a different set of points, and therefore a different set of triangles. We can also see that the grayscale values are being averaged together to determine the fill color of each triangle.</p>

<p>When we use an <code>Magick::Image</code> object to represent a member of the population, we do so to easily compare it to the <code>Magick::Image</code> target object and visualize the results from the algorithm.</p>

<p>When we use the <code>Petridish::Member</code> object to represent the same member, we do so to enable the algorithm to easily calculate and evolve new members.</p>

<p>This type of data engineering, akin to <em>feature engineering</em> in machine learning, is a critical step in the process of developing an evolutionary algorithm. The way we encode the problem and represent potential solutions has a large impact on the performance of the algorithm and our ability to interpret its output.</p>

<blockquote>
  <p>⬜️ <strong>Why the White Background?</strong><br>
When we create a new <code>Magick::Image</code> object to represent a member in the <code>member_to_image</code> method, we opt for <code>white</code> as the background color. This choice, although arbitrary, influences the performance of the algorithm. For instance, with the grayscale Ruby logo, whose background is largely white, starting with a white background might expedite the convergence on a solution. However, hardcoding this value may bias the algorithm towards reconstructing targets with white backgrounds. The best solution would be to make this choice configurable in order to make this parameter tunable. This is a good example of how the smallest details in the way we model a problem can impact the performance of the algorithm.</p>
</blockquote>

<h2 id="population-initialization">Population Initialization</h2>

<p>Often it is the case that completely random population initialization is a good place to start, but we can sometimes quickly see faster results if seed the population with some prior knowledge; similar to choosing a good initial set of weights for a neural network.</p>

<p>In the case of image reconstruction, I found that random initialization lead to a lot of waste in the early generations on distributing the points across the image dimensions. To avoid this, we can instead evenly distribute the points across the <code>x</code> and <code>y</code> dimensions of the image and then randomly assign a grayscale value to each point.</p>

<div><pre><code><span>def</span> <span>init_member</span>
  <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span>
    <span>genes: </span><span>(</span><span>0</span><span>..</span><span>IMAGE_WIDTH_PX</span><span>).</span><span>step</span><span>(</span><span>10</span><span>).</span><span>map</span> <span>do</span> <span>|</span><span>x</span><span>|</span>
              <span>(</span><span>0</span><span>..</span><span>IMAGE_HEIGHT_PX</span><span>).</span><span>step</span><span>(</span><span>10</span><span>).</span><span>map</span> <span>do</span> <span>|</span><span>y</span><span>|</span>
                <span>Point</span><span>.</span><span>new</span><span>(</span><span>x</span><span>,</span> <span>y</span><span>,</span> <span>GRAYSCALE_VALUES</span><span>.</span><span>sample</span><span>)</span>
              <span>end</span>
            <span>end</span><span>.</span><span>flatten</span><span>,</span>
    <span>fitness_function: </span><span>-&gt;</span><span>(</span><span>_member</span><span>)</span> <span>{</span> <span>}</span>
  <span>)</span>
<span>end</span>
</code></pre></div>
<p>Let’s see what the result looks like if we run this method a few times:</p>

<div><pre><code><span>5</span><span>.</span><span>times</span> <span>do</span> <span>|</span><span>i</span><span>|</span>
  <span>member_to_image</span><span>(</span><span>init_member</span><span>).</span><span>write</span><span>(</span><span>"member</span><span>#{</span><span>i</span><span>}</span><span>.png"</span><span>)</span>
<span>end</span>
</code></pre></div>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/init_members.png"></p><figcaption>Five non-random members of the population.</figcaption>
</div>

<p>We can see that the points are evenly distributed across the image dimensions, and that the grayscale values are randomly assigned. Whether or not this is a better starting point than a completely random initialization is a question of experimentation. In the case of image reconstruction and other generative tasks, a random initialization may be better because it allows the algorithm to explore the search space more creatively, though it may take longer to converge on a solution.</p>

<h2 id="fitness-function">Fitness Function</h2>

<p>The fitness function is a function that takes a <code>Member</code> and returns a number that represents how well that member solves the problem. In our case, we want to know how well a member approximates the target image.</p>

<p>Modeling a fitness function to map to the search space is often the most difficult part of developing an evolutionary algorithm. It’s also the most important part because it’s what the algorithm uses to determine which members are better than others. Two key qualities of a fitness function are <em>determinism</em> and <em>discrimination</em>.</p>

<p>Deterministic means that given the same <code>Member</code>, the fitness function should always return the same fitness score. This is because the fitness of a member may be evaluated multiple times during the evolutionary process, and inconsistent results could lead to unpredictable behavior.</p>

<p>Discriminative means that the fitness function should be able to discriminate between different members of the population. That is, members with different genes should have different fitness scores. Although fitness function do not have to be strictly discriminative, if many members have the same fitness score, the evolutionary algorithm may have a harder time deciding which members are better.</p>

<p>Lucky for us, the <code>rmagick</code> library provides an <a href="https://rmagick.github.io/image1.html#difference"><code>Image#difference</code></a> method that fits the bill. <code>Image#difference</code> compares two images and returns three numbers that represent how different they are: <code>mean_erorr_per_pixel</code>, <code>normalized_mean_error</code>, and <code>normalized_maximum_error</code>. We’ll use the <code>normalized_mean_error</code> to calculate our fitness score.<sup id="fnref:normalized_mean_error" role="doc-noteref"><a href="#fn:normalized_mean_error" rel="footnote">4</a></sup></p>

<div><pre><code><span>require</span> <span>'petri_dish'</span>
<span>require</span> <span>'rmagick'</span>

  <span>def</span> <span>calculate_fitness</span><span>(</span><span>target_image</span><span>)</span>
    <span>-&gt;</span><span>(</span><span>member</span><span>)</span> <span>do</span>
      <span>member_image</span> <span>=</span> <span>member_to_image</span><span>(</span><span>member</span><span>,</span> <span>IMAGE_WIDTH_PX</span><span>,</span> <span>IMAGE_HEIGHT_PX</span><span>)</span>
      <span># Magick::Image#difference returns a tuple of:</span>
      <span># [mean error per pixel, normalized mean error, normalized maximum error]</span>
      <span>(</span><span>1.0</span> <span>/</span> <span>target_image</span><span>.</span><span>difference</span><span>(</span><span>member_image</span><span>)[</span><span>1</span><span>])</span><span>**</span><span>2</span> <span># Use normalized mean error</span>
    <span>end</span>
  <span>end</span>
</code></pre></div>

<p>The fitness function is a lambda that takes a <code>Member</code> and returns a fitness score. The number is the inverse of the normalized mean error between the target image and the image generated from the member, squared. This means that the higher the fitness score, the better the member approximates the target image.</p>

<blockquote>
  <p>🎛️ <strong>Why normalized?</strong><br>
The normalized mean error is a number between 0 and 1 that represents the average difference between the grayscale values of each pixel in the target image and the member image. This puts the error of every member on the same scale. When comparing members that all have the same dimension and color scale, normalization may be moot, but sneakily, we can reuse this fitness function for other images that may have different dimensions and color scales and generally compare the performance of the algorithm across those different target images.</p>
</blockquote>

<blockquote>
  <p>🙃 <strong>Why the inverse?</strong><br>
When the normalized mean error is inverted (i.e., 1 divided by the normalized mean error), we get a fitness score such that smaller errors (which are closer to 0 after normalization) yield larger fitness values, and larger errors yield smaller fitness values. This means the less “wrong” a member is, the higher its fitness will be.<sup id="fnref:inverted-error" role="doc-noteref"><a href="#fn:inverted-error" rel="footnote">5</a></sup></p>
</blockquote>

<blockquote>
  <p>2️⃣ <strong>Why squared?</strong><br>
In effect, this transformation makes our algorithm very sensitive to the quality of the solutions. Solutions that are closer to the target (i.e., have a larger inverted normalized mean error) are assigned significantly higher fitness scores, and are therefore more likely to be selected for reproduction in the next generation (generally true, but depending on the selection function we define later). This can potentially speed up convergence, but as always, we should be cautious of premature convergence on sub-optimal solutions if there is not enough diversity in the population.</p>
</blockquote>

<p>Lastly, we define <code>#calculate_fitness</code> as a lambda because the Petri Dish framework requires the <code>fitness_function</code> to respond to <code>#call</code>. The framework will call this lambda via the <code>#fitness</code> method on <code>Member</code> in order to memoize and return the fitness score. We use a closure here so that the <code>target_image</code> is available to the lambda when it’s called.</p>

<blockquote>
  <p>📫 <strong>Closures</strong><br>
<em>Closures</em> are a powerful feature of Ruby and other languages. They allow us to define a function that can be called later, but that also has access to the variables that were in scope when the function was defined. It’s like putting a note inside an envelope for the function to open later. In our case, we want to define a function that can be called later by the Petri Dish framework, but that also has access to the <code>target_image</code> that we defined earlier.</p>
</blockquote>

<p>Now that we have a way to represent a member of the population and a way to evaluate the fitness of a member, we can start to evolve the population by defining the evolutionary operators.</p>

<h2 id="genetic-operators">Genetic Operators</h2>

<p>The genetic operators are the functions that we use to evolve the population generation after generation—they are what allow the algorithm to navigate the vast search space of potential solutions.</p>

<p>The operators we’ll take a look at are grouped by <em>selection</em>, <em>crossover</em>, <em>mutation</em>, and <em>replacement</em>.</p>

<h2 id="parent-selection-function">Parent Selection Function</h2>

<p>Selection is the process of choosing which members of the population are the most fit and therefore should be used as <em>parents</em> to create the next generation of <em>children</em>. There are many different selection strategies, but for our task, we’ll use one called <em>fitness proportionate selection</em>.</p>

<p>Also called <em>roulette wheel selection</em> or <em>stochastic acceptance</em>, fitness proportionate selection works by assigning each member a weighted probability of being selected as a parent, and then randomly selects parents based on those probabilities.</p>

<p>The weighted probability assigned to each member is proportional to that member’s fitness score, which means that members with higher fitness scores are more likely to be selected.</p>

<p>For example, let’s say we have the following <code>Member</code>-s with the following fitness scores:</p>

<div><pre><code><span>population</span> <span>=</span> <span>[</span>
  <span>Member</span><span>.</span><span>new</span><span>(</span><span>genes: </span><span>[</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>3</span><span>],</span> <span>fitness_function: </span><span>-&gt;</span><span>(</span><span>_member</span><span>)</span> <span>{</span> <span>2</span> <span>}),</span>
  <span>Member</span><span>.</span><span>new</span><span>(</span><span>genes: </span><span>[</span><span>4</span><span>,</span> <span>5</span><span>,</span> <span>6</span><span>],</span> <span>fitness_function: </span><span>-&gt;</span><span>(</span><span>_member</span><span>)</span> <span>{</span> <span>3</span> <span>}),</span>
  <span>Member</span><span>.</span><span>new</span><span>(</span><span>genes: </span><span>[</span><span>7</span><span>,</span> <span>8</span><span>,</span> <span>9</span><span>],</span> <span>fitness_function: </span><span>-&gt;</span><span>(</span><span>_member</span><span>)</span> <span>{</span> <span>5</span> <span>}),</span>
<span>]</span>
</code></pre></div>

<p>To calculate the proportional fitness for each member, we divide the member’s fitness by the total fitness of the population. In our case, the total fitness is <code>2 + 3 + 5 = 10</code>. Dividing each members’ fitness by this number gives us the proportion of the total fitness that that member contributes.</p>

<p>If we calculate a proportional fitness for each member from our example, we get the following results:</p>

<div><pre><code><span>weights</span> <span>=</span> <span>population</span><span>.</span><span>map</span> <span>{</span> <span>|</span><span>member</span><span>|</span> <span>member</span><span>.</span><span>fitness</span> <span>/</span> <span>population</span><span>.</span><span>sum</span><span>(</span><span>&amp;</span><span>:fitness</span><span>).</span><span>to_f</span> <span>}</span>
<span># =&gt; [0.2, 0.3, 0.5]</span>
</code></pre></div>

<p>In our example, if we were to select multiple members using these weighted probabilities, we would expect to get the first member (<code>population[0]</code>) 20% of the time, the second member (<code>population[1]</code>) 30% of the time, and the third member (<code>population[2]</code>) 50% of the time.</p>

<p>We can then use these proportional fitnesses, to <em>weigh</em>, or <em>bias</em> the otherwise equally random probability of each member being selected.</p>

<p>Here’s what that looks like:</p>

<div><pre><code>  <span>def</span> <span>roulette_wheel_parent_selection_function</span>
    <span>-&gt;</span><span>(</span><span>members</span><span>)</span> <span>do</span>
      <span>population_fitness</span> <span>=</span> <span>members</span><span>.</span><span>sum</span><span>(</span><span>&amp;</span><span>:fitness</span><span>)</span>
      <span>members</span><span>.</span><span>max_by</span><span>(</span><span>2</span><span>)</span> <span>do</span> <span>|</span><span>member</span><span>|</span>
        <span>weighted_fitness</span> <span>=</span> <span>member</span><span>.</span><span>fitness</span> <span>/</span> <span>population_fitness</span><span>.</span><span>to_f</span>
        <span>rand</span><span>**</span><span>(</span><span>1.0</span> <span>/</span> <span>weighted_fitness</span><span>)</span>
      <span>end</span>
    <span>end</span>
  <span>end</span>
</code></pre></div>

<p>The proportional fitness is calculated by dividing the member’s fitness by the total population fitness, like before. Then, we raise a random number between 0 and 1 to the inverse of the proportional fitness in order to bias the selection towards members with higher fitness scores. The <code>Enumberable#max_by</code> method is used to select two members with the highest result from the block.</p>

<p>The maths are a bit annoying to me personally, but nevertheless, the result of all of this is like spinning a roulette wheel where the size of each slice is proportional to the member’s fitness. The higher the fitness, the larger the slice, and the more likely the member is to be selected.</p>

<p>Notice how the parent selection function makes no mention of <code>Point</code>-s or <code>Magick::Image</code>-s. This is because the selection function is generic and can be used for any problem. It only needs to know how to select members based on their fitness scores.</p>

<p>There are many other selection methods, like simply selecting the fittest members (elite selection) or by first choosing a random subset of the population and then choosing the fittest amongst those (tournament selection).</p>

<p>The benefit of fitness proportional selection is that it allows for a balance between <em>exploration</em> (trying new things) and <em>exploitation</em> (using what we know works). This is because members with lower fitness scores still have a chance of being selected, but members with higher fitness scores are more likely to be selected.</p>

<p>This is the selection method we’ll use for our task, but it may be worth experimenting with other selection methods to see if they work better for our problem.</p>

<blockquote>
  <p>👨‍👨‍👦 <strong>Multiple Parents</strong><br>
Although most implementations of evolutionary algorithms that I’ve seen select two parents, it is possible to select more than two. In fact, the Petri Dish framework allows for any number of parents to be inside the Array returned by the selection function lambda.</p>
</blockquote>

<h2 id="crossover-function">Crossover Function</h2>

<p>In biology, crossover is when paired chromosomes from each parent swap segments of their DNA. This creates new combinations of genes, leading to genetic diversity in offspring. In evolutionary algorithms, crossover is the process of combining the genes of parents members to create a new child member.</p>

<p>After selecting parents, their genes, an Array of <code>Point</code>-s in our case, are combined to create a new <code>Petridish::Member</code>. There are many different ways to combine the genes of parents, but for our task, we’ll use a method called <em>random midpoint crossover</em> to crossover two parents.</p>

<p>Random midpoint crossover works by randomly selecting a midpoint in the genes of each parent and then combining the genes before and after that midpoint to create a new child. Specifically, we’ll randomly select a midpoint between <code>0</code> and the length of the genes Array, and then take the genes before that midpoint from the first parent and the genes after that midpoint from the second parent.</p>

<p>For example, say we have two parents with the following genes:</p>

<div><pre><code><span>parent_1</span> <span>=</span> <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span>
  <span>genes: </span><span>[</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>25</span><span>),</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>3</span><span>,</span> <span>4</span><span>,</span> <span>50</span><span>),</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>5</span><span>,</span> <span>6</span><span>,</span> <span>100</span><span>),</span>
  <span>],</span>
  <span># fitness_function: ...</span>
<span>)</span>
<span>parent_2</span> <span>=</span> <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span>
  <span>genes: </span><span>[</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>7</span><span>,</span> <span>9</span><span>,</span> <span>125</span><span>),</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>9</span><span>,</span> <span>10</span><span>,</span> <span>150</span><span>),</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>11</span><span>,</span> <span>12</span><span>,</span> <span>200</span><span>),</span>
  <span>],</span>
  <span># fitness_function: ...</span>
<span>)</span>
</code></pre></div>

<p>If we were to perform random midpoint crossover on these parents, and the <code>midpoint = 1</code>, we would get the following child:</p>

<div><pre><code><span>child</span> <span>=</span> <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span>
  <span>genes: </span><span>[</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>1</span><span>,</span> <span>2</span><span>,</span> <span>25</span><span>),</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>9</span><span>,</span> <span>10</span><span>,</span> <span>50</span><span>),</span>
    <span>Point</span><span>.</span><span>new</span><span>(</span><span>11</span><span>,</span> <span>12</span><span>,</span> <span>200</span><span>),</span>
  <span>],</span>
  <span># fitness_function: ...</span>
<span>)</span>
</code></pre></div>

<p>Here’s our <code>random_midpoint_crossover_function</code> implementation for combining two parents:</p>

<div><pre><code>  <span>def</span> <span>random_midpoint_crossover_function</span><span>(</span><span>configuration</span><span>)</span>
    <span>-&gt;</span><span>(</span><span>parents</span><span>)</span> <span>do</span>
      <span>midpoint</span> <span>=</span> <span>rand</span><span>(</span><span>parents</span><span>[</span><span>0</span><span>].</span><span>genes</span><span>.</span><span>length</span><span>)</span>
      <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span><span>genes: </span><span>parents</span><span>[</span><span>0</span><span>].</span><span>genes</span><span>[</span><span>0</span><span>...</span><span>midpoint</span><span>]</span> <span>+</span> <span>parents</span><span>[</span><span>1</span><span>].</span><span>genes</span><span>[</span><span>midpoint</span><span>..</span><span>],</span> <span>fitness_function: </span><span>configuration</span><span>.</span><span>fitness_function</span><span>)</span>
    <span>end</span>
  <span>end</span>
</code></pre></div>

<p>Note again, our function returns a lambda, as required by the Petri Dish framework. The lambda takes an Array of parents and returns a new <code>PetriDish::Member</code> with the combined genes of the parents, while also passing along the <code>fitness_function</code> from the configuration object captured by the closure. As before, the fitness function works generically and does not need to know about <code>Point</code>-s or <code>Magick::Image</code>-s.</p>

<p>Other crossover methods include <em>uniform crossover</em>, where each gene is randomly selected from either parent, and <em>majority rule crossover</em>, which works well for instances of selecting more than two parents. It works by having each gene of the offspring determined by a majority vote among the parents. If the parents have equal votes, one parent is chosen randomly to determine the gene.</p>

<p>Random midpoint crossover is a good choice for starting out for its simplicity, but again, it’s worth experimenting with other crossover methods to see if they work better for a particular problem. (In fact, its possible to use one genetic algorithm to optimize the genetic operators of another genetic algorithm, but that’s a topic for another day…).</p>

<blockquote>
  <p>👩‍🔬 <strong>Meta Experimentation</strong><br>
This type of meta experimentation is akin to hyperparameter tuning in machine learning. A core design philosophy of the Petri Dish framework is to make it easy to experiment with different configurations in this way. By passing in different functions for the genetic operators, we can easily experiment with different configurations and observe which ones work best.</p>
</blockquote>

<p>That said, for our task, random midpoint crossover works well enough, so we’ll stick with it for now.</p>

<h2 id="mutation-function">Mutation Function</h2>

<p>Mutation is the process of randomly changing the genes of a child member after crossover. Combining well-fit parents can get us a long way towards a great solution, but mutation is done to introduce new genetic material into the population.</p>

<p>There are many different ways to mutate a member, but for our task, we’ll use a domain-specific implementation that I call <em>nudge mutation</em>.</p>

<blockquote>
  <p>🧬 <strong>Why mutate at all?</strong><br>
Mutation is not strictly necessary for an evolutionary algorithm to work. However, mutation increases diversity and diversity is what allows the algorithm to explore the search space more thoroughly. Without mutation, the algorithm may get stuck in a local maximum, i.e. be unable to find a better solution, though one may exist. Mutation allows the algorithm to escape this local maximum and continue searching for a better solution.</p>
</blockquote>

<p>If we think back to our genes as an Array of <code>Point</code>-s, then nudge mutation is the process of randomly moving each point’s position and grayscale value by a small amount.</p>

<p>This is done by adding a random number between <code>-10</code> and <code>10</code> to the <code>x</code> and <code>y</code> coordinates of each point <code>clamp</code>-ed between the image dimensions. And, adding a random number between <code>-25</code> and <code>+25</code> to the grayscale value <code>clamp</code>-ed between <code>0..255</code> (i.e. valid grayscale values).</p>

<p>If we implemented this as a lambda for the Petri Dish <code>mutation_function</code> configuration (RBS type <code>Proc[Member, Member]</code>), it might look something like this:</p>

<div><pre><code>  <span>def</span> <span>nudge_mutation_function</span><span>(</span><span>configuration</span><span>)</span>
    <span>-&gt;</span><span>(</span><span>member</span><span>)</span> <span>do</span>
      <span>mutated_genes</span> <span>=</span> <span>member</span><span>.</span><span>genes</span><span>.</span><span>dup</span><span>.</span><span>map</span> <span>do</span> <span>|</span><span>gene</span><span>|</span>
        <span>Point</span><span>.</span><span>new</span><span>(</span>
          <span>(</span><span>gene</span><span>.</span><span>x</span> <span>+</span> <span>rand</span><span>(</span><span>-</span><span>10</span><span>..</span><span>10</span><span>)).</span><span>clamp</span><span>(</span><span>0</span><span>,</span> <span>IMAGE_WIDTH_PX</span><span>),</span>
          <span>(</span><span>gene</span><span>.</span><span>y</span> <span>+</span> <span>rand</span><span>(</span><span>-</span><span>10</span><span>..</span><span>10</span><span>)).</span><span>clamp</span><span>(</span><span>0</span><span>,</span> <span>IMAGE_HEIGHT_PX</span><span>),</span>
          <span>(</span><span>gene</span><span>.</span><span>grayscale</span> <span>+</span> <span>rand</span><span>(</span><span>-</span><span>25</span><span>..</span><span>25</span><span>)).</span><span>clamp</span><span>(</span><span>GRAYSCALE</span><span>.</span><span>min</span><span>,</span> <span>GRAYSCALE_RANGE</span><span>.</span><span>max</span><span>)</span>
        <span>)</span>
        <span>end</span>
      <span>PetriDish</span><span>::</span><span>Member</span><span>.</span><span>new</span><span>(</span><span>genes: </span><span>mutated_genes</span><span>,</span> <span>fitness_function: </span><span>configuration</span><span>.</span><span>fitness_function</span><span>)</span>
    <span>end</span>
  <span>end</span>
</code></pre></div>
<p>However, we don’t want to mutate every gene of a child; we want to preserve qualities from the parents and strike a balance between exploration and exploitation. Therefore, we use a <em>mutation rate</em> to determine the probability that any particular gene will be mutated.</p>

<p>For example, if the mutation rate is <code>0.1</code>, then there is a 10% chance that a gene will be mutated.</p>

<p>If we add the concept of a mutation rate to our mutation function, we get this:</p>

<div><pre><code><span>def nudge_mutation_function(configuration)
</span>  -&gt;(member) do
    mutated_genes = member.genes.dup.map do |gene|
<span>+      if rand &lt; configuration.mutation_rate
</span>        Point.new(
          (gene.x + rand(-10..10)).clamp(0, IMAGE_WIDTH_PX),
          (gene.y + rand(-10..10)).clamp(0, IMAGE_HEIGHT_PX),
          (gene.grayscale + rand(-25..25)).clamp(GRAYSCALE.min, GRAYSCALE_RANGE.max)
        )
<span>+      else
+        gene
+      end
</span>    end
    PetriDish::Member.new(genes: mutated_genes, fitness_function: configuration.fitness_function)
  end
<span>end
</span></code></pre></div>

<p>Here, we use the <code>configuration.mutation_rate</code> to determine whether or not to mutate each gene. If the random number is less than the mutation rate, we mutate the gene, otherwise, copy it over to the new <code>PetriDish::Member</code> as-is.</p>

<blockquote>
  <p>📈 <strong>Determining the mutation rate</strong><br>
The mutation rate is a hyperparameter that can be tuned to improve the performance of the algorithm. A higher mutation rate will increase diversity, but it may also cause the algorithm to take longer to converge. A lower mutation rate will decrease diversity, but it may also cause the algorithm to get stuck in a local maximum. The mutation rate is often a good hyperparameter to tune when trying to improve the performance of an evolutionary algorithm.<sup id="fnref:high-mutation-rate" role="doc-noteref"><a href="#fn:high-mutation-rate" rel="footnote">6</a></sup></p>
</blockquote>

<p>Other common types of mutation strategies include <em>swap mutation</em>, where two genes’ positions are randomly swapped, and <em>scramble mutation</em>, where a random subset of genes are randomly shuffled. Like all other genetic operators, the best strategy for the problem at hand is highly dependent on the problem itself and is often worth experimenting with.</p>

<p>In our case, the mutation function implementation was developed to represent the idea of nudging around the points of a polygon until the resulting image looks like the target image.</p>

<blockquote>
  <p>🪲 <strong>Point jitter??</strong><br>
You may see that in the <a href="https://github.com/Thomascountz/petri_dish/blob/133be9efea42e7e3f62e01cd92a77ba03425afa4/examples/low_poly_reconstruction/low_poly_reconstruction.rb#L115-L130">actual implementation</a> of this method, I’ve added a <code>point_jitter</code> of <code>rand(-0.0001..0.0001)</code> to each <code>x</code> and <code>y</code> of <code>Point</code>. This is because the particular implementation of the Delaunay algorithm would fall into a divide-by-zero error if all of the points were collinear (on exactly on the same line). This is a good example of how reality is often messier than theory, and how we must adapt our models and implementation to the problem at hand.</p>
</blockquote>

<p>Now that we have a way to select parents, combine their genes, and mutate the resulting child, we can start to evolve the population. The last step is to define how we’ll replace the old population with the new population.</p>

<h2 id="replacement">Replacement</h2>

<p>In the most simple case, we can replace the entire population with the new population, sometimes called <em>generational replacement</em>. This often works well, but it can sometimes cause <em>too much</em> diversity, which can cause the algorithm to take longer to converge as some of the most-fit members are lost. To prevent this, we can use a technique called <em>elitism</em>.</p>

<p>Elitism, which I personally like to call <em>grandparenting</em>, is the process of preserving the fittest members of the population from one generation to the next. This is done by taking the top <code>n</code> members of the population and adding them to the new population. The rest of the new population is filled with the children of the parents.</p>

<p>In the Petri Dish framework, we tune this parameter using the <code>elitism_rate</code> configuration value. This is the proportion of the population that is preserved through elitism. For example, if the elitism rate is <code>0.1</code>, then the top 10% of the population will be preserved through to the next generation.</p>

<p>Other replacement strategies include <em>steady-state replacement</em>, where only a single member of the population is replaced with a child, and <em>age-based replacement</em>, where the oldest members of the population are replaced with children.</p>

<p>For our image reconstruction task, we’ll use generational replacement with grandparenting set to <code>0.05</code>, or 5%.</p>

<h2 id="end-condition">End Condition</h2>

<p>Lastly, we need to define when the algorithm should stop. The two most common end conditions are 1) when a member of the population meets the criteria, or 2) when a certain number of generations have passed. We’ll use the latter.</p>

<p>An <code>end_condition_function</code> can otherwise be used to determine if any of the members of the population meets a particular criteria. For example, if we were trying to find a member of the population that had a fitness score of <code>1.0</code>, we could use an <code>end_condition_function</code>. Alternatively, we could run the algorithm for a given amount of wall time, or until the rate of improvement drops below a certain threshold.</p>

<p>In our case, we’ll use the <code>max_generations</code> configuration value to determine when the algorithm should stop. This is the maximum number of generations that the algorithm will run for, regardless of the fitness of the members of the population. I have found that <code>5000</code> generations is enough to get a good approximation of the target image, but not so many that it takes too long to run.</p>

<p>We now have all of the pieces we need to put together our evolutionary algorithm. Let’s see how it all works!</p>

<h2 id="putting-it-together">Putting it Together</h2>

<p>Before we look at the results, let’s recap everything we’ve gone over.</p>

<ol>
  <li>A genetic algorithm is a type of evolutionary algorithm that uses genetic operators to evolve a population of members towards a solution to a problem.</li>
  <li>We start the algorithm design by identifying our objective, defining our decision variables and search space, and defining our constraints.</li>
  <li>We then define a way to represent a member of the population and a way to evaluate the fitness of a member.
    <ol>
      <li>In our case, we represent a member of the population as an <code>Magick::Image</code> object, and we evaluate the fitness of a member by comparing it to the target image using the <code>Magick::Image#difference</code> method.</li>
      <li>We also represent a member of the population as a <code>PetriDish::Member</code> object with an Array of <code>Point</code>-s as genes, which is used by the Petri Dish framework to evolve the population.</li>
    </ol>
  </li>
  <li>The genetic operators are selection, crossover, mutation, and replacement.
    <ol>
      <li>Selection is the process of choosing which members of the population are the most fit and therefore should be used as <em>parents</em> to create the next generation of <em>children</em>.</li>
      <li>Crossover is the process of combining the genes of parents members to create a new child member.</li>
      <li>Mutation is the process of randomly changing the genes of a child member after crossover.</li>
      <li>Replacement is the process of replacing the old population with the new population.</li>
    </ol>
  </li>
  <li>The end condition is the criteria that determines when the algorithm should stop.
    <ol>
      <li>In our case, we’ll use the <code>max_generations</code> configuration value to determine when the algorithm should stop. This is the maximum number of generations that the algorithm will run for, regardless of the fitness of the members of the population.</li>
    </ol>
  </li>
</ol>

<h2 id="final-configuration">Final Configuration</h2>

<p>The following is the configuration from the <a href="https://github.com/Thomascountz/petri_dish/blob/133be9efea42e7e3f62e01cd92a77ba03425afa4/examples/low_poly_reconstruction/low_poly_reconstruction.rb#L42-L56">actual implementation</a> and contains all of the pieces we’ve discussed so far, with the addition of a few callbacks that the framework provides.</p>

<div><pre><code><span>def</span> <span>configuration</span>
  <span>PetriDish</span><span>::</span><span>Configuration</span><span>.</span><span>configure</span> <span>do</span> <span>|</span><span>config</span><span>|</span>
    <span>config</span><span>.</span><span>population_size</span> <span>=</span> <span>50</span>
    <span>config</span><span>.</span><span>mutation_rate</span> <span>=</span> <span>0.05</span>
    <span>config</span><span>.</span><span>elitism_rate</span> <span>=</span> <span>0.05</span>
    <span>config</span><span>.</span><span>max_generations</span> <span>=</span> <span>10_000</span>
    <span>config</span><span>.</span><span>fitness_function</span> <span>=</span> <span>calculate_fitness</span><span>(</span><span>target_image</span><span>)</span>
    <span>config</span><span>.</span><span>parents_selection_function</span> <span>=</span> <span>roulette_wheel_parent_selection_function</span>
    <span>config</span><span>.</span><span>crossover_function</span> <span>=</span> <span>random_midpoint_crossover_function</span><span>(</span><span>config</span><span>)</span>
    <span>config</span><span>.</span><span>mutation_function</span> <span>=</span> <span>nudge_mutation_function</span><span>(</span><span>config</span><span>)</span>
    <span># TODO: Don't pass in image dimensions, use constants instead</span>
    <span>config</span><span>.</span><span>highest_fitness_callback</span> <span>=</span> <span>-&gt;</span><span>(</span><span>member</span><span>)</span> <span>{</span> <span>save_image</span><span>(</span><span>member_to_image</span><span>(</span><span>member</span><span>,</span> <span>IMAGE_WIDTH_PX</span><span>,</span> <span>IMAGE_HEIGHT_PX</span><span>))</span> <span>}</span>
    <span>config</span><span>.</span><span>generation_start_callback</span> <span>=</span> <span>-&gt;</span><span>(</span><span>current_generation</span><span>)</span> <span>{</span> <span>generation_start_callback</span><span>(</span><span>current_generation</span><span>)</span> <span>}</span>
    <span>config</span><span>.</span><span>end_condition_function</span> <span>=</span> <span>nil</span>
  <span>end</span>
<span>end</span>
</code></pre></div>

<p>The <code>highest_fitness_callback</code> is invoked when a member with the highest fitness seen so far is found. When that happens, we save the image to a file so that we can see the progress of the algorithm.</p>

<p>The <code>generation_start_callback</code> is invoked at the start of each generation. We use this to keep track of the progress of the algorithm to do things like name the output images.</p>

<p>The last piece of the configuration we haven’t discussed yet is the <code>population_size</code>. This is the number of members in the population per generation, and like all other pieces of configuration, is a hyperparameter that should be tuned to improve the performance of the algorithm. A larger population size can increase diversity, but it may also cause the algorithm to take longer to converge. A smaller population size can decrease diversity, but can be aided with a higher mutation rate and maximum number of generations, as we’ve done here.</p>

<h2 id="results">Results</h2>

<p>Finally, it’s time to run the algorithm and see what happens! Let’s take a subjective look at the results before we get into the numbers.</p>



<div>
  <div>
    <p><span>Generation:</span>
      <span>0000</span>
    </p>
    <p><span>Max Fitness:</span>
      <span>0078.1640</span>
    </p>
    <p><span>Time (seconds):</span>
      <span>0001.03</span>
    </p>
  </div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/out/gen-0000.png">
  </p>
  </div>



<h2 id="subjective-analysis">Subjective Analysis</h2>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/ruby_logo_result.png"></p><figcaption>Target image and result</figcaption>
</div>

<p>After running the algorithm for over 6000 generations over the course of an hour, I’m really please with the results!</p>

<p>I’m surprised by the details the algorithm was able to replicate. For example, the curvature of the top of the ruby is really well defined, given that we’re working with only straight lines. Also, the highlights along the gem’s facets were captured well. If I squint hard enough, I have a hard time distinguishing the target image from the result!</p>

<p>With that said, there are some points stuck in the upper left corner that are shading part of the background the wrong color, but I think it’s those points are actually contributing to the gem’s curvature that I mentioned earlier.</p>

<p>It looks like algorithm had a lot of early success: by generation 120, we can already begin to see vast improvements! However, as the algorithm continued to run, the gains each generation appeared to diminish, which is to be expected from an evolutionary algorithm and an exponential fitness function. After about generation 2000, the algorithm was making smaller and smaller tweaks to the image.</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/skip_montage.png"></p><figcaption>Output of the <code>highest_fitness_callback</code> calls show a progressively more refined low-poly representation</figcaption>
</div>

<p>The biggest improvements to the image after the early generations appear to be in the grayscale values, rather than the positions of the points. This makes sense because the position of the points only really matter in that the resulting triangle contributes to the grayscale value of the pixels it covers.</p>

<p>By looking only at the images, it’s hard for me to tell how much the algorithm improved after generation 2000 and wether or not we could have stopped it there.</p>

<p>I’m curious to see if the numbers tell a different story.<sup id="fnref:subjectivity" role="doc-noteref"><a href="#fn:subjectivity" rel="footnote">7</a></sup></p>

<h2 id="data-analysis-and-interpretation">Data Analysis and Interpretation</h2>

<p>Now that we’ve taken a subjective look at the results, let’s take an objective look at the algorithm’s performance. We’re going to take these numbers with a grain of salt: since we’ve only ran the algorithm once and with one set of configurations, there is nothing to characterize the performance against.<sup id="fnref:additional_runs" role="doc-noteref"><a href="#fn:additional_runs" rel="footnote">8</a></sup> Additionally, we’re going to look at the numbers from the perspective of the <em>algorithm’s</em> performance only, rather than the performance of the Ruby code itself<sup id="fnref:time_t" role="doc-noteref"><a href="#fn:time_t" rel="footnote">9</a></sup> <sup id="fnref:ruby-performance" role="doc-noteref"><a href="#fn:ruby-performance" rel="footnote">10</a></sup></p>

<h3 id="log-data">Log Data</h3>

<div><pre><code><span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>28.744335</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":0,"highest_fitness":0,"elapsed_time":0.0,"last_fitness_increase":0}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>29.393945</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":0,"highest_fitness":45.43454105775939,"elapsed_time":0.65,"last_fitness_increase":0}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>29.422413</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":0,"highest_fitness":73.14234456163621,"elapsed_time":0.68,"last_fitness_increase":0}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>29.702998</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":0,"highest_fitness":75.73263190998411,"elapsed_time":0.96,"last_fitness_increase":0}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>29.775709</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":0,"highest_fitness":78.16397715764293,"elapsed_time":1.03,"last_fitness_increase":0}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>29.990462</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":1,"highest_fitness":78.16397715764293,"elapsed_time":1.25,"last_fitness_increase":0}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>30.146199</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":1,"highest_fitness":85.22354925417734,"elapsed_time":1.4,"last_fitness_increase":1}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>30.543062</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":2,"highest_fitness":85.22354925417734,"elapsed_time":1.8,"last_fitness_increase":1}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>30.711047</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":2,"highest_fitness":95.88177285281498,"elapsed_time":1.97,"last_fitness_increase":2}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>31.090201</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":3,"highest_fitness":95.88177285281498,"elapsed_time":2.35,"last_fitness_increase":2}</span>
<span>I</span><span>,</span> <span>[</span><span>2023</span><span>-</span><span>08</span><span>-</span><span>04</span><span>T19</span><span>:</span><span>48</span><span>:</span><span>31.405858</span> <span>#83090]  INFO -- : {"id":"869b3cc4-b37b-47ff-8beb-602aaa52c48f","generation_count":3,"highest_fitness":100.92915163430119,"elapsed_time":2.66,"last_fitness_increase":3}</span>
</code></pre></div>

<p>Using the logs as a data source, let’s start by looking at a plot of the highest fitness score of any population over time. The fitness was determined by the inverse of the normalized mean error between the target image and the image generated from the member, squared. The higher the fitness, the better the member approximates the target image.</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/highest_fitness_over_time.png"></p><figcaption>Fitness of the fittest member of the population over time.</figcaption>
</div>

<p>We can see that the fitness of the fittest member of each population trends heavily positive over time; somewhat linearly but with a steeper slope at the beginning. This is to be expected because the algorithm starts with a lot to gain from its initial, somewhat random, initial state, and then spends time improving on better and better results.</p>

<p>We can also see that the the trend is not monotonically increasing, i.e. it does not always increase from one time step (generation) to the next. This is because the algorithm is not guaranteed to find a better solution in each generation.</p>

<p>We can visualize this by plotting the change in highest fitness over time, which I called <em>velocity</em>, but can also be considered <em>efficiency</em>.</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/highest_fitness_and_fitness_growth_over_generations.png"></p><figcaption>Velocity of the fittest member of the population over time.</figcaption>
</div>

<p>Here, we can see a lot of zero-efficiency/zero-velocity generations, where the fitness of the fittest member of the population did not change from the previous generation, specifically after about the 1000th generation. This shows us in another way that the algorithm is converging on a solution.</p>

<p>In fact, we could this metric to improve our end condition function, i.e. stop the algorithm when the efficiency drops below a certain threshold, rather than blindly after a certain number generations or a particular fitness score. We can also use efficiency to compare the performance of different configurations.</p>

<p>That said, convergence on a solution doesn’t always mean that the solution is the best solution to be found, just that it’s the best so far. We should be careful not to prematurely stop the algorithm. For example, at around generation 4500, we see another significant spike in efficiency even after many hundreds of generations with little-or-no improvement.</p>

<h3 id="image-data">Image Data</h3>

<p>Subjectively, I thought that there was little to be gained after generation 2000, but based on the data from the logs, we know that the algorithm continued to find fitter members, almost linearly! Is generation 6198, with a fitness score of <code>2857.08</code>, really <em><code>68%</code> better</em> than generation 2194 with a fitness score of <code>1700.74</code>?</p>

<p>What does “68% better” <em>look</em> like?</p>

<p>Let’s start by taking a look at the error across individual pixels. If we remember back to our fitness function, we know that the fitness score was determined by the mean error of each pixel, i.e. how far off the grayscale value of each pixel was from the target image. We can visualize this by plotting the grayscale value of a few random pixel over time.</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/grayscale_value_of_random_pixels.png"></p><figcaption>Five random pixels' grayscale values over time</figcaption>
</div>

<p>Here, we’re plotting the same five pixels from each member as they journey towards their target (indicated by the dashed lines) over each generation. We can observe that these pixels remain relatively stable after just a few hundred generations, and even more so after about 2500 generations. We can also notice that while some pixels hit their target dead on, others get farther away over time.</p>

<p>Interestingly, we can see some pixels correlate to the global trends we saw in the log data earlier: pixel 4 makes a significant improvement around generation 2500, and pixel 1 makes a significant improvement around generation 4500.</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/grayscale_value_of_random_neighboring_pixels.png"></p><figcaption>10 random neighboring pixels' grayscale values over time moving towards grayscale 46</figcaption>
</div>

<p>We see a similar story when we look at 10 pixels near the center of the image that are all moving towards the same grayscale value. Looking at neighboring pixels is interesting because the algorithm is evolving the population by moving the vertices of triangles around, and therefore, the grayscale values of neighboring pixels are likely to be correlated.</p>

<p>Again, we can see that the pixels stabilize after about 250 generations, even more so after around after 2500. And, we also clearly see the correlation to the large spike around generation 4500 that we saw in the log data. It appears that these pixels were somewhat stuck for over 1000 generations, and then suddenly jumped to their target grayscale value. Curiously, we can also see a divergence after 5500 generations, even though the overall fitness score continued to increase…</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/member_differences.png"></p><figcaption>The differences between the target image and generations 0000, 0120, 2194, and 6198. Black pixels mean they're equal.</figcaption>
</div>

<p>If we render the differences between the target image and a sample of generations, we get the images above. In these images, the darker the pixel, the closer the grayscale value of the pixel is to the target image.</p>

<p>This is a good way to visualize our fitness function as the algorithm is essentially trying to increase the number of black pixels and decrease the number of white pixels. We can see that the differences are, in fact, decreasing over time, but it’s still hard to see the 68% difference between generations 2194 and 6198.</p>

<div>
  <p><img src="https://thomascountz.com/assets/images/low_poly_image_generation/diff_gen-6198_gen-2194.png"></p><figcaption>The difference between generations 2194 and 6198.</figcaption>
</div>

<p>If we look at the <em>difference of the differences</em> between generations 2194 and 6198, we see mostly dark colored pixels, indicating that the differences are small, and perhaps nearly imperceptible.</p>

<p>This is what “68% better” looks like!</p>

<p>Despite all the math and theory, throughout this exploration, we have aimed the power of evolutionary algorithms towards scratching the subjective search space surface of creativity and art. Algorithmic processes can produce results that are not only fascinating from a technical standpoint but also visually (and philosophically) compelling. At the end of analyzing our algorithm’s ability to near its target, we are left to contemplate how well the resulting image captures our aesthics and creative vision.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Crafting a low-poly image representation is but one example of the myriad applications of evolutionary algorithms. The <a href="https://github.com/Thomascountz/petri_dish/tree/main/examples"><code>/examples</code> directory within the Petri Dish repository</a> showcases additional uses, including tackling the <a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">Travelling Salesperson Problem</a> and a more straightforward task of text generation.</p>

<p>Despite the diverse applications, evolutionary algorithms generally follow a uniform framework, as discussed in <a href="#putting-it-together">Putting it Together</a>. Interestingly, many of the design considerations we covered in this blog post are even more broadly applicable to the field of data engineering.</p>

<p>If you’re intersted in exploring the use of genetic algorithms for creative purposes, I can recommend:</p>

<ul>
  <li>“The Nature of Code” by Daniel Shiffman, particularly the chapters on evolutionary algorithms.</li>
  <li>“Generative Art” by Matt Pearson, which discusses the principles of algorithmic art creation.</li>
  <li>The <a href="https://processing.org/">Processing</a> community, which is rich with examples of generative art and creative coding.</li>
</ul>

<p>And of course, feel free to checkout the code for <a href="https://github.com/Thomascountz/petri_dish/">Petri Dish</a> on Github.</p>




  <span>
    <time datetime="2023-07-30T00:00:00+00:00">July 30, 2023</time> · 
    <a href="https://thomascountz.com/tag/ruby">ruby</a>, 
    <a href="https://thomascountz.com/tag/generative%20ai">generative ai</a>, 
    <a href="https://thomascountz.com/tag/machine%20learning">machine learning</a>
  </span>
</section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[World’s oldest tree? Genetic analysis traces evolution of iconic Pando forest (105 pts)]]></title>
            <link>https://www.nature.com/articles/d41586-024-03570-4</link>
            <guid>42046953</guid>
            <pubDate>Mon, 04 Nov 2024 22:58:50 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.nature.com/articles/d41586-024-03570-4">https://www.nature.com/articles/d41586-024-03570-4</a>, See on <a href="https://news.ycombinator.com/item?id=42046953">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                    
                        <p>DNA samples from one of the world’s largest and oldest plants — a quaking aspen tree (<i>Populus tremuloides</i>) in Utah called Pando — have helped researchers to determine its age and revealed clues about its evolutionary history.</p><p>By sequencing hundreds of samples from the tree, researchers confirmed that Pando is between 16,000 and 80,000 years old, verifying previous suggestions that it is among the oldest organisms on Earth. They were also able to track patterns of genetic variation spread throughout the tree that offer clues about how it has adapted and evolved over the course of its lifetime. The findings were posted on the bioRxiv preprint server on 24 October<sup><a href="#ref-CR1" data-track="click" data-action="anchor-link" data-track-label="go to reference" data-track-category="references">1</a></sup>. The work has not yet been peer reviewed.</p><p>“It’s just pretty cool to study such an iconic organism,” says co-author Rozenn Pineau, a plant evolutionary geneticist at the University of Chicago in Illinois. “I think it’s important to draw people’s attention on natural wonders of the world.”</p><h2>One very big tree</h2><p>Pando — whose name means ‘I spread’ in Latin — consists of some 47,000 stems that cover an area of 42.6 hectares in Utah’s Fishlake National Forest. Because of the way the plant reproduces, this collection of aspens is technically all one tree, supported by a single, vast root system. Pando is triploid, meaning that its cells contain three copies of each chromosome, rather than two. As a result, Pando cannot reproduce sexually and mix its DNA with that of other trees, and instead creates clones of itself.</p><article data-label="Related"><a href="https://www.nature.com/articles/d41586-022-04150-0" data-track="click" data-track-label="recommended article"><img alt="" src="https://media.nature.com/w400/magazine-assets/d41586-024-03570-4/d41586-024-03570-4_27122472.jpg"><p>The trees’ lessons: climate records are written in tree rings</p></a></article><p>Although this process generates offspring that are genetically identical, they can still accumulate genetic mutations as their cells divide. Biologists are interested in these variations because they provide information on how the plant has changed since the first seedling sprouted. Some studies have explored the spread of new mutations in plants and fungi that reproduce clonally, but few have investigated centuries-old plants like Pando.</p><p>“It’s kind of shocking to me that there hasn’t been a lot of genetic interest in Pando already, given how cool it is,” says study co-author William Ratcliff, an evolutionary biologist at the Georgia Institute of Technology in Atlanta.</p><p>The researchers collected samples of roots, bark, leaves and branches from across the Pando clone, as well as from other, unrelated quaking aspen trees for comparison. They extracted DNA from the samples, then sequenced and analysed a subsection of the genome.</p><p>After removing variants that were found in both Pando and neighbouring trees, as well as mutations found in just one sample, the researchers were able to review nearly 4,000 genetic variants that had arisen as Pando cloned itself repeatedly over millennia.</p><p>Analysing the patterns of these mutations revealed surprising results. “You would expect that the trees that are spatially close are also closer genetically,” says Pineau. “But this is not exactly what we find. We found a spatial signal, but that is much weaker than what we expected.” Physically close trees did share more similar mutations than those that were far apart — but only slightly more. However, over a smaller scale of 1–15 metres the trend was stronger, with stems that were closer together having significantly more shared mutations. Pando covers an area of more than 40 hectares, “but it almost looks like it’s a well-mixed pot of genetic information”, says Ratcliff.</p><h2>Protective mechanism</h2><p>By inputting Pando’s genetic data into a theoretical model that plots an organism’s evolutionary lineage, the researchers also estimated Pando’s age. They put this at between 16,000 and 80,000 years. “It makes the Roman Empire seem like just a young, recent thing,” says Ratcliff.</p><p>The team also considered reasons for the tree’s remarkable endurance. Pineau says that Pando being triploid might lead to “bigger cells, bigger organisms, better fitness”, and that existing clones might be more durable than new mixed offspring.</p><p>Philippe Reymond, who researches interactions between plants and herbivores at the University of Lausanne in Switzerland, says that the findings hint that “plants and trees have a mechanism to protect the genome” from the accumulation of harmful genetic mutations, a suggestion that is “quite interesting for many scientists”. He adds that future studies could search for this exact mechanism at the cellular level.</p><p>Ratcliff is also keen for more studies to be done on Pando’s genetic history. “I would love to make a call for people to work on these kinds of organisms,” he says.</p>
                    
                </div></div>]]></description>
        </item>
    </channel>
</rss>