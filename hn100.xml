<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>HN100 - Readable Contents</title>
        <link>https://hn.algolia.com/api/v1/search_by_date?tags=%28story,poll%29&amp;numericFilters=points%3E100</link>
        <description>Uses Readability to add bodies to the RSS feed</description>
        <lastBuildDate>Sun, 28 Jul 2024 20:30:04 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Perfectionism – one of the biggest productivity killers in the eng industry (128 pts)]]></title>
            <link>https://newsletter.eng-leadership.com/p/perfectionism-one-of-the-biggest</link>
            <guid>41094485</guid>
            <pubDate>Sun, 28 Jul 2024 17:14:28 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://newsletter.eng-leadership.com/p/perfectionism-one-of-the-biggest">https://newsletter.eng-leadership.com/p/perfectionism-one-of-the-biggest</a>, See on <a href="https://news.ycombinator.com/item?id=41094485">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><article><div dir="auto"><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg" width="800" height="445" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:445,&quot;width&quot;:800,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:27704,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/jpeg&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:false,&quot;topImage&quot;:true,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F597a1df9-bf38-4e9c-a3a0-7f20097379ef_800x445.jpeg 1456w" sizes="100vw" fetchpriority="high"></picture></div></a></figure></div><p>Perfectionism is one of these things that hurt us without even realizing it. We may think it’s great to put so much effort into ensuring the result is “perfect”, but at the end of the day, we never finish it and it becomes an endless “work in progress”, which is a big problem.</p><p><span>This article is done in collaboration with </span><a href="https://www.linkedin.com/in/jordancutler1/" rel="">Jordan Cutler</a><span>, Senior Software Engineer at Pinterest and the author of the newsletter </span><a href="https://read.highgrowthengineer.com/" rel="">High Growth Engineer</a><span>.</span></p><p>We both made a lot of mistakes thinking that perfecting is the way to go and after some time we realized that progress is so much better!</p><p>And today, we are sharing our stories with you! Let’s start with Jordan’s first.</p><p>Early in my career, I spent a lot of time writing code. In fact, I shipped over 1200 pull requests (PRs) in my first 3 years as an engineer, averaging ~1-2 PRs per day.</p><p>While the code velocity was high, I was focusing on the wrong things. Most of the PRs were dedicated to “perfecting” our codebase.</p><p>At the time, I thought I was doing great things. Who wouldn’t love the code to be spruced up? But looking back, I realized how I could have spent my time so much better.</p><p>Instead of perfecting code, often code that hadn’t been touched in years and didn’t need to be touched, I could have been adding value for the team.</p><p>Things like:</p><ul><li><p>Reducing the plate of my teammates, rather than adding to it with more code reviews to give them</p></li><li><p>Shipping the current feature faster and getting ahead on the next one</p></li><li><p>Asking my manager how I can help them more</p></li></ul><p>So, even though I shipped all those PRs early in my career, today I realize how meaningless it is.</p><p>If I had spent less time perfecting code, I could have shipped 50% fewer PRs and added 2x more value to the team.</p><p>Today, I’m lucky if I ship more than 3 PRs in a week. That’s because my focus is on working on the right things, which often means helping the team, creating partnerships, writing proposals, and scaling myself through docs. When I do ship code, it’s with clear intent to move value for the team or business.</p><p>Outside of this example, I avoid perfectionism by doing 3 things:</p><ol><li><p><strong>Writing down my priorities</strong><span> at the start of the week, which helps me know what’s most important to accomplish. Hint: It’s usually not perfecting something.</span></p></li><li><p><strong>Shipping the smallest unit of value</strong><span> I can, either to internal or external customers. For example, shipping an 80% working prototype behind a feature flag to get early feedback internally.</span></p></li><li><p><strong>Seeking early feedback</strong><span>. I set up 4-hour focus time blocks at the start of my day and make as much progress as I can. Then, I ask myself, “Based on what I accomplished, is there anything I should share or request feedback on?” I do this all the time with technical docs. I ask my team, “Am I going in a completely wrong direction here, or should I continue on this path?” Sometimes, I find there’s a simpler solution than my proposal, it’s already explored, or not valuable. That saves me hours of time from perfecting the doc.</span></p></li></ol><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png" width="1456" height="505" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/f95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:505,&quot;width&quot;:1456,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:314206,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ff95e1da5-498c-4028-8c3d-257bfbc53493_1600x555.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p>Less perfection. More progress.</p><p>Perfectionism has been a problem for me starting from an early age. I’ve always wanted to make things the best quality possible, especially things that matter a lot to me.</p><p>It took a long time for me to realize it’s actually counter-productive. Here are the most prominent things that I wanted to perfect as a Software Engineer and a manager:</p><p><strong>I wanted to learn “perfectly” from tutorials</strong></p><p>In my early days as a self-taught engineer, I did SO much learning from tutorials.</p><p>Looking back at that time, I could see how I could have progressed much faster if I hadn’t wanted to always make sure that I finished every single tutorial 100%, plus with the mindset of “I shouldn’t miss any second of it”.</p><p><span>What I know now, the best way to learn from tutorials is to get what you need and apply that to your own project. Building your own project is the best way to learn. You can find more details about this here: </span><a href="https://newsletter.eng-leadership.com/p/become-a-better-engineer-by-working" rel="">Become a better engineer by working on side projects</a><span> (paid article).</span></p><p><strong>I wanted to design “perfect” things</strong></p><p>In one of my student jobs as a Software Engineer, I was also doing a lot of design related things like designing banners, websites also doing some graphic design. I saw a repeating pattern when designing.</p><p>That pattern was that I would create a draft quite quickly, but then spend the 2-4x amount of time applying finishing touches. Which was quite counter-productive and also stressful for me.</p><p>I spent so much time trying to make sure it’s “pixel perfect”: right colors, right fonts, right spacing, etc. I would make so much more progress if I would just be fine with it. The funny thing is that the end result wasn’t much better than the first draft (maybe a tad more).</p><p><strong>I wanted to create “perfect” code</strong></p><p>Especially early on in my career as a Software Engineer, I would feel that I need to write perfect code, before showing it to others.</p><p>I spent so much time refactoring functions, renaming variables, rethinking the approach and overall looking for ways to optimize it. It was my impostor syndrome telling me that I was not good enough to do this.</p><p>That got me to the place where my overall progression was hurting and similar with designing → it caused additional stress to me.</p><p>I would be making SO much more progress if I would be focusing on good enough code and getting feedback early on! So much wasted time trying to “perfect”.</p><p><strong>As a manager, I wanted to wait for “perfect” timings and make “perfect” decisions</strong></p><p>I thought that my timing to give feedback needed to be perfect. Well, the outcome of waiting was that things got a lot worse.</p><p>I said to myself: “Maybe things will get better if I wait for a bit more time”. Well, the reality was that things didn’t. And my waiting for perfect timing made it a LOT worse.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png" width="800" height="400" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/bd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:400,&quot;width&quot;:800,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:46210,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fbd7425a3-c8d3-45d9-98bc-fb5e42d76671_800x400.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p>Similar to making decisions. “They need to be perfect”, I said to myself. And that got me to the place, where I didn’t make the decisions fast enough, which actually blocked my team from progressing.</p><p>And I realized over time, that not all the decisions will be the absolute right ones, but it’s much better to make a decision and reverse it later if needed, instead of not making it at all.</p><p><strong>Here are my top 3 learnings:</strong></p><ul><li><p>Focusing on progression instead of perfecting will make you SO much more productive + it’s so much better for your mental health.</p></li><li><p>Perfect moments do not exist and waiting for them will just cause a lot more issues. Doing things now or as soon as you can is the way to go when you are dealing with important things.</p></li><li><p>Whenever I feel like I am trying to “perfect”, I think of this: 100% does not exist and 95% is good enough in the majority of the cases. That shifts my mind into making progress instead of perfecting.</p></li></ul><p><span>Thanks to Jordan for sharing his story and his insights on this very important topic. Make sure to check him out on </span><a href="https://www.linkedin.com/in/jordancutler1/" rel="">LinkedIn</a><span> and also check out his </span><a href="https://read.highgrowthengineer.com/" rel="">newsletter</a><span>!</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png" width="800" height="400" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/2a065581-415f-4ca6-8506-8051f5fec840_800x400.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:400,&quot;width&quot;:800,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:386666,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F2a065581-415f-4ca6-8506-8051f5fec840_800x400.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>Jordan (left) and me (right) rocking the Progress over Perfection T-shirts!</figcaption></figure></div><p>Let’s end this article with this important message:</p><blockquote><p>There is no such thing as “perfection” and the faster we realize it, the better our progress is going to be and the more things we’ll get done!</p></blockquote><ul><li><p><a href="https://newsletter.eng-leadership.com/p/biggest-productivity-killers-in-the" rel="">Biggest productivity killers in the engineering industry</a><span> (paid article)</span></p></li><li><p><a href="https://newsletter.eng-leadership.com/p/context-switching-one-of-the-worst" rel="">Context-switching - one of the worst productivity killers in the engineering industry</a><span> (paid article)</span></p></li><li><p><a href="https://newsletter.eng-leadership.com/t/productivity" rel="">Check out the full Productivity learning track</a><span> (8 articles)</span></p></li></ul><p>We are not over yet!</p><p>After months of testing and especially trying so many different T-shirts, the store is now officially available to all of you!</p><div><figure><a target="_blank" href="https://store.eng-leadership.com/" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png" width="800" height="600" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/fd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:600,&quot;width&quot;:800,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:115372,&quot;alt&quot;:null,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:&quot;https://store.eng-leadership.com/&quot;,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Ffd0cf284-fa91-4005-a8aa-0ff698e8bd32_800x600.png 1456w" sizes="100vw" loading="lazy"></picture></div></a></figure></div><p>You can get the same Progress over Perfection T-shirt that both me and Jordan are wearing. Or others available. I wear these shirts proudly almost every day. I especially love to wear them when doing exercise!</p><p data-attrs="{&quot;url&quot;:&quot;https://store.eng-leadership.com/&quot;,&quot;text&quot;:&quot;I want to check it out!&quot;,&quot;action&quot;:null,&quot;class&quot;:null}" data-component-name="ButtonCreateButton"><a href="https://store.eng-leadership.com/" rel=""><span>I want to check it out!</span></a></p><p><span>Paid subscribers, you are getting </span><strong>20% off</strong><span> on everything in the store!</span></p><p><span>You can find the discount code here: </span><a href="https://newsletter.eng-leadership.com/p/special-deals-for-paid-subscribers" rel="">💰 Special Deals for paid subscribers</a></p><p>Liked this article? Make sure to 💙 click the like button.</p><p>Feedback or addition? Make sure to 💬 comment.</p><p>Know someone that would find this helpful? Make sure to 🔁 share this post.</p><ul><li><p><span>Join the Cohort course Senior Engineer to Lead: Grow and thrive in the role </span><a href="https://maven.com/gregor-ojstersek/senior-engineer-to-lead?promoCode=ENGLEADERSHIP" rel="">here</a><span>.</span></p></li><li><p><span>Book a Coaching and Mentoring or Consulting and Advising call with me </span><a href="https://tidycal.com/gregorojstersek" rel="">here</a><span>.</span></p></li><li><p><span>Interested in sponsoring this newsletter? Check the sponsorship options </span><a href="https://calico-cabinet-fbf.notion.site/Sponsor-Engineering-Leadership-fa0579535d6f4422a6da350580a54546" rel="">here</a><span>.</span></p></li></ul><p><span>You can find me on </span><a href="https://www.linkedin.com/mynetwork/discovery-see-all/?usecase=PEOPLE_FOLLOWS&amp;followMember=gregorojstersek" rel="">LinkedIn</a><span> or </span><a href="https://twitter.com/gregorojstersek" rel="">Twitter</a><span>.</span></p><p>If you wish to make a request on particular topic you would like to read, you can send me an email to info@gregorojstersek.com.</p><p>This newsletter is funded by paid subscriptions from readers like yourself.</p><p>If you aren’t already, consider becoming a paid subscriber to receive the full experience!</p><p data-attrs="{&quot;url&quot;:&quot;https://newsletter.eng-leadership.com/about#§paid-subscribers-get&quot;,&quot;text&quot;:&quot;Check the benefits of the paid plan&quot;,&quot;action&quot;:null,&quot;class&quot;:&quot;button-wrapper&quot;}" data-component-name="ButtonCreateButton"><a href="https://newsletter.eng-leadership.com/about#%C2%A7paid-subscribers-get" rel=""><span>Check the benefits of the paid plan</span></a></p><p>You are more than welcome to find whatever interests you here and try it out in your particular case. Let me know how it went! Topics are normally about all things engineering related, leadership, management, developing scalable products, building teams etc.</p></div></article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How simultaneous multithreading works under the hood (105 pts)]]></title>
            <link>https://blog.codingconfessions.com/p/simultaneous-multithreading</link>
            <guid>41093916</guid>
            <pubDate>Sun, 28 Jul 2024 15:35:14 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://blog.codingconfessions.com/p/simultaneous-multithreading">https://blog.codingconfessions.com/p/simultaneous-multithreading</a>, See on <a href="https://news.ycombinator.com/item?id=41093916">Hacker News</a></p>
<div id="readability-page-1" class="page"><div dir="auto"><p>Simultaneous multithreading (SMT) is a feature that lets a processor handle instructions from two different threads at the same time. But have you ever wondered how this actually works? How does the processor keep track of two threads and manage its resources between them?</p><p>In this article, we’re going to break it all down. Understanding the nuts and bolts of SMT will help you decide if it’s a good fit for your production servers. Sometimes, SMT can turbocharge your system's performance, but in other cases, it might actually slow things down. Knowing the details will help you make the best choice.</p><p>So, let’s dive in and figure out how SMT works, why it was invented in the first place, and what it means for you. </p><blockquote><h5><em><strong>Disclaimer:</strong></em><span> </span><em>Much of the discussion in this article is about Intel’s implementation of SMT, also called hyper-threading. It is based on their white paper published in 2002</em></h5></blockquote><p><strong>Watch Video Instead:</strong><span> </span><em>If you prefer video over text, then you can also watch the recording of a live session I did on this topic:</em><span> </span></p><div data-component-name="DigestPostEmbed"><a href="https://blog.codingconfessions.com/p/recording-how-hyper-threading-works" target="_blank" rel="noopener"><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_140,h_140,c_fill,f_webp,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-video.s3.amazonaws.com%2Fvideo_upload%2Fpost%2F146388589%2Fbe1acb70-4217-4ce5-81bb-b051d8c3c24e%2Ftranscoded-00001.png"><img src="https://substackcdn.com/image/fetch/w_140,h_140,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-video.s3.amazonaws.com%2Fvideo_upload%2Fpost%2F146388589%2Fbe1acb70-4217-4ce5-81bb-b051d8c3c24e%2Ftranscoded-00001.png" sizes="100vw" alt="Recording: How Hyper-Threading Works — A Microarchitectural Perspective" width="140" height="140"></picture></div></a></div><p>SMT was introduced to improve the utilization of the resources in the processor. At the microarchitecture level, processors consist of hundreds of registers, multiple load/store units and multiple arithmetic units. To utilize these better, processors also employ various techniques for instruction level parallelism (ILP), such as instruction pipelining, superscalar architecture, out-of-order execution to name a few.</p><p>A pipelined processor improves the resource utilization by breaking down the execution of an instruction into multiple stages which form a pipeline, like the assembly line of a factory. In each cycle, an instruction moves from one stage of the pipeline to the next and the processor adds a new instruction to the first stage of the pipeline. The following figure shows how pipelining works for a pipeline of depth 5. As you can see, 5th cycle onwards, the processor will have upto 5 instructions in flight each cycle, and it will finish 1 instruction each cycle after that.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png" width="607" height="133" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:133,&quot;width&quot;:607,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;Illustration of a five-stage instruction pipeline. In each cycle, an instruction moves to the next stage which makes up space in the first stage and a new instruction can also start getting processed in each cycle. A super deep pipeline will have many instructions being processed in parallel.&quot;,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="Illustration of a five-stage instruction pipeline. In each cycle, an instruction moves to the next stage which makes up space in the first stage and a new instruction can also start getting processed in each cycle. A super deep pipeline will have many instructions being processed in parallel." title="Illustration of a five-stage instruction pipeline. In each cycle, an instruction moves to the next stage which makes up space in the first stage and a new instruction can also start getting processed in each cycle. A super deep pipeline will have many instructions being processed in parallel." srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7cbbeb2e-ed04-4f44-bb88-683713a2a740_607x133.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>Illustration of a five-stage instruction pipeline. In each cycle, an instruction moves to the next stage which makes up space in the first stage and a new instruction can also start getting processed in each cycle. A super deep pipeline will have many instructions being processed in parallel.</figcaption></figure></div><p>Modern processors are also superscalar, which means instead of issuing one instruction each cycle, they can issue multiple instructions. For instance, the recent Intel core i7 processors can issue 4 instructions each cycle (also called the issue width of the processor).</p><p>Instruction pipelining and superscalar architecture significantly improve the instruction throughput and resource utilization of the processor. However, in practice, this max utilization can be difficult to achieve. To execute so many instructions in parallel, the processor needs to find enough independent instructions in the program, which is very hard.</p><p><span>This typically leads to two kinds of wastages. One is </span><em>horizontal waste</em><span> which occurs when the processor is not able to find enough independent instructions in the thread to saturate the issue width of the processor.</span></p><p><span>The other type of wastage is  </span><em>vertical waste</em><span> that occurs when the processor is unable to issue any instructions in a cycle because all the next instructions in the program are dependent on the currently executing ones.</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png" width="665" height="351" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:351,&quot;width&quot;:665,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:45702,&quot;alt&quot;:&quot;Illustration of horizontal and vertical state in a processor with issue width of 5 instructions per cycle. The empty boxes represent the instruction slots where the processor could not issue an instruction&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="Illustration of horizontal and vertical state in a processor with issue width of 5 instructions per cycle. The empty boxes represent the instruction slots where the processor could not issue an instruction" title="Illustration of horizontal and vertical state in a processor with issue width of 5 instructions per cycle. The empty boxes represent the instruction slots where the processor could not issue an instruction" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd0121e9e-b8b1-4374-ba66-2683ad8364fa_665x351.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>Illustration of horizontal and vertical state in a processor with issue width of 5 instructions per cycle. The empty boxes represent the instruction slots where the processor could not issue an instruction</figcaption></figure></div><p>One way to better utilize the processing power is using traditional multithreading where the processor context switches between multiple threads. In this scheme, within a given cycle the processor issues instructions for only one thread, so this may still result in horizontal waste. However, in the next cycle the processor can context switch and issue instructions for another thread and avoid vertical wastage. This results in improved CPU utilization, however, with larger issue width processors, the horizontal wastage can still be significant. Also, there is the overhead of context switching between the threads.</p><p>This is where the idea of simultaneous multithreading was introduced. It enables the processor to issue instructions for multiple threads in the same cycle without any overhead of context switching. By definition, instructions of different threads are independent and can be executed in parallel which ultimately results in full utilization of the execution resources. </p><blockquote><p><em>Even though the idea of SMT doesn’t put a limit on the number of threads, Intel’s implementation of SMT (called hyper-threading) restricts it to two threads per core.</em></p></blockquote><p>We understand why SMT was introduced, now let’s learn about how it is implemented. Along with the implementation details we will also cover how it actually works.</p><p><span>A normal non-SMT processor can only execute instructions for one thread at a time. This is because every thread has an associated context to represent the current state of the program on the processor, which is also called the </span><a href="https://en.wikipedia.org/wiki/Architectural_state" rel="">architecture state</a><span>. This includes the data in the registers, the program counter value, the control registers etc. </span></p><p>To simultaneously execute instructions of two threads, the processor needs to be able to represent the state of the two threads simultaneously. So to implement the SMT capability, the hardware designers duplicated the architecture state of the processor. By doing so, a single physical processor appears as two logical processors to the operating system (OS), so that it can schedule threads for execution on them.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png" width="1342" height="747" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:747,&quot;width&quot;:1342,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:60239,&quot;alt&quot;:&quot;Illustration of a two core processor without SMT (top) and a two core processor with SMT (bottom). For implementing SMT the architecture state has been duplicated in the bottom processor and it will appear as having four processing cores to the OS.&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="Illustration of a two core processor without SMT (top) and a two core processor with SMT (bottom). For implementing SMT the architecture state has been duplicated in the bottom processor and it will appear as having four processing cores to the OS." title="Illustration of a two core processor without SMT (top) and a two core processor with SMT (bottom). For implementing SMT the architecture state has been duplicated in the bottom processor and it will appear as having four processing cores to the OS." srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F8ddb618f-a2b8-4524-b4e7-7a3f45c10d48_1342x747.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>Illustration of a two core processor without SMT (top) and a two core processor with SMT (bottom). For implementing SMT the architecture state has been duplicated in the bottom processor and it will appear as having four processing cores to the OS.</figcaption></figure></div><p>Apart from that, at the microarchitecture level, the processor also has various buffers and execution resources as well. To execute the instructions of two threads simultaneously, these resources are also either duplicated or shared between the two logical processors. The decision of whether to duplicate or to share a resource is based on many factors. For instance, how costly is it to duplicate a resource, in terms of power consumption and real-estate on the chip. </p><p>The crucial details about how SMT works lies in its microarchitectural implementation, so let’s go deeper into that.</p><p><em>The processor exposes the instruction set architecture (ISA) as the public interface for the programmers to program the CPU. The ISA includes the set of instructions, and the registers that the instructions can use. The microarchitecture of the processor is its internal implementation detail. Different processor models can support the same ISA but at the microarchitecture level they might be different.</em></p><p><span>The microarchitecture has three parts: the </span><em>frontend</em><span>, the </span><em>backend</em><span> and the </span><em>retirement unit</em><span>. The following diagram shows the schematics of the microarchitecture of a modern day processor:</span></p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png" width="695" height="631" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:631,&quot;width&quot;:695,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:56859,&quot;alt&quot;:&quot;The schematics of the microarchitecture of a modern processor consisting of the frontend, the backend, and the retirement unit&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="The schematics of the microarchitecture of a modern processor consisting of the frontend, the backend, and the retirement unit" title="The schematics of the microarchitecture of a modern processor consisting of the frontend, the backend, and the retirement unit" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F987bee1e-0bec-4753-947c-5ff58cb1a260_695x631.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>The schematics of the microarchitecture of a modern processor consisting of the frontend, the backend, and the retirement unit</figcaption></figure></div><p>The frontend is the part which contains the instruction control unit that fetches and decodes the program instructions which should be executed next.</p><p>The backend consists of the execution resources, such as the physical registers, the arithmetic units, and the load/store units. It picks up the decoded instructions provided by the frontend, allocates execution resources for them and schedules them for execution.</p><p>The retirement unit is where the results of the executed instructions are finally committed to the architecture state of the processor.</p><p>To understand how SMT works we will go deeper into each of three components of the CPU microarchitecture. Let’s start with the frontend.</p><p>The following figure shows a more zoomed in view of the microarchitecture frontend. It consists of several components with each having a distinct role behind the fetching and decoding of instructions. Let’s talk about them one by one.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png" width="497" height="486" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/d1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:486,&quot;width&quot;:497,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:70383,&quot;alt&quot;:&quot;A zoomed in view of the frontend of an X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002.&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="A zoomed in view of the frontend of an X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002." title="A zoomed in view of the frontend of an X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002." srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fd1bf4a84-1c63-461e-9050-cd925a66749c_497x486.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>A zoomed in view of the frontend of an X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002.</figcaption></figure></div><p>To track which instructions to fetch, the frontend contains an instruction pointer which contains the address of the next instruction of the program.</p><p>In the case of an SMT capable processor, there are two sets of instruction pointers which track the next instruction for the two programs independently.</p><p>The instruction pointers gives the addresses of the next instructions of the threads and the frontend has to read the instructions from those addresses. Before doing that it first checks for the existence of those instructions in the trace cache. </p><p>The trace cache contains recently decoded traces of instructions. Instruction decoding is an expensive operation and some instructions need to be executed frequently. Having this cache helps the processor cut down the instruction execution latency.</p><p>Trace cache is shared dynamically between the two logical processors on an as needed basis. If one thread is executing more instructions than the other, it is allowed to occupy more entries in the trace cache.</p><p>Each entry in the cache is tagged with the thread information to distinguish the instructions of the two threads. The access to the trace cache is arbitrated between the two logical processors each cycle. </p><p>If there is a miss in the trace cache, then the frontend looks for the instruction for the given address in the L1 instruction cache. If there is a miss in the L1 instruction cache, then it needs to fetch the instruction from the next level cache or the main memory.</p><p><span>The L1 instruction caches data using its </span><a href="https://en.wikipedia.org/wiki/Virtual_address_space" rel="">virtual address</a><span>, but main memory lookups require physical addresses. To translate the virtual addresses into physical addresses, the instruction lookaside buffer (ITLB) is used which contains the recently translated virtual addresses. </span></p><p>In an SMT capable processor, each logical processors has its own ITLB cache.</p><p>The instruction fetch logic for fetching the instructions from the main memory works on a first come first served basis, but it reserves at least one request slot for each logical processor so that both can make progress.</p><p>Once the instructions arrive from the main memory, they are kept in a small streaming buffer before they get picked up for decoding. These buffers are also small structures and duplicated for the logical processors in an SMT capable processor.</p><p>Once the instructions are fetched, they are decoded into smaller and simpler instructions called micro instructions (uops). These uops are put into the uop queue which acts as the boundary between the CPU frontend and backend. </p><p>The uop queue is shared equally between the two logical processors. This static partitioning enables both the logical processors to make independent progress.</p><p>Once the Uop queue has microinstructions ready, the role of the backend starts. The following figure shows a zoomed in view of the backend of an Intel X86 processor.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png" width="1056" height="479" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:479,&quot;width&quot;:1056,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:null,&quot;alt&quot;:&quot;The zoomed in view of the backend of an Intel X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002.&quot;,&quot;title&quot;:null,&quot;type&quot;:null,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="The zoomed in view of the backend of an Intel X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002." title="The zoomed in view of the backend of an Intel X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002." srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F66314505-33d7-441b-9cfb-8c4bbeb61085_1056x479.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>The zoomed in view of the backend of an Intel X86 processor. Source: Intel Technology Journal, Vol 06, Issue 01, 2002.</figcaption></figure></div><p>Let’s talk about what happens in the backend component wise. </p><p>The backend picks up the micro instructions from the uop queue and executes them. However, it executes them out of their original program order. </p><p>Nearby instructions in a program are typically dependent on each other and these instructions may stall because they may perform a long latency operation, such as reading from main memory. As a result, all of their dependent instructions will also have to wait. In such a situation, the processor’s resources are wasted. To alleviate this problem, out-of-order execution engine is employed which picks up later instructions of the program and executes them out of their original order.</p><p>The out-of-order execution engine consists of an allocator which identifies the resources required by these micro instructions and allocates them based on their availability.</p><p>The allocator allocates resources for the micro instructions of one logical processor in one cycle and then switches to the other logical processor in the next cycle. If the uop queue has micro instructions for only one of the logical processors, or one of the logical processors has exhausted its share of resources, then the allocator uses all the cycles for the other logical processor.</p><p>So what are these resources that the allocator allocates to the micro instructions and how are they shared?</p><p>The first resource that the micro instructions need is registers. At the ISA level the processor might only have a very few registers (e.g. X86-64 has 16 general purpose integer registers), but at the microarchitecture level there are hundreds of physical integer registers, and similar number of floating-point registers. In an SMT enabled processor, these registers are divided equally between the two logical processors.</p><p>Apart from the registers, the backend also has a number of load and store buffers. These buffers are used for doing memory read and write operations. Again, in an SMT enabled processor, they are divided equally between the logical processors.</p><p>To enable out-of-order execution, the backend also needs to perform register renaming. Because at the ISA level there are only a handful of architectural registers, the program instructions will reuse the same register in many independent instructions. And, the out-of-order execution engine wants to execute these instructions ahead of their original order and in parallel. For doing so, it renames the original logical registers used in the program instructions to one of the physical registers. This mapping is maintained in the register alias table (RAT). </p><p>Because the two logical processors have their own sets of architectural registers, they also have their own copy of the RAT. </p><p>After the register renaming and allocator stages, the instructions are almost ready to execute. They are put into two sets of queues — one is for the memory read/write instructions and the other is for all other general instructions. These queues are also partitioned equally between the two logical processors in an SMT enabled core.</p><p>The processor has multiple instruction schedulers which operate in parallel. In each CPU cycle, some of the instructions from the instruction ready queues are pushed to the schedulers. The queues switch between the instructions of the two logical processors each cycle, i.e., in one cycle they push the instruction of one logical processor and in the next they switch to the second logical processor. </p><p>Each scheduler itself has a small internal buffer to store these pushed instructions temporarily until the scheduler can schedule them for execution. Each of these instructions need certain operands and execution units to be available. As soon as the required data and resources for one of the instructions become available, the scheduler dispatches that instruction for execution. </p><p>The schedulers do not care about the logical processors, they will execute a micro instruction as soon as the resources required by that instruction are available. But to ensure fairness, there is a limit on the number of active entries for a logical processor in the scheduler’s queue. </p><p>After the execution of an instruction finishes and its result is ready, it is placed in the reorder buffer. Even though the instructions are executed out-of-order, they need to be committed to the processor’s architecture state in their original program order. The reorder buffer enables this.</p><p>The reorder buffer is split equally between the two logical processors in an SMT enabled core.</p><p>The retirement unit tracks when the instructions are ready to be committed to the architecture state of the processor and retires them in their correct program order.</p><p>In an SMT enabled processor core, the retirement unit alternates between the micro instructions for each logical processor. If one of the logical processors does not have any micro instructions to be retired, then the retirement unit spends all the bandwidth on the other logical processor.</p><p>After an instruction retires, it might also have to write to the L1 cache. At this point the selection logic comes into the picture to do these writes, and that also alternates between the two logical processors each cycle to write the data to the cache.</p><p>While we have covered how the execution resources of a processor core are shared between the logical processors for an SMT enabled system, we have not talked about memory access. Let’s discuss what happens there.</p><p>The translation lookaside buffer (TLB) is a small cache which holds the translation of virtual addresses to physical addresses for data requests. The TLB is shared dynamically between the two logical processors on an as needed basis. To distinguish the entries for the two logical processors, each entry is also tagged with the logical processor id. </p><p>Each CPU core has its own private L1 cache. Depending on the microarchitecture, the L2 cache might also be private or it might be shared between the cores. If there is an L3 cache, it is shared between the cores. The caches are also oblivious to the existence of the logical processors.</p><div><figure><a target="_blank" href="https://substackcdn.com/image/fetch/f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png" data-component-name="Image2ToDOM" rel=""><div><picture><source type="image/webp" srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_webp,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 1456w" sizes="100vw"><img src="https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png" width="866" height="470" data-attrs="{&quot;src&quot;:&quot;https://substack-post-media.s3.amazonaws.com/public/images/6010b920-377a-41bf-9a47-d5378699661d_866x470.png&quot;,&quot;srcNoWatermark&quot;:null,&quot;fullscreen&quot;:null,&quot;imageSize&quot;:null,&quot;height&quot;:470,&quot;width&quot;:866,&quot;resizeWidth&quot;:null,&quot;bytes&quot;:77007,&quot;alt&quot;:&quot;Depiction of L1 and L2 caches in a 2 core processor. Each core has its own private L1 and L2 caches.&quot;,&quot;title&quot;:null,&quot;type&quot;:&quot;image/png&quot;,&quot;href&quot;:null,&quot;belowTheFold&quot;:true,&quot;topImage&quot;:false,&quot;internalRedirect&quot;:null}" alt="Depiction of L1 and L2 caches in a 2 core processor. Each core has its own private L1 and L2 caches." title="Depiction of L1 and L2 caches in a 2 core processor. Each core has its own private L1 and L2 caches." srcset="https://substackcdn.com/image/fetch/w_424,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 424w, https://substackcdn.com/image/fetch/w_848,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 848w, https://substackcdn.com/image/fetch/w_1272,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 1272w, https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6010b920-377a-41bf-9a47-d5378699661d_866x470.png 1456w" sizes="100vw" loading="lazy"></picture></div></a><figcaption>Depiction of L1 and L2 caches in a 2 core processor. Each core has its own private L1 and L2 caches.</figcaption></figure></div><p>As the L1 (and possibly L2) cache is private to the core, it will contain data for both the logical processors on an as needed basis. This can cause conflict and eviction of the data and hamper the performance. On the other hand if the threads running on the two logical processors are working with the same set of data, the shared cache might improve their performance.</p><p>At this point we have covered almost everything about how SMT is implemented at the microarchitecture level and how the instructions for the two logical processors are executed in parallel. Now let’s discuss the performance impact.</p><p>As we have seen, enabling SMT on a CPU core requires sharing many of the buffers and execution resources between the two logical processors. Even if there is only one thread running on an SMT enabled core, these resources remain unavailable to that thread which reduces its potential performance.</p><p>Apart from the wasted shared resources in the absence of the 2nd thread, there is another performance impact. The operating system runs an idle loop on the unused logical processor which waits for instructions to arrive. This loop also wastes resources which could otherwise be spent on letting the other logical processor at its peak potential.</p><p>If you have two threads running on the two logical processors, then one of the things to think about is their cache access patterns. If the threads are using the cache aggressively and competing for it then they are bound to run into conflicts and evict each other’s data, which will degrade their performance.</p><p>On the other hand, if the threads are cooperating in nature, they might help improve each other’s performance. For instance, one thread is producing some data which is consumed by the other thread, then their performance will improve because of the data sharing in the cache.</p><p>If the two threads are not competing for cache, then they might be able to run fine without hampering each other’s performance, while improving the resource usage of the CPU core. </p><p>However, many experts believe that when absolute maximum performance is needed for a program, it is best to disable SMT so that the single thread will have all the resources available to it.</p><p><span>Apart from performance, there are also security issues associated with SMT which were discovered in the recent few years (see </span><a href="https://docs.oracle.com/en/operating-systems/oracle-linux/notice-smt/" rel="">this</a><span> and </span><a href="https://access.redhat.com/solutions/rhel-smt" rel="">this</a><span> for examples). Because of the shared resources and speculative execution of instructions, a lot of these issues open up possibilities of leaks of sensitive data to the attacker. As a result, the general advice has been to disable SMT in the systems. There is also </span><a href="https://www.extremetech.com/computing/intels-arrow-lake-cpus-will-allegedly-ditch-hyper-threading-leak" rel="">rumor</a><span> that because of these issues Intel might remove hyperthreading from their next generation of processors (Arrow Lake). </span></p><p>Let's wrap things up. Understanding how Simultaneous Multithreading (SMT) works is super helpful when you’re deciding whether or not to use it in your production servers. SMT was designed to make better use of CPU resources and boost instruction throughput. While it does a good job of that by letting multiple threads run at the same time, there are definitely some trade-offs to keep in mind.</p><p>Inside the processor, SMT means duplicating certain parts and sharing or dividing up others between the threads. This can lead to mixed results depending on what kind of work your CPU is handling. Sure, SMT can improve resource usage and system throughput overall, but it can also cause competition for shared resources, which can slow down individual threads.</p><p>Security is another big factor. Recent vulnerabilities have shown that sharing resources in SMT-enabled CPUs can be risky. Sensitive data could end up getting exposed, which is why some experts often recommend disabling SMT in security-critical systems.</p><p>So, should you use SMT? It really depends. If your workloads need the highest performance and lowest latency, turning SMT off might give you that edge. But if you’re running general-purpose tasks that can benefit from more parallelism, keeping SMT on could be a win.</p><p>By getting a handle on these details, you’ll be better equipped to decide what's best for your setup, ensuring you get the most efficient—and secure—performance out of your servers.</p><ul><li><p><a href="https://www.intel.com/content/dam/www/public/us/en/documents/research/2002-vol06-iss-1-intel-technology-journal.pdf" rel="">Intel Technology Journal, 2002, Vol 06, Issue 1</a></p></li><li><p><a href="https://www.princeton.edu/~rblee/ELE572Papers/SMT_Eggers.pdf" rel="">Simultaneous Multithreading: Maximizing On-Chip Parallelism</a></p></li><li><p><a href="https://arxiv.org/pdf/2310.12786" rel="">SYNPA: SMT Performance Analysis and Allocation of Threads to Cores in ARM Processors</a></p></li></ul><p>If you find my work interesting and valuable, you can support me by opting for a paid subscription (it’s $6 monthly/$60 annual). As a bonus you get access to monthly live sessions, and all the past recordings. </p><p><span>Many people report failed payments, or don’t want a recurring subscription. For that I also have a </span><a href="https://buymeacoffee.com/codeconfessions" rel="">buymeacoffee page</a><span>. Where you can buy me coffees or become a member. I will upgrade you to a paid subscription for the equivalent duration here.</span></p><p data-attrs="{&quot;url&quot;:&quot;https://buymeacoffee.com/codeconfessions&quot;,&quot;text&quot;:&quot;Buy me a coffee&quot;,&quot;action&quot;:null,&quot;class&quot;:&quot;button-wrapper&quot;}" data-component-name="ButtonCreateButton"><a href="https://buymeacoffee.com/codeconfessions" rel=""><span>Buy me a coffee</span></a></p><p>I also have a GitHub Sponsor page. You will get a sponsorship badge, and also a complementary paid subscription here.</p><p data-attrs="{&quot;url&quot;:&quot;https://github.com/sponsors/abhinav-upadhyay&quot;,&quot;text&quot;:&quot;Sponsor me on GitHub&quot;,&quot;action&quot;:null,&quot;class&quot;:&quot;button-wrapper&quot;}" data-component-name="ButtonCreateButton"><a href="https://github.com/sponsors/abhinav-upadhyay" rel=""><span>Sponsor me on GitHub</span></a></p><p data-attrs="{&quot;url&quot;:&quot;https://blog.codingconfessions.com/p/simultaneous-multithreading?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share&quot;,&quot;text&quot;:&quot;Share&quot;,&quot;action&quot;:null,&quot;class&quot;:&quot;button-wrapper&quot;}" data-component-name="ButtonCreateButton"><a href="https://blog.codingconfessions.com/p/simultaneous-multithreading?utm_source=substack&amp;utm_medium=email&amp;utm_content=share&amp;action=share" rel=""><span>Share</span></a></p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[My favorite tools and techniques for procedural gamedev (172 pts)]]></title>
            <link>https://cprimozic.net/blog/tools-and-techniques-for-procedural-gamedev/</link>
            <guid>41092861</guid>
            <pubDate>Sun, 28 Jul 2024 12:56:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://cprimozic.net/blog/tools-and-techniques-for-procedural-gamedev/">https://cprimozic.net/blog/tools-and-techniques-for-procedural-gamedev/</a>, See on <a href="https://news.ycombinator.com/item?id=41092861">Hacker News</a></p>
<div id="readability-page-1" class="page"><div><p>For a couple of years now, I've been working on and off on some <a href="https://github.com/ameobea/sketches-3d">3D scenes and levels</a> that run in the browser.  It started off as a scattering of self-contained demos for some custom shaders or similar that I wanted to try out, but over time the project has grown into a pretty substantial interconnected game-like thing.</p>
<p>One of the unifying themes of the work is the use procedural and generative techniques in some way.  Usually it's just some specific element of the level that makes use of this rather than a fully procedurally generated world.</p>
<p>This has resulted in me accumulating a good number of procedural and semi-procedural tools and effects that I re-use from level to level.  I thought I'd put together a list of some of my favorites in case they might be of interest to anyone else working on similar kinds of 3D applications.</p>
<h2 id="shaders--textures"><a href="#shaders--textures" aria-label="shaders  textures permalink"></a>Shaders + Textures</h2>
<p>Most of the textures I use for my scenes are seamless - meaning that they tile along both axes without any visible discontinuities.  They're popular in gamedev and used regularly.</p>
<p>Here's an example of one that I've used in the past:</p>
<p><span>
      <a href="https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/6cf05/seamless-texture.png" target="_blank" rel="noopener">
    <span></span>
  <picture>
          <source srcset="https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/8359c/seamless-texture.avif 210w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/4c727/seamless-texture.avif 420w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/4ab03/seamless-texture.avif 840w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/c3c94/seamless-texture.avif 1260w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/c095d/seamless-texture.avif 1680w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/cf946/seamless-texture.avif 3074w" sizes="(max-width: 840px) 100vw, 840px" type="image/avif">
          <source srcset="https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/aaa7a/seamless-texture.png 210w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/2dc40/seamless-texture.png 420w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/993bb/seamless-texture.png 840w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/db723/seamless-texture.png 1260w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/7bc17/seamless-texture.png 1680w, https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/6cf05/seamless-texture.png 3074w" sizes="(max-width: 840px) 100vw, 840px" type="image/png">
          <img src="https://cprimozic.b-cdn.net/static/4edbb1f1a5502ef5331f90e2480dd516/993bb/seamless-texture.png" alt="A screenshot of a seamless texture consisting of black rock with gold flecks tiling repeatedly.  There are no obvious discontinuities or cutoff points where the image repeats." title="" loading="lazy" decoding="async">
        </picture>
  </a>
    </span></p>
<p>Although it does tile smoothly, you can pretty clearly see the patterns created by it repeating - especially when it's spread across a large area.</p>
<p>There are a lot of fancy tricks that can be used with seamless textures to make them even more useful.  I created a custom shader in Three.JS which extends the base <code>MeshPhysicalMaterial</code> with a bunch of additions and extra features that I can turn on at will, and several of them are dedicated to improving seamless texturing support for my materials.</p>
<h3 id="triplanar-mapping"><a href="#triplanar-mapping" aria-label="triplanar mapping permalink"></a>Triplanar Mapping</h3>
<p>Triplanar mapping is the workhorse of my texturing toolkit.  I end up using it in some way in pretty much every level I create, and it works far better than it ought to given how simple it is to implement.</p>
<p>The reason for this is that it allows meshes to be textured using seamless textures without the need for pre-defined UV maps.  For that reason, this technique is usually used for things like procedurally generated terrain since there isn't an opportunity for a modeller to define a UV mapping for them.</p>
<p>
I've found triplanar mapping to work well for a vast array of both generated and hand-modeled meshes.
</p>
<p>Seriously - I throw this thing on everything and it almost always looks at least half decent.</p>
<p>It's also quite light-weight and easy to implement; here's <a href="https://github.com/Ameobea/sketches-3d/blob/main/src/viz/shaders/triplanarMapping.ts">my implementation</a> for reference.</p>
<h4 id="tweaks--improvements"><a href="#tweaks--improvements" aria-label="tweaks  improvements permalink"></a>Tweaks + Improvements</h4>
<p>I also made a slight tweak to the default triplanar mapping algorithm which makes it even better.</p>
<p>Normally, triplanar mapping uses a linear mix of three texture lookups for each axis based on the fragment's normal.  This can lead to visible layering of the texture in areas where the normal isn't very close a single axis.</p>
<p>To improve this, I run the weights through a <code>pow()</code> call with a pretty high exponent and then re-normalize the resulting vector.  This has the effect of putting more weight on the dominant axis and making the transition areas much smaller.  This drastically improves the quality of the results (left is without <code>pow()</code>, right is with):</p>

<p>As an added bonus, performing this transformation results in one axis having a weight very close to 1 and the other two axes having weights very close to zero for most places on the mesh.  This allows for an optimization that just completely skips texture lookups for weights smaller than some threshold and makes the performance overhead of triplanar mapping much lighter - barely more than normal UV-mapped texturing.</p>
<p>One last trick I use in my triplanar mapping implementation is for handling normal maps - which need some special considerations in the shader code in order to get correct results.</p>
<p>I use the method that was introduced <a href="https://github.com/bgolus/Normal-Mapping-for-a-Triplanar-Shader/blob/master/TriplanarGPUGems3.shader#L62">in GPU Gems</a> that specifically addresses this and it works nicely.  There's more details in <a href="https://bgolus.medium.com/normal-mapping-for-a-triplanar-shader-10bf39dca05a">this blog post</a> as well if you're looking to implement this yourself.</p>
<h3 id="hex-tiling"><a href="#hex-tiling" aria-label="hex tiling permalink"></a>Hex Tiling</h3>
<p>This is another technique that I make use of in most of my scenes in some way.  Hex Tiling is an algorithm that completely hides visible tiling and repetition in seamless textures.</p>
<p>Here's an example of the effect it can have on a stripped-down scene to highlight its impact:</p>

<p>It's hard to overstate how good this effect is at making a wide range of scenes look way, way better - and all it takes is adding one extra config option to the material to turn it on.  It can make a scene go from looking like a low-effort mockup to semi-realistic all by itself.</p>
<p>My original hex tiling implementation was based on a <a href="https://www.shadertoy.com/view/MdyfDV">Shadertoy</a> by <a href="http://evasion.imag.fr/~Fabrice.Neyret/">Fabrice Neyret</a>.  I converted it to work with Three.JS's material system and integrated it into the shader for the main material for my project.</p>
<p>I also ported my version of the hex tiling shader (with permission) it into a <a href="https://github.com/ameobea/three-hex-tiling">standalone library</a> that can be plugged into any Three.JS project to add hex tiling support to its built-in materials.</p>
<p>There are some caveats to note about this technique though.  Unlike triplanar mapping, hex tiling does require a pre-defined UV mapping.  I looked into using triplanar mapping and hex tiling together - which would be incredibly useful - but the performance overhead seems to just be too much.  The max texture fetches needed for each fragment would go up multiplicatively to a whopping 27 for each map used, and that is obviously ridiculous and impractical.</p>
<p>The being said, the hex tiling algorithm does linear interpolation between three lookups for each fragment just like triplanar mapping, so the same <code>pow()</code> trick for the interpolation weights that I developed to reduce texture fetches in triplanar mapping can also be used.  This not only improves performance but also makes the results look better as well.</p>
<h3 id="depth-pre-pass"><a href="#depth-pre-pass" aria-label="depth pre pass permalink"></a>Depth Pre-Pass</h3>
<p>All of these texturing methods can have a non-trivial performance impact - especially in large scenes with a lot going on.  This can result in a fragment shader that is quite expensive to run.</p>
<p>A depth pre-pass excellent option for winning back some performance.  It's a pretty common method in computer graphics and is used decently often in different game engines and rendering pipelines.  The idea is that you render the entire scene using an extremely simple material that is as cheap as possible to render and record the depth fo every pixel.</p>
<p>Although there is some overhead involved in rendering the whole scene twice, it's almost always worth it.  Especially for scenes with high amounts of overdraw, adding a depth pre-pass can often improve performance by 30% or more.</p>
<p>By changing the configuration of the pre-pass, you can set it to do the inverse and only render occluded fragments:</p>
<p><span>
      <a href="https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/31d0f/occluded-frag-viz.png" target="_blank" rel="noopener">
    <span></span>
  <picture>
          <source srcset="https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/8359c/occluded-frag-viz.avif 210w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/4c727/occluded-frag-viz.avif 420w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/4ab03/occluded-frag-viz.avif 840w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/c3c94/occluded-frag-viz.avif 1260w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/c095d/occluded-frag-viz.avif 1680w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/a5f5d/occluded-frag-viz.avif 1886w" sizes="(max-width: 840px) 100vw, 840px" type="image/avif">
          <source srcset="https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/aaa7a/occluded-frag-viz.png 210w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/2dc40/occluded-frag-viz.png 420w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/993bb/occluded-frag-viz.png 840w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/db723/occluded-frag-viz.png 1260w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/7bc17/occluded-frag-viz.png 1680w, https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/31d0f/occluded-frag-viz.png 1886w" sizes="(max-width: 840px) 100vw, 840px" type="image/png">
          <img src="https://cprimozic.b-cdn.net/static/416bf83f2b3c1231698f5449ffaa7a6a/993bb/occluded-frag-viz.png" alt="A screenshot from a scene rendered with a showing the result of inverting the depth test of the depth pre-pass and rendering only occluded fragments.  It looks similar to what happens when you change the GL rendering mode to backface." title="" loading="lazy" decoding="async">
        </picture>
  </a>
    </span></p>
<p>Every fragment rendered in this image is one that gets skipped when a depth pre-pass is used.</p>
<p>I also wrote a <a href="https://cprimozic.net/blog/threejs-depth-pre-pass-optimization/">dedicated article</a> with more details about the setup and how I implemented it for Three.JS.</p>
<h3 id="ai-powered-pbr-texture-synthesis"><a href="#ai-powered-pbr-texture-synthesis" aria-label="ai powered pbr texture synthesis permalink"></a>AI-Powered PBR Texture Synthesis</h3>
<p>I figure I should mention this here since it's something I make use of in pretty much all my scenes.  AI-generated textures are a bit of a contentious topic, but I find that they lend themselves very well to the kind of things I build.</p>
<p>If used tastefully, the results can actually look pretty good.  Every texture in this scene below is AI-generated:</p>
<p><span>
      <a href="https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/87caf/3d-sketches.png" target="_blank" rel="noopener">
    <span></span>
  <picture>
          <source srcset="https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/8359c/3d-sketches.avif 210w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/4c727/3d-sketches.avif 420w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/4ab03/3d-sketches.avif 840w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/c3c94/3d-sketches.avif 1260w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/30c6a/3d-sketches.avif 1512w" sizes="(max-width: 840px) 100vw, 840px" type="image/avif">
          <source srcset="https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/aaa7a/3d-sketches.png 210w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/2dc40/3d-sketches.png 420w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/993bb/3d-sketches.png 840w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/db723/3d-sketches.png 1260w, https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/87caf/3d-sketches.png 1512w" sizes="(max-width: 840px) 100vw, 840px" type="image/png">
          <img src="https://cprimozic.b-cdn.net/static/df9dea909a1a6da6ddc5737499aa35ef/993bb/3d-sketches.png" alt="A screenshot of one of the 3D sketches I created as a part of this project.  A golden arch made out of a metallic-rocky material stands on a concrete plinth.  It sits in what looks like a sort of shrine with curved stone arches.  There is a cobblestone floor and stone walls.  The graphics are reminiscent of PS2 games or similar style." title="" loading="lazy" decoding="async">
        </picture>
  </a>
    </span></p>
<p>I also wrote a <a href="https://cprimozic.net/notes/posts/generating-textures-for-3d-using-stable-diffusion/">dedicated article</a> about my process for generating these textures, generating PBR maps for them, and combining them to produce seamless 4K textures without upscaling.</p>
<p>One note is that the website I reference in the article which I used to generate PBR maps is no longer available.  Instead, I've been using <a href="https://github.com/HugoTini/DeepBump">DeepBump</a> to generate normal maps and non-AI tools like <a href="https://www.boundingboxsoftware.com/materialize/">Materialize</a> for the other maps if I really need them.</p>
<h3 id="volumetric-fogclouds"><a href="#volumetric-fogclouds" aria-label="volumetric fogclouds permalink"></a>Volumetric Fog/Clouds</h3>
<p>I've long been interested in volumetric rendering for the unique effect it lends to scenes.  I put together a relatively versatile shader that can add clouds or fog to any Three.JS scene which produces results like this:</p>
<p><span>
      <a href="https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/ba9b4/volumetric-pass.png" target="_blank" rel="noopener">
    <span></span>
  <picture>
          <source srcset="https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/8359c/volumetric-pass.avif 210w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/4c727/volumetric-pass.avif 420w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/4ab03/volumetric-pass.avif 840w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/c3c94/volumetric-pass.avif 1260w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/c095d/volumetric-pass.avif 1680w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/2d32d/volumetric-pass.avif 3188w" sizes="(max-width: 840px) 100vw, 840px" type="image/avif">
          <source srcset="https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/aaa7a/volumetric-pass.png 210w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/2dc40/volumetric-pass.png 420w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/993bb/volumetric-pass.png 840w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/db723/volumetric-pass.png 1260w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/7bc17/volumetric-pass.png 1680w, https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/ba9b4/volumetric-pass.png 3188w" sizes="(max-width: 840px) 100vw, 840px" type="image/png">
          <img src="https://cprimozic.b-cdn.net/static/4c44b419896e49e625b4fcc20569b942/993bb/volumetric-pass.png" alt="A screenshot of some clouds rendered using the volumetric pass I developed for Three.JS.  The image features a dense layer of somewhat fluffy-looking clouds with the image taken from a perspective above them.  The color of the clouds is mostly gray and white.  The sky above the horizon is pure black." title="" loading="lazy" decoding="async">
        </picture>
  </a>
    </span></p>
<p>I was inspired an awesome <a href="https://www.shadertoy.com/view/XslGRr">Shadertoy</a> by the legendary shader author <a href="https://iquilezles.org/">Inigo Quilez</a> (who helped create Shadertoy itself).  I created a basic volumetric volumetric clouds shader of my own using LoD noise lookups similar to the ones he used in his. I then kept adding features to it and expanding it to make it more generic and configurable.</p>
<p>I find that this shader is very useful for filling in the gaps of sparse levels and adding a bit of dynamism to static levels by introducing some moving clouds or fog.</p>
<p>This shader also used some code and approaches developed by <a href="https://github.com/n8python">n8programs</a> for the <a href="https://github.com/ameobea/three-good-godrays"><code>three-good-godrays</code></a> project that we built together.  I use <code>three-good-godrays</code> decently often as well; it adds an extremely unique vibe to levels.</p>
<h2 id="meshes--geometry"><a href="#meshes--geometry" aria-label="meshes  geometry permalink"></a>Meshes + Geometry</h2>
<p>Generating meshes at runtime is something I've been getting into more and more recently.  I like the idea of growing a world out of a software seed, but I want to avoid the "infinite but empty" phenomenon that some games which bill themselves as procedural can become.</p>
<p>
To that end, I've been mostly focusing on adding decorations, backdrops, or procedural flourishes to levels rather than making the core of the experience procedurally generated.
</p>
<h3 id="lod-terrain"><a href="#lod-terrain" aria-label="lod terrain permalink"></a>LoD Terrain</h3>
<p>Terrain generation is a staple of procedural gamedev, and it's well-trodden ground in the space.  My implementation is really nothing special, so I won't spend a lot of time going into details about it.</p>
<p>Like most other methods, I use noise functions to generate a heightmap for the terrain and then tessellate it into triangles for rendering.  I texture it using triplanar mapping or hex tiling.</p>
<p>The main cool thing about it is the LoD system.  The terrain is generated in tiles, and each tile gets generated at a range of resolutions.  The different resolutions are then dynamically swapped in and out based on the distance between that tile and the camera, as shown in this debug view:</p>
<p><span>
      <a href="https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/7d1b4/lod-terrain.png" target="_blank" rel="noopener">
    <span></span>
  <picture>
          <source srcset="https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/8359c/lod-terrain.avif 210w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/4c727/lod-terrain.avif 420w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/4ab03/lod-terrain.avif 840w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/c3c94/lod-terrain.avif 1260w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/c095d/lod-terrain.avif 1680w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/e2eb5/lod-terrain.avif 1983w" sizes="(max-width: 840px) 100vw, 840px" type="image/avif">
          <source srcset="https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/aaa7a/lod-terrain.png 210w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/2dc40/lod-terrain.png 420w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/993bb/lod-terrain.png 840w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/db723/lod-terrain.png 1260w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/7bc17/lod-terrain.png 1680w, https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/7d1b4/lod-terrain.png 1983w" sizes="(max-width: 840px) 100vw, 840px" type="image/png">
          <img src="https://cprimozic.b-cdn.net/static/07805fbe91f3aa7e4f25d83e8ba50878/993bb/lod-terrain.png" alt="A screenshot of a debug view of the LOD terrain system.  It shows some procedurally generated terrain rendered as a wireframe with different colors representing different levels of detail." title="" loading="lazy" decoding="async">
        </picture>
  </a>
    </span></p>
<p>Again, nothing groundbreaking here.  But I make use of this terrain generation system all the time and having a flexible and efficient system to implement it makes it possible to re-use it with minimal effort.</p>
<h3 id="procedural-mesh-processing--manipulation-pipeline"><a href="#procedural-mesh-processing--manipulation-pipeline" aria-label="procedural mesh processing  manipulation pipeline permalink"></a>Procedural Mesh Processing + Manipulation Pipeline</h3>
<p>This is the piece I've been working on most recently.  My original goal was to take low-poly meshes - including those generated dynamically - and procedurally subdivide + deform them.  The idea was to make simple meshes for things like platforms, boulders, or other large structures look more realistic or interesting when added to my levels.</p>
<p>Here's a bit of an extreme example of the kind of deformation that can be achieved using this process:</p>

<p>These efforts led to me building a pretty capable software pipeline for ingesting raw geometry data, making arbitrary changes to it, and re-exporting it in a ready-to-render format - all in the browser at runtime.</p>
<p>
It turns out that there's a good bit of nuance involved in this - particularly when it comes to handling normals.
</p>
<p>One last time, I'll link to a <a href="https://cprimozic.net/blog/subdividing-meshes-for-displacement/">separate writeup</a> that I published which goes into much detail about how this pipeline was implemented.</p>
<h2 id="future-work"><a href="#future-work" aria-label="future work permalink"></a>Future Work</h2>
<p>Most of the things I've listed here were originally developed as one-offs for some specific use case.  Then, I'd end up thinking of different contexts to try them in and re-using on other levels since I already had them built.</p>
<p>There are some other ideas I want to try out which I think have a lot of potential to be cool and useful.  First on my list is:</p>
<h3 id="constructive-solid-geometry"><a href="#constructive-solid-geometry" aria-label="constructive solid geometry permalink"></a>Constructive Solid Geometry</h3>
<p>Constructive Solid Geometry is something I've wanted to try out for a long time.  It's essentially a system for applying boolean operators to 3D space.  This lets you do things like merge two arbitrary meshes together, cut chunks out of meshes, and stuff like that.</p>
<p>Some time ago, I found the <a href="https://evanw.github.io/csg.js/">csg.js</a> library which inspired me greatly.  It implements a full CSG toolkit (including mesh primitives, all the boolean operators, and a clean API) within a single ~500 LoC file of well-commented JavaScript.</p>
<p>At some point, I am planning on porting this library to Rust and hopefully getting a better understanding of how it works in the process.  I think that there's a lot of potential for using this in tandem with the mesh processing pipeline to produce some really cool results.</p>
<p>One thing I especially want to try out is to procedurally "damage" meshes.  I want to be able to take chunks out of buildings or bridges to simulate decay or weathering or generate cracks in walls or roads.  I'm sure I'd find a ton of other uses for it as well once it's available.</p>
<p>I'll definitely write about how that goes once I get around to implementing it.  If you're interested, you can subscribe to my blog's <a href="https://cprimozic.net/rss.xml">RSS feed</a> or follow me on <a href="https://twitter.com/ameobea10">Twitter</a> or <a href="https://mastodon.ameo.dev/@ameo">Mastodon</a> where I post updates about the things I work on.</p></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[CalcGPT (152 pts)]]></title>
            <link>https://calcgpt.io/</link>
            <guid>41092460</guid>
            <pubDate>Sun, 28 Jul 2024 11:08:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://calcgpt.io/">https://calcgpt.io/</a>, See on <a href="https://news.ycombinator.com/item?id=41092460">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-astro-cid-tisrfsvx="" data-astro-cid-j7pv25f6="">  <p>2023</p> <p>GPT-3 (babbage-002), HTML, CSS and JS on website</p> <p data-astro-cid-tisrfsvx=""> <a href="https://calvin.sh/" target="_blank" rel="noopener noreferrer" data-astro-cid-tisrfsvx=""><b data-astro-cid-tisrfsvx="">Calvin Liang</b></a> </p> <p data-astro-cid-tisrfsvx="">
CalcGPT, conceived by an incisive and quirky artist-engineer Calvin Liang,
      serves as the praxis of satire in a hyper-advanced AI-dominated era.
      Imbued with an ingenious blend of technology and dry humor, the creation
      shrewdly prods at the modern world's pervasive and at times, excessive
      leaning towards AI solutions - even when not necessarily needed.
</p> <p data-astro-cid-tisrfsvx="">
More than merely functional, this artwork manifests in the rather
      unassuming form of a calculator, powered by the sophisticated GPT language
      model. But this isn't your standard piece of tech; instead, it is a clever
      parody, an emblem of resistance to the unrelenting AI craze.
</p> <p data-astro-cid-tisrfsvx="">
CalcGPT embodies the timeless adage - 'Old is Gold' - reminding us that
      it’s often rewarding to resort to established, traditional methods rather
      than chasing buzzword-infused cutting-edge tech. Serving not just as a
      computational tool, but as a poignant social commentary, this creation
      employs the grandeur of technology to a funny yet thought-provoking end.
</p> <p data-astro-cid-tisrfsvx="">
The piece invites us to reflect on the necessity and relevance of AI in
      every aspect of our lives as opposed to its prevailing use as a mere
      marketing gimmick. With its delightful slowness and propensity for
      computational errors, CalcGPT elicits mirth while urging us to question
      our zealous indulgence in all things AI.
</p> <p data-astro-cid-tisrfsvx="">
Liang's creation is laced with understated humor, driving home a
      lighthearted critique on our unchecked fascination with AI. CalcGPT urges
      us to weigh the equilibrium between preserving tradition and embracing
      innovation and reflects on the possibility of our headlong pursuit of
      fashionable tech buzzwords misguiding us.
</p> <p data-astro-cid-tisrfsvx="">^ written by ChatGPT</p> </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Irrational hungry judge effect: magnitude is overestimated (2023) (165 pts)]]></title>
            <link>https://www.cambridge.org/core/journals/judgment-and-decision-making/article/irrational-hungry-judge-effect-revisited-simulations-reveal-that-the-magnitude-of-the-effect-is-overestimated/61CE825D4DC137675BB9CAD04571AE58</link>
            <guid>41091803</guid>
            <pubDate>Sun, 28 Jul 2024 07:35:11 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.cambridge.org/core/journals/judgment-and-decision-making/article/irrational-hungry-judge-effect-revisited-simulations-reveal-that-the-magnitude-of-the-effect-is-overestimated/61CE825D4DC137675BB9CAD04571AE58">https://www.cambridge.org/core/journals/judgment-and-decision-making/article/irrational-hungry-judge-effect-revisited-simulations-reveal-that-the-magnitude-of-the-effect-is-overestimated/61CE825D4DC137675BB9CAD04571AE58</a>, See on <a href="https://news.ycombinator.com/item?id=41091803">Hacker News</a></p>
<div id="readability-page-1" class="page"><div lang="en" data-v-2fa8b348="" id="sec0" data-v-43a4d572=""><h2>Abstract</h2>  <div><p>Danziger, Levav and Avnaim-Pesso (2011) analyzed legal rulings of Israeli parole boards concerning the effect of serial order in which cases are presented within ruling sessions. They found that the probability of a favorable decision drops from about 65% to almost 0% from the first ruling to the last ruling within each session and that the rate of favorable rulings returns to 65% in a session following a food break. The authors argue that these findings provide support for extraneous factors influencing judicial decisions and cautiously speculate that the effect might be driven by mental depletion. A simulation shows that the observed influence of order can be alternatively explained by a statistical artifact resulting from favorable rulings taking longer than unfavorable ones. An effect of similar magnitude would be produced by a (hypothetical) rational judge who plans ahead minimally and ends a session instead of starting cases that he or she assumes will take longer directly before the break. One methodological detail further increased the magnitude of the artifact and generates it even without assuming any foresight concerning the upcoming case. Implications for this article are discussed and the increased application of simulations to identify nonobvious rational explanations is recommended.</p></div> </div><div id="content-container" data-v-43a4d572=""><div>
<div>
<div data-magellan-destination="s1" id="s1">
<h2><span>1</span> Introduction</h2>
<p> In decisions in various contexts, individuals do not strictly adhere to standards of rationality, in that judgments and choices are influenced by many irrelevant factors such as changes in presentation format (e.g., <a href="#rf17"><span>Reference Kahneman and Tversky</span>Kahneman &amp; Tversky, 1984</a>), the presence of random anchors (e.g., <a href="#rf27"><span>Reference Tversky and Kahneman</span>Tversky &amp; Kahneman, 1974</a>), and many more. It is, however, of course socially desirable for the outcomes of legal cases to depend solely on laws and relevant facts and for influences of extraneous factors to be minimal. Decisions should, for instance, not be influenced by the order in which cases are presented or by whether the judge is exhausted or hungry.</p>
<p> Still, it has been demonstrated that judges show the same fallacies and biases as other individuals do (e.g., <a href="#rf6"><span>Reference Englich, Mussweiler and Strack</span>Englich, Mussweiler &amp; Strack, 2006</a>; <a href="#rf10"><span>Reference Guthrie, Rachlinski and Wistrich</span>Guthrie, Rachlinski &amp; Wistrich, 2000</a>, 2007). In psychology, the prevailing descriptive models consequently take into account that legal decision making does not follow a purely rational calculation, but involves some constructive and intuitive element, making it potentially malleable to irrelevant factors (e.g., <a href="#rf21"><span>Reference Pennington and Hastie</span>Pennington &amp; Hastie, 1992</a>; <a href="#rf25"><span>Reference Simon</span>Simon, 2004</a>; <a href="#rf26"><span>Reference Thagard</span>Thagard, 2006</a>).</p>
<p> Similarly, in the legal literature the traditional view that legal judgments can be mechanically or logically derived from official legal materials — such as statutes and reported court cases — in the vast majority of instances has been challenged by legal realism (e.g., Frank, 1930) maintaining that “legal doctrine […] is more malleable, less determinate, and less causal of judicial outcomes than the traditional view of law’s constraints supposes” (<a href="#rf24"><span>Reference Schauer</span>Schauer, 2013</a>). Legal realism holds that — aside from official legal materials — extraneous factors influence legal rulings such as ideology or policy preferences of the judge, general judgment biases, and — similar to current approaches in psychology — it has been argued that rulings are partially guided by intuition (Hutcheson, 1929; see Schauer, 2013, for a review). Legal realism has a long history and many facets but it is often caricaturized by the phrase that “justice is what the judge ate for breakfast”, which also has become a trope for legal realism in general.</p>
<p> In summary, there is clear evidence that judicial decision making is influenced to some degree by extraneous factors, which is also reflected in prevailing theories in law and psychology. Danziger, Levav and Avnaim-Pesso (2011a) (hereafter DLA) aim to add to this body of evidence by demonstrating that deciding multiple cases in a row influences legal outcomes of later cases. DLA analyzed 1,112 legal rulings of Israeli parole boards that cover about 40% of the parole requests of the country. They assessed the effect of the serial order in which cases are presented within a ruling session and took advantage of the fact that the ruling boards work on the cases in three sessions per day, separated by a late morning snack and a lunch break.</p>
<p> DLA found that the probability of a favorable decision drops from about 65% in the first ruling to almost 0% in the last ruling within each session (<a href="#fig1">Figure 1</a>). The rate of favorable rulings returns to 65% in the session following the break. DLA argue that this effect of ordering shows that judges are influenced by extraneous factors and they speculate that the effect is caused by mental depletion (<a href="#rf19"><span>Reference Muraven and Baumeister</span>Muraven &amp; Baumeister, 2000</a>). The argument is that, after repeated decisions, judges become exhausted, hungry or mentally depleted and use the simple and less effortful strategy to stick with the status quo by rejecting the request resulting in what could be called an “irrational hungry judge effect”.</p>
<div data-magellan-destination="fig1" id="fig1">
<p><img data-src="https://static.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig1.png?pub-status=live" width="328" height="380" data-original-image="/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig1.png" data-zoomable="false" src="https://www.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig1.png"></p>
<div><p><span>Figure 1:</span> Results redrawn from the graph provided in Danziger et al. (2011a).</p></div></div>
<p> Considering the tremendous consequences for human beings, the large magnitude of the effect, and the fact that the investigated boards decide almost half of the parole requests in Israel, these results are unexpected and potentially alarming. Consequently the article has attracted attention and the supposed order effect is considerably cited in psychology (e.g., <a href="#rf7"><span>Reference Evans, Dillon, Goldin and Krueger</span>Evans, Dillon, Goldin &amp; Krueger, 2011</a>), law (e.g., Schauer, 2013), economics (e.g., Kamenica, 2012), and beyond (e.g., Gibb, 2012; <a href="#rf29"><span>Reference Yamada, Camerer, Fujie, Kato, Matsuda, Takano and Takahashi</span>Yamada et al., 2012</a>).<a href="#fn1"><span>Footnote </span><sup>1</sup></a> The fact that — in line with the trope for legal realism mentioned above — eating (or not) is considered important for legal rulings according to DLA might have additionally contributed to the tendency to cite it heavily.</p>
</div>
<div data-magellan-destination="s2" id="s2">
<h2><span>2</span> Critical Evaluation</h2>
<p> One further factor that most likely contributed to the popularity of the article is the large magnitude of the effect. A drop of favorable decisions from 65% in the first trial to 5% in the last trial as observed in DLA is equivalent to an odds ratio of 35 or a standardized mean difference of <em>d</em> = 1.96 (<a href="#rf3"><span>Reference Chinn</span>Chinn, 2000</a>). This is more than twice the size of the conventional limit for large effects. The meta-analytic estimate for effect of mental depletion, which is considered as potential explanation for the drop, is <em>d</em> = –0.10 to 0.25 (publication-bias corrected), meaning that on average only small effects of mental depletion can be expected (<a href="#rf1"><span>Reference Carter and McCullough</span>Carter &amp; McCullough, 2013</a>).<a href="#fn2"><span>Footnote </span><sup>2</sup></a> Similarly, a recent multi-lab registered replication study involving 23 labs (N= 2,142) found an effect of d = 0.04 and not significantly different from zero (<a href="#rf12"><span>Reference Hagger and Chatzisarantis</span>Hagger &amp; Chatzisarantis, 2016</a>). Hence, under the assumption that mental depletion is causing the findings, the magnitude of the effect observed by DLA is surprisingly large. It might, however, be argued that manipulations of depletion and exhaustion might be stronger in reality than in the lab causing stronger effects.</p>
<p> Considering the latter issue and taking into account that the potential costs for giving wrong advice are high, it seems justified to take a closer look at the results and the analyses on which they are based.</p>
<div data-magellan-destination="s3" id="s3">
<h3><span>2.1</span> Non-random Order of Cases</h3>
<p> One crucial assumption permitting conclusions concerning the effect of case ordering is that case ordering is random or at least not driven by hidden factors that are not taken into account in the analysis. If more severe cases went first, for example, and severe cases at the same time reduced the likelihood of favorable decisions, spurious correlations could result. In their regression analyses, DLA take this concern into account by including reasonable control variables for substantive factors that might influence both ordering and rulings. They show that the results remain robust when controlling statistically for severity of offence, previous imprisonment, months served, participation in a rehabilitation program, and proportion of previous favorable decisions.</p>
<p> Still in a direct reply to DLA, it has been argued that case order is influenced by systematic factors that DLA did not account for (<a href="#rf28"><span>Reference Weinshall-Margel and Shapard</span>Weinshall-Margel &amp; Shapard, 2011</a>). Specifically, Weinshall-Margel and Shapard (2011) conducted informal interviews with persons involved in the parole decision process (including a panel judge) and came to the conclusion that case ordering is not random. They argue, among other things, that the downward trend might be due to the fact that, within each session, unrepresented prisoners usually go last and are less likely to be granted parole than prisoners who are represented by attorneys. In a response, Danziger, Levav and Avnaim-Pesso (2011b) show that the downward trend also holds when controlling for representation by an attorney although they do not report whether the magnitude of the effect remains the same, which seems unlikely given the correlation pattern reported above. Note also the more general methodological problem that statistical control need not remove the full effect of a variable measured in rough categories (e.g., severity of offence) or with error.</p>
</div>
<div data-magellan-destination="s4" id="s4">
<h3><span>2.2</span> Decision to Take a Break</h3>
<p> A second, potentially more subtle, concern is that results might be driven by factors that systematically influence judges’ decisions to take a break. DLA analyze whether properties of a case influence the likelihood of taking a break afterwards. They report that the substantive case properties mentioned above do not predict when a break is taken. Furthermore, they argue that judges do not know details of the upcoming case such as whether the prisoner has a previous incarceration record or not. Interestingly, Weinshall-Margel and Shapard still report their interviewees to state that judges might aim to finish a set of cases (e.g., to complete all cases from one prison) within a session. This indicates that some organizational planning occurs. At first glance, however, it seems hard to understand how this mere organizational planning of when to end a session without taking into account any details of the case could contribute to the downward trend. I will discuss this issue in detail in the next section.</p>
<p> In summary, in their reply DLA (2011b) argue that they could rule out all alternative explanations and therefore uphold their conclusion that parole decisions are influenced by legally irrelevant factors in that repeated choice is causing a decreasing likelihood for making favorable decision as the session progresses.</p>
</div>
</div>
<div data-magellan-destination="s5" id="s5">
<h2><span>3</span> Rational Time Management and Selective Dropouts</h2>
<p> If we accept that the effect of ordinal position also holds after all reasonable substantive factors that might have influenced ordering and decisions to take a break are ruled out, we must still ask whether more subtle factors could explain the observed effects, without assuming that judgments are influenced to a large degree by irrelevant factors. One major concern is the effects of selective dropouts and rational time management when to end a session in order to complete cases or sets of cases within it. Selective dropout in this context refers to the possibility that — for whatever reason — cases with favorable rulings have a lower likelihood to be in the sample of cases with higher ordinal number in a session than cases with unfavorable rulings.</p>
<p> DLA report that favorable rulings take longer (<em>M</em> = 7.37 min, <em>SD</em> = 5.11) than unfavorable rulings (<em>M</em> = 5.21 min, <em>SD</em> = 4.97). The number of cases completed in each session varies between 2 and 28<a href="#fn3"><span>Footnote </span><sup>3</sup></a> and DLA present rulings for 10 to 13 cases within each session, with the last ruling having a probability of zero (or in one case close to zero) to be favorable, respectively. Consequently, the number of observations within each session decreases with ordinal position and the last observations in a session are likely to consist of a few observations only. Considering that favorable rulings take longer than unfavorable rulings, the dropout is not random. On average, sessions that consist of mainly unfavorable decisions will allow judges to make many rulings. Therefore, in the reduced sample of observations constituting the data for higher ordinal positions, the relative frequency of rulings from sessions with mainly unfavorable decisions increases.<a href="#fn4"><span>Footnote </span><sup>4</sup></a></p>
<p> Judges have to finish cases before they take a break. To avoid starving, they are likely to avoid starting potentially complex cases (or sets of cases) directly before the break. It seems reasonable to assume that simple surface features that are available before investigating the case in detail (e.g., amount of material, kind of the request, representation by an attorney, some specifics of the attorney, the prison, or the prisoner) allow judges roughly to estimate the time the next case will take above chance level. Importantly, such surface features could also be unrelated to the content features that could produce non-random ordering of cases and that DLA already control for in their analysis.</p>
<p> Still, as mentioned above, it is hard to see whether and to what degree not starting overly long cases before a break would lead to the observation of downward sloping effects without assuming that judgments are influenced by extraneous factors at all. I conducted simulations to make the effect visible.</p>
</div>
<div data-magellan-destination="s6" id="s6">
<h2><span>4</span> Simulating Choice Patterns by a (hypothetical) Rational Judge</h2>
<p> I simulated the rulings of an ideal judge who makes choices without errors and biases. I assume that she has a rough time limit for each session and works on cases until recognizing that a case would go over this limit. The case that would be too long would not be solved any more in the current session, but it would be the first case in the next session.<a href="#fn5"><span>Footnote </span><sup>5</sup></a></p>
<p> The results indicate that, following the approach by DLA, a rational judge working on cases that are presented in random order would show a strongly decreasing probability of a favorable decision towards the end of the session. Even the shape of the curve and the magnitude of the effect are comparable to that observed by DLA. Simulations assuming normally distributed decision times (<a href="#fig2">Figure 2</a>, right) or more realistic positively-skewed decision times that follow a Weibull distribution (<a href="#fig2">Figure 2</a>, left) lead to similar conclusions, and repeated simulations show that the qualitative pattern of results is robust to changes in distributional assumptions. As one could expect, however, estimations become unstable for higher decision numbers due to the low number of remaining observations (see <a href="#fig2">Figure 2</a>, size of circles), resulting in occasional peaks to high or zero percentages. Not surprisingly, statistical analysis reveals that the downward trend is significant and that first decisions are more favorable than later ones, as it was found by DLA.</p>
<div data-magellan-destination="fig2" id="fig2">
<p><img data-src="https://static.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig2.png?pub-status=live" width="700" height="501" data-original-image="/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig2.png" data-zoomable="true" src="https://www.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig2.png"></p>
<div><p><span>Figure 2:</span> Simulated favorability ratings of a perfectly rational judge who works on cases with the speed observed by DLA and starts a new session for each case that would go over the time limit. The left chart depicts a distribution assuming that decision times follow a Weibull distribution, while the right chart shows results assuming a normal distribution. Circle diameter indicates the sample size for each observation and shows the large degree of dropouts within sessions.</p></div></div>
<p> <a href="#fig3">Figure 3</a> shows why this effect appears for the normally distributed case. Distributions of decision time have different means with favorable cases taking longer than unfavorable ones (left panel). Consequently, the relative frequency of favorable cases (in all cases) that would still fit in the session decreases with remaining time. In our example, if 15 minutes remain in the session, essentially all cases would still be started since such long times are rare both for favorable and unfavorable cases (<a href="#fig3">Figure 3</a>, left). The ratio of favorable and unfavorable cases therefore roughly reflects the overall ratio in the population. For 5 minutes remaining, however, only 12% of the favorable cases could still be included in the session, whereas the respective proportion for unfavorable cases is much higher at 46%. Hence, the relative frequency of favorable cases, as compared to all cases, decreases with the time that remains causing selective dropout.</p>
<div data-magellan-destination="fig3" id="fig3">
<p><img data-src="https://static.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig3.png?pub-status=live" width="700" height="383" data-original-image="/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig3.png" data-zoomable="true" src="https://www.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig3.png"></p>
<div><p><span>Figure 3:</span> Distribution of decision times (left) and effect of the remaining time on the proportion of favorable cases in the remaining selective sample (right).</p></div></div>
<p> The cumulative probability distribution for favorable decisions (taking into account differences in base rates for both events) is plotted in the right panel of <a href="#fig3">Figure 3</a>. For long remaining times, the proportion of favorable cases is close to the base rate of 36%. For short remaining times, the proportion approaches values close to zero. With an increasing decision number within a session, the remaining time decreases, causing the downward sloping effect. Since sessions can stop after 1 to 14 decisions, the stopping effect is not only found after case 14, but already to a smaller degree for earlier cases. Hence, the probability can be expected to drop from 36% to zero percent for later rulings.</p>
<p> It remains to be explained why the proportion of favorable rulings (in both the simulation and the DLA data) peaks beyond 36% in the first round. This “beginning effect” is indirectly caused by the above mechanism as well, since the session is more likely to end before a favorable ruling than before an unfavorable ruling. The probability mass that is missing in the last decision of the previous session adds to the probability mass of favorable cases in the first decision of the next session (either on the same day or the first session of the next day). If one assumes that planning is not only done for single cases, but also occasionally concerns sets of cases (<a href="#rf28"><span>Reference Weinshall-Margel and Shapard</span>Weinshall-Margel &amp; Shapard, 2011</a>), this would explain why the probability of a favorable decision in the second and third ruling in a session is also above the base rate of 36%.<a href="#fn6"><span>Footnote </span><sup>6</sup></a> Furthermore, the observation by DLA that the overall length of sessions varies considerably does not speak against the planning explanation since the effect also holds under the assumption that judges have implicit time limits that vary from session to session. Also, it should be noted that the planning described here is merely organizational and does not require any foresight concerning how the case will be decided. All it requires is that the judges have a rough estimate, whether the next case will be quick or take longer.</p>
</div>
<div data-magellan-destination="s7" id="s7">
<h2><span>5</span> Further Factors: Autocorrelation and Censoring</h2>
<p> After demonstrating that rational time management and selective dropout can cause dramatic drops in favorability ratings, the robustness of this finding and the influence of further factors should be investigated. Two factors are considered. First, DLA report that they censor their data, in that the last 5% of the cases in each session are dropped, with the intention of eliminating small samples at higher ordinal positions. Second, as mentioned above (Footnote 4) results from DLA indicate that there is an autocorrelation in the time-series, in that rulings correlate with previous ones. Since the consequences of these factors are again hard to anticipate, I conducted further analyses to explore their effects.</p>
<p> To investigate the effect of censoring, I dropped the last 5% of the rulings within each session in the normal distribution data-set from above (<a href="#fig2">Figure 2</a>, right) and analyzed the data again. Results remained largely the same, but censoring increased the magnitude of the drop (<a href="#fig4">Figure 4</a>, left), which was also observed for the Weibull data set and was consistently replicated in further simulations. Hence, censoring artificially increases selective dropout, and therefore it should not be used when analyzing the effect of ordinal position on favorability rulings.</p>
<div data-magellan-destination="fig4" id="fig4">
<p><img data-src="https://static.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig4.png?pub-status=live" width="681" height="484" data-original-image="/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig4.png" data-zoomable="true" src="https://www.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig4.png"></p>
<div><p><span>Figure 4:</span> Simulated favorability ratings including the effects of censoring the last 5% of cases within each session (left) and additional autocorrelation (right). Circle diameter represents <em>n</em>.</p></div></div>
<p> To investigate the effect of autocorrelation, I generated new data sets (<em>N</em> = 50,000) based on normally distributed response times with the same parameters as above in which, however, rulings correlated with rulings directly before at a low degrees. <a href="#fig4">Figure 4</a> (right) shows results from a data set with a (first-order) autocorrelation of <em>r</em> = .10 and including censoring as above. Results are generally comparable to the results from the independent data-set, and autocorrelation did not noticeably change the magnitude of the artifact.</p>
</div>
<div data-magellan-destination="s8" id="s8">
<h2><span>6</span> Rational Time Management without Foresight</h2>
<p> One assumption underlying the simulations reported so far is that judges plan ahead and do not start a case that would be too long to finish within the time limit for a session. This planning would require some degree of foresight in that judges (or other people administratively involved) generate estimates of the time required for finishing the upcoming case. Thereby estimates do not need to be exact to generate the artifact and can be based on rough surface cues as mentioned above as well. Also cues for time management might be (consciously or unconsciously) conveyed by administrative persons involved in the process of handling cases (<a href="#rf22"><span>Reference Pfungst</span>Pfungst, 1911</a>). As mentioned above, DLA state that details about the upcoming case are not known to the members of the board in advance. Since, however, DLA did not have full control over the situations, the existence of such cues cannot be entirely ruled out.</p>
<p> Still, presuming foresight in many cases is admittedly a relatively strong assumption. I therefore tested whether the analysis conducted by DLA would also generate similar artifacts without foresight in that judges stop <em>after</em> a case went over the available time limit.<a href="#fn7"><span>Footnote </span><sup>7</sup></a> When conducting this analysis without censoring and autocorrelation, all artifacts disappear, as one would expect. Interestingly, however, when including censoring and autocorrelation a downward sloping effect appears again (<a href="#fig5">Figure 5</a>). The reason for this is that cases with favorable rulings are more likely to hit the time limit than cases with unfavorable ruling due to the mere fact that they are longer. Dropping 5% of the cases at the end means often postponing this last case, which is more likely favorable than unfavorable. Hence, censoring causes selective dropout of favorable cases even without foresight and artificially induces a downward sloping effect of favorable ruling. The effect was, however, smaller than in the simulations with foresight and caused a drop of roughly 15% only.</p>
<div data-magellan-destination="fig5" id="fig5">
<p><img data-src="https://static.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig5.png?pub-status=live" width="326" height="438" data-original-image="/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig5.png" data-zoomable="false" src="https://www.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_fig5.png"></p>
<div><p><span>Figure 5:</span> Simulated favorability ratings without foresight concerning the upcoming case but including the effects of censoring the last 5% of cases within each session and autocorrelation <em>r</em> = .10 (<em>N</em> = 50,000). Circle diameter represents <em>n</em>.</p></div></div>
</div>
<div data-magellan-destination="s9" id="s9">
<h2><span>7</span> Discussion</h2>
<p> In a comprehensive analysis of legal rulings of Israeli parole boards DLA identified that the proportion of favorable rulings decreases with serial order within a session but goes back to the initial level after a session break that includes eating a meal. This finding is important as well as potentially alarming, since both serial order and food supply are clearly extraneous factors that should not affect whether a parole request is decided favorable or not. DLA argue that their findings indicate that extraneous variables influence judicial decisions and cautiously interpret their finding with reference to a mental depletion account.</p>
<p> I critically revisited this interpretation and tested whether the core of the conclusion — namely that order and mental depletion causally influence the outcome of legal judgments — can be made on the basis of the presented data. Specifically, I tested whether the observed downward trend could also results from selective dropout of favorable cases due to rational time management, censoring of data and autocorrelation. The analysis shows that large parts — but admittedly not all aspects, see below — of the findings could be accounted for by this explanation.</p>
<p> The simulations show that the seemingly dramatic drop of favorable rulings from 65% to almost 0% towards the end of each session does not conclusively indicate bias or error in judicial decision making. A drop of comparable — although somewhat smaller — magnitude would be produced by a (hypothetical) rational judge who aims to avoid starting work on cases that could not be completed in the time that remains in the current session. Furthermore, the simulations revealed that the practice of censoring data within a session is problematic and artificially induces a downward sloping effect even without foresight and under the less restrictive assumption that judges stop each session after a time limit has been passed. Hence, the analyses by DLA do not provide conclusive evidence for the hypothesis that extraneous factors influence legal rulings.</p>
<div data-magellan-destination="s10" id="s10">
<h3><span>7.1</span> Caveats</h3>
<p> It has to be acknowledged that the analyses reported in this paper do not preclude that serial order and mental depletion might have affected the legal judgments analyzed by DLA. The analysis, however, demonstrates that there is a possible alternative explanation for large parts of the results within a rational framework that does not require the assumption of any influence of extraneous factors. The strong downward-sloping effect could — at least in parts — simply reflect a statistical artifacts.</p>
<p> Still, rational time management and selective dropout cannot account for all aspects of the data by DLA. First, the magnitude of the effects reported in the simulations was somewhat smaller than the magnitude of the original effects.<a href="#fn8"><span>Footnote </span><sup>8</sup></a> This was mainly due to the fact that, second, in the original data the percentage of favorable rulings started at a higher level than in the current simulations (i.e. 65% instead of 45%). Particularly, the high starting rates at the beginning of the day (and not only after the breaks) are hard to explain by my account since postponing cases to a different day and panel seems not overly likely.<a href="#fn9"><span>Footnote </span><sup>9</sup></a> Third, since the statistical effects described here are driven by ordinal position, they cannot easily explain the effects of time on favorable rulings reported in DLA as well. Fourth, the shape of the curves differ in some details in that the empirical curve tended to be smoother whereas the simulated data showed stronger drops at the beginning and the end a flatter area in between. Finally, given that according to DLA the setting might have precluded direct foresight concerning the upcoming case to some degree, the remaining effects of rational time management could be estimated to account for a drop of 15% to 45% only.</p>
<p> In sum, rational time management and selective dropout — although potentially being important — can explain the findings by DLA only in parts. Hence, further factors may exist that contributed to the observed downward-sloping effect. The remaining differences could potentially be explained by other methodological factors such as the issue of non-random ordering in that prisoners represented by attorneys went first (<a href="#rf28"><span>Reference Weinshall-Margel and Shapard</span>Weinshall-Margel &amp; Shapard, 2011</a>). Alternatively, extraneous factors such as causal effects of serial case ordering and mental depletion might have played a role. Since the data are not available<a href="#fn10"><span>Footnote </span><sup>10</sup></a> for further detailed analyses and the exact circumstances under which the rulings were made cannot be fully reconstructed, these issues have to be addressed in further studies.</p>
<p> The analyses reported here indicates that the effect of serial order and mental depletion is overestimated in the original work by DLA. Rational time management concerning when to take a break and effects of non-random ordering of cases with represented prisoners going first identified by Weinshall-Margel and Shapard (2011) are lumped together with potential effects of serial order and mental depletion so that the latter are overestimated. Disentangling these influences should lead to more reasonable (smaller) estimates concerning the magnitude of the effect. According to previous findings on mental depletion, the “irrational hungry judge effect” should at best be small in magnitude (if existing at all; see <a href="#rf1"><span>Reference Carter and McCullough</span>Carter &amp; McCullough, 2013</a>), which might render the observed extraneous influence less relevant from a practical point of view and the need for state interventions less urgent.</p>
<p> More generally, the analysis shows that sometimes there is a nonobvious rational basis for irrational-looking behavior. Computer simulations as well as formal mathematical analyses are measures to identify them. Such analyses have revealed, for example, that whole strands of literature supposedly demonstrating irrational behavior such as spreading apart effects after choice (<a href="#rf2"><span>Reference Chen and Risen</span>Chen &amp; Risen, 2010</a>), unrealistic optimism (<a href="#rf14"><span>Reference Harris and Hahn</span>Harris &amp; Hahn, 2011</a>) or the adaptive usage of simple heuristics (Jekel &amp; Glöckner, in press) are methodological or statistical artifacts that would be shown by completely rational agents as well. I argue that simulations of rational agents and formal mathematical analyses should be used earlier and more intensely in the research process to investigate findings of supposedly hugely irrational behavior before jumping to the conclusion that legal actors — or any other individuals — are irrational.</p>
</div>
</div>
</div>
<div data-magellan-destination="app1" id="app1">
<h2><span>Appendix:</span> STATA code for the simulation program for normal distributed response times</h2>
<div data-magellan-destination="figa1" id="figa1">
<p><img data-src="https://static.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_figa1.png?pub-status=live" width="783" height="870" data-original-image="/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_figa1.png" data-zoomable="true" src="https://www.cambridge.org/binary/version/id/urn:cambridge.org:id:binary:20240509060830882-0276:S1930297500004812:S1930297500004812_figa1.png"></p>
</div>
</div>
</div>    <div id="references-list"><h2>References</h2> <div id="rf2" aria-flowto="reference-2-content reference-2-button"><p><span><span>Chen</span>, <span>M. K.</span></span>, &amp; <span><span>Risen</span>, <span>J. L.</span></span> (<span>2010</span>). <span>How choice affects and reflects preferences: revisiting the free-choice paradigm.</span> <span>Journal of Personality and Social Psychology</span>, <span>99</span>(4), <span>573</span>–<span>594</span>.<a target="_blank" aria-label="CrossRef link for How choice affects and reflects preferences: revisiting the free-choice paradigm." href="https://dx.doi.org/10.1037/a0020217">CrossRef</a><a target="_blank" aria-label="Google Scholar link for How choice affects and reflects preferences: revisiting the free-choice paradigm." href="https://scholar.google.com/scholar_lookup?title=How+choice+affects+and+reflects+preferences%3A+revisiting+the+free-choice+paradigm.&amp;author=Chen+M.+K.&amp;author=Risen+J.+L.&amp;publication+year=2010&amp;journal=Journal+of+Personality+and+Social+Psychology&amp;volume=99&amp;doi=10.1037%2Fa0020217&amp;pages=573-594">Google Scholar</a><a target="_blank" aria-label="PubMed link for How choice affects and reflects preferences: revisiting the free-choice paradigm." href="https://www.ncbi.nlm.nih.gov/pubmed/20658837">PubMed</a></p></div><div id="rf5" aria-flowto="reference-5-content reference-5-button"><p><span><span>Danziger</span>, <span>S.</span></span>, <span><span>Levav</span>, <span>J.</span></span>, &amp; <span><span>Avnaim-Pesso</span>, <span>L.</span></span> (<span>2011b</span>). <span>Reply to Weinshall-Margel and Shapard: Extraneous factors in judicial decisions persist.</span> <span>Proceedings of the National Academy of Sciences of the United States of America</span>, <span>108</span>(42), <span>E834</span>-<span>E834</span>. <a href="https://dx.doi.org/10.1073/pnas.1112190108">http://dx.doi.org/10.1073/pnas.1112190108</a>.<a target="_blank" aria-label="Google Scholar link for Reply to Weinshall-Margel and Shapard: Extraneous factors in judicial decisions persist." href="https://scholar.google.com/scholar_lookup?title=Reply+to+Weinshall-Margel+and+Shapard%3A+Extraneous+factors+in+judicial+decisions+persist.&amp;author=Danziger+S.&amp;author=Levav+J.&amp;author=Avnaim-Pesso+L.&amp;publication+year=2011b&amp;journal=Proceedings+of+the+National+Academy+of+Sciences+of+the+United+States+of+America&amp;volume=108&amp;pages=E834-E834">Google Scholar</a></p></div><div id="rf6" aria-flowto="reference-6-content reference-6-button"><p><span><span>Englich</span>, <span>B.</span></span>, <span><span>Mussweiler</span>, <span>T.</span></span>, &amp; <span><span>Strack</span>, <span>F.</span></span> (<span>2006</span>). <span>Playing dice with criminal sentences: The influence of irrelevant anchors on experts judicial decision making.</span> <span>Personality and Social Psychology Bulletin</span>, <span>32</span>(2), <span>188</span>–<span>200</span>.<a target="_blank" aria-label="CrossRef link for Playing dice with criminal sentences: The influence of irrelevant anchors on experts judicial decision making." href="https://dx.doi.org/10.1177/0146167205282152">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Playing dice with criminal sentences: The influence of irrelevant anchors on experts judicial decision making." href="https://scholar.google.com/scholar_lookup?title=Playing+dice+with+criminal+sentences%3A+The+influence+of+irrelevant+anchors+on+experts+judicial+decision+making.&amp;author=Englich+B.&amp;author=Mussweiler+T.&amp;author=Strack+F.&amp;publication+year=2006&amp;journal=Personality+and+Social+Psychology+Bulletin&amp;volume=32&amp;doi=10.1177%2F0146167205282152&amp;pages=188-200">Google Scholar</a><a target="_blank" aria-label="PubMed link for Playing dice with criminal sentences: The influence of irrelevant anchors on experts judicial decision making." href="https://www.ncbi.nlm.nih.gov/pubmed/16382081">PubMed</a></p></div><div id="rf7" aria-flowto="reference-7-content reference-7-button"><p><span><span>Evans</span>, <span>A. M.</span></span>, <span><span>Dillon</span>, <span>K. D.</span></span>, <span><span>Goldin</span>, <span>G.</span></span>, &amp; <span><span>Krueger</span>, <span>J. I.</span></span> (<span>2011</span>). <span>Trust and self-control: The moderating role of the default.</span> <span>Judgment and Decision Making</span>, <span>6</span>(7), <span>697</span>–<span>705</span>.<a target="_blank" aria-label="CrossRef link for Trust and self-control: The moderating role of the default." href="https://dx.doi.org/10.1017/S1930297500002709">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Trust and self-control: The moderating role of the default." href="https://scholar.google.com/scholar_lookup?title=Trust+and+self-control%3A+The+moderating+role+of+the+default.&amp;author=Evans+A.+M.&amp;author=Dillon+K.+D.&amp;author=Goldin+G.&amp;author=Krueger+J.+I.&amp;publication+year=2011&amp;journal=Judgment+and+Decision+Making&amp;volume=6&amp;doi=10.1017%2FS1930297500002709&amp;pages=697-705">Google Scholar</a></p></div><div id="rf8" aria-flowto="reference-8-content reference-8-button"><p><span><span>Frank</span>, <span>J.</span></span> (<span>1930</span>). <span>Law and the modern mind.</span> <span>New York</span>: <span>Brentano’s</span>.<a target="_blank" aria-label="Google Scholar link for Law and the modern mind." href="https://scholar.google.com/scholar_lookup?title=Law+and+the+modern+mind.&amp;author=Frank+J.&amp;publication+year=1930">Google Scholar</a></p></div><div id="rf10" aria-flowto="reference-10-content reference-10-button"><p><span><span>Guthrie</span>, <span>C.</span></span>, <span><span>Rachlinski</span>, <span>J. J.</span></span>, &amp; <span><span>Wistrich</span>, <span>A. J.</span></span> (<span>2000</span>). <span>Inside the judicial mind.</span> <span>Cornell Law Review,</span> <span>86</span>, <span>777</span>–<span>830</span>.<a target="_blank" aria-label="Google Scholar link for Inside the judicial mind." href="https://scholar.google.com/scholar_lookup?title=Inside+the+judicial+mind.&amp;author=Guthrie+C.&amp;author=Rachlinski+J.+J.&amp;author=Wistrich+A.+J.&amp;publication+year=2000&amp;journal=Cornell+Law+Review%2C&amp;volume=86&amp;pages=777-830">Google Scholar</a></p></div><div id="rf11" aria-flowto="reference-11-content reference-11-button"><p><span><span>Guthrie</span>, <span>C.</span></span>, <span><span>Rachlinski</span>, <span>J. J.</span></span>, &amp; <span><span>Wistrich</span>, <span>A. J.</span></span> (<span>2007</span>). <span>Blinking on the bench: How judges decide cases.</span> <span>Cornell Law Review</span>, <span>93</span>(1), <span>1</span>–<span>44</span>.<a target="_blank" aria-label="Google Scholar link for Blinking on the bench: How judges decide cases." href="https://scholar.google.com/scholar_lookup?title=Blinking+on+the+bench%3A+How+judges+decide+cases.&amp;author=Guthrie+C.&amp;author=Rachlinski+J.+J.&amp;author=Wistrich+A.+J.&amp;publication+year=2007&amp;journal=Cornell+Law+Review&amp;volume=93&amp;pages=1-44">Google Scholar</a></p></div><div id="rf13" aria-flowto="reference-13-content reference-13-button"><p><span><span>Hagger</span>, <span>M. S.</span></span>, <span><span>Wood</span>, <span>C.</span></span>, <span><span>Stiff</span>, <span>C.</span></span>, &amp; <span><span>Chatzisarantis</span>, <span>N. L.</span></span> (<span>2010</span>). <span>Ego depletion and the strength model of self-control: a meta-analysis.</span> <span>Psychological Bulletin</span>, <span>136</span>(4), <span>495</span>–<span>525</span>.<a target="_blank" aria-label="CrossRef link for Ego depletion and the strength model of self-control: a meta-analysis." href="https://dx.doi.org/10.1037/a0019486">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Ego depletion and the strength model of self-control: a meta-analysis." href="https://scholar.google.com/scholar_lookup?title=Ego+depletion+and+the+strength+model+of+self-control%3A+a+meta-analysis.&amp;author=Hagger+M.+S.&amp;author=Wood+C.&amp;author=Stiff+C.&amp;author=Chatzisarantis+N.+L.&amp;publication+year=2010&amp;journal=Psychological+Bulletin&amp;volume=136&amp;doi=10.1037%2Fa0019486&amp;pages=495-525">Google Scholar</a><a target="_blank" aria-label="PubMed link for Ego depletion and the strength model of self-control: a meta-analysis." href="https://www.ncbi.nlm.nih.gov/pubmed/20565167">PubMed</a></p></div><div id="rf14" aria-flowto="reference-14-content reference-14-button"><p><span><span>Harris</span>, <span>A. J.</span></span>, &amp; <span><span>Hahn</span>, <span>U.</span></span> (<span>2011</span>). <span>Unrealistic optimism about future life events: a cautionary note.</span> <span>Psychological Review</span>, <span>118</span>(1), <span>135</span>–<span>154</span>.<a target="_blank" aria-label="CrossRef link for Unrealistic optimism about future life events: a cautionary note." href="https://dx.doi.org/10.1037/a0020997">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Unrealistic optimism about future life events: a cautionary note." href="https://scholar.google.com/scholar_lookup?title=Unrealistic+optimism+about+future+life+events%3A+a+cautionary+note.&amp;author=Harris+A.+J.&amp;author=Hahn+U.&amp;publication+year=2011&amp;journal=Psychological+Review&amp;volume=118&amp;doi=10.1037%2Fa0020997&amp;pages=135-154">Google Scholar</a><a target="_blank" aria-label="PubMed link for Unrealistic optimism about future life events: a cautionary note." href="https://www.ncbi.nlm.nih.gov/pubmed/21058872">PubMed</a></p></div><div id="rf15" aria-flowto="reference-15-content reference-15-button"><p><span><span>Hutcheson</span>, <span>J. C.</span></span> (<span>1929</span>). <span>The judgment intuitive: the function of the “hunch” in judicial decision making.</span> <span>Cornell Law Quarterly,</span> <span>14</span>, <span>274</span>–<span>288</span>.<a target="_blank" aria-label="Google Scholar link for The judgment intuitive: the function of the “hunch” in judicial decision making." href="https://scholar.google.com/scholar_lookup?title=The+judgment+intuitive%3A+the+function+of+the+%E2%80%9Chunch%E2%80%9D+in+judicial+decision+making.&amp;author=Hutcheson+J.+C.&amp;publication+year=1929&amp;journal=Cornell+Law+Quarterly%2C&amp;volume=14&amp;pages=274-288">Google Scholar</a></p></div><div id="rf16" aria-flowto="reference-16-content reference-16-button"><p><span><span>Jekel</span>, <span>M.</span></span>, &amp; <span><span>Glöckner</span>, <span>A.</span></span> <span>(in press). How to identify strategy use and adaptive strategy selection: the crucial role of chance correction in Weighted Compensatory Strategies.</span> <span>Journal of Behavioral Decision Making.</span><a target="_blank" aria-label="Google Scholar link for (in press). How to identify strategy use and adaptive strategy selection: the crucial role of chance correction in Weighted Compensatory Strategies." href="https://scholar.google.com/scholar?q=Jekel,+M.,+&amp;+Gl%C3%B6ckner,+A.+(in+press).+How+to+identify+strategy+use+and+adaptive+strategy+selection:+the+crucial+role+of+chance+correction+in+Weighted+Compensatory+Strategies.+Journal+of+Behavioral+Decision+Making.">Google Scholar</a></p></div><div id="rf17" aria-flowto="reference-17-content reference-17-button"><p><span><span>Kahneman</span>, <span>D.</span></span>, &amp; <span><span>Tversky</span>, <span>A.</span></span> (<span>1984</span>). <span>Choices, values, and frames.</span> <span>American Psychologist</span>, <span>39</span>(4), <span>341</span>–<span>350</span>.<a target="_blank" aria-label="CrossRef link for Choices, values, and frames." href="https://dx.doi.org/10.1037/0003-066X.39.4.341">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Choices, values, and frames." href="https://scholar.google.com/scholar_lookup?title=Choices%2C+values%2C+and+frames.&amp;author=Kahneman+D.&amp;author=Tversky+A.&amp;publication+year=1984&amp;journal=American+Psychologist&amp;volume=39&amp;doi=10.1037%2F0003-066X.39.4.341&amp;pages=341-350">Google Scholar</a></p></div><div id="rf18" aria-flowto="reference-18-content reference-18-button"><p><span><span>Kamenica</span>, <span>E.</span></span> (<span>2012</span>). <span>Behavioral economics and psychology of incentives.</span> <span>Annual Review of Economics</span>, <span>4</span>(1), <span>427</span>–<span>452</span>.<a target="_blank" aria-label="CrossRef link for Behavioral economics and psychology of incentives." href="https://dx.doi.org/10.1146/annurev-economics-080511-110909">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Behavioral economics and psychology of incentives." href="https://scholar.google.com/scholar_lookup?title=Behavioral+economics+and+psychology+of+incentives.&amp;author=Kamenica+E.&amp;publication+year=2012&amp;journal=Annual+Review+of+Economics&amp;volume=4&amp;doi=10.1146%2Fannurev-economics-080511-110909&amp;pages=427-452">Google Scholar</a></p></div><div id="rf19" aria-flowto="reference-19-content reference-19-button"><p><span><span>Muraven</span>, <span>M.</span></span>, &amp; <span><span>Baumeister</span>, <span>R. F.</span></span> (<span>2000</span>). <span>Self-regulation and depletion of limited resources: Does self-control resemble a muscle?</span> <span>Psychological Bulletin</span>, <span>126</span>(2), <span>247</span>–<span>259</span>.<a target="_blank" aria-label="CrossRef link for Self-regulation and depletion of limited resources: Does self-control resemble a muscle?" href="https://dx.doi.org/10.1037/0033-2909.126.2.247">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Self-regulation and depletion of limited resources: Does self-control resemble a muscle?" href="https://scholar.google.com/scholar_lookup?title=Self-regulation+and+depletion+of+limited+resources%3A+Does+self-control+resemble+a+muscle%3F&amp;author=Muraven+M.&amp;author=Baumeister+R.+F.&amp;publication+year=2000&amp;journal=Psychological+Bulletin&amp;volume=126&amp;doi=10.1037%2F0033-2909.126.2.247&amp;pages=247-259">Google Scholar</a><a target="_blank" aria-label="PubMed link for Self-regulation and depletion of limited resources: Does self-control resemble a muscle?" href="https://www.ncbi.nlm.nih.gov/pubmed/10748642">PubMed</a></p></div><div id="rf20" aria-flowto="reference-20-content reference-20-button"><p><span><span>Open</span>, <span>Science Collaboration.</span></span> (<span>2015</span>). <span>Estimating the reproducibility of psychological science.</span> <span>Science</span>, <span>349</span>(6251), aac4716.<a target="_blank" aria-label="Google Scholar link for Estimating the reproducibility of psychological science." href="https://scholar.google.com/scholar_lookup?title=Estimating+the+reproducibility+of+psychological+science.&amp;author=Open+Science+Collaboration.&amp;publication+year=2015&amp;journal=Science&amp;volume=349">Google Scholar</a></p></div><div id="rf21" aria-flowto="reference-21-content reference-21-button"><p><span><span>Pennington</span>, <span>N.</span></span>, &amp; <span><span>Hastie</span>, <span>R.</span></span> (<span>1992</span>). <span>Explaining the evidence: Tests of the Story Model for juror decision making.</span> <span>Journal of Personality and Social Psychology</span>, <span>62</span>(2), <span>189</span>–<span>206</span>.<a target="_blank" aria-label="CrossRef link for Explaining the evidence: Tests of the Story Model for juror decision making." href="https://dx.doi.org/10.1037/0022-3514.62.2.189">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Explaining the evidence: Tests of the Story Model for juror decision making." href="https://scholar.google.com/scholar_lookup?title=Explaining+the+evidence%3A+Tests+of+the+Story+Model+for+juror+decision+making.&amp;author=Pennington+N.&amp;author=Hastie+R.&amp;publication+year=1992&amp;journal=Journal+of+Personality+and+Social+Psychology&amp;volume=62&amp;doi=10.1037%2F0022-3514.62.2.189&amp;pages=189-206">Google Scholar</a></p></div><div id="rf22" aria-flowto="reference-22-content reference-22-button"><p><span><span>Pfungst</span>, <span>O.</span></span> (<span>1911</span>). <span>Clever Hans (the horse of Mr. Von Osten): a contribution to experimental animal and human psychology.</span> <span>New York</span>: <span>Holt, Rinehart and Winston</span> (Originally published in German, 1907).<a target="_blank" aria-label="CrossRef link for Clever Hans (the horse of Mr. Von Osten): a contribution to experimental animal and human psychology." href="https://dx.doi.org/10.5962/bhl.title.56164">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Clever Hans (the horse of Mr. Von Osten): a contribution to experimental animal and human psychology." href="https://scholar.google.com/scholar_lookup?title=Clever+Hans+(the+horse+of+Mr.+Von+Osten)%3A+a+contribution+to+experimental+animal+and+human+psychology.&amp;author=Pfungst+O.&amp;publication+year=1911">Google Scholar</a></p></div><div id="rf23" aria-flowto="reference-23-content reference-23-button"><p><span><span>Rouder</span>, <span>J. N.</span></span>, <span><span>Lu</span>, <span>J.</span></span>, <span><span>Speckman</span>, <span>P.</span></span>, <span><span>Sun</span>, <span>D. H.</span></span>, &amp; <span><span>Jiang</span>, <span>Y.</span></span> (<span>2005</span>). <span>A hierarchical model for estimating response time distributions.</span> <span>Psychonomic Bulletin &amp; Review</span>, <span>12</span>(2), <span>195</span>–<span>223</span>.<a target="_blank" aria-label="CrossRef link for A hierarchical model for estimating response time distributions." href="https://dx.doi.org/10.3758/BF03257252">CrossRef</a><a target="_blank" aria-label="Google Scholar link for A hierarchical model for estimating response time distributions." href="https://scholar.google.com/scholar_lookup?title=A+hierarchical+model+for+estimating+response+time+distributions.&amp;author=Rouder+J.+N.&amp;author=Lu+J.&amp;author=Speckman+P.&amp;author=Sun+D.+H.&amp;author=Jiang+Y.&amp;publication+year=2005&amp;journal=Psychonomic+Bulletin+%26+Review&amp;volume=12&amp;doi=10.3758%2FBF03257252&amp;pages=195-223">Google Scholar</a><a target="_blank" aria-label="PubMed link for A hierarchical model for estimating response time distributions." href="https://www.ncbi.nlm.nih.gov/pubmed/16082801">PubMed</a></p></div><div id="rf24" aria-flowto="reference-24-content reference-24-button"><p><span><span>Schauer</span>, <span>F.</span></span> (<span>2013</span>). <span>Legal Realism Untamed.</span> <span>Texas Law Review</span>, <span>91</span>(4), <span>749</span>–<span>780</span>.<a target="_blank" aria-label="Google Scholar link for Legal Realism Untamed." href="https://scholar.google.com/scholar_lookup?title=Legal+Realism+Untamed.&amp;author=Schauer+F.&amp;publication+year=2013&amp;journal=Texas+Law+Review&amp;volume=91&amp;pages=749-780">Google Scholar</a></p></div><div id="rf25" aria-flowto="reference-25-content reference-25-button"><p><span><span>Simon</span>, <span>D.</span></span> (<span>2004</span>). <span>A third view of the black box: cognitive coherence in legal decision making.</span> <span>University of Chicago Law Review,</span> <span>71</span>, <span>511</span>–<span>586</span>.<a target="_blank" aria-label="Google Scholar link for A third view of the black box: cognitive coherence in legal decision making." href="https://scholar.google.com/scholar_lookup?title=A+third+view+of+the+black+box%3A+cognitive+coherence+in+legal+decision+making.&amp;author=Simon+D.&amp;publication+year=2004&amp;journal=University+of+Chicago+Law+Review%2C&amp;volume=71&amp;pages=511-586">Google Scholar</a></p></div><div id="rf26" aria-flowto="reference-26-content reference-26-button"><p><span><span>Thagard</span>, <span>P.</span></span> (<span>2006</span>). <span>Evaluating Explanations in Law, Science, and Everyday Life.</span> <span>Current Directions in Psychological Science</span>, <span>15</span>(3), <span>141</span>–<span>145</span>.<a target="_blank" aria-label="CrossRef link for Evaluating Explanations in Law, Science, and Everyday Life." href="https://dx.doi.org/10.1111/j.0963-7214.2006.00424.x">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Evaluating Explanations in Law, Science, and Everyday Life." href="https://scholar.google.com/scholar_lookup?title=Evaluating+Explanations+in+Law%2C+Science%2C+and+Everyday+Life.&amp;author=Thagard+P.&amp;publication+year=2006&amp;journal=Current+Directions+in+Psychological+Science&amp;volume=15&amp;doi=10.1111%2Fj.0963-7214.2006.00424.x&amp;pages=141-145">Google Scholar</a></p></div><div id="rf27" aria-flowto="reference-27-content reference-27-button"><p><span><span>Tversky</span>, <span>A.</span></span>, &amp; <span><span>Kahneman</span>, <span>D.</span></span> (<span>1974</span>). <span>Judgment under uncertainty: Heuristics and biases.</span> <span>Science</span>, <span>185</span>(4157), <span>1124</span>–<span>1131</span>.<a target="_blank" aria-label="CrossRef link for Judgment under uncertainty: Heuristics and biases." href="https://dx.doi.org/10.1126/science.185.4157.1124">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Judgment under uncertainty: Heuristics and biases." href="https://scholar.google.com/scholar_lookup?title=Judgment+under+uncertainty%3A+Heuristics+and+biases.&amp;author=Tversky+A.&amp;author=Kahneman+D.&amp;publication+year=1974&amp;journal=Science&amp;volume=185&amp;doi=10.1126%2Fscience.185.4157.1124&amp;pages=1124-1131">Google Scholar</a><a target="_blank" aria-label="PubMed link for Judgment under uncertainty: Heuristics and biases." href="https://www.ncbi.nlm.nih.gov/pubmed/17835457">PubMed</a></p></div><div id="rf29" aria-flowto="reference-29-content reference-29-button"><p><span><span>Yamada</span>, <span>M.</span></span>, <span><span>Camerer</span>, <span>C. F.</span></span>, <span><span>Fujie</span>, <span>S.</span></span>, <span><span>Kato</span>, <span>M.</span></span>, <span><span>Matsuda</span>, <span>T.</span></span>, <span><span>Takano</span>, <span>H.</span></span>, …<span><span>Takahashi</span>, <span>H.</span></span> (<span>2012</span>). <span>Neural circuits in the brain that are activated when mitigating criminal sentences.</span> <span>Nature Communications, 3.</span> <a href="https://dx.doi.org/10.1038/ncomms1757">http://dx.doi.org/10.1038/ncomms1757</a>.<a target="_blank" aria-label="CrossRef link for Neural circuits in the brain that are activated when mitigating criminal sentences." href="https://dx.doi.org/10.1038/ncomms1757">CrossRef</a><a target="_blank" aria-label="Google Scholar link for Neural circuits in the brain that are activated when mitigating criminal sentences." href="https://scholar.google.com/scholar_lookup?title=Neural+circuits+in+the+brain+that+are+activated+when+mitigating+criminal+sentences.&amp;author=Yamada+M.&amp;author=Camerer+C.+F.&amp;author=Fujie+S.&amp;author=Kato+M.&amp;author=Matsuda+T.&amp;author=Takano+H.&amp;author=Takahashi+H.&amp;publication+year=2012&amp;journal=Nature+Communications%2C+3.&amp;doi=10.1038%2Fncomms1757">Google Scholar</a><a target="_blank" aria-label="PubMed link for Neural circuits in the brain that are activated when mitigating criminal sentences." href="https://www.ncbi.nlm.nih.gov/pubmed/22453832">PubMed</a></p></div></div></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[StreamPot: Run FFmpeg as an API with fluent-FFmpeg compatibility, queues and S3 (104 pts)]]></title>
            <link>https://github.com/StreamPot/StreamPot</link>
            <guid>41091163</guid>
            <pubDate>Sun, 28 Jul 2024 04:09:04 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/StreamPot/StreamPot">https://github.com/StreamPot/StreamPot</a>, See on <a href="https://news.ycombinator.com/item?id=41091163">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">StreamPot</h2><a id="user-content-streampot" aria-label="Permalink: StreamPot" href="#streampot"></a></p>
<div dir="auto"><p dir="auto">Note</p><p dir="auto"><strong>StreamPot is still in the early stages of development, we would appreciate your feedback.</strong></p>
</div>
<p dir="auto">StreamPot is a project that provides scaffolding for transforming media in your app (e.g. trimming a video, stripping the audio from a video, transcoding a video from mp4 to webp).</p>
<p dir="auto">We are building this because an increasing number of projects are transforming media as part of their workflow.</p>
<p dir="auto">If you want a no-setup way to run this, check out <a href="https://www.streampot.io/" rel="nofollow">StreamPot</a>.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Running the server locally</h2><a id="user-content-running-the-server-locally" aria-label="Permalink: Running the server locally" href="#running-the-server-locally"></a></p>
<p dir="auto">Visit the <a href="https://www.streampot.io/installation.html#setting-up-the-server-without-docker" rel="nofollow">Installation (server)</a> page for self-hosting instructions.
If you'd like to use the <strong>hosted version</strong>, please <a href="https://app.streampot.io/register" rel="nofollow">sign up</a> and give it a try.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Running a job in your app</h2><a id="user-content-running-a-job-in-your-app" aria-label="Permalink: Running a job in your app" href="#running-a-job-in-your-app"></a></p>
<p dir="auto">Note: You should only run this from your server.</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Install the client library</h3><a id="user-content-install-the-client-library" aria-label="Permalink: Install the client library" href="#install-the-client-library"></a></p>

<p dir="auto"><h3 tabindex="-1" dir="auto">Initialise the client &amp; submit a job.</h3><a id="user-content-initialise-the-client--submit-a-job" aria-label="Permalink: Initialise the client &amp; submit a job." href="#initialise-the-client--submit-a-job"></a></p>
<div dir="auto" data-snippet-clipboard-copy-content="import StreamPot from '@streampot/client'
const EXAMPLE_VID = 'https://sample-videos.com/video321/mp4/240/big_buck_bunny_240p_1mb.mp4'

const client = new StreamPot({
    baseUrl: 'http://127.0.0.1:3000', // adjust if you are serving in production
})

const clipJob = await client.input(EXAMPLE_VID)
    .setStartTime(1)
    .setDuration(2)
    .output('output.mp4')
    .run()
const jobId = clipJob.id

// In production you should set up a poll.
setTimeout(async () => {
    const job = await client.checkStatus(jobId)
    if (job.status === 'completed'){
        console.log(job.output_url)
    } 
},10000) // wait 10 seconds"><pre><span>import</span> <span>StreamPot</span> <span>from</span> <span>'@streampot/client'</span>
<span>const</span> <span>EXAMPLE_VID</span> <span>=</span> <span>'https://sample-videos.com/video321/mp4/240/big_buck_bunny_240p_1mb.mp4'</span>

<span>const</span> <span>client</span> <span>=</span> <span>new</span> <span>StreamPot</span><span>(</span><span>{</span>
    <span>baseUrl</span>: <span>'http://127.0.0.1:3000'</span><span>,</span> <span>// adjust if you are serving in production</span>
<span>}</span><span>)</span>

<span>const</span> <span>clipJob</span> <span>=</span> <span>await</span> <span>client</span><span>.</span><span>input</span><span>(</span><span>EXAMPLE_VID</span><span>)</span>
    <span>.</span><span>setStartTime</span><span>(</span><span>1</span><span>)</span>
    <span>.</span><span>setDuration</span><span>(</span><span>2</span><span>)</span>
    <span>.</span><span>output</span><span>(</span><span>'output.mp4'</span><span>)</span>
    <span>.</span><span>run</span><span>(</span><span>)</span>
<span>const</span> <span>jobId</span> <span>=</span> <span>clipJob</span><span>.</span><span>id</span>

<span>// In production you should set up a poll.</span>
<span>setTimeout</span><span>(</span><span>async</span> <span>(</span><span>)</span> <span>=&gt;</span> <span>{</span>
    <span>const</span> <span>job</span> <span>=</span> <span>await</span> <span>client</span><span>.</span><span>checkStatus</span><span>(</span><span>jobId</span><span>)</span>
    <span>if</span> <span>(</span><span>job</span><span>.</span><span>status</span> <span>===</span> <span>'completed'</span><span>)</span><span>{</span>
        <span>console</span><span>.</span><span>log</span><span>(</span><span>job</span><span>.</span><span>output_url</span><span>)</span>
    <span>}</span> 
<span>}</span><span>,</span><span>10000</span><span>)</span> <span>// wait 10 seconds</span></pre></div>
<p dir="auto"><h2 tabindex="-1" dir="auto">Acknowledgements</h2><a id="user-content-acknowledgements" aria-label="Permalink: Acknowledgements" href="#acknowledgements"></a></p>
<p dir="auto">This project is heavily reliant on the amazing work of the ffmpeg and fluent-ffmpeg teams</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Feedback</h2><a id="user-content-feedback" aria-label="Permalink: Feedback" href="#feedback"></a></p>
<p dir="auto">If you want to use StreamPot in your project, I'd be happy to help &amp; improve it based on your feedback. Email me at <a href="mailto:jack@bitreach.io">jack@bitreach.io</a> or <a href="https://cal.com/jackbridger/30min" rel="nofollow">let's have a call</a>.</p>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How to Debug Your Battery (243 pts)]]></title>
            <link>https://github.com/ionworks/how-to-debug-your-battery</link>
            <guid>41090658</guid>
            <pubDate>Sun, 28 Jul 2024 01:39:06 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://github.com/ionworks/how-to-debug-your-battery">https://github.com/ionworks/how-to-debug-your-battery</a>, See on <a href="https://news.ycombinator.com/item?id=41090658">Hacker News</a></p>
<div id="readability-page-1" class="page"><div data-hpc="true"><article itemprop="text"><p dir="auto"><h2 tabindex="-1" dir="auto">How to debug your battery design</h2><a id="user-content-how-to-debug-your-battery-design" aria-label="Permalink: How to debug your battery design" href="#how-to-debug-your-battery-design"></a></p>
<p dir="auto"><h3 tabindex="-1" dir="auto">By <a href="https://www.linkedin.com/in/tom-tranter-355a1033/" rel="nofollow">Tom Tranter</a>, Co-founder &amp; CTO at <a href="https://www.ionworks.com/" rel="nofollow">Ionworks</a></h3><a id="user-content-by-tom-tranter-co-founder--cto-at-ionworks" aria-label="Permalink: By Tom Tranter, Co-founder &amp; CTO at Ionworks" href="#by-tom-tranter-co-founder--cto-at-ionworks"></a></p>
<p dir="auto">[ N.B I have edited the title to emphasize this is more a theoretical exploration of battery design than practical advice to fix your hardware issues - sorry to disappoint those coming for the latter ]</p>
<p dir="auto">Picture the scene, you're an engineer at an electric vehicle company and your boss comes to you and says: <em>"Jeremy we've got a problem!"</em> (your name is Jeremy by the way) <em>"It's these damn batteries, there's just too many of them in the car and it's weighing us down but we really want our customers to be able to drive 400 miles without having to stop and charge!"</em> - What do you do? How do you debug your battery? It's a black box of magic right?!? Wrong. Use simulation.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">The <strong>"and"</strong> problem</h2><a id="user-content-the-and-problem" aria-label="Permalink: The &quot;and&quot; problem" href="#the-and-problem"></a></p>
<p dir="auto">It seems like there's no good solution in the market today. Batteries are either designed to be high energy <strong>or</strong> high power, not high energy <strong>and</strong> power. If we stick a bunch of high energy batteries in the vehicle we might get more range but then when we try to accelerate they overheat because the rated power is too low and the losses in the system are too high. This causes us to over-engineer the cooling system (adding weight and cost) and we also find that batteries operating at higher temperatures lose capacity faster. Also there are other constraints on the battery design, such as safety, lifetime, weight and last but by no means least cost.</p>
<p dir="auto">Below is an indicative spider-plot of the main metrics that battery engineers tend to care about when designing or selecting cells which often compete with one another.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/spider.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/spider.png" alt=""></a></p>
<p dir="auto">A good intro into cell design can be found at <a href="https://www.batterydesign.net/power-versus-energy-cells/" rel="nofollow">batterydesign.net</a>. Below is an image taken from that site of the difference between high power and high energy. Thinner electrodes tend to be better for drawing larger currents because there is less material in the way of ion transport but they have more inactive material (i.e. current collectors and separators - the gold, grey and yellow bits) per unit volume making them less energy dense.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/power-vs-energy-cell-b.webp"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/power-vs-energy-cell-b.webp" alt=""></a></p>
<p dir="auto">This problem is even bigger for your buddy designing batteries for electric aircraft as the peak power needed for take-off and landing is much higher (10 x) than the power needed for cruising. So you have to prioritize power and sacrifice range - aircraft also find it really hard to top-up charge mid flight 🤣. For a great perspective on the prospects of electric flight I recommend <a href="https://www.nature.com/articles/s41586-021-04139-1" rel="nofollow">this article</a>.</p>
<p dir="auto">Luckily you know an engineer at your battery supplier and can call them to discuss the problem.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">The curse of dimensionality</h2><a id="user-content-the-curse-of-dimensionality" aria-label="Permalink: The curse of dimensionality" href="#the-curse-of-dimensionality"></a></p>
<p dir="auto">The battery supplier is well aware of the difficulties in designing batteries and explains they have been spending years on the problem, testing different designs trying to optimize for different use cases. It takes at least 1 day to build and fully test one single design in the lab with all the characterization experiments they need to run and up to 1 month for cells selected for accelerated ageing tests. This is where the cell is cycled really hard constantly and the data collected is then extrapolated to a real-world driving scenario (car mostly parked on your driveway), but going from one scenario to another isn't so straight-forward as the ageing effects are non-linear. A rough estimate for how much it costs to build and test a new battery design on a single cell (one data point) is around $1000.</p>
<p dir="auto">That might not sound too much but now consider how many different design decisions go into making one battery. You have to choose materials:</p>
<ul dir="auto">
<li>Anode</li>
<li>Cathode</li>
<li>Electrolyte</li>
<li>Separator</li>
</ul>
<p dir="auto">Each solid material can be tuned by:</p>
<ul dir="auto">
<li>Thickness</li>
<li>Porosity (amount of space for solid active material or for liquid ion transporting material)</li>
<li>Particle size</li>
<li>Composition if a mixture of materials</li>
</ul>
<p dir="auto">Then you have geometric factors like</p>
<ul dir="auto">
<li>Form factor - cylindrical, prismatic, pouch</li>
<li>Size i.e. 18650</li>
<li>Number of tabs</li>
<li>Current collector thickness</li>
<li>Safety features like venting cap and central mandrel.</li>
</ul>
<p dir="auto">Each electrolyte composition can be altered too and this is often where the secret sauce actually is (but maybe more on that another day).</p>
<p dir="auto">Let's say conservatively there are 20 things you might want to change. If you collect 3 different data points changing each thing one at a time (original design, some number higher, some number lower) whilst keeping everything else constant (usually a good scientific approach) that's 3<sup>20</sup> possible combinations of changes!</p>
<p dir="auto">That's 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3 x 3</p>
<p dir="auto">= 3,486,784,401</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/counting.gif"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/counting.gif" alt="" data-animated-image=""></a></p>
<p dir="auto">The short script below illustrates the curse for a 3 variable problem. It's hard to visualize a 20 dimensional parameter space but you get the drift.</p>
<div data-snippet-clipboard-copy-content="import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import numpy as np

def plot_points(x, y, z):
    # Create a 3D plot
    fig = plt.figure(figsize=(5, 5))
    ax = fig.add_subplot(111, projection='3d')

    # Plot the points
    ax.scatter(x.flatten(), y.flatten(), z.flatten(), s=10)

    # Set titles and labels
    ax.set_title(f'{np.sum(np.array(np.shape(x)) > 1)}D Parameter Space')
    ax.set_xlabel('X-axis')
    ax.set_ylabel('Y-axis')
    ax.set_zlabel('Z-axis')

    # Show plot
    plt.show()

# Generate data for 3D space
points = np.linspace(0, 1, 10)
x, y, z = np.meshgrid(points, 1, 1)
plot_points(x, y, z)
x, y, z = np.meshgrid(points, points, 1)
plot_points(x, y, z)
x, y, z = np.meshgrid(points, points, points)
plot_points(x, y, z)"><pre><code>import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import numpy as np

def plot_points(x, y, z):
    # Create a 3D plot
    fig = plt.figure(figsize=(5, 5))
    ax = fig.add_subplot(111, projection='3d')

    # Plot the points
    ax.scatter(x.flatten(), y.flatten(), z.flatten(), s=10)

    # Set titles and labels
    ax.set_title(f'{np.sum(np.array(np.shape(x)) &gt; 1)}D Parameter Space')
    ax.set_xlabel('X-axis')
    ax.set_ylabel('Y-axis')
    ax.set_zlabel('Z-axis')

    # Show plot
    plt.show()

# Generate data for 3D space
points = np.linspace(0, 1, 10)
x, y, z = np.meshgrid(points, 1, 1)
plot_points(x, y, z)
x, y, z = np.meshgrid(points, points, 1)
plot_points(x, y, z)
x, y, z = np.meshgrid(points, points, points)
plot_points(x, y, z)
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/1d-pspace.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/1d-pspace.png" alt=""></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/2d-pspace.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/2d-pspace.png" alt=""></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/3d-pspace.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/3d-pspace.png" alt=""></a></p>
<p dir="auto">Now testing 3,486,784,401 batteries is obviously a <strong>ridiculous</strong> thing to do and no reasonable battery developer would carry out that many experiments. Even if you parallelize by say 1000 and have a huge test facility cycling batteries constantly that's still over 1 million experiments for each cycler channel which would take at least 1 million days and cost over $1B dollars!</p>
<p dir="auto">This is known as the curse of dimensionality (the more things you have to vary, the <strong>exponentially</strong> more combinations you have to test) and unfortunately battery engineers have this curse pretty bad! In fact several battery unicorns are spending basically all their money on R&amp;D and still trying to bring their new technology to market without having yet put a single cell inside a single car.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/get-out.gif"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/get-out.gif" alt="" data-animated-image=""></a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">A solution to the "and" problem?</h2><a id="user-content-a-solution-to-the-and-problem" aria-label="Permalink: A solution to the &quot;and&quot; problem?" href="#a-solution-to-the-and-problem"></a></p>
<p dir="auto">Your battery cell designer has some hope for your problem though, they have been testing a new material which could deliver more energy density while retaining high power. An anode with a mixture of graphite and silicon. This being silicon valley and all you are pretty excited as there must be plenty of that around and you ask when can you get some batteries to test out....?</p>
<p dir="auto">Well... your battery supplier says, <em>"we're still evaluating that material and it may be a little while longer. The initial tests in the lab look good though and there are already some cells on the market with silicon but they've had a few issues."</em> More on this in a bit.</p>
<p dir="auto">Typically, the cell designers won't actually be making all the modifications and carry out all these tests themselves. They will have their own suppliers of materials and they will be doing a lot of the tests too. Let's take the anode as an example:</p>
<p dir="auto">The anode is the negative electrode in the cell and hosts ions in what we call the active material (think itty bitty particles). The Li ions intercalate which basically means squeeze inside the crystalline lattice of the host material and this causes the material to change in size. Once inside a process like diffusion occurs where ions migrate to the center of the material (a spherical particle for the sake of argument). As the concentration of Li ions inside the host material changes we call this lithiation i.e. filling up with lithium. This is an electrochemical process and requires electron transfer to take place which occurs when current is supplied or drawn from the cell.</p>
<p dir="auto">Here's a great and easy to understand video by The Limiting Factor on how batteries work at the particle and atomic level.</p>
<p dir="auto"><a href="https://youtu.be/4-1psMHSpKs" rel="nofollow"><img src="https://camo.githubusercontent.com/c723e07f96c61e9a4b99573df420329dd16b35101b16b3d6a3b282183a10d805/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f342d3170734d4853704b732f302e6a7067" alt="" data-canonical-src="https://img.youtube.com/vi/4-1psMHSpKs/0.jpg"></a></p>
<p dir="auto">Adding silicon to an anode gives more capacity to the cell as there are more host sites for lithium per unit volume but this does have one or two drawbacks. The first is what happens to the cell voltage:</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Voltage Hysteresis</h3><a id="user-content-voltage-hysteresis" aria-label="Permalink: Voltage Hysteresis" href="#voltage-hysteresis"></a></p>
<p dir="auto">There are typically several stages of the process of lithiation where the crystal structure tends to form stable phases as the degree of lithiation increases or decreases. The chemical potential of the lithiated particles is directly related to the degree of lithiation (hard to measure) and this basically translates to the open circuit potential or voltage of the material (easier to measure).</p>
<p dir="auto">Without diving too much deeper into the physics we can safely say, as you charge and discharge, ions move in and out of the host material and voltage changes. The voltage changes more slowly when materials are changing from one stable phase to the next. Careful analysis of the open-circuit potential and it's derivative with respect to lithiation or capacity (dVdQ) can then reveal what the material inside might be because crystals are "somewhat" predictable. They have characteristic plateaus in voltage at certain degrees of lithiation. On the flip side: if you know the material you can predict the state of charge (SoC) from the voltage (something the battery systems designers really like to know). I say "somewhat" because silicon unfortunately suffers from voltage hysteresis meaning that the voltage when charging and discharging in a cycle follows different paths, even when cycling very slowly, say 1 cycle per day.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/hysteresis.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/hysteresis.png" alt=""></a></p>
<p dir="auto">It sounds like a fairly trivial thing to know how much charge your battery has left, why not just measure the current in and out constantly (a technique known as coulomb counting). However, counting is prone to error, if say a sensor fails or has a low accuracy or systematic error the predictions will drift over time. Voltage can be measured and gives an instant snapshot of the state of the battery and is therefore usually used as the indicator of SoC.</p>
<p dir="auto">But is voltage reliable? No not really. Voltage has its issues too and depends on how far from equilibrium the system is. Often what happens is the battery is left at rest and then cells connected in parallel start to equalize their open circuit potentials and current re-balances. The overall charge left in the system is still the same but the voltage at rest has relaxed closer to equilibrium compared with when you switched the system off (this also happens inside the cell as well as between cells). Voltage also depends on temperature, ageing, and also whether you are charging or discharging the battery (hysteresis).</p>
<p dir="auto"><h3 tabindex="-1" dir="auto">Swelling &amp; Cracking</h3><a id="user-content-swelling--cracking" aria-label="Permalink: Swelling &amp; Cracking" href="#swelling--cracking"></a></p>
<p dir="auto">Another problem with silicon is that the particles swell to around 80% bigger when lithiated compared to de-lithiated. This is an issue because this causes stress to the particle itself which may break up and no-longer form an active part of the material, and it may also impact its surrounding host material, either breaking that or breaking its connection with it. These mechanical effects cause accelerated ageing of the cell where active material inventory is lost more quickly and cell capacity decreases.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/cracking.jpg"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/cracking.jpg" alt=""></a></p>
<p dir="auto">Fortunately, making the particles smaller, helps both with the voltage hysteresis and the effects of swelling, it also increases the active surface area per unit mass of the silicon and this helps lower the losses associated with the reactions in the battery.</p>
<p dir="auto">How do I know all this you might wonder? Well, there is a certain amount of intuition to these things and I have a PhD and several more years subsequently researching electrochemical systems. But the main reason is that these systems can be explored, tested and evaluated with computational simulations.</p>
<p dir="auto"><h2 tabindex="-1" dir="auto">PyBaMM to the rescue</h2><a id="user-content-pybamm-to-the-rescue" aria-label="Permalink: PyBaMM to the rescue" href="#pybamm-to-the-rescue"></a></p>
<p dir="auto">Let's look at some cool things you can do with simulation to help debug your battery problem. <a href="https://github.com/pybamm-team/PyBaMM/">PyBaMM</a> is open-source and written in Python (that's the <strong>Py</strong> bit). The "BaMM" stands for <strong>Ba</strong>tery <strong>M</strong>athematical <strong>M</strong>odelling.</p>
<p dir="auto">First off, what is going on inside when I charge and discharge and why is my voltage changing the way it does? Which physical processes and their related design features have the biggest effect on the voltage?</p>
<div data-snippet-clipboard-copy-content="import pybamm
model = pybamm.lithium_ion.DFN()
parameter_values = pybamm.ParameterValues(&quot;Chen2020&quot;)
experiment = pybamm.Experiment(
    [
        &quot;Discharge at 2C for 20 minutes&quot;,
        &quot;Rest for 10 minutes&quot;,
    ], period=&quot;30 seconds&quot;
)
sim = pybamm.Simulation(model, experiment=experiment, parameter_values=parameter_values)
solution = sim.solve()
plotter = pybamm.QuickPlot(solutions=solution, time_unit=&quot;hours&quot;)
plotter.dynamic_plot()"><pre><code>import pybamm
model = pybamm.lithium_ion.DFN()
parameter_values = pybamm.ParameterValues("Chen2020")
experiment = pybamm.Experiment(
    [
        "Discharge at 2C for 20 minutes",
        "Rest for 10 minutes",
    ], period="30 seconds"
)
sim = pybamm.Simulation(model, experiment=experiment, parameter_values=parameter_values)
solution = sim.solve()
plotter = pybamm.QuickPlot(solutions=solution, time_unit="hours")
plotter.dynamic_plot()
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/plot.gif"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/plot.gif" alt="" data-animated-image=""></a></p>
<p dir="auto">Here we can clearly see the big difference in voltage when we stop discharging the battery and start resting. But what exactly is going on here? A useful feature of PyBaMM is to split the voltage into its constituent components, known as overpotentials. You have the ideal potential of the battery for a certain state of charge when everything is in equilibrium: the open-circuit potential (OCP) and then you have all the voltage losses associated with things not being at equilibrium.</p>
<div data-snippet-clipboard-copy-content="pybamm.plot_voltage_components(solution)"><pre><code>pybamm.plot_voltage_components(solution)
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_01_voltage_components.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_01_voltage_components.png" alt=""></a></p>
<p dir="auto">Here we can immediately learn a few things:</p>
<ul dir="auto">
<li>A large portion of the change in voltage of the cell is just the open circuit voltage changing as a function of lithiation (SoC), but other processes are certainly significant.</li>
<li>At the point that the current stops, the voltage relaxes a great deal almost instantly. You can see the green reaction overpotential, purple Ohmic electrolyte potential and brown Ohmic electrode overpotential go from being thick sections to disappearing. This makes sense as these processes are all related to current and ion transport.</li>
<li>The orange and to an extent the red concentration overpotentials are slower to disappear which means that ions are still moving in the system when no reactions are taking place and this is due to the build up of concentration gradients inside the active solid and electrolyte.</li>
<li>The electrolyte losses due to concentration (overpotential) during discharge are fairly sizeable (around 100 mV) but they disappear much faster than within the active material meaning that diffusion is much easier in the electrolyte than within the solid.</li>
</ul>
<p dir="auto">We can inspect the concentration profiles in both solid particles and the electrolyte to confirm these findings. Below are 5 snapshots at the start of the rest period and afterwards.</p>
<div data-snippet-clipboard-copy-content="plotter = pybamm.QuickPlot(solutions=[solution], output_variables=[
    &quot;X-averaged negative particle concentration [mol.m-3]&quot;,
    &quot;X-averaged positive particle concentration [mol.m-3]&quot;,
    &quot;Electrolyte concentration [mol.m-3]&quot;
    ])
plotter.plot(t=[1200]) # At point of rest
plotter.plot(t=[1380])
plotter.plot(t=[1800])"><pre><code>plotter = pybamm.QuickPlot(solutions=[solution], output_variables=[
    "X-averaged negative particle concentration [mol.m-3]",
    "X-averaged positive particle concentration [mol.m-3]",
    "Electrolyte concentration [mol.m-3]"
    ])
plotter.plot(t=[1200]) # At point of rest
plotter.plot(t=[1380])
plotter.plot(t=[1800])
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_01_concs_1200.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_01_concs_1200.png" alt=""></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_01_concs_1380.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_01_concs_1380.png" alt=""></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_01_concs_1800.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_01_concs_1800.png" alt=""></a></p>
<p dir="auto">The concentration in the positive particle is still not equal as a function of radius. We can intuitively guess then that changing some feature of the positive particle may have some effect on the relaxation behavior of the cell. Let's see what the current positive particle radius is and where changing this value has a significant effect.</p>
<div data-snippet-clipboard-copy-content="parameter_values[&quot;Positive particle radius [m]&quot;]"><pre><code>parameter_values["Positive particle radius [m]"]
</code></pre></div>
<p dir="auto">5.22e-06</p>
<div data-snippet-clipboard-copy-content="parameter_values[&quot;Positive particle radius [m]&quot;] = 3.0e-6
sim2 = pybamm.Simulation(model, experiment=experiment, parameter_values=parameter_values)
solution2 = sim2.solve()
pybamm.plot_voltage_components(solution2)"><pre><code>parameter_values["Positive particle radius [m]"] = 3.0e-6
sim2 = pybamm.Simulation(model, experiment=experiment, parameter_values=parameter_values)
solution2 = sim2.solve()
pybamm.plot_voltage_components(solution2)
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_02_voltage_components.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_02_voltage_components.png" alt=""></a></p>
<p dir="auto">We can now see a much faster leveling off of the voltage at rest and we can check the concentrations again</p>
<div data-snippet-clipboard-copy-content="plotter = pybamm.QuickPlot(solutions=[solution, solution2], labels=[&quot;Big particle&quot;,&quot;Small particle&quot;], output_variables=[
    &quot;X-averaged negative particle concentration [mol.m-3]&quot;,
    &quot;X-averaged positive particle concentration [mol.m-3]&quot;,
    &quot;Electrolyte concentration [mol.m-3]&quot;
    ])
plotter.plot(t=[1200]) # At point of rest
plotter.plot(t=[1800]) # At point of rest"><pre><code>plotter = pybamm.QuickPlot(solutions=[solution, solution2], labels=["Big particle","Small particle"], output_variables=[
    "X-averaged negative particle concentration [mol.m-3]",
    "X-averaged positive particle concentration [mol.m-3]",
    "Electrolyte concentration [mol.m-3]"
    ])
plotter.plot(t=[1200]) # At point of rest
plotter.plot(t=[1800]) # At point of rest
</code></pre></div>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_02_concs_1200.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_02_concs_1200.png" alt=""></a>
<a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/simulation_02_concs_1800.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/simulation_02_concs_1800.png" alt=""></a></p>
<p dir="auto">Now the contributions of the positive solid particle to the voltage at rest is resolved much more quickly than before. This is because the smaller particle size allows for faster diffusion of lithium ions in and out of the particle. This is a good example of how the model can be used to investigate the effect of different parameters on the performance of a battery.</p>
<p dir="auto">This is just one example of how to use modelling to debug your battery problem. <strong>PyBaMM</strong> also has many other examples including one on modelling <a href="https://docs.pybamm.org/en/stable/source/examples/notebooks/models/differential-capacity-hysteresis-state.html" rel="nofollow">hysteresis</a> in silicon anodes. Also as we can see here a single experiment takes a matter of seconds and with some of the simpler models only a matter of ms. This helps engineers really battle the curse of dimensionality. For example the Ragone plot below sweeping over some of the common parameters you might investigate changing contains 6500 data points and with each one taking less than 1s running one after the other on a single core would take under 2 hours to compute, already a massive saving compared to weeks with our 1000 channel cycler lab (each experiment takes less than an hour in the lab but we have to prepare the materials and build the cells too). With parallel computing this number can be cut to less than a minute.</p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/ragone.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/ragone.png" alt=""></a></p>
<p dir="auto">If you liked this How to guide and want to learn more about battery modelling head to our github page (and don't forget to give it a ⭐) <a href="https://github.com/pybamm-team/PyBaMM">https://github.com/pybamm-team/PyBaMM</a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/pybamm.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/pybamm.png" alt=""></a></p>
<p dir="auto">For enterprises looking to get help with their battery modelling hit me up at <a href="mailto:tom@ionworks.com">tom@ionworks.com</a> or head to our <a href="https://www.ionworks.com/" rel="nofollow">website</a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/figures/ionworks.png"><img src="https://github.com/ionworks/how-to-debug-your-battery/raw/main/figures/ionworks.png" alt=""></a></p>
<p dir="auto">All runnable code in this document can be found <a href="https://github.com/ionworks/how-to-debug-your-battery/blob/main/how-to-debug-your-battery.ipynb">here</a></p>
<p dir="auto"><h2 tabindex="-1" dir="auto">Links</h2><a id="user-content-links" aria-label="Permalink: Links" href="#links"></a></p>
<ol dir="auto">
<li><a href="https://www.ycombinator.com/launches/LRR-ionworks-build-and-run-battery-simulations-at-scale" rel="nofollow">https://www.ycombinator.com/launches/LRR-ionworks-build-and-run-battery-simulations-at-scale</a></li>
<li><a href="https://www.batterydesign.net/power-versus-energy-cells/" rel="nofollow">https://www.batterydesign.net/power-versus-energy-cells/</a></li>
<li><a href="https://www.nature.com/articles/s41586-021-04139-1" rel="nofollow">https://www.nature.com/articles/s41586-021-04139-1</a></li>
<li><a href="https://youtu.be/4-1psMHSpKs" rel="nofollow">https://youtu.be/4-1psMHSpKs</a></li>
<li><a href="https://www.researchgate.net/publication/371137234/figure/fig1/AS:11431281162715436@1685416870841/Open-circuit-voltage-hysteresis-generated-by-a-viscoelastoplastic-SEI-in-comparison-to.png" rel="nofollow">https://www.researchgate.net/publication/371137234/figure/fig1/AS:11431281162715436@1685416870841/Open-circuit-voltage-hysteresis-generated-by-a-viscoelastoplastic-SEI-in-comparison-to.png</a></li>
<li><a href="https://ars.els-cdn.com/content/image/1-s2.0-S1226086X19300942-gr7.jpg" rel="nofollow">https://ars.els-cdn.com/content/image/1-s2.0-S1226086X19300942-gr7.jpg</a></li>
</ol>
</article></div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[How did Facebook intercept their competitor's encrypted mobile app traffic? (433 pts)]]></title>
            <link>https://doubleagent.net/onavo-facebook-ssl-mitm-technical-analysis/</link>
            <guid>41090304</guid>
            <pubDate>Sun, 28 Jul 2024 00:08:21 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://doubleagent.net/onavo-facebook-ssl-mitm-technical-analysis/">https://doubleagent.net/onavo-facebook-ssl-mitm-technical-analysis/</a>, See on <a href="https://news.ycombinator.com/item?id=41090304">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
        <p>There is a current class action lawsuit against Meta in which court documents include claims that the company had breached the <a href="https://en.wikipedia.org/wiki/Electronic_Communications_Privacy_Act?ref=doubleagent.net" rel="noreferrer">Wiretap Act</a>. The analysis made in this post is based on content <a href="https://www.documentcloud.org/documents/24520332-merged-fb?ref=doubleagent.net" rel="noreferrer">court documents</a> and reverse engineering sections of archived Onavo Protect app packages for Android. </p><p>It is suggested to read a recent <a href="https://techcrunch.com/2024/03/26/facebook-secret-project-snooped-snapchat-user-traffic/?ref=doubleagent.net" rel="noreferrer">TechCrunch</a> article for additional background on the case.</p><p>It is claimed that Facebook intercepted user's encrypted HTTPS traffic by using what would be considered the a <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack?ref=doubleagent.net" rel="noreferrer">MITM attack</a>. Facebook called this technique "ssl bump", appropriately named after the transparent proxy <a href="https://www.squid-cache.org/Doc/config/ssl_bump/?ref=doubleagent.net" rel="noreferrer">feature</a> in the <a href="https://www.squid-cache.org/?ref=doubleagent.net" rel="noreferrer">Squid caching</a> proxy software which was used to (allegedly) decrypt specific Snapchat, YouTube and Amazon domain(s). </p><div><p>Due to the limited and partial information, some facts may be inaccurate or incomplete in this post. As such this post is subject to updates if corrections are warranted or new discoveries made. Feel free to subscribe to this blog to receive updates in your inbox, or follow me on <a href="https://twitter.com/haxrob?ref=doubleagent.net" rel="noreferrer">X (ex Twitter</a>).</p></div><h3 id="summary">Summary</h3><ul><li><a href="https://apkpure.com/onavo-protect-from-facebook/com.onavo.spaceship?ref=doubleagent.net" rel="noreferrer">Onavo Protect Android app</a> contained code to prompt the user to install a CA (certificate authority) certificate issued by "Facebook Research" in the user trust store of the device. This certificate was required for Facebook to decrypt TLS traffic.</li><li>Some versions of the older app contain the Facebook Research CA certs as embedded assets in the distributed app from 2016. One cert is valid until 2027. Data discovery content in court documents state certificates are "generated on the server and sent to the device".</li><li>Soon after the "ssl bump" feature was deployed in the Protect app, a newer version of Android was released that included improved security controls that would render this method unusable on devices with the newer operating system.</li><li>A review of an old Snapchat app shows that it's analytics domain did not employ certificate pinning, meaning that MITM / "ssl bumping" would have worked as described.</li><li>In addition to the core functionality of gathering other app's usage statistics through abusing a permission granted by the user, there also appears to be other functionality to obtain questionable sensitive data, such as the <a href="https://en.wikipedia.org/wiki/International_mobile_subscriber_identity?ref=doubleagent.net" rel="noreferrer">subscriber IMSI</a>.</li></ul><p>The setup most likely would have looked something the following diagram:</p><figure><img src="https://doubleagent.net/content/images/2024/04/fb1-3-1.png" alt="" loading="lazy" width="844" height="305" srcset="https://doubleagent.net/content/images/size/w600/2024/04/fb1-3-1.png 600w, https://doubleagent.net/content/images/2024/04/fb1-3-1.png 844w" sizes="(min-width: 720px) 720px"><figcaption><span>An interpretation of FB's setup based on court documents and app analysis</span></figcaption></figure><p>Here we have a trusted cert installed on the device, all device traffic going over a VPN to Facebook controlled infrastructure, traffic redirected into a Squid caching proxy setup as a transparent proxy with the 'ssl bump' feature configured. We know from the documents that various domains belonging to Snapchat, Amazon and Youtube were of interest. It's not known if any other user traffic was intercepted, or just proxied on. This type of information we can't obtain from looking at the archived Onavo Protect apps, rather for the time being, we have to rely on the content in the court documents made available to the public.</p><p>Over time the success of their strategy to employ a transparent TLS proxy was diminishing due to improved security controls in Android.  Additionally certificate pinning adoption was said to be an issue. As an alterative, Facebook were considering using the <a href="https://support.google.com/googleplay/android-developer/answer/10964491?hl=en&amp;ref=doubleagent.net#:~:text=Google%20Play%20permits%20the%20use,that%20they%20are%20accessibility%20tools." rel="noreferrer">Accessibility API</a> as an alternative. </p><figure><img src="https://doubleagent.net/content/images/2024/04/image-14.png" alt="" loading="lazy" width="818" height="161" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-14.png 600w, https://doubleagent.net/content/images/2024/04/image-14.png 818w" sizes="(min-width: 720px) 720px"><figcaption><span>Page 3 - Case 3:20-cv-08570-JD Document 736</span></figcaption></figure><p>This is what Google has to say about using the accessibility features on their operating system:</p><blockquote>"only services that are designed to help people with disabilities access their device or otherwise overcome challenges stemming from their disabilities are eligible to declare that they are accessibility tools."</blockquote><p>It's somewhat telling of a company that would consider abusing features designed to support people with disabilities for a competitive advantage. Generally, Android accessibility functionality misuse is attributed to malicious applications such as <a href="https://blog.pradeo.com/accessibility-services-mobile-analysis-malware?ref=doubleagent.net" rel="noreferrer">banking malware</a>.</p><h2 id="motivation">Motivation</h2><p>Mark Zuckerberg states the need for "<em>reliable analytics</em>" on Snapchat:</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-4.png" alt="" loading="lazy" width="617" height="335" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-4.png 600w, https://doubleagent.net/content/images/2024/04/image-4.png 617w"></figure><p>The solution? "<em>Kits that can be installed on iOS and Android that intercept traffic for specific sub-domains</em>":</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-6.png" alt="" loading="lazy" width="1311" height="614" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-6.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/image-6.png 1000w, https://doubleagent.net/content/images/2024/04/image-6.png 1311w" sizes="(min-width: 720px) 720px"></figure><p>My take on the above is that in addition to utilizing the Onavo Protect VPN app to intercept traffic for specific domains, there was an intention to rebrand the core technology and having it distributed in other applications. Facebook had <a href="https://techcrunch.com/2013/10/13/facebook-buys-mobile-analytics-company-onavo-and-finally-gets-its-office-in-israel/?ref=doubleagent.net" rel="noreferrer">acquired </a>Onavo for approximately $120M USD in 2013 and needed to put this technology in good use. That price point should give a clear indication on the value they placed on the ability to gain competitor intelligence from people's phones and tablets. </p><p><a href="https://medium.com/@chronic_9612/notes-on-analytics-and-tracking-in-onavo-protect-for-ios-904bdff346c0?ref=doubleagent.net" rel="noreferrer">Prior research</a> on the iOS version notes that the Onavo VPN app was collecting some usage telemetry from iPhones. On Android we can see the app was pulling much more fine grained statistics from their user's devices by utilizing permissions granted under the pretext of showing the user app data usage (we will see how this looked in an embedded video below). But that was not enough, Facebook wanted to take this one step further and intercept encrypted traffic towards specific competitor's analytics domains in order to obtain data on the "<strong>in-app actions"</strong>.</p><p>All they would need to do is to get the user to install a custom certificate into the user's phone's trust store (and be on specific Android releases).</p><div><p>💡</p><div><p>The wiretapping claim is new and perhaps not to be confused with the prior controversy and litigation: </p><p>In 2023, two subsidiaries of Facebook was ordered to pay a total of $20M by the Australian Federal Court for "engaging in conduct liable to mislead in breach of the Australian Consumer Law", according to the <a href="https://www.accc.gov.au/media-release/20m-penalty-for-meta-companies-for-conduct-liable-to-mislead-consumers-about-use-of-their-data?ref=doubleagent.net" rel="noreferrer">ACCC</a>.</p><p>Facebook had shutdown Onavo in 2019 after an <a href="https://techcrunch.com/2019/01/29/facebook-project-atlas/?ref=doubleagent.net" rel="noreferrer">investigation </a>revealed they had been paying teenagers to use the app to track them. Also that year, Apple went as far as to <a href="https://web.archive.org/web/20220609072355/https://www.vox.com/2019/1/30/18203231/apple-banning-facebook-research-app" rel="noreferrer">revoke Facebook's developer program certificates</a>, sending a clear message. </p><p>Despite the apps being taken offline, we are able to find old archived versions which enabled the technical insights offered in this post. </p></div></div><h2 id="technical-analysis">Technical analysis</h2><p>Websites and applications on end user devices trust remote websites or servers over HTTPS/TLS due to public certificates that are stored in the device's trust store. These "certificate authority" certs are the "trust anchor" that applications rely on to verify they communicating with the intended party. These certificates are generally distributed and stored within the operating system. By adding your own self-signed certificate to the appropriate trust store, it is often possible to intercept encrypted TLS traffic. Corporations may also do this as a means of inspecting outbound traffic from employee's devices. Security testers may also do this on their own devices. There are legitimate reasons for doing this. The question here is if what Facebook did was legitimate, meaning, was it legal or not.</p><div><p>There is some irony that the documentation for software that Facebook is said to employ to do the interception contains the following <a href="https://wiki.squid-cache.org/Features/SslBump?ref=doubleagent.net" rel="noreferrer">warning</a>:</p></div><blockquote>HTTPS was designed to give users an expectation of privacy and security. Decrypting HTTPS tunnels without user consent or knowledge may violate ethical norms and may be illegal in your jurisdiction. </blockquote><p>Unlike iOS on the iPhone, Google has made numerous changes to make it extremely difficult to install a CA cert that will be trusted by most applications on the phone. In Android 11, released in September 2020, Google had completely blocked the mechanism which the app used to prompt a user to install the cert and no application would trust any certificate in the user store by default.</p><div><p>💡</p><div><p>People have asked "<i><em>what about cert pinning? wouldn't this have prevented successful MITM of the traffic?</em></i>"</p><p>While that would be the case, as we will see later, at the time, the Snapchat app did not to cert pinning for it's analytics domain. This would likely hold true for the other app domains. So it appears Facebook had leveraged off this technical limitation / oversight by it's competitors.</p></div></div><p>So today, technically speaking, is is simply is not possible to do what Facebook had done back in 2016 to 2019. But it worked - so how did they do it? Fortunately, at least with Android and the Play store ecosystem, we are able to often go back in time and sometimes dig up old Android app packages.</p><p>The first thing is to install the Onavo app on a test handset to see how users would interact with the app.  Despite the VPN connectivity not working and the actual backend service being down, we do get a glimpse on how the application coerces the user into accepting multiple permissions:</p><figure data-kg-thumbnail="https://doubleagent.net/content/media/2024/04/zszPzD8NSHAFb9W1_thumb.jpg" data-kg-custom-thumbnail="">
            <div>
                <video src="https://doubleagent.net/content/media/2024/04/zszPzD8NSHAFb9W1.mp4" poster="https://img.spacergif.org/v1/480x852/0a/spacer.png" width="480" height="852" playsinline="" preload="metadata"></video>
                
                <div>
                        <p>
                        
                        <span>0:00</span></p><p>
                            /<span>0:45</span>
                        </p>
                        </div>
            </div>
            
        <img src="https://doubleagent.net/content/media/2024/04/zszPzD8NSHAFb9W1_thumb.jpg"></figure><p>What we see here under pretext of providing the user 'protection', two particular permissions are of concern:</p><ul><li>Display over other apps</li><li>Access past and deleted app usage</li></ul><blockquote>"<em>We need this permission to show you how much mobile data your apps use.</em>" </blockquote><p>What they didn't explain is that this feature is not so much for the benefit of the user who installed the app, but actually Onavo/Facebook. And this type of information is valuable, to the tune of $120M (what FB paid in the acquisition).</p><figure><img src="https://pbs.twimg.com/media/GJpCkIEbkAAsckm?format=jpg&amp;name=small" alt="Image" loading="lazy" width="486" height="680"></figure><p>The Android manifest includes the <code>uses-permission</code> directive <code>android.permission.PACKAGE_USAGE_STATS</code> which is what we are agreeing to in the screenshot above:</p><figure><img src="https://pbs.twimg.com/media/GJptvfla8AA0rVZ?format=png&amp;name=medium" alt="Image" loading="lazy" width="903" height="412"></figure><p>Continuing with the "application stats" feature (assumed to be the original core functionality), we can dump the schema of the local database on the handset to get an idea on exactly what it was collecting on the device itself:</p><figure><img src="https://pbs.twimg.com/media/GJpyTakbIAAeD_A?format=png&amp;name=large" alt="Image" loading="lazy" width="1882" height="460"></figure><p>Mostly it seems they could just obtain statistics on in app usage of other applications and of course the network traffic usage for the apps. It's still somewhat high level statistics and clearly not enough granularity for what Mark was after, implied by one of the emails in the court documents. Intercepting the actual encrypted traffic towards the analytics domains of various competitors on the other hand, would do the trick. And to do this, Facebook would have to get a CA certificate somehow on the device.</p><p>But we don't see any prompt to install any certificate. This is because the VPN did not successfully connect to the remote service, which appears to be precondition. Time or interest permitting, I may go back to figure out how to trigger the certificate installation prompt.</p><figure><img src="https://doubleagent.net/content/images/2024/04/GJo--s8aQAAYwtL.png" alt="" loading="lazy" width="1062" height="365" srcset="https://doubleagent.net/content/images/size/w600/2024/04/GJo--s8aQAAYwtL.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/GJo--s8aQAAYwtL.png 1000w, https://doubleagent.net/content/images/2024/04/GJo--s8aQAAYwtL.png 1062w" sizes="(min-width: 720px) 720px"><figcaption><span>Connections timing out, and a tcpdump shows that all traffic from the device is dropped after the VPN connection is initiated</span></figcaption></figure><h3 id="onto-the-ca-certificates">Onto the CA certificates</h3><p>Decompiling the app, we do see the functionality is there. In the following image, the method highlighted calls <code>KeyChain.createInstallIntent()</code> to install a certificate. Here a popup would appear asking the user for permission, with the name "Facebook Research"</p><figure><img src="https://doubleagent.net/content/images/2024/04/GJpP7rmaAAAQDKI.png" alt="" loading="lazy" width="680" height="424" srcset="https://doubleagent.net/content/images/size/w600/2024/04/GJpP7rmaAAAQDKI.png 600w, https://doubleagent.net/content/images/2024/04/GJpP7rmaAAAQDKI.png 680w"></figure><p><code>KeyChain.createInstallIntent()</code> <a href="https://commonsware.com/R/pages/chap-security-004.html?ref=doubleagent.net" rel="noreferrer">stopped working</a> in Android 7 (Nougat). A user would have to manually install the certificate. It would no longer be possible to have Facebook's CA cert installed directly in the app.</p><p>Another notable change in Android 7 - According to the <a href="https://developer.android.com/privacy-and-security/security-config?ref=doubleagent.net" rel="noreferrer">Android documentation</a> (emphasis mine):</p><blockquote>By default, secure connections (using protocols like TLS and HTTPS) from all apps trust the pre-installed system CAs, and <strong>apps targeting Android 6.0 (API level 23) and lower also trust the user-added CA store by default</strong></blockquote><p>In other words, it appears other apps would have trusted certs in the user store from Android Marshmallow (Android 6) and below, but from Android 7, released in August 22, 2016, they would no longer be trusted at all by other applications, unless due to a security configuration in the app's manifest file.</p><p>Another  improvement to Android in version 7 was that it was made impossible to install certificates into the system store by <em>any</em> means except by fully rooting the device. </p><p>Regardless, the functionality remained in both the older version and newer, all the way to the last published app in 2019. The actual MITM certificate was removed in 2017. Detail in the court documents may offer plausible explanation:</p><blockquote>Where is the key generated that's used for the SSL bump and how it protected from abuse? (e.g., is generated on the device, specific to that device, and never leaves the device, or is there a shared key that's downloaded with the app and installed)<p><strong>The certificate is generated on the server and being sent to the device</strong></p></blockquote><figure><img src="https://doubleagent.net/content/images/2024/04/image-15.png" alt="" loading="lazy" width="933" height="104" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-15.png 600w, https://doubleagent.net/content/images/2024/04/image-15.png 933w" sizes="(min-width: 720px) 720px"><figcaption><span>Page 3 - Case 3:20-cv-08570-JD Document 736</span></figcaption></figure><p>So we need to go back to much older releases before 2019, specifically a version from September 2017. The certificates in this version are found as assets named "<code>old_ca.cer</code>" and "<code>new_ca.cer</code>". The relevant code is found in the class <code>ResearchCertificateManager</code>.</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-7.png" alt="" loading="lazy" width="773" height="462" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-7.png 600w, https://doubleagent.net/content/images/2024/04/image-7.png 773w" sizes="(min-width: 720px) 720px"></figure><p>The can be found under the "assets" folder (if uncompressing the .apk as a zip file). Observed in JADX:</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-9.png" alt="" loading="lazy" width="476" height="390"></figure><p>Also observing the routine to check if the certificates have been installed or not:</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-8.png" alt="" loading="lazy" width="1187" height="811" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-8.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/image-8.png 1000w, https://doubleagent.net/content/images/2024/04/image-8.png 1187w" sizes="(min-width: 720px) 720px"></figure><p>Now why would there be two certificates? (old and new)? Here are the two certificates pulled from one version of the app. Whoever had created the first certificate had only issued it to be valid for one year. If this was an oversight, they did manage to figure it out before the expiry time. </p><figure><div><p><img src="https://doubleagent.net/content/images/2024/04/GJq8BYsbUAAiREe.png" width="680" height="500" loading="lazy" alt="" srcset="https://doubleagent.net/content/images/size/w600/2024/04/GJq8BYsbUAAiREe.png 600w, https://doubleagent.net/content/images/2024/04/GJq8BYsbUAAiREe.png 680w"></p><p><img src="https://doubleagent.net/content/images/2024/04/GJq8JjeaAAA59Ec.png" width="680" height="533" loading="lazy" alt="" srcset="https://doubleagent.net/content/images/size/w600/2024/04/GJq8JjeaAAA59Ec.png 600w, https://doubleagent.net/content/images/2024/04/GJq8JjeaAAA59Ec.png 680w"></p></div><figcaption><p><span>old_va.cer vs new_ca.cer</span></p></figcaption></figure><p>I have not been able to find all versions of the .apk online, but enough to draw the following conclusion:</p><ul><li>The first certificate was valid from Sep 8th 2016, some months before Mark Zuckerberg put the call out to gain further insight into Snapchat (email dated June 9th, 2016)</li><li>The second certificate was added alongside the first which was valid from Jun 8th, 2017. It will be valid until Jun 8 2027.</li><li>At least from Oct 19th, 2027, there are no certs, the second cert was deleted from the app completely. As stated earlier, court documents explain certificates were obtained from the server. I have yet to locate the functionality relevant to this in the apps I have obtained from <a href="https://apkpure.com/onavo-protect-from-facebook/com.onavo.spaceship?ref=doubleagent.net" rel="noreferrer">archives</a>, and more work needs to be done here.</li></ul><p>Versions with certificates found with their respective fingerprints:  </p><figure><img src="https://pbs.twimg.com/media/GJrEPLeaEAAhjQM?format=png&amp;name=900x900" alt="Image" loading="lazy" width="745" height="208"></figure><p>The court documents state that there was additional interception of YouTube and Amazon at later dates. Here we would have to dig further to find out in which apps and how this was done:</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-12.png" alt="" loading="lazy" width="1345" height="387" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-12.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/image-12.png 1000w, https://doubleagent.net/content/images/2024/04/image-12.png 1345w" sizes="(min-width: 720px) 720px"><figcaption><span>Page 2, case 3:20-cv-08570-JD Document 735</span></figcaption></figure><h3 id="back-to-the-pinning-question">Back to the pinning question</h3><p>Any app doing full certificate pinning would have prevented this technique from working.  Around the time period in question, Snapchat was doing some certificate pinning. But not everywhere.</p><p>We can go back and grab an old Snapchat app and check for ourselves. What was the domain? According to one the artefacts in the document discovery, it was <code>sc-analytics.appspot.com</code>:</p><figure><img src="https://pbs.twimg.com/media/GKBeIsTbgAAdHpH?format=png&amp;name=small" alt="Image" loading="lazy" width="613" height="430"></figure><p>And behold, in a decompilation of and old Snapchat app, traffic to this domain did not use certificate pinning:</p><figure><img src="https://pbs.twimg.com/media/GKBnQNdb0AA2M8t?format=png&amp;name=medium" alt="Image" loading="lazy" width="1075" height="402"></figure><p>As discussed earlier, Facebook were aware of the security enhancements in Android and the wider adoption of pinning, with the statement included (reference earlier):</p><blockquote>There is a general question on SSL bump long term applicability on Android as SSL pinning by default is present on newer devices.</blockquote><h2 id="what-else">What else?</h2><p>This one caught my eye, a request to obtain the <a href="https://en.wikipedia.org/wiki/International_mobile_subscriber_identity?ref=doubleagent.net" rel="noreferrer">subscriber IMSI</a>. A very sensitive bit of data indeed: </p><figure><img src="https://pbs.twimg.com/media/GJp7AoJaQAA5E-N?format=png&amp;name=medium" alt="Image" loading="lazy" width="1031" height="309"></figure><p>Initially I was wondering how this is even possible, and it seems at the time, it was actually possible with the permission <code>READ_PHONE_STATE</code>:</p><figure><img src="https://pbs.twimg.com/media/GJqOvKmbwAAmL_p?format=png&amp;name=medium" alt="Image" loading="lazy" width="942" height="273"></figure><p>Which of course was defined in the app's manifest:</p><figure><img src="https://doubleagent.net/content/images/2024/04/image-10.png" alt="" loading="lazy" width="1679" height="449" srcset="https://doubleagent.net/content/images/size/w600/2024/04/image-10.png 600w, https://doubleagent.net/content/images/size/w1000/2024/04/image-10.png 1000w, https://doubleagent.net/content/images/size/w1600/2024/04/image-10.png 1600w, https://doubleagent.net/content/images/2024/04/image-10.png 1679w" sizes="(min-width: 720px) 720px"></figure><p>Given this discovery, there is probably more to explore.</p><h2 id="wrapping-up">Wrapping up</h2><p>While this is all "old news" in the sense that happened years ago, it is interesting from a technical standpoint to see how far application developers, and even companies like Facebook will go to abuse permission models on mobile phones.</p><p>And there is certainly is more to dig into, such as the routine to trigger the CA install procedure, how certs were added after 2017 and what else the Onavo application was collecting. Also, it would also be nice to find iPhone version of the application if anyone knows where to find copies.</p><p> If the class action lawsuit progresses in an interesting way, perhaps this could provide further motivation to continue the exploration. </p><p>If you are interested in receiving further updates, feel free to subscribe below with an email address, and/or follow me on <a href="https://twitter.com/haxrob?ref=doubleagent.net" rel="noreferrer">X</a>.  </p>
    </section></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Plan 9 is a uniquely complete operating system (145 pts)]]></title>
            <link>https://posixcafe.org/blogs/2024/07/27/0/</link>
            <guid>41090222</guid>
            <pubDate>Sat, 27 Jul 2024 23:52:32 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://posixcafe.org/blogs/2024/07/27/0/">https://posixcafe.org/blogs/2024/07/27/0/</a>, See on <a href="https://news.ycombinator.com/item?id=41090222">Hacker News</a></p>
<div id="readability-page-1" class="page"><article>

<p>A large contributor to the "feel" of an Operating System comes from the software it chooses to include by default. There are entire linux distributions that differentiate themselves just based on the default configured software. There is room for so many options of base software because there are in general many different options to pick. Linux being just a kernel itself specifically creates an environment which encourages this (to some extent). This is both a blessing and a curse, for people wanting to write software targeting linux there now is some matrix of options they must test under if they want it to work with all the various software choices. BSD systems, unlike Linux, tend to include more than just a kernel by default, generally including some "blessed" c library, c compiler, libraries and programs. This makes targeting the system a bit easier, in the sense that you can assume there is a larger set of software on a BSD machine than you could with some system that uses a Linux kernel. Even with BSD however, not all of the software is in control of those in charge of the system itself, there is still a large amount of shared code between these systems for things like the c compiler. There are some pros and cons to this situation. On the plus side these systems get to reap the benefits of the work put in to these other projects (gnu, llvm, and so on), but this also does lead to there being some differences in design. Put in another way, if someone wanted the ability to touch every line of code (in the upstream sense), they would have to be a member of some non trivial amount of communities.</p>
<p>Plan 9 is unique in this sense that everything the system needs is covered by the base install. This includes the compilers, graphical environment, window manager, text editors, ssh client, torrent client, web server, and the list goes on. Nearly everything a user can do with the system is available right from the get go. I think this is super important for a couple of reasons:</p>
<ul>
<li>
Everything is one monorepo, a single commit hash communicates your entire kernel and user space state.
</li><li>
There is a consistency of design between all the code in the system.
</li><li>
There is no matrix of configurations to test your software against.
</li><li>
Programs can assume the presence of a fairly large collection of software.
</li><li>
There is an encouragement to write new software that adapts to the Plan 9 style instead of importing existing software.
</li>
</ul>
<p>There are of course some downsides to this approach as well:</p>
<ul>
<li>
The Plan 9 implementations tend to not be as feature rich as the proper upstream variants.
</li><li>
There is a larger barrier to entry when adding new programs or features to the system.
</li><li>
In general the system becomes somewhat isolated from the general flow of software outside of it.
</li>
</ul>
<p>I generally like to think the pros outweight the cons, but I do acknowledge this design is part of the reason why Plan 9 has generally been stuck as just a hobbyist curiosity.</p>
<p>It is important to highlight this difference because I think in general people are not aware of the amount of independent implementations that have been written for 9front as part of following this design. There is no other system that provides this many examples of its own interfaces, that are by themselves generally useful programs.</p>
<p>Some examples I'm fond of:</p>
<ul>
<li>
<a href="http://git.9front.org/plan9front/plan9front/520d698c3e9ec8f76923965481aa15862f9f3c81/sys/src/cmd/ssh.c/f.html">ssh</a>
</li><li>
<a href="http://git.9front.org/plan9front/plan9front/520d698c3e9ec8f76923965481aa15862f9f3c81/sys/src/cmd/git/f.html">git</a>
</li><li>
<a href="http://git.9front.org/plan9front/plan9front/520d698c3e9ec8f76923965481aa15862f9f3c81/sys/src/cmd/ip/torrent.c/f.html">torrent client</a>
</li><li>
<a href="http://git.9front.org/plan9front/plan9front/520d698c3e9ec8f76923965481aa15862f9f3c81/sys/src/cmd/ktrans/f.html">Japanese, Korean &amp; Chinese IME</a>
</li><li>
<a href="http://git.9front.org/plan9front/plan9front/520d698c3e9ec8f76923965481aa15862f9f3c81/sys/src/cmd/ip/cifsd/f.html">SMB server</a>
</li><li>
<a href="http://git.9front.org/plan9front/plan9front/520d698c3e9ec8f76923965481aa15862f9f3c81/sys/src/cmd/ip/tinc.c/f.html">tinc VPN</a>
</li>
</ul>
<p>Specifically because of this design, Plan 9 becomes an excellent learning resource for anything that it supports. It becomes a sandbox for individuals to learn and experiment with any topic of operating systems. In these regards I do think that Plan 9 is a truly unique collection of software.</p>
<p>If by some chance this writing interested you in the Plan 9, I encourage you to download the 9front iso and give it a go. As of the time of this writing the amd64 <a href="http://9front.org/releases/2024/04/28/0/">release iso</a> is a measily 467M and includes everything I've talked about.</p>

</article></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Intel N100 Radxa X4 First Thoughts (159 pts)]]></title>
            <link>https://bret.dk/intel-n100-radxa-x4-first-thoughts/</link>
            <guid>41089911</guid>
            <pubDate>Sat, 27 Jul 2024 22:51:57 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://bret.dk/intel-n100-radxa-x4-first-thoughts/">https://bret.dk/intel-n100-radxa-x4-first-thoughts/</a>, See on <a href="https://news.ycombinator.com/item?id=41089911">Hacker News</a></p>
<div id="readability-page-1" class="page"><div id="penci-post-entry-inner">
<p>It only feels like the beginning of the week since Radxa announced their Intel N100-based Radxa x4 Single Board Computer and thanks to the wonders of express global shipping, I’ve had one in my hands since lunchtime.</p>
<figure><picture><source srcset="https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5-1024x738.png.webp 1024w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5-300x216.png.webp 300w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5-150x108.png.webp 150w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5-768x553.png.webp 768w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5-1170x843.png.webp 1170w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5-585x421.png.webp 585w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-5.png.webp 1244w" sizes="(max-width: 1024px) 100vw, 1024px" type="image/webp"><img fetchpriority="high" decoding="async" width="1024" height="738" src="https://bret.dk/wp-content/uploads/2024/07/image-5-1024x738.png" data-src="https://bret.dk/wp-content/uploads/2024/07/image-5-1024x738.png" alt="Radxa x4 - the Intel N100 underneath that powers the board" title="Intel N100 Radxa X4 First Thoughts 18" data-srcset="https://bret.dk/wp-content/uploads/2024/07/image-5-1024x738.png 1024w, https://bret.dk/wp-content/uploads/2024/07/image-5-300x216.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-5-150x108.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-5-768x553.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-5-1170x843.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-5-585x421.png 585w, https://bret.dk/wp-content/uploads/2024/07/image-5.png 1244w" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://bret.dk/wp-content/uploads/2024/07/image-5-1024x738.png 1024w, https://bret.dk/wp-content/uploads/2024/07/image-5-300x216.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-5-150x108.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-5-768x553.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-5-1170x843.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-5-585x421.png 585w, https://bret.dk/wp-content/uploads/2024/07/image-5.png 1244w"></picture></figure>
<p>It’s the first time in a long, long time that I find myself being excited about an SBC and I feel it’s for a good reason? Here we have a (more or less) Raspberry Pi 5 form factor board with an x86 processor, the Intel N100. This means that I was able to grab the Windows 11 ISO and install it. I was able to go to Debian’s homepage, grab the latest ISO and just, well, install it?</p>
<p>I’m going to try something slightly different though and rather than slam you with 20 graphs, I’m going to approach it more as if you were asking me what I thought about it face-to-face. I’ll include some data, but it’s going to be my first thoughts upon opening and playing with the Radxa x4 first and foremost. It may get a little rambly but you all expect that from me at this point.</p>
<div id="penci-toc-container">

<nav><ul><li><a href="#Radxa-x4-Specifications" title="Radxa x4 Specifications">Radxa x4 Specifications</a></li><li><a href="#Out-of-the-Box" title="Out of the Box">Out of the Box</a></li><li><a href="#Initial-Setup" title="Initial Setup">Initial Setup</a><ul><li><a href="#BIOS" title="BIOS">BIOS</a></li><li><a href="#Debian-12-Bookworm" title="Debian 12 (Bookworm)">Debian 12 (Bookworm)</a></li><li><a href="#Windows-11" title="Windows 11">Windows 11</a></li></ul></li><li><a href="#Quick-Tests" title="Quick Tests">Quick Tests</a><ul><li><a href="#Geekbench-6-for-Windows" title="Geekbench 6 for Windows">Geekbench 6 for Windows</a></li><li><a href="#Networking" title="Networking">Networking</a></li><li><a href="#Power-Draw" title="Power Draw">Power Draw</a></li><li><a href="#Temperatures" title="Temperatures">Temperatures</a></li><li><a href="#Power-over-Ethernet" title="Power over Ethernet">Power over Ethernet</a></li></ul></li><li><a href="#Summary" title="Summary">Summary</a></li></ul></nav></div>
<h2><span id="Radxa-x4-Specifications">Radxa x4 Specifications</span></h2>
<p>As a quick overview, the Radxa x4 offers the following:</p>
<ul>
<li>Intel N100 CPU (4 Alderlake CPU cores, up to 3.4GHz)</li>
<li>Intel UHD Graphics (750MHz)</li>
<li>4/8/12/16GB LPDDR5 4786MT/s</li>
<li>2.5Gbit RJ45 Ethernet (with PoE support via HAT)</li>
<li>M.2 M-Key connection for M.2 2230 NVMe drives</li>
<li>12V USB-C Power Delivery Input</li>
<li>3x USB-A 3.2 (10Gbps) ports, 1x USB-A 2.0</li>
<li>WiFi 5 &amp; BT5, or WiFi 6 &amp; BT5.2 (the latter on 8GB RAM models and up)</li>
<li>2x Micro HDMI (up to 4K60)</li>
<li>Raspberry Pi RP2040 to control the 40-pin GPIO headers</li>
<li>Fan &amp; RTC Battery headers</li>
<li>3.5mm Headphone &amp; Microphone Jack</li>
<li>eMMC is available either to solder yourself or when you order a SKU that includes it</li>
</ul>
<p>The inclusion of the RP2040 for the GPIO header control is a great move. Long before I wrote the <a href="https://bret.dk/intel-n100-a-challenge-to-arm/" data-type="post" data-id="4921">ARM vs N100</a> piece (comparing an RK3588 to an Intel 100 Mini PC) during the Raspberry Pi shortages everyone was screaming “Just buy a mini PC!!!” but that really didn’t help anyone who wanted or needed to interface with the Raspberry Pi’s GPIO for their projects. Now, you have the best of both worlds but will Radxa nurture the product and ecosystem in a way that will pose a legitimate thread to those on the fence about the Raspberry Pi 5?</p>
<h2><span id="Out-of-the-Box">Out of the Box</span></h2>
<p>I received my package with the Radxa x4, its PoE+ HAT (there’s a new, specific HAT for the x4), and the case/cooler hybrid they’ve got going on and there was a fun mix of packaging. I definitely prefer when vendors ship in plastic cases (sorry, I know) as they’re much more suited to stacking in my storage shelves.</p>
<p>Everything was as I expected inside. The case/cooler came with a thermal pad (more on that later) and 2 feet sticker things so you don’t have to have metal directly on a surface, the PoE HAT has standoffs pre-applied with extras in a bag, and the x4 board came with a pre-installed RTC battery and 2 WiFi antennas.</p>
<figure><picture><source srcset="https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-768x1024.png.webp 768w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-225x300.png.webp 225w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-113x150.png.webp 113w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1152x1536.png.webp 1152w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1170x1560.png.webp 1170w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-585x780.png.webp 585w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image.png.webp 1536w" sizes="(max-width: 768px) 100vw, 768px" type="image/webp"><img decoding="async" width="768" height="1024" src="https://bret.dk/wp-content/uploads/2024/07/image-768x1024.png" data-src="https://bret.dk/wp-content/uploads/2024/07/image-768x1024.png" alt="Radxa x4, Cooler, and PoE+ HAT packaging" title="Intel N100 Radxa X4 First Thoughts 19" data-srcset="https://bret.dk/wp-content/uploads/2024/07/image-768x1024.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-225x300.png 225w, https://bret.dk/wp-content/uploads/2024/07/image-113x150.png 113w, https://bret.dk/wp-content/uploads/2024/07/image-1152x1536.png 1152w, https://bret.dk/wp-content/uploads/2024/07/image-1170x1560.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-585x780.png 585w, https://bret.dk/wp-content/uploads/2024/07/image.png 1536w" sizes="(max-width: 768px) 100vw, 768px" srcset="https://bret.dk/wp-content/uploads/2024/07/image-768x1024.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-225x300.png 225w, https://bret.dk/wp-content/uploads/2024/07/image-113x150.png 113w, https://bret.dk/wp-content/uploads/2024/07/image-1152x1536.png 1152w, https://bret.dk/wp-content/uploads/2024/07/image-1170x1560.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-585x780.png 585w, https://bret.dk/wp-content/uploads/2024/07/image.png 1536w"></picture></figure>
<h2><span id="Initial-Setup">Initial Setup</span></h2>
<p>For this post I’ve been using the official Pi 5 PSU (it offers 2.25A at 12V) and a WD_BLACK SN770M 2230 M.2 NVMe drive.</p>
<h3><span id="BIOS">BIOS</span></h3>
<p>I was fully expecting a BIOS offering 2-3 pages with 5 options per page given my experience with mini PCs (also rocking N100 CPUs) but upon first boot and jumping into the BIOS I was very pleasantly surprised. The screenshot below shows the American Megatrends BIOS built in April 2024, so really quite new!</p>
<figure><img decoding="async" width="960" height="540" src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main.jpg" data-src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main.jpg" alt="Radxa x4 - Main BIOS Page" title="Intel N100 Radxa X4 First Thoughts 20" data-srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-585x329.jpg 585w" sizes="(max-width: 960px) 100vw, 960px" srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_main-585x329.jpg 585w"></figure>
<figure><img decoding="async" width="960" height="540" src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced.jpg" data-src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced.jpg" alt="Radxa x4 - Advanced BIOS Page" title="Intel N100 Radxa X4 First Thoughts 21" data-srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-585x329.jpg 585w" sizes="(max-width: 960px) 100vw, 960px" srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced-585x329.jpg 585w"></figure>
<figure><img decoding="async" width="960" height="540" src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot.jpg" data-src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot.jpg" alt="Radxa x4 - Boot BIOS Page" title="Intel N100 Radxa X4 First Thoughts 22" data-srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-585x329.jpg 585w" sizes="(max-width: 960px) 100vw, 960px" srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_boot-585x329.jpg 585w"></figure>
<p>If you dig a little deeper into the options, you’ll find you have the ability to really tweak the settings for most aspects of the system. I’ve included a preview of the CPU Power Management page, and the NVMe information/configuration page, but there are quite a few more!</p>
<figure><img decoding="async" width="960" height="540" src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management.jpg" data-src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management.jpg" alt="Radxa x4 - Advanced CPU Power Management BIOS Page" title="Intel N100 Radxa X4 First Thoughts 23" data-srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-585x329.jpg 585w" sizes="(max-width: 960px) 100vw, 960px" srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_cpu_power_management-585x329.jpg 585w"></figure>
<figure><img decoding="async" width="960" height="540" src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info.jpg" data-src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info.jpg" alt="Radxa x4 - Advanced NVMe Storage Configuration BIOS Page" title="Intel N100 Radxa X4 First Thoughts 24" data-srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-585x329.jpg 585w" sizes="(max-width: 960px) 100vw, 960px" srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_bios_advanced_nvme_info-585x329.jpg 585w"></figure>
<h3><span id="Debian-12-Bookworm">Debian 12 (Bookworm)</span></h3>
<p>I gave Debian a try first to see how things went and it was fairly uneventful. You just need to grab the relevant ISO (I took the net install option) and go through the installation process. I opted for GNOME as my desktop environment to look around and it was responsive, with most things working as expected.</p>
<p>The 2.5GbE network connection (supplied by an Intel I226-V NIC) was detected during installation, however, WiFi/BT wasn’t and that carried on once into the OS. WiFi drivers are always a bit picky though.</p>
<p>A <a href="https://www.youtube.com/watch?v=LXb3EKWsInQ&amp;pp=ygUINGsgdmlkZW8%3D" data-type="link" data-id="https://www.youtube.com/watch?v=LXb3EKWsInQ&amp;pp=ygUINGsgdmlkZW8%3D" target="_blank" rel="noopener">4K 60fps “HDR” video</a> in the included Firefox ran extremely smoothly (in my opinion) with around 40 frames dropped during the 5min13s video. These were barely noticeable and the Radxa x4 happily chugged along. A quick try on Windows showed much the same in terms of minimal dropped frames.</p>
<p>I didn’t spend much more time in Debian as I wanted to see how Windows 11 would fare. Sorry, not sorry.</p>
<h3><span id="Windows-11">Windows 11</span></h3>
<p>You’ll need to create a Windows media installation via their tool on another computer (or create installation media however you like) to get up and running but it’s quick and easy, and within a couple of minutes I had the Windows installation running nice and smoothly.</p>
<figure><img decoding="async" width="960" height="540" src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network.jpg" data-src="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network.jpg" alt="Radxa x4 - Windows Installation finds no network drivers" title="Intel N100 Radxa X4 First Thoughts 25" data-srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-585x329.jpg 585w" sizes="(max-width: 960px) 100vw, 960px" srcset="https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network.jpg 960w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-300x169.jpg 300w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-150x84.jpg 150w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-768x432.jpg 768w, https://bret.dk/wp-content/uploads/2024/07/radxa_x4_windows_installation_no_network-585x329.jpg 585w"><figcaption>Uh oh..</figcaption></figure>
<p>That is until we reached the network detection part where it was immediately apparent that there were no suitable network drivers within the default Windows installation media. Bit of a bummer, but if you hit SHIFT+F10 you’ll bring up a prompt that you can enter <code>OOBE\BYPASSNRO</code> in and hit enter. Once done, the installer will restart and when you get back to the network page it will offer you the option to skip without an internet connection.</p>
<p>Once you’re finally in Windows though, you’ll want to address the network driver issue. Luckily, <a href="https://www.intel.com/content/www/us/en/download/15084/intel-ethernet-adapter-complete-driver-pack.html" target="_blank" rel="noopener">Intel’s driver page</a> has everything you need and you can download those on another device and copy them across with a USB drive or similar. When installed, you have yourself a little x4 ready to take on the world.</p>
<h2><span id="Quick-Tests">Quick Tests</span></h2>
<h3><span id="Geekbench-6-for-Windows">Geekbench 6 for Windows</span></h3>
<p>I’m not going to go through a full benchmarking suite here, but as I had Windows open, I thought I’d see how Geekbench 6 was looking. On the CPU side, we ended up with a 1007 single-core and a 2295 multi-core score. For the Intel GPU, we saw 3246 for OpenCL and 3710 on Vulkan.</p>
<p>A note for this section though, by default (and after changing the power plan) the maximum CPU frequency, even on single-core workloads was 2.9GHz. I likely need to dig into the BIOS a little more and make some changes to get the N100 running at its full speed. As a quick side note, changing the PL2 values to 6W from 25W made no difference for this benchmark and when run on Ubuntu, it got up to 3.1GHz and posted 1171 on single-core, and 2389 multi-core.</p>
<h3><span id="Networking">Networking</span></h3>
<p>iperf3 between the Radxa x4 (on Windows) and my ROCK 5B (Debian) manages to saturate the 2.5Gbps connection in both directions so everything’s looking good there. WiFi didn’t install via Windows Update, nor was I able to quickly find a suitable driver so for this first thoughts post, WiFi gets a thumbs down, I’ll have to look into that later.</p>
<p>On Ubuntu though the WiFi chip shows up as a Realtek RTL8852BE adapter and worked during the Ubuntu installation process.</p>
<figure><picture><source srcset="https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1.png.webp 904w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1-300x122.png.webp 300w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1-150x61.png.webp 150w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1-768x312.png.webp 768w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-1-585x237.png.webp 585w" sizes="(max-width: 904px) 100vw, 904px" type="image/webp"><img decoding="async" width="904" height="367" src="https://bret.dk/wp-content/uploads/2024/07/image-1.png" data-src="https://bret.dk/wp-content/uploads/2024/07/image-1.png" alt="Radxa x4 - iperf3 2.5GbE Results" title="Intel N100 Radxa X4 First Thoughts 26" data-srcset="https://bret.dk/wp-content/uploads/2024/07/image-1.png 904w, https://bret.dk/wp-content/uploads/2024/07/image-1-300x122.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-1-150x61.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-1-768x312.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-1-585x237.png 585w" sizes="(max-width: 904px) 100vw, 904px" srcset="https://bret.dk/wp-content/uploads/2024/07/image-1.png 904w, https://bret.dk/wp-content/uploads/2024/07/image-1-300x122.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-1-150x61.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-1-768x312.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-1-585x237.png 585w"></picture></figure>
<h3><span id="Power-Draw">Power Draw</span></h3>
<p>Under Windows 11 at idle with the default BIOS power settings (so the default power targets and Intel Speedstep enabled etc) I’m pulling <strong>8 watts</strong> from the wall. This is with a basic keyboard, a Razer Deathadder (which does have an LED), 1x HDMI, 2.5GbE networking, and the WD_BLACK SN770M 500GB NVMe SSD.</p>
<p>If I yank out everything bar the power cable, idle power utilisation drops to around <strong>6.8 watts</strong>, so you can save 1.2 watts if you want to run it headless I suppose?</p>
<p>If I then stress the Intel N100 and its GPU with OCCT and the Power Configuration tester (it stresses the CPU, RAM and GPU all at once) it quickly jumps to <strong>27.3 watts</strong> and then drops down, likely because that’s at the limit of what the 12V/2.25A PSU (the official Raspberry Pi 5 PSU) can offer so for future testing, I’ll need to give it a slightly beefier power supply and see what it does. Stressing just the CPU and RAM results in <strong>22.1 watts</strong> of power draw.</p>
<h3><span id="Temperatures">Temperatures</span></h3>
<p>To cover the question I saw a few times on Twitter when it was announced, no, I’m going to recommend that you don’t leave the CPU open to the world and run it raw. The whole thing gets extremely hot, extremely quickly and the only way you’re going to be able to keep it somewhat under control is if you heavily throttle its power targets, in which case, what’s the point? You could probably make do with an ARM chip if that’s the plan.</p>
<p>Fortunately, I have the Radxa 4x Cooler/Case combo. It’s not strictly a case as it has open sides and an open bottom but it keeps it off the surface where you’ve placed it and it has a fan which is nice.</p>
<p>Unfortunately, the thermal pad was crumbling and ripping when I tried to apply it and I have no idea if that’s supposed to be normal or not? I was told that the thermal pad was rated for 13.8 watts, though I don’t think it’s quite enough for this setup. Perhaps things would be better when I figure out how to get the fan to operate from behind the RP2040.</p>
<figure><picture><source srcset="https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3-1024x767.png.webp 1024w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3-300x225.png.webp 300w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3-150x112.png.webp 150w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3-768x575.png.webp 768w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3-1170x876.png.webp 1170w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3-585x438.png.webp 585w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-3.png.webp 1482w" sizes="(max-width: 1024px) 100vw, 1024px" type="image/webp"><img decoding="async" width="1024" height="767" src="https://bret.dk/wp-content/uploads/2024/07/image-3-1024x767.png" data-src="https://bret.dk/wp-content/uploads/2024/07/image-3-1024x767.png" alt="Radxa x4 - Cooler's Thermal Pad" title="Intel N100 Radxa X4 First Thoughts 27" data-srcset="https://bret.dk/wp-content/uploads/2024/07/image-3-1024x767.png 1024w, https://bret.dk/wp-content/uploads/2024/07/image-3-300x225.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-3-150x112.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-3-768x575.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-3-1170x876.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-3-585x438.png 585w, https://bret.dk/wp-content/uploads/2024/07/image-3.png 1482w" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://bret.dk/wp-content/uploads/2024/07/image-3-1024x767.png 1024w, https://bret.dk/wp-content/uploads/2024/07/image-3-300x225.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-3-150x112.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-3-768x575.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-3-1170x876.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-3-585x438.png 585w, https://bret.dk/wp-content/uploads/2024/07/image-3.png 1482w"></picture></figure>
<p>I’ll revisit this topic in the follow-up piece but at first glance, I can actually see light between the board/thermal pad/cooler in places so that pad feels like it’s either slightly too thin or something’s happened to the pad that I have here and that hampers cooling.</p>
<h3><span id="Power-over-Ethernet">Power over Ethernet</span></h3>
<p>One of the selling points of this SBC was that the 2.5GbE port was PoE-compatible with a HAT, to the point where Radxa made a modified version of their PoE+ HAT to work specifically with the x4. After finding my go-to cable wouldn’t do power and networking, I found one that worked and booted up fine. The second I hit it with a benchmark load it reset. Thinking the Power Limit 2 (PL2) may have been the problem with it set to 25W, I dropped it to 15W but nope, same problem.</p>
<figure><picture><source srcset="https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4-1024x917.png.webp 1024w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4-300x269.png.webp 300w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4-150x134.png.webp 150w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4-768x688.png.webp 768w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4-1170x1048.png.webp 1170w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4-585x524.png.webp 585w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-4.png.webp 1246w" sizes="(max-width: 1024px) 100vw, 1024px" type="image/webp"><img decoding="async" width="1024" height="917" src="https://bret.dk/wp-content/uploads/2024/07/image-4-1024x917.png" data-src="https://bret.dk/wp-content/uploads/2024/07/image-4-1024x917.png" alt="Radxa x4 PoE+ HAT (Power over Ethernet)" title="Intel N100 Radxa X4 First Thoughts 28" data-srcset="https://bret.dk/wp-content/uploads/2024/07/image-4-1024x917.png 1024w, https://bret.dk/wp-content/uploads/2024/07/image-4-300x269.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-4-150x134.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-4-768x688.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-4-1170x1048.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-4-585x524.png 585w, https://bret.dk/wp-content/uploads/2024/07/image-4.png 1246w" sizes="(max-width: 1024px) 100vw, 1024px" srcset="https://bret.dk/wp-content/uploads/2024/07/image-4-1024x917.png 1024w, https://bret.dk/wp-content/uploads/2024/07/image-4-300x269.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-4-150x134.png 150w, https://bret.dk/wp-content/uploads/2024/07/image-4-768x688.png 768w, https://bret.dk/wp-content/uploads/2024/07/image-4-1170x1048.png 1170w, https://bret.dk/wp-content/uploads/2024/07/image-4-585x524.png 585w, https://bret.dk/wp-content/uploads/2024/07/image-4.png 1246w"></picture></figure>
<p>Was my 2.5Gbit PoE switch to blame? It was a no-name unit from AliExpress, so possibly? I switched (hehe) over to my UniFi PoE switch to see if that changed anything and what do you know, it was able to handle the spike just fine with the PL2 set to 15W. Would the cheap PoE switch handle it if it was set to 6W? It does, so that’s good to know!</p>
<h2><span id="Summary">Summary</span></h2>
<p>Overall, I still think it’s a very good product but it has things that need to be looked at and that will likely be covered by documentation that (I hope) will be on the way soon.</p>
<p>For the most part everything is working as expected. You have the ease of using whichever ISO you can find (though you may have a couple of driver issues to work around depending on what OS you’re looking to use. The cooler leaves a little to be desired, and when you have the PoE HAT installed too, your poor NVMe drive has around 1-2mm between it and the WiFi chip below, and then 3-4mm between it and the HAT above. When I get the fan on the HAT working this will alleviate a little of that pain.</p>
<div>
<figure><picture><source srcset="https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-2.png.webp 570w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-2-300x63.png.webp 300w, https://bret.dk/wp-content/webp-express/webp-images/uploads/2024/07/image-2-150x31.png.webp 150w" sizes="(max-width: 570px) 100vw, 570px" type="image/webp"><img decoding="async" width="570" height="119" src="https://bret.dk/wp-content/uploads/2024/07/image-2.png" data-src="https://bret.dk/wp-content/uploads/2024/07/image-2.png" alt="Radxa x4 - WD_BLACK SN770M getting hot with no airflow" title="Intel N100 Radxa X4 First Thoughts 29" data-srcset="https://bret.dk/wp-content/uploads/2024/07/image-2.png 570w, https://bret.dk/wp-content/uploads/2024/07/image-2-300x63.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-2-150x31.png 150w" sizes="(max-width: 570px) 100vw, 570px" srcset="https://bret.dk/wp-content/uploads/2024/07/image-2.png 570w, https://bret.dk/wp-content/uploads/2024/07/image-2-300x63.png 300w, https://bret.dk/wp-content/uploads/2024/07/image-2-150x31.png 150w"></picture><figcaption>It’s getting hot in here</figcaption></figure></div>
<p>I’ll work a bit more on benchmarking during the week once a bit more information comes out and I’ve tinkered a bit more but for now, it’s almost there, and I look forward to seeing what I can do in the next week or so.</p>
<p>For the curious, too, an sbc-bench run on Ubuntu Server 24 (on kernel 6.8.0-39 with all BIOS settings default bar the 6W PL2) can be found at <a href="https://0x0.st/Xf2I.bin" target="_blank" rel="noreferrer noopener">https://0x0.st/Xf2I.bin</a></p>
<p>If you have any particular benchmark requests or things you want me to check out, let me know either in the comments or on <a href="https://twitter.com/bretweber" target="_blank" rel="noopener">Twitter</a> and I’ll take a look!</p>


</div><div>
<p><img alt="" src="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%3E%3C/svg%3E" data-src="https://secure.gravatar.com/avatar/2615200eb0c4295c0be42b583947a4b8?s=100&amp;d=mm&amp;r=g" data-srcset="https://secure.gravatar.com/avatar/2615200eb0c4295c0be42b583947a4b8?s=200&amp;d=mm&amp;r=g 2x" height="100" width="100" decoding="async"> </p>
<div>
<h5><a href="https://bret.dk/author/bret/" title="Author Bret" rel="author">Bret</a></h5>
<p>Bret has worked with Raspberry Pi computers for almost 10 years now and in that time he's benchmarked and tested over 30 Single Board computers. In his day job, he's a systems administrator for a large cloud computing provider.</p>

</div>
</div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Apple has reached its first-ever union contract with store employees in Maryland (170 pts)]]></title>
            <link>https://apnews.com/article/apple-union-contract-maryland-store-f9884d978bf3129c37726dd7978392a5</link>
            <guid>41089558</guid>
            <pubDate>Sat, 27 Jul 2024 21:46:51 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://apnews.com/article/apple-union-contract-maryland-store-f9884d978bf3129c37726dd7978392a5">https://apnews.com/article/apple-union-contract-maryland-store-f9884d978bf3129c37726dd7978392a5</a>, See on <a href="https://news.ycombinator.com/item?id=41089558">Hacker News</a></p>
<div id="readability-page-1" class="page"><div>
                                        <p>Apple has reached a tentative collective bargaining contract with the <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/politics-new-york-staten-island-maryland-baltimore-296f3f71f22352b0f12b9f8d599e7954">first unionized company store</a></span> in the country. </p><p>The International Association of Machinists and Aerospace Workers’ Coalition of Organized Retail Employees, which represents the employees at a retail location in Maryland, announced Friday evening that it struck a three-year deal with the company that will increase pay by an average of 10% and offer other benefits to workers. </p><p>The agreement must be approved by roughly 85 employees at the store, which is located in the Baltimore suburb of Towson. A vote is scheduled for Aug. 6. </p><p>“By reaching a tentative agreement with Apple, we are giving our members a voice in their futures and a strong first step toward further gains,” the union’s negotiating committee said in a statement. “Together, we can build on this success in store after store.”</p>
    

<p>Apple did not immediately respond to a request for comment. </p><p>The deal came after workers at the store <span><a data-gtm-enhancement-style="LinkEnhancementA" href="https://apnews.com/article/apple-store-maryland-union-strike-960295499eb853d96287164349907088">authorized a strike in May</a></span>, saying talks with management for more than a year hadn’t yielded “satisfactory outcomes.” </p><p>The Maryland store is one of only two unionized Apple sites in the country. Employees there voted in favor of the union in June 2022, a few months before workers at a second Apple location in Oklahoma City, Oklahoma, unionized with the Communications Workers of America. The second store has not secured a contract with the tech company. </p><p>Unions have scored headline-grabbing election wins in recent years, including at an Amazon warehouse in New York City, a Chipotle store in Michigan and hundreds of Starbucks stores across the country. But many of them have not secured contracts. </p>
                                    </div></div>]]></description>
        </item>
        <item>
            <title><![CDATA[Roguecraft Devs on Developing for Amiga in 2024 (126 pts)]]></title>
            <link>https://www.timeextension.com/features/interview-its-easy-to-get-a-bit-over-ambitious-roguecraft-devs-on-developing-for-amiga-in-2024</link>
            <guid>41089161</guid>
            <pubDate>Sat, 27 Jul 2024 20:35:40 GMT</pubDate>
            <description><![CDATA[<p>URL: <a href="https://www.timeextension.com/features/interview-its-easy-to-get-a-bit-over-ambitious-roguecraft-devs-on-developing-for-amiga-in-2024">https://www.timeextension.com/features/interview-its-easy-to-get-a-bit-over-ambitious-roguecraft-devs-on-developing-for-amiga-in-2024</a>, See on <a href="https://news.ycombinator.com/item?id=41089161">Hacker News</a></p>
<div id="readability-page-1" class="page"><section>
<figure><a title="Roguecraft" href="https://images.timeextension.com/c1e69cc4ee6fa/roguecraft.large.jpg"><img src="https://images.timeextension.com/c1e69cc4ee6fa/roguecraft.900x.jpg" width="900" height="520" alt="Roguecraft"></a><figcaption><em><span></span> Image: Badger Punch Games</em></figcaption></figure><p>We don't think it's an exaggeration to call <strong>Roguecraft</strong> one of the most hotly anticipated Amiga games in recent memory</p>
<p>Created by the Norwegian development studio <a href="https://www.badgerpunch.com/">Badger Punch Games</a>, it is an ambitious follow-up to the spectacular Commodore 64 homebrew <strong>Rogue 64</strong> — a game that earned a ton of praise upon its release in 2022 from indie outlets as well as from more mainstream outlets like <a href="https://www.destructoid.com/rogue64-roguelike-new-game-commodore-64-c64-badgerpunch-games/">Destructoid</a>.</p>
<p>As its name suggests, the game is a roguelike inspired by the works of HP Lovecraft and sees players exploring a maze of dungeons as one of three character archetypes (a fighter, a rogue, or a mage), in search of unimaginable treasure. Along the way, there are various secrets, items, and enemies to encounter, with the ultimate goal being to navigate the various levels and kill the tentacled monster hiding out at the end.</p>
<p>The first we heard that Badger Punch was <a href="https://www.timeextension.com/news/2024/07/roguecraft-is-a-stunning-new-roguelike-coming-to-amiga-this-year">working on a follow-up to Rogue 64 was at the beginning of 2023</a>, but it was actually announced even earlier than that, with <a href="https://x.com/sphair/status/1571850810069336064">the devs teasing the logo as early as September 2022</a>. Since then, we've been eagerly anticipating updates about the game and were excited earlier this month to see it finally go on pre-order, with the help of <a href="https://www.thalamusdigital.co.uk/">Thalamus Digital</a>.</p>
<p>The game is now expected to be released later this year, in September, so we thought it might be a good time to have a chat with its two core developers, the programmer Ricki Sickenger and artist Henning Ludvigsen, to discuss their incredible development journey so far. They gave us a little more context on how Badger Punch was originally formed, why they wanted to develop a new title for the Amiga, and why the game has taken a bit longer to make than initially expected.</p>
<hr>
<p><strong>Time Extension: Can you tell us a bit about Badger Punch Games? How did the core team come together?</strong></p>
<p><strong>Ludvigsen:</strong> We got to know each other in the early 90s, as we were both members of the same Amiga demo group. We’re both based in Norway, but we live on opposite sides of the country. Ricki’s in the west and I'm in the East.</p>
<p>In the late 90’s both of us started working on an MMORPG game called <strong>Darkfall Online</strong> with a bunch of other friends. To make a really long and complicated story very short, it basically ended up with us moving to Athens, Greece to merge with another company and to make the game, and it took almost 10 years of really hard work. Towards the end, Ricki moved back to Norway while I was stuck there for a little bit longer. We kept in touch daily and just started working on a small game for Xbox Indie Live, just for fun. And that’s when Badger Punch Games became a reality. And we’ve just kept going since then. Still, just as a side project, just for fun.</p>
<figure><a title="Henning Ludvigsen &amp; Ricki Sickenger" href="https://images.timeextension.com/d9761eb4034f4/henning-ludvigsen-and-ricki-sickenger.large.jpg"><img src="https://images.timeextension.com/d9761eb4034f4/henning-ludvigsen-and-ricki-sickenger.900x.jpg" width="900" height="600" loading="lazy" alt="Henning Ludvigsen &amp; Ricki Sickenger"></a><figcaption>Henning Ludvigsen (left) and Ricki Sickenger (right) — <em><span></span> Image: Badger Punch Games</em></figcaption></figure>
<p><strong><strong>Time Extension:</strong> Obviously, as you mentioned, Roguecraft isn’t the team’s first game. You’ve released multiple projects across a wide range of platforms in the past, including Commodore 64. What made you want to tackle a project for Amiga machines? What is your own personal history with the hardware?</strong></p>
<p><strong>Sickenger:</strong> I got my Amiga 500 around 1990, after having a C64 for a few years. I immediately started teaching myself 68k assembly and started making small intros and other things in assembly, [before] getting into the Amiga demoscene. I have fond memories of coding on the Amiga, and after making a few games on the C64 I really wanted to get back into assembly on the Amiga. The Amiga hits the sweet spot for me regarding capabilities and what you can accomplish on it as a hobby project. It really is a cool machine to make things for.</p>
<blockquote>
<p>After making a few games on the C64 I really wanted to get back into assembly on the Amiga. The Amiga hits the sweet spot for me regarding capabilities and what you can accomplish on it as a hobby project</p>
</blockquote>
<p><strong>Ludvigsen:</strong> My own personal history with the Amiga was getting a taste of it by borrowing my big brother’s Amiga 1000 without permission. However, I was using the C64/C128 for a few more years before finally getting my hands on an Amiga CDTV, which I will admit was a strange choice. Still, it was enough to get me hooked on creating music and pixel art and getting introduced to (and included) in the demo scene. At a later point, I replaced the CDTV with an Amiga 1200, and I stepped up my game even further. I still have my lovely A1200 to this day.</p>
<p><strong><strong>Time Extension:</strong> What have been some of the advantages and disadvantages of working with the Amiga hardware?</strong></p>
<p><strong>Sickenger:</strong> The big advantage compared to the C64, is that the Amiga is much faster and has dedicated coprocessors that lighten the load for the CPU. The blitter makes it pretty easy to add a lot of moving graphics on the screen, and the ability to set up your own 32-color palette lets us customize the colors to the game. Henning did an excellent job of making a palette and graphics that really showcase the Amiga’s graphical capabilities.</p>
<p>The main disadvantage I guess is that it is easy to get a bit over-ambitious when developing for the Amiga. That would be okay in a commercial sense, but not when you're trying to make games as a hobby while having a job and other commitments. Roguecraft was supposed to take about 6 months to develop and ended up taking 2 years. Also, the coprocessors like the Blitter and Copper add a layer of complexity to the coding that can get in the way before you gain experience with the Amiga architecture.</p>

<p><strong><strong>Time Extension:</strong> On your website, Roguecraft is described as an enhanced version of Rogue 64 — a game that you previously released for the Commodore 64. What were some of the main things you wanted to incorporate into this expanded version of the game to take advantage of the more powerful hardware?</strong></p>
<p><strong>Sickenger:</strong> With Roguecraft we wanted to explore the possibilities of the Amiga hardware, so we changed to isometric graphics and added quite a few new things while keeping the same gameplay as Rogue64.</p>
<p>Using the isometric style we were able to add a lot more detail to the dungeons and the monsters. Also, using an isometric view just gave us more depth to the visuals.</p>

<p><strong><strong>Time Extension:</strong> We’re huge fans of the game’s pixelated isometric graphics. How did you develop the look of the game? What were the influences you drew on?</strong></p>
<p><strong><strong><strong>Ludvigsen:</strong></strong></strong> We wanted to give using an isometric view a try, as we’ve never really done anything like that earlier. There are no real influences to the visuals, except that we do love the Lovecraftian universe, and thought it would be cool to use that as an inspiration. There’s also where the name “Roguecraft” came from; It’s a Rogue-style game set in the Lovecraft universe. The style just happened organically over time — as the palette gradually got established so did the visual style.</p>

<p><strong><strong>Time Extension:</strong> What other tools are you using for this project? Is it mostly bespoke stuff or are there any common toolsets you’re taking advantage of?</strong></p>
<p><strong>Sickenger:</strong> Each room is pre-made in a lovely program called <a href="https://www.mapeditor.org/">Tiled</a>. Tiled supports isometric tilesets, and helped us enormously. We have scripts that convert the Tiled room data into assembly data so they can be used in-game.</p>
<p><strong><strong>Ludvigsen:</strong></strong> For the pixel art, I’m using Photoshop. I found a YouTube tutorial called '<a href="https://www.youtube.com/watch?v=7Q36EyvaYG8">HD Index Painting in Photoshop</a>' by “Dan Fessler which really helped me establish a pipeline that worked for me. We tweaked this pipeline to work well with our limited 32-color Amiga palette. The cool thing with this workflow is that you can work pretty much non-destructively in Photoshop using most of the tools and still stay within the established 32-color palette. We’re also using Tiled for building the rooms based on the tile sets we’re creating, which has worked tremendously well.</p>
<figure><a title="Roguecraft" href="https://images.timeextension.com/307bcd4de5db3/roguecraft.large.jpg"><img src="https://images.timeextension.com/307bcd4de5db3/roguecraft.900x.jpg" width="900" height="720" loading="lazy" alt="Roguecraft"></a><figcaption><em><span></span> Image: Badger Punch Games</em></figcaption></figure>
<blockquote>
<p>There are over 100 room variations, and as you progress in the game, the rooms get more dark and gritty. That keeps the levels from feeling too repetitive.</p>
</blockquote>
<p><strong><strong>Time Extension:</strong> Let’s talk about the dungeons in the game. The game features randomly generated levels. Could you explain how these were built? What were some of the rules you set in place to ensure these were fun to play and not needlessly repetitive?</strong></p>
<p><strong>Sickenger:</strong> We used some common techniques and some simplifications to generate the dungeons. Every level in the dungeon is a 5x5 grid of rooms. The randomizing algorithm removes a room at a time, and then for each room it has removed, it checks that you still can access every room from every other room. That means we haven’t split the dungeon in two. If the dungeon has been split, we re-add the room and randomly pick another room to remove. We keep doing this until we have reached the minimum number of rooms, or until we have had to re-add rooms a certain number of times. Rooms are placed in the dungeon depending on how many exits they have and where they fit. There are over 100 room variations, and as you progress in the game, the rooms get more dark and gritty. That keeps the levels from feeling too repetitive.</p>

<p><strong><strong>Time Extension:</strong> Just as a final question, how much work is still left to do on the game at this stage? How are you feeling about things as you’re getting closer to the release?</strong></p>
<p><strong>Ludvigsen:</strong> The game is done, and it has been for quite a while. The pre-orders for the physical boxes opened on July 1st, which is exciting!</p>
<p>As a developer, there are always things that you know about and would have loved to keep polishing on, but we’ve focused on not falling into crazy amounts of feature creep and keeping a fairly basic and hopefully fun game experience.</p>
<p>From what we’ve seen so far, the reviews and feedback have been overwhelmingly positive which is more than we ever hoped for, so we’re currently just hoping that we’ve squished all the bugs before the big release. Also, releasing the game under the legendary Thalamus Digital banner is something we're nerding out about.</p>
<hr>
<p><em>If you're interested in checking the game out, Roguecraft is currently available to pre-order now from <a href="https://www.thalamus.shop/product/roguecraft-amiga">Thalamus Digital's website</a> in three different versions. Pre-orders are expected to be fulfilled in September 2024. The list of compatible Amiga machines includes the A500 (ECS Agnus), A500+, A600, A1200, A2000 (ECS Agnus), A3000, A4000, and CD32. More information can be found <a href="https://thalamusdigital.itch.io/roguecraft">here</a>.</em></p>
<!-- cache: html:timeextension.com/ssl/related-articles:155645,144708,168143 @ 2024-07-28T11:36:11+01:00 --></section></div>]]></description>
        </item>
    </channel>
</rss>